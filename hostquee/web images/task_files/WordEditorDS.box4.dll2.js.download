'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1364:function(J,L,d){J=d(0);var m=d(14),f=d(40),a=d(5),l=d(110),w=d(175),z=d(795),x=d(221),u=d(602),v=d(2),E=d(356),y=d(19),H=d(108),I=d(267),F=d(1),C=d(1518);class P{constructor(Z,T){this.Gsk=Z;this.GB=T}K(Z){return this.Gsk.Q2(Z,this.GB)}}Object(J.a)(P,"PropertyMergeStrategies",null,[]);var K=d(1582),G=d(1516);class R extends G.a{constructor(){super();this.udd=this.Pie=this.zo=null;this.pqe=0}get Xea(){return"Property"}mPb(){this.detail.Z("Type",
this.Xea);this.detail.Z("ComplexMerger",null!=this.zo?this.zo:-1);this.detail.Z("Strategy",null!=this.Pie?this.Pie:-1);this.detail.Z("ClassId",null!=this.udd?this.udd:-1);this.detail.Z("PropId",this.pqe);return this.detail}}Object(J.a)(R,"PropertyMergeFailureDetail",G.a,[]);d.d(L,"a",function(){return W});class W{constructor(Z=null){this.qzh=this.sc=null;this.M8b=Z||this.Y2c()}get zo(){return 1}get yub(){return this.M8b}Y2c(){return[Object(H.a)(this,this.anp,"tryPreProcessFavoredRevision"),Object(H.a)(this,
this.Sql,"cloneObjectAndRemoveNeededProperties"),Object(H.a)(this,this.Nmp,"tryMergeNodeInternal")]}get GB(){return 5}get rqe(){return this.qzh||(this.qzh=new P(this.el(),this.GB))}AD(Z,T){const N=Z.ih.value.Lf;w.a.instance.Ua(4016352,1,4,"GenericNodeComplexMerge: Failing to merge object with [Id: {0}] [ClassId: {1}] because not all of its properties changes were ignorable.",N.id,N.wc);Z.hu.logger.Pi(Object.assign(new R,{zo:this.zo,udd:N.wc,pqe:T}));return!1}uJg(Z){const T=Z.ih.value;w.a.instance.Ua(4016353,
1,5,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",T.Lf.id,T.Lf.wc);for(let N=0;N<this.yub.length;N++)if(!(0,this.yub[N])(Z))return w.a.instance.Ua(4016354,1,4,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",T.Lf.id,T.Lf.wc,N),Z.hu.logger.Che("GraphNodeComplexMerge.GetMergeFunctions()",N),this.eAn(Z),Z.Tl=null,!1;w.a.instance.Ua(4016355,1,5,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",T.Lf.id,T.Lf.wc);
return!0}eAn(Z){Z.DNg||(Z.DNg=!0,K.a(Z.ih.value.Ov,"Base",1),K.a(Z.ih.value.Lf,"Favored",1),K.a(Z.Po.value.Lf,"Conflict",1))}anp(Z){const T=Z.ih.value,N=this.rqe;if(!T.e3)return!0;let U=!0;T.WMa.forEach((ba,X)=>{if(!X.e3||Z.Ug.contains(ba))return!0;X=N.K(ba);if(5===X){const Y=T.Ov.wc;w.a.instance.Ua(4018176,1,2,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",Y,ba,X);Z.hu.logger.Pi(Object.assign(new R,{zo:this.zo,
udd:Y,pqe:ba,Pie:X}));return U=!1}6===X&&Z.Dmg.add(ba);return!0});return U}Sql(Z){Z.Tl=Z.ih.value.Lf.JO();const T=Z.Dmg,N=Z.Tl;T&&T.forEach(U=>{N.removeProperty(z.a.p_(U));return!0});return!0}Nmp(Z){const T=Z.Po.value,N=T.Ov.wc,U=this.rqe;let ba=!0;T.WMa.forEach((X,Y)=>{const ca=U.K(X);ba=this.Omp(Z,Y,X,ca);ba||(Z.Tl=null,w.a.instance.Ua(4018177,1,4,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",N,X,ca),Z.hu.logger.Pi(Object.assign(new R,{zo:this.zo,udd:N,pqe:X,
Pie:ca})));return ba});return ba}Omp(Z,T,N,U){const ba=Z.Tl;if(!T.e3&&8!==U||2===U||7===U||Z.Ug.contains(N))return!0;if(5===U)return!1;if(4===U||3===U){let X;if(({value:X}=Z.ih.value.WMa.Ac(N)).returnValue&&X.e3)return 4!==U;U=0}8===U&&(U=0);if(0===U){if(!T.isDeleted)return Z=z.a.p_(N),(W.TAp(T,N,Z)||W.Q0o())&&ba.Rdb(Z,T.newValue),!0;U=6}return 6===U?(ba.removeProperty(z.a.p_(N)),!0):1===U?this.AD(Z,N):!1}MIn(Z,T,N,U,ba,X){Z=Z||new x.a;T=T||new x.a;N=N||new x.a;var Y=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseList.Length: {0}] to not exceed [favoredList.Length: {1}] or [conflictList.Length: {2}]",
Z.length,T.length,N.length),ca=Z.length<=T.length&&Z.length<=N.length;this.xYi()&&ca&&w.a.instance.Ua(541181455,1,1,Y);if(!ca&&this.yWi(X.runtime.sc))return null;if(this.xYi())for(Y=0;Y<Z.length;Y++){ca=Z.sg(Y);var ia=T.sg(Y);let la=N.sg(Y);ca=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseVal: {0}] [favoredVal: {1}] and [conflictVal: {2}] [index: {3}] [baseList.Count {4}] to all be the same.",ca,ia,la,Y,Z.length);w.a.instance.Ua(541181457,1,1,ca)}if(this.yWi(X.runtime.sc))for(X=0;X<
Z.length;X++)if(Y=Z.sg(X),ca=T.sg(X),ia=N.sg(X),!U(Y,ca)||!U(Y,ia))return null;Z=Z.VNa();U=new u.a;X=Z.length;for(Y=X;Y<T.length;Y++)ca=T.sg(Y),Z.add(ca),U.add(ca);for(;X<N.length;X++)T=N.sg(X),U.contains(T)?w.a.instance.Ua(4018180,1,5,"MergePurelyAdditiveLists: Both favored and conflict lists contained a reference to {0}. Only adding one copy of it.",T):(Z.add(T),ba(T));return Z}xYi(){return!!v.AFrameworkApplication.J&&v.AFrameworkApplication.J.$("LogMPALErrors")}yWi(Z){if(!Z)return!1;Z.p9d(1000008);
return Z.frb(1000008)}Con(Z){if(!Z)return!1;Z.p9d(1000009);return Z.frb(1000009)}ncj(Z,T,N,U){return C.a(Z,T,N,U)}$La(Z,T,N){Z=Z||new x.a;T=T||new x.a;N=N||new x.a;const U=Z.uS(),ba=T.uS(),X=N.uS();Z=W.filter(Z,Y=>ba.contains(Y)&&X.contains(Y));Z.uS();Z.iD(Z.length,W.filter(T,Y=>!U.contains(Y)));Z.iD(Z.length,W.filter(N,Y=>!U.contains(Y)&&!ba.contains(Y)));return Z}FIn(Z,T){const N=z.a.p_(T),U=Z.kf;var ba=U.getPropertyObjectIds(Z.ih.value.Ov,N),X=U.getPropertyObjectIds(Z.ih.value.Lf,N);const Y=U.getPropertyObjectIds(Z.Po.value.Lf,
N);ba=this.$La(ba,X,Y);X=Z.Tl;0<ba.length?U.setPropertyObjectIds(X,N,ba):X.removeProperty(N);Z.Ug.add(T)}Hnb(Z,T,N){Z.hasProperty(N)?T.Rdb(N,Z.UG(N)):T.removeProperty(N)}fAo(Z,T){var N=T.ek();for(const U of N)T.removeProperty(U);N=Z.ek();for(const U of N)T.Rdb(U,Z.UG(U))}r1f(Z,T,N,U,ba){T=Z.getPropertyInt32(T,ba);N=Z.getPropertyInt32(N,ba);N=null!=T&&null!=N?Math.max(T,N):null!=N?N:null!=T?T:null;null!=N?Z.setPropertyInt32(U,ba,N):U.removeProperty(ba)}snf(Z,T,N,U,ba,X){T=Z(T,ba);N=Z(N,ba);Z=Z(U,ba);
U=T.uS();let Y=!1;X&&(Y=X(T,N,Z));Y?(X=!0,U=!1):(X=U.e5h(N),U=U.e5h(Z));w.a.instance.Ua(588011013,1,4,"CheckForMaterialDifferences: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",z.a.zb(ba),T.Qr(),N.Qr(),Z.Qr(),X,U);return{FVc:Z,N$a:X,E$a:U}}vml(Z,T,N,U,ba){let X;T=Z(T,ba);N=Z(N,ba);Z=Z(U,ba);U=this.W0i(T,N);X=this.W0i(T,Z);w.a.instance.Ua(588011014,1,4,"CheckForMaterialDifferencesInDictionaryProperty: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",
z.a.zb(ba),T.Qr(),N.Qr(),Z.Qr(),U,X);return{FVc:Z,N$a:U,E$a:X}}W0i(Z,T){if(!Z&&!T)return!0;if(!Z||!T)return!1;if(!Z.count&&!T.count)return!0;let N=!1;T.forEach((U,ba)=>N=Z.lb(U)&&ba==Z.K(U));return N}el(){let Z;Z=this.Con(this.sc)?W.cBk.value:W.bBk.value;const T=new E.a(0);for(let N=0;N<Z.length;N++)T.Z(Z[N],7);return T}static kaa(){return new W}static get instance(){return W._instance.value}static Q0o(){return y.a.instance.Oa(12).isFeatureEnabled(70)}static TAp(Z,T,N){if(void 0!==Z.newValue&&null!==
Z.newValue||F.a.mZi(N.type))return!0;W.cBn(Z,T,N);return!1}static cBn(Z,T,N){N=N.type===F.a.string;T=String.format("TryMergeProperty: Failed to Merge Property [ID: {0}]",T);N||(T+=String.format(" [NewValue: {0}] [OldValue: {1}]",Z.newValue,Z.oldValue));w.a.instance.Ua(19145822,1,2,T)}static M7f(Z,T,N){const U=z.a.zb(N),ba=Z.kf;var X=ba.getPropertyObjectIds(Z.ih.value.Ov,N);const Y=ba.getPropertyObjectIds(Z.ih.value.Lf,N);var ca=ba.getPropertyObjectIds(Z.Po.value.Lf,N);ca=W.ZNm(ca,Z.hu.runtime.Axc);
T=T.$La(X,Y,ca);X=Z.Tl;0<T.length?ba.setPropertyObjectIds(X,N,T):X.removeProperty(N);Z.Ug.add(U);return!0}static ZNm(Z,T){const N=new x.a;Z.forEach(U=>{T.contains(U,(ba,X)=>ba.equals(X))||N.add(U);return!0});return N}static filter(Z,T){const N=new x.a;Z.forEach(U=>{T(U)&&N.add(U);return!0});return N}static Zsm(){return[z.a.zb(m.a.k0d),z.a.zb(m.a.lastModifiedTime),z.a.zb(m.a.QL),z.a.zb(m.a.kld),z.a.zb(m.a.Lug),z.a.zb(f.a.sdd),z.a.zb(a.a.mWd),z.a.zb(a.a.Eob),z.a.zb(l.a.iHj)]}static $sm(){return[z.a.zb(m.a.k0d),
z.a.zb(m.a.lastModifiedTime),z.a.zb(m.a.QL),z.a.zb(m.a.kld),z.a.zb(m.a.Lug),z.a.zb(f.a.sdd),z.a.zb(a.a.mWd),z.a.zb(l.a.iHj)]}}W._instance=new I.a(W.kaa);W.bBk=new I.a(W.Zsm);W.cBk=new I.a(W.$sm);Object(J.a)(W,"GraphNodeComplexMerge",null,[1437])},1367:function(J,L,d){d.r(L);J=d(0);var m=d(252),f=d(1395),a=d(1375),l=d(1584),w=d(1585);class z{constructor(u,v){this.Tib=!1;this.hma=null;if(!u)throw Error.argumentNull("annotations");if(!u.Uoc(v))throw Error.argument("structTypeID","Invalid struct type ID");
this.Cx=u;this.wqc=this.Cx.sBi(v);this.MMk=v}get Fcc(){return this.Cx}get isReadOnly(){return this.Tib}get J_a(){return this.MMk}uqb(u){if(0>u||u>=this.wqc)throw Error.argument("iField","Invalid field index");return this.hma&&null!=this.hma[u]?this.hma[u]:this.Cx.cGi(this.J_a,u)}nyg(u,v){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>u||u>=this.wqc)throw Error.argument("iField","Invalid field index");if(!this.Cx.Qnc(this.Cx.oQb(this.J_a,
u),v))throw Error.argument("value","Value is not of the correct type for the specified field");(this.hma||(this.hma=Array(this.wqc)))[u]=v}Qha(){const {Annotations:u}=d(1367);let v="[";if(this.hma){let E=!0;for(let y=0;y<this.wqc;++y){if(null==this.hma[y])continue;const H=this.Cx.oQb(this.J_a,y);if(u.oAb(H,this.hma[y],this.Cx.cGi(this.J_a,y)))continue;E?E=!1:v+=", ";v+=this.Cx.dGi(this.J_a,y);v+="=";const I=this.Cx.Qha(H,this.hma[y]);H===u.Ica?(v+='"',v+=f.a.DAf(I),v+='"'):v+=I}}return v+"]"}isEqual(u){const {Annotations:v}=
d(1367);if(this===u)return!0;if(!u||this.Cx!==u.Fcc||this.J_a!==u.J_a)return!1;for(let E=0;E<this.wqc;++E)if(!v.oAb(this.Cx.oQb(this.J_a,E),this.uqb(E),u.uqb(E)))return!1;return!0}clone(){const u=new z(this.Cx,this.J_a);this.hma&&(u.hma=Array.clone(this.hma));return u}AW(){return this.isReadOnly?this.clone():this}O4f(){const {Annotations:u}=d(1367);if(!this.isReadOnly&&(this.Tib=!0,this.hma))for(let v=0;v<this.wqc;++v){const E=this.hma[v];null!=E&&u.yUb(E)}}toString(){return this.Qha()}}Object(J.a)(z,
"StructValue",null,[2039,2037]);d.d(L,"Annotations",function(){return x});class x{constructor(u,v){if(!u)throw Error.argumentNull("initData");if(!v)throw Error.argumentNull("objectFetcher");this.eEn=v.EVl;let E=0;var y=v.gqb(u.K(E));++E;this.G6f=new l.a(new w.a(y));this.Csk=u.K(E);++E;this.G$i=Array(this.H0d);this.Jbd=Array(this.H0d);this.nub=Array(this.H0d);for(y=0;y<this.H0d;++y){this.G$i[y]=v.eD(u.K(E));++E;this.Jbd[y]=u.K(E);++E;var H=u.K(E);++E;this.nub[y]=Array(H);for(var I=0;I<H;++I)this.nub[y][I]=
v.eD(u.K(E)),++E}this.LMk=u.K(E);++E;this.maj=Array(this.Opd);this.hie=Array(this.Opd);this.iie=Array(this.Opd);this.gie=Array(this.Opd);for(y=0;y<this.Opd;++y)for(this.maj[y]=v.eD(u.K(E)),++E,H=u.K(E),++E,this.hie[y]=Array(H),this.iie[y]=Array(H),this.gie[y]=Array(H),I=0;I<H;++I)this.hie[y][I]=v.eD(u.K(E)),++E,this.iie[y][I]=u.K(E),++E,this.gie[y][I]=({rla:E}=this.BUa(this.iie[y][I],u,E,null,null,null)).returnValue,x.yUb(this.gie[y][I]);this.gmk=u.K(E);++E;this.k6f=Array(this.ddc);this.l6f=Array(this.ddc);
this.j6f=Array(this.ddc);for(y=0;y<this.ddc;++y)this.k6f[y]=v.eD(u.K(E)),++E,this.l6f[y]=u.K(E),++E,this.j6f[y]=({rla:E}=this.BUa(this.l6f[y],u,E,null,null,null)).returnValue,x.yUb(this.j6f[y])}l1c(u){for(let v=0;v<this.ddc;++v)if(this.k6f[v]===u)return v;return-1}dsi(u){if(!this.Qoc(u))throw Error.argument("attrID","Invalid attribute ID");return this.k6f[u]}getAttributeType(u){if(!this.Qoc(u))throw Error.argument("attrID","Invalid attribute ID");return this.l6f[u]}oQb(u,v){if(!this.Uoc(u))throw Error.argument("structTypeID",
"Invalid struct type ID");u=this.iie[x.Ppd(u)];if(0>v||v>=u.length)throw Error.argument("iField","Invalid field index");return u[v]}Qha(u,v){if(!this.O0f(u))throw Error.argument("typeID","Invalid type ID");if(!this.Qnc(u,v))throw Error.argument("value","Value is not of the correct type");switch(u){case x.Ica:return v;case x.xEa:return v?"True":"False";case x.TOa:case x.Sva:return v.toString();case x.sY:return v.Qha();default:if(!x.kK(u)&&x.$rd(u)){u=x.qAf(u);const H=this.nub[u].length;switch(this.Jbd[u]){case 0:return this.nub[u][v];
case 1:if(v){var E="";for(var y=1;y<H;++y)v&1<<y-1&&(0<E.length&&(E+=" & "),E+=this.nub[u][y]);return E}return this.nub[u][0];case 2:E="";for(y=0;y<H;++y)v&1<<y&&(0<E.length&&(E+=" & "),E+=this.nub[u][y]);return E;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.Jbd[u]);}}else return v.Qha()}}O0f(u){switch(u){case x.Ica:case x.xEa:case x.TOa:case x.Sva:case x.sY:return!0;default:return x.kK(u)?this.O0f(x.j9a(u)):x.$rd(u)?this.Lqn(u):this.Uoc(u)}}Lqn(u){u=x.qAf(u);return 0<=
u&&u<this.G$i.length}Uoc(u){u=x.Ppd(u);return 0<=u&&u<this.maj.length}Qoc(u){return 0<=u&&u<this.ddc}Qnc(u,v){if(null==v)return!1;switch(u){case x.Ica:return"string"===typeof v;case x.xEa:return"boolean"===typeof v;case x.TOa:return"number"===typeof v;case x.Sva:return"number"===typeof v;case x.sY:return Object(m.a)(2036,v);default:if(x.kK(u))return Object(m.a)(2038,v)&&v.M7===x.j9a(u);if(x.$rd(u)){if("number"!==typeof v)return!1;u=x.qAf(u);const E=this.nub[u].length;switch(this.Jbd[u]){case 0:return 0<=
v&&v<E;case 1:return!(v&-1<<E-1);case 2:return!!v&&!(v&-1<<E);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.Jbd[u]);}}else return Object(m.a)(2039,v)&&v.J_a===u}}get ddc(){return this.gmk}get H0d(){return this.Csk}get Opd(){return this.LMk}Qfm(u){if(!this.Qoc(u))throw Error.argument("attrID","Invalid attribute ID");return this.j6f[u]}sBi(u){if(!this.Uoc(u))throw Error.argument("structTypeID","Invalid struct type ID");return this.hie[x.Ppd(u)].length}dGi(u,v){if(!this.Uoc(u))throw Error.argument("structTypeID",
"Invalid struct type ID");return this.hie[x.Ppd(u)][v]}cGi(u,v){if(!this.Uoc(u))throw Error.argument("structTypeID","Invalid struct type ID");u=this.gie[x.Ppd(u)];if(0>v||v>=u.length)throw Error.argument("iField","Invalid field index");return u[v]}BUa(u,v,E,y,H,I){if(!v)throw Error.argumentNull("initData");if(x.kK(u)){var F=v.K(E);++E;u=x.j9a(u);var C=new a.a(this,u);for(var P=0;P<F;++P)Array.add(C.items,({rla:E}=this.BUa(u,v,E,y,H,I)).returnValue);return{returnValue:C,rla:E}}switch(u){case x.Ica:return{returnValue:(y||
this.G6f).eD(v.K(E++)),rla:E};case x.xEa:return{returnValue:1===v.K(E++),rla:E};case x.TOa:return{returnValue:v.K(E++),rla:E};case x.Sva:return{returnValue:(H||this.eEn)[v.K(E++)],rla:E};case x.sY:u=v.K(E++);F=new f.a(this);for(C=0;C<u;++C)P=v.K(E),++E,I&&(P=I[P]),F.dA(P,({rla:E}=this.BUa(this.getAttributeType(P),v,E,y,H,I)).returnValue);return{returnValue:F,rla:E};default:if(x.$rd(u))return{returnValue:v.K(E++),rla:E};if(x.a3j(u)){F=v.K(E++);C=new z(this,u);for(P=0;P<F;++P){const K=v.K(E);++E;C.nyg(K,
({rla:E}=this.BUa(this.oQb(u,K),v,E,y,H,I)).returnValue)}return{returnValue:C,rla:E}}throw Error.argument("typeID","Invalid type ID");}}static $rd(u){return 16<=(u&16383)&&16384!==(u&16384)&&32768!==(u&32768)}static a3j(u){return 16<=(u&16383)&&16384===(u&16384)&&32768!==(u&32768)}static kK(u){return 32768===(u&32768)}static kwm(u){if(x.kK(u))throw Error.argument("nonListTypeID","Non-list type ID required");return u|32768}static j9a(u){if(!x.kK(u))throw Error.argument("listTypeID","List type ID required");
return u&-32769}static oAb(u,v,E){switch(u){case x.Ica:case x.xEa:case x.TOa:case x.Sva:return v===E;case x.sY:return v.isEqual(E);default:return x.kK(u)?v.isEqual(E):x.$rd(u)?v===E:v.isEqual(E)}}static yUb(u){Object(m.a)(2037,u)&&u.O4f()}static AW(u){return Object(m.a)(2037,u)?u.AW():u}static qAf(u){return u-16}static Ppd(u){return(u&-16385)-16}}x.Ica=1;x.xEa=2;x.TOa=3;x.Sva=5;x.sY=9;Object(J.a)(x,"Annotations",null,[2040])},1372:function(J,L,d){J=d(0);var m=d(346);class f{constructor(){this.userId=
this.email=this.displayName=null}}Object(J.a)(f,"InsertMentionParameters",null,[]);class a{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(J.a)(a,"InsightsParameters",null,[]);var l=d(1725),w=d(1726),z=d(1728),x=d(1729),u=d(2),v=d(1456),E=d(1473),y=d(29),H=d(18),I=d(17),F=d(1359),C=d(1727);d.d(L,"a",function(){return P});class P{static get eVf(){return"Insights_16x16x32"}static get z6l(){return"Find_16x16x32"}static get $pj(){return"-Parameterized"}static get fDg(){return"Parameterized"}static get aDe(){return"bTryQuery"}static get BJg(){return"TellMeSuggestion_"}static get D2j(){return"bTryQueryAlternate"}static get PGg(){return"MenuTellMe"}static get V7n(){const K=
{},G=[];Array.add(G,{Term:{PeopleType:"Person"}});K.And=G;return K}static ztf(K){return K+P.$pj}static getParameter(K){let G="",R="";if(K)for(let W=0;W<K.Xli;++W)"Type"===K.yIf(W)?G=K.getValue(W):"Value"===K.yIf(W)&&(R=K.getValue(W));return new m.a(G,R)}static qMb(K){K=Object.assign(new a,{neighborhood:K,mentionStart:0,mentionLength:K.length});return y.c(K)}static s$h(K,G,R){K=Object.assign(new f,{displayName:K,email:G,userId:R});return y.c(K)}static oUa(K,G,R=null){return y.c(P.JFi(K,G,R,null))}static JFi(K,
G,R=null,W=null){K=Object.assign(new E.a,{neighborhood:K,mentionStart:0,mentionLength:K?K.length:0});return Object.assign(new v.a,{selection:K,userIntent:W,entryPoint:G,launchData:R})}static vEo(K,G){return P.oUa(K,P.sFj(G))}static sFj(K){switch(K){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;case "GenerateDeckFromFile":return 38;default:return 0}}static Wgn(){return!!u.AFrameworkApplication.J&&u.AFrameworkApplication.J.$("IsGoLocalEnvironment")}static Doc(){const K=
u.AFrameworkApplication.J?u.AFrameworkApplication.J.ib("SovereignEnvironmentName"):null;return!!K&&0<K.length}static isEnterpriseUser(){const K=u.AFrameworkApplication.J?u.AFrameworkApplication.J.ib("HostAuthType"):null;return!!K&&"aad"===K.toLowerCase()||"external"===K&&P.iXf()}static TAg(K){return K.qfp&&!P.Doc()}static Inn(){const K=u.AFrameworkApplication.J?u.AFrameworkApplication.J.ib("UiHostIntegrationType"):"";return!!u.AFrameworkApplication.J&&"UnifiedUiHostTeams"===K&&u.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",
!1)}static SAg(K){return K.T_a&&K.s4l&&(K.zqd||K.xqd||K.ztb)&&!P.Inn()&&P.isEnterpriseUser()&&!P.Doc()}static yta(){return u.AFrameworkApplication.J?u.AFrameworkApplication.neb||u.AFrameworkApplication.J.$("SmartLookupEnableNativePane"):u.AFrameworkApplication.neb}static wU(K){return!K||P.R0i(K.Wg)}static R0i(K){return!K||!K.trim().length}static NCe(K){if(!K)return 0;const G=Math.pow(10,5);return Math.round(K*G)/G}static Ihp(){var K=new Date;return K?new Date(K.getUTCFullYear(),K.getUTCMonth(),K.getUTCDate(),
K.getUTCHours(),K.getUTCMinutes(),K.getUTCSeconds(),K.getUTCMilliseconds()):null}static XNf(K){K=new Date(K);return(P.Ihp().getTime()-K.getTime())/1E3}static z1i(K){switch(K){case l.a.LRf:case w.a.Gni:case C.a.MRi:case z.a.Afj:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "ActionAIFromTellMe":case "LaunchAddinDialogFromTellMe":case "GenerateSlidesFromTellMe":case "QuickActionOnFile":case "SummarizeDeckFromTellMe":case "SummarizeSlidesFromTellMe":return!0}return K.startsWith(P.aDe)||
K.startsWith(P.BJg)||K.startsWith(P.D2j)||K.startsWith("PeopleSuggestion")||K.startsWith("FileSuggestion")||K.startsWith("FindInDocumentSuggestion")||K.startsWith("NotesSuggestion")||K.startsWith("OnenoteNotesSuggestion")||K.startsWith("SmartLookupFromTellMe")||K.startsWith("GetHelpFromTellMe")||K.startsWith("GetHelpWithDescriptionFromTellMe")||K.startsWith("AddinSuggestion")||K.startsWith("OfficeScripts")?!0:!1}static VIf(K,G){const R=[];Array.add(R,new x.a(400,K));Array.add(R,new x.a(200,G));K=
{};K.parts=R;return JSON.stringify(K)}static cqb(K){const G=K.indexOf("<b0>"),R=K.lastIndexOf("</b0>"),W=[];Array.add(W,new x.a(400,K.substring(0,G)));Array.add(W,new x.a(600,K.substring(G+4,R)));Array.add(W,new x.a(400,K.substring(R+5,K.length)));K={};K.parts=W;return JSON.stringify(K)}static CHi(K){const G=P.XNf(K);return 60>G?CommonUIStrings.l_TimeSince_SecsAgo:3600>G?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(G/60).toString()):86400>G?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(G/3600).toString()):172800>G?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(K)).localeFormat("MMMM dd, yyyy"))}static Cjm(K){const G=Array(K.length);for(let R=0;R<K.length;R++)G[R]=K[R].commandId;return G}static iXf(){if("Dev Box"===u.AFrameworkApplication.J.ib("StatusBarEnvironmentNameToUse"))return!0;let K=u.AFrameworkApplication.J.ib("UserPrincipalName");K=F.c(K)?"":I.a.vh(K);const G=u.AFrameworkApplication.J.Zx("TellMeIntEnabledForFeatureCrew")?
u.AFrameworkApplication.J.cD("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(G,K)&&"inner"===u.AFrameworkApplication.J.ib("Microsoft365Ring")}static Vsm(K){switch(P.z5d(K)){case "PowerPoint":return"SaveAsPowerPointPptx_20";case "Word":return"SaveAsWordDocx_20";case "Excel":return"SaveAsExcelXlsx_20";case "Pdf":return"PdfFile_20";case "OneNote":return"OneNote_20";case "Visio":return"visio_20"}return""}static EIm(K){K=P.z5d(K);switch(K){case "PowerPoint":return"pptx";case "Word":return"docx";
case "Excel":return"xlsx";default:return K}}static z5d(K){switch(K.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"PowerPoint";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"Word";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"Excel";case "pdf":return"Pdf";case "one":case "onepkg":return"OneNote";
case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio"}return"Unknown"}static kta(){return H.a.u7&&!H.a.Pr}}P.Seb=9E5;Object(J.a)(P,"TellMeUtils",null,[])},1373:function(J,L,d){d.r(L);J=d(0);var m=d(513),f=d(276),a=d(108),l=d(252),w=d(83),z=d(1613),x=d(1007);class u{constructor(ra,Ya,ab,cb,Eb,mc){this.groupType=ra;this.resultType=Ya;this.ZEg=ab;this.Raa=cb;this.exf=Eb;this.resultIndex=
mc}}Object(J.a)(u,"ClickLoggingInfo",null,[]);const v=ra=>{const Ya=[];for(;ra;)Array.add(Ya,"{ContextId:"+ra.contextId+", IsGraphNodeContext:"+ra.Al+"}"),ra=ra.Ik;Ya.reverse();return"{"+Ya.join(", ")+"}"};class E{constructor(){this.$sa=this.sessionId=null}}Object(J.a)(E,"CorrelationRecord",null,[1917]);var y=d(1407);class H{constructor(ra,Ya){this.provider=ra;this.hfb=Ya}}Object(J.a)(H,"ExternalResultProvider",null,[]);class I{constructor(ra,Ya){this.Id=null;this.TimeStamp=0;this.Id=ra;this.TimeStamp=
Ya}}Object(J.a)(I,"MRUControl",null,[]);var F=d(1586),C=d(1372),P=d(2),K=d(1238);class G{constructor(ra,Ya){this.tCk=10;this.g$=[];this.wGa=[];this.hoh=this.goh=!1;this.bLc=this.aLc="";this.K8b=Ya;this.kc=ra}Q1c(){!this.goh&&this.kc&&(this.aLc="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.kc.application,this.g$=this.Vsi(),this.goh=!0);return this.g$}HEm(){!this.hoh&&this.kc&&(this.bLc="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.kc.application,this.wGa=this.Vsi(!0),this.hoh=!0);return this.wGa}Mpn(ra){return ra.startsWith("TellMeUpsell")||
"OpenInClientUpsell"===ra||"TryOfficeUpsell"===ra}PWf(ra){return this.ebn(ra)||this.Mpn(ra)||C.a.z1i(ra)?!1:!0}w5a(ra){ra=ra.ControlId;this.PWf(ra)&&(ra=this.Drg(ra),this.bwo(ra),this.$En(),Array.insert(this.g$,0,new I(ra,Date.now())),this.aLc.length&&(ra=JSON.stringify(this.g$),K.a.instance.setItem(this.aLc,ra)))}DG(ra){this.ZEn();Array.insert(this.wGa,0,new I(F.a[ra],Date.now()));this.bLc.length&&(ra=JSON.stringify(this.wGa),K.a.instance.setItem(this.bLc,ra))}Vsi(ra=!1){if(!this.g$.length){var Ya=
ra?K.a.instance.getItem(this.bLc):K.a.instance.getItem(this.aLc);if(!Ya||""===Ya)return ra?this.wGa:this.g$;let ab=null;try{ab=JSON.parse(Ya)}catch(cb){this.Xol(ra),ab=null}if(!ab||!ab.length||10<ab.length)return ra?this.wGa:this.g$;Ya=0;for(const cb of ab)if(ra||this.kc.Hfe(cb.Id)&&this.PWf(cb.Id))if(ra?Array.insert(this.wGa,Ya++,cb):Array.insert(this.g$,Ya++,cb),Ya===this.K8b)break}return ra?this.wGa:this.g$}pqf(ra){ra=this.Drg(ra);for(const Ya of this.g$)if(Ya.Id===ra)return!0;return!1}Xol(ra=
!1){K.a.instance.setItem(ra?this.bLc:this.aLc,"")}xdn(ra){ra=this.Drg(ra.ControlId);return this.PWf(ra)?this.pqf(ra):!1}bwo(ra){if(0<this.g$.length){let Ya=0;for(const ab of this.g$){if(ab.Id===ra){Array.removeAt(this.g$,Ya);break}Ya++}}}Drg(ra){return"Excel"===this.kc.application&&ra.startsWith("m_excelWebRenderer_ewaCtl_")?ra.substr(26,ra.length):ra}$En(){this.g$.length===this.K8b&&Array.removeAt(this.g$,this.g$.length-1)}ZEn(){this.wGa.length===this.tCk&&Array.removeAt(this.wGa,this.wGa.length-
1)}ebn(ra){ra=ra.split("|");let Ya="";if(6<=ra.length)Ya=ra[0];else if(3<=ra.length){if("3"===ra[0])return!0;Ya=ra[1]}return Ya.startsWith("WA")}static createInstance(ra){let Ya=3;P.AFrameworkApplication.J&&(Ya=P.AFrameworkApplication.J.ic("TellMeMaxRecommendedResultsToReturn",3));return new G(ra,Ya)}}Object(J.a)(G,"MruControlsManager",null,[1915]);class R{constructor(ra){this.wGb=ra}eka(ra,Ya){let ab;return ra.tE&&(ab=this.wGb[ra.value])?ab.eka(ra,Ya):(ab=this.Vti(ra.value))?ab.eka(ab.IKn,Ya):null}kCm(ra,
Ya){if(ra=this.wGb[ra])for(const ab of Ya)if(Ya=C.a.getParameter(ab),Ya.key===ra.uig)return Ya.value;return null}gPn(ra){(ra=this.Vti(ra))&&ra.dPn()}Vti(ra){const Ya=ra.indexOf(C.a.$pj);return 0<Ya?this.wGb[ra.substring(0,Ya)]:null}}Object(J.a)(R,"ParameterizedCommandManager",null,[1914]);var W=d(1429);class Z{constructor(ra,Ya){this.Wg=ra;this.Bwb=Ya}}Object(J.a)(Z,"TellMeQuery",null,[]);var T=d(1583);class N{constructor(ra,Ya){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=ra;this.TimeElapsedSinceClick=
Ya}}Object(J.a)(N,"CommandClickedEvent",null,[]);var U=d(1359);class ba{constructor(ra,Ya){this.MEk=ra;this.Vxa=Ya}Nt(ra){this.MEk(U.c(ra.query)?"":ra.query.Wg,ra.Wo,ra.attributes,this.Vxa,ra.hoc)}}Object(J.a)(ba,"ResultsUpdatedCallback",null,[1913]);class X{constructor(ra,Ya,ab,cb,Eb){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=0;this.TerminalParentControlId=this.CommandSurface=null;this.ControlId=ra;this.TimeElapsedSinceClick=ab;this.CommandSurface=cb;this.CommandId=Ya;this.TerminalParentControlId=
Eb}}Object(J.a)(X,"UserActionEvent",null,[]);var Y=d(75);class ca{constructor(ra,Ya){this.menuModel=ra;this.qFj=Ya}}Object(J.a)(ca,"GeneratedMenuModel",null,[]);class ia{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(J.a)(ia,"MenuModel",null,[]);class la{constructor(ra,Ya,ab){this.kc=ra;this.wGb=Ya;this.lja=ab}Rcm(ra,Ya,ab){const {TellMeActor:cb}=d(1373);let Eb=0;const mc=new ia,tb=[];let Xa="";mc.sections=[];let Mb=new Y.a;
const cc=!!this.kc&&this.kc.Aab;var oc=!!this.kc&&this.kc.tyb||P.AFrameworkApplication.ua.Ib.tyb;for(const vb of ra){ra=0;cc||(Mb=new Y.a);const jd=new Y.a;let ud=vb.displayName;for(const qe of vb.results){if(0<=qe.value.indexOf(C.a.fDg)){if(qe.tE){var Pc=this.wGb[qe.value];if(Pc&&qe.value.endsWith(C.a.fDg)){if("FindParameterized"!==qe.value&&!oc){const Ae=[];Ae.push(appChrome.actions.setControlLabel(qe.value,Pc.q6d(qe)));Ae.push(appChrome.actions.setButtonCommandValueId(qe.value,Pc.PGf(qe)));appChrome.api.dispatch(Ae)}Pc=
qe.value.replace(C.a.fDg,"");Mb.remove(Pc)?ra--:jd.add(Pc);Mb.add(qe.value);ra++}}}else switch(qe.type){case 5:jd.contains(qe.value)||(Mb.add(qe.value),ra++);break;case 7:Mb.add(qe.tE);ra++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 25:case 26:case 6:case 19:case 20:case 21:case 27:case 29:case 28:case 30:case 31:Mb.add(qe.value),ra++}13===vb.groupType&&(ud=C.a.yta()?0<Ya.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,
Ya):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,Ya));21===vb.groupType&&(ud=CommonUIStrings.l_LearningUILiveText)}Eb+=ra;""!==ud&&0<ra&&(Xa+=" , "+ra.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+ud+" , ");0<Mb.count&&!cc&&(ra=appChrome.api.menuSection(Mb.toArray(),vb.displayName,null,W.a[vb.groupType]),tb.push(ra))}oc=null;0<Eb&&(oc=0<Ya.length?1!==Eb?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,
Eb,Ya):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,Ya):1!==Eb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,Eb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,cc?(Ya=appChrome.api.menuSection(Mb.toArray(),"",null,null),tb.push(Ya)):oc+=Xa);ab&&(this.kc.hBa?cb.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(oc)):appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(oc)));mc.sections=
tb;return new ca(mc,Eb,[])}static get hzf(){return la.$eh||(la.$eh=new ca(Object.assign(new ia,{sections:[]}),0,[]))}}la.$eh=null;Object(J.a)(la,"TellMeMenuDefintionGenerator",null,[]);var ta;(function(ra){ra[ra.QNp=0]="TellMeControlActivated";ra[ra.SNp=1]="TellMeQueryExecuted";ra[ra.UNp=2]="TellMeResultsRendered";ra[ra.RNp=3]="TellMeControlDeactivated"})(ta||(ta={}));Object(J.b)("PerformanceMarker",ta);var za;(function(ra){ra[ra.WNp=0]="TellMeTimeToRender";ra[ra.VNp=1]="TellMeSessionLength";ra[ra.TNp=
2]="TellMeResultTriageTime"})(za||(za={}));Object(J.b)("PerformanceMeasure",za);class Ha{mark(ra){window.performance.mark(ta[ra])}measure(ra,Ya,ab){const {TellMeActor:cb}=d(1373);try{window.performance.measure(za[ra],ta[Ya],ta[ab])}catch(Eb){cb.instance.Xe.onError("TellMePerformance:Measure","error measuring "+za[ra])}}p5f(ra,Ya,ab){const {TellMeActor:cb}=d(1373);cb.instance.Xe.z5f(Ya,ab,ra,this.Ywm(ra))}zpl(){var ra=[0,1,2,3];for(const Ya of ra)window.performance.clearMarks(ta[Ya])}clearMeasures(ra){for(const Ya of ra)window.performance.clearMeasures(za[Ya])}Ywm(ra){let Ya=
0;(ra=this.Eem(ra))&&0<ra.length&&(Ya=ra[ra.length-1].duration);return Ya}Eem(ra){return window.performance.getEntriesByName(za[ra],"measure")}}Object(J.a)(Ha,"TellMePerformance",null,[]);var Na=d(1478),ya=d(1477),ma=d(29);class Ea{constructor(ra){this.MNk=ra}$ed(ra,Ya,ab){const {TellMeActor:cb}=d(1373);cb.instance.Xe.Eba(Ya,ya.a.Ttc,ra.data.Ie.toString(),Math.round(window.performance.now()-ab),ya.a.Ttc,!0,Na.a.tWa);ra=ma.b(ra.data.De);Ya=-1;ra.Index&&(Ya=ra.Index);cb.instance.Xe.gCn(Ya,this.MNk)}ned(ra,
Ya,ab){const {TellMeActor:cb}=d(1373);cb.instance.Xe.Eba(Ya,ya.a.Ttc,ra.data.Ie.toString(),Math.round(window.performance.now()-ab),ya.a.Ttc,!1,Na.a.tWa)}NEm(ra){if(ra&&""!==ra.trim()){const ab=window.performance.now(),cb=P.AFrameworkApplication.kZj;var Ya={};Ya.Text=ra;Ya.IsFileHash="false";Ya=ma.c(Ya);P.AFrameworkApplication.Ee.Wj(cb,2,Ya,{"Content-Type":"application/json",Accept:"application/json"},!1,0,Eb=>{this.$ed(Eb,ra.length,ab)},Eb=>{this.ned(Eb,ra.length,ab)},null,null,!1,4E3,6E3)}}}Object(J.a)(Ea,
"TellMeQueryIndexCallback",null,[]);var Ba=d(1377);class $a{constructor(ra,Ya,ab){this.xml=ra;this.qFj=Ya;this.pTl=ab}}Object(J.a)($a,"GeneratedMenuXml",null,[]);var ea=d(1725),ka=d(17);class La{constructor(ra,Ya){this.Wxd=ra||{};this.I3a=Ya}get nZb(){return 5}eka(ra,Ya=null){return this.I3a.eka(ra,Ya)||this.ndl(ra.value)}ndl(ra){return La.flf(ra,this.Wxd[ra]||null)}static flf(ra,Ya=null){ra=String.format('<ClonedControl Id="{0}" ',ra);for(const Eb in Ya){var ab=Eb,cb=Ya[Eb];cb=cb?ka.a.Jf(cb.toString()):
"";ra+=String.format('{0}="{1}" ',ab,cb)}return ra+"/>"}}Object(J.a)(La,"CommandMenuItemFactory",null,[1878]);var va=d(226);class Ca{constructor(){this.ztk=CommonUIStrings.l_FindInDocumentText}get nZb(){return 8}eka(ra){var Ya=ra.tE;ra=ka.a.Jf(ra.value);const ab=ka.a.Jf(Ya);Ya=ka.a.Jf(String.format(this.ztk,Ya));return this.icm(ra,ab,Ya)}icm(ra,Ya,ab){return va.a(ra,"1540292897",ab,C.a.z6l,null,Ya,ab,null,null)}}Object(J.a)(Ca,"FindInDocumentMenuItemFactory",null,[1878]);var ua=d(1726),Sa=d(1727);
class Ta{constructor(ra=null){this.Hxk=ra||CommonUIStrings.l_InsightsButtonText}get nZb(){return 10}eka(ra){var Ya=ra.tE;ra=C.a.yta()?C.a.oUa(Ya,1):C.a.qMb(Ya);Ya=String.format(this.Hxk,Ya);return this.rcm(ra,Ya)}rcm(ra,Ya){return va.a(Sa.a.MRi,C.a.yta()?"1914896509":"3317204163",ka.a.Jf(Ya),C.a.eVf,null,ka.a.Jf(ra),ka.a.Jf(Ya),null,null)}}Object(J.a)(Ta,"InsightsMenuItemFactory",null,[1878]);var zb=d(1728);class Ra{get nZb(){return 7}eka(ra){const Ya=Object(w.a)(T.a,ra);return this.Ycm(ka.a.Jf(ra.value),
Ya.id)}Ycm(ra,Ya){return va.a(Ya,"1404166600",ra,null,null,ra,ra,null,null)}}Object(J.a)(Ra,"TryQueryMenuItemFactory",null,[1878]);class qb{constructor(ra){this.NS=[];this.kc=ra}gpm(ra){for(const Ya of this.NS)if(Ya.nZb===ra)return Ya;return null}ia(ra){this.NS.push(ra)}$po(ra){this.ia(new La(this.kc.uyl,ra));this.ia(new zb.a(this.kc.PNn));this.ia(new ea.a(this.kc.HJo,this.kc.GJo,this.kc.Bfp,this.kc.pYm,this.kc.O_o));this.ia(new Ta);this.ia(new Ca);this.ia(new ua.a);this.ia(new Ra)}}Object(J.a)(qb,
"MenuItemFactoryRegistry",null,[]);var kb=d(1379);class Va{constructor(ra,Ya){this.kc=ra;this.qth=new qb(this.kc);this.qth.$po(Ya)}Scm(ra,Ya){let ab=0;const cb=[],Eb=[];for(const tb of ra){ra=C.a.PGg;var mc=[];for(const Xa of tb.results){const Mb=this.qth.gpm(Xa.type).eka(Xa,Ya);ra=C.a.PGg;mc.push(Mb);if(13===Xa.type||14===Xa.type)ra="Menu32";17===Xa.type&&(ra="MenuTellMeExtended");Xa.groupType=tb.groupType;Eb.push(Object(w.a)(kb.a,Xa))}ab=ab?ab:mc.length;mc=va.d("TellMeDropdownControls",mc);ra=va.g("TellMeDropdownMenuSection",
mc,ra,tb.displayName);cb.push(ra)}Ya=va.h(cb,"LookupDropdownMenu");return new $a(Ya,ab,Eb)}static get Y_d(){return Va.afh||(Va.afh=new $a(va.h([],"LookupDropdownMenu"),0,[]))}}Va.afh=null;Object(J.a)(Va,"TellMeXmlGenerator",null,[]);class Za{}Za.DLn="MRU";Za.test="Test";Object(J.a)(Za,"ActionType",null,[]);var Ka=d(1460),bb;(function(ra){ra[ra.gNp=0]="Service";ra[ra.b3b=1]="Local";ra[ra.nLp=2]="MRU";ra[ra.Thk=3]="TestResult";ra[ra.Unknown=4]="Unknown"})(bb||(bb={}));Object(J.b)("SubResultType",bb);
var Ib=d(86);class ib{constructor(ra,Ya,ab,cb,Eb=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=null;this.CommandId=ra;this.IsEnabled=Ya;this.ResultType=F.a[ab];this.SubResultType=bb[cb];this.OptionalData=Eb?Ib.a.toJSON(Eb):null}}Object(J.a)(ib,"ResultInfo",null,[]);var jb=d(120),hb=d(183),pb=d(291);class ob{constructor(ra,Ya=null){this.gDd="TellMeWAC.";this.mGk=ra;this.QOk=Ya}KNa(ra,Ya,ab){Ya=jb.a.$H(Ya);ra=jb.a.ttf(ra,this.mGk,this.QOk,ab,Ya);hb.a.KNa(ra,
this.gDd)}JNa(ra,Ya,ab=0){Ya=jb.a.$H(Ya);hb.a.JNa(Object.assign(new pb.a,{name:ra,dataFields:Ya,durationMs:ab}),this.gDd)}}Object(J.a)(ob,"TellMeOtelLogger",null,[1938]);var sb=d(124);class Ab{constructor(ra,Ya,ab,cb,Eb,mc,tb){this.j$=this.Rda=this.Bah=null;this.CPa=ra;this.jhb=Ya;this.pSa=ab;this.Sib=cb;this.P2a=Eb;this.hAk=mc;this.j$=tb?tb:new ob(this.Sib?x.a.eDg:x.a.rBe)}get As(){return this.Sib}get Lua(){return this.pSa}jxe(ra){this.Bah=ra;switch(ra){case Ba.a.contextMenu:this.Rda=Ba.a.contextMenu;
break;default:this.Rda=Ba.a.ou}}$$k(ra,Ya){this.pSa.$sa||(this.pSa.$sa=sb.a.create().toString(),this.v8i(ra,!0,Ya))}pii(ra,Ya=!0){this.pSa.$sa&&this.Tzn(ra,Ya);this.Sib&&appChrome.api.updateTellMeCorrelationId("");this.pSa.$sa=null}v8i(ra,Ya,ab){const {TellMeActor:cb}=d(1373),Eb=this.naa(y.a.x$a);Eb[Ka.a.culture]=this.jhb;Eb[Ka.a.appName]=this.CPa;Eb[Ka.a.context]=ra;Eb[Ka.a.Mee]=this.P2a;Eb[Ka.a.Kpn]=this.hAk;Eb[Ka.a.uon]=ab;Eb[Ka.a.iin]=Ya;Eb[Ka.a.contentType]=cb.instance.xYd;this.j$.KNa(y.a.x$a,
Eb,this.Bah);this.Sib&&appChrome.api.updateTellMeCorrelationId(this.pSa.$sa)}Tzn(ra,Ya){const ab=this.naa(y.a.bSb);ab[Ka.a.pWl]=ra;ab[Ka.a.hin]=Ya;this.j$.JNa(y.a.bSb,ab)}fCn(ra,Ya,ab){let cb=0;!ab&&0<ra.length&&(cb=ra.trim().split(" ").length);const Eb=this.naa(y.a.query);Eb[Ka.a.query]="!";Eb[Ka.a.WXb]=Ya;Eb[Ka.a.Dvj]=ra.length;Eb[Ka.a.Z2i]=ab;Eb[Ka.a.TGp]=cb;this.j$.KNa(y.a.query,Eb,this.Rda)}iBn(ra,Ya,ab,cb,Eb,mc,tb,Xa=null){const Mb=this.naa(y.a.latency);Mb[Ka.a.culture]=this.jhb;Mb[Ka.a.Dvj]=
ra;Mb[Ka.a.f3j]=Ya;Mb[Ka.a.statusCode]=ab;Mb[Ka.a.service]=Eb;Mb[Ka.a.isSuccess]=mc;Mb[Ka.a.bun]=tb;Xa&&(Mb[Ka.a.mip]=Xa);this.j$.JNa(y.a.latency,Mb,cb)}z5f(ra,Ya,ab,cb){const Eb=this.naa(y.a.performance);Eb[Ka.a.culture]=this.jhb;Eb[Ka.a.dal]=ta[ra];Eb[Ka.a.QYl]=ta[Ya];Eb[Ka.a.n8n]=za[ab];this.j$.JNa(y.a.performance,Eb,cb)}oCn(ra,Ya){var {TellMeActor:ab}=d(1373);const {CommandResultsUtility:cb}=d(1442);if(ra.results.length){var Eb=this.naa(y.a.ZCj);Eb[Ka.a.Raa]=Ya.toString();Eb[Ka.a.groupType]=W.a[ra.groupType];
16===ra.groupType&&(Eb[Ka.a.Qnn]=ab.instance.btd);Ya=[];ab=[];var mc=[];for(const tb of ra.results)Eb[Ka.a.resultType]||(Eb[Ka.a.resultType]=F.a[tb.type]),ra={},27===tb.type&&(ra.AssetId=tb.QK),ab.push(cb.Z7c(tb.value)),Ya.push(tb.value),mc.push(new ib(tb.value,cb.Z7c(tb.value),tb.type,tb.subType,ra));0<Ya.length&&(Eb[Ka.a.xEo]="{"+Ya.join(", ")+"}",Eb[Ka.a.nYl]="{"+ab.join(", ")+"}",Eb[Ka.a.sEo]=ma.c(mc));this.j$.KNa(y.a.ZCj,Eb,this.Rda)}}Gdm(ra,Ya){if(4===ra)return Za.DLn;switch(Ya){case 5:case 16:case 17:case 18:return"Command";
case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return F.a[Ya]}wzn(ra,Ya,ab,cb,Eb){const mc=this.naa(y.a.click);mc[Ka.a.f3j]=ra;mc[Ka.a.j6n]=Ya;mc[Ka.a.commandId]=ab;mc[Ka.a.v6]=cb;mc[Ka.a.actionType]=this.Gdm(Eb.groupType,Eb.resultType);mc[Ka.a.resultType]=F.a[Eb.resultType];mc[Ka.a.ZEg]=bb[Eb.ZEg];mc[Ka.a.groupType]=W.a[Eb.groupType];mc[Ka.a.Raa]=Eb.Raa.toString();mc[Ka.a.exf]=Eb.exf.toString();mc[Ka.a.resultIndex]=Eb.resultIndex.toString();this.j$.KNa(y.a.click,
mc,this.Rda)}Czn(ra,Ya){this.pSa.$sa||(this.pSa.$sa=sb.a.create().toString(),this.v8i("",!1,Ya));Ya=this.naa(y.a.f6h);Ya[Ka.a.WXb]=ra;this.j$.JNa(y.a.f6h,Ya)}P8i(ra,Ya,ab){if(ra){if(ab)for(const cb in ab)ra[cb]=ab[cb];this.j$.JNa(y.a.events,ra,Ya)}}BI(ra,Ya,ab=null){const cb=this.naa(y.a.events);cb[Ka.a.event]=ra;this.P8i(cb,Math.round(Ya),ab)}Sta(ra,Ya,ab=null){const cb=this.naa(y.a.events);cb[Ka.a.event]=y.a.error;cb[Ka.a.module]=ra;cb[Ka.a.errorMessage]=Ya;cb[Ka.a.message]=Ya;this.P8i(cb,Math.round(window.performance.now()),
ab)}uzn(ra){const Ya=this.naa(y.a.Z2h);Ya[Ka.a.value]=ra;Ya[Ka.a.mse]=this.Sib;this.j$.KNa(y.a.Z2h,Ya,this.Rda)}Nyn(ra){const Ya=this.naa(y.a.FKh);Ya[Ka.a.value]=ra;Ya[Ka.a.mse]=this.Sib;this.j$.KNa(y.a.FKh,Ya,this.Rda)}oAn(ra){const Ya=this.naa(y.a.umi);Ya[Ka.a.value]=ra;Ya[Ka.a.mse]=this.Sib;this.j$.KNa(y.a.umi,Ya,this.Rda)}dCn(ra){const Ya=this.naa(y.a.Vuj);Ya[Ka.a.value]=ra;Ya[Ka.a.mse]=this.Sib;this.j$.KNa(y.a.Vuj,Ya,this.Rda)}azn(ra){const Ya=this.naa(y.a.xKj);Ya[Ka.a.value]=ra;this.j$.KNa(y.a.xKj,
Ya,this.Rda)}hCn(ra,Ya){const ab=this.naa(y.a.yvj);ab[Ka.a.Ttc]=ra;Ya&&(ab[Ka.a.$sa]=Ya);this.j$.JNa(y.a.yvj,ab)}naa(ra){return{["SessionID"]:this.pSa.sessionId,["CorrelationID"]:this.pSa.$sa,["Time"]:(new Date).getTime(),["Event"]:ra,["Scenario"]:this.Rda}}}Object(J.a)(Ab,"UsageLogger",null,[1912]);var nc=d(80),qc=d(1674),Jc=d(1151),ad=d(1439),Kc=d(92),Jb=d(71),Zb=d(1150),xb=d(593),$b=d(18),Xb=d(750),Lb=d(89),gc=d(13);d.d(L,"TellMeActor",function(){return qa});class qa{constructor(){this.I3a=this.F5=
this.Yb=this.Ga=this.FS=this.pu=this.Gb=this.ga=this.Xe=this.KM=this.A_e=this.SJh=this.Spa=this.kc=null;this.b8b=!1;this.pMe=[];this.xah=[];this.AIh=[];this.$th=[];this.auh=[];this.Woh=!1;this.Q4b=this.lja=null;this.ZIc=this.P2a=!1;this.yGd=!0;this.R1=this.YHc=this.Rih=this.P_e=this.Mth=null;this.U0=[];this.lhb=this.z5b=this.CFa=this.xJd=this.$Dh=null;this.q7b=!1;this.I_e=0;this.n4b=null;this.Vxa=-1;this.sth=0;this.gJc=!1;this.Ohb=null;this.vIh=!1;this.p4b=this.xr=null;this.RZd=(ra,Ya,ab,cb,Eb)=>
{if(Ya.contextId===Lb.a.frame)switch(ra){case gc.a.ou:return this.ou(ra,Ya,ab,cb,Eb);case gc.a.OGg:return this.qXh(ra,Ya,ab,cb,Eb);case gc.a.TGg:return this.g9i(ra,Ya,ab,cb,Eb);case gc.a.WGg:return this.G8i(ra,Ya,ab,cb,Eb);case gc.a.VGg:return this.c9i(ra,Ya,ab,cb,Eb);case gc.a.RGg:return this.x$a(ra,Ya,ab,cb,Eb);case gc.a.YGg:return this.eEo(ab);case gc.a.UGg:return this.b9i(ra,Ya,ab,cb,Eb);case gc.a.XGg:return this.F8i(ra,Ya,ab,cb,Eb);case gc.a.yqd:return this.uoi(ra,Ya,ab,cb,Eb);case gc.a.NGg:return this.V4h(ra,
Ya,ab,cb,Eb);case gc.a.ZGg:case gc.a.L2f:return this.$Uf(ra,Ya,ab,cb,Eb);case gc.a.ZBf:case gc.a.$Bf:case gc.a.aCf:case gc.a.bCf:case gc.a.cCf:case gc.a.Hgg:case gc.a.Igg:case gc.a.Jgg:case gc.a.$Gg:return this.GYa(ra,Ya,ab,cb,Eb);case gc.a.hjg:case gc.a.ijg:case gc.a.jjg:return this.s$a(ra,Ya,ab,cb,Eb);case gc.a.QGg:return this.Tnj(ra,Ya,ab,cb,Eb);case gc.a.Uff:case gc.a.Vff:case gc.a.Wff:return this.qge(ra,Ya,ab,cb,Eb);case gc.a.s0b:return this.s0b(ra,Ya,ab,cb,Eb);case gc.a.f2f:return this.x4i(ra,
Ya,ab,cb,Eb);case gc.a.jog:return this.Zvj(ra,Ya,ab,cb,Eb);case gc.a.aFf:return this.Nqi(ra,Ya,ab,cb,Eb)}return 2};this.Zvj=(ra,Ya,ab,cb,Eb)=>{if(1===ab)return 32;if(U.c(Eb))return this.Xe.onError("TellMeActor:QuickActionOnFileHandler","actiondata comes null"),16;this.Yb.wDf();if(ra=Eb.TerminalParentControlId){ra=this.p4b.K(ra);if(!ra)return 16;Ya=[];Array.add(Ya,ra);if(!this.M4i(Ya))return 8}return 32};this.Nqi=()=>{if(!this.p4b.count)return 16;const ra=[];for(const Ya of this.p4b.values)Array.add(ra,
Ya);return this.M4i(ra)?32:8};this.s$a=(ra,Ya,ab,cb,Eb)=>{if(1===ab)return 32;if(U.c(Eb))return this.Xe.onError("TellMeActor:InsertMention","actiondata comes null"),16;ra=Eb.UILocation;let mc;Eb=Eb.CommandValueId;try{mc=ma.a(Eb)}catch(tb){return this.Xe.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),16}return U.c(mc)?(this.Xe.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):U.c(this.YHc)?(this.Xe.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),
16):19!==ra?(this.Xe.onError("TellMeActor:InsertMention","location "+ra+" is unexpected"),16):this.YHc.s$a(mc.displayName,mc.email,mc.userId)?32:(this.Xe.onError("TellMeActor:InsertMention","mention is not inserted"),16)};this.GYa=(ra,Ya,ab,cb,Eb)=>1===ab?32:U.c(Eb)?(this.Xe.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===Eb.UILocation?this.X8m(ab,Eb):this.usc(ra,Ya,ab,cb,Eb);this.Tnj=(ra,Ya,ab,cb,Eb)=>{if(1===ab)return 32;if(U.c(Eb))return this.Xe.onError("TellMeActor:OpenFeedback",
"actiondata comes null"),16;this.xr&&window.setTimeout(()=>{this.xr.execute(mc=>{mc.ieb("TellMeSurvey",null)})},qa.K3l);return 32};this.QCa=(ra,Ya,ab,cb,Eb)=>{ab=window.performance.now();this.g$n(Ya);this.Xe.jSo(Ya);this.kc.As?(this.lhb=this.A_e.Rcm(Ya,ra,Eb),this.kc.hBa?(this.U0.push(appChrome.actions.updateTellMeSearchResults(this.lhb.menuModel,ra,Eb)),appChrome.api.dispatch(this.U0)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.lhb.menuModel,ra,Eb)),this.kc.IEe&&this.q7b&&
(U.c(this.R1)||this.R1.Location!==Ba.a.contextMenu)&&(this.KM.mark(2),this.KM.measure(0,1,2))):this.CFa=this.SJh.Scm(Ya,this.Xe.Lua);this.n4b&&this.Gb.Zb(this.n4b);Eb={};Eb.GroupsCount=Ya.length;Eb.QueryID=cb;Eb.QueryLength=ra.length;this.Xe.$B(y.a.fHl,window.performance.now()-ab,Eb)};this.x4i=(ra,Ya,ab,cb,Eb)=>{if(1===ab)return 32;if(U.c(Eb))return this.Xe.onError("TellMeActor:LaunchAddinStore","actiondata comes null"),16;if(this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",
!1)){ra={};ra.SourceControlId=Eb.SourceControlId;ra.Query=Eb.CommandValueId;Eb=this.ga.Pb(gc.a.sad,2,ra);if(32!==Eb)this.Xe.onError("TellMeActor:LaunchAddinStore","CommonCommands.LaunchAppforOfficeDialog failed. Response: "+Eb+".");return Eb}return this.ga.Pb(gc.a.sad,2,Eb)};this.qge=(ra,Ya,ab,cb,Eb)=>{({AddinResultsProvider:ra}=d(1614));if(1===ab)return 32;if(U.c(Eb))return this.Xe.onError("TellMeActor:LaunchAddin","actiondata comes null"),16;ab=Eb.CommandValueId;if(U.b(ab))return this.Xe.onError("TellMeActor:LaunchAddin",
"Add-in assetId is null"),16;if(!ra.WJb[ab])return this.Xe.onError("TellMeActor:LaunchAddin","Add-in with assetId "+ab+" doesn't not exist in entitlements"),16;Eb=d(1614).AddinResultsProvider.WJb[ab];ra={};ra.solutionId=Eb.id;ra.version=Eb.appVersion;ra.storeType=Eb.storeType;ra.storeId=Eb.storeId;ra.assetId=Eb.assetId;ra.assetStoreId=Eb.assetStoreId;ra.displayName=Eb.displayName;ra.targetType=Eb.targetType;ra.height=Eb.height;ra.width=Eb.width;Eb=this.ga.Pb(gc.a.LUf,2,ra);if(32!==Eb)this.Xe.onError("TellMeActor:LaunchAddin",
"CommonCommands.InsertOfficeAddin failed. Response: "+Eb+". AssetId: "+ab);return Eb};this.s0b=()=>{if(!U.c(this.xr))for(const ra of z.a.instance.Spb()){if("ShowContextMenuWithFloatie"===ra.commandId)return this.xr.execute(Ya=>{Ya.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(ra.commandId&&-1===ra.commandId.indexOf("Tab"))break}return 8}}get xYd(){return this.FS?this.FS.contentType:qa.unknown}get actions(){return this.U0}set actions(ra){this.U0=ra}D8d(){return this.Xe?this.Xe.Lua.$sa:
null}rR(){return this.kc}get oKn(){return this.yGd}get tCp(){return this.Mth}performance(){return this.KM}get VCg(){return this.$Dh}set VCg(ra){this.$Dh=ra}get btd(){return this.vIh}set btd(ra){this.vIh=ra}eJ(ra){const Ya=window.performance.now();this.lja&&!U.c(ra)&&(this.lja(ra),this.Xe.$B(y.a.eJ,window.performance.now()-Ya))}initialize(ra,Ya=null,ab=null,cb=null,Eb=null,mc=null,tb=null,Xa=null,Mb=null,cc=null,oc=null){const {InteractionLogger:Pc}=d(1989),{GroupsPlacementInfo:vb}=d(1987),{AggregatorResultsProvider:jd}=
d(1759);this.kc=ra;this.P2a=!!P.AFrameworkApplication.ua&&P.AFrameworkApplication.ua.Ib.yoc;this.Xe=cb;if(!cb){cb=new E;cb.sessionId=P.AFrameworkApplication.userSessionId;const ud=Xb.a.Hg(P.AFrameworkApplication.lcid)||Xb.a.B7c;this.Xe=new Pc(new Ab(this.kc.application,ud.name,cb,this.kc.As,this.P2a,ra.T_a,null),this.kc.Byl,this.kc)}this.I3a=new R(this.kc.parameterData);this.SJh=ab||new Va(this.kc,this.I3a);this.lja=tb;this.A_e=this.A_e||new la(this.kc,this.kc.parameterData,tb);this.Yb=nc.FocusManager.instance();
this.F5=G.createInstance(this.kc);this.Rih=new vb(ra);this.ga=Eb||P.AFrameworkApplication.va;this.Gb=mc||P.AFrameworkApplication.oc;this.pu=Mb;this.Spa=Ya;this.xr=oc;this.KM=new Ha;this.p4b=new m.a(f.a.th());this.xJd=[];Mb?Mb.execute(ud=>{ud.isFeatureEnabled(qa.pfp,!0).then(qe=>{const {AggregatorResultsProvider:Ae}=d(1759);this.gJc=qe;this.Spa=this.Spa||Ae.createInstance(this.F5,this.kc,this.I3a,this.gJc);for(const hf of this.xJd)this.Spa.DG(hf.provider,hf.hfb);this.xJd=[];return null})}):(this.gJc=
!0,this.Spa=this.Spa||jd.createInstance(this.F5,this.kc,this.I3a,this.gJc));this.Ga=Xa;this.CFa=Va.Y_d;this.Mth=new Promise(ud=>{this.P_e=ud});cc&&cc.execute(ud=>{this.FS=ud})}Xb(){this.FXk()}xro(ra){this.YHc=ra}FXk(){this.ga.fb(gc.a.ou,Lb.a.frame,Object(a.a)(this,this.ou,"tellMe"),96);this.ga.fb(gc.a.OGg,Lb.a.frame,Object(a.a)(this,this.qXh,"cacheAsyncMenuRefreshFunction"),96);this.ga.fb(gc.a.TGg,Lb.a.frame,Object(a.a)(this,this.g9i,"logItemExecuted"),96);this.ga.fb(gc.a.WGg,Lb.a.frame,Object(a.a)(this,
this.G8i,"logControlDeactivation"),96);this.ga.fb(gc.a.VGg,Lb.a.frame,Object(a.a)(this,this.c9i,"logInputFocus"),96);this.ga.fb(gc.a.RGg,Lb.a.frame,Object(a.a)(this,this.x$a,"interactionBegin"),96);this.ga.fb(gc.a.YGg,Lb.a.frame,Object(a.a)(this,this.x$a,"interactionBegin"),96);this.ga.fb(gc.a.UGg,Lb.a.frame,Object(a.a)(this,this.b9i,"logInputBlur"),96);this.ga.fb(gc.a.XGg,Lb.a.frame,Object(a.a)(this,this.F8i,"logControlActivated"),96);this.ga.fb(gc.a.yqd,Lb.a.frame,Object(a.a)(this,this.uoi,"focusSearchBox"),
96);this.ga.fb(gc.a.NGg,Lb.a.frame,Object(a.a)(this,this.V4h,"constructLiveNotificationForMenu"),96);this.ga.fb(gc.a.ZGg,Lb.a.frame,Object(a.a)(this,this.$Uf,"insertTryQuery"),96);this.ga.fb(gc.a.L2f,Lb.a.frame,Object(a.a)(this,this.$Uf,"insertTryQuery"),96);this.ga.fb(gc.a.ZBf,Lb.a.frame,this.GYa,96);this.ga.fb(gc.a.$Bf,Lb.a.frame,this.GYa,96);this.ga.fb(gc.a.aCf,Lb.a.frame,this.GYa,96);this.ga.fb(gc.a.bCf,Lb.a.frame,this.GYa,96);this.ga.fb(gc.a.cCf,Lb.a.frame,this.GYa,96);this.ga.fb(gc.a.Hgg,Lb.a.frame,
this.GYa,96);this.ga.fb(gc.a.Igg,Lb.a.frame,this.GYa,96);this.ga.fb(gc.a.Jgg,Lb.a.frame,this.GYa,96);this.ga.fb(gc.a.hjg,Lb.a.frame,this.s$a,96);this.ga.fb(gc.a.ijg,Lb.a.frame,this.s$a,96);this.ga.fb(gc.a.jjg,Lb.a.frame,this.s$a,96);this.ga.fb(gc.a.QGg,Lb.a.frame,this.Tnj,96);this.ga.fb(gc.a.$Gg,Lb.a.frame,this.GYa,96);this.ga.fb(gc.a.Uff,Lb.a.frame,this.qge,96);this.ga.fb(gc.a.Vff,Lb.a.frame,this.qge,96);this.ga.fb(gc.a.Wff,Lb.a.frame,this.qge,96);this.ga.fb(gc.a.s0b,Lb.a.frame,this.s0b,96);this.ga.fb(gc.a.f2f,
Lb.a.frame,this.x4i,96);this.ga.fb(gc.a.jog,Lb.a.frame,this.Zvj,96);this.ga.fb(gc.a.aFf,Lb.a.frame,this.Nqi,96)}mpo(ra){this.yGd=!1;const Ya=window.performance.now();ra.Vab.isCompleted?(this.yGd=!0,this.P_e(!0)):ra.a2(()=>{this.yGd=!0;this.P_e(!0);this.Xe.$B(y.a.OOl,window.performance.now()-Ya)});this.eqo(ra)}eqo(ra){xb.a.Cse(this.RZd);xb.a.GZc([new Zb.a(gc.a.ou,Lb.a.frame,96),new Zb.a(gc.a.OGg,Lb.a.frame,96),new Zb.a(gc.a.TGg,Lb.a.frame,96),new Zb.a(gc.a.WGg,Lb.a.frame,96),new Zb.a(gc.a.VGg,Lb.a.frame,
96),new Zb.a(gc.a.RGg,Lb.a.frame,96),new Zb.a(gc.a.YGg,Lb.a.frame,96),new Zb.a(gc.a.UGg,Lb.a.frame,96),new Zb.a(gc.a.XGg,Lb.a.frame,96),new Zb.a(gc.a.yqd,Lb.a.frame,96),new Zb.a(gc.a.NGg,Lb.a.frame,96),new Zb.a(gc.a.ZGg,Lb.a.frame,96),new Zb.a(gc.a.L2f,Lb.a.frame,96),new Zb.a(gc.a.ZBf,Lb.a.frame,96),new Zb.a(gc.a.$Bf,Lb.a.frame,96),new Zb.a(gc.a.aCf,Lb.a.frame,96),new Zb.a(gc.a.bCf,Lb.a.frame,96),new Zb.a(gc.a.cCf,Lb.a.frame,96),new Zb.a(gc.a.Hgg,Lb.a.frame,96),new Zb.a(gc.a.Igg,Lb.a.frame,96),new Zb.a(gc.a.Jgg,
Lb.a.frame,96),new Zb.a(gc.a.hjg,Lb.a.frame,96),new Zb.a(gc.a.ijg,Lb.a.frame,96),new Zb.a(gc.a.jjg,Lb.a.frame,96),new Zb.a(gc.a.QGg,Lb.a.frame,96),new Zb.a(gc.a.$Gg,Lb.a.frame,96),new Zb.a(gc.a.Uff,Lb.a.frame,96),new Zb.a(gc.a.Vff,Lb.a.frame,96),new Zb.a(gc.a.Wff,Lb.a.frame,96),new Zb.a(gc.a.s0b,Lb.a.frame,96),new Zb.a(gc.a.f2f,Lb.a.frame,96),new Zb.a(gc.a.jog,Lb.a.frame,96),new Zb.a(gc.a.aFf,Lb.a.frame,96)],ra)}uoi(ra,Ya,ab){if(1===ab)return 32;this.jOj();ra=!1;(this.kc.T_a||this.P2a)&&(Ya=document.getElementById("SearchButton"))&&
Ya.click();if(!this.kc.T_a&&this.P2a)for(Ya=document.getElementsByClassName("ms-suiteux-search-box"),ab=0;ab<Ya.length;ab++){const cb=Ya[ab].querySelector("input[type=search]");cb&&(ra=nc.FocusManager.ON(cb))}else ra=nc.FocusManager.ON($get(this.kc.As?x.a.eDg:x.a.rBe));this.ZIc=!0;return ra?32:8}$Uf(ra,Ya,ab,cb,Eb){if(1===ab)return 32;if(U.c(Eb))return this.Xe.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.jOj();ra=Eb.CommandValueId;Ya=this.kc.As?x.a.eDg:x.a.rBe;this.kc.As&&
!U.c(Eb[Jc.a.t_a])&&(Eb[Jc.a.t_a]=!1);if(ra){if(this.kc.As)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(ra)),this.Ohb=[19],32;if(Eb=$get(Ya))Eb.value=ra}return nc.FocusManager.ON($get(Ya))?32:8}jOj(){this.Yb.HN(this.kc.T_a||this.P2a?this.kc.XQb:this.kc.ndb,!1)}xdm(ra,Ya){switch(ra){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,Ya);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,Ya);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,
Ya);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,Ya)}return Ya}V4h(ra,Ya,ab,cb,Eb){if(1===ab)return 32;if(U.c(Eb))return this.Xe.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;ra=this.CFa?this.CFa.qFj:0;Eb.Value=1!==ra?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,ra):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.CFa)for(const mc of this.CFa.pTl)Eb=Object(l.a)(T.a,
mc)?mc.id:ka.a.replaceAll(mc.value,'"',""),(Eb=$get(Eb+"-"+C.a.PGg))&&Jb.a.Gs(Eb,Jb.a.Aja,ka.a.Jf(this.xdm(mc.groupType,Eb.innerText)));return 32}qXh(ra,Ya,ab,cb,Eb){if(1===ab)return 32;if(U.c(Eb))return this.Xe.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.n4b=new Kc.a(2,1,0,()=>{Eb[qc.a.Callback]()},97);this.CFa&&this.Gb.Zb(this.n4b);return 32}g9i(ra,Ya,ab,cb,Eb){if(1===ab)return 32;if(U.c(Eb))return this.Xe.onError("TellMeActor:LogItemExecuted","actiondata comes null"),
16;Eb.CloseAllMenus&&(ra=void 0===Eb.ParentControlId||null===Eb.ParentControlId?"<NA>":Eb.ParentControlId,Ya=this.Q4b?this.Q4b[Eb.ControlId]:null,!Ya&&this.Q4b&&"<NA>"!==ra&&(Ya=this.Q4b[ra]),Ya||(Ya=this.b8b&&this.F5.xdn(Eb),Ya=this.iQl(Ya,Eb.ControlId),Ya=new u(Ya,32,4,-1,-1,-1),this.Xe.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+Eb.ControlId+" determined group:"+W.a[Ya.groupType])),this.Xe.fTn(Eb.ControlId,ra,Eb.CommandId,Eb.CloseAllMenus,Ya),this.I3a.gPn(Eb.ControlId),Eb.Location!==
Ba.a.contextMenu&&(this.F5.w5a(Eb),this.F5.DG(Ya.resultType),this.kc.mye&&this.Spa.tVk(Eb.CommandId)));return 32}G8i(ra,Ya,ab,cb,Eb){if(1===ab)return 32;(new Ea(this.D8d())).NEm(this.z5b);ra=this.z5b;Ya=this.Vxa;ab=this.Xe.wyd;if(U.c(Eb))return this.Xe.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;Eb=Eb.UILocation;ra&&0<ra.length&&this.gJc&&C.a.TAg(this.kc)&&this.kc.ofe&&19!==Eb&&Ya>ab&&!this.kc.mS&&(this.Xe.B5f(ra),this.Xe.dyg(Ya));this.Xe.RCo();this.kc.IEe&&19!==Eb&&(this.KM.mark(3),
this.KM.measure(1,0,3),this.KM.measure(2,2,3),this.KM.p5f(0,1,2),this.KM.p5f(2,2,3),this.KM.p5f(1,0,3),this.KM.zpl(),this.KM.clearMeasures([0,2,1]));this.Xe.ITn(window.performance.now()-this.I_e);this.kc.As&&(this.lhb=null,this.Xe.KCa());this.ZIc=this.q7b=!1;this.z5b="";return 32}c9i(ra,Ya,ab){if(1===ab)return 32;this.Xe.tvb(v(Ya),this.ZIc);return 32}b9i(ra,Ya,ab){if(1===ab)return 32;this.Xe.KCa();this.q7b=!1;return 32}F8i(ra,Ya,ab,cb,Eb){if(1===ab)return 32;this.R1=null;Eb&&(this.R1=Eb);this.kc.IEe&&
(U.c(this.R1)||this.R1.Location!==Ba.a.contextMenu)&&this.KM.mark(0);this.Xe.jxe(U.c(this.R1)||U.c(this.R1.Location)?Ba.a.unknown:this.R1.Location);this.Xe.HTn(this.sth,this.ZIc);this.q7b||this.Sbb();return 32}B8h(ra,Ya){const ab=[],cb=Date.now();for(const Eb of ra)ra=(cb-Eb.timeStamp)/1E3,ra=C.a.NCe(ra),Array.add(ab,new N(Ya?Eb.commandId:Eb.controlId,ra));return ab}mJl(ra){const Ya=[],ab=Date.now();for(const cb of ra)if(cb.controlId||"keyboardShortcut"===cb.commandSurface)ra=(ab-cb.timeStamp)/1E3,
ra=C.a.NCe(ra),Array.add(Ya,new X(cb.controlId,cb.commandId,ra,cb.commandSurface,cb.vBe));return Ya}p9h(ra=!1){var Ya=ra?this.F5.HEm():this.F5.Q1c();ra=[];const ab=Date.now();for(const cb of Ya)Ya=(ab-cb.TimeStamp)/1E3,Ya=C.a.NCe(Ya),Array.add(ra,new N(cb.Id,Ya));return ra}Sbb(){if(!this.q7b){this.b8b=this.q7b=!0;if(!this.Woh){this.Woh=!0;const ra={};ra.IsMLREnabled=this.kc.Tjn;ra.IsReactRibbonEnabled=this.kc.As;ra.IsSharedHeaderEnabled=!!P.AFrameworkApplication.ua&&P.AFrameworkApplication.ua.Ib.vN;
ra.IsSearchUxEnabled=this.P2a;ra.IsTellMeInHeaderEnabled=this.kc.T_a;ra.IsGoLocalEnv=C.a.Wgn();ra.IsSovereignEnvironment=C.a.Doc();ra.IsTellMeServiceResultsEnabled=C.a.TAg(this.kc);ra.IsSubstrateProviderEnabled=C.a.SAg(this.kc);ra.ShouldFetchTokens=!!P.AFrameworkApplication.ua&&P.AFrameworkApplication.ua.Ib.a0b;ra.IsSerpletEnabled=C.a.yta();ra.FirstOnClickTimeInMS=Math.round(window.performance.now());ra.IsHeaderHidden=P.AFrameworkApplication.hideHeader||P.AFrameworkApplication.I_;ra.IsSearchInHeaderHidden=
P.AFrameworkApplication.A5c;void 0!==window.performance.timing&&null!==window.performance.timing&&(ra.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));ra.IsFindWithMatchesEnabled=this.kc.j2d;ra.HelpShowsTopSearchResult=this.kc.nod;ra.HelpShowsNumberOfMatches=this.kc.lod;P.AFrameworkApplication.J&&(ra.UiHost=P.AFrameworkApplication.J.ib("UiHostIntegrationType"));this.Xe.zCn(JSON.stringify(ra))}this.pMe=this.B8h(z.a.instance.G1c(),!1);this.xah=this.B8h(z.a.instance.Spb(),
!0);this.AIh=this.mJl(z.a.instance.Spb());this.$th=this.p9h();this.auh=this.p9h(!0);this.Xe.Sbb()}}x$a(ra,Ya,ab,cb,Eb){if(1===ab)return 32;if(U.c(Eb))return this.Xe.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if($b.a.T8c)return 32;this.I_e=window.performance.now();this.Sbb();ra=new ba(this.QCa,0);this.Vxa++;this.Xe.beginQuery("",this.Vxa,this.b8b);this.SKg(!0,null);this.CFa=Va.Y_d;this.lhb=la.hzf;if(this.Spa)qa.instance.actions=[],this.Spa.WJ(new Z("",this.Vxa),ra,this.kc.As);
else this.Xe.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.n4b&&this.Gb.Zb(this.n4b);return 32}eEo(ra){if(1===ra)return 32;this.Yb.$U(this.kc.T_a||this.P2a?this.kc.XQb:this.kc.ndb,!1);return 32}ou(ra,Ya,ab,cb,Eb){if(1===ab)return 32;if(U.c(Eb))return this.Xe.onError("TellMeActor:TellMe","actiondata comes null"),16;this.R1=Eb;this.Xe.jxe(U.c(this.R1.Location)?Ba.a.unknown:this.R1.Location);ra=this.R1.Value;this.kc.As||ra&&""!==ra.trim()?(!this.lhb&&this.kc.As&&
(this.Xe.tvb(v(Ya),this.ZIc),this.Sbb()),this.z1l(ra,this.R1.Location),this.R1.PopulationXML=this.CFa.xml):this.b8b?this.R1.PopulationXML=this.CFa.xml:(this.R1.PopulationXML=Va.Y_d.xml,this.lhb=la.hzf,this.z5b="");return 32}z1l(ra,Ya){this.I_e=window.performance.now();this.kc.IEe&&Ya!==Ba.a.contextMenu&&this.KM.mark(1);this.kc.As&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(ra));ra&&0<ra.trim().length&&(this.b8b=!1);this.kc.P_l();Ya=U.c(Ya)?Ba.a.ou:Ya;if(ra!==this.z5b||this.kc.As){this.Vxa++;
this.Xe.beginQuery(ra,this.Vxa,this.b8b);this.SKg(!0,null);const ab=new Z(ra,this.Vxa),cb=new ba(this.QCa,this.Vxa);this.CFa=Va.Y_d;this.lhb=la.hzf;if(this.Spa)qa.instance.actions=[],this.Spa.WJ(ab,cb,this.kc.As,Ya,this.Ohb),this.Ohb=null;else this.Xe.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.sth=this.Vxa;this.z5b=ra}}mup(ra){if(this.kc.As){var Ya=appChrome.selectors.getActiveControlStates();if(Ya=Object(w.a)(Object,Ya[ra.value])){ra.label=Ya.label;let ab=
null;"description"in Ya&&(ab=Ya.description);ab&&Object.getType(ab)===String?ra.description=ab:"secondaryText"in Ya?ra.description=Ya.secondaryText:"fullDescriptionLabel"in Ya&&(ra.description=Ya.fullDescriptionLabel)}}}g$n(ra){this.Q4b={};let Ya=0,ab=0;for(const cb of ra){ra=0;for(const Eb of cb.results)this.Q4b[Eb.value]=new u(Eb.groupType,Eb.type,Eb.subType,Ya,ra,ab),ra++,ab++,Eb.label||5!==Eb.type||this.mup(Eb);0<ra&&Ya++}}usc(ra,Ya,ab,cb,Eb){if(1===ab)return 32;if(U.c(Eb))return this.Xe.onError("TellMeActor:OpenUrlInNewTab",
"actiondata comes null"),16;(ra=Eb.CommandValueId)&&window.open(ra,"_blank");return 32}M4i(ra){const Ya={};Ya.token=this.VCg;Ya.files=ma.c(ra);Ya.type="MultiFilesDeckGeneration";if(P.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFastCards",!1))return this.ga.Pb(gc.a.wun,2,Ya),!0;ra=C.a.JFi("",C.a.sFj("GenerateDeckFromFile"),Object.assign(new ad.a,{landingTab:"All",data:Ya}));ra=this.ga.Pb(gc.a.Yaa,2,ra);return 32!==ra?(this.Xe.onError("LaunchSmartLookupWithFilesData",
"CommonCommands.InvokeSerplet failed. Response: "+ra+"."),!1):!0}X8m(ra,Ya){if(1===ra)return 32;if(U.c(Ya))return this.Xe.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(U.c(this.YHc))return this.Xe.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;ra=Ya.CommandValueId;return U.c(ra)?(this.Xe.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.YHc.insertHtmlText(ra)?32:(this.Xe.onError("TellMeActor:InsertUrl","url is not inserted"),16)}iQl(ra,
Ya){return Ya.startsWith(this.kc.As?C.a.BJg:C.a.aDe)?5:ra?4:"bSearchHelp"===Ya||Ya.startsWith("GetHelpFromTellMe")?8:"bInsights"===Ya||Ya.startsWith("SmartLookupFromTellMe")?13:"ActionAIFromTellMe"===Ya?24:Ya===this.kc.pCf?2:0}DG(ra,Ya){this.Spa?this.Spa.DG(ra,Ya):Array.add(this.xJd,new H(ra,Ya))}SKg(ra,Ya="",ab=null){ra?this.p4b=new m.a(f.a.th()):Ya&&ab&&this.p4b.add(Ya,ab)}static get instance(){return qa._instance||(qa._instance=new qa)}}qa._instance=null;qa.pfp="mso_tellMeService";qa.unknown="Unknown";
qa.K3l=500;Object(J.a)(qa,"TellMeActor",null,[])},1375:function(J,L,d){d.d(L,"a",function(){return f});J=d(0);var m=d(1395);class f{constructor(a,l){this.Tib=!1;const {Annotations:w}=d(1367);if(!a)throw Error.argumentNull("annotations");if(!a.O0f(l))throw Error.argument("memberTypeID","Invalid type ID");if(w.kK(l))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.Cx=a;this.CCk=l;this.aq=[]}get Fcc(){return this.Cx}get isReadOnly(){return this.Tib}get M7(){return this.CCk}get items(){return this.aq}Qha(){const {Annotations:a}=
d(1367);let l="[";for(let w=0,z=this.items.length;w<z;++w){0<w&&(l+=", ");const x=this.Cx.Qha(this.M7,this.items[w]);this.M7===a.Ica?(l+='"',l+=m.a.DAf(x),l+='"'):l+=x}return l+"]"}isEqual(a){const {Annotations:l}=d(1367);if(this===a)return!0;if(!a||a.Fcc!==this.Cx||a.M7!==this.M7||a.items.length!==this.items.length)return!1;for(let w=0;w<this.items.length;++w)if(!l.oAb(this.M7,this.items[w],a.items[w]))return!1;return!0}clone(){const a=new f(this.Cx,this.M7);Array.addRange(a.items,this.items);return a}AW(){return this.isReadOnly?
this.clone():this}O4f(){const {Annotations:a}=d(1367);if(!this.isReadOnly){this.Tib=!0;for(const l of this.items)a.yUb(l)}}toString(){return this.Qha()}}Object(J.a)(f,"ListValue",null,[2038,2037])},1377:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m{}m.ou="TellMe";m.contextMenu="ContextMenu";m.unknown="Unknown";Object(J.a)(m,"TellMeScenario",null,[])},1379:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m{constructor(f,a,l=null,w=null,z=4,x=-99999,u=0){this.QK="";this.nRd=
-1;this.value=f;this.type=a;this.subType=z;this.label=this.tE=l;this.groupType=30;this.description=w;this.score=x;this.count=u}}Object(J.a)(m,"ResultBinding",null,[])},1381:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m{constructor(f){this.attributes=null;this.query=f;this.Wo=[]}dw(f){this.Wo.push(f)}nBj(f){const a=[];for(const l of this.Wo)l.groupType!==f&&a.push(l);this.Wo.length!==a.length&&(this.Wo=a)}get hoc(){return!1}}Object(J.a)(m,"SimpleResultsUpdatedEventArgs",null,[1898])},
1382:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m{constructor(f=30,a=""){this.rO=[];this.groupType=f;this.displayName=a}get results(){return this.rO}Xx(f){f.groupType=this.groupType;Array.add(this.results,f)}rrg(f=1){if(this.results.length>=f)for(let a=0;a<f;a++)Array.removeAt(this.results,this.results.length-1)}}Object(J.a)(m,"SimpleResultGroup",null,[1899])},1395:function(J,L,d){J=d(0);class m{constructor(a,l){this.kmb=a;this.value=l}}Object(J.a)(m,"AttrValuePair",null,[]);d.d(L,
"a",function(){return f});class f{constructor(a){this.Tib=!1;if(!a)throw Error.argumentNull("annotations");this.Cx=a;this.k0=[]}get Fcc(){return this.Cx}get isReadOnly(){return this.Tib}get UQf(){return 0<this.k0.length}mr(a){if(!this.Cx.Qoc(a))throw Error.argument("attributeID","Invalid attribute ID");for(const l of this.k0)if(a===l.kmb)return a=l.value,{returnValue:!0,value:a};return{returnValue:!1,value:null}}dA(a,l){var {Annotations:w}=d(1367);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");
if(!this.Cx.Qoc(a))throw Error.argument("attributeID","Invalid attribute ID");if(!this.Cx.Qnc(this.Cx.getAttributeType(a),l))throw Error.argument("value","Value is not of the correct type for the specified attribute");w.yUb(l);for(w=0;w<this.k0.length;++w){const z=this.k0[w];if(a===z.kmb){z.value=l;return}}Array.add(this.k0,new m(a,l))}CZa(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.Cx.Qoc(a))throw Error.argument("attributeID",
"Invalid attribute ID");for(let l=0;l<this.k0.length;++l)if(a===this.k0[l].kmb){Array.removeAt(this.k0,l);break}}k3d(a){if(!a)throw Error.argumentNull("action");for(const l of this.k0)a(l.kmb,l.value)}clone(){const a=new f(this.Cx);a.T6a(this);return a}T6a(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!a)throw Error.argumentNull("other");if(a.Fcc!==this.Cx)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.k0);
a.k3d((l,w)=>{this.dA(l,w)})}Qha(){const {Annotations:a}=d(1367);let l="[",w=!0;for(const z of this.k0){w?w=!1:l+=", ";l+=this.Cx.dsi(z.kmb);l+="=";const x=this.Cx.getAttributeType(z.kmb),u=this.Cx.Qha(x,z.value);x===a.Ica?(l+='"',l+=f.DAf(u),l+='"'):l+=u}return l+"]"}isEqual(a){const {Annotations:l}=d(1367);if(!a)throw Error.argumentNull("other");if(this===a)return!0;if(!a||this.Cx!==a.Fcc||this.UQf!==a.UQf)return!1;let w=0,z=null,x=!1;a.k3d((u,v)=>{++w;if(!x){var E=-1;for(let y=0,H=this.k0.length;y<
H;++y)if(this.k0[y].kmb===u){E=y;break}0>E?x=!0:(z||(z=Array(this.k0.length)),z[E]=v)}});if(this.k0.length!==w||x)return!1;for(let u=0,v=this.k0.length;u<v;++u)if(!l.oAb(this.Cx.getAttributeType(this.k0[u].kmb),this.k0[u].value,z[u]))return!1;return!0}AW(){return this.isReadOnly?this.clone():this}O4f(){const {Annotations:a}=d(1367);if(!this.isReadOnly){this.Tib=!0;for(const l of this.k0)a.yUb(l.value)}}toString(){return this.Qha()}static DAf(a){return a.replace("\\","\\\\").replace("[","\\[").replace("]",
"\\]").replace(",","\\,")}}Object(J.a)(f,"FeatureBundle",null,[2036,2037])},1407:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m{}m.click="Click";m.x$a="InteractionBegin";m.bSb="InteractionEnd";m.f6h="ControlActivated";m.query="Query";m.yvj="QueryIndexRecorded";m.Z2h="Clicks";m.FKh="ActionEvents";m.umi="FilteredActionEvents";m.xKj="SessionContext";m.latency="Latency";m.performance="Performance";m.ZCj="RenderedResults";m.events="Events";m.fHl="CreateResultsMenu";m.eJ="UpdateRibbonControls";
m.wEo="ResultsAggregation";m.WJ="IssueQuery";m.jtl="CommandSuggestions";m.error="Error";m.x4f="LoadModelData";m.OOl="DepsResolveTime";m.pKn="ModelDataWaitTime";m.IHg="TimedOut";m.G0k="AddinQueryCommandReady";m.aem="GetAddinEntitlements";m.Vuj="ProviderMRUEvents";m.dYl="EnableAddinSearchCommands";Object(J.a)(m,"EventNames",null,[])},1417:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m{constructor(){this.D6f=null;this.ega=this.F6f=0}sEf(f,a,l){if(!f)throw Error.argumentNull("referenceList");
if(0>a||a>f.length)throw Error.argumentOutOfRange("startIndex");if(0>l||l>f.length)throw Error.argumentOutOfRange("length");if(a+l>f.length)throw Error.argument("Invalid start-length range");this.D6f=f;this.F6f=a;this.ega=l}Lpb(f,a,l){this.sEf(f.D6f,f.F6f+a,l)}K(f){if(0>f||f>=this.ega)throw Error.argumentOutOfRange("index");return this.D6f[this.F6f+f]}get count(){return this.ega}static $sf(f){const a=new m;a.sEf(f,0,f.length);return a}}Object(J.a)(m,"ReadOnlyList",null,[2047])},1429:function(J,L,
d){d.d(L,"a",function(){return m});J=d(0);var m;(function(f){f[f.QIp=0]="Classifier";f[f.qIp=1]="AppsForOffice";f[f.IGe=2]="FindInDocument";f[f.jKp=3]="FindInDocumentScopedSearch";f[f.DMp=4]="RecentlyUsed";f[f.eik=5]="TryQuery";f[f.Empty=6]="Empty";f[f.cOp=7]="TryCommand";f[f.Tbk=8]="Assistance";f[f.Lbk=9]="Answer";f[f.Definition=10]="Definition";f[f.Entity=11]="Entity";f[f.Uik=12]="WolframAnswer";f[f.Cek=13]="Insights";f[f.People=14]="People";f[f.Document=15]="Document";f[f.EMp=16]="Recommended";
f[f.hNp=17]="ServiceClassifier";f[f.iNp=18]="ServiceRecommended";f[f.Image=19]="Image";f[f.Notes=20]="Notes";f[f.Zek=21]="Learning";f[f.Feedback=22]="Feedback";f[f.Template=23]="Template";f[f.Abk=24]="ActionAI";f[f.Bbk=25]="ActionAICommand";f[f.uhk=26]="SummarizeDeck";f[f.Ibk=27]="Addin";f[f.cgk=28]="OfficeScript";f[f.Jbk=29]="AddinStoreEntry";f[f.None=30]="None";f[f.uLp=31]="MergedActions";f[f.vLp=32]="MergedScopedSearches";f[f.wLp=33]="MergedSuggestedSearches"})(m||(m={}));Object(J.b)("ResultGroupType",
m)},1440:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);d=d(1516);class m extends d.a{constructor(){super();this.info=this.$j=this.eventId=null}get Xea(){return"Misc"}mPb(){this.detail.Z("Type",this.Xea);this.detail.Z("EventId",this.eventId);this.detail.Z("Func",this.$j);this.detail.Z("Info",this.info);return this.detail}}Object(J.a)(m,"BasicMergeFailureDetail",d.a,[])},1441:function(J,L,d){d.d(L,"a",function(){return l});J=d(0);var m=d(602),f=d(795),a=d(1464);class l{constructor(w,z=!0){this.Bm=
z&&w?w.JO():w;this.Oac=new m.a}OM(w){this.Oac.add(f.a.zb(w))}IWo(w){this.Oac=w}rcj(w){this.Bm&&(new a.a(this.Bm,w)).WMa.forEach((z,x)=>{x.e3&&!this.Oac.contains(z)&&(this.Oac.add(z),x.isDeleted?(x=this.Bm,x.hasProperty(f.a.p_(z))&&x.removeProperty(f.a.p_(z))):this.Bm.Rdb(f.a.p_(z),x.newValue));return!0})}}Object(J.a)(l,"PartialMergeResult",null,[])},1442:function(J,L,d){d.r(L);d.d(L,"CommandResultsUtility",function(){return v});J=d(0);var m=d(1460),f=d(1407),a=d(1461),l=d(1379),w=d(1382),z=d(1373),
x=d(1372),u=d(2);class v{static jsd(E,y){if(y&&y.As){const H={};for(const I of E)y.Hfe(I)&&(H[I]=appChrome.selectors.getModelType(I));z.TellMeActor.instance.eJ(H)}}static Cfp(E){return E.startsWith("btnTellMeOfficeAddIn")}static Z7c(E){const y=z.TellMeActor.instance.rR();return!!y&&y.As&&!appChrome.selectors.isControlDisabled(E)}static rhe(E,y,H,I){if(z.TellMeActor.instance.Xe&&E){const F=[];for(const C of E)F.push(String.format('{{"Id":"{0}","Score":{1}}}',C.commandId,C.score));E={};E[m.a.suggestions]=
"[{"+F.join(",")+"}]";E[m.a.Z2i]=y;E[m.a.groupType]=H;E[m.a.provider]=I;z.TellMeActor.instance.Xe.$B(f.a.jtl,window.performance.now(),E)}}static klm(E,y){const H=[],I=[];for(const F of y){y=F.commandId;let C=F;F.commandId in E&&(y=E[F.commandId],C=new a.a(y,F.score));Array.contains(I,y)||(H.push(C),I.push(y))}return H}static J3c(E,y,H,I,F,C,P,K){var G;H.oHf&&(y=v.klm(H.oHf,y));var R=x.a.Cjm(y);v.jsd(R,H);var W=[],Z=[];R=[];const T=new w.a(P);P=16===P||18===P||7===P||4===P?u.AFrameworkApplication.J?
u.AFrameworkApplication.J.ic("TellMeMaxRecommendedResultsToReturn",3):3:0===P||17===P||25===P?5:0;for(const U of y)if(!v.vdn(U.commandId)){y=v.Cfp(U.commandId);if(H.Hfe(U.commandId)&&!y){if(x.a.z1i(U.commandId))continue;y=null;F&&C&&(y=F.kCm(U.commandId,C));v.Z7c(U.commandId)?Array.add(W,new l.a(U.commandId,5,y,null,K,U.score)):Array.add(Z,new l.a(U.commandId,5,y,null,K,U.score))}else H.fKb&&y&&I&&Array.add(R,U.commandId.substr(21));if(W.length+R.length>=P)break}H=0;for(F=0;F<W.length&&H<P;F++,H++)T.Xx(W[F]);
var N=(G=(W=null===(G=u.AFrameworkApplication.J)||void 0===G?void 0:G.getBooleanFeatureGate("Microsoft.Office.WordOnline.disabledButtonsInTellMeShouldHide",!1))?null===(N=null===appChrome||void 0===appChrome?void 0:appChrome.api)||void 0===N?void 0:N.getSharedUxSettings():void 0)?G.commonSettings:void 0;if(!W||!N||!N().Ihq())for(N=0;N<Z.length&&H<P;N++,H++)T.Xx(Z[N]);for(Z=0;Z<R.length&&H<P;Z++,H++)I.Zlq(E,R[Z],T);return T}static vdn(E){v.OUh||(u.AFrameworkApplication.J&&u.AFrameworkApplication.J.Zx("TellMeControlPredictionBlockList")&&
u.AFrameworkApplication.J.cD("TellMeControlPredictionBlockList").forEach(y=>{Array.add(v.NUh,y.toLowerCase())}),v.OUh=!0);return Array.contains(v.NUh,E.toLowerCase())}static DWf(E){return 2<E.length&&";"===E.charAt(0)&&";"===E.charAt(E.length-1)&&!!u.AFrameworkApplication.J&&(u.AFrameworkApplication.J.$("TellMeCommandHookIsEnabled")||u.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",!1))}static Xti(E){const y=new w.a(0);var H=E.split(";");E=
z.TellMeActor.instance.rR();for(const I of H)if(0<I.length){H=I.split(":");const F=2===H.length?H[0]:I;if(!E.Hfe(F))break;if(1===H.length)H=new l.a(F,5,null,null,1),y.Xx(H);else if(2===H.length)H=new l.a(F,5,H[1],null,1),y.Xx(H);else break}return y}static LUk(E,y,H){if(!(y&&y.results&&E&&E.results&&E.results.length))return{returnValue:!1,Bdf:E,yef:y};const I=[];for(var F of y.results)Array.add(I,F.value);F=0;const C=0<y.results.length?y.results[0].score:0;for(const P of E.results)if(P.score>H&&!Array.contains(I,
P.value)&&v.Z7c(P.value)&&(0<C&&(P.score=C),Array.insert(y.results,F,P),F++),2===F)break;return 0<F?(H=y.results.length-5,0<H&&y.rrg(H),{returnValue:!0,Bdf:E,yef:y}):{returnValue:!1,Bdf:E,yef:y}}}v.OUh=!1;v.NUh=[];Object(J.a)(v,"CommandResultsUtility",null,[])},1459:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m{static zhp(f){return f.toString().charCodeAt(0)}static npn(f){return 55296<=f&&57343>=f}static charAt(f,a){return f.charAt(a)}static FSh(f,a){if(f===a)return!0;"\u00a0"===
f&&(f=" ");"\u00a0"===a&&(a=" ");return f===a}static ESh(f,a){if(f===a)return!0;if(!f||!a||f.length!==a.length)return!1;f=m.hDj(f);a=m.hDj(a);return f===a}static hDj(f){return f.replace(m.bcd," ")}static Wyb(f,a,l){return f.substring(a,a+l)}}m.bcd=RegExp("\u00a0","g");Object(J.a)(m,"CharUtils",null,[])},1460:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m{}m.appName="AppName";m.v6="CloseAllMenus";m.commandId="CommandId";m.context="Context";m.culture="Culture";m.message="Message";m.errorMessage=
"ErrorMessage";m.event="Event";m.$sa="CorrelationID";m.j6n="ParentUiElement";m.query="Input";m.WXb="QueryID";m.Dvj="QueryLength";m.Ttc="QueryIndex";m.xEo="ResultsList";m.suggestions="Suggestions";m.scenario="Scenario";m.sessionId="SessionID";m.source="Source";m.timeStamp="Time";m.f3j="UiElement";m.mse="ReactUx";m.value="Val";m.statusCode="StatusCode";m.service="Service";m.isSuccess="IsSuccess";m.mip="TokenAcquired";m.bun="LatencyType";m.groupName="GroupName";m.Raa="GroupIndex";m.groupType="GroupType";
m.sEo="ResultInfoList";m.resultType="ResultType";m.ZEg="SubResultType";m.hin="IsInputBlur";m.iin="IsInputFocus";m.uon="IsShortCutUsed";m.actionType="ActionType";m.count="Count";m.pWl="DwellTime";m.Z2i="IsZeroTerm";m.TGp="WordsCount";m.Mee="IsSearchUxEnabled";m.Kpn="IsTellMeInHeaderEnabled";m.module="Module";m.resultIndex="ResultIndex";m.exf="DisplayIndex";m.nYl="EnableList";m.provider="Provider";m.contentType="ContentType";m.Qnn="IsSelectionBased";m.dal="BeginPerformanceMarker";m.QYl="EndPerformanceMarker";
m.n8n="PerformanceMeasure";Object(J.a)(m,"Columns",null,[])},1461:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m{constructor(f,a){this.commandId=f;this.score=a}}Object(J.a)(m,"CommandSuggestion",null,[])},1464:function(J,L,d){J=d(0);var m=d(356),f=d(795),a=d(267),l=d(108);class w{constructor(x,u,v){this.CHk=x;this.WDk=u;this.qDk=v;this.MVe=new a.a(Object(l.a)(this,this.Lml,"checkIfDifferent"))}get Emg(){return this.CHk}get oldValue(){return this.WDk}get newValue(){return this.qDk}get usb(){return!(void 0===
this.newValue||null===this.newValue)&&(void 0===this.oldValue||null===this.oldValue)}get isDeleted(){return(void 0===this.newValue||null===this.newValue)&&!(void 0===this.oldValue||null===this.oldValue)}get e3(){return this.usb||this.isDeleted||this.MVe.value}Lml(){return this.usb||this.isDeleted?!0:!f.a.NSh(this.Emg,this.oldValue,this.newValue)}}Object(J.a)(w,"PropertyDiff",null,[]);d.d(L,"a",function(){return z});class z{constructor(x,u){this.TDk=x;this.nDk=u;this.MVe=new a.a(()=>this.j8c());this.EHk=
new a.a(Object(l.a)(this,this.B0l,"evaluatePropertyDiffs"))}get Ov(){return this.TDk}get Lf(){return this.nDk}get usb(){return!!this.Lf&&!this.Ov}get isDeleted(){return!this.Lf&&!!this.Ov}get e3(){return this.usb||this.isDeleted||this.MVe.value}get WMa(){return this.EHk.value}j8c(x=null){let u=!1;this.WMa.forEach((v,E)=>{u=E.e3&&(!x||7!==x.K(v));return!u});return u}B0l(){const x=new m.a;var u=this.Lf,v=this.Ov;if(this.usb){v=u.ek();for(var E=0;E<v.length;E++){var y=v[E];x.Z(f.a.zb(y),new w(y,null,
u.UG(y)))}}else if(this.isDeleted)for(u=v.ek(),E=0;E<u.length;E++)y=u[E],x.Z(f.a.zb(y),new w(y,v.UG(y),null));else{E=v.ek();for(y=0;y<E.length;y++){var H=E[y],I=f.a.zb(H),F=v.UG(H);const C=u.hasProperty(H)?u.UG(H):null;x.Z(I,new w(H,F,C))}E=u.ek();for(y=0;y<E.length;y++)H=E[y],v.hasProperty(H)||(I=f.a.zb(H),F=u.UG(H),x.Z(I,new w(H,null,F)))}return x}}Object(J.a)(z,"MergeableObjectDiff",null,[])},1476:function(J,L,d){d.d(L,"a",function(){return f});J=d(0);var m=d(48);class f{constructor(){this.cp=
0;this.id=m.a.create()}}Object(J.a)(f,"LcsUpdateHint",null,[1454,260])},1477:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m{}m.ou="TellMe";m.JDn="Loki";m.wXj="Substrate";m.Ttc="QueryIndex";m.lZj="TellMeRanker";m.mZj="TellMeRankerLogging";Object(J.a)(m,"Services",null,[])},1478:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m{}m.tWa="HttpRequest";m.provider="Provider";Object(J.a)(m,"LatencyTypes",null,[])},1484:function(J,L,d){J=d(0);var m=d(59),f=d(14),a=d(5),l=d(34),
w=d(221),z=d(175),x=d(236),u=d(48),v=d(602),E=d(108),y=d(241),H=d(1516);class I extends H.a{constructor(){super();this.cB=null}get Xea(){return"CreateMergeBlock"}mPb(){this.detail.Z("Type",this.Xea);this.detail.Z("Revision",this.cB);return this.detail}}Object(J.a)(I,"CreateMergeBlockFailureDetail",H.a,[]);var F=d(1580),C=d(1582),P=d(1713),K=d(1517),G=d(1441),R=d(1782),W=d(571);d.d(L,"a",function(){return Z});class Z{static LXd(T,N,U,ba,X,Y,ca){let ia;ia="";const la=new w.a;for(let za=0;za<U.length;za++){var ta=
void 0;let Ha;ta=F.a.Blm(N,U.K(za),ba,X,Y,ca,T);if(!ta)return{returnValue:null,pbb:ia};({L7f:Ha,pbb:ta}=ta.AAi());if(!Ha)return{returnValue:null,pbb:ia};ia+=ta;la.iD(la.length,Ha)}return{returnValue:la,pbb:ia}}static r9h(T,N,U,ba,X,Y,ca,ia){let la,ta,za,Ha,Na,ya;ya=Na=Ha=za=ta=la=null;({pbb:Ha,returnValue:la}=Z.LXd(N,ma=>T.runtime.Cn.K(ma),U,1,Y,ca,ia));if(!la)return z.a.instance.Ua(17044299,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for base revision"),
T.logger.Pi(Object.assign(new I,{cB:"Base"})),{returnValue:!1,UM:la,v_c:ta,csd:za,zSd:Ha,C1d:Na,yDe:ya};({pbb:Na,returnValue:ta}=Z.LXd(N,ma=>T.runtime.IA.K(ma)||T.runtime.Cn.K(ma),ba,2,Y,ca,ia));if(!ta)return z.a.instance.Ua(17044300,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for favoured revision"),T.logger.Pi(Object.assign(new I,{cB:"Favored"})),{returnValue:!1,UM:la,v_c:ta,csd:za,zSd:Ha,C1d:Na,yDe:ya};({pbb:ya,returnValue:za}=
Z.LXd(N,ma=>T.runtime.uv.K(ma)||T.runtime.Cn.K(ma),X,4,Y,ca,ia));return za?{returnValue:!0,UM:la,v_c:ta,csd:za,zSd:Ha,C1d:Na,yDe:ya}:(z.a.instance.Ua(17044301,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for unfavoured revision"),T.logger.Pi(Object.assign(new I,{cB:"Unfavored"})),{returnValue:!1,UM:la,v_c:ta,csd:za,zSd:Ha,C1d:Na,yDe:ya})}static X2h(T,N=!1){const U=new w.a;let ba=0;for(;ba<T.length;){var X=T.K(ba);if(1===X.type||
4===X.type||2===X.type)U.add(X),ba++;else if(3===X.type){let ca="";ca+=X.character;ba++;let ia=X.oXa,la=!1;for(;ba<T.length;ba++){var Y=T.K(ba);3===Y.type?X.runId===Y.runId&&X.oL.equals(Y.oL)&&(X.sfa===Y.sfa||X.CKa===Y.CKa)&&X.bA.VB(Y.bA)&&(!N||X.$u&&X.$u.equals(Y.$u))?(ca+=Y.character,Y.oXa&&(ia=!0)):la=!0:la=!0;if(la){X=new R.a(null,X.source,X.wk,X.Og,X.runId,X.oL,ca,X.Qub,!0,ia,X.sfa,X.CKa,X.iZa,X.bA,X.$u);U.add(X);break}}}}z.a.instance.Ua(17044302,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",
U.Qr());return U}static $sl(T,N=!1){const U=new w.a;let ba=0;for(;ba<T.length;){var X=T.K(ba);if(1===X.type||4===X.type||2===X.type)U.add(X),ba++;else if(3===X.type){let ca=X.character.toString();ba++;let ia=X.oXa;for(;ba<T.length;ba++){var Y=T.K(ba);if(3===Y.type&&Z.W_o(X,Y,N))ca+=Y.character,Y.oXa&&(ia=!0);else break}X=new R.a(null,X.source,X.wk,X.Og,X.runId,X.oL,ca,X.Qub,!0,ia,X.sfa,X.CKa,X.iZa,X.bA,X.$u);U.add(X)}}z.a.instance.Ua(50931345,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",
U.Qr());return U}static W_o(T,N,U){return T.runId===N.runId&&T.oL.equals(N.oL)&&(T.sfa===N.sfa||T.CKa===N.CKa)&&T.bA.VB(N.bA)&&(!U||!!T.$u&&T.$u.equals(N.$u))}static qUo(T,N,U,ba,X,Y,ca,ia,la,ta,za,Ha,Na,ya,ma,Ea){T.setPropertyString(U.Bm,f.a.Pn,X);T.setPropertyUint32(U.Bm,a.a.Yc,ba);T.setPropertyUint32s(U.Bm,a.a.Gq,Y);T.setPropertyUint32s(U.Bm,a.a.Lt,ca);T.setPropertyObjectIds(U.Bm,f.a.Qn,la);T.hasProperty(U.Bm,a.a.Uj)&&T.setPropertyUint32(U.Bm,a.a.Uj,Z.wcm());N&&N(7)&&T.setPropertyObjectIds(U.Bm,
a.a.Ew,Ea);ba=!1;for(X=0;X<ta.length;X++)if(ta.K(X)){ba=!0;break}ba&&T.setPropertyBools(U.Bm,a.a.Pag,ta);Z.Jgl(N,T,U,za,Ha,Na,ya);Z.Kgl(T,U,ma);U.OM(f.a.Pn);U.OM(a.a.Yc);U.OM(a.a.Gq);U.OM(a.a.Lt);U.OM(f.a.Qn);U.OM(a.a.Pag);U.OM(f.a.vn);U.OM(f.a.Lyb);U.OM(a.a.ZVa);U.OM(a.a.VMa);U.OM(f.a.CCa);U.OM(a.a.Ew);T.hasProperty(U.Bm,a.a.Uj)&&U.OM(a.a.Uj);0<ia.length?T.setPropertyUint32s(U.Bm,f.a.vn,ia):U.Bm.removeProperty(f.a.vn)}static Jgl(T,N,U,ba,X,Y,ca){if(T(94)){T=ba.contains(!0,(ia,la)=>la);Z.kzg(N,U,
f.a.CCa,T?ba:null);Z.kzg(N,U,f.a.Lyb,Z.OEj(ba,X));Z.kzg(N,U,a.a.ZVa,Z.OEj(ba,Y));ba=!1;for(X=0;X<ca.length;X++)0!==ca.K(X)&&(ba=!0);ba?N.setPropertyUint32s(U.Bm,a.a.VMa,ca):U.Bm.removeProperty(a.a.VMa)}}static Kgl(T,N,U){const ba=ca=>ca;var X=Object(E.a)(T,T.setPropertyBools,"setPropertyBools");Z.GTa(N,U.ksb,ba,X,a.a.ZKa);Z.GTa(N,U.iob,ba,X,a.a.kka);Z.GTa(N,U.Acb,ba,X,a.a.UMa);X=ca=>0<ca.length;var Y=Object(E.a)(T,T.setPropertyStrings,"setPropertyStrings");Z.GTa(N,U.jsb,X,Y,a.a.$Ka);Z.GTa(N,U.hob,
X,Y,a.a.fJa);Z.GTa(N,U.twb,X,Y,a.a.KOa);X=ca=>!!ca;Y=Object(E.a)(T,T.setPropertyListOfMilliseconds,"setPropertyListOfMilliseconds");Z.GTa(N,U.lsb,X,Y,a.a.aLa);Z.GTa(N,U.t7a,X,Y,a.a.gJa);Z.GTa(N,U.vwb,X,Y,a.a.LOa);X=ca=>!!ca;Y=Object(E.a)(T,T.sUo,"setPropertyList");Z.Plf(N,U.IWa,X,Y,l.a.JWa);Z.Plf(N,U.XMb,X,Y,l.a.zUa);Z.Plf(N,U.BXb,X,Y,l.a.f0a);U.Acb.any(ba)?Z.GTa(N,U.uwb,()=>!0,Object(E.a)(T,T.setPropertyObjectIds,"setPropertyObjectIds"),a.a.vEa):N.Bm.removeProperty(a.a.vEa)}static OEj(T,N){const U=
new w.a;let ba=!1;for(let X=0;X<T.length;X++){const Y=N.K(X)&&!T.K(X);U.add(Y);ba=Y||ba}return ba?U:null}static kzg(T,N,U,ba){ba?T.setPropertyBools(N.Bm,U,ba):N.Bm.removeProperty(U)}static wcm(){return x.a.OF()}static yBi(T,N){return T.runtime.IA.Q2(N,T.runtime.Cn.K(N)||T.runtime.uv.get(N))}static Z2c(T,N,U,ba,X){let Y;Y=new w.a;const ca=!!U&&U(7),ia=!!U&&U(110);if(T.runtime.sc.isFeatureEnabled(69)){var la=Z.$sl(ba,ca);var ta=Z.X2h(ba,ca);la.length!==ta.length&&T.runtime.sc.DI(69)}else la=Z.X2h(ba,
ca);ta=0;let za="",Ha=new w.a,Na=new w.a,ya=new w.a,ma=new w.a,Ea=new w.a,Ba=new w.a,$a=new w.a,ea=new w.a,ka=new w.a;const La=new P.a;let va=new w.a;var Ca=la.K(la.length-1);if(2!==Ca.type&&4!==Ca.type)return z.a.instance.Ua(17044304,1,2,"GetMergeableObjectsFromMergeBlocks: Last merge block not an EOP or table but is [Type: {0}] instead",Ca.type),T.logger.Pi(Object.assign(new K.a,{$j:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnq",info:String.format("Last merge block is not EOP or table but {0}",
Ca.type)})),{returnValue:!1,Roe:Y};var ua=0;for(Ca=0;Ca<la.length;Ca++){var Sa=la.K(Ca),Ta=null;if(1===Sa.type||3===Sa.type)Ta=Sa,za+=Ta.text;else if(4===Sa.type){Sa=Z.yBi(T,Sa.wk);Sa=new G.a(Sa);Y.add(Sa);continue}Ta?(Ha.add(Ta.runId),Na.add(Ta.Og),ua+=Ta.text.length,ya.add(ua),ma.add(Ta.oL),Ea.add(Ta.Qub),Ba.add(Ta.oXa),$a.add(Ta.sfa),ea.add(Ta.CKa),ka.add(Ta.iZa),La.ksb.add(Ta.bA.pWm),La.iob.add(Ta.bA.SVm),La.Acb.add(Ta.bA.VWm),La.jsb.add(Ta.bA.msb.author),La.hob.add(Ta.bA.job.author),La.twb.add(Ta.bA.Fua.author),
La.lsb.add(Ta.bA.msb.Icd),La.t7a.add(Ta.bA.job.Icd),La.vwb.add(Ta.bA.Fua.Icd),La.uwb.add(Ta.bA.Fua.klg),ia&&(La.IWa.push(new W.a(!1,"",null,null!=Ta.bA.msb.aMa?N.gyg(Ta.bA.msb.aMa):null)),La.IWa.push(new W.a(!1,"",null,null!=Ta.bA.job.aMa?N.gyg(Ta.bA.job.aMa):null)),La.IWa.push(new W.a(!1,"",null,null!=Ta.bA.Fua.aMa?N.gyg(Ta.bA.Fua.aMa):null))),ca&&va.add(Ta.$u)):Ha.length||(Ha.add(0),Na.add(0),ya.add(0),ma.add(u.a.nil),Ea.add(!1),Ba.add(!1),$a.add(!1),ea.add(!1),ka.add(0),La.ksb.add(!1),La.iob.add(!1),
La.Acb.add(!1),La.jsb.add(""),La.hob.add(""),La.twb.add(""),La.lsb.add(0),La.t7a.add(0),La.vwb.add(0),La.uwb.add(u.a.nil),ia&&(La.IWa.push(new W.a(!1,"",null,null)),La.XMb.push(new W.a(!1,"",null,null)),La.BXb.push(new W.a(!1,"",null,null))));if(2===Sa.type){ua=Sa;Sa=ua.Yc;ya.YH(ya.length-1);Ta=X.K(ta);if(!Ta)return z.a.instance.Ua(17044307,1,2,"GetMergeableObjectsFromMergeBlocks: Failed to get a paragraphId. [ParagraphIdx: {0}] [ParagraphIds.Count: {1}] [MergeBlocks.Length: {2}] [CombinedMergeBlockIdx: {3}] [CombinedMergeBlocks.Length: {4}]",
ta,X.length,ba.length,Ca,la.length),T.logger.Pi(Object.assign(new K.a,{$j:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnt",info:"Failed to get ParaId"})),z.a.instance.Rna(17044308,1,4,"GetMergeableObjectsFromMergeBlocks Paragraphs",X.Qr()),z.a.instance.Rna(17044309,1,4,"GetMergeableObjectsFromMergeBlocks MergeBlocks",ba.Qr()),z.a.instance.Rna(17044310,1,4,"GetMergeableObjectsFromMergeBlocks CombinedMergeBlocks",la.Qr()),{returnValue:!1,Roe:Y};if(Ta=Z.yBi(T,Ta))Ta=new G.a(Ta.JO()),Z.qUo(N,U,Ta,
ua.Yc,za,Ha,Na,ya,ma,Ea,Ba,$a,ea,ka,La,va),Y.add(Ta);z.a.instance.Ua(17044312,1,4,"Merge result for: [GraphNode: {0}] [WordId: {1}] [RunIds: {2}] [ParaIds: {3}] [RunIndices: {4}] [ProofingRequired: {5}] [HasSpellingError: {6}] [HasGrammarError: {7}] [FormattingIds: {8}] {9} [ProofingErrorHint: {10}]",ua.wk,Sa,Ha.Qr(),Na.Qr(),ya.Qr(),Ba.Qr(),$a.Qr(),ea.Qr(),ma.Qr(),"",ka.Qr());ta++;za="";Ha=new w.a;Na=new w.a;ya=new w.a;ma=new w.a;Ea=new w.a;Ba=new w.a;$a=new w.a;ea=new w.a;ka=new w.a;La.reset();ua=
0;va=new w.a}}return{returnValue:!0,Roe:Y}}static jDo(T,N){const U=T.runtime.Tq.K(y.a.QN),ba=N.getPropertyObjectIds(U.Bm,a.a.uY);for(let X=0;X<ba.length;X++)T.runtime.Tq.remove(ba.K(X));N.setPropertyObjectIds(U.Bm,a.a.uY,new w.a);N.setPropertyString(U.Bm,a.a.EEa,u.a.nil.toString());U.OM(a.a.uY);U.OM(a.a.EEa)}static F5m(T,N){if(T.runtime.Tq.lb(y.a.QN))return null;const U=new G.a(T.runtime.Cn.K(y.a.QN).JO());N.setPropertyString(U.Bm,a.a.EEa,T.output.LL.last().id.toString());N.setPropertyObjectIds(U.Bm,
a.a.uY,new w.a);U.OM(a.a.uY);U.OM(a.a.EEa);T.runtime.Tq.Z(y.a.QN,U);return U}static yKf(T){const N=new w.a;T.forEach(U=>{N.add(U.id);return!0});return N}static lqc(T,N,U,ba){let X=0;U.forEach(Y=>{C.a(Y,N+X++,1);Y.wc===m.a.paragraphNode&&T.getPropertyObjectIds(Y,f.a.Qn).forEach(ca=>{ba.add(ca);return!0});return!0})}static dAn(T,N){const U=new v.a;let ba=0;N.forEach(X=>{if(U.contains(X))return!0;U.add(X);if(({index:ba}=Z.j5f("BaseFormatting_",ba,X,Y=>T.runtime.Cn.K(Y))).returnValue||({index:ba}=Z.j5f("FavoredFormatting_",
ba,X,Y=>T.runtime.IA.K(Y))).returnValue||({index:ba}=Z.j5f("ConflictingFormatting_",ba,X,Y=>T.runtime.uv.K(Y))).returnValue)return!0;ba++;return!0})}static j5f(T,N,U,ba){if(U=ba(U))if(C.a(U,T+N,1),U.wc===m.a.s_a)return N++,{returnValue:!0,index:N};return{returnValue:!1,index:N}}static Pxf(T){return!!T.runtime.Cn.K(y.a.QN)}static GTa(T,N,U,ba,X){N.any(U)?(ba(T.Bm,X,N),T.OM(X)):T.Bm.removeProperty(X)}static Plf(T,N,U,ba,X){N.some(U)?(ba(T.Bm,X,N),T.OM(X)):T.Bm.removeProperty(X)}static NNj(T,N){const U=
new w.a;U.add(0);const ba=T?T.length:0;for(let X=0;X<ba;X++)U.insert(X+1,T.sg(X));U.insert(U.length,N);return U}}Object(J.a)(Z,"ParagraphMergeUtils",null,[])},1514:function(J,L,d){d.d(L,"a",function(){return f});J=d(0);var m=d(221);class f{constructor(a,l,w){this.yn=null;this.Mk=a;this.source=l;this.wk=w}get type(){return this.Mk}get Aeb(){return!1}get Mgn(){return 1===(this.source&1)}get Ngn(){return 2===(this.source&2)}get Ogn(){return 4===(this.source&4)}B7(){return!1}toString(){return String.format("[Source: {0}] [Type: {1}]",
this.Cgm(),this.Qic())}Cgm(){let a="";this.Mgn&&(a+="Base");this.Ngn&&(a+="FavoredUpdate");this.Ogn&&(a+="UnfavoredUpdate");return a}Qic(){return""}VB(a){return this.type===a.type}tpd(){const a=new m.a;a.add(this);return a}get length(){return 0}}Object(J.a)(f,"AMergeBlock",null,[42,43])},1515:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);d=d(1514);class m extends d.a{constructor(f,a,l){super(2,f,a);this.Yc=l}toString(){return String.format("{0} [WordId: {1}] [GraphNodeId: {2}]",super.toString(),
this.Yc,this.wk)}Qic(){return"Eop"}clone(){return new m(this.source,this.wk,this.Yc)}VB(f,a,l,w=!1,z=!0){return super.VB(f,a,l,w)?z?f.Yc===this.Yc:f.wk===this.wk&&f.Yc===this.Yc:!1}get length(){return 1}}Object(J.a)(m,"EopMergeBlock",d.a,[])},1516:function(J,L,d){d.d(L,"a",function(){return f});J=d(0);var m=d(356);class f{constructor(){this.detail=new m.a}}Object(J.a)(f,"AMergeFailureDetail",null,[1446])},1517:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);d=d(1440);class m extends d.a{constructor(){super()}get Xea(){return"ParagraphMerge"}}
Object(J.a)(m,"ParagraphMergeFailureDetail",d.a,[])},1518:function(J,L,d){d.d(L,"b",function(){return w});d.d(L,"a",function(){return x});var m=d(221),f=d(356),a=d(602),l=d(1714);const w=(v,E,y)=>{const H=z(v,E,y);let I=0,F=0,C=0,P=new l.a;const K=new m.a;for(let G=0;G<H.length;G++){const R=H.sg(G+1);P.FRd(v.sg(I));P.HRd(E.sg(F));P.LRd(y.sg(C));I++;F++;for(C++;I<v.length&&(!R||!R.equals(v.sg(I)));)P.FRd(v.sg(I)),I++;for(;F<E.length&&(!R||!R.equals(E.sg(F)));)P.HRd(E.sg(F)),F++;for(;C<y.length&&(!R||
!R.equals(y.sg(C)));)P.LRd(y.sg(C)),C++;K.add(P);P=new l.a}for(;I<v.length;)P.FRd(v.sg(I)),I++;for(;F<E.length;)P.HRd(E.sg(F)),F++;for(;C<y.length;)P.LRd(y.sg(C)),C++;P.isEmpty||K.add(P);return K},z=(v,E,y)=>{const H=new m.a,I=E.uS(),F=y.uS();v.forEach(C=>{I.contains(C)&&F.contains(C)&&H.add(C);return!0});return H},x=(v,E,y)=>{v=v||new m.a;E=E||new m.a;y=y||new m.a;const H=new m.a,I=new f.a(0),F=new a.a;for(var C=0;C<v.length;C++){var P=v.sg(C);I.Z(P,C)}for(v=C=0;C<E.length&&v<y.length;){P=E.sg(C);
let K=y.sg(v),G=I.Q2(P,-1),R=I.Q2(K,-1);-1===G?(u(F,H,P),C++):-1===R?(u(F,H,K),v++):G===R?(u(F,H,P),C++,v++):G<R?C++:v++}for(;C<E.length;C++)P=E.sg(C),-1===I.Q2(P,-1)&&u(F,H,P);for(;v<y.length;v++)E=y.sg(v),-1===I.Q2(E,-1)&&u(F,H,E);return H},u=(v,E,y)=>{v.contains(y)||(E.add(y),v.add(y))}},1519:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);d=d(1440);class m extends d.a{constructor(){super()}get Xea(){return"RdOpLcs"}}Object(J.a)(m,"ReducedOpsLcsFailureDetail",d.a,[])},1526:function(J,L,
d){J=d(0);class m{constructor(){this.tokenFilter=this.Z6c=null;this.t7f=this.score=this.dcd=0}Cig(H,I,F){this.score=H.K(I);++I;this.Z6c=H.K(I)?F.ssa(H.K(I)):null;++I;this.tokenFilter=H.K(I)?F.ssa(H.K(I)):null;++I;this.dcd=H.K(I);++I;this.t7f=H.K(I);++I;return I}}Object(J.a)(m,"TokenStringGeneratorInit",null,[]);class f{constructor(H,I,F,C,P){this.zpb=H;this.count=I;this.F2d=F;this.cR=C;this.depth=P}}Object(J.a)(f,"ErrorTolerantTrieMatch",null,[]);var a=d(1612),l=d(1734);class w{constructor(H=null,
I=0,F=0,C=0){this.POk=H||new l.a;this.yAa=I;this.cR=F;this.depth=C}get Z8(){return this.POk}getKey(){return this.Z8.Uy.toString()+":"+this.yAa.toString()}}Object(J.a)(w,"TrieBookmark",null,[]);class z{constructor(H,I){this.$Xa=H;this.x6f=I}KDn(H){if(null==H)throw Error.argumentNull("prefix");let I={};var F=I[""]=new w;this.L$d(F,I);for(F=0;F<H.length;++F){const C=H.charCodeAt(F),P={};for(let K in I)this.A1k(C,I[K],P);I=P}return this.kkp(I)}L$d(H,I){if(!(H.cR>=this.x6f)&&(H=new w(a.a.tof(H.Z8),H.yAa,
H.cR+1,H.depth),H.Z8.uH&a.a.Yfb&&(H.yAa+=1),this.$Xa.E1b(H.Z8))){H.depth+=1;let F=!0;for(;F;)z.iEe(H,I),this.L$d(H,I),H.yAa+=this.$Xa.ejc(H.Z8,!0)+(H.Z8.uH&a.a.Yfb?1:0),F=this.$Xa.zrd(H.Z8)}}A1k(H,I,F){I.cR+1<=this.x6f&&(I.cR+=1,z.iEe(I,F),--I.cR);I.Z8.uH&a.a.Yfb&&(I.yAa+=1);if(this.$Xa.E1b(I.Z8)){I.depth+=1;let C=!0;for(;C;)I.Z8.N2b===H?(z.iEe(I,F),this.L$d(I,F)):I.cR+1<=this.x6f&&(I.cR+=1,z.iEe(I,F),this.L$d(I,F),--I.cR),I.yAa+=this.$Xa.ejc(I.Z8,!0)+(I.Z8.uH&a.a.Yfb?1:0),C=this.$Xa.zrd(I.Z8)}}kkp(H){const I=
[];for(var F in H){const C=H[F];if(!C.Z8.Uy)continue;const P=!!(C.Z8.uH&a.a.Yfb),K=this.$Xa.ejc(C.Z8,!1)+(P?1:0);Array.add(I,new f(C.yAa,K,P,C.cR,C.depth))}I.sort((C,P)=>{let K=C.zpb-P.zpb;return K||(K=-(C.count-P.count))?K:K=C.depth-P.depth});if(2>I.length)return I;H=[];for(F=0;F<I.length;)F+=z.T0j(F,I,H);return H}static iEe(H,I){const F=H.getKey();F in I?(I=I[F],I.cR=Math.min(I.cR,H.cR)):I[F]=new w(a.a.tof(H.Z8),H.yAa,H.cR,H.depth)}static T0j(H,I,F){const C=I[H];let P=C.zpb;const K=P+C.count;let G=
1,R=C.F2d;for(;H+G<I.length&&I[H+G].zpb<K;){const W=I[H+G];W.zpb>P&&(Array.add(F,new f(P,W.zpb-P,R,C.cR,C.depth)),R=!1);G+=z.T0j(H+G,I,F);P=W.zpb+W.count}P<K&&Array.add(F,new f(P,K-P,R,C.cR,C.depth));return G}}Object(J.a)(z,"ErrorTolerantTrieLookupEngine",null,[2060]);class x extends m{constructor(H,I,F){super();this.fPi=this.Lnj=!1;this.Tji=null;if(H){var C=0;try{C=this.Cig(H,C,I);this.Lnj=1===H.K(C);++C;this.fPi=1===H.K(C);++C;const P=H.K(C);this.Tji=this.D6n(F,P)}catch(P){throw Error.argument("initData");
}}}D6n(H,I){return new z(H,I)}}Object(J.a)(x,"FuzzyMatchTokenStringGeneratorInit",m,[]);class u extends m{constructor(H,I){super();this.query=this.name=null;if(H){this.annotations=I.annotations;var F=0;try{F=this.Cig(H,F,I),this.name=I.eD(H.K(F)),++F,this.query=I.eN(H.K(F))}catch(C){throw Error.argument("initData");}}}}Object(J.a)(u,"QueryTokenStringGeneratorInit",m,[]);class v extends m{constructor(H,I){super();if(H)try{this.Cig(H,0,I)}catch(F){throw Error.argument("initData");}}}Object(J.a)(v,"SurfaceStringTokenStringGeneratorInit",
m,[]);var E=d(1417);d.d(L,"a",function(){return y});class y{constructor(H){this.n6f=H}get Z6c(){return this.n6f.Z6c}get tokenFilter(){return this.n6f.tokenFilter}get dcd(){return this.n6f.dcd}static create(H,I,F){const {SurfaceStringTokenStringGenerator:C}=d(1906),{QueryTokenStringGenerator:P}=d(1907),{FuzzyMatchTokenStringGenerator:K}=d(1908);let G=0;try{if(H.K(G)!==y.SKb)throw Error.argument("initData","Input does not represent a token string generator");++G;const R=H.K(G);++G;const W=new E.a;W.Lpb(H,
G,H.count-G);switch(R){case C.KTc:return new C(new v(W,I));case P.KTc:return new P(new u(W,I));case K.KTc:return new K(new x(W,I,F));default:throw Error.argument("initData");}}catch(R){throw Error.argument("initData");}}static BNh(H,I,F,C,P,K){H=H.tip.getId(I,null);if(0>H)return++K,K;y.CNh(H,F,C,P);return K}static CNh(H,I,F,C){Array.add(C.LEg,H);Array.add(C.bXj,I);++C.nzc[F]}}y.SKb=1099767983;Object(J.a)(y,"TokenStringGenerator",null,[2057])},1579:function(J,L,d){d.d(L,"a",function(){return a});J=
d(0);var m=d(221);L=d(1514);var f=d(1459);class a extends L.a{constructor(l,w,z){super(l,w,z)}Q8o(l){let w;w=null;if(!this.text||!this.Aeb||0>=l||l>=this.length)return{returnValue:!1,rVj:w};w=new m.a;const z=this.clone();z.Vnd(f.a.Wyb(this.text,0,l));const x=this.clone();x.Vnd(f.a.Wyb(this.text,l,this.length-l));w.add(z);w.add(x);return{returnValue:!0,rVj:w}}B7(){return!0}get length(){return this.text.length}}Object(J.a)(a,"ATextMergeBlock",L.a,[])},1580:function(J,L,d){d.d(L,"a",function(){return a});
J=d(0);var m=d(59),f=d(175);class a{ghf(l,w){return l+("[Block: "+w+"] ")}static Blm(l,w,z,x,u,v,E){const {ParagraphMergeBlockCreator:y}=d(1995),{TableMergeBlockCreator:H}=d(2001);if(w.wc===m.a.paragraphNode)return new y(l,w,z,u,v,x(7),E,x(110));if(w.wc===m.a.qp)return new H(w,z);f.a.instance.Ua(4051652,1,1,"Trying to Run GetMergeBlockList on unknown Runtime Class ID {0}.",w.wc);return null}}Object(J.a)(a,"MergeBlockCreator",null,[])},1581:function(J,L,d){d.d(L,"a",function(){return w});J=d(0);var m=
d(59),f=d(5),a=d(48);L=d(1579);var l=d(1464);class w extends L.a{constructor(z,x,u,v,E,y,H,I,F,C,P,K,G,R){super(x,u,v);this.Og=E;this.runId=y;this.Qub=I;this.kuk=H;this.jJe=z;this.oXa=F;this.sfa=C;this.CKa=P;this.iZa=K;this.bA=G;this.$u=R}get cSc(){return this.jJe}get oL(){return this.kuk}get DOb(){return this.cSc(this.oL)}toString(){return String.format("{0} [ParaId: {1}] [RunId: {2}] [NewlyTypedRun: {3}] [GraphNodeId: {4}] [FormatId: {5}] [ChangeId: {6}]",super.toString(),this.Og,this.runId,this.Qub,
this.wk,this.oL.toString(),this.$u?this.$u.toString():"NULL")}VB(z,x,u,v=!1){if(!super.VB(z,x,u,v))return!1;if(v)return!0;if(!this.bA.VB(z.bA)||this.$u&&!this.$u.equals(z.$u))return!1;if(this.oL.equals(z.oL)||this.oL.equals(a.a.nil)||z.oL.equals(a.a.nil))return!0;z=new l.a(this.DOb,z.DOb);x=x.S8h(this.DOb,u);return z.j8c(x.rqe)?!1:!0}get obn(){return this.B7()&&"\ufffc"===this.text&&this.DOb?this.DOb.hasProperty(f.a.ft)||this.DOb.wc!==m.a.Zvb?!0:!1:!1}}Object(J.a)(w,"AUserRunMergeBlock",L.a,[])},
1582:function(J,L,d){d.d(L,"a",function(){return f});var m=d(175);const f=(a,l,w=4)=>{a?m.a.instance.Rna(4273285,w,4,l,a.kzc()):m.a.instance.Ua(4293845,w,1,l,"{0}: Node was null.",l)}},1583:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);d=d(1379);class m extends d.a{constructor(f,a,l,w,z=null){super(f,a,z,null,l);this.id=w}}Object(J.a)(m,"TryQueryResultBinding",d.a,[])},1584:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m{constructor(f){this.Ab=f}get Gbb(){return this.Ab.Gbb}get icp(){return 4!==
this.Ab.style}get kcp(){return!0}get trie(){return this.Ab.trie}getId(f,a){if(!this.icp)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Ab.style){case 0:return this.Xsm(f,a);default:throw Error.notImplemented();}}eD(f){if(!this.kcp)throw Error.invalidOperation("String lookup not supported on this string table");if(0>f||f>=this.Gbb)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Ab.style){case 0:return this.nJm(f);case 4:return this.mJm(f);
default:throw Error.notImplemented();}}Xsm(f,a){f=this.Ab.trie.c$i(f,0,f.length,a);if(!f.succeeded)return-1;if(0>f.Dzc||f.Dzc>=this.Ab.Gbb)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Ab.Ard?this.Ab.Lid.aA(this.Ab.Ard+4*f.Dzc,4):f.Dzc}nJm(f){if(this.Ab.Ard){let a=0;for(;a<this.Ab.Gbb&&this.Ab.Lid.aA(this.Ab.Ard+4*a,4)!==f;++a);if(a>=this.Ab.Gbb)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Ab.trie.bGi(a)}return this.Ab.trie.bGi(f)}mJm(f){const a=
this.Ab.Lid.aA(this.Ab.ZWj+4*f,4);f=this.Ab.Lid.aA(this.Ab.$Wj+4*f,4);if(0>f||0>a)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const l=Array(a);for(let w=0;w<a;++w)l[w]=({C_m:f}=this.Vko(f)).returnValue;return String.fromCharCode.apply(null,l)}Vko(f){let a=0;for(let l=0;3>l;++l){const w=this.Ab.Lid.K(this.Ab.w_h+f)^182;++f;a|=(w&127)<<7*l;if(!(w&128))break}return{returnValue:a,C_m:f}}}Object(J.a)(m,"StringTable",null,[2046])},1585:function(J,L,d){d.d(L,"a",function(){return f});
J=d(0);var m=d(1612);class f{constructor(a){this.trie=null;this.w_h=this.ZWj=this.$Wj=this.Ard=0;if(a){this.Lid=a;var l=0;if(a.aA(l,4)!==f.SKb)throw Error.argument("bytes","Input does not represent a string table");l+=4;this.Gbb=a.aA(l,4);l+=4;this.style=a.aA(l,4);l+=4;switch(this.style){case 0:const w=1===a.aA(l,4);l+=4;w||(this.Ard=l,l+=4*this.Gbb);a.aA(l,4);this.trie=this.f7n(a,l+4);break;case 4:this.$Wj=l;this.ZWj=l+=4*this.Gbb;l+=4*this.Gbb;a.aA(l,4);this.w_h=l+4;break;default:throw Error.argument("bytes");
}}}f7n(a,l){return new m.a(a,l)}}f.SKb=1025118440;Object(J.a)(f,"StringTableInit",null,[])},1586:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);var m;(function(f){f[f.Lbk=0]="Answer";f[f.Definition=1]="Definition";f[f.Entity=2]="Entity";f[f.Uik=3]="WolframAnswer";f[f.Tbk=4]="Assistance";f[f.Command=5]="Command";f[f.Document=6]="Document";f[f.eik=7]="TryQuery";f[f.IGe=8]="FindInDocument";f[f.DKp=9]="HelpAction";f[f.Cek=10]="Insights";f[f.People=11]="People";f[f.Image=12]="Image";f[f.lKp=13]=
"FirstRunResult";f[f.MLp=14]="NoCommandsFoundResult";f[f.Thk=15]="TestResult";f[f.rIp=16]="AppsForOffice_Installed";f[f.tIp=17]="AppsForOffice_Recommandation";f[f.sIp=18]="AppsForOffice_Query";f[f.RLp=19]="Notes_Onenote";f[f.SLp=20]="Notes_Samsung";f[f.TLp=21]="Notes_Sticky";f[f.Zek=22]="Learning";f[f.Feedback=23]="Feedback";f[f.Template=24]="Template";f[f.Abk=25]="ActionAI";f[f.Bbk=26]="ActionAICommand";f[f.Ibk=27]="Addin";f[f.cgk=28]="OfficeScript";f[f.Jbk=29]="AddinStoreEntry";f[f.wKp=30]="GenerateSlides";
f[f.uhk=31]="SummarizeDeck";f[f.Unknown=32]="Unknown"})(m||(m={}));Object(J.b)("ResultType",m)},1609:function(J,L,d){J=d(0);var m=d(5),f=d(602),a=d(175),l=d(221),w=d(48),z=d(356),x=d(83),u;(function(jb){jb[jb.none=0]="none";jb[jb.Ccd=1]="mergeConflict";jb[jb.VSp=2]="containerBaseIdValidationFailure";jb[jb.pXp=3]="failedToApplyHints";jb[jb.aFe=4]="validateUpdateHintsAreComplete";jb[jb.other=5]="other"})(u||(u={}));Object(J.b)("ParagraphMergeUsingHintsFailureReason",u);var v=d(1025),E=d(241),y=d(719);
const H=jb=>{const hb=new l.a;jb.forEach(pb=>{hb.add(pb);return!0});return hb};var I=d(1515),F=d(1518),C=d(1519);const P=(jb,hb)=>{if(jb.length!==hb.length)return!1;for(let pb=0;pb<jb.length;pb++)jb.K(pb).yn=hb.K(pb),hb.K(pb).yn=jb.K(pb);return!0},K=(jb,hb,pb)=>{let ob,sb,Ab;ob=0;sb=!1;Ab=0;var nc;if(!({idx:nc}=T(jb,hb)).returnValue)return a.a.instance.Ua(18969440,1,5,"TryFindMergeBlockToSplit: Unable to find MergeBlock for [GraphNodeId: {0}] [MergeBlocks: {1}]",hb,jb.Qr()),{returnValue:!1,x4c:ob,
Nub:sb,hdd:Ab};if(!pb&&2===jb.K(nc).type)return{returnValue:!0,x4c:nc,Nub:sb,hdd:Ab};if(!jb.K(nc).B7())return a.a.instance.Ua(17044256,1,2,"TryFindMergeBlockToSplit: MergeBlock that at [Index: {0}] [Cp: {1}] is of Unexpected type [MergeBlocks: {2}]",nc,pb,jb.Qr()),{returnValue:!1,x4c:ob,Nub:sb,hdd:Ab};let qc=!1,Jc=0;for(;nc<jb.length&&jb.K(nc).wk.equals(hb);nc++){if(pb===Jc){qc=!0;break}if(pb>Jc&&pb<Jc+jb.K(nc).length){sb=qc=!0;Ab=pb-Jc;break}Jc+=jb.K(nc).length}qc||pb!==Jc||(qc=!0);qc&&(ob=nc);return{returnValue:qc,
x4c:ob,Nub:sb,hdd:Ab}},G=(jb,hb,pb)=>{let ob,sb,Ab;Ab=sb=0;ob=!1;let nc=0,qc=!1;for(;sb<jb.length;sb++){if(hb===nc){qc=!0;break}if(hb>nc&&hb<nc+jb.K(sb).length){ob=qc=!0;Ab=hb-nc;break}nc+=jb.K(sb).length}qc||hb!==nc||(qc=!0);qc||(jb=String.format("Unable to find block idx to split at cp [Blocks: {0}][Length: {1}][CP: {2}]",jb.length,nc,hb),a.a.instance.Ua(573178201,1,2,jb),pb.Pi(Object.assign(new C.a,{eventId:"8k6fz",info:jb})));return{returnValue:qc,Nub:ob,LUh:sb,KUh:Ab}},R=(jb,hb,pb)=>{let ob;
if(jb.K(hb).B7()&&({rVj:ob}=jb.K(hb).Q8o(pb)).returnValue)return jb.iD(hb+1,ob),jb.YH(hb),!0;a.a.instance.Ua(18969441,1,5,"TrySplitMergeBlockInListAtIndexAndCp: Unable to split at [Index: {0}] [Cp: {1}] [MergeBlocks: {2}]",hb,pb,jb.Qr());return!1},W=(jb,hb,pb)=>{let ob,sb;if(!({x4c:pb,Nub:sb,hdd:ob}=K(jb,hb,pb)).returnValue)return{returnValue:!1,index:0};if(!sb)return{returnValue:!0,index:pb};if(R(jb,pb,ob))return{returnValue:!0,index:pb+1};a.a.instance.Ua(18969442,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [GraphNodeId: {0}] [Cp: {1}] [MergeBlocks: {2}]",
hb,ob,jb.Qr());return{returnValue:!1,index:0}},Z=(jb,hb,pb)=>{let ob;if(!({Nub:ob,LUh:hb,KUh:pb}=G(jb,hb,pb)).returnValue)return{returnValue:!1,index:0};if(!ob)return{returnValue:!0,index:hb};if(R(jb,hb,pb))return{returnValue:!0,index:hb+1};a.a.instance.Ua(574433311,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [Cp: {1}] [MergeBlocks: {2}]",pb,jb.Qr());return{returnValue:!1,index:0}},T=(jb,hb)=>{let pb;pb=0;for(let ob=0;ob<jb.length;ob++)if(jb.K(ob).wk.equals(hb))return pb=ob,{returnValue:!0,
idx:pb};a.a.instance.Ua(18969443,1,5,"TryGetFirstIdxForGraphNodeId: Unable to find first idx [GraphNodeId: {0}] [MergeBlocks: {1}]",hb,jb.Qr());return{returnValue:!1,idx:pb}},N=(jb,hb)=>{let pb;pb=-1;for(let ob=hb;ob<jb.length;ob++)if(2===jb.K(ob).type)return pb=ob,{returnValue:!0,Cka:pb};a.a.instance.Ua(18969472,1,5,"TryGetIdxNextEop: Unable to find first idx [Index: {0}] [MergeBlocks: {1}]",hb,jb.Qr());return{returnValue:!1,Cka:pb}},U=(jb,hb,pb)=>{let ob;ob=-1;for(let sb=pb;sb<jb.length;sb++)if(2===
jb.K(sb).type&&jb.K(sb).wk.equals(hb))return ob=sb,{returnValue:!0,Cka:ob};a.a.instance.Ua(18969473,1,5,"TryGetIdxNextEopForGraphNodeId: Unable to find EOP [GraphNodeId: {0}] [Index: {1}] [MergeBlocks: {2}]",hb,pb,jb.Qr());return{returnValue:!1,Cka:ob}},ba=(jb,hb)=>{let pb;pb=0;var ob;if(!({idx:ob}=T(jb,hb)).returnValue)return a.a.instance.Ua(17342616,1,2,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",hb,jb),{returnValue:!1,length:pb};for(;ob<jb.length;ob++)if(6!==jb.K(ob).type){if(2===jb.K(ob).type)return{returnValue:!0,
length:pb};a.a.instance.shipAssertTag(17342617,1,jb.K(ob).B7(),"We found something other than text with type "+jb.K(ob).type);a.a.instance.shipAssertTag(17877021,1,jb.K(ob).wk.equals(hb),"Unexpected GraphNodeId {0} for ParaId {1}",jb.K(ob).wk,hb);pb+=jb.K(ob).length}a.a.instance.Ua(18969474,1,5,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",hb,jb);return{returnValue:!1,length:pb}},X=jb=>{const hb=new l.a;for(let pb=0;pb<jb.length;pb++)hb.add(jb.K(pb).clone());return hb};var Y=d(1517),ca=d(1459);
class ia{constructor(jb,hb,pb=null,ob=null){this.wk=jb;this.type=hb;this.text=pb;this.Yc=ob}isEqual(jb){return jb.wk.equals(this.wk)&&this.type===jb.type&&this.Yc===jb.Yc&&ca.a.ESh(this.text,jb.text)}toString(){let jb=String.format("[GraphNodeId: {0}] [WordId: {1}] [MergeBlockType: {2}]",this.wk,this.Yc,this.type);this.text&&(jb+=String.format(" [TextLength: {0}]",this.text.length));return jb}}Object(J.a)(ia,"MergeBlockValidationState",null,[]);var la=d(252),ta=d(866),za=d(867),Ha=d(473),Na=d(474),
ya=d(865),ma=d(864),Ea=d(1440),Ba=d(1722),$a;(function(jb){jb[jb.Qj=1]="base";jb[jb.CXp=2]="favoredUpdate";jb[jb.rlq=4]="unfavoredUpdate";jb[jb.min=1]="min";jb[jb.max=7]="max"})($a||($a={}));Object(J.b)("MergeBlockSource",$a);class ea{constructor(jb,hb,pb,ob){this.Og=jb;this.cp=hb;this.ySd=pb;this.Nsd=ob}}Object(J.a)(ea,"MergedListBlocksWithUpdatedFormattingIds",null,[]);var ka=d(1514);class La extends ka.a{constructor(jb,hb){super(6,jb,hb);this.Yc=0}toString(){return String.format("{0} [GraphNodeId: {1}]",
super.toString(),this.wk)}Qic(){return"Selection"}clone(){return new La(this.source,this.wk)}VB(){return!1}get length(){return 0}}Object(J.a)(La,"SelectionMergeBlock",ka.a,[]);var va;(function(jb){jb[jb.success=0]="success";jb[jb.Tgq=1]="selfSplit";jb[jb.R$p=2]="noSecondaryBlockToSplit";jb[jb.plq=3]="unexpected"})(va||(va={}));Object(J.b)("SplitTwinListResult",va);var Ca=d(1579);class ua extends Ca.a{constructor(jb,hb,pb,ob){super(5,jb,hb);this._text=null;this.Vnd(pb);this.sPk=ob}get text(){return this._text}Vnd(jb){this._text=
jb}get tsd(){return this.sPk}clone(){return new ua(this.source,this.wk,this.text,this.tsd)}get Aeb(){return this.text&&this.text.length?!0:!1}toString(){return String.format("{0}",super.toString())}}Object(J.a)(ua,"UpdateHintTextMergeBlock",Ca.a,[]);class Sa{constructor(jb,hb,pb,ob){this.E5=!1;this.kkb=new z.a;this.ee=jb;this.YHh=ob;this.Z9g=pb;this._base=hb;this.xOe=X(hb);if(!P(this.Qj,this.Ze))throw a.a.instance.Ua(574133957,1,2,"LcsTwinList ConnectList: Length not equal"),jb.logger.Pi(Object.assign(new Ea.a,
{info:"TwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get Qj(){return this._base}get Ze(){return this.xOe}get Ccd(){return this.E5}Xhf(jb,hb){switch(jb.type){case 1:return this.M5k(jb,hb);case 2:return this.vhf(jb,hb);case 3:return this.M6k(jb,hb);case 4:return this.g6k(jb);case 5:return this.d5k(jb,hb);case 6:return this.thf(jb);default:return!1}}Whf(jb,hb){switch(jb.type){case 1:return this.zhf(jb,hb);case 2:return this.uhf(jb,hb);case 3:return this.L6k(jb,hb);case 4:return this.f6k(jb);
case 5:return this.c5k(jb,hb);case 6:return this.shf(jb);default:return{returnValue:!1,vv:null}}}M5k(jb,hb){let pb;const ob=({vla:pb}=this.iOa(jb.Og,hb,!1,jb.cp,!1,"ApplyInsertTextHintToDerived")).returnValue;if(0!==ob&&1!==ob)return 3!==ob&&(a.a.instance.Ua(590202197,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToDerived for mergeBlockSource {0}: {1}",$a[hb],va[ob]),this.ee.logger.Pi(Object.assign(new Ba.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vv"}))),!1;this.E5=
!1;hb=new ua(hb,jb.Og,jb.text,jb.id);this.xUf(jb,pb,hb);return!0}vhf(jb,hb){let pb,ob=({vla:pb}=this.iOa(jb.Og,hb,!1,jb.cp,!1,"ApplyDeleteTextHintToDerived Start")).returnValue;if(0!==ob&&1!==ob)return 3!==ob&&(a.a.instance.Ua(590202198,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (start) for mergeBlockSource {0}: {1}",$a[hb],va[ob]),this.ee.logger.Pi(Object.assign(new Ba.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vw"}))),!1;let sb;({vla:sb,returnValue:ob}=
this.iOa(jb.Og,hb,!1,jb.cp+jb.text.length,!1,"ApplyDeleteTextHintToDerived End"));if(0!==ob&&1!==ob)return 3!==ob&&(a.a.instance.Ua(590202199,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (end) for mergeBlockSource {0}: {1}",$a[hb],va[ob]),this.ee.logger.Pi(Object.assign(new Ba.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vx"}))),!1;this.E5=!1;this.nvf(jb,pb,sb);return!0}M6k(jb,hb){let pb;const ob=({MSf:pb}=this.Eyi(jb,hb,!1)).returnValue;if(0!==ob&&1!==ob)return 3!==
ob&&(a.a.instance.Ua(590202200,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToDerived for mergeBlockSource {0}: {1}",$a[hb],va[ob]),this.ee.logger.Pi(Object.assign(new Ba.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vy"}))),!1;this.E5=!1;hb=new I.a(hb,jb.Wu,jb.Dya);this.xUf(jb,pb,hb);return!0}g6k(jb){let hb;if(!({R$d:hb}=this.Fyi(jb,this.Ze,"Derived")).returnValue)return!1;this.nvf(jb,hb,hb+1);return!0}d5k(jb,hb){let pb;if(!({K7f:hb,LSf:pb}=this.zAi(jb,!1,hb)).returnValue)return!1;
this.xUf(jb,pb,hb);return!0}thf(jb){let hb;if(!({Q$d:hb}=this.wyi(jb,this.Ze,"Derived")).returnValue)return!1;this.nvf(jb,hb,hb+1);return!0}NRh(jb,hb,pb){const ob=({vla:hb}=this.iOa(jb,pb,!1,hb,!0,"ApplyInsertCpPlaceHolderHintToDerived")).returnValue;if(0!==ob&&1!==ob)return 3!==ob&&(a.a.instance.Ua(590202201,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToDerived for mergeBlockSource {0}: {1}",$a[pb],va[ob]),this.ee.logger.Pi(Object.assign(new Ba.a,{$j:"ParagraphMergeUsingHintsTwinList",
eventId:"9l2vz"}))),!1;this.E5=!1;jb=new La(pb,jb);this.Ze.insert(hb,jb);return!0}zhf(jb,hb){var pb=null;if(Sa.jWi(jb.text.length))return{returnValue:!1,vv:pb};let ob,sb,Ab;var nc=({vla:ob,vBa:sb,aka:Ab}=this.iOa(jb.Og,hb,!0,jb.cp,!1,"ApplyInsertTextHintToBaseAndDerived")).returnValue;if(0!==nc&&2!==nc)return 3!==nc&&(a.a.instance.Ua(590202202,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToBaseAndDerived for mergeBlockSource {0}: {1}",$a[hb],va[nc]),this.ee.logger.Pi(Object.assign(new Ba.a,
{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v0"}))),{returnValue:!1,vv:pb};this.E5=!1;({Cka:nc}=N(this.Ze,sb));nc=this.Ze.K(nc).wk;pb=new ua(hb,jb.Og,jb.text,jb.id);hb=new ua(hb,nc,jb.text,jb.id);pb.yn=hb;hb.yn=pb;this.Qj.insert(ob,pb);this.Ze.insert(sb,hb);pb=new l.a;pb.add(new Na.a(nc,Ab,jb.text,jb.id,jb.Kv));return{returnValue:!0,vv:pb}}uhf(jb,hb){let pb;pb=null;if(Sa.jWi(jb.text.length))return{returnValue:!1,vv:pb};let ob;var sb,Ab=({vla:ob,vBa:nc,aka:sb}=this.iOa(jb.Og,hb,!0,jb.cp,!1,
"ApplyDeleteTextHintToBaseAndDerived Start")).returnValue;if(0!==Ab){if(2!==Ab)return 3!==Ab&&(a.a.instance.Ua(590202203,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (start) for mergeBlockSource {0}: {1}",$a[hb],va[Ab]),this.ee.logger.Pi(Object.assign(new Ba.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v1"}))),{returnValue:!1,vv:pb};var nc=0;for({idx:sb}=T(this.Qj,jb.Og);sb<this.Qj.length&&nc<jb.cp;sb++)nc+=this.Qj.K(sb).length;nc-=this.Qj.K(sb-1).length;
({vBa:nc,aka:sb,returnValue:Ab}=this.iOa(jb.Og,hb,!0,nc,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Ab)return 3!==Ab&&(a.a.instance.Ua(590202204,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback start) for mergeBlockSource {0}: {1}",$a[hb],va[Ab]),this.ee.logger.Pi(Object.assign(new Ba.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v2"}))),{returnValue:!1,vv:pb};this.E5=!1}var qc,Jc;({vla:qc,vBa:Jc,aka:ad,returnValue:Ab}=this.iOa(jb.Og,
hb,!0,jb.cp+jb.text.length,!1,"ApplyDeleteTextHintToBaseAndDerived End"));if(0!==Ab){if(2!==Ab)return 3!==Ab&&(a.a.instance.Ua(590202205,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (end) for mergeBlockSource {0}: {1}",$a[hb],va[Ab]),this.ee.logger.Pi(Object.assign(new Ba.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v3"}))),{returnValue:!1,vv:pb};var ad=0;for({idx:Jc}=T(this.Qj,jb.Og);Jc<this.Qj.length&&ad<jb.cp+jb.text.length;Jc++)ad+=this.Qj.K(Jc).length;
({vBa:Jc,aka:ad,returnValue:Ab}=this.iOa(jb.Og,hb,!0,ad,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Ab)return 3!==Ab&&(a.a.instance.Ua(590202206,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback end) for mergeBlockSource {0}: {1}",$a[hb],va[Ab]),this.ee.logger.Pi(Object.assign(new Ba.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v4"}))),{returnValue:!1,vv:pb};this.E5=!1}hb="";pb=new l.a;for(--Jc;Jc>=nc;Jc--)if(6!==this.Ze.K(Jc).type)if(this.Ze.K(Jc).yn)hb=
this.Ze.K(Jc).text+hb,this.Ze.YH(Jc);else{if(5===this.Ze.K(Jc).type)Ab=ad-hb.length;else if(2===this.Ze.K(Jc).type){if(Ab=0,!({length:ad}=ba(this.Ze,this.Ze.K(Jc).wk)).returnValue)return a.a.instance.Ua(589603462,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetTextLengthForParaId failed"),this.ee.logger.Pi(Object.assign(new Ba.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkg"})),{returnValue:!1,vv:pb}}else return a.a.instance.Ua(589898051,1,2,"ApplyDeleteTextHintToBaseAndDerived: Unexpected block type missing twin"),
this.ee.logger.Pi(Object.assign(new Ba.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9ksfd"})),{returnValue:!1,vv:pb};if(!({Cka:Kc}=N(this.Ze,Jc+1)).returnValue)return a.a.instance.Ua(589603463,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.ee.logger.Pi(Object.assign(new Ba.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkh"})),{returnValue:!1,vv:pb};var Kc=this.Ze.K(Kc).wk;pb.add(new Ha.a(Kc,Ab,hb));hb=""}for(--qc;qc>=ob;qc--)this.Qj.YH(qc);if(!({Cka:Kc}=N(this.Ze,
nc)).returnValue)return a.a.instance.Ua(589603464,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.ee.logger.Pi(Object.assign(new Ba.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9jkki"})),{returnValue:!1,vv:pb};Kc=this.Ze.K(Kc).wk;hb&&hb.length&&pb.add(new Ha.a(Kc,sb,hb,jb.id,jb.Kv));return{returnValue:!0,vv:pb}}L6k(jb,hb){var pb=null;let ob,sb,Ab;var nc=({MSf:ob,tOi:sb,aka:Ab}=this.Eyi(jb,hb,!0)).returnValue;if(0!==nc)return 3!==nc&&(a.a.instance.Ua(590202207,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToBaseAndDerived for mergeBlockSource {0}: {1}",
$a[hb],va[nc]),this.ee.logger.Pi(Object.assign(new Ba.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v5"}))),{returnValue:!1,vv:pb};var qc;if(!({Cka:qc}=N(this.Ze,sb)).returnValue)return a.a.instance.Ua(17342618,1,2,"ApplySplitParaHintToBaseAndDerived: Could not find corrsponding block in derived list."),{returnValue:!1,vv:pb};nc=this.Ze.K(qc).wk;const Jc=this.Ze.K(qc).Yc;let ad,Kc,Jb;({Wu:qc,Q$:ad,Dya:Kc,kea:Jb}=this.xym(jb,qc));this.q_h(this.Ze,qc,ad,Jb,sb);pb=new I.a(hb,jb.Wu,jb.Dya);hb=
new I.a(hb,qc,Kc);pb.yn=hb;hb.yn=pb;this.Qj.insert(ob,pb);this.Ze.insert(sb,hb);pb=new l.a;pb.add(new ma.a(nc,Jc,Ab,qc,Kc,ad,Jb,jb.id,jb.Kv));return{returnValue:!0,vv:pb}}f6k(jb){let hb;hb=null;let pb,ob;var sb;if(!({R$d:pb}=this.Fyi(jb,this.Qj,"Base")).returnValue)return{returnValue:!1,vv:hb};if(!this.Qj.K(pb).yn||!({Cka:ob}=U(this.Ze,this.Qj.K(pb).yn.wk,0)).returnValue)return a.a.instance.Ua(17342619,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),
this.ee.logger.Pi(Object.assign(new Ba.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"bckc1"})),this.E5=!0,{returnValue:!1,vv:hb};if(!({Cka:sb}=N(this.Ze,ob+1)).returnValue)return a.a.instance.Ua(17342620,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation as the below para on derived after merge is null"),this.ee.logger.Pi(Object.assign(new Ba.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"bckc2"})),this.E5=!0,{returnValue:!1,vv:hb};let Ab,nc,qc,Jc,ad,Kc;({qbb:sb,rbb:qc,Gag:Ab,
sNn:Jc,cNn:nc,dNn:ad}=this.Zlm(jb,ob,sb));if(!({length:Kc}=ba(this.Ze,sb)).returnValue)return{returnValue:!1,vv:hb};this.p_h(this.Ze,sb,qc,ob);this.Ze.YH(ob);this.Qj.YH(pb);hb=new l.a;hb.add(new ya.a(Ab,Jc,Kc,nc,ad,sb,qc,jb.id,jb.Kv));return{returnValue:!0,vv:hb}}c5k(jb,hb){var pb=null;let ob,sb,Ab;if(!({K7f:Ab,LSf:ob}=this.zAi(jb,!0,hb)).returnValue)return{returnValue:!1,vv:pb};if(!({Lrb:sb}=this.M2c(this.Qj,this.Ze,ob,!0)).returnValue)return a.a.instance.Ua(17146332,1,2,"ApplyAddParaHintToBaseAndDerived: We could not find the corresponding index in the Derived list."),
{returnValue:!1,vv:pb};if(0<sb&&2!==this.Ze.K(sb-1).type)return a.a.instance.Ua(17342621,1,2,"ApplyAddParaHintToBaseAndDerived: We cannot insert a new para in a middle of an existing para"),this.ee.logger.Pi(Object.assign(new Ba.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"bckc3"})),this.E5=!0,{returnValue:!1,vv:pb};let nc;if(!({Wu:nc}=this.cri(sb)).returnValue)return{returnValue:!1,vv:pb};hb=new I.a(hb,jb.Og,jb.Yc);pb=Ab;pb.yn=hb;hb.yn=pb;this.Qj.insert(ob,Ab);this.Ze.insert(sb,hb);pb=new l.a;
pb.add(new ta.a(jb.Og,jb.Yc,nc,jb.id,jb.Kv));return{returnValue:!0,vv:pb}}shf(jb){let hb;hb=null;let pb;var ob;if(!({Q$d:ob}=this.wyi(jb,this.Qj,"Base")).returnValue)return{returnValue:!1,vv:hb};if(!this.Qj.K(ob).yn||!this.Qj.K(ob).yn.wk.equals(jb.Og))return a.a.instance.Ua(17135243,1,2,"ApplyDeleteParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.ee.logger.Pi(Object.assign(new Ba.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0l"})),
this.E5=!0,{returnValue:!1,vv:hb};if(!({Lrb:pb}=this.M2c(this.Qj,this.Ze,ob,!0)).returnValue)return a.a.instance.Ua(17135244,1,2,"ApplyDeleteParaHintToBaseAndDerived: Possibly bad merge hints provided"),{returnValue:!1,vv:hb};if(0<pb&&2!==this.Ze.K(pb).type)return a.a.instance.Ua(17135245,1,2,"ApplyDeleteParaHintToBaseAndDerived: Detected new or leftover content in the list"),this.ee.logger.Pi(Object.assign(new Ba.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0n"})),this.E5=!0,{returnValue:!1,
vv:hb};const sb=this.Ze.K(pb).wk,Ab=this.Ze.K(pb).Yc;this.Ze.YH(pb);this.Qj.YH(ob);({Wu:ob}=this.cri(pb));0<pb&&6===this.Ze.K(pb-1).type&&this.bao(pb-1,ob);hb=new l.a;hb.add(new za.a(sb,Ab,ob,jb.id,jb.Kv));return{returnValue:!0,vv:hb}}MRh(jb,hb,pb){let ob;var sb=({vla:hb,vBa:ob}=this.iOa(jb,pb,!0,hb,!0,"ApplyInsertCpPlaceHolderHintToBaseAndDerived")).returnValue;if(0!==sb)return 3!==sb&&(a.a.instance.Ua(590202208,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToBaseAndDerived for mergeBlockSource {0}: {1}",
$a[pb],va[sb]),this.ee.logger.Pi(Object.assign(new Ba.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v6"}))),!1;({Cka:sb}=N(this.Ze,ob));sb=this.Ze.K(sb).wk;jb=new La(pb,jb);pb=new La(pb,sb);jb.yn=pb;pb.yn=jb;this.Qj.insert(hb,jb);this.Ze.insert(ob,pb);return!0}Zlm(jb,hb,pb){let ob,sb,Ab;ob=jb.qbb.equals(jb.Og)?this.Ze.K(hb).wk:this.Ze.K(pb).wk;jb=jb.rbb===jb.Yc?this.Ze.K(hb).Yc:this.Ze.K(pb).Yc;sb=this.Ze.K(hb).wk;hb=this.Ze.K(hb).Yc;Ab=this.Ze.K(pb).wk;pb=this.Ze.K(pb).Yc;return{qbb:ob,rbb:jb,
Gag:sb,sNn:hb,cNn:Ab,dNn:pb}}xym(jb,hb){let pb;var ob=jb.Og.equals(jb.Wu)?jb.Q$:jb.Wu;const sb=jb.Yc===jb.Dya?jb.kea:jb.Dya;jb.Og.equals(jb.Wu)?pb=this.Ze.K(hb).wk:(pb=ob,ob=this.Ze.K(hb).wk);jb.Yc===jb.Dya?(jb=this.Ze.K(hb).Yc,hb=sb):(jb=sb,hb=this.Ze.K(hb).Yc);return{Wu:pb,Q$:ob,Dya:jb,kea:hb}}r_h(jb,hb,pb,ob){for(;ob<jb.length;ob++){if(!jb.K(ob).B7()&&6!==jb.K(ob).type&&2!==jb.K(ob).type){a.a.instance.shipAssertTag(17311188,1,!1,"Found merge block of type "+jb.K(ob).type);break}jb.K(ob).wk=hb;
if(2===jb.K(ob).type){jb.K(ob).Yc=pb;break}}}q_h(jb,hb,pb,ob,sb){this.r_h(jb,pb,ob,sb);Sa.s_h(jb,hb,sb)}p_h(jb,hb,pb,ob){this.r_h(jb,hb,pb,ob+1);Sa.s_h(jb,hb,ob)}Fyi(jb,hb,pb){let ob,sb=-1;if(!({Cka:ob}=U(hb,jb.Og,0)).returnValue)return a.a.instance.Ua(17342622,1,2,"GetIndicesForMergePara: Failed to find index of EOP in "+pb+"for GraphNodeId "+jb.Og),{returnValue:!1,R$d:ob};if(!({Cka:sb}=N(hb,ob+1)).returnValue||!hb.K(sb).wk.equals(jb.Q$))return a.a.instance.Ua(17342623,1,2,"GetIndicesForMergePara: Failed to find index "+
ob+1+" in "+pb+" of length "+hb.length),{returnValue:!1,R$d:ob};this.p_h(hb,jb.qbb,jb.rbb,ob);return{returnValue:!0,R$d:ob}}Eyi(jb,hb,pb){let ob;const sb=pb?this.Qj:this.Ze,Ab=pb?"Base":"Derived",nc=({vla:hb,vBa:pb,aka:ob}=this.iOa(jb.Og,hb,pb,jb.cp,!1,"GetIndicesAndCpForSplitPara")).returnValue;if(3===nc||2===nc)return a.a.instance.Ua(17311189,1,2,"GetIndicesAndCpForSplitPara: Failed to find indices and Cp for "+Ab),{returnValue:nc,MSf:hb,tOi:pb,aka:ob};this.q_h(sb,jb.Wu,jb.Q$,jb.kea,hb);return{returnValue:nc,
MSf:hb,tOi:pb,aka:ob}}wyi(jb,hb,pb){return({idx:jb}=T(hb,jb.Og)).returnValue?2!==hb.K(jb).type?(a.a.instance.Ua(17156034,1,2,"GetIndexForDeletePara: Found merge block that is not a zero length merge block "+pb),{returnValue:!1,Q$d:-1}):{returnValue:!0,Q$d:jb}:(a.a.instance.Ua(17156033,1,2,"GetIndexForDeletePara: Failed to find the para in "+pb),{returnValue:!1,Q$d:-1})}bao(jb,hb){var pb=this.Ze.K(jb);if(hb){let ob;({Cka:ob}=U(this.Ze,hb,0));pb=pb.clone();pb.wk=hb;this.Ze.YH(jb);this.Ze.insert(ob,
pb)}else this.Ze.length>jb&&(this.Ze.K(jb+1).B7()||2===this.Ze.K(jb+1).type)&&(pb.wk=this.Ze.K(jb+1).wk)}zAi(jb,hb,pb){var ob=hb?this.Qj:this.Ze;hb=hb?"Base":"Derived";pb=new I.a(pb,jb.Og,jb.Yc);if(jb.Wu){if(!({Cka:ob}=U(ob,jb.Wu,0)).returnValue)return a.a.instance.Ua(17146333,1,2,"GetMergeBlockAndIndexToInsertForAddPara: We could not find [AboveParaId: {0}] in {1}",jb.Wu,hb),{returnValue:!1,K7f:pb,LSf:ob};ob+=1}else ob=0;return{returnValue:!0,K7f:pb,LSf:ob}}cri(jb){let hb;hb=null;let pb=jb-1;if(-1===
pb)return{returnValue:!0,Wu:hb};6===this.Ze.K(pb).type&&pb--;if(2===this.Ze.K(pb).type||4===this.Ze.K(pb).type)return hb=this.Ze.K(pb).wk,{returnValue:!0,Wu:hb};a.a.instance.Ua(17342934,1,2,"GetAboveParaIdFromDerived: We found an unexpected block [Type: {0}] above",this.Ze.K(jb-1).type);return{returnValue:!1,Wu:hb}}M2c(jb,hb,pb,ob){let sb,Ab=!0;sb=-1;if(pb>jb.length)return a.a.instance.Ua(17146334,1,2,"GetIndexInSecondary: Index supplied for the primary is out of bounds"),{returnValue:!1,Lrb:sb};
if(pb<jb.length){if(-1<pb&&pb<jb.length&&!jb.K(pb).yn){Ab=!1;for(var nc=pb+1;nc<jb.length;nc++)if(jb.K(nc).yn){pb=nc;Ab=!0;break}}if(!Ab)return{returnValue:!1,Lrb:sb};Ab=!1;for(nc=0;jb.K(pb)&&nc<hb.length;nc++)if(hb.K(nc).yn===jb.K(pb)){sb=nc;Ab=!0;break}if(!Ab)return{returnValue:!1,Lrb:sb}}else sb=hb.length;if(0<sb&&ob&&!hb.K(sb-1).yn){for(jb=sb-1;0<=jb&&!hb.K(jb).yn;jb--);sb=jb+1;6===hb.K(sb).type&&5!==this.ee.input.source&&sb++}return{returnValue:!0,Lrb:sb}}iOa(jb,hb,pb,ob,sb,Ab){let nc;var qc;
let Jc;var ad=this.Qj;let Kc=this.Ze,Jb=!1;pb||(ad=this.Ze,Kc=this.Qj);Jc=qc=nc=0;let Zb,xb,$b=0;if(!({x4c:ob,Nub:Zb,hdd:xb}=K(ad,jb,ob)).returnValue)return a.a.instance.Ua(17044295,1,2,"SplitTwinListAtCpForHint: Unable to find the merge block to split at given Cp. It most likely means that our update hints are not complete"),{returnValue:3,vla:nc,vBa:qc,aka:Jc};0<=ob&&ob<ad.length&&!ad.K(ob).yn&&Zb&&!sb&&(a.a.instance.Ua(17044296,1,4,"SplitTwinListAtCpForHint: We are trying to split a merge block that is deleted in the other revision. Failing merge. Called from {0}",
Ab),this.E5=!0,$b=hb===ad.K(ob).source?1:2,Jb=!0);sb&&!ad.K(ob)&&ob--;sb&&Zb&&!ad.K(ob).yn&&(Zb=!1,xb=0);if(!pb&&!({idx:jb}=T(Kc,jb)).returnValue&&!Zb)return{returnValue:0,vla:ob,vBa:qc,aka:Jc};if(!({Lrb:jb}=this.M2c(ad,Kc,ob,pb&&!Zb)).returnValue&&!Jb&&(hb=!1,1===this.YHh&&0<ob&&!xb&&(ob--,{Lrb:jb,returnValue:hb}=this.M2c(ad,Kc,ob,pb&&!Zb),hb&&(ob++,jb<Kc.length-1?jb++:hb=!1)),!hb))return a.a.instance.Ua(17156037,1,2,"SplitTwinListAtCpForHint: We are trying to find index in derived when the para most likley doesn't exist."),
this.ee.logger.Pi(Object.assign(new Ba.a,{$j:"ParagraphMergeUsingHintsTwinList",eventId:"bb25f"})),this.E5=!0,{returnValue:3,vla:nc,vBa:qc,aka:Jc};if(Zb&&(!R(ad,ob,xb)||!Jb&&!R(Kc,jb,xb)))return a.a.instance.shipAssertTag(17044297,1,!1,"SplitTwinListAtCpForHint: Unable find the twin in secondary or unable to split the lists when a split was needed"),{returnValue:3,vla:nc,vBa:qc,aka:Jc};nc=ob;qc=jb;Zb&&(nc=ob+1,Jb||(qc=ad.K(ob),pb=Kc.K(jb),qc.yn=pb,pb.yn=qc,ad=ad.K(ob+1),qc=Kc.K(jb+1),ad.yn=qc,qc.yn=
ad,qc=jb+1));if(qc>=Kc.length)return a.a.instance.shipAssertTag(17311190,1,!1,"SplitTwinListAtCpForHint: We are in bad state. indexInSecondary was "+qc+" secondaryList length was "+Kc.length),{returnValue:3,vla:nc,vBa:qc,aka:Jc};for(ad=0;ad<qc;ad++)Kc.K(ad).wk.equals(Kc.K(qc).wk)&&(Jc+=Kc.K(ad).length);return{returnValue:$b,vla:nc,vBa:qc,aka:Jc}}nvf(jb,hb,pb){this.Z9g.contains(jb.id)&&this.kkb.Z(jb.id,new l.a);for(--pb;pb>=hb;pb--)this.Z9g.contains(jb.id)?this.kkb.K(jb.id).insert(this.kkb.K(jb.id).length,
this.Ze.K(pb)):this.Ze.K(pb).yn&&(this.Ze.K(pb).yn.yn=null),this.Ze.YH(pb)}xUf(jb,hb,pb){if(this.kkb.lb(jb.Kv)){const ob=this.kkb.K(jb.Kv);for(let sb=0;sb<ob.length;sb++)ob.K(sb).wk=pb.wk,Object(la.a)(I.a,pb)&&Object(la.a)(I.a,ob.K(sb))&&(ob.K(sb).Yc=pb.Yc);this.Ze.iD(hb,this.kkb.K(jb.Kv));this.kkb.remove(jb.Kv)}else this.Ze.insert(hb,pb)}XMm(jb){let hb,pb;pb=hb=-1;if(!jb.yn)return{returnValue:!1,egc:hb,Kvf:pb};var ob;let sb=0,Ab=!1;if(!({idx:ob}=T(this.Ze,jb.yn.wk)).returnValue)return{returnValue:!1,
egc:hb,Kvf:pb};for(;ob<this.Ze.length;ob++){if(jb.yn===this.Ze.K(ob)){hb=ob;pb=sb;Ab=!0;break}sb+=this.Ze.K(ob).length}return{returnValue:Ab,egc:hb,Kvf:pb}}sCf(jb){let hb;hb=new l.a;let pb=0,ob=0;for(;pb<jb.length;){if(ob>=this.Qj.length)return a.a.instance.shipAssertTag(17335388,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),{returnValue:!1,Zzc:hb};if(jb.K(pb).length>this.Qj.K(ob).length){if(!R(jb,pb,this.Qj.K(ob).length))return a.a.instance.Ua(17335389,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision MergeBlock [Idx: {0}] at [Cp: {1}]",
pb,this.Qj.K(ob).length),{returnValue:!1,Zzc:hb}}else if(jb.K(pb).length<this.Qj.K(ob).length){var sb=!!this.Qj.K(ob).yn,Ab=0;if(sb&&!({Lrb:Ab}=this.M2c(this.Qj,this.Ze,ob,!1)).returnValue)return a.a.instance.shipAssertTag(17335390,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Base Merge Block at [Idx: {0}] has a Twin, but we are unable to find it",ob),{returnValue:!1,Zzc:hb};if(!R(this.Qj,ob,jb.K(pb).length)||sb&&!R(this.Ze,Ab,jb.K(pb).length))return a.a.instance.Ua(17335391,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split Base and/or Derived Merge blocks"),
{returnValue:!1,Zzc:hb};if(sb){sb=this.Qj.K(ob);var nc=this.Ze.K(Ab);sb.yn=nc;nc.yn=sb;sb=this.Qj.K(ob+1);Ab=this.Ze.K(Ab+1);sb.yn=Ab;Ab.yn=sb}}if(this.Qj.K(ob).yn&&5!==this.Qj.K(ob).type&&this.Qj.K(ob).B7()&&(Ab=this.Qj.K(ob),sb=jb.K(pb),!Ab.oL.equals(sb.oL)||!Ab.bA.VB(sb.bA))){let qc;if(!({egc:nc,Kvf:qc}=this.XMm(this.Qj.K(ob))).returnValue)return{returnValue:!1,Zzc:hb};hb.add(new ea(this.Ze.K(nc).wk,qc,Ab,sb))}pb++;ob++}return{returnValue:!0,Zzc:hb}}static s_h(jb,hb,pb){for(--pb;0<=pb;pb--){if(!jb.K(pb).B7()&&
6!==jb.K(pb).type){a.a.instance.shipAssertTag(17311187,1,2===jb.K(pb).type||4===jb.K(pb).type,"Found merge block of type "+jb.K(pb).type);break}jb.K(pb).wk=hb}}static jWi(jb){return jb?!1:(a.a.instance.Ua(17156036,1,2,"IsEmptyRunUpdateHint: We are trying to insert an empty run. It is likely we have bad merge hints."),!0)}}Object(J.a)(Sa,"ParagraphMergeUsingHintsTwinList",null,[1439]);var Ta=d(1720),zb=d(1721),Ra=d(1717),qb=d(1719),kb=d(1718);class Va{constructor(jb,hb,pb,ob){this.cp=jb;this.length=
hb;this.ySd=pb;this.Nsd=ob}}Object(J.a)(Va,"UpdateFormattingIdsPosInfo",null,[]);class Za{constructor(jb,hb,pb){this.E5=!1;this.kkb=new z.a;this.xth=!1;this.ee=jb;this.YHh=pb;this._base=hb;this.xOe=X(hb);if(!P(this.Qj,this.Ze))throw a.a.instance.Ua(574133956,1,2,"LcsTwinList ConnectList: Length not equal"),jb.logger.Pi(Object.assign(new C.a,{info:"LcsTwinList ConnectList: Length not equal"})),Error.create("ConnectList");this.ee.runtime.sc.frb(1000010)&&(this.xth=!0)}get Qj(){return this._base}get Ze(){return this.xOe}get Ccd(){return this.E5}Xhf(jb,
hb){switch(jb.type){case 11:return this.K5k(jb,hb);case 8:return this.vhf(jb,hb);case 10:return this.thf(jb);default:return!1}}Whf(jb,hb){switch(jb.type){case 11:return this.J5k(jb,hb);case 8:return this.uhf(jb,hb);case 10:return this.shf(jb);default:return{returnValue:!1,vv:null}}}NRh(){a.a.instance.Ua(574433295,1,2,"ApplyInsertCpPlaceHolderHintToDerived not implemented");this.ee.logger.Pi(Object.assign(new C.a,{$j:"ApplyInsertCpPlaceHolderHintToDerived",eventId:"8ps6p"}));return!1}MRh(){a.a.instance.Ua(574433296,
1,2,"ApplyInsertCpPlaceHolderHintToBaseAndDerived not implemented");this.ee.logger.Pi(Object.assign(new C.a,{$j:"ApplyInsertCpPlaceHolderHintToBaseAndDerived",eventId:"8ps6q"}));return!1}sCf(jb){let hb;hb=new l.a;let pb=0,ob=0,sb=0;for(;pb<jb.length;){if(ob>=this.Qj.length)return a.a.instance.shipAssertTag(574433297,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),this.ee.logger.Pi(Object.assign(new C.a,{$j:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6r"})),
{returnValue:!1,Msd:hb};if(jb.K(pb).length>this.Qj.K(ob).length){if(!R(jb,pb,this.Qj.K(ob).length))return a.a.instance.Ua(574433298,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision"),this.ee.logger.Pi(Object.assign(new C.a,{$j:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6s"})),{returnValue:!1,Msd:hb}}else if(jb.K(pb).length<this.Qj.K(ob).length&&!this.seb(sb+jb.K(pb).length,!0).returnValue)return a.a.instance.Ua(574433299,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split"),
this.ee.logger.Pi(Object.assign(new C.a,{$j:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6t"})),{returnValue:!1,Msd:hb};if(this.Qj.K(ob).yn&&5!==this.Qj.K(ob).type&&this.Qj.K(ob).B7()){const Ab=this.Qj.K(ob),nc=jb.K(pb);if(!Ab.oL.equals(nc.oL)||!Ab.bA.VB(nc.bA)){let qc,Jc;if(({egc:qc,sdi:Jc}=this.YMm(this.Qj.K(ob))).returnValue)hb.add(new Va(Jc,this.Ze.K(qc).length,Ab,nc));else return a.a.instance.Ua(571757956,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Enable to find unfavored formatting"),
this.ee.logger.Pi(Object.assign(new C.a,{$j:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ffwe"})),{returnValue:!1,Msd:hb}}}sb+=this.Qj.K(ob).length;pb++;ob++}return{returnValue:!0,Msd:hb}}K5k(jb,hb){let pb;if(!({hJa:pb}=this.seb(jb.cp,!0)).returnValue)return a.a.instance.Ua(574433300,1,2,"ApplyInsertTextHintToDerived"),this.ee.logger.Pi(Object.assign(new C.a,{$j:"ApplyInsertTextHintToDerived",eventId:"8ps6u"})),!1;for(let sb=0;sb<jb.W2.length;sb++)switch(jb.W2.K(sb).type){case 7:var ob=
jb.W2.K(sb);this.Ze.insert(pb,new ua(hb,null,ob.text,ob.id));break;case 9:ob=jb.W2.K(sb);this.Ze.insert(pb,new I.a(hb,ob.Og,ob.Yc));break;default:return a.a.instance.Ua(574433301,1,2,"ApplyInsertHintToDerived invalid hint"),this.ee.logger.Pi(Object.assign(new C.a,{$j:"ApplyInsertHintToDerived",eventId:"8ps6v"})),!1}return!0}vhf(jb,hb){let pb,ob;if(!({hJa:pb}=this.seb(jb.cp,!0)).returnValue||!({hJa:ob}=this.seb(jb.cp+jb.text.length,!1)).returnValue)return a.a.instance.Ua(575706433,1,2,"ApplyDeleteTextHintToDerived"),
this.ee.logger.Pi(Object.assign(new C.a,{$j:"ApplyDeleteTextHintToDerived",eventId:"8ujvb"})),!1;for(jb=ob;jb>=pb;jb--)this.Ze.K(jb).source!==hb&&this.fZd(this.Ze,jb);return!0}thf(jb){let hb;if(!({hJa:hb}=this.seb(jb.cp,!0)).returnValue)return a.a.instance.Ua(574433302,1,2,"ApplyDeleteParaHintToDerived"),this.ee.logger.Pi(Object.assign(new C.a,{$j:"ApplyDeleteParaHintToDerived",eventId:"8ps6w"})),!1;this.qvf(this.Ze,jb,hb);return!0}J5k(jb,hb){let pb;pb=null;let ob,sb;if(!({mKb:ob,hJa:sb}=this.seb(jb.cp,
!0)).returnValue)return a.a.instance.Ua(574433303,1,2,"ApplyInsertTextHintToBaseAndDerived unable to split"),this.ee.logger.Pi(Object.assign(new C.a,{$j:"ApplyInsertTextHintToBaseAndDerived",eventId:"8ps6x"})),{returnValue:!1,vv:pb};var Ab=this.rHf(this.Ze,sb-1);Ab=new kb.a(Ab);for(let nc=0;nc<jb.W2.length;nc++)switch(jb.W2.K(nc).type){case 7:Ab.W2.add(this.zhf(jb.W2.K(nc),hb,ob,sb));break;case 9:Ab.W2.add(this.L5k(jb.W2.K(nc),hb,ob,sb));break;default:return a.a.instance.Ua(574433304,1,2,"ApplyInsertHintToDerived invalid hint"),
this.ee.logger.Pi(Object.assign(new C.a,{$j:"ApplyInsertHintToDerived",eventId:"8ps6y"})),{returnValue:!1,vv:pb}}pb=new l.a;pb.add(Ab);return{returnValue:!0,vv:pb}}zhf(jb,hb,pb,ob){const sb=new ua(hb,jb.Og,jb.text,jb.id);hb=new ua(hb,jb.Og,jb.text,jb.id);sb.yn=hb;hb.yn=sb;this.Qj.insert(pb,sb);this.Ze.insert(ob,hb);pb=new qb.a(jb.Og,jb.text);pb.id=jb.id;return pb}L5k(jb,hb,pb,ob){const sb=new I.a(hb,jb.Og,jb.Yc);hb=new I.a(hb,jb.Og,jb.Yc);sb.yn=hb;hb.yn=sb;this.Qj.insert(pb,sb);this.Ze.insert(ob,
hb);return new Ra.a(jb.Og,jb.Yc)}uhf(jb){let hb;hb=new l.a;let pb;var ob;let sb;if(!({mKb:pb,hJa:ob}=this.seb(jb.cp,!0)).returnValue||!({mKb:sb,hJa:Ab}=this.seb(jb.cp+jb.text.length,!1)).returnValue)return a.a.instance.Ua(588001990,1,2,"ApplyDeleteTextHintToBaseAndDerived"),this.ee.logger.Pi(Object.assign(new C.a,{$j:"ApplyDeleteTextHintToBaseAndDerived",eventId:"9ddlg"})),{returnValue:!1,vv:hb};this.ee.runtime.sc.p9d(1000010);for(jb=Ab;jb>=ob;jb--)if(this.Ze.K(jb).yn){var Ab=jb;const nc=({Bag:jb}=
this.c6l(jb,ob)).returnValue;nc&&(hb.add(nc),this.fZd(this.Ze,jb,Ab))}for(ob=sb;ob>=pb;ob--)this.fZd(this.Qj,ob);return{returnValue:!0,vv:hb}}shf(jb){let hb;hb=null;let pb,ob;if(!({mKb:pb,hJa:ob}=this.seb(jb.cp,!0)).returnValue)return a.a.instance.Ua(574433305,1,2,"ApplyDeleteParaHintToBaseAndDerived"),this.ee.logger.Pi(Object.assign(new C.a,{$j:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps6z"})),{returnValue:!1,vv:hb};if(!this.qvf(this.Qj,jb,pb))return a.a.instance.Ua(574433306,1,2,"ApplyDeleteParaHintToBaseAndDerived EOP mismatch"),
this.ee.logger.Pi(Object.assign(new C.a,{$j:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps60"})),{returnValue:!1,vv:hb};this.qvf(this.Ze,jb,ob)&&(hb=new l.a,hb.add(new Ta.a(this.rHf(this.Ze,ob-1),jb.Og,jb.Yc)));return{returnValue:!0,vv:hb}}seb(jb,hb){var pb;var ob=pb=-1;let sb,Ab;if(!({Nub:Ab,LUh:jb,KUh:sb}=G(this.Qj,jb,this.ee.logger)).returnValue)return{returnValue:!1,mKb:pb,hJa:ob};const nc=jb>=this.Qj.length;nc&&jb--;if(this.Qj.K(jb).yn){const qc=this.A7l(this.Ze,this.Qj.K(jb));if(Ab){if(0>
qc||!R(this.Qj,jb,sb)||!R(this.Ze,qc,sb))return a.a.instance.Ua(575706444,1,2,"SplitTwinListAndFindIdx"),this.ee.logger.Pi(Object.assign(new C.a,{$j:"SplitTwinListAndFindIdx",eventId:"8ujvm"})),{returnValue:!1,mKb:pb,hJa:ob};pb=this.Qj.K(jb);ob=this.Ze.K(qc);pb.yn=ob;ob.yn=pb;pb=this.Qj.K(jb+1);ob=this.Ze.K(qc+1);pb.yn=ob;ob.yn=pb;pb=hb?jb+1:jb;ob=hb?qc+1:qc}else hb?(pb=nc?jb+1:jb,ob=nc?qc+1:qc):(pb=nc?jb:jb-1,ob=nc?qc:qc-1)}else if(Ab){if(R(this.Qj,jb,sb))pb=hb?jb+1:jb;else return a.a.instance.Ua(575706445,
1,2,"SplitTwinListAndFindIdx"),this.ee.logger.Pi(Object.assign(new C.a,{$j:"SplitTwinListAndFindIdx",eventId:"8ujvn"})),{returnValue:!1,mKb:pb,hJa:ob};hb?(ob=({qRb:ob}=this.Thc(this.Qj,this.Ze,jb,!1)).returnValue?ob+1:0,ob=ob>=this.Ze.length?this.Ze.length-1:ob):(ob=({qRb:ob}=this.Thc(this.Qj,this.Ze,jb,!0)).returnValue?ob-1:this.Ze.length-1,ob=0>ob?0:ob)}else hb?(({qRb:ob}=this.Thc(this.Qj,this.Ze,jb,!0)).returnValue||(({qRb:ob}=this.Thc(this.Qj,this.Ze,jb,!1)).returnValue?ob+=1:(ob=nc?this.Ze.length-
1:0,ob=0>ob?0:ob)),pb=nc?jb+1:jb):(({qRb:ob}=this.Thc(this.Qj,this.Ze,jb,!1)).returnValue||(({qRb:ob}=this.Thc(this.Qj,this.Ze,jb,!0)).returnValue?--ob:(ob=jb?this.Ze.length-1:0,ob=0>ob?0:ob)),pb=nc?jb:jb-1);return{returnValue:!0,mKb:pb,hJa:ob}}Thc(jb,hb,pb,ob){let sb=null;if(ob)for(;pb<jb.length;pb++){if(jb.K(pb).yn){sb=jb.K(pb).yn;break}}else for(;0<=pb;pb--)if(jb.K(pb).yn){sb=jb.K(pb).yn;break}if(sb)for(jb=0;jb<hb.length;jb++)if(hb.K(jb)===sb)return hb=jb,{returnValue:!0,qRb:hb};return{returnValue:!1,
qRb:-1}}A7l(jb,hb){for(let pb=0;pb<jb.length;pb++)if(jb.K(pb).yn===hb)return pb;return-1}fZd(jb,hb,pb=-1){for(pb=0>pb?hb:pb;pb>=hb;pb--)jb.K(pb).yn&&(jb.K(pb).yn.yn=null),jb.YH(pb)}rHf(jb,hb){let pb=0;for(;0<=hb;hb--)pb+=jb.K(hb).length;return pb}vLm(jb){jb=Object(x.a)(Ca.a,jb);jb||(a.a.instance.Ua(575706448,1,2,"GetTextBlock"),this.ee.logger.Pi(Object.assign(new C.a,{$j:"GetTextBlock",eventId:"8ujvq"})));return jb}c6l(jb,hb){let pb="",ob=jb;for(;ob>=hb&&this.Ze.K(ob).yn&&2!==this.Ze.K(ob).type;)pb=
this.vLm(this.Ze.K(ob)).text+pb,ob--;hb=0>ob?0:this.rHf(this.Ze,ob);return!this.xth||ob<jb?(jb=ob+1,{returnValue:new zb.a(hb,pb),Bag:jb}):{returnValue:null,Bag:ob}}YMm(jb){let hb,pb,ob=!1;pb=hb=0;if(!jb.yn)return{returnValue:!1,egc:hb,sdi:pb};for(hb=0;hb<this.Ze.length;hb++){if(this.Ze.K(hb).yn===jb){ob=!0;break}pb+=this.Ze.K(hb).length}return{returnValue:ob,egc:hb,sdi:pb}}qvf(jb,hb,pb){pb=pb===jb.length?--pb:pb;pb>jb.length-1&&(a.a.instance.Ua(571757957,1,2,"DeleteEopInList: Idx out of range"),this.ee.logger.Pi(Object.assign(new C.a,
{$j:"DeleteEopInList",eventId:"8ffwf"})));if(2===jb.K(pb).type){const ob=jb.K(pb);if(ob.wk!==hb.Og||ob.Yc!==hb.Yc)return!1;this.fZd(jb,pb);return!0}return!1}}Object(J.a)(Za,"ParagraphMergeUsingHintsTwinListLcs",null,[1439]);var Ka=d(1484),bb=d(1441),Ib=d(1716);d.d(L,"a",function(){return ib});class ib{constructor(jb,hb,pb,ob,sb,Ab,nc=null,qc=null,Jc=null){this.dT=this.wya=this.IQa=this.rwa=null;this._initialized=!1;this.ee=jb;this.vH=hb;this.pHa=ob;this.UFa=pb;this.Uwa=sb;this.pKe=new f.a;for(jb=
0;jb<this.vH.length;jb++)this.pKe.add(this.vH.K(jb).id);this.cgh=new f.a;for(jb=0;jb<this.UFa.length;jb++)this.cgh.add(this.UFa.K(jb).id);this.LHh=new f.a;for(jb=0;jb<this.pHa.length;jb++)this.LHh.add(this.pHa.K(jb).id);this.vg=Ab;this.Xaf=nc||y.a.instance;this.AK=qc;this.EZ=Jc;this.IEb=1===(this.AK&&this.EZ&&1===this.AK.bPa&&1===this.EZ.bPa?1:0);this.Twa=0}get tug(){return 1!==this.Twa}E5m(){var jb=!0;if(this.AK&&this.EZ)return jb;if(this.AK||this.EZ)return a.a.instance.Ua(593826832,1,2,"ParagraphMergeUsingHints.InitializeUpdateHints : Unexpected input to constructor: need to supply both or neither of favored and unfavored update hints, just supplying one is unsupported"),
!1;this.ee.runtime.IA.lb(E.a.QN)&&(jb=this.ee.runtime.IA.K(E.a.QN),jb=this.UMg(jb,this.ee.runtime.wIa.id,"favored")&&({lK:this.AK}=this.tQi(jb,this.pKe,this.cgh,this.ee.runtime.IA,"favored")).returnValue);jb&&this.ee.runtime.uv.lb(E.a.QN)&&(jb=this.ee.runtime.uv.K(E.a.QN),jb=this.UMg(jb,this.ee.runtime.wIa.id,"unfavored")&&({lK:this.EZ}=this.tQi(jb,this.pKe,this.LHh,this.ee.runtime.uv,"unfavored")).returnValue);this.AK=this.AK?this.AK:new Ib.a(new l.a,0);this.EZ=this.EZ?this.EZ:new Ib.a(new l.a,0);
jb&&this.ee.input.sRb&&(jb=this.ee.input.Gca.last().qKa(E.a.QN),jb=this.UMg(jb,this.ee.input.Gca.last().DJ.id,"alreadyMerged"));return jb}G3m(){const jb=new f.a;if(this.IEb)return jb;const hb=this.AK?this.AK.lK.VNa():new l.a;let pb=0;for(;pb<hb.length-1;){const ob=hb.K(pb);let sb,Ab=!1;for(sb=pb+1;sb<hb.length;sb++){const nc=hb.K(sb);if(ob.VXi(nc)){jb.add(ob.id);hb.YH(sb);hb.YH(pb);Ab=!0;break}}Ab||pb++}return jb}UMg(jb,hb,pb){jb=this.vg.getPropertyString(jb,m.a.EEa);jb=w.a.Cf(jb);return hb.equals(jb)?
!0:(this.dnd(2),a.a.instance.Ua(17162307,1,2,"ParagraphMergeUsingHints: ValidateUpdateHintsContainerBaseId returned failure [MergeBaseId: {0}] [UpdateHintsContainerBaseId: {1}] [RevisionType: {2}]",this.ee.runtime.wIa.id,jb,pb),!1)}tQi(jb,hb,pb,ob,sb){let Ab;Ab=new Ib.a(new l.a,0);jb=this.vg.getPropertyObjectIds(jb,m.a.uY).VNa();for(let qc=0;qc<jb.length;qc++){if(!ob.lb(jb.K(qc)))return a.a.instance.Ua(17044257,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to find [UpdateHintObject: {0}] in [RevisionType: {1}]",
jb.K(qc),sb),{returnValue:!1,lK:Ab};const Jc=ob.K(jb.K(qc));var nc=w.a.Cf(this.vg.getPropertyString(Jc,m.a.Xna));if(hb.contains(nc)||pb.contains(nc)){nc=this.Xaf.Lkc(Jc);if(!nc)return a.a.instance.Ua(17044258,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to create a updateHint for [UpdateHintObject: {0}]  in [RevisionType: {1}]",Jc.id,sb),{returnValue:!1,lK:Ab};Ab.lK.add(nc)}}0<jb.length&&a.a.instance.Ua(17162308,1,5,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs for [RevisionType: {0}] [UpdateHintIds: {1}] [UpdateHints: {2}]",
sb,jb.Qr(),Ab.lK.Qr());return{returnValue:!0,lK:Ab}}N4m(){return({UM:this.rwa,v_c:this.IQa,csd:this.wya}=Ka.a.r9h(this.ee,this.vg,this.vH,this.UFa,this.pHa,this.Uwa,!0,!0)).returnValue?!0:!1}C5m(jb){const hb=Ka.a.LXd(this.vg,pb=>this.ee.runtime.Cn.K(pb),this.vH,1,this.Uwa,!0,!0).returnValue;if(!hb)return a.a.instance.Ua(17044259,1,2,"InitializeTwinTextMergeBlocks:Unable to create merge blocks for the base or derived"),!1;this.dT=this.IEb?new Za(this.ee,hb,1):new Sa(this.ee,hb,jb,this.AK?this.AK.bPa:
0);return!0}initialize(){if(this._initialized)return!1;this._initialized=!0;if(!this.E5m()||!this.N4m())return!1;const jb=this.G3m();return this.C5m(jb)?!0:!1}BAi(jb){const hb=new l.a;let pb="";for(let ob=0;ob<jb.length;ob++){const sb=jb.K(ob);sb.B7()?pb+=jb.K(ob).text:2===sb.type?(hb.add(new ia(sb.wk,sb.type,pb,sb.Yc)),pb=""):4===sb.type&&(hb.add(new ia(sb.wk,sb.type)),pb="")}return hb}aFe(jb,hb,pb){hb=this.BAi(hb);jb=this.BAi(jb);let ob=hb.length===jb.length;if(ob)for(let sb=0;sb<hb.length;sb++)if(!hb.K(sb).isEqual(jb.K(sb))){ob=
!1;break}ob||(this.dnd(4),a.a.instance.Ua(17044288,1,2,"ValidateUpdateHintsAreComplete: Validation of update hints from [Revision: {0}] was unsuccessful [MergeValidationState: {1}] [RevisionValidationState: {2}]",pb,jb.Qr(),hb.Qr()));return ob}tSh(jb,hb,pb){(hb=({rfb:jb}=this.v7k(jb,hb,pb)).returnValue)||this.dnd(this.dT.Ccd?1:3);return{returnValue:hb,rfb:jb}}v7k(jb,hb,pb){let ob;ob=new l.a;let sb=!0;var Ab=0;let nc=null,qc=this.AK?this.AK.lK.length:0;for(var Jc=0;Jc<qc&&sb;Jc++)nc=this.AK.lK.K(Jc),
Ab<this.EZ.lK.length&&nc.id.equals(this.EZ.lK.K(Ab).id)&&5!==this.ee.input.source?({returnValue:sb}=this.dT.Whf(nc,2),Ab++):sb=this.dT.Xhf(nc,2);if(!sb)return a.a.instance.Ua(17044289,1,2,"ApplyUpdateHints: Failed to apply favored [UpdateHint: {0}]",nc.toString()),{returnValue:!1,rfb:ob};if(!this.aFe(this.dT.Ze,this.IQa,"Favored"))return{returnValue:!1,rfb:ob};if(jb&&1===this.ee.input.lma&&!this.dT.NRh(hb,pb,2))return a.a.instance.Ua(17409920,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",
hb,pb),{returnValue:!1,rfb:ob};sb=!0;Jc=new l.a;for(qc=this.EZ?this.EZ.lK.length:0;Ab<qc&&sb;Ab++){nc=this.EZ.lK.K(Ab);let ad;({vv:ad,returnValue:sb}=this.dT.Whf(nc,4));sb&&ad&&Jc.iD(Jc.length,ad)}return sb?this.aFe(this.dT.Qj,this.wya,"Unfavored")?jb&&2===this.ee.input.lma&&!this.dT.MRh(hb,pb,4)?(a.a.instance.Ua(17409921,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",hb,pb),{returnValue:!1,rfb:ob}):{returnValue:!0,rfb:Jc}:{returnValue:!1,rfb:ob}:(a.a.instance.Ua(17044291,
1,2,"ApplyUpdateHints: Failed to apply unfavored [UpdateHint: {0}] [Type: {1}]",nc.id,nc.type),{returnValue:!1,rfb:ob})}bxm(){let jb,hb=0;let pb=0,ob=w.a.nil;for(jb=new z.a;pb<this.dT.Qj.length;){const nc=this.dT.Qj.K(pb);ob.equals(nc.wk)||(hb=0,ob=nc.wk);if(5===nc.type){var sb=hb+nc.length;var Ab=void 0;let qc;const Jc=X(this.wya);if(!({index:Ab}=W(Jc,nc.wk,hb)).returnValue||!({index:qc}=W(Jc,nc.wk,sb)).returnValue)return a.a.instance.Ua(17335384,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks from unfavored to insert in favored for [UpdateHintId: {0}]",
nc.tsd),{returnValue:!1,ecj:jb};for(sb=new l.a;Ab<qc;Ab++)sb.add(Jc.K(Ab));jb.Z(nc.tsd,sb)}hb+=nc.length;pb++}return{returnValue:!0,ecj:jb}}cxm(){let jb;jb=new z.a;let hb=0;for(let ob=0;ob<this.dT.Qj.length;ob++){const sb=this.dT.Qj.K(ob);if(5===sb.type){var pb=void 0;let Ab;const nc=X(this.wya);if(!({index:pb}=Z(nc,hb,this.ee.logger)).returnValue||!({index:Ab}=Z(nc,hb+sb.length,this.ee.logger)).returnValue)return a.a.instance.Ua(574433309,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks"),
{returnValue:!1,fcj:jb};const qc=new l.a;for(;pb<Ab;pb++)qc.add(nc.K(pb));jb.Z(sb.tsd,qc)}hb+=sb.length}return{returnValue:!0,fcj:jb}}h6k(jb){let hb;hb=new l.a;let pb;if(this.IEb){if(!({fcj:pb}=this.cxm()).returnValue)return{returnValue:!1,Gcd:hb}}else if(!({ecj:pb}=this.bxm()).returnValue)return{returnValue:!1,Gcd:hb};let ob;ob=this.IEb?new Za(this.ee,X(this.IQa),1):new Sa(this.ee,X(this.IQa),new f.a,this.AK?this.AK.bPa:0);for(var sb=0;sb<jb.length;sb++)if(!ob.Xhf(jb.K(sb),4))return{returnValue:!1,
Gcd:hb};for(jb=ob.Ze.length-1;0<=jb;jb--)5===ob.Ze.K(jb).type&&(sb=ob.Ze.K(jb).tsd,ob.Ze.YH(jb),ob.Ze.iD(jb,pb.K(sb)));this.IEb&&(this.tbi(ob.Ze),this.tbi(this.dT.Ze));if(!this.aFe(this.dT.Ze,ob.Ze,"Merged"))return{returnValue:!1,Gcd:hb};hb=ob.Ze;return{returnValue:!0,Gcd:hb}}tbi(jb){const hb=new z.a;for(let pb=jb.length-1;0<=pb;pb--){const ob=Object(x.a)(I.a,jb.K(pb));ob&&(hb.lb(ob.Yc)?hb.K(ob.Yc).source!==ob.source&&jb.YH(pb):hb.add(ob.Yc,ob))}}u7k(jb){let hb;if(!({Msd:hb}=this.dT.sCf(X(this.wya))).returnValue)return!1;
for(let ob=0;ob<hb.length;ob++){const sb=hb.K(ob);let Ab,nc;if(!({index:Ab}=Z(jb,sb.cp,this.ee.logger)).returnValue||!({index:nc}=Z(jb,sb.cp+sb.length,this.ee.logger)).returnValue)return a.a.instance.Ua(572379488,1,2,"ApplyUnfavoredFormattingChangesLcs: Unable to split"),this.ee.logger.Pi(Object.assign(new C.a,{$j:"ApplyUnfavoredFormattingChangesLcs",eventId:"8h3f6"})),!1;var pb=!1;for(let qc=Ab;qc<nc&&!pb;qc++)pb=!sb.ySd.oL.equals(jb.K(qc).oL);if(!pb){for(pb=Ab;pb<nc;pb++)jb.YH(Ab);jb.insert(Ab,
sb.Nsd)}}return!0}t7k(jb){let hb;if(!({Zzc:hb}=this.dT.sCf(X(this.wya))).returnValue)return!1;for(let sb=0;sb<hb.length;sb++){var pb=hb.K(sb);let Ab,nc;if(({index:Ab}=W(jb,pb.Og,pb.cp)).returnValue&&({index:nc}=W(jb,pb.Og,pb.cp+pb.Nsd.length)).returnValue){var ob=!1;for(let qc=Ab;qc<nc&&!ob;qc++)ob=!pb.ySd.oL.equals(jb.K(qc).oL)||!pb.ySd.bA.VB(jb.K(qc).bA);if(ob){if(this.AK&&1===this.AK.bPa||this.EZ&&1===this.EZ.bPa)return!1}else{for(ob=Ab;ob<nc;ob++)jb.YH(Ab);jb.insert(Ab,pb.Nsd)}}else if(pb=pb.Nsd.obn,
a.a.instance.Ua(51500353,1,2,"ApplyUnfavoredFormattingChanges: Unable to find corresponding merge blocks with update formatting in merged list. IsEmbeddedObject {0}",pb),pb||this.AK&&1===this.AK.bPa||this.EZ&&1===this.EZ.bPa)return!1}return!0}yCm(jb){let hb,pb;pb=new l.a;hb=this.ee.runtime.Tq.K(E.a.QN);let ob;({U7f:ob}=ib.Eri(this.ee,this.vg));const sb=new l.a;for(let nc=0;nc<jb.length;nc++){if(ob.contains(jb.K(nc).id,(Jc,ad)=>Jc.equals(ad)))continue;if(this.ee.runtime.Tq.lb(jb.K(nc).id))return a.a.instance.shipAssertTag(17044293,
1,!1,"[UpdateHint: {0}] is already in the merged object. Failing merge.",jb.K(nc).id),{returnValue:!1,Toe:hb,Soe:pb};sb.add(jb.K(nc).id);var Ab=jb.K(nc).MVa();const qc=new bb.a(Ab);Ab=Ab.ek();for(const Jc of Ab)qc.OM(Jc);pb.add(qc)}jb=this.vg.getPropertyObjectIds(hb.Bm,m.a.uY);jb.iD(jb.length,sb);this.vg.setPropertyObjectIds(hb.Bm,m.a.uY,jb);return{returnValue:!0,Toe:hb,Soe:pb}}s5d(jb){return String.format("Name: {0}, Message: {1}, Stack: {2}",jb.name,jb.message,jb.stack)}dnd(jb){0===this.Twa&&(this.Twa=
jb)}Mzc(){let jb;jb=null;let hb,pb;var ob;try{if({Tq:jb,Toe:hb,Soe:pb,returnValue:ob}=this.Glp(),ob){if(hb&&pb){this.ee.runtime.Tq.Z(hb.Bm.id,hb);for(ob=0;ob<pb.length;ob++){const qc=pb.K(ob);this.ee.runtime.Tq.Z(qc.Bm.id,qc)}const sb=hb.Bm,Ab=this.vg.getPropertyObjectIds(sb,m.a.uY),nc=this.vg.getPropertyString(sb,m.a.EEa);a.a.instance.Ua(17162312,1,5,"ParagraphMergeUsingHints returned success [UpdateHintsContainerNodeIds: {0}] [UpdateHintsContainerBaseId: {1}]",Ab.Qr(),nc)}else a.a.instance.Ua(593826831,
1,5,"ParagraphMergeUsingHints returned success and did not update UpdateHint objects");return{returnValue:!0,Tq:jb}}}catch(sb){a.a.instance.Ua(17162313,1,2,"ParagraphMergeUsingHints Crashed! Retrying ParagraphMerge [{0}]",this.s5d(sb))}this.dnd(5);a.a.instance.Ua(17409922,1,2,"TryDoMerge: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.Twa,this.tug);this.Zab();this.AK&&1===this.AK.bPa&&this.ee.logger.Pi(Object.assign(new Y.a,{eventId:"bc04c",$j:"ParagraphMergeUsingHints.TryDoMerge",
info:u[this.Twa]+"/LCS"}));return{returnValue:!1,Tq:jb}}Glp(){let jb,hb,pb;pb=hb=jb=null;let ob;ob=this.initialize();this.ee.logger.EX("PMUH Initialize");let sb=null;ob=ob&&({rfb:sb}=this.tSh(!1,w.a.nil,0)).returnValue;this.ee.logger.EX("PMUH ApplyUpdateHints");let Ab=new l.a;ob=ob&&({Gcd:Ab}=this.h6k(sb)).returnValue;this.ee.logger.EX("PMUH ApplyMergedUnfavoredHintsToFavoredToMergeFavoredFormattingChanges");ob=this.IEb?ob&&this.u7k(Ab):ob&&this.t7k(Ab);this.ee.logger.EX("PMUH ApplyUnfavoredFormattingChanges");
this.IEb&&!this.hFo(Ab)&&(a.a.instance.shipAssertTag(571552961,1,!1,"ReuseParaIdsIfPossible"),this.ee.logger.Pi(Object.assign(new C.a,{$j:"ReuseParaIdsIfPossible",eventId:"8ettb"})),ob=!1);const nc=this.d7d(Ab);ob=ob&&({Roe:jb}=Ka.a.Z2c(this.ee,this.vg,this.Uwa,Ab,nc)).returnValue;this.ee.logger.EX("PMUH GetMergeableObjectsFromMergeBlocks");this.AK&&1===this.AK.bPa&&this.EZ&&1===this.EZ.bPa||(ob=ob&&({Toe:hb,Soe:pb}=this.yCm(H(sb))).returnValue,this.ee.logger.EX("PMUH GetPartialMergeResultForUpdateHintNodes"));
return{returnValue:ob,Ccd:!!this.dT&&this.dT.Ccd,Tq:jb,Toe:hb,Soe:pb}}d7d(jb){const hb=new l.a;for(let pb=0;pb<jb.length;pb++)2===jb.K(pb).type&&hb.add(jb.K(pb).wk);return hb}pIf(jb){const hb=new l.a;for(let pb=0;pb<jb.length;pb++)2===jb.K(pb).type&&hb.add(jb.K(pb));return hb}hFo(jb){var hb=this.pIf(this.rwa),pb=this.pIf(this.IQa),ob=this.pIf(this.wya),sb=this.d7d(hb),Ab=this.d7d(pb),nc=this.d7d(ob);Ab=F.b(sb,Ab,nc);sb=new l.a;for(nc=0;nc<Ab.length;nc++)sb.iD(sb.length,Ab.K(nc).C7l());Ab=this.H7l(jb);
hb=this.D7l(Ab,sb,hb,pb,ob);pb=0;ob=new f.a;for(sb=0;sb<jb.length;sb++)if(Ab=jb.K(sb),2===Ab.type)if(ob.contains(Ab.wk))if(pb<hb.length)jb.YH(sb),jb.insert(sb,hb.K(pb)),pb++;else return!1;else ob.add(Ab.wk);0<jb.length&&2!==jb.K(jb.length-1).type&&pb<hb.length&&jb.insert(jb.length,hb.K(pb));return!0}H7l(jb){const hb=new f.a;for(let pb=0;pb<jb.length;pb++)2===jb.K(pb).type&&hb.add(jb.K(pb).wk);return hb}D7l(jb,hb,pb,ob,sb){const Ab=new l.a;for(let nc=0;nc<hb.length;nc++){const qc=hb.K(nc);if(!jb.contains(qc)){let Jc;
(({block:Jc}=this.kCf(ob,qc)).returnValue||({block:Jc}=this.kCf(sb,qc)).returnValue||({block:Jc}=this.kCf(pb,qc)).returnValue)&&Jc&&Ab.add(Jc)}}return Ab}kCf(jb,hb){for(let pb=0;pb<jb.length;pb++)if(2===jb.K(pb).type&&jb.K(pb).wk===hb)return jb=jb.K(pb),{returnValue:!0,block:jb};return{returnValue:!1,block:null}}Zab(){const jb=new l.a;Ka.a.lqc(this.vg,"BaseObjects_",this.vH,jb);Ka.a.lqc(this.vg,"FavoredObjects_",this.UFa,jb);Ka.a.lqc(this.vg,"ConflictObjects_",this.pHa,jb)}Mhl(){let jb,hb;jb=w.a.nil;
hb=-1;let pb=0;for(let ob=0;ob<this.dT.Ze.length;ob++){const sb=this.dT.Ze.K(ob);if(sb.B7())pb+=sb.length;else if(6!==sb.type)pb=0;else return jb=sb.wk,hb=pb,{returnValue:!0,objectId:jb,cp:hb}}a.a.instance.Ua(17409923,1,2,"CalculatePositionOfPlaceHolderCp: Unable to find placeholder Cp");return{returnValue:!1,objectId:jb,cp:hb}}osd(jb,hb){let pb,ob;ob=hb;pb=jb;try{let sb=this.initialize();if(sb=(sb=sb&&this.tSh(!0,jb,hb).returnValue)&&({objectId:pb,cp:ob}=this.Mhl()).returnValue)return a.a.instance.Ua(17409924,
1,5,"UpdateCpAccordingToIncomingChange returned success [ResultObjectId: {0}] [ResultCp: {1}]",pb,ob),{returnValue:!0,idb:pb,Xua:ob}}catch(sb){a.a.instance.Ua(17409925,1,2,"UpdateCpAccordingToIncomingChange Crashed! Retrying using the old method [{0}]",this.s5d(sb))}this.dnd(5);a.a.instance.Ua(17409926,1,2,"UpdateCpAccordingToIncomingChange: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.Twa,this.tug);this.Zab();return{returnValue:!1,idb:pb,Xua:ob}}static Eri(jb,
hb){let pb;pb=new l.a;if(!jb.input.sRb)return{returnValue:!0,U7f:pb};jb=jb.input.Gca.last().qKa(E.a.QN);pb=hb.getPropertyObjectIds(jb,m.a.uY);return{returnValue:!0,U7f:pb}}static Pao(jb){if(!Ka.a.Pxf(jb))return!0;const hb=new v.a;jb.runtime.Tq.Z(E.a.QN,Ka.a.F5m(jb,hb));return!0}static oao(jb){if(!jb.runtime.Tq.lb(E.a.QN)||!jb.runtime.uv.lb(E.a.QN))return!0;const hb=new v.a,pb=jb.runtime.Tq.K(E.a.QN);var ob=hb.getPropertyString(pb.Bm,m.a.EEa);if(w.a.Cf(ob).equals(w.a.nil))return!0;ob=hb.getPropertyObjectIds(pb.Bm,
m.a.uY);const sb=hb.getPropertyObjectIds(jb.runtime.uv.K(E.a.QN),m.a.uY);let Ab;({U7f:Ab}=ib.Eri(jb,hb));for(let nc=0;nc<sb.length;nc++)ob.contains(sb.K(nc),(qc,Jc)=>qc.equals(Jc))||Ab.contains(sb.K(nc),(qc,Jc)=>qc.equals(Jc))||(ob.add(sb.K(nc)),jb.runtime.Tq.Z(sb.K(nc),new bb.a(jb.runtime.uv.K(sb.K(nc)).JO())));hb.setPropertyObjectIds(pb.Bm,m.a.uY,ob);return!0}}Object(J.a)(ib,"ParagraphMergeUsingHints",null,[1413])},1612:function(J,L,d){J=d(0);class m{constructor(x){this.ofj=x;this.succeeded=!1;
this.Dzc=x?x.Dzc:0;this.Fpn=!1;this.length=this.xep=0}}Object(J.a)(m,"TrieResult",null,[]);class f{constructor(x,u,v){this.pub=new m(null);this.mEn=x;this.Mbd=u;this.F$i=u+v-1}get result(){return this.pub}WAi(){let x;return this.Mbd<=this.F$i?(x=this.mEn.charAt(this.Mbd),++this.Mbd,{returnValue:!0,ch:x}):{returnValue:!1,ch:"\x00"}}uqg(x,u,v){x&&(this.pub.Fpn=!0,this.pub.xep=u);this.pub.length=this.Mbd;this.pub.succeeded=!0;this.pub.Dzc=v;this.Mbd!==this.F$i+1&&(this.pub=new m(this.pub))}}Object(J.a)(f,
"LookUpStringVisitor",null,[2054]);var a=d(1734);class l{constructor(){this.VZh=this.lXh=this.nXh=this.kXh=this.mXh=this.Dlf=this.Blf=this.Flf=this.Alf=0}}Object(J.a)(l,"TRIESTATS",null,[]);class w{constructor(){this.mOa=this.Edd=0}}Object(J.a)(w,"TrieSymbol",null,[]);d.d(L,"a",function(){return z});class z{constructor(x,u){this.I7=null;this.bie=this.U$i=this.S$i=this.W$i=this.O$i=this.V$i=this.T$i=this.X$i=this.P$i=0;this.KL=x;if(x.aA(u,4)!==z.SKb)throw Error.argument("Input does not represent a trie");
u+=4;this.H$i=1===x.aA(u,4);u+=4;this.jEn=1===x.aA(u,4);u+=4;this.fEn=x.aA(u,4);u+=4;if(x.aA(u,4)){x=u+4;this.I7=this.clo(x);this.P$i=u=x+z.fgl;this.X$i=u+=z.sTd*(this.I7.Alf+(this.I7.Alf%2?1:0));this.T$i=u+=z.sTd*(this.I7.Flf+(this.I7.Flf%2?1:0));this.V$i=u+=z.sTd*(this.I7.Blf+(this.I7.Blf%2?1:0));this.O$i=u+=z.sTd*(this.I7.Dlf+(this.I7.Dlf%2?1:0));this.W$i=u+=z.Hlf*this.I7.kXh;this.S$i=u+=z.Ilf*this.I7.nXh;this.U$i=u+=z.Ilf*this.I7.lXh;u+=z.Ilf*this.I7.mXh;if(u!==x+this.I7.VZh)throw Error.argument("Corrupted trie binary");
this.bie=u}else this.I7=null}c$i(x,u,v,E){x=new f(x,u,v);this.f$j(x,E);return x.result}bGi(x){if(this.H$i)if(x)--x;else return"";if(!this.I7)throw Error.argument("Invalid trieID");const u=new a.a;u.uH=0;this.E1b(u);const v=[];for(;;){if(u.uH&z.Yfb)if(x)--x;else return Array.add(v,u.N2b),String.fromCharCode.apply(null,v);const E=!!(u.uH&z.CHe),y=this.ejc(u,!0);if(E||x<y){if(Array.add(v,u.N2b),!this.E1b(u))throw Error.argument("Invalid trieID");}else if(x-=y,!this.zrd(u))throw Error.argument("Invalid trieID");
}}f$j(x,u){let v=0;this.H$i&&(x.uqg(this.jEn,this.fEn,0),++v);if(this.I7){var E=new a.a;E.uH=0;if(this.E1b(E))for(;;){var y=void 0;if(!({ch:y}=x.WAi()).returnValue)break;u&&(y=u(y));y=y.toString().charCodeAt(0);let H=!1;for(;!H;){const I=!!(E.uH&z.Yfb);if(E.N2b===y){if(H=!0,I&&x.uqg(!!(E.uH&z.gRg),E.fBe,v),!this.E1b(E))return}else if(v+=this.ejc(E,!0),!this.zrd(E))return;I&&++v}}}}E1b(x){if(!x.uH)return this.WIg(x),!0;if(!(x.uH&z.BHe))return!1;x.wWa=0;x.Uy=x.Krb;this.WIg(x);return!0}zrd(x){if(x.uH&
z.CHe)return!1;this.WIg(x);return!0}ejc(x,u){return x.uH&z.fRg?x.rTd:x.uH&z.BHe?!u&&x.uH&z.CHe?this.olm(x):1:0}olm(x){x=z.tof(x);if(!this.E1b(x))return 0;let u=0;do x.uH&z.Yfb&&++u,u+=this.ejc(x,!1);while(this.zrd(x));return u}WIg(x){x.uH||(x.wWa=0,x.Uy=this.bie);var u=this.OYd(this.P$i,x.Uy),v=u.mOa;x.Uy+=u.Edd;u=this.KL.aA(this.O$i+z.Hlf*v,z.Hlf);x.N2b=u&65535;x.uH=u>>16;x.uH&z.fRg&&(x.rTd=this.gLl(x));x.uH&z.gRg&&(u=this.OYd(this.X$i,x.Uy),v=u.mOa,x.Uy+=u.Edd,x.fBe=this.KL.aA(this.W$i+4*v,4));
x.uH&z.Khk?(x.Krb=this.bie+((this.KL.K(x.Uy)<<8|this.KL.K(x.Uy+1))<<8|this.KL.K(x.Uy+2)),x.Uy+=3):x.uH&z.Lhk?(x.Krb=x.Uy,x.wWa=x.Krb):x.uH&z.Mhk?(u=this.OYd(this.T$i,x.Uy),v=u.mOa,x.Uy+=u.Edd,x.Krb=this.bie+this.KL.aA(this.S$i+4*v,4)):x.uH&z.BHe&&(u=this.OYd(this.V$i,x.Uy),v=u.mOa,x.Uy+=u.Edd,x.wWa||(x.wWa=x.Uy),x.wWa+=this.KL.aA(this.U$i+4*v,4),x.Krb=x.wWa)}OYd(x,u){const v=new w;let E=0;for(;;){E+=this.KL.K(u);++u;++v.Edd;const y=this.KL.aA(x,2);if(E<y)break;v.mOa+=y;E-=y;x+=2;E<<=8}v.mOa+=E;return v}gLl(x){let u=
this.KL.K(x.Uy);192<=u?(u=(u&63)<<15|(this.KL.K(x.Uy+1)&127)<<8,u|=this.KL.K(x.Uy+2),x.Uy+=3):128<=u?(u=(u&127)<<8|this.KL.K(x.Uy+1),x.Uy+=2):x.Uy+=1;return u}clo(x){const u=new l;u.Alf=this.KL.aA(x+12,2);u.Flf=this.KL.aA(x+14,2);u.Blf=this.KL.aA(x+16,2);u.Dlf=this.KL.aA(x+18,2);u.mXh=this.KL.aA(x+24,4);u.kXh=this.KL.aA(x+28,4);u.nXh=this.KL.aA(x+32,4);u.lXh=this.KL.aA(x+36,4);u.VZh=this.KL.aA(x+40,4);return u}static tof(x){const u=new a.a;u.N2b=x.N2b;u.uH=x.uH;u.rTd=x.rTd;u.Uy=x.Uy;u.Krb=x.Krb;u.wWa=
x.wWa;u.fBe=x.fBe;return u}}z.SKb=1654263084;z.fgl=48;z.sTd=2;z.Ilf=4;z.Hlf=4;z.Yfb=1;z.CHe=2;z.fRg=4;z.gRg=8;z.BHe=16;z.Lhk=64;z.Mhk=128;z.Khk=256;Object(J.a)(z,"Trie",null,[2053])},1614:function(J,L,d){d.r(L);J=d(0);d(1377);var m=d(1407);class f{}f.Waj=0;f.dkl=1;f.cqe=10;Object(J.a)(f,"AppsForOfficeStoreType",null,[]);var a=d(1373),l=d(2),w=d(92),z=d(13);class x{constructor(){this.N8e=0}hng(C,P){this.N8e=window.performance.now();this.G0a(()=>{const K=window.performance.now(),G={},R=l.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",
!0);P.H0k&&(G.callback=W=>{C(W,f.Waj,K)},R&&(G.storeType=f.Waj),l.AFrameworkApplication.va.Pb(z.a.UXb,2,G));P.I0k&&(G.callback=W=>{C(W,f.cqe,K)},R?G.storeType=f.cqe:l.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?G.storeType=10:G.storeType=f.cqe,l.AFrameworkApplication.va.Pb(z.a.UXb,2,G))},0,()=>{if(a.TellMeActor.instance.Xe)a.TellMeActor.instance.Xe.onError("AddinEntitlementsQuery:QueryEntitlementAsync","Query entitlements timeout after "+
(window.performance.now()-this.N8e)+" ms")})}G0a(C,P=0,K=null){2!==l.AFrameworkApplication.va.Ob(z.a.UXb,1)?(a.TellMeActor.instance.Xe&&a.TellMeActor.instance.Xe.$B(m.a.G0k,window.performance.now()-this.N8e),C()):P<x.yHn?l.AFrameworkApplication.oc.Zb(new w.a(2,1,x.xCp,()=>{this.G0a(C,P+1,K)})):K&&K()}static get instance(){x._instance||(x._instance=new x);return x._instance}}x._instance=null;x.yHn=20;x.xCp=500;Object(J.a)(x,"AddinEntitlementsQuery",null,[]);class u{constructor(){this.description=this.id=
this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.A1f=this.storeType=this.storeId=this.providerName=this.iconUrl=null}}Object(J.a)(u,"AddinInfo",null,[]);var v=d(1379),E=d(1382),y=d(1381),H=d(1372),I=d(151);d.d(L,"AddinResultsProvider",function(){return F});class F{constructor(C){this.Z4e=[];this.kc=C;this.yVn=(P,K,G)=>{if(P){const R=P.errorCode;if(a.TellMeActor.instance.Xe){const W={};W.StoreType=K;W.ErrorCode=R;W.AddinCount=
P.value?P.value.length:0;a.TellMeActor.instance.Xe.$B(m.a.aem,window.performance.now()-G,W)}if(0===R&&P.value){F.WJb=F.WJb||{};P=P.value;for(const W of P)P=new u,P.displayName=W[0],P.id=W[1],P.description=W[2],P.targetType=W[3],P.appVersion=4<W.length?W[4]:"",P.assetId=5<W.length?W[5]:"",P.assetStoreId=6<W.length?W[6]:"",P.width=7<W.length?W[7]:0,P.height=8<W.length?W[8]:0,P.iconUrl=9<W.length?W[9]:"",P.providerName=10<W.length?W[10]:"",P.storeId=11<W.length?W[11]:"",P.storeType=12<W.length?W[12]:
"",P.A1f=this.Hum(P),F.WJb[P.id]=P,0<P.iconUrl.length&&(K="AddinIcon_"+P.id,l.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)?this.gzj(K,P.iconUrl):appChrome.addInApi.registerAddinIcon(K,P.iconUrl))}}};x.instance.hng(this.yVn,this.kc)}oN(){return"Add-ins"}bX(){return 0===this.kc.iw?0:1===this.kc.iw?1:2}WJ(C,P,K,G,R=null){K=new y.a(C);R&&!Array.contains(R,27)||H.a.wU(C)||(R=new E.a(27),R.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,
this.hum(C.Wg,R),K.dw(R));P.Nt(K)}hum(C,P){if((C=this.EJo(C))&&0<C.length){let K=0;C.forEach(G=>{if(!(3<++K)){var R="AddinSuggestion"+K,W={};if(l.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)){var Z="AddinIcon_"+G.id;0>Array.indexOf(this.Z4e,Z)&&0<G.iconUrl.length&&this.gzj(Z,G.iconUrl);W["default"]=0<=Array.indexOf(this.Z4e,Z)?Z:"AppForOfficeLogo_20"}else W["default"]=0<G.iconUrl.length?"AddinIcon_"+G.id:"AppForOfficeLogo_20";Z=[];
Z.push(appChrome.actions.setControlLabel(R,G.displayName));Z.push(appChrome.actions.setControlIconSet(R,W));Z.push(appChrome.actions.setCompoundButtonCommandValueId(R,G.id));Z.push(appChrome.actions.updateCompoundButtonDescription(R,G.description));l.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",!0)&&(W=window.performance.now(),Z.push(appChrome.actions.updateControlEnabledDisabledState(R,!1)),a.TellMeActor.instance.Xe&&a.TellMeActor.instance.Xe.$B(m.a.dYl,
window.performance.now()-W));appChrome.api.dispatch(Z);R=new v.a(R,27,void 0,void 0,1);R.QK=Telemetry.PrivacyRules.GetPrivacyCompliantId(G.id,G.storeType,G.assetId,null,null,G.storeId);P.Xx(R)}})}}gzj(C,P){I.c()&&appChrome.addInApi.registerAddinIcon&&(appChrome.addInApi.registerAddinIcon(C,P),Array.add(this.Z4e,C))}EJo(C){if(!F.WJb)return null;const P=[],K=F.WJb;for(const R in K){var G=K[R];G&&F.BGn(C,G)&&Array.add(P,G)}return P}Hum(C){return F.p9o(C.displayName)}static BGn(C,P){if(!P.A1f)return!1;
for(const K of C.split(" ")){C=!1;for(const G of P.A1f)if(G.toLowerCase().startsWith(K.toLowerCase())){C=!0;break}if(!C)return!1}return!0}static p9o(C){const P=[];for(const K of C.split(" ")){C=0;for(let G=0;G<K.length;G++){const R=K.charAt(G);R.toString().toUpperCase()===R.toString()&&G>C&&(Array.add(P,K.substring(C,G)),C=G)}Array.add(P,K.substring(C,K.length));C&&Array.add(P,K.substring(0,K.length))}return P}}F.WJb=null;Object(J.a)(F,"AddinResultsProvider",null,[1399])},1713:function(J,L,d){d.d(L,
"a",function(){return f});J=d(0);var m=d(221);class f{constructor(){this.BXb=this.XMb=this.IWa=this.uwb=this.vwb=this.t7a=this.lsb=this.twb=this.hob=this.jsb=this.Acb=this.iob=this.ksb=null;this.reset()}reset(){this.ksb=new m.a;this.iob=new m.a;this.Acb=new m.a;this.jsb=new m.a;this.hob=new m.a;this.twb=new m.a;this.lsb=new m.a;this.t7a=new m.a;this.t7a=new m.a;this.vwb=new m.a;this.uwb=new m.a;this.IWa=[];this.XMb=[];this.BXb=[]}UAp(a){return this.gWa(this.ksb,a)&&this.gWa(this.iob,a)&&this.gWa(this.Acb,
a)&&this.gWa(this.jsb,a)&&this.gWa(this.hob,a)&&this.gWa(this.twb,a)&&this.gWa(this.lsb,a)&&this.gWa(this.t7a,a)&&this.gWa(this.vwb,a)&&this.gWa(this.uwb,a)}gWa(a,l){return!a||!a.length||a.length===l}}Object(J.a)(f,"MergeableTrackedChangesProperties",null,[])},1714:function(J,L,d){d.d(L,"a",function(){return a});J=d(0);var m=d(221),f=d(602);class a{constructor(){this.FPa=new m.a;this.HQa=new m.a;this.VSa=new m.a}get kKb(){return this.FPa}get GBf(){return this.HQa}get Vzb(){return this.VSa}get isEmpty(){return!this.FPa.length&&
!this.HQa.length&&!this.VSa.length}get vub(){return Math.max(Math.max(this.FPa.length,this.HQa.length),this.VSa.length)}get aKn(){return Math.min(Math.min(this.FPa.length,this.HQa.length),this.VSa.length)}FRd(l){this.FPa.add(l)}HRd(l){this.HQa.add(l)}LRd(l){this.VSa.add(l)}C7l(){const l=new f.a,w=new m.a;let z=0;for(;z<this.FPa.length||z<this.HQa.length||z<this.VSa.length;)z<this.FPa.length&&!l.contains(this.FPa.K(z))&&(w.add(this.FPa.K(z)),l.add(this.FPa.K(z))),z<this.HQa.length&&!l.contains(this.HQa.K(z))&&
(w.add(this.HQa.K(z)),l.add(this.HQa.K(z))),z<this.VSa.length&&!l.contains(this.VSa.K(z))&&(w.add(this.VSa.K(z)),l.add(this.VSa.K(z))),z++;return w}}Object(J.a)(a,"ObjectCollection",null,[])},1715:function(J,L,d){d.d(L,"a",function(){return I});J=d(0);var m=d(59),f=d(14),a=d(356),l=d(221);d(48);d(795);var w=d(602),z=d(175),x=d(181),u=d(1025),v=d(1264),E=d(1768),y=d(1518),H=d(1764);class I{constructor(F){this.uC=new u.a;this.fZ=new a.a;this.OGh=new a.a(0);this.Ovd=new l.a;this.Yjh=new l.a;this.huh=
new l.a;this.Erh=new l.a;this.wth="";this.j2a=null;this.rt=this.PYe=0;this.mId=new a.a(0);this.aRe=this.Gxh=this.cFd=0;const {MarkerValidation:C}=d(1904);this._state=F;this.gCk=new C}get acd(){return this.gCk}get avj(){return this.j2a}QVo(F){this.PYe=F}Che(F,C){this.wth=String.format("{0}-{1}",F,C)}Wwe(F){this.jpl();this.aRe=F}Uyg(){this.aRe=0}jpl(){this.j2a&&this.Ovd.add(this.j2a);this.j2a=null}Pi(F){this.j2a||(this.j2a=F);switch(this.aRe){case 1:this.Yjh.add(F);break;case 2:this.huh.add(F);break;
case 3:this.Erh.add(F);break;default:this.j2a&&this.Ovd.add(F)}}t8i(F){this.Ovd.add(F)}tBn(){this.rt=this.fKa();this.bbb("MergeEnd")}bbb(F){const C=this.fKa();this.OGh.Z(F,C-this.PYe);this.PYe=C}MTo(){this.cFd=this.fKa();this.Gxh++}EX(F){const C=this.fKa();let P;({value:P}=this.mId.Ac(F)).returnValue?(P+=C-this.cFd,this.mId.Z(F,P)):this.mId.Z(F,C-this.cFd);this.cFd=C}fxm(){this.fZ.Z("Id",this._state.input.iVb.toString());this.fZ.Z("Source",v.a[this._state.input.source]);this.fZ.Z("RevSummary",I.K0a(this.WFm()));
this.fZ.Z("NodesRolledBackIfFailed",I.K0a(this.mzm()));if(!this._state.output.succeeded){let F,C,P,K,G;({K$k:F,C3l:C,Lop:P,P$k:K,Nop:G}=this.J5l(this._state.runtime));this.fZ.Z("CharactersLost",this.Dim(F,C,P));this.fZ.Z("CharactersLostInComments",this.Kjm());this.fZ.Z("CharactersLostInTables",this.Uem(G,K))}this.fZ.Z("FuncStep",this.wth);this.fZ.Z("FailureDetail",I.K0a(this.mPb()));this.fZ.Z("FailDetailHints",this.u5d(this.Yjh));this.fZ.Z("FailDetailNaiveMerge",this.u5d(this.huh));this.fZ.Z("FailDetailLcs",
this.u5d(this.Erh));this.fZ.Z("ExtraDetails",this.u5d(this.Ovd));this.fZ.Z("Timeline",I.K0a(this.OGh));this.fZ.Z("ParagraphMergesCount",this.Gxh);this.fZ.Z("ParagraphMergeDurations",I.K0a(this.mId));this.fZ.Z("MarkerInfo",I.K0a(this.acd.Cvi()));this.fZ.Z("Result",I.K0a(this.hxm()));return JSON.stringify(I.K0a(this.fZ))}fKa(){return(new Date).getTime()}WFm(){const F=new a.a;let C,P,K;({vHg:C,BOg:P,wIa:K}=this.TJf(this._state,this._state.input.Gca,this._state.input.M0a,this._state.input.sRb));F.Z("hasBase",
K?"true":"false");if(K){let G=0,R=0;for(;C&&!C.id.equals(K.id);)G++,C=C.DJ;for(;P&&!P.id.equals(K.id);)R++,P=P.DJ;F.Z("lenToBaseTheirs",C?G:-1);F.Z("lenToBaseYours",P?R:-1)}return F}TJf(F,C,P,K){F=C.sg(C.length-1-(K?1:0));C=(P=P.sg(P.length-1))&&F?F.sVa(P):null;return{vHg:F,BOg:P,wIa:C}}mzm(){if(!this._state.runtime.wQi)return null;const F=this._state.runtime.uv,C=new a.a(0);F.forEach((P,K)=>{({value:P}=C.Ac(K.wc.toString()));C.Z(K.wc.toString(),P+1);return!0});return C}Dim(F,C,P){let K=null,G=null,
R=null;const W=this._state.runtime.uv;let Z=0;try{R=new H.a(this.uC,this._state);K=y.b(F,C,P);G=new w.a;for(F=0;F<K.length;F++)if(!K.K(F).kKb.xt(K.K(F).Vzb,(T,N)=>T.equals(N))){const T=this.zei(K.K(F),R);Z+=T;G.add(K.K(F))}K&&W.forEach((T,N)=>{if(N.wc===m.a.paragraphNode){N=null;for(let U=0;U<K.length;U++)if(!G.contains(K.K(U))&&K.K(U).Vzb.contains(T,(ba,X)=>ba===X)){N=K.K(U);break}N&&(T=this.zei(N,R),G.add(N),Z+=T)}return!0});return Z}catch(T){return z.a.instance.Ua(579190992,1,2,"Exception in GetCharactersLost: "+
T.toString()),-1}}J5l(F){let C,P,K,G,R;F.$I=Z=>{if(750<this.fKa()-this._state.input.H_a)throw z.a.instance.Ua(579190991,1,2,"Timed out while calculating characters lost: {0}",Z),x.a.invalidOperation(Z);};C=new l.a;P=new l.a;K=new l.a;G=new l.a;const W=new l.a;R=new l.a;try{if(F.Cn){const Z=F.Cn.K(E.ChildNodeListMerge.hoe);let T,N;T=F.IA.K(E.ChildNodeListMerge.hoe)||Z;N=F.uv.K(E.ChildNodeListMerge.hoe)||Z;this.iCf(Z,U=>F.Cn.K(U),C,G);this.iCf(T,U=>F.IA.K(U)||F.Cn.K(U),P,W);this.iCf(N,U=>F.uv.K(U)||
F.Cn.K(U),K,R)}}catch(Z){z.a.instance.Ua(573089732,1,2,"Exception in FindAllParagraphAndTableIds: "+Z.toString())}return{K$k:C,C3l:P,Lop:K,P$k:G,Nop:R}}Uem(F,C){try{let K=0;const G=this._state.runtime;var P=Z=>G.uv.K(Z)||G.Cn.K(Z);const R=new w.a,W=this.w7l(F,G,P,R);for(F=0;F<W.count;F++){let Z=W.keys.K(F);const T=W.K(Z);if(!R.contains(Z)){let N=this.BGi(G,P,R,Z,T);if(-1!==N)K+=N;else return z.a.instance.Ua(573089733,1,2,"Error calculating characters lost between base and unfavored tables"),-1}}for(P=
0;P<C.length;P++){let Z=C.K(0);if(!R.contains(Z)){let T=this.F8d(G.Cn.K(Z));if(-1===T)return z.a.instance.Ua(573089734,1,2,"Error calculating characters lost in table deleted from base"),-1;K+=T}}return K}catch(K){return z.a.instance.Ua(573089735,1,2,"Exception in GetAllTablesCharactersLost: "+K.toString()),-1}}BGi(F,C,P,K,G){F.$I("GetTableCharactersLost");let R=0;G=this.uC.getPropertyObjectIds(G,f.a.pg);for(let U=0;U<G.length;U++){var W=C(G.K(U));W=this.uC.getPropertyObjectIds(W,f.a.pg);for(let ba=
0;ba<W.length;ba++){var Z=C(W.K(ba));if(F.Cn.K(G.K(U))&&F.Cn.K(W.K(ba))){var T=F.Cn.K(W.K(ba));if(!T)return z.a.instance.Ua(573089737,1,2,"Base cell unexpectedly null"),-1;Z=this.uC.getPropertyObjectIds(T,f.a.pg);var N=F.IA.K(W.K(ba))||F.Cn.K(W.K(ba));N=this.uC.getPropertyObjectIds(N,f.a.pg);T=this.uC.getPropertyObjectIds(T,f.a.pg);Z=y.b(Z,N,T);for(T=0;T<Z.length;T++){N=Z.K(T);const X=this.IKm(F,C,P,N);if(-1===X)return z.a.instance.Ua(573089738,1,2,"Error getting characters lost for parition {0}",
N.toString()),-1;R+=X}}else{T=this.zLm(C,Z,P);if(-1===T)return z.a.instance.Ua(573089736,1,2,"Error getting text length of cell {0}",Z.id.toString()),-1;R+=T}}}P.add(K);return R}IKm(F,C,P,K){let G=0;var R=new l.a,W=new l.a;const Z=new a.a;new a.a;for(var T=0;T<K.kKb.length;T++){var N=F.Cn.K(K.kKb.K(T));N=this.uC.getPropertyObjectIds(N,f.a.oF);if(1!==N.length)return z.a.instance.Ua(573089739,1,2,"Unexpected number of ContentNodes: {0}",N.length),-1;var U=F.Cn.K(N.K(0));U.wc===m.a.paragraphNode?R.add(U):
U.wc===m.a.qp&&Z.add(N.K(0),U)}for(T=0;T<K.Vzb.length;T++){N=C(K.Vzb.K(T));N=this.uC.getPropertyObjectIds(N,f.a.oF);if(1!==N.length)return z.a.instance.Ua(573089740,1,2,"Unexpected number of ContentNodes: {0}",N.length),-1;U=C(N.K(0));if(U.wc===m.a.paragraphNode)W.add(U);else if(U.wc===m.a.qp){U=this.BGi(F,C,P,N.K(0),U);if(-1===U)return z.a.instance.Ua(573089741,1,2,"Error diffing table {0}",N.K(0).toString()),-1;G+=U}}T=new H.a(this.uC,this._state);if(0<R.length&&0<W.length){R=T.Fmi(R,ba=>F.Cn.K(ba),
W,ba=>C(ba));if(-1===R)return z.a.instance.Ua(573089742,1,2,"Problem diffing parition {0} with LCS",K.toString()),-1;G+=R}else if(0<R.length)for(K=0;K<R.length;K++)G+=this.uC.getPropertyString(R.K(K),f.a.Pn).length+1;else if(0<W.length)for(K=0;K<W.length;K++)G+=this.uC.getPropertyString(W.K(K),f.a.Pn).length+1;for(K=0;K<Z.count;K++)if(R=Z.keys.K(K),!P.contains(R)){W=this.F8d(Z.K(R));if(-1===W)return z.a.instance.Ua(573089743,1,2,"Error getting length of table {0}",R.toString()),-1;G+=W}return G}zLm(F,
C,P){let K=0;C=this.uC.getPropertyObjectIds(C,f.a.pg);for(let W=0;W<C.length;W++){var G=F(C.K(W));G=this.uC.getPropertyObjectIds(G,f.a.oF);if(1!==G.length)return z.a.instance.Ua(573089744,1,2,"Unexpected number of ContentNodes: {0}",G.length),-1;var R=F(G.K(0));if(R.wc===m.a.paragraphNode)K+=this.uC.getPropertyString(R,f.a.Pn).length+1;else if(R.wc===m.a.qp){R=this.F8d(R);if(-1===R)return z.a.instance.Ua(573089745,1,2,"Problem finding text length of table {0}",G.K(0).toString()),-1;K+=R;P.add(G.K(0))}}return K}F8d(F){this._state.runtime.$I("GetTextLengthOfTable");
let C=0;const P=Z=>this._state.runtime.uv.K(Z)||this._state.runtime.Cn.K(Z);F=this.uC.getPropertyObjectIds(F,f.a.pg);for(let Z=0;Z<F.length;Z++){var K=P(F.K(Z));K=this.uC.getPropertyObjectIds(K,f.a.pg);for(let T=0;T<K.length;T++){var G=P(K.K(T));G=this.uC.getPropertyObjectIds(G,f.a.pg);for(let N=0;N<G.length;N++){var R=P(G.K(N));R=this.uC.getPropertyObjectIds(R,f.a.oF);if(1!==R.length)return z.a.instance.Ua(573089746,1,2,"Unexpected number of ContentNodes: {0}",R.length),-1;var W=P(R.K(0));if(W.wc===
m.a.paragraphNode)C+=this.uC.getPropertyString(W,f.a.Pn).length+1;else if(W.wc===m.a.qp){W=this.F8d(W);if(-1===W)return z.a.instance.Ua(573089747,1,2,"Error finding the text length of table {0}",R.K(0)),-1;C+=W}}}}return C}w7l(F,C,P,K){const G=new a.a;for(let R=0;R<F.length;R++){let W=!1;C.uv.K(F.K(R))&&(W=!0);const Z=P(F.K(R)),T=this.uC.getPropertyObjectIds(Z,f.a.pg);if(!W)for(let N=0;N<T.length;N++)if(C.uv.K(T.K(N))){W=!0;break}W?G.add(F.K(R),Z):K.add(F.K(R))}return G}zei(F,C){return this.yei(F.kKb,
F.Vzb,C)}yei(F,C,P){const K=new l.a;for(var G=0;G<F.length;G++)K.add(this._state.runtime.Cn.K(F.K(G)));F=new l.a;for(G=0;G<C.length;G++)F.add(this._state.runtime.uv.K(C.K(G))||this._state.runtime.Cn.K(C.K(G)));return P.Fmi(K,R=>this._state.runtime.Cn.K(R),F,R=>this._state.runtime.uv.K(R)||this._state.runtime.Cn.K(R))}iCf(F,C,P,K){if(F.wc===m.a.Uh){F=this.uC.getPropertyObjectIds(F,f.a.pg);for(let G=0;G<F.length;G++){const R=this.uC.getPropertyObjectIds(C(F.K(G)),f.a.pg);for(let W=0;W<R.length;W++){const Z=
this.uC.getPropertyObjectIds(C(R.K(W)),f.a.pg);for(let T=0;T<Z.length;T++){const N=this.uC.getPropertyObjectIds(C(Z.K(T)),f.a.oF);if(1!==N.length)return;const U=C(N.K(0));U.wc===m.a.paragraphNode?P.add(N.K(0)):U.wc===m.a.qp?K.add(N.K(0)):z.a.instance.Ua(573089748,1,2,"Unsupported class id in GetCharactersLost: "+m.a[U.wc])}}}}}jCf(F,C){F=this.uC.getPropertyObjectIds(F,f.a.pg);const P=new l.a;for(let K=0;K<F.length;K++){const G=this.uC.getPropertyObjectIds(C(F.K(K)),f.a.oF);if(1!==G.length)return null;
P.add(G.K(0))}return P}Kjm(){let F=0;const C=this._state.runtime,P=C.uv,K=R=>C.uv.K(R)||C.Cn.K(R);let G=null;C.$I=R=>{if(750<this.fKa()-this._state.input.H_a)throw z.a.instance.Ua(573089749,1,2,"Timed out while calculating comment characters lost: {0}",R),x.a.invalidOperation(R);};try{P.forEach((R,W)=>{if(W.wc===m.a.XK){R=this.jCf(W,K);var Z=C.Cn.K(W.id);if(Z)Z=this.jCf(Z,N=>C.Cn.K(N)),G||(G=new H.a(this.uC,this._state)),F+=this.yei(Z,R,G);else for(Z=0;Z<R.length;Z++)F+=this.uC.getPropertyString(C.uv.K(R.K(Z)),
f.a.Pn).length+1}if(W.wc===m.a.Rja&&(R=this.uC.getPropertyObjectIds(W,f.a.pg).uS(),W=C.Cn.K(W.id)))for(W=this.uC.getPropertyObjectIds(W,f.a.pg),Z=0;Z<W.length;Z++)if(!R.contains(W.K(Z))){var T=C.Cn.K(W.K(Z));T=this.jCf(T,N=>C.Cn.K(N));for(let N=0;N<T.length;N++)F+=this.uC.getPropertyString(C.Cn.K(T.K(N)),f.a.Pn).length+1}return!0})}catch(R){return z.a.instance.Ua(573089750,1,2,"Exception in GetCommentCharactersLost: "+R.toString()),-1}return F}mPb(){return this.j2a?this.j2a.mPb():null}u5d(F){const C=
new l.a;F.forEach(P=>{C.add(I.K0a(P.mPb()));return!0});return C.toArray()}hxm(){const F=new a.a;F.Z("Succeeded",this._state.output.succeeded);F.Z("Timeout",this._state.output.timeout);F.Z("Crash",this._state.output.Jza);F.Z("MergedRevisions",this._state.output.LL?this._state.output.LL.length:-1);F.Z("Duration",this.rt-this._state.input.H_a);return F}static K0a(F){if(!F)return null;const C={};F.forEach((P,K)=>{C[P.toString()]=K;return!0});return C}}Object(J.a)(I,"MergeLogger",null,[])},1716:function(J,
L,d){d.d(L,"a",function(){return m});J=d(0);class m{constructor(f,a){this.bPa=a;this.lK=f}}Object(J.a)(m,"UpdateHintCollection",null,[])},1717:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);d=d(1476);class m extends d.a{constructor(f,a){super();this.Og=f;this.Yc=a}get type(){return 9}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,this.type,this.Og,this.Yc)}}Object(J.a)(m,"LcsInsertParaUpdateHint",d.a,[])},1718:function(J,L,d){d.d(L,"a",function(){return f});
J=d(0);var m=d(221);d=d(1476);class f extends d.a{constructor(a){super();this.W2=new m.a;this.cp=a}get type(){return 11}toString(){let a="";for(let l=0;l<this.W2.length;l++)a+=String.format("({0}), ",this.W2.K(l).toString());return String.format("[Cp:{0}] {1}",this.cp,a)}}Object(J.a)(f,"LcsInsertUpdateHint",d.a,[])},1719:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);d=d(1476);class m extends d.a{constructor(f,a){super();this.text=a;this.Og=f}get type(){return 7}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [Text:{3}]",
this.cp,this.type,this.Og,this.text)}}Object(J.a)(m,"LcsInsertTextUpdateHint",d.a,[])},1720:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);d=d(1476);class m extends d.a{constructor(f,a,l){super();this.cp=f;this.Og=a;this.Yc=l}get type(){return 10}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,this.type,this.Og,this.Yc)}}Object(J.a)(m,"LcsDeleteParaUpdateHint",d.a,[])},1721:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);d=d(1476);class m extends d.a{constructor(f,
a){super();this.cp=f;this.text=a}get type(){return 8}toString(){return String.format("[Cp:{0}] [Type:{1}] [Text:{2}]",this.cp,this.type,this.text)}}Object(J.a)(m,"LcsDeleteTextUpdateHint",d.a,[])},1722:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);d=d(1440);class m extends d.a{constructor(){super()}get Xea(){return"Conflict"}}Object(J.a)(m,"ConflictMergeFailureDetail",d.a,[])},1723:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);d=d(1440);class m extends d.a{constructor(){super()}get Xea(){return"TableMerge"}}
Object(J.a)(m,"TableMergeFailureDetail",d.a,[])},1725:function(J,L,d){d.d(L,"a",function(){return a});J=d(0);var m=d(226),f=d(17);class a{constructor(l,w,z,x,u){this.J6e=l;this.I6e=w;this.QNk=z;this.kwk=x;this.Jkh=u}get nZb(){return 4}eka(l,w=null){w=w.sessionId+"|"+w.$sa+"|"+l.tE;if(this.Jkh||this.kwk){let z=this.Jkh||f.a.kC(CommonUIStrings.l_HelpTooltip)===f.a.kC(l.tE.trim());if(this.QNk&&2<l.tE.length){const x=l.tE;";"===x.charAt(0)&&";"===x.charAt(x.length-1)&&x.substring(1,x.length-1)===a.LRf&&
(z=!0)}l=z?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,l.tE);return this.Mqi(w,f.a.Jf(l),z)}return this.Mqi(w,f.a.Jf(String.format(CommonUIStrings.l_TextWithQuotation,l.tE)),!1)}Mqi(l,w,z){return m.a(a.LRf,z?this.I6e:this.J6e,w,"OfficeAssistant_16x16x32","A0",f.a.Jf(l),w,null,null)}}a.LRf="bSearchHelp";Object(J.a)(a,"AssistanceMenuItemFactory",null,[1878])},1726:function(J,L,d){d.d(L,"a",function(){return w});J=d(0);var m=d(2),f=d(226),a=d(97),l=
d(17);class w{get nZb(){return 13}eka(){return w.Hdl()}static Hdl(){return f.b(w.Gni,"798637440",l.a.Jf(CommonUIStrings.l_LookupFirstRunExperienceTitle),m.AFrameworkApplication.Ss,a.getImageClass("Info_32x32x32"),null,null,l.a.Jf(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,l.a.Jf(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}w.Gni="bTellMeFirstRun";Object(J.a)(w,"FirstRunMenuItemFactory",null,[1878])},1727:function(J,L,d){d.d(L,"a",function(){return m});
J=d(0);class m{}m.MRi="bInsights";Object(J.a)(m,"InsightsMenuItemFactoryStatic",null,[])},1728:function(J,L,d){d.d(L,"a",function(){return l});J=d(0);var m=d(2),f=d(226),a=d(17);class l{constructor(w=null,z=null){this.Iuh=w;this.yDk=z||CommonUIStrings.l_LookupNoResultsDescription}get nZb(){return 14}eka(w){w=String.format(this.yDk,w.tE);return this.wel(w)}wel(w){return f.b(l.Afj,"798637440",a.a.Jf(CommonUIStrings.l_LookupNoResultsTitle),this.Iuh?m.AFrameworkApplication.Ss:null,this.Iuh,null,null,
a.a.Jf(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,a.a.Jf(w),null,null)}}l.Afj="lookupNoResults";Object(J.a)(l,"NoCommandsFoundMenuItemFactory",null,[1878])},1729:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m{constructor(f,a){this.FontWeight=0;this.Text=null;this.FontWeight=f;this.Text=a}}Object(J.a)(m,"LabelFormatted",null,[])},1730:function(J,L,d){d.d(L,"a",function(){return z});J=d(0);d(1377);var m=d(1379),f=d(1382),a=d(1381),l=d(1372),w=d(17);class z{constructor(x){this.kc=
x}oN(){return"Assistance"}bX(){return 0===this.kc.iw?0:1===this.kc.iw?1:this.kc.kfd?3:2}WJ(x,u,v=!1,E,y=null){E=new a.a(x);if((!y||Array.contains(y,8))&&!l.a.wU(x)){y=new f.a(8);if(v){v=w.a.kC(CommonUIStrings.l_HelpTooltip)===w.a.kC(x.Wg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,x.Wg);const H=[];this.kc.Aab&&(this.kc.uye||H.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),v=this.mBi(x.Wg));const I=
"||"+x.Wg;H.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",v));H.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",I));appChrome.api.dispatch(H);x=new m.a("GetHelpFromTellMe",4,x.Wg,null,1)}else x=new m.a("bSearchHelp",4,x.Wg,null,1);y.Xx(x);y.displayName=CommonUIStrings.l_HelpButtonTitle;E.dw(y)}u.Nt(E)}nrb(x,u=null){const v=new f.a(8),E=w.a.kC(CommonUIStrings.l_HelpTooltip)===w.a.kC(x.Wg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,
x.Wg);for(let H=0;H<u.length&&2>H;H++){var y=[];let I="GetHelpWithDescriptionFromTellMe"+(H+1).toString(),F=4;if(this.kc.lod)y.push(appChrome.actions.setControlLabel(I,E)),y.push(appChrome.actions.setCompoundButtonCommandValueId(I,x.Wg)),y.push(appChrome.actions.updateCompoundButtonDescription(I,this.dOf(u.length)));else if(this.kc.nod){let C=this.NHi(u[H]);I="GetHelpFromTellMe"+(H+1).toString();this.kc.Aab&&(C=this.mBi(C));F=9;y.push(appChrome.actions.setControlLabel(I,C));y.push(appChrome.actions.setButtonCommandValueId(I,
this.oMm(u[H])))}appChrome.api.dispatch(y);y=new m.a(I,F,null,null,0);y.label=this.NHi(u[H]);y.description=this.nMm(u[H]);v.Xx(y);if(this.kc.nod)break}v.displayName=CommonUIStrings.l_HelpButtonTitle;return v}dOf(x){return 1===x?String.format(CommonUIStrings.l_SearchResultText,x):String.format(CommonUIStrings.l_SearchResultsText,x)}mBi(x){return this.kc.W_f?l.a.VIf(x,CommonUIStrings.l_HelpScopedButtonText):x+CommonUIStrings.l_HelpScopedButtonText}NHi(x){return x.name?x.name:""}nMm(x){return x.description?
x.description:""}oMm(x){return x.id?"AssetID="+x.id:""}}Object(J.a)(z,"AssistanceResultsProvider",null,[1399])},1731:function(J,L,d){d.d(L,"a",function(){return x});J=d(0);d(1377);var m=d(1379),f=d(1382),a=d(1381),l=d(1373),w=d(1372),z=d(1439);class x{constructor(u){this.kc=u}oN(){return"Image"}bX(){return 0===this.kc.iw?0:1===this.kc.iw?1:3===this.kc.iw?3:2}WJ(u,v,E,y,H=null){E=new a.a(u);(!H||Array.contains(H,19))&&w.a.wU(u)&&this.kc.mS&&this.nrb(u,E,1);v.Nt(E)}nrb(u,v,E,y=null){var H=[];let I;
l.TellMeActor.instance.rR()&&l.TellMeActor.instance.rR().Aab?(I=this.kc.W_f?w.a.VIf(u.Wg,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):u.Wg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.kc.uye||H.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):I=this.kc.mS?w.a.wU(u)?this.kc.hmb?w.a.cqb(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.kc.hmb?w.a.cqb(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,
u.Wg)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,u.Wg):this.kc.Vwc?CommonUIStrings.l_TellMeImageSuggestionButtonText:u.Wg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.kc.hBa?(l.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",I)),H=w.a.oUa(u.Wg,9,Object.assign(new z.a,{landingTab:"Image"})),l.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",H))):(H.push(appChrome.actions.setControlLabel("ImageForSearch",
I)),u=w.a.oUa(u.Wg,9,Object.assign(new z.a,{landingTab:"Image"})),H.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",u)),appChrome.api.dispatch(H));E=new m.a("ImageForSearch",12,null,null,E);y&&(E.score=y.ConfidenceScore);y=new f.a(19,this.kc.Vwc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);y.Xx(E);v.dw(y)}}Object(J.a)(x,"ImageResultsProvider",null,[1399])},1732:function(J,L,d){d.d(L,"a",function(){return z});J=d(0);d(1377);var m=d(1379),f=d(1382),a=d(1381),
l=d(1372),w=d(2);class z{constructor(x){this.kc=x}oN(){return"Template"}bX(){return 0===this.kc.iw?0:1===this.kc.iw?1:3}WJ(x,u){x=new a.a(x);u.Nt(x)}nrb(x,u,v){var E=[];let y;y=this.kc.mS?this.kc.hmb?l.a.cqb(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,x.Wg)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,x.Wg):String.format(CommonUIStrings.l_TellMeTemplateButtonText,x.Wg);E.push(appChrome.actions.setControlLabel("TemplateForSearch",y));E.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",
String.format(w.AFrameworkApplication.J.ib("TellMeTemplateProviderURL"),w.AFrameworkApplication.uiCulture,x.Wg)));appChrome.api.dispatch(E);x=new f.a(23);x.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;E=new m.a("TemplateForSearch",24,null,null,0);E.label=v[0].Title?v[0].Title:"";E.description=v[0].Description?v[0].Description:"";x.Xx(E);u.dw(x)}}Object(J.a)(z,"TemplateResultsProvider",null,[1399])},1733:function(J,L,d){d.d(L,"a",function(){return v});J=d(0);d(1377);var m=d(1442),f=d(1379),
a=d(1382),l=d(1381),w=d(1583),z=d(1373),x=d(1372),u=d(17);class v{constructor(E,y,H,I){this.F5=E;this.ilb=y;this.uHh=I;this.Jtk=H;this.kc=z.TellMeActor.instance.rR()}oN(){return"EmptyQuery"}bX(){return 1===this.kc.iw?1:0}WJ(E,y,H=!1,I,F=null){I=new l.a(E);if((!F||Array.contains(F,5)||Array.contains(F,6)||Array.contains(F,4))&&x.a.wU(E)){this.F5.Q1c().length||!this.Jtk||this.uHh||(E=new a.a(6),F=new f.a(null,13,void 0,void 0,1),E.Xx(F),I.dw(E));E=new a.a(4);if(0<this.F5.Q1c().length){E.displayName=
CommonUIStrings.l_TellMeRecentlyUsedTitle;F=this.F5.Q1c();var C=[];for(var P of F)C.push(P.Id);m.CommandResultsUtility.jsd(C,this.kc);for(var K of F)m.CommandResultsUtility.Z7c(K.Id)&&E.Xx(new f.a(K.Id,5,null,null,2));I.dw(E)}if(this.uHh&&0<this.ilb.length&&this.F5.Q1c().length<v.maxResults){P=new a.a(5);P.displayName=CommonUIStrings.l_TellMeTryQueryTitle;K=v.maxResults-E.results.length;E=[];for(F=0;F<this.ilb.length&&F<K;++F){if(H){C=x.a.BJg+(F+1);const G=this.ilb[F].key,R=u.a.replaceAll(G,'"',"");
E.push(appChrome.actions.setControlLabel(C,G));E.push(appChrome.actions.setButtonCommandValueId(C,R));C=new w.a(G,7,0,R,C)}else C=new w.a(this.ilb[F].key,7,0,this.ilb[F].value);P.Xx(C)}0<E.length&&appChrome.api.dispatch(E);I.dw(P)}}y.Nt(I)}}v.maxResults=5;Object(J.a)(v,"EmptyQueryResultsProvider",null,[1399])},1734:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m{constructor(){this.fBe=this.wWa=this.Krb=this.Uy=this.rTd=this.uH=this.N2b=0}}Object(J.a)(m,"TRIESCAN",null,[])},1759:function(J,
L,d){d.r(L);var m=d(0),f=d(1377),a=d(1460),l=d(1407),w=d(1379),z=d(1382),x=d(1381),u=d(1373),v=d(1372),E=d(1439);class y{constructor(nb){this.kc=nb}oN(){return"ActionAI"}bX(){return 0===this.kc.iw?0:1===this.kc.iw?1:2}WJ(nb,Nb,ec=!1,Hc,Tc=null){Hc=new x.a(nb);if(!Tc||Array.contains(Tc,24))if(this.g1o()||!v.a.wU(nb)){Tc=new z.a(24);var xd=v.a.wU(nb);ec&&(ec=null,v.a.yta()&&(ec=v.a.oUa(xd?"":nb.Wg,1,Object.assign(new E.a,{landingTab:"ActionAI"}))),this.kc.hBa?ec&&u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",
ec)):(nb=[],ec&&nb.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",ec)),appChrome.api.dispatch(nb)));Tc.Xx(new w.a("ActionAIFromTellMe",25,null,null,1));Hc.dw(Tc)}Nb.Nt(Hc)}g1o(){return v.a.yta()&&this.kc.YVf}}Object(m.a)(y,"ActionAIResultsProvider",null,[1399]);var H=d(1614);class I{constructor(nb,Nb){this.$Ea=nb;this.Fl=Nb}Nt(nb){this.$Ea.NUo(this.Fl,nb)}}Object(m.a)(I,"AggregatorResultsProviderCallback",null,[1913]);class F{constructor(nb){this.lwa=null;this.kc=nb;this.kc.fKb&&
(this.lwa=null)}oN(){return"AppsForOffice"}bX(){return 0===this.kc.iw?0:1===this.kc.iw?1:2}WJ(nb,Nb,ec,Hc,Tc=null){ec=new x.a(nb);if(!Tc||Array.contains(Tc,1))Tc=new z.a(1),this.lwa.RPp(Tc,nb.Wg),ec.dw(Tc);Nb.Nt(ec)}}Object(m.a)(F,"AppsForOfficeRecommendationResultsProvider",null,[1399]);var C=d(1730),P=d(1367),K=d(1395),G=d(252);class R{constructor(nb,Nb){this.Ab=nb;this.iEn=Nb}isMatch(nb,Nb){if(!Object(G.a)(2036,nb))throw Error.argument("objToTest","Expected feature bundle");let ec;return({value:ec}=
nb.mr(this.Ab.aza)).returnValue?this.Ab.YMg.isMatch(ec,Nb):this.iEn}}Object(m.a)(R,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[2048]);class W{constructor(nb,Nb){this.Ab=nb;this.t6f=Nb}isMatch(nb){if(!Object(G.a)(2036,nb))throw Error.argument("objToTest","Expected feature bundle");return!!(this.t6f^nb.mr(this.Ab.aza).returnValue)}}Object(m.a)(W,"AnnotatedWithAnnotationFilter",null,[2048]);class Z{constructor(nb){this.Ab=nb}isMatch(nb,Nb){if(!Object(G.a)(2039,nb))throw Error.argument("objToTest",
"Expected struct value");return this.Ab.YMg.isMatch(nb.uqb(this.Ab.cVa),Nb)}}Object(m.a)(Z,"FieldValueMatchesStructFilter",null,[2048]);class T{constructor(nb,Nb){nb&&(this.cVa=nb.K(0),this.YMg=Nb.ssa(nb.K(1)))}}Object(m.a)(T,"FieldValueMatchesStructFilterInit",null,[]);class N{constructor(nb){this.t6f=nb}isMatch(nb){if(!Object(G.a)(2036,nb))throw Error.argument("objToTest","Expected feature bundle");return!!(this.t6f^nb.UQf)}}Object(m.a)(N,"HasAnnotationsAnnotationFilter",null,[2048]);class U{constructor(nb,
Nb){this.Ab=nb;this.xba=Nb}isMatch(nb,Nb){if(!Object(G.a)(2038,nb))throw Error.argument("objToTest","Expected list value");switch(this.xba){case 0:for(const ec of nb.items)if(this.Ab.filter.isMatch(ec,Nb))return!0;return!1;case 1:for(const ec of nb.items)if(!this.Ab.filter.isMatch(ec,Nb))return!1;return!0;default:throw Error.notImplemented();}}}Object(m.a)(U,"ItemTestListFilter",null,[2048]);class ba{constructor(nb){this.Ab=nb}isMatch(nb,Nb){if(!Object(G.a)(2038,nb))throw Error.argument("objToTest",
"Expected list value");return this.Ab.filter.isMatch(nb.items.length,Nb)}}Object(m.a)(ba,"LengthMatchesListFilter",null,[2048]);class X{constructor(nb,Nb){this.Ab=nb;this.xba=Nb}isMatch(nb,Nb,ec=null){let Hc=0===this.xba;for(const Tc of this.Ab.F0h)if((Hc=Tc.isMatch(nb,Nb,ec))?1===this.xba:0===this.xba)return Hc;2===this.xba&&(Hc=!Hc);return Hc}}Object(m.a)(X,"NonterminalFilter",null,[2048]);class Y{constructor(nb,Nb){if(nb){var ec=nb.K(0);this.F0h=Array(ec);for(let Hc=0;Hc<ec;++Hc)this.F0h[Hc]=Nb.ssa(nb.K(1+
Hc))}}}Object(m.a)(Y,"NonterminalFilterInit",null,[]);class ca{constructor(nb,Nb){this.Ab=nb;this.xba=Nb}isMatch(nb,Nb){if("number"!==typeof nb)throw Error.argument("objToTest","Expected number value");let ec=this.Ab.number;if(this.Ab.query){Nb=this.Ab.query.Gu(null,Nb);if("number"!==typeof Nb)throw Error.invalidOperation("Query did not return number");ec+=Nb}switch(this.xba){case 0:return nb===ec;case 1:return nb<ec;case 2:return nb<=ec;case 3:return nb>ec;case 4:return nb>=ec;default:throw Error.notImplemented();
}}}Object(m.a)(ca,"NumberFilter",null,[2048]);class ia{constructor(nb,Nb){nb&&(this.number=nb.K(0),this.query=nb.K(1)?Nb.eN(nb.K(1)):null)}}Object(m.a)(ia,"NumberFilterInit",null,[]);class la{constructor(nb,Nb,ec){this.v5d=this.mpm;this.oEn=nb;this.L$i=Nb;this.K$i=ec}Ymf(nb){this.L$i=nb}mpm(nb){if(!nb)throw Error.argument("name","Invalid named feature bundle reference");const Nb=nb.substr(1);return 1===nb.charCodeAt(0)&&Nb===this.oEn?this.L$i:this.K$i?this.K$i.v5d(nb):null}}Object(m.a)(la,"SimpleNamedFeatureBundleResolver",
null,[2051]);class ta{constructor(nb){this.Ab=nb}isMatch(nb,Nb){if(!Object(G.a)(2036,nb))throw Error.argument("objToTest","Expected feature bundle");nb=this.Ab.query.Gu(null,new la(this.Ab.cFe,nb,Nb));if("boolean"!==typeof nb)throw Error.invalidOperation("Query did not return bool");return nb}}Object(m.a)(ta,"PredicateAnnotationFilter",null,[2048]);class za{constructor(nb,Nb){nb&&(this.cFe=Nb.eD(nb.K(0)),this.query=Nb.eN(nb.K(1)))}}Object(m.a)(za,"PredicateAnnotationFilterInit",null,[]);class Ha{constructor(nb){this.Ab=
nb}isMatch(nb,Nb){if("boolean"!==typeof nb)throw Error.argument("objToTest","Expected bool value");Nb=this.Ab.query.Gu(null,Nb);if("boolean"!==typeof Nb)throw Error.invalidOperation("Query did not return bool");return nb===Nb}}Object(m.a)(Ha,"QueryBooleanFilter",null,[2048]);class Na{constructor(nb,Nb){this.Ab=nb;this.xba=Nb}isMatch(nb,Nb){if("number"!==typeof nb)throw Error.argument("objToTest","Expected integer");Nb=this.Ab.query.Gu(null,Nb);if("number"!==typeof Nb)throw Error.invalidOperation("Query did not return an enum value");
switch(this.xba){case 0:return nb===Nb;case 1:return 0!==(nb&Nb);case 2:return nb===(nb&Nb);case 3:return Nb===(nb&Nb);default:throw Error.notImplemented();}}}Object(m.a)(Na,"QueryEnumFilter",null,[2048]);class ya{constructor(nb,Nb){nb&&(this.Yde=1===nb.K(0),this.query=Nb.eN(nb.K(1)))}}Object(m.a)(ya,"QueryEnumFilterInit",null,[]);class ma{constructor(nb,Nb){this.Ab=nb;this.xba=Nb}isMatch(nb,Nb){if(!Object(G.a)(2038,nb))throw Error.argument("objToTest","Expected list value");Nb=this.Ab.query.Gu(null,
Nb);if(!Object(G.a)(2038,Nb))throw Error.invalidOperation("Query did not return list value");if(nb.M7!==Nb.M7)return!1;switch(this.xba){case 0:return P.Annotations.oAb(P.Annotations.kwm(nb.M7),nb,Nb);case 1:for(const ec of nb.items)for(const Hc of Nb.items)if(P.Annotations.oAb(nb.M7,ec,Hc))return!0;return!1;case 2:for(const ec of nb.items)for(const Hc of Nb.items)if(!P.Annotations.oAb(nb.M7,ec,Hc))return!1;return!0;case 3:for(const ec of Nb.items)for(const Hc of nb.items)if(!P.Annotations.oAb(nb.M7,
ec,Hc))return!1;return!0;default:throw Error.notImplemented();}}}Object(m.a)(ma,"QueryListFilter",null,[2048]);class Ea{constructor(nb,Nb){this.Ab=nb;this.xba=Nb}isMatch(nb,Nb){if("string"!==typeof nb)throw Error.argument("objToTest","Expected string");Nb=this.Ab.query.Gu(null,Nb);if("string"!==typeof Nb)throw Error.invalidOperation("Query did not return string");this.Ab.xWf&&(nb=nb.toUpperCase(),Nb=Nb.toUpperCase());switch(this.xba){case 0:return nb===Nb;case 1:return 0<=nb.indexOf(Nb);case 2:return nb.startsWith(Nb);
case 3:return nb.endsWith(Nb);case 4:return 0<=Nb.indexOf(nb);case 5:return Nb.startsWith(nb);case 6:return Nb.endsWith(nb);default:throw Error.notImplemented();}}}Object(m.a)(Ea,"QueryStringFilter",null,[2048]);class Ba{constructor(nb,Nb){nb&&(this.query=Nb.eN(nb.K(0)),this.xWf=1===nb.K(1))}}Object(m.a)(Ba,"QueryStringFilterInit",null,[]);class $a{constructor(nb){this.Ab=nb}isMatch(nb,Nb){if(!Object(G.a)(2039,nb))throw Error.argument("objToTest","Expected struct value");Nb=this.Ab.query.Gu(null,
Nb);if(!Object(G.a)(2039,Nb))throw Error.invalidOperation("Query did not return struct value");return nb.isEqual(nb)}}Object(m.a)($a,"QueryStructFilter",null,[2048]);class ea{constructor(nb){this.Ab=nb}isMatch(nb,Nb){nb=this.Ab.query.Gu(null,Nb);if("boolean"!==typeof nb)throw Error.invalidOperation("Query did not return bool");return nb}}Object(m.a)(ea,"QueryWhereConstraintFilter",null,[2048]);class ka{constructor(nb){this.Ab=nb}isMatch(nb){if("string"!==typeof nb)throw Error.argument("objToTest",
"Expected string");return this.Ab.Ipg.test(nb)}}Object(m.a)(ka,"RegexStringFilter",null,[2048]);class La{constructor(nb,Nb){nb&&(this.Ipg=Nb.kkc(nb.K(0)))}}Object(m.a)(La,"RegexStringFilterInit",null,[]);class va{constructor(nb,Nb){nb&&(this.filter=Nb.ssa(nb.K(0)))}}Object(m.a)(va,"SingleFilterFilterInit",null,[]);class Ca{constructor(nb,Nb){nb&&(this.query=Nb.eN(nb.K(0)))}}Object(m.a)(Ca,"SingleQueryFilterInit",null,[]);class ua{constructor(nb){this.Ab=nb}isMatch(nb){if("boolean"!==typeof nb)throw Error.argument("objToTest",
"Expected bool value");return nb===this.Ab.value}}Object(m.a)(ua,"StoredValueBooleanFilter",null,[2048]);class Sa{constructor(nb){nb&&(this.value=1===nb.K(0))}}Object(m.a)(Sa,"StoredValueBooleanFilterInit",null,[]);class Ta{constructor(nb,Nb){this.Ab=nb;this.xba=Nb}isMatch(nb){if("number"!==typeof nb)throw Error.argument("objToTest","Expected integer");switch(this.xba){case 0:return this.Ab.Yde?this.Ab.value?!!(nb&this.Ab.value):!nb:nb===this.Ab.value;case 1:return this.Ab.Yde?(nb&this.Ab.value)===
this.Ab.value:32>nb&&(1<<nb&this.Ab.value)===this.Ab.value;case 2:return this.Ab.Yde?!!(nb&this.Ab.value):32>nb&&!!(1<<nb&this.Ab.value);default:throw Error.notImplemented();}}}Object(m.a)(Ta,"StoredValueEnumFilter",null,[2048]);class zb{constructor(nb){nb&&(this.Yde=1===nb.K(0),this.value=nb.K(1))}}Object(m.a)(zb,"StoredValueEnumFilterInit",null,[]);class Ra{constructor(){this.i6n=null;this.Glf=this.oRb=0}}Object(m.a)(Ra,"WHEREConstraintData",null,[]);class qb{constructor(nb){this.Ab=nb}isMatch(nb,
Nb){if(!Object(G.a)(Ra,nb))throw Error.argument("objToTest","Expected WHERE constraint data");let ec=-1,Hc=-1;const Tc=nb.i6n;switch(this.Ab.Jmf){case 4:ec=Tc.e0c;Hc=Tc.sDg;break;case 5:ec=nb.oRb;Hc=Tc.e0c-nb.oRb;break;case 6:ec=Tc.e0c+Tc.sDg;Hc=nb.oRb+nb.Glf-ec;break;case 1:case 2:case 3:let xd=!1;for(let ld=Tc.QRp;ld;ld=ld.next)if(this.Ab.yzp===ld.name){xd=!0;1===this.Ab.Jmf?(ec=ld.e0c,Hc=ld.sDg):2===this.Ab.Jmf?(ec=nb.oRb,Hc=ld.e0c-nb.oRb):(ec=ld.e0c+ld.sDg,Hc=nb.oRb+nb.Glf-ec);break}if(!xd)return!1;
break;case 7:ec=nb.oRb;Hc=nb.Glf;break;default:throw Error.notImplemented();}return null!==this.Ab.q9o.BZp(Tc.ijq,ec,Hc,ec,!0,2,Nb)}}Object(m.a)(qb,"SubSreWhereConstraintFilter",null,[2048]);class kb{constructor(nb,Nb){if(nb){var ec=Nb.eD(nb.K(0));this.Jmf=ec.charCodeAt(0);this.yzp=ec.substr(1);this.q9o=Nb.HGm(nb.K(1))}}}Object(m.a)(kb,"SubSreWhereConstraintFilterInit",null,[]);class Va{constructor(nb){this.Ab=nb}isMatch(nb,Nb,ec=null){if(!Object(G.a)(2036,nb))throw Error.argument("objToTest","Expected feature bundle");
if(null==ec)throw Error.argumentNull("parentTextForSpan");if(this.Ab.lQh&&!this.Ab.lQh.isMatch(nb,Nb))return!1;if(this.Ab.hHg){let Hc;if(({value:Hc}=nb.mr(this.Ab.k8o)).returnValue){if(!this.Ab.hHg.isMatch(Hc,Nb))return!1}else{let Tc,xd;if(!({value:Tc}=nb.mr(this.Ab.SUj)).returnValue||!({value:xd}=nb.mr(this.Ab.RUj)).returnValue||0>Tc||0>xd||Tc+xd>ec.length||!this.Ab.hHg.isMatch(ec.substr(Tc,xd),Nb))return!1}}if(this.Ab.MVj){let Hc;if(!({value:Hc}=nb.mr(this.Ab.SUj)).returnValue||!this.Ab.MVj.isMatch(Hc,
Nb))return!1}if(this.Ab.j5i){let Hc;if(!({value:Hc}=nb.mr(this.Ab.RUj)).returnValue||!this.Ab.j5i.isMatch(Hc,Nb))return!1}return!0}}Object(m.a)(Va,"TextSpanFilter",null,[2048]);class Za{constructor(nb,Nb){nb&&(this.annotations=Nb.annotations,this.SUj=nb.K(0),this.RUj=nb.K(1),this.k8o=nb.K(2),this.hHg=nb.K(3)?Nb.ssa(nb.K(3)):null,this.lQh=nb.K(4)?Nb.ssa(nb.K(4)):null,this.MVj=nb.K(5)?Nb.ssa(nb.K(5)):null,this.j5i=nb.K(6)?Nb.ssa(nb.K(6)):null)}}Object(m.a)(Za,"TextSpanFilterInit",null,[]);class Ka{constructor(nb,
Nb){nb&&(this.annotations=Nb.annotations,this.aza=nb.K(0),this.YMg=nb.K(1)?Nb.ssa(nb.K(1)):null)}}Object(m.a)(Ka,"ValueFilterAnnotationFilterInit",null,[]);var bb=d(1417);class Ib{ssa(nb,Nb){const ec=nb.K(0),Hc=new bb.a;Hc.Lpb(nb,1,nb.count-1);switch(ec){case 1:return new X(new Y(Hc,Nb),0);case 2:return new X(new Y(Hc,Nb),1);case 3:return new X(new Y(Hc,Nb),2);case 101:return new ka(new La(Hc,Nb));case 103:return new Ea(new Ba(Hc,Nb),0);case 104:return new Ea(new Ba(Hc,Nb),1);case 105:return new Ea(new Ba(Hc,
Nb),2);case 106:return new Ea(new Ba(Hc,Nb),3);case 107:return new Ea(new Ba(Hc,Nb),4);case 108:return new Ea(new Ba(Hc,Nb),5);case 109:return new Ea(new Ba(Hc,Nb),6);case 201:return new ua(new Sa(Hc));case 202:return new Ha(new Ca(Hc,Nb));case 301:return new ca(new ia(Hc,Nb),0);case 302:return new ca(new ia(Hc,Nb),1);case 303:return new ca(new ia(Hc,Nb),2);case 304:return new ca(new ia(Hc,Nb),3);case 305:return new ca(new ia(Hc,Nb),4);case 401:return new Ta(new zb(Hc),0);case 402:return new Ta(new zb(Hc),
1);case 403:return new Ta(new zb(Hc),2);case 404:return new Na(new ya(Hc,Nb),0);case 405:return new Na(new ya(Hc,Nb),1);case 406:return new Na(new ya(Hc,Nb),2);case 407:return new Na(new ya(Hc,Nb),3);case 501:return new Z(new T(Hc,Nb));case 502:return new $a(new Ca(Hc,Nb));case 601:return new U(new va(Hc,Nb),0);case 602:return new U(new va(Hc,Nb),1);case 603:return new ba(new va(Hc,Nb));case 604:return new ma(new Ca(Hc,Nb),0);case 605:return new ma(new Ca(Hc,Nb),1);case 606:return new ma(new Ca(Hc,
Nb),2);case 607:return new ma(new Ca(Hc,Nb),3);case 701:return new N(!1);case 702:return new N(!0);case 703:return new W(new Ka(Hc,Nb),!1);case 704:return new W(new Ka(Hc,Nb),!0);case 705:return new R(new Ka(Hc,Nb),!1);case 706:return new R(new Ka(Hc,Nb),!0);case 707:return new ta(new za(Hc,Nb));case 901:return new Va(new Za(Hc,Nb));case 1002:return new ea(new Ca(Hc,Nb));case 1001:return new qb(new kb(Hc,Nb));default:throw Error.argument("initData");}}}Object(m.a)(Ib,"FilterFactory",null,[2041]);
var ib=d(1375);class jb{constructor(nb){this.Ab=nb}get DF(){return this.Ab.DF}get o8(){return this.Ab.o8}get DAe(){return this.Ab.DAe}get Dce(){return this.Ab.Dce}load(nb,Nb){return this.Gu(nb,nb?new la("root",nb,Nb):Nb)}store(nb,Nb,ec){this.Uxc(nb,Nb,nb?new la("root",nb,ec):ec,null)}Gu(nb,Nb){if(!this.Dce&&!this.Ab.annotations.Qnc(this.DF,nb))throw Error.argument("input","Input value not of expected type");let ec=this.Ab.Jni;for(;ec;)nb=ec.load(nb,Nb),ec=ec.next;return nb}Uxc(nb,Nb,ec,Hc){if(!this.DAe)throw Error.invalidOperation("Attempt to store into query that supports only loading");
if(!this.Dce&&!this.Ab.annotations.Qnc(this.DF,nb))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Ab.annotations.Qnc(this.o8,Nb))throw Error.argument("rvalue","Rvalue not of expected type");return this.Ab.Jni.store(nb,Nb,ec,Hc)}static K2h(nb,Nb,ec,Hc){if(ec===Hc)return Nb;if(P.Annotations.kK(ec)&&P.Annotations.kK(Hc)){ec=P.Annotations.j9a(ec);Hc=P.Annotations.j9a(Hc);const Tc=new ib.a(nb,Hc);for(const xd of Nb.items)Array.add(Tc.items,jb.K2h(nb,xd,ec,Hc));return Tc}if(ec===
P.Annotations.TOa){if(Hc===P.Annotations.Sva)return Nb;if(Hc===P.Annotations.Ica)return Nb.toString()}else if(ec===P.Annotations.Sva){if(Hc===P.Annotations.TOa)return Math.floor(Nb);if(Hc===P.Annotations.Ica)return Nb.toString()}else if(ec===P.Annotations.Ica){if(Hc===P.Annotations.TOa)return parseInt(Nb);if(Hc===P.Annotations.Sva)return parseFloat(Nb)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(m.a)(jb,"AnnotationQuery",null,[2043]);class hb{constructor(){this.o8=
this.DF=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}n9a(nb){if(this.next)return{returnValue:this.next,jOa:nb};if(nb){const Nb=nb.c6h;nb=nb.wtj;return{returnValue:Nb,jOa:nb}}return{returnValue:null,jOa:nb}}}Object(m.a)(hb,"AnnotationQueryStep",null,[2058]);class pb extends hb{constructor(nb){super();this.Ab=nb}load(nb,Nb){Nb=this.Ab.query.Gu(nb,Nb);if(P.Annotations.kK(this.DF)){var ec=P.Annotations.j9a(this.DF);let Tc=new ib.a(this.Ab.annotations,ec);if(P.Annotations.kK(this.Ab.query.o8)){if(nb.items.length!==
Nb.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let xd=0,ld=nb.items.length;xd<ld;++xd)Array.add(Tc.items,this.ATd(nb.items[xd],Nb.items[xd],ec===P.Annotations.Sva))}else for(var Hc of nb.items)Array.add(Tc.items,this.ATd(Hc,Nb,ec===P.Annotations.Sva));return Tc}if(P.Annotations.kK(this.Ab.query.o8)){Hc=new ib.a(this.Ab.annotations,this.DF);for(ec of Nb.items)Array.add(Hc.items,this.ATd(nb,ec,this.DF===P.Annotations.Sva));return Hc}return this.ATd(nb,
Nb,this.DF===P.Annotations.Sva)}ATd(nb,Nb,ec){nb=this.Pdc(nb,Nb);return ec?nb:Math.floor(nb)}}Object(m.a)(pb,"NumericAnnotationQueryStep",hb,[]);class ob extends pb{constructor(nb){super(nb)}Pdc(nb,Nb){return nb+Nb}}Object(m.a)(ob,"AddAnnotationQueryStep",pb,[]);class sb extends hb{constructor(nb){super();this.Ab=nb}load(nb,Nb){if(this.DF===P.Annotations.xEa&&this.Ab.query.o8===P.Annotations.xEa){let Tc;if(({result:Tc}=this.dZh(nb)).returnValue)return Tc}if(P.Annotations.kK(this.DF)){var ec=new ib.a(this.Ab.annotations,
P.Annotations.xEa);Nb=this.Ab.query.Gu(nb,Nb);if(P.Annotations.kK(this.Ab.query.o8)){if(nb.items.length!==Nb.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let Tc=0,xd=nb.items.length;Tc<xd;++Tc)Array.add(ec.items,this.CVc(Nb.items[Tc],nb.items[Tc]))}else for(var Hc of nb.items)Array.add(ec.items,this.CVc(Nb,Hc));return ec}Hc=this.Ab.query.Gu(nb,Nb);if(P.Annotations.kK(this.Ab.query.o8)){Nb=new ib.a(this.Ab.annotations,P.Annotations.xEa);for(ec of Hc.items)Array.add(Nb.items,
this.CVc(ec,nb));return Nb}return this.CVc(Hc,nb)}}Object(m.a)(sb,"BinaryBooleanAnnotationQueryStep",hb,[]);class Ab extends sb{constructor(nb){super(nb)}dZh(nb){return{returnValue:!nb,result:!1}}CVc(nb,Nb){return nb&&Nb}}Object(m.a)(Ab,"AndAnnotationQueryStep",sb,[]);class nc{constructor(nb){nb&&(this.annotations=nb)}}Object(m.a)(nc,"AnnotationsOnlyQueryStepInit",null,[]);class qc extends hb{constructor(nb){super();this.Ab=nb}load(nb,Nb){Nb=this.Ab.query.Gu(nb,Nb);nb=nb.clone();P.Annotations.kK(this.Ab.query.o8)?
Array.addRange(nb.items,Nb.items):Array.add(nb.items,Nb);return nb}}Object(m.a)(qc,"AppendAnnotationQueryStep",hb,[]);class Jc extends hb{constructor(nb){super();this.Ab=nb}load(nb,Nb){if(this.DF===P.Annotations.sY)return this.i_c(nb,Nb);const ec=new ib.a(this.Ab.annotations,P.Annotations.sY);for(const Hc of nb.items)Array.add(ec.items,this.i_c(Hc,Nb));return ec}i_c(nb,Nb){const ec=new K.a(this.Ab.annotations);ec.T6a(nb);nb=new K.a(this.Ab.annotations);this.Ab.script.VUa(null,new la("Input",ec,new la("Output",
nb,Nb)));return nb}}Object(m.a)(Jc,"ApplyAnnotationQueryStep",hb,[]);class ad extends hb{constructor(nb){super();this.Ab=nb}load(nb,Nb){if(this.DF===P.Annotations.sY)return Nb=this.i_c(nb,Nb),Nb.mr(this.Ab.jQh).returnValue||new ib.a(this.Ab.annotations,P.Annotations.sY),Nb;const ec=new ib.a(this.Ab.annotations,P.Annotations.sY);for(const Hc of nb.items)if(nb=this.i_c(Hc,Nb),({value:nb}=nb.mr(this.Ab.jQh)).returnValue)for(const Tc of nb.items)Array.add(ec.items,Tc);return ec}i_c(nb,Nb){const ec=new K.a(this.Ab.annotations);
ec.T6a(nb);nb=new K.a(this.Ab.annotations);this.Ab.script.VUa(null,new la("Input",ec,new la("Output",nb,Nb)));return nb}}Object(m.a)(ad,"ApplyExpandAnnotationQueryStep",hb,[]);class Kc{constructor(nb,Nb){nb&&(this.annotations=Nb.annotations,this.script=Nb.NOb(nb.K(0)),this.jQh=nb.K(1))}}Object(m.a)(Kc,"ApplyExpandQueryStepInit",null,[]);class Jb{constructor(nb,Nb){nb&&(this.annotations=Nb.annotations,this.script=Nb.NOb(nb.K(0)))}}Object(m.a)(Jb,"ApplyQueryStepInit",null,[]);class Zb extends hb{constructor(nb){super();
this.Ab=nb}load(nb){if(this.DF===P.Annotations.sY)return this.che(nb);const Nb=new ib.a(this.Ab.annotations,this.Ab.annotations.getAttributeType(this.Ab.aza));for(const ec of nb.items)Array.add(Nb.items,this.che(ec));return Nb}store(nb,Nb,ec,Hc){if(this.DF===P.Annotations.sY){var Tc=Nb,xd=({jOa:Hc}=this.n9a(Hc)).returnValue;xd&&(Tc=xd.store(P.Annotations.AW(this.che(nb)),Nb,ec,Hc));nb.dA(this.Ab.aza,Tc)}else{var ld=Nb;if(Tc=({jOa:Hc}=this.n9a(Hc)).returnValue){ld=new ib.a(this.Ab.annotations,this.Ab.annotations.getAttributeType(this.Ab.aza));
for(xd of nb.items)Array.add(ld.items,this.che(xd));ld=Tc.store(ld,Nb,ec,Hc)}Nb=ld;if(Nb.items.length!==nb.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let Ed=0,Zd=nb.items.length;Ed<Zd;++Ed)ec=nb.items[Ed],ec.isReadOnly&&(ec=ec.clone(),nb.items[Ed]=ec),ec.dA(this.Ab.aza,Nb.items[Ed])}return nb}che(nb){({value:nb}=nb.mr(this.Ab.aza)).returnValue||(nb=this.Ab.annotations.Qfm(this.Ab.aza));return nb}}Object(m.a)(Zb,"AttrAnnotationQueryStep",hb,
[]);class xb{constructor(nb,Nb){nb&&(this.annotations=Nb,this.aza=nb.K(0))}}Object(m.a)(xb,"AttrQueryStepInit",null,[]);class $b extends hb{constructor(nb){super();this.Ab=nb}load(nb){const Nb=new K.a(this.Ab.annotations);Nb.T6a(nb);return this.Ab.module.execute(Nb)}}Object(m.a)($b,"CallModuleAnnotationQueryStep",hb,[]);class Xb{constructor(nb,Nb){nb&&(this.annotations=Nb.annotations,this.module=Nb.DKf(nb.K(0)))}}Object(m.a)(Xb,"CallModuleQueryStepInit",null,[]);class Lb extends hb{constructor(nb){super();
this.Ab=nb}load(nb,Nb){if(P.Annotations.kK(this.DF)){var ec=this.Ab.query.Gu(nb,Nb);Nb=new ib.a(this.Ab.annotations,P.Annotations.Ica);let xd="string"===typeof ec;for(var Hc of nb.items)if(xd)Array.add(Nb.items,Hc+ec);else for(var Tc of ec.items)Array.add(Nb.items,Hc+Tc);return Nb}Hc=this.Ab.query.Gu(nb,Nb);if("string"===typeof Hc)return nb+Hc;Tc=new ib.a(this.Ab.annotations,P.Annotations.Ica);for(ec of Hc.items)Array.add(Tc.items,nb+ec);return Tc}}Object(m.a)(Lb,"ConcatAnnotationQueryStep",hb,[]);
class gc extends hb{constructor(nb){super();this.Ab=nb}load(nb){return jb.K2h(this.Ab.annotations,nb,this.DF,this.o8)}}Object(m.a)(gc,"ConvertAnnotationQueryStep",hb,[]);class qa extends hb{constructor(){super()}load(nb){return nb.items.length}}Object(m.a)(qa,"CountAnnotationQueryStep",hb,[]);class ra extends pb{constructor(nb){super(nb)}Pdc(nb,Nb){return nb/Nb}}Object(m.a)(ra,"DivideAnnotationQueryStep",pb,[]);class Ya extends hb{constructor(nb){super();this.Ab=nb}load(nb,Nb){Nb=new la(this.Ab.cFe,
null,Nb);for(const ec of nb.items)if(Nb.Ymf(ec),this.Ab.query.Gu(ec,Nb))return!0;return!1}}Object(m.a)(Ya,"ExistsAnnotationQueryStep",hb,[]);class ab extends pb{constructor(nb){super(nb)}Pdc(nb,Nb){return Math.pow(nb,Nb)}}Object(m.a)(ab,"ExpAnnotationQueryStep",pb,[]);class cb{constructor(nb,Nb){nb&&(this.bVa=Nb.eD(nb.K(0)))}}Object(m.a)(cb,"FeatureBundleNameQueryStepInit",null,[]);class Eb extends hb{constructor(nb){super();this.Ab=nb}load(nb){if(P.Annotations.kK(this.DF)){const Nb=new ib.a(this.Ab.annotations,
this.Ab.annotations.oQb(P.Annotations.j9a(this.DF),this.Ab.cVa));for(const ec of nb.items)Array.add(Nb.items,ec.uqb(this.Ab.cVa));return Nb}return nb.uqb(this.Ab.cVa)}store(nb,Nb,ec,Hc){if(P.Annotations.kK(this.DF)){var Tc=Nb,xd=({jOa:Hc}=this.n9a(Hc)).returnValue;if(xd){Tc=new ib.a(this.Ab.annotations,this.Ab.annotations.oQb(P.Annotations.j9a(this.DF),this.Ab.cVa));for(var ld of nb.items)Array.add(Tc.items,ld.uqb(this.Ab.cVa));Tc=xd.store(Tc,Nb,ec,Hc)}Nb=Tc;if(Nb.items.length!==nb.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");
for(let Ed=0,Zd=nb.items.length;Ed<Zd;++Ed)ec=nb.items[Ed],ec.isReadOnly&&(ec=ec.clone(),nb.items[Ed]=ec),ec.nyg(this.Ab.cVa,Nb.items[Ed])}else xd=Nb,(ld=({jOa:Hc}=this.n9a(Hc)).returnValue)&&(xd=ld.store(P.Annotations.AW(nb.uqb(this.Ab.cVa)),Nb,ec,Hc)),nb.nyg(this.Ab.cVa,xd);return nb}}Object(m.a)(Eb,"FieldAnnotationQueryStep",hb,[]);class mc{constructor(nb,Nb){nb&&(this.annotations=Nb,this.cVa=nb.K(0))}}Object(m.a)(mc,"FieldQueryStepInit",null,[]);class tb extends hb{constructor(nb){super();this.Ab=
nb}load(nb,Nb){for(const ec of nb.items)if(this.Ab.filter.isMatch(ec,Nb))return ec;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(nb,Nb,ec,Hc){let Tc=Nb,xd=-1;for(let Ed=0,Zd=nb.items.length;Ed<Zd;Ed++)if(this.Ab.filter.isMatch(nb.items[Ed],ec)){xd=Ed;break}if(0>xd)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const ld=({jOa:Hc}=this.n9a(Hc)).returnValue;ld&&(Tc=ld.store(P.Annotations.AW(nb.items[xd]),Nb,ec,Hc));
nb.items[xd]=Tc;return nb}}Object(m.a)(tb,"FirstItemMatchingAnnotationQueryStep",hb,[]);class Xa extends hb{constructor(nb){super();this.Ab=nb}load(nb,Nb){Nb=new la(this.Ab.cFe,null,Nb);for(const ec of nb.items)if(Nb.Ymf(ec),!this.Ab.query.Gu(ec,Nb))return!1;return!0}}Object(m.a)(Xa,"ForAllAnnotationQueryStep",hb,[]);class Mb extends hb{constructor(nb){super();this.Ab=nb}load(nb,Nb){nb=Nb?Nb.v5d(this.Ab.bVa):null;if(!nb)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ab.bVa+
'"');return nb}store(nb,Nb,ec,Hc){nb=ec?ec.v5d(this.Ab.bVa):null;if(!nb)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ab.bVa+'"');let Tc=Nb;const xd=({jOa:Hc}=this.n9a(Hc)).returnValue;xd&&(Tc=xd.store(nb,Nb,ec,Hc));nb!==Tc&&nb.T6a(Tc);return nb}}Object(m.a)(Mb,"GetAnnotationQueryStep",hb,[]);class cc{constructor(nb,Nb){this.Ypk=nb;this.gHk=Nb}get c6h(){return this.Ypk}get wtj(){return this.gHk}}Object(m.a)(cc,"AnnotationQueryStoreContinuation",null,[2059]);class oc extends hb{constructor(nb){super();
this.Ab=nb}load(nb,Nb){return this.Ab.xBe.Gu(nb,Nb)?this.Ab.H1j.Gu(nb,Nb):this.Ab.z1d?this.Ab.z1d.Gu(nb,Nb):nb}store(nb,Nb,ec,Hc){var Tc=this.Ab.xBe.Gu(nb,ec);this.next&&(Hc=new cc(this.next,Hc));if(Tc)return this.Ab.H1j.Uxc(nb,Nb,ec,Hc);if(this.Ab.z1d)return this.Ab.z1d.Uxc(nb,Nb,ec,Hc);Tc=Nb;let xd=null;Hc&&(xd=Hc.c6h,Hc=Hc.wtj);xd&&(Tc=xd.store(P.Annotations.AW(nb),Nb,ec,Hc));return Tc}}Object(m.a)(oc,"IfAnnotationQueryStep",hb,[]);class Pc{constructor(nb,Nb){nb&&(this.xBe=Nb.eN(nb.K(0)),this.H1j=
Nb.eN(nb.K(1)),this.z1d=nb.K(2)?Nb.eN(nb.K(2)):null)}}Object(m.a)(Pc,"IfQueryStepInit",null,[]);class vb{constructor(nb,Nb){nb&&(this.X1m=Nb.eN(nb.K(0)),this.b3i=Nb.eN(nb.K(1)))}}Object(m.a)(vb,"IndexAndItemQueryStepInit",null,[]);class jd extends hb{constructor(nb){super();this.Ab=nb}load(nb,Nb){const ec=this.Ab.X1m.Gu(nb,Nb);Nb=this.Ab.b3i.Gu(nb,Nb);nb=nb.clone();if(0>ec||ec>nb.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(P.Annotations.kK(this.Ab.b3i.o8))for(let Hc=
0;Hc<Nb.items.length;++Hc)Array.insert(nb.items,ec+Hc,Nb.items[Hc]);else Array.insert(nb.items,ec,Nb);return nb}}Object(m.a)(jd,"InsertAtAnnotationQueryStep",hb,[]);class ud extends hb{constructor(nb){super();this.Ab=nb}load(nb,Nb){return!(!Nb||!Nb.v5d(this.Ab.bVa))}}Object(m.a)(ud,"IsDefinedAnnotationQueryStep",hb,[]);class qe extends hb{constructor(nb){super();this.Ab=nb}load(nb,Nb){Nb=this.uL(nb,Nb);return nb.items[Nb]}store(nb,Nb,ec,Hc){const Tc=this.uL(nb,ec);let xd=Nb;const ld=({jOa:Hc}=this.n9a(Hc)).returnValue;
ld&&(xd=ld.store(P.Annotations.AW(nb.items[Tc]),Nb,ec,Hc));nb.items[Tc]=xd;return nb}uL(nb,Nb){Nb=this.Ab.query.Gu(nb,Nb);if(0>Nb||Nb>=nb.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Nb}}Object(m.a)(qe,"ItemAnnotationQueryStep",hb,[]);class Ae extends hb{constructor(nb){super();this.Ab=nb}load(nb,Nb){const ec=new ib.a(this.Ab.annotations,P.Annotations.j9a(this.DF));for(const Hc of nb.items)this.Ab.filter.isMatch(Hc,Nb)&&Array.add(ec.items,Hc);return ec}}
Object(m.a)(Ae,"ItemsMatchingAnnotationQueryStep",hb,[]);class hf extends hb{constructor(nb){super();this.Ab=nb}load(nb,Nb){Nb=this.uL(nb,Nb);return nb.items[nb.items.length-Nb-1]}store(nb,Nb,ec,Hc){const Tc=this.uL(nb,ec);let xd=Nb;const ld=({jOa:Hc}=this.n9a(Hc)).returnValue;ld&&(xd=ld.store(P.Annotations.AW(nb.items[nb.items.length-Tc-1]),Nb,ec,Hc));nb.items[nb.items.length-Tc-1]=xd;return nb}uL(nb,Nb){Nb=this.Ab.query?this.Ab.query.Gu(nb,Nb):0;if(0>Nb||Nb>=nb.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");
return Nb}}Object(m.a)(hf,"LastItemAnnotationQueryStep",hb,[]);class Qe extends hb{constructor(nb){super();this.Ab=nb}load(nb){if(P.Annotations.kK(this.DF)){const Nb=new ib.a(this.Ab.annotations,P.Annotations.TOa);for(const ec of nb.items)Array.add(Nb.items,ec.length);return Nb}return nb.length}}Object(m.a)(Qe,"LengthAnnotationQueryStep",hb,[]);class vf extends hb{constructor(nb){super();this.Ab=nb}load(nb,Nb){if(P.Annotations.kK(this.DF)){const ec=new ib.a(this.Ab.annotations,P.Annotations.xEa);
for(const Hc of nb.items)Array.add(ec.items,this.Ab.filter.isMatch(Hc,Nb));return ec}return this.Ab.filter.isMatch(nb,Nb)}}Object(m.a)(vf,"MatchesAnnotationQueryStep",hb,[]);class Jd extends hb{constructor(nb){super();this.Ab=nb}load(nb,Nb){return this.Ab.filter.isMatch(nb,Nb)}}Object(m.a)(Jd,"MatchesAsListAnnotationQueryStep",hb,[]);class mh extends pb{constructor(nb){super(nb)}Pdc(nb,Nb){return nb%Nb}}Object(m.a)(mh,"ModuloAnnotationQueryStep",pb,[]);class gh extends pb{constructor(nb){super(nb)}Pdc(nb,
Nb){return nb*Nb}}Object(m.a)(gh,"MultiplyAnnotationQueryStep",pb,[]);class Td extends hb{constructor(nb){super();this.Ab=nb}load(nb){if(P.Annotations.kK(this.DF)){const Nb=new ib.a(this.Ab.annotations,P.Annotations.xEa);for(const ec of nb.items)Array.add(Nb.items,!ec);return Nb}return!nb}}Object(m.a)(Td,"NotAnnotationQueryStep",hb,[]);class Vc extends sb{constructor(nb){super(nb)}dZh(nb){return{returnValue:nb,result:!0}}CVc(nb,Nb){return nb||Nb}}Object(m.a)(Vc,"OrAnnotationQueryStep",sb,[]);class id extends hb{constructor(nb){super();
this.Ab=nb}load(nb,Nb){const ec=this.Ab.mEg.Gu(nb,Nb);nb=this.Ab.xWc.Gu(nb,Nb);Nb=new ib.a(this.Ab.annotations,P.Annotations.TOa);for(let Hc=0;Hc<nb;++Hc)Array.add(Nb.items,ec+Hc);return Nb}}Object(m.a)(id,"RangeAnnotationQueryStep",hb,[]);class Re{constructor(nb,Nb){nb&&(this.annotations=Nb.annotations,this.filter=Nb.ssa(nb.K(0)))}}Object(m.a)(Re,"SingleFilterQueryStepInit",null,[]);class cf{constructor(nb,Nb){nb&&(this.annotations=Nb.annotations,this.query=nb.K(0)?Nb.eN(nb.K(0)):null)}}Object(m.a)(cf,
"SingleOptionalQueryQueryStepInit",null,[]);class me{constructor(nb,Nb){nb&&(this.annotations=Nb.annotations,this.query=Nb.eN(nb.K(0)))}}Object(m.a)(me,"SingleQueryQueryStepInit",null,[]);class ce{constructor(nb,Nb){nb&&(this.annotations=Nb.annotations,this.mEg=Nb.eN(nb.K(0)),this.xWc=nb.K(1)?Nb.eN(nb.K(1)):null)}}Object(m.a)(ce,"StartAndCountOrLengthQueryStepInit",null,[]);class Ie extends hb{constructor(nb){super();this.Ab=nb}load(nb,Nb){let ec;({startIndex:Nb,length:ec}=this.h8d(nb,Nb));const Hc=
new ib.a(this.Ab.annotations,nb.M7);for(let Tc=0;Tc<ec;++Tc)Array.add(Hc.items,nb.items[Nb+Tc]);return Hc}store(nb,Nb,ec,Hc){let Tc,xd;({startIndex:Tc,length:xd}=this.h8d(nb,ec));var ld=Nb;const Ed=({jOa:Hc}=this.n9a(Hc)).returnValue;if(Ed){ld=new ib.a(this.Ab.annotations,nb.M7);for(let Zd=0;Zd<xd;++Zd)Array.add(ld.items,nb.items[Tc+Zd]);ld=Ed.store(ld,Nb,ec,Hc)}Nb=ld;for(ec=0;ec<xd;++ec)Array.removeAt(nb.items,Tc);for(let Zd=0,If=Nb.items.length;Zd<If;++Zd)Array.insert(nb.items,Tc+Zd,Nb.items[Zd]);
return nb}h8d(nb,Nb){let ec;ec=this.Ab.mEg.Gu(nb,Nb);if(0>ec)throw Error.invalidOperation("Invalid start index in Sublist() query step");Nb=this.Ab.xWc?this.Ab.xWc.Gu(nb,Nb):nb.items.length-ec;if(0>Nb||ec+Nb>nb.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{startIndex:ec,length:Nb}}}Object(m.a)(Ie,"SublistAnnotationQueryStep",hb,[]);class Le extends hb{constructor(nb){super();this.Ab=nb}load(nb,Nb){if(P.Annotations.kK(this.DF)){const ec=
new ib.a(this.Ab.annotations,P.Annotations.Ica);for(let Hc=0,Tc=nb.items.length;Hc<Tc;++Hc)Array.add(ec.items,this.oGi(nb.items[Hc],Nb));return ec}return this.oGi(nb,Nb)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}oGi(nb,Nb){let ec;({startIndex:Nb,length:ec}=this.h8d(nb,Nb));return nb.substr(Nb,ec)}h8d(nb,Nb){let ec;ec=this.Ab.mEg.Gu(nb,Nb);if(0>ec)throw Error.invalidOperation("Invalid start index in Substring() query step");Nb=this.Ab.xWc?this.Ab.xWc.Gu(nb,
Nb):nb.length-ec;if(0>Nb||ec+Nb>nb.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{startIndex:ec,length:Nb}}}Object(m.a)(Le,"SubstringAnnotationQueryStep",hb,[]);class we extends pb{constructor(nb){super(nb)}Pdc(nb,Nb){return nb-Nb}}Object(m.a)(we,"SubtractAnnotationQueryStep",pb,[]);class xf extends hb{constructor(nb){super();this.Ab=nb}load(nb){const Nb=new ib.a(this.Ab.annotations,P.Annotations.Ica);for(let ec=0;ec<nb.length;++ec)Array.add(Nb.items,
nb.charAt(ec).toString());return Nb}}Object(m.a)(xf,"ToCharListAnnotationQueryStep",hb,[]);class Ig extends hb{constructor(nb){super();this.Ab=nb}load(nb){const Nb=new ib.a(this.Ab.annotations,this.DF);Array.add(Nb.items,nb);return Nb}}Object(m.a)(Ig,"ToListAnnotationQueryStep",hb,[]);class jg extends hb{constructor(nb){super();this.Ab=nb}load(){return this.Ab.value}}Object(m.a)(jg,"ValueAnnotationQueryStep",hb,[]);class kg{constructor(nb,Nb){if(nb){var ec=nb.K(0),Hc=1;this.value=({rla:Hc}=Nb.BUa(ec,
nb,Hc,null,null,null)).returnValue;P.Annotations.yUb(this.value)}}}Object(m.a)(kg,"ValueQueryStepInit",null,[]);class eh{constructor(nb,Nb){nb&&(this.cFe=Nb.eD(nb.K(0)),this.query=Nb.eN(nb.K(1)))}}Object(m.a)(eh,"VarNameAndQueryQueryStepInit",null,[]);class zg{constructor(nb,Nb){this.Tgh=null;if(nb){this.annotations=Nb.annotations;var ec=0;this.DF=nb.K(ec);++ec;this.o8=nb.K(ec);++ec;this.DAe=1===nb.K(ec);++ec;this.Dce=1===nb.K(ec);++ec;var Hc=nb.K(ec);++ec;if(Hc){var Tc=ec,xd=ec+Hc,ld=ec+2*Hc;ec+=
3*Hc;var Ed=nb.count-ec,Zd=null;for(let qg=0;qg<Hc;++qg){var If=ec+nb.K(ld+qg);const ch=(qg===Hc-1?Ed:nb.K(ld+qg+1))-nb.K(ld+qg),mk=new bb.a;mk.Lpb(nb,If,ch);If=zg.zym(nb.K(xd+qg),mk,Nb);If.DF=nb.K(Tc+qg);If.o8=qg===Hc-1?this.o8:nb.K(Tc+qg+1);Zd?Zd.next=If:this.Tgh=If;Zd=If}}}}get Jni(){return this.Tgh}static zym(nb,Nb,ec){switch(nb){case 1:return new Mb(new cb(Nb,ec));case 2:return new ud(new cb(Nb,ec));case 3:return new Zb(new xb(Nb,ec.annotations));case 4:return new Eb(new mc(Nb,ec.annotations));
case 5:return new oc(new Pc(Nb,ec));case 6:return new vf(new Re(Nb,ec));case 43:return new Jd(new Re(Nb,ec));case 45:return new Jc(new Jb(Nb,ec));case 49:return new ad(new Kc(Nb,ec));case 46:return new jg(new kg(Nb,ec.annotations));case 51:return new $b(new Xb(Nb,ec));case 52:return new id(new ce(Nb,ec));case 53:return new gc(new nc(ec.annotations));case 13:return new qe(new me(Nb,ec));case 14:return new hf(new cf(Nb,ec));case 15:return new qa;case 18:return new tb(new Re(Nb,ec));case 16:return new Xa(new eh(Nb,
ec));case 17:return new Ya(new eh(Nb,ec));case 22:return new jd(new vb(Nb,ec));case 24:return new qc(new me(Nb,ec));case 26:return new Ie(new ce(Nb,ec));case 27:return new Ae(new Re(Nb,ec));case 30:return new Ig(new nc(ec.annotations));case 31:return new Le(new ce(Nb,ec));case 32:return new Lb(new me(Nb,ec));case 47:return new Qe(new nc(ec.annotations));case 48:return new xf(new nc(ec.annotations));case 34:return new ob(new me(Nb,ec));case 35:return new we(new me(Nb,ec));case 36:return new gh(new me(Nb,
ec));case 37:return new ra(new me(Nb,ec));case 38:return new mh(new me(Nb,ec));case 39:return new ab(new me(Nb,ec));case 40:return new Ab(new me(Nb,ec));case 41:return new Vc(new me(Nb,ec));case 42:return new Td(new nc(ec.annotations));default:throw Error.argument("currStepInitData");}}}Object(m.a)(zg,"AnnotationQueryInit",null,[]);class Gi{constructor(nb){this.Ab=nb}execute(nb,Nb){this.VUa(nb,nb?new la("root",nb,Nb):Nb)}VUa(nb,Nb){for(const ec of this.Ab.commands)Nb=ec.execute(nb,Nb)}}Object(m.a)(Gi,
"AnnotationScript",null,[2045]);class jj{constructor(nb){this.Ab=nb}execute(nb,Nb){const ec=this.Ab.y6m.Gu(nb,Nb),Hc=this.Ab.T3n.Gu(nb,Nb);this.Ab.script.VUa(nb,new la("Input",ec,new la("Output",Hc,Nb)));return Nb}}Object(m.a)(jj,"ApplyAnnotationScriptCommand",null,[2052]);class Dg{constructor(nb,Nb){nb&&(this.y6m=Nb.eN(nb.K(0)),this.T3n=Nb.eN(nb.K(1)),this.script=Nb.NOb(nb.K(2)))}}Object(m.a)(Dg,"ApplyScriptCommandInit",null,[]);class Jf{constructor(nb){this.Ab=nb}execute(nb,Nb){const ec=this.Ab.pvg.Gu(nb,
Nb);this.Ab.The.Uxc(nb,ec,Nb,null);return Nb}}Object(m.a)(Jf,"AssignAnnotationScriptCommand",null,[2052]);class xg{constructor(nb){this.Ab=nb}execute(nb,Nb){const ec=this.Ab.The.Gu(nb,Nb);nb=this.Ab.pvg.Gu(nb,Nb);ec!==nb&&ec.T6a(nb);return Nb}}Object(m.a)(xg,"CopyAnnotationScriptCommand",null,[2052]);class Vi{constructor(nb){this.Ab=nb}execute(nb,Nb){let ec=this.Ab.n3f.Gu(nb,Nb);if(this.Ab.n3f.DAe){ec=P.Annotations.AW(ec);var Hc=new la(this.Ab.bVa,null,Nb);for(let xd=0,ld=ec.items.length;xd<ld;++xd){var Tc=
this.pki(nb,ec.items[xd],Hc);if(0>this.Ab.kue)ec.items[xd]=Tc;else if(({value:Tc}=Tc.mr(this.Ab.kue)).returnValue)ec.items[xd]=Tc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Ab.n3f.Uxc(nb,ec,Nb,null)}else{Hc=new la(this.Ab.bVa,null,Nb);for(let xd=0,ld=ec.items.length;xd<ld;++xd)this.pki(nb,ec.items[xd],Hc)}return Nb}pki(nb,Nb,ec){let Hc;0>this.Ab.kue?Hc=P.Annotations.AW(Nb):(Hc=new K.a(this.Ab.annotations),Hc.dA(this.Ab.kue,Nb));ec.Ymf(Hc);
this.Ab.fbl.VUa(nb,ec);return Hc}}Object(m.a)(Vi,"EnumerateAnnotationScriptCommand",null,[2052]);class Lf{constructor(nb,Nb){nb&&(this.annotations=Nb.annotations,this.bVa=Nb.eD(nb.K(0)),this.n3f=Nb.eN(nb.K(1)),this.fbl=Nb.NOb(nb.K(2)),this.kue=nb.K(3))}}Object(m.a)(Lf,"EnumerateScriptCommandInit",null,[]);class ac{constructor(nb){this.Ab=nb}execute(nb,Nb){this.Ab.xBe.Gu(nb,Nb)?this.Ab.klp.VUa(nb,Nb):this.Ab.uli&&this.Ab.uli.VUa(nb,Nb);return Nb}}Object(m.a)(ac,"IfAnnotationScriptCommand",null,[2052]);
class xc{constructor(nb,Nb){nb&&(this.xBe=Nb.eN(nb.K(0)),this.klp=Nb.NOb(nb.K(1)),this.uli=nb.K(2)?Nb.NOb(nb.K(2)):null)}}Object(m.a)(xc,"IfScriptCommandInit",null,[]);class gd{constructor(nb,Nb){nb&&(this.annotations=Nb.annotations,this.The=Nb.eN(nb.K(0)),this.pvg=Nb.eN(nb.K(1)))}}Object(m.a)(gd,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class Hd{constructor(nb){this.Ab=nb}execute(nb,Nb){const ec=this.Ab.pvg.Gu(this.Ab.The.Gu(nb,Nb),Nb);this.Ab.The.Uxc(nb,ec,Nb,null);return Nb}}Object(m.a)(Hd,
"ModifyAnnotationScriptCommand",null,[2052]);class ie{constructor(nb){this.Ab=nb}execute(nb,Nb){const ec=new K.a(this.Ab.annotations);this.Ab.query&&ec.T6a(this.Ab.query.Gu(nb,Nb));return Nb=new la(this.Ab.bVa,ec,Nb)}}Object(m.a)(ie,"NewAnnotationScriptCommand",null,[2052]);class Je{constructor(nb,Nb){nb&&(this.annotations=Nb.annotations,this.bVa=Nb.eD(nb.K(0)),this.query=nb.K(1)?Nb.eN(nb.K(1)):null)}}Object(m.a)(Je,"NewScriptCommandInit",null,[]);class Xe{constructor(nb){this.Ab=nb}execute(nb,Nb){nb=
this.Ab.query.Gu(nb,Nb);if(this.Ab.query.o8===P.Annotations.sY)nb.CZa(this.Ab.aza);else for(const ec of nb.items)ec.CZa(this.Ab.aza);return Nb}}Object(m.a)(Xe,"RemoveAnnotationScriptCommand",null,[2052]);class Tf{constructor(nb,Nb){nb&&(this.annotations=Nb.annotations,this.query=Nb.eN(nb.K(0)),this.aza=nb.K(1))}}Object(m.a)(Tf,"RemoveScriptCommandInit",null,[]);class Zh{constructor(nb,Nb){if(nb){var ec=0,Hc=nb.K(ec);++ec;if(Hc){var Tc=ec,xd=ec+Hc;ec+=2*Hc;var ld=nb.count-ec;this.commands=Array(Hc);
for(let Ed=0;Ed<Hc;++Ed){const Zd=ec+nb.K(xd+Ed),If=(Ed===Hc-1?ld:nb.K(xd+Ed+1))-nb.K(xd+Ed),qg=new bb.a;qg.Lpb(nb,Zd,If);this.commands[Ed]=Zh.oym(nb.K(Tc+Ed),qg,Nb)}}}}static oym(nb,Nb,ec){switch(nb){case 1:return new Jf(new gd(Nb,ec));case 2:return new Hd(new gd(Nb,ec));case 3:return new Xe(new Tf(Nb,ec));case 6:return new ie(new Je(Nb,ec));case 7:return new Vi(new Lf(Nb,ec));case 8:return new ac(new xc(Nb,ec));case 9:return new xg(new gd(Nb,ec));case 10:return new jj(new Dg(Nb,ec));default:throw Error.argument("initData");
}}}Object(m.a)(Zh,"AnnotationScriptInit",null,[]);var se=d(1612);class Gg{constructor(nb){this.S4=nb;this.vz=0}Zba(){const nb=this.S4.aA(this.vz,4);this.vz+=4;return nb}get Cja(){return this.S4}get offset(){return this.vz}set offset(nb){this.vz=nb}}Object(m.a)(Gg,"ByteArrayReader",null,[]);class mf{constructor(){this.KL=null;this.Q$i=this.ega=0}K(nb){if(0>nb||nb>=this.ega)throw Error.argumentOutOfRange("index");return this.KL.aA(this.Q$i+4*nb,4)}get count(){return this.ega}static HDl(nb,Nb,ec){const Hc=
new mf;Hc.KL=nb;Hc.Q$i=Nb;Hc.ega=ec;return Hc}}Object(m.a)(mf,"ReadOnlyListOverByteArray",null,[2047]);class Ne{constructor(nb,Nb){this.J$i=this.I$i=!1;this.Cx=this.$Xa=this.i6f=this.M$i=null;try{this.Cx=Nb.annotations;const ec=Nb.gqb(nb.K(0)),Hc=new Gg(ec);if(-914743053!==Hc.Zba())throw Error.argument("Input does not represent a flat lexicon");this.I$i=1===Hc.Zba();this.J$i=1===Hc.Zba();const Tc=Hc.Zba();Hc.offset+=Tc;const xd=Hc.Zba();this.i6f=Ne.n6n(Hc,xd,this.Cx);const ld=Hc.Zba();this.M$i=Ne.E6n(Hc,
ld);const Ed=Hc.Zba();this.$Xa=new se.a(Hc.Cja,Hc.offset);Hc.offset+=Ed}catch(ec){throw Error.argument("initData");}}get trie(){return this.$Xa}Whm(nb){return"i"===nb&&this.J$i?"\u0130":nb.toUpperCase()}xWf(){return this.I$i}cfm(nb){let Nb;Nb=new ib.a(this.Cx,P.Annotations.sY);if(1!==nb)if(0===nb)nb=new K.a(this.Cx),Array.add(Nb.items,nb);else if(nb&1073741824){nb=this.M$i[nb&-1073741825];for(let Hc=0;Hc<nb.length;++Hc){var ec=nb[Hc];ec=0===ec?new K.a(this.Cx):this.i6f[ec-2];Array.add(Nb.items,ec)}}else Array.add(Nb.items,
this.i6f[nb-2]);return{returnValue:!0,Pvn:Nb}}static n6n(nb,Nb,ec){if(Nb%4)throw Error.argument("reader");const Hc=mf.HDl(nb.Cja,nb.offset,Nb/4);nb.offset+=Nb;nb=[];for(Nb=0;Nb<Hc.count;){const Tc=({rla:Nb}=ec.BUa(P.Annotations.sY,Hc,Nb,null,null,null)).returnValue;Array.add(nb,Tc)}return nb}static E6n(nb,Nb){Nb=nb.offset+Nb;const ec=[];for(;nb.offset<Nb;){const Hc=nb.Zba(),Tc=Array(Hc);for(let xd=0;xd<Hc;++xd){const ld=nb.Zba();Tc[xd]=ld}Array.add(ec,Tc)}return ec}}Object(m.a)(Ne,"RawFlatLexicon",
null,[2044]);var Fb=d(1584),Vb=d(1585);class Qc{constructor(nb){if(null==nb)throw Error.argumentNull("base64String");const Nb=nb.length;if(Nb%4)throw Error.argument("base64String's length must be a multiple of 4");this.ega=.75*Nb;this.NUb=Array(Math.ceil(this.ega/4));nb.endsWith("==")?this.ega-=2:nb.endsWith("=")&&--this.ega;let ec=0;for(let Hc=0;Hc<Nb;Hc+=4){const Tc=Qc.Zue[nb.charCodeAt(Hc)-43]<<18|Qc.Zue[nb.charCodeAt(Hc+1)-43]<<12|Qc.Zue[nb.charCodeAt(Hc+2)-43]<<6|Qc.Zue[nb.charCodeAt(Hc+3)-43];
let xd=Tc>>16&255;this.NUb[Math.floor(ec/4)]|=xd<<ec%4*8;++ec;xd=Tc>>8&255;this.NUb[Math.floor(ec/4)]|=xd<<ec%4*8;++ec;xd=Tc&255;this.NUb[Math.floor(ec/4)]|=xd<<ec%4*8;++ec}}get length(){return this.ega}K(nb){if(0>nb||nb>=this.ega)throw Error.argumentOutOfRange("i");return this.Psi(nb)}aA(nb,Nb){if(0>nb||0>Nb||nb+Nb>this.ega)throw Error.argument("Bad range");let ec=0;for(let Hc=0;Hc<Nb;++Hc)ec|=this.Psi(nb+Hc)<<8*Hc;return ec}flo(nb,Nb){let ec=0,Hc=0,Tc=Math.floor(nb/8);for(nb%=8;Hc<Nb;){const xd=
8-nb>Nb-Hc?Nb-Hc:8-nb,ld=this.K(Tc);ec|=(ld>>nb&~(255<<xd))<<Hc;Hc+=xd;++Tc;nb=0}return ec}Psi(nb){return this.NUb[Math.floor(nb/4)]>>nb%4*8&255}}Qc.Zue=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(m.a)(Qc,"ByteArray",null,[]);class yd{constructor(nb,Nb,ec){this.HF=nb;this.kEn=Nb;this.nEn=ec;this.Y$i=Array(nb.b?nb.b.length:
0);this.G6f=new Fb.a(new Vb.a(this.gqb(this.HF.s)));this.vba=Array(nb.t.length);this.FD=new P.Annotations(this.bqb(0),this)}get annotations(){return this.FD}get EVl(){return this.HF.d}Hxm(){if(!(""in this.HF.m))throw Error.argument("name","Unrecognized module");return this.DKf(this.HF.m[""])}gqb(nb){if(0>nb||!this.HF.b||nb>=this.HF.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.Y$i[nb]||(this.Y$i[nb]=new Qc(this.HF.b[nb]))}eD(nb){if(1>nb||nb>=this.HF.t.length)throw Error.argumentOutOfRange("blobID");
if(1!==this.HF.t[nb])throw Error.argument("blobID","Requested blob is not a string");if(null==this.vba[nb]){const Nb=this.bqb(nb).K(0);this.vba[nb]=this.G6f.eD(Nb)}return this.vba[nb]}kkc(nb){if(1>nb||nb>=this.HF.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.HF.t[nb])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.vba[nb]){var Nb=this.bqb(nb);const ec=this.eD(Nb.K(0));Nb=1===Nb.K(1);this.vba[nb]=new RegExp(ec,Nb?"i":"")}return this.vba[nb]}HGm(nb){if(1>nb||
nb>=this.HF.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.HF.t[nb])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}DKf(nb){if(1>nb||nb>=this.HF.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.HF.t[nb])throw Error.argument("blobID","Requested blob is not an NL module");return this.vba[nb]||(this.vba[nb]=this.nEn.cym(this.bqb(nb),this))}eN(nb){if(1>nb||nb>=this.HF.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.HF.t[nb])throw Error.argument("blobID",
"Requested blob is not an annotation query");return this.vba[nb]||(this.vba[nb]=new jb(new zg(this.bqb(nb),this)))}NOb(nb){if(1>nb||nb>=this.HF.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.HF.t[nb])throw Error.argument("blobID","Requested blob is not an annotation script");return this.vba[nb]||(this.vba[nb]=new Gi(new Zh(this.bqb(nb),this)))}ssa(nb){if(1>nb||nb>=this.HF.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.HF.t[nb])throw Error.argument("blobID","Requested blob is not a filter");
return this.vba[nb]||(this.vba[nb]=this.kEn.ssa(this.bqb(nb),this))}TEm(nb){if(1>nb||nb>=this.HF.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.HF.t[nb])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.vba[nb]||(this.vba[nb]=new Ne(this.bqb(nb),this))}bqb(nb){const Nb=this.HF.n[nb];nb=(nb<this.HF.t.length-1?this.HF.n[nb+1]:this.HF.n.length)-Nb;if(0>Nb||0>nb||Nb+nb>this.HF.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+
Nb+","+nb+")");const ec=new bb.a;ec.sEf(this.HF.n,Nb,nb);return ec}}Object(m.a)(yd,"ObjectFetcher",null,[2035]);class Ce{constructor(nb,Nb,ec){if(!nb)throw Error.argumentNull("prediction");if(!Nb)throw Error.argumentNull("fieldNames");if(!ec)throw Error.argumentNull("values");if(Nb.length!==ec.length)throw Error.argument("values","fieldNames and values do not have same length");this.WGk=nb;this.OUb=Nb;this.Qbd=ec}get prediction(){return this.WGk}get Xli(){return this.OUb.length}yIf(nb){return 0<=
nb&&nb<this.OUb.length?this.OUb[nb]:null}getValue(nb){return 0<=nb&&nb<this.Qbd.length?this.Qbd[nb]:null}}Object(m.a)(Ce,"PredictionData",null,[]);class sf{constructor(nb,Nb){if(!nb)throw Error.argumentNull("predictions");if(!Nb)throw Error.argumentNull("tokenAttributes");this.qEn=nb;this.uEn=Nb}LLf(){return this.qEn}Cri(){return this.uEn}}Object(m.a)(sf,"PredictionDataWithTokenAttributes",null,[]);class lh{constructor(nb,Nb){this.prediction=null;this.score=0;this.prediction=nb;this.score=Nb}}Object(m.a)(lh,
"PredictionWithScore",null,[]);class Ef{constructor(nb,Nb){if(!nb)throw Error.argumentNull("predictions");if(!Nb)throw Error.argumentNull("attributes");this.XGk=nb;this.imk=Nb}LLf(){return this.XGk}Cri(){return this.imk}}Object(m.a)(Ef,"PredictionsWithTokenAttributes",null,[]);class ng{constructor(nb,Nb,ec){if(!nb)throw Error.argumentNull("attributeName");if(!Nb)throw Error.argumentNull("fieldNames");if(!ec)throw Error.argumentNull("values");if(Nb.length!==ec.length)throw Error.argument("values",
"fieldNames and values do not have same length");this.hmk=nb;this.OUb=Nb;this.Qbd=ec}get attributeName(){return this.hmk}get Xli(){return this.OUb.length}yIf(nb){return 0<=nb&&nb<this.OUb.length?this.OUb[nb]:null}getValue(nb){return 0<=nb&&nb<this.Qbd.length?this.Qbd[nb]:null}}Object(m.a)(ng,"TokenAttributes",null,[]);var Dh=d(108),Af=d(135);class Jh{constructor(nb,Nb,ec,Hc,Tc){this.eud=0;this.FOg=null;this.fud=this.iBc=0;this.fGe=this.W2b=this.hwa=this.jBc=null;this.GOg=0;this.r0e=this.GD=null;this._state=
-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.yV=nb;this.jbk=this.nbk=Nb;this.ibk=this.lbk=ec;this.cud=this.kbk=Hc;this.dud=this.mbk=Tc}obk(){this.fud=0;return this.DOg}DOg(){if(!(this.fud<this.cud))return this.EOg;this.jBc=this.jbk.items[this.fud+this.ibk];this.hwa=new K.a(this.yV.Ab.annotations);1!==this.cud&&this.yV.Ab.V7c||this.hwa.T6a(this.jBc);if(0<=this.yV.Ab.Mje){({value:this.W2b}=this.hwa.mr(this.yV.Ab.Mje)).returnValue?this.W2b=
this.W2b.AW():this.W2b=new ib.a(this.yV.Ab.annotations,P.Annotations.sY);this.fGe=this.dud.items;this.GOg=this.fGe.length;for(this.eud=0;this.eud<this.GOg;++this.eud)this.FOg=this.fGe[this.eud],Array.add(this.W2b.items,this.FOg);this.hwa.dA(this.yV.Ab.Mje,this.W2b)}else 0<=this.yV.Ab.gDg?this.hwa.dA(this.yV.Ab.gDg,this.dud.items[0]):0<=this.yV.Ab.Vjf?this.hwa.dA(this.yV.Ab.Vjf,!0):this.yV.Ab.CZi?this.dud.items[0].k3d((nb,Nb)=>this.hwa.dA(nb,Nb)):(this.hwa.T6a(this.dud.items[0]),1!==this.cud&&this.yV.Ab.V7c||
(({value:this.iBc}=this.jBc.mr(this.yV.Ab.k6)).returnValue&&this.hwa.dA(this.yV.Ab.k6,this.iBc),({value:this.iBc}=this.jBc.mr(this.yV.Ab.N$)).returnValue&&this.hwa.dA(this.yV.Ab.N$,this.iBc),this.jBc.mr(this.yV.Ab.lmb).returnValue&&this.hwa.dA(this.yV.Ab.lmb,this.iBc)));this.GD=this.hwa;this._state=2;return this.qbk}EOg(){this._state=3}pbk(){this.fud++;return this.DOg}qbk(){return 1<this.cud&&this.yV.Ab.V7c?this.EOg:this.pbk}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new Jh(this.yV,
this.nbk,this.lbk,this.kbk,this.mbk)).getEnumerator()}[Symbol.iterator](){return Object(Af.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?this._state=1:(this._state=1,this.r0e=this.obk());for(;1===this._state;)this.r0e=this.r0e();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.GD}}Object(m.a)(Jh,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",
null,[10,15,37]);class vg{constructor(nb,Nb,ec){this.Nbd=this.R$i=0;this.xqc=null;this.H6f=this.o6f=this.vqc=this.$he=this.r6f=0;this.aie=!1;this.B6f=nb;this.J6f=Nb;this.pEn=ec}WAi(){null===this.xqc&&({CZj:this.xqc,lOi:this.r6f,length:this.$he,c3l:nb}=this.B6f.KHi(this.J6f.items[this.Nbd],this.pEn),this.aie=nb||this.aie);if(this.vqc<this.$he){var nb=this.xqc.charAt(this.r6f+this.vqc);++this.vqc;return{returnValue:!0,ch:nb}}if(this.Nbd===this.J6f.items.length-1)return{returnValue:!1,ch:"\x00"};++this.Nbd;
this.vqc=0;this.xqc=null;return{returnValue:!0,ch:" "}}uqg(nb,Nb){this.vqc===this.$he&&this.xqc&&(this.H6f=Nb,this.o6f=this.Nbd-this.R$i+1)}dDo(nb){if(0>nb||nb>=this.J6f.items.length)throw Error.argumentOutOfRange("iToken");this.Nbd=this.R$i=nb;this.xqc=null;this.o6f=this.vqc=this.$he=this.r6f=0;this.H6f=-1;this.aie=!1}Fwm(){return{dgl:this.o6f,Ssn:this.H6f,b3l:this.aie}}}Object(m.a)(vg,"TriePrefixVisitor",null,[2054]);class Hk{constructor(nb){this.Ab=nb}execute(nb){if(!({value:ec}=nb.mr(this.Ab.zTa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");
let Nb;({value:Nb}=nb.mr(this.Ab.U5a)).returnValue||(Nb=null);var ec=this.jem(ec,Nb);nb=P.Annotations.AW(nb);nb.dA(this.Ab.zTa,ec);return nb}jem(nb,Nb){let ec=null;const Hc=this.Ab.flatLexicon.trie,Tc=new vg(this,nb,Nb);let xd=null;this.Ab.flatLexicon.xWf()&&(xd=Object(Dh.a)(this.Ab.flatLexicon,this.Ab.flatLexicon.Whm,"getCaseInsensitiveForm"));let ld=0,Ed;var Zd;let If;for(;ld<nb.items.length;){const qg=nb.items[ld];Tc.dDo(ld);Hc.f$j(Tc,xd);({dgl:Ed,Ssn:Zd,b3l:If}=Tc.Fwm());if(0<Ed){({Pvn:Zd}=this.Ab.flatLexicon.cfm(Zd));
for(let ch of this.HFl(nb,ld,Ed,Zd)){1<Ed&&this.Ab.V7c&&this.CGl(nb,Nb,ld,qg,Ed,If,ch);if(!ec)for(ec=new ib.a(this.Ab.annotations,P.Annotations.sY),Zd=0;Zd<ld;++Zd)Array.add(ec.items,nb.items[Zd]);Array.add(ec.items,ch)}ld+=Ed}else ec&&Array.add(ec.items,qg),++ld}return ec||nb}CGl(nb,Nb,ec,Hc,Tc,xd,ld){if(xd)xd=!0;else if(this.Ab.kZi){xd=!1;var Ed=-1;for(var Zd=0;Zd<Tc;Zd++){var If=nb.items[ec+Zd];let qj;var qg=void 0;if(!({value:qj}=If.mr(this.Ab.k6)).returnValue||!({value:qg}=If.mr(this.Ab.N$)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");
if(0<Zd){if(qj>Ed+1){xd=!0;break}if(0>Ed||null===Nb||Ed>=Nb.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==Nb.charAt(Ed)){xd=!0;break}}Ed=qj+qg}}else xd=!1;if(xd){qg=new Sys.StringBuilder;for(xd=0;xd<Tc;++xd)({CZj:Ed,lOi:Zd,length:If}=this.KHi(nb.items[ec+xd],Nb)),0<xd&&qg.append(" "),qg.append(Ed.substr(Zd,If));ld.dA(this.Ab.lmb,qg.toString())}nb=nb.items[ec+Tc-1];let ch,mk;({value:Hc}=Hc.mr(this.Ab.k6)).returnValue&&
({value:ch}=nb.mr(this.Ab.k6)).returnValue&&({value:mk}=nb.mr(this.Ab.N$)).returnValue?(ld.dA(this.Ab.k6,Hc),ld.dA(this.Ab.N$,ch+mk-Hc)):(ld.CZa(this.Ab.k6),ld.CZa(this.Ab.N$))}HFl(nb,Nb,ec,Hc){return new Jh(this,nb,Nb,ec,Hc)}KHi(nb,Nb){let ec,Hc;if(({value:ec}=nb.mr(this.Ab.lmb)).returnValue)Hc=!0,Nb=0,nb=ec.length;else{Hc=!1;if(null===Nb)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");ec=Nb;if(!({value:Nb}=nb.mr(this.Ab.k6)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:nb}=nb.mr(this.Ab.N$)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>Nb||0>nb||Nb+nb>ec.length)throw Error.argument("Token start/length values out of range","token");}return{CZj:ec,lOi:Nb,length:nb,c3l:Hc}}}Object(m.a)(Hk,"FlatLexiconNLModule",null,[2049]);class tg{constructor(nb,Nb){this.Vjf=this.Mje=this.gDg=this.lmb=this.N$=this.k6=this.U5a=this.zTa=0;this.CZi=this.kZi=this.V7c=!1;this.flatLexicon=null;this.annotations=Nb.annotations;
let ec=0;try{this.zTa=nb.K(ec),++ec,this.U5a=nb.K(ec),++ec,this.k6=nb.K(ec),++ec,this.N$=nb.K(ec),++ec,this.lmb=nb.K(ec),++ec,this.gDg=nb.K(ec),++ec,this.Mje=nb.K(ec),++ec,this.Vjf=nb.K(ec),++ec,this.V7c=1===nb.K(ec),++ec,this.kZi=1===nb.K(ec),++ec,this.CZi=1===nb.K(ec),++ec,this.flatLexicon=Nb.TEm(nb.K(ec))}catch(Hc){throw Error.argument("initData");}}}Object(m.a)(tg,"FlatLexiconNLModuleInit",null,[]);class wh{constructor(){this.U5c=0;this.gCf=null;this.Qld=0}}Object(m.a)(wh,"FeatureGenStackRec",
null,[]);class Hg{constructor(nb){this.gIg=Array(nb);this.nzc=Array(nb);this.LEg=[];this.bXj=[]}}Object(m.a)(Hg,"TokenStringLattice",null,[]);const Sf=(nb,Nb,ec)=>{for(let Hc=0;Hc<nb.length;Hc++)ec=Nb(ec,nb[Hc]);return ec},ph=(nb,Nb)=>{const ec=Array(nb.length);for(let Hc=0;Hc<nb.length;Hc++)ec[Hc]=Nb(nb[Hc]);return ec},Mh=(nb,Nb)=>{Nb=Array(Math.min(Nb,nb.length));for(let ec=0;ec<Nb.length;ec++)Nb[ec]=nb[ec];return Nb},Qf=(nb,Nb)=>{const ec=[];for(const Hc of nb)Nb(Hc)&&Array.add(ec,Hc);return ec};
class Qi{constructor(nb,Nb){this.key=nb;this.value=Nb}}Object(m.a)(Qi,"KeyValuePair",null,[]);const Cl=(nb,Nb)=>({returnValue:Nb in nb,value:nb[Nb]}),tl=nb=>{const Nb=[];for(let ec in nb){const Hc=new Qi(ec,nb[ec]);Array.add(Nb,Hc)}return Nb};class pf{constructor(nb){this.JHi=this.cMm;this.Ab=nb;this.die=this.y6f=this.z6f=0;for(const Nb of this.Ab.G1d)this.z6f=Math.max(this.z6f,Nb.Ekg),this.y6f=Math.max(this.y6f,Nb.ykg),this.die=Math.max(this.die,Nb.Hyb.length)}get z5l(){return this.Ab.qCe.trie}execute(nb){if(!nb)throw Error.argumentNull("input");
let Nb,ec;({tokens:Nb,dun:ec}=this.dMm(nb));let Hc=null,Tc=null,xd={};if(this.Ab.A8c){Nb=P.Annotations.AW(Nb);for(var ld=0;ld<Nb.items.length;++ld)Nb.items[ld]=P.Annotations.AW(Nb.items[ld])}else({Cli:Tc,returnValue:Hc}=this.LBi(nb,xd));ld=Array(this.die);const Ed=Array(this.die);for(var Zd=0;Zd<Ed.length;++Zd)Ed[Zd]=new wh;for(Zd=-this.z6f;Zd<Nb.items.length+this.y6f;++Zd){let If=null;this.Ab.A8c&&(If=Nb.items[Zd],xd={},{Cli:Tc,returnValue:Hc}=this.LBi(If,xd));for(const qg of this.Ab.G1d){if(0>Zd&&
-Zd>qg.Ekg||Zd>=Nb.items.length&&Zd-Nb.items.length+1>qg.ykg)continue;let ch=!0;for(let mk=0;mk<qg.Hyb.length;++mk){const qj=Zd+qg.Hyb[mk];ld[mk]=qj;if(0>qj?0>this.Ab.Fkg:qj>=Nb.items.length?0>this.Ab.zkg:!ec.nzc[qj]){ch=!1;break}}ch&&({SJl:Hc,TJl:Tc}=this.k9m(qg,ec,Hc,Tc,xd,Ed,ld))}this.Ab.A8c&&(If.dA(this.Ab.S$a?this.Ab.cdc:this.Ab.adc,Hc),this.Ab.S$a&&If.dA(this.Ab.bdc,Tc))}nb=P.Annotations.AW(nb);this.Ab.A8c?nb.dA(this.Ab.zTa,Nb):(nb.dA(this.Ab.S$a?this.Ab.cdc:this.Ab.adc,Hc),this.Ab.S$a&&nb.dA(this.Ab.bdc,
Tc));return nb}dMm(nb){let Nb,ec;if(!nb||!({value:Nb}=nb.mr(this.Ab.zTa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Hc;({value:Hc}=nb.mr(this.Ab.U5a)).returnValue||(Hc="");ec=new Hg(Nb.items.length);const Tc=Qf(this.Ab.jIg,xd=>!xd.Z6c||xd.Z6c.isMatch(nb,null));for(let xd=0;xd<Nb.items.length;++xd){const ld=Nb.items[xd];let Ed=null;ec.gIg[xd]=ec.LEg.length;let Zd=ec.nzc[xd]=0;for(const If of Tc)0<If.dcd&&ec.nzc[xd]+Zd>=If.dcd||If.tokenFilter&&!If.tokenFilter.isMatch(ld,
null)||({erd:Ed,JTc:Zd}=If.apply(this,ld,xd,ec,Hc,Ed,Zd))}return{tokens:Nb,dun:ec}}k9m(nb,Nb,ec,Hc,Tc,xd,ld){let Ed=0;xd[0].U5c=-1;for(xd[0].gCf=nb.zGj;;){var Zd=ld[Ed],If=0>Zd||Zd>=Nb.nzc.length?1:Nb.nzc[Zd];let mk=!1;for(;xd[Ed].U5c<If-1;){++xd[Ed].U5c;var qg=void 0,ch=void 0;0>Zd?(qg=this.Ab.Fkg,ch=1):Zd>=Nb.gIg.length?(qg=this.Ab.zkg,ch=1):(ch=Nb.gIg[Zd]+xd[Ed].U5c,qg=Nb.LEg[ch],ch=Nb.bXj[ch]);xd[Ed].Qld=ch*(Ed?xd[Ed-1].Qld:nb.score);if(({value:qg}=Cl(xd[Ed].gCf,qg.toString())).returnValue){Ed===
nb.Hyb.length-1?(Zd=qg,xd[Ed].Qld&&(({value:If}=Cl(Tc,Zd.toString())).returnValue||(If=-1),0>If&&(ec=P.Annotations.AW(ec),Array.add(ec.items,Zd)),this.Ab.S$a&&(Hc=P.Annotations.AW(Hc),0>If?Array.add(Hc.items,xd[Ed].Qld):Hc.items[If]+=xd[Ed].Qld),0>If&&(this.Ab.h2i||this.Ab.S$a)&&(Tc[Zd.toString()]=ec.items.length-1))):(++Ed,xd[Ed].U5c=-1,xd[Ed].gCf=qg);mk=!0;break}}if(!mk&&(--Ed,0>Ed))break}return{SJl:ec,TJl:Hc}}LBi(nb,Nb){let ec;if(({value:ec}=nb.mr(this.Ab.S$a?this.Ab.cdc:this.Ab.adc)).returnValue)for(let Hc=
0;Hc<ec.items.length;++Hc)Nb[ec.items[Hc].toString()]=Hc;else ec=new ib.a(this.Ab.annotations,P.Annotations.TOa);if(this.Ab.S$a){if(({value:Nb}=nb.mr(this.Ab.bdc)).returnValue||(Nb=new ib.a(this.Ab.annotations,P.Annotations.Sva)),Nb.items.length!==ec.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Ab.annotations.Qha(P.Annotations.sY,nb));}else Nb=null;return{returnValue:ec,Cli:Nb}}get tip(){return this.Ab.qCe}cMm(nb,
Nb){var ec;if(({value:ec}=Nb.mr(this.Ab.lmb)).returnValue)nb=ec;else{if(!({value:ec}=Nb.mr(this.Ab.k6)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:Nb}=Nb.mr(this.Ab.N$)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>ec||0>Nb||ec+Nb>nb.length)throw Error.argument("Token indices are out of range");nb=nb.substr(ec,Nb)}return nb}}Object(m.a)(pf,"NGramNLModule",null,[2049,2050]);class Wk{constructor(nb){this.Hyb=null;this.score=this.ykg=this.Ekg=
0;this.zGj=null;if(nb){var Nb=0;try{if(nb.K(Nb)!==Wk.SKb)throw Error.argument("initData","Input does not represent a feature template");++Nb;const ec=nb.K(Nb);++Nb;this.Hyb=Array(ec);for(let Hc=0;Hc<ec;++Hc)this.Hyb[Hc]=nb.K(Nb),++Nb;this.Ekg=nb.K(Nb);++Nb;this.ykg=nb.K(Nb);++Nb;this.score=nb.K(Nb);++Nb;this.zGj=({fOi:Nb}=Wk.exj(nb,Nb)).returnValue}catch(ec){throw Error.argument("initData");}}}static exj(nb,Nb){const ec=nb.K(Nb);++Nb;const Hc={};for(let Tc=0;Tc<ec;++Tc){const xd=nb.K(Nb);++Nb;nb.K(Nb)?
Hc[xd.toString()]=({fOi:Nb}=Wk.exj(nb,Nb)).returnValue:(++Nb,Hc[xd.toString()]=nb.K(Nb),++Nb)}return{returnValue:Hc,fOi:Nb}}}Wk.SKb=240803228;Object(m.a)(Wk,"FeatureTemplate",null,[2056]);var Eh=d(1526);class Li{constructor(nb,Nb){this.S$a=this.h2i=this.A8c=!1;this.lmb=this.N$=this.k6=this.zTa=this.U5a=this.bdc=this.cdc=this.adc=0;this.qCe=null;this.zkg=this.Fkg=0;this.G1d=this.jIg=null;if(nb){this.annotations=Nb.annotations;var ec=0;try{this.A8c=1===nb.K(ec);++ec;this.h2i=1===nb.K(ec);++ec;this.S$a=
1===nb.K(ec);++ec;this.adc=nb.K(ec);++ec;this.cdc=nb.K(ec);++ec;this.bdc=nb.K(ec);++ec;this.U5a=nb.K(ec);++ec;this.zTa=nb.K(ec);++ec;this.k6=nb.K(ec);++ec;this.N$=nb.K(ec);++ec;this.lmb=nb.K(ec);++ec;this.qCe=this.a7n(Nb.gqb(nb.K(ec)));++ec;this.Fkg=nb.K(ec);++ec;this.zkg=nb.K(ec);++ec;const Hc=nb.K(ec);++ec;this.jIg=Array(Hc);for(let xd=0;xd<Hc;++xd){const ld=nb.K(ec);++ec;const Ed=this.qCe.trie,Zd=new bb.a;Zd.Lpb(nb,ec,ld);this.jIg[xd]=this.e7n(Zd,Nb,Ed);ec+=ld}const Tc=nb.K(ec);++ec;this.G1d=Array(Tc);
for(Nb=0;Nb<Tc;++Nb){const xd=nb.K(ec);++ec;const ld=new bb.a;ld.Lpb(nb,ec,xd);this.G1d[Nb]=this.F6n(ld);ec+=xd}}catch(Hc){throw Error.argument("initData");}}}a7n(nb){return new Fb.a(new Vb.a(nb))}e7n(nb,Nb,ec){return Eh.a.create(nb,Nb,ec)}F6n(nb){return new Wk(nb)}}Object(m.a)(Li,"NGramNLModuleInit",null,[]);class Dj{constructor(nb){this.Ab=nb}execute(nb){if(!nb)throw Error.argumentNull("input");nb=nb.clone();this.Ab.script.execute(nb,null);return nb}}Object(m.a)(Dj,"ScriptNLModule",null,[2049]);
class xi{constructor(nb,Nb){nb&&(this.script=Nb.NOb(nb.K(0)))}}Object(m.a)(xi,"ScriptNLModuleInit",null,[]);const pg=nb=>{nb=ph(nb,Nb=>Nb*Nb);return Math.sqrt(Sf(nb,(Nb,ec)=>Nb+ec,0))},Mi=nb=>Sf(nb,(Nb,ec)=>Nb>ec?Nb:ec,nb[0]);class Vl{constructor(nb){this.Ab=nb}execute(nb){if(!nb)throw Error.argumentNull("input");var Nb=[],ec=[];this.ssl(nb,Nb,ec);this.V0k(Nb,ec);const Hc={};for(let xd=0;xd<Nb.length;++xd){var Tc=Nb[xd];const ld=this.Ab.oSi.K(Tc);Tc=this.Ab.pSi.K(Tc);for(let Ed=0;Ed<Tc;++Ed){const Zd=
this.Ab.baa.K(this.Ab.Q0h.K(ld+Ed)),If=this.Ab.R0h.K(ld+Ed);let qg;({value:qg}=Cl(Hc,Zd)).returnValue||(qg=0);Hc[Zd]=qg+ec[xd]*If}}ec=tl(Hc);ec.sort((xd,ld)=>{var Ed=xd.value,Zd=ld.value;(Ed=-(Ed>Zd?1:Ed<Zd?-1:0))||(Ed=xd.key.localeCompare(ld.key));return Ed});Nb=new ib.a(this.Ab.annotations,P.Annotations.sY);for(const xd of Mh(ec,this.Ab.SGn))ec=new K.a(this.Ab.annotations),ec.dA(this.Ab.g9k,xd.key),ec.dA(this.Ab.i9k,xd.value),Array.add(Nb.items,ec);nb.dA(this.Ab.h9k,Nb);return nb}ssl(nb,Nb,ec){if(({value:nb}=
nb.mr(this.Ab.f9k)).returnValue){let Hc;if(({value:Hc}=nb.mr(this.Ab.cdc)).returnValue){let Tc;if(!({value:Tc}=nb.mr(this.Ab.bdc)).returnValue||Hc.items.length!==Tc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.DVd(Hc,Tc,Nb,ec)}if(({value:Hc}=nb.mr(this.Ab.k9k)).returnValue){let Tc;if(!({value:Tc}=nb.mr(this.Ab.l9k)).returnValue||Hc.items.length!==Tc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");
this.DVd(Hc,Tc,Nb,ec)}({value:Hc}=nb.mr(this.Ab.adc)).returnValue&&this.DVd(Hc,null,Nb,ec);({value:Hc}=nb.mr(this.Ab.j9k)).returnValue&&this.DVd(Hc,null,Nb,ec)}}DVd(nb,Nb,ec,Hc){for(let xd=0;xd<nb.items.length;++xd){var Tc=void 0;nb.M7===P.Annotations.Ica?({value:Tc}=Cl(this.Ab.Zgi,nb.items[xd])).returnValue||(Tc=-1):(Tc=nb.items[xd],Tc=Tc>=this.Ab.k8f&&Tc<=this.Ab.tHn?this.Ab.fbg?this.Ab.fbg.K(Tc-this.Ab.k8f)-1:Tc-this.Ab.k8f:-1);if(0<=Tc){let ld;ld=Nb?Nb.items[xd]:1;0<ld&&(Array.add(ec,Tc),Array.add(Hc,
ld))}}}V0k(nb,Nb){if(nb.length){switch(this.Ab.Kgo){case 0:break;case 1:for(var ec=0;ec<Nb.length;++ec)Nb[ec]=1+Math.log(Nb[ec]);break;case 2:ec=Mi(Nb);for(let Hc=0;Hc<Nb.length;++Hc)Nb[Hc]=.5+Nb[Hc]/ec*.5;break;case 3:for(ec=0;ec<Nb.length;++ec)Nb[ec]=1;break;default:throw Error.notImplemented();}if(this.Ab.zbe)for(ec=0;ec<Nb.length;++ec)Nb[ec]*=this.Ab.zbe.K(nb[ec]);nb=pg(Nb);for(ec=0;ec<Nb.length;++ec)Nb[ec]/=nb}}}Object(m.a)(Vl,"TfIdfRankerNLModule",null,[2049]);class ki{constructor(nb,Nb=0){if(!nb)throw Error.argumentNull("byteArray");
this.eie=Nb;if(604662927!==nb.aA(this.eie+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.Kk=nb.aA(this.eie+4,4);this.A$i=nb.aA(this.eie+8,4);this.dEn=nb}K(nb){if(0>nb||nb>=this.count)throw Error.argumentOutOfRange("index");return this.dEn.flo(8*this.eie+96+nb*this.A$i,this.A$i)}get count(){return this.Kk}}Object(m.a)(ki,"CompactIntArray",null,[2047]);const Th=(nb,Nb)=>{Nb=Array(Nb);for(let xd=0;xd<Nb.length;xd++){var ec=xd,Hc=nb.Zba(),Tc=1===(Hc>>31&1)?
-1:1;const ld=Hc&8388607;Hc=Hc>>23&255;256===Hc+1?Tc=ld?Number.NaN:1===Tc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:Hc?(Hc-=127,Tc=Tc*hh(ld,1)*Math.pow(2,Hc)):Tc=Tc*hh(ld,0)*Math.pow(2,-126);Nb[ec]=Tc}return Nb},hh=(nb,Nb)=>{let ec=0;for(let Hc=0;23>Hc;Hc++)ec+=(nb>>22-Hc&1)/Math.pow(2,Hc+1);return Nb+ec};class Fe{constructor(nb,Nb){this.fbg=null;this.zgj=0;this.pSi=this.oSi=this.zbe=null;this.ygj=0;this.R0h=this.Q0h=null;this.annotations=Nb.annotations;let ec=0;this.j9k=nb.K(ec);++ec;this.adc=
nb.K(ec);++ec;this.k9k=nb.K(ec);++ec;this.l9k=nb.K(ec);++ec;this.cdc=nb.K(ec);++ec;this.bdc=nb.K(ec);++ec;this.f9k=nb.K(ec);++ec;this.h9k=nb.K(ec);++ec;this.g9k=nb.K(ec);++ec;this.i9k=nb.K(ec);++ec;var Hc=nb.K(ec);++ec;var Tc=Array(Hc);for(var xd=0;xd<Hc;++xd)Tc[xd]=Nb.eD(nb.K(ec)),++ec;this.baa=bb.a.$sf(Tc);this.SGn=nb.K(ec);++ec;this.Kgo=nb.K(ec);++ec;Hc=nb.K(ec);++ec;this.Zgi={};for(Tc=0;Tc<Hc;++Tc){xd=Nb.eD(nb.K(ec));++ec;const ld=nb.K(ec);++ec;this.Zgi[xd]=ld}this.k8f=nb.K(ec);++ec;this.tHn=
nb.K(ec);++ec;Hc=nb.K(ec);++ec;0<Hc&&(Hc=Nb.gqb(nb.K(ec)),++ec,this.fbg=this.Koe(new Gg(Hc)));++ec;nb=Nb.gqb(nb.K(ec));this.O6n(nb)}Koe(nb){return new ki(nb.Cja,nb.offset)}O6n(nb){try{const Nb=new Gg(nb);this.zgj=Nb.Zba();1===Nb.Zba()?this.zbe=bb.a.$sf(Th(Nb,this.zgj)):this.zbe=null;const ec=Nb.Zba();this.oSi=this.Koe(Nb);Nb.offset+=ec;const Hc=Nb.Zba();this.pSi=this.Koe(Nb);Nb.offset+=Hc;this.ygj=Nb.Zba();const Tc=Nb.Zba();this.Q0h=this.Koe(Nb);Nb.offset+=Tc;this.R0h=bb.a.$sf(Th(Nb,this.ygj))}catch(Nb){throw Error.argument("byteReader");
}}}Object(m.a)(Fe,"TfIdfRankerNLModuleInit",null,[]);class tj{constructor(nb,Nb,ec,Hc){this.yig=nb;this.yni=ec;this.tokens=Hc;this.Bra=Nb;this.Wvc=-1;this.Qve=0}}Object(m.a)(tj,"TokenizerData",null,[]);class Ni{constructor(nb){this.Ab=nb}execute(nb){if(!nb)throw Error.argumentNull("input");if(!({value:Hc}=nb.mr(this.Ab.U5a)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Nb;({value:Nb}=nb.mr(this.Ab.k6)).returnValue||(Nb=0);let ec;({value:ec}=
nb.mr(this.Ab.N$)).returnValue||(ec=Hc.length-Nb);if(0>Nb||Nb>Hc.length)throw Error.argument("input","Start index out of range");if(0>ec||ec>Hc.length)throw Error.argument("input","Length out of range");if(Nb+ec>Hc.length)throw Error.argument("input","Bad start-length range");var Hc=new tj(Hc,Nb,Nb+ec,new ib.a(this.Ab.annotations,P.Annotations.sY));this.uip(Hc);nb=nb.isReadOnly?nb.clone():nb;nb.dA(this.Ab.zTa,Hc.tokens);return nb}uip(nb){for(;nb.Bra<nb.yni;){if(this.Ab.nPf){var Nb=this.Ab.nPf.c$i(nb.yig,
nb.Bra,nb.yni-nb.Bra,null);!Nb.succeeded&&Nb.ofj&&(Nb=Nb.ofj);if(Nb.succeeded){this.tkj(nb,Nb.length,this.Ab.eKi);nb.Bra+=Nb.length;continue}}Nb=nb.yig.substr(nb.Bra);let ec=-1,Hc=-1,Tc=-1;for(let xd=0;xd<this.Ab.Oue.length;++xd){const ld=this.Ab.Oue[xd].exec(Nb);ld&&0<ld[1].length&&(0>ec||ld[0].length>Hc)&&(ec=xd,Hc=ld[0].length,Tc=ld[1].length)}0<=ec?(this.tkj(nb,Tc,this.Ab.lvg[ec]),nb.Bra+=Tc):nb.Bra+=1}}tkj(nb,Nb,ec){if(this.Ab.t0i)ec!==Ni.mgl&&(0>nb.Wvc&&(nb.Wvc=nb.Bra),nb.Qve=nb.Bra+Nb-nb.Wvc,
ec===Ni.lgl&&(0<=nb.Wvc&&0<nb.Qve&&(Nb=new K.a(this.Ab.annotations),Nb.dA(this.Ab.k6,nb.Wvc),Nb.dA(this.Ab.N$,nb.Qve),Nb.dA(this.Ab.Jif,Ni.ngl),Nb.dA(this.Ab.U5a,nb.yig),Array.add(nb.tokens.items,Nb)),nb.Wvc=-1,nb.Qve=0));else{let Hc=new K.a(this.Ab.annotations);Hc.dA(this.Ab.k6,nb.Bra);Hc.dA(this.Ab.N$,Nb);Hc.dA(this.Ab.Jif,ec);Array.add(nb.tokens.items,Hc)}}}Ni.mgl="GAP";Ni.lgl="EOS_CHUNK";Ni.ngl="SENTENCE";Object(m.a)(Ni,"TokenizerNLModule",null,[2049]);class bh{constructor(nb,Nb){this.N$=this.k6=
this.Jif=this.zTa=this.U5a=0;this.t0i=!1;this.lvg=this.Oue=this.eKi=this.nPf=null;if(nb){this.annotations=Nb.annotations;var ec=0;try{this.U5a=nb.K(ec);++ec;this.zTa=nb.K(ec);++ec;this.Jif=nb.K(ec);++ec;this.k6=nb.K(ec);++ec;this.N$=nb.K(ec);++ec;this.t0i=1===nb.K(ec);++ec;var Hc=nb.K(ec);++ec;0<Hc&&(this.nPf=Nb.DKf(Hc).z5l);this.eKi=nb.K(ec)?Nb.eD(nb.K(ec)):"";++ec;const Tc=nb.K(ec);++ec;this.Oue=Array(Tc);this.lvg=Array(Tc);for(Hc=0;Hc<Tc;++Hc)this.Oue[Hc]=new RegExp(Nb.eD(nb.K(ec))),++ec,this.lvg[Hc]=
Nb.eD(nb.K(ec)),++ec}catch(Tc){throw Error.argument("initData");}}}}Object(m.a)(bh,"TokenizerNLModuleInit",null,[]);class rk{constructor(nb){this.Ab=nb}execute(nb){if(!nb)throw Error.argumentNull("input");let Nb;if(!({value:Nb}=nb.mr(this.Ab.ITh)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const ec of this.Ab.WDg)Nb=ec.apply(Nb);nb=P.Annotations.AW(nb);nb.dA(this.Ab.JTh,Nb);return nb}static Vhf(nb,Nb){const ec=new Sys.StringBuilder;for(let Hc=
0;Hc<nb.length;++Hc)ec.append(Nb(nb.substr(Hc,1)));return ec.toString()}}Object(m.a)(rk,"TransliteratorNLModule",null,[2049]);class Qd{constructor(nb){nb&&(this.style=nb.K(0))}apply(nb){return rk.Vhf(nb,Nb=>Qd.ell(Nb,this.style))}static ell(nb,Nb){switch(Nb){case 0:return nb.toLowerCase();case 1:return"I"===nb?"\u0131":nb.toLowerCase();case 2:return nb.toUpperCase();case 3:return"i"===nb?"\u0130":nb.toUpperCase();default:throw Error.invalidOperation();}}}Qd.TKb=0;Object(m.a)(Qd,"ChangeCaseTransliterationStage",
null,[2055]);class kf{apply(nb){return rk.Vhf(nb,kf.Ujp)}static Ujp(nb){const Nb=nb.charCodeAt(0);return 65281<=Nb&&65374>=Nb?String.fromCharCode(Nb-65248):nb}}kf.TKb=4;Object(m.a)(kf,"LatinFullWidthToHalfWidthTransliterationStage",null,[2055]);class sk{constructor(nb,Nb){nb&&(this.Ipg=Nb.kkc(nb.K(0)),this.LAo=Nb.eD(nb.K(1)))}apply(nb){return nb.replace(this.Ipg,this.LAo)}}sk.TKb=1;Object(m.a)(sk,"RegexReplaceTransliterationStage",null,[2055]);class al{constructor(nb,Nb){if(nb){var ec=nb.K(0),Hc=
Nb.eD(nb.K(1)),Tc=new ki(Nb.gqb(nb.K(2)));nb=0>nb.K(3)?null:new ki(Nb.gqb(nb.K(3)));this.dFg={};for(Nb=0;Nb<ec;++Nb)this.dFg[Hc.charAt(Nb).toString()]=Hc.substr(Tc.K(Nb),nb?nb.K(Nb):1)}}apply(nb){return rk.Vhf(nb,Nb=>Nb in this.dFg?this.dFg[Nb]:Nb)}}al.TKb=2;Object(m.a)(al,"SingleCharSubstitutionsTransliterationStage",null,[2055]);class he{constructor(nb,Nb){this.JTh=this.ITh=0;this.WDg=null;if(nb){this.annotations=Nb.annotations;var ec=0;try{this.ITh=nb.K(ec);++ec;this.JTh=nb.K(ec);++ec;const Hc=
nb.K(ec);++ec;this.WDg=Array(Hc);for(let Tc=0;Tc<Hc;++Tc){const xd=nb.K(ec);++ec;const ld=nb.K(ec);++ec;const Ed=new bb.a;Ed.Lpb(nb,ec,ld);ec+=ld;this.WDg[Tc]=this.$6n(xd,Ed,Nb)}}catch(Hc){throw Error.argument("initData");}}}$6n(nb,Nb,ec){switch(nb){case Qd.TKb:return new Qd(Nb);case sk.TKb:return new sk(Nb,ec);case al.TKb:return new al(Nb,ec);case kf.TKb:return new kf;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(m.a)(he,"TransliteratorNLModuleInit",
null,[]);class qd{cym(nb,Nb){const ec=nb.K(0),Hc=new bb.a;Hc.Lpb(nb,1,nb.count-1);switch(ec){case 0:return new Dj(new xi(Hc,Nb));case 2:return new Ni(new bh(Hc,Nb));case 3:return new pf(new Li(Hc,Nb));case 5:return new Hk(new tg(Hc,Nb));case 9:return new rk(new he(Hc,Nb));case 10:return new Vl(new Fe(Hc,Nb));default:throw Error.notImplemented();}}}Object(m.a)(qd,"NLModuleFactory",null,[2042]);class hl{constructor(nb){this.jgl=";";if(!nb)throw Error.argumentNull("resource");this.ima=new yd(nb,new Ib,
new qd);this.B6f=this.ima.Hxm();this.z$i=this.ima.annotations.l1c("Text.Text");this.x$i=this.ima.annotations.l1c("Classification.Predictions");this.m6f=this.ima.annotations.l1c("Classification.PredictionString");this.y$i=this.ima.annotations.l1c("Classification.Probability");this.cEn=this.ima.annotations.l1c("NLMod.Tokens");if(0>this.z$i||0>this.x$i||0>this.m6f||0>this.y$i)throw Error.argument("resourceObj","Resource does not represent a ranker");}ngm(){const nb=[];this.PAf(void 0,this.qsi(nb),null);
return nb}pgm(nb,Nb){const ec=[],Hc=[];this.PAf(nb,this.qsi(ec),(Tc,xd)=>{const ld=this.ima.annotations.dsi(Tc),Ed=[],Zd=[];Nb&&Nb.length&&-1===Array.indexOf(Nb,ld)||(Tc=this.ima.annotations.getAttributeType(Tc),this.psj(Tc,xd,Ed,Zd),xd=new ng(ld,Ed,Zd),Array.add(Hc,xd))});return new Ef(ec,Hc)}ogm(nb){const Nb=[];this.PAf(nb,ec=>{let Hc;if(({value:Hc}=ec.mr(this.m6f)).returnValue){let Tc;({value:Tc}=ec.mr(this.y$i)).returnValue&&Array.add(Nb,new lh(Hc,Tc))}},null);return Nb}PAf(nb,Nb,ec){var Hc=new K.a(this.ima.annotations);
Hc.dA(this.z$i,nb);nb=this.B6f.execute(Hc);if(({value:Hc}=nb.mr(this.x$i)).returnValue)for(const Tc of Hc.items)Nb(Tc);if(ec&&({value:Nb}=nb.mr(this.cEn)).returnValue)for(const Tc of Nb.items)Tc.k3d(ec)}psj(nb,Nb,ec,Hc){if(P.Annotations.kK(nb))for(var Tc of Nb.items)this.psj(Nb.M7,Tc,ec,Hc);else if(P.Annotations.a3j(nb)){Tc=this.ima.annotations.sBi(nb);for(let xd=0;xd<Tc;xd++)Array.add(ec,this.ima.annotations.dGi(nb,xd)),Array.add(Hc,this.ima.annotations.Qha(this.ima.annotations.oQb(nb,xd),Nb.uqb(xd)))}else Array.add(ec,
"VALUE"),Array.add(Hc,this.ima.annotations.Qha(nb,Nb))}qsi(nb){return Nb=>{let ec;({value:ec}=Nb.mr(this.m6f)).returnValue&&Array.add(nb,this.tDm(ec))}}tDm(nb){const Nb=nb.indexOf(this.jgl);return 0>Nb?nb:nb.substring(0,Nb)}}Object(m.a)(hl,"Ranker",null,[]);var ug=d(1442),Tj=d(1461),xk=d(2);class ff{constructor(nb,Nb){this.Oqh="";this.x4e=null;this.y4e=!1;this.lwa=null;this.kmk=["TellMe.TellMeParamCollection"];this.kc=nb;this.I3a=Nb;this.kc.fKb&&(this.lwa=null)}get kre(){if(!this.x4e&&!this.y4e){let nb=
null;try{nb=window.TellMeModel}catch(Nb){if(u.TellMeActor.instance.Xe)u.TellMeActor.instance.Xe.onError("QueryRanker","TellMeModel not found. Exception: "+Nb)}if(nb){try{this.x4e=new hl(nb)}catch(Nb){if(u.TellMeActor.instance.Xe)u.TellMeActor.instance.Xe.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Nb)}this.y4e=!0}else if(u.TellMeActor.instance.Xe)u.TellMeActor.instance.Xe.onError("QueryRanker","Classifier model not found")}return this.x4e}oN(){return"Command"}bX(){return 0===
this.kc.iw?0:1===this.kc.iw?1:2}WJ(nb,Nb,ec=!1,Hc=f.a.ou,Tc=null){const xd=new x.a(nb);if((!Tc||Array.contains(Tc,0))&&!v.a.wU(nb)){if(!this.kre&&this.y4e){if(u.TellMeActor.instance.Xe)u.TellMeActor.instance.Xe.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.kc.fKb&&this.lwa&&this.lwa.initialize();if(ug.CommandResultsUtility.DWf(nb.Wg)&&(Tc=ug.CommandResultsUtility.Xti(nb.Wg),0<Tc.results.length)){Tc.displayName=
"Classifier Debug";xd.dw(Tc);Nb.Nt(xd);return}Tc=nb?this.Oqh=nb.Wg:this.Oqh;if(xk.AFrameworkApplication.J.$("TellMeParameterizedQueriesEnabled")){Tc=this.vDm(Tc);var ld=this.D4d(Tc.LLf());Tc=Tc.Cri()}else Tc=this.uDm(Tc),ld=this.Fjm(Tc),Tc=[];ug.CommandResultsUtility.rhe(ld,!1,"Classifier","TFIDF");ld=ug.CommandResultsUtility.J3c(nb,ld,this.kc,this.lwa,this.I3a,Tc,0,1);0<ld.results.length&&Hc!==f.a.contextMenu&&(ld.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);ec||ld.results.length||this.kc.Y2||
this.kc.neb||(nb=new w.a("lookupNoResults",14,nb.Wg,null,1),ld.Xx(nb));0<ld.results.length&&xd.dw(ld);xd.attributes=Tc}Nb.Nt(xd)}LLf(){let nb=[];try{nb=this.kre.ngm()}catch(Nb){if(u.TellMeActor.instance.Xe)u.TellMeActor.instance.Xe.onError("GetPredictions","Exception: "+Nb)}return nb}uDm(nb){let Nb=[];try{Nb=this.kre.ogm(nb)}catch(ec){if(u.TellMeActor.instance.Xe)u.TellMeActor.instance.Xe.onError("GetPredictionsWithScore","Exception: "+ec)}return Nb}vDm(nb){try{return this.kre.pgm(nb,this.kmk)}catch(Nb){if(u.TellMeActor.instance.Xe)u.TellMeActor.instance.Xe.onError("GetPredictionsWithTokenAttributes",
"Exception: "+Nb)}return new Ef([],[])}D4d(nb){const Nb=[];if(nb)for(const ec of nb)Nb.push(new Tj.a(ec,-99999));return Nb}Fjm(nb){const Nb=[];if(nb)for(const ec of nb)Nb.push(new Tj.a(ec.prediction,ec.score));return Nb}}Object(m.a)(ff,"CommandResultsProvider",null,[1399]);var Oi=d(1733);class Ph{constructor(nb){this.kc=nb}oN(){return"Feedback"}bX(){return 0===this.kc.iw?0:1===this.kc.iw?1:2}WJ(nb,Nb,ec,Hc,Tc=null){nb=new x.a(nb);if(!Tc||Array.contains(Tc,21))Tc=[],Tc.push(appChrome.actions.setControlLabel("TellMeFeedback",
CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(Tc),Tc=new z.a(22),Tc.displayName="",Tc.Xx(new w.a("TellMeFeedback",23,null,null,1)),nb.dw(Tc);Nb.Nt(nb)}}Object(m.a)(Ph,"FeedbackResultsProvider",null,[1399]);class ni{constructor(nb,Nb,ec,Hc){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=nb;this.CommandId=Nb;this.CommandValueId=ec;this.InputText=Hc}}Object(m.a)(ni,"FindInDocumentProp",null,[]);var Pf=d(17);class Yh{constructor(nb){this.n_e=2;this.HFb=[];
this.ujb=[];this.kc=nb;Yh.KJa=nb.pCf;Yh.Vmi="FindInDocumentSuggestion";Yh.vrj="FindInDocumentSuggestion3";this.mZe=Object.assign(new E.a,{landingTab:"Indoc",data:null});this.LKk=this.kc.tyb||!!xk.AFrameworkApplication.ua&&xk.AFrameworkApplication.ua.Ib.tyb}oN(){return"FindInDocument"}bX(){return 0===this.kc.iw?0:1===this.kc.iw?1:3===this.kc.iw?this.kc.kUj?2:3:2}WJ(nb,Nb,ec=!1,Hc,Tc=null){const xd=new x.a(nb);if(Tc&&!Array.contains(Tc,2))Nb.Nt(xd);else if(Array.clear(this.HFb),v.a.wU(nb)){if(ec&&this.DRj()){ec=
new z.a(2);ec.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Tc=1;Hc="";if(0<this.ujb.length&&!this.kc.Vwc)for(var ld of this.ujb)if(""!==ld.Label.toLowerCase()){if(Tc>=this.n_e)break;this.f7j(ec,ld.Label,ld.CommandValueId,Yh.Vmi+Tc,ld.InputText);Tc++}ld="";this.kc.mS?(xd.dw(ec),ec=new z.a(3),ld=this.kc.hmb?v.a.cqb(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):CommonUIStrings.l_TellMeOpenFindPaneTextV2):ld=CommonUIStrings.l_TellMeOpenFindPaneText;Hc=this.Wti("");this.f7j(ec,ld,Hc,
Yh.vrj,"");xd.dw(ec)}Nb.Nt(xd)}else ld="",ec&&(ec=this.Wti(nb.Wg),Hc=[],this.kc.Aab?(this.kc.uye&&Hc.push(appChrome.actions.setControlIconSet(Yh.KJa,{"default":"FindInDocument_20"})),ld=this.kc.W_f?v.a.VIf(nb.Wg,CommonUIStrings.l_FindInDocumentScopedButtonText):nb.Wg+CommonUIStrings.l_FindInDocumentScopedButtonText):this.kc.mS?(ld=this.kc.hmb?v.a.cqb(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,nb.Wg)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,nb.Wg),
Hc.push(appChrome.actions.setControlIconSet(Yh.KJa,{"default":"FindInDocument_20"}))):ld=this.kc.Vwc?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,nb.Wg),this.kc.hBa?(u.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Yh.KJa,ld)),u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Yh.KJa,ec))):(Hc.push(appChrome.actions.setControlLabel(Yh.KJa,ld)),Hc.push(appChrome.actions.setButtonCommandValueId(Yh.KJa,ec)),
appChrome.api.dispatch(Hc)),this.aNj(ld,Yh.KJa,ec,nb.Wg)),this.kc.kUj?(ld=new w.a(Yh.KJa,8,nb.Wg),ec=new z.a(2),ec.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,ec.Xx(ld),xd.dw(ec),Nb.Nt(xd)):this.kc.A5d(nb.Wg).then(Ed=>{const Zd=new w.a(Yh.KJa,8,nb.Wg,null,1);Zd.count=Ed;Ed=new z.a(2);Ed.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Ed.Xx(Zd);xd.dw(Ed);Nb.Nt(xd)},Ed=>{u.TellMeActor.instance.Xe.onError("FindInDocumentResultsProvider:issueQuery","Find manager promise rejected: "+
Ed);Ed=new w.a(Yh.KJa,8,nb.Wg,null,1);const Zd=new z.a(2);Zd.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Zd.Xx(Ed);xd.dw(Zd);Nb.Nt(xd)})}DRj(){return!!this.kc&&this.kc.mye}f7j(nb,Nb,ec,Hc,Tc=null){const xd=[];Nb&&xd.push(appChrome.actions.setControlLabel(Hc,Nb));this.kc.mS&&xd.push(appChrome.actions.setControlIconSet(Hc,{"default":"FindInDocument_20"}));xd.push(appChrome.actions.setButtonCommandValueId(Hc,ec));appChrome.api.dispatch(xd);this.aNj(Nb,Hc,ec,"");nb.Xx(new w.a(Hc,8,Tc,null,
1,-99999))}Wti(nb){return this.LKk?v.a.oUa(nb,15,this.mZe):Pf.a.Jf(nb)}aNj(nb,Nb,ec,Hc){this.DRj()&&this.HFb.length<this.n_e&&(nb=new ni(nb,Nb,ec,Hc),Array.add(this.HFb,nb))}PSo(nb){for(let Nb=0;Nb<this.HFb.length;Nb++)if(this.HFb[Nb].CommandId===nb){const ec=this.HFb[Nb].Label;let Hc=!1;if(0<this.ujb.length){let Tc=0;for(const xd of this.ujb){if(xd.Label===ec){Array.removeAt(this.ujb,Tc);Hc=!0;break}Tc++}}!Hc&&this.ujb.length>=this.n_e-1&&Array.removeAt(this.ujb,1);Array.insert(this.ujb,0,this.HFb[Nb])}}}
Yh.KJa=null;Yh.Vmi=null;Yh.vrj=null;Object(m.a)(Yh,"FindInDocumentResultsProvider",null,[1399]);var Qh=d(1731);class fk{constructor(nb){this.kc=nb}oN(){return"Insights"}bX(){return 0===this.kc.iw?0:1===this.kc.iw?1:2}WJ(nb,Nb,ec=!1,Hc,Tc=null){Hc=new x.a(nb);if(!Tc||Array.contains(Tc,13))if(this.u1o()||!v.a.wU(nb)){Tc=new z.a(13);var xd=""===nb.Wg.trim(),ld=xd?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",Ed=new w.a(ld,10,nb.Wg,null,1);ec&&(ec=null,v.a.yta()?xd?xd=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:
(xd=this.kc.Vwc?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,nb.Wg),ec=v.a.oUa(nb.Wg,1)):(xd=String.format(CommonUIStrings.l_InsightsButtonText,nb.Wg),ec=v.a.qMb(nb.Wg)),this.kc.hBa?(u.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ld,xd)),ec&&u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",ec))):(nb=[],nb.push(appChrome.actions.setControlLabel(ld,xd)),
ec&&nb.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",ec)),appChrome.api.dispatch(nb)),Ed.label=xd);Tc.Xx(Ed);Hc.dw(Tc)}Nb.Nt(Hc)}u1o(){return v.a.yta()&&this.kc.ofp&&!this.kc.vka}}Object(m.a)(fk,"InsightsResultsProvider",null,[1399]);var km=d(1729);class gk{constructor(nb){this.kc=nb}oN(){return"Learning"}bX(){return 0===this.kc.iw?0:1===this.kc.iw?1:2}WJ(nb,Nb,ec,Hc,Tc=null){ec=new x.a(nb);Tc&&!Array.contains(Tc,21)||!v.a.wU(nb)||(Tc=[],Hc=this.kc.tvn,Tc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",
Hc)),Hc=gk.hrm(Hc),Tc.push(appChrome.actions.setControlLabel("LearningForSearch",Hc)),appChrome.api.dispatch(Tc),nb=new w.a("LearningForSearch",22,nb.Wg,null,1),Tc=new z.a(21),Tc.Xx(nb),ec.dw(Tc));Nb.Nt(ec)}static hrm(nb){const Nb=[];Array.add(Nb,new km.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Nb,new km.a(400,CommonUIStrings.l_TellMeLearningButtonText));Array.add(Nb,new km.a(600,nb));Array.add(Nb,new km.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));nb={};nb.parts=
Nb;return JSON.stringify(nb)}}Object(m.a)(gk,"LearningProvider",null,[1399]);var Ij=d(603);class Wl{constructor(nb,Nb){this.e8b=this.$ac=this.Yjb=this.xGd=null;this.Gy=!1;this.O8b=nb;this.Cqk=Nb;nb&&this.dli(nb)}XCe(){this.O8b.XCe()&&this.dli(this.O8b)}lNf(nb){let Nb=[];var ec=[];nb=Wl.wOn(nb);var Hc="";Array.clear(ec);for(let Tc=0;Tc<nb.length;Tc++){const xd=nb.charAt(Tc);-1!==" ".indexOf(xd)?(Hc.length&&Array.add(ec,Hc),Hc=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(xd)?(Hc.length&&Array.add(ec,
Hc),Hc=xd,Array.add(ec,Hc),Hc=""):Hc+=xd}Hc.length&&Array.add(ec,Hc);for(nb=0;nb<ec.length;nb++)Hc=this.Ejm(ec[nb]),Hc=this.ozl(Hc),Nb=Wl.qIn(Nb,Hc);return Nb=this.tWk(Nb)}cZf(){this.Gy||this.XCe();return this.Gy}NYd(nb){return this.xGd[nb.toString()]}tWk(nb){for(let Nb=0;Nb<nb.length;Nb++){const ec=this.Yjb[Nb];if(nb[Nb].commandId!==this.NYd(ec[0]))throw Error.create("Incorrect Tcid orders with Priors data");let Hc;(Hc=nb[Nb]).score=Hc.score+ec[1]}return nb}ozl(nb){const Nb=[];for(var ec=0;ec<this.Yjb.length;ec++)Nb.push(new Tj.a(this.NYd(this.Yjb[ec][0]),
-5));ec=new Ij.a;for(var Hc=0;Hc<nb.length;Hc++)ec.add(this.NYd(nb[Hc][0]));for(Hc=0;Hc<Nb.length;Hc++){const xd=Nb[Hc];for(let ld=0;ld<nb.length;ld++){var Tc=nb[ld];const Ed=this.NYd(Tc[0]);Tc=Tc[1];if(Ed===xd.commandId){xd.score=Tc;ec.remove(Ed);break}}if(!ec.count)break}return Nb}Ejm(nb){const Nb=1>nb.length;for(let ld=0;2>=ld;ld++){const Ed=this.e8b;for(const Zd in Ed){var ec=Ed[Zd],Hc=nb,Tc=Zd;const If=Tc.length+1,qg=Array((Hc.length+1)*If);for(var xd=0;xd<=Hc.length;xd++)qg[xd*If]=xd;for(xd=
0;xd<=Tc.length;xd++)qg[xd]=xd;for(xd=0;xd<Tc.length;xd++)for(let ch=0;ch<Hc.length;ch++)qg[(ch+1)*If+(xd+1)]=Hc.charAt(ch)===Tc.charAt(xd)?qg[ch*If+xd]:Math.min(Math.min(qg[ch*If+(xd+1)]+1,qg[(ch+1)*If+xd]+1),qg[ch*If+xd]+1);Hc=qg[Hc.length*If+Tc.length];if((!Hc||!Nb)&&Hc<=ld)return ec}}return this.$ac}dli(nb){this.xGd=nb.CKf();this.Yjb=nb.fEm();this.$ac=nb.iNm();this.e8b=nb.Jum();if(this.Gy=!!this.xGd&&!!this.Yjb&&!!this.e8b&&!!this.$ac)this.Gy=0<this.Yjb.length&&Wl.jWf(this.Yjb);this.Gy&&(this.Gy=
0<this.$ac.length&&Wl.jWf(this.$ac));this.Gy&&(this.e8b=Wl.YNm(this.e8b));this.Gy||(this.e8b=this.$ac=this.Yjb=this.xGd=null)}pMm(nb){nb=this.lNf(nb);return this.l5l(nb,this.Cqk)}l5l(nb,Nb){let ec=[];for(let Hc=0;Hc<nb.length;Hc++)nb[Hc].score>=Nb&&ec.push(nb[Hc]);ec.sort((Hc,Tc)=>Hc.score<Tc.score?1:Hc.score>Tc.score?-1:0);0<ec.length-10&&(ec=ec.slice(0,10));return ec}static qIn(nb,Nb){if(!nb.length)return Nb;if(nb.length!==Nb.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");
for(let ec=0;ec<nb.length;ec++){if(nb[ec].commandId!==Nb[ec].commandId)throw Error.create("Incorrect CommandId");let Hc;(Hc=nb[ec]).score=Hc.score+Nb[ec].score}return nb}static wOn(nb){return Pf.a.vh(nb)}static jWf(nb){for(let Nb=0;Nb<nb.length;Nb++)if(2!==nb[Nb].length)return!1;return!0}static YNm(nb){const Nb={};for(const Tc in nb){var ec=Tc,Hc=nb[Tc];const xd=Hc;xd.length&&Wl.jWf(xd)&&(Nb[ec]=Hc)}return Nb}}Object(m.a)(Wl,"NaiveBayesClassifierModel",null,[]);class lm{constructor(nb,Nb){this.lwa=
null;this.kc=nb;this.WKc=new Wl(Nb,nb.dym);this.kc.fKb&&(this.lwa=null)}oN(){return"NBCommand"}bX(){return 0===this.kc.iw?0:1===this.kc.iw?1:2}WJ(nb,Nb,ec=!1,Hc=f.a.ou,Tc=null){const xd=new x.a(nb);if((!Tc||Array.contains(Tc,0))&&!v.a.wU(nb)){if(ug.CommandResultsUtility.DWf(nb.Wg)&&(Tc=ug.CommandResultsUtility.Xti(nb.Wg),0<Tc.results.length)){Tc.displayName="Classifier Debug";xd.dw(Tc);Nb.Nt(xd);return}if(!this.WKc.cZf()){if(u.TellMeActor.instance.Xe)u.TellMeActor.instance.Xe.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");
throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.kc.fKb&&this.lwa&&this.lwa.initialize();Tc=this.WKc.pMm(nb.Wg);ug.CommandResultsUtility.rhe(Tc,!1,"Classifier","NaiveBayesian");Tc=ug.CommandResultsUtility.J3c(nb,Tc,this.kc,this.lwa,null,null,0,1);0<Tc.results.length&&Hc!==f.a.contextMenu&&(Tc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);ec||Tc.results.length||this.kc.Y2||this.kc.neb||(nb=new w.a("lookupNoResults",14,nb.Wg,null,1),Tc.Xx(nb));0<Tc.results.length&&
xd.dw(Tc)}Nb.Nt(xd)}}Object(m.a)(lm,"NaiveBayesCommandProvider",null,[1399]);class il{constructor(){this.EFb=null;this.Gy=!1;this.XCe()}XCe(){this.Gy||(this.EFb=window.NBCRM)&&4===this.EFb.length&&(this.Gy=!0);return this.Gy}fEm(){return this.Gy?this.EFb[1]:null}iNm(){return this.Gy?this.EFb[2]:null}Jum(){return this.Gy?this.EFb[3][0]:null}CKf(){return this.Gy?this.EFb[0][0]:null}}Object(m.a)(il,"NaiveBayesModelAdapter",null,[1940]);var kn=d(134);class Jl{constructor(nb){this.kc=nb}oN(){return"OfficeScript"}bX(){return 0===
this.kc.iw?0:1===this.kc.iw?1:2}WJ(nb,Nb){const ec=new x.a(nb);if(!v.a.wU(nb)){nb=kn.d(nb.Wg);var Hc=new z.a(28);Hc.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;Hc=this.$Mh(nb,Jl.Qop,"OfficeScriptsUnhideAllRowsCols","samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,Hc);Hc=this.$Mh(nb,Jl.nbm,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,Hc);ec.dw(Hc)}Nb.Nt(ec)}$Mh(nb,Nb,ec,Hc,Tc,xd){const ld=[];for(const Ed of Nb)if(kn.a(nb,Ed)){this.kc.hBa?
(u.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ec,Tc)),u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(ec,Hc))):(ld.push(appChrome.actions.setControlLabel(ec,Tc)),ld.push(appChrome.actions.setButtonCommandValueId(ec,Hc)),appChrome.api.dispatch(ld));xd.Xx(new w.a(ec,28,null,null,1));break}return xd}}Jl.Qop="unhide row rows col cols column columns".split(" ");Jl.nbm=["freeze","selection","pane","panes"];Object(m.a)(Jl,"OfficeScriptsSamplesProvider",
null,[1399]);var Zm=d(75),bl=d(346),$m=d(1478),Tk=d(1429),zm=d(1477),yk=d(29),Kl=d(124),li=d(1359);class Tn{constructor(nb){this.fT=null;this.i5=-1;this.u7f=14;this.x7f=12;this.attributes=this.Iaf=this.query=null;this.hoc=!1;this.c$b=[];this.Gf=xk.AFrameworkApplication.Ee;xk.AFrameworkApplication.J&&(this.u7f=xk.AFrameworkApplication.J.ic("TellMeMaxTermedResults",this.u7f),this.x7f=xk.AFrameworkApplication.J.ic("TellMeMaxZeroTermResults",this.x7f));this.KU=nb}get Wo(){return this.c$b}get CDe(){return this.Iaf}dw(nb){let Nb=
!1;for(let ec=0;ec<this.Wo.length;ec++)if(30!==this.Wo[ec].groupType&&this.Wo[ec].groupType===nb.groupType){this.jef(this.Wo[ec],nb);Nb=!0;break}Nb||this.Wo.push(nb)}jef(nb,Nb){for(let ec=0;ec<Nb.results.length;ec++)nb.Xx(Nb.results[ec])}nBj(nb){const Nb=[];for(const ec of this.Wo)ec.groupType!==nb&&Nb.push(ec);this.Wo.length!==Nb.length&&(this.c$b=Nb)}Qvo(nb){let Nb=null,ec=null,Hc=null;for(let Tc=0;Tc<nb.length;Tc++){const xd=nb[Tc];if(xd&&xd.Wo&&xd.Wo.length)for(const ld of xd.Wo)if(17===ld.groupType||
18===ld.groupType)Nb=ld;else if(0===ld.groupType||16===ld.groupType)ec=ld,Hc=xd}Nb&&ec&&0<ec.results.length&&(17===Nb.groupType&&({Bdf:ec,yef:Nb}=ug.CommandResultsUtility.LUk(ec,Nb,this.KU.rR()?this.KU.rR().Zim:-.6)),Hc.nBj(ec.groupType))}O7o(){this.KU&&(new Zm.a,this.jpd(this.KU.eaj))}j$c(nb,Nb){return this.query.Wg.length>this.KU.rR().OEm&&this.cmn(nb,Nb)||this.query.Wg.length>this.KU.rR().PEm&&this.$on(nb,Nb)?!0:!1}$on(nb,Nb){return nb&&nb.length&&Nb&&Nb.length?-1===Nb.toLowerCase().indexOf(nb.toLowerCase())?
!1:!0:!1}cmn(nb,Nb){return nb&&nb.length&&Nb&&Nb.length?Nb.toLowerCase().startsWith(nb.toLowerCase()):!1}x5l(nb){const Nb=[];for(const ec of this.KU.rR().mS?this.CDe:this.Wo)nb.contains(ec.groupType)||Nb.push(ec);this.KU.rR().mS?this.Iaf=Nb:this.c$b=Nb}kwp(nb,Nb){const ec=[];for(const Hc of this.Wo){const Tc=Hc;if(13!==Tc.groupType||24!==Tc.groupType){const xd=nb[Tk.a[Tc.groupType].toLowerCase()];let ld="False";xd<Nb&&(ld="True");Tc.displayName=Tc.displayName+" ("+ld+": "+xd+")"}ec.push(Tc)}this.c$b=
ec}jpd(nb,Nb=!1,ec=null){if(this.KU.rR().mS){if(!Nb)for(this.Iaf=Array(this.Wo.length),Nb=0;Nb<this.Wo.length;Nb++)this.CDe[Nb]=this.Wo[Nb];this.KU.kaj.jpd(this.Wo,this.CDe,this.query,nb,ec)}else{for(ec=new Zm.a;this.Wo.length;){Nb=this.Wo.pop();const Hc=Tk.a[Nb.groupType].toLowerCase(),Tc=nb[Hc];if(li.c(Tc))throw Error.create("GroupId "+Hc+" missed from group SortingOrder");ec.add(new bl.a(Tc,Nb))}ec.Sc((Hc,Tc)=>Hc.key<Tc.key?-1:1);for(nb=0;nb<ec.count;nb++)Nb=ec.K(nb).value,this.Wo.push(Nb)}}P7o(){var nb=
!1;let Nb=!1,ec=!1;for(let Tc=0;Tc<this.Wo.length;Tc++){var Hc=this.Wo[Tc];const xd=Hc.groupType;if(8===xd||15===xd||14===xd){Hc=Hc.results;for(let ld=0;ld<Hc.length;ld++){if(8===xd&&this.j$c(this.query.Wg,Hc[ld].label)){nb=!0;break}if(15===xd&&this.j$c(this.query.Wg,Hc[ld].label)){Nb=!0;break}if(14===xd){if(this.j$c(this.query.Wg,Hc[ld].label)||this.j$c(this.query.Wg,Hc[ld].description)){ec=!0;break}const Ed=Hc[ld].label.split(" ");for(const Zd of Ed)if(this.j$c(this.query.Wg,Zd)){ec=!0;break}}}}}nb=
this.KU.CGm(nb,Nb,ec);this.jpd(nb)}yWb(nb,Nb,ec,Hc,Tc,xd){if(Tc===this.fT){var ld=nb.data.De;Tc=null;try{Tc=yk.b(ld)}catch(Se){u.TellMeActor.instance.Xe.onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+Se);return}if("RankerResults"in Tc&&Tc.RankerResults){this.oIa();var Ed=Tc.RankerResults,Zd=new Zm.a,If=new Zm.a;ld=0;for(var qg of Ed){Ed=qg.ProviderId;var ch=qg.Score;ld+=ch;Zd.add(new bl.a(Ed,ch))}Zd.Sc((aj,te)=>aj.value>te.value?-1:1);ch=xd?xd.rFi:1E-6;
qg={};Ed={};let Se=0;for(var mk=0;mk<Zd.count;mk++){const aj=parseInt(Zd.K(mk).key),te=Zd.K(mk).value/ld;1===aj&&(Ed.answer=Se++,Ed.entity=Se++,Ed.definition=Se++,Ed.wolframanswer=Se++,te<ch&&(If.add(9),If.add(11),If.add(10),If.add(12)),qg.answer=te,qg.entity=te,qg.definition=te,qg.wolframanswer=te);2===aj&&(Ed.assistance=Se++,te<ch&&If.add(8),qg.assistance=te);3===aj&&(Ed.classifier=Se++,Ed.serviceclassifier=Se++,te<ch&&(If.add(0),If.add(17)),qg.classifier=te,qg.serviceclassifier=te);4===aj&&(Ed.people=
Se++,te<ch&&If.add(14),qg.people=te);5===aj&&(Ed.document=Se++,te<ch&&If.add(15),qg.document=te);6===aj&&(Ed.findindocument=Se++,te<ch&&If.add(2),qg.findindocument=te);7===aj&&(Ed.notes=Se++,te<ch&&If.add(20),qg.notes=te);8===aj&&(Ed.image=Se++,te<ch&&If.add(19),qg.image=te)}Zd=new Zm.a;Zd.add("classifier");Zd.add("serviceclassifier");Zd.add("appsforoffice");Zd.add("addin");Zd.add("findindocument");Zd.add("assistance");Zd.add("document");Zd.add("people");Zd.add("answer");Zd.add("wolframanswer");Zd.add("definition");
Zd.add("entity");Zd.add("image");Zd.add("template");Zd.add("officescript");for(mk=0;mk<Zd.count;mk++)Zd.K(mk)in Ed||(Ed[Zd.K(mk)]=Se++);Ed.learning=Se++;Ed.insights=Se++;Ed.actionai=Se++;Ed.actionaicommand=Se++;Ed.feedback=Se++;xd&&xd.OYi&&this.kwp(qg,ch);xd&&xd.PYi&&this.x5l(If);If={};for(var qj in qg)If[qj]=qg[qj]*ld;this.jpd(Ed,!0,If)}if(xd.Vee&&"Intents"in Tc&&Tc.Intents){qj=Tc.Intents;for(var ne of qj)if(this.I0f(ne)&&"Serplet"===ne.GroupType&&ne.ConfidenceScore>ne.ConfidenceThreshold){qj=!1;
Tc=0;if(xd.Wee){ld=new w.a("",32);for(If=0;If<this.Wo.length;If++)if((Zd=this.Wo[If].results)&&0<Zd.length){Tc=If;ld=Zd[0];break}2===ld.groupType&&(qj=!0)}ld=new z.a(13);qj&&xd.Wee&&(ld=new z.a(13,CommonUIStrings.l_TellMeWebTitle));If=new w.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Wg,null,0);Zd=[];qg=null;qg=v.a.yta()?v.a.oUa(this.query.Wg,1):v.a.qMb(this.query.Wg);Zd.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",qg));qg=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,
this.query.Wg);Zd.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",qg));appChrome.api.dispatch(Zd);ld.Xx(If);If=[];if(qj&&xd.Wee)for(If.push(this.Wo[Tc]),If.push(ld),qj=Tc+1;qj<this.Wo.length;qj++)(Tc=this.Wo[qj].results)&&0<Tc.length&&If.push(this.Wo[qj]);else for(If.push(ld),qj=0;qj<this.Wo.length;qj++)(Tc=this.Wo[qj].results)&&0<Tc.length&&If.push(this.Wo[qj]);this.c$b=If}}if(xd.u$c&&!xd.mS){ne=qj=-1;for(Tc=0;Tc<this.Wo.length;Tc++)switch(this.Wo[Tc].groupType){case 23:qj=
Tc;break;case 0:case 17:case 2:-1===ne&&(ne=Tc)}if(-1!==qj){ne=-1===ne?0:qj>ne?ne+1:ne;qj=this.Wo[qj];Tc=Array(this.Wo.length);ld=0;for(If=0;If<Tc.length;If++)If===ne?Tc[If]=qj:(23===this.Wo[ld].groupType&&ld++,Tc[If]=this.Wo[ld],ld++);this.c$b=Tc}}Hc.Nt(this);Hc=u.TellMeActor.instance.Xe;Hc.Eba(Nb.length,"RankerInference",nb.data.Ie.toString(),Math.round(window.performance.now()-ec),zm.a.lZj,!0,$m.a.tWa);this.hoc&&Hc&&(nb=this.query.Bwb,Nb=Hc.wyd,xd.ofe&&nb>Nb&&!xd.mS&&(Hc.B5f(this.query.Wg),Hc.dyg(nb)))}}I0f(nb){if("GroupType"in
nb&&nb.GroupType&&"ConfidenceScore"in nb&&"ConfidenceThreshold"in nb)return!0;u.TellMeActor.instance.Xe.onError("IsValidIntentGroup","Invalid intents found");return!1}gWb(nb,Nb,ec,Hc,Tc){Hc===this.fT&&(this.oIa(),u.TellMeActor.instance.Xe.Eba(Nb.length,"RankerInference",nb.data.Ie.toString(),Math.round(window.performance.now()-ec),zm.a.lZj,!1,$m.a.tWa));Tc.Nt(this)}oIa(){-1!==this.i5&&(window.clearTimeout(this.i5),this.i5=-1)}Q7o(nb){let Nb;Nb=this.KU.rR().mS?u.TellMeActor.instance.Xe.jNf(this.CDe,
this.query.Wg):u.TellMeActor.instance.Xe.jNf(this.Wo,this.query.Wg);var ec=this.KU.rR().qFi;""!==ec&&(ec="_"+ec);let Hc="";this.KU.rR().Vde&&(Hc="RankerInference"+ec+",");this.KU.rR().Vee&&(Hc+="SerpletClassifier");","===Hc.charAt(Hc.length-1)&&(Hc=Hc.substring(0,Hc.length-1));ec=u.TellMeActor.instance.Xe.eHi(Hc);const Tc=this.fT=Kl.a.create().toString();ec["Client-Request-Id"]=Tc;const xd=window.performance.now(),ld=this.KU.rR()?this.KU.rR().sFi:600;this.oIa();this.i5=window.setTimeout(()=>{if(Tc===
this.fT){this.fT="";this.i5=-1;nb.Nt(this);const Ed={};Ed[a.a.provider]="Ranker";Ed[a.a.WXb]=this.query.Bwb;u.TellMeActor.instance.Xe.$B(l.a.IHg,ld,Ed)}},ld);this.Gf.Wj(u.TellMeActor.instance.Xe.fHi(),2,Nb,ec,!1,0,Ed=>{this.yWb(Ed,this.query.Wg,xd,nb,Tc,this.KU.rR())},Ed=>{this.gWb(Ed,this.query.Wg,xd,Tc,nb)},null,null,!1,4E3,6E3)}Zkp(){var nb=0,Nb=new Zm.a,ec=this.KU.caj,Hc=this.KU.daj;for(var Tc=0;Tc<this.Wo.length;Tc++){var xd=this.Wo[Tc],ld=Tk.a[xd.groupType].toLowerCase(),Ed=ec[ld];nb+=xd.results.length;
xd.results.length>Ed&&(ld=Hc[ld],li.c(ld)||Nb.add(new bl.a(ld,xd)))}Hc=!this.query||""===this.query.Wg.trim();Tc=nb-(Hc?this.x7f:this.u7f);if(!(0>=Tc)){Hc=window.performance.now();nb=nb.toString()+" total,"+Tc.toString()+" to remove.";if(0<Nb.count)for(Nb.Sc((Zd,If)=>Zd.key>If.key?-1:1),xd=0;xd<Nb.count&&0<Tc;xd++){ld=Nb.K(xd).value;Ed=Tk.a[ld.groupType].toLowerCase();let Zd=ld.results.length-ec[Ed];Zd>Tc&&(Zd=Tc);0<Zd&&(ld.rrg(Zd),nb+=Ed+": "+Zd.toString()+" results removed.",Tc-=Zd)}if(0<Tc){nb+=
Tc.toString()+" results left after trimming.";Nb=new Zm.a;ec=this.KU.haj;for(xd=0;xd<this.Wo.length;xd++)ld=this.Wo[xd],Ed=ec[Tk.a[ld.groupType].toLowerCase()],li.c(Ed)||Nb.add(new bl.a(Ed,ld));Nb.Sc((Zd,If)=>Zd.key<If.key?-1:1);for(ec=0;0<Tc;)xd=Nb.K(ec++).value,Tc>=xd.results.length?(Array.remove(this.Wo,xd),nb+=Tk.a[xd.groupType]+": "+xd.results.length.toString()+" results force removed.",Tc-=xd.results.length):(xd.rrg(Tc),nb+=Tk.a[xd.groupType]+": "+Tc.toString()+" results force removed.",Tc=
0)}u.TellMeActor.instance.Xe&&(Nb={},Nb[a.a.message]=nb,u.TellMeActor.instance.Xe.$B("ShowOptimal",window.performance.now()-Hc,Nb))}}}Object(m.a)(Tn,"CombineResultsUpdatedEventArgs",null,[1898]);class Uk{constructor(nb,Nb,ec,Hc=!1,Tc=""){this.T2e=this.I5e=!1;this.uw=nb;this.qHb=[];this.uzh=Nb.length;this.kc=u.TellMeActor.instance.rR();this.zEd=Hc;this.kja=Tc;this.tac={};for(nb=0;nb<Nb.length;++nb)this.tac[nb.toString()]=ec?0:Nb[nb].bX()}NUo(nb,Nb){Nb&&Nb.query&&Nb.query.Bwb<u.TellMeActor.instance.Vxa||
(this.qHb[nb]=Nb,this.T2e?this.I5e=!0:(!this.kc||3!==this.kc.iw||3!==this.tac[nb.toString()]||this.wei())&&this.gSb())}I7n(){this.T2e=!0}jpp(){this.T2e=!1;this.I5e&&(this.I5e=!1,this.gSb())}wei(){if(this.qHb.length<this.uzh)return!1;for(let nb=0;nb<this.uzh;++nb)if(!this.qHb[nb])return!1;return!0}gSb(){var nb=this.wei();const Nb=window.performance.now(),ec=new Tn(u.TellMeActor.instance.Rih);ec.Qvo(this.qHb);for(var Hc=0;Hc<this.qHb.length;++Hc){var Tc=this.qHb[Hc];if(Tc&&Tc.Wo&&Tc.Wo.length&&(ec.query=
Tc.query,Tc.attributes&&0<Tc.attributes.length&&(ec.attributes=Tc.attributes),Tc&&Tc.Wo&&(nb||this.Hnl(Hc,this.qHb))))for(const xd of Tc.Wo)ec.dw(xd)}ec.Wo&&ec.Wo.length&&(ec.hoc=nb,this.kc&&this.kc.JCe&&ec.Zkp(),this.kc&&this.kc.snn&&ec.query.Wg&&0<ec.query.Wg.length?ec.P7o():ec.O7o(),this.kc&&(this.kc.Vde||this.kc.Vee)&&this.zEd&&ec.query.Wg&&0<ec.query.Wg.length&&ec.hoc&&this.kja!==f.a.contextMenu?(3===this.kc.iw&&nb||this.uw.Nt(ec),ec.Q7o(this.uw)):this.uw.Nt(ec),nb=u.TellMeActor.instance.Xe,
ec.hoc&&nb&&(Hc=ec.query.Bwb,Tc=nb.wyd,ec.query.Wg&&0<ec.query.Wg.length&&this.zEd&&this.kc.ofe&&this.kja!==f.a.contextMenu&&Hc>Tc&&!this.kc.Vde&&!this.kc.mS&&(nb.B5f(ec.query.Wg),nb.dyg(Hc)),nb.$B(l.a.wEo,window.performance.now()-Nb)))}Hnl(nb,Nb){if(!(this.tac&&nb.toString()in this.tac)||Nb.length<=nb||!Nb[nb])return!1;if(!Nb[nb].Wo.length)return!0;const ec=this.tac[nb.toString()];if(0===ec)return!0;const Hc=this.tac;for(const xd in Hc){var Tc=Hc[xd];const ld=Number.parseInvariant(xd);if(ld!==nb&&
Tc===ec&&!(Nb.length>ld&&Nb[ld]))return!1}return!0}}Object(m.a)(Uk,"ResultsAggregator",null,[]);var zk=d(1769);class Ik{constructor(){this.gzc=this.hzc=this.fzc=this.mbd=this.rqc=this.Dmc=0}sUk(nb,Nb){switch(nb){case 1:this.Dmc=Nb;break;case 3:this.rqc=Nb;break;case 2:this.mbd=Nb;break;case 5:this.fzc=Nb;break;case 4:this.hzc=Nb;break;case 6:this.gzc=Nb}}}Object(m.a)(Ik,"CommandFeatures",null,[]);class ig{constructor(nb){this.hgh=0;this.uGa=nb;this.Nok={}}get modelId(){return this.uGa}get G3l(){return this.hgh}get eVc(){return this.Nok}lTk(nb,
Nb,ec){0===Nb?this.hgh=ec:(this.eVc[nb]||(this.eVc[nb]=new Ik),this.eVc[nb].sUk(Nb,ec))}}Object(m.a)(ig,"CoefficientsModel",null,[]);const ul=(nb,Nb)=>Math.pow(10,-Nb/(60*Math.LN10/Math.LN2*nb));class pe{constructor(nb,Nb){this.Kk=1;this.mtk=new Ik;this.features.mbd=1+Math.log(this.count)/Math.LN2;this.features.Dmc=nb?1/nb:0;this.features.rqc=2/Math.pow(2,nb);this.features.fzc=ul(10,Nb);this.features.hzc=ul(2,Nb);this.features.gzc=ul(1,Nb)}get count(){return this.Kk}get features(){return this.mtk}lPi(){this.Kk=
this.count+1;this.features.mbd=1+Math.log(this.count)/Math.LN2}$vp(nb){const Nb=2/Math.pow(2,nb);this.features.Dmc=Math.max(this.features.Dmc,nb?1/nb:0);this.features.rqc=Math.max(this.features.rqc,Nb)}xxp(nb){const Nb=ul(10,nb),ec=ul(2,nb);nb=ul(1,nb);this.features.fzc=Math.max(this.features.fzc,Nb);this.features.hzc=Math.max(this.features.hzc,ec);this.features.gzc=Math.max(this.features.gzc,nb)}}Object(m.a)(pe,"CommandModel",null,[]);class Ln{constructor(nb){this.WDc=null;if(!nb&&u.TellMeActor.instance.Xe)u.TellMeActor.instance.Xe.onError("PredictionEngine",
"IModelAdapter can't be null");this.O8b=nb;this.wGd=this.x4f()}x4f(){const nb=this.O8b.yxm(),Nb=this.O8b.CKf();if(void 0===nb||null===nb||void 0===Nb||null===Nb)return!1;try{window.performance.now();this.WDc={};for(let ec=0;ec<nb.length;ec++){const Hc=nb[ec],Tc=Nb[Hc[0].toString()].trim(),xd=Hc[1],ld=0!==xd?Nb[Hc[2].toString()].trim():"",Ed=Hc[3];Tc in this.WDc||(this.WDc[Tc]=new ig(Tc));this.WDc[Tc].lTk(ld,xd,Ed)}}catch(ec){if(u.TellMeActor.instance.Xe)u.TellMeActor.instance.Xe.onError("LoadModelData",
"Error Loading Suggestions Model: "+ec);return!1}return!0}qcm(){const nb=this.O8b.Ztm(),Nb={};if(!nb)return Nb;let ec=1;for(let Hc=0;Hc<nb.length;Hc++){const Tc=nb[Hc];Tc.Id in Nb?(Nb[Tc.Id].lPi(),Nb[Tc.Id].$vp(ec),Nb[Tc.Id].xxp(Tc.TimeElapsedSinceClick)):Nb[Tc.Id]=new pe(ec,Tc.TimeElapsedSinceClick);ec++}return Nb}cZf(){this.wGd||(this.wGd=this.x4f());return this.wGd}sDm(){let nb=[];if(!this.wGd){if(u.TellMeActor.instance.Xe)u.TellMeActor.instance.Xe.onError("GetPredictedCommands","IModelAdapter returned no data");
return nb}const Nb=this.qcm(),ec=this.WDc;for(const Tc in ec){const xd=ec[Tc],ld=xd.modelId;let Ed=0;for(const Zd in Nb){var Hc=Zd;const If=Nb[Zd].features;(Hc=Hc in xd.eVc?xd.eVc[Hc]:null)&&(Ed+=If.Dmc*Hc.Dmc+If.rqc*Hc.rqc+If.mbd*Hc.mbd+If.fzc*Hc.fzc+If.hzc*Hc.hzc+If.gzc*Hc.gzc)}Ed+=xd.G3l;nb.push(new Tj.a(ld,Ed))}nb.sort((Tc,xd)=>Tc.score<xd.score?1:Tc.score>xd.score?-1:0);0<nb.length-10&&(nb=nb.slice(0,10));return nb}}Object(m.a)(Ln,"PredictionEngine",null,[]);class $h{constructor(){this.yCh={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),
"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),
"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),
"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),
"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}D4d(nb,Nb){return Nb&&"word"===Nb.application.toLowerCase()&&
nb in this.yCh?this.yCh[nb]:[]}}Object(m.a)($h,"SuggestionResultsUtility",null,[]);class ll{constructor(nb,Nb,ec){this.kc=Nb;this.WKc=new Ln(nb);this.F5=ec;this.rFh=new $h}oN(){return"Suggestion"}bX(){return 0===this.kc.iw?0:1===this.kc.iw?1:2}WJ(nb,Nb,ec,Hc=f.a.ou,Tc=null){ec=new x.a(nb);u.TellMeActor.instance.btd=!1;if((!Tc||Array.contains(Tc,16))&&v.a.wU(nb)){if(!this.WKc.cZf()){if(u.TellMeActor.instance.Xe)u.TellMeActor.instance.Xe.onError("CRASH","SuggestionResultsProvider: Found invalid Model data");
throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();if(this.Nee()&&0<this.rFh.D4d(u.TellMeActor.instance.xYd,this.kc).length){const ld=this.rFh.D4d(u.TellMeActor.instance.xYd,this.kc);Tc=[];for(var xd of ld)this.kc.mye&&"Find"===xd||Tc.push(new Tj.a(xd,0));u.TellMeActor.instance.btd=!0}else Tc=this.WKc.sDm();ug.CommandResultsUtility.rhe(Tc,!0,"Recommended","LRE");xd=[];for(const ld of Tc)this.F5&&this.F5.pqf(ld.commandId)||xd.push(ld);nb=ug.CommandResultsUtility.J3c(nb,
xd,this.kc,null,null,null,16,1);0<nb.results.length&&Hc!==f.a.contextMenu&&(nb.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<nb.results.length&&ec.dw(nb)}Nb.Nt(ec)}Nee(){return!!this.kc&&(this.kc.Nee||this.kc.Nrn)}}Object(m.a)(ll,"SuggestionResultsProvider",null,[1399]);class zf{Ztm(){return u.TellMeActor.instance.pMe}yxm(){return window.TellMeSuggestionModel}CKf(){return window.CoefficientModelIdMap}}Object(m.a)(zf,"SuggestionsModelAdapter",null,[1939]);var af=d(1780),Eg=d(1732);d.d(L,"AggregatorResultsProvider",
function(){return Ag});class Ag{constructor(nb=!1){this.Q9b={};this.Q9b[f.a.ou]=[];this.Q9b[f.a.contextMenu]=[];this.zEd=nb}a3i(nb,Nb,ec,Hc,Tc=null){let xd;var ld=!1;switch(Hc){case f.a.contextMenu:xd=this.Q9b[f.a.contextMenu];ld=!0;break;default:xd=this.Q9b[f.a.ou]}Nb=new Uk(Nb,xd,ld,this.zEd,Hc);Nb.I7n();for(let Ed=0;Ed<xd.length;++Ed){const Zd=window.performance.now(),If=new I(Nb,Ed);(ld=u.TellMeActor.instance.rR())&&ld.ucl?window.setTimeout(()=>{xd[Ed].WJ(nb,If,ec,Hc,Tc);if(u.TellMeActor.instance.Xe){const qg=
{};qg[a.a.provider]=xd[Ed].oN();qg[a.a.WXb]=nb.Bwb;u.TellMeActor.instance.Xe.$B(l.a.WJ,window.performance.now()-Zd,qg)}},0):(xd[Ed].WJ(nb,If,ec,Hc,Tc),u.TellMeActor.instance.Xe&&(ld={},ld[a.a.provider]=xd[Ed].oN(),ld[a.a.WXb]=nb.Bwb,u.TellMeActor.instance.Xe.$B(l.a.WJ,window.performance.now()-Zd,ld)))}Nb.jpp()}oN(){return"Aggregator"}bX(){return 0}WJ(nb,Nb,ec=!1,Hc=f.a.ou,Tc=null){if(u.TellMeActor.instance.oKn)this.a3i(nb,Nb,ec,Hc,Tc);else{const xd=window.performance.now();u.TellMeActor.instance.tCp.then(()=>
{u.TellMeActor.instance.Xe&&u.TellMeActor.instance.Xe.$B(l.a.pKn,window.performance.now()-xd);this.a3i(nb,Nb,ec,Hc,Tc);return!0})}}DG(nb,Nb){this.Q9b[Nb].push(nb)}tVk(nb){switch(nb){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Nb=this.Q9b[f.a.ou];for(const ec of Nb)if("FindInDocument"===ec.oN()){ec.PSo(nb);break}}}static createInstance(nb,Nb,ec,Hc){const Tc=Nb.vka;var xd=Hc&&v.a.TAg(Nb),ld=xd&&Nb.Kgg&&!Tc;const Ed=Nb.p0f&&!v.a.Doc()&&!Tc,Zd=Nb.tZf&&
!Tc,If=new Ag(xd);if(Nb.v1o&&!Tc){var qg=new gk(Nb);If.DG(qg,f.a.ou)}qg=Nb.As?xk.AFrameworkApplication.J.$("TellMeIsSuggestionsForSimplifiedUxEnabled"):xk.AFrameworkApplication.J.$("TellMeSuggestionsIsEnabled");const ch=!qg&&xk.AFrameworkApplication.J.$("TellMeFirstRunExperienceIsEnabled");If.DG(new Oi.a(nb,Nb.enp,ch,!1),f.a.ou);qg&&!Tc&&If.DG(new ll(new zf,Nb,nb),f.a.ou);nb=xk.AFrameworkApplication.ua.Ib.A1i?new lm(Nb,new il):new ff(Nb,ec);If.DG(nb,f.a.contextMenu);(xd&&Nb.Lgg||ld)&&If.DG(af.a.K$h(Nb,
!0),f.a.ou);If.DG(nb,f.a.ou);!Nb.Qmi||Tc||"Word"===Nb.application&&Nb.j2d||If.DG(new Yh(Nb),f.a.ou);Nb.fKb&&!Tc&&(ld=new F(Nb),If.DG(ld,f.a.ou),If.DG(ld,f.a.contextMenu));!Nb.hKb||Nb.nod||Nb.lod||Tc||If.DG(new C.a(Nb),f.a.ou);Hc&&(Nb.Y2||v.a.yta())&&(ld=new fk(Nb),If.DG(ld,f.a.ou),If.DG(ld,f.a.contextMenu));xd&&If.DG(af.a.K$h(Nb,!1),f.a.ou);Hc&&!Nb.fFg&&v.a.SAg(Nb)&&!Tc&&(If.DG(new zk.a(Nb),f.a.ou),Nb.xXj&&If.DG(new zk.a(Nb),f.a.contextMenu));Ed&&If.DG(new Ph(Nb),f.a.ou);!Nb.Zwc&&!Nb.mS||Tc||If.DG(new Qh.a(Nb),
f.a.ou);Nb.u$c&&!Tc&&If.DG(new Eg.a(Nb),f.a.ou);Nb.YVf&&(xd=new y(Nb),If.DG(xd,f.a.ou),If.DG(xd,f.a.contextMenu));Hc&&Nb.bce&&!Tc&&If.DG(new H.AddinResultsProvider(Nb),f.a.ou);Zd&&"Excel"===Nb.application&&!Tc&&If.DG(new Jl(Nb),f.a.ou);return If}}Object(m.a)(Ag,"AggregatorResultsProvider",null,[1399])},1764:function(J,L,d){J=d(0);var m=d(59),f=d(14),a=d(5),l=d(175),w=d(221),z=d(356);d(48);var x=d(83);d(866);d(867);var u=d(473);d(474);var v=d(1720),E=d(1721),y=d(1717),H=d(1719),I=d(1718);d(865);d(864);
class F{constructor(Y,ca,ia){this.Ibm=Y;this.F$k=ca;this.yll=ia}}Object(J.a)(F,"BacktraceAndMakeUpdateHintsInput",null,[]);var C=d(1459),P;(function(Y){Y[Y.QJp=0]="EOP";Y[Y.character=1]="character";Y[Y.XVp=2]="embeddedMarker"})(P||(P={}));Object(J.b)("LCSBlockType",P);class K{toString(){return String.format("[Type: {0}]",P[this.type])}}Object(J.a)(K,"ALCSBlock",null,[]);class G extends K{constructor(Y,ca){super();this.wLe=ca;this.D2e=Y}get type(){return 1}get character(){return this.wLe}get UYa(){return this.D2e}VB(Y){return 1===
Y.type&&C.a.FSh(Y.character,this.character)}toString(){return String.format("{0} [Char: {1}]",super.toString(),this.character)}}Object(J.a)(G,"CharacterLCSBlock",K,[]);class R extends K{constructor(Y,ca,ia){super();this.D2e=Y;this.dcf=ca;this.iG=ia}get type(){return 0}get Yc(){return this.dcf}get length(){return this.iG}get UYa(){return this.D2e}VB(Y){return 0!==Y.type?!1:Y.UYa===this.UYa&&Y.Yc===this.Yc}toString(){return String.format("{0} [ParaId: {1}] [WordId: {2}] [Length: {3}]",super.toString(),
this.UYa.toString(),this.Yc,this.length)}}Object(J.a)(R,"EOPLCSBlock",K,[]);class W extends G{constructor(Y,ca,ia){super(Y,"\ufffc");this.fCk=ca;this.cBd=ia}get type(){return 2}get le(){return this.fCk}get Ek(){return this.cBd}VB(Y){return 2!==Y.type?!1:Y.le===this.le&&this.Ek.equals(Y.Ek)}toString(){return String.format("{0} [Marker: {1}] [FId: {2}]",super.toString(),this.le,this.Ek)}}Object(J.a)(W,"EmbeddedMarkerLCSBlock",G,[]);class Z{constructor(Y,ca){this.x=Y;this.y=ca}equals(Y){return Y.x===
this.x&&Y.y===this.y}toString(){return"("+this.x+", "+this.y+")"}}Object(J.a)(Z,"IntPair",null,[1321]);var T=d(1517),N=d(1484),U=d(1519),ba=d(1716);d.d(L,"a",function(){return X});class X{constructor(Y,ca){this.vg=Y;this.ee=ca}U$h(Y,ca,ia,la,ta,za,Ha){return this.QIl(Y,ca,ia,la,ta,za,Ha)}QIl(Y,ca,ia,la,ta,za,Ha){let Na;Na=null;({returnValue:Y}=this.p6d(Y,ca));if(!Y)return l.a.instance.Ua(575706449,1,2,"Failed to get LCS blocks from objects for base"),this.ee.logger.EX("GetLCSBlocksFromObject"),{returnValue:!1,
lK:Na};({returnValue:ia}=this.p6d(ia,la));if(!ia)return l.a.instance.Ua(575706450,1,2,"Failed to get LCS blocks from objects for changed"),this.ee.logger.EX("GetLCSBlocksFromObject"),{returnValue:!1,lK:Na};this.ee.logger.EX("GetLCSBlocksFromObject");Na=this.PIl(Y,ia,ta,za,Ha);return Na?{returnValue:!0,lK:Na}:(l.a.instance.Ua(575706451,1,2,"Failed to Create UpdateHints"),{returnValue:!1,lK:Na})}Fmi(Y,ca,ia,la){({returnValue:Y}=this.p6d(Y,ca));if(!Y)return-1;({returnValue:ia}=this.p6d(ia,la));if(!ia)return-1;
({Buf:ia}=this.Jmi(Y,ia));return ia}p6d(Y,ca){let ia;const la=new w.a;ia=new w.a;if(!Y.length)return l.a.instance.Ua(594124833,1,2,"Abandoning LCS due to empty list of paragraphs"),this.ee.logger.Pi(Object.assign(new T.a,{$j:"GetLCSBlocksFromObject",eventId:"900a7"})),{returnValue:null,sAf:ia};for(let Ha=0;Ha<Y.length;Ha++)if(this.ee.runtime.$I("GetLCSBlocksFromObject: paraObjs#"+Ha),Y.K(Ha).wc===m.a.paragraphNode){const Na=this.vg.getPropertyString(Y.K(Ha),f.a.Pn),ya=this.vg.getPropertyUint32(Y.K(Ha),
a.a.Yc);if(null==ya)return l.a.instance.Ua(594124835,1,2,"Abandoning LCS due to missing WordId"),this.ee.logger.Pi(Object.assign(new T.a,{$j:"GetLCSBlocksFromObject",eventId:"900a9"})),{returnValue:null,sAf:ia};let ma=this.vg.getPropertyUint32s(Y.K(Ha),f.a.vn);ma=N.a.NNj(ma,Na.length);const Ea=this.vg.getPropertyObjectIds(Y.K(Ha),f.a.Qn);let Ba;for(Ba=0;Ba<ma.length-1;Ba++){var ta=ca(Ea.sg(Ba)),za=void 0;za=ta?(za=this.vg.getPropertyBool(ta,f.a.Eca))?za:!1:!1;if(za)la.add(this.bDl(Y.K(Ha).id,ta));
else for(ta=ma.sg(Ba);ta<ma.sg(Ba+1);ta++)la.add(new G(Y.K(Ha).id,C.a.charAt(Na,ta)))}la.add(new R(Y.K(Ha).id,ya,ma.K(Ba)));ia.add(la.length-1)}else return l.a.instance.Ua(594124864,1,2,"Abandoning LCS due to presence of non-paragraph object of type {0}",Y.K(Ha).wc),this.ee.logger.Pi(Object.assign(new T.a,{$j:"GetLCSBlocksFromObject",eventId:"900ba"})),{returnValue:null,sAf:ia};this.ee.runtime.$I("LCS: GetLCSBlocks for base");return{returnValue:la,sAf:ia}}bDl(Y,ca){const ia=null==this.vg.getPropertyInt32(ca,
a.a.ft)?0:this.vg.getPropertyInt32(ca,a.a.ft);return new W(Y,ia,ca.id)}PIl(Y,ca,ia,la,ta){la=({Buf:ia}=this.Jmi(Y,ca,ia,la,ta)).returnValue;this.ee.logger.EX("FindFurthestPaths");Y=new F(la,Y,ca);Y=new ba.a(this.u$k(Y,ia),1);this.ee.logger.EX("BacktraceAndMakeUpdateHints");return Y}Jmi(Y,ca,ia=-1,la=-1,ta=-1){let za;if(-1===ia||-1===la||-1===ta)ta=la=ia=-1;za=-1;const Ha=new z.a;Ha.Z(new Z(-1,1),new Z(0,-1));if(-1!==ia){Ha.Z(new Z(0,0),new Z(ia,ia));var Na=1}else Na=0,la=Y.length,ta=ca.length;for(ia=
0;Na<=Y.length+ca.length;Na++){let ya=!1;for(let ma=-Na;ma<=Na;ma+=2){let Ea,Ba;ma===-Na?(Ea=Ha.K(new Z(Na-1,ma+1)).x,Ba=Ha.K(new Z(Na-1,ma+1)).y+1):ma===Na?(Ea=Ha.K(new Z(Na-1,ma-1)).x+1,Ba=Ha.K(new Z(Na-1,ma-1)).y):Ha.K(new Z(Na-1,ma-1)).x>=Ha.K(new Z(Na-1,ma+1)).x?(Ea=Ha.K(new Z(Na-1,ma-1)).x+1,Ba=Ha.K(new Z(Na-1,ma-1)).y):(Ea=Ha.K(new Z(Na-1,ma+1)).x,Ba=Ha.K(new Z(Na-1,ma+1)).y+1);for(;Ea<la&&Ba<ta&&Y.K(Ea).VB(ca.K(Ba));)Ea++,Ba++;Ha.Z(new Z(Na,ma),new Z(Ea,Ba));if(Ea===la&&Ba===ta){ya=!0;za=
Na;ia=ma;break}}if(ya)break;this.ee.runtime.$I("LCS FindFurthestPaths")}if(ia!==la-ta)return{returnValue:null,Buf:za};Ha.Z(new Z(za,ia),new Z(la+1,ta+1));l.a.instance.Ua(593826837,1,4,"FindFurthestPaths finished. Length of base: {0} Length of changed: {1} Size of diff: {2}",Y.length,ca.length,za);return{returnValue:Ha,Buf:za}}u$k(Y,ca){const ia=Y.Ibm,la=Y.F$k;Y=Y.yll;const ta=new w.a;let za=la.length,Ha=Y.length;for(;0<za||0<Ha;){var Na=za-1,ya=Ha-1;if(this.H7n(ia,ca,za,Ha)){Na=Y.K(ya);if(1===Na.type||
2===Na.type)this.S8m(ta,za,Na);else if(0===Na.type)this.o8m(ta,za,Na);else return l.a.instance.Ua(575706452,1,2,"Abandoning LCS due to unexpected block of type {0}",Na.type),this.ee.logger.Pi(Object.assign(new U.a,{$j:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;Ha--;ca--}else if(this.G7n(ia,ca,za,Ha)){ya=la.K(Na);if(1===ya.type||2===ya.type)this.FOl(ta,Na,ya);else if(0===ya.type)this.lOl(ta,Na,ya);else return l.a.instance.Ua(575706453,1,2,"Abandoning LCS due to unexpected block of type {0}",
ya.type),this.ee.logger.Pi(Object.assign(new U.a,{$j:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;za--;ca--}else if(za&&Ha&&la.K(Na).VB(Y.K(ya)))za--,Ha--;else return l.a.instance.Ua(575706454,1,2,"Abandoning LCS due to being unable to find a path"),this.ee.logger.Pi(Object.assign(new U.a,{$j:"BacktraceAndMakeUpdateHints",eventId:"0"})),null}this.ee.runtime.$I("LCS: CreateUpdateHintsFromLCSBlocks");return ta}G7n(Y,ca,ia,la){ca=new Z(ca-1,ia-la-1);return Y.lb(ca)&&Y.K(ca).x===ia-1&&
Y.K(ca).y===la}H7n(Y,ca,ia,la){ca=new Z(ca-1,ia-la+1);return Y.lb(ca)&&Y.K(ca).x===ia&&Y.K(ca).y===la-1}o8m(Y,ca,ia){ia=new y.a(ia.UYa,ia.Yc);let la=!1;if(0<Y.length&&11===Y.sg(Y.length-1).type){const ta=Y.sg(Y.length-1);ta.cp===ca&&(la=!0,ta.W2.add(ia))}la||(ca=new I.a(ca),ca.W2.add(ia),Y.add(ca))}S8m(Y,ca,ia){var la=!1;if(0<Y.length&&11===Y.sg(Y.length-1).type){const ta=Y.sg(Y.length-1);ta.cp===ca&&((la=Object(x.a)(H.a,ta.W2.K(ta.W2.length-1)))?la.text=ia.character.toString()+la.text:ta.W2.add(new H.a(ia.UYa,
ia.character.toString())),la=!0)}la||(ca=new I.a(ca),ca.W2.add(new H.a(ia.UYa,ia.character.toString())),Y.add(ca))}lOl(Y,ca,ia){ca=new v.a(ca,ia.UYa,ia.Yc);Y.add(ca)}bYc(Y,ca){let ia=!1;if(0<Y.lK.length&&2===Y.lK.sg(Y.lK.length-1).type){const la=Y.lK.sg(Y.lK.length-1);la.Og.equals(ca.UYa)&&la.cp===ca.woe&&(la.cp=ca.woe-1,la.text=(void 0).character.toString()+la.text,ia=!0)}ia||Y.lK.add(new u.a(ca.UYa,ca.woe-1,(void 0).character.toString()));--ca.woe}FOl(Y,ca,ia){let la=!1;if(0<Y.length&&8===Y.sg(Y.length-
1).type){const ta=Y.sg(Y.length-1);ta.cp===ca+1&&(ta.text=ia.character.toString()+ta.text,--ta.cp,la=!0)}la||Y.add(new E.a(ca,ia.character.toString()))}}Object(J.a)(X,"LCSUpdateHintGenerator",null,[])},1768:function(J,L,d){d.r(L);J=d(0);var m=d(59),f=d(14),a=d(5),l=d(175),w=d(356),z=d(602),x=d(221),u=d(48),v=d(108),E=d(1440);class y extends E.a{constructor(){super()}get Xea(){return"ChildNodeListMerge"}}Object(J.a)(y,"ChildNodeListMergeFailureDetail",E.a,[]);class H{Qzb(ba,X,Y){return X.Q2(ba,Y.K(ba))}b2j(ba,
X,Y,ca){let ia;return({value:ia}=X.Ac(ba)).returnValue||({value:ia}=Y.Ac(ba)).returnValue?ia:ca.K(ba)}}Object(J.a)(H,"ChildNodeListMergeUtils",null,[1438]);var I=d(1518),F=d(1783),C=d(1582);class P{constructor(ba,X){this.classId=ba;this.Gnp=X}}Object(J.a)(P,"NodeChildrenTransformation",null,[]);var K=d(795),G=d(1464);class R{constructor(ba,X,Y){this.SM=ba;this.zEa=Y;this.fsa=X}qqe(ba){let X,Y;return({Quj:X}=this.g2j(this.zEa,ba)).returnValue&&X.e3||({Quj:Y}=this.g2j(this.fsa,ba)).returnValue&&Y.e3}g2j(ba,
X){let Y;return{returnValue:({value:Y}=(new G.a(this.SM,ba)).WMa.Ac(K.a.zb(X))).returnValue,Quj:Y}}}Object(J.a)(R,"NodeTriplet",null,[]);var W=d(1714);class Z{constructor(ba,X,Y){this.ee=ba;this.vg=X;this.Z5=Y;this.nFh=!0}get hu(){return this.ee}get kf(){return this.vg}get LEa(){return this.Z5}get success(){return this.nFh}xCm(){l.a.instance.Ua(4220310,1,5,"Evaluating ParentObjects");const ba=new w.a;this.nlf(ba,X=>this.hu.runtime.Cn.K(X));this.nlf(ba,X=>this.LEa.Qzb(X,this.hu.runtime.IA,this.hu.runtime.Cn));
this.nlf(ba,X=>this.LEa.Qzb(X,this.hu.runtime.uv,this.hu.runtime.Cn));return ba}nlf(ba,X){const Y=X(d(1768).ChildNodeListMerge.hoe);this.kf.getPropertyObjectIds(Y,f.a.pg).forEach(ca=>{this.kf.getPropertyObjectIds(X(ca),f.a.pg).forEach(ia=>{ba.lb(ia)&&!ca.equals(ba.K(ia))&&(this.nFh=!1,l.a.instance.Ua(4220311,1,1,"OutlineGroup {0} should have parent {1} but instead has a different parent {2}.",ia,ca,ba.K(ia)));ba.Z(ia,ca);return!0});return!0})}}Object(J.a)(Z,"OutlineGroupParentFinder",null,[]);var T=
d(1441),N=d(1723);d.d(L,"ChildNodeListMerge",function(){return U});class U{constructor(ba,X=null,Y=null,ca=null,ia=null){this.vg=ba;this.U5n=X||F.a.A2j;this.oke=Y||this.fzm();this.LEa=ca||new H;this.icj=ia||this.dxm()}get kf(){return this.vg}fzm(){return[new P(m.a.Uh,Object(v.a)(this,this.z4n,"pageContentNodeThreewayChildMerge")),new P(m.a.joa,Object(v.a)(this,this.FGp,"wordSectionNodeThreewayChildMerge")),new P(m.a.hH,Object(v.a)(this,this.Zne,"outlineElementContainerThreewayChildMerge")),new P(m.a.Bca,
Object(v.a)(this,this.ydp,"tableCellThreewayChildMerge")),new P(m.a.Caa,Object(v.a)(this,this.Zne,"outlineElementContainerThreewayChildMerge")),new P(m.a.t5c,Object(v.a)(this,this.Zne,"outlineElementContainerThreewayChildMerge")),new P(m.a.XK,Object(v.a)(this,this.Zne,"outlineElementContainerThreewayChildMerge"))]}dxm(){return[Object(v.a)(this,this.Gbo,"prepareObjectGroupings"),Object(v.a)(this,this.kTm,"handleInterOutlineGroupMerge"),Object(v.a)(this,this.m8n,"performThreewayChildMerge")]}pIn(ba){let X=
0;for(;X<this.icj.length;X++)if(!(0,this.icj[X])(ba))return l.a.instance.Ua(4273296,1,4,"MergeChildNodeLists: Merged failed. [Function: {0}]",X),ba.logger.Che("ChildNodeListMerge.GetMergeChildNodeListsFunctions()",X),!1;return!0}Gbo(ba){const X=new w.a,Y=new w.a,ca=new z.a;ba.runtime.IA.forEach((ia,la)=>U.vqj(la,X));ba.runtime.uv.forEach((ia,la)=>U.vqj(la,Y));for(let ia=0;ia<this.oke.length;ia++){const la=this.oke[ia].classId;ba.runtime.Vub.Z(la,new w.a);X.lb(la)&&X.K(la).forEach(ta=>{var za=ba.runtime.Cn.K(ta.id);
za&&(za=new R(za,ta,ba.runtime.uv.Q2(ta.id,za)),ba.runtime.Vub.K(la).add(ta.id,za),ca.add(ta.id));return!0});Y.lb(la)&&Y.K(la).forEach(ta=>{if(ca.contains(ta.id))return!0;const za=ba.runtime.Cn.K(ta.id);za&&ba.runtime.Vub.K(la).add(ta.id,new R(za,za,ta));return!0})}ba.runtime.$I("PrepareObjectGroupings");ba.logger.bbb("PrepareObjectGroupings");return!0}m8n(ba){let X=!0;for(let Y=0;X&&Y<this.oke.length;Y++){const ca=this.oke[Y];ba.runtime.$I("Before function#"+Y);const ia=ca.classId;ba.runtime.Vub.K(ia).forEach((la,
ta)=>{ba.runtime.MTa.contains(ta.SM.id)||(X=ca.Gnp(ba,ta)&&X);X||(l.a.instance.Ua(4273297,1,4,"PerformThreewayChildMerge: Failed. [ClassId: {0}] [BaseObject.Id: {1}]",ia,ta.SM.id),ba.logger.Pi(Object.assign(new y,{$j:"PerformThreewayChildMerge",eventId:"aqtsr"})));return X});ba.runtime.$I("PerformThreewayChildMerge"+Y)}ba.logger.bbb("PerformThreewayChildMerge");return X}z4n(ba,X){if(X.qqe(f.a.pg)){var Y=this.kf.getPropertyObjectIds(X.SM,f.a.pg);const ca=this.kf.getPropertyObjectIds(X.fsa,f.a.pg);
X=this.kf.getPropertyObjectIds(X.zEa,f.a.pg);Y=String.format("Child node count: Base={0}, Favored={1}, Unfavored={2}, GraphMergeSource={3}",Y.length,ca.length,X.length,ba.input.source);l.a.instance.Ua(4030551,1,4,"Punting attempted merge as there appears to be an added or removed WordSection. {0}",Y);ba.logger.Pi(Object.assign(new y,{$j:"PageContentNodeThreewayChildMerge",eventId:"apybx",info:Y}));return!1}return!0}FGp(ba,X){if(X.qqe(f.a.pg)){const Ha=new z.a,Na=new z.a,ya=new z.a,ma=new z.a;var Y=
this.kf.getPropertyObjectIds(X.SM,f.a.pg),ca=Y.uS(),ia,la=({s7h:ia}=this.N9j(X.fsa,ca,Ha,"Favored")).returnValue,ta=({s7h:za}=this.N9j(X.zEa,ca,Na,"Unfavored")).returnValue;if(!la||!ta)return Y=String.format("Unexpected OG node added. Base OG count: {0}. Favored OG count: {1}. Unfavored OG count: {2}. Favored OGs not found in base: {3}. Unfavored OGs not found in base: {4}.",ca.count,Ha.count,Na.count,ia,za),ba.logger.Pi(Object.assign(new y,{$j:"WordSectionNodeThreewayChildMerge",info:Y})),!1;Y.forEach(Ea=>
{Ha.contains(Ea)||ya.add(Ea);Na.contains(Ea)||ma.add(Ea);return!0});X=X.SM.JO();ca=new x.a;for(ia=0;ia<Y.length;ia++){var za=Y.sg(ia);if(ya.contains(za)||ma.contains(za)){if(ba.runtime.MTa.add(za),ca.length&&(la=ca.sg(ca.length-1),la=ba.runtime.Vub.K(m.a.hH).K(la),ta=ba.runtime.Vub.K(m.a.hH).K(za),la&&ta))ya.contains(za)?ma.contains(za)||(la.SM=la.SM.JO(),la.zEa=la.zEa.JO(),this.GRd(la.SM,ta.SM),this.GRd(la.zEa,ta.zEa)):(la.SM=la.SM.JO(),la.fsa=la.fsa.JO(),this.GRd(la.SM,ta.SM),this.GRd(la.fsa,ta.fsa))}else ca.add(za)}this.kf.setPropertyObjectIds(X,
f.a.pg,ca);Y=new T.a(X);Y.OM(f.a.pg);ba.runtime.Tq.Z(X.id,Y)}return!0}GRd(ba,X){const Y=this.kf.getPropertyObjectIds(ba,f.a.pg);X=this.kf.getPropertyObjectIds(X,f.a.pg);const ca=Y.VNa();X.forEach(ia=>{ca.add(ia);return!0});this.kf.setPropertyObjectIds(ba,f.a.pg,ca)}N9j(ba,X,Y,ca){let ia=0,la=!0;this.kf.getPropertyObjectIds(ba,f.a.pg).forEach(ta=>{X.contains(ta)?Y.add(ta):(la=!1,l.a.instance.Ua(573912977,1,4,"VerifyWordSectionChildren {0}: Failed to find {1} in baseObjects.",ca,ta),ia++);return!0});
return{returnValue:la,s7h:ia}}kTm(ba){let X=!0;ba.runtime.Vub.K(m.a.hH).forEach((Y,ca)=>{if(this.vin(ca)){l.a.instance.Ua(4220302,1,4,"OutlineGroup {0} requires inter-OG merge.",ca.SM.id);let ia;const la=new Z(ba,this.kf,this.LEa);if(({Foj:Y,Eak:ia}=this.Qlp(ba,la.xCm(),ca)).returnValue)return l.a.instance.Ua(4220303,1,4,"Merging WordSection {0} as a unit.",ia),X=la.success&&this.hJn(ba,ia,Y)&&X,X||(l.a.instance.Ua(4273299,1,2,"Inter-OG merge failed. [ObjectId: {0}] [OutlineGroupParentFinder.Success: {1}].",
ca.SM.id,la.success),ba.logger.Pi(Object.assign(new y,{$j:"HandleInterOutlineGroupMerge",eventId:"aqtst",info:String.format("Inter-OG Failure [OutlineGroupParentFinder.Success: {0}]",la.success)}))),X}return!0});return X}vin(ba){if(!ba.qqe(f.a.pg))return!1;const X=this.kf.getPropertyObjectIds(ba.SM,f.a.pg).K(0),Y=this.kf.getPropertyObjectIds(ba.fsa,f.a.pg);ba=this.kf.getPropertyObjectIds(ba.zEa,f.a.pg);return!Y.contains(X,(ca,ia)=>ca.equals(ia))||!ba.contains(X,(ca,ia)=>ca.equals(ia))}Qlp(ba,X,Y){X=
X.K(Y.SM.id);l.a.instance.Ua(4220304,1,4,"While inspecting OG {0}, it appears an inter-OG merge is taking place. All children of WordSection {1} will be merged as a unit.",Y.SM.id,X);if(ba.runtime.MTa.contains(X))return l.a.instance.Ua(4220305,1,5,"Trying to merge WordSection {0} for an inter-OG merge, but an another OG caused us to do that already. Skipping the attempt.",X),{returnValue:!1,Foj:null,Eak:X};const ca=new W.a;Y=ba.runtime.Cn.K(X);this.kf.getPropertyObjectIds(Y,f.a.pg).forEach(ia=>{ca.FRd(ia);
return!0});Y=this.LEa.Qzb(X,ba.runtime.IA,ba.runtime.Cn);this.kf.getPropertyObjectIds(Y,f.a.pg).forEach(ia=>{ca.HRd(ia);return!0});ba=this.LEa.Qzb(X,ba.runtime.uv,ba.runtime.Cn);this.kf.getPropertyObjectIds(ba,f.a.pg).forEach(ia=>{ca.LRd(ia);return!0});return{returnValue:!0,Foj:ca,Eak:X}}Xkg(ba,X,Y,ca,ia){let la=!0;ba.forEach(ta=>{const za=X(ta);this.kf.getPropertyObjectIds(za,f.a.pg).forEach(Ha=>{Y.add(Ha);if(ca.lb(Ha))return(la=ca.K(Ha).equals(ta)&&la)||l.a.instance.Ua(4273300,1,2,"PreprocessRevisionOutlineGroups {0}: Failed. [OutlineElementId: {1}] [OutlineGroupId: {2}] [OutputMapping: {3}]",
ia,Ha,ta,ca.K(Ha)),la;ca.Z(Ha,ta);return!0});return!0});return la}JAm(ba,X){let Y,ca,ia,la;Y=new x.a;ca=new x.a;ia=new x.a;la=new w.a;const ta=ba.runtime.Cn;return this.Xkg(X.kKb,za=>ta.K(za),Y,la,"Base")&&this.Xkg(X.GBf,za=>this.LEa.Qzb(za,ba.runtime.IA,ta),ca,la,"Favored")&&this.Xkg(X.Vzb,za=>this.LEa.Qzb(za,ba.runtime.uv,ta),ia,la,"Unfavored")?{returnValue:!0,mUh:Y,wli:ca,w3j:ia,Ogj:la}:{returnValue:!1,mUh:Y,wli:ca,w3j:ia,Ogj:la}}M7l(ba,X,Y,ca){let ia=!0;const la=ba.runtime.Cn,ta=ba.runtime.IA,
za=ba.runtime.uv,Ha=ba.runtime.Tq,Na=new x.a,ya=new w.a;Y.forEach(ma=>{const Ea=ca.K(ma);if(!Ea)return l.a.instance.Ua(4220306,1,1,"OutlineElementId {0} does not have an OutlineGroup parent in oeToOgMapping.",ma),ba.logger.Pi(Object.assign(new y,{$j:"FinishInterOutlineGroupMerge",eventId:"aqgws"})),ia=!1;Ea.equals(Na.last())||(Na.add(Ea),ya.add(Ea,new x.a));ya.K(Ea).add(ma);ba.runtime.MTa.add(ma);return!0});if(!ia)return!1;ya.forEach((ma,Ea)=>{const Ba=this.LEa.b2j(ma,ta,za,la).JO();this.kf.setPropertyObjectIds(Ba,
f.a.pg,Ea);Ha.Z(ma,new T.a(Ba));Ha.K(ma).OM(f.a.pg);ba.runtime.MTa.add(ma);return ia});Y=this.LEa.b2j(X,ta,za,la).JO();this.kf.setPropertyObjectIds(Y,f.a.pg,Na);Ha.Z(X,new T.a(Y));Ha.K(X).OM(f.a.pg);ba.runtime.MTa.add(X);return ia}hJn(ba,X,Y){let ca,ia;if(!({mUh:la,wli:ca,w3j:ia,Ogj:Y}=this.JAm(ba,Y)).returnValue)return!1;var la=I.b(la,ca,ia);la=this.Boj(ba,la);return!!la&&this.M7l(ba,X,la,Y)}Zne(ba,X){return this.Coj(ba,X)}Coj(ba,X){if(X.qqe(f.a.pg)){var Y=this.FAm(X);Y=this.Boj(ba,Y);if(!Y)return l.a.instance.Ua(4220308,
1,1,"OutlineElementContainerThreewayChildMerge: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",X.SM.id),ba.logger.Pi(Object.assign(new y,{$j:"OutlineElementContainerThreewayChildMerge",eventId:"aqgwu"})),C.a(X.SM,"OutlineElementContainerThreewayChildMerge_Base",1),C.a(X.fsa,"OutlineElementContainerThreewayChildMerge_Favored",1),C.a(X.zEa,"OutlineElementContainerThreewayChildMerge_Unfavored",1),!1;var ca=this.kf.getPropertyObjectIds(X.SM,
f.a.pg);const ia=Y.uS();ca.forEach(la=>{ia.contains(la)||(la=this.kf.getPropertyObjectIds(X.SM,f.a.oF),0<la.length&&ba.runtime.$hg.add(la.K(0)));return!0});ca=X.fsa.JO();this.kf.setPropertyObjectIds(ca,f.a.pg,Y);ba.runtime.Tq.Z(ca.id,new T.a(ca));ba.runtime.Tq.K(ca.id).OM(f.a.pg)}return!0}ydp(ba,X){let Y=X.fsa.hasProperty(f.a.pg),ca=X.zEa.hasProperty(f.a.pg);Y&&(Y=!!this.kf.getPropertyObjectIds(X.fsa,f.a.pg).length);ca&&(ca=!!this.kf.getPropertyObjectIds(X.zEa,f.a.pg).length);if(Y!==ca)if(this.vpn(ba.runtime.sc))ba.logger.t8i(Object.assign(new N.a,
{info:"TableCell OE missing children, ghost cell likely touched"}));else return ba.logger.Pi(Object.assign(new N.a,{info:"TableCell OE missing children, ghost cell likely touched"})),!1;return this.Coj(ba,X)}FAm(ba){let X,Y;({G$k:ba,z3l:X,Iop:Y}=this.kom(ba));return I.b(ba,X,Y)}Boj(ba,X){l.a.instance.Ua(4220309,1,5,"Considering {0} OutlineElement collections for merge.",X.length);const Y=new x.a;let ca=!0;X.forEach(ia=>{if(!ia)return l.a.instance.shipAssertTag(4740611,1,!1,"Mapping is null."),ba.logger.Pi(Object.assign(new y,
{$j:"OutlineElementCollectionsThreewayChildMerge",eventId:"asfyd"})),ca=!1;if(1===ia.aKn&&1===ia.vub){const Ba=ia.kKb.K(0),$a=ia.GBf.K(0),ea=ia.Vzb.K(0);if(Ba&&Ba.equals($a)&&Ba.equals(ea))return Y.add(Ba),!0;if(1!==X.length)return l.a.instance.shipAssertTag(4030554,1,!1,"OutlineElementCollectionsThreewayChildMerge: A 1-1-1 mapping found which somehow contains differing objects. [Base: {0}] [Favored: {1}] [Unfavored: {2}] [Total Collections: {3}].",Ba,$a,ea,X.length),ba.logger.Pi(Object.assign(new y,
{$j:"OutlineElementCollectionsThreewayChildMerge",eventId:"apyb0"})),ca=!1}const la=new w.a,ta=new x.a,za=new x.a,Ha=new x.a,Na=new x.a,ya=new x.a,ma=new x.a,Ea=ba.runtime.Cn;ia.kKb.forEach(Ba=>ca=this.Ylg(ba,Ba,$a=>Ea.K($a),ta,Na,la,"Base"));if(!ca)return l.a.instance.Ua(4285026,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process base outlines."),ba.logger.Pi(Object.assign(new y,{$j:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj8"})),!1;ia.GBf.forEach(Ba=>ca=this.Ylg(ba,
Ba,$a=>this.LEa.Qzb($a,ba.runtime.IA,Ea),za,ya,la,"Favored"));if(!ca)return l.a.instance.Ua(4285027,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process favored outlines."),ba.logger.Pi(Object.assign(new y,{$j:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj9"})),!1;ia.Vzb.forEach(Ba=>ca=this.Ylg(ba,Ba,$a=>this.LEa.Qzb($a,ba.runtime.uv,Ea),Ha,ma,la,"Unfavored"));if(!ca)return l.a.instance.Ua(4285056,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process unfavored outlines."),
ba.logger.Pi(Object.assign(new y,{$j:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwka"})),!1;ba.runtime.sc&&ba.runtime.sc.frb(1000005)&&(ya.length&&this.y3l(ya,ba.runtime.IA)?(this.ANh(ya,ba,Y,la),this.IQd(ba,la,ma)):this.ANh(ma,ba,Y,la));if(ta.length){ia=null;if(!({Tq:ia}=this.U5n(ba,ta,za,Ha,ia)).returnValue||!ia)return ca=!1;ia.forEach(Ba=>{0<Ba.Oac.count&&ba.runtime.Tq.Z(Ba.Bm.id,Ba);Y.add(la.K(Ba.Bm.id));return!0})}return!0});return ca?Y:null}y3l(ba,X){for(let Y=0;Y<ba.length;Y++)if(X.get(ba.sg(Y).id))return!0;
return!1}IQd(ba,X,Y){Y.length&&(Y.forEach(ca=>{ba.runtime.Axc.add(ca.id);ba.runtime.Axc.add(X.K(ca.id));return!0}),F.a.IQd(ba,this.kf,Y.K(0)))}ANh(ba,X,Y,ca){ba.forEach(ia=>{const la=new T.a(ia.JO());X.runtime.Tq.Z(ia.id,la);Y.add(ca.K(ia.id));return!0})}Ylg(ba,X,Y,ca,ia,la,ta){var za=Y(X);if(!za)return l.a.instance.Ua(4285057,1,1,"ProcessOutlineElement {0}: Failed to find OutlineElement with [Id: {1}]",ta,X),ba.logger.Pi(Object.assign(new y,{$j:"ProcessOutlineElement",eventId:"aqwkb",info:String.format("[Revision: {0}] Failed to find OutlineElement",
ta)})),!1;const Ha=this.kf.getPropertyObjectIds(za,f.a.oF);if(!Ha||!Ha.length)return l.a.instance.Ua(4285058,1,1,"ProcessOutlineElement {0}: OutlineElement [Id: {1}] has no children.",ta,X),ba.logger.Pi(Object.assign(new y,{$j:"ProcessOutlineElement",eventId:"aqwkc",info:String.format("[Revision: {0}] OutlineElement has no children",ta)})),C.a(za,"ProcessOutlineElement_"+ta,1),!1;za=Ha.sg(0);Y=Y(za);if(!Y)return l.a.instance.Ua(4285059,1,1,"ProcessOutlineElement {0}: Failed to find ParagraphNode with [Id: {1}] as a child of OutlineElement with [Id: {2}]",
ta,za,X),ba.logger.Pi(Object.assign(new y,{$j:"ProcessOutlineElement",eventId:"aqwkd",info:String.format("[Revision: {0}] Failed to find correct ParagraphNode in OutlineElement",ta)})),!1;if((ta=this.kf.getPropertyString(Y,a.a.cQ))&&""!==ta&&ba.runtime.sc&&(ba.runtime.sc.p9d(1000005),ba.runtime.sc.frb(1000005)))return ia.add(Y),la.add(za,X),ba.runtime.MTa.add(za),!0;ca.add(Y);la.add(za,X);ba.runtime.MTa.add(za);return!0}kom(ba){let X,Y;X=this.kf.getPropertyObjectIds(ba.SM,f.a.pg);Y=this.kf.getPropertyObjectIds(ba.fsa,
f.a.pg);ba=this.kf.getPropertyObjectIds(ba.zEa,f.a.pg);return{G$k:X,z3l:Y,Iop:ba}}vpn(ba){if(!ba)return l.a.instance.Ua(51422868,1,2,"Feature Helper is null"),!1;ba.DI(99);return ba.isFeatureEnabled(99)}static vqj(ba,X){X.lb(ba.wc)||X.Z(ba.wc,new x.a);X.K(ba.wc).add(ba);return!0}}U.hoe=u.a.Cf("{4215CA2B-DF37-4aaa-89ED-F1646178CD20}{1}");Object(J.a)(U,"ChildNodeListMerge",null,[1419])},1769:function(J,L,d){J=d(0);var m=d(1377),f=d(1574),a=d(1460),l=d(1407),w=d(1703),z=d(1478);class x{constructor(X,
Y){this.DimensionValue=this.DimensionName=null;this.DimensionName=X;this.DimensionValue=Y}}Object(J.a)(x,"Dimension",null,[]);class u{constructor(X,Y,ca,ia,la){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=X;this.Query=Y;this.From=ca;this.Size=ia;la&&(this.Filter=la)}}Object(J.a)(u,"EntityRequest",null,[]);class v{constructor(X){this.QueryString=null;this.QueryString=X}}Object(J.a)(v,"Query",null,[]);var E=d(1379);class y{constructor(X,Y){this.Dimensions=this.Name=
null;this.Name=X;this.Dimensions=Y}}Object(J.a)(y,"Scenario",null,[]);var H=d(1382),I=d(1381);class F{constructor(X,Y,ca,ia){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=X;this.TimeZone=Y;this.Cvid=ca;this.Scenario=ia}}Object(J.a)(F,"SubstrateBody",null,[]);var C=d(1477),P=d(1373),K=d(1372),G=d(2),R=d(1697),W=d(1696),Z=d(1439),T=d(29),N=d(17),U=d(124);d.d(L,"a",function(){return ba});class ba{constructor(X){this.aMc=this.vkb=this.UGd=this.IGc=this.MMc=0;this.Ouh=
this.lyh=this.fT=null;this.cZe=0;this.i5=-1;this.DPc="";this.kSe=!1;this.Gf=G.AFrameworkApplication.Ee;this.kc=X;this.RMd=this.kNf();this.EHb=new f.a;this.eth=this.kc.JCe?3:2;this.c$e=this.kc.JCe&&this.kc.$Sj?5:3;this.rcf=this.kc.mye?2:3;this.TJh=1;this.$Fd=this.kc.vBi;this.pEh=this.kc.Fon;this.MNc=X.HFi;G.AFrameworkApplication.J&&(this.lyh=G.AFrameworkApplication.J.ib("AppCatalogUrl")+G.AFrameworkApplication.J.ib("SearchPersonaPhotoBaseUrl"),this.kSe=this.kc.bhc||this.kc.vka||this.kc.b0d);this.kc.vka&&
(this.rcf=this.c$e=5)}oN(){return"Substrate"}bX(){return 0===this.kc.iw?0:1===this.kc.iw?1:3}WJ(X,Y,ca,ia=m.a.ou,la=null){const ta=new I.a(X);if(!la||Array.contains(la,14)||Array.contains(la,15)||Array.contains(la,20))if(!this.cZe||window.performance.now()-this.cZe>=K.a.Seb)if(ca=this.EHb.mGi())this.cZe=window.performance.now(),ca.then(za=>{za&&""!==za?(this.DPc=za,""!==this.fT&&this.lGi(X,ia,this.DPc,Y,la)):(P.TellMeActor.instance.Xe.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),
Y.Nt(ta))},za=>{P.TellMeActor.instance.Xe.onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+za);Y.Nt(ta)});else{if(P.TellMeActor.instance.Xe)P.TellMeActor.instance.Xe.onError("SubstrateResultsProvider:IssueQuery","undefined token promise");Y.Nt(ta)}else this.DPc&&""!==this.DPc?this.lGi(X,ia,this.DPc,Y,la):(Y.Nt(ta),P.TellMeActor.instance.Xe.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else Y.Nt(ta)}zDa(){this.vkb=this.aMc=this.UGd=this.IGc=
this.MMc=0}lGi(X,Y,ca,ia,la){this.zDa();const ta=new I.a(X),za=this.fT=U.a.create().toString();this.oIa();this.i5=window.setTimeout(()=>{if(za===this.fT){this.fT="";this.i5=-1;ia.Nt(ta);const ya={};ya[a.a.provider]=this.oN();ya[a.a.WXb]=X.Bwb;P.TellMeActor.instance.Xe.$B(l.a.IHg,this.MNc,ya)}},this.MNc);const Ha={"Content-Type":"application/json",Accept:"application/json"};Ha.Authorization="Bearer "+ca;Ha["X-Office-Version"]=G.AFrameworkApplication.buildVersion;Ha["X-Office-Application"]=G.AFrameworkApplication.J.ib("Application");
Ha["X-Office-Platform"]="WAC";Ha["X-TellMe-SessionId"]=P.TellMeActor.instance.D8d();Ha["X-TellMe-Culture"]=G.AFrameworkApplication.uiCulture;Ha["X-TellMe-ProcessSessionId"]=G.AFrameworkApplication.userSessionId;Ha["Client-Request-Id"]=za;const Na=window.performance.now();this.Gf.Wj(this.IJm(),2,this.JJm(X.Wg,this.kc.application,P.TellMeActor.instance.D8d(),K.a.wU(X)),Ha,!1,0,ya=>{this.yWb(ya,X,ia,za,Na,Y,la)},ya=>{this.gWb(ya,X,ia,za,Na)},null,null,!1,4E3,6E3)}oIa(){-1!==this.i5&&(window.clearTimeout(this.i5),
this.i5=-1)}yWb(X,Y,ca,ia,la,ta,za){P.TellMeActor.instance.Xe.Eba(Y.Wg.length,this.RMd.join(","),X.data.Ie.toString(),Math.round(window.performance.now()-la),C.a.wXj,!0,z.a.tWa);const Ha=K.a.wU(Y),Na=new I.a(Y);if(ia===this.fT){this.oIa();X=T.b(X.data.De);if(X.Groups){X=X.Groups;for(const ya of X)"People"===ya.Type&&this.kc.zqd&&(za?Array.contains(za,14):1)?(X=this.MCi(ya.Suggestions,Ha,ta),0<X.results.length&&Na.dw(X)):"File"===ya.Type&&this.kc.xqd&&(za?Array.contains(za,15):1)?(X=this.CIf(ya.Suggestions,
Ha,ta),0<X.results.length&&(this.nde()&&(ia=new E.a("GenerateSlidesFromTellMe",30,"",null,1),X.Xx(ia)),Na.dw(X))):"Notes"===ya.Type&&this.kc.ztb&&ta!==m.a.contextMenu&&(za?Array.contains(za,20):1)&&(X=this.rBi(ya.Suggestions,Ha,Y),0<X.results.length&&Na.dw(X))}ca.Nt(Na);P.TellMeActor.instance.Xe.Eba(Y.Wg.length,this.RMd.join(","),"",Math.round(window.performance.now()-la),"",!0,z.a.provider)}else ca.Nt(Na)}rBi(X,Y,ca){const ia=new H.a(20);ia.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;
for(const la of X)this.Wqn(la)&&(X=la.NotesType,X=N.a.vh(X),X=this.wzm(X,la.LastModifiedTime,la.BodyPreview,la.Subject,Y,ca,la))&&(X.groupType=20,ia.Xx(X));return ia}MCi(X,Y,ca){const ia=new H.a(14);ia.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const ta of X)if(this.Xqn(ta)){var la=ta.Id.split("@")[0];X=ta.EmailAddresses[0];let za=ta.Type;if(void 0===za||null===za)za="User";if(la=this.MCm(za,ta.DisplayName,ta.JobTitle,X,la,ca,Y))la.description=X,X=ta.JobTitle,"Department"in ta&&"CompanyName"in
ta&&(X+="@"+ta.Department+"@"+ta.CompanyName),la.QK=X,ia.Xx(la)}return ia}CIf(X,Y,ca){const ia=new H.a(15);ia.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const ya of X)if(this.Nqn(ya)){var la=ya.FileName;X=ya.FileExtension;var ta=la;la.length>X.length&&ta.endsWith(X)&&(ta=la.substr(0,la.length-X.length-1));var za=void 0,Ha=0;"DateCreated"in ya&&ya.DateCreated?(Ha=K.a.XNf(ya.DateCreated),za=K.a.CHi(ya.DateCreated),za=String.format(CommonUIStrings.l_CreatedTimeFormatString,ya.Author,za)):
za=ya.Author;var Na=ya.AccessUrl+"?web=1";const ma=N.a.Klc(Na);la=String.format('<a href="{0}">{1}</a>',ma,N.a.N_(la));if(ca!==m.a.contextMenu||N.a.yX(Na))if(ta=this.Apm(ta,ca===m.a.contextMenu?la:Na,za,ya.FileExtension,ya.Text,Y))ta.description=ya.Author,ta.nRd=Ha,ia.Xx(ta),this.kSe&&(Ha=ya.AccessUrl,la=K.a.z5d(X),za=ya.DateModified?ya.DateModified:ya.DateCreated,Na=ya.Size?ya.Size:ya.FileSize,this.p0o()&&(Ha=Ha.replace(RegExp("%20","g")," "),la=K.a.EIm(X)),X=new w.a(la,Ha,ya.SPWebUrl,ya.Id,Na,za),
P.TellMeActor.instance.SKg(!1,ta.value,X))}return ia}gWb(X,Y,ca,ia,la){ia===this.fT&&(this.oIa(),P.TellMeActor.instance.Xe.Eba(Y.Wg.length,this.RMd.join(","),X.data.Ie.toString(),Math.round(window.performance.now()-la),C.a.wXj,!1,z.a.tWa));X=new I.a(Y);ca.Nt(X)}MCm(X,Y,ca,ia,la,ta,za){za=za?this.TJh:this.eth;if(!window.LPC&&!K.a.iXf()||this.MMc===za)return null;this.MMc+=1;za="PeopleSuggestion"+this.MMc.toString();var Ha=this.lyh+"?size=1&accountName="+ia;X=Object.assign(new R.a,{PersonaType:X,Smtp:ia,
ProfilePictureUrl:Ha,AadObjectId:la});const Na=Object.assign(new W.a,{identifiers:X,displayName:Y});X=ta===m.a.contextMenu;this.kc.hBa?(P.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(za,Na,Y,ca)),ta===m.a.contextMenu&&(ca=K.a.s$h(Y,ia,la),P.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(za,ca))),P.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(za,X))):(Ha=[],Ha.push(appChrome.actions.setPersonaButtonCoauthor(za,
Na,Y,ca)),ta===m.a.contextMenu&&(ca=K.a.s$h(Y,ia,la),Ha.push(appChrome.actions.setButtonCommandValueId(za,ca))),Ha.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(za,X)),appChrome.api.dispatch(Ha));return new E.a(za,11,Y,ia,0)}wzm(X,Y,ca,ia,la,ta,za){if(la&&!this.kc.E1i||this.UGd===this.$Fd||this.aMc===this.$Fd||this.vkb===this.$Fd)return null;var Ha=null;this.UGd+=1;la="";const Na=[],ya={};za.type="Notes";this.Ouh=Object.assign(new Z.a,{landingTab:"Notes",data:za});ta=K.a.oUa(ta.Wg,
33,this.Ouh);if("onenotepagepreviews"===X){if(!("ClickthroughUrl"in za&&za.ClickthroughUrl)||""===za.ClickthroughUrl)return null;this.aMc+=1;la="OnenoteNotesSuggestion"+this.aMc.toString();ya["default"]="SaveAsonetoc2_20";Ha=za.ClickthroughUrl;Na.push(appChrome.actions.setControlIconSet(la,ya));Na.push(appChrome.actions.setCompoundButtonCommandValueId(la,Ha));Ha=new E.a(la,19,null,null,0)}else if("stickynote"===X){if(!this.pEh)return null;this.vkb+=1;la="NotesSuggestion"+this.vkb.toString();ya["default"]=
"ShowAllNotes_20";Na.push(appChrome.actions.setControlIconSet(la,ya));Na.push(appChrome.actions.setCompoundButtonCommandValueId(la,ta));Ha=new E.a(la,21,null,null,0)}else if("samsung"===X){if(!this.pEh)return null;this.vkb+=1;la="NotesSuggestion"+this.vkb.toString();ya["default"]="CategoryCollapsed_20";Na.push(appChrome.actions.setControlIconSet(la,ya));Na.push(appChrome.actions.setCompoundButtonCommandValueId(la,ta));Ha=new E.a(la,20,null,null,0)}""!==la&&(X=K.a.CHi(Y),X=String.format(CommonUIStrings.l_LastModifiedString,
X),Ha.label=ia,Ha.nRd=K.a.XNf(Y),Na.push(appChrome.actions.setControlLabel(la,ia)),Na.push(appChrome.actions.updateCompoundButtonDescription(la,X)),Na.push(appChrome.actions.setControlCustomTooltip(la,ca)),appChrome.api.dispatch(Na));return Ha}Apm(X,Y,ca,ia,la,ta){if(this.IGc===(ta?this.rcf:this.c$e)||this.kSe&&"Word"!==K.a.z5d(ia))return null;this.IGc+=1;ta="FileSuggestion"+this.IGc.toString();const za=[],Ha={};Ha["default"]=K.a.Vsm(ia);this.kc.hBa?(P.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ta,
X)),P.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(ta,Ha)),P.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(ta,ca)),P.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(ta,Y)),P.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(ta,la)),this.kc.bhc&&P.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonSecondaryButtonId(ta,"QuickActionOnFile"))):(za.push(appChrome.actions.setControlLabel(ta,
X)),za.push(appChrome.actions.setControlIconSet(ta,Ha)),za.push(appChrome.actions.updateCompoundButtonDescription(ta,ca)),za.push(appChrome.actions.setCompoundButtonCommandValueId(ta,Y)),za.push(appChrome.actions.setControlCustomTooltip(ta,la)),this.kc.bhc&&za.push(appChrome.actions.setCompoundButtonSecondaryButtonId(ta,"QuickActionOnFile")),appChrome.api.dispatch(za));return new E.a(ta,6,X,ca,0)}kNf(){const X=[];this.kc.zqd&&Array.add(X,"People");this.kc.xqd&&Array.add(X,"File");this.kc.ztb&&Array.add(X,
"Notes");return X}JJm(X,Y,ca,ia){var la=new v(X);X=new u("File",la,0,ia?this.rcf:this.c$e,null);ia=new u("People",la,0,ia?this.TJh:this.eth,K.a.V7n);la=new u("Notes",la,0,this.$Fd,null);(this.kc.bhc||this.kc.b0d)&&"powerpoint"===Y.toLowerCase()&&(Y="word");Y=new x("app",Y.toLowerCase());var ta=[];Array.add(ta,Y);Y=new y("tellmesearch",ta);ta=[];this.kc.xqd&&Array.add(ta,X);this.kc.zqd&&Array.add(ta,ia);this.kc.ztb&&Array.add(ta,la);ca=new F(ta,"UTC",ca,Y);return T.c(ca)}IJm(){let X=this.kc.Mbp;this.kc.ztb&&
(X+="?&setflight=NotesFrom3S");""!==this.kc.nGi&&(X=X+"&"+this.kc.nGi);return X}Xqn(X){return"DisplayName"in X&&"Id"in X&&"EmailAddresses"in X&&!!X.Id&&!!X.EmailAddresses}Nqn(X){return"FileExtension"in X&&!!X.FileExtension&&"FileName"in X&&!!X.FileName&&""!==X.FileName&&"AccessUrl"in X&&!!X.AccessUrl&&""!==X.AccessUrl}Wqn(X){return"Id"in X&&!!X.Id&&"NotesType"in X&&!!X.NotesType&&"Subject"in X&&!!X.Subject&&""!==X.Subject}nde(){return!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",
!1)}p0o(){return!!G.AFrameworkApplication.J&&G.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPerformFileInfoFixes",!0)}}Object(J.a)(ba,"SubstrateResultsProvider",null,[1399])},1771:function(J,L,d){J=d(0);var m=d(59),f=d(34),a=d(5),l=d(14),w=d(175),z=d(87),x=d(181),u=d(221),v=d(602),E=d(48),y=d(356),H=d(2),I=d(1320),F=d(940),C=d(1318);class P{constructor(la,ta=0){this.lsf=null;this.Kig=0;this.LL=la;this.R7f=ta}}Object(J.a)(P,"GraphMergerResponse",null,[]);var K=
d(108),G=d(1),R=d(95),W=d(871),Z=d(1440),T=d(1516);class N extends T.a{constructor(){super();this.AVj=null;this.N$j=!1}get Xea(){return"Crash"}mPb(){this.detail.Z("Type",this.Xea);this.detail.Z("Trace",this.llp(this.AVj));this.detail.Z("Continue",this.N$j);return this.detail}llp(la){la=la.split("\n");const ta=4<la.length?4:la.length,za=new Sys.StringBuilder;for(let Ha=0;Ha<ta;Ha++)Ha===ta-1?za.append(String.format("{0}...",la[Ha])):za.append(String.format("{0}\n",la[Ha]));return za.toString()}}Object(J.a)(N,
"CrashMergeFailureDetail",T.a,[]);var U=d(1990),ba=d(1464),X=d(1609),Y=d(1441);class ca{constructor(){this.sbl=new y.a;this.kul=new y.a;this.Dxl=new y.a}}Object(J.a)(ca,"RangeMarkers",null,[]);d.d(L,"a",function(){return ia});class ia{constructor(){this.o9d=0;this.Jih=this.kib=this.M8b=this.vg=this.mBh=this.f$b=null;this.cth=0;this.Lph=50;this.ggh=this.K$g=null}get ldb(){return this.f$b}get sFo(){return this.mBh}get kf(){return this.vg}get yub(){return this.M8b}get WJi(){return this.kib}get FQm(){return this.Jih}get Hqc(){return this.cth}get G0h(){return this.K$g}get x_c(){return this.ggh}gVb(la,
ta,za,Ha,Na,ya,ma){za=this.nFl(la,ta,Ha,Na,ya,ma,this.x_c);Ha=0;const Ea=za.runtime.rye;let Ba=null;try{this.zBn(Ea,za,ma,la,ta,Na,ya);let $a=C.a.success;for(;Ha<this.yub.length;Ha++)if(!(0,this.yub[Ha])(za)){$a=C.a.Zj;za.logger.Che("GraphMerger.GetMergeFunctions()",Ha);break}return Ba=new P(za.output.LL,$a)}catch($a){const ea=!za.output.timeout;za.output.Jza=ea;const ka=this.s5d($a),La=String.format("Merge {0}! [MergeId: {1}] Failing the merge. [Will continue: {2}] [{3}]",ea?"Crashed":"Timed Out",
za.input.iVb,!!za.output.LL,ka);ea?(w.a.instance.Ua(4051608,1,1,"MergeChanges Crash. [Error: {0}]",La),za.logger.Pi(Object.assign(new N,{AVj:ka,N$j:!!za.output.LL}))):w.a.instance.Ua(4993346,1,2,"MergeChanges Timeout. [Error: {0}]",La);if(za.output.LL)return Ba=new P(za.output.LL,C.a.Zj);throw $a;}finally{za.output.succeeded?this.wBn(Ea,za,Ha):za.output.timeout?this.yBn(za,Ha):za.output.Jza?za.output.LL?this.xBn(za,Ha):this.vBn(za,Ha):this.uBn(za,Ha);za.logger.tBn();w.a.instance.Rna(42350232,1,za.output.succeeded?
4:2,"MergeLogger",za.logger.fxm());za.logger.acd.WLi()&&w.a.instance.Rna(559015903,1,2,"MarkerInfo",za.logger.acd.toString());if(za.runtime.sc&&za.runtime.sc.isFeatureEnabled(66))try{this.Ryn(za)}catch($a){w.a.instance.Ua(571619421,1,4,"Error logging references: {0}",$a.toString())}this.eCn(za);Ba.Kig|=(za.output.succeeded?2:1)<<2*(ma-1);if(Ba)try{Ba.lsf=this.mbo(za)}catch($a){w.a.instance.shipAssertTag(51663492,1,!1,"Failed to create merge report {0}",$a)}}}eCn(la){if(!la.output.succeeded){la=la.output.timeout?
"Timeout":la.logger.avj?la.logger.avj.Xea:"Unknown";const ta=new R.a;z.Health.instance.recordQosError(la,["MergeFailure"],!0,!0,!1,!1,ta)}}Ryn(la){const ta=Na=>{const ya=this.fKa()-la.input.H_a>this.Hqc;if(0<this.Hqc&&ya)throw w.a.instance.Ua(571619422,1,2,"Timed out while calculating added and deleted nodes: {0}",Na),x.a.invalidOperation(Na);};let za=la.runtime.IA.keys,Ha=Na=>la.runtime.IA.K(Na);this.U4f(la,ta,za,Ha,"Favored");za=la.runtime.uv.keys;Ha=Na=>la.runtime.uv.K(Na);this.U4f(la,ta,za,Ha,
"Unfavored");za=la.runtime.Tq.keys;Ha=Na=>{const ya=la.runtime.Tq.K(Na);return ya?ya.Bm:la.runtime.IA.K(Na)};this.U4f(la,ta,za,Ha,"Merged")}U4f(la,ta,za,Ha,Na){var ya=new u.a;const ma=new u.a;for(let Ea=0;Ea<za.length;Ea++){ta("LogAddedAndDeletedNodes");const Ba=Ha(za.K(Ea));if(Ba.wc===m.a.Yna)continue;const $a=la.runtime.Cn.K(Ba.id);$a&&this.Syn(ya,ma,Ba,$a)}this.m9i(ma,Ea=>la.runtime.Cn.K(Ea),ta);this.m9i(ya,Ha,ta);ta=new Sys.StringBuilder;for(za=0;za<ya.length;za++)ta.append(ya.K(za).toString()+
",");ya=new Sys.StringBuilder;for(za=0;za<ma.length;za++)ya.append(ma.K(za).toString()+",");w.a.instance.Rna(571619423,1,4,Na+" revision: Added references",ta.toString());w.a.instance.Rna(571619424,1,4,Na+" revision: Deleted references",ya.toString())}Syn(la,ta,za,Ha){const Na=za.ek();for(let ma=0;ma<Na.length;ma++){const Ea=Na[ma];if(this.ITi(Ea)){var ya=this.kf.getPropertyObjectIds(za,Ea);this.FAn(la,ta,Ha,Ea,ya)}else this.qZi(Ea)&&(ya=this.kf.getPropertyObjectId(za,Ea),this.EAn(la,ta,Ha,Ea,ya))}}m9i(la,
ta,za){za("LogNestedReferences");za=new u.a;const Ha=new v.a;for(let Na=0;Na<la.length;Na++){const ya=la.K(Na);this.x5f(ya,za,Ha,ta)}for(ta=0;ta<za.length;ta++)la.add(za.K(ta))}x5f(la,ta,za,Ha){const Na=Ha(la);if(Na){const ma=Na.ek();for(let Ea=0;Ea<ma.length;Ea++){var ya=ma[Ea];if(this.ITi(ya)){ya=this.kf.getPropertyObjectIds(Na,ya);for(let Ba=0;Ba<ya.length;Ba++)za.contains(ya.K(Ba))||(ta.add(ya.K(Ba)),za.add(ya.K(Ba)),this.x5f(ya.K(Ba),ta,za,Ha))}else this.qZi(ya)&&(ya=this.kf.getPropertyObjectId(Na,
ya),za.contains(ya)||(ta.add(ya),za.add(ya),this.x5f(la,ta,za,Ha)))}}}FAn(la,ta,za,Ha,Na){if(this.kf.hasProperty(za,Ha)){za=this.kf.getPropertyObjectIds(za,Ha);const ya=za.uS();Ha=Na.uS();for(let ma=0;ma<Na.length;ma++)ya.contains(Na.K(ma))||la.add(Na.K(ma));for(la=0;la<za.length;la++)Ha.contains(za.K(la))||ta.add(za.K(la))}else for(ta=0;ta<Na.length;ta++)la.add(Na.K(ta))}EAn(la,ta,za,Ha,Na){Na&&(this.kf.hasProperty(za,Ha)?(za=this.kf.getPropertyObjectId(za,Ha),Na.equals(za)||(la.add(Na),ta.add(za))):
la.add(Na))}sBn(la){w.a.instance.Ua(4535064,1,4,"Sending merge backup. [MergeId: {0}] [Crash: {1}] [Timeout: {2}]",la.input.iVb,la.output.Jza,la.output.timeout)}zBn(la,ta,za,Ha,Na,ya,ma){if(la){la=Ha.length?Ha.sg(Ha.length-1):null;var Ea=Na.length?Na.sg(Na.length-1):null;za=String.format("MergeChanges: Begin. [MergeId: {0}] [TheirChanges - Length:{1} Last:{2} Base:{3}] [YourChanges - Length:{4} Last:{5} Base:{6}] [MergeHint: {7}] [IgnoreConflictsInLastServerRevision: {8}] [MaxMergeTimeInMs: {9}] [Source: {10}]",
ta.input.iVb,Ha.length,la?la.id:E.a.nil,la?la.DJ?la.DJ.id:E.a.nil:E.a.nil,Na.length,Ea?Ea.id:E.a.nil,Ea?Ea.DJ?Ea.DJ.id:E.a.nil:E.a.nil,ya,ma,this.Hqc,za);switch(ta.input.source){case 5:w.a.instance.Ua(51663493,1,4,za);break;default:w.a.instance.Ua(4051606,1,4,za)}}}wBn(la,ta,za){if(la)switch(la=this.g2c(ta,za,"Succeeded"),ta.input.source){case 5:w.a.instance.Ua(51663494,1,4,la);break;default:w.a.instance.Ua(4059162,1,4,la)}}yBn(la,ta){ta=this.g2c(la,ta,"Timeout");switch(la.input.source){case 5:w.a.instance.Ua(51663495,
1,4,ta);break;default:w.a.instance.Ua(4059163,1,2,ta)}}uBn(la,ta){ta=this.g2c(la,ta,"Rejection");switch(la.input.source){case 5:w.a.instance.Ua(51663496,1,4,ta);break;default:w.a.instance.Ua(4059164,1,2,ta)}}xBn(la,ta){ta=this.g2c(la,ta,"Crash - Rejection");switch(la.input.source){case 5:w.a.instance.Ua(51663497,1,4,ta);break;default:w.a.instance.Ua(4059165,1,2,ta)}}vBn(la,ta){ta=this.g2c(la,ta,"Crash - Failed");switch(la.input.source){case 5:w.a.instance.Ua(51663498,1,4,ta);break;default:w.a.instance.Ua(4059166,
1,2,ta)}}g2c(la,ta,za){const Ha=la.output.LL,Na=Ha&&Ha.length?Ha.sg(Ha.length-1):null;return String.format("MergeChanges: End for [MergeId: {0}] with result {1}. [ElapsedTime: {2}ms] [Function: {3}] [MergedRevisions - Length:{4} Last:{5} Base:{6}] [Source: {7}]",la.input.iVb,za,this.fKa()-la.input.H_a,ta,Ha?Ha.length:0,Na?Na.id:E.a.nil,Na?Na.DJ?Na.DJ.id:E.a.nil:E.a.nil,la.input.source)}nFl(la,ta,za,Ha,Na,ya,ma){const Ea=new U.a,Ba=Ea.input;Ba.Gca=la;Ba.M0a=ta;Ba.ml=za;Ba.lma=Ha;Ba.sRb=Na;Ba.source=
ya;Ba.x_c=ma;Ba.H_a=this.fKa();Ea.logger.QVo(Ba.H_a);la=Ea.runtime;la.xod=w.a.instance.i4(1,5);la.rye=w.a.instance.i4(1,4);let $a="";la.$I=ea=>{if(this.Hqc){var ka=this.fKa()-Ba.H_a,La=ka>this.Hqc;$a+=String.format(" ({0}: {1})",ea,ka);La&&(Ea.output.timeout=!0,ea=String.format("[MergeId: {0}] Exceeded [MaxMergeTimeInMs: {1}] when we reached [Details: {2}] [Elapsed Time: {3}] [Timeline: {4}]",Ba.iVb,this.Hqc,ea,ka,$a),w.a.instance.Ua(528061012,1,2,ea),this.Kgp(ea))}};return Ea}Y2c(){return[Object(K.a)(this,
this.n3n,"otherAuthorsHaveChangesToMerge"),Object(K.a)(this,this.jin,"isInputValid"),Object(K.a)(this,this.S4m,"initializeOutputMergeState"),Object(K.a)(this,this.Mae,"initializeRuntimeMergeState"),X.a.Pao,Object(K.a)(this.G0h,this.G0h.pIn,"mergeChildNodeLists"),Object(K.a)(this,this.Tmp,"tryObjectMerge"),X.a.oao,Object(K.a)(this,this.D5l,"finalizeObjectMerge"),Object(K.a)(this,this.IAp,"validateMarkers"),Object(K.a)(this,this.wVk,"addMergeResultsToOutput")]}n3n(la){const ta=la.input.Gca;la=la.output;
return ta?ta.length?!0:(w.a.instance.Ua(4051610,1,5,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),la.LL=ta,la.succeeded=!0,!1):(w.a.instance.Ua(4051609,1,5,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),la.LL=ta,la.succeeded=!0,!1)}jin(la){var ta=la.input;const za=ta.Gca,Ha=ta.M0a,Na=ta.ml,ya=ta.lma;ta=ta.sRb;la=la.output;if(!Ha||!Ha.length)return w.a.instance.Ua(42350233,1,5,"IsInputValid: No local changes to merge."),la.LL=za,la.succeeded=
!0,!1;let ma=!0;if(2!==ya&&1!==ya)return la.LL=za,!1;Na&&Na!==E.a.nil||(ma=!1);za.length<(ta?2:1)&&(w.a.instance.Ua(4051614,1,5,"IsInputValid: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",ta),ma=!1);ma||(la.LL=2===ya?za:Ha);return ma}Mae(la){var ta=la.input,za=ta.Gca,Ha=ta.M0a,Na=ta.lma,ya;let ma;({vHg:ya,BOg:ma,wIa:ta}=this.TJf(la,za,Ha,ta.sRb));if(!ta)return w.a.instance.Ua(4273301,1,2,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",
ya.id,ma.id),la.logger.Pi(Object.assign(new Z.a,{$j:"InitializeRuntimeMergeState",eventId:"aqtsv",info:"Couldn't find a common base change"})),this.D9i(ya,za.length,"TheirChanges"),this.D9i(ma,Ha.length,"YourChanges"),la.output.LL=2===Na?za:Ha,!1;la.runtime.wIa=ta;({Jop:za,A3l:Ha}=this.BQl(Na,ya,ma));({Kop:ta,B3l:Na,J$k:ya}=this.Dxm(la,za,Ha,ta));la.runtime.Cn=ya;la.runtime.uv=ta;la.runtime.IA=Na;la.runtime.Tq=new y.a;la.runtime.B1d=Ha.id;la.runtime.xDe=za.id;la.runtime.Vub=new y.a;la.runtime.MTa=
new v.a;la.runtime.gvf=new y.a;la.runtime.uvl=new y.a;la.runtime.Hdp=new y.a;la.runtime.lse=new ca;la.runtime.Rie=new u.a;la.runtime.$hg=new v.a;la.runtime.Axc=new u.a;la.runtime.sc=la.input.x_c(la);la.runtime.sc.PRc(1000001,"Microsoft.Office.WordOnline.WordTestCrossCompiledFeature","WoWor220;WoWor220cf",f.a.Dfp);la.runtime.sc.PRc(1000005,"Microsoft.Office.WordOnline.TOCMerge","Word-TOCMerge;Word-TOCMergecf",f.a.Mhp);la.runtime.sc.PRc(1000008,"Microsoft.Office.WordOnline.FailOnMPALAsserts","69bca399;0362i899",
f.a.i3l);la.runtime.sc.PRc(1000009,"Microsoft.Office.WordOnline.RemoveEditedImageUrlFromIgnoredProperties","mergeeditedimageurl;mergeeditedimageurlcf",f.a.fvo);la.runtime.sc.PRc(1000010,"Microsoft.Office.WordOnline.MergeLcsInfLoopFix","79ee6190;i588c310",f.a.EIn);la.runtime.wQi=!0;H.AFrameworkApplication.J&&(this.Lph=H.AFrameworkApplication.J.ic("WordEditorGraphMergeMaxIterationsPerCycle",50));return!0}D9i(la,ta,za){const Ha=new u.a;for(;la;)Ha.add(la),la=la.DJ;const Na=new Sys.StringBuilder;Na.append(String.format("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",
za,ta,Ha.length));let ya=Ha.length,ma=0;Ha.forEach(Ea=>({kOi:ya,Z9i:ma}=this.jXk(Na,Ea,Ha,ya,ma)).returnValue);w.a.instance.Ua(4273302,1,4,Na.toString())}jXk(la,ta,za,Ha,Na){la.append(String.format(" [{0} {1} {2}]",Ha,ta.Vla?"S":"B",ta.id));Ha--;Na++;return 50<Na&&za.length!==Na?(la.append(" ...Truncated."),{returnValue:!1,kOi:Ha,Z9i:Na}):{returnValue:!0,kOi:Ha,Z9i:Na}}TJf(la,ta,za,Ha){ta=ta.sg(ta.length-1-(Ha?1:0));za=za.sg(za.length-1);Ha=ta.sVa(za);la.runtime.$I("GetCommonBase");la.logger.bbb("GetCommonBase");
return{vHg:ta,BOg:za,wIa:Ha}}Dxm(la,ta,za,Ha){let Na,ya;({result:Na}=ta.jVb(Ha));la.runtime.$I("GetUnfavoredChanges");la.logger.bbb("GetUnfavoredChanges");({result:ya}=za.jVb(Ha));5===la.input.source&&(la.runtime.E3l=W.a.iEi(za),la.runtime.Mop=W.a.iEi(ta));la.runtime.$I("GetFavoredChanges");la.logger.bbb("GetFavoredChanges");ta=new I.a(Object(K.a)(Ha,Ha.qKa,"getMergeableObject"));la.runtime.$I("GetModifiedObjects");la.logger.bbb("GetModifiedObjects");return{Kop:Na,B3l:ya,J$k:ta}}BQl(la,ta,za){2===
la?(la=ta,ta=za):la=za;return{Jop:ta,A3l:la}}S4m(la){const ta=la.input,za=ta.Gca,Ha=ta.M0a;la.output.LL=(2===ta.lma?za:Ha).VNa();la.runtime.$I("InitializeOutputMergeState");la.logger.bbb("InitializeOutputMergeState");return!0}wVk(la){var ta=la.input.ml;const za=la.runtime.Tq,Ha=la.output.LL;ta=this.oFl(la,Ha.sg(Ha.length-1),ta,E.a.create());this.a5l(la,ta,za);Ha.add(ta);return la.output.succeeded=!0}oFl(la,ta,za,Ha){la.runtime.rye&&w.a.instance.Ua(4051616,1,4,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",
za,Ha);la=this.sFo(Ha);la.AUh(ta,za);return la}a5l(la,ta,za){la.runtime.rye&&w.a.instance.Ua(4059167,1,4,"FillRevision: Adding {0} objects to merged revision.",za.count);za.forEach((Ha,Na)=>{ta.acc(Na.Bm);return!0})}Tmp(la){return this.w2j(la,!1)}D5l(la){return this.w2j(la,!0)}w2j(la,ta){const za=la.runtime,Ha=za.Cn,Na=za.IA,ya=ta?za.gvf:za.uv,ma=za.Tq;let Ea=!0;const Ba=la.runtime.xod;let $a=0,ea=0,ka=0;ya.forEach((La,va)=>{Ba&&w.a.instance.Ua(4051617,1,5,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]",
La,va.wc,ta);ea++;this.Lph===ea&&($a++,la.runtime.$I(String.format("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}] [Finalize: {2}]",$a,ka,ta)),ea=0);if(la.runtime.sc&&la.runtime.sc.frb(1000005)&&la.runtime.Axc.contains(va.id,(Sa,Ta)=>Sa.equals(Ta))||this.U6o(va.wc))return!0;if(!ta&&this.cNl(va.wc,la.runtime.sc))return za.gvf.Z(La,va),!0;var Ca=Na.get(La);if(!Ca)return ma.lb(La)?ma.K(La).rcj(va):ma.Z(La,new Y.a(va,!1)),!0;if(!Ha.K(La)&&!this.gJn(Ca.wc)){var ua=!!la.input.Gca&&!!la.input.Gca.last()&&
la.input.Gca.last().k3(La);const Sa=!!la.input.M0a&&!!la.input.M0a.last()&&la.input.M0a.last().k3(La),Ta=new ba.a(Ca,va);if(!Ta.e3)return ma.Z(La,new Y.a(Ca,!1)),!0;w.a.instance.Ua(4051618,1,2,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]. Object wasn't in base revision, but was in conflict and favored. [ReferencedInFavored: {3}] [ReferencedInUnfavored: {4}] [Identical: {5}] [Source: {6}].",La,va.wc,ta,ua,Sa,!Ta.e3,la.input.source);la.logger.Pi(Object.assign(new Z.a,{$j:"GraphMerger.TryObjectMerge",
eventId:"ap3k8"}));return Ea=!1}ua=ma.Q2(La,new Y.a(Ha.K(La)));({Tl:Ca,returnValue:Ea}=this.FQm.merge(la,this.WJi,this.kf,ua,Ca,va));ka++;Ea&&(la.runtime.$I(String.format("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}] [Finalize: {4}]",La,va.wc,ka,$a,ta)),Ca&&(ma.lb(Ca.Bm.id)?ma.K(Ca.Bm.id).rcj(Ca.Bm):ma.Z(Ca.Bm.id,Ca)));return Ea});la.logger.bbb("ObjectMerge");Ba&&w.a.instance.Ua(4059168,1,5,"TryObjectMerge: Merged {0} objects. {1} were complex merges, finalize: {2}.",ya.count,
ka,ta);return Ea}IAp(la){try{for(let ta=0;ta<la.runtime.Rie.length;ta++){const za=la.runtime.Rie.K(ta);if(la.runtime.Tq.K(za)){if(!this.Djn(la,za))return!1}else w.a.instance.Ua(527034192,1,2,"ValidateMerge: Couldn't find merged node to verify");la.runtime.$I("Validate markers taking too long")}}catch(ta){w.a.instance.Ua(559535579,1,2,"ValidateMerge threw an exception: {0}",ta)}return la.logger.acd.WLi()?!1:!0}L1o(la){return 38===la||39===la||40===la||41===la||44===la||45===la||33===la||34===la?!1:
!0}Qwm(la){switch(la){case 38:case 39:case 40:case 41:return a.a.qe;case 44:case 45:return a.a.QSd;case 33:case 34:return a.a.lk}return F.CommonProperties.nil}HAp(la,ta){const za=this.kf.getPropertyUint32(la,a.a.ft);if(!za||this.L1o(za))return!0;la=this.kf.getPropertyObjectId(la,this.Qwm(za));return ia.vjc(ta,la)?!0:(ta.logger.acd.Cbe=za,!1)}Djn(la,ta){if(la.runtime.$hg.contains(ta))return!1;if(ta=ia.vjc(la,ta)){ta=this.kf.getPropertyObjectIds(ta,l.a.Qn);for(let za=0;za<ta.length;za++){const Ha=ia.vjc(la,
ta.sg(za));if(Ha&&!this.HAp(Ha,la))return!1}}return!0}U6o(la){switch(la){case m.a.OHa:case m.a.Jcc:case m.a.XJb:case m.a.Gcc:case m.a.DEa:case m.a.Yna:return!0}return!1}cNl(la,ta){let za=!1;if(la===m.a.Wd)return!0;ta&&ta.DI(116);ta&&ta.isFeatureEnabled(116)&&la===m.a.wmb&&(za=!0);return za}gJn(la){switch(la){case m.a.Hyc:return!0}return!1}EHl(la,ta){const za=new u.a,Ha=new u.a,Na=new u.a;var ya=la.runtime.wIa;const ma=ya?ya.id:E.a.nil;this.p3f(ya).forEach(Ea=>{za.add(ta(Ea));return!0});ya=la.input.Gca.sg(la.input.Gca.length-
1);this.p3f(ya,ma).forEach(Ea=>{Ha.add(ta(Ea));return!0});la=la.input.M0a.sg(la.input.M0a.length-1);this.p3f(la,ma).forEach(Ea=>{Na.add(ta(Ea));return!0});return{I$k:za,kgp:Ha,zHp:Na}}p3f(la,ta=null){const za=new u.a;ta||(ta=E.a.nil);for(;la&&!ta.equals(la.id);)za.add(la),la=la.DJ;za.reverse();return za}jcp(la){const ta=3===this.o9d;let za=!1;!la.output.succeeded&&(2===this.o9d||la.output.Jza&&1===this.o9d)&&(za=!0);let Ha=!1;la.input.Gca&&0<la.input.Gca.length&&(ta||za)&&la.runtime.IA&&la.runtime.Cn&&
la.runtime.sc&&(Ha=la.runtime.sc.isFeatureEnabled(45));return Ha}ITi(la){return 9===G.a.Tqb(G.a.vEf(la))}qZi(la){return 8===G.a.Tqb(G.a.vEf(la))}static zrm(la){return la.output.Jza?2:la.output.succeeded?3:1}static vjc(la,ta){if(!ta||ta===E.a.nil)return null;const za=la.runtime.Tq.K(ta);return za?za.Bm:la.runtime.Cn.K(ta)}}ia.m9d=E.a.Cf("{0B310978-27EA-4A49-A620-7E588CFE64C6}{1}");Object(J.a)(ia,"GraphMergerBase",null,[1293])},1780:function(J,L,d){J=d(0);var m=d(75),f=d(1377),a=d(1574),l=d(1460),w=
d(1407),z=d(1478),x=d(1379),u=d(1382),v=d(1381),E=d(1373),y=d(1372);class H{constructor(U){this.kc=U;this.RMd=this.kNf()}oN(){return"Add-ins"}bX(){return 0===this.kc.iw?0:1===this.kc.iw?1:3}WJ(U,ba){U=new v.a(U);ba.Nt(U)}nrb(U,ba,X){let Y;Y=this.kc.mS?new u.a(29):new u.a(27);Y.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;X&&this.B5o(U.Wg,ba,Y)}B5o(U,ba,X){const Y=[];let ca;ca=this.kc.Fan?this.kc.mS&&this.kc.hmb?y.a.cqb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,
U)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,U):this.kc.Gan?this.kc.mS&&this.kc.hmb?y.a.cqb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,U)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,U):this.kc.mS&&this.kc.hmb?y.a.cqb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,U)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,U);this.kc.hBa?(E.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",
ca)),E.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",U))):(Y.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",ca)),Y.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",U)),appChrome.api.dispatch(Y));X.Xx(new x.a("LaunchAddinDialogFromTellMe",29));ba.dw(X)}kNf(){const U=[];this.kc.bce&&Array.add(U,"Addin");return U}}Object(J.a)(H,"AddinStoreResultsProvider",null,[1399]);var I=d(1730),F=d(1442),
C=d(1461),P=d(1731),K=d(1769),G=d(1732),R=d(1477),W=d(2),Z=d(29),T=d(124);d.d(L,"a",function(){return N});class N{constructor(U,ba,X){this.Lkb=this.XOc=this.YOc=this.XLd=!1;this.fT=null;this.i5=-1;this.L4a=this.SPc=this.kja=this.nIb=null;this.$qh=this.irh=0;this.kc=U;const Y=y.a.yta();this.Ohb=ba||[];this.Gf=W.AFrameworkApplication.Ee;this.KDh=U.Lgg;this.ZOc=U.Kgg;this.VLd=Y&&this.f0b();this.WLd=Y&&this.g0b();this.MDh=Y&&this.h0b();this.ZLd=this.i0b();this.L7e=this.Zwc();if((ba=U.fFg&&y.a.SAg(U))||
U.vka)this.nIb=new K.a(U),this.XLd=U.xqd;ba&&(this.YOc=U.zqd,this.XOc=U.ztb,this.Lkb=this.XLd&&this.py("File")||this.YOc&&this.py("People")||this.XOc&&this.py("Notes"));this.ULd=this.i1o();this.aPc=U.kfd;this.YLd=this.C1o();this.K7e=this.h1o();this.U$b=this.lye();this.Vca=this.rLm();this.i8g=new I.a(U);this.axk=new P.a(U);this.ONk=new G.a(U);this.Okk=new H(U);this.MNc=X;this.EHb=new a.a;this.aPc&&(this.i8g=new I.a(U));U.vka&&(this.K7e=this.YLd=this.aPc=this.Lkb=this.XOc=this.YOc=this.L7e=this.ZLd=
this.MDh=this.WLd=this.VLd=this.ZOc=!1,W.AFrameworkApplication.J&&this.py("File")&&this.TRj()||this.U$b)&&(U=this.EHb.$Nf("Search",W.AFrameworkApplication.J.ib("TellMeServiceAuthEndpointForSearch")),this.z_c(U,"TellMeService",!0),U=this.EHb.$Nf("SmartLookup",W.AFrameworkApplication.J.ib("SmartLookupShredderServiceEndpoint")),this.z_c(U,"Shredder",!1));W.AFrameworkApplication.J&&this.Lkb&&this.py("File")&&this.TRj()&&(U=this.EHb.$Nf("Search",W.AFrameworkApplication.J.ib("TellMeServiceAuthEndpointForSearch")),
this.z_c(U,"TellMeService",!0))}py(U){return Array.contains(this.Ohb,U)?!0:!1}oN(){return"TellMeService"}bX(){return 0===this.kc.iw?0:1===this.kc.iw?1:this.py("Command")||this.py("Recommended")?2:3}oLm(U){let ba="";if(!U&&this.py("Command")&&this.kc.eZf){ba+="CommandSearch_DLIS,";var X=this.kc.pZj;0<X.length&&(ba+=X+",")}U&&this.py("Recommended")&&this.ZOc&&(X=this.vPm(),0<X.length&&(ba+=X+","));!U&&this.py("Help")&&(U=this.kc.oZj,0<U.length&&(ba+=U+","));this.kc.vka&&this.L4a&&0<this.L4a.length&&
(ba+="IsRecallEnabled_true,");(this.kc.bhc||this.kc.b0d||this.kc.vka)&&this.Lkb&&(ba+="IsGenerateSlidesEnabled_true,");0<ba.length&&(ba=ba.substr(0,ba.length-1));return ba}z_c(U,ba,X){const Y=X?this.irh:this.$qh;if(!Y||window.performance.now()-Y>=y.a.Seb)if(U)X?this.irh=window.performance.now():this.$qh=window.performance.now(),U.then(ca=>{X?this.SPc=ca:(this.L4a=ca,E.TellMeActor.instance.VCg=ca)},ca=>{E.TellMeActor.instance.Xe.onError("TellMeServiceProvider:FetchTokenForService_"+ba,"tellMeServiceToken promise rejected: "+
ca)});else if(E.TellMeActor.instance.Xe)E.TellMeActor.instance.Xe.onError("TellMeServiceProvider:FetchTokenForService_"+ba,"undefined token promise")}WJ(U,ba,X,Y=f.a.ou,ca=null){const ia=new v.a(U);X=y.a.wU(U);this.py("File")&&(this.Lkb||this.kc.vka)&&this.z_c(this.EHb.sLm(),"TellMeService",!0);(this.py("File")&&this.kc.vka||this.py("ActionAI")&&this.U$b)&&this.z_c(this.EHb.rIm(),"Shredder",!1);var la=this.Lkb&&!!this.SPc;const ta=this.kc.vka&&!!this.L4a;var za=la||ta||X&&this.py("Recommended")&&
this.ZOc;la=la||ta||!X&&(this.KDh&&this.py("Command")||this.VLd&&this.py("Answer")||this.WLd&&this.py("Definition")||this.L7e&&this.py("Image")||this.aPc&&this.py("Help")||this.ZLd&&this.py("WolframAnswer")||this.YLd&&this.py("Template")||this.K7e&&this.py("Addin"));if(za||la)if(this.kja=Y,Y={"Content-Type":"application/json",Accept:"application/json"},Y["X-Office-Version"]=W.AFrameworkApplication.buildVersion,Y["X-Office-Application"]=W.AFrameworkApplication.J.ib("Application"),Y["X-Office-Platform"]=
"WAC",Y["X-TellMe-SqmUserId"]=W.AFrameworkApplication.J.ib("LoggableUserId")||"",Y["X-TellMe-SessionId"]=E.TellMeActor.instance.D8d(),this.SPc&&(Y.Authorization="Bearer "+this.SPc),this.L4a&&0<this.L4a.length&&(Y["X-TellMe-ShredderToken"]="Bearer "+this.L4a),za=this.oLm(X),0<za.length&&(Y["X-TellMe-Flights"]=za),za=[],!X&&this.py("Answer")&&this.VLd&&(ca?Array.contains(ca,9):1)&&Array.add(za,"Answer"),!X&&this.py("Command")&&this.KDh&&!F.CommandResultsUtility.DWf(U.Wg)&&(ca?Array.contains(ca,17):
1)&&Array.add(za,"Command"),!X&&this.py("Definition")&&this.WLd&&(ca?Array.contains(ca,10):1)&&Array.add(za,"Definition"),!X&&this.py("Help")&&this.aPc&&(ca?Array.contains(ca,8):1)&&Array.add(za,"Help"),!X&&this.py("WolframAnswer")&&this.ZLd&&(ca?Array.contains(ca,12):1)&&Array.add(za,"WolframAnswer"),X&&this.py("Recommended")&&this.ZOc&&!E.TellMeActor.instance.btd&&(ca?Array.contains(ca,18):1)&&Array.add(za,"Recommended"),!X&&this.py("Image")&&this.L7e&&(ca?Array.contains(ca,19):1)&&Array.add(za,
"Image"),this.SPc&&this.Lkb&&(ca?Array.contains(ca,14)||Array.contains(ca,15)||Array.contains(ca,20):1)&&(this.nIb.zDa(),this.XLd&&this.py("File")&&Array.add(za,"File"),this.YOc&&this.py("People")&&Array.add(za,"People"),this.XOc&&this.py("Notes")&&Array.add(za,"Notes")),this.L4a&&0<this.L4a.length&&this.kc.vka&&(ca?Array.contains(ca,15):1)&&(this.nIb.zDa(),this.py("File")&&Array.add(za,"File")),!X&&this.py("Template")&&this.YLd&&(ca?Array.contains(ca,23):1)&&Array.add(za,"Template"),!X&&this.py("Addin")&&
this.K7e&&(ca?Array.contains(ca,27):1)&&Array.add(za,"Addin"),!X&&this.py("ActionAI")&&this.U$b&&(ca?Array.contains(ca,25):1)&&Array.add(za,"ActionAI"),za.length){Y["X-TellMe-SuggestionTypes"]=za.join(",");Y["X-TellMe-Culture"]=W.AFrameworkApplication.uiCulture;Y["X-TellMe-ProcessSessionId"]=W.AFrameworkApplication.userSessionId;var Ha=this.fT=T.a.create().toString();Y["Client-Request-Id"]=Ha;var Na=window.performance.now();this.oIa();this.i5=window.setTimeout(()=>{if(Ha===this.fT){this.fT="";this.i5=
-1;ba.Nt(ia);const ya={};ya[l.a.provider]=this.oN();ya[l.a.WXb]=U.Bwb;E.TellMeActor.instance.Xe.$B(w.a.IHg,this.MNc,ya)}},this.MNc);this.Gf.Wj(this.Vca,2,this.qLm(U.Wg),Y,!1,0,ya=>{this.yWb(ya,U,ba,Ha,Na,ca)},ya=>{this.gWb(ya,U,ba,Ha,Na)},null,null,!1,4E3,this.U$b?3E4:6E3)}else E.TellMeActor.instance.Xe.onError("IssueQuery","Empty Online Provider List: No online calls by provider"),ba.Nt(ia);else ba.Nt(ia)}oIa(){-1!==this.i5&&(window.clearTimeout(this.i5),this.i5=-1)}yWb(U,ba,X,Y,ca,ia){const la=
new v.a(ba);if(Y===this.fT){this.oIa();E.TellMeActor.instance.Xe.Eba(ba.Wg.length,this.Ohb.join(","),U.data.Ie.toString(),Math.round(window.performance.now()-ca),R.a.ou,!0,z.a.tWa);Y=U.data.De;U=null;try{U=Z.b(Y)}catch(ma){E.TellMeActor.instance.Xe.onError("OnSuccessCallBack","Exception occured while deserializing response:"+ma);return}Y=y.a.wU(ba);if("Groups"in U&&U.Groups){var ta=U.Groups;for(var za of ta)if("GroupType"in za&&"Suggestions"in za&&za.Suggestions)if("Commands"===za.GroupType&&(ia?
Array.contains(ia,17):1)||"Recommended"===za.GroupType&&(ia?Array.contains(ia,18):1)){var Ha=(ta="Recommended"===za.GroupType)?"DLIS":"NaiveBayes";"Source"in za&&za.Source&&(Ha=za.Source);var Na=za.Suggestions;new m.a;var ya=[];for(const ma of Na)this.Gqn(ma)&&(Na=ma.Type,("Command"===Na||ta&&"Recommended"===Na)&&ya.push(new C.a(ma.CommandId,ma.Score)));F.CommandResultsUtility.rhe(ya,!ba.Wg.trim().length,za.GroupType,Ha);Ha=E.TellMeActor.instance.F5;Na=[];for(const ma of ya)ta&&Ha&&Ha.pqf(ma.commandId)||
Na.push(ma);ya=F.CommandResultsUtility.J3c(ba,Na,this.kc,null,null,null,ta?18:17,0);0<ya.results.length&&(this.kja!==f.a.contextMenu&&(ya.displayName=ta?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),la.dw(ya))}else if("Answer"===za.GroupType){Na=za.Suggestions;ta=null;ya=2147483647;Ha="";for(const ma of Na)if(this.Fqn(ma))if(Ha=ma.Type,Na=this.dEm(Ha),"Answer"===Ha&&this.VLd){ta=this.g$h(Ha,ma,ba.Wg);break}else Na&&Na<ya&&(ya=Na,ta=this.g$h(Ha,ma,ba.Wg));ya=
y.a.vEo(ba.Wg,Ha);ta&&(ia?Array.contains(ia,ta.type):1)&&(Ha=[],this.ULd?this.kc.hBa?(E.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ta.value,ta.tE)),E.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(ta.value,ta.description)),E.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(ta.value,ya))):(Ha.push(appChrome.actions.setControlLabel(ta.value,ta.tE)),Ha.push(appChrome.actions.updateCompoundButtonDescription(ta.value,
ta.description)),Ha.push(appChrome.actions.setCompoundButtonCommandValueId(ta.value,ya)),appChrome.api.dispatch(Ha)):this.kc.hBa?(E.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ta.value,ta.tE+" - "+ta.description)),E.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(ta.value,ya))):(Ha.push(appChrome.actions.setControlLabel(ta.value,ta.tE+" - "+ta.description)),Ha.push(appChrome.actions.setButtonCommandValueId(ta.value,ya)),appChrome.api.dispatch(Ha)),
ya=this.MHl(ta.type),ya.Xx(ta),la.dw(ya))}else"Help"===za.GroupType&&za.Suggestions.length&&(ia?Array.contains(ia,8):1)?this.aPc&&(ta=this.i8g.nrb(ba,za.Suggestions))&&0<ta.results.length&&la.dw(ta):"Template"===za.GroupType&&(ia?Array.contains(ia,23):1)?(ta=za.Suggestions)&&0<ta.length&&this.ONk.nrb(ba,la,ta):"Addin"===za.GroupType&&(ia?Array.contains(ia,27):1)?(ta=za.Suggestions)&&0<ta.length&&this.Okk.nrb(ba,la,ta):"ActionAI"===za.GroupType&&(ia?Array.contains(ia,25):1)?(ya=za.Suggestions,ta=[],
new u.a(25),ya&&1===ya.length&&(Ha=ya[0])&&Ha.CommandId&&(ya=Ha.CommandId,ta.push(new C.a(ya,"Score"in Ha?Ha.Score:0)),ta=F.CommandResultsUtility.J3c(ba,ta,this.kc,null,null,null,25,0),ta.displayName=CommonUIStrings.l_TellMeActionAIProviderTitle,la.dw(ta))):"Substrate"===za.GroupType&&this.Lkb&&"Type"in za?"File"===za.Type&&this.XLd&&(ia?Array.contains(ia,15):1)?(ta=this.nIb.CIf(za.Suggestions,Y,this.kja))&&0<ta.results.length&&(this.nde()&&(ya=new x.a("GenerateSlidesFromTellMe",30,"",null,1),ta.Xx(ya)),
la.dw(ta)):"People"===za.Type&&this.YOc&&(ia?Array.contains(ia,14):1)?(ta=this.nIb.MCi(za.Suggestions,Y,this.kja))&&0<ta.results.length&&la.dw(ta):"Notes"===za.Type&&this.XOc&&(ia?Array.contains(ia,14):1)&&(ta=this.nIb.rBi(za.Suggestions,Y,ba))&&0<ta.results.length&&la.dw(ta):"Recall"===za.GroupType&&this.kc.vka&&"Type"in za&&"IntentService"===za.Type&&(ia?Array.contains(ia,15):1)&&(ta=this.nIb.CIf(za.Suggestions,Y,this.kja))&&0<ta.results.length&&(this.nde()&&(ya=new x.a("GenerateSlidesFromTellMe",
30,"",null,1),ta.Xx(ya)),la.dw(ta));else E.TellMeActor.instance.Xe.onError("OnSuccessCallBack","GroupType"in za?"Invalid group suggestions found for "+za.GroupType:"Invalid group found")}if(U.Intents){za=U.Intents;for(const ma of za)this.I0f(ma)&&("Image"===ma.GroupType&&ma.ConfidenceScore>ma.ConfidenceThreshold&&(ia?Array.contains(ia,19):1)?this.axk.nrb(ba,la,0,ma):"Commands"===ma.GroupType&&ma.ConfidenceScore<ma.ConfidenceThreshold&&(ia?Array.contains(ia,17):1)&&(za=new u.a(17),la.dw(za)))}X.Nt(la);
E.TellMeActor.instance.Xe.Eba(ba.Wg.length,this.Ohb.join(","),"",Math.round(window.performance.now()-ca),"",!0,z.a.provider)}}gWb(U,ba,X,Y,ca){const ia=new v.a(ba);Y===this.fT&&(this.oIa(),E.TellMeActor.instance.Xe.Eba(ba.Wg.length,this.Ohb.join(","),U.data.Ie.toString(),Math.round(window.performance.now()-ca),R.a.ou,!1,z.a.tWa));X.Nt(ia)}dEm(U){switch(U){case "Entity":return this.MDh?3:0;case "Definition":return this.WLd?5:0;case "WolframAnswer":return this.ZLd?2:0;default:return 0}}g$h(U,ba,X){switch(U){case "Answer":return new x.a(this.ULd?
"AnswerForSearch":"AnswerForSearchSingleLine",0,""===ba.Title?X:ba.Title,ba.Description,0);case "Entity":return new x.a(this.ULd?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===ba.Title?X:ba.Title,ba.Description,0);case "Definition":return new x.a(this.ULd?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===ba.Title?X:ba.Title,ba.Description,0);case "WolframAnswer":return new x.a("WolframForSearch",3,""===ba.Title?X:ba.Title,ba.Description,0);default:return null}}MHl(U){switch(U){case 0:return new u.a(9,
CommonUIStrings.l_TellMeAnswersTitle);case 2:return new u.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new u.a(10,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new u.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new u.a(19,this.kc.Vwc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);default:return null}}Fqn(U){return"Type"in U&&!!U.Type&&""!==U.Type&&"Description"in U&&!!U.Description&&""!==U.Description}Gqn(U){return"Type"in U&&!!U.Type&&""!==
U.Type&&"CommandId"in U&&!!U.CommandId&&""!==U.CommandId&&"Score"in U&&!!U.Score}I0f(U){if("GroupType"in U&&U.GroupType&&"ConfidenceScore"in U&&"ConfidenceThreshold"in U)return!0;E.TellMeActor.instance.Xe.onError("IsValidIntentGroup","Invalid intents found");return!1}qLm(U){const ba=y.a.R0i(U),X={};X.Query=U;ba&&this.ZOc&&(this.hkn()?X.UserActionEvents=E.TellMeActor.instance.AIh:(X.CommandClickedEvents=E.TellMeActor.instance.pMe,X.CommandActionEvents=E.TellMeActor.instance.xah),X.TellMeCommandClickMruEvents=
E.TellMeActor.instance.$th,X.ContentType=E.TellMeActor.instance.xYd);this.YLd&&(U={},U.Application=this.kc.application,X.TemplateInfo=U);return Z.c(X)}f0b(){return!!this.kc&&this.kc.f0b||!!W.AFrameworkApplication.ua&&W.AFrameworkApplication.ua.Ib.f0b}g0b(){return!!this.kc&&this.kc.g0b||!!W.AFrameworkApplication.ua&&W.AFrameworkApplication.ua.Ib.g0b}h0b(){return!!this.kc&&this.kc.h0b||!!W.AFrameworkApplication.ua&&W.AFrameworkApplication.ua.Ib.h0b}i0b(){return!!this.kc&&this.kc.i0b||!!W.AFrameworkApplication.ua&&
W.AFrameworkApplication.ua.Ib.i0b}Zwc(){return!!this.kc&&(this.kc.Zwc||this.kc.mS)}i1o(){return!!this.kc&&!this.kc.Aab}C1o(){return!!this.kc&&this.kc.u$c}h1o(){return!!this.kc&&this.kc.Han&&this.kc.Ean}lye(){return!!this.kc&&this.kc.lye}B1i(){return!!W.AFrameworkApplication.J&&W.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}C1i(){return!!W.AFrameworkApplication.J&&W.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",
!1)}hkn(){return!!W.AFrameworkApplication.J&&W.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",!1)}nde(){return!!W.AFrameworkApplication.J&&W.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}TRj(){return!!W.AFrameworkApplication.J&&W.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FetchTellMeTokensAtBoot",!1)}vPm(){return W.AFrameworkApplication.J?
W.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.TellMeZeroTermModelName",""):""}rLm(){if(!W.AFrameworkApplication.J)return"";if(this.C1i())return W.AFrameworkApplication.J.ib("TellMeServiceProdEndpointForSearch");if(this.B1i())return W.AFrameworkApplication.J.ib("TellMeServiceEdogEndpointForSearch");if(y.a.iXf())return W.AFrameworkApplication.J.ib("TellMeServiceIntEndpointForSearch");let U=W.AFrameworkApplication.J.ib("TellMeServiceSearchEndpoint");U&&""!==U||(U=W.AFrameworkApplication.nZj);
return U}static K$h(U,ba){if(ba)return new N(U,["Command","Recommended"],U.jpm);ba=y.a.yta()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin ActionAI".split(" "):"Help WolframAnswer File People Notes Template Addin ActionAI".split(" ");return new N(U,ba,U.HFi)}}Object(J.a)(N,"TellMeServiceProvider",null,[1399])},1782:function(J,L,d){J=d(0);var m=d(221),f=d(1581),a=d(181),l=d(1459);class w extends f.a{constructor(x,u,v,E,y,H,I,F,C,P,K,G,R,W){super(x,3,u,v,E,y,H,F,C,P,K,
G,R,W);this.wLe=I}get character(){return this.wLe}get text(){return this.character.toString()}Vnd(){throw a.a.notImplemented();}toString(){return String.format("{0}",super.toString())}Qic(){return"CharRun"}clone(){return new w(this.cSc,this.source,this.wk,this.Og,this.runId,this.oL,this.character,this.Qub,this.oXa,this.sfa,this.CKa,this.iZa,this.bA,this.$u)}VB(x,u,v,E=!1){return super.VB(x,u,v,E)?x.character===this.character?!0:l.a.FSh(x.character,this.character):!1}}Object(J.a)(w,"CharRunMergeBlock",
f.a,[]);d.d(L,"a",function(){return z});class z extends f.a{constructor(x,u,v,E,y,H,I,F,C,P,K,G,R,W,Z){super(x,1,u,v,E,y,H,F,P,K,G,R,W,Z);this._text=I;this.u9e=C}get text(){return this._text}Vnd(x){this._text=x}get Aeb(){return this.u9e&&this._text&&this._text.length?!0:!1}toString(){return String.format("{0} [SupportsSplit: {1}]",super.toString(),this.u9e)}Qic(){return"TextRun"}clone(){return new z(this.cSc,this.source,this.wk,this.Og,this.runId,this.oL,this._text,this.Qub,this.u9e,this.oXa,this.sfa,
this.CKa,this.iZa,this.bA,this.$u)}VB(x,u,v,E=!1){return super.VB(x,u,v,E)?l.a.ESh(this._text,x._text):!1}tpd(){const x=new m.a;for(let v=0;v<this.text.length;v++){var u=l.a.charAt(this._text,v);if(l.a.npn(l.a.zhp(u))){let E="";E+=u;u=l.a.charAt(this._text,++v);E+=u;u=new z(this.cSc,this.source,this.wk,this.Og,this.runId,this.oL,E,this.Qub,!1,this.oXa,this.sfa,this.CKa,this.iZa,this.bA,this.$u);x.add(u)}else u=new w(this.cSc,this.source,this.wk,this.Og,this.runId,this.oL,u,this.Qub,this.oXa,this.sfa,
this.CKa,this.iZa,this.bA,this.$u),x.add(u)}return x}}Object(J.a)(z,"TextRunMergeBlock",f.a,[])},1783:function(J,L,d){J=d(0);var m=d(267),f=d(34),a=d(14),l=d(5),w=d(110),z=d(795),x=d(175),u=d(221),v=d(356),E=d(1364);class y{constructor(F,C,P){this.position=F;this.leader=C;this.val=P}equals(F){return this.position===F.position&&this.leader===F.leader&&this.val===F.val}toString(){return this.position.toString()}}Object(J.a)(y,"TabStop",null,[]);var H=d(1905);d.d(L,"a",function(){return I});class I extends E.a{constructor(){super();
this.jOd=null}get zo(){return 20}get mjp(){return this.jOd?this.jOd:this.jOd=new Set([z.a.zb(f.a.JWa),z.a.zb(f.a.zUa),z.a.zb(f.a.f0a)])}get GB(){return 0}el(){const F=super.el();F.Z(z.a.zb(a.a.Pn),1);F.Z(z.a.zb(a.a.Qn),1);F.Z(z.a.zb(a.a.vn),1);F.Z(z.a.zb(l.a.Lt),1);F.Z(z.a.zb(l.a.Gq),1);F.Z(z.a.zb(l.a.Yc),1);F.Z(z.a.zb(a.a.Lyb),1);F.Z(z.a.zb(l.a.ZVa),1);F.Z(z.a.zb(l.a.VMa),1);F.Z(z.a.zb(a.a.CCa),1);F.Z(z.a.zb(l.a.ZKa),1);F.Z(z.a.zb(l.a.kka),1);F.Z(z.a.zb(l.a.$Ka),1);F.Z(z.a.zb(l.a.fJa),1);F.Z(z.a.zb(l.a.aLa),
1);F.Z(z.a.zb(l.a.gJa),1);F.Z(z.a.zb(l.a.UMa),1);F.Z(z.a.zb(l.a.KOa),1);F.Z(z.a.zb(l.a.LOa),1);F.Z(z.a.zb(l.a.vEa),1);F.Z(z.a.zb(l.a.Ew),1);F.Z(z.a.zb(f.a.JWa),1);F.Z(z.a.zb(f.a.zUa),1);F.Z(z.a.zb(f.a.f0a),1);F.Z(z.a.zb(l.a.aC),1);F.Z(z.a.zb(l.a.bC),1);F.Z(z.a.zb(l.a.ry),1);F.Z(z.a.zb(w.a.Zma),6);F.Z(z.a.zb(w.a.YJ),6);F.Z(z.a.zb(w.a.H0a),6);F.Z(z.a.zb(l.a.rLb),7);F.Z(z.a.zb(w.a.YJ),6);F.Z(z.a.zb(l.a.qUj),2);F.Z(z.a.zb(w.a.gxl),2);F.Z(z.a.zb(w.a.C5n),2);F.Z(z.a.zb(l.a.Azc),2);F.Z(z.a.zb(l.a.urd),2);
F.Z(z.a.zb(l.a.D1b),2);F.Z(z.a.zb(l.a.Zeb),2);F.Z(z.a.zb(l.a.vrd),2);F.Z(z.a.zb(l.a.wrd),2);F.Z(z.a.zb(l.a.P4f),2);F.Z(z.a.zb(l.a.listID),3);F.Z(z.a.zb(l.a.listLevel),3);return F}AD(F,C){var P=F.hu.runtime.sc,K=P.isFeatureEnabled(110);if(C===z.a.zb(a.a.Pn)||C===z.a.zb(a.a.Qn)||C===z.a.zb(a.a.vn)||C===z.a.zb(l.a.Lt)||C===z.a.zb(l.a.Gq)||C===z.a.zb(l.a.Yc)||C===z.a.zb(a.a.Lyb)||C===z.a.zb(l.a.ZVa)||C===z.a.zb(l.a.VMa)||C===z.a.zb(a.a.CCa)||C===z.a.zb(l.a.ZKa)||C===z.a.zb(l.a.kka)||C===z.a.zb(l.a.$Ka)||
C===z.a.zb(l.a.fJa)||C===z.a.zb(l.a.aLa)||C===z.a.zb(l.a.gJa)||C===z.a.zb(l.a.UMa)||C===z.a.zb(l.a.KOa)||C===z.a.zb(l.a.LOa)||C===z.a.zb(l.a.vEa)||C===z.a.zb(l.a.Ew)||C===z.a.zb(l.a.cQ)||this.ZIn(C,K)){var G=F.Po.value.Ov;K=F.Po.value.Lf;C=F.ih.value.Lf;if(F.hu.runtime.MTa.contains(G.id))return x.a.instance.Ua(18989579,1,4,"ParagraphNodeComplexMerge: Skipping merge for [Paragraph: {0}] as it was already merged during ChildNodeListMerge.",G.id),!0;if(P.frb(1000005)&&this.b7o(F,C,K))return F.Tl=C.JO(),
I.oMh(F),I.IQd(F.hu,F.kf,K),!0;P=new u.a;P.add(G);G=new u.a;G.add(K);K=new u.a;K.add(C);if(!({Tq:C}=I.A2j(F.hu,P,K,G)).returnValue)return F.DNg=!0,F.Tl=null,!1;I.oMh(F);F.Tl=C.sg(0).Bm;return!0}return C===z.a.zb(l.a.aC)||C===z.a.zb(l.a.bC)||C===z.a.zb(l.a.ry)?(this.Blp(F),F.Ug.add(z.a.zb(l.a.aC)),F.Ug.add(z.a.zb(l.a.bC)),F.Ug.add(z.a.zb(l.a.ry)),!0):!1}b7o(F,C,P){C=F.kf.getPropertyString(C,l.a.cQ);F=F.kf.getPropertyString(P,l.a.cQ);return C||F?!0:!1}Blp(F){const C=F.kf,P=F.Tl;var K=F.Po.value.Lf,
G=F.ih.value.Lf;F=this.HHf(F.Po.value.Ov,C);G=this.HHf(G,C);K=this.HHf(K,C);({lJn:K,mJn:F,nJn:G}=this.jxm(F,G,K));K.length?(C.setPropertyUint32s(P,l.a.ry,K),C.setPropertyUint32s(P,l.a.aC,F),C.setPropertyUint32s(P,l.a.bC,G)):this.Suo(P)}HHf(F,C){const P=C.getPropertyUint32s(F,l.a.ry),K=C.getPropertyUint32s(F,l.a.aC);F=C.getPropertyUint32s(F,l.a.bC);C=new u.a;if(!P)return C;for(let G=0;G<P.length;++G)C.add(new y(P.K(G),K.K(G),F.K(G)));return C}jxm(F,C,P){({uoj:C,voj:W,woj:R}=this.jvi(F,C));let K,G;
({uoj:P,voj:K,woj:G}=this.jvi(F,P));F=this.kSm(F,W,R,K,G);var R=this.jSm(F,C,P);F=new u.a;C=new u.a;var W=new u.a;for(P=0;P<R.length;++P)F.add(R.K(P).position),C.add(R.K(P).leader),W.add(R.K(P).val);return{lJn:F,mJn:C,nJn:W}}jvi(F,C){let P,K,G;P=new u.a;K=new v.a;G=new v.a;let R,W;for(R=W=0;R<F.length&&W<C.length;)F.K(R).position===C.K(W).position?(F.K(R).equals(C.K(W))||G.Z(F.K(R).position,C.K(W)),++R,++W):F.K(R).position<C.K(W).position?(K.Z(F.K(R).position,F.K(R)),++R):(P.add(C.K(W)),++W);for(;R<
F.length;)K.Z(F.K(R).position,F.K(R)),++R;for(;W<C.length;)P.add(C.K(W)),++W;return{uoj:P,voj:K,woj:G}}kSm(F,C,P,K,G){const R=new u.a;for(let W=0;W<F.length;++W){const Z=F.K(W).position;C.lb(Z)||(P.lb(Z)?R.add(P.K(Z)):K.lb(Z)||(G.lb(Z)?R.add(G.K(Z)):R.add(F.K(W))))}return R}jSm(F,C,P){C=this.pcj(C,P);return this.pcj(F,C)}pcj(F,C){const P=new u.a;let K,G;for(K=G=0;K<F.length&&G<C.length;)F.K(K).position<=C.K(G).position?(P.add(F.K(K)),F.K(K).position===C.K(G).position&&++G,++K):P.add(C.K(G++));for(;K<
F.length;)P.add(F.K(K++));for(;G<C.length;)P.add(C.K(G++));return P}Suo(F){F.removeProperty(l.a.ry);F.removeProperty(l.a.aC);F.removeProperty(l.a.bC)}static Eh(){return new I}static get instance(){return I.hh.value}static oMh(F){F.Ug.add(z.a.zb(a.a.Pn));F.Ug.add(z.a.zb(a.a.Qn));F.Ug.add(z.a.zb(a.a.vn));F.Ug.add(z.a.zb(l.a.Lt));F.Ug.add(z.a.zb(l.a.Gq));F.Ug.add(z.a.zb(l.a.Yc));F.Ug.add(z.a.zb(a.a.Lyb));F.Ug.add(z.a.zb(l.a.ZVa));F.Ug.add(z.a.zb(l.a.VMa));F.Ug.add(z.a.zb(a.a.CCa));F.Ug.add(z.a.zb(l.a.ZKa));
F.Ug.add(z.a.zb(l.a.kka));F.Ug.add(z.a.zb(l.a.$Ka));F.Ug.add(z.a.zb(l.a.fJa));F.Ug.add(z.a.zb(l.a.aLa));F.Ug.add(z.a.zb(l.a.gJa));F.Ug.add(z.a.zb(l.a.UMa));F.Ug.add(z.a.zb(l.a.KOa));F.Ug.add(z.a.zb(l.a.LOa));F.Ug.add(z.a.zb(l.a.vEa));F.Ug.add(z.a.zb(l.a.Ew));F.Ug.add(z.a.zb(l.a.cQ))}static A2j(F,C,P,K){return(new H.a(F,C,P,K)).Mzc()}static IQd(F,C,P){P=C.getPropertyObjectIds(P,a.a.Qn);for(let G=0;G<P.length;G++){var K=F.runtime.uv.K(P.sg(G));if(K&&(K=C.getPropertyObjectId(K,l.a.qe))){F.runtime.Axc.add(K);
break}}}ZIn(F,C){return C?this.mjp.has(F)?!0:!1:!1}}I.hh=new m.a(I.Eh);Object(J.a)(I,"ParagraphNodeComplexMerge",E.a,[])},1904:function(J,L,d){d.r(L);d.d(L,"MarkerValidation",function(){return a});J=d(0);var m=d(356),f=d(1715);class a{constructor(){this.Cbe=this.BSi=this.ASi=this.zSi=0}Cvi(){const l=new m.a(0);l.Z("InvalidBookmarks",this.zSi);l.Z("InvalidComments",this.ASi);l.Z("InvalidContentControls",this.BSi);0!==this.Cbe&&l.Z("InvalidMarkerType",this.Cbe);return l}WLi(){return 0<this.zSi||0<this.ASi||
0<this.BSi||0!==this.Cbe?!0:!1}toString(){return JSON.stringify(f.a.K0a(this.Cvi()))}}Object(J.a)(a,"MarkerValidation",null,[])},1905:function(J,L,d){d.d(L,"a",function(){return z});J=d(0);var m=d(175),f=d(1025),a=d(241),l=d(1609),w=d(1484);class z{constructor(x,u,v,E,y=null,H=null,I=null,F=null){this.ee=x;this.vH=u;this.UFa=v;this.pHa=E;this.GCk=y;this.htk=H;this.gPk=I;this.Uwa=F||this.Xrf()}Xrf(){return x=>!!this.ee.runtime.sc&&this.ee.runtime.sc.isFeatureEnabled(x)}qDl(){return()=>this.ee.runtime.sc}Pxf(){return!!this.ee.runtime.Cn.K(a.a.QN)}JUj(){let x;
if(1===this.ee.input.source||2===this.ee.input.source)x=73;else if(4===this.ee.input.source||3===this.ee.input.source)x=34;else if(5===this.ee.input.source)x=111;else return!1;return this.Pxf()&&this.Uwa(x)}YWj(x,...u){return String.format.apply(null,[x].concat(u))}f7d(x){const {ParagraphMerge:u}=d(1991);let v=this.ee,E=this.UFa,y=this.pHa;x||(v=this.GCk||this.ee,E=this.htk||E,y=this.gPk||y);var H=w.a.yKf(this.vH);const I=w.a.yKf(E),F=w.a.yKf(y);H=this.YWj("[MergeSource: {0}] [BaseRevisionId: {1}] [FavoredRevisionId: {2}] [UnfavoredRevisionId: {3}] [BaseObjects: {4}] [FavoredObjects: {5}] [UnfavoredObjects: {6}]",
v.input.source,v.runtime.wIa.id,v.runtime.B1d,v.runtime.xDe,H.Qr(),I.Qr(),F.Qr());return x?{returnValue:new l.a(v,this.vH,E,y,this.Xrf(),new f.a),Qr:H}:{returnValue:new u(v,this.vH,E,y,this.Xrf(),this.qDl(),new f.a),Qr:H}}Mzc(){this.ee.logger.MTo();var x=this.JUj();var u=({Qr:E}=this.f7d(x)).returnValue;m.a.instance.Ua(18994389,1,4,"ParagraphMergeSelector TryDoMerge: [UseHints: {0}] {1}",x,E);this.ee.logger.EX("ParagraphMergeSelector initialization");x?this.ee.logger.Wwe(1):this.ee.logger.Wwe(2);
let v=({Tq:u}=u.Mzc()).returnValue;this.ee.logger.Uyg();var E=!v;x=!!this.ee.runtime.Cn.K(a.a.QN)&&(x&&!v||!x);E&&({Qr:E,returnValue:u}=this.f7d(!1),{Tq:u,returnValue:v}=u.Mzc(),m.a.instance.Ua(18994390,1,v?4:2,"ParagraphMergeSelector TryDoMerge Fallback: [Success: {0}] {1}",v,E));x&&(E=new f.a,w.a.jDo(this.ee,E));this.ee.logger.EX("ParagraphMergeSelector finalization");return{returnValue:v,Tq:u}}osd(x,u){let v,E,y;const H=this.JUj()&&this.Uwa(112);let I=({Qr:y}=this.f7d(H)).returnValue,F=({idb:v,
Xua:E}=I.osd(x,u)).returnValue;m.a.instance.Ua(18994391,1,4,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange: [UseHints: {0}] {1}",H,y);H&&!F&&I.tug&&({Qr:y,returnValue:I}=this.f7d(!1),{idb:v,Xua:E,returnValue:F}=I.osd(x,u),m.a.instance.Ua(18994392,1,F?4:2,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange Fallback: [Success: {0}] {1}",F,y));return{returnValue:F,idb:v,Xua:E}}}Object(J.a)(z,"ParagraphMergeSelector",null,[1413])},1906:function(J,L,d){d.r(L);d.d(L,"SurfaceStringTokenStringGenerator",
function(){return f});J=d(0);var m=d(1526);class f extends m.a{constructor(a){super(a);this.Ab=a}apply(a,l,w,z,x,u,v){null==u&&(u=a.JHi(x,l));v=m.a.BNh(a,u,this.Ab.score,w,z,v);return{erd:u,JTc:v}}}f.KTc=0;Object(J.a)(f,"SurfaceStringTokenStringGenerator",m.a,[])},1907:function(J,L,d){d.r(L);d.d(L,"QueryTokenStringGenerator",function(){return a});J=d(0);var m=d(1526),f=d(1367);class a extends m.a{constructor(l){super(l);this.Ab=l}apply(l,w,z,x,u,v,E){w=this.Ab.query.load(w,null);u=0;let y=null;this.Ab.query.o8===
f.Annotations.xEa?w&&(y=this.Ab.name):((y=this.Ab.name)&&(y+="_"),y+=this.Ab.annotations.Qha(this.Ab.query.o8,w));null!=y&&(u=m.a.BNh(l,y,this.Ab.score,z,x,u));return{erd:v,JTc:E+u}}}a.KTc=1;Object(J.a)(a,"QueryTokenStringGenerator",m.a,[])},1908:function(J,L,d){d.r(L);d.d(L,"FuzzyMatchTokenStringGenerator",function(){return f});J=d(0);var m=d(1526);class f extends m.a{constructor(a){super(a);this.Ab=a}apply(a,l,w,z,x,u,v){null==u&&(u=a.JHi(x,l));a=this.Ab.Tji.KDn(u);if(this.Ab.Lnj)for(var E of a)if(!E.cR&&
E.F2d)return{erd:u,JTc:v};E=0;for(const y of a)if(y.cR&&!({Elf:E}=this.vSh(y,!0,w,z,E)).returnValue)return{erd:u,JTc:v};if(this.Ab.fPi)for(const y of a)if(!({Elf:E}=this.vSh(y,!1,w,z,E)).returnValue)break;return{erd:u,JTc:v}}vSh(a,l,w,z,x){let u;l?(l=0,u=a.F2d?1:0):(l=a.F2d?1:0,u=a.count-l);for(let v=0;v<u;++v)if(m.a.CNh(a.zpb+l+v,this.Ab.score,w,z),++x,0<this.Ab.t7f&&x>=this.Ab.t7f)return{returnValue:!1,Elf:x};return{returnValue:!0,Elf:x}}}f.KTc=2;Object(J.a)(f,"FuzzyMatchTokenStringGenerator",m.a,
[])},1983:function(J,L,d){J=d(0);var m=d(59),f=d(5),a=d(40),l=d(267),w=d(1364);class z extends w.a{constructor(){super()}get zo(){return 2}get GB(){return 7}static Eh(){return new z}static get instance(){return z.hh.value}}z.hh=new l.a(z.Eh);Object(J.a)(z,"AppBindingNodeComplexMerge",w.a,[]);var x=d(14),u=d(795),v=d(175),E=d(1441);class y extends w.a{constructor(){super()}get zo(){return 3}get GB(){return 7}el(){const cb=super.el();cb.Z(u.a.zb(x.a.DU),1);return cb}AD(cb,Eb){if(Eb===u.a.zb(x.a.DU)){const tb=
cb.Tl;var mc=cb.kf;v.a.instance.Ua(6633221,1,4,"AppNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",tb.id,tb.wc,Eb);Eb=mc.getPropertyMilliseconds(cb.ih.value.Lf,x.a.DU);mc=mc.getPropertyMilliseconds(cb.Po.value.Lf,x.a.DU);Eb<mc&&this.lkm(cb);cb.Ug.add(u.a.zb(x.a.DU));return!0}v.a.instance.Ua(6633222,1,1,"AppNodeComplexMerge: Failed to merge AppNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.ih.value.Lf.id,Eb);return!1}lkm(cb){this.fAo(cb.Po.value.Lf,
cb.Tl);this.WGf(cb,f.a.CRd);this.WGf(cb,f.a.ahf);this.WGf(cb,f.a.Sgf)}WGf(cb,Eb){var mc=cb.kf,tb=cb.Tl;if(mc.hasProperty(tb,Eb)&&(Eb=mc.getPropertyObjectIds(tb,Eb))&&Eb.length)for(mc=cb.hu.runtime.uv,cb=cb.hu.runtime.Tq,tb=0;tb<Eb.length;tb++){const Xa=Eb.K(tb);if(!mc.lb(Xa))continue;const Mb=mc.K(Xa).JO();cb.add(Xa,new E.a(Mb,!1))}}static Eh(){return new y}static get instance(){return y.hh.value}}y.hh=new l.a(y.Eh);Object(J.a)(y,"AppNodeComplexMerge",w.a,[]);class H extends w.a{constructor(){super()}get zo(){return 4}get GB(){return 7}static Eh(){return new H}static get instance(){return H.hh.value}}
H.hh=new l.a(H.Eh);Object(J.a)(H,"AppPropNodeComplexMerge",w.a,[]);class I extends w.a{constructor(){super()}get zo(){return 5}get GB(){return 7}static Eh(){return new I}static get instance(){return I.hh.value}}I.hh=new l.a(I.Eh);Object(J.a)(I,"AppRefNodeComplexMerge",w.a,[]);var F=d(356),C=d(602),P=d(221),K=d(17);class G{constructor(cb,Eb){this.id=cb;this.E9o=Eb}}Object(J.a)(G,"IdAndTime",null,[]);class R extends w.a{constructor(){super()}get zo(){return 6}el(){const cb=super.el();cb.Z(u.a.zb(f.a.sTa),
1);return cb}AD(cb,Eb){if(Eb===u.a.zb(f.a.sTa)){const mc=cb.Tl,tb=cb.kf;v.a.instance.Ua(6633224,1,4,"AppsNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",mc.id,mc.wc,Eb);Eb=tb.getPropertyObjectIds(cb.ih.value.Ov,f.a.sTa);const Xa=tb.getPropertyObjectIds(cb.ih.value.Lf,f.a.sTa),Mb=tb.getPropertyObjectIds(cb.Po.value.Lf,f.a.sTa);Eb=this.fIn(cb,Eb,Xa,Mb);0<Eb.length?tb.setPropertyObjectIds(mc,f.a.sTa,Eb):mc.removeProperty(f.a.sTa);cb.Ug.add(u.a.zb(f.a.sTa));
return!0}v.a.instance.Ua(6633225,1,1,"AppsNodeComplexMerge: Failed to merge AppsNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.ih.value.Lf.id,Eb);return!1}fIn(cb,Eb,mc,tb){const Xa=this.$La(Eb,mc,tb),Mb=Eb.uS(),cc=mc.uS(),oc=tb.uS();Eb=w.a.filter(Xa,jd=>!Mb.contains(jd)&&cc.contains(jd));mc=w.a.filter(Xa,jd=>!Mb.contains(jd)&&oc.contains(jd));if(!Eb.length||!mc.length)return Xa;const Pc=new F.a;Eb.forEach(jd=>{const ud=new G(jd,this.asi(cb,jd,!1));this.Xri(cb,jd,!1).forEach(qe=>
{Pc.add(qe,ud);return!0});return!0});const vb=new C.a;mc.forEach(jd=>{const ud=this.asi(cb,jd,!0);this.Xri(cb,jd,!0).forEach(qe=>Pc.lb(qe)?(vb.add(Pc.K(qe).E9o>=ud?jd:Pc.K(qe).id),!1):!0);return!0});return w.a.filter(Xa,jd=>!vb.contains(jd))}asi(cb,Eb,mc){return(Eb=this.ela(cb,Eb,mc))?cb.kf.getPropertyMilliseconds(Eb,x.a.DU):0}ela(cb,Eb,mc){cb=mc?cb.hu.runtime.uv:cb.hu.runtime.IA;return cb.lb(Eb)?cb.K(Eb):null}Xri(cb,Eb,mc){const tb=new P.a,Xa=new C.a,Mb=cb.kf;Eb=this.ela(cb,Eb,mc);var cc=this.$Di(Mb,
Eb);if(cc)for(tb.add(cc),Xa.add(cc),Eb=Mb.getPropertyObjectIds(Eb,f.a.CRd),cc=0;Eb&&cc<Eb.length;cc++){const oc=this.$Di(Mb,this.ela(cb,Eb.K(cc),mc));if(!oc)break;Xa.contains(oc)||(tb.add(oc),Xa.add(oc))}return tb}$Di(cb,Eb){if(!cb.hasProperty(Eb,f.a.tTa)||!cb.hasProperty(Eb,f.a.amb)||!cb.hasProperty(Eb,f.a.YJb))return null;const mc=cb.getPropertyString(Eb,f.a.tTa),tb=cb.getPropertyString(Eb,f.a.amb);cb=cb.getPropertyString(Eb,f.a.YJb);return K.a.kC(mc+";"+tb+";"+cb)}static Eh(){return new R}static get instance(){return R.hh.value}}
R.hh=new l.a(R.Eh);Object(J.a)(R,"AppsNodeComplexMerge",w.a,[]);class W extends w.a{constructor(){super()}get zo(){return 36}el(){const cb=super.el();cb.Z(u.a.zb(f.a.RKg),1);cb.Z(u.a.zb(f.a.hzg),1);return cb}AD(cb,Eb){v.a.instance.Ua(51430790,1,4,"AutoSaveParametersNode PropertyId {0}: Using CustomMerge Strategy",Eb);if(Eb===u.a.zb(f.a.RKg)||Eb===u.a.zb(f.a.hzg)){const Mb=u.a.p_(Eb);var mc=cb.ih.value.Lf,tb=cb.Po.value.Lf;const cc=cb.Tl;var Xa=cb.kf.getPropertyStrings(cb.ih.value.Ov,Mb);mc=cb.kf.getPropertyStrings(mc,
Mb);tb=cb.kf.getPropertyStrings(tb,Mb);Xa=this.$La(Xa,mc,tb);cb.kf.setPropertyStrings(cc,Mb,Xa);cb.Ug.add(Eb);return!0}return!1}static Eh(){return new W}static get instance(){return W.hh.value}}W.hh=new l.a(W.Eh);Object(J.a)(W,"AutoSaveParametersNodeComplexMerge",w.a,[]);class Z extends w.a{constructor(){super()}get zo(){return 44}el(){const cb=super.el();cb.Z(u.a.zb(x.a.pg),1);return cb}AD(cb,Eb){const mc=cb.hu.runtime.sc;if(Eb===u.a.zb(x.a.pg))return v.a.instance.Ua(589608865,1,4,"BookmarkContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
cb.Tl.id,cb.Tl.wc,Eb),mc.DI(116),mc.isFeatureEnabled(116)?this.iIn(cb,Eb):this.FIn(cb,Eb),!0;v.a.instance.Ua(589608912,1,1,"BookmarkContainerNodeComplexMerge: Failed to merge BookmarkContainer [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",cb.ih.value.Lf.id,Eb);return!1}iIn(cb,Eb){const mc=u.a.p_(Eb),tb=cb.kf;var Xa=tb.getPropertyObjectIds(cb.ih.value.Ov,mc),Mb=tb.getPropertyObjectIds(cb.ih.value.Lf,mc),cc=tb.getPropertyObjectIds(cb.Po.value.Lf,mc);cc=Z.gNm(cb,Mb,cc);Xa=this.$La(Xa,Mb,
cc);Mb=cb.Tl;0<Xa.length?tb.setPropertyObjectIds(Mb,mc,Xa):Mb.removeProperty(mc);cb.Ug.add(Eb)}static Eh(){return new Z}static get instance(){return Z.hh.value}static gNm(cb,Eb,mc){const tb=new P.a,Xa=new F.a;Eb.forEach(Mb=>{const cc=cb.hu.runtime.IA.K(Mb);cc&&Xa.add(cc.UG(f.a.wu).toString(),Mb);return!0});mc.forEach(Mb=>{var cc=cb.hu.runtime.uv.K(Mb);cc?(cc=cc.UG(f.a.wu).toString(),Xa.lb(cc)&&Xa.get(cc)!==Mb?v.a.instance.Ua(557061773,1,4,"BookmarkContainerNodeComplexMerge: Similar name bookmark found during merge, skipping conflict revision bookmark"):
tb.add(Mb)):tb.add(Mb);return!0});return tb}}Z.hh=new l.a(Z.Eh);Object(J.a)(Z,"BookmarkContainerNodeComplexMerge",w.a,[]);class T extends w.a{constructor(){super()}get zo(){return 41}el(){const cb=super.el();cb.Z(u.a.zb(f.a.sKb),1);cb.Z(u.a.zb(f.a.wu),1);return cb}AD(cb,Eb){return Eb===u.a.zb(f.a.sKb)?(cb.Ug.add(u.a.zb(f.a.sKb)),!0):Eb===u.a.zb(f.a.wu)?(cb.Ug.add(u.a.zb(f.a.wu)),!0):!1}Tf(cb){return cb&&cb.length?!1:!0}static Eh(){return new T}static get instance(){return T.hh.value}}T.hh=new l.a(T.Eh);
Object(J.a)(T,"BookmarkNodeComplexMerge",w.a,[]);class N extends w.a{constructor(){super();this.tce=!1}get zo(){return 7}el(){const cb=super.el();cb.Z(u.a.zb(x.a.pg),1);return cb}AD(cb,Eb){if(Eb===u.a.zb(x.a.pg)){const Xa=cb.Tl,Mb=cb.kf;var mc=cb.hu.runtime.sc;mc&&(this.tce=mc.isFeatureEnabled(67));v.a.instance.Ua(4511579,1,4,"CommentContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Xa.id,Xa.wc,Eb);Eb=Mb.getPropertyObjectIds(cb.ih.value.Ov,x.a.pg);
mc=Mb.getPropertyObjectIds(cb.ih.value.Lf,x.a.pg);var tb=Mb.getPropertyObjectIds(cb.Po.value.Lf,x.a.pg);Eb=this.rIn(Eb,mc,tb);if(this.tce&&0<Eb.length){mc=new Sys.StringBuilder;for(tb=0;tb<Eb.length;tb++)mc.append(Eb.K(tb).toString()+",");v.a.instance.Ua(559710276,1,4,"Merge result for CommentContentNode {0}: {1}",Xa.id,mc.toString())}0<Eb.length?Mb.setPropertyObjectIds(Xa,x.a.pg,Eb):Xa.removeProperty(x.a.pg);cb.Ug.add(u.a.zb(x.a.pg));return!0}v.a.instance.Ua(4511580,1,1,"CommentContentNodeComplexMerge: Failed to merge CommentContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
cb.ih.value.Lf.id,Eb);return!1}rIn(cb,Eb,mc){const tb=new P.a,Xa=new F.a(0);this.Z4l(cb,mc,tb,Xa);return this.qQl(Eb,Xa,tb)}Z4l(cb,Eb,mc,tb){cb=cb||new P.a;Eb=Eb||new P.a;cb.forEach(Xa=>{tb.Z(Xa,1);return!0});Eb.forEach(Xa=>{tb.Ac(Xa).returnValue?tb.Z(Xa,2):(tb.Z(Xa,0),mc.add(Xa));return!0})}qQl(cb,Eb,mc){cb=cb||new P.a;const tb=new P.a,Xa=new P.a,Mb=new P.a;cb.forEach(cc=>{let oc=!0,Pc;({value:Pc}=Eb.Ac(cc)).returnValue&&(0===Pc?Eb.Z(cc,2):1===Pc&&(oc=!1));oc?tb.add(cc):this.tce&&Xa.add(cc);return!0});
mc.forEach(cc=>{let oc=!1,Pc;({value:Pc}=Eb.Ac(cc)).returnValue?0===Pc&&(oc=!0,Eb.Z(cc,2)):v.a.instance.Ua(4511585,1,4,"DetermineMergedListOfCommentNodes: Expected to find Conflicting Comment with [ObjectID: {0}] in conflictChangesMap, but it was not there.",cc);oc?tb.add(cc):this.tce&&Mb.add(cc);return!0});this.A9i(Xa,"Favored");this.A9i(Mb,"Unfavored");return tb}A9i(cb,Eb){if(cb.length){var mc=new Sys.StringBuilder;for(let tb=0;tb<cb.length;tb++)mc.append(cb.K(tb).toString()+",");v.a.instance.Ua(561637572,
1,4,"DetermineMergedListOfCommentNodes: Removed {0} ObjectIds: {1}",Eb,mc.toString())}}static Eh(){return new N}static get instance(){return N.hh.value}}N.hh=new l.a(N.Eh);Object(J.a)(N,"CommentContentNodeComplexMerge",w.a,[]);var U=d(83),ba=d(29);class X extends w.a{constructor(){super();this.xFh=[1];this.E4e=new F.a}get zo(){return 8}el(){const cb=super.el();cb.Z(u.a.zb(f.a.wea),3);cb.Z(u.a.zb(f.a.MG),3);cb.Z(u.a.zb(f.a.Cec),2);cb.Z(u.a.zb(f.a.commentId),2);cb.Z(u.a.zb(f.a.kpf),2);cb.Z(u.a.zb(f.a.tIa),
2);cb.Z(u.a.zb(f.a.ZTa),1);cb.Z(u.a.zb(f.a.vrb),1);cb.Z(u.a.zb(f.a.Csb),1);cb.Z(u.a.zb(f.a.KT),1);cb.Z(u.a.zb(f.a.uI),1);cb.Z(u.a.zb(f.a.qVc),2);cb.Z(u.a.zb(f.a.LVd),2);cb.Z(u.a.zb(f.a.yLb),2);cb.Z(u.a.zb(f.a.mpf),2);cb.Z(u.a.zb(f.a.LO),1);cb.Z(u.a.zb(x.a.pg),0);cb.Z(u.a.zb(f.a.FJ),0);return cb}AD(cb,Eb){if(Eb===u.a.zb(f.a.LO)){var mc=cb.kf.getPropertyString(cb.Po.value.Lf,f.a.LO);this.Tf(mc)?cb.Tl.removeProperty(f.a.LO):cb.Tl.Rdb(f.a.LO,mc);return!0}if(Eb!==u.a.zb(f.a.ZTa)&&Eb!==u.a.zb(f.a.vrb)&&
Eb!==u.a.zb(f.a.Csb)&&Eb!==u.a.zb(f.a.uI)&&Eb!==u.a.zb(f.a.KT))return!1;var tb=cb.ih.value.Ov;const Xa=cb.ih.value.Lf;var Mb=cb.Po.value.Lf;mc=cb.Tl;if(Eb===u.a.zb(f.a.ZTa)){tb=cb.kf.getPropertyString(Xa,f.a.ZTa);Mb=cb.kf.getPropertyString(Mb,f.a.ZTa);Mb=this.Tf(tb)?Mb:this.Tf(Mb)?tb:null;if(this.Tf(Mb))return!0;cb.kf.setPropertyString(mc,f.a.ZTa,Mb);cb.Ug.add(u.a.zb(f.a.ZTa));return!0}if(Eb===u.a.zb(f.a.Csb))return tb=cb.kf.getPropertyBool(Xa,f.a.Csb),Mb=cb.kf.getPropertyBool(Mb,f.a.Csb),tb=null!=
tb?tb:!1,tb=(null!=Mb?Mb:!1)||tb,cb.kf.setPropertyBool(mc,f.a.Csb,tb),cb.Ug.add(u.a.zb(f.a.Csb)),!0;if(Eb===u.a.zb(f.a.vrb)){tb=cb.kf.getPropertyBool(Xa,f.a.vrb);Mb=cb.kf.getPropertyBool(Mb,f.a.vrb);if(tb===Mb)return!0;tb=null!=tb?tb:!1;tb=(null!=Mb?Mb:!1)||tb;cb.kf.setPropertyBool(mc,f.a.vrb,tb);return!0}if(Eb===u.a.zb(f.a.uI)){tb=cb.kf.getPropertyBool(Xa,f.a.uI);Mb=cb.kf.getPropertyBool(Mb,f.a.uI);if(tb===Mb)return!0;tb=null!=tb?tb:!1;tb=(null!=Mb?Mb:!1)||tb;cb.kf.setPropertyBool(mc,f.a.uI,tb);
cb.Ug.add(u.a.zb(f.a.uI));return!0}if(Eb===u.a.zb(f.a.KT)){Eb=cb.hu.runtime.sc;Eb.DI(11);if(Eb.isFeatureEnabled(11))return this.oul(cb,tb,Xa,Mb,mc);tb=cb.kf.getPropertyString(Xa,f.a.KT);Mb=cb.kf.getPropertyString(Mb,f.a.KT);if(tb===Mb)return!0;cb.kf.setPropertyString(mc,f.a.KT,Mb||tb);cb.Ug.add(u.a.zb(f.a.KT));return!0}return!1}oul(cb,Eb,mc,tb,Xa){mc=cb.kf.getPropertyString(mc,f.a.KT);tb=cb.kf.getPropertyString(tb,f.a.KT);if(mc===tb)return!0;Eb=cb.kf.getPropertyString(Eb,f.a.KT);const Mb={};for(let oc=
0;oc<this.xFh.length;oc++){const Pc=this.xFh[oc];var cc=this.WLf(Eb,Pc,0);const vb=this.WLf(mc,Pc,1),jd=this.WLf(tb,Pc,2);cc=this.NIn(cc,vb,jd);Mb[Pc.toString()]=cc.toArray()}cb.kf.setPropertyString(Xa,f.a.KT,this.nNo(Mb));cb.Ug.add(u.a.zb(f.a.KT));return!0}NIn(cb,Eb,mc){const tb=new F.a,Xa=new F.a(0);for(var Mb=0;Mb<Eb.length;Mb++){const oc=Eb[Mb].UserId;tb.add(oc,Eb[Mb]);Xa.add(oc,0)}for(Eb=0;Eb<mc.length;Eb++)Mb=mc[Eb].UserId,Xa.lb(Mb)?Xa.Z(Mb,2):(tb.add(Mb,mc[Eb]),Xa.add(Mb,0));for(mc=0;mc<cb.length;mc++)Eb=
cb[mc].UserId,Xa.lb(Eb)&&2!==Xa.K(Eb)&&Xa.Z(Eb,1);const cc=new P.a;Xa.forEach((oc,Pc)=>{if(1===Pc)return!0;cc.add(tb.K(oc));return!0});return cc}WLf(cb,Eb,mc){cb=Object(U.a)(Object,this.ZEm(cb,mc));return Eb.toString()in cb?Array.isArray(cb[Eb.toString()])?cb[Eb.toString()]:null:[]}ZEm(cb,Eb){if(this.E4e.lb(Eb))return Object(U.a)(Object,this.E4e.K(Eb));cb=Object(U.a)(Object,this.aPl(cb));this.E4e.add(Eb,cb);return cb}aPl(cb){return Object(U.a)(Object,ba.b(cb))}nNo(cb){return ba.c(cb)}Tf(cb){return cb&&
cb.length?!1:!0}static Eh(){return new X}static get instance(){return X.hh.value}}X.hh=new l.a(X.Eh);Object(J.a)(X,"CommentNodeComplexMerge",w.a,[]);class Y extends w.a{constructor(){super()}get zo(){return 46}el(){const cb=super.el();cb.Z(u.a.zb(f.a.Wd),1);cb.Z(u.a.zb(x.a.lastModifiedTime),0);cb.Z(u.a.zb(f.a.VVc),2);return cb}AD(cb,Eb){if(Eb===u.a.zb(f.a.Wd))return v.a.instance.Ua(556865370,1,4,"ContentControlContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
cb.Tl.id,cb.Tl.wc,Eb),w.a.M7f(cb,this,f.a.Wd);v.a.instance.Ua(556865371,1,1,"ContentControlContainerNodeComplexMerge: Failed to merge ContentControlContainerNode [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",cb.ih.value.Lf.id,Eb);return!1}static Eh(){return new Y}static get instance(){return Y.hh.value}}Y.hh=new l.a(Y.Eh);Object(J.a)(Y,"ContentControlContainerNodeComplexMerge",w.a,[]);var ca=d(34),ia=d(48),la=d(1771);class ta extends w.a{constructor(){super()}get zo(){return 37}el(){const cb=
super.el();cb.Z(u.a.zb(f.a.faa),1);cb.Z(u.a.zb(f.a.Dzb),1);cb.Z(u.a.zb(f.a.DWd),2);cb.Z(u.a.zb(f.a.NLb),2);cb.Z(u.a.zb(f.a.Wd),1);cb.Z(u.a.zb(f.a.aba),1);cb.Z(u.a.zb(f.a.Xja),1);cb.Z(u.a.zb(f.a.Xec),1);cb.Z(u.a.zb(f.a.znb),1);cb.Z(u.a.zb(f.a.wnb),1);cb.Z(u.a.zb(f.a.vnb),1);cb.Z(u.a.zb(f.a.eUa),2);cb.Z(u.a.zb(f.a.PLb),1);cb.Z(u.a.zb(f.a.EWd),1);cb.Z(u.a.zb(f.a.eaa),1);cb.Z(u.a.zb(f.a.DL),2);cb.Z(u.a.zb(f.a.Zza),2);cb.Z(u.a.zb(f.a.Jra),2);cb.Z(u.a.zb(f.a.i3),1);cb.Z(u.a.zb(f.a.Xsa),1);cb.Z(u.a.zb(f.a.Ysa),
1);this.sc.isFeatureEnabled(16)&&(cb.Z(u.a.zb(ca.a.Gqf),2),cb.Z(u.a.zb(ca.a.C5h),2),cb.Z(u.a.zb(ca.a.B5h),2),cb.Z(u.a.zb(ca.a.K5h),2),cb.Z(u.a.zb(ca.a.J5h),2));return cb}AD(cb,Eb){var mc=cb.ih.value.Lf,tb=cb.Po.value.Lf;const Xa=cb.Tl;if(Eb===u.a.zb(f.a.Wd))return w.a.M7f(cb,this,f.a.Wd);if(Eb===u.a.zb(f.a.aba)){Eb=cb.kf.getPropertyBool(mc,f.a.aba);tb=cb.kf.getPropertyBool(tb,f.a.aba);if(null!=Eb&&Eb||null!=tb&&tb)cb.kf.setPropertyBool(Xa,f.a.aba,!0),cb.Ug.add(u.a.zb(f.a.aba));return!0}if(Eb===u.a.zb(f.a.Xja))return Eb=
cb.kf.getPropertyBool(mc,f.a.Xja),tb=cb.kf.getPropertyBool(tb,f.a.Xja),cb.kf.setPropertyBool(Xa,f.a.Xja,null!=Eb&&!!Eb&&null!=tb&&!!tb),cb.Ug.add(u.a.zb(f.a.Xja)),!0;if(Eb===u.a.zb(f.a.Xec))return Eb=cb.kf.getPropertyUint32(tb,f.a.Xec),null!=Eb&&(cb.kf.setPropertyUint32(Xa,f.a.Xec,Eb),cb.Ug.add(u.a.zb(f.a.Xec))),!0;if(Eb===u.a.zb(f.a.znb)||Eb===u.a.zb(f.a.wnb)||Eb===u.a.zb(f.a.vnb))return(tb=cb.kf.getPropertyString(tb,u.a.p_(Eb)))&&0<tb.length&&(cb.kf.setPropertyString(Xa,u.a.p_(Eb),tb),cb.Ug.add(Eb)),
!0;if(Eb===u.a.zb(f.a.PLb)||Eb===u.a.zb(f.a.EWd)){mc=cb.kf.getPropertyObjectId(mc,u.a.p_(Eb));if(la.a.vjc(cb.hu,mc))return!0;if((tb=cb.kf.getPropertyObjectId(tb,u.a.p_(Eb)))&&tb!==ia.a.nil)return cb.kf.setPropertyObjectId(Xa,u.a.p_(Eb),tb),cb.Ug.add(Eb),!0;Xa.removeProperty(u.a.p_(Eb));cb.Ug.add(Eb);return!0}if(Eb===u.a.zb(f.a.eaa)){mc=cb.kf.getPropertyObjectId(mc,f.a.eaa);if((mc=la.a.vjc(cb.hu,mc))&&cb.kf.getPropertyObjectIds(mc,f.a.Wd).uS().contains(cb.Tl.id))return!0;tb=cb.kf.getPropertyObjectId(tb,
f.a.eaa);return(mc=la.a.vjc(cb.hu,tb))&&cb.kf.getPropertyObjectIds(mc,f.a.Wd).uS().contains(cb.Tl.id)?(cb.kf.setPropertyObjectId(Xa,f.a.eaa,tb),cb.Ug.add(Eb),!0):!1}if(Eb===u.a.zb(f.a.faa))return Eb=cb.kf.getPropertyBool(tb,f.a.faa),null==Eb||Eb||(cb.kf.setPropertyBool(Xa,f.a.faa,!1),cb.Ug.add(u.a.zb(f.a.faa))),!0;if(Eb===u.a.zb(f.a.Dzb)){Eb=cb.kf.getPropertyObjectId(mc,f.a.Dzb);tb=cb.kf.getPropertyObjectId(tb,f.a.Dzb);if(Eb&&!Eb.equals(tb))return!1;if(Eb=Eb||tb)cb.kf.setPropertyObjectId(Xa,f.a.Dzb,
Eb),cb.Ug.add(u.a.zb(f.a.Dzb));return!0}Eb!==u.a.zb(f.a.i3)&&Eb!==u.a.zb(f.a.Xsa)&&Eb!==u.a.zb(f.a.Ysa)||v.a.instance.Ua(512274638,1,1,"ContentControlNodeComplexMerge: Unexpected merge conflict for inserted tracked change property [PropertyId: {1}]",Eb);return!1}static Eh(){return new ta}static get instance(){return ta.hh.value}}ta.hh=new l.a(ta.Eh);Object(J.a)(ta,"ContentControlNodeComplexMerge",w.a,[]);class za extends w.a{constructor(){super()}get zo(){return 10}el(){const cb=super.el();cb.Z(u.a.zb(f.a.XQ),
1);return cb}AD(cb,Eb){if(Eb===u.a.zb(f.a.XQ)){Eb=cb.Tl;const tb=cb.kf;var mc=tb.getPropertyObjectIds(cb.ih.value.Ov,f.a.XQ);const Xa=tb.getPropertyObjectIds(cb.ih.value.Lf,f.a.XQ),Mb=tb.getPropertyObjectIds(cb.Po.value.Lf,f.a.XQ);mc=this.vIn(mc,Xa,Mb);0<mc.length?tb.setPropertyObjectIds(Eb,f.a.XQ,mc):Eb.removeProperty(f.a.XQ);cb.Ug.add(u.a.zb(f.a.XQ));return!0}return!1}vIn(cb,Eb,mc){return this.$La(cb,Eb,mc)}static Eh(){return new za}static get instance(){return za.hh.value}}za.hh=new l.a(za.Eh);
Object(J.a)(za,"CustomXmlPartContainerNodeComplexMerge",w.a,[]);class Ha extends w.a{constructor(){super()}get zo(){return 9}get GB(){return 0}static Eh(){return new Ha}static get instance(){return Ha.hh.value}}Ha.hh=new l.a(Ha.Eh);Object(J.a)(Ha,"CustomXmlPartNodeComplexMerge",w.a,[]);class Na extends w.a{constructor(){super()}get zo(){return 29}get GB(){return 3}el(){const cb=super.el();cb.Z(u.a.zb(f.a.uka),1);return cb}AD(cb,Eb){if(Eb===u.a.zb(f.a.uka)){Eb=cb.kf;var mc=Eb.getPropertyObjectIds(cb.ih.value.Ov,
f.a.uka),tb=Eb.getPropertyObjectIds(cb.ih.value.Lf,f.a.uka);const Xa=Eb.getPropertyObjectIds(cb.Po.value.Lf,f.a.uka);mc=this.$La(mc,tb,Xa);tb=cb.Tl;0<mc.length?Eb.setPropertyObjectIds(tb,f.a.uka,mc):tb.removeProperty(f.a.uka);cb.Ug.add(u.a.zb(f.a.uka));return!0}return!1}static Eh(){return new Na}static get instance(){return Na.hh.value}}Na.hh=new l.a(Na.Eh);Object(J.a)(Na,"EmbeddedFontContainerNodeComplexMerge",w.a,[]);class ya extends w.a{constructor(){super()}get zo(){return 30}get GB(){return 3}static Eh(){return new ya}static get instance(){return ya.hh.value}}
ya.hh=new l.a(ya.Eh);Object(J.a)(ya,"EmbeddedFontNodeComplexMerge",w.a,[]);class ma extends w.a{constructor(){super()}get zo(){return 11}el(){const cb=super.el();cb.Z(u.a.zb(f.a.V6),4);cb.Z(u.a.zb(f.a.VJa),1);return cb}AD(cb,Eb){if(Eb===u.a.zb(f.a.VJa)){const mc=cb.Tl,tb=cb.kf;v.a.instance.Ua(4063307,1,4,"FootnoteEndnoteContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",mc.id,mc.wc,Eb);Eb=tb.getPropertyObjectIds(cb.ih.value.Ov,f.a.VJa);const Xa=tb.getPropertyObjectIds(cb.ih.value.Lf,
f.a.VJa),Mb=tb.getPropertyObjectIds(cb.Po.value.Lf,f.a.VJa);Eb=this.ncj(Eb,Xa,Mb,(cc,oc)=>cc.equals(oc));0<Eb.length?tb.setPropertyObjectIds(mc,f.a.VJa,Eb):mc.removeProperty(f.a.VJa);cb.Ug.add(u.a.zb(f.a.VJa));return!0}v.a.instance.Ua(4063308,1,1,"FootnoteEndnoteContainerNodeComplexMerge: Failed to merge FootnoteEndnoteContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.ih.value.Lf.id,Eb);return!1}static Eh(){return new ma}static get instance(){return ma.hh.value}}ma.hh=new l.a(ma.Eh);
Object(J.a)(ma,"FootnoteEndnoteContainerNodeComplexMerge",w.a,[]);class Ea extends w.a{constructor(){super()}get zo(){return 12}get GB(){return 3}el(){const cb=super.el();cb.Z(u.a.zb(f.a.jsa),1);return cb}AD(cb,Eb){const mc=cb.Tl,tb=cb.kf;if(Eb===u.a.zb(f.a.jsa)){let Xa=-1;v.a.instance.Ua(5002527,1,4,"FootnoteEndnoteNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",mc.id,mc.wc,Eb);const Mb=tb.getPropertyInt32(cb.ih.value.Lf,f.a.jsa),cc=tb.getPropertyInt32(cb.Po.value.Lf,
f.a.jsa);null!=Mb&&-1!==Mb?Xa=Mb:null!=cc&&(Xa=cc);tb.setPropertyInt32(mc,f.a.jsa,Xa);cb.Ug.add(Eb);return!0}v.a.instance.Ua(5002528,1,4,"FootnoteEndnoteNodeComplexMerge: Failed to merge FootnoteEndnoteNodeComplexMerge [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.ih.value.Ov.id,Eb);return!1}static Eh(){return new Ea}static get instance(){v.a.instance.Ua(5002526,1,4,"FootnoteEndnoteNodeComplexMerge: Got Instance");return Ea.hh.value}}Ea.hh=new l.a(Ea.Eh);Object(J.a)(Ea,"FootnoteEndnoteNodeComplexMerge",
w.a,[]);class Ba extends w.a{constructor(){super()}get zo(){return 47}el(){const cb=super.el();cb.Z(u.a.zb(f.a.XVa),1);return cb}AD(cb,Eb){return Eb===u.a.zb(f.a.XVa)?(v.a.instance.Ua(525099865,1,4,"GlossaryPageManifestNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",cb.Tl.id,cb.Tl.wc,Eb),w.a.M7f(cb,this,f.a.XVa)):!1}static Eh(){return new Ba}static get instance(){return Ba.hh.value}}Ba.hh=new l.a(Ba.Eh);Object(J.a)(Ba,"GlossaryPageManifestNodeComplexMerge",
w.a,[]);class $a extends w.a{constructor(){super()}get zo(){return 13}get GB(){return 3}el(){const cb=super.el();cb.Z(u.a.zb(f.a.jna),4);return cb}static Eh(){return new $a}static get instance(){return $a.hh.value}}$a.hh=new l.a($a.Eh);Object(J.a)($a,"HeaderFooterContainerNodeComplexMerge",w.a,[]);class ea extends w.a{constructor(){super()}get zo(){return 14}get GB(){return 3}el(){const cb=super.el();cb.Z(u.a.zb(f.a.runId),3);cb.Z(u.a.zb(f.a.Yc),3);cb.Z(u.a.zb(f.a.wTi),3);cb.Z(u.a.zb(f.a.kX),1);cb.Z(u.a.zb(a.a.Q_),
1);cb.Z(u.a.zb(x.a.imageAltText),1);cb.Z(u.a.zb(f.a.O_),1);cb.Z(u.a.zb(x.a.Tba),1);cb.Z(u.a.zb(a.a.Ifb),1);cb.Z(u.a.zb(f.a.qTa),1);return cb}AD(cb,Eb){if(Eb===u.a.zb(x.a.imageAltText)||Eb===u.a.zb(f.a.O_)||Eb===u.a.zb(f.a.kX)||Eb===u.a.zb(f.a.P_)||Eb===u.a.zb(x.a.Jrb)||Eb===u.a.zb(x.a.Tba)||Eb===u.a.zb(a.a.Q_)||Eb===u.a.zb(a.a.Ifb)||Eb===u.a.zb(f.a.qTa)){const tb=cb.Tl;var mc=cb.kf;v.a.instance.Ua(4018185,1,4,"ImageNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
tb.id,tb.wc,Eb);const Xa=mc.getPropertyInt32(cb.ih.value.Lf,a.a.Q_);mc=mc.getPropertyInt32(cb.Po.value.Lf,a.a.Q_);if(null!=Xa&&(0===Xa||2===Xa))return!0;if(null!=mc&&(0===mc||2===mc))return Eb=cb.Po.value.Lf,this.Hnb(Eb,tb,x.a.imageAltText),this.Hnb(Eb,tb,f.a.O_),this.Hnb(Eb,tb,f.a.P_),Eb.hasProperty(f.a.kX)&&this.Hnb(Eb,tb,f.a.kX),this.Hnb(Eb,tb,x.a.Jrb),this.Hnb(Eb,tb,x.a.Tba),this.Hnb(Eb,tb,a.a.Q_),this.Hnb(Eb,tb,a.a.Ifb),cb.Ug.add(u.a.zb(x.a.imageAltText)),cb.Ug.add(u.a.zb(f.a.O_)),cb.Ug.add(u.a.zb(f.a.P_)),
cb.Ug.add(u.a.zb(f.a.kX)),cb.Ug.add(u.a.zb(x.a.Jrb)),cb.Ug.add(u.a.zb(x.a.Tba)),cb.Ug.add(u.a.zb(a.a.Q_)),cb.Ug.add(u.a.zb(a.a.Ifb)),cb.Ug.add(u.a.zb(f.a.qTa)),!0}v.a.instance.Ua(4018186,1,4,"ImageNodeComplexMerge: Failed to merge ImageNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.ih.value.Ov.id,Eb);return!1}static Eh(){return new ea}static get instance(){return ea.hh.value}}ea.hh=new l.a(ea.Eh);Object(J.a)(ea,"ImageNodeComplexMerge",w.a,[]);class ka extends w.a{constructor(){super()}get zo(){return 40}get GB(){return 0}static Eh(){return new ka}static get instance(){return ka.hh.value}}
ka.hh=new l.a(ka.Eh);Object(J.a)(ka,"IntelligenceAnnotationNodeComplexMerge",w.a,[]);class La extends w.a{constructor(){super()}get zo(){return 32}get GB(){return 0}static Eh(){return new La}static get instance(){return La.hh.value}}La.hh=new l.a(La.Eh);Object(J.a)(La,"IntelligenceContentLocatorNodeComplexMerge",w.a,[]);class va extends w.a{constructor(){super()}get zo(){return 34}get GB(){return 0}el(){const cb=super.el();cb.Z(u.a.zb(f.a.LWa),1);return cb}AD(cb,Eb){const mc=cb.Tl,tb=cb.kf;if(Eb===
u.a.zb(f.a.LWa)){Eb=tb.getPropertyObjectIds(cb.ih.value.Ov,f.a.LWa);const Xa=tb.getPropertyObjectIds(cb.ih.value.Lf,f.a.LWa),Mb=tb.getPropertyObjectIds(cb.Po.value.Lf,f.a.LWa);Eb=this.$La(Eb,Xa,Mb);tb.setPropertyObjectIds(mc,f.a.LWa,Eb);cb.Ug.add(u.a.zb(f.a.LWa));return!0}return!1}static Eh(){return new va}static get instance(){return va.hh.value}}va.hh=new l.a(va.Eh);Object(J.a)(va,"IntelligenceRegionNodeComplexMerge",w.a,[]);class Ca extends w.a{constructor(){super()}get zo(){return 35}get GB(){return 0}static Eh(){return new Ca}static get instance(){return Ca.hh.value}}
Ca.hh=new l.a(Ca.Eh);Object(J.a)(Ca,"IntelligenceRejectionNodeComplexMerge",w.a,[]);class ua extends w.a{constructor(){super()}get zo(){return 39}get GB(){return 0}static Eh(){return new ua}static get instance(){return ua.hh.value}}ua.hh=new l.a(ua.Eh);Object(J.a)(ua,"IntelligenceReviewedNodeComplexMerge",w.a,[]);class Sa extends w.a{constructor(){super()}get zo(){return 33}get GB(){return 0}el(){const cb=super.el();cb.Z(u.a.zb(f.a.ymc),1);cb.Z(u.a.zb(f.a.xmc),1);cb.Z(u.a.zb(f.a.pbe),1);cb.Z(u.a.zb(f.a.rbe),
1);return cb}AD(cb,Eb){const mc=cb.Tl,tb=cb.kf;if(Eb===u.a.zb(f.a.ymc)||Eb===u.a.zb(f.a.xmc)||Eb===u.a.zb(f.a.pbe)||Eb===u.a.zb(f.a.rbe)){Eb=Eb===u.a.zb(f.a.ymc)?f.a.ymc:f.a.xmc;var Xa=tb.getPropertyObjectIds(cb.ih.value.Ov,Eb);const Mb=tb.getPropertyObjectIds(cb.ih.value.Lf,Eb),cc=tb.getPropertyObjectIds(cb.Po.value.Lf,Eb);Xa=this.$La(Xa,Mb,cc);tb.setPropertyObjectIds(mc,Eb,Xa);cb.Ug.add(u.a.zb(Eb));return!0}return!1}static Eh(){return new Sa}static get instance(){return Sa.hh.value}}Sa.hh=new l.a(Sa.Eh);
Object(J.a)(Sa,"IntelligenceRootNodeComplexMerge",w.a,[]);class Ta extends w.a{constructor(){super()}get zo(){return 42}get GB(){return 0}static Eh(){return new Ta}static get instance(){return Ta.hh.value}}Ta.hh=new l.a(Ta.Eh);Object(J.a)(Ta,"IntelligenceSettingNodeComplexMerge",w.a,[]);class zb extends w.a{constructor(){super()}get zo(){return 45}get GB(){return 0}static Eh(){return new zb}static get instance(){return zb.hh.value}}zb.hh=new l.a(zb.Eh);Object(J.a)(zb,"IntelligenceWorkflowNodeComplexMerge",
w.a,[]);class Ra extends w.a{constructor(){super()}get zo(){return 15}get GB(){return 3}static Eh(){return new Ra}static get instance(){return Ra.hh.value}}Ra.hh=new l.a(Ra.Eh);Object(J.a)(Ra,"NumberListNodeComplexMerge",w.a,[]);var qb=d(110);class kb extends w.a{constructor(){super()}get zo(){return 16}get GB(){return 0}el(){const cb=super.el();cb.Z(u.a.zb(f.a.eKb),1);cb.Z(u.a.zb(qb.a.upf),7);cb.Z(u.a.zb(qb.a.spf),7);return cb}AD(cb,Eb){const mc=cb.Tl,tb=cb.kf;if(Eb===u.a.zb(f.a.eKb))return this.r1f(tb,
cb.ih.value.Lf,cb.Po.value.Lf,mc,f.a.eKb),cb.Ug.add(Eb),!0;v.a.instance.Ua(4207940,1,4,"OutlineElementNodeComplexMerge: Failed to merge OutlineElementNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.ih.value.Ov.id,Eb);return!1}static Eh(){return new kb}static get instance(){return kb.hh.value}}kb.hh=new l.a(kb.Eh);Object(J.a)(kb,"OutlineElementNodeComplexMerge",w.a,[]);class Va extends w.a{constructor(){super()}get zo(){return 17}el(){const cb=super.el();cb.Z(u.a.zb(f.a.eKb),1);
cb.Z(u.a.zb(f.a.nka),1);cb.Z(u.a.zb(qb.a.NJ),1);cb.Z(u.a.zb(qb.a.xpc),1);cb.Z(u.a.zb(qb.a.Bma),8);return cb}AD(cb,Eb){const mc=cb.Tl,tb=cb.kf;if(Eb===u.a.zb(f.a.eKb))return this.r1f(tb,cb.ih.value.Lf,cb.Po.value.Lf,mc,f.a.eKb),cb.Ug.add(Eb),!0;if(Eb===u.a.zb(f.a.nka)){var Xa=tb.getPropertyBool(cb.ih.value.Lf,f.a.nka),Mb=tb.getPropertyBool(cb.Po.value.Lf,f.a.nka);tb.setPropertyBool(mc,f.a.nka,null==Xa?!1:Xa&&null==Mb?!1:Mb);cb.Ug.add(Eb);return!0}if(Eb===u.a.zb(qb.a.xpc))return this.r1f(tb,cb.ih.value.Lf,
cb.Po.value.Lf,mc,qb.a.xpc),cb.Ug.add(Eb),!0;if(Eb===u.a.zb(qb.a.NJ))return Xa=tb.getPropertyBool(cb.ih.value.Lf,qb.a.NJ),Mb=tb.getPropertyBool(cb.Po.value.Lf,qb.a.NJ),tb.setPropertyBool(mc,qb.a.NJ,null==Xa?!0:Xa||null==Mb?!0:Mb),cb.Ug.add(Eb),!0;v.a.instance.Ua(4057305,1,4,"OutlineGroupNodeComplexMerge: Failed to merge OutlineGroupNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.ih.value.Ov.id,Eb);return!1}static Eh(){return new Va}static get instance(){return Va.hh.value}}Va.hh=
new l.a(Va.Eh);Object(J.a)(Va,"OutlineGroupNodeComplexMerge",w.a,[]);var Za=d(108);class Ka extends w.a{constructor(){super()}get zo(){return 18}get GB(){return 2}el(){const cb=super.el();cb.Z(u.a.zb(f.a.V9d),3);cb.Z(u.a.zb(x.a.cS),this.GB);cb.Z(u.a.zb(f.a.Xs),1);cb.Z(u.a.zb(f.a.a8),1);cb.Z(u.a.zb(f.a.Sq),1);cb.Z(u.a.zb(ca.a.FF),1);cb.Z(u.a.zb(ca.a.tYa),1);return cb}AD(cb,Eb){const mc=cb.kf;if(cb.hu.runtime.sc.isFeatureEnabled(64)){if(Eb===u.a.zb(f.a.Xs)||Eb===u.a.zb(f.a.a8)||Eb===u.a.zb(ca.a.tYa)||
Eb===u.a.zb(f.a.Sq)||Eb===u.a.zb(ca.a.FF))return this.znp(mc,cb)}else if(Eb===u.a.zb(f.a.Xs)||Eb===u.a.zb(f.a.Sq)){let tb,Xa;({FVc:Eb,N$a:tb,E$a:Xa}=this.snf(Object(Za.a)(mc,mc.getPropertyUint32s,"getPropertyUint32s"),cb.ih.value.Ov,cb.ih.value.Lf,cb.Po.value.Lf,f.a.Xs,null));if(!Xa&&!tb)return v.a.instance.Ua(4318873,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",cb.ih.value.Lf.id,u.a.zb(f.a.Xs)),!0;let Mb,cc,oc;({FVc:Mb,
N$a:cc,E$a:oc}=this.snf(Object(Za.a)(mc,mc.getPropertyObjectIds,"getPropertyObjectIds"),cb.ih.value.Ov,cb.ih.value.Lf,cb.Po.value.Lf,f.a.Sq,null));if(!cc&&!oc)return v.a.instance.Ua(4318874,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",cb.ih.value.Lf.id,u.a.zb(f.a.Sq)),!0;const Pc=cc&&!oc;if((tb&&!Xa)!==Pc)return v.a.instance.Ua(4318875,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
cb.ih.value.Lf.id,u.a.zb(f.a.Xs),u.a.zb(f.a.Sq)),!1;Pc&&(mc.setPropertyObjectIds(cb.Tl,f.a.Sq,Mb),mc.setPropertyUint32s(cb.Tl,f.a.Xs,Eb));v.a.instance.Ua(4318877,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [PropertyId: {1}] [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}]. [PropertyId: {3}] [favoredEquivalentToBase: {4}] [conflictEquivalentToBase: {5}]",cb.ih.value.Lf.id,u.a.zb(f.a.Xs),tb,Xa,u.a.zb(f.a.Sq),cc,oc);cb.Ug.add(u.a.zb(f.a.Sq));cb.Ug.add(u.a.zb(f.a.Xs));
return!0}v.a.instance.Ua(4318878,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.ih.value.Lf.id,Eb);return!1}zMi(cb,Eb,mc,tb){let Xa;({FVc:Eb,N$a:tb,E$a:Xa}=this.snf(Eb,mc.ih.value.Ov,mc.ih.value.Lf,mc.Po.value.Lf,cb,tb));return Xa||tb?{returnValue:!0,Wpf:Eb,N$a:tb,E$a:Xa}:(v.a.instance.Ua(592545113,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
mc.ih.value.Lf.id.toString(),u.a.zb(cb)),{returnValue:!1,Wpf:Eb,N$a:tb,E$a:Xa})}ALi(cb,Eb,mc,tb,Xa){let Mb;let cc,oc,Pc,vb;({Wpf:Mb,N$a:jd,E$a:cc,returnValue:Pc}=this.zMi(cb,Object(Za.a)(mc,mc.getPropertyUint32s,"getPropertyUint32s"),tb,null));({Wpf:mc,N$a:Xa,E$a:oc,returnValue:vb}=this.zMi(Eb,Object(Za.a)(mc,mc.getPropertyObjectIds,"getPropertyObjectIds"),tb,Xa));var jd=jd&&!cc;return Pc&&vb?jd!==(Xa&&!oc)?(v.a.instance.Ua(592545114,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
tb.ih.value.Lf.id.toString(),u.a.zb(cb),u.a.zb(Eb)),{returnValue:2,oWd:Mb,nWd:mc,gBe:jd}):{returnValue:0,oWd:Mb,nWd:mc,gBe:jd}:{returnValue:1,oWd:Mb,nWd:mc,gBe:jd}}AXf(cb){let Eb=!0;cb.forEach(mc=>mc!==ia.a.nil?Eb=!1:!0);return Eb}$om(cb,Eb,mc){return this.AXf(cb)&&this.AXf(Eb)&&this.AXf(mc)?!0:!1}znp(cb,Eb){let mc,tb,Xa,Mb,cc,oc;var Pc=({oWd:Mb,nWd:cc,gBe:tb}=this.ALi(ca.a.tYa,f.a.Sq,cb,Eb,null)).returnValue;if(2===Pc||1===Pc)return!0;({oWd:Xa,nWd:oc,gBe:mc,returnValue:Pc}=this.ALi(f.a.Xs,f.a.a8,
cb,Eb,Object(Za.a)(this,this.$om,"getExtendedGuidEquivalence")));if(2===Pc||1===Pc)return!0;let vb;({FVc:Pc,N$a:jd,E$a:vb}=this.vml(Object(Za.a)(cb,cb.getPropertyDictionary,"getPropertyDictionary"),Eb.ih.value.Ov,Eb.ih.value.Lf,Eb.Po.value.Lf,ca.a.FF));if(!vb&&!jd)return v.a.instance.Ua(592545115,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",Eb.ih.value.Lf.id.toString(),u.a.zb(ca.a.FF)),!0;var jd=jd&&!vb;if(mc!==tb||mc!==
jd)return v.a.instance.Ua(592545116,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}], [PropertyId: {2}] and [PropertyId: {3}] differently. [takeConflictingAbsListId: {4}] [takeConflictingListId: {5}] [takeConflictingMap: {6}]",Eb.ih.value.Lf.id.toString(),u.a.zb(f.a.Xs),u.a.zb(ca.a.tYa),u.a.zb(ca.a.FF),tb,mc,jd),!0;mc&&(cb.setPropertyObjectIds(Eb.Tl,f.a.Sq,cc),cb.setPropertyUint32s(Eb.Tl,ca.a.tYa,Mb),cb.setPropertyObjectIds(Eb.Tl,
f.a.a8,oc),cb.setPropertyUint32s(Eb.Tl,f.a.Xs,Xa),cb.setPropertyDictionary(Eb.Tl,ca.a.FF,Pc));v.a.instance.Ua(592545118,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [takeConflictingNSID: {1}] [takeConflictingListId: {2}] [takeConflictingMap: {3}]",Eb.ih.value.Lf.id.toString(),tb,mc,jd);Eb.Ug.add(u.a.zb(ca.a.tYa));Eb.Ug.add(u.a.zb(f.a.Sq));Eb.Ug.add(u.a.zb(f.a.Xs));Eb.Ug.add(u.a.zb(f.a.a8));Eb.Ug.add(u.a.zb(ca.a.FF));return!0}static Eh(){return new Ka}static get instance(){return Ka.hh.value}}
Ka.hh=new l.a(Ka.Eh);Object(J.a)(Ka,"PageContentNodeComplexMerge",w.a,[]);class bb extends w.a{constructor(){super()}get zo(){return 19}el(){const cb=super.el();cb.Z(u.a.zb(f.a.XDa),1);cb.Z(u.a.zb(f.a.wTa),2);cb.Z(u.a.zb(f.a.ika),2);cb.Z(u.a.zb(f.a.n7),1);return cb}AD(cb,Eb){const mc=cb.kf;if(Eb===u.a.zb(f.a.XDa)){var tb=mc.getPropertyObjectIds(cb.ih.value.Ov,f.a.XDa),Xa=mc.getPropertyObjectIds(cb.ih.value.Lf,f.a.XDa),Mb=mc.getPropertyObjectIds(cb.Po.value.Lf,f.a.XDa);if((tb=this.MIn(tb,Xa,Mb,(cc,
oc)=>cc.equals(oc),cc=>{let oc;({value:oc}=cb.hu.runtime.uv.Ac(cc)).returnValue?cb.hu.runtime.Tq.Z(cc,new E.a(oc,!1)):v.a.instance.shipAssertTag(4034653,1,!1,"PageManifestNodeComplexMerge failed to shared formatting object with [id: {0}] in conflicting revision.")},cb.hu))&&0<tb.length)return mc.setPropertyObjectIds(cb.Tl,f.a.XDa,tb),cb.Ug.add(u.a.zb(f.a.XDa)),!0}if(Eb===u.a.zb(f.a.n7))return tb=mc.getPropertyObjectIds(cb.ih.value.Ov,f.a.n7),Xa=mc.getPropertyObjectIds(cb.ih.value.Lf,f.a.n7),Mb=mc.getPropertyObjectIds(cb.Po.value.Lf,
f.a.n7),tb=this.$La(tb,Xa,Mb),mc.setPropertyObjectIds(cb.Tl,f.a.n7,tb),cb.Ug.add(Eb),!0;v.a.instance.Ua(4018187,1,4,"PageManifestNodeComplexMerge: Failed to merge PageManifestNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.ih.value.Lf.id,Eb);return!1}static Eh(){return new bb}static get instance(){return bb.hh.value}}bb.hh=new l.a(bb.Eh);Object(J.a)(bb,"PageManifestNodeComplexMerge",w.a,[]);class Ib extends w.a{constructor(){super()}get zo(){return 43}el(){const cb=super.el();
cb.Z(u.a.zb(f.a.Cqa),0);cb.Z(u.a.zb(f.a.lXb),0);cb.Z(u.a.zb(f.a.mTb),0);cb.Z(u.a.zb(f.a.Ksa),1);cb.Z(u.a.zb(f.a.sessionId),3);cb.Z(u.a.zb(f.a.buildVersion),3);cb.Z(u.a.zb(f.a.hCa),1);cb.Z(u.a.zb(f.a.ZWi),1);cb.Z(u.a.zb(f.a.ow),1);return cb}AD(cb,Eb){if(Eb===u.a.zb(f.a.hCa)||Eb===u.a.zb(f.a.ZWi)||Eb===u.a.zb(f.a.ow)){var mc=cb.Po.value.Lf,tb=cb.ih.value.Lf,Xa=u.a.p_(Eb);tb=cb.kf.getPropertyBool(tb,Xa);mc=cb.kf.getPropertyBool(mc,Xa);cb.kf.setPropertyBool(cb.Tl,Xa,null==tb?!1:tb&&null==mc?!1:mc);cb.Ug.add(Eb);
return!0}if(Eb===u.a.zb(f.a.Ksa)){Eb=cb.kf;mc=cb.ih.value.Ov;tb=cb.Po.value.Lf;Xa=cb.ih.value.Lf;mc=mc?Eb.getPropertyObjectId(mc,f.a.Ksa):null;tb=tb?Eb.getPropertyObjectId(tb,f.a.Ksa):null;Xa=Xa?Eb.getPropertyObjectId(Xa,f.a.Ksa):null;v.a.instance.Ua(589657691,1,4,"GraphFeatureChild Merge Attempt: [Base: {0}] [Conflict: {1}] [Favored: {2}]",mc?mc.toString():"NULL",tb?tb.toString():"NULL",Xa?Xa.toString():"NULL");if(tb){if(Xa&&tb.equals(Xa))return cb.Ug.add(u.a.zb(f.a.Ksa)),Eb.setPropertyObjectId(cb.Tl,
f.a.Ksa,tb),!0;if(la.a.m9d.equals(tb))return cb.Ug.add(u.a.zb(f.a.Ksa)),Eb.setPropertyObjectId(cb.Tl,f.a.Ksa,la.a.m9d),!0}if(Xa&&la.a.m9d.equals(Xa))return cb.Ug.add(u.a.zb(f.a.Ksa)),Eb.setPropertyObjectId(cb.Tl,f.a.Ksa,la.a.m9d),!0;v.a.instance.Ua(589657692,1,2,"GraphFeatureChild Merge Failure: [Base: {0}] [Conflict: {1}] [Favored: {2}]",mc?mc.toString():"NULL",tb?tb.toString():"NULL",Xa?Xa.toString():"NULL")}return!1}static Eh(){return new Ib}static get instance(){return Ib.hh.value}}Ib.hh=new l.a(Ib.Eh);
Object(J.a)(Ib,"PageMetadataNodeComplexMerge",w.a,[]);var ib=d(1783),jb=d(176);class hb extends w.a{constructor(){super()}get zo(){return 31}el(){const cb=super.el();cb.Z(u.a.zb(jb.a.XB),1);cb.Z(u.a.zb(f.a.listID),3);cb.Z(u.a.zb(f.a.listLevel),1);cb.Z(u.a.zb(f.a.Se),3);cb.Z(u.a.zb(f.a.pdc),3);cb.Z(u.a.zb(f.a.runId),3);cb.Z(u.a.zb(f.a.K0d),3);cb.Z(u.a.zb(x.a.fontColor),3);cb.Z(u.a.zb(f.a.J4h),3);cb.Z(u.a.zb(f.a.Yc),1);cb.Z(u.a.zb(jb.a.oce),3);cb.Z(u.a.zb(jb.a.g1f),3);cb.Z(u.a.zb(jb.a.W8c),3);cb.Z(u.a.zb(f.a.y$l),
3);cb.Z(u.a.zb(qb.a.Z3j),3);for(let Eb=0;Eb<hb.Sab.length;Eb++)cb.Z(hb.Sab[Eb],1);return cb}AD(cb,Eb){var mc=cb.kf;const tb=cb.Tl;u.a.p_(Eb);if(Eb===u.a.zb(f.a.Yc)){mc=cb.kf.getPropertyInt32(cb.Po.value.Lf,f.a.Yc);if(null==mc||!mc)return!0;cb.kf.setPropertyInt32(tb,f.a.Yc,mc);cb.Ug.add(Eb);return!0}if(Eb===u.a.zb(jb.a.XB)){const Xa=mc.getPropertyUint32(cb.ih.value.Lf,jb.a.XB),Mb=mc.getPropertyUint32(cb.Po.value.Lf,jb.a.XB);if(null!=Xa&&null!=Mb&&Xa===Mb)return mc.setPropertyUint32(tb,jb.a.XB,Xa),
cb.Ug.add(Eb),!0;if(null==Xa&&null==Mb)return tb.removeProperty(jb.a.XB),cb.Ug.add(u.a.zb(jb.a.XB)),!0;if(null!=Xa&&null==Mb)return mc.setPropertyUint32(tb,jb.a.XB,Xa),cb.Ug.add(Eb),!0;if(null==Xa&&null!=Mb)return mc.setPropertyUint32(tb,jb.a.XB,Mb),cb.Ug.add(Eb),!0}else{if(Eb===u.a.zb(f.a.listLevel))return this.Mmp(mc,cb);if(Array.contains(hb.Sab,Eb))return this.Lmp(cb)}return!1}Lmp(cb){let Eb=!0,mc=!0,tb,Xa;({Pfn:Eb,Wcn:mc,D3l:tb,hwl:Xa}=this.wml(cb));v.a.instance.Ua(578932993,1,4,"PersistablePropertySetComplexMerge: Merging ListDef properties [Id: {0}]. [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}].",
cb.ih.value.Lf.id.toString(),Eb,mc);return Eb&&!mc?(this.adj(Xa,cb),!0):Eb?!1:(this.adj(tb,cb),!0)}wml(cb){let Eb,mc,tb,Xa;const Mb=cb.Po.value;let cc;const oc=cb.ih.value;let Pc;mc=Eb=!0;tb=new F.a;Xa=new F.a;for(let vb=0;vb<hb.Sab.length;vb++){const jd=hb.Sab[vb],ud=({value:cc}=Mb.WMa.Ac(jd)).returnValue;({value:Pc}=oc.WMa.Ac(jd)).returnValue&&(Eb=this.f2j(cb.ih,tb,Pc,jd)&&Eb);ud&&(mc=this.f2j(cb.Po,Xa,cc,jd)&&mc)}return{Pfn:Eb,Wcn:mc,D3l:tb,hwl:Xa}}f2j(cb,Eb,mc,tb){const Xa=u.a.p_(tb);cb=cb.value.Lf;
Eb.Z(tb,cb.hasProperty(Xa)?cb.UG(Xa):null);return!mc.e3}adj(cb,Eb){const mc=Eb.Tl;for(let Xa=0;Xa<hb.Sab.length;Xa++){var tb=hb.Sab[Xa];const Mb=u.a.p_(tb);(tb=cb.K(tb))?mc.Rdb(Mb,tb):mc.removeProperty(Mb)}for(cb=0;cb<hb.Sab.length;cb++)Eb.Ug.add(hb.Sab[cb]);v.a.instance.Ua(578932994,1,4,"PersistablePropertySetComplexMerge: Completed Merging ListDef properties [Id: {0}].",Eb.ih.value.Lf.id.toString())}Mmp(cb,Eb){const mc=Eb.Tl,tb=cb.getPropertyInt32(Eb.ih.value.Lf,f.a.listLevel),Xa=cb.getPropertyInt32(Eb.Po.value.Lf,
f.a.listLevel);return null!=tb&&null!=Xa&&tb===Xa?(cb.setPropertyInt32(mc,f.a.listLevel,tb),Eb.Ug.add(u.a.zb(f.a.listLevel)),!0):null==tb&&null==Xa?(mc.removeProperty(f.a.listLevel),Eb.Ug.add(u.a.zb(f.a.listLevel)),!0):null!=tb&&null==Xa?(cb.setPropertyInt32(mc,f.a.listLevel,tb),Eb.Ug.add(u.a.zb(f.a.listLevel)),!0):null==tb&&null!=Xa?(cb.setPropertyInt32(mc,f.a.listLevel,Xa),Eb.Ug.add(u.a.zb(f.a.listLevel)),!0):!1}static Eh(){return new hb}static get instance(){return hb.hh.value}}hb.hh=new l.a(hb.Eh);
hb.Sab=[u.a.zb(f.a.he),u.a.zb(f.a.Mt),u.a.zb(x.a.O7),u.a.zb(f.a.aga),u.a.zb(f.a.Tw),u.a.zb(f.a.Ys),u.a.zb(x.a.GU),u.a.zb(f.a.ljf),u.a.zb(x.a.font),u.a.zb(qb.a.jub),u.a.zb(a.a.Yw)];Object(J.a)(hb,"PersistablePropertySetComplexMerge",w.a,[]);class pb extends w.a{constructor(){super()}get zo(){return 21}get GB(){return 0}static Eh(){return new pb}static get instance(){return pb.hh.value}}pb.hh=new l.a(pb.Eh);Object(J.a)(pb,"RevisionMetadataNodeComplexMerge",w.a,[]);class ob extends w.a{constructor(){super()}get zo(){return 48}el(){const cb=
super.el();cb.Z(u.a.zb(f.a.$pe),3);return cb}static Eh(){return new ob}static get instance(){return ob.hh.value}}ob.hh=new l.a(ob.Eh);Object(J.a)(ob,"ShadowNumberListNodeComplexMerge",w.a,[]);class sb extends w.a{constructor(){super()}get zo(){return 22}el(){const cb=super.el();cb.Z(u.a.zb(f.a.Iab),7);cb.Z(u.a.zb(f.a.E9c),2);return cb}static Eh(){return new sb}static get instance(){return sb.hh.value}}sb.hh=new l.a(sb.Eh);Object(J.a)(sb,"SharedPersistablePropertySetComplexMerge",w.a,[]);class Ab extends w.a{constructor(){super()}get zo(){return 38}get GB(){return 3}static Eh(){return new Ab}static get instance(){return Ab.hh.value}}
Ab.hh=new l.a(Ab.Eh);Object(J.a)(Ab,"StylePropertySetComplexMerge",w.a,[]);class nc extends w.a{constructor(){super()}get zo(){return 23}get GB(){return 0}el(){const cb=super.el();cb.Z(u.a.zb(x.a.pg),4);cb.Z(u.a.zb(f.a.rowSpan),1);cb.Z(u.a.zb(f.a.colSpan),1);cb.Z(u.a.zb(f.a.ghostCell),1);cb.Z(u.a.zb(ca.a.vMerge),1);cb.Z(u.a.zb(ca.a.gridSpan),1);cb.Z(u.a.zb(f.a.$eb),2);cb.Z(u.a.zb(f.a.Lzb),2);cb.Z(u.a.zb(f.a.tOa),2);return cb}gCa(cb){if(!cb)return v.a.instance.Ua(540120285,1,2,"Feature helper is null"),
!1;cb.DI(100);return cb.isFeatureEnabled(100)}AD(cb,Eb){cb.hu.runtime.$I("TableCellNodeComplexMerge.TryMergeCustomProperty, propertyId:"+Eb);let mc=Eb===u.a.zb(f.a.rowSpan)||Eb===u.a.zb(f.a.colSpan)||Eb===u.a.zb(f.a.ghostCell);this.gCa(cb.hu.runtime.sc)&&(mc=mc||Eb===u.a.zb(ca.a.vMerge)||Eb===u.a.zb(ca.a.gridSpan));return!mc}static Eh(){return new nc}static get instance(){return nc.hh.value}}nc.hh=new l.a(nc.Eh);Object(J.a)(nc,"TableCellNodeComplexMerge",w.a,[]);var qc=d(1723);class Jc extends w.a{constructor(){super()}get zo(){return 24}get GB(){return 0}el(){const cb=
super.el();cb.Z(u.a.zb(x.a.pg),1);cb.Z(u.a.zb(x.a.M8),1);cb.Z(u.a.zb(x.a.Bha),1);cb.Z(u.a.zb(f.a.qyc),1);cb.Z(u.a.zb(f.a.Dca),1);cb.Z(u.a.zb(f.a.$eb),2);cb.Z(u.a.zb(f.a.Lzb),2);cb.Z(u.a.zb(f.a.tOa),2);return cb}AD(cb,Eb){cb.hu.runtime.$I("TableNodeComplexMerge.TryMergeCustomProperty, PropertyId:"+Eb);if(Eb===u.a.zb(x.a.pg)||Eb===u.a.zb(x.a.M8)||Eb===u.a.zb(f.a.qyc)||Eb===u.a.zb(f.a.Dca)||Eb===u.a.zb(x.a.Bha)){const tb=cb.Tl,Xa=cb.kf;v.a.instance.Ua(4273303,1,4,"TableNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
tb.id,tb.wc,Eb);if(this.PTl(cb))return!1;var mc=Xa.getPropertyObjectIds(cb.ih.value.Ov,x.a.pg);const Mb=Xa.getPropertyObjectIds(cb.ih.value.Lf,x.a.pg),cc=Xa.getPropertyObjectIds(cb.Po.value.Lf,x.a.pg);mc=this.ncj(mc,Mb,cc,(oc,Pc)=>oc.equals(Pc));if(0<mc.length)return Xa.setPropertyObjectIds(tb,x.a.pg,mc),Xa.setPropertyInt32(tb,x.a.Bha,mc.length),cb.Ug.add(u.a.zb(x.a.pg)),cb.Ug.add(u.a.zb(x.a.M8)),cb.Ug.add(u.a.zb(x.a.Bha)),cb.Ug.add(u.a.zb(f.a.qyc)),cb.Ug.add(u.a.zb(f.a.Dca)),!0}v.a.instance.Ua(4018189,
1,4,"TableNodeComplexMerge: Failed to merge TableNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.ih.value.Lf.id,Eb);return!1}PTl(cb){const Eb=cb.Po.value,mc=cb.ih.value;let tb,Xa;({value:tb}=Eb.WMa.Ac(u.a.zb(x.a.M8)));({value:Xa}=mc.WMa.Ac(u.a.zb(x.a.M8)));return tb.e3||Xa.e3?tb.e3&&Xa.e3?(v.a.instance.Ua(4273304,1,4,"TableNodeComplexMerge: Failed to merge TableNode due to columns being changed in both. [Base: {0}] [Favored: {1}] [Conflicting: {2}]",tb.oldValue,Xa.newValue,tb.newValue),
cb.hu.logger.Pi(Object.assign(new qc.a,{$j:"DoColumnsConflict",eventId:"aqtsy",info:"Columns changed"})),!0):Jc.zfi(cb.hu,tb,mc,"BaseConflict")||Jc.zfi(cb.hu,Xa,Eb,"BaseFavored")?!0:!1:!1}static Eh(){return new Jc}static get instance(){return Jc.hh.value}static zfi(cb,Eb,mc,tb){return Eb.e3&&({value:Eb}=mc.WMa.Ac(u.a.zb(x.a.pg)),Eb.e3)?(v.a.instance.Ua(4273305,1,4,"TableNodeComplexMerge {0}: Failed to merge TableNode due to columns and rows being changed on different sides of the conflict.",tb),cb.logger.Pi(Object.assign(new qc.a,
{$j:"DoColumnsConflictWithRows",eventId:"aqtsz"})),!0):!1}}Jc.hh=new l.a(Jc.Eh);Object(J.a)(Jc,"TableNodeComplexMerge",w.a,[]);class ad extends w.a{constructor(){super()}get zo(){return 25}get GB(){return 0}el(){const cb=super.el();cb.Z(u.a.zb(f.a.Yc),3);cb.Z(u.a.zb(x.a.pg),4);cb.Z(u.a.zb(f.a.$eb),2);cb.Z(u.a.zb(f.a.Lzb),2);cb.Z(u.a.zb(f.a.tOa),2);cb.Z(u.a.zb(ca.a.mGg),2);cb.Z(u.a.zb(ca.a.lGg),2);return cb}static Eh(){return new ad}static get instance(){return ad.hh.value}}ad.hh=new l.a(ad.Eh);Object(J.a)(ad,
"TableRowNodeComplexMerge",w.a,[]);class Kc extends w.a{constructor(){super()}el(){const cb=super.el();cb.Z(u.a.zb(f.a.Sep),2);cb.Z(u.a.zb(x.a.pg),1);return cb}AD(cb,Eb){if(Eb===u.a.zb(x.a.pg)){const tb=cb.Tl,Xa=cb.kf;v.a.instance.Ua(42754251,1,4,"TaskContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",tb.id,tb.wc,Eb);var mc=Xa.getPropertyObjectIds(cb.ih.value.Ov,x.a.pg);const Mb=Xa.getPropertyObjectIds(cb.ih.value.Lf,x.a.pg),cc=Xa.getPropertyObjectIds(cb.Po.value.Lf,
x.a.pg);if(mc=this.XIn(mc,Mb,cc))return 0<mc.length?Xa.setPropertyObjectIds(tb,x.a.pg,mc):tb.removeProperty(x.a.pg),cb.Ug.add(u.a.zb(x.a.pg)),!0}v.a.instance.Ua(42754252,1,1,"TaskContentNodeComplexMerge: Failed to merge TaskContent [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.ih.value.Lf.id,Eb);return!1}XIn(cb,Eb,mc){const tb=new F.a(0);cb.forEach(Mb=>{tb.Z(Mb,0);return!0});Eb.forEach(Mb=>{tb.lb(Mb)?tb.Z(Mb,1):tb.Z(Mb,3);return!0});mc.forEach(Mb=>{let cc;({value:cc}=tb.Ac(Mb)).returnValue?
1===cc?tb.Z(Mb,5):3===cc?(v.a.instance.Ua(42754253,1,2,"TaskNode was found added by both sides of merge"),tb.Z(Mb,3)):tb.Z(Mb,2):tb.Z(Mb,4);return!0});const Xa=new P.a;tb.forEach((Mb,cc)=>{0!==cc&&2!==cc&&1!==cc&&Xa.add(Mb);return!0});return Xa}static Eh(){return new Kc}static get instance(){return Kc.hh.value}}Kc.hh=new l.a(Kc.Eh);Object(J.a)(Kc,"TaskContentNodeComplexMerge",w.a,[]);class Jb{equals(cb,Eb){return cb&&Eb?cb.UserId===Eb.UserId&&cb.Provider===Eb.Provider&&cb.DisplayName===Eb.DisplayName&&
cb.Email===Eb.Email:!cb&&!Eb}iN(){return 0}}Object(J.a)(Jb,"CommentTaskPersonComparer",null,[12]);class Zb{equals(cb,Eb){return cb&&Eb?cb.startDate?cb.endDate?cb.startDate.getTime()===Eb.startDate.getTime()&&cb.endDate.getTime()===Eb.endDate.getTime():!Eb.endDate:!Eb.startDate:!cb&&!Eb}iN(){return 0}}Object(J.a)(Zb,"CommentTaskScheduleEqualityComparer",null,[12]);class xb{equals(cb,Eb){if(!cb||!Eb)return!cb&&!Eb;if(!cb.extensions&&!Eb.extensions)return!0;if(!cb.extensions||!Eb.extensions||cb.extensions.count!==
Eb.extensions.count)return!1;let mc=!0;cb.extensions.forEach((tb,Xa)=>{let Mb;return({value:Mb}=Eb.extensions.Ac(tb)).returnValue&&Xa===Mb?!0:mc=!1});return mc}iN(){return 0}}Object(J.a)(xb,"ExtensionListEqualityComparer",null,[12]);class $b{e0l(cb,Eb){return cb&&Eb?cb.recordId===Eb.recordId&&$b.Kah.equals(cb.user,Eb.user)&&$b.Kah.equals(cb.assignee,Eb.assignee)&&cb.type===Eb.type&&cb.title===Eb.title&&cb.priority===Eb.priority&&cb.isLossy===Eb.isLossy&&cb.completion===Eb.completion&&cb.commentId===
Eb.commentId&&cb.time===Eb.time&&$b.apk.equals(cb.schedule,Eb.schedule):!cb&&!Eb}equals(cb,Eb){return this.e0l(cb,Eb)}iN(){return 0}}$b.Kah=new Jb;$b.apk=new Zb;new xb;Object(J.a)($b,"HistoryRecordEqualityComparer",null,[12]);var Xb=d(2136),Lb=d(1464);class gc extends w.a{constructor(cb){super();this.NSa=cb}el(){const cb=super.el();cb.Z(u.a.zb(f.a.d1b),5);cb.Z(u.a.zb(f.a.taskId),2);cb.Z(u.a.zb(f.a.Dep),2);cb.Z(u.a.zb(f.a.Iep),2);cb.Z(u.a.zb(f.a.mEa),1);return cb}uJg(cb){if(!cb.Po.value.Ov&&!cb.ih.value.Ov){const Eb=
cb.ih.value.Lf.JO();Eb.removeProperty(f.a.mEa);const mc=cb.ih.value.Lf,tb=cb.Po.value.Lf;cb.ih=new l.a(()=>new Lb.a(Eb,mc));cb.Po=new l.a(()=>new Lb.a(Eb,tb))}return super.uJg(cb)}AD(cb,Eb){if(Eb!==u.a.zb(f.a.mEa))return v.a.instance.Ua(42754254,1,1,"TaskSingleNodeComplexMerge: Failed to merge TaskSingle [Id: {0}] due to a conflicting change on [PropertyId: {1}]",cb.ih.value.Lf.id,Eb),!1;const mc=cb.Tl,tb=cb.kf;v.a.instance.Ua(42754255,1,4,"TaskSingleNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
mc.id,mc.wc,Eb);Eb=tb.getPropertyString(cb.ih.value.Ov,f.a.mEa);const Xa=tb.getPropertyString(cb.ih.value.Lf,f.a.mEa),Mb=tb.getPropertyString(cb.Po.value.Lf,f.a.mEa);Eb=this.WIn(Eb,Xa,Mb);if(!Eb)return!1;0<Eb.length?tb.setPropertyString(mc,f.a.mEa,Eb):mc.removeProperty(f.a.mEa);cb.Ug.add(u.a.zb(f.a.mEa));return!0}WIn(cb,Eb,mc){cb=this.NSa.fgc(cb);Eb=this.NSa.fgc(Eb);mc=this.NSa.fgc(mc);if(!gc.k_i(cb,Eb))return v.a.instance.Ua(42754256,1,1,"MergeTaskHistory: base must be a prefix of the favored entries"),
null;if(!gc.k_i(cb,mc))return v.a.instance.Ua(42754257,1,1,"MergeTaskHistory: base must be a prefix of the conflict entries"),null;mc=gc.btl(cb.length,Eb,mc);return this.NSa.pxg(mc)}static Eh(){const cb=new Xb.a;return new gc(cb)}static get instance(){return gc.hh.value}static btl(cb,Eb,mc){const tb=new P.a;for(let Xa=0;Xa<Eb.length;Xa++)tb.add(Eb.K(Xa));for(;cb<mc.length;cb++)tb.add(mc.K(cb));return tb}static k_i(cb,Eb){const mc=cb.length;if(mc>Eb.length)return!1;for(let tb=0;tb<mc;tb++)if(!gc.swk.equals(Eb.K(tb),
cb.K(tb)))return Eb.K(tb).recordId===cb.K(tb).recordId&&v.a.instance.Ua(50357519,1,1,"MergeTaskHistory: History records with same RecordId must have all other fields equal"),!1;return!0}}gc.hh=new l.a(gc.Eh);gc.swk=new $b;Object(J.a)(gc,"TaskSingleNodeComplexMerge",w.a,[]);class qa extends w.a{constructor(){super()}get zo(){return 26}el(){const cb=super.el();cb.Z(u.a.zb(x.a.pg),1);return cb}AD(cb,Eb){const mc=x.a.pg;if(Eb===u.a.zb(mc)){Eb=cb.Tl;const Xa=cb.kf;var tb=Xa.getPropertyObjectIds(cb.ih.value.Ov,
mc);const Mb=Xa.getPropertyObjectIds(cb.ih.value.Lf,mc),cc=Xa.getPropertyObjectIds(cb.Po.value.Lf,mc);tb=this.dJn(tb,Mb,cc);Xa.setPropertyObjectIds(Eb,mc,tb);cb.Ug.add(u.a.zb(mc));return!0}return!1}dJn(cb,Eb,mc){return this.$La(cb,Eb,mc)}static Eh(){return new qa}static get instance(){return qa.hh.value}}qa.hh=new l.a(qa.Eh);Object(J.a)(qa,"VectorClockContainerNodeComplexMerge",w.a,[]);class ra extends w.a{constructor(){super()}get zo(){return 27}el(){const cb=super.el();cb.Z(u.a.zb(f.a.O0),1);return cb}AD(cb,
Eb){const mc=f.a.O0;if(Eb===u.a.zb(mc)){Eb=cb.Tl;const tb=cb.kf,Xa=tb.getPropertyUint32(cb.ih.value.Lf,mc)||0,Mb=tb.getPropertyUint32(cb.Po.value.Lf,mc)||0;tb.setPropertyUint32(Eb,mc,this.Wwm(Xa,Mb));cb.Ug.add(u.a.zb(mc));return!0}return!1}Wwm(cb,Eb){return cb>Eb?cb:Eb}static Eh(){return new ra}static get instance(){return ra.hh.value}}ra.hh=new l.a(ra.Eh);Object(J.a)(ra,"VectorClockNodeComplexMerge",w.a,[]);class Ya extends w.a{constructor(){super()}get zo(){return 28}get GB(){return 0}el(){const cb=
super.el();cb.Z(u.a.zb(f.a.Cxf),3);cb.Z(u.a.zb(f.a.Yc),3);cb.Z(u.a.zb(f.a.Vfi),5);cb.Z(u.a.zb(f.a.Z7f),5);cb.Z(u.a.zb(f.a.jna),5);return cb}static Eh(){return new Ya}static get instance(){return Ya.hh.value}}Ya.hh=new l.a(Ya.Eh);Object(J.a)(Ya,"WordSectionNodeComplexMerge",w.a,[]);d.d(L,"a",function(){return ab});class ab{S8h(cb,Eb){switch(cb.wc){case m.a.Jma:return cb.hasProperty(f.a.imageType)||cb.hasProperty(a.a.Q_)?this.Xp(ea.instance,Eb):this.Xp(hb.instance,Eb);case m.a.Gcc:return this.Xp(z.instance,
Eb);case m.a.OHa:return this.Xp(y.instance,Eb);case m.a.XJb:return this.Xp(H.instance,Eb);case m.a.Jcc:return this.Xp(I.instance,Eb);case m.a.wTa:return this.Xp(R.instance,Eb);case m.a.VHa:return this.Xp(W.instance,Eb);case m.a.eza:return this.Xp(Z.instance,Eb);case m.a.wmb:return this.Xp(T.instance,Eb);case m.a.Rja:return this.Xp(N.instance,Eb);case m.a.XK:return this.Xp(X.instance,Eb);case m.a.Wd:return this.Xp(ta.instance,Eb);case m.a.pra:return this.Xp(Y.instance,Eb);case m.a.ika:return this.Xp(za.instance,
Eb);case m.a.XQ:return this.Xp(Ha.instance,Eb);case m.a.vJa:return this.Xp(Na.instance,Eb);case m.a.uka:return this.Xp(ya.instance,Eb);case m.a.UJa:return this.Xp(ma.instance,Eb);case m.a.Caa:return this.Xp(Ea.instance,Eb);case m.a.lWa:return this.Xp($a.instance,Eb);case m.a.yWa:return this.Xp(ea.instance,Eb);case m.a.oI:return this.Xp(ea.instance,Eb);case m.a.iVf:return this.Xp(ka.instance,Eb);case m.a.jVf:return this.Xp(La.instance,Eb);case m.a.obe:return this.Xp(va.instance,Eb);case m.a.kVf:return this.Xp(Ca.instance,
Eb);case m.a.lVf:return this.Xp(ua.instance,Eb);case m.a.n7:return this.Xp(Sa.instance,Eb);case m.a.Nbb:return this.Xp(Ra.instance,Eb);case m.a.MX:return this.Xp(kb.instance,Eb);case m.a.hH:return this.Xp(Va.instance,Eb);case m.a.Uh:return this.Xp(Ka.instance,Eb);case m.a.MWb:return this.Xp(Ib.instance,Eb);case m.a.YCa:return this.Xp(bb.instance,Eb);case m.a.paragraphNode:return this.Xp(ib.a.instance,Eb);case m.a.mvc:return this.Xp(pb.instance,Eb);case m.a.s_a:return this.Xp(sb.instance,Eb);case m.a.Uyb:return this.Xp(Ab.instance,
Eb);case m.a.Bca:return this.Xp(nc.instance,Eb);case m.a.qp:return this.Xp(Jc.instance,Eb);case m.a.Ina:return this.Xp(ad.instance,Eb);case m.a.F2b:return this.Xp(qa.instance,Eb);case m.a.wOa:return this.Xp(Kc.instance,Eb);case m.a.Hyc:return this.Xp(gc.instance,Eb);case m.a.eFe:return this.Xp(ra.instance,Eb);case m.a.joa:return this.Xp(Ya.instance,Eb);case m.a.qVf:return this.Xp(zb.instance,Eb);case m.a.nVf:return this.Xp(Ta.instance,Eb);case m.a.dBa:return this.Xp(Ba.instance,Eb);case m.a.Ynd:return this.Xp(ob.instance,
Eb)}return this.Xp(w.a.instance,Eb)}Xp(cb,Eb){cb.sc=Eb?Eb():null;return cb}}Object(J.a)(ab,"GraphNodeComplexMergeFactory",null,[1423])},1987:function(J,L,d){d.r(L);J=d(0);var m=d(1429),f=d(75),a=d(346),l=d(83),w=d(1382);class z{constructor(C,P,K,G=0){this.nKi=C;this.groupType=P;this.nQf=G;this.Xkd=K}}Object(J.a)(z,"SortingGroup",null,[]);class x{constructor(C,P,K,G){this.order=C;this.Raa=P;this.dRm=K;this.groupType=G}}Object(J.a)(x,"SortingProp",null,[]);var u=d(1373),v=d(1377),E=d(1372),y=d(1359);
class H{constructor(C,P){this.gaj={};this.faj={};this.baj=this.naj=1;this.JWh(C,P)}R7o(C,P,K){var G=E.a.wU(K)?this.gaj:this.faj;K=new f.a;for(var R of P)P=Object(l.a)(x,G[m.a[R.groupType].toLowerCase()]),y.c(P)||K.add(new a.a(P,R));K.Sc((Z,T)=>Z.key.order<T.key.order?-1:1);Array.clear(C);R=u.TellMeActor.instance.R1;for(P=0;P<K.count;){G=K.K(P).key.Raa;var W=K.K(P).value;const Z=new w.a(K.K(P).key.groupType);y.c(R)||R.Location===v.a.contextMenu||(Z.displayName=K.K(P).key.dRm);for(const T of W.results)Z.Xx(T);
for(W=++P;W<K.count&&K.K(W).key.Raa===G;)this.jef(Z,K.K(W).value),W=++P;C.push(Z)}}Lwp(C,P){this.baj=this.naj=1;this.JWh(C,P)}JWh(C,P){this.FUj(C);for(var K=0;K<C.length;K++){const G=C[K];for(const R of G.Xkd)this.JUk(R,K,G.nKi,G.groupType)}this.FUj(P);for(C=0;C<P.length;C++){K=P[C];for(const G of K.Xkd)this.IUk(G,C,K.nKi,K.groupType)}}FUj(C){C.sort((P,K)=>Object(l.a)(z,P).nQf>Object(l.a)(z,K).nQf?-1:1)}JUk(C,P,K,G){this.gaj[m.a[C].toLowerCase()]=new x(this.naj++,P,K,G)}IUk(C,P,K,G){this.faj[m.a[C].toLowerCase()]=
new x(this.baj++,P,K,G)}jef(C,P){for(let K=0;K<P.results.length;K++)C.Xx(P.results[K])}}Object(J.a)(H,"BaseGroupingSorter",null,[]);class I{constructor(){this.kie=[new z("",26,[26]),new z("",24,[24]),new z(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,4,[4,2]),new z(CommonUIStrings.l_TellMeCommandProviderTitle,7,[18,16,7]),new z(CommonUIStrings.l_TellMeSuggestionsProviderTitle,33,[15,14,19,3]),new z("",13,[13]),new z("",22,[22])];this.fie=[new z("",25,[25]),new z(CommonUIStrings.l_TellMeCommandProviderTitle,
31,[17,0,1,8,28]),new z(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,32,[2,19,23,29]),new z(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,33,[15,14,20,9,12,10,11,27]),new z("",13,[13]),new z("",22,[22])];this.N$i=new H(this.kie,this.fie)}jpd(C,P,K,G=null,R=null){let W=!1;if(G){for(const Z of E.a.wU(K)?this.kie:this.fie)this.jko(Z,G);W=!0}if(R){for(const Z of E.a.wU(K)?this.kie:this.fie)this.Mwp(P,Z,R);W=!0}W&&this.N$i.Lwp(this.kie,this.fie);this.N$i.R7o(C,P,K)}jko(C,P){const K=new f.a;
for(var G of C.Xkd){const R=P[m.a[G].toLowerCase()];K.add(new a.a(y.c(R)?Number.MAX_VALUE:R,G))}if(K.count){K.Sc((R,W)=>R.key<W.key?-1:1);P=Array(K.count);for(G=0;G<K.count;G++)P[G]=K.K(G).value;C.Xkd=P}}Mwp(C,P,K){let G=0;for(const R of P.Xkd)if(m.a[R].toLowerCase()in K&&K[m.a[R].toLowerCase()])for(const W of C)if(W.groupType===R){G+=K[m.a[R].toLowerCase()];break}P.nQf=G}}Object(J.a)(I,"SimplifiedGroupingSorter",null,[]);d.d(L,"GroupsPlacementInfo",function(){return F});class F{constructor(C){this.eaj=
{};this.caj={};this.daj={};this.haj={};this.E6f={};this.iaj=this.wEn=this.rEn=this.tEn=1;this.kaj=null;this.Dx=C;this.ffl();this.G$n();this.Uel();this.Wdl();C.mS&&(this.kaj=new I)}AG(C){this.eaj[m.a[C].toLowerCase()]=this.tEn++}BJ(C,P){this.caj[m.a[C].toLowerCase()]=P}dTa(C){this.daj[m.a[C].toLowerCase()]=this.rEn++}e6(C){this.haj[m.a[C].toLowerCase()]=this.wEn++}hF(C){this.E6f[m.a[C].toLowerCase()]=this.iaj++}ffl(){const C=!!this.Dx&&this.Dx.Aab,P=!!this.Dx&&this.Dx.kfd,K=!!this.Dx&&this.Dx.ztb,
G=!!this.Dx&&this.Dx.p0f&&!E.a.Doc(),R=!!this.Dx&&this.Dx.u$c,W=!!this.Dx&&this.Dx.bce,Z=!!this.Dx&&this.Dx.tZf,T=!!this.Dx&&this.Dx.YVf;this.Dx&&(this.Dx.bhc||this.Dx.vka||this.Dx.b0d)&&this.AG(26);T&&this.AG(24);this.AG(4);this.AG(18);this.AG(16);this.AG(7);this.AG(17);this.AG(0);this.AG(1);Z&&this.AG(28);R&&this.AG(23);C||this.AG(2);C&&!P||this.AG(8);this.AG(15);K&&this.AG(20);this.AG(14);this.AG(9);this.AG(12);this.AG(10);this.AG(11);C&&this.AG(2);C&&!P&&this.AG(8);this.AG(19);W&&this.AG(27);
this.AG(21);this.AG(13);G&&this.AG(22);this.AG(30)}G$n(){this.BJ(21,1);this.BJ(4,3);this.BJ(18,3);this.BJ(16,3);this.BJ(7,3);this.BJ(17,5);this.BJ(0,5);this.BJ(1,1);this.BJ(28,2);this.BJ(2,1);this.BJ(8,2);this.BJ(15,3);this.BJ(14,2);this.BJ(27,3);this.BJ(9,1);this.BJ(12,1);this.BJ(10,1);this.BJ(11,1);this.BJ(19,1);this.BJ(23,1);this.BJ(13,1);this.BJ(24,1);this.BJ(25,1);this.BJ(20,2);this.BJ(22,1);this.BJ(26,1)}Uel(){this.dTa(4);this.dTa(0);this.dTa(17);this.dTa(7);this.dTa(16);this.dTa(18);this.dTa(15);
this.dTa(20);this.dTa(8);this.dTa(14)}Wdl(){this.e6(14);this.e6(10);this.e6(12);this.e6(9);this.e6(11);this.e6(20);this.e6(15);this.e6(8);this.e6(2);this.e6(1);this.e6(27);this.e6(7);this.e6(18);this.e6(16);this.e6(17);this.e6(0);this.e6(4)}aDo(){this.E6f={};this.iaj=1}CGm(C,P,K){this.aDo();const G=!!this.Dx&&this.Dx.Aab,R=!!this.Dx&&this.Dx.kfd,W=!!this.Dx&&this.Dx.ztb,Z=!!this.Dx&&this.Dx.p0f&&!E.a.Doc(),T=!!this.Dx&&this.Dx.u$c,N=!!this.Dx&&this.Dx.bce,U=!!this.Dx&&this.Dx.tZf,ba=!!this.Dx&&this.Dx.lye;
C=C&&R;ba&&this.hF(25);this.hF(4);this.hF(18);this.hF(16);this.hF(7);this.hF(17);this.hF(0);this.hF(1);U&&this.hF(28);T&&this.hF(23);G&&!R||!C||this.hF(8);P&&this.hF(15);G||this.hF(2);N&&this.hF(27);K&&this.hF(14);G&&!R||C||this.hF(8);P||this.hF(15);W&&this.hF(20);K||this.hF(14);this.hF(9);this.hF(12);this.hF(10);this.hF(11);G&&this.hF(2);G&&!R&&this.hF(8);this.hF(19);this.hF(21);this.hF(13);Z&&this.hF(22);return this.E6f}rR(){return this.Dx}}Object(J.a)(F,"GroupsPlacementInfo",null,[])},1989:function(J,
L,d){d.r(L);J=d(0);var m=d(1613),f=d(1478),a=d(1429),l=d(1780),w=d(1477);class z{constructor(F="",C="",P="",K=-99999,G=-1,R=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=F?F:"";this.Description=C?C:"";this.Type=P?P:"";this.Score=K;this.Age=G;this.Count=R}}Object(J.a)(z,"Suggestion",null,[]);class x{constructor(F,C){this.GroupType=this.Suggestions=null;this.Suggestions=F;this.GroupType=C}}Object(J.a)(x,"SuggestionGroup",null,[]);class u{}u.tlc="help";u.B3k=
"answer";u.commands="commands";u.wNo="servicecommands";u.template="template";Object(J.a)(u,"SuggestionGroupType",null,[]);var v=d(1373),E=d(1372),y=d(2),H=d(29);d.d(L,"InteractionLogger",function(){return I});class I{constructor(F,C,P){this.SPe=0;this.$9e=this.OJc=null;this.Hc=F;this.g8e=this.eNe=this.KUe=!1;this.cqk=C;this.Gf=y.AFrameworkApplication.Ee;this.kc=P;this.wyd=this.J2e=0}get Lua(){return this.Hc.Lua}jxe(F){this.Hc.jxe(F)}B9i(){if(this.OJc){var F=0;for(const C of this.OJc)this.Hc.oCn(C,
F++);this.OJc=null}}beginQuery(F,C,P){this.Hc.fCn(F,C,P)}tvb(F,C){this.Hc.$$k(F,C);this.KUe=!0;this.g8e=!1}KCa(){this.KUe=!1;this.eNe||(this.B9i(),this.Hc.pii(this.SPe))}gCn(F,C){this.Hc.hCn(F,C)}fTn(F,C,P,K,G){for(const R of this.cqk)if(F.startsWith(R)){this.g8e=!0;break}this.Hc.wzn(F,C,P,K,G)}ITn(F){this.eNe=!1;this.SPe=F;this.KUe||this.g8e||(this.B9i(),this.Hc.pii(this.SPe,!1))}HTn(F,C){this.Hc.Czn(F,C);this.eNe=!0}QEf(F,C){if(!F.count)return"";let P="";const K=Date.now();for(const G of F)F=(K-
G.timeStamp)/1E3,F=E.a.NCe(F),0<P.length&&(P+=";"),P+=C?G.commandId:G.controlId,P+=":",P+=F.toString();return P}Sbb(){var F=this.QEf(m.a.instance.G1c(),!1);0<F.length&&this.Hc.uzn(F);F=this.QEf(m.a.instance.Spb(),!0);0<F.length&&this.Hc.Nyn(F);F=this.QEf(m.a.instance.JGc,!0);0<F.length&&this.Hc.oAn(F);F=v.TellMeActor.instance.auh;0<F.length&&this.Hc.dCn(H.c(F))}zCn(F){this.Hc.azn(F)}Eba(F,C,P,K,G,R,W,Z=null){this.Hc.iBn(F,C,P,K,G,R,W,Z)}z5f(F,C,P,K){this.Hc.z5f(F,C,P,K)}$B(F,C,P=null){this.Hc.BI(F,
C,P)}onError(F,C,P=null){this.Hc.Sta(F,C,P)}jSo(F){this.OJc=F}NJm(F){const C=[];if(!F)return C;for(let P=0;P<F.length;P++){const K=a.a[F[P].groupType].toLowerCase(),G=[],R=F[P].results;if(R){for(let W=0;W<R.length;W++)"findindocument"===K?Array.add(G,new z("","",K,R[W].score,R[W].nRd,R[W].count)):Array.add(G,new z(R[W].label,R[W].description,K,R[W].score,R[W].nRd,R[W].count));"answer"===K||"definition"===K||"wolframanswer"===K||"entity"===K?Array.add(C,new x(G,u.B3k)):"classifier"===K||"appsforoffice"===
K?Array.add(C,new x(G,u.commands)):"serviceclassifier"===K?Array.add(C,new x(G,u.wNo)):"assistance"===K?Array.add(C,new x(G,u.tlc)):("document"===K||"people"===K||"findindocument"===K||"notes"===K||"image"===K||"template"===K)&&Array.add(C,new x(G,K))}}return C}jNf(F,C){const P={};P.Query=C;P.SuggestionGroups=H.c(this.NJm(F));return H.c(P)}eHi(F){const C={"Content-Type":"application/json",Accept:"application/json"};C["X-Office-Version"]=y.AFrameworkApplication.buildVersion;C["X-Office-Application"]=
y.AFrameworkApplication.J.ib("Application");C["X-Office-Platform"]="WAC";C["X-TellMe-SqmUserId"]=y.AFrameworkApplication.J.ib("LoggableUserId")||"";C["X-TellMe-SessionId"]=this.Hc.Lua.$sa;C["X-TellMe-SuggestionTypes"]="Ranker";C["X-TellMe-Culture"]=y.AFrameworkApplication.uiCulture;C["X-TellMe-ProcessSessionId"]=y.AFrameworkApplication.userSessionId;C["X-TellMe-Flights"]=F;C["X-TellMe-PartialQueryIndex"]=this.J2e;return C}yWb(F,C,P){this.Eba(C.length,"RankerLogging",F.data.Ie.toString(),Math.round(window.performance.now()-
P),w.a.mZj,!0,f.a.tWa)}gWb(F,C,P){this.Eba(C.length,"RankerLogging",F.data.Ie.toString(),Math.round(window.performance.now()-P),w.a.mZj,!1,f.a.tWa)}fHi(){this.$9e||(this.$9e=new l.a(this.kc,null,6E3));return this.$9e.Vca}B5f(F){const C=this.jNf(this.OJc,F),P=this.eHi("RankerLogging"),K=window.performance.now();this.Gf.Wj(this.fHi(),2,C,P,!1,0,G=>{this.yWb(G,F,K)},G=>{this.gWb(G,F,K)},null,null,!1,4E3,6E3);this.J2e++}RCo(){this.J2e=0}dyg(F){this.wyd=F}}Object(J.a)(I,"InteractionLogger",null,[])},1990:function(J,
L,d){J=d(0);var m=d(1715),f=d(48);class a{constructor(){this.source=0;this.ml=this.M0a=this.Gca=null;this.lma=0;this.sRb=!1;this.mode=this.H_a=0;this.x_c=null;this.iVb=f.a.create()}}Object(J.a)(a,"InputState",null,[]);class l{constructor(){this.timeout=this.succeeded=this.Jza=!1;this.LL=null}}Object(J.a)(l,"OutputState",null,[]);class w{constructor(){this.wQi=this.rye=this.xod=!1;this.sc=this.Rie=this.$hg=this.lse=this.Hdp=this.uvl=this.MTa=this.$I=this.Vub=this.Axc=this.Mop=this.E3l=this.Tq=this.gvf=
this.uv=this.IA=this.Cn=this.xDe=this.B1d=this.wIa=null}}Object(J.a)(w,"RuntimeState",null,[]);d.d(L,"a",function(){return z});class z{constructor(){this.input=new a;this.runtime=new w;this.output=new l;this.logger=new m.a(this)}}Object(J.a)(z,"MergeState",null,[])},1991:function(J,L,d){d.r(L);J=d(0);var m=d(602),f=d(221),a=d(175),l=d(252),w=d(1581),z=d(1722),x=d(1764),u=d(5),v=d(1983);class E{constructor(K,G){this.start=K;this.end=G}}Object(J.a)(E,"MergeDiffIdx",null,[]);class y{constructor(K,G,
R,W=!1,Z=null,T=null,N=!0){this.ezd=this.dzd=this.Gdh=this.MKc=0;this.bbc=this.nKe=null;this.kib=Z||new v.a;this.vg=R;this.rwa=K.VNa();this.zPk=G.VNa();this.HS=new E(0,0);this.nW=new E(0,0);this.lUe=W;this.cIc=N;this.Vwa=T;this.bhl();this.WSo()}get UM(){return this.rwa}get mM(){return this.zPk}get XA(){return this.MKc}get IB(){return this.Gdh}get aAa(){return this.dzd}get Mra(){return this.ezd}get sRl(){const K=new f.a;for(let G=this.nKe.start;G<this.nKe.end;G++)K.add(this.UM.sg(G));return K}get zwf(){const K=
new f.a;for(let G=this.bbc.start;G<this.bbc.end;G++)K.add(this.mM.sg(G));return K}Oxf(K){if(this.IB<K.IB){if(this.IB+this.aAa>K.IB)return!0}else if(this.IB>K.IB){if(K.IB+K.aAa>this.IB)return!0}else if(2===this.XA&&3===K.XA||3===this.XA&&2===K.XA||2===this.XA&&2===K.XA||3===this.XA&&3===K.XA)return!0;return!1}fDj(K,G,R,W){K.YH(G);K.iD(G,R);return W+=R.length-1}gVj(K,G,R,W,Z){let T=this.UM.sg(K),N=this.mM.sg(G);if(!T||!N||!T.Aeb&&!N.Aeb)return{returnValue:!1,WHa:W,aPa:Z};let U=new f.a,ba=new f.a;T.Aeb&&
(U=T.tpd(),T=U.sg(R?0:U.length-1));N.Aeb&&(ba=N.tpd(),N=ba.sg(R?0:ba.length-1));if(!T.VB(N,this.kib,this.Vwa,this.lUe,this.cIc))return{returnValue:!1,WHa:W,aPa:Z};U.length&&(W=this.fDj(this.UM,K,U,W));ba.length&&(Z=this.fDj(this.mM,G,ba,Z));return{returnValue:!0,WHa:W,aPa:Z}}r6l(K,G,R,W,Z,T){for(;Z<=R&&T<=W;){const N=K.sg(Z),U=G.sg(T);if(!N.VB(U,this.kib,this.Vwa,this.lUe,this.cIc))break;this.HS.start+=N.length;this.nW.start+=U.length;Z++;T++}return{kjf:Z,KKg:T}}p6l(K,G,R,W,Z,T){for(;Z>=R&&T>=W;){const N=
K.sg(Z),U=G.sg(T);if(!N.VB(U,this.kib,this.Vwa,this.lUe,this.cIc))return{returnValue:!0,WHa:Z,aPa:T};Z--;T--}return{returnValue:!1,WHa:Z,aPa:T}}q6l(K,G,R,W){let Z=!1;do({kjf:K,KKg:G}=this.r6l(this.UM,this.mM,R,W,K,G)),{WHa:R,aPa:W,returnValue:Z}=this.gVj(K,G,!0,R,W);while(Z);return{kjf:K,KKg:G,WHa:R,aPa:W}}o6l(K,G,R,W){let Z=!1;do{if(!({WHa:R,aPa:W}=this.p6l(this.UM,this.mM,K,G,R,W)).returnValue)break;({WHa:R,aPa:W,returnValue:Z}=this.gVj(R,W,!1,R,W))}while(Z);return{WHa:R,aPa:W}}bhl(){var K=0,G=
0,R=this.UM.length-1,W=this.mM.length-1;0<=R&&this.UM.sg(R);0<=W&&this.mM.sg(W);({kjf:K,KKg:G,WHa:R,aPa:W}=this.q6l(K,G,R,W));if(K<R||G<W)({WHa:R,aPa:W}=this.o6l(K,G,R,W));R++;W++;this.nKe=new E(K,R);this.bbc=new E(G,W);this.HS.end=this.HS.start;this.nW.end=this.nW.start;for(var Z=K;Z<R;Z++){var T=this.UM.sg(Z);this.HS.end+=T.length}for(Z=G;Z<W;Z++)T=this.mM.sg(Z),this.nW.end+=T.length;a.a.instance.Ua(3993809,1,4,"CalculateDiffIndexes: NonGranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",
K,R,G,W);a.a.instance.Ua(3993810,1,4,"CalculateDiffIndexes: GranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",this.HS.start,this.HS.end,this.nW.start,this.nW.end);this.HS.start<=this.HS.end&&this.nW.start<=this.nW.end&&(K=this.UM.sg(K),G=this.mM.sg(G),Z=this.UM.sg(R),T=this.mM.sg(W),R=this.UM.sg(R-1),W=this.mM.sg(W-1),a.a.instance.Ua(3993811,1,4,"CalculateDiffIndexes: Merge Blocks [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}] [Base.UnequalEnd: {4}] [Update.UnequalEnd: {5}]",
K,Z,G,T,R,W))}WSo(){this.Gdh=this.HS.start;this.dzd=this.ezd=0;this.HS.start===this.HS.end&&this.nW.start===this.nW.end?this.MKc=0:this.HS.start===this.HS.end&&this.nW.start<this.nW.end?(this.MKc=1,this.ezd=this.nW.end-this.nW.start):this.nW.start===this.nW.end&&this.HS.start<this.HS.end?(this.MKc=2,this.dzd=this.HS.end-this.HS.start):(this.MKc=3,this.dzd=this.HS.end-this.HS.start,this.ezd=this.nW.end-this.nW.start);a.a.instance.Ua(3993814,1,4,"SetMergeDiffType: [MergeDiffType: {0}] [DiffIndex: {1}] [DiffLengthBase: {2}] [DiffLengthUpdate: {3}]",
this.XA,this.IB,this.aAa,this.Mra)}Gjn(K,G){return K.B7()&&G.B7()?K.runId===G.runId&&K.Og===G.Og:!1}fpn(K){if(!K.B7()||"\ufffc"!==K.text)return!1;K=K.DOb;return K?K.hasProperty(u.a.lk)||K.hasProperty(u.a.QSd)||K.hasProperty(u.a.qyf)||K.hasProperty(u.a.V6)||K.hasProperty(u.a.imageType)||K.hasProperty(u.a.vXa)||K.hasProperty(u.a.pTb)||K.hasProperty(u.a.ft)&&(K=this.vg.getPropertyInt32(K,u.a.ft))&&(36===K||35===K||24===K||23===K||33===K||34===K||44===K||45===K||42===K||43===K)?!0:!1:!1}f9c(K){return K.B7()&&
!this.fpn(K)}Gil(){if(2===this.XA)return!1;var K=this.bbc.start;if(!K)return!1;let G=null;for(var R=this.bbc.start;R<this.bbc.end;R++){const W=this.mM.sg(R);if(this.f9c(W)){G=W;break}}if(!G)return!1;--K;for(R=this.mM.sg(K);R&&!this.f9c(R);)K--,R=this.mM.sg(K);return R&&this.Gjn(R,G)?!0:!1}vxi(K){const G=new f.a;for(let R=0;R<K.length;R++)K.K(R).Aeb?G.iD(G.length,K.K(R).tpd()):G.insert(G.length,K.K(R));return G}Ijn(){if(3!==this.XA||this.aAa!==this.Mra)return!1;const K=this.vxi(this.sRl),G=this.vxi(this.zwf);
if(K.length!==G.length)return!1;for(let R=0;R<K.length;R++)if(!K.K(R).VB(G.K(R),this.kib,this.Vwa,!0,this.cIc))return!1;return!0}Hjn(){if(0!==this.XA&&3!==this.XA||this.UM.length!==this.mM.length)return!1;let K=!1;for(let G=0;G<this.UM.length;G++){if(!this.UM.K(G).VB(this.mM.K(G),this.kib,this.Vwa,!0,this.cIc))return!1;if(3===this.UM.K(G).type||1===this.UM.K(G).type){const R=this.UM.K(G),W=this.mM.K(G);K=R.runId!==W.runId||R.Og!==W.Og||K}}return K}}Object(J.a)(y,"MergeBlockDiff",null,[]);var H=d(1517);
class I{constructor(K,G){this.id=K;this.index=G}}Object(J.a)(I,"ParagraphStartIndex",null,[]);var F=d(1609),C=d(1484);d.d(L,"ParagraphMerge",function(){return P});class P{constructor(K,G,R,W,Z,T,N){this.d$b=this.sGb=this.Np=this.Cy=null;this.ui=!1;this.MHh=this.dgh=this.J8g=this.wya=this.IQa=this.rwa=null;this.ee=K;this.vH=G;this.pHa=W;this.UFa=R;this.Uwa=Z;this.Vwa=T;this.vg=N}hEi(K){const G=new m.a;K.UM.forEach(R=>{2===R.type&&G.add(R.wk);return!0});K.mM.forEach(R=>{2===R.type&&G.remove(R.wk);return!0});
return G}CAi(K){const G=new f.a;K.mM.forEach(R=>{2===R.type&&G.add(R.wk);return!0});return G}s4h(K){const G=new f.a;let R=0,W=0;K.mM.forEach(Z=>{2===Z.type&&(G.add(new I(Z.wk,R<K.IB?R:R<K.IB+K.Mra?K.IB:R-K.Mra+K.aAa)),R=W);W+=Z.length;return!0});return G}Ivl(K,G){var R=this.s4h(K);const W=this.s4h(G);K=this.hEi(K);const Z=this.hEi(G);G=new f.a;const T=new m.a;let N=0;for(let U=0;U<R.length;U++){const ba=R.K(U);if(N<W.length){let X=W.K(N);for(;N<W.length&&X.index<=ba.index;){if(X.id.equals(ba.id)){N++;
break}K.contains(X.id)||T.contains(X.id)||(G.add(X.id),T.add(X.id));N++;X=W.K(N)}}Z.contains(ba.id)||(G.add(ba.id),T.add(ba.id))}for(;N<W.length;)R=W.K(N),K.contains(R.id)||T.contains(R.id)||(G.add(R.id),T.add(R.id)),N++;return G}initialize(){if(this.ui){const K=!!this.Cy&&!!this.Np;this.ee.logger.Pi(Object.assign(new H.a,{$j:"ParagraphMerge.Initialize",info:"MergeDiff objects not initialized"}));return K}this.ui=!0;if(!({UM:this.rwa,v_c:this.IQa,csd:this.wya,zSd:this.J8g,C1d:this.dgh,yDe:this.MHh}=
C.a.r9h(this.ee,this.vg,this.vH,this.UFa,this.pHa,this.Uwa,!1,!1)).returnValue)return!1;this.Cy=new y(this.rwa,this.IQa,this.vg,void 0,void 0,this.Vwa);this.Np=new y(this.rwa,this.wya,this.vg,void 0,void 0,this.Vwa);a.a.instance.Ua(593272919,1,4,String.format("FavoredBaseDiffLen: {0} FavoredUpdateDiffLen: {1} UnfavoredBaseDiffLen: {2} UnfavoredUpdateDiffLen {3}",this.Cy.aAa,this.Cy.Mra,this.Np.aAa,this.Np.Mra));return!0}MOa(){a.a.instance.Ua(593826836,1,4,"Attempting to merge with LCS");let K=!1;
const G=new x.a(this.vg,this.ee);let R=null,W=null;var Z=null;const T=U=>this.ee.runtime.Cn.K(U),N=U=>this.ee.runtime.uv.K(U)||this.ee.runtime.Cn.K(U);this.Cy=new y(this.rwa,this.IQa,this.vg,void 0,void 0,this.Vwa,!1);this.Np=new y(this.rwa,this.wya,this.vg,void 0,void 0,this.Vwa,!1);({lK:R}=G.U$h(this.vH,T,this.UFa,U=>this.ee.runtime.IA.K(U)||this.ee.runtime.Cn.K(U),this.Cy.IB,this.Cy.IB+this.Cy.aAa,this.Cy.IB+this.Cy.Mra)).returnValue&&({lK:W}=G.U$h(this.vH,T,this.pHa,N,this.Np.IB,this.Np.IB+this.Np.aAa,
this.Np.IB+this.Np.Mra)).returnValue&&(K=!0);K||(a.a.instance.Ua(593826835,1,2,"Failed to create update hints with LCS"),K=!1);K&&(Z=new F.a(this.ee,this.vH,this.UFa,this.pHa,U=>this.ee.runtime.sc?this.ee.runtime.sc.isFeatureEnabled(U):!1,this.vg,null,R,W),({Tq:Z}=Z.Mzc()).returnValue||(a.a.instance.Ua(593826834,1,2,"Failed to merge using LCS generated UpdateHints"),this.ee.logger.Pi(Object.assign(new H.a,{$j:"TryLCSMerge",eventId:"9zrqs"})),K=!1));a.a.instance.Ua(593826833,1,K?4:2,"TryLCSMerge: [Success: {0}]",
K);return{returnValue:K,Tq:Z}}Mzc(){let K;K=null;if(!this.initialize())return this.ee.logger.EX("ParagraphMerge Initialize"),this.Zab(),{returnValue:!1,Tq:K};this.ee.logger.EX("ParagraphMerge Initialize");let G;this.ee.logger.Wwe(2);let R=({MOa:G}=this.bUl()).returnValue;R=R&&({Tq:K,MOa:G}=this.Z2c(this.ee,this.vg,this.Uwa,this.d$b,this.sGb)).returnValue;this.ee.logger.Uyg();if(!R){this.ee.logger.EX("ParagraphMerge DoMergeInteral");if(G){this.ee.logger.Wwe(3);({Tq:K,returnValue:R}=this.MOa());this.ee.logger.Uyg();
if(R)return{returnValue:!0,Tq:K};this.Zab();return{returnValue:!1,Tq:K}}this.Zab();return{returnValue:!1,Tq:K}}if(!({Tq:K,MOa:G}=this.Z2c(this.ee,this.vg,this.Uwa,this.d$b,this.sGb)).returnValue)return this.ee.logger.EX("ParagraphMerge DoMergeInteral"),this.Zab(),{returnValue:!1,Tq:K};this.ee.logger.EX("ParagraphMerge DoMergeInteral");return{returnValue:!0,Tq:K}}Z2c(){let K;if(!({Roe:K}=C.a.Z2c(this.ee,this.vg,this.Uwa,this.d$b,this.sGb)).returnValue)return this.ee.logger.EX("ParagraphMerge GetMergeableObjectsFromMergeBlocks"),
this.Zab(),{returnValue:!1,Tq:K,MOa:!0};this.ee.logger.EX("ParagraphMerge GetMergeableObjectsFromMergeBlocks");return{returnValue:!0,Tq:K,MOa:!1}}Zab(K=!1){a.a.instance.Rna(4478665,1,1,"ParagraphMergeFailed: [IsCpMerge: "+K+"] BaseRevisionMergeBlocksList: {0}",this.J8g);a.a.instance.Rna(4478666,1,1,"FavoredRevisionMergeBlocksList: {0}",this.dgh);a.a.instance.Rna(4478667,1,1,"UnfavoredRevisionMergeBlocksList: {0}",this.MHh);K=new f.a;C.a.lqc(this.vg,"BaseObjects_",this.vH,K);C.a.lqc(this.vg,"FavoredObjects_",
this.UFa,K);C.a.lqc(this.vg,"ConflictObjects_",this.pHa,K);C.a.dAn(this.ee,K)}jYh(K){let G,R;R=G=0;if(0===this.Cy.XA)G=this.Np.IB;else if(1===this.Cy.XA)G=this.Np.IB<this.Cy.IB?this.Np.IB:this.Np.IB===this.Cy.IB?K||1!==this.Np.XA?this.Np.IB+this.Cy.Mra:this.Np.IB:this.Np.IB+this.Cy.Mra;else if(2===this.Cy.XA||3===this.Cy.XA)G=this.Np.IB<=this.Cy.IB?this.Np.IB:this.Np.IB+(this.Cy.Mra-this.Cy.aAa);if(2===this.Np.XA||3===this.Np.XA)R=G+this.Np.aAa;return{RJi:G,sQm:R}}Ymi(K,G){let R;R=0;if(!G)return{returnValue:!0,
xdd:R};let W=0,Z=0;for(;W<K.length;){let T;for(let N=W;N<K.length;N++){W=N;T=K.K(N);const U=T.length;Z+=U;if(!(Z<G)){if(Z>G)if(T.Aeb)K.YH(W),K.iD(W,T.tpd()),Z-=U;else return a.a.instance.Ua(3993819,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}] as the block could not be split",G),this.ee.logger.Pi(Object.assign(new H.a,{$j:"FindNonGranularListIndex",eventId:"appd1"})),{returnValue:!1,xdd:R};break}}if(Z===G)return W++,
R=W,{returnValue:!0,xdd:R}}a.a.instance.Ua(3993820,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}]",G);this.ee.logger.Pi(Object.assign(new H.a,{$j:"FindNonGranularListIndex",eventId:"appd2"}));return{returnValue:!1,xdd:R}}V6k(K,G,R){let W=0;var Z=0,T=!1;const N=this.Np.zwf.VNa();if(this.Np.Gil())for(--G;0<=G;G--){let U=K.K(G);if(this.Np.f9c(U)){Z=K.K(G);W=Z.runId;Z=Z.Og;T=!0;break}}T||((Z=K.K(R))&&this.Np.f9c(Z)?
(W=Z.runId,Z=Z.Og):Z=W=0);for(K=0;K<N.length;K++)R=N.K(K),R.B7()&&(T=R,this.Np.f9c(R)?(T.runId=W,T.Og=Z):(T.runId=0,T.Og=0));return N}tZi(K){if(2===K.length){const G=1===K.K(0).type?K.K(0):null;K=2===K.K(1).type;if(G&&K&&""===G.text)return!0}return!1}bUl(){const K=this.Cy.Hjn();if(!K&&0===this.Cy.XA)return this.d$b=this.Np.mM.VNa(),this.sGb=this.CAi(this.Np),{returnValue:!0,MOa:!1};if(0===this.Np.XA)return this.d$b=this.Cy.mM.VNa(),this.sGb=this.CAi(this.Cy),{returnValue:!0,MOa:!1};(this.tZi(this.Cy.mM)||
this.tZi(this.Np.mM))&&this.ee.logger.t8i(Object.assign(new H.a,{info:"DoMergeInternal - OneParaEmpty"}));if(!K){var G=this.Cy.Oxf(this.Np);G&&this.Uwa(48)&&(a.a.instance.Ua(17326359,1,2,"DoMergeInternal: Diff overlaps when we take formatting ids into account. Running another diff without formatting ids"),this.Cy=new y(this.rwa,this.IQa,this.vg,!0,void 0,this.Vwa),this.Np=new y(this.rwa,this.wya,this.vg,!0,void 0,this.Vwa),G=this.Cy.Oxf(this.Np));if(G)return a.a.instance.Ua(3993821,1,2,"DoMergeInternal: We were unable to merge as there was an overlap in the changes in the 2 revisions"),
this.ee.logger.Pi(Object.assign(new z.a,{$j:"ParagraphMerge",eventId:"appd3"})),{returnValue:!1,MOa:!0}}var R;G=0;this.sGb=this.Ivl(this.Cy,this.Np);({RJi:R,sQm:Z}=this.jYh(!1));const W=this.Cy.mM.VNa();if(!({xdd:R}=this.Ymi(W,R)).returnValue||(2===this.Np.XA||3===this.Np.XA)&&!({xdd:G}=this.Ymi(W,Z)).returnValue)return{returnValue:!1,MOa:!1};if(2===this.Np.XA||3===this.Np.XA){this.cwc(W,G);this.cwc(W,R-1);var Z=null;for(var T=G-1;T>=R;T--)2===W.K(T).type&&(Z=W.K(T)),W.YH(T);0<W.length&&(T=W.K(W.length-
1),2!==T.type&&4!==T.type&&Z&&(this.ee.runtime.sc.DI(69),this.ee.runtime.sc.isFeatureEnabled(69)&&(W.add(Z),this.sGb.add(Z.wk))));a.a.instance.Ua(4019726,1,4,"DoMergeInternal deleted [Length: {0}] merge blocks at [Index: {1}]",G-R-1,R)}if(1===this.Np.XA||3===this.Np.XA)Z=this.Np.zwf,K&&(Z=this.V6k(W,R,G)),this.cwc(W,R-1),this.cwc(W,R),this.cwc(Z,0),this.cwc(Z,Z.length-1),W.iD(R,Z),a.a.instance.Ua(4019727,1,4,"DoMergeInternal: Inserted merge blocks at [Index: {0}] [Syncdiff merge: {1}] [Merge Blocks: {2}]",
R,K,Z.Qr());this.d$b=W;return{returnValue:!0,MOa:!1}}cwc(K,G){0>G||G>=K.length||(K=K.K(G),Object(l.a)(w.a,K)&&(K.oXa=!0))}osd(K,G){let R;R=G;if(!this.initialize())return{returnValue:!1,idb:K,Xua:R};if(this.Np.Oxf(this.Cy))return this.Zab(!0),this.ee.logger.Pi(Object.assign(new z.a,{$j:"ParagraphMerge",info:"Is a CpMerge"})),{returnValue:!1,idb:K,Xua:R};if(0===this.Np.XA||3===this.Np.XA&&this.Np.Ijn())return{returnValue:!0,idb:K,Xua:G};let W;({RJi:W}=this.jYh(!0));G<W||G===W&&(1!==this.Np.XA||1===
this.Np.XA&&1===this.Cy.XA&&G===this.Cy.IB+this.Cy.Mra)?R=G:(R=G+this.Np.Mra-this.Np.aAa,R<W&&(R=W));return{returnValue:!0,idb:K,Xua:R}}}Object(J.a)(P,"ParagraphMerge",null,[1413])},1995:function(J,L,d){d.r(L);J=d(0);var m=d(14),f=d(5),a=d(34),l=d(175),w=d(221),z=d(48),x=d(1713),u=d(1580),v=d(1515),E=d(1484);class y{constructor(C,P,K=null,G=null){this.author=C;this.Icd=P;this.klg=K||z.a.nil;this.aMa=G}VB(C){return C?this.author===C.author&&this.Icd===C.Icd&&this.klg===C.klg&&this.aMa===C.aMa:!1}}
Object(J.a)(y,"RunMergeBlockTrackedChangeAttribute",null,[]);class H{constructor(C,P,K){this.msb=C||H.ezf;this.job=P||H.ezf;this.Fua=K||H.ezf}get pWm(){return 0<this.msb.author.length}get SVm(){return 0<this.job.author.length}get VWm(){return 0<this.Fua.author.length}VB(C){return C?this.msb.VB(C.msb)&&this.job.VB(C.job)&&this.Fua.VB(C.Fua):!1}}H.ezf=new y("",0);Object(J.a)(H,"RunMergeBlockTrackedChangeInfo",null,[]);var I=d(1782);d.d(L,"ParagraphMergeBlockCreator",function(){return F});class F extends u.a{constructor(C,
P,K,G,R,W,Z,T){super();this.maxValue=Number.MAX_VALUE;this.Vt=new x.a;this.x4b=null;this.qG=0;this.knh=!1;this.LKc="";this.jJe=C;this.Kq=P;this.xv=K;this.ZLk=G;this.YAd=R;this.umh=W;this.Z7b=T;this.vg=Z;if(this.vg.hasProperty(this.Kq,m.a.Pn))if(this.vg.hasProperty(this.Kq,f.a.Yc))if(this.vg.hasProperty(this.Kq,f.a.Gq))if(this.vg.hasProperty(this.Kq,f.a.Lt))if(this.vg.hasProperty(this.Kq,m.a.Qn))if(this.G5=this.vg.getPropertyString(this.Kq,m.a.Pn),this.dcf=this.vg.getPropertyUint32(this.Kq,f.a.Yc),
this.ut=this.vg.getPropertyUint32s(this.Kq,f.a.Gq),this.hId=this.vg.getPropertyUint32s(this.Kq,f.a.Lt),this.WRe=this.vg.getPropertyObjectIds(this.Kq,m.a.Qn),this.G5||""===this.G5)if(this.G5.length||1!==this.WRe.length||(this.ut.length||(this.ut.add(0),l.a.instance.Ua(4322134,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no runIDs, fixing it")),this.hId.length||(this.hId.add(0),l.a.instance.Ua(4322135,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no paraIDs, fixing it"))),
this.rDk=this.f4d(this.Kq,f.a.Pag,this.ut.length),this.IMc=this.f4d(this.Kq,m.a.CCa,this.ut.length),this.Zpa=this.f4d(this.Kq,m.a.Lyb,this.ut.length),this.ipa=this.f4d(this.Kq,f.a.ZVa,this.ut.length),this.Kpa=this.aNm(this.Kq,f.a.VMa,this.ut.length),this.e3m(),C=this.vg.hasProperty(this.Kq,m.a.vn)?this.vg.getPropertyUint32s(this.Kq,m.a.vn):new w.a,this.RKd=E.a.NNj(C,this.G5.length),this.ut.length!==this.hId.length)l.a.instance.Ua(3993799,1,1,"MergeBlockIterator: Length of RunIds and ParaIds does not match on [Object: {0}]",
P.id);else if(this.ut.length!==this.WRe.length)l.a.instance.Ua(3993800,1,1,"MergeBlockIterator: Length of FormattingIds and ParaIds does not match on [Object: {0}]",P.id);else{this.umh&&(this.vg.hasProperty(this.Kq,f.a.Ew)?this.x4b=this.vg.getPropertyObjectIds(this.Kq,f.a.Ew):(l.a.instance.Ua(40939931,1,2,"MergeBlockIterator: ChangeIds are null on [Object: {0}]",P.id),this.x4b=this.u2(this.ut.length,z.a.nil)),this.ut.length!==this.x4b.length&&(l.a.instance.Ua(40939932,1,2,"MergeBlockIterator: Length of RunIds and ChangeIds don't match on [Object: {0}]. RunIds Length: {1} ChangeIds Length: {2}",
P.id,this.ut.length,this.x4b.length),this.x4b=this.u2(this.ut.length,z.a.nil)));if(this.ut.length!==this.IMc.length||this.ut.length!==this.Zpa.length||this.ut.length!==this.ipa.length||this.ut.length!==this.Kpa.length)this.ut.length===this.IMc.length||this.YAd||l.a.instance.Ua(8266445,1,1,"MergeBlockIterator: Length of NotProofedRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [NotProofedRuns Length: {2}]",P.id,this.ut.length,this.IMc.length),this.ut.length===this.Zpa.length||
this.YAd||l.a.instance.Ua(8266446,1,1,"MergeBlockIterator: Length of SpellErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [SpellErrorRuns Length: {2}]",P.id,this.ut.length,this.Zpa.length),this.ut.length===this.ipa.length||this.YAd||l.a.instance.Ua(20742792,1,1,"MergeBlockIterator: Length of GrammarErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [GrammarErrorRuns Length: {2}]",P.id,this.ut.length,this.ipa.length),this.ut.length===this.Kpa.length||
this.YAd||l.a.instance.Ua(25274202,1,1,"MergeBlockIterator: Length of ProofingErrorHints and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [ProofingErrorHints Length: {2}]",P.id,this.ut.length,this.Kpa.length),C=this.vg.getPropertyBool(this.Kq,m.a.wqf),l.a.instance.Ua(17877020,1,4,"MergeBlockIterator: Reproofing Para {0}. [ForceProofing: {1}] [ContainsIgnoredSpellingErrors: {2}]",P.id,R,null==C?!1:C),this.IMc=this.u2(this.ut.length,!0),this.Zpa=this.u2(this.ut.length,!1),this.ipa=this.u2(this.ut.length,
!1),this.Kpa=this.u2(this.ut.length,0),this.vg.setPropertyBool(this.Kq,m.a.wqf,!1);this.Vt.UAp(this.ut.length)?(this.RKd.length!==this.ut.length+1&&l.a.instance.Ua(3993801,1,1,"MergeBlockIterator: Length of RunIdexes is different than expected for [Object: {0}] [RunIds Length: {1}] [RunIndices Length: {2}]",P.id,this.ut.length,this.RKd.length),this.uAk=!0):l.a.instance.Ua(23205786,1,1,"MergeBlockIterator: Length of RunIds and tracked changes properties does not match on [Object: {0}]",P.id)}else l.a.instance.Ua(4322133,
1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",P.id);else l.a.instance.Ua(3993798,1,1,"MergeBlockIterator: FormattingIds is null on [Object: {0}]",P.id);else l.a.instance.Ua(3993797,1,1,"MergeBlockIterator: ParaIds is null on [Object: {0}]",P.id);else l.a.instance.Ua(3993796,1,1,"MergeBlockIterator: RunIds is null on [Object: {0}]",P.id);else l.a.instance.Ua(3993795,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",P.id);else l.a.instance.Ua(3993794,1,
1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",P.id)}e3m(){this.vg.hasProperty(this.Kq,f.a.ZKa)?this.Vt.ksb=this.vg.getPropertyBools(this.Kq,f.a.ZKa):this.Vt.ksb=this.u2(this.ut.length,!1);this.vg.hasProperty(this.Kq,f.a.kka)?this.Vt.iob=this.vg.getPropertyBools(this.Kq,f.a.kka):this.Vt.iob=this.u2(this.ut.length,!1);this.vg.hasProperty(this.Kq,f.a.$Ka)?this.Vt.jsb=this.vg.getPropertyStrings(this.Kq,f.a.$Ka):this.Vt.jsb=this.u2(this.ut.length,"");this.vg.hasProperty(this.Kq,
f.a.fJa)?this.Vt.hob=this.vg.getPropertyStrings(this.Kq,f.a.fJa):this.Vt.hob=this.u2(this.ut.length,"");this.vg.hasProperty(this.Kq,f.a.aLa)?this.Vt.lsb=this.vg.getPropertyListOfMilliseconds(this.Kq,f.a.aLa):this.Vt.lsb=this.u2(this.ut.length,0);this.Z7b&&this.vg.hasProperty(this.Kq,a.a.JWa)?this.Vt.IWa=this.vg.PLf(this.Kq,a.a.JWa):this.Vt.IWa=null;this.vg.hasProperty(this.Kq,f.a.gJa)?this.Vt.t7a=this.vg.getPropertyListOfMilliseconds(this.Kq,f.a.gJa):this.Vt.t7a=this.u2(this.ut.length,0);this.Z7b&&
this.vg.hasProperty(this.Kq,a.a.zUa)?this.Vt.XMb=this.vg.PLf(this.Kq,a.a.zUa):this.Vt.XMb=null;this.vg.hasProperty(this.Kq,f.a.UMa)?this.Vt.Acb=this.vg.getPropertyBools(this.Kq,f.a.UMa):this.Vt.Acb=this.u2(this.ut.length,!1);this.vg.hasProperty(this.Kq,f.a.KOa)?this.Vt.twb=this.vg.getPropertyStrings(this.Kq,f.a.KOa):this.Vt.twb=this.u2(this.ut.length,"");this.vg.hasProperty(this.Kq,f.a.LOa)?this.Vt.vwb=this.vg.getPropertyListOfMilliseconds(this.Kq,f.a.LOa):this.Vt.vwb=this.u2(this.ut.length,0);this.Z7b&&
this.vg.hasProperty(this.Kq,a.a.f0a)?this.Vt.BXb=this.vg.PLf(this.Kq,a.a.f0a):this.Vt.BXb=null;this.vg.hasProperty(this.Kq,f.a.vEa)?this.Vt.uwb=this.vg.getPropertyObjectIds(this.Kq,f.a.vEa):this.Vt.uwb=this.u2(this.ut.length,z.a.nil)}f4d(C,P,K){return this.vg.hasProperty(C,P)?this.vg.getPropertyBools(C,P):this.u2(K,!1)}aNm(C,P,K){return this.vg.hasProperty(C,P)?this.vg.getPropertyUint32s(C,P):this.u2(K,0)}u2(C,P){const K=new w.a;for(let G=0;G<C;G++)K.add(P);return K}yLm(C){const P=this.RKd.sg(C);
C=this.RKd.sg(C+1);return this.G5.substring(P,C)}VAi(){if(this.knh)return null;var C=this.qG<this.ut.length?this.ut.sg(this.qG):this.maxValue;if(C===this.maxValue||this.ZLk&&!this.G5.length)return this.knh=!0,C=new v.a(this.xv,this.Kq.id,this.dcf),this.LKc=this.ghf(this.LKc,C.toString()),C;const P=this.hId.sg(this.qG),K=this.WRe.sg(this.qG),G=this.rDk.sg(this.qG),R=this.IMc.sg(this.qG),W=this.Zpa.sg(this.qG),Z=this.ipa.sg(this.qG),T=this.Kpa.sg(this.qG),N=this.umh?this.x4b.sg(this.qG):null;var U=
null;this.Vt.ksb.sg(this.qG)&&(U=new y(this.Vt.jsb.sg(this.qG)||"",this.Vt.lsb.sg(this.qG)));if(this.Z7b&&null!=U){var ba=this.Vt.IWa.length<this.qG?this.Vt.IWa[this.qG]:null;null!=ba&&null!=ba.Oca&&(U.aMa=this.vg.LHf(new Date(ba.Oca)))}ba=null;this.Vt.iob.sg(this.qG)&&(ba=new y(this.Vt.hob.sg(this.qG)||"",this.Vt.t7a.sg(this.qG)));if(this.Z7b&&null!=ba){var X=this.Vt.XMb.length<this.qG?this.Vt.XMb[this.qG]:null;null!=X&&null!=X.Oca&&(ba.aMa=this.vg.LHf(new Date(X.Oca)))}X=null;this.Vt.Acb.sg(this.qG)&&
(X=new y(this.Vt.twb.sg(this.qG)||"",this.Vt.vwb.sg(this.qG),this.Vt.uwb.sg(this.qG)));if(this.Z7b&&null!=X){const Y=this.Vt.BXb.length<this.qG?this.Vt.BXb[this.qG]:null;null!=Y&&null!=Y.Oca&&(X.aMa=this.vg.LHf(new Date(Y.Oca)))}U=new H(U,ba,X);ba=this.yLm(this.qG);this.qG++;X=ba.startsWith("\ufddfHYPERLINK ");C=new I.a(this.jJe,this.xv,this.Kq.id,P,C,K,ba,G,!X,R,W,Z,T,U,N);this.LKc=this.ghf(this.LKc,C.toString());return C}AAi(){let C;C=null;var P="";if(!this.uAk)return{L7f:C,pbb:P};if(P=this.VAi())C=
new w.a,C.add(P);for(;P=this.VAi();)C.add(P);P=this.LKc;return{L7f:C,pbb:P}}}Object(J.a)(F,"ParagraphMergeBlockCreator",u.a,[])},2001:function(J,L,d){d.r(L);J=d(0);var m=d(221),f=d(1580),a=d(1514);class l extends a.a{constructor(z,x){super(4,z,x)}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.wk)}Qic(){return"Table"}clone(){return new l(this.source,this.wk)}VB(z,x,u,v=!1){return super.VB(z,x,u,v)?this.wk.equals(z.wk):!1}get length(){return 1}}Object(J.a)(l,"TableMergeBlock",
a.a,[]);d.d(L,"TableMergeBlockCreator",function(){return w});class w extends f.a{constructor(z,x){super();this.U8g=new l(x,z.id)}AAi(){let z;z=new m.a;z.add(this.U8g);return{L7f:z,pbb:this.ghf("",this.U8g.toString())}}}Object(J.a)(w,"TableMergeBlockCreator",f.a,[])},2105:function(J,L,d){function m(a){var l=!0,w=[];a.forEach(function(z){var x,u=z.classification;if(u===f.a.nPg.cRg||u===f.a.nPg.Pdk){u=(x={},x.name=z.name,x.bool=null,x.string=null,x["double"]=null,x.int64=null,x.date=null,x.contract=
null,x);switch(z.dataType){case f.a.yud.Boolean:u.bool=z.value;break;case f.a.yud.Double:u["double"]=z.value;break;case f.a.yud.Int64:u.int64=z.value;break;case f.a.yud.String:u.string=z.value;break;default:return}w.push(u)}else l=!1});return l?w:[]}d.d(L,"a",function(){return m});var f=d(2106)},2120:function(J,L,d){d.r(L);var m=d(2),f=d(0),a=d(169),l=d(764);class w extends a.a{constructor(Q,Da){super(!1,!1,!0);this.pZb=(eb,Tb)=>{1===eb&&(this.XEa.ySf=Tb.tooltipPersistenceEnabled,m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",
!1)&&(eb=Tb.textSelectionChangeEnabled,this.XEa.Tyc!==eb&&this.YNk.raiseEvent(l.a.dnj),this.XEa.Tyc=eb))};this.XEa=Q;this.YNk=Da}start(){const Q={["tooltipPersistenceEnabled"]:this.XEa.ySf};m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(Q.textSelectionChangeEnabled=this.XEa.Tyc);this.mi("",this.pZb,{["id"]:"AccessibilitySettingsDialog",["bodyControls"]:Q})}}Object(f.a)(w,"AccessibilitySettingsDialog",a.a,[]);var z=d(89),x=d(13);
class u{constructor(Q,Da){this.L2o=()=>{(new w(this.XEa,l.a.instance())).start();return 32};this.ga=Q;this.XEa=Da}Xb(){this.ga.qa(x.a.K2o,z.a.frame,this.L2o)}}Object(f.a)(u,"AccessibilitySettingsDialogActor",null,[1319]);var v=d(333);const E=Q=>{const Da=new v.a;m.AFrameworkApplication.Ee.Wj(H(Q),1,null,null,!0,2,eb=>{200===eb.data.Ie?Da.hg("true"===eb.data.De.toLowerCase()):Da.hg(!1)},()=>{Da.hg(!1)},null,void 0,void 0,void 0,void 0,"7");return Da.task},y=(Q,Da)=>{m.AFrameworkApplication.Ee.Wj(H(Q),
2,Da.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8")},H=Q=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",m.AFrameworkApplication.J.appSettings.RoamingServiceHandlerWebServiceBase||"",Q,m.AFrameworkApplication.um);var I=d(151);class F{constructor(){this.Cac=this.e7b=null}get ySf(){return!!this.e7b}set ySf(Q){Q!==this.e7b&&(this.e7b=Q,I.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(Q),this.Gee()&&y("saveHoverableRibbonTooltipIsEnabled",
Q))}get Tyc(){return!!this.Cac}set Tyc(Q){Q!==this.Cac&&(this.Cac=Q,this.Gee()&&y("saveTextSelectionHighlightChangeIsEnabled",Q))}Cxn(){const Q=new v.a;if(this.e7b)Q.hg(this.e7b);else if(this.Gee()){const Da=E("getHoverableRibbonTooltipIsEnabled");Da.continueWith(()=>{this.e7b=Da.result;I.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(Da.result);Q.hg(Da.result)},8)}else Q.hg(!1)}gyn(){const Q=new v.a;if(this.Cac)Q.hg(this.Cac);else if(this.Gee()){const Da=E("getTextSelectionHighlightChangeIsEnabled");
Da.continueWith(()=>{this.Cac=Da.result;Q.hg(Da.result)},8)}else Q.hg(!1)}Gee(){const Q=m.AFrameworkApplication.J.$("IsRoamingServiceEnabled"),Da=m.AFrameworkApplication.J.$("IsAnonymousUser");return Q&&!Da}}Object(f.a)(F,"AccessibilitySettingsInfo",null,[1318]);var C=d(177),P=d(24);class K{constructor(){this.W=null}get name(){return"Common.App.AccessibilitySettings"}uc(Q){this.W=Q;this.W.register(F,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as(495).Sd(()=>new F).ha();this.W.register(u,
"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as(1191).Sd(()=>new u(m.AFrameworkApplication.va,this.W.Oa(495))).ha()}init(){const Q=this.W.Oa(495),Da=this.W.Oa(1191);Q&&Da?(Da.Xb(),Q.Cxn(),Q.gyn(),P.b(508827098,200,50,"Text Selection Highlight Change Setting value on boot: {0}",Q.Tyc)):P.b(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){C.a.instance.Lc(new K)}}
Object(f.a)(K,"AccessibilitySettingsPackage",null,[0,1]);var G=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",Width:"330"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]},R=d(108),W=d(88);class Z extends Sys.EventArgs{constructor(Q,Da){super();this.OBe=Q;this.actualValue=Da}}Object(f.a)(Z,
"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);class T{constructor(){this.b5b=[];this.Ibh=this.tNe=0;this.kj=null;this.sa=new W.a;this.JAl=(Q,Da)=>{P.b(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.AXd(Da.OBe,Da.actualValue))}}init(Q,Da,eb){this.kj=Q;this.tNe=Da;this.Ibh=eb;this.kj.cff(Object(R.a)(this,this.sle,"onCpuMeterFrameAvailable"));this.CZk(this.JAl)}sle(Q,Da){Da.bfj&&(Array.enqueue(this.b5b,Da.bfj.CP),this.b5b.length>this.Ibh&&(Array.dequeue(this.b5b),
this.Zll()))}Zll(){var Q=this.b5b.length;let Da=0;for(let eb=0;eb<Q;eb++){const Tb=Array.dequeue(this.b5b);Da+=Tb;Array.enqueue(this.b5b,Tb)}Q=Da/Q;Q>this.tNe&&this.sa.raiseEvent("CPTTE",new Z(this.tNe,Q))}CZk(Q){this.sa.addHandler("CPTTE",Q)}AXd(Q,Da){const eb={};eb.ThresholdValue=Q;eb.ActualValue=Da;return eb}}Object(f.a)(T,"CpuMeterMonitor",null,[1349]);class N{constructor(){this.S=this.T=this.M=this.C=0}}Object(f.a)(N,"ProfileInformation",null,[]);var U=d(10),ba=d(36),X=d(236),Y=d(86);class ca{constructor(Q=
0,Da=0){this.ZDb=!1;this.xDb={};this.OFd=Q;this.gGd=Da;this.Eaf=0;ba.a.addHandler(window.self,U.a.JPh,()=>{this.ZDb=!0});ba.a.addHandler(window.self,U.a.KPh,()=>{this.ZDb=!1})}MPh(Q,Da,eb){const Tb=ca.generateKey(Da,eb);Tb in this.xDb?Da=this.xDb[Tb]:(Da=new N,Da.S=eb?1:0,this.xDb[Tb]=Da,this.Eaf++);Da.C++;Da.M=Q>Da.M?Q:Da.M;Da.T+=Q}MHa(Q,Da){this.MPh(Q,Da,!1);this.ZDb&&this.MPh(Q,Da,!0)}getData(){if(0<this.gGd&&this.Eaf>this.gGd)return this.Mlm();const Q=0<this.OFd,Da={},eb=this.xDb;for(const Ac in eb){var Tb=
Ac;const hd=eb[Ac];this.HGj(hd);Q&&hd.T>=this.OFd&&(Da[Tb]=hd)}return Q?Y.a.Tf(Da)?null:Da:this.xDb}Mlm(){var Q=0<this.OFd,Da=[];const eb=this.xDb;for(const Tb in eb){const Ac={key:Tb,value:eb[Tb]},hd=Ac.value;(!Q||hd.T>=this.OFd)&&Array.add(Da,Ac)}if(Da.length>this.gGd)Da.sort((Tb,Ac)=>Ac.value.T-Tb.value.T),Da=Da.slice(0,this.gGd);else if(!Da.length)return null;Q={};for(const Tb of Da)Da=Tb.value,this.HGj(Da),Q[Tb.key]=Da;return Q}HGj(Q){Q.M=X.a.PP(Q.M,0);Q.T=X.a.PP(Q.T,0)}reset(){this.xDb={};this.Eaf=
0}static generateKey(Q,Da){return Da?Q+" [it]":Q}}Object(f.a)(ca,"FunctionCallAggregator",null,[1312]);var ia=d(887);class la{}Object(f.a)(la,"CpuMeterFrame",null,[]);class ta extends Sys.EventArgs{constructor(Q){super();this.bfj=Q}}Object(f.a)(ta,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class za{}Object(f.a)(za,"MiniTaskItemInfo",null,[]);class Ha{}Object(f.a)(Ha,"TaskItemInfo",null,[]);var Na=d(1022),ya=d(1269),ma=d(187);class Ea{constructor(Q,Da,eb,Tb,Ac){this.hIb=0;this.H1=null;this.UKd=
this.OEh=0;this.Xxa=!1;this.u6b=0;this.WIc=!1;this.Gxa=null;this.fDd=0;this.d1e=new W.a;this.uNd=[];this.nB=Q;this.a_e=Da;this.cSe=eb;this.Ksh=Tb;m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("WrapSetTimeoutForTelemetryIsEnabled")&&this.ipc();this.Ssk=Ac;this.dSe=new ca(100);this.aCk=Na.a.TG(1,5,new ya.a)}cff(Q){this.d1e.addHandler("OnCpuMeterFrameAvailable",Q)}cCj(Q){this.d1e.removeHandler("OnCpuMeterFrameAvailable",Q)}wwb(Q,Da,eb,Tb=null){eb=Tb?Tb.priority:7;const Ac=this.nB();this.start(Da,
eb);try{Q()}finally{this.stop(Da,Tb),Q=this.nB()-Ac,this.Ksh.track(Q,Da)}}$d(Q,Da){const eb=this.nB();try{Q()}finally{Q=this.nB()-eb,this.cSe.MHa(Q,Da),0<this.hIb&&this.dSe.MHa(Q,Da),this.Ksh.track(Q,Da)}}bgg(Q){const Da=new Ha;Da.TN=Q.X5f;Da.TP=Q.priority;this.Awj(1,Da)}Dqc(Q){this.fDd|=Q}start(Q,Da){if(!this.hIb){this.dSe.reset();const eb=this.r2i(Q);eb&&this.sie(1);this.H1=new Ha;this.H1.TN=Q;this.H1.TP=Da;this.H1.ST=(new Date).toISOString();this.H1.STS=X.a.PP(this.nB(),2);eb?this.H1.UI=1:this.Qjn(Q)?
this.H1.UI=2:this.H1.UI=0}this.hIb++}sie(Q){this.u6b|=Q}UUd(Q=!0,Da=0){this.u6b=Q?0:this.u6b&~Da}stop(Q,Da=null){let eb;this.hIb--;0>=this.hIb&&this.H1&&(eb=this.nB()-this.H1.STS,this.UKd+=eb,this.a_e.MHa(eb,Q),this.r2i(Q)&&this.UUd(!1,1),this.H1.TRT=X.a.PP(eb,2),Da&&(this.H1.TQT=X.a.PP(Da.Cio,2),this.H1.TDT=X.a.PP(Da.O3i,2)),this.Ssk&&(this.Awj(0,this.H1),this.oBo()),this.hIb=0);0<=Q.indexOf(ia.a.Pnp)&&this.Dqc(2);0<=Q.indexOf(ia.a.nDj)&&this.Dqc(4);1===(this.u6b&1)&&this.Dqc(1);2===(this.u6b&2)&&
this.Dqc(8)}oBo(){var Q=this.H1.TRT;if(750<Q){let eb=this.dSe.getData();if(eb){const Tb={};for(const Ac in eb){var Da=eb[Ac];const hd=Ac;hd.startsWith("SiOp_")||hd.endsWith("[it]")||(Tb[hd]=Math.round(100*Da.T/Q))}eb=Tb}Q=Object.assign(new za,{B:this.H1.STS,T:Q,S:eb});this.aCk.track(Q,this.H1.TN)}}E7o(){var Q=this.nB()-this.OEh,Da=X.a.PP(this.UKd/Q*100,2);Q=new la;Q.CP=Da;Q.II=this.fDd;Da=this.a_e.getData();Y.a.count(Da)&&(Q.LRT=Da);Da=this.cSe.getData();Y.a.count(Da)&&(Q.FP=Da);this.d1e.raiseEvent("OnCpuMeterFrameAvailable",
new ta(Q));this.KVj()}KVj(){this.a_e.reset();this.cSe.reset();this.UKd=this.hIb=0;this.OEh=this.nB();this.fDd=0;this.H1=null}run(){this.Xxa?this.E7o():(this.KVj(),this.Xxa=!0);this.Gxa?this.Gxa(Object(R.a)(this,this.run,"run"),1E3):window.setTimeout(Object(R.a)(this,this.run,"run"),1E3)}hQd(Q,Da,eb){const Tb=Array(2);Tb[0]=Da;Tb[1]=eb;this.uNd[Q]||(this.uNd[Q]=[]);this.uNd[Q].push(Tb)}Awj(Q,Da){Q=this.uNd[Q];if(!ma.a.Tf(Q))for(let Tb=0;Tb<Q.length;Tb++){var eb=Q[Tb];const Ac=eb[0];eb=eb[1];Ac&&!Ac(Da)||
eb(Da)}}ipc(){if(!this.WIc){const Q=window.setTimeout;this.Gxa=(Da,eb)=>Q(Da,eb);this.WIc=!0}}r2i(Q){return Q.startsWith("key")||Q.startsWith("input")}Qjn(Q){return Q.startsWith("click")||Q.startsWith("mouse")||Q.startsWith("pointer")}}Object(f.a)(Ea,"CpuMeter",null,[101]);class Ba{constructor(Q){this.AEc=null;this.Nq=new v.a;this.nB=Q}initialize(Q,Da,eb,Tb=!1){this.AEc||(this.AEc=new Ea(this.nB,Q,Da,eb,Tb),this.Nq.hg(this.AEc));return this.AEc}}Object(f.a)(Ba,"CpuMeterProvider",null,[1348]);var $a=
d(153);class ea{constructor(Q=1){this.fF=[];this.Xyd=[];this.Kk=Q}B6l(){let Q=0;for(let Da=0;Da<this.fF.length;Da++)this.fF[Da]<this.fF[Q]&&(Q=Da);return Q}MHa(Q,Da){Q=X.a.PP(Q,2);if(this.fF.length<this.Kk)Array.add(this.fF,Q),Array.add(this.Xyd,Da);else{var eb=this.B6l();Q>this.fF[eb]&&(this.fF[eb]=Q,this.Xyd[eb]=Da)}}getData(){return this.fF.length?{["Vals"]:this.fF,["Desc"]:this.Xyd}:null}reset(){this.fF=[];this.Xyd=[]}}Object(f.a)(ea,"MaxDataAggregator",null,[1312]);var ka=d(41),La=d(19);class va{get name(){return"Common.App.CpuMeter"}uc(Q){Q.register(Ba,
1192).as(100).ha().Sd(()=>new Ba(ka.a.Ge));Q.register(T,"Common.App.CpuMeter.CpuMeterMonitor").as(1193).ha().Sd(()=>new T)}init(){const Q=m.AFrameworkApplication.J;if(Q.$("CpuMeterIsEnabled")){const Da=La.a.instance.resolve(1192);$a.a.instance.Wgf.continueWith(()=>{va.U3m(Q,Da)})}}dispose(){}static U3m(Q,Da){const eb=Na.a.TG(10,5,new ca(Q.ic("TaskManagerLoggingThreshold",0),Q.ic("CpuMeterMaximumEntriesToLog",0)));Da=Da.initialize(new ea(5),new ca,eb,Q.$("CPUMeterExposeTaskDetailsIsEnabled"));Q.$("WordEditorInteractivePerfDisableCpuMeterFrames")||
(Da.run(),Q.$("CpuMeterMonitorIsEnabled")&&La.a.instance.resolve(1193).init(Da,Q.hN("CpuMeterAverageCpuPercentThreshold",80),Q.ic("CpuMeterRollingAverageFramesCount",15)));P.b(16827671,306,50,"Initializing CpuMeter")}static main(){C.a.instance.Lc(new va)}}Object(f.a)(va,"CpuMeterPackage",null,[0,1]);var Ca=d(7),ua=d(87),Sa=d(1046),Ta=d(1032),zb=d(18),Ra=d(1270);class qb{constructor(){this.Lxa=this.vCc=null;this.pbc=!0;this.fJc=!1}uc(Q){m.AFrameworkApplication.J.$("EventTimingMeterIsEnabled")&&Q.register(1274,
209).ha().Sd(()=>new EventTiming.EventTimingMeter)}get name(){return"Common.App.EventTimingMeter"}init(){var Q=new Ta.a(m.AFrameworkApplication.J.ic("EventTimingMeterEventSamplingPercent",0)/100);Q=new Sa.a(Object(R.a)(Q,Q.V_b,"shouldBeInSample"));const Da=Na.a.TG(16,1,Q);this.Lxa=new Ra.a("TypingDuration-SlowPercentileAtValue","Percentile",m.AFrameworkApplication.J.hN("AshaVetoForTypingThresholdInMS",150),m.AFrameworkApplication.J.hN("AshaVetoForTypingThresholdPercentile",95),this.pbc);(this.fJc=
!zb.a.pab)&&m.AFrameworkApplication.XI(()=>{this.xnf()});this.vCc=eb=>{eb=eb.rawEvent.detail;for(const Tb of eb)Da.track(Tb,"EventTimingData"),"false"!==Tb.metadata.altPressed.toString()||"false"!==Tb.metadata.ctrlPressed.toString()||"false"!==Tb.metadata.repeat.toString()||"CharacterKey"!==Tb.metadata.key.toString()&&"Space"!==Tb.metadata.key.toString()||!this.fJc||this.Lxa.lDa(Tb.timeToRequestAnimationFrameMs)};ba.a.addHandler(window.self,U.a.IPh,this.vCc)}dispose(){this.vCc&&(ba.a.removeHandler(window.self,
U.a.IPh,this.vCc),this.vCc=null)}xnf(){this.Lxa.sZa();this.Lxa.Hoj&&(Ca.ULS.sendTraceTag(588649307,209,15,"Report SlowTypingSession Veto with SlowTypingSession error"),ua.Health.instance.recordQosError("SlowTypingSession",["SlowTypingSession"],!1,!0,!0,!1,null))}static main(){C.a.instance.Lc(new qb)}}Object(f.a)(qb,"EventTimingMeterPackage",null,[0,1]);var kb=d(75),Va=d(83),Za=d(29);class Ka{constructor(Q,Da,eb,Tb=null,Ac=null){this.fQb=hd=>{let Ud=!1,Ee=null;try{if(0<hd.data.De.length){const Me=
Object(Va.a)(Object,Za.a(hd.data.De)),Kf=Me?Me[this.kO.Ygf]:null;Kf&&(Ee=Object(Va.a)(Object,Za.a(Kf.toString())))}Ud=!0}catch(Me){this.v9a(null)}Ud&&this.sHc&&this.sHc(hd.data,Ee)};this.v9a=hd=>{this.mHc&&this.mHc(hd?hd.data:null)};this.rao=hd=>{this.Ayh&&this.Ayh(hd?hd.data:null)};this.wcb=hd=>{this.WMc&&this.WMc(hd?hd.data:null)};this.kO=Q;this.sHc=Da;this.mHc=eb;this.Ayh=Tb;this.WMc=Ac}VAf(Q){const Da=new Sys.StringBuilder(this.kO.old);Da.append("RoamingServiceHandler.ashx?action=");Da.append("getFirstRunExperienceSettings");
Da.append("&");Da.append(this.TLf(Q));Da.append("&");Da.append(m.AFrameworkApplication.um);m.AFrameworkApplication.Ee.Wj(Da.toString(),1,null,null,!0,2,this.fQb,this.v9a,null)}e1d(Q){var Da=new Sys.StringBuilder(this.kO.old);Da.append("RoamingServiceHandler.ashx?action=");Da.append("saveFirstRunExperienceSettings");Da.append("&");Da.append(m.AFrameworkApplication.um);Da=Da.toString();Q=Za.c(Q);m.AFrameworkApplication.Ee.Wj(Da,2,Q,null,!0,4,this.rao,this.wcb,null)}TLf(Q){const Da=new Sys.StringBuilder("requestedsettings=");
for(let eb=0;eb<Q.count;eb++)Da.append(Q.K(eb)),eb<Q.count-1&&Da.append(";");return Da.toString()}}Object(f.a)(Ka,"FirstRunExperienceRequestHandler",null,[]);var bb=d(251);class Ib{constructor(){this.VGc=this.KAd=this.kO=null;this.fQb=(Q,Da)=>{Q=Q?+Q.MO-+Q.bH:-1;Q>this.kO.sGj?Ca.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",Q,this.kO.sGj):Da?this.I2o(Da)?(Ca.ULS.sendTraceTag(51675536,
306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.kO.Kcj),this.iCg()):(this.Zwf(!1),Ca.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(Ca.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.iCg())};this.v9a=Q=>{this.Zwf(!1);Ca.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",
Q?Q.Ie:-1)};this.wcb=Q=>{Ca.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",Q?Q.Ie:-1)};this.aVn=Q=>{if(Q){var Da=Q.detail;Q=Q.type;var eb=this.kO&&this.kO.MYh?this.kO.MYh.split("-")[0]:null;if("FRELaunchedEvent"===Q||eb&&Da&&Da.id&&-1!==Da.id.indexOf(eb)){if("FRELaunchedEvent"===Q||Da&&Da.success)Ca.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.xHj(this.kO.currentVersion);
window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.VGc,!0),window.removeEventListener("FRELaunchedEvent",this.VGc,!0))}}}}S3o(Q){Q?(this.kO=Q,this.Ljn()&&(Ca.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),Q=new kb.a,Q.add(this.kO.Ygf),this.KAd=new Ka(this.kO,this.fQb,this.v9a,null,this.wcb),this.KAd.VAf(Q)),(this.kO.G1i||m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",
!1))&&this.iCg()):Ca.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}Ljn(){try{if(this.kO.G1i)return!0;if(!m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||m.AFrameworkApplication.J.$("IsAnonymousUser"))return!1;if(this.kO.ben||this.kO.Moc||m.AFrameworkApplication.J.$("IsO365ConsumerHost"))return!0;const Q=m.AFrameworkApplication.J.ib("FlightId");return-1!==(Q?Q.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(Q){Ca.ULS.sendTraceTag(576582624,
306,10,"Error checking setting {0}",Q?Q.toString():null)}return!1}xHj(Q){const Da={},eb={};eb.FREDisplayedDate=(new Date).toUTCString();eb.VersionDisplayed=Q;eb.RemindMeLater=!1;Da[this.kO.Ygf]=Za.c(eb);Ca.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.KAd&&this.KAd.e1d(Da)}iCg(){this.Zwf(!0);var Q=La.a.instance.Oa(2);Q?this.wSj(Q):(Ca.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",
!0)&&((Q=La.a.instance.Ra(2))?Q.execute(Da=>{this.wSj(Da)}):Ca.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}wSj(Q){if(Q){var Da=this.kO.e9l;Da&&m.AFrameworkApplication.cga(Da);Ca.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",Da);Q.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.VGc=this.aVn,window.addEventListener("FGWebSurfaceEvent",this.VGc,!0),window.addEventListener("FRELaunchedEvent",
this.VGc,!0)):(Ca.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.xHj(this.kO.currentVersion))}else Ca.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}I2o(Q){if("RemindMeLater"in Q&&"FREDisplayedDate"in Q){if("true"===Q.RemindMeLater.toString()&&(+new Date-+new Date(Q.FREDisplayedDate.toString()))/36E5>this.kO.Kcj)return!0}else if(m.AFrameworkApplication.J.$("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in Q&&Q.VersionDisplayed<
this.kO.currentVersion)return Ca.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}Zwf(Q){m.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&bb.a.dispatch("FREDecisionEvent",{["show"]:Q})}}Object(f.a)(Ib,"FirstRunExperienceLauncher",null,[1272]);class ib{constructor(){this.W=null}get name(){return"Common.App.FirstRunExperienceLauncher"}uc(Q){this.W=Q;this.W.register(1272,
1249).ha().Sd(()=>new Ib)}init(){}dispose(){}static main(){C.a.instance.Lc(new ib)}}Object(f.a)(ib,"FirstRunExperienceLauncherPackage",null,[0,1]);class jb{constructor(){this.y=this.x=0}}Object(f.a)(jb,"HammerPoint",null,[]);class hb{constructor(Q,Da,eb,Tb,Ac){this.Pqh=this.E2a=this.TCd=1;this.AOd=this.vQc=this.i5a=0;this.t0e=this.YPa=null;this.aBb=this.sRe=this.sJd=!1;this.Vj=Q;this.BSa=Da;this.Akb=eb;this.ga=Tb;Ac&&(this.sJd=Ac.$("PromoteLayerPinchToZoomIsEnabled"),this.sRe=Ac.$("FinalizeWithInitialPinchScaleIsEnabled"),
this.aBb=Ac.$("AdjustPinchStartXWithPageMarginIsEnabled"))}get bM(){return this.BSa}get Xvg(){return this.Akb}Sgn(){return!!this.Vj.instance}xVn(Q){this.ga&&this.ga.Ob(x.a.aWj,2);const Da=this.Vj.instance;this.sJd&&Da.twj();this.E2a=Da.yj;this.TCd=Q.W0c.scale;this.Pqh=1;this.t0e=this.oYh();this.YPa=this.BSa.getBounds();if(!this.YPa)return Ca.ULS.sendTraceTag(42821145,353,15,"Unexpected null bounds"),!1;Q=this.ZCi(Q);this.aBb?this.lNj(this.BSa.scrollWidth,this.YPa.width,Q,this.E2a,Da):this.i5a=this.BSa.scrollWidth>
this.YPa.width?this.OTc(this.Akb.scrollLeft,Q.x,this.E2a):null;this.AOd=this.BSa.scrollHeight>this.YPa.height?this.OTc(this.Akb.scrollTop,Q.y,this.E2a):null;return!0}Ktg(){this.i5a=null;this.vQc=0}lNj(Q,Da,eb,Tb,Ac){Q>Da?this.i5a?(Q=Ac.Q2f,Q!==this.vQc&&(this.i5a-=this.vQc-Q,this.vQc=Q)):(this.i5a=this.OTc(this.Akb.scrollLeft,eb.x,Tb),this.vQc=Ac.Q2f):this.Ktg()}wVn(Q){const Da=this.ZCi(Q);if(!Da)return Ca.ULS.sendTraceTag(42821147,353,15,"Unexpected null pinch center"),!1;Q=this.yQo(Q.W0c.scale/
this.TCd)*this.E2a;this.xwp(Da,Q);this.ywp(Da,Q);return!0}xwp(Q,Da){const eb=this.BSa.scrollWidth,Tb=this.YPa.width;this.aBb?this.lNj(eb,Tb,Q,Da,this.Vj.instance):!this.i5a&&eb>Tb&&(this.i5a=this.OTc(this.Akb.scrollLeft,Q.x,Da));if(Q=this.xYh(Q.x,this.i5a,eb,Tb,Da))this.Akb.scrollLeft=Q}ywp(Q,Da){const eb=this.BSa.scrollHeight,Tb=this.YPa.height;!this.AOd&&eb>Tb&&(this.AOd=this.OTc(this.Akb.scrollTop,Q.y,Da));if(Q=this.xYh(Q.y,this.AOd,eb,Tb,Da))this.Akb.scrollTop=Q}xYh(Q,Da,eb,Tb,Ac){return eb<=
Tb||!Da||!Tb?null:Math.max(0,Math.min(Da*Ac-Q,eb-Tb))}OTc(Q,Da,eb){return(Q+Da)/eb}vVn(Q){Q=Q.W0c.scale;this.sRe&&(Q/=this.TCd);this.vmi(Q);this.sJd&&this.Vj.instance.Dog();this.ga&&this.ga.Ob(x.a.Azf,2);this.aBb&&this.Ktg()}uVn(Q){Q=Q.W0c.scale;this.sRe&&(Q/=this.TCd);this.vmi(Q,!0);this.sJd&&this.Vj.instance.Dog();this.ga&&this.ga.Ob(x.a.Azf,2);this.aBb&&this.Ktg()}yQo(Q){const Da=this.Vj.instance,eb=new Date>=this.t0e;eb&&(this.t0e=this.oYh());Math.abs(Q-this.Pqh)>=.01*Q&&Da.wXo(Q*this.E2a,eb);
return Da.yj/this.E2a}vmi(Q,Da=!1){Q*=this.E2a;this.Vj.instance.cAg(Q,!1);const eb={};eb.initialScale=this.E2a;eb.finalScale=Q;eb.cancelled=Da;Ca.ULS.sendTraceTag(42821150,353,50,"Pinch zoom ended: {0}",eb)}ZCi(Q){return(Q=Q.W0c.center)&&this.YPa?Object.assign(new jb,{x:Q.x-this.YPa.x,y:Q.y-this.YPa.y}):null}oYh(){const Q=(new Date).getTime();return new Date(Q+1E3)}}Object(f.a)(hb,"PinchZoomAdapter",null,[1339]);class pb{constructor(Q){this._element=Q}get scrollWidth(){return this._element.scrollWidth}get scrollHeight(){return this._element.scrollHeight}getBounds(){return Sys.UI.DomElement.getBounds(this._element)}}
Object(f.a)(pb,"ScrollContainerElement",null,[1337]);var ob=d(125);class sb{constructor(Q,Da,eb,Tb,Ac,hd){this.Z8e=this.hib=null;this.W=Q;this.Xd=Da;this.cEd=eb;this.Doh=Tb;this.Fzk=Ac;this.X6b=hd;this.Hxd=new kb.a}register(Q,Da){this.cEd&&(4===m.AFrameworkApplication.ua.Ib.Uk&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.OneNoteOnline.OneNoteDelayLoadHammerJs",!1)?ob.a.get_instance().Tk(8,()=>{this.XEj(Q,Da)}):this.XEj(Q,Da))}XEj(Q,Da){this.W.Ra(91).execute(eb=>{this.q$o();this.hib=
eb;this.Hxd.add(Q);if(this.Doh){if(this.Fzk&&0!==eb.vrm()){this.HWj();return}var Tb=this.W.Ra(6);this.W.resolve(71);const Ac=new pb(Q);Tb=new hb(Tb,Ac,Da,m.AFrameworkApplication.va,m.AFrameworkApplication.J);eb.Xqo(Q,Tb)}this.HWj()})}unregister(){if(this.hib&&this.Hxd){if(this.Doh){for(const Q of this.Hxd)this.hib.Bpp(Q);this.Hxd.clear()}this.hib=null}}q$o(){this.X6b&&(this.Xd?this.Z8e=this.Xd.Wf("Task","Register"):Ca.ULS.sendTraceTag(590387076,310,10,"_stopwatchBuilder is null"))}HWj(){this.X6b&&
(this.Z8e?this.Z8e.stop():Ca.ULS.sendTraceTag(590387077,310,10,"_stopwatchForRegister is null"))}}Object(f.a)(sb,"GestureInputRegistrar",null,[1273]);class Ab{constructor(){this.W=null;this.ui=!1}get name(){return"Common.App.GestureInput"}init(){this.ui||(this.W.resolve(127),this.ui=!0)}dispose(){}uc(Q){this.W=Q;Q.register(1273,127).ha().Sd(()=>new sb(Q,m.AFrameworkApplication.ua.Vr,m.AFrameworkApplication.l9c(),m.AFrameworkApplication.f_i(),!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("PinchZoomOnlyPointerEventsIsEnabled"),
!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("HammerJsPerformanceTimersIsEnabled")))}static main(){C.a.instance.Lc(new Ab)}}Object(f.a)(Ab,"GestureInputPackage",null,[0,1]);var nc=d(414),qc=d(94);class Jc{constructor(){this.Fwb=this.Zqi=null}}Object(f.a)(Jc,"GestureAdapterInfo",null,[]);var ad=d(593),Kc=d(293);class Jb{constructor(){this.xCb=null}r4f(){if(!this.xCb){var Q="hammer.min.js";m.AFrameworkApplication.J.Zx("IsServerFlavorDebug")&&(Q=m.AFrameworkApplication.J.$("IsServerFlavorDebug")?
"hammer.js":"hammer.min.js");Q=m.AFrameworkApplication.eC(String.format("{0}",Q),5);Q=Kc.a.create(Q,null,null);ad.a.l_(Q);this.xCb=Q.Vab}return this.xCb}static get instance(){Jb._instance||(Jb._instance=new Jb);return Jb._instance}}Jb._instance=null;Object(f.a)(Jb,"HammerJsDependencyLoader",null,[1369]);const Zb=(Q,Da,eb=null)=>{if(void 0===Da||null===Da)throw Ca.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let Tb=null;switch(Q){case U.a.ipe:Tb=
new Hammer.Pinch(eb);break;case U.a.pan:Tb=new Hammer.Pan(eb)}Tb&&(Tb.manager=Da);return Tb};var xb;(function(Q){Q[Q.none=-1]="none";Q[Q.ipe=0]="pinch";Q[Q.pan=1]="pan";Q[Q.KFg=2]="swipe"})(xb||(xb={}));Object(f.b)("GestureEvent",xb);var $b=d(73);class Xb extends $b.a{constructor(Q,Da,eb,Tb,Ac,hd,Ud,Ee){super(Q,eb,Tb,hd);this.QDc=Da;this.J4a=Ud;this.Fwa=Ee;this.uuk=Ac}get shiftKey(){return this.J4a}get ctrlKey(){return this.Fwa}get clientPoint(){return this.QDc}get W0c(){return this.uuk}static create(Q,
Da,eb,Tb,Ac,hd){if(eb.rawEvent)if(hd){var Ud=eb.rawEvent;Ud=new Sys.UI.Point(Ud.clientX,Ud.clientY)}else Ud=$b.a.t4d(eb);else Ud=new Sys.UI.Point(eb.clientX,eb.clientY);return new Xb(Q,Ud,Da,eb,Tb,Ac,eb.shiftKey,eb.ctrlKey,hd)}}Object(f.a)(Xb,"GestureEventArgs",$b.a,[]);class Lb{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=
this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(f.a)(Lb,"GestureManagerData",null,[]);class gc{}gc.Vgk=2;gc.Wgk=4;gc.Xgk=8;gc.Ygk=8;Object(f.a)(gc,"HammerConstants",null,[]);var qa=d(107),ra=d(126),Ya=d(17),ab=d(109);class cb extends ba.a{constructor(Q,Da){super();this.lRa=nc.a.kdm;this.p3e=!!window.PointerEvent;this.bHh=window.hasOwnProperty("ontouchstart");this.BDb=this.PLc=null;this.ZQa=
!1;this.Jpa=new qc.a;this.TMc=new qc.a;this.$hh=new kb.a;this.nhb=null;this.o4b=this.X6b=this.y$g=this.CLe=this.SZe=this.NAh=this.Q$g=this.CQc=!1;this.GKc=-1;this.curRecognizer=this.element=this.handlers=this.session=this.$8e=null;this.Fvb=(eb,Tb,Ac)=>{eb=this.Nyi(eb);Tb=this.Ytm(Ac);Hammer.inputHandler(this,eb,Tb);this.ZQa&&Ac.preventDefault();return this.ZQa};this.Gme=(eb,Tb,Ac)=>{var hd=Ac.rawEvent.pointerType.toString();const Ud=Ac.rawEvent.pointerId.toString();if("touch"!==hd)return!1;eb=this.Nyi(eb);
if(1!==eb&&!this.Jpa.lb(Ud))return!1;this.Q$g&&1===eb&&Ac.rawEvent.isPrimary&&this.Jpa.count&&(Ca.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.RTd());this.CQc?this.VVk(Ud,Tb,Ac):this.Jpa.Z(Ud,Ac);this.SZe&&2===eb&&(!this.CLe||this.CLe&&"function"===typeof Ac.rawEvent.getCoalescedEvents)&&(Tb=Ac.rawEvent.getCoalescedEvents())&&this.sLi()&&(this.GKc=Math.max(this.GKc,Tb.length));this.NAh&&(this.ZQa=!1);hd=this.Xtm(this.Jpa,Ac,hd);Hammer.inputHandler(this,eb,hd);if(4===eb||
8===eb)this.CQc?this.iBj(Ud):this.Jpa.remove(Ud),this.Jpa.count||(this.session=null,this.SZe&&-1!==this.GKc&&(Ca.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.GKc),this.GKc=-1));this.ZQa&&Ac.preventDefault();return this.ZQa};this.qme=()=>!1;this.Eg=qa.EventHandlerManager.instance;this.p3e?(Ca.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.PLc=this.Gme,this.BDb=U.a.mdm):this.bHh?(Ca.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.PLc=this.Fvb,
this.BDb=U.a.uzc):(Ca.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.PLc=this.qme,this.BDb=U.a.ldm);this.Xd=Da;this.n5=Q;m.AFrameworkApplication.J&&(this.CQc=m.AFrameworkApplication.J.$("UsePointerCaptureIsEnabled"),this.Q$g=m.AFrameworkApplication.J.$("ClearCacheOnPrimaryPointerIsEnabled"),this.NAh=m.AFrameworkApplication.J.$("ResetHandledBeforeInputHandlerIsEnabled"),this.SZe=m.AFrameworkApplication.J.$("LogCoalescedEventsIsEnabled"),this.CLe=m.AFrameworkApplication.J.$("CheckExistenceOfGetCoalescedEventsIsEnabled"),
this.y$g=m.AFrameworkApplication.J.$("CheckIfHammerExistsAfterDownloadIsEnabled"),this.X6b=m.AFrameworkApplication.J.$("HammerJsPerformanceTimersIsEnabled"),this.o4b=this.CQc&&m.AFrameworkApplication.J.$("CancelDragFromGestureInputManagerIsEnabled")&&m.AFrameworkApplication.J.$("UseGestureInputManagerPointerCacheIsEnabled"))}vrm(){return this.p3e?0:this.bHh?1:2}lw(Q){super.lw(Q);this.Eg.UKa(this.BDb,Q,0,this.PLc)}hw(Q){super.hw(Q);this.Eg.r7a(Q,this.BDb)}Xqo(Q,Da){m.AFrameworkApplication.l9c()?Jb.instance.r4f().continueWith(eb=>
{this.p$o();if(eb.fj||eb.kp)Ca.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",eb.status);else{Ca.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",eb.status);if(this.y$g){eb=window.Hammer;if("undefined"===typeof eb){Ca.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.aAe();return}if("undefined"===typeof eb.inputHandler){Ca.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");this.aAe();return}}if(!Q)throw this.aAe(),Error.argumentNull("source element can not be null");
eb=ra.a.Eb(Q,this.lRa);if(void 0===eb||null===eb)eb=new qc.a,ra.a.Dm(Q,this.lRa,eb),this.Yqo(Q);if(!eb.lb(xb[0])){var Tb=Object.assign(new Jc,{Fwb:Zb(xb[0],this,null),Zqi:Da});eb.add(xb[0],Tb)}}this.aAe()}):Ca.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}p$o(){this.X6b&&(this.Xd?this.$8e=this.Xd.Wf("Task","RegisterGestureAdapterAfterLoad"):Ca.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}aAe(){this.X6b&&(this.$8e?this.$8e.stop():
Ca.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}Bpp(Q){Ca.ULS.sendTraceTag(42256223,310,Q?100:10,"source element {0} ",Q.id);const Da=ra.a.Eb(Q,this.lRa);void 0!==Da&&null!==Da&&(Da.remove(xb[0]),Da.count||(ra.a.$X(Q,this.lRa),this.curRecognizer=null,this.Cpp(Q)))}Yqo(Q){this.$hh.add(Q);this.Eg.UKa(this.BDb,Q,0,this.PLc)}Cpp(Q){this.$hh.remove(Q);this.Eg.r7a(Q,this.BDb)}recognize(Q){var Da=Array(Q.pointers.length);for(var eb=0;eb<Q.pointers.length;eb++)Da[eb]=
Q.pointers[eb].target;eb=null;for(this.nhb=this.Hwm(Da);void 0!==this.nhb&&null!==this.nhb&&(eb=ra.a.Eb(this.nhb,this.lRa),void 0===eb||null===eb);this.nhb=this.nhb.parentNode);if(void 0!==eb&&null!==eb){this.curRecognizer&&this.curRecognizer.state===gc.Ygk&&(this.curRecognizer=null);Da=eb.keys;for(const Tb of Da){Da=eb.K(Tb);void 0!==Da&&null!==Da&&void 0!==Da.Fwb&&null!==Da.Fwb&&(void 0===this.curRecognizer||null===this.curRecognizer||Da.Fwb===this.curRecognizer||Da.Fwb.canRecognizeWith(this.curRecognizer))&&
Da.Fwb.recognize(Q);const Ac=Da.Fwb.state;this.curRecognizer||gc.Vgk!==Ac&&gc.Wgk!==Ac&&gc.Xgk!==Ac||(this.curRecognizer=Da.Fwb)}}}emit(Q,Da){if("hammer.input"!==Q){this.ZQa=!1;Da=Xb.create(Q,this.nhb,Da.srcEvent,Da,3,this.p3e);var eb=ra.a.Eb(this.nhb,this.lRa);if(this.Nln(Q))var Tb=0;else if(this.kln(Q))Tb=1;else if(this.qpn(Q))Tb=2;else{Ca.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}({value:eb}=eb.Ac(xb[Tb]));void 0!==eb&&null!==eb&&((eb=eb.Zqi,eb.Sgn())?
Q.endsWith("start")?this.ZQa=eb.xVn(Da):Q.endsWith("end")?(eb.vVn(Da),this.ZQa=!0):Q.endsWith("cancel")?(eb.uVn(Da),this.ZQa=!0):Q.endsWith("move")&&(this.ZQa=eb.wVn(Da)):Ca.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",Q))}}get(Q){return Object(Va.a)(Hammer.Recognizer,Q)}Hwm(Q){if(1>Q.length)return null;if(1===Q.length)return Q[0];var Da=Q[0],eb=!0;for(let Tb=1;Tb<Q.length;Tb++){if(!Q[Tb])return null;if(Da!==Q[Tb]){eb=!1;break}}if(eb)return Da;Da=this.Gri(Q[0]);eb=
0;for(const Tb of Q){Q=this.Gri(Tb);if(Da.K(Da.count-1)!==Q.K(Q.count-1))return null;for(let Ac=Da.count-2,hd=Q.count-2;Ac>=eb&&0<=hd;Ac--,hd--)if(Da.K(Ac)!==Q.K(hd)){eb=Ac+1;break}}return Da.K(eb)}Gri(Q){const Da=new kb.a;for(;void 0!==Q&&null!==Q;Q=Q.parentNode)Da.add(Q);return Da}Nyi(Q){switch(Q){case U.a.wS:case U.a.IKb:return 1;case U.a.vS:case U.a.Xkf:return 2;case U.a.jM:case U.a.JKb:return 4;case U.a.wCe:case U.a.Wkf:return 8}return 0}sLi(){return 1<this.Jpa.count}RTd(){Ca.ULS.sendTraceTag(594055960,
310,50,"CancelPendingPointerEvents");if(this.CQc)for(const Q of this.Jpa)this.iBj(Q.key);else this.Jpa=new qc.a;this.session=null}VVk(Q,Da,eb){Ca.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",Q);if(!this.TMc.lb(Q)){try{Da.setPointerCapture(Q)}catch(Tb){Ca.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",Tb)}this.TMc.add(Q,Da)}this.Jpa.Z(Q,eb);this.o4b&&1<this.Jpa.count&&this.n5&&!this.n5.aUc&&(this.n5.aUc=!0)}iBj(Q){Ca.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",
Q);if(this.TMc.lb(Q)){try{this.TMc.K(Q).releasePointerCapture(Q)}catch(Da){Ca.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",Da)}this.TMc.remove(Q)}else Ca.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",Q);this.Jpa.remove(Q);this.o4b&&1>=this.Jpa.count&&this.n5&&this.n5.aUc&&(this.n5.aUc=!1)}Ytm(Q){const Da=new Lb;var eb=Q.rawEvent;const Tb=eb.touches;eb=eb.changedTouches;Da.pointers=Array.clone(Tb);Da.pointers=Array.clone(0<Tb.length?Tb:eb);Da.changedPointers=
Array.clone(eb);Da.srcEvent=Q;Da.pointerType="touch";return Da}Xtm(Q,Da,eb){const Tb=new Lb;Tb.pointers=ab.toArray(Q.values);Tb.changedPointers=[Da];Tb.pointerType=eb;Tb.srcEvent=Da;return Tb}Nln(Q){return Ya.a.startsWith(Q,U.a.ipe)}kln(Q){return Ya.a.startsWith(Q,U.a.pan)}qpn(Q){return Ya.a.startsWith(Q,U.a.KFg)}}Object(f.a)(cb,"GestureInputManager",ba.a,[1350,1351]);var Eb=d(299);class mc{constructor(){this.W=null;this.ui=!1}get name(){return"Common.App.GestureInputManager"}uc(Q){Q.register(cb,
1194).as(91).ha().Sd(()=>new cb(Eb.a.instance,m.AFrameworkApplication.ua.Vr));this.W=Q}init(){this.ui||(this.W.resolve(1194),this.ui=!0)}dispose(){}static main(){C.a.instance.Lc(new mc)}}Object(f.a)(mc,"GestureInputManagerPackage",null,[0,1]);var tb=d(267),Xa=d(46),Mb=d(1471);class cc{constructor(Q,Da,eb){this.z7e=this.y7e=null;this.R$b=new v.a;this.$ed=Tb=>{let Ac=null;Ac&&Ac.length||!Tb||!Tb.data||(Ac=Tb.data.De);if(Ac&&Ac.length)try{const hd=Za.a(Ac);this.y7e=hd.NavBarDataJson;Ca.ULS.sendTraceTag(41551899,
215,50,"Skipping call to TryLoadResources for React Shared Header.");this.y7e?({ev:this.z7e}=Za.d(hd.NavBarDataJson)).returnValue?(this.FBn(this.z7e),this.R$b.hg(this.z7e)):(Ca.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:Mb.a.Erd(this.y7e)}),this.R$b.$ga()):(Ca.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.R$b.$ga())}catch(hd){Ca.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.R$b.$ga()}else Ca.ULS.sendTraceTag(6362369,
215,10,"Response from O365ShellServiceProxy is null.")};this.ned=()=>{this.R$b.$ga();Ca.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")};this.Gf=Q;this.HLc=eb;this.sqa=Da.appSettings[cc.PCp]||""}get aZo(){return this.R$b.task}get HT(){return this.Gf.value}UBo(){const Q={};Q[cc.uVm]=m.AFrameworkApplication.um;Q["Content-Type"]="application/json; charset=utf-8";Ca.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const Da=Xa.a.Ap(this.sqa+
cc.bZo,cc.AQn,m.AFrameworkApplication.ua.Ib.Uk.toString());this.HT.Wj(Da,1,"",Q,!0,2,this.$ed,this.ned,null,void 0,void 0,void 0,void 0,"20")}FBn(Q){try{const Da={};Da.FlightName=Q.FlightName;Da.SessionID=Q.SessionID;Ca.ULS.sendTraceTag(594883776,215,50,Za.c(Da))}catch(Da){Ca.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}static get instance(){return cc._instance||(cc._instance=cc.MOb())}static MOb(){return new cc(new tb.a(()=>m.AFrameworkApplication.Ee),m.AFrameworkApplication.J,
m.AFrameworkApplication.ua.Ib.Uk)}}cc.uVm="X-qs";cc.AQn="at";cc.bZo="O365ShellServiceProxy.ashx";cc._instance=null;cc.PCp="ShellWebServiceBase";Object(f.a)(cc,"O365ShellActor",null,[1315]);class oc{constructor(){this.W=null;this.fz=()=>{m.AFrameworkApplication.qMg&&m.AFrameworkApplication.ua.Ib.vN&&this.W.resolve(1195).UBo()}}get name(){return"Common.App.O365Shell"}uc(Q){this.W=Q;this.W.register(cc,1195).as(1069).ha().Sd(()=>new cc(new tb.a(()=>m.AFrameworkApplication.Ee),m.AFrameworkApplication.J,
m.AFrameworkApplication.ua.Ib.Uk))}init(){m.AFrameworkApplication.J.Uo(this.fz)}dispose(){}static main(){C.a.instance.Lc(new oc)}}Object(f.a)(oc,"PackageManager",null,[0,1]);class Pc{RXa(){}init(){}dispose(){}}Object(f.a)(Pc,"NoOpOfflineLogger",null,[1357,10]);var vb=d(785);class jd{}jd.ARd=0;Object(f.a)(jd,"OfflineLoggerConstants",null,[]);var ud=d(92),qe=d(254),Ae=d(305);class hf{constructor(Q,Da,eb,Tb,Ac,hd){this.N2a=!1;this.b$=null;this.OEc=this.k8b=this.jCb=0;this.JK=this.hjb=this.iT=null;this.fm=
!1;this.sgg=(Ud,Ee)=>{if(void 0!==Ee&&null!==Ee&&void 0!==Ee.args&&null!==Ee.args){Ud=!1;if(!this.hjb.lb(Ee.args.tag)){if(!this.hjb.lb(jd.ARd))return;Ud=!0}this.hjb.remove(Ud?jd.ARd:Ee.args.tag);this.JK.lb(Ee.uploadId)||this.JK.Z(Ee.uploadId,new kb.a);this.JK.K(Ee.uploadId).add(Ee.args)}};this.ugg=(Ud,Ee)=>{this.JK.remove(Ee.uploadId);this.cFb&&(this.cFb=!1,this.j1h())};this.tgg=(Ud,Ee)=>{this.cFb=!0;if(void 0!==Ee&&null!==Ee&&this.JK.lb(Ee.uploadId)){Ud=!0;var Me=this.JK.K(Ee.uploadId);for(const Kf of Me)Me=
hf.serialize(Kf,this.bHa),this.Prd(this.CTc(this.OEc++),Me)||(Ud=!1);Ud&&this.JK.remove(Ee.uploadId)}};this.ucg=()=>{this.dispose()};this.AGa=eb;this.nHa=Tb;this.bHa=Ac;this.Gf=Da;this.Gb=Q;this.M1a=hd;this.cFb=!1;this.f_e="OfflineLoggerManifest|"+this.M1a;this.SBk="OfflineLog|"+this.M1a+"|"}init(){this.oAg();this.Ixn();this.N2a=!1;this.Gf.y5a(this);this.iT=new ud.a(3,2,2500,Object(R.a)(this,this.Lve,"sendOfflineLogs"),104);this.Gb.Zb(this.iT)}CTc(Q){return this.SBk+Q}Ixn(){const Q=this.AGa.getItem(this.f_e);
void 0!==Q&&null!==Q&&0<Q.length&&(this.b$=hf.Ord(Q));this.b$||(this.b$={});if(void 0===this.b$.end||null===this.b$.end)this.b$.end=0;if(void 0===this.b$.offset||null===this.b$.offset)this.b$.offset=0;this.jCb=this.b$.offset;isFinite(this.jCb)||(this.jCb=0);this.k8b=this.b$.end;isFinite(this.k8b)||(this.k8b=0);this.OEc=this.k8b}oAg(){this.hjb=new Ae.a;this.JK=new qe.a;this.nHa.lOh(this.sgg);this.nHa.POh(this.ugg);this.nHa.OOh(this.tgg);this.nHa.cOh(this.ucg)}Prd(Q,Da){try{return this.AGa.setItem(Q,
Da),!0}catch(eb){return!1}}Lve(){if(!this.N2a){for(var Q=this.jCb,Da=new kb.a,eb=null;Q<this.k8b&&5>=Da.count;++Q){var Tb=this.CTc(Q);const Ac=this.AGa.getItem(Tb);this.AGa.removeItem(Tb);if(void 0===Ac||null===Ac)continue;const hd=({sessionId:Tb}=hf.deserialize(Ac)).returnValue;if(hd){if(!eb)eb=Tb;else if(Tb!==eb)break;Da.add(hd)}else Ca.ULS.sendTraceTag(18614233,222,15,"Unable to deserialze the offline log: {0}",Ac)}0<Da.count&&this.nHa.yEj(this,ab.toArray(Da),eb);this.jCb=Q;Q>=this.k8b&&this.MNb()}}j1h(){this.MNb();
this.iT=new ud.a(3,2,2500,Object(R.a)(this,this.Lve,"sendOfflineLogs"),104);this.Gb.Zb(this.iT)}RXa(Q,Da,eb){!this.fm&&Ca.ULS.i4(Da,eb)&&this.hjb.Z(Q,!0)}dispose(){if(!this.fm){this.iT&&this.Gb.uf(this.iT);var Q=ab.toArray(this.JK.keys);Q.sort();for(const Da of Q){Q=this.JK.K(Da);for(const eb of Q)Q=hf.serialize(eb,this.bHa),this.Prd(this.CTc(this.OEc++),Q)}this.jCb<this.OEc?(this.b$.end=this.OEc,this.b$.offset=this.jCb,this.Prd(this.f_e,JSON.stringify(this.b$))):this.AGa.removeItem(this.f_e)}this.fm=
!0}yCa(){this.N2a=!0}mYa(){this.N2a=!1;this.j1h()}MNb(){this.iT&&(this.Gb.uf(this.iT),this.iT=null)}static serialize(Q,Da){const eb={};eb.t=Q.tag;eb.c=Q.category;eb.l=Q.level;eb.m=Q.message;eb.lt=Q.logType;eb.s=Da;eb.ts=Q.timestamp;eb.o=Q.isMinified;eb.a=Q.args;return JSON.stringify(eb)}static deserialize(Q){return(Q=hf.Ord(Q))?{returnValue:new vb.a(Q.ts,Q.c,Q.t,Q.l,Q.m,Q.lt,Q.o,Q.a),sessionId:Q.s}:{returnValue:null,sessionId:null}}static Ord(Q){try{return JSON.parse(Q)}catch(Da){Ca.ULS.sendTraceTag(18614234,
222,10,"OfflineLogger TryParseString failed with exception: {0}",Da.message)}return null}}Object(f.a)(hf,"OfflineLoggerImpl",null,[1357,10,325]);class Qe{constructor(Q,Da,eb,Tb){this.sessionId=Q;this.version=Da;this.pSd=eb;this.ehg=Tb;this.IUb=new kb.a}}Object(f.a)(Qe,"CachedLogUpload",null,[]);class vf{constructor(Q){Q.name&&(this.n=Q.name);Q.stack&&(this.s=Q.stack);Q.message&&(this.m=Q.message);Q.file&&(this.f=Q.file);null!=Q.line&&(this.l=Q.line);null!=Q.column&&(this.c=Q.column)}}Object(f.a)(vf,
"LoggingExceptionArgsLocalStorage",null,[]);class Jd{constructor(Q){this.t=Q.tag;this.c=Q.category;this.l=Q.level;this.m=Q.message;this.lt=Q.logType;this.ts=Q.timestamp;this.o=Q.isMinified;this.a=Q.args;Q.exceptionArgs&&(this.e=new vf(Q.exceptionArgs))}}Object(f.a)(Jd,"LoggingArgsLocalStorage",null,[]);var mh=d(488);class gh{constructor(Q,Da,eb,Tb,Ac,hd,Ud){this.t=Q;this.m=Da;this.s=eb;this.v=Tb;this.i=Ac;this.a=hd;this.d=Ud;this.op="Log"}}Object(f.a)(gh,"LoggingKeyLocalStorage",null,[]);var Td=d(124);
const Vc=(Q,Da,eb,Tb)=>!(void 0===Q||null===Q)&&!(void 0===Q.i||null===Q.i)&&!(void 0===Q.t||null===Q.t)&&!(void 0===Q.s||null===Q.s)&&"Log"===Q.op&&Q.t===Da&&isFinite(Q.t)&&Td.a.isValid(Q.s)&&(void 0===Q.m||null===Q.m||Q.m===eb)&&(void 0===Q.d||null===Q.d||Q.d===Tb);class id{constructor(Q,Da,eb,Tb,Ac,hd,Ud,Ee,Me,Kf,th,Fj){this.N2a=this.ysh=this.nsh=this.osh=!1;this.JK=this.hjb=this.b$=this.iT=null;this.fm=!1;this.oQl=()=>{this.Sdi(!0)};this.pQl=()=>{this.Sdi(!1)};this.M7o=uh=>uh.s!==uh.s?uh.s.localeCompare(uh.s):
uh.i-uh.i;this.J7o=uh=>uh.s!==uh.s?uh.s.localeCompare(uh.s):uh.i-uh.i;this.sgg=(uh,hi)=>{if(void 0!==hi&&null!==hi&&void 0!==hi.args&&null!==hi.args){if(this.$ad.lb(hi.args.tag))this.$ad.remove(hi.args.tag);else if(this.$ad.lb(jd.ARd))this.$ad.remove(jd.ARd);else if(!(this.HBk&&50>hi.args.level))return;({value:uh}=this.NLa.Ac(hi.uploadId)).returnValue||(uh=new Qe(hi.sessionId,hi.version,hi.pSd,hi.ehg),this.NLa.Z(hi.uploadId,uh));this.NLa.K(hi.uploadId).IUb.add(hi.args)}};this.ugg=(uh,hi)=>{this.NLa.remove(hi.uploadId);
this.cFb&&(this.cFb=!1,this.k1h())};this.tgg=(uh,hi)=>{this.cFb=!0;void 0!==hi&&null!==hi&&this.NLa.lb(hi.uploadId)&&this.jdj(hi.uploadId)&&!this.ysh&&(this.ysh=!0)};this.ucg=()=>{this.dispose()};this.MEb=[];this.d8b=[];this.AGa=eb;this.nHa=Tb;this.bHa=Ac;this.Gf=Da;this.Gb=Q;this.HLc=hd;this.Q0e=Ud;this.ZAh=Ee;this.i3a=Me;this.HBk=Kf;this.xXe=th;this.M1a=Fj;this.cFb=!1}get manifest(){return this.b$}get $ad(){return this.hjb}get NLa(){return this.JK}init(){this.oAg();this.N2a=!1;this.Gf.y5a(this);
this.iT=new ud.a(3,1,2500,this.oQl,103);this.Gb.Zb(this.iT)}Sdi(Q){this.MNb();this.MEb=[];Q&&(this.d8b=[]);for(var Da=0;Da<this.AGa.length;Da++){const eb=this.AGa.key(Da),Tb=id.B2j(eb,!1);Vc(Tb,this.HLc,this.Q0e,this.M1a)&&(Tb.s===this.bHa?Array.add(this.MEb,eb):Q&&Array.add(this.d8b,eb))}if(this.MEb.length||Q&&this.d8b.length)if(Da=this.xXe?this.J7o:this.M7o,this.MEb.sort(Da),Q&&this.d8b.sort(Da),0<this.MEb.length||0<this.d8b.length)this.iT=new ud.a(3,2,2500,Object(R.a)(this,this.Lve,"sendOfflineLogs"),
105),this.Gb.Zb(this.iT)}CTc(Q,Da,eb,Tb){Q=new gh(this.HLc,this.Q0e,Da,eb,Q,Tb,this.M1a);return JSON.stringify(Q)}oAg(){this.hjb=new Ae.a;this.JK=new qe.a;this.nHa.lOh(this.sgg);this.nHa.POh(this.ugg);this.nHa.OOh(this.tgg);this.nHa.cOh(this.ucg)}jdj(Q){let Da=!1;if(({value:Tb}=this.NLa.Ac(Q)).returnValue&&Tb&&0<Tb.IUb.count){if(Tb.pSd>=this.i3a)return this.NLa.remove(Q),!1;var eb=Tb.IUb;const Ac=Array(eb.count);for(let hd=0,Ud=eb.count;hd<Ud;++hd)Ac[hd]=new Jd(eb.K(hd));eb=id.serialize(Ac);var Tb=
this.CTc(Tb.ehg,Tb.sessionId,Tb.version,Tb.pSd);this.Prd(Tb,eb)&&(this.NLa.remove(Q),Da=!0)}return Da}Prd(Q,Da){try{return this.AGa.setItem(Q,Da),!0}catch(eb){return!1}}Lve(){if(!this.N2a){var Q=0<this.MEb.length?this.MEb:this.d8b,Da=Q.length;if(Da)for(;0<Da;){Da--;var eb=this.xXe?Q.pop():Q[0];this.xXe||Array.removeAt(Q,0);const hd=id.B2j(eb,!0);if(Vc(hd,this.HLc,this.Q0e,this.M1a)){var Tb=this.AGa.getItem(eb);this.AGa.removeItem(eb);if(void 0!==Tb&&null!==Tb)if(hd.a>this.i3a)Ca.ULS.sendTraceTag(37290075,
222,50,"Log has more attempt {0} than the max allowed {1}.",hd.a,this.i3a);else if(eb=id.Ord(Tb,!0),void 0!==eb&&null!==eb&&isFinite(eb.length))if(eb.length){Tb=eb[eb.length-1];var Ac=(new Date).getTime()-Tb.ts;if(Ac<-id.h_j)Ca.ULS.sendTraceTag(37290078,222,50,"Log came from more than a day in the future.  Let's throw it away and not trust it. {0}",Tb.ts);else if(Ac>this.ZAh*id.h_j)Ca.ULS.sendTraceTag(37290079,222,50,"Log is older than our retention period of {0} days.  Throwing it away. {1}",this.ZAh,
Tb.ts);else{hd.s===this.bHa?this.osh||(this.osh=!0,Ca.ULS.sendTraceTag(37290080,222,50,"Attempted to re-send logs from this session.")):this.nsh||(this.nsh=!0,Ca.ULS.sendTraceTag(37290081,222,50,"Attempted to re-send logs from another session {0}.",hd.s));Da=Array(eb.length);for(Tb=0;Tb<eb.length;Tb++){Q=Tb;a:{Ac=eb[Tb];if(void 0===Ac||null===Ac){Ac=null;break a}let Ud=null;Ac.e&&(Ud=new mh.a(null),Ud.name=Ac.e.n,Ud.stack=Ac.e.s,Ud.message=Ac.e.m,Ud.file=Ac.e.f,Ud.line=Ac.e.l,Ud.column=Ac.e.c);Ac=
new vb.a(Ac.ts,Ac.c,Ac.t,Ac.l,Ac.m,Ac.lt,Ac.o,Ac.a,Ud)}Da[Q]=Ac}this.nHa.yEj(this,Da,hd.s,hd.v,hd.a+1,hd.i);break}}else Ca.ULS.sendTraceTag(37290077,222,15,"Deserialize an empty array from local storage: {0}",Tb);else Ca.ULS.sendTraceTag(37290076,222,15,"Unable to deserialize the offline log: {0}",Tb)}}else this.MNb()}}k1h(){this.MNb();this.iT=new ud.a(3,1,2500,this.pQl,102);this.Gb.Zb(this.iT)}RXa(Q,Da,eb){!this.fm&&Ca.ULS.i4(Da,eb)&&this.$ad.Z(Q,!0)}dispose(){if(!this.fm){this.iT&&this.Gb.uf(this.iT);
var Q=ab.toArray(this.NLa.keys);for(const Da of Q)this.jdj(Da)}this.fm=!0}yCa(){this.N2a=!0;this.MNb()}mYa(){this.N2a=!1;this.k1h()}MNb(){this.iT&&(this.Gb.uf(this.iT),this.iT=null)}static serialize(Q){return JSON.stringify(Q)}static B2j(Q,Da){(Q=id.Ord(Q,Da))&&void 0===Q.d&&(Q=new gh(Q.t,Q.m,Q.s,Q.v,Q.i,Q.a,0));return Q}static Ord(Q,Da){try{return JSON.parse(Q)}catch(eb){Da&&Ca.ULS.sendTraceTag(37290082,222,10,"OfflineLogger TryParseString failed with exception: {0}",eb.message)}return null}}id.h_j=
864E5;Object(f.a)(id,"OfflineLoggerImplV2",null,[1357,10,325]);class Re{constructor(){localStorage.getItem("{CBEDE940-2407-4B58-BA27-B8CBF0B0DDE6}{5}")}get length(){try{return localStorage.length}catch(Q){return this.handleError("Length",Q),-1}}key(Q){try{return localStorage.key(Q)}catch(Da){return this.handleError("Key",Da),null}}getItem(Q){try{return localStorage.getItem(Q)}catch(Da){return this.handleError("GetItem",Da),null}}setItem(Q,Da){try{return localStorage.setItem(Q,Da)}catch(eb){return this.handleError("SetItem",
eb),null}}removeItem(Q){try{localStorage.removeItem(Q)}catch(Da){this.handleError("RemoveItem",Da)}}clear(){try{localStorage.clear()}catch(Q){this.handleError("Clear",Q)}}handleError(){}}Object(f.a)(Re,"OfflineStorage",null,[1355]);class cf{create(Q){var Da=null;try{void 0!==localStorage&&null!==localStorage&&(Da=new Re)}catch(Tb){Ca.ULS.sendTraceTag(18641093,222,50,"window.localStorage is not accessable: {0}",Tb.message)}Object.getType(Ca.ULS.host).implementsInterface(1336)&&Da||(Ca.ULS.sendTraceTag(18614230,
222,50,"OfflineLogger is not supported: offline storage is {0}, ULS host hook is {1}",Da?"supported":"not supported",Object.getType(Ca.ULS.host).implementsInterface(1336)?"supported":"not supported"),Q=0);const eb=m.AFrameworkApplication.J;1===Q?Da=new hf(m.AFrameworkApplication.oc,m.AFrameworkApplication.Ee,Da,Ca.ULS.host,m.AFrameworkApplication.userSessionId,m.AFrameworkApplication.cbi):2===Q?(Q=m.AFrameworkApplication.ua.Ib,Da=new id(m.AFrameworkApplication.oc,m.AFrameworkApplication.Ee,Da,Ca.ULS.host,
m.AFrameworkApplication.userSessionId,Q.Uk,Q.rma,eb.ic("OfflineLoggerRetentionInDays",30),eb.ic("OfflineLoggerMaxAttempts",5),eb.$("OfflineLoggerListenForAllMonitorableLogsIsEnabled"),eb.$("SendOfflineLogsV2ImprovementIsEnabled"),m.AFrameworkApplication.cbi)):Da=new Pc;Da.init();return Da}}Object(f.a)(cf,"OfflineLoggerFactory",null,[]);class me{uc(){}get name(){return"Common.App.OfflineLogger"}init(){const Q=m.AFrameworkApplication.J;let Da=0;Q.$("OneNoteOfflineLoggerIsEnabled")?Da=1:Q.$("OfflineLoggerV2IsEnabled")&&
(Da=2);0!==Da&&(m.AFrameworkApplication.CBe=(new cf).create(Da))}dispose(){}}Object(f.a)(me,"OfflineLoggerPackage",null,[0,1]);var ce=d(43),Ie=d(1238);class Le{constructor(Q){this.$$i=null;this.hJm=()=>{Ca.ULS.sendTraceTag(527214156,306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")};this.jJm=Da=>{Ca.ULS.sendTraceTag(527214157,352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");Da=Za.a(Da.data.De).state+"";Ie.a.instance.setItem("AccountLinkedStatusCache",Da)};
Ca.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");this.Pbd=m.AFrameworkApplication.J.ib("PhoneLinkServiceEndpoint");(this.wba=Q)||Ca.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.Pbd&&this.Pbd.length||Ca.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}h4l(Q){Q&&(this.Pbd="https://dcg-df.microsoft.com/",Ca.ULS.sendTraceTag(526697302,306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.g4l()}g4l(){Ca.ULS.sendTraceTag(527214155,
306,50,"PhoneLinkManager::FetchPhoneLinkData...");if(864E5>=+new Date-+this.$$i)Ca.ULS.sendTraceTag(527574722,306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.$$i=new Date;var Q=new Date;this.wba.pV("BayBridge",this.Pbd).then(Da=>{const eb=+new Date-+Q;Da.IsSuccess?(Ca.ULS.sendTraceTag(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",eb),this.W3l(Da.Token,this.zfm())):Ca.ULS.sendTraceTag(527574724,306,
15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",eb,Da.ErrorCode,Da.ErrorMessage)}).catch(Da=>{Ca.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",Da,+new Date-+Q)})}}W3l(Q,Da){const eb={};eb.Authorization="Bearer "+Q;eb["Authorization-Type"]="AAD";eb.Accept="application/json";eb["DCG-SessionId"]=m.AFrameworkApplication.userSessionId;m.AFrameworkApplication.Ee.Wj(Da,
1,null,eb,!1,2,this.jJm,this.hJm,null,void 0,void 0,void 0,void 0,"39");ce.a("FetchAccountLinkedStatus")}Lhm(){const Q=Ie.a.instance.getItem("AccountLinkedStatusCache");return Q&&Q.length?"true"===Q.toLowerCase()?!0:!1:!1}zfm(){return this.Pbd+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}}Object(f.a)(Le,"PhoneLinkManager",null,[1270]);class we{constructor(){this.W=null}get name(){return"Common.App.PhoneLink"}uc(Q){this.W=Q;this.W.register(1270,1028).ha().Sd(()=>new Le(this.W.resolve(722)))}init(){m.AFrameworkApplication.J.Uo(()=>
{this.j$a()})}j$a(){this.W.resolve(1028)}dispose(){}static main(){C.a.instance.Lc(new we)}}Object(f.a)(we,"PhoneLinkPackage",null,[0,1]);const xf=Q=>{try{return Za.a(Q)}catch(Da){}return null};class Ig{constructor(Q,Da,eb,Tb,Ac,hd){this.s1=!1;this.Yk=null;this.$2e=!1;this.Zif=Ud=>{const Ee=Ud.yPb();Ee.continueWith(()=>{this.Yk=Ee.result;this.$2e&&(this.Yk.fC(2,null,!0),this.$2e=!1);this.Yk.BO((Me,Kf)=>{2===Kf.type&&this.Rb.Ob(x.a.gOb,2)});this.Yk.NZ((Me,Kf)=>{2===Kf.newState&&this.Rb.Ob(x.a.gOb,2)});
2===this.Yk.connectionState&&this.Rb.Ob(x.a.gOb,2)})};this.Yrc=Ud=>{this.s1=!1;const Ee=xf(Ud.data.De);Ud.data.state.sE(Ee,this.zrh.value)};this.nZn=Ud=>{5!==Ud.data.status||this.s1?this.Clj(Ud):(this.s1=!0,this.zki(Ud.data.state,!1))};this.Clj=Ud=>{Ud.data.state.onFailure(-1)};this.Ved=Ud=>{this.s1=!1;const Ee=xf(Ud.data.De);Ud.data.state.sE(Ee,this.zrh.value);this.hgj()};this.rZn=Ud=>{5!==Ud.data.status||this.s1?this.Elj(Ud):(this.s1=!0,this.Bki(Ud.data.state,!1))};this.Elj=Ud=>{Ud.data.state.onFailure(-1)};
this.ga=Q;this.Gf=Da;this.em=eb;this.zrh=Tb;this.Ga=Ac;this.lBk=hd}init(Q,Da){Da&&Q.Ra(140).execute(this.Zif)}WUa(Q){this.zki(Q,!0)}zki(Q,Da){const eb=this.Mel(Q.hUj),Tb={};Tb[Ig.T5h]=Ig.U5h;this.lEj.Wj(eb,2,"",Tb,!1,2,this.Yrc,Da?this.nZn:this.Clj,Q)}UNb(Q){this.Bki(Q,!0)}Bki(Q,Da){const eb=this.Nel(),Tb={};Tb[Ig.T5h]=Ig.U5h;Tb[Ig.sVm]=Ya.a.Yi(Q.sEj);Tb[Ig.qVm]=this.lBk.value.Nrl;this.lEj.Wj(eb,2,"",Tb,!1,2,this.Ved,Da?this.rZn:this.Elj,Q)}Nel(){return this.IWh()}Mel(Q){let Da=this.IWh();return Da=
Xa.a.Ap(Da,Ig.wVm,Q?"2":"1")}IWh(){let Q=(this.Ga.value.appSettings.RenameWebServiceBase||"")+Ig.rVm;Q=Xa.a.Ap(Q,Ig.tVm,Ya.a.Yi(m.AFrameworkApplication.um));this.Dn&&this.Dn.OXf&&(Q=Xa.a.Ap(Q,Ig.vVm,"1"));return Q}hgj(){this.Yk?this.Yk.fC(2,null,!0):this.$2e=!0}get Rb(){return this.ga.value}get lEj(){return this.Gf.value}get Dn(){return this.em.value}static get instance(){return Ig._instance||(Ig._instance=Ig.MOb())}static MOb(){return new Ig(new tb.a(()=>m.AFrameworkApplication.va),new tb.a(()=>
m.AFrameworkApplication.Ee),new tb.a(()=>m.AFrameworkApplication.Dn),new tb.a(()=>La.a.instance.resolve(7)),new tb.a(()=>m.AFrameworkApplication.J),new tb.a(()=>La.a.instance.resolve(1068)))}}Ig.T5h="Content-Type";Ig.U5h="application/json; charset=utf-8";Ig.rVm="renamehandler.ashx";Ig.tVm="qs";Ig.sVm="n";Ig.vVm="sl";Ig.qVm="X-CoauthLockId";Ig.wVm="u";Ig._instance=null;Object(f.a)(Ig,"ExecuteRenameFileHandler",null,[]);class jg{constructor(){this.onFailure=this.sE=null;this.hUj=!1}}Object(f.a)(jg,
"ExecuteRefreshFilenameData",null,[]);class kg{constructor(){this.onFailure=this.sE=this.sEj=null}}Object(f.a)(kg,"ExecuteRenameFileData",null,[]);class eh{constructor(){this.W=null;this.QQe=Ig.instance;this.fz=()=>{m.AFrameworkApplication.T9c()&&(Ig.instance.init(this.W,m.AFrameworkApplication.dkd),m.AFrameworkApplication.UNb=Object(R.a)(this,this.UNb,"executeRenameFile"),m.AFrameworkApplication.WUa=Object(R.a)(this,this.WUa,"executeRefreshFilename"),m.AFrameworkApplication.rmd=Object(R.a)(this,
this.rmd,"sendFileNameAndLocationUpdateNotification"))}}get name(){return"Common.App.RenameFile.RenameExecutor"}uc(Q){this.W=Q}init(){m.AFrameworkApplication.J.Uo(this.fz)}UNb(Q,Da,eb){const Tb=new kg;Tb.sEj=Q;Tb.sE=Da;Tb.onFailure=eb;this.QQe.UNb(Tb)}WUa(Q,Da,eb){const Tb=new jg;Tb.sE=Q;Tb.onFailure=Da;Tb.hUj=eb;this.QQe.WUa(Tb)}rmd(){this.QQe.hgj()}dispose(){}}Object(f.a)(eh,"PackageManager",null,[0,1]);var zg=d(173);class Gi{constructor(Q,Da,eb){this.xCg=this.yCg=this.zCg=!1;this.OCg=!Q&&!Da;this.PCg=
!Q&&!eb;this.OCg||this.PCg||(this.zCg=!Q,this.yCg=!Da,this.xCg=!eb)}}Object(f.a)(Gi,"RenameDisabledDialogInfo",null,[]);class jj extends zg.StandardDialog{constructor(Q,Da,eb,Tb,Ac){super();this.eHg=[];this.Bia=new Gi(Q,Da,eb);this.slb=Tb;this.Uib=Ac;this.Ng="RenameDisabledDialog";this.Fd=0;this.Qe(1,CommonUIStrings.l_DialogClose);this.uWo();this.vzo()}uWo(){this.Bia.OCg?this.Rod(this.slb?this.Uib?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.Bia.PCg?this.Rod(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.sVk();this.aQd(this.eHg)}Rod(Q){Array.add(this.eHg,Q)}sVk(){const Q=[];this.Bia.zCg||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.Bia.yCg||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.Bia.xCg||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<Q.length&&Array.add(this.eHg,Q)}}Object(f.a)(jj,"ReactRenameDisabledDialogBase",
zg.StandardDialog,[]);class Dg extends jj{constructor(Q,Da,eb,Tb,Ac){super(Q,Da,eb,Tb,Ac)}vzo(){this.zub(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(f.a)(Dg,"ReactRenameDisabledDialog",jj,[]);class Jf{static get kh(){return a.a.Ry(Jf.Hn,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}Jf.Hn="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(f.a)(Jf,"RenameDisabledDialogHtml",null,[]);class xg extends a.a{constructor(Q,Da,eb,Tb,Ac){super();this.Bia=new Gi(Q,Da,eb);this.slb=Tb;this.Uib=Ac;this.Ng="RenameDisabledDialog";this.Fd=0;this.Qe(1,CommonUIStrings.l_DialogClose);this.kh=Jf.kh;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.t8("RenameRow")}Cba(){if(this.Bia.OCg){let Q;Q=this.slb?this.Uib?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;xg.Rod(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),Q)}else this.Bia.PCg?xg.Rod(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.SYm()}SYm(){this.Bia.zCg&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.Bia.yCg&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.Bia.xCg&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static Rod(Q,Da,eb){Q.style.display="none";Da.innerText=eb}}Object(f.a)(xg,"RenameDisabledDialog",a.a,[]);class Vi{constructor(Q,Da){this.zFb=0;this.vpf=(eb,Tb,Ac,hd,Ud)=>{if(1===Ac)return this.ga.Ob(x.a.Sua,1);eb=Ya.a.rL(this.sQa.yA);Ud=(0,Ud.getNewDocumentTitle)();Ud.length>this.zFb&&(Ud=Ud.substr(0,this.zFb));if(32!==this.ga.Pb(x.a.Sua,2,Ud))return this.oAc(eb),8;this.oAc(Ud);return 32};this.ga=
Q;this.sQa=Da}initialize(Q){if(!this.ga||!this.sQa)return!1;this.zFb=Q;this.Xb();return!0}Xb(){this.ga.qa(x.a.vpf,z.a.frame,this.vpf)}oAc(Q){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(Q))}static Pm(){return new Vi(m.AFrameworkApplication.va,m.AFrameworkApplication.Ft)}}Object(f.a)(Vi,"ReactRenameUIHandler",null,[1356]);var Lf=d(1007),ac=d(1555),xc=d(703),gd=d(138),Hd=d(260),ie=d(71);class Je{constructor(Q,Da,eb,Tb,Ac,hd,Ud,Ee,Me,Kf,th,Fj){this._initialized=!1;this._element=null;
this.zFb=0;this.Y6e=this.nUe=!1;this.ga=Q;this.uoa=Da;this.oe=eb;this.mx=Tb;this.sQa=Ac;this.ZBh=hd;this.jLd=Ud;this.WLe=Ee;this.qib=Me;this.toh=Kf;this.Vi=th;this.XVe=Fj}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(Q,Da,eb){if(!(this.ga&&this.sQa&&this.ZBh&&this.jLd&&this.WLe&&Da)||0>=Q)return!1;this._element=Da;this._element.title=eb;this._element.setAttribute(ie.a.Ph,ie.a.K$);this._element.setAttribute("Unselectable","on");this.zFb=Q;this.zE();return this._initialized=
!0}zE(){this.uoa&&(this.uoa.nb(U.a.blur,this._element,Object(R.a)(this,this.onBlur,"onBlur")),this.uoa.nb(U.a.paste,this._element,Object(R.a)(this,this.Ked,"onPaste")));this.oe.nb(U.a.hj,this._element,Object(R.a)(this,this.onKeyDown,"onKeyDown"));this.mx.nb(U.a.gt,this._element,Object(R.a)(this,this.rE,"onPointerDown"));this.mx.nb(U.a.BP,this._element,Object(R.a)(this,this.OCa,"onPointerUp"))}onBlur(){this.isActive&&!this.nUe&&(this.toh||this.WLe(this._element),this.S3h(),this.Ouf(!1));return this.nUe=
!1}Ked(){Ca.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(Q){return this.isActive?this.CWn(Q):this.DWn(Q)}CWn(Q){let Da=!1;switch(Q.Nb.keyCode){case Sys.UI.Key.enter:this.S3h();this.Ouf(this.Vi||this.XVe);Da=!0;break;case Sys.UI.Key.tab:this.toh&&this.WLe(this._element);break;case Sys.UI.Key.esc:this.dug(),this.Ouf(this.Vi||this.XVe),Da=!0}return Da}DWn(Q){let Da=!1;switch(Q.Nb.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.I1j(this.XVe),
this.isActive&&this.jLd(this._element),Da=!0}return Da}rE(){this.isActive||(this.I1j(!1),this.isActive&&(this._element.focus(),this.jLd(this._element),this.Y6e=!0));return!1}OCa(){return this.Y6e?(this.jLd(this._element),this.Y6e=!1,!0):!1}moc(){return 32===this.ga.Ob(x.a.Sua,1)}S3h(){const Q=Ya.a.rL(this.sQa.yA);let Da=this._element.innerText.trim();Da.length>this.zFb&&(Da=Da.substr(0,this.zFb));Da!==Q&&""!==Da?32!==this.ga.Pb(x.a.Sua,2,Da)?this.dug():this.oAc(Da):this.dug()}dug(){this.oAc(Ya.a.rL(this.sQa.yA))}oAc(Q){this._initialized&&
(this._element.innerText=Q,this.ZBh())}I1j(Q){this.moc()?this.isActive||(Q&&(this.nUe=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(ie.a.Ph,ie.a.hTh),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,Lf.a.fhi),this.qib&&this.qib.execute(Da=>{Da.vwj(!0)}),Q&&this._element.focus(),Ca.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.ga.Ob(x.a.rxc,2)}Ouf(Q){this._element.removeAttribute("contentEditable");
this._element.setAttribute("Unselectable","on");this._element.setAttribute(ie.a.Ph,ie.a.K$);Sys.UI.DomElement.removeCssClass(this._element,Lf.a.fhi);this.qib&&this.qib.execute(Da=>{Da.vwj(!1)});Q&&(this._element.blur(),this._element.focus())}static GDa(){ac.a.GDa(m.AFrameworkApplication.isRtl)}static Pm(){return new Je(m.AFrameworkApplication.va,xc.a.instance,gd.KeyInputManager.instance,Hd.a.instance,m.AFrameworkApplication.Ft,Je.GDa,ka.a.iKo,ka.a.J1h,La.a.instance.Ra(692),zb.a.x7,zb.a.Ci,zb.a.uj)}}
Object(f.a)(Je,"RenameUIHandler",null,[1356]);class Xe{static get instance(){return m.AFrameworkApplication.ua.Ib.vN?Xe._instance||(Xe._instance=Vi.Pm()):Xe._instance||(Xe._instance=Je.Pm())}}Xe._instance=null;Object(f.a)(Xe,"RenameUIHandlerFactory",null,[]);var Tf=d(147);class Zh{constructor(){this.yag=this.gNn=this.VJl=null}}Object(f.a)(Zh,"RenameMruEntryProperties",null,[]);var se=d(184),Gg=d(90),mf=d(1470),Ne;(function(Q){Q[Q.unknown=-1]="unknown";Q[Q.success=0]="success";Q[Q.zeq=1]="renameInvalidFileName";
Q[Q.yeq=2]="renameInCoauthNotSupported";Q[Q.Aeq=3]="renameNotSupportedInViewMode";Q[Q.q8n=4]="permissionDenied";Q[Q.Zgq=5]="serverCommunicationFailure";Q[Q.RXp=6]="fileNameTooLong"})(Ne||(Ne={}));Object(f.b)("CommonOperationResult",Ne);class Fb{constructor(Q,Da,eb,Tb,Ac,hd,Ud,Ee,Me,Kf,th,Fj){this.lmc=()=>Xe.instance.initialize(m.AFrameworkApplication.X1d,m.AFrameworkApplication.hgi,m.AFrameworkApplication.xCj||CommonUIStrings.l_RenameFileTooltip)?32:8;this.rxc=()=>{const uh=this.wzp(),hi=this.OPk();
Ca.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",this.gFb,hi,uh,this.slb);m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib.cH&&m.AFrameworkApplication.J.$("ReactRenameDisabledDialogIsEnabled")?new Dg(this.gFb,!hi,!uh,this.slb,this.Uib()):new xg(this.gFb,!hi,!uh,this.slb,this.Uib());return 32};this.Sua=(uh,hi,kk,kl,Aa)=>{if(1===kk)return this.moc();
if(!m.AFrameworkApplication.UNb)return 8;if(8===this.moc())return this.Rb.Ob(x.a.rxc,2),8;Ca.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");m.AFrameworkApplication.UNb(Aa,Object(R.a)(this,this.Ved,"onRenameFileSuccess"),this.qZn);m.AFrameworkApplication.wCj=!0;return 32};this.qZn=uh=>{const hi=new zg.StandardDialog;hi.Fd=0;switch(uh){case 1:Ca.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");hi.yna(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,
null);break;case 6:Ca.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");hi.yna(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;default:Ca.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:uh}),hi.yna(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}m.AFrameworkApplication.qN().execute(kk=>{kk.sendMessage(Gg.a.P4l,{["FailureMessage"]:Ne[uh]})});this.mFj()};this.Xoo=
(uh,hi,kk)=>{if(1===kk)return this.moc();if(!m.AFrameworkApplication.WUa)return 8;m.AFrameworkApplication.WUa(Object(R.a)(this,this.Yrc,"onRefreshFilenameSuccess"),Object(R.a)(this,this.Jme,"onRefreshFilenameFailure"),!1);return 32};this.Cje=(uh,hi,kk,kl,Aa)=>{if(1===kk)return m.AFrameworkApplication.J.$("UiHostSupportsMoveToFolder")?this.moc():8;if(2===kk){if(!m.AFrameworkApplication.rmd)return ua.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,
!1,null),8;if(!Aa)return ua.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(Aa[se.a.Kdn])if(Aa[se.a.h8j])if(uh=Aa[se.a.h8j].toLowerCase(),hi=m.AFrameworkApplication.J.$("UiHostSupportsDocRebootFeatures"),kk=m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),hi&&m.AFrameworkApplication.Btb&&kk){const Qa={};Qa[se.a.quc]="1";Qa[se.a.documentUrl]=uh;Qa[se.a.reason]=mf.a.wvg;ua.Health.instance.recordKpiSuccess("MoveToFolder",
null);m.AFrameworkApplication.qN().execute(Fa=>{Fa.sendMessage(Gg.a.kNb,Qa)})}else if(!m.AFrameworkApplication.Btb&&kk)ua.Health.instance.recordKpiSuccess("MoveToFolder",null),ka.a.un(uh,ka.a.ewa(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return ua.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else ua.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else m.AFrameworkApplication.WUa(Object(R.a)(this,this.Yrc,"onRefreshFilenameSuccess"),
Object(R.a)(this,this.Jme,"onRefreshFilenameFailure"),!1),m.AFrameworkApplication.rmd(),ua.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32};this.Noh=Q;this.ga=Da;this.em=eb;this.dO=Tb;this.gFb=Ac;this.OPk=hd;this.slb=Ud;this.cIh=Ee;this.uIk=Me;this.Uib=Kf;this.Ga=th;this.tIk=Fj}Xb(){m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib.vN||this.Rb.qa(x.a.lmc,z.a.frame,this.lmc);this.Rb.qa(x.a.rxc,z.a.frame,this.rxc);this.Rb.qa(x.a.Sua,z.a.frame,this.Sua);this.Rb.fb(x.a.gOb,z.a.frame,
this.Xoo,64);this.Rb.fb(x.a.Cje,z.a.frame,this.Cje,64);this.Rb.qa(x.a.qVb,z.a.frame,Object(R.a)(this,this.qVb,"moveToFolder"));(m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||m.AFrameworkApplication.ua&&(m.AFrameworkApplication.J.$("PostMessageEmbedded")||m.AFrameworkApplication.J.$("IsJsApi"))&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0))&&m.AFrameworkApplication.qN().execute(Q=>
{Q.Xu(Gg.a.Gdj);Q.sD(Gg.a.Gdj,Fb.slo);Q.Xu(Gg.a.WBf);Q.sD(Gg.a.WBf,Fb.rlo)})}moc(){return 0===this.tIk.jEi()?32:8}wzp(){return this.Dn?this.slb?this.Dn.pgi:this.Dn.$pb:!0}Ved(Q,Da){Q?0!==Q.OperationResult?this.HKi(Q.OperationResult):(this.$Lo(Da,Q.NewName),this.Zqp(Q,Object(R.a)(m.AFrameworkApplication.ua.Ib,m.AFrameworkApplication.ua.Ib.y6j,"updateOpenInClientDocumentUrl")),m.AFrameworkApplication.J.$("DocumentNameInJewelInfoMenuIsEnabled")&&m.AFrameworkApplication.ua.Fe(),this.uIk.h4j()):this.HKi(5)}$Lo(Q,
Da){const eb={};eb[se.a.Q4l]=Da;Q.sendMessage(Gg.a.WBf,eb)}Zqp(Q,Da){this.mrp(Q);m.AFrameworkApplication.HZd=Q.DirectInvokeDavUrl;Da=Da(Q.EditDocInClientUrl);const eb=new Zh;eb.yag=this.dO.yA;eb.VJl=Da;eb.gNn=Q.EditDocInClientUrl;this.Rb.Pb(x.a.yCj,2,eb)}HKi(Q){switch(Q){case 1:Q=new zg.StandardDialog,Q.Fd=0,Q.jY(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.mFj()}}mrp(Q){this.dO.yA=Fb.v4k(this.dO.yA,Q.NewName);Q.BreadcrumbFolderName&&(this.dO.breadcrumbFolderName=
Q.BreadcrumbFolderName);Q.BreadcrumbFolderUrl&&(this.dO.breadcrumbFolderUrl=Q.BreadcrumbFolderUrl);this.cIh(Q.NewName)}qVb(Q,Da,eb,Tb,Ac){if(1===eb)return m.AFrameworkApplication.J.$("UiHostSupportsMoveToFolder")?32:8;if(2===eb){const hd={};Q=m.AFrameworkApplication.Btb;Da=m.AFrameworkApplication.J.$("UiHostSupportsDocRebootFeatures");Q=(!Q||Q&&Da)&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);hd[se.a.Vbp]=Q;Ac&&Ac.MoveButtonClickedTime&&(hd[se.a.QKn]=
Ac.MoveButtonClickedTime.getTime());m.AFrameworkApplication.qN().execute(Ud=>{Ud.sendMessage(Gg.a.qVb,hd)});if(Ac&&Ac.MoveButtonClickedTime){if(Q=Tf.a.KG())Ac=(new Date).getTime()-Ac.MoveButtonClickedTime.getTime(),Q.set("MovePostDuration",Ac.toString());ua.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",Q)}return 32}return 8}k2o(Q,Da){return Q&&Da?Q!==this.dO.breadcrumbFolderName||Da!==this.dO.breadcrumbFolderUrl:!1}Yrc(Q,Da){Q&&(Q.NewName!==Ya.a.rL(this.dO.yA)||this.k2o(Q.BreadcrumbFolderName,
Q.BreadcrumbFolderUrl))&&this.Ved(Q,Da)}Jme(){}mFj(){this.cIh(Ya.a.rL(this.dO.yA))}get Rb(){return this.ga.value}get Dn(){return this.em.value}static get instance(){return Fb._instance||(Fb._instance=Fb.MOb())}static MOb(){return new Fb(m.AFrameworkApplication.T9c,new tb.a(()=>m.AFrameworkApplication.va),new tb.a(()=>m.AFrameworkApplication.Dn),m.AFrameworkApplication.Ft,m.AFrameworkApplication.Mta,()=>m.AFrameworkApplication.zMg,m.AFrameworkApplication.dkd,Object(R.a)(Xe.instance,Xe.instance.oAc,
"updateTitle"),La.a.instance.resolve(1196),()=>m.AFrameworkApplication.ow,m.AFrameworkApplication.J,La.a.instance.resolve(1068))}static v4k(Q,Da){Q=Ya.a.Uka(Q);return Da+Q}static slo(Q){const Da=Q.Values[se.a.Sjn];Ca.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",Da);Da?m.AFrameworkApplication.va.Pb(x.a.Cje,2,Q.Values):ua.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static rlo(Q){m.AFrameworkApplication.va.Pb(x.a.Sua,2,
Q.Values.NewName)}}Fb._instance=null;Object(f.a)(Fb,"RenameActor",null,[]);var Vb=d(193),Qc=d(1246),yd=d(569),Ce=d(467);class sf{constructor(Q,Da){this.ga=Q;this.wFc=Da}Xb(){this.ga.qa(x.a.JCg,z.a.frame,Object(R.a)(this,this.i5o,"showRenameDialogAction"))}i5o(Q,Da,eb){Q=32;if(1===eb)return Ce.SessionStatusManager.instance.Hk||m.AFrameworkApplication.nta?8:32;2===eb&&(32!==this.ga.Ob(x.a.Sua,1)?(this.ga.Ob(x.a.rxc,2),Vb.a.instance.$b(Qc.a.esa,{["Reason"]:yd.a.Cyo}),Q=8):32===this.ga.Ob(x.a.sxc,1)?
this.ga.Ob(x.a.sxc,2):this.wFc.value.create().x_a());return Q}}Object(f.a)(sf,"RenameDialogActor",null,[1342]);class lh{constructor(Q,Da,eb){this.dialog=null;this.ga=Q;this.dO=Da;this.Zhb=eb}tFm(){const Q={};Q.nameInputProps={["type"]:"AppInputProps",["id"]:lh.zgc,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:Ya.a.rL(this.dO.yA),["maxLength"]:this.Zhb};return Q}x_a(){const Q={["id"]:"RenameDialog",["bodyControls"]:this.tFm()};this.dialog=new a.a(!1,!1,!0);this.dialog.Fd=1;this.dialog.Ng=
"RenameDialog";this.dialog.mi(CommonUIStrings.l_RenameDialogTitle,Object(R.a)(this,this.isg,"renameDialogHandler"),Q)}isg(Q,Da){if(Da&&1===Q){if(Da[lh.zgc]&&(Q=Ya.a.rL(this.dO.yA),Da=(Da[lh.zgc]||"").trim(),Da!==Q&&""!==Da)){this.ga.Pb(x.a.Sua,2,Da);return}Vb.a.instance.$b(Qc.a.wgc,{["Reason"]:yd.a.hmi})}}}lh.zgc="txtDocumentName";Object(f.a)(lh,"ReactRenameDialog",null,[1358]);class Ef{static get kh(){return a.a.Ry(Ef.Hn,CommonUIStrings.l_RenameDialogLabel)}}Ef.Hn="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(f.a)(Ef,"RenameDialogHtml",null,[]);class ng extends a.a{constructor(Q,Da,eb){super();this.ga=Q;this.dO=Da;this.Zhb=eb;this.Ng="RenameDialog";this.kh=Ef.kh}x_a(){var Q={["txtDocumentName"]:Ya.a.rL(this.dO.yA)};this.mi(CommonUIStrings.l_RenameDialogTitle,Object(R.a)(this,this.isg,"renameDialogHandler"),Q);Q=document.getElementById(ng.zgc);0<this.Zhb&&(Q.maxLength=this.Zhb);Q.focus()}isg(Q,Da){if(1===Q&&(Q=Ya.a.rL(this.dO.yA),Da=(Da[ng.zgc]||"").trim(),Da!==Q&&""!==Da)){this.ga.Pb(x.a.Sua,2,
Da);return}Vb.a.instance.$b(Qc.a.wgc,{["Reason"]:yd.a.hmi})}}ng.zgc="txtDocumentName";Object(f.a)(ng,"RenameDialog",a.a,[1358]);class Dh{constructor(Q){this.sQa=null;this.Zhb=0;this.ga=Q;this._initialized=!1}initialize(Q,Da){this.sQa=Q;this.Zhb=Da;this._initialized=!0}create(){return this._initialized?m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib.cH&&m.AFrameworkApplication.J.$("ReactRenameDialogIsEnabled")?new lh(this.ga,this.sQa,this.Zhb):new ng(this.ga,this.sQa,this.Zhb):null}}Object(f.a)(Dh,
"RenameDialogFactory",null,[1341]);var Af=d(178),Jh=d(114);class vg{constructor(Q,Da){this.ga=Q;this.Yb=Da}Xb(){this.ga.qa(x.a.sxc,z.a.frame,Object(R.a)(this,this.j5o,"showRenameFlyoutAction"))}gjl(){return I.d("setDocumentTitleFlyoutOpened")&&m.AFrameworkApplication.ua.Ib.vN}j5o(Q,Da,eb){if(1===eb)return this.gjl()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}gXk(){vg.won&&m.AFrameworkApplication.wI&&Jh.a.instance.Zb(new ud.a(5,1,5E3,()=>{32===this.ga.Ob(x.a.sxc,
1)&&this.Yb&&this.Yb.currentScope.name===Af.AFrame.Ro&&(ce.a("RenameFloatieShownOnNewDocumentLoad",!0),this.ga.Ob(x.a.sxc,2))}))}static get won(){vg.uEd&&null!=vg.uEd||(m.AFrameworkApplication.vd("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),vg.uEd=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return vg.uEd}}vg.uEd=null;Object(f.a)(vg,"RenameFlyoutActor",null,[1338]);
class Hk{constructor(Q,Da,eb,Tb,Ac){this.Nrl=null;this.em=Ac;this.Ooh=eb;this.Noh=Tb;this.QPk=Q;this.Uib=Da}get Dn(){return this.em.value}jEi(){if(!this.Noh())return 5;if(this.Uib())return 1;if(this.Dn){if(this.Ooh&&!this.Dn.pgi)return 3;if(!this.Ooh&&!this.Dn.$pb)return 4}return this.QPk()?0:2}}Object(f.a)(Hk,"RenameProps",null,[1340]);class tg{constructor(Q,Da,eb,Tb,Ac,hd){this.Ks=!1;this.VYe=new qc.a;this.V5b=Da;this.nB=eb;this.M4b=Tb;this.Ga=Ac;this.eja=hd}enable(){this.Ks||(this.h4j(),this.pEg(),
this.Ks=!0)}generateKey(Q,Da,eb){return String.format("{0}/{1}/{2}",eb,Q,Da)}Fum(){const Q=Ya.a.rL(this.V5b().yA);return this.generateKey(this.V5b().breadcrumbFolderName,this.V5b().breadcrumbFolderUrl,Q)}Gum(Q,Da,eb){return Q&&Da?this.generateKey(Q,Da,eb):eb}rRl(Q,Da,eb){return Q&&Q!==this.V5b().breadcrumbFolderName||Da&&Da!==this.V5b().breadcrumbFolderUrl?!0:eb!==Ya.a.rL(this.V5b().yA)}h4j(){const Q=this.Fum();this.VYe.Z(Q,new Date)}tjg(Q){this.q0o(Q)&&this.AKh(Q)}q0o(Q){const Da=this.M4b();return Da?
this.eja&&this.eja.Do||!Da.OXf||!m.AFrameworkApplication.WUa?(this.LWj(Q),this.Ks=!1):!0:!1}Imj(Q,Da,eb,Tb){const Ac=this.rRl(Q,Da,eb);Q=this.Gum(Q,Da,eb);Da=this.VYe.Ac(Q).returnValue;Ac&&!Da&&(this.JKi(Tb),Ca.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.v5f));Ac||this.VYe.Z(Q,this.nB())}}Object(f.a)(tg,"ARenamedFileChecker",null,[1313]);class wh extends tg{constructor(Q,Da,eb,Tb,Ac,hd,Ud,Ee){super(Q,Da,eb,Tb,Ac,hd);this.eLi=(Me,Kf)=>{Kf&&Kf.BVb&&Kf.ihj&&(Kf.tXa("BreadcrumbDocName")||
Kf.tXa("BreadcrumbFolderName")||Kf.tXa("BreadcrumbFolderUrl")||Kf.tXa("DirectInvokeDAVUrl")||Kf.tXa("EditDocInClientUrl"))&&(Ca.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.v5f),this.tjg(Kf))};this.qO=Ac;this.sIk=Ud;this.PTe=Ee}get v5f(){return"RenamedFileCheckerUsingSettingsRefresh"}pEg(){this.qO.URc(this.eLi)}LWj(){this.qO.Srg(this.eLi)}AKh(Q){if(Q&&Q.BVb){const Da=Q.BVb;this.Imj(Da.ib("BreadcrumbFolderName"),Da.ib("BreadcrumbFolderUrl"),Da.ib("BreadcrumbDocName"),Q)}}JKi(Q){const Da=
{OperationResult:0,classId:1};Q=Q.BVb;Da.BreadcrumbFolderName=Q.ib("BreadcrumbFolderName");Da.BreadcrumbFolderUrl=Q.ib("BreadcrumbFolderUrl");Da.DirectInvokeDavUrl=Q.ib("DirectInvokeDAVUrl");Da.EditDocInClientUrl=Q.ib("EditDocInClientUrl");Q=Q.ib("BreadcrumbDocName");Da.NewName=m.AFrameworkApplication.g_d?Q:Ya.a.rL(Q);this.PTe.execute(eb=>{this.V$m(Da,eb)})}V$m(Q,Da){this.sIk().Ved(Q,Da)}}Object(f.a)(wh,"RenamedFileCheckerUsingSettingsRefresh",tg,[]);class Hg extends tg{constructor(Q,Da,eb,Tb,Ac,
hd,Ud,Ee,Me,Kf){super(Q,eb,Tb,Ac,hd,Me);this.DNc=this.tk=null;this.EGk=Da;this.ga=Ud;this.Gb=Ee;Kf&&Kf.execute(th=>{this.yto(th)})}get v5f(){return"RenamedFileCheckerUsingTask"}yto(Q){this.tk=Q;this.tk.IHa(Object(R.a)(this,this.A_,"handleVisibilityChange"))}A_(Q,Da){!this.Ks||0!==Da.newState&&1!==Da.newState||this.DNc||(this.pEg(),this.tjg(this.DNc))}pEg(){this.DNc=new ud.a(3,2,this.EGk(),Object(R.a)(this,this.tjg,"performRenameFileCheckTick"),89);this.Gb.Zb(this.DNc)}LWj(Q){this.Gb.uf(Q)}AKh(Q){this.tk&&
2===this.tk.uA?this.tvo(Q):m.AFrameworkApplication.WUa(Object(R.a)(this,this.Yrc,"onRefreshFilenameSuccess"),Object(R.a)(this,this.Jme,"onRefreshFilenameFailure"),!0)}tvo(Q){this.Gb.uf(Q);this.DNc=null}Yrc(Q){Q&&this.Imj(Q.BreadcrumbFolderName,Q.BreadcrumbFolderUrl,Q.NewName,null)}JKi(){this.ga.Ob(x.a.gOb,2)}Jme(){}}Object(f.a)(Hg,"RenamedFileCheckerUsingTask",tg,[]);var Sf=d(80);class ph{constructor(){this.Ga=this.W=null;this.fz=()=>{const Q=m.AFrameworkApplication.ua.Ib.vN;m.AFrameworkApplication.T9c()&&
Xe.instance.initialize(m.AFrameworkApplication.X1d,Q?null:m.AFrameworkApplication.hgi,Q?null:m.AFrameworkApplication.xCj||CommonUIStrings.l_RenameFileTooltip)&&(this.W.register(Hk,"Common.App.Rename.RenameProps").as(1068).Sd(()=>new Hk(()=>m.AFrameworkApplication.zMg,()=>m.AFrameworkApplication.ow,m.AFrameworkApplication.dkd,m.AFrameworkApplication.T9c,new tb.a(()=>m.AFrameworkApplication.Dn))).ha(),Fb.instance.Xb(),this.Ga.$("RenameDialogIsEnabled")&&(this.W.resolve(1197).initialize(m.AFrameworkApplication.Ft,
m.AFrameworkApplication.X1d),this.W.resolve(1198).Xb()),this.W.resolve(1199).Xb(),m.AFrameworkApplication.dkd&&this.W.resolve(1196).enable(),this.W.resolve(1199).gXk())}}get name(){return"Common.App.RenameFile"}uc(Q){this.W=Q;this.Ga=m.AFrameworkApplication.J;this.W.register(sf,"Common.App.Rename.RenameDialogActor").as(1198).Sd(()=>new sf(m.AFrameworkApplication.va,this.W.rf(1200))).ha();this.W.register(Dh,1197).as(1200).Sd(()=>new Dh(m.AFrameworkApplication.va)).ha();this.W.register(1313,1196).Sd(()=>
this.WGl()).ha();this.W.register(vg,"Common.App.Rename.RenameFlyoutActor").as(1199).Sd(()=>new vg(m.AFrameworkApplication.va,Sf.FocusManager.instance())).ha()}WGl(){if(this.Ga.$("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const Q=this.W.Oa(1);if(Q&&Q.O_i)return new wh(()=>Q.ic("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>m.AFrameworkApplication.Ft,()=>new Date,()=>m.AFrameworkApplication.Dn,Q,this.W.Oa(117),()=>Fb.instance,this.W.Ra(7))}return new Hg(()=>this.Ga.ic("RenamedFileCheckerMaxCachedAgeInMs",
48E4),()=>this.Ga.ic("RenamedFileCheckerPingIntervalInMs",12E4),()=>m.AFrameworkApplication.Ft,()=>new Date,()=>m.AFrameworkApplication.Dn,m.AFrameworkApplication.J,m.AFrameworkApplication.va,m.AFrameworkApplication.oc,this.W.Oa(117),this.W.Ra(103))}init(){this.Ga.Uo(this.fz)}dispose(){}}Object(f.a)(ph,"PackageManager",null,[0,1]);class Mh extends a.a{constructor(Q,Da,eb){super(!1,!1,!0);this.pZb=(Tb,Ac)=>{if(1===Tb){Tb=Ac.ribbonLayoutChoice;const hd=Ac.showRibbonChoice;Ac.checkedNewLookToggle!==
this.ooh&&appChrome.api.getToggleVNextLookHandler()();if(this.sBh!==Tb)appChrome.onRibbonModeToggle();this.ZDh!==hd&&("AlwaysShow"===hd?appChrome.api.getAlwaysShowCommandHandler():appChrome.api.getHideCommandHandler())()}};this.ooh=Q;this.sBh=Da;this.ZDh=eb}start(){this.mi("",this.pZb,{["id"]:"RibbonSettingsDialog",["bodyControls"]:{["checkedNewLookToggle"]:this.ooh,["ribbonLayoutChoice"]:this.sBh,["showRibbonChoice"]:this.ZDh}})}}Object(f.a)(Mh,"RibbonSettingsDialog",a.a,[]);class Qf{constructor(Q){this.ga=
Q}Xb(){this.ga.qa(x.a.m5o,z.a.frame,this.n5o)}n5o(){let Q="SingleLineRibbon";const Da=m.AFrameworkApplication.J.$("Fluent2StyleIsEnabled");"Multiline"===appChrome.selectors.getRibbonMode()&&(Q="ClassicRibbon");const eb=appChrome.selectors.getShyState().isActive?"AutomaticallyHide":"AlwaysShow";(new Mh(Da,Q,eb)).start();return 32}}Object(f.a)(Qf,"RibbonSettingsDialogActor",null,[1314]);class Qi{constructor(){this.W=null}get name(){return"Common.App.RibbonSettings"}uc(Q){this.W=Q;this.W.register(Qf,
"Common.App.RibbonSettings.RibbonSettingsDialogActor").as(1201).Sd(()=>new Qf(m.AFrameworkApplication.va)).ha()}init(){const Q=this.W.Oa(1201);Q?Q.Xb():P.b(508436678,200,15,"Failed to resolve IRibbonSettingsDialogActor. Ribbon dialog feature is not enabled.")}dispose(){}static main(){C.a.instance.Lc(new Qi)}}Object(f.a)(Qi,"RibbonSettingsPackage",null,[0,1]);class Cl{static get kh(){return a.a.Ry(Cl.Hn,CommonUIStrings.l_SaveACopyFileName)}}Cl.Hn="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(f.a)(Cl,"FileNameDialogHtml",null,[]);class tl extends a.a{constructor(Q,Da,eb,Tb){super();this.SAd=this.PQa=null;this.ga=Q;this.nwa=Da;this.ibc=eb;this.Qe(1,CommonUIStrings.l_SaveButtonLabel);this.kh=Cl.kh;this.Ng="FileNameDialog-SaveACopy";this.zh=Tb}nJa(Q,Da,eb){this.SAd=Q;this.PQa=eb;Q={["txtFileName"]:Ya.a.rL(m.AFrameworkApplication.Ft.yA),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,Da)};this.mi(CommonUIStrings.l_SaveToOneDrive,Object(R.a)(this,this.W1d,"fileNameDialogHandler"),
Q);Ca.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}W1d(Q,Da){1!==Q?Ca.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(Q=Da.txtFileName.trim(),Ca.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),Da=Ya.a.Uka(m.AFrameworkApplication.fileName),Q&&""!==Q&&""!==Da&&(Q+=Da),this.ibc.gEa(this.SAd,this.PQa,Q,this.zh))}}Object(f.a)(tl,"FileNameDialog",
a.a,[1368]);class pf{constructor(Q,Da,eb){this.ga=Q;this.nwa=Da;this.ibc=eb}create(Q){return new tl(this.ga,this.nwa,this.ibc,Q)}}Object(f.a)(pf,"FileNameDialogFactory",null,[1352]);class Wk extends zg.StandardDialog{constructor(Q){super();this.rug=Da=>{1===Da?(Ca.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.ga.Ob(x.a.tdb,2)):Ca.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")};this.Fd=1;this.Qe(1,CommonUIStrings.l_RetryButtonLabel);this.Qe(0,CommonUIStrings.l_DialogClose);
this.ga=Q}aR(Q){Ca.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",Q);this.zy(Q,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,this.rug)}}Object(f.a)(Wk,"RetryDialog",zg.StandardDialog,[1353]);var Eh=d(1150);class Li{}Li.wxb="SaveToCloudStorage";Li.tdb="SaveACopy";Object(f.a)(Li,"SaveToCloudStorageConstants",null,[]);class Dj{constructor(Q,Da,eb,Tb){this.vKd=null;this.NJk=Q;this.Ga=eb;this.twh=Da;this.Srh=new v.a;this.Xd=Tb}Moc(){return this.Ga.$("SaveToCloudStorageUIIsEnabled")}Tpb(){return x.a.wxb}BTd(){ad.a.Cse(Object(R.a)(this,
this.KHj,"saveToCloudActionDispatcher"));ad.a.GZc([new Eh.a(x.a.wxb,z.a.frame,0)],this.twh.Vjc())}Xb(){const Q=this.twh.Vjc();Q?(Q.a2(()=>{this.Srh.hg(!0)}),this.BTd()):Ca.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}Dxj(){Ca.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}KHj(Q,Da,eb,Tb,Ac){Tb="";switch(Q){case x.a.wxb:Tb=Li.wxb;break;case x.a.tdb:Tb=Li.tdb;break;default:Ca.ULS.sendTraceTag(508372377,216,50,
"SaveToCloudStorageActor Entry Point other than SaveToCloudStorage or SaveACopy")}return Da.contextId!==z.a.frame||Q!==this.Tpb()?2:this.Moc()?1===eb?Ce.SessionStatusManager.instance.Hk||m.AFrameworkApplication.nta?8:32:2===eb?(this.Dxj(),Ac&&m.AFrameworkApplication.J.$("EntryPoint_SaveToCloudStorage")&&(Ac.SaveEntryPoint=Tb),Ac&&Ac.FileDownloadUrl&&Ca.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.Xd&&(this.vKd=this.Xd.Wf("DialogShown","SaveToOneDriveReponseTime")),
this.Srh.task.continueWith(()=>{this.vKd&&(this.vKd.stop(),this.vKd=null);this.NJk.start(Ac)}),32):8:8}}Object(f.a)(Dj,"SaveToCloudStorageActor",null,[1362]);class xi extends Dj{constructor(Q,Da,eb,Tb){super(Q,Da,eb,Tb);this.jFk=Da}Moc(){return this.Ga.$("SaveACopyBrsIsEnabled")}Tpb(){return x.a.tdb}BTd(){ad.a.Cse(Object(R.a)(this,this.KHj,"saveToCloudActionDispatcher"));ad.a.GZc([new Eh.a(x.a.tdb,z.a.frame,0)],this.jFk.Vjc())}Dxj(){m.AFrameworkApplication.vd("CreateCopy_cf;CreateCopy_tf");Ca.ULS.sendTraceTag(7205456,
216,50,"User clicked on SaveAs button from the backstage.")}}Object(f.a)(xi,"SaveACopyActor",Dj,[]);class pg{}pg.default=0;Object(f.a)(pg,"SaveToCloudErrorCodes",null,[]);class Mi{constructor(Q,Da,eb,Tb,Ac,hd){this.zh=null;this.JLk=Q;this.fya=Da;this.ibc=eb;this.Ga=Tb;this.S3b=Ac;this.qJ=hd}start(Q){this.zh=Q;var Da=null!==this.zh&&this.zh.hasOwnProperty("SaveEntryPoint")&&this.zh.SaveEntryPoint.toString()===Li.wxb;if("SharePointOnlineConsumer"===this.Ga.ib("FileSource")){const eb=La.a.instance.resolve(1202);
if(eb){eb.start(null,Q);return}}this.fya.K7c?(Q=Object(Va.a)(String,m.AFrameworkApplication.sessionStartInfoSettings.Host),m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib&&1===m.AFrameworkApplication.ua.Ib.Uk&&Da&&("Open From URL"===Q||m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveToOneDriveSkipFilePicker",!1))?(Ca.ULS.sendTraceTag(508852051,216,15,"User is signed in. We will initiate a save for this file to user's root OneDrive location"),this.ibc.gEa("root",
"https://onedrive.live.com",null,this.zh)):(Ca.ULS.sendTraceTag(6590559,216,m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib&&1===m.AFrameworkApplication.ua.Ib.Uk?15:50,"User is signed in. We will show file picker."),this.fil())):(Ca.ULS.sendTraceTag(6590560,216,m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib&&1===m.AFrameworkApplication.ua.Ib.Uk?15:50,"User is not signed in. We will show sign in dialog."),this.u5o())}u5o(){this.JLk.create().nJa()}mq(){this.qJ().aR(pg.default)}fil(){try{Ca.ULS.sendTraceTag(6590561,
216,50,"Initializing OneDrive API");let Q={["client_id"]:this.Ga.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.S3b||2===this.S3b)Q={["client_id"]:this.Ga.appSettings.UploadToSkyDriveClientId};WL.init(Q);Ca.ULS.sendTraceTag(6590562,216,m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib&&1===m.AFrameworkApplication.ua.Ib.Uk?15:50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(R.a)(this,this.sE,"onSuccess"),
Object(R.a)(this,this.onFailure,"onFailure"))}catch(Q){Ca.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",Q,Q.stack),this.mq()}}sE(Q){Ca.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");Q&&Q.data&&Q.data.folders&&this.ibc.gEa(Q.data.folders[0].id,Q.data.folders[0].urls.viewInBrowser,null,this.zh)}onFailure(Q){if(Q&&Q.error){if("user_canceled"===Q.error.code){Ca.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");
return}Ca.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",Q.error.code,Q.error.message)}else Ca.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.mq()}}Object(f.a)(Mi,"SaveToCloudManager",null,[1334]);class Vl extends Mi{constructor(Q,Da,eb,Tb,Ac,hd,Ud){super(Da,eb,Tb,Ac,hd,Ud);this.qtk=Q}sE(Q){Q&&Q.data&&Q.data.folders?(Ca.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.qtk.create(this.zh).nJa(Q.data.folders[0].id,
Q.data.folders[0].name,Q.data.folders[0].urls.viewInBrowser)):(Ca.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.mq())}onFailure(Q){Q&&Q.error&&"user_canceled"===Q.error.code&&Ca.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.onFailure(Q)}mq(){Ca.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.mq()}}Object(f.a)(Vl,"SaveACopyManager",Mi,[]);var ki=d(179);class Th{constructor(Q,Da,eb,Tb,Ac){this.PQa=
this.pl=this.wDc=null;this.s1=!1;this.zh=this.l5a=null;this.dbf=Q;this.W3a=Da;this.qJ=eb;this.wj=Tb;this.Xd=Ac}jeb(){this.wj&&1===this.wj.state||(this.pl=this.W3a(),this.pl.message=CommonUIStrings.l_CommentProgressTooltip,this.pl.Fd=5,this.pl.Bu=!1,this.pl.dM(CommonUIStrings.l_DefaultDialogTitle,null,null))}Ora(){this.pl&&(this.pl.close(),this.pl=null)}A8(){1!==m.AFrameworkApplication.ua.state&&this.qJ().aR(pg.default)}EYb(){Ca.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");ka.a.un(this.PQa,
ka.a.ewa(3),void 0,"UploadToCloudManager.RedirectToFolder")}DYb(Q){var Da=null!==this.zh&&this.zh.hasOwnProperty("SaveEntryPoint")&&this.zh.SaveEntryPoint.toString()===Li.wxb;m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib&&1===m.AFrameworkApplication.ua.Ib.Uk&&Da&&(Q+="&wdsvodm=true");let eb=Da=!1;m.AFrameworkApplication.J&&(Da=m.AFrameworkApplication.J.$("SaveACopyIsEnabledForUiHost"),eb=m.AFrameworkApplication.J.$("UiHostSupportsDocRebootFeatures"));Ca.ULS.sendTraceTag(6654163,216,m.AFrameworkApplication.ua&&
m.AFrameworkApplication.ua.Ib&&1===m.AFrameworkApplication.ua.Ib.Uk?15:50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",Q,Da);if(Da&&eb){Ca.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Tb={};Tb[se.a.quc]="1";Tb[se.a.documentUrl]=Q;m.AFrameworkApplication.qN().execute(Ac=>{Ac.sendMessage(Gg.a.kNb,Tb)})}else ka.a.un(Q,ka.a.ewa(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}gEa(Q,Da,eb=null,Tb=null){Ca.ULS.sendTraceTag(7143886,
216,50,"Starting to upload file");this.Xd&&(this.l5a=this.Xd.Wf("DialogShown","SaveToOneDriveUploadTime"));this.jeb();this.PQa=Da;this.wDc=this.dbf.create(Q,eb,Tb);this.zh=Tb;this.Dka()}Dka(){Ca.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.wDc.execute(Object(R.a)(this,this.l_n,"onSaveToCloudUploadFinished"),Object(R.a)(this,this.k_n,"onSaveToCloudUploadFailed"))}l_n(Q){this.Ora();this.s1=!1;if(Q&&Q.data&&Q.data.De){var Da;if(({ev:Da}=Za.d(Q.data.De)).returnValue)if(Q=Da,
Q.StatusCode!==ki.a.pz&&Q.StatusCode!==ki.a.zfc)Ca.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.A8();else{Ca.ULS.sendTraceTag(6590603,216,m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib&&1===m.AFrameworkApplication.ua.Ib.Uk?15:50,"UploadToCloudManager upload success.");try{Q.NewDocumentUrl&&""!==Q.NewDocumentUrl?this.DYb(Q.NewDocumentUrl):this.EYb()}catch(eb){Ca.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",
eb.toString())}this.qgd()}else Ca.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Mb.a.Erd(Q.data.De)}),this.A8()}else Ca.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.A8()}k_n(Q){5!==Q.data.status&&12!==Q.data.status||this.s1?(Ca.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",Q.data.status),this.Ora(),this.A8(),this.qgd()):(Ca.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),
this.s1=!0,this.Dka())}qgd(){this.l5a&&(this.l5a.stop(),this.l5a=null)}}Object(f.a)(Th,"UploadToCloudManager",null,[1335]);class hh extends Th{constructor(Q,Da,eb,Tb,Ac,hd){super(Da,eb,Tb,Ac,hd);this.ga=Q}w_f(){return!!this.zh&&!!this.zh.SaveEntryPoint&&"VersionHistory"===this.zh.SaveEntryPoint.toString()}A8(){Ca.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.w_f()&&this.ga.Pb(x.a.Ote,2,{["FailureReason"]:"Unknown"});super.A8()}EYb(){Ca.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");
this.w_f()&&this.ga.Ob(x.a.Bkd,2);super.EYb()}DYb(Q){Ca.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",Q);this.w_f()&&this.ga.Ob(x.a.Bkd,2);super.DYb(Q)}Dka(){this.zh&&"true"===this.zh.SkipSaveToHost?super.Dka():32!==this.ga.Ob(x.a.LZb,1)?(Ca.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.Dka()):this.ga.Pb(x.a.LZb,2,[()=>{Ca.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");
Th.prototype.Dka.call(this)},()=>{Ca.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.A8()}])}}Object(f.a)(hh,"SaveACopyUploadToCloudManager",Th,[]);var Fe=d(752),tj=d(1148);class Ni{constructor(){this.W=null;this.fz=()=>{m.AFrameworkApplication.J.$("SaveACopyBrsIsEnabled")&&this.W.resolve(1203).Xb()}}get name(){return"Common.App.SaveACopy"}init(){m.AFrameworkApplication.J.Uo(this.fz)}dispose(){}uc(Q){this.W=Q;this.W.register(hh,
1205).Sd(()=>new hh(m.AFrameworkApplication.va,Q.resolve(1204),()=>(new tj.a).create(),()=>new Wk(m.AFrameworkApplication.va),m.AFrameworkApplication.ua,m.AFrameworkApplication.ua.Vr)).ha();this.W.register(pf,1208).as("Common.App.SaveACopy.IFileNameDialogFactory").Sd(()=>new pf(m.AFrameworkApplication.va,m.AFrameworkApplication.ua.Ib,Q.resolve(1205))).ha();this.W.register(xi,1203).Sd(()=>new xi(Q.resolve(1206),Q.resolve(1207),m.AFrameworkApplication.J,m.AFrameworkApplication.ua.Vr)).ha();this.W.register(Vl,
1206).Sd(()=>new Vl(Q.resolve(1208),Q.resolve(1209),Fe.a.instance,Q.resolve(1205),m.AFrameworkApplication.J,m.AFrameworkApplication.O6,()=>new Wk(m.AFrameworkApplication.va))).ha()}static main(){C.a.instance.Lc(new Ni)}}Object(f.a)(Ni,"PackageManager",null,[0,1]);var bh=d(44);class rk extends zg.StandardDialog{constructor(Q,Da){super();this.j9b=!1;this.tQ=null;this.rug=eb=>{1===eb?(Ca.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.tQ?this.ga.Pb(x.a.Kld,2,[this.tQ,
this.j9b]):this.ga.Ob(x.a.Kld,2)):Ca.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")};this.ga=Q;this.xGc=Da;this.$Na=!1}aR(Q,Da,eb){this.tQ=Da;this.j9b=eb;Ca.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",Q,eb);Q=this.pnf(Q);0===Q?(this.Fd=6,this.Qe(0,CommonUIStrings.l_DialogClose)):(this.Fd=0,this.Qe(1,CommonUIStrings.l_DialogClose));0===Q&&Ca.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.zy(bh.a.zHo,this.dnm(Q),this.cnm(Q,
Da),this.rug,!0)}pnf(Q){return 0>Q||6<Q?(Ca.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",Q),0):Q}cnm(Q,Da){Q=this.pnf(Q);return this.xGc?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,Da),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][Q]:[CommonUIStrings.l_FailToSaveFile,
CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,Da),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][Q]}dnm(Q){Q=this.pnf(Q);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][Q]}}
Object(f.a)(rk,"ErrorRetryDialog",zg.StandardDialog,[1372]);class Qd{constructor(Q,Da){this.Ga=Q;this.ga=Da;this.xGc=this.Ga.$("SaveToHostWithExtraCharsInFileName")}create(){return new rk(this.ga,this.xGc)}}Object(f.a)(Qd,"ErrorRetryDialogFactory",null,[1360]);class kf extends a.a{constructor(Q,Da,eb,Tb,Ac,hd,Ud=null){super();this.H9=null;this.ga=Da;this.nwa=Tb;this.m5a=hd;this.Ga=Q;this.qJ=Ac;this.wj=eb;this.xGc=this.Ga.$("SaveToHostWithExtraCharsInFileName");this.zh=Ud;this.Qe(1,CommonUIStrings.l_SaveButtonLabel)}get ua(){return this.wj}Nei(Q,
Da){this.iva(1,!!Q&&Q!==Da);this.H9=document.getElementById(kf.gmi);ba.a.addHandler(this.H9,"change",Object(R.a)(this,this.Lle,"onFileNameChange"));ba.a.addHandler(this.H9,"input",Object(R.a)(this,this.Lle,"onFileNameChange"));this.H9.focus()}fmi(Q){return this.xGc?(new RegExp("["+this.Uji('\\/:*?"<>|')+"]")).test(Q):(new RegExp("["+this.Uji('\\/:*?"<>|#{}%~&')+"]")).test(Q)}Uji(Q){return Q.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}xQf(){const Q=Ya.a.rL(m.AFrameworkApplication.Ft.yA);
this.iva(1,!!this.H9&&""!==this.H9.value&&this.H9.value!==Q)}Lle(){this.H9&&window.setTimeout(()=>{this.xQf()},0)}W1d(Q,Da){if(1!==Q)Ca.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{Q=Da[kf.gmi];Da=kf.Poj in Da?Da[kf.Poj]:!1;Ca.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",Ya.a.dyj(Q),Da);const eb=Ya.a.Uka(m.AFrameworkApplication.fileName);(Q=Q?Q.trim():null)&&""!==Q&&""!==eb||
1===this.ua.state?this.fmi(Q)?this.qJ.create().aR(1,Q,Da):this.m5a.gEa(Q+eb,Da,this.zh):this.qJ.create().aR(2,Q,Da)}}dispose(){this.H9&&(ba.a.removeHandler(this.H9,"change",Object(R.a)(this,this.Lle,"onFileNameChange")),ba.a.removeHandler(this.H9,"input",Object(R.a)(this,this.Lle,"onFileNameChange")),this.H9=null);super.dispose()}}kf.gmi="txtFileName";kf.Poj="chkOverwrite";Object(f.a)(kf,"FileNameDialogBase",a.a,[]);class sk{static get kh(){return a.a.Ry(sk.Hn,CommonUIStrings.l_SaveACopyFileName,
CommonUIStrings.l_SaveAsToHostOverwrite)}}sk.Hn="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(f.a)(sk,"FileNameDialogHtml",null,[]);class al extends kf{constructor(Q,Da,eb,Tb,Ac,hd){super(Q,Da,eb,Tb,Ac,hd);this.kh=sk.kh;this.Ng="FileNameDialog-SaveAsToHost"}nJa(Q,Da){const eb=Ya.a.rL(m.AFrameworkApplication.Ft.yA);Da={["txtFileName"]:Q||eb,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:Da};this.mi(CommonUIStrings.L_SaveAs,Object(R.a)(this,this.W1d,"fileNameDialogHandler"),Da);this.Nei(Q,eb)}}Object(f.a)(al,"FileNameDialog",kf,[1371]);class he{constructor(Q,Da,
eb,Tb,Ac,hd){this.ga=Da;this.Ga=Q;this.nwa=Tb;this.m5a=hd;this.qJ=Ac;this.wj=eb}create(){return new al(this.Ga,this.ga,this.wj,this.nwa,this.qJ,this.m5a)}}Object(f.a)(he,"FileNameDialogFactory",null,[1359]);class qd{constructor(Q,Da,eb){this.rHj=(Tb,Ac,hd,Ud,Ee)=>Ac.contextId!==z.a.frame||Tb!==x.a.Kld?2:this.Ga.$("SaveAsToHostBrsIsEnabled")?1===hd?Ce.SessionStatusManager.instance.Hk||m.AFrameworkApplication.nta?8:32:2===hd?(Ca.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),
Tb=this.pRe.create(),Ee&&Object.getType(Ee)===Array&&2===Ee.length?Tb.nJa(Ee[0],!!Ee[1]):Tb.nJa(null,!1),32):8:8;this.m5a=eb;this.pRe=Da;this.Ga=Q}Xb(){2===m.AFrameworkApplication.ua.Ib.Uk?m.AFrameworkApplication.va.fb(x.a.Kld,z.a.frame,this.rHj,4):m.AFrameworkApplication.va.qa(x.a.Kld,z.a.frame,this.rHj)}}Object(f.a)(qd,"SaveAsToHostActor",null,[]);class hl{constructor(Q,Da,eb,Tb,Ac,hd,Ud,Ee){this.pl=null;this.j9b=this.s1=!1;this.l5a=this.zh=this.tQ=null;this.Ga=Da;this.sqa=this.Ga.appSettings.SaveAsToHostWebServiceBase;
this.nmh=Tb;this.W3a=Ac;this.Gf=eb;this.qJ=hd;this.Xd=Ee;this.wj=Ud;this.ga=Q;this.v2a=Da.ib("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}jeb(){1!==this.wj.state&&(this.pl=this.W3a(),this.pl.message=CommonUIStrings.l_CommentProgressTooltip,this.pl.Fd=5,this.pl.Bu=!1,this.pl.dM(CommonUIStrings.l_DefaultDialogTitle,null,null))}A8(Q=0){1!==this.wj.state&&this.qJ.create().aR(Q,Ya.a.rL(this.tQ),this.j9b)}EYb(){const Q=this.Ga.appSettings.BreadcrumbFolderUrl;Ca.ULS.sendTraceTag(8194016,216,50,
"Redirecting to OneDrive for business Folder.");ka.a.un(Q,ka.a.ewa(3),void 0,"UploadToHostManager.RedirectToFolder")}DYb(Q){let Da=!1,eb=!1;this.Ga&&(Da=this.Ga.$("SaveACopyIsEnabledForUiHost"),eb=this.Ga.$("UiHostSupportsDocRebootFeatures"));Ca.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",Q,Da,eb);if(Da&&eb){Ca.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Tb=
{};Tb[se.a.quc]="1";Tb[se.a.documentUrl]=Q;Tb[se.a.reason]=mf.a.wvg;m.AFrameworkApplication.qN().execute(Ac=>{Ac.sendMessage(Gg.a.kNb,Tb)})}else Da&&!eb&&m.AFrameworkApplication.lP?ka.a.un(Q,ka.a.ewa(4),void 0,"UploadToHostManager.RedirectToEditUrl"):ka.a.un(Q,ka.a.ewa(3),void 0,"UploadToHostManager.RedirectToEditUrl")}gEa(Q,Da,eb=null){Ca.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.nmh&&!this.nmh()&&this.Gf&&(this.Xd&&(this.l5a=this.Xd.Wf("DialogShown","SaveAsToHostUploadTime")),
this.jeb(),this.j9b=Da,this.tQ=Q,(this.zh=eb)&&"true"===this.zh.SkipSaveToHost?this.$0d():this.Dka())}Dka(){32!==this.ga.Ob(x.a.LZb,1)?(Ca.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.$0d()):this.ga.Pb(x.a.LZb,2,[()=>{Ca.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.$0d()},(Q,Da)=>{Ca.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.A8(Da)}])}k1n(Q){this.Ora();this.s1=!1;if(Q&&Q.data&&Q.data.De)if(({ev:Da}=Za.d(Q.data.De)).returnValue)if(Q=Da,Q.StatusCode!==ki.a.pz&&Q.StatusCode!==ki.a.zfc){Ca.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var Da={};Da.FailureReason=Q.StatusCode.toString();Da.ExtraInfo=Q.ExtraInfo;this.KZa(Da);this.A8(parseInt(Q.ExtraInfo))}else{Ca.ULS.sendTraceTag(8194050,216,50,"UploadToHost execute success.");this.atg();try{Q.NewDocumentUrl&&""!==Q.NewDocumentUrl?
this.DYb(Q.NewDocumentUrl):this.EYb()}catch(eb){Ca.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",eb.toString())}this.qgd()}else Ca.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Mb.a.Erd(Q.data.De)}),this.KZa({["FailureReason"]:"Failed to deserialize response"}),this.A8();else Ca.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),this.KZa({["FailureReason"]:"null response"}),this.A8()}j1n(Q){5!==Q.data.status&&
12!==Q.data.status||this.s1?(Ca.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:Q.data.status,["HttpStatus"]:Q.data.Ie}),this.KZa({["FailureReason"]:Q.data.Ie.toString()}),this.Ora(),this.A8(),this.qgd()):(Ca.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.s1=!0,this.zh&&"true"===this.zh.SkipSaveToHost?this.$0d():this.Dka())}Ora(){this.pl&&(this.pl.close(),this.pl=null)}qgd(){this.l5a&&(this.l5a.stop(),this.l5a=
null)}atg(){this.zh&&"VersionHistory"===this.zh.SaveEntryPoint&&this.ga.Ob(x.a.Bkd,2)}KZa(Q){this.zh&&"VersionHistory"===this.zh.SaveEntryPoint&&this.ga.Pb(x.a.Ote,2,Q)}$0d(){let Q=this.sqa+this.v2a;Q=Xa.a.Ap(Q,"qs",Ya.a.Yi(m.AFrameworkApplication.um));Q=Xa.a.Ap(Q,"n",Ya.a.Yi((new Date).getTime().toString()));Q=Xa.a.Ap(Q,"ov",Ya.a.Yi(this.j9b.toString()));Q=Xa.a.Ap(Q,"fn",Ya.a.Yi(this.tQ));this.zh&&this.zh.FileDownloadUrl&&(Q=Xa.a.Ap(Q,"furl",Ya.a.Yi(this.zh.FileDownloadUrl)));this.Gf.Wj(Q,1,"",{"Content-Type":"application/json; charset=utf-8"},
!1,2,Object(R.a)(this,this.k1n,"onUploadFinished"),Object(R.a)(this,this.j1n,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(f.a)(hl,"UploadToHostManager",null,[1354]);class ug{constructor(){this.W=null;this.fz=()=>{m.AFrameworkApplication.J.$("SaveAsToHostBrsIsEnabled")&&this.W.resolve(1210).Xb()}}get name(){return"Common.App.SaveAsToHost"}init(){m.AFrameworkApplication.J.Uo(this.fz)}uc(Q){this.W=Q;this.W.register(Qd,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as(1211).Sd(()=>
new Qd(m.AFrameworkApplication.J,m.AFrameworkApplication.va)).ha();this.W.register(hl,1212).as(1221).Sd(()=>new hl(m.AFrameworkApplication.va,m.AFrameworkApplication.J,m.AFrameworkApplication.Ee,()=>m.AFrameworkApplication.Sl,()=>(new tj.a).create(),Q.resolve(1211),m.AFrameworkApplication.ua,m.AFrameworkApplication.ua.Vr)).ha();this.W.register(he,1213).as("Common.App.SaveAsToHost.IFileNameDialogFactory").Sd(()=>new he(m.AFrameworkApplication.J,m.AFrameworkApplication.va,m.AFrameworkApplication.ua,
m.AFrameworkApplication.ua.Ib,Q.resolve(1211),Q.resolve(1212))).ha();this.W.register(qd,1210).Sd(()=>new qd(m.AFrameworkApplication.J,Q.resolve(1213),Q.resolve(1212))).ha()}dispose(){}static main(){C.a.instance.Lc(new ug)}}Object(f.a)(ug,"SaveAsToHostPackage",null,[0,1]);class Tj extends zg.StandardDialog{constructor(){super();this.Fd=0;this.Qe(1,CommonUIStrings.l_DialogClose)}aR(Q){this.zy(Q,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)}}Object(f.a)(Tj,"ErrorDialog",
zg.StandardDialog,[1353]);var xk=d(202);class ff extends zg.StandardDialog{constructor(Q,Da,eb){super();this.u6m=Tb=>{0===Tb?(Ca.ULS.sendTraceTag(6590598,216,m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib&&1===m.AFrameworkApplication.ua.Ib.Uk?15:50,"User dismissed SignIn Dialog."),this.hide()):this.dpe()};this.Fmj=()=>{this.Wla&&this.hide();Ca.ULS.sendTraceTag(7143885,216,m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib&&1===m.AFrameworkApplication.ua.Ib.Uk?15:50,"User signed in successfully. Calling Savetocloudstorage action handler");
this.ga.Ob(x.a.wxb,2)};this.ga=Q;this.fya=Da;this.nwa=eb;this.nda=!1;this.Fd=1;this.gY(1);this.Qe(1,CommonUIStrings.l_SignIn);this.Qe(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}nJa(){this.fya.PNh(this.Fmj);this.Ex(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,this.u6m)}Sll(){let Q="2";if(this.nwa)switch(this.nwa.Uk){case 3:Q="0";break;case 2:Q="3";break;case 1:Q="1"}return Q}hide(){this.fya.pxo(this.Fmj);super.hide()}dpe(){var Q=m.AFrameworkApplication.J.$("SignInAspxInWebAppsPortalIsEnabled")?
"/start/signin.aspx":"Signin.aspx";Q=new xk.QueryStringBuilder(Q);Q.ye("prompt","1");Q.ye("cbcxt",this.Sll());m.AFrameworkApplication.rja(Q);ka.a.un(Q.toString(),"LoginWindow",void 0,"SignInDialog")}}Object(f.a)(ff,"SignInDialog",zg.StandardDialog,[1375]);class Oi{constructor(Q,Da,eb){this.ga=Q;this.fya=Da;this.nwa=eb}create(){return new ff(this.ga,this.fya,this.nwa)}}Object(f.a)(Oi,"SignInDialogFactory",null,[1363]);class Ph{constructor(Q,Da,eb,Tb,Ac,hd,Ud){this.sqa=Q;this.tQ=Da;this.B6b=eb;this.SAd=
Tb;this.p4e=Ac;this.v2a=hd;this.zh=Ud}execute(Q,Da){if(!m.AFrameworkApplication.Sl&&m.AFrameworkApplication.Ee){var eb=this.sqa+this.v2a;eb=Xa.a.Ap(eb,"fo",Ya.a.Yi(this.SAd));eb=Xa.a.Ap(eb,"fn",Ya.a.Yi(this.tQ));eb=Xa.a.Ap(eb,"qs",Ya.a.Yi(this.p4e));eb=Xa.a.Ap(eb,"n",Ya.a.Yi((new Date).getTime().toString()));this.zh&&this.zh.FileDownloadUrl&&(eb=Xa.a.Ap(eb,"furl",Ya.a.Yi(this.zh.FileDownloadUrl)));this.B6b&&(eb=Xa.a.Ap(eb,"fnn",Ya.a.Yi(this.B6b)));m.AFrameworkApplication.Ee.Wj(eb,1,"",{"Content-Type":"application/json; charset=utf-8"},
!1,2,Q,Da,null)}}}Object(f.a)(Ph,"SkyDriveUploadCaller",null,[1374]);class ni{constructor(Q){this.Ga=Q;this.lJb=Q.appSettings.SkyDriveUploadWebServiceBase;this.tQ=Q.appSettings.FileName;this.v2a=Q.ib("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(Q,Da,eb){return new Ph(this.lJb,this.tQ,Da,Q,m.AFrameworkApplication.um,this.v2a,eb)}}Object(f.a)(ni,"SkydriveUploadCallerFactory",null,[1361]);class Pf{constructor(){this.W=null}get name(){return"Common.App.SaveToCloudStorage"}init(){m.AFrameworkApplication.J.$("SaveToCloudStorageUIIsEnabled")&&
this.W.resolve(1214).Xb()}dispose(){}uc(Q){this.W=Q;this.W.register(Oi,1209).as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Sd(()=>new Oi(m.AFrameworkApplication.va,Fe.a.instance,m.AFrameworkApplication.ua.Ib)).ha();this.W.register(ni,1204).as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Sd(()=>new ni(m.AFrameworkApplication.J)).ha();this.W.register(Dj,1214).Sd(()=>new Dj(Q.resolve(1215),Q.resolve(1207),m.AFrameworkApplication.J,m.AFrameworkApplication.ua.Vr)).ha();this.W.register(Th,
1216).Sd(()=>new Th(Q.resolve(1204),()=>(new tj.a).create(),()=>new Tj,m.AFrameworkApplication.ua,m.AFrameworkApplication.ua.Vr)).ha();this.W.register(Mi,1215).Sd(()=>new Mi(Q.resolve(1209),Fe.a.instance,Q.resolve(1216),m.AFrameworkApplication.J,m.AFrameworkApplication.O6,()=>new Tj)).ha()}static main(){C.a.instance.Lc(new Pf)}}Object(f.a)(Pf,"PackageManager",null,[0,1]);class Yh extends zg.StandardDialog{constructor(){super();this.Fd=0;this.Qe(1,CommonUIStrings.l_DialogClose)}aR(Q,Da){this.lfi(Q,
Da,bh.a.BHo)}lfi(Q,Da,eb){Ca.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",eb);this.zy(eb,Q,Da,null)}ixf(Q,Da){Ca.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.zy(bh.a.DHo,Q,Da,null,!0)}}Object(f.a)(Yh,"ErrorDialog",zg.StandardDialog,[1376]);class Qh{static get kh(){return a.a.Ry(Qh.Hn,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}Qh.Hn="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(f.a)(Qh,"FileNameDialogHtml",null,[]);var fk=d(93);class km extends kf{constructor(Q,Da,eb,Tb,Ac,hd,Ud,Ee){super(Q,Da,eb,Tb,Ac,hd,Ee);this.Cib=this.z6e=this.lT=null;this.Xfl=CommonUIStrings.l_SaveToAnotherFolder;this.kh=Qh.kh;this.Ng="FileNameDialog-SaveToSharePoint";this.mOc=Ud;this.wFk=Ee}nJa(Q){const Da=Ya.a.rL(m.AFrameworkApplication.Ft.yA),eb=m.AFrameworkApplication.breadcrumbFolderName,Tb=m.AFrameworkApplication.breadcrumbBrandName,Ac={["txtFileName"]:Q||Da};let hd=CommonUIStrings.L_SaveAs;
2===m.AFrameworkApplication.ua.Ib.Uk&&(hd=CommonUIStrings.L_SaveACopy);this.mi(hd,Object(R.a)(this,this.W1d,"fileNameDialogHandler"),Ac);this.Nei(Q,Da);this.ewf.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");m.AFrameworkApplication.J.$("HideSaveToAnotherFolderButtonforUIHost")||(this.lT=document.getElementById("anotherFolder"),Q=document.getElementById("folderLocation"),this.z6e=ie.a.NQh(Q,this.lT,"anotherFolderDescribedBy"),this.lT.className=
"WACButton WACDialogButtonNormal",Q=!1,eb&&eb.length?(this.uLh(this.lT,this.z6e,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Tb,eb)),Q=this.TSk(Tb,eb)):this.uLh(this.lT,this.z6e,CommonUIStrings.l_CurrentOnlineFolder),this.RUk(this.lT),this.VSk(this.lT),Q?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.lT,"SaveToAnotherLocationTwo"),Ca.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.lT,
"SaveToAnotherLocationOne"),ba.a.addHandler(this.lT,U.a.click,Object(R.a)(this,this.Nfg,"onSaveToAnotherLocationClick")),ba.a.addHandler(this.lT,U.a.hj,Object(R.a)(this,this.jmj,"onSaveToAnotherLocationKeyDown")))}TSk(Q,Da){let eb;eb=!1;const Tb=document.getElementById("currentLocation");Tb.innerText="";const Ac=this.QAi(Tb,Q),hd=this.QAi(Tb,Da);let Ud=255,Ee=255;255<Ac+hd&&(Ud=Math.max(238,408-Ac),Ee=Math.max(170,408-hd),eb=!0);this.kXk(Tb,Q,Ee,Da,Ud);return eb}QAi(Q,Da){const eb=document.createElement("div");
eb.innerText=Da;eb.style.visibility="hidden";Q.appendChild(eb);Da=eb.clientWidth;Q.removeChild(eb);return Da}kXk(Q,Da,eb,Tb,Ac){Da&&(this.tLh(Q,Da,eb),this.bXk(Q));Tb&&this.tLh(Q,Tb,Ac)}tLh(Q,Da,eb){const Tb=document.createElement("div");Tb.innerText=Da;Tb.title=Da;Tb.className="SaveToAnotherFolderBreadcrumb";Tb.style.maxWidth=eb.toString()+"px";Q.appendChild(Tb)}bXk(Q){const Da=document.createElement("span");Da.id="FolderSeparator";const eb=document.createElementNS("http://www.w3.org/2000/svg","svg");
eb.setAttribute("class","SeparatorCaret");const Tb=document.createElementNS("http://www.w3.org/2000/svg","polygon");Tb.setAttribute("points","1 4 1 11 5 7.5");eb.appendChild(Tb);Da.appendChild(eb);Q.appendChild(Da)}uLh(Q,Da,eb){eb=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,eb);Da&&(Da.innerText=eb);Q.tabIndex=0;Q.setAttribute(ie.a.Ph,ie.a.K$)}VSk(Q){const Da=document.createElement("span");Da.id="anotherFolderText";Da.innerText=this.Xfl;Da.className="AnotherFolderTextSpan";
Q.appendChild(Da)}RUk(Q){const Da=document.createElement("span");Da.className="cui-img-cont-float cui-img-16by16 ";this.Cib=document.createElementNS("http://www.w3.org/2000/svg","svg");this.Cib.setAttribute("class","FolderIconSVG");const eb=document.createElementNS("http://www.w3.org/2000/svg","path");eb.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.Cib.appendChild(eb);Da.appendChild(this.Cib);Q.appendChild(Da)}jmj(Q){!Q||
Q.keyCode!==fk.a.Nu&&Q.keyCode!==fk.a.itd||this.Nfg(Q)}Nfg(){if(this.H9){const Q=Ya.a.Uka(m.AFrameworkApplication.fileName);let Da=this.H9.value;this.hide();Da&&""!==Da&&""!==Q||1===this.ua.state?(""!==Q&&(Da+=Q),this.fmi(Da)?this.qJ.create().aR(1,Da,!1):this.mOc.start(Da,this.wFk)):this.qJ.create().aR(2,Da,!1)}}ull(Q){this.lT&&this.Cib&&(Q?(this.lT.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.lT,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.Cib,"DisabledFolderIconSVG")):(this.lT.tabIndex=
-1,Sys.UI.DomElement.containsCssClass(this.lT,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.Cib,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.lT,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.Cib,"DisabledFolderIconSVG"))))}xQf(){super.xQf();this.ull(!!this.H9&&""!==this.H9.value)}dispose(){this.lT&&(ba.a.removeHandler(this.lT,U.a.click,Object(R.a)(this,this.Nfg,"onSaveToAnotherLocationClick")),ba.a.removeHandler(this.lT,U.a.hj,Object(R.a)(this,this.jmj,
"onSaveToAnotherLocationKeyDown")),this.lT=null);super.dispose()}}Object(f.a)(km,"FileNameDialog",kf,[1406]);var gk=d(513),Ij=d(276),Wl=d(1462),lm=d(1672);class il{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(f.a)(il,"SaveAsDialogInput",null,[]);class kn{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(f.a)(kn,"SaveLocation",null,[]);var Jl=d(95);class Zm{constructor(Q,Da,eb,Tb,Ac,hd,Ud,Ee,Me){this.rZe=
null;this.tQ="";this.bnm=()=>{const Kf=new kb.a;Kf.add(this.Ylm());const th=this.kIm();th&&Kf.addRange(th);return Object.assign(new il,{enableMoreLocations:!m.AFrameworkApplication.J.$("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.tQ,extension:Ya.a.Uka(this.dO.yA),saveLocations:Kf.toArray(),scenario:"SaveToSharePoint"})};this.mOc=Q;this.qJ=Da;this.zh=Me;this.m5a=eb;this.wj=Ac;this.dO=Tb;this.WIb=Ud;this.Q$b=Ee;hd&&(this.rZe=new tb.a(()=>new Wl.a(hd.value,null)))}Ylm(){const Q=new gk.a(Ij.a.th());
Q.Z("type","currentHost");return Object.assign(new kn,{folderName:this.dO.breadcrumbFolderName,friendlyPath:this.dO.breadcrumbBrandName,properties:Q})}ton(Q){return!!Q&&"ClassicMru"===Q.type&&!!Q.service_info&&!!Q.service_info.service_id&&-1!==Q.service_info.service_id.indexOf("SHAREPOINT")}kIm(){if(!this.rZe||!this.WIb)return null;var Q=this.rZe.value.zR("SaveAsToSharePointDialog",!1);if(!Q||3!==Q.state||!Q.Pdj)return null;Q=Q.Pdj;const Da=new kb.a;let eb=0,Tb=0;for(var Ac=0;Ac<Q.length;Ac++){var hd=
Q[Ac];if(!this.ton(hd))continue;eb++;if(!hd.sharepoint_info)continue;const Ud=hd.url,Ee=hd.sharepoint_info.site_url,Me=hd.title;hd=lm.b(hd,m.AFrameworkApplication.isRtl);if(!(Ud&&Ee&&Me&&hd))continue;Tb++;const Kf=new gk.a(Ij.a.th());Kf.Z("type","SharePoint");Kf.Z("siteUrl",Ee);Kf.Z("folderUrl",Ud);Tb++;Da.add(Object.assign(new kn,{folderName:Me,friendlyPath:hd,properties:Kf}))}Ac=new Map;Ac.set("NumPlaces",Q.length.toString());Ac.set("NumSharepointPlaces",eb.toString());Ac.set("placesWithMetadata",
Tb.toString());ua.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",Ac);0<eb&&(Tb?.5>1*Tb/eb&&ua.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):ua.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return Da}VHf(){const Q={};Q.inputPropsCallback=this.bnm;return Q}nJa(Q){this.tQ=Q;this.tQ||(this.tQ=String.format(CommonUIStrings.l_SaveACopy_Filename,Ya.a.rL(this.dO.yA)));
Q={["id"]:"SaveAsDialog",["bodyControls"]:this.VHf()};let Da=CommonUIStrings.L_SaveAs;2===this.wj.Ib.Uk&&(Da=CommonUIStrings.L_SaveACopy);const eb=new a.a(!1,!1,!0);eb.Fd=1;eb.Ng="SaveAsDialog";eb.Qe(1,CommonUIStrings.l_SaveButtonLabel);eb.mi(Da,Object(R.a)(this,this.xHo,"saveAsDialogHandler"),Q)}F4o(Q,Da){Q&&""!==Q&&""!==Da||1===this.wj.state?this.son()?this.Wxn(Q,Da):(""!==Da&&(Q+=Da),this.mOc.start(Q,this.zh)):(Ca.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),
this.qJ.create().aR(2,Q,!1))}Wxn(Q,Da){ua.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const eb=this.Q$b.ksf(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.Q$b.y5d(eb).then(Tb=>{if(Tb&&0<Tb.length){const Ac=Tb[0][se.a.M8n];Tb=Tb[0][se.a.N8n];if(""!==Ac&&""!==Tb)this.WIb.gEa(Tb,Q+Da,Ac,this.zh),ua.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.qJ.create().aR(0,Q,!1);const hd=Tf.a.KG();hd&&(hd.set("SiteUrlAvailable",
""===Ac?"false":"true"),hd.set("FolderUrlAvailable",""===Tb?"false":"true"));ua.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new Jl.a,{extendedProperties:hd}))}}else this.qJ.create().aR(0,Q,!1),ua.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Tb=>{"Canceled"===Tb?((Tb=Tf.a.KG())&&Tb.set("IsCanceled","true"),ua.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new Jl.a,{extendedProperties:Tb}))):
ua.Health.instance.recordKpiFailure("SaveACopySFP",Tb,!1,!1,null)})}son(){return this.Q$b?this.Q$b.G_f():(Ca.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}xHo(Q,Da){if(Da&&1===Q){Q=Da.fileName;var eb=Ya.a.Uka(this.dO.yA);Da.moreLocationsSelected&&this.F4o(Q,eb);if(Da.locationCallback){var Tb=Da.locationCallback();Tb?Tb.properties&&"currentHost"===Tb.properties.K("type")?this.m5a.gEa(Q+eb,!1,this.zh):Tb.properties&&"SharePoint"===Tb.properties.K("type")?(Da=Tb.properties.K("siteUrl"),
Tb=Tb.properties.K("folderUrl"),this.WIb.gEa(Tb,Q+eb,Da,this.zh)):Ca.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):Ca.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else Ca.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(f.a)(Zm,"ReactSaveAsDialog",null,[1406]);class bl{constructor(Q,Da,eb,Tb,Ac,hd,Ud,Ee=null,Me=null,Kf=null){this.ga=Da;this.Ga=Q;this.nwa=Tb;this.m5a=hd;this.qJ=Ac;this.wj=eb;this.XBh=Ud;this.dBk=Ee;this.WIb=Me;this.Q$b=
Kf}create(Q){return this.wj&&this.wj.Ib.cH?new Zm(this.XBh,this.qJ,this.m5a,m.AFrameworkApplication.Ft,this.wj,this.dBk,this.WIb,this.Q$b,Q):new km(this.Ga,this.ga,this.wj,this.nwa,this.qJ,this.m5a,this.XBh,Q)}}Object(f.a)(bl,"FileNameDialogFactory",null,[1373]);class $m{constructor(Q,Da,eb,Tb){this.hx=this.ZLc=null;this.NPb=Ac=>{this.hx||3!==Ac.state||(this.hx=Ac)};this.jDb=Q;this.wj=eb;this.DGk=Tb;this.s2a=new tb.a(()=>new Wl.a(Da.value,this.NPb))}get Enj(){this.ZLc||(this.s2a.value.zR("Save As",
!0),this.hx&&this.hx.Dga&&this.hx.Dga.length&&(this.ZLc=this.$zm(this.hx.Dga)));return this.ZLc}start(Q){if(!this.Enj)if(m.AFrameworkApplication.breadcrumbFolderUrl&&m.AFrameworkApplication.breadcrumbFolderUrl.length)this.ZLc=m.AFrameworkApplication.breadcrumbFolderUrl;else return Ca.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.hx),!1;const Da=this.DGk();Da.U4o();const eb=
Da.UCm();if(!eb)return Ca.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.jDb.start((Tb,Ac)=>{Da.hide();Q(Tb,Ac)},()=>{this.onCancel(Da)},eb,this.ZLc);return!0}onCancel(Q){Q.hide();Ca.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}$zm(Q){Q=Q.toLowerCase();Q.endsWith("/")||(Q+="/");const Da=Q.indexOf("/documents/");return-1!==Da?Q.substring(0,Da+1)+"_layouts/15/onedrive.aspx":""}}Object(f.a)($m,"OneDriveFilePickerHelper",null,
[1367]);class Tk extends a.a{constructor(){super()}U4o(){this.XEc="FilePickerDialog";this.kh="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.Ng="PickerDialog-MsoSp";this.showDialog("",null)}UCm(){return document.getElementById("FilePickerDiv")}LN(){}Iga(){}}Object(f.a)(Tk,"PickerDialog",a.a,[1366]);class zm{constructor(Q,Da,eb,Tb,Ac,hd,Ud){this.Ga=Q;this.pRe=eb;this.ga=Da;this.mOc=Tb;this.jDb=Ac;this.YLc=hd;this.Tnk=Ud}Xb(){const Q=this.jDb.Vjc();Q?zb.a.kta||this.Ga.$("SaveToSharePointOnDemandDownloadJsIsEnabled")?
this.ga.fb(x.a.Dvc,z.a.frame,Object(R.a)(this,this.NHj,"saveToSharePointActionDispatcher"),64):(Q.Vab.continueWith(Da=>{Da.fj&&this.jDb.Eeg(Da)}),this.BTd()):Ca.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}BTd(){ad.a.Cse(Object(R.a)(this,this.NHj,"saveToSharePointActionDispatcher"));ad.a.GZc([new Eh.a(x.a.Dvc,z.a.frame,0)],this.jDb.Vjc())}get Moc(){return this.Ga.$("SaveToAnotherFolderBrsIsEnabled")}get gZh(){return this.Ga.$("UserCanWriteRelative")}NHj(Q,
Da,eb,Tb,Ac){return Da.contextId!==z.a.frame||Q!==x.a.Dvc?2:this.Moc&&(this.YLc.Enj||this.gZh)?1===eb?Ce.SessionStatusManager.instance.Hk||m.AFrameworkApplication.nta?8:this.Tnk()?32:8:2===eb?(Ca.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(Ac&&Ac.SaveEntryPoint&&"VersionHistory"===Ac.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.gZh?(Ca.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.pRe.create(Ac).nJa(null)):(Ca.ULS.sendTraceTag(24524225,
216,50,"No permission save to current folder, show Picker to save to another folder."),this.mOc.start(null,Ac)),32):8:8}}Object(f.a)(zm,"SaveToSharePointActor",null,[]);class yk{constructor(Q,Da,eb,Tb){this.zh=this.ruh=null;this.WIb=Q;this.qJ=Da;this.YLc=eb;this.wj=Tb}start(Q,Da){Ca.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.ruh=Q;this.zh=Da;this.YLc.start((eb,Tb)=>{this.processResponse(eb,Tb)})||this.ECg()}processResponse(Q,Da){if(Q)this.sE(Da);else this.onFailure(Da)}ECg(){1!==
this.wj.state&&this.qJ().ixf(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}sE(Q){Ca.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(Q&&Q.data&&Q.data.value&&Q.data.value.length&&Q.data.value[0].sharePoint){const Da=Q.data.value[0].sharePoint.url;Q=Q.data.value[0].sharePoint.listUrl;let eb=null;if(Da&&(eb=Q?this.xIm(Q):this.wIm(Da))){this.WIb.gEa(Da,this.ruh,eb,this.zh);return}Ca.ULS.sendTraceTag(25180164,
216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!Da,!eb)}Ca.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.ECg()}wIm(Q){Q.endsWith("/")||(Q+="/");let Da=0;for(let eb=0;eb<Q.length;eb++)if("/"===Q.charAt(eb)&&5===++Da)return Q.substr(0,eb);return null}xIm(Q){Q.endsWith("/")&&(Q=Q.substring(0,Q.length-1));const Da=Q.lastIndexOf("/");return-1!==Da?Q.substring(0,Da):null}onFailure(Q){Ca.ULS.sendTraceTag(23881888,216,
10,"Picker failure Callback called.");Q&&Q.error?Ca.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",Q.error.errorCode,Q.error.message):Ca.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.ECg()}}Object(f.a)(yk,"SaveToSharePointManager",null,[1365]);class Kl{constructor(Q,Da,eb,Tb,Ac,hd,Ud,Ee){this.sqa=Q;this.tQ=Da;this.B6b=Tb;this.p4e=hd;this.PQa=eb;this.WLk=Ac;this.v2a=Ud;this.zh=Ee}execute(Q,Da){if(!m.AFrameworkApplication.Sl&&
m.AFrameworkApplication.Ee){var eb=this.sqa+this.v2a;eb=Xa.a.Ap(eb,"fu",Ya.a.Yi(this.PQa));eb=Xa.a.Ap(eb,"su",Ya.a.Yi(this.WLk));eb=Xa.a.Ap(eb,"fn",Ya.a.Yi(this.tQ));eb=Xa.a.Ap(eb,"n",Ya.a.Yi((new Date).getTime().toString()));this.zh&&this.zh.FileDownloadUrl&&(eb=Xa.a.Ap(eb,"furl",Ya.a.Yi(this.zh.FileDownloadUrl)));eb=eb+"&"+this.p4e;this.B6b&&this.B6b.length?eb=Xa.a.Ap(eb,"fnn",Ya.a.Yi(this.B6b)):Ca.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");Ca.ULS.sendTraceTag(23881920,216,
50,"Trying send SharePointSaveAsHandler.ashx request.");m.AFrameworkApplication.Ee.Wj(eb,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Q,Da,null,void 0,void 0,void 0,void 0,"9")}}}Object(f.a)(Kl,"SharePointSaveAsCaller",null,[1383]);class li{constructor(Q){this.lJb=Q.appSettings.SaveAsToHostWebServiceBase;this.tQ=Q.appSettings.FileName;this.v2a=Q.ib("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(Q,Da,eb,Tb){return new Kl(this.lJb,this.tQ,Q,Da,eb,m.AFrameworkApplication.um,
this.v2a,Tb)}}Object(f.a)(li,"SharePointUploadCallerFactory",null,[1364]);var Tn=d(1244);class Uk{constructor(Q,Da,eb,Tb,Ac){this.pl=this.wDc=null;this.nJe=!1;this.t6e=this.PQa=null;this.dbf=Da;this.W3a=eb;this.qJ=Tb;this.wj=Ac;this.ga=Q}gEa(Q,Da,eb,Tb){this.nJe=!1;Ca.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.jeb();this.PQa=Q;Tb&&Tb.SaveEntryPoint&&(this.t6e=Tb.SaveEntryPoint);this.wDc=this.dbf.create(Q,Da,eb,Tb);Tb&&"true"===Tb.SkipSaveToHost?
this.Dka():this.dam()}dam(){const Q=()=>{Ca.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.Dka()};32!==this.ga.Pb(x.a.LZb,2,[()=>{Ca.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.Dka()},Q])&&Q()}Dka(){Ca.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.wDc.execute(Object(R.a)(this,this.n_n,"onSaveToSharePointUploadFinished"),Object(R.a)(this,this.m_n,
"onSaveToSharePointUploadFailed"))}n_n(Q){if(Q&&Q.data&&Q.data.De){var Da;if(({ev:Da}=Za.d(Q.data.De)).returnValue)if(Da.StatusCode!==ki.a.pz&&Da.StatusCode!==ki.a.zfc)Ca.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",Q.data.status,Da.StatusCode),Da.StatusCode!==ki.a.etg&&this.Sfi(Q.data.status)||(this.KZa(Da.StatusCode.toString()),this.K3o(Da.StatusCode));else{Ca.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");
this.atg();try{Da.NewDocumentUrl?this.DYb(Da.NewDocumentUrl):this.EYb()}catch(eb){Ca.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",eb.toString())}}else Ca.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Mb.a.Erd(Q.data.De)}),this.a_d()||(this.KZa("Failed to deserialize response"),this.Xod())}else Ca.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.a_d()||(this.KZa("Unknown"),this.Xod())}m_n(Q){Q&&Q.data?this.Sfi(Q.data.status)||
(Ca.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.KZa(Tn.a[Q.data.status]),this.Xod()):(Ca.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.a_d()||(this.KZa("Unknown"),this.Xod()))}a_d(){if(!this.nJe)return Ca.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.nJe=!0,this.Dka(),!0;Ca.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}Sfi(Q){Ca.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",
Q);return this.a_d()}EYb(){Ca.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");ka.a.un(this.PQa,ka.a.ewa(3),void 0,"UploadToSharePointManager.RedirectToFolder")}DYb(Q){let Da=!1,eb=!1;m.AFrameworkApplication.J&&(Da=m.AFrameworkApplication.J.$("SaveACopyIsEnabledForUiHost"),eb=m.AFrameworkApplication.J.$("UiHostSupportsDocRebootFeatures"));Ca.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",Q,Da);if(Da&&eb){Ca.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");
const Tb={};Tb[se.a.quc]="1";Tb[se.a.documentUrl]=Q;Tb[se.a.reason]=mf.a.wvg;m.AFrameworkApplication.qN().execute(Ac=>{Ac.sendMessage(Gg.a.kNb,Tb)})}else ka.a.un(Q,ka.a.ewa(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}jeb(){this.wj&&1===this.wj.state||(this.pl=this.W3a(),this.pl.message=CommonUIStrings.l_CommentProgressTooltip,this.pl.Fd=5,this.pl.Bu=!1,this.pl.dM(CommonUIStrings.l_DefaultDialogTitle,null,null))}Ora(){this.pl&&(this.pl.close(),this.pl=null)}Xod(){this.mq(CommonUIStrings.l_SaveFailedDialogTitle,
CommonUIStrings.l_FailToSaveFile)}G4o(){this.mq(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}Q3o(){const Q=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.mq(CommonUIStrings.l_SaveAsFileTooLargeTitle,Q,bh.a.yHo)}mq(Q,Da,eb=bh.a.CHo){Ca.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",Q,Da);this.Ora();1!==this.wj.state&&this.qJ().lfi(Q,Da,eb)}K3o(Q){Ca.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",
Q);switch(Q){case ki.a.qDe:this.G4o();break;case ki.a.etg:this.Q3o();break;default:this.Xod()}}atg(){"VersionHistory"===this.t6e&&this.ga.Ob(x.a.Bkd,2)}KZa(Q){"VersionHistory"===this.t6e&&this.ga.Pb(x.a.Ote,2,{["FailureReason"]:Q})}}Object(f.a)(Uk,"UploadToSharePointManager",null,[1311]);var zk=d(534),Ik=d(133);class ig{constructor(){this.Ikb=this.a0e=this.S_e=this.W=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}uc(Q){this.W=Q;this.S_e=zk.a.Yp(Q.Ra(804));this.a0e=zk.a.Yp(Q.Ra(805));
this.Ikb=zk.a.Yp(Q.Ra(1027));Ik.Task.WAA.call(null,this.S_e,this.a0e,this.Ikb).continueWith(()=>{this.upo()})}upo(){this.W.register(li,1217).as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Sd(()=>new li(m.AFrameworkApplication.J)).ha();this.W.register(Uk,1218).as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Sd(()=>new Uk(m.AFrameworkApplication.va,this.W.resolve(1217),()=>(new tj.a).create(),()=>new Yh,m.AFrameworkApplication.ua)).ha();this.W.register(yk,"Common.App.SaveToSharePoint.SaveToSharePointManager").as(1202).Sd(()=>
new yk(this.W.resolve(1218),()=>new Yh,this.W.resolve(1219),m.AFrameworkApplication.ua)).ha();this.W.register($m,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as(1219).Sd(()=>new $m(this.W.resolve(1220),new tb.a(()=>this.S_e.result),m.AFrameworkApplication.ua,()=>new Tk)).ha();this.W.register(bl,1222).Sd(()=>new bl(m.AFrameworkApplication.J,m.AFrameworkApplication.va,m.AFrameworkApplication.ua,m.AFrameworkApplication.ua.Ib,this.W.resolve(1211),this.W.resolve(1221),this.W.resolve(1202),new tb.a(()=>
this.a0e.result),this.W.resolve(1218),this.Ikb?this.Ikb.result:null)).ha();this.W.register(zm,1223).Sd(()=>new zm(m.AFrameworkApplication.J,m.AFrameworkApplication.va,this.W.resolve(1222),this.W.resolve(1202),this.W.resolve(1220),this.W.resolve(1219),()=>m.AFrameworkApplication.ua.pjl)).ha();m.AFrameworkApplication.J.$("SaveToAnotherFolderBrsIsEnabled")&&this.W.resolve(1223).Xb()}static main(){C.a.instance.Lc(new ig)}}Object(f.a)(ig,"PackageManager",null,[0,1]);class ul{}Object(f.a)(ul,"StringDifference",
null,[1377]);class pe{constructor(Q,Da){this.charCode=Q;this.description=Da}}Object(f.a)(pe,"UBTableEntry",null,[]);class Ln{}new pe(8,"C0 Controls 1");new pe(9,"Horizontal tab (HT)");new pe(10,"Line feed (LF)");new pe(12,"C0 Controls 2");new pe(13,"Carriage return (CR)");new pe(31,"C0 Controls 3");new pe(32,"Space");new pe(47,"ASCII Punctuation and Symbols 1");new pe(57,"ASCII Digits");new pe(64,"ASCII Punctuation and Symbols 2");new pe(90,"Uppercase Latin Alphabet");new pe(96,"ASCII Punctuation and Symbols 3");
new pe(122,"Lowercase Latin Alphabet");new pe(127,"U+0000..U+007F Basic Latin");new pe(159,"C1 Controls");new pe(160,"NB Space");new pe(191,"Latin-1 Punctuation and Symbols");new pe(255,"U+0080..U+00FF Latin-1 Supplement");new pe(383,"U+0100..U+017F Latin Extended-A");new pe(591,"U+0180..U+024F Latin Extended-B");new pe(687,"U+0250..U+02AF IPA Extensions");new pe(767,"U+02B0..U+02FF Spacing Modifier Letters");new pe(879,"U+0300..U+036F Combining Diacritical Marks");new pe(1023,"U+0370..U+03FF Greek and Coptic");
new pe(1279,"U+0400..U+04FF Cyrillic");new pe(1327,"U+0500..U+052F Cyrillic Supplement");new pe(1423,"U+0530..U+058F Armenian");new pe(1535,"U+0590..U+05FF Hebrew");new pe(1791,"U+0600..U+06FF Arabic");new pe(1871,"U+0700..U+074F Syriac");new pe(1919,"U+0750..U+077F Arabic Supplement");new pe(1983,"U+0780..U+07BF Thaana");new pe(2047,"U+07C0..U+07FF NKo");new pe(2111,"U+0800..U+083F Samaritan");new pe(2143,"U+0840..U+085F Mandaic");new pe(2303,"U+08A0..U+08FF Arabic Extended-A");new pe(2431,"U+0900..U+097F Devanagari");
new pe(2559,"U+0980..U+09FF Bengali");new pe(2687,"U+0A00..U+0A7F Gurmukhi");new pe(2815,"U+0A80..U+0AFF Gujarati");new pe(2943,"U+0B00..U+0B7F Oriya");new pe(3071,"U+0B80..U+0BFF Tamil");new pe(3199,"U+0C00..U+0C7F Telugu");new pe(3327,"U+0C80..U+0CFF Kannada");new pe(3455,"U+0D00..U+0D7F Malayalam");new pe(3583,"U+0D80..U+0DFF Sinhala");new pe(3711,"U+0E00..U+0E7F Thai");new pe(3839,"U+0E80..U+0EFF Lao");new pe(4095,"U+0F00..U+0FFF Tibetan");new pe(4255,"U+1000..U+109F Myanmar");new pe(4351,"U+10A0..U+10FF Georgian");
new pe(4607,"U+1100..U+11FF Hangul Jamo");new pe(4991,"U+1200..U+137F Ethiopic");new pe(5023,"U+1380..U+139F Ethiopic Supplement");new pe(5119,"U+13A0..U+13FF Cherokee");new pe(5759,"U+1400..U+167F Unified Canadian Aboriginal Syllabics");new pe(5791,"U+1680..U+169F Ogham");new pe(5887,"U+16A0..U+16FF Runic");new pe(5919,"U+1700..U+171F Tagalog");new pe(5951,"U+1720..U+173F Hanunoo");new pe(5983,"U+1740..U+175F Buhid");new pe(6015,"U+1760..U+177F Tagbanwa");new pe(6143,"U+1780..U+17FF Khmer");new pe(6319,
"U+1800..U+18AF Mongolian");new pe(6399,"U+18B0..U+18FF Unified Canadian Aboriginal Syllabics Extended");new pe(6479,"U+1900..U+194F Limbu");new pe(6527,"U+1950..U+197F Tai Le");new pe(6623,"U+1980..U+19DF New Tai Lue");new pe(6655,"U+19E0..U+19FF Khmer Symbols");new pe(6687,"U+1A00..U+1A1F Buginese");new pe(6831,"U+1A20..U+1AAF Tai Tham");new pe(7039,"U+1B00..U+1B7F Balinese");new pe(7103,"U+1B80..U+1BBF Sundanese");new pe(7167,"U+1BC0..U+1BFF Batak");new pe(7247,"U+1C00..U+1C4F Lepcha");new pe(7295,
"U+1C50..U+1C7F Ol Chiki");new pe(7375,"U+1CC0..U+1CCF Sundanese Supplement");new pe(7423,"U+1CD0..U+1CFF Vedic Extensions");new pe(7551,"U+1D00..U+1D7F Phonetic Extensions");new pe(7615,"U+1D80..U+1DBF Phonetic Extensions Supplement");new pe(7679,"U+1DC0..U+1DFF Combining Diacritical Marks Supplement");new pe(7935,"U+1E00..U+1EFF Latin Extended Additional");new pe(8191,"U+1F00..U+1FFF Greek Extended");new pe(8303,"U+2000..U+206F General Punctuation");new pe(8351,"U+2070..U+209F Superscripts and Subscripts");
new pe(8399,"U+20A0..U+20CF Currency Symbols");new pe(8447,"U+20D0..U+20FF Combining Diacritical Marks for Symbols");new pe(8527,"U+2100..U+214F Letterlike Symbols");new pe(8591,"U+2150..U+218F Number Forms");new pe(8703,"U+2190..U+21FF Arrows");new pe(8959,"U+2200..U+22FF Mathematical Operators");new pe(9215,"U+2300..U+23FF Miscellaneous Technical");new pe(9279,"U+2400..U+243F Control Pictures");new pe(9311,"U+2440..U+245F Optical Character Recognition");new pe(9471,"U+2460..U+24FF Enclosed Alphanumerics");
new pe(9599,"U+2500..U+257F Box Drawing");new pe(9631,"U+2580..U+259F Block Elements");new pe(9727,"U+25A0..U+25FF Geometric Shapes");new pe(9983,"U+2600..U+26FF Miscellaneous Symbols");new pe(10175,"U+2700..U+27BF Dingbats");new pe(10223,"U+27C0..U+27EF Miscellaneous Mathematical Symbols-A");new pe(10239,"U+27F0..U+27FF Supplemental Arrows-A");new pe(10495,"U+2800..U+28FF Braille Patterns");new pe(10623,"U+2900..U+297F Supplemental Arrows-B");new pe(10751,"U+2980..U+29FF Miscellaneous Mathematical Symbols-B");
new pe(11007,"U+2A00..U+2AFF Supplemental Mathematical Operators");new pe(11263,"U+2B00..U+2BFF Miscellaneous Symbols and Arrows");new pe(11359,"U+2C00..U+2C5F Glagolitic");new pe(11391,"U+2C60..U+2C7F Latin Extended-C");new pe(11519,"U+2C80..U+2CFF Coptic");new pe(11567,"U+2D00..U+2D2F Georgian Supplement");new pe(11647,"U+2D30..U+2D7F Tifinagh");new pe(11743,"U+2D80..U+2DDF Ethiopic Extended");new pe(11775,"U+2DE0..U+2DFF Cyrillic Extended-A");new pe(11903,"U+2E00..U+2E7F Supplemental Punctuation");
new pe(12031,"U+2E80..U+2EFF CJK Radicals Supplement");new pe(12255,"U+2F00..U+2FDF Kangxi Radicals");new pe(12287,"U+2FF0..U+2FFF Ideographic Description Characters");new pe(12351,"U+3000..U+303F CJK Symbols and Punctuation");new pe(12447,"U+3040..U+309F Hiragana");new pe(12543,"U+30A0..U+30FF Katakana");new pe(12591,"U+3100..U+312F Bopomofo");new pe(12687,"U+3130..U+318F Hangul Compatibility Jamo");new pe(12703,"U+3190..U+319F Kanbun");new pe(12735,"U+31A0..U+31BF Bopomofo Extended");new pe(12783,
"U+31C0..U+31EF CJK Strokes");new pe(12799,"U+31F0..U+31FF Katakana Phonetic Extensions");new pe(13055,"U+3200..U+32FF Enclosed CJK Letters and Months");new pe(13311,"U+3300..U+33FF CJK Compatibility");new pe(19903,"U+3400..U+4DBF CJK Unified Ideographs Extension A");new pe(19967,"U+4DC0..U+4DFF Yijing Hexagram Symbols");new pe(40959,"U+4E00..U+9FFF CJK Unified Ideographs");new pe(42127,"U+A000..U+A48F Yi Syllables");new pe(42191,"U+A490..U+A4CF Yi Radicals");new pe(42239,"U+A4D0..U+A4FF Lisu");new pe(42559,
"U+A500..U+A63F Vai");new pe(42655,"U+A640..U+A69F Cyrillic Extended-B");new pe(42751,"U+A6A0..U+A6FF Bamum");new pe(42783,"U+A700..U+A71F Modifier Tone Letters");new pe(43007,"U+A720..U+A7FF Latin Extended-D");new pe(43055,"U+A800..U+A82F Syloti Nagri");new pe(43071,"U+A830..U+A83F Common Indic Number Forms");new pe(43135,"U+A840..U+A87F Phags-pa");new pe(43231,"U+A880..U+A8DF Saurashtra");new pe(43263,"U+A8E0..U+A8FF Devanagari Extended");new pe(43311,"U+A900..U+A92F Kayah Li");new pe(43359,"U+A930..U+A95F Rejang");
new pe(43391,"U+A960..U+A97F Hangul Jamo Extended-A");new pe(43487,"U+A980..U+A9DF Javanese");new pe(43615,"U+AA00..U+AA5F Cham");new pe(43647,"U+AA60..U+AA7F Myanmar Extended-A");new pe(43743,"U+AA80..U+AADF Tai Viet");new pe(43775,"U+AAE0..U+AAFF Meetei Mayek Extensions");new pe(43823,"U+AB00..U+AB2F Ethiopic Extended-A");new pe(44031,"U+ABC0..U+ABFF Meetei Mayek");new pe(55215,"U+AC00..U+D7AF Hangul Syllables");new pe(55295,"U+D7B0..U+D7FF Hangul Jamo Extended-B");new pe(56191,"U+D800..U+DB7F High Surrogates");
new pe(56319,"U+DB80..U+DBFF High Private Use Surrogates");new pe(57343,"U+DC00..U+DFFF Low Surrogates");new pe(63743,"U+E000..U+F8FF Private Use Area");new pe(64255,"U+F900..U+FAFF CJK Compatibility Ideographs");new pe(64335,"U+FB00..U+FB4F Alphabetic Presentation Forms");new pe(65023,"U+FB50..U+FDFF Arabic Presentation Forms-A");new pe(65039,"U+FE00..U+FE0F Variation Selectors");new pe(65055,"U+FE10..U+FE1F Vertical Forms");new pe(65071,"U+FE20..U+FE2F Combining Half Marks");new pe(65103,"U+FE30..U+FE4F CJK Compatibility Forms");
new pe(65135,"U+FE50..U+FE6F Small Form Variants");new pe(65279,"U+FE70..U+FEFF Arabic Presentation Forms-B");new pe(65519,"U+FF00..U+FFEF Halfwidth and fullwidth forms");new pe(65535,"U+FFF0..U+FFFF Specials");new pe(65663,"U+10000..U+1007F Linear B Syllabary");new pe(65791,"U+10080..U+100FF Linear B Ideograms");new pe(65855,"U+10100..U+1013F Aegean Numbers");new pe(65935,"U+10140..U+1018F Ancient Greek Numbers");new pe(65999,"U+10190..U+101CF Ancient Symbols");new pe(66047,"U+101D0..U+101FF Phaistos Disc");
new pe(66207,"U+10280..U+1029F Lycian");new pe(66271,"U+102A0..U+102DF Carian");new pe(66351,"U+10300..U+1032F Old Italic");new pe(66383,"U+10330..U+1034F Gothic");new pe(66463,"U+10380..U+1039F Ugaritic");new pe(66527,"U+103A0..U+103DF Old Persian");new pe(66639,"U+10400..U+1044F Deseret");new pe(66687,"U+10450..U+1047F Shavian");new pe(66735,"U+10480..U+104AF Osmanya");new pe(67647,"U+10800..U+1083F Cypriot Syllabary");new pe(67679,"U+10840..U+1085F Imperial Aramaic");new pe(67871,"U+10900..U+1091F Phoenician");
new pe(67903,"U+10920..U+1093F Lydian");new pe(67999,"U+10980..U+1099F Meroitic Hieroglyphs");new pe(68095,"U+109A0..U+109FF Meoritic Cursive");new pe(68191,"U+10A00..U+10A5F Kharoshthi");new pe(68223,"U+10A60..U+10A7F Old South Arabian");new pe(68415,"U+10B00..U+10B3F Avestan");new pe(68447,"U+10B40..U+10B5F Inscriptional Parthian");new pe(68479,"U+10B60..U+10B7F Inscriptional Pahlavi");new pe(68687,"U+10C00..U+10C4F Old Turkic");new pe(69247,"U+10E60..U+10E7F Rumi Numeral Symbols");new pe(69759,
"U+11000..U+1107F Brahmi");new pe(69839,"U+11080..U+110CF Kaithi");new pe(69887,"U+110D0..U+110FF Sora Sompeng");new pe(69967,"U+11100..U+1114F Chakma");new pe(70111,"U+11180..U+111DF Sharada");new pe(71375,"U+11680..U+116CF Takri");new pe(74751,"U+12000..U+123FF Cuneiform");new pe(74879,"U+12400..U+1247F Cuneiform Numbers and Punctuation");new pe(78895,"U+13000..U+1342F Egyptian Hieroglyphs");new pe(92735,"U+16800..U+16A3F Bamum Supplement");new pe(94111,"U+16F00..U+16F9F Miao");new pe(110847,"U+1B000..U+1B0FF Kana Supplement");
new pe(119039,"U+1D000..U+1D0FF Byzantine Musical Symbols");new pe(119295,"U+1D100..U+1D1FF Musical Symbols");new pe(119375,"U+1D200..U+1D24F Ancient Greek Musical Notation");new pe(119647,"U+1D300..U+1D35F Tai Xuan Jing Symbols");new pe(119679,"U+1D360..U+1D37F Counting Rod Numerals");new pe(120831,"U+1D400..U+1D7FF Mathematical Alphanumeric Symbols");new pe(126719,"U+1EE00..U+1EEFF Arabic Mathematical Alphabetic Symbols");new pe(127023,"U+1F000..U+1F02F Mahjong Tiles");new pe(127135,"U+1F030..U+1F09F Domino Tiles");
new pe(127231,"U+1F0A0..U+1F0FF Playing Cards");new pe(127487,"U+1F100..U+1F1FF Enclosed Alphanumeric Supplement");new pe(127743,"U+1F200..U+1F2FF Enclosed Ideographic Supplement");new pe(128511,"U+1F300..U+1F5FF Miscellaneous Symbols and Pictographs");new pe(128591,"U+1F600..U+1F64F Emoticons");new pe(128767,"U+1F680..U+1F6FF Transport and Map Symbols");new pe(128895,"U+1F700..U+1F77F Alchemical Symbols");new pe(173791,"U+20000..U+2A6DF CJK Unified Ideographs Extension B");new pe(177983,"U+2A700..U+2B73F CJK Unified Ideographs Extension C");
new pe(178207,"U+2B740..U+2B81F CJK Unified Ideographs Extension D");new pe(195103,"U+2F800..U+2FA1F CJK Compatibility Ideographs Supplement");new pe(917631,"U+E0000..U+E007F Tags");new pe(917999,"U+E0100..U+E01EF Variation Selectors Supplement");new pe(1048575,"U+F0000..U+FFFFF Supplementary Private Use Area-A");new pe(1114111,"U+100000..U+10FFFF Supplementary Private Use Area-B");Object(f.a)(Ln,"UnicodeBlocks",null,[1309]);class $h{constructor(){this.W=null}uc(Q){this.W=Q;this.W.register(ul,"Common.App.SensitiveLogging.StringDifference").as(1224).ha();
this.W.register(Ln,"Common.App.SensitiveLogging.UnicodeBlocks").as(1225).ha()}get name(){return"Common.App.SensitiveLogging"}init(){this.W.resolve(1224);this.W.resolve(1225)}dispose(){}static main(){C.a.instance.Lc(new $h)}}Object(f.a)($h,"SensitiveLoggingPackage",null,[0,1]);var ll;(function(Q){Q[Q.m$p=0]="myFiles";Q[Q.recent=1]="recent";Q[Q.PTp=2]="currentFolder";Q[Q.Anq=3]="yourPhone"})(ll||(ll={}));Object(f.b)("SharedFilePickerLandingLocation",ll);class zf{constructor(Q){this.kRb=this.Ktc=null;
this._initialized=!1;this.rSf=Q}MZc(Q){this._initialized||(Q.Xu(Gg.a.lxj),Q.sD(Gg.a.lxj,Object(R.a)(this,this.iZn,"onReceivedPickerResponse")),this._initialized=!0)}y5d(Q){return this.kRb=new Promise((Da,eb)=>{const Tb={};Tb[se.a.L8n]=Q;this.Ktc=(Ac,hd)=>{""===hd?(Ca.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),Da(Ac)):("Canceled"===hd?Ca.ULS.sendTraceTag(572548164,306,50,hd):Ca.ULS.sendTraceTag(556901065,306,10,hd),eb(hd))};this.rSf.execute(Ac=>{this.MZc(Ac);Ac.sendMessage(Gg.a.L2n,
Tb)})})}iZn(Q){this.Ktc(Q.Values[se.a.KKo],void 0===Q.Values[se.a.xjg]||null===Q.Values[se.a.xjg]?"":Q.Values[se.a.xjg])}G_f(){return m.AFrameworkApplication.J.$("UiHostCommonFilePicker")}ksf(Q,Da,eb,Tb,Ac,hd,Ud,Ee,Me=null){const Kf={};Kf[se.a.kKo]=Q;Kf[se.a.titleText]=Da;Kf[se.a.y2k]=eb;Kf[se.a.z2k]=Tb;Kf[se.a.B2k]=Ac;Kf[se.a.eTl]=!0;Kf[se.a.V4l]=hd;Kf[se.a.P8n]=Ud;Kf[se.a.O8n]=ll[Ee];I.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Kf[se.a.Q8n]="Dark");Me&&(null!=Me.zcc&&(Kf[se.a.zcc]=
Me.zcc),null!=Me.cmc&&(Kf[se.a.cmc]=Me.cmc));return Kf}}Object(f.a)(zf,"SharedFilePickerManager",null,[1308]);class af{constructor(){this.W=null}get name(){return"Common.App.SharedFilePicker"}uc(Q){this.W=Q;Q.register(zf,"Common.App.SharedFilePicker.SharedFilePickerManager").as(1027).ha().Sd(()=>new zf(Q.Ra(7)))}init(){m.AFrameworkApplication.J.Uo(()=>{this.j$a()})}j$a(){this.W.resolve(1027)}dispose(){}static main(){C.a.instance.Lc(new af)}}Object(f.a)(af,"SharedFilePickerPackage",null,[0,1]);class Eg extends Sys.EventArgs{constructor(){super()}}
Object(f.a)(Eg,"TypingSpeedMeterChangedEventArgs",Sys.EventArgs,[]);class Ag{}Object(f.a)(Ag,"TypingSpeedMeterWindow",null,[]);class nb{constructor(Q,Da){new W.a;this.sle=()=>{};this.nB=Q;this.kj=Da;this.kj.cff(this.sle)}dispose(){this.kj.cCj(this.sle)}}Object(f.a)(nb,"TypingSpeedMeter",null,[1409]);class Nb{constructor(Q){this.sOd=null;this.Nq=new v.a;this.nB=Q}initialize(Q,Da,eb,Tb){this.sOd||(this.sOd=new nb(this.nB,Q,Da,eb,Tb),this.Nq.hg(this.sOd));return this.sOd}}Object(f.a)(Nb,"TypingSpeedMeterProvider",
null,[1378]);class ec{constructor(){this.yaf=null}get name(){return"Common.App.TypingSpeedMeter"}init(){if(m.AFrameworkApplication.J.$("TypingSpeedMeterIsEnabled")){const Q=La.a.instance.resolve(1226),Da=zk.a.Yp(La.a.instance.Ra(100));Da.continueWith(()=>{const eb=Da.result.Nq.task;var Tb=new Ta.a(m.AFrameworkApplication.J.ic("TypingSpeedMeterWindowSamplingPercent",0)/100);Tb=new Sa.a(Object(R.a)(Tb,Tb.V_b,"shouldBeInSample"));const Ac=Na.a.TG(12,1,Tb),hd=m.AFrameworkApplication.J.ic("TypingSpeedMeterWindowTimeoutMs",
5E3),Ud=m.AFrameworkApplication.J.ic("TypingSpeedMeterMaxKeystrokesPerWindow",5);eb.CWR(()=>this.yaf=Q.initialize(eb.result,Ac,hd,Ud))})}}dispose(){this.yaf&&this.yaf.dispose()}uc(Q){Q.register(Nb,1226).as("Common.ITypingSpeedMeterProvider").ha().Sd(()=>new Nb(ka.a.Ge))}static main(){C.a.instance.Lc(new ec)}}Object(f.a)(ec,"TypingSpeedMeterPackage",null,[0,1]);class Hc{constructor(){this.events=[];this.ctg=!1}static y1f(Q){return Q.ctrlKey&&"Control"!==Q.key||Q.altKey&&"Alt"!==Q.key||!!Hc.Osn[Q.key]}static mel(Q,
Da){let eb;eb=Hc.y1f(Q)?Q.key:" "===Q.key?"Space":"CharacterKey";return null!=Da?(Da.altPressed=(!!Q.altKey).toString(),Da.ctrlPressed=(!!Q.ctrlKey).toString(),Da.key=eb,Da.repeat=(!!Q.repeat).toString(),Da.shiftPressed=(!!Q.shiftKey).toString(),Da):{["altPressed"]:(!!Q.altKey).toString(),["ctrlPressed"]:(!!Q.ctrlKey).toString(),["key"]:eb,["repeat"]:(!!Q.repeat).toString(),["shiftPressed"]:(!!Q.shiftKey).toString()}}static c_i(Q){return window.performance&&window.performance.now&&Q.timeStamp<performance.now()}static gki(Q){return!!Q&&
Hc.c_i(Q)&&Hc.y1f(Q)}static hki(Q){return!!Q&&Hc.c_i(Q)&&!Hc.y1f(Q)}keyPressedEventHandlerStart(Q,Da){Hc.hki(Q)&&this.jWj(Q,Da)}keyPressedEventHandlerEnd(Q){Hc.hki(Q)&&this.PWj(Q)}keyDownEventHandlerStart(Q,Da){Hc.gki(Q)&&this.jWj(Q,Da)}keyDownEventHandlerEnd(Q){Hc.gki(Q)&&this.PWj(Q)}jWj(Q,Da){Q={["metadata"]:Hc.mel(Q,Da),["timeStamp"]:this.Lzc(Q.timeStamp),["timeToHandlerFinishMs"]:0,["timeToHandlerStartMs"]:this.Lzc(performance.now()-Q.timeStamp),["eventDurationMs"]:0,["timeToRequestAnimationFrameMs"]:0};
this.events.push(Q);this.Hso()}PWj(Q){if(0!==this.events.length){var Da=this.Lzc(Q.timeStamp);for(let eb=this.events.length-1;0<=eb;--eb){const Tb=this.events[eb];if(Tb.timeStamp===Da){Tb.timeToHandlerFinishMs=this.Lzc(performance.now()-Q.timeStamp);Tb.eventDurationMs=this.Lzc(Tb.timeToHandlerFinishMs-Tb.timeToHandlerStartMs);break}}}}Lzc(Q){return Number(Q.toFixed(2))}Hso(){if(!this.ctg){const Q=document.createEvent("CustomEvent");Q.initCustomEvent("aggregateeventtimingstart",!1,!1,null);dispatchEvent(Q);
requestAnimationFrame(()=>{this.ctg=!1;const Da=performance.now();this.events.forEach(Tb=>{Tb.timeToRequestAnimationFrameMs=this.Lzc(Da-Tb.timeStamp)});var eb=document.createEvent("CustomEvent");eb.initCustomEvent("aggregateeventtiming",!1,!1,this.events.slice(0));dispatchEvent(eb);this.events=[];eb=document.createEvent("CustomEvent");eb.initCustomEvent("aggregateeventtimingstop",!1,!1,null);dispatchEvent(eb)});this.ctg=!0}}}Hc.Osn={["ArrowDown"]:!0,["ArrowLeft"]:!0,["ArrowRight"]:!0,["ArrowUp"]:!0,
["Backspace"]:!0,["Delete"]:!0,["End"]:!0,["Enter"]:!0,["Escape"]:!0,["Home"]:!0,["PageDown"]:!0,["PageUp"]:!0,["Tab"]:!0};class Tc{constructor(){this.Pte=this.obb=this.LXa=this.Gqc=null;this.stb=!1;this.Quc=null;this.G0c=[];this.wsd=()=>{Tc.iln()&&null==this.obb?(this.LXa=null,this.obb=requestAnimationFrame(this.qcd)):null!=this.obb&&(cancelAnimationFrame(this.obb),this.obb=null)};this.qcd=Q=>{if(null!=this.LXa){const Da=Q-this.LXa;if(null==this.Gqc||this.Gqc<Da)this.Gqc=Da;for(let eb=0;eb<Tc.ranges.length;++eb)if(Da<
Tc.ranges[eb]){++this.G0c[eb];break}}this.LXa=Q;this.obb=requestAnimationFrame(this.qcd)};this.IDj=()=>{if(null!=this.Gqc){var Q={};for(var Da=0;Da<Tc.ranges.length;++Da)Q[Tc.ranges[Da]]=this.G0c[Da],this.G0c[Da]=0;Da=performance.now();Q={["intervalStart"]:this.Quc,["intervalEnd"]:Da,["maxFrameLengthMs"]:this.Gqc,["frameData"]:Q};var eb=document.createEvent("CustomEvent");eb.initCustomEvent("reportframetiming",!1,!1,Q);dispatchEvent(eb);this.Gqc=null;this.Quc=Da}}}static JZf(){return!!window.performance&&
!!window.performance.now}start(Q){!this.stb&&Tc.JZf()&&(this.TXo(),this.Pte=setInterval(this.IDj,1E3*Q),this.Quc=performance.now(),this.wsd(),document.addEventListener("visibilitychange",this.wsd),this.stb=!0)}stop(){this.stb&&(document.removeEventListener("visibilitychange",this.wsd),null!=this.Pte&&(clearInterval(this.Pte),this.Pte=null),null!=this.obb&&(cancelAnimationFrame(this.obb),this.obb=null),this.IDj(),this.stb=!1)}get oab(){return this.stb}TXo(){this.G0c=[];for(let Q=0;Q<Tc.ranges.length;++Q)this.G0c.push(0)}}
Tc.iln=()=>"visible"===document.visibilityState;Tc.ranges=[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];class xd{create(Q){return new Ta.a(Q)}}Object(f.a)(xd,"RandomSamplerFactory",null,[1789]);var ld=d(21),Ed=d(64);class Zd{constructor(Q,Da,eb,Tb,Ac){Q.PQd(()=>{Tb.tkd()});Q.MOh((hd,Ud)=>{Tb.rkd(Ud.revisionId,Ud.Mbb)});Q.SQd((hd,Ud)=>{Tb.m1m(Ud.oCa,Ud.Mbb,Ud.l_j)});Q.a_k(()=>{Tb.Rsg()});Da.C_k((hd,Ud)=>{Tb.ahp(Ud.tDj,Ud.OBe,Ud.actualValue)});Da.mZk((hd,Ud)=>{Tb.$gp(Ud.tDj,
Ud.OBe,Ud.actualValue)});Ac.TRc(()=>{Tb.asd()});eb.BO((hd,Ud)=>{6===Ud.type&&Tb.wvc(Ud.iA)})}}Object(f.a)(Zd,"EventForwarder",null,[]);class If{constructor(Q,Da,eb){this.KDk=Q;this.mQ=eb;this.Dac=Da}create(Q,Da){return new Zd(this.KDk,this.Dac,Q,Da,this.mQ)}}Object(f.a)(If,"EventForwarderFactory",null,[]);var qg=d(338);class ch{}ch.Rnp="TypingToOutboundReplicationStart";ch.w3n="OutboundReplicationStartToOutboundReplicationEnd";ch.NGj="RtcNotificationToInboundReplicationEnd";ch.d3j="TypingToInboundReplicationEnd";
Object(f.a)(ch,"PerfTrackerPhases",null,[]);class mk{constructor(Q,Da,eb,Tb,Ac,hd,Ud,Ee,Me=null){this.msh=!1;this.M0e=5;this.Dth=50;this.q_e=20;this.ZYe=this.$Ze=this.$Ea=null;this.LEc=this.zEc=0;this.L8e=this.T9e=!1;this.tNd=Array(7);this.$Bc=null;this.jjh=!1;this.ELe=null;this.Ima={};this.MCd=Q;this.J1a=Da;this.lCk=eb;this.ilh=Tb.create(ch.NGj,Ac,hd,20,!1);this.tOd=Tb.create(ch.d3j,Ud,Ee,20,!0);if(this.Ga=m.AFrameworkApplication.J)this.msh=this.Ga.$("LogSteppedInboundFrameIsEnabled"),this.q_e=this.Ga.ic("InboundFrameMaxNumberOfLongRunningTasks",
20),this.Dth=this.Ga.ic("InboundFrameMinLengthForLongRunningTasksInMs",50),this.M0e=this.Ga.ic("InboundFrameNumberOfLastShortTasks",5);this.SBb=Me}get bnl(){null==this.ELe&&(this.ELe=!!this.Ga&&this.Ga.$("InboundRequestTakesTooLongToSendAfterRTCTelemetryIsEnabled"));return this.ELe}initialize(Q){this.$Ea=Q}SAo(Q,Da,eb=null){this.Y0h();Ca.ULS.shipAssertTag(8229761,324,0<Q.length);let Tb=!1;for(const hd of Q){const Ud=hd.toString();if(Ud in this.Ima){var Ac=this.Ima[Ud];if(!Ac.$vc){Ac.vKj(Q,Da,eb);
if(Tb)this.I9i(hd.toString(),Ac,null,null,this.tNd,null);else{const Ee=this.Y2l(),Me=this.$cm(this.$Bc);Tb=!0;this.I9i(hd.toString(),Ac,Ee,this.ZYe,this.tNd,Me)}delete this.Ima[Ud]}}else Ac=this.MCd.create(this.ilh,this.tOd),Ac.vKj(Q,Da),this.Ima[Ud]=Ac}this.L8e=!1}wvc(Q){Ca.ULS.shipAssertTag(8257930,304,Q.A2i,"Expected data not sent on the wire");if(Q.A2i){if(Q.xue in this.Ima){var Da=this.Ima[Q.xue];Da.Lue||(Da.wvc(Q.revisionId,Q.yoj,Q.yRj,Q.Mbb),delete this.Ima[Q.xue])}else Da=this.MCd.create(this.ilh,
this.tOd),Da.wvc(Q.revisionId,Q.yoj,Q.yRj,Q.Mbb),this.Ima[Q.xue]=Da;this.Y0h()}}b3m(){this.T9e||(this.$Ze=Array(this.q_e),this.ZYe=Array(this.M0e),this.LEc=this.zEc=0,this.tNd=[0,0,0,0,0,0,0,0],this.$Bc=Array(3),this.$Bc[1]=[0,0],this.$Bc[2]=[0,0],this.T9e=!0)}W0o(Q){return!Q.TP&&Q.TN===ia.a.nDj&&(Q=qg.a(this.Ima))&&Q[0]?!0:!1}OTn(Q){this.T9e=!1;const Da=qg.a(this.Ima);Da&&Da[0]&&(Q.TRT>=this.Dth&&this.zEc<this.q_e?this.$Ze[this.zEc++]=Q:(this.ZYe[this.LEc]=Q,this.LEc=this.LEc<this.M0e-1?this.LEc+
1:0),this.MCn(Q),this.aDn(Q))}NTn(){this.b3m();this.L8e=!0}MCn(Q){this.tNd[Q.TP]++}aDn(Q){if(Q&&Q.UI){const Da=this.$Bc[Q.UI];Da[0]+=1;Da[1]+=Q.TRT}}$cm(Q){const Da={};Q&&(Q[1]&&(Da.Typing=Q[1]),Q[2]&&(Da.Clicking=Q[2]));return Da}Y2l(){return this.zEc?this.$Ze.slice(0,this.zEc-1):null}Y0h(){var Q=qg.a(this.Ima);if(Q&&(this.jjh||this.wDn(Q),Q.length>this.lCk))for(const Da of Q){Q=this.Ima[Da];const eb=Q.createdTime,Tb=this.J1a();6E4<Tb-eb&&(P.b(8438528,304,50,"{0}",{["Not Received"]:Q.$vc?"RtcNotification":
"ServerRevision",["Duration"]:Tb-eb}),Q.$vc||P.b(42075798,304,15,"{0}",{["RevisionId"]:Da,["Duration"]:Tb-eb}),delete this.Ima[Da])}}wDn(Q){if(this.bnl&&this.SBb)for(const Da of Q)if(Q=this.Ima[Da],Q.Lue&&!Q.$vc&&(Q=Q.createdTime,2E3<this.J1a()-Q)){let eb=null;ld.StaticActiveAppFrame.za()&&ld.StaticActiveAppFrame.za().kb&&ld.StaticActiveAppFrame.za().kb.$c&&(eb=ld.StaticActiveAppFrame.za().kb.$c.wg);this.SBb.execute(Tb=>{Tb.flush(eb,1)});this.jjh=!0}}I9i(Q,Da,eb,Tb,Ac,hd){this.msh&&(Da=Da.Ncm())&&
(Da.RevisionId=Q,Da.LRTWR=eb,Da.LSTWR=Tb,Da.TSD=Ac,Da.UIWR=hd,this.$Ea&&this.$Ea.track(Da))}}Object(f.a)(mk,"InboundMonitor",null,[1418]);class qj{constructor(Q,Da,eb,Tb){this.XE=Da;this.MCd=eb;this.pOk=Tb}create(Q,Da,eb,Tb,Ac=null){return new mk(this.MCd,this.XE,50,this.pOk,Q,Da,eb,Tb,Ac)}}Object(f.a)(qj,"InboundMonitorFactory",null,[1387]);var ne=d(373);class Se{}Se.NEe="UserCount";Se.qFo="RevisionChainLength";Object(f.a)(Se,"PerfTrackerPivotNames",null,[]);class aj{}Object(f.a)(aj,"PerfTrackingContext",
null,[]);const te=Q=>5>=Q?"5AndFewer":10>=Q?"6To10":15>=Q?"11To15":20>=Q?"15To20":25>=Q?"21To25":30>=Q?"26To30":"31AndAbove";class hk{}Object(f.a)(hk,"SteppedInboundFrame",null,[]);class ak{constructor(Q,Da,eb,Tb,Ac){this.Pjb=this.OCd=null;this.dlh=500;this.NCd=this.mxa=this.aEb=this.l7b=this.ovd=-1;this.SRg=null;this.NCh=this.JBh=!1;this.oBh=null;this.Ywh=this.PRa=0;this.z9b=Q;this.createdTime=Da();this.SLd=!1;this.Z1e=0;this.QFb=eb;this.mxk=Tb;this.tOd=Ac;m.AFrameworkApplication.J&&(this.dlh=m.AFrameworkApplication.J.ic("InboundFrameSamplingMinimalTotalTimeMs",
500))}get Lue(){return this.JBh}get $vc(){return this.NCh}get UFj(){return this.oBh}get Mbb(){return this.PRa}get v3n(){return this.Ywh}get xNb(){return this.QFb()}wvc(Q,Da,eb,Tb){this.Lue||(this.SLd=eb,this.Z1e=Da,this.ovd=X.a.PP(ka.a.Ge(),2),this.SRg=(new Date).toISOString(),this.Pjb=Q,this.Ywh=Tb,this.JBh=!0,this.$vc?this.Fii():(this.kWj(),$a.a.instance.sA(Q.toString()+"Start"),ne.a.instance.sie(2)))}vKj(Q,Da,eb=null){this.$vc||(this.PRa=Da,this.NCh=!0,this.oBh=Q,this.NCd=X.a.PP(ka.a.Ge(),2),this.Lue&&
($a.a.instance.sA(this.Pjb.toString()+"End"),eb&&(this.l7b=eb.wEj,this.aEb=eb.pNa,this.mxa=eb.sDj),ne.a.instance.UUd(),this.Fii()))}Ncm(){if(!(0<this.ovd&&0<this.l7b&&0<this.aEb&&0<this.mxa&&0<this.NCd))return null;const Q=new hk;Q.TT=X.a.PP(this.NCd-this.ovd,2);if(Q.TT<this.dlh)return null;Q.ST=this.SRg;Q.UC=this.xNb;Q.RS=X.a.PP(this.l7b-this.ovd,2);Q.SR=X.a.PP(this.aEb-this.l7b,2);Q.RRS=X.a.PP(this.mxa-this.aEb,2);Q.RP=X.a.PP(this.NCd-this.mxa,2);Q.ResponseLanded=X.a.PP(this.aEb,2);0<Q.RS?($a.a.instance.m0("RTCToRequestSent",
this.Pjb.toString()+"Start","RequestInvoked"+this.l7b),$a.a.instance.m0("RequestSentToResponseReceived","RequestInvoked"+this.l7b,"RequestCompleted"+this.aEb),$a.a.instance.m0("ResponseReceivedToReplicationStart","RequestCompleted"+this.aEb,"ReplicationStart"+this.mxa)):$a.a.instance.m0("RTCToReplicationStart",this.Pjb.toString()+"Start","ReplicationStart"+this.mxa);$a.a.instance.m0("Replication","ReplicationStart"+this.mxa,this.Pjb.toString()+"End");return Q}kWj(){this.OCd=this.z9b.create();this.OCd.start(ch.NGj,
ch.d3j)}Fii(){this.OCd||this.kWj();const Q=this.OCd.end(this.SLd,this.xGl());this.mxk.Nte(Q);this.tOd.Nte(Q+this.Z1e)}xGl(){const Q={};Q[Se.NEe]=te(this.xNb);var Da=this.UFj.length;Q[Se.qFo]=9>=Da?Da.toString():"10AndAbove";return Object.assign(new aj,{P:Q,FC:this.Mbb,CFC:this.v3n+this.Mbb,ID:this.Pjb.toString(),CD:this.Z1e,UC:this.xNb,RCL:this.UFj.length})}}Object(f.a)(ak,"InboundOperation",null,[1417]);class lj{constructor(Q,Da,eb){this.GQa=Q;this.J1a=Da;this.QFb=eb}create(Q,Da){return new ak(this.GQa,
this.J1a,this.QFb,Q,Da)}}Object(f.a)(lj,"InboundOperationFactory",null,[1386]);class bm{constructor(Q,Da,eb,Tb,Ac,hd,Ud,Ee,Me){this.TLd=!0;this.eyh=this.EId=null;this.fC=Kf=>{this.Yh.fC(6,Kf)};this.Y1e=Q;this.wsk=Da;this.CGk=eb;this.Yh=Tb;this.zaf=Ac.create("TypingToOutboundReplicationStart",hd,Ud,20,!1);this.j5e=Ac.create("OutboundReplicationStartToOutboundReplicationEnd",Ee,Me,20,!1)}get fjg(){return this.EId}get Yoe(){return this.eyh}asd(){!this.fjg&&this.TLd&&(this.TLd=this.wsk())&&(this.EId=
this.Y1e.create(this.fC,this.CGk(),this.zaf,this.j5e),this.fjg.asd())}tkd(){this.TLd=!0;this.eyh=this.fjg;this.Yoe&&(this.EId=null,this.Yoe.tkd())}Rsg(){this.EId=null}rkd(Q,Da){this.Yoe&&this.Yoe.rkd(Q,Da)}}Object(f.a)(bm,"OutboundMonitor",null,[]);class Oa{constructor(Q,Da){this.Y1e=Q;this.AFk=Da}create(Q,Da,eb,Tb,Ac,hd,Ud){return new bm(this.Y1e,Q,Da,eb,this.AFk,Tb,Ac,hd,Ud)}}Object(f.a)(Oa,"OutboundMonitorFactory",null,[]);var kc=d(48);class Oc{constructor(Q){this.dkb=Q}get oko(){return this.dkb}lb(Q){return!!this.dkb&&
Q in this.dkb}get A2i(){return this.lb(Oc.G_d)&&this.lb(Oc.wZb)&&this.lb(Oc.vBg)}get revisionId(){if(this.lb(Oc.wZb))return kc.a.Cf(this.dkb[Oc.wZb]);throw Error.create("Unable to parse RevisionIdKey key from dictionary into string");}get xue(){if(this.lb(Oc.wZb))return this.dkb[Oc.wZb];throw Error.create("Unable to cast RevisionIdKey key from dictionary into string");}get yoj(){if(this.lb(Oc.G_d))return Number.parseInvariant(this.dkb[Oc.G_d]);throw Error.create("Unable to parse DurationKey key from dictionary into int");
}get yRj(){if(this.lb(Oc.wZb))return Boolean.parse(this.dkb[Oc.vBg]);throw Error.create("Unable to parse ShouldSample key from dictionary into bool");}get Mbb(){if(this.lb(Oc.Jbg))return Number.parseInvariant(this.dkb[Oc.Jbg]);throw Error.create("Unable to parse NumSequentailFailuresKey key from dictionary into int");}static JDl(Q){return new Oc(Q)}static ODl(Q,Da,eb,Tb){const Ac={};Ac[Oc.G_d]=Q.toString();Ac[Oc.wZb]=Da.toString();Ac[Oc.vBg]=eb.toString();Ac[Oc.Jbg]=Tb.toString();return new Oc(Ac)}}
Oc.wZb="RevisionID";Oc.G_d="Duration";Oc.vBg="ShouldSample";Oc.Jbg="NumSequentialFailures";Object(f.a)(Oc,"ReplicationNotificationMessage",null,[1415]);class Cd{constructor(Q,Da,eb,Tb,Ac,hd,Ud){this.rt=this.ji=0;this.iGb=this.rQc=null;this.NIe=[];this.czh=null;this.eAd={};this.PRa=0;this.z9b=Q;this.iKk=Da;this.J1a=eb;this.QFb=Tb;this.HDh=Ac;this.Pjb=null;this.eAd.TypingStartStage=null;this.eAd.ReplicationStartStage="TypingStartStage";this.eAd.ReplicationEndStage="ReplicationStartStage";this.tIh=1<
this.xNb;this.zaf=hd;this.j5e=Ud}get xNb(){return this.QFb()}asd(){this.nnf("TypingStartStage")&&(this.tpg("TypingStartStage"),Ca.ULS.shipAssertTag(8257931,324,!this.iGb&&!this.rt,"ReplicationStart or ReplicationEnd were calledbefore TypingStart"),this.ji=this.J1a(),this.rQc=this.z9b.create(),this.$Vj(this.rQc,ch.Rnp))}tkd(){if(this.nnf("ReplicationStartStage")){this.tpg("ReplicationStartStage");Ca.ULS.shipAssertTag(8257932,324,!!this.rQc,"TypingStart not called");if(this.rQc){const Q=this.zii(this.rQc,
this.Pjb);this.zaf.Nte(Q)}this.iGb=this.z9b.create();this.$Vj(this.iGb,ch.w3n)}}rkd(Q,Da){this.nnf("ReplicationEndStage")&&(this.tpg("ReplicationEndStage"),this.rt=this.J1a(),this.PRa=Da,Ca.ULS.shipAssertTag(8257933,324,!!this.iGb,"ReplicationStart not called"),this.iGb&&(Ca.ULS.shipAssertTag(8193425,324,!!this.iGb,"ReplicationStart not called"),Da=this.zii(this.iGb,Q),this.j5e.Nte(Da)),Ca.ULS.shipAssertTag(8257934,324,!!this.ji,"StartTime not set. No message sent to other editors."),this.ji&&(Q=
Oc.ODl(this.rt-this.ji,Q,this.HDh,this.PRa),this.iKk(Q.oko)))}nnf(Q){if(this.eAd[Q]===this.czh)return!0;Ca.ULS.shipAssertTag(8422940,324,!1,"{0}",{["Previous stage mismatch"]:this.oSk()});return!1}oSk(){const Q=new Sys.StringBuilder;Q.append("Actual Phase:");for(let Da=0;Da<this.NIe.length;Da++)Q.append(" "+this.NIe[Da]);return Q.toString()}tpg(Q){this.NIe.push(Q);this.czh=Q}$Vj(Q,Da){this.tIh&&Q.start(Da)}zii(Q,Da){if(!this.tIh)return-1;const eb={};eb[Se.NEe]=te(this.xNb);Da=Object.assign(new aj,
{P:eb,FC:this.PRa,CFC:0,ID:Da?Da.toString():"",CD:0,UC:this.xNb,RCL:0});return Q.end(this.HDh,Da)}}Object(f.a)(Cd,"OutboundOperation",null,[1416]);class Ve{constructor(Q,Da,eb){this.z9b=Q;this.J1a=Da;this.QFb=eb}create(Q,Da,eb,Tb){return new Cd(this.z9b,Q,this.J1a,this.QFb,Da,eb,Tb)}}Object(f.a)(Ve,"OutboundOperationFactory",null,[1385]);class Fd{constructor(Q,Da){this.Sah=this._name=this.Q5=null;this.Xd=Q;this.$Ea=Da}start(Q,Da=null){this.Q5=this.Xd.Wf("UserAction",Q);this._name=Q;this.Sah=Da}end(Q,
Da){let eb=-1;Q&&(eb=this.Q5.Ei,Da.D=eb,Da.CN=this.Sah,Da.CD+=eb,this.$Ea.track(Da,this._name));return eb}}Object(f.a)(Fd,"PerfTracker",null,[1414]);class pa{constructor(Q,Da){this.Xd=Q;this.$Ea=Da}create(){return new Fd(this.Xd,this.$Ea)}}Object(f.a)(pa,"PerfTrackerFactory",null,[1384]);class Hb{constructor(Q,Da,eb){this.hMc=null;this.zFk=Q;this.hlh=Da;this.Czh=eb}init(Q,Da,eb,Tb,Ac,hd,Ud){Da=this.Czh.create(Da/100);eb=this.Czh.create(eb/100);this.hMc=this.zFk.create(Object(R.a)(Da,Da.V_b,"shouldBeInSample"),
Object(R.a)(eb,eb.V_b,"shouldBeInSample"),Q,Tb,Ac,hd,Ud)}asd(){this.hMc.asd()}tkd(){this.hMc.tkd()}Rsg(){this.hMc.Rsg()}rkd(Q,Da){this.hMc.rkd(Q,Da)}m1m(Q,Da,eb=null){this.hlh.SAo(Q,Da,eb)}wvc(Q){Q=Oc.JDl(Q);this.hlh.wvc(Q);$a.a.instance.sA(Q.revisionId+"Start")}ahp(Q,Da,eb){P.b(9041820,304,50,"ReplicationTelemetry KPI Threshold Exceeded: [{0}]",this.AXd(Q,Da,eb))}$gp(Q,Da,eb){P.b(9041821,304,50,"ReplicationTelemetry KPI Average Threshold Exceeded: [{0}]",this.AXd(Q,Da,eb))}AXd(Q,Da,eb){const Tb=
{};Tb.PhaseName=Q;Tb.ThresholdValue=Da;Tb.ActualValue=eb;return Tb}}Object(f.a)(Hb,"ReplicationTelemetryManager",null,[]);var Ob=d(931);class Dc extends Ob.a{constructor(Q,Da){super(Q,Da);this.Kk=this.SMd=0}lDa(Q){this.SMd+=Q;this.Kk++}getValue(){return this.Kk?this.SMd/this.Kk:0}OZa(){this.Kk=this.SMd=0}}Object(f.a)(Dc,"AverageMetric",Ob.a,[]);class nd extends Ob.a{constructor(Q,Da){super(Q,Da);this.e$=0}lDa(Q){Q>this.e$&&(this.e$=Q)}getValue(){return this.e$}OZa(){this.e$=0}}Object(f.a)(nd,"MaxMetric",
Ob.a,[]);var Od=d(1909);class ye extends Ob.a{constructor(Q,Da,eb=100){super(Q,Da);this.bGd=this.Y8b=this.qac=0;this.FKd=eb;this.a6e=new Od.a(this.FKd)}lDa(Q){if(this.Y8b===this.FKd){const Da=this.a6e.dequeue();this.qac-=Da;this.Y8b--}this.a6e.enqueue(Q);this.qac+=Q;this.Y8b++;Q=this.qac/this.Y8b;Q>this.bGd&&this.Y8b===this.FKd&&(this.bGd=Q)}getValue(){return this.bGd}OZa(){this.bGd=0;this.a6e=new Od.a(this.FKd);this.Y8b=this.qac=0}}Object(f.a)(ye,"MaxRollingAverageMetric",Ob.a,[]);class Oe extends Ob.a{constructor(Q,
Da){super(Q,Da);this.Kk=0}lDa(){this.Kk++}getValue(){return this.Kk}OZa(){this.Kk=0}}Object(f.a)(Oe,"CounterMetric",Ob.a,[]);class Cf{constructor(Q,Da){this.pbc=Da;this.cKe=new Dc(Q+"-AverageValue","Milliseconds");this.o_e=new nd(Q+"-MaxValue","Milliseconds");this.t_e=new ye(Q+"-MaxRollingAverageValue","Milliseconds");this.rNe=new Oe(Q+"-NumberOfEvents","Count");this.Lxa=new Ra.a(Q+"-SlowPercentileAtValue","Percentile",m.AFrameworkApplication.J.hN("CoAuthLatencySlowTargetValue",3E3),m.AFrameworkApplication.J.hN("CoAuthLatencySlowThresholdPercentile",
95),this.pbc);this.d3e=new Ra.a(Q+"-BrokenSlowPercentileAtValue","Percentile",m.AFrameworkApplication.J.hN("CoAuthLatencyBrokenSlowTargetValue",5E3),m.AFrameworkApplication.J.hN("CoAuthLatencyBrokenSlowThresholdPercentile",95),this.pbc)}S3(Q){this.cKe.lDa(Q);this.o_e.lDa(Q);this.t_e.lDa(Q);this.rNe.lDa(Q);this.Lxa.lDa(Q);this.d3e.lDa(Q)}rse(){this.cKe.sZa();this.o_e.sZa();this.t_e.sZa();this.rNe.sZa();this.Lxa.sZa();this.d3e.sZa();this.cKe.OZa();this.o_e.OZa();this.t_e.OZa();this.rNe.OZa();this.Lxa.OZa();
this.d3e.OZa()}}Object(f.a)(Cf,"ReplicationLatencyMetrics",null,[]);class Bg{constructor(){this.lZe=new qc.a}Uxj(Q,Da,eb){if(!(0>Da)){if(!({value:Tb}=this.lZe.Ac(Q,Tb)).returnValue){var Tb=new Cf(Q,eb);this.lZe.Z(Q,Tb)}Tb.S3(Da)}}rse(){for(const Q of this.lZe.values)Q.rse()}}Object(f.a)(Bg,"ReplicationTelemetryMetricsManager",null,[1382]);class Zg{Uxj(){}rse(){}}Object(f.a)(Zg,"ReplicationTelemetryMetricsManagerStub",null,[1382]);class Qg{constructor(Q,Da,eb,Tb,Ac,hd,Ud){this.a5a=this.eOd=0;this.LCk=
Q;this.h3e=eb;this.xGh=Tb;this.G8g=Ac;this.Dac=Da;this.MCk=hd;this.pbc=Ud}Nte(Q){this.LCk.Uxj(this.h3e,Q,this.pbc);Q>this.xGh&&this.Dac.Fgp(this.h3e,this.xGh,Q);this.eOd+=Q;this.a5a++;this.eOd/this.a5a>this.G8g&&this.a5a>this.MCk&&this.Dac.k$k(this.h3e,this.G8g,this.eOd/this.a5a)}}Object(f.a)(Qg,"TimeSpanVerifier",null,[1412]);class Sg{constructor(Q,Da){this.MIk=Q;this.Dac=Da}create(Q,Da,eb,Tb,Ac){return new Qg(this.MIk,this.Dac,Q,Da,eb,Tb,Ac)}}Object(f.a)(Sg,"TimeSpanVerifierFactory",null,[1381]);
class Qk extends Sys.EventArgs{constructor(Q,Da,eb){super();this.tDj=Q;this.OBe=Da;this.actualValue=eb}}Object(f.a)(Qk,"TimeSpanVerifierEventArgs",Sys.EventArgs,[]);class bk{constructor(){this.sa=new W.a}Fgp(Q,Da,eb){this.sa.raiseEvent("TSVTE",new Qk(Q,Da,eb))}k$k(Q,Da,eb){this.sa.raiseEvent("TSVATE",new Qk(Q,Da,eb))}C_k(Q){this.sa.addHandler("TSVTE",Q)}mZk(Q){this.sa.addHandler("TSVATE",Q)}}Object(f.a)(bk,"TimeSpanVerifierNotifier",null,[1380]);var df=d(1260);class fc{constructor(){this.W=this.Ga=
null}get name(){return"Box4.ReplicationTelemetry"}uc(Q){this.Ga=Q.resolve(71);this.W=Q;if(this.Ga.$("Box4ReplicationTelemetryIsEnabled")){Q.ia(1229,()=>new pa(ld.StaticActiveAppFrame.za().Vr,Na.a.TG(20,1,new ya.a))).ha();Q.ia(1228,()=>new bk).ha();this.Ga.$("Box4ReplicationTelemetryMetricsIsEnabled")?Q.ia(1227,()=>new Bg).ha():Q.ia(1227,()=>new Zg).ha();Q.ia(1231,()=>new Sg(Q.resolve(1227),Q.resolve(1228))).ha();Q.ia(1230,()=>new Ve(Q.resolve(1229),()=>(new Date).getTime(),fc.Vvi)).ha();Q.ia(1234,
()=>new Oa(Q.resolve(1230),Q.resolve(1231))).ha();Q.ia(1232,()=>new lj(Q.resolve(1229),()=>(new Date).getTime(),fc.Vvi)).ha();var Da=new qj(Q.resolve(1229),()=>(new Date).getTime(),Q.resolve(1232),Q.resolve(1231)),eb=this.Ga.$("ComponentStateLoggingPackageIsEnabled")?this.W.Ra(1233):null;Q.ia(1235,()=>Da.create(this.Ga.ic("Box4ReplicationTelemetryInboundOperationThreshold",0),this.Ga.ic("Box4ReplicationTelemetryInboundOperationAverageThreshold",0),this.Ga.ic("Box4ReplicationTelemetryTypingToInboundEndThreshold",
0),this.Ga.ic("Box4ReplicationTelemetryTypingToInboundEndAverageThreshold",0),eb)).ha();Q.ia(1236,()=>new xd).ha();Q.ia(1237,()=>new Hb(Q.resolve(1234),Q.resolve(1235),Q.resolve(1236))).ha();Q.ia(1238,()=>new If(df.a.instance,Q.resolve(1228),Q.resolve(230)))}}init(){if(this.Ga.$("Box4ReplicationTelemetryIsEnabled")){var Q=this.Ga.ic("Box4ReplicationTelemetrySamplePercent",0),Da=this.Ga.ic("Box4ReplicationTelemetryPhaseSamplePercent",0),eb=this.Ga.ic("Box4ReplicationTelemetryTypingToReplicationStartThreshold",
0),Tb=this.Ga.ic("Box4ReplicationTelemetryTypingToReplicationStartAverageThreshold",0),Ac=this.Ga.ic("Box4ReplicationTelemetryReplicationStartToReplicationEndThreshold",0),hd=this.Ga.ic("Box4ReplicationTelemetryReplicationStartToReplicationEndAverageThreshold",0),Ud=this;this.W.Ra(543).execute(Me=>{Me.aD().continueWith(()=>{const Kf=Me.aD().result,th=Ud.W.resolve(1237);th.init(Kf,Q,Da,eb,Tb,Ac,hd);Ud.W.resolve(1238).create(Kf,th);if(Ud.Ga.$("LogSteppedInboundFrameIsEnabled")){const Fj=zk.a.Yp(Ud.W.Ra(100));
Fj.continueWith(()=>{const uh=Ud.W.resolve(1235);var hi=new Sa.a(()=>!0);hi=Na.a.TG(19,1,hi);uh.initialize(hi);const kk=Fj.result.Nq.task;kk.continueWith(()=>{kk.result.hQd(0,()=>uh.L8e,kl=>{uh.OTn(kl)});kk.result.hQd(1,kl=>uh.W0o(kl),()=>{uh.NTn()})})})}Ca.ULS.sendTraceTag(8257935,305,50,"ReplicationTelemetry init")})});var Ee=this;m.AFrameworkApplication.XI(()=>{Ee.W.resolve(1227).rse()})}}dispose(){}static Vvi(){const Q=Ed.a.ud();return Q?Q.nhi:0}}Object(f.a)(fc,"ReplicationTelemetryPackage",null,
[0,1]);var vd=d(1243),Uc=d(11),ze=d(129),Gd=d(3),Ej=d(85),bd=d(65),gg=d(38),Wf=d(22),Rg=d(164),ii=d(8),fo=d(2103);class na{static get kh(){return a.a.Ry(na.Hn,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}na.Hn="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";
Object(f.a)(na,"InsertSymbolsDialogHtml",null,[]);class db extends fo.a{constructor(Q,Da,eb){super();this.i8b=this.MSa=this.alb=null;this.dVe=0;this.F8m=Tb=>{1===Tb?(this.teg("symbol_d_"+db.JJc),this.Yb.HN(this.dN,!0),this.Yb.au().Nk.hA(this.jJ),this.jJ.focus()):this.hide()};this.dYj=Tb=>{if(Tb.target!==this.i8b){const Ac=this.Yb.au();Ac&&Ac.Nk&&(Ac.Nk.hA(Tb.target),this.i8b=Tb.target)}this.A_n(Tb.target.id)};this.Rcp=Tb=>{const Ac=Tb.If;if("a"!==Ac.tagName.toLowerCase())return!1;Tb.eventName===U.a.PC&&
this.teg(Ac.id);this.Yb.HN(this.dN,!0);this.Yb.au().Nk.hA(Ac);Ac.focus();return!0};this.Tcp=Tb=>{var Ac=Tb.If;if("a"!==Ac.tagName.toLowerCase())return!1;const hd=parseInt(Ac.id.substr(Ac.id.lastIndexOf("_")+1));if(Tb.Nb.ctrlKey||Tb.Nb.altKey||Tb.Nb.keyCode>=fk.a.p3b&&Tb.Nb.keyCode<=fk.a.q3b)return!1;if(Tb.eventName===U.a.hj){Tb=Tb.Nb.keyCode;let Ud=-1;Tb===Sys.UI.Key.enter?(this.teg(Ac.id),this.Yb.HN(this.dN,!0),this.Yb.au().Nk.hA(Ac),Ac.focus()):Tb===Sys.UI.Key.up?Ud=hd-15:Tb===Sys.UI.Key.down?Ud=
hd+15:Tb===Sys.UI.Key.left?Ud=m.AFrameworkApplication.isRtl?hd+1:hd-1:Tb===Sys.UI.Key.right&&(Ud=m.AFrameworkApplication.isRtl?hd-1:hd+1);0<=Ud&&(Ac=this.pNf("symbol_d_"+Ud))&&Ac.focus()}return!0};this.ga=Q;this.Yb=Da;this.blb=eb;this.Qe(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Qe(0,CommonUIStrings.l_DialogClose);this.nda=!1;this.kh=na.kh;this.Ng="InsertSymbolsDialog"}dispose(){0<db.Y$e&&Ca.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",
this.dVe,db.Y$e);db.ndh++;Ca.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",db.ndh);this.ga=this.blb=null;super.dispose()}x_a(){this.mi(Box4Intl.Box4Strings.L_SymbolSingle,this.F8m,null);this.dVe=0;db.tdh++;Ca.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",db.tdh);const Q=this.pNf("symbol_d_"+db.JJc);Q&&Q.focus()}hide(){var Q=document.getElementById("symbolsContainer");if(Q&&(Q=Q.getElementsByTagName("a")))for(let Da=0;Da<Q.length;Da++)ba.a.removeHandler(Q[Da],
U.a.focus,this.dYj);super.hide()}get Stb(){return db.NJc}set Stb(Q){db.NJc=Q}get Ntb(){return db.DJc}set Ntb(Q){db.DJc=Q}Cba(){super.Cba();var Q=document.getElementById("symbolsContainer");if(Q&&(Q.innerHTML=this.blb.Sdl(),Q=Q.getElementsByTagName("a")))for(let Da=0;Da<Q.length;Da++)ba.a.addHandler(Q[Da],U.a.focus,this.dYj)}Oqa(){const Q=document.getElementById("symbolsContainer");Q&&(this.alb||(this.alb=this.Rcp,this.rr.nb(U.a.click,Q,this.alb),this.rr.nb(U.a.PC,Q,this.alb)),this.MSa||(this.MSa=
this.Tcp,this.oe.nb(U.a.hj,Q,this.MSa),this.oe.nb(U.a.mv,Q,this.MSa),this.oe.nb(U.a.pi,Q,this.MSa)));super.Oqa()}oob(){const Q=document.getElementById("symbolsContainer");Q&&(this.alb&&(this.rr.xc(U.a.click,Q,this.alb),this.rr.xc(U.a.PC,Q,this.alb),this.alb=null),this.MSa&&(this.oe.xc(U.a.hj,Q,this.MSa),this.oe.xc(U.a.mv,Q,this.MSa),this.oe.xc(U.a.pi,Q,this.MSa),this.MSa=null));super.oob()}get vRf(){return!0}A_n(Q){this.kOj("symbol_d_"+db.JJc,!1);db.JJc=parseInt(Q.substr(Q.lastIndexOf("_")+1));this.kOj(Q,
!0);if(Q=document.getElementById("SymbolNameValueLabel")){const Da=this.r8d(db.JJc);Q.innerText=Da.altText}}r8d(Q){const Da=this.blb.NAe.OFg.value,eb=qg.a(Da);return Da[eb[Q]]}teg(Q){this.dVe++;db.Y$e++;Q=parseInt(Q.substr(Q.lastIndexOf("_")+1));const Da=this.r8d(Q),eb={};eb.SourceControlId="symbol_"+Q+"_"+Da.LAe;this.ga.Pb(Gd.a.isb,2,eb);Ca.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",Q)}pNf(Q){const Da=document.getElementById("symbolsContainer");return Da?Da.querySelector("#"+
Q):null}kOj(Q,Da){if(Q=this.pNf(Q))Da?(Q.setAttribute("selected","true"),Q.setAttribute("aria-selected","true"),Q.tabIndex=0):(Q.removeAttribute("selected"),Q.setAttribute("aria-selected","false"),Q.tabIndex=-1)}}db.JJc=0;db.NJc=null;db.DJc=null;db.tdh=0;db.ndh=0;db.Y$e=0;Object(f.a)(db,"InsertSymbolsDialog",fo.a,[]);class Pb{constructor(Q,Da,eb,Tb,Ac,hd,Ud){this.YJm=()=>this.blb.Lel();this.Ivj=(Ee,Me,Kf,th,Fj)=>{if(1===Kf)return 32;Ee=this.blb.oqj(Fj);Ee=String.format(this.blb.Scp,Ee.character);
Fj[vd.a.InnerHTML]=Ee;Fj[vd.a.On]=!1;return 32};this.HWa=(Ee,Me,Kf,th,Fj)=>{if(({ne:Ee,selected:Kf,HWa:kk}=this.NXc(Me,Kf)).returnValue)return kk;var uh=gg.a.pf(Kf);let hi=!0;Kf=8;var kk=this.Qc.Nc(15);kk.Bb(Ee.od);uh||(Kf=this.ga.Nf(Me,Gd.a.Ira,2,!0,th,null),Me=32===Kf,Ca.ULS.shipAssertTag(6407387,348,Me,"DeleteForReplace did not succeed. Response is {0}",Kf),hi=Me);hi&&(Me=Ee.mb.Mg,uh=gg.a.pf(Me),Ca.ULS.shipAssertTag(6407388,348,uh,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",
Me.contextId),Kf=8,uh&&(Kf=this.ga.Nf(Me,Gd.a.isb,2,!1,th,Fj),Ca.ULS.shipAssertTag(6407389,348,32===Kf,"Insertion at IP context did not succeed. Response is {0}",Kf),32===Kf&&Sf.FocusManager.instance().Jg(Ee.nL)));kk.dispose();return Kf};this.E8m=(Ee,Me,Kf,th,Fj)=>{if(1===Kf)return 32;if(gg.a.D$a(Me))return 2;Ee=this.blb.oqj(Fj);th.Bt=Ee.index;th=this.Zc.kg(Me.node);Kf=th.vb(11);Ca.ULS.shipAssertTag(6379466,324,Kf,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",ze.a[Me.node.type]);
Kf=this.Qc.Nc(15);Kf.mu(th);Pb.Fg.Ve(Me,Ee.character,!0,!1);Me=Wf.SelectionFactory.ue(th.currentNode,Me.cpBegin+1);this.hb.Kc(Me);Kf.dispose();return 32};this.tXb=(Ee,Me,Kf,th,Fj)=>{if(1===Kf)return 32;Fj.MenuItems=this.$Mk.value;return 32};this.eYj=(Ee,Me,Kf)=>{({HWa:Ee}=this.NXc(Me,Kf));return Ee};this.OSj=(Ee,Me,Kf)=>{2===Kf&&(new db(this.ga,Sf.FocusManager.instance(),La.a.instance.resolve(1239))).x_a();return 32};this.vng=()=>32;this.ga=Q;this.Zc=Da;this.$Mk=new tb.a(this.YJm);this.Qc=eb;this.blb=
Tb;this.xl=Ac;this.hb=hd;this.Sn=Ud}Xb(){this.ga.fb(Gd.a.vng,Uc.a.application,this.vng,96);this.ga.qa(Gd.a.tXb,Uc.a.view,this.tXb);this.ga.qa(Gd.a.MAe,Uc.a.view,this.eYj);this.ga.qa(Gd.a.vre,Uc.a.view,this.Ivj);this.ga.qa(Gd.a.isb,Uc.a.view,this.HWa);this.ga.qa(Gd.a.tXb,Uc.a.Xc,this.tXb);this.ga.qa(Gd.a.MAe,Uc.a.Xc,this.eYj);this.ga.qa(Gd.a.vre,Uc.a.Xc,this.Ivj);this.ga.qa(Gd.a.isb,Uc.a.Xc,this.E8m);this.ga.Pc(Gd.a.tXb,1124);this.ga.Pc(Gd.a.MAe,1036);this.ga.Pc(Gd.a.vre,1124);this.ga.Pc(Gd.a.isb,
1036);m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("InsertMoreSymbolsIsEnabled")&&(this.ga.qa(Gd.a.i7c,Uc.a.view,this.OSj),this.ga.qa(Gd.a.i7c,Uc.a.Xc,this.OSj),this.ga.Pc(Gd.a.i7c,1124))}NXc(Q,Da){let eb,Tb=null;Q.view.te&&(Tb=Q.view);eb=null;if(!Tb||!Tb.mb)return P.b(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",Q.toString()),{returnValue:!0,ne:Tb,selected:eb,HWa:8};eb=Tb.mb.Mg;if(!eb)return{returnValue:!0,
ne:Tb,selected:eb,HWa:2};if(this.xl.q2(eb)||this.xl.Nla(eb))return{returnValue:!0,ne:Tb,selected:eb,HWa:8};if(Tb.mb.gb.FL||this.Sn&&this.Sn.instance&&this.Sn.instance.sX(eb)||gg.a.D$a(Q.Ik))return{returnValue:!0,ne:Tb,selected:eb,HWa:2};if(Object(Rg.a)().NEa(ii.ParagraphReader.qX,eb))return Q=8,Pb.Dc.$b(Ej.a.Re,{["Reason"]:bd.a.QQ}),{returnValue:!0,ne:Tb,selected:eb,HWa:Q};Q=32;return 1===Da?{returnValue:!0,ne:Tb,selected:eb,HWa:Q}:{returnValue:!1,ne:Tb,selected:eb,HWa:Q}}static get Fg(){return Pb.Qd||
(Pb.Qd=La.a.instance.resolve(322))}static set Fg(Q){Pb.Qd=Q}static get Dc(){return Vb.a.instance}}Pb.Qd=null;Object(f.a)(Pb,"SymbolsActor",null,[1268]);class Rb{constructor(Q,Da){this.LAe=Q;this.altText=Da}}Object(f.a)(Rb,"Symbol",null,[]);class sc{constructor(){this.D9e=null;this.GFh=new tb.a(sc.mtf)}get OFg(){return this.GFh}nzi(Q){this.D9e||(this.D9e=qg.a(this.GFh.value));return Array.indexOf(this.D9e,Q)}static mtf(){const Q={};Q["\u2022"]=new Rb("\u2022",Box4Intl.Box4Strings.L_Bullet);Q["\u20ac"]=
new Rb("\u20ac",Box4Intl.Box4Strings.L_EuroSign);Q["\u00a3"]=new Rb("\u00a3",Box4Intl.Box4Strings.L_PoundSign);Q["\u00a5"]=new Rb("\u00a5",Box4Intl.Box4Strings.L_YenSign);Q["\u00a9"]=new Rb("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);Q["\u00ae"]=new Rb("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);Q["\u2122"]=new Rb("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);Q["\u00b1"]=new Rb("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);Q["\u2260"]=new Rb("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);Q["\u2264"]=
new Rb("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);Q["\u2265"]=new Rb("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);Q["\u00f7"]=new Rb("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);Q["\u00d7"]=new Rb("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);Q["\u221e"]=new Rb("\u221e",Box4Intl.Box4Strings.L_Infinity);Q["\u00b5"]=new Rb("\u00b5",Box4Intl.Box4Strings.L_MicroSign);Q["\u03b1"]=new Rb("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);Q["\u03b2"]=new Rb("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);
Q["\u03c0"]=new Rb("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);Q["\u03a9"]=new Rb("\u03a9",Box4Intl.Box4Strings.L_OhmSign);Q["\u03a3"]=new Rb("\u03a3",Box4Intl.Box4Strings.L_NArySummation);Q["\u00b0"]=new Rb("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);Q["\u0394"]=new Rb("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);Q["\u263a"]=new Rb("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);Q["\u2665"]=new Rb("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);Q["\u20b9"]=new Rb("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);
Q["\u00bf"]=new Rb("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);Q["\u00a1"]=new Rb("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);Q["\u2014"]=new Rb("\u2014",Box4Intl.Box4Strings.L_EmDash);Q["\u2026"]=new Rb("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);Q["\u00c0"]=new Rb("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);Q["\u00c1"]=new Rb("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);Q["\u00c2"]=new Rb("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);
Q["\u00c3"]=new Rb("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);Q["\u00c4"]=new Rb("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);Q["\u00c5"]=new Rb("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);Q["\u00c6"]=new Rb("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);Q["\u00c7"]=new Rb("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);Q["\u00c8"]=new Rb("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);Q["\u00c9"]=new Rb("\u00c9",
Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);Q["\u00ca"]=new Rb("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);Q["\u00cb"]=new Rb("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);Q["\u00cc"]=new Rb("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);Q["\u00cd"]=new Rb("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);Q["\u00ce"]=new Rb("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);Q["\u00cf"]=new Rb("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);
Q["\u00d1"]=new Rb("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);Q["\u00d2"]=new Rb("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);Q["\u00d3"]=new Rb("\u00d3",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);Q["\u00d4"]=new Rb("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);Q["\u00d5"]=new Rb("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);Q["\u00d6"]=new Rb("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);Q["\u00d9"]=
new Rb("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);Q["\u00da"]=new Rb("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);Q["\u00db"]=new Rb("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);Q["\u00dc"]=new Rb("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);Q["\u00df"]=new Rb("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);Q["\u00e0"]=new Rb("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);Q["\u00e1"]=new Rb("\u00e1",
Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);Q["\u00e2"]=new Rb("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);Q["\u00e3"]=new Rb("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);Q["\u00e4"]=new Rb("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);Q["\u00e5"]=new Rb("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);Q["\u00e6"]=new Rb("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);Q["\u00e7"]=new Rb("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);
Q["\u00e8"]=new Rb("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);Q["\u00e9"]=new Rb("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);Q["\u00ea"]=new Rb("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);Q["\u00eb"]=new Rb("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);Q["\u00ec"]=new Rb("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);Q["\u00ed"]=new Rb("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);Q["\u00ee"]=new Rb("\u00ee",
Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);Q["\u00ef"]=new Rb("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);Q["\u00f1"]=new Rb("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);Q["\u00f2"]=new Rb("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);Q["\u00f3"]=new Rb("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);Q["\u00f4"]=new Rb("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);Q["\u00f5"]=new Rb("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);
Q["\u00f6"]=new Rb("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);Q["\u00f9"]=new Rb("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);Q["\u00fa"]=new Rb("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);Q["\u00fb"]=new Rb("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);Q["\u00fc"]=new Rb("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);Q["\u00ff"]=new Rb("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);Q["\u011e"]=
new Rb("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);Q["\u011f"]=new Rb("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);Q["\u0130"]=new Rb("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);Q["\u0131"]=new Rb("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);Q["\u0152"]=new Rb("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);Q["\u0153"]=new Rb("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);Q["\u015e"]=new Rb("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);
Q["\u015f"]=new Rb("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);Q["\u0178"]=new Rb("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return Q}}Object(f.a)(sc,"SymbolsLoader",null,[1267]);var Nc=d(411),wc=d(339),ub=d(207),ee=d(632),We=d(1336),re=d(226),jf=d(97);class $e{constructor(Q){this.NAe=Q}get Scp(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}oqj(Q){Q=Q.SourceControlId.split("_");const Da={};2===Q.length?(Da.character=
Q[1],Da.index=this.NAe.nzi(Da.character)):(Da.character=Q[2],Da.index=parseInt(Q[1]));return Da}Lel(){return this.vGi()}build(){return this.ZJm()}Sdl(){const Q=new Sys.StringBuilder;Q.append('<table class="moreSymbolsTable">');const Da=this.NAe.OFg.value,eb=qg.a(Da);let Tb=0;for(;Tb<eb.length;){Tb%15||Q.append('<tr role="presentation">');const Ac=Da[eb[Tb]];Q.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabIndex="-1" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+Tb,Ya.a.N_(Ac.LAe),Ya.a.N_(Ac.altText)));Tb++;Tb%15&&Tb!==eb.length||Q.append("</tr>")}Q.append("</table>");return Q.toString()}ZJm(){const Q=this.vGi();return re.o(Q)}vGi(){const Q=Object.assign(new Nc.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});Q.MenuSectionList.push(this.wXk());m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("InsertMoreSymbolsIsEnabled")&&Q.MenuSectionList.push(this.CVk());return Q}CVk(){const Q=Object.assign(new wc.a,{Id:"msMoreSymbols",Title:"",DisplayMode:"Menu16",
ControlsId:"ctrlMoreSymbols",ControlList:[]}),Da=Object.assign(new ub.a,{Id:"btnMoreSymbols",Command:Gd.a.i7c.toString(),LabelText:Ya.a.Jf(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:Ya.a.Jf(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:m.AFrameworkApplication.Ss,Image16by16Class:jf.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});Q.ControlList.push(Da);return Q}wXk(){const Q=Object.assign(new wc.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),
Da=Object.assign(new ee.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),eb=this.NAe.OFg.value,Tb=qg.a(eb),Ac=Math.min(25,Tb.length);for(let Ud=0;Ud<Ac;Ud++){var hd=eb[Tb[Ud]];hd=Object.assign(new We.a,{Id:String.format("{0}{1}_{2}","symbol_",Ud,hd.LAe),Character:hd.LAe,Command:Gd.a.isb.toString(),QueryCommand:Gd.a.vre.toString(),Alt:Ya.a.Jf(hd.altText)});Da.GalleryItems.push(hd)}Q.ControlList.push(Da);
return Q}}Object(f.a)($e,"SymbolsUiBuilder",null,[1266]);var Cg=d(51),Tg=d(253),Dd=d(545),nh=d(337);class bj{constructor(){this.W=null}get name(){return"Box4.Symbols"}init(){m.AFrameworkApplication.J.$("InsertSymbolIsEnabled")&&this.W.resolve(1240).Xb()}dispose(){}uc(Q){this.W=Q;this.W.register(sc,"Box4.Symbols.SymbolsLoader").as(1241).ha();this.W.ia("Box4.Symbols.SymbolsUiBuilder",()=>new $e(this.W.resolve(1241))).as(1239).ha();this.W.ia("Box4.Symbols.SymbolsActor",()=>new Pb(m.AFrameworkApplication.va,
new Dd.a,new nh.a,this.W.resolve(1239),Tg.a.instance,Cg.a.instance,this.W.Ra(51))).as(1240).ha()}static main(){C.a.instance.Lc(new bj)}}Object(f.a)(bj,"Box4SymbolsPackage",null,[0,1]);var fe=window.AccCheckerPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AccCheckerTaskPane",Width:"300",Overflow:"auto"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AccCheckResultsPlaceHolder",IsStretched:"true",MinHeight:"400"}}]}]}]},
Ge=d(1579),og=d(1514),Hi=d(1484),Nh=d(1983),ji=d(292),qi=d(410);class ai{constructor(){this.uPa=null}uc(Q){this.container=Q}init(){this.uPa=this.container.resolve(1242)}dispose(){this.uPa&&this.uPa.dispose()}}Object(f.a)(ai,"ALiveBooksAccessibilityCheckPackageManager",null,[0,1]);class Ll{get Uxl(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get Vxl(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get Wxl(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get s3n(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get Nsc(){return CommonUIStrings.l_AccCheckerPaneTitle}get j7n(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}
Object(f.a)(Ll,"AccessibilityCheckStringsProvider",null,[1099]);class cl{constructor(){this.RGj=this.contentId=null}}Object(f.a)(cl,"ResultIds",null,[]);class nk{constructor(Q,Da){this._element=null;this.Dg=Da;this.oe=Q}get element(){this._element||(this._element=this.WCl(),this.$A());return this._element}eAg(Q){this._element=Q}dispose(){this.element&&(this.Jca(),this.eAg(null))}$A(){this.Dg&&this.oe?(this.Dg.nb(U.a.click,this.element,Object(R.a)(this,this.onClick,"onClick")),this.oe.nb(U.a.hj,this.element,
Object(R.a)(this,this.HI,"onKeyPress"))):Ca.ULS.shipAssertTag(19789026,334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}Jca(){this.Dg&&this.oe&&(this.Dg.xc(U.a.click,this.element,Object(R.a)(this,this.onClick,"onClick")),this.oe.xc(U.a.hj,this.element,Object(R.a)(this,this.HI,"onKeyPress")))}onClick(){this.Mjj();return!0}HI(Q){return this.Nin(Q.Nb.keyCode)?(this.Mjj(),!0):!1}Nin(Q){return Q===fk.a.itd||Q===fk.a.Nu}}
Object(f.a)(nk,"AInteractivePaneElement",null,[1109,10]);var wg=d(451),pd=d(79);class Ak extends nk{constructor(Q,Da,eb){super(Q,Da);this.f1e=eb}hide(){this.element.removeAttribute(ie.a.Ph);ie.a.Gs(this.element,ie.a.vA,ie.a.fq);this.element.style.display="none"}show(){ie.a.Gs(this.element,ie.a.vA,ie.a.FO);ie.a.Gs(this.element,ie.a.Ph,ie.a.hif);this.element.style.display="block"}WCl(){const Q=wg.b("div",this.$fj,"AccCheckerNotification");ie.a.Gs(Q,ie.a.QSh,ie.a.fq);ie.a.Gs(Q,ie.a.Bja,this.sbg);Q.tabIndex=
0;const Da=wg.b("span",this.Zfj,"AccCheckerNotificationIcon");var eb=jf.createClusteredImage(16,16,"Info_16x16x32","",!0,"");Da.appendChild(eb);eb=wg.b("span",this.sbg,"AccCheckerNotificationText");pd.a.Jx(eb,this.agj);Q.appendChild(Da);Q.appendChild(eb);return Q}Mjj(){this.f1e()}}Object(f.a)(Ak,"APopupNotification",nk,[1168,1109,10]);class Ql extends Ak{constructor(Q,Da,eb,Tb){super(Q,Da,eb);this.kya=Tb}get $fj(){return"AccCheckerOutOfSyncNotificationId"}get Zfj(){return"AccCheckerOutOfSyncNotificationIconId"}get sbg(){return"AccCheckerOutOfSyncNotificationTextId"}get agj(){return this.kya.s3n}}
Object(f.a)(Ql,"OutOfSyncNotification",Ak,[]);class an extends Ak{constructor(Q,Da,eb,Tb){super(Q,Da,eb);this.kya=Tb}get $fj(){return"AccCheckerPartialResultNotificationId"}get Zfj(){return"AccCheckerPartialResultNotificationIconId"}get sbg(){return"AccCheckerPartialResultNotificationTextId"}get agj(){return this.kya.j7n}}Object(f.a)(an,"PartialResultNotification",Ak,[]);var Jg=d(183),ln=d(30),Ck=d(235);class Xl{constructor(Q,Da,eb,Tb=null,Ac=null,hd=null,Ud=null){this.WAh=this.sO=this.oe=this.uPa=
null;this.FXa=Tb;this.Dg=Q;this.Yb=Da;this.Zp=eb;this.kya=Ud||new Ll;this.W1e=Ac||new Ql(this.FXa,this.Dg,Object(R.a)(this,this.ERl,"dimissOutOfSyncNotification"),this.kya);this.L2e=hd||new an(this.FXa,this.Dg,Object(R.a)(this,this.FRl,"dimissPartialResultNotification"),this.kya)}show(){}hide(){}get FXa(){return this.oe||(this.oe=m.AFrameworkApplication.ua.LE)}set FXa(Q){this.oe=Q}h8h(){}Lsa(){}dispose(){}kfb(){}Q$m(Q){var Da=this.WAh[Q];Q=Da.contentId;if((Da=Da.RGj+"")&&Da.length){const eb=[];Array.add(eb,
Object.assign(new ln.a,{name:"RuleID",string:Da}));Jg.a.sendTelemetryEvent(Object.assign(new Ck.a,{name:String.format("{0}.{1}",Xl.MGg,"ViolationSelected"),dataFields:eb}))}this.HMn(Q)}HMn(Q){Q&&this.uPa.EQo(Q)||(this.Yb.HN(Af.AFrame.cKh,!1),this.k3o())}ERl(){this.Jod(!1)}FRl(){this.GSj(!1)}k3o(){const Q=Object.assign(new zg.StandardDialog(!0),{Bu:m.AFrameworkApplication.Jfa,Fd:1,$Na:!1});Q.gY(1);Q.Qe(1,this.kya.Uxl);Q.Qe(0,CommonUIStrings.l_DialogCancel);Q.jY(this.kya.Wxl,this.kya.Vxl,Da=>{1===Da&&
this.TVf()})}Qel(Q){let Da=null;if(Q.Results&&0<Q.Results.length){Da={};let eb=0;for(const Tb of Q.Results)Tb.ResultId=Xl.jRk+ ++eb,Q=new cl,Q.contentId=Tb.ContentId,Q.RGj=Tb.RuleId,Da[Tb.ResultId]=Q}return Da}DCn(){Jg.a.addNamespaceMapping(Xl.MGg,Xl.lfp);Jg.a.sendTelemetryEvent(Object.assign(new Ck.a,{name:String.format("{0}.{1}",Xl.MGg,"ShowTaskpane")}))}}Xl.jRk="AccCheckResult";Xl.MGg="Office.UX.AccChecker";Xl.lfp="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(f.a)(Xl,
"BaseAccessibilityCheckPane",null,[1101,10]);class mm{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(f.a)(mm,"AccCheckerTaskPaneProps",null,[]);var fd=d(1724),Mc=d(1857),Pi=d(1492),Uj=d(194);class tk extends Xl{constructor(Q,Da,eb,Tb,Ac=null,hd=null,Ud,Ee=null,Me=null){super(Da,
eb,Tb,hd,void 0,void 0,Ee);this.O6g=null;this.Hzh=this.K2e=this.QHd=this.ZKd=this.wKd=!1;this.Yaf=null;this.W9e=!!m.AFrameworkApplication.ua&&!!m.AFrameworkApplication.ua.Ib&&m.AFrameworkApplication.ua.Ib.o0f;this.UGc=this.j9=null;this.FHc=0;this.XBd=null;this.W0=Ac;Me&&(this.j9=Me.PPd,this.UGc=Me.eYp,this.FHc=Me.H_p);this.wC=new Mc.a}get isVisible(){return this.Hzh}r_a(Q){this.Hzh=Q}gxf(Q){Q&&(this.O6g=Q,Q.IsSuccess&&(this.WAh=this.Qel(Q),Q.IsPartialResult&&this.GSj(!0)),this.wKd=!0,this.ZKd=!1,
this.jn())}Jod(Q){this.isVisible&&Q!==this.QHd&&(this.QHd=Q,this.jn())}GSj(Q){this.K2e=Q;this.jn()}kS(){this.ZKd||Uj.UISurfaces.Iv().then(Q=>{$a.a.instance.sA(tk.RAb+":PaneOpen:Start");Q.showTaskPane(tk.RAb,this.EB());this.TVf();return null});this.isVisible?Uj.UISurfaces.Iv().then(Q=>{Q.setSelectedTaskPane(tk.RAb);return null}):this.DCn()}jn(){Uj.UISurfaces.Iv().then(Q=>{Q.updateTaskPane(tk.RAb,this.EB());return null})}EB(){var Q=new mm;this.wC.dyb(Q);Q=Object.assign(new Pi.a,{title:this.kya.Nsc,
hideHeader:!1,width:320,location:2,contentProps:Q,onOpen:()=>{this.lca();this.r_a(!0);m.AFrameworkApplication.ua.Fe()},onClose:()=>{this.bha();this.r_a(!1);this.ZKd=this.wKd=!1;this.jn();m.AFrameworkApplication.ua.Fe()},isModernPane:!0});this.W9e&&(Q.enableResize=!0,Q.minResizeWidth=268,Q.maxResizeWidth=920);return Q}initialize(Q){const Da=this.Yb.ie(tk.RAb);Da.parent=Af.AFrame.Eq;Da.HL=!0;this.uPa=Q;this.sSk()}dispose(){this.kfb();this.W1e&&(this.W1e.dispose(),this.W1e=null);this.L2e&&(this.L2e.dispose(),
this.L2e=null);super.dispose()}sSk(){this.wC.IN(this.onRecheckExecute());this.wC.IN(this.vdm());this.wC.IN(this.MFm());this.wC.IN(this.onInvokeNavigateExecute());this.wC.IN(this.wsm());this.wC.IN(this.DAm());this.wC.IN(this.zCm());this.wC.IN(this.updateLastScanTime());this.wC.IN(this.showHelpPane())}onRecheckExecute(){return Q=>{Q.onRecheckExecute=()=>{this.TVf()}}}vdm(){return Q=>{Q.accessibilityCheckResultCollection=this.O6g}}MFm(){return Q=>{Q.resultsReady=this.wKd}}onInvokeNavigateExecute(){return Q=>
{Q.onInvokeNavigateExecute=Da=>{this.Q$m(Da)}}}wsm(){return Q=>{Q.helpLink=this.y2l}}DAm(){return Q=>{Q.outOfSync=this.QHd}}zCm(){return Q=>{Q.partialResult=this.K2e}}updateLastScanTime(){return Q=>{Q.updateLastScanTime=Da=>{this.Yaf=Da}}}showHelpPane(){return Q=>{Q.showHelpPane=()=>{m.AFrameworkApplication.J&&m.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?m.AFrameworkApplication.gL||this.ySh()?this.XBd?this.XBd():this.j9.value&&this.UGc&&
this.FHc&&this.j9.value.Pb(this.FHc,2,this.UGc):this.ETj():this.ySh()?this.XBd?this.XBd():this.j9.value&&this.UGc&&this.FHc&&this.j9.value.Pb(this.FHc,2,this.UGc):this.ETj()}}}ySh(){return!this.W0||!this.W0.value}ETj(){const Q=this.W0.value;if(Q){var Da={};Da.query=tk.OHk+tk.jwk;Da=Object.assign(new fd.a,{ZR:Da});Q.j4(tk.wTe,Da)}}TVf(){this.K2e=this.QHd=this.wKd=!1;this.Yaf&&this.Yaf();this.jn();this.ZKd=!0;this.uPa.SSn()}lca(){this.Yb.Jg(tk.RAb)}bha(){this.zab()&&this.Yb.Jg(this.Yb.IW)}zab(){return!!this.Yb.currentScope&&
this.Yb.currentScope.name===tk.RAb}}tk.RAb="AccessibilityCheckerPane";tk.jwk="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";tk.wTe="FA000000012";tk.OHk="AssetID=";Object(f.a)(tk,"ReactAccessibilityCheckPane",Xl,[]);class tm extends tk{constructor(Q,Da,eb,Tb,Ac,hd,Ud,Ee,Me=null){super(Q,Da,eb,Tb,Ac,hd,void 0,Me);this.Vsk=Ee;this.V5=Ud}get y2l(){return this.Vsk}kS(){this.V5.nUa();super.kS()}}Object(f.a)(tm,"ReactLiveBooksAccessibilityCheckPane",tk,[]);var Ml=d(1762),Pp=d(136),bi=d(105),Mq=d(62),Ri=d(119),sh=
d(615),Xi=d(516),Ah;(function(Q){Q[Q.error=0]="error";Q[Q.ot=1]="warning";Q[Q.Jkq=2]="tip";Q[Q.A1p=3]="intelligentService"})(Ah||(Ah={}));Object(f.b)("AccessibilityRuleCategory",Ah);class He{constructor(Q,Da,eb=null){this.nIe=null;this.Unh=this.Cmh=!1;this.cTa=Q;this.vvd=Da;this.ga=eb;this.Rb.qa(x.a.grl,z.a.frame,Object(R.a)(this,this.Cof,"closePane"))}get Rb(){return this.ga||(this.ga=m.AFrameworkApplication.va)}set Rb(Q){this.ga=Q}sZl(){this.Cmh||(this.cTa.initialize(this),this.vvd.initialize(this),
this.Cmh=!0)}SSn(){P.b(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.vvd.BGo()}kS(Q,Da,eb){if(1===eb)return Ce.SessionStatusManager.instance.Hk?8:32;this.cTa.isVisible||this.sZl();this.T4o();return 32}Cof(Q,Da,eb){1!==eb&&this.cTa.Lsa();return 32}NZn(){this.cTa.Jod(!0)}gxf(Q){if(Q){if(Q.AccessibilityRules&&Object.keys(Q.AccessibilityRules).length){const eb=Q.AccessibilityRules;for(const Tb in eb){var Da=Tb;const Ac=eb[Tb].RuleId+"";Da!==Ac&&P.b(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",
Da,Ac)}this.nIe=eb}else!this.nIe&&Q.Results&&0<Q.Results.length?(P.b(18993251,200,15,"No accessibility rule definitions available"),Q.IsSuccess=!1):Q.AccessibilityRules=this.nIe;Q.IsSuccess||P.b(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.Jvo(Q);this.tCn(Q);this.cTa.gxf(Q)}}Jvo(Q){const Da=Q.AccessibilityRules;if(Q=Q.Results)for(let eb=Q.length-1;0<=eb;eb--){const Tb=Q[eb];let Ac="";const hd=Tb.RuleId;Tb.ContentName||(Ac+="Result does not have content name. ");hd in Da||(Ac+=String.format("No accessibility check rule exists for ID {0}.",
hd));0<Ac.length&&(P.b(36214999,200,15,"Omitting invalid accessibility check result: "+Ac),Array.removeAt(Q,eb))}}SGm(){return m.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):La.a.instance.resolve(77).JD.loadScript("accessibility-checker-pane-strings")}T4o(){this.Unh?this.cTa.kS():this.SGm().then(()=>{this.Unh=!0;this.cTa.kS()}).catch(Q=>Ca.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",
Q))}tCn(Q){var Da={};const eb={};var Tb=Q.Results,Ac=[];Array.add(Ac,Object.assign(new ln.a,{name:"FinalViolationCount",int64:0}));Array.add(Ac,Object.assign(new ln.a,{name:"FinalErrorCount",string:"0"}));Array.add(Ac,Object.assign(new ln.a,{name:"FinalWarningCount",string:"0"}));Array.add(Ac,Object.assign(new ln.a,{name:"FinalTipCount",string:"0"}));Array.add(Ac,Object.assign(new ln.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(Tb){for(const Ee of Tb)if(Q.AccessibilityRules){var hd=Q.AccessibilityRules[Ee.RuleId];
if(hd){if(Da[Ah[hd.Category]]){let Me=Da[Ah[hd.Category]];Da[Ah[hd.Category]]=++Me}else Da[Ah[hd.Category]]=1;eb[Ee.RuleId]?(hd=eb[Ee.RuleId],eb[Ee.RuleId]=++hd):eb[Ee.RuleId]=1}}Ac[0].int64=Tb.length;for(var Ud in Da)switch(Q=Da[Ud],Tb=Ud,Tb="Final"+Tb.charAt(0).toUpperCase()+Tb.substring(1,Tb.length)+"Count",Tb){case "FinalErrorCount":Ac[1].string=Q.toString();break;case "FinalWarningCount":Ac[2].string=Q.toString();break;case "FinalTipCount":Ac[3].string=Q.toString();break;case "FinalIntelligentServiceCount":Ac[4].string=
Q.toString()}}Jg.a.sendTelemetryEvent(Object.assign(new Ck.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),dataFields:Ac}));for(const Ee in eb)Da=Ee,Ac=eb[Ee],Ud=[],Array.add(Ud,Object.assign(new ln.a,{name:"RuleID",string:Da})),Array.add(Ud,Object.assign(new ln.a,{name:"FinalViolationCount",string:Ac.toString()})),Jg.a.sendTelemetryEvent(Object.assign(new Ck.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:Ud}))}dispose(){this.cTa&&
this.cTa.dispose();this.vvd&&this.vvd.dispose()}}Object(f.a)(He,"AAccessibilityCheckManager",null,[25,10]);var wb=d(450);const ic=[12,14,22,19,30,43,44];class Zc extends He{constructor(Q,Da,eb,Tb,Ac,hd){super(Da,eb,Q);this.Rb.qa(x.a.TBg,z.a.frame,this.kS.bind(this));this.Rb.fb(x.a.kio,z.a.frame,this.Kvj.bind(this),96);this.BR=Ac;this.bDk=Tb;this.vzk=hd;this.fsc=()=>{this.NZn()};this.gso()}Kvj(Q,Da,eb,Tb,Ac){if(1===eb)return 32;Ac[wb.a.On]=this.cTa.isVisible;return 32}EQo(Q){if(this.vzk)return Ca.ULS.sendTraceTag(20713608,
334,15,"ODT file. Disable content navigation."),!0;Ca.ULS.shipAssertTag(20272215,334,!!Q);return this.bDk.AMn(Q)}gso(){for(const Q of ic){const Da=this.BR.jf(Q);Da.jo(this.fsc);Da.wt(this.fsc);Da.Yx(this.fsc)}}Npp(){for(const Q of ic){const Da=this.BR.jf(Q);Da.JP(this.fsc);Da.hS(this.fsc);Da.Rua(this.fsc)}}dispose(){super.dispose();this.Npp()}}Object(f.a)(Zc,"WordAccessibilityCheckManager",He,[]);var dd=d(84),Bd=d(26),Bf=d(101),Zf=d(12),Of=d(163),Ff=d(5),hg=d(20),Jk=d(478);class Fg{constructor(Q,
Da,eb,Tb,Ac,hd,Ud){this.Wn=null;this.BMb=0;this.Zc=Da;this.oG=eb;this.hb=Tb;this.ga=Ac;this.kd=hd;this.Ky=Q;this.yd=Ud}get xS(){if(!this.Wn){const Q=this.Zc.kg(this.Ky.$c);this.oG.wJg(Q);if(Q.vb(7)||Q.ld(7))this.Wn=dd.a.At(Q,Q.origin)}return this.Wn}AMn(Q){if(!Q||!Q.Og||0>=Q.Og.length)return Ca.ULS.shipAssertTag(20272217,334,!1,"ContentId is null or invalid."),!1;var Da=Array(Q.Og.length);let eb=7,Tb=null;for(let hd=0;hd<Q.Og.length;hd++)if(Tb=this.N6l(Q.Og[hd])){if(7===eb)eb=this.BMb;else if(eb!==
this.BMb)return Ca.ULS.shipAssertTag(20272218,334,!1,"Two paragraphs in a range selections don't belong to the same view."),!1;var Ac=this.yd.TYa(Tb.characterData,Tb.ra);const Ud=Q.cpBegin?this.yd.YLb(Ac,Q.cpBegin):-1;Ac=Q.cpEnd?this.yd.YLb(Ac,Q.cpEnd):-1;if(-1>Ud||-1>Ac)return Ca.ULS.shipAssertTag(20272219,334,!1,"Fail to convert WordTextOffset to WAC cp. Reset Cps to -1."),!1;Da[hd]=Bd.a.UT(Ud,Ac,!1,Tb);switch(Q.contentType){case 5:if(!Bf.a.g5c(Da[hd],!1))return!1;break;case 6:if(!Zf.ImageReader.t7(Da[hd]))return!1;
break;case 7:Da[hd]=Bd.a.UT(-1,-1,!1,Tb)}}else return!1;Da=new Of.Selection(Da,!1);return this.zVo(Tb,Da,Q.contentType)}N6l(Q){if(this.xS)for(this.xS.reset(),this.BMb=7;this.xS.moveNext();){var Da=this.xS.currentNode.type;if(38===Da||36===Da||23===Da)this.BMb=Da;else if(12===Da){Da=this.xS.currentNode;const eb=Da.ka(Ff.a.Yc,0);if(Q===eb)return Da}}return null}aYj(Q){this.ga.Ob(hg.a.KW,2);this.ga.Ob(hg.a.I6,2);let Da=2;switch(this.BMb){case 23:Da=32;break;case 38:Da=this.ga.Pb(hg.a.Zbb,2,new Jk.a(Q));
break;case 36:Da=this.ga.Pb(hg.a.Ttb,2,new Jk.a(Q));break;default:Ca.ULS.shipAssertTag(20272220,334,!1,"Unexpected search scope encountered: {0}",this.BMb)}if(32===Da)return!0;Ca.ULS.shipAssertTag(20272221,334,!1,"Fail to switch to target view: {0}",this.BMb);return!1}zVo(Q,Da,eb){if(this.aYj(Q)){Q=this.Ky.Bw;const Tb=this.hb.gb.currentSelection;Tb&&Tb.equals(Da)&&this.kd.iha(Q,null);this.kd.iha(Q,Da);switch(eb){case 0:case 1:this.ga.Ob(Gd.a.UZb,2);break;case 2:this.ga.Ob(Gd.a.amd,2);break;case 3:this.ga.Ob(Gd.a.LDa,
2)}return!0}return!1}}Object(f.a)(Fg,"WordAccessibilityCheckNavigateManager",null,[1305]);class Un{constructor(Q){this.uPa=null;this.fih=Q}get fileId(){return this.fih?this.fih():null}initialize(Q){this.uPa=Q}eij(Q){this.uPa.gxf(Q)}}Object(f.a)(Un,"AAccessibilityCheckService",null,[1100,10]);class $o{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(Q){Q=Sys.Serialization.JavaScriptSerializer.deserialize(Q);const Da=Q.AccessibilityRules,
eb={};if(Da)for(let Tb=0;Tb<Da.length;++Tb){const Ac=Da[Tb];eb[Ac.Key]=Ac.Value}Q.AccessibilityRules=eb;return Q}}Object(f.a)($o,"AccessibilityCheckResultCollection",null,[]);class fh extends Un{constructor(Q){super(Q);this.onFailure=(Da,eb)=>{Ca.ULS.shipAssertTag(20730842,334,!1,"Acc Checker force save failed! StatusCode:{0}",eb);Da=Object.assign(new $o,{IsSuccess:!1});this.eij(Da)};this.sE=Da=>{Da=fh.KFm(Da);let eb=null;if(Da)try{eb=this.XOl(Da)}catch(Tb){Ca.ULS.shipAssertTag(20730843,334,!1,"AccChecker response data is invalid. [{0}]",
Tb.message),eb=Object.assign(new $o,{IsSuccess:!1})}else Ca.ULS.shipAssertTag(20730844,334,!1,"AccChecker response is NULL."),eb=Object.assign(new $o,{IsSuccess:!1});this.eij(eb)}}dispose(){}static KFm(Q){let Da=null;Q&&Q.fk&&(Da=Q.fk[0]);return Da?Da.Body:null}}Object(f.a)(fh,"ALiveBooksAccessibilityCheckService",Un,[]);var Mn=d(834),gj=d(985),cm=d(1328),Oo=d(257),ik=d(446);class Hm extends Oo.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1}$m(){return ik.a.iRk}static construct(Q,
Da){const eb=new Hm;eb.FileId=Q;eb.IsCoauthorable=Da;return eb}}Object(f.a)(Hm,"WordAccessibilityCheckRequest",Oo.a,[]);class Bk{}Object(f.a)(Bk,"AccessibilityCheckRule",null,[]);var cj=d(181);class po{static parse(Q){switch(Ya.a.vh(Q)){case "warnings":return 1;case "tips":return 2;case "errors":return 0;case "intelligentservices":return 3;default:throw Q=String.format("Invalid Accessibility result category: {0}",Q),cj.a.argument(Q);}}}Object(f.a)(po,"AccessibilityRuleCategoryParser",null,[]);class Zp{constructor(){this.Category=
this.Text=this.Id=null}static vhp(Q){const Da=new Bk;Da.RuleId=Q.Id;Da.RuleName=Q.Text;Da.Category=po.parse(Q.Category);return Da}}Object(f.a)(Zp,"WordAccessibilityCheckRule",null,[]);class mq{}Object(f.a)(mq,"AccessibilityCheckResult",null,[]);class lc{constructor(){this.cpEnd=this.cpBegin=this.Og=null;this.contentType=0}}Object(f.a)(lc,"WordAccessibilityCheckContentId",null,[]);const bn=Q=>{switch(Ya.a.vh(Q)){case "tableheading":return 0;case "tablerow":return 1;case "tablecolumn":return 2;case "table":return 3;
case "textcontrast":return 4;case "hyperlink":return 5;case "inlinepicture":return 6;case "anchoredepicture":return 7;default:return 8}};var Ec=d(1530);class yl{constructor(){this.OE=this.OS=this.ContentType=this.Label=this.RuleId=this.ParaId=null}static thp(Q){const Da=new mq;Da.RuleId=Q.RuleId;Da.ContentName=Q.Label;const eb=new lc;eb.Og=Q.ParaId;eb.cpBegin=Ec.b(Q.OS);eb.cpEnd=Ec.b(Q.OE);eb.contentType=bn(Q.ContentType);Da.ContentId=eb;return Da}}Object(f.a)(yl,"WordAccessibilityViolation",null,
[]);class np{constructor(){this.Violations=this.Rules=null}static uhp(Q){const Da=new $o;try{var eb={};if(Q.Rules){for(let Tb=0;Tb<Q.Rules.length;++Tb){const Ac=Zp.vhp(Q.Rules[Tb]);eb[Ac.RuleId]=Ac}Da.AccessibilityRules=eb}if(Q.Violations){const Tb=Array(Q.Violations.length);for(eb=0;eb<Q.Violations.length;++eb)Tb[eb]=yl.thp(Q.Violations[eb]);Da.Results=Tb}Da.IsPartialResult=!1;Da.IsSuccess=!0}catch(Tb){Ca.ULS.shipAssertTag(20272214,334,!1,"Failed to convert WordAccessibilityCheckResult to AccessibilityCheckResultCollection. [{0}]",
Tb.message),Da.IsSuccess=!1}return Da}}Object(f.a)(np,"WordAccessibilityCheckResult",null,[]);class ap extends fh{constructor(Q,Da,eb){super(Q);this.uDb=Da;this.Lib=eb}BGo(){const Q=Object.assign(new Mn.a,{Wq:Hm.construct(this.fileId,this.Lib),status:gj.a.nH,vE:"AccessibilityCheck"});this.uDb(cm.a.kRk,!1,this.sE,this.onFailure,Q,null,Q)}XOl(Q){Q=Za.b(Q);return np.uhp(Q)}}Object(f.a)(ap,"WordAccessibilityCheckService",fh,[]);class Dn extends ai{constructor(){super()}get name(){return"WordEditor.AccessibilityChecker"}uc(Q){super.uc(Q);
Q.ia(1245,()=>new tm(m.AFrameworkApplication.va,ji.a.instance,Sf.FocusManager.instance(),qi.a.instance,Q.rf(1243),gd.KeyInputManager.instance,Ml.a.instance,m.AFrameworkApplication.J.ib("AccessibilityCheckerHelpUrl"))).ha();Q.ia(1246,()=>new ap(()=>m.AFrameworkApplication.rootQuerySignature,Xi.a.fU,Pp.PageReader.instance.j6d(ld.StaticActiveAppFrame.za().kb.$c))).ha();Q.ia(1247,()=>new Fg(ld.StaticActiveAppFrame.za().kb,Q.resolve(292),Object(bi.a)(),Q.resolve(326),m.AFrameworkApplication.va,Object(Mq.a)(),
Q.resolve(1244))).ha();Q.ia(1242,()=>new Zc(m.AFrameworkApplication.va,Q.resolve(1245),Q.resolve(1246),Q.resolve(1247),Ri.a.gf.Ll,sh.a.q9c)).ha()}init(){this.container.resolve(12).us.continueWith(()=>{ai.prototype.init.call(this)})}}Object(f.a)(Dn,"WordAccCheckerPackageManager",ai,[]);var Co;(function(Q){Q[Q.f_p=0]="graphSpaceReplicatorNotSendingContent";Q[Q.X0p=1]="inboundRequestTakesTooLongToSendAfterRTC";Q[Q.sVp=2]="docxSaveMonitorKickoutElapsed"})(Co||(Co={}));Object(f.b)("ComponentLoggingScenario",
Co);var zp=d(1321);class Do{flush(Q,Da){const eb=this.$mm(Q);eb.LoggingScenario=Co[Da];qg.a(eb).length?Ca.ULS.sendTraceTag(594571986,3013,15,"{0}",eb):Ca.ULS.sendTraceTag(594571987,3013,15,"No log returned when component state log manager trying to log with {0}",zp.a[Q.J6a])}$mm(Q){const Da={};if(!Q)return Da;const eb=new Od.a;for(eb.enqueue(Q);!eb.isEmpty;){Q=eb.dequeue();const Tb=zp.a[Q.J6a];try{Da[Tb]=Q.ZC()}catch(Ac){Ca.ULS.sendTraceTag(594571985,3013,15,"Exception when component state log manager trying to log with {0}, details: {1}",
Tb.toString(),{["Kind"]:"Exception",["Stack"]:Ac.stack,["Message"]:Ac.message,["FileName"]:Ac.fileName,["LineNumber"]:Ac.lineNumber})}if((Q=Q.iWd)&&Q.length)for(const Ac of Q)!Ac||zp.a[Ac.J6a]in Da||eb.enqueue(Ac)}return Da}}Object(f.a)(Do,"ComponentStateLogManager",null,[1264]);class vc{flush(){}}Object(f.a)(vc,"NoOpComponentStateLogManager",null,[1264]);class go{constructor(){this.W=null}get name(){return"WordEditor.ComponentStateLogging"}init(){this.W.resolve(1233)}dispose(){}uc(Q){this.W=Q;m.AFrameworkApplication.J.$("ComponentStateLoggingPackageIsEnabled")?
Q.ia("WordEditor.ComponentStateLogging.ComponentStateLogManager",()=>new Do).as(1233).ha():Q.ia("WordEditor.ComponentStateLogging.NoOpComponentStateLogManager",()=>new vc).as(1233).ha()}static main(){C.a.instance.Lc(new go)}}Object(f.a)(go,"WordEditorComponentStateLoggingPackage",null,[0,1]);var nm=d(1154),zl=d(638),ck=d(776),vl=d(777),Xk=d(69);class Vg{constructor(Q,Da=null,eb=-1,Tb=null){this.U1=Q;this.aJh=Tb||(()=>Da);this.Syd=eb}Wj(Q,Da,eb,Tb,Ac,hd,Ud,Ee,Me,Kf=null,th=!1,Fj=null,uh=null){const hi=
new XMLHttpRequest;let kk="";hd="";2===Da?(kk="POST",eb&&(hd=eb)):kk="GET";Da={};this.U1&&(Q=nm.a.FUk(Da,Q,Xk.a.QEe,m.AFrameworkApplication.nAb,this.U1));hi.open(kk,Q,!0);this.Pel(Da,Q);if(Tb)for(const Aa in Tb)hi.setRequestHeader(Aa,Ya.a.gP(Tb[Aa]));for(const Aa in Da)hi.setRequestHeader(Aa,Da[Aa]);Q=Fj||this.Syd;0<Q&&(hi.timeout=Q);Q=[];Array.add(Q,Xk.a.s2);Tb=new Sys.Net.WebRequest;const kl=new ck.a(1,2,Tb,Q,Ac,Ud,Ee,Me,th,Kf,uh);hi.onreadystatechange=()=>{this.fZn(hi,kl)};try{hi.send(hd)}catch(Aa){Ca.ULS.sendTraceTag(24938643,
205,15,"Invoke failed in SimpleClientRequestSender")}return 1}mkc(){return 1}fZn(Q,Da){if(this.snl(Q,Da)&&4===Q.readyState)if(Q.getResponseHeader(Xk.a.Dii)&&m.AFrameworkApplication.CZc)m.AFrameworkApplication.CZc();else{var eb=Q.getResponseHeader(Xk.a.tmf);nm.a.NDe(eb);this.gwp(Q,Da);Q.status===ki.a.pz?(Da.status=2,Da.jK(new vl.a(Da))):(Da.status=Q.status&&Q.status!==ki.a.bxb?Q.status===ki.a.g8?5:3:7,Da.T6(new zl.a(Da)))}}Pel(Q,Da){Q["X-xhr"]=1;m.AFrameworkApplication.iXa&&(Q[Xk.a.W8i]=1);m.AFrameworkApplication.buildVersion&&
(Q[Xk.a.urc]=Ya.a.gP(m.AFrameworkApplication.buildVersion));let eb=null;this.aJh&&(eb=this.aJh());eb&&(Q[Xk.a.uNg]=eb);m.AFrameworkApplication.WM&&(Q[Xk.a.dLb]=Ya.a.gP(m.AFrameworkApplication.WM),m.AFrameworkApplication.iqc&&Ca.ULS.sendTraceTag(24938644,205,50,"Canary in request: {0}",Q[Xk.a.dLb]));m.AFrameworkApplication.accessToken&&(nm.a.r0h(Da,m.AFrameworkApplication.b6)||(Q[Xk.a.wKh]=Ya.a.gP(m.AFrameworkApplication.accessToken)),nm.a.r0h(Da,m.AFrameworkApplication.vqa)||(Q[Xk.a.xKh]=m.AFrameworkApplication.bTa.toString()));
m.AFrameworkApplication.userType&&(Q[Xk.a.V8j]=Ya.a.gP(m.AFrameworkApplication.userType))}gwp(Q,Da){Da.Ie=Q.status?Q.status:ki.a.bxb;try{Da.De=Q.responseText;if(void 0!==Da.RZa&&null!==Da.RZa){Da.vi={};for(let eb=0;eb<Da.RZa.length;++eb){const Tb=Da.RZa[eb];Da.vi[Tb]=Q.getResponseHeader(Tb)}}Da.kye&&(Da.cna=Q.responseText&&Q.responseText.length?Q.responseXML:null)}catch(eb){Ca.ULS.sendTraceTag(24938645,205,10,"OnRequestCompleted: Unable to get ResponseData/XML, Id={0}, Url={1} ResponseAvailable={2}",
Da.id,Da.request.get_url(),4===Q.readyState)}}snl(Q,Da){return Q?Da?!0:(Ca.ULS.sendTraceTag(24938648,205,15,"OnRequestCompleted in SimpleClientRequestSender: RequestItem doesn't exist."),!1):(Ca.ULS.sendTraceTag(24938646,205,15,"OnRequestCompleted in SimpleClientRequestSender: XMLHttpRequest doesn't exist."),!1)}static create(Q,Da,eb){return new Vg(Q,null,eb,Da)}}Object(f.a)(Vg,"SimpleClientRequestSender",null,[1775]);class $p{constructor(Q,Da,eb){this.Gf=Q;this.iMd=Da;this.Fzh=eb}Wj(Q,Da,eb,Tb,Ac,
hd,Ud,Ee,Me,Kf=null,th=!1,Fj=null,uh=null,hi=null,kk=null,kl=!1){return this.Fzh?this.iMd.Wj(Q,Da,eb,Tb,Ac,hd,Ud,Ee,Me,Kf,th,uh,hi):this.Gf.Wj(Q,Da,eb,Tb,Ac,hd,Ud,Ee,Me,Kf,th,Fj,uh,hi,kk,kl)}mkc(Q){return this.Fzh?this.iMd.mkc():this.Gf.mkc(Q)}}Object(f.a)($p,"ClientRequestAdapter",null,[1833]);var Rl=d(220),yf=d(242),Pm=d(230),Og=d(1266),Dl=d(1275),Yl=d(1330),Mk=d(45),Eo=d(734),qo=d(594),ro=d(91),Fo=d(575),pp=d(603),aq;(function(Q){Q[Q.none=0]="none";Q[Q.gti=1]="getCells";Q[Q.E$d=2]="hotStoreStatus";
Q[Q.yHj=3]="saveMonitor";Q[Q.Xfq=4]="saveMonitor_LineageTombstone";Q[Q.Itb=5]="kickoutExecutor"})(aq||(aq={}));Object(f.b)("MostRecentRevisionIdOrigin",aq);class wl extends Sys.EventArgs{constructor(Q,Da,eb,Tb){super();this.Mab=Q;this.httpStatusCode=eb;this.aK=Tb}}Object(f.a)(wl,"UpdatedLastRevisionSaveIdEventArgs",Sys.EventArgs,[]);class Qp{constructor(){this.o$=0}get isEmpty(){return!this.o$}MRc(Q){this.o$|=Q}U9c(Q){return!!(this.o$&Q)}clear(){this.o$=0}YTc(){return!1}}Object(f.a)(Qp,"DocxSaveMonitorRetryAttemptOnce",
null,[]);class dj{constructor(Q,Da=3){this.o$=0;this.zKd=new Map;this.rCk=Q;this.iJk=Da}get isEmpty(){return!this.o$}MRc(Q){this.o$|=Q;let Da=this.zKd.get(Q)||0;this.zKd.set(Q,++Da)}U9c(Q){return!!(this.o$&Q)}clear(){this.o$=0;this.zKd.clear()}YTc(Q){return this.iJk&Q?(this.zKd.get(Q)||0)<this.rCk:!1}}Object(f.a)(dj,"DocxSaveMonitorRetryAttemptMany",null,[]);class jp{static create(Q=!1,Da=3,eb=0){return Q?new dj(Da,eb):new Qp}}Object(f.a)(jp,"DocxSaveMonitorRetryAttemptFactory",null,[]);class El extends Oo.a{constructor(){super();
this.CellId=this.FileId=null}$m(){return ik.a.VJf}static construct(Q){const Da=new El;Da.FileId=Q.Jj().yq;Da.CellId=ro.a(Q.Ic.id);return Da}}Object(f.a)(El,"LastSavedRevisionRequest",Oo.a,[]);var Ap;(function(Q){Q[Q.P$p=-1]="noResultYet";Q[Q.Xlq=0]="upToDate";Q[Q.fhq=1]="sessionLost";Q[Q.mmq=2]="userSignedOut";Q[Q.rdq=3]="previousRequestPending";Q[Q.Rte=4]="requestFailed";Q[Q.Shq=5]="shuttingDown";Q[Q.uaq=6]="nullResponseData";Q[Q.V1p=7]="invalidResponseData";Q[Q.oXp=8]="failedRevisionLookup";Q[Q.hgq=
9]="savedWithinThreshold";Q[Q.baq=10]="notSavedWarning";Q[Q.A2p=11]="kickoutThreshold";Q[Q.slq=12]="unknownRevision";Q[Q.hTp=13]="contentNotYetLoaded";Q[Q.ANo=14]="sessionExpired";Q[Q.Ajl=15]="canaryError";Q[Q.timeout=16]="timeout";Q[Q.B2p=17]="kickoutThreshold_Offline";Q[Q.EVp=18]="dssSessionDeleted";Q[Q.FVp=19]="dssSessionExpired";Q[Q.Dmq=20]="waitingForSessionTokenRefresh";Q[Q.GVp=21]="dssSessionNotFound"})(Ap||(Ap={}));Object(f.b)("SaveMonitorResult",Ap);class xh{constructor(Q,Da,eb,Tb,Ac,hd,
Ud,Ee,Me,Kf,th,Fj,uh,hi,kk,kl,Aa,Qa,Fa,xa,Wa,Db,Yb,rc,Lc,Sc=null,sd){this.XKc=0;this.P7b=!1;this.LNc=null;this.CJc=this.rZ=-1;this.N3e=null;this.aJd=0;this.bJd=!1;this.XFb=null;this.MLc=0;this.A6e=this.JGh=null;this.JV=this.Xqh=this.RFc=0;this.gZe=null;this.Xnh=!1;this.tk=null;this.gBh=this.jMd=0;this.CDh=!1;this.T7l=()=>{var ed;Ca.ULS.sendTraceTag(524871194,xh.Mn,50,"DocxSaveMonitor tick: {0}",{["IsUpToDate"]:this.AU,["AppVisibilityState"]:Og.a[null===(ed=this.tk)||void 0===ed?void 0:ed.uA]});try{if(this.lHc){var $c=
this.lHc();Ca.ULS.sendTraceTag(509367249,xh.Mn,50,"Additional Details: {0}",$c)}}catch(Md){ed=Za.c({["Kind"]:"Exception",["Stack"]:Md.stack,["Message"]:Md.message,["FileName"]:Md.fileName,["LineNumber"]:Md.lineNumber}),Ca.ULS.sendTraceTag(509367062,xh.Mn,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",ed)}ed=this.aFb;this.aFb=this.nB();if(this.vda())this.tB.event(5),this.stop("session has shut down");else if(this.Kib===xh.FFj&&this.FEa(this.eDb),$c=
this.V6b())if(this.AU)this.tB.event(0);else if(this.U7b())this.tB.event(1),this.stop("session is lost"),m.AFrameworkApplication.vd("WordKickoutSafetyCheck;WordKickoutSafetyCheckcf"),this.Xnh&&!this.Oin()&&(Ca.ULS.sendTraceTag(554726995,xh.Mn,10,"DocxSaveMonitor: Session lost but not kicked out"),this.XJ(Mk.a.mgi));else if(this.Xoh())20!==this.tB.currentState?(this.tB.event(20),this.JGh=this.nB(),Ca.ULS.sendTraceTag(593510691,xh.Mn,15,"Detected that session is expired. DocxSaveMonitor will wait for {0}ms to see if we can refresh the access token.",
this.LGh)):this.nB().getTime()-this.JGh.getTime()>this.LGh&&(this.tB.event(14),this.bge(20,Mk.a.p_d,"TokenExpired"));else if(this.sAk())if(this.aFb=ed,this.P7b)this.tB.event(3),this.nB().getTime()-this.LNc.getTime()>this.uYe&&(ed=this.$Le.mkc(this.rZ),Ca.ULS.sendTraceTag(19161610,205,50,"DocxSaveMonitorKickout: Status for presumably pending request {0} is {1}",this.rZ,Tn.a[ed]),this.kKd&&this.kKd.log(),this.stop("stuck on previousRequestPending"),this.XJ());else if(ed=qo.b(El.construct($c)),this.P7b=
!0,this.LNc=this.RIk(),this.rZ=this.$Le.Wj(xh.serviceUrl,2,ed,{"Content-Type":"application/json; charset=utf-8"},!1,0,this.vnl,this.unl,null,void 0,void 0,this.t4e,this.IOc,void 0,void 0,!0),0>=this.rZ)this.P7b=!1,Ca.ULS.sendTraceTag(19161611,205,50,"DocxSaveMonitorKickout: Request {0} was not added to the queue.",this.rZ.toString());else{ed=this.$Le.mkc(this.rZ);$c=100;if(ed&&1!==ed||this.nlh)$c=50;Ca.ULS.sendTraceTag(19161612,xh.Mn,$c,"DocxSaveMonitor: Sending Request {0}",{["Id"]:this.rZ,["Status"]:Tn.a[ed]});
this.kKd&&this.kKd.start(this.rZ)}else this.tB.event(2);else this.tB.event(13)};this.unl=ed=>{this.JV=this.qWd+1;let $c=this.P7b=!1,Md=!1;ed=ed.data;zb.a.Qm&&m.AFrameworkApplication.cga("MultipleRetriesForDocxSaveMonitor_t;MultipleRetriesForDocxSaveMonitor_c");ed?(Ca.ULS.sendTraceTag(22552773,xh.Mn,15,"Request failed {0}",{["Status"]:ed.status,["HttpStatus"]:ed.Ie,["Correlation"]:ed.vi?ed.vi[Xk.a.s2]:"",["Id"]:ed.id,["ConsecutiveErrors"]:this.qWd,["Request.InvokedTime"]:ed.bH,["Request.EnqueueTime"]:ed.Yra,
["Request.CompletedTime"]:ed.MO}),Md=7===ed.status||13===ed.status,this.YTc(2)&&Md?(this.D1a.MRc(2),$c=!0,this.CJc=ed.Ie,this.tB.event(16)):this.YTc(1)&&5===ed.status?(this.D1a.MRc(1),$c=!0,this.CJc=ed.Ie,this.tB.event(15)):(this.tB.event(4),this.CJc=ed.Ie)):(this.tB.event(4),Ca.ULS.sendTraceTag(23425240,xh.Mn,15,"RequestFailed and event data is null"));if(!$c&&(this.D1a.clear(),Md?this.bge(17,Mk.a.mVl,"while offline"):this.bge(11,Mk.a.Nxf,"while online")))return;this.FEa($c?this.Zfm(Md):this.eDb)};
this.vnl=ed=>{this.JV=this.qWd+1;this.P7b=!1;var $c={};this.D1a.clear();if(ed=ed.data){var Md=ed.vi?ed.vi[Xk.a.s2]:"";$c.HttpStatus=ed.Ie;$c.Correlation=Md;$c.Id=ed.id;Ca.ULS.sendTraceTag(23425242,xh.Mn,this.nlh?50:100,"Request succeeded at the HTTP level {0}",$c);this.CJc=ed.Ie}else Ca.ULS.sendTraceTag(23425241,xh.Mn,15,"Request succeeded with null response data");if(this.vda()||!this.q_d)this.tB.event(5),this.stop("session has shut down");else if(!this.ion())if(ed&&ed.De)if(ed=this.AUa(ed.De))if(this.BH.cPa(ed),
ed.StatusCode)this.D1f(ed,$c)||this.tB.event(8,$c);else{this.JV=0;this.aFb=this.nB();this.L5e.clear();$c={["LastSavedRevisionId"]:ed.LastSavedRevisionId,["LastSavedRevisionSequenceNumber"]:ed.RevisionSequenceNumber};ed=ro.b(ed.LastSavedRevisionId);this.Zxb(ed,3);var xe=this.kHf().WZa.h4c(ed);if(xe){ed=null;Md=this.qqb();xe=(xe=xe.sVa(Md))?xe.id:kc.a.nil;let Nd=Md;for(;Nd&&!Nd.id.equals(xe);)ed=Nd,Nd=Nd.FG;this.dUm(ed,$c,Md)||this.tB.event(9)}else this.JSm()||this.tB.event(12,$c);this.FEa(this.pac)&&
Ca.ULS.sendTraceTag(22552774,xh.Mn,50,"Received response from server -- going back to normal interval")}else this.tB.event(7),this.E1f("invalid response",$c);else this.tB.event(6),this.E1f("null response",$c)};this.uEo=(ed,$c)=>{ed={};ed.DocxSaveMonitorState=Ap[$c.newState];ed.PreviousState=Ap[$c.nlg];ed.PreviousStateHits=$c.olg;ed.PreviousStateTransitionTime=$c.plg.toISOString();ed.LastHttpStatus=this.CJc;ed.LastSuccessTime=this.aFb.toISOString();this.LNc&&(ed.LastRequestStartTime=this.LNc.toISOString());
ed.LastSavedRevisionID=this.lje.toString();ed.LastSavedRevisionIdOrigin=this.XKc;ed.LastSavedRevisionIdSetTime=this.A6e?this.A6e.toISOString():null;ed.IsViable=this.tf.jCa;ed.IsNetworkConnected=this.tf.WA;ed.IsExpired=this.tf.dba;ed.HasEmergencyViewModeBeenDeployed=this.tf.Hk;ed["Navigator.Online"]=window.navigator.onLine;const Md=$c.K$o;Md&&xh.lcj(ed,Md);$c=$c.newState;switch($c){case 13:Ca.ULS.sendTraceTag(5830086,xh.Mn,50,"{0}",ed);break;case 1:Ca.ULS.sendTraceTag(5884125,xh.Mn,50,"{0}",ed);break;
case 0:Ca.ULS.sendTraceTag(5830087,xh.Mn,50,"{0}",ed);break;case 2:Ca.ULS.sendTraceTag(5830088,xh.Mn,50,"{0}",ed);break;case 3:Ca.ULS.sendTraceTag(5830089,xh.Mn,50,"{0}",ed);break;case 4:Ca.ULS.sendTraceTag(5884126,xh.Mn,50,"{0}",ed);break;case 5:Ca.ULS.sendTraceTag(5884127,xh.Mn,50,"{0}",ed);break;case 6:Ca.ULS.shipAssertTag(5830090,xh.Mn,!1,"{0}",ed);break;case 7:Ca.ULS.shipAssertTag(5830091,xh.Mn,!1,"{0}",ed);break;case 8:Ca.ULS.sendTraceTag(5830092,xh.Mn,15,"{0}",ed);break;case 10:Ca.ULS.sendTraceTag(5830094,
xh.Mn,15,"{0}",ed);break;case 9:Ca.ULS.sendTraceTag(5884128,xh.Mn,50,"{0}",ed);break;case 11:Ca.ULS.sendTraceTag(5830096,xh.Mn,15,"{0}",ed);break;case 17:Ca.ULS.sendTraceTag(37835678,xh.Mn,15,"{0}",ed);break;case 12:Ca.ULS.sendTraceTag(5830095,xh.Mn,15,"{0}",ed);break;case 18:Ca.ULS.sendTraceTag(38122832,xh.Mn,15,"{0}",ed);break;case 19:Ca.ULS.sendTraceTag(38122833,xh.Mn,15,"{0}",ed);break;case 21:Ca.ULS.sendTraceTag(0,xh.Mn,15,"{0}",ed);break;case 14:Ca.ULS.sendTraceTag(6575508,xh.Mn,15,"{0}",ed);
break;case 15:Ca.ULS.sendTraceTag(36739287,xh.Mn,50,"{0}",ed);break;case 16:Ca.ULS.sendTraceTag(36767649,xh.Mn,15,"{0}",ed);break;case 20:Ca.ULS.sendTraceTag(593510690,xh.Mn,15,"{0}",ed);break;default:Ca.ULS.shipAssertTag(5884129,xh.Mn,!1,"Bad state:{0} logInfo:{1}",$c,ed)}};this.pac=Q;this.eDb=Da;this.Kib=Q;this.jJh=eb;this.iLk=Tb;this.t4e=hd;this.IOc=Ud;this.a9b=Ee;this.ceh=Me;this.$Le=Kf;this.C1=th;this.BH=Fj;this.V6b=uh;this.sAk=hi;this.U7b=kk;this.Xoh=kl;this.vda=Aa;this.nB=Qa;this.RIk=Fa;this.Xnh=
Lc;this.D1a=jp.create(sd.isEnabled,sd.maxRetries,Db.o$);this.L5e=new pp.a;this.lHc=Yb;this.tB=new Dl.a(-1);this.tf=Sc;this.tB.Aff(this.uEo);this.kKd=xa;this.aFb=Qa();this.nlh=Wa;this.elk=sd.isEnabled?null:Db;this.SBb=rc;this.LGh=this.jJh;this.U_e=kc.a.nil;this.sa=new W.a;La.a.instance.Ra(103).execute(ed=>{this.tk=ed;this.tk.IHa(($c,Md)=>{this.A_($c,Md)});this.Y3e=ed.uA});this.tf&&this.tf.PJb((ed,$c)=>{this.lga(ed,$c)});this.uYe=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIntervalMs",
Ac):Ac;this.gBh=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorRetryIntervalAfterActive",this.eDb):this.eDb;this.CDh=m.AFrameworkApplication.J?m.AFrameworkApplication.J.$("StopDocxSaveMonitorKickoutIsEnabled"):!0;this.kJk=sd}lga(Q,Da){Ca.ULS.sendTraceTag(528577692,xh.Mn,15,"DocxSaveMonitor: AppNetworkChanged event raised. OldState: [{0}], NewState: [{1}]",Yl.a[Da.yrc],Yl.a[Da.zbb]);1!==Da.zbb&&3!==Da.zbb&&(Ca.ULS.sendTraceTag(528566343,
xh.Mn,50,"Resetting list of current failed request retries. State before resetting is - Canary: [{0}], Timeout: [{1}]",this.D1a.U9c(1),this.D1a.U9c(2)),this.D1a.clear())}get q_d(){return this.RFc}get lje(){return this.U_e}get AU(){const Q=!this.qqb()||this.lje.equals(this.qqb().id);Q||Ca.ULS.sendTraceTag(521413851,xh.Mn,50,"Document has unSavedChanges: currentRevisionId [{0}], mostRecentRevisionIdResult [{1}]",this.qqb().id.toString(),this.lje.toString());return Q}get eYi(){return this.nB().getTime()-
this.aFb.getTime()>this.uYe}get qWd(){return this.JV}get J6a(){return 3}get iWd(){let Q=null;ld.StaticActiveAppFrame.za()&&ld.StaticActiveAppFrame.za().kb&&ld.StaticActiveAppFrame.za().kb.$c&&(Q=ld.StaticActiveAppFrame.za().kb.$c.wg);return[Q,sh.a.K0]}A_(Q,Da){var eb,Tb,Ac;Q={["VisibilityState"]:Og.a[this.tk.uA],["IsVisible"]:this.tk.isVisible,["DocxSaveMonitor"]:{["RequestPending"]:this.P7b,["KickoutIntervalElapsed"]:this.eYi,["LastSuccessfulIterationTime"]:null!==(eb=this.aFb)&&void 0!==eb?eb:"null",
["RequestStartTime"]:null!==(Tb=this.LNc)&&void 0!==Tb?Tb:"null",["SkippedKickouts"]:this.jMd,["LastSkippedKickoutAt"]:null!==(Ac=this.brh)&&void 0!==Ac?Ac:"null"},["IsViable"]:this.tf.jCa,["IsNetworkConnected"]:this.tf.WA,["IsExpired"]:this.tf.dba,["HasEmergencyViewModeBeenDeployed"]:this.tf.Hk,["Navigator.Online"]:window.navigator.onLine};Ca.ULS.sendTraceTag(539874775,xh.Mn,50,Za.c(Q));this.Y3e!=this.tk.uA&&(0==Da.oldState||1==Da.oldState||0!==Da.newState&&1!==Da.newState||this.FEa(this.gBh),0===
this.tk.uA?ce.c(hg.a.Gcl,void 0,void 0,void 0,void 0,void 0,Q):0===this.Y3e&&ce.c(hg.a.Hcl,void 0,void 0,void 0,void 0,void 0,Q),this.Y3e=this.tk.uA)}start(){this.RFc=this.ceh.Snb(this.T7l,this.Kib)}FEa(Q){if(!this.q_d||this.Kib===Q)return!1;const Da=this.Kib;this.Kib=Q;this.stop("changing save monitor interval from "+Da+"ms to "+Q+"ms");this.start();return!0}Zxb(Q,Da){if(Da>=this.XKc&&Q&&!kc.a.nil.equals(Q)){var eb=!this.U_e.equals(Q);this.XKc=Da;this.U_e=Q;const Tb=this.nB();this.A6e=Tb;const Ac=
this.AU;eb&&(Da={["Id"]:Q.toString(),["IsUpToDate"]:Ac,["Origin"]:aq[Da]},this.gZe&&(Da.LastUpToDateTime=this.gZe.toISOString()),(eb=this.kHf())&&eb.WZa&&(Q=eb.WZa.h4c(Q))&&(Da.LastSavedCreationTime=Q.creationTime.toISOString()),Ca.ULS.sendTraceTag(557320151,xh.Mn,50,"Updating Last Saved Revision: {0}",Da));Ac&&(this.gZe=Tb)}else Da<this.XKc?Ca.ULS.sendTraceTag(572051800,xh.Mn,50,'Deny lower rank origin: {{"CurrentOrigin":"{0}", "Attempt":"{1}"}}',this.XKc,Da):Ca.ULS.sendTraceTag(572051801,xh.Mn,
15,'Deny null or Nil ID: {{"Attempt":"{0}"}}',Da)}stop(Q){this.uf(Q)}uf(Q){this.q_d&&(Ca.ULS.sendTraceTag(5830084,xh.Mn,50,"Stopping DocxSaveMonitor because {0}!",Q),this.ceh.uf(this.q_d),this.RFc=0)}JSm(){if(0>=this.a9b)return!1;var Q=this.Szm();if(!Q)return this.N3e=null,this.aJd=0,this.bJd=!1;this.XFb=Q.C2d;this.XFb===this.N3e?this.aJd++:(this.N3e=this.XFb,this.aJd=1,this.bJd=!1);if(this.aJd<xh.VJn)return!1;this.MLc=+this.nB()-+this.XFb;if(this.MLc<=this.a9b)return!1;if(!this.bJd)return this.bJd=
!0,this.wwj(),!1;if(this.SBb)this.SBb.execute(Da=>{Da.flush(this,0)});else{Q="";try{this.lHc&&(Q=this.lHc())}catch(Da){Q=Za.c({["Kind"]:"Exception",["Stack"]:Da.stack,["Message"]:Da.message,["FileName"]:Da.fileName,["LineNumber"]:Da.lineNumber}),Ca.ULS.sendTraceTag(50426817,xh.Mn,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",Q)}Ca.ULS.sendTraceTag(50426818,xh.Mn,15,"Oldest local revision was created at {0} which is {1}ms ago and exceeds max allowed age of {2}ms.  Extra Details: {3}",
this.XFb.toISOString(),this.MLc,this.a9b,Q)}this.a9b=-1;this.stop("Exceeded oldest allowed local revision");this.XJ(Mk.a.nVl);return!0}Szm(){let Q=null,Da=this.qqb();for(;Da&&!Da.Vla;)Q=Da,Da=Da.FG;return Q}ion(){return this.U7b()?(this.tB.event(1),this.stop("session is lost"),!0):this.Xoh()?(this.tB.event(14),Ca.ULS.sendTraceTag(20029718,xh.Mn,15,"ExpiredSessionNotLostYet"),this.stop("session is expired"),this.XJ(Mk.a.p_d),!0):!1}kHf(){const Q=this.V6b();return Q?Q.Ic:null}qqb(){const Q=this.kHf();
return Q?Q.xm:null}YTc(Q){return this.kJk.isEnabled?this.D1a.YTc(Q):this.elk.U9c(Q)&&!this.D1a.U9c(Q)}Zfm(Q){return Q?xh.mhp:xh.FFj}bge(Q,Da,eb){if(this.eYi)if(this.tk&&!this.tk.isVisible)Ca.ULS.sendTraceTag(540669727,xh.Mn,15,"Kickout interval has elapsed, but browser tab is not visible. We will not kick out immediately"),this.jMd+=1,this.brh=this.nB();else return this.tB.event(Q,{}),this.stop("request failed after kickout interval "+eb),this.SBb&&this.SBb.execute(Tb=>{Tb.flush(this,2)}),this.XJ(Da),
!0;return!1}D1f(Q,Da){const eb=Q.StatusCode;return 88===eb||89===eb||236===eb?(Da.KickoutDiagnostics=this.lHc(),88===eb?(Da.Result="deleted DSS session",this.tB.event(18,Da),this.stop("deleted DSS session"),this.XJ(Mk.a.F4f)):89===eb?(Da.Result="expired DSS session",this.tB.event(19,Da),this.stop("expired DSS session"),this.XJ(Mk.a.uUb)):(m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled",!1)&&(Q=ro.b(Q.LastSavedRevisionId),
this.Zxb(Q,4)),Da.Result="DSS session not found",this.tB.event(21,Da),this.stop("DSS session not found"),this.XJ(Mk.a.fhe)),!0):14===eb?(this.stop("DSS returned an unspecified failure"),this.XJ(Mk.a.syn),!0):104===eb?(this.stop("this operation is disabled on the server"),!0):this.E1f("unrecognized OperationResult: "+eb,Da)}E1f(Q,Da){if(!this.L5e.contains(Q))this.L5e.add(Q);else if(this.bge(11,Mk.a.Nxf,Q))return Da.ConsecutiveErrors=this.qWd,Da.Reason=Q,Ca.ULS.sendTraceTag(41997899,xh.Mn,15,"DocxSaveMonitor kickout. {0}",
Da),!0;this.FEa(this.eDb);return!1}dUm(Q,Da,eb){let Tb=!1;if(Q){const Ac=this.nB().getTime()-Q.creationTime.getTime();Ac>=this.jJh&&(Tb=!0,xh.lcj(Da,this.UFm(Q,Ac,eb)),Ac>=this.uYe&&10===this.tB.currentState?(this.tB.event(11,Da),this.stop("didn't save in time"),this.XJ()):(this.tB.event(10,Da),this.wwj(),this.YDf()))}return Tb}h_k(Q){this.sa.addHandler(xh.Fsj,Q)}IZk(Q){this.sa.addHandler(xh.eEf,Q)}iCj(Q){this.sa.removeHandler(xh.eEf,Q)}wwj(){this.sa.raiseEvent(xh.Fsj)}AUa(Q){let Da;return({group:Da}=
Fo.a.z4(Q)).returnValue?Da.Responses[0]:null}UFm(Q,Da,eb){const Tb={};Tb.FirstUnsavedRevisionId=Q.id.toString();Tb.FirstUnsavedRevisionLengthToRoot=Q.nP;Tb.UnsavedTimeInMs=Da;Tb.CurrentRevisionId=eb.id.toString();Tb.CurrentRevisionLengthToRoot=eb.nP;return Tb}YDf(){Xi.a.ZDf(cm.a.yHj)}XJ(Q=Mk.a.Nxf){this.iLk?this.CDh?(Ca.ULS.sendTraceTag(509146274,xh.Mn,15,"DocxSaveMonitor would have kicked out due to: {0}. Diagnostic Log: {1}.",Q,this.Evi()),0==this.RFc&&this.start()):this.tk&&!this.tk.isVisible?
(Ca.ULS.sendTraceTag(509146273,xh.Mn,15,"DocxSaveMonitor did not kick out because the session is not visible. Error code: {0}. Diagnostic Log: {1}",Q,this.Evi()),0==this.RFc&&this.start()):(this.stop(xh.itn),Q===Mk.a.p_d?this.C1.value.XJ(Q,Object.assign(new Eo.a,{Kja:4,UZ:Box4Intl.Box4Strings.L_SessionExpiredMessageDescription,r6:Box4Intl.Box4Strings.L_SessionExpiredMessageTitle,showDescription:!0})):this.C1.value.XJ(Q,new Eo.a)):Ca.ULS.sendTraceTag(19247383,xh.Mn,50,"Kickout disabled")}Evi(){const Q=
{};var Da=La.a.instance.resolve(436);Q.HasDataloss=!Da.AU;Q.UnSavedRevisionsCount=Da.l0a;Q.OldestUnsavedRevisionCreationTime=Da.AU?"":Da.fjc().toString();Q.RevisionsWithOutServerRevisionSequenceNumbers=Da.ffc();Q.RevisionsWithServerRevisionSequenceNumbers=Da.nXd();Q.RSNManager_Diagnostics=Da.ZC();if(Da=La.a.instance?La.a.instance.Oa(441):null)Q.RunawayDataLossMonitor_Diagnostics=Da.hHj;Q.DocxSaveMonitor_Diagnostics=this.ZC();(Da=La.a.instance?La.a.instance.Oa(401):null)&&(Q.LastSavedToHostDetailsManager_Diagnostics=
Da.ZC());this.tk&&(Q.VisibilityState=Og.a[this.tk.uA]);return Q}ZC(){const Q={};this.XFb&&(Q.ORT=this.XFb.toISOString());0<this.MLc&&(Q.AA=this.MLc);0<this.a9b&&(Q.MAA=this.a9b);0<this.jMd&&(Q.LSKO=this.brh.toISOString());this.tB&&0<=this.tB.currentState&&(Q.SMS=Ap[this.tB.currentState]);const Da={};m.AFrameworkApplication.Xla&&(Da.S=1);Ri.a.JU&&(Da.LS=1);this.tf&&(this.tf.Do&&(Da.KO=1),this.tf.dba&&(Da.TE=1));this.tk&&(Da.VS=Og.a[this.tk.uA]);window.navigator&&(Da.NW=!window.navigator.onLine);Q.AMD=
Da;return Q}fsm(){const Q={"Content-Type":"application/json; charset=utf-8","X-Requested-With":"Fetch"};m.AFrameworkApplication.buildVersion&&(Q["X-OfficeVersion"]=Ya.a.gP(m.AFrameworkApplication.buildVersion));m.AFrameworkApplication.accessToken&&(Q["X-AccessToken"]=Ya.a.gP(m.AFrameworkApplication.accessToken),Q["X-AccessTokenTtl"]=m.AFrameworkApplication.bTa.toString());m.AFrameworkApplication.WM&&(Q["X-Key"]=Ya.a.gP(m.AFrameworkApplication.WM));m.AFrameworkApplication.userType&&(Q["X-UserType"]=
Ya.a.gP(m.AFrameworkApplication.userType));const Da=m.AFrameworkApplication.Ee.Q0;Da&&(Q["X-WacCluster"]=Ya.a.gP(Da));m.AFrameworkApplication.userSessionId&&(Q["X-UserSessionId"]=Ya.a.gP(m.AFrameworkApplication.userSessionId));return Q}nam(){var Q=this.tf?this.tf.networkState:null;if(1===Q||3===Q)Ca.ULS.sendTraceTag(558158790,xh.Mn,15,"Not sending request because we dont have network.");else if(Q=this.V6b()){var Da=new Sys.Net.WebRequest;Da.set_httpVerb("POST");Da.set_url(xh.serviceUrl);var eb={};
eb.body=qo.b(El.construct(Q));eb.headers=this.fsm();eb.method=Da.get_httpVerb();try{"function"===typeof window.fetch?window.fetch(Da.getResolvedUrl(),eb).then(Tb=>{Ca.ULS.sendTraceTag(561551382,xh.Mn,50,"Request succeeded at the HTTP level {0}",Tb.statusText);this.Xqh=Tb.status;return Tb.json()},Tb=>{Ca.ULS.sendTraceTag(561551383,xh.Mn,15,"Request failed at the HTTP level {0}",Tb);return null}).then(Tb=>{Tb=JSON.stringify(Tb);this.jnl(Tb,this.Xqh);return Tb},()=>{Ca.ULS.sendTraceTag(561551385,xh.Mn,
15,"Request succeeded with null response data");return""}):Ca.ULS.sendTraceTag(561002076,xh.Mn,15,"Browser does not support Fetch.")}catch(Tb){Ca.ULS.sendTraceTag(561551386,xh.Mn,15,String.format("Exception when attempting to get last revision save id : {0}",Tb))}}else Ca.ULS.sendTraceTag(540079457,xh.Mn,15,"Target node is null, not sending last saved revision request.")}jnl(Q,Da){let eb=kc.a.nil,Tb=!1,Ac=-1;Da===ki.a.pz&&((Q=this.AUa(Q))?(eb=ro.b(Q.LastSavedRevisionId),Q.StatusCode||(Tb=!0,Ac=Q.StatusCode)):
Ca.ULS.sendTraceTag(561002077,xh.Mn,50,"Response is null when attempting to get last revision save id"));this.sa.raiseEvent(xh.eEf,new wl(eb,Tb,Da,Ac))}static lcj(Q,Da){for(const eb in Da)Q[eb]=Da[eb]}Oin(){return Ce.SessionStatusManager.instance.Do}}xh.FFj=0;xh.serviceUrl=Ri.a.webServiceBase+"OneNote.ashx?perfTag=LastSavedRevisionRequest";xh.itn="kickout";xh.Fsj="PS";xh.eEf="FLSR";xh.Mn=343;xh.VJn=5;xh.mhp=5E4;Object(f.a)(xh,"DocxSaveMonitor",null,[1269,108]);class Xq{Snb(Q,Da){return window.setInterval(Q,
Da)}uf(Q){window.clearInterval(Q)}}Xq.instance=new Xq;Object(f.a)(Xq,"DocxSaveMonitorTaskManager",null,[1265]);class Mt{constructor(Q){this.rZ=0;this.jya=Q}start(Q){this.jya&&(this.rZ=Q,this.jya.reset())}log(){if(this.jya){var Q={};Q.RequstId=this.rZ;Q.InvokeCount=this.jya.C7c;Q.InvokeFailedCount=this.jya.D7c;Q.NoOpenConnectionCount=this.jya.qdd;Q.SynchronousNotificationCount=this.jya.kqd;Q.ResponseNotAvailable=this.jya.Tkd;Ca.ULS.sendTraceTag(19161613,205,50,"ClientRequestManagerTelemetryStorage: {0}",
Q)}}}Object(f.a)(Mt,"RequestLifeCycleTelemetryManager",null,[1263]);class qp{constructor(){this.W=this.w6e=null;this.vHl=()=>{var Q=m.AFrameworkApplication.J;if(!Q.$("DocxSaveMonitorEnabled"))return null;var Da=Q.$("DocxSaveMonitorKickoutEnabled");const eb=Q.ic("DocxSaveMonitorIntervalMs",6E4),Tb=Q.ic("DocxSaveMonitorFailureIntervalMs",5E3),Ac=Q.ic("DocxSaveMonitorWarningTimeMs",12E4),hd=Q.ic("DocxSaveMonitorKickoutTimeMs",6E5),Ud=Q.ic("DocxSaveMonitorQueueTimeoutMs",6E4),Ee=Q.ic("DocxSaveMonitorSentTimeoutMs",
12E4),Me=Q.ic("DocxSaveMonitorOldestAllowedLocalRevisionMs",3E5);var Kf=Q.$("DocxSaveMonitorTelemetryInfoEnabled");const th=Q.$("DocxSaveMonitorInfoRequestLoggingEnabled");var Fj=m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorBypassCRMIsEnabled",!1),uh=Q.$("DocxSaveMonitorRawWebRequestsEnabled")||Fj;Fj=Q.$("ComponentStateLoggingPackageIsEnabled");Q=Q.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIfSessionisLostButNotKickedOutIsEnabled",
!1);var hi=m.AFrameworkApplication.Ee,kk=uh?new Vg(m.AFrameworkApplication.userSessionId,hi.Q0,hi.UYd):null;kk=new $p(hi,kk,uh);Kf=Kf&&hi&&!uh?new Mt(hi.YI):null;uh=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorIsEnabled",!1):!1;hi=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorMaxRetries",3):3;const kl=jp.create(uh,hi);kl.MRc(1);
kl.MRc(2);Fj=Fj?this.W.Ra(1233):null;Da=new xh(eb,Tb,Ac,Da,hd,Ud,Ee,Me,Xq.instance,kk,La.a.instance.rf(439),yf.a.instance,this.Ckc,()=>!m.AFrameworkApplication.Xje||Fe.a.instance.K7c,()=>Ri.a.JU,Object(R.a)(Rl.a.instance,Rl.a.instance.jIa,"checkAndTriggerSessionHasExpired"),()=>m.AFrameworkApplication.Sl,()=>new Date,()=>new Date,Kf,th,kl,this.dem,Fj,Q,La.a.instance.Oa(117)||Ce.SessionStatusManager.instance,{isEnabled:uh,maxRetries:hi});Da.start();Ca.ULS.sendTraceTag(5884131,xh.Mn,50,"SaveMonitor initialized");
return Da};this.Ckc=()=>{const Q=ld.StaticActiveAppFrame.za().kb.Jc;return Q?Q.od:null};this.dem=()=>{const Q={};m.AFrameworkApplication.oc&&(Q.TM=m.AFrameworkApplication.oc.ZC());Pm.WoncaApp.WF&&(Q.RS=Pm.WoncaApp.WF.ZC());sh.a.K0&&(Q.CRS=sh.a.K0.ZC());ld.StaticActiveAppFrame.za()&&ld.StaticActiveAppFrame.za().kb&&ld.StaticActiveAppFrame.za().kb.$c&&ld.StaticActiveAppFrame.za().kb.$c.wg&&(Q.GSR=ld.StaticActiveAppFrame.za().kb.$c.wg.ZC());m.AFrameworkApplication.Xla&&(Q.S=1);Ri.a.JU&&(Q.LS=1);Ed.a.ud()&&
Ed.a.ud().iC.Do&&(Q.KO=1);Q.RVS=window.document.visibilityState;return Sys.Serialization.JavaScriptSerializer.serialize(Q)}}get name(){return"WordEditor.DocxSaveMonitor"}init(){if(Ri.a.yt||Ri.a.hn)this.w6e=this.W.resolve(1248)}dispose(){this.w6e&&this.w6e.stop("WordEditorDocxSaveMonitorPackage is being disposed")}uc(Q){this.W=Q;(Ri.a.yt||Ri.a.hn)&&Q.ia(1248,this.vHl).as(434).ha()}static main(){C.a.instance.Lc(new qp)}}Object(f.a)(qp,"WordEditorDocxSaveMonitorPackage",null,[0,1]);var Dk=d(1006);class un{constructor(Q,
Da){this.fo=Q;this.hJo=Object(Dk.c)(Da)}async loadChunk(Q){return this.fo.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk(Q):(await this.hJo).JD.loadScript(Q)}}Object(f.a)(un,"WordOnlineChunksLoader",null,[]);class jk{constructor(){this.name="WordEditor.EditorAi.Entry"}uc(Q){Q.ia(1291,()=>new un(m.AFrameworkApplication.J,Q.Ra(77)))}init(){}dispose(){}static main(){C.a.instance.Lc(new jk)}}Object(f.a)(jk,"EditorAiEntryPackage",null,[0,1]);var Sl;(function(Q){Q[Q.kBp=0]="version0";Q[Q.version1=
1]="version1"})(Sl||(Sl={}));Object(f.b)("FirstRunExperienceVersion",Sl);class Ek{get Ygf(){return"Word"}get MYh(){return"74eb3f02-206c-47c2-ad65-c4d21db60910"}get version(){return Sl.kBp}get currentVersion(){return Sl.version1}get ben(){return Ek.isEnabled()&&m.AFrameworkApplication.J.$("WordEditorFirstRunExperienceDataStoreIsEnabled")}get Moc(){return Ek.isEnabled()&&m.AFrameworkApplication.J.$("WordEditorFirstRunExperienceUIV2IsEnabled")}get G1i(){return m.AFrameworkApplication.J.$("WordEditorFirstRunExperienceTestIsEnabled")}get e9l(){return"Microsoft.Office.Web.SessionSettings.IWordEditorFirstRunExperienceUIV2Settings"}get Kcj(){return 24}get sGj(){return 4E3}get old(){return""}static isEnabled(){const Q=
m.AFrameworkApplication.sessionStartInfoSettings?m.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup:"";return"Unknown"!==Q&&"Automation"!==Q}}Object(f.a)(Ek,"FirstRunExperienceLauncherSettings",null,[1388]);class Rp{constructor(Q){this.Rgh=Q}R3o(Q){void 0==m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CEBlockPopupEnabled",void 0)&&this.Rgh&&this.Rgh.S3o(Q)}}Object(f.a)(Rp,"FirstRunExperienceManager",null,[1297]);class Go{constructor(){this.W=null}get name(){return"WordEditor.FirstRunExperience"}uc(Q){this.W=
Q;this.W.ia(1250,()=>new Rp(this.W.resolve(1249))).ha()}init(){const Q=this.W.resolve(1250);Q&&Q.R3o(new Ek)}dispose(){}}Object(f.a)(Go,"WordEditorFirstRunExperiencePackageManager",null,[0,1]);class ja{constructor(Q,Da){this.ZNa=(eb,Tb,Ac,hd,Ud)=>{var Ee,Me;if(1===Ac)return Ud=null===(Me=null===(Ee=Tb.view.mb)||void 0===Ee?void 0:Ee.gb)||void 0===Me?void 0:Me.currentSelection,(null===Ud||void 0===Ud?0:Ud.kP)||eb===hg.a.Iod&&(null===Ud||void 0===Ud?0:Ud.WWa)?32:8;if(2===Ac){Ee=this.Aib.Oj.isVisible;
this.Aib.fA(!0,1===Ud);Me=0;switch(eb){case hg.a.BSj:Ud=1;break;case hg.a.CSj:Ud=2;break;case hg.a.Eye:Ud=2;Me=1;break;case hg.a.Fye:Ud=1;Me=2;break;case hg.a.Iod:Ud=1;Me=3;break;case hg.a.gCe:Ud=this.Aib.Mfc;break;default:Me=Ud=0}Ee&&eb===hg.a.ZNa||this.Aib.ZQo(Ud,Me);return 32}return 8};this.r$d=(eb,Tb,Ac,hd,Ud)=>{this.toggleButton(Ud,!1);return this.srl(Ac)};this.gCe=(eb,Tb,Ac,hd,Ud)=>this.Aib.Oj.isVisible?this.r$d(eb,Tb,Ac,hd,Ud):this.ZNa(eb,Tb,Ac,hd,Ud);this.ga=Q;this.Aib=Da}dispose(){this.Aib&&
this.Aib.dispose()}Xb(){this.ga.qa(hg.a.gCe,Uc.a.view,this.gCe);this.ga.fb(hg.a.ZNa,Uc.a.view,this.ZNa,4);this.ga.qa(hg.a.r$d,Uc.a.view,this.r$d);this.ga.fb(hg.a.Eye,Uc.a.view,this.ZNa,4);this.ga.qa(hg.a.Fye,Uc.a.view,this.ZNa);this.ga.qa(hg.a.Iod,Uc.a.view,this.ZNa)}srl(Q){if(1===Q)return 32;this.Aib.fA(!1);return 32}toggleButton(Q,Da){Q&&(Q[wb.a.On]=Da)}}Object(f.a)(ja,"FormatPictureActor",null,[10]);class Ua{constructor(Q){this.AIb=!1;this.Oj=Q}get Mfc(){return this.Oj.YJl}ZQo(Q,Da){switch(Q){case 0:case 1:this.Oj.V4o(Da);
break;case 2:this.Oj.f5o(Da)}}fA(Q,Da=!1){this.AIb||this.lUf();Q?this.Oj.kS(Da):this.Oj.Lsa()}dispose(){this.Oj.dispose()}lUf(){this.AIb||(this.Oj.initialize(),this.AIb=!0)}}Object(f.a)(Ua,"FormatPictureManager",null,[1262,10]);var yb=d(335),Wb=d(176),tc=d(157);class Rc{}Rc.pS=tc.a.z3d;Rc.Msc=1;Rc.Nsc=WordEditorIntl.WordEditorStrings.L_FormatPicture;Rc.Vza="FormatPictureTaskPaneData";Object(f.a)(Rc,"FormatPicturePaneConstants",null,[]);class Id{constructor(){this.type="FormatPictureTaskPaneProps";
this.section=0;this.description=this.title=this.numberFormatInfo=null;this.rotationAngle=this.rightCrop=this.leftCrop=this.bottomCrop=this.topCrop=0;this.onRotationSpinButtonChange=this.onCropSpinButtonChange=this.onDescriptionChange=this.onTitleChange=null;this.disabled=!1}}Object(f.a)(Id,"FormatPictureTaskPaneProps",null,[]);class Pd{constructor(Q,Da,eb,Tb){this.M6e=0;this.sFc=this.nqa=null;this.KKd=this.CKd=this.yFd=this.Awd=this.cOd=0;this.Ut=this.Q5b=!1;this.HNe=0;this.I_n=()=>{this.cMj()};this.rn=
()=>{let Ac=!1;Ac=this.bho()||Ac;Ac=this.Jcb()||Ac;Ac=this.Icb()||Ac;Ac=this.Rtc()||Ac;(Ac=this.Ygo()||Ac)&&this.jn()};this.V5=Q;this.$Ak=Da;this.pZe=eb;this.Dg=Tb}initialize(){this.i2();this.tna()}get isVisible(){return this.Ut}kS(Q){this.Qod(Q)}Lsa(){this.bha();this.IYm()}V4o(Q){this.lOj(Q,1)}f5o(Q){this.lOj(Q,2)}lOj(Q,Da){this.HNe=Da;this.M6e=Q}get YJl(){return this.HNe}dispose(){}i2(){this.V5.nUa();this.M6e=this.HNe=0}get focusManager(){return this.$Ak.value}get Rb(){return this.pZe.value}zab(){return!!this.focusManager.currentScope&&
this.focusManager.currentScope.name===Rc.pS}cMj(){this.focusManager.Jg(Rc.pS)}tna(){const Q=this.focusManager.ie(Rc.pS);Q.parent=Af.AFrame.Eq;Q.sja(this.I_n)}bha(){this.zab()&&this.focusManager.Jg(this.focusManager.IW)}Qod(Q){Uj.UISurfaces.Iv().then(Da=>{Da.showTaskPane(Rc.pS,this.EB(Q));this.isVisible&&Q&&this.focusManager.Jg(Rc.pS);return null})}jn(){Uj.UISurfaces.Iv().then(Q=>{Q.updateTaskPane(Rc.pS,this.EB(!1));return null})}IYm(){Uj.UISurfaces.Iv().then(Q=>{Q.hideTaskPane(Rc.pS,2);return null})}EB(){const Q=
new Id;this.mYo(Q);return Object.assign(new Pi.a,{title:Rc.Nsc,hideHeader:!1,width:320,location:2,contentProps:Q,onOpen:Da=>{this.Ut=!0;ld.StaticActiveAppFrame.za().E5a(this.rn);ld.StaticActiveAppFrame.za().Fe();this.cMj();this.Dg.yRc(Rc.pS,Da)},onClose:()=>{this.bha();this.Ut=!1;ld.StaticActiveAppFrame.za().Juc(this.rn);ld.StaticActiveAppFrame.za().Fe()},isModernPane:!0,enableResize:!0,minResizeWidth:150,maxResizeWidth:920})}mYo(Q){const Da=I.e().numberFormatInfo;Q.section=this.M6e;Q.numberFormatInfo=
"object"===typeof Da?Da:null;Q.title=this.nqa;Q.description=this.sFc;Q.topCrop=this.cOd;Q.bottomCrop=this.Awd;Q.leftCrop=this.yFd;Q.rightCrop=this.CKd;Q.rotationAngle=this.KKd;Q.onTitleChange=this.onTitleChange();Q.onDescriptionChange=this.onDescriptionChange();Q.onCropSpinButtonChange=this.onCropSpinButtonChange();Q.onRotationSpinButtonChange=this.onRotationSpinButtonChange();Q.disabled=this.Q5b}onTitleChange(){return Q=>{if(Q!==this.nqa){this.nqa=Q;var Da=new yb.DictionaryPropertySet;Da.setValue(Wb.a.Nrb,
Q);this.Rb.Pb(Gd.a.Umd,2,Da);this.jn()}}}onDescriptionChange(){return Q=>{if(Q!==this.sFc){var Da=new yb.DictionaryPropertySet;Da.setValue(Wb.a.O_,Q);this.sFc=Q;this.Rb.Pb(Gd.a.l_b,2,Da);this.jn()}}}onCropSpinButtonChange(){return(Q,Da)=>{const eb=new yb.DictionaryPropertySet;switch(Da){case 0:this.cOd=Q;eb.setValue(Wb.a.Srb,Q);this.Rb.Pb(hg.a.i6c,2,eb);break;case 1:this.Awd=Q;eb.setValue(Wb.a.Prb,Q);this.Rb.Pb(hg.a.f6c,2,eb);break;case 2:this.yFd=Q;eb.setValue(Wb.a.Qrb,Q);this.Rb.Pb(hg.a.g6c,2,eb);
break;case 3:this.CKd=Q,eb.setValue(Wb.a.Rrb,Q),this.Rb.Pb(hg.a.h6c,2,eb)}this.jn()}}onRotationSpinButtonChange(){return Q=>{this.KKd=Q;const Da=new yb.DictionaryPropertySet;Da.setValue(Wb.a.p6c,0);Da.setValue(Wb.a.lX,Q);this.Rb.Pb(Gd.a.Vaa,2,Da);this.jn()}}bho(){const Q=2===this.Rb.Pb(Gd.a.Umd,1,null),Da=Q!==this.Q5b;this.Q5b=Q;return Da}Jcb(){var Q=new yb.DictionaryPropertySet;this.Rb.Pb(Gd.a.Jcb,2,Q);Q=Q.ka(Wb.a.Nrb,"");const Da=Q!==this.nqa;this.nqa=Q;return Da}Icb(){var Q=new yb.DictionaryPropertySet;
this.Rb.Pb(Gd.a.Icb,2,Q);Q=Q.ka(Wb.a.O_,"");const Da=Q!==this.sFc;this.sFc=Q;return Da}Rtc(){var Q=new yb.DictionaryPropertySet;this.Rb.Pb(hg.a.Mhd,2,Q);const Da=Q.ka(Wb.a.Srb,0),eb=Q.ka(Wb.a.Prb,0),Tb=Q.ka(Wb.a.Qrb,0);Q=Q.ka(Wb.a.Rrb,0);const Ac=Da!==this.cOd||eb!==this.Awd||Tb!==this.yFd||Q!==this.CKd;this.cOd=Da;this.Awd=eb;this.yFd=Tb;this.CKd=Q;return Ac}Ygo(){var Q=new yb.DictionaryPropertySet;this.Rb.Pb(Gd.a.ZXb,2,Q);Q=Q.ka(Wb.a.lX,0);const Da=Q!==this.KKd;this.KKd=Q;return Da}}Object(f.a)(Pd,
"ReactFormatPicturePane",null,[1261,10]);class Rd{constructor(){this.$Ad=this.W=null}get name(){return"WordEditor.FormatPicture"}uc(Q){this.W=Q;this.W.ia(1252,()=>new Ua(this.W.resolve(1251))).ha();this.W.ia(1251,()=>new Pd(Ml.a.instance,new tb.a(()=>Sf.FocusManager.instance()),new tb.a(()=>m.AFrameworkApplication.va),ji.a.instance)).ha();this.W.ia(1253,()=>new ja(m.AFrameworkApplication.va,this.W.resolve(1252))).ha()}init(){if(sh.a.$Ng||sh.a.pak)this.$Ad=this.W.resolve(1253),this.$Ad.Xb(),ld.StaticActiveAppFrame.za().Fe()}dispose(){this.$Ad&&
this.$Ad.dispose()}static main(){C.a.instance.Lc(new Rd)}}Object(f.a)(Rd,"WordEditorFormatPicturePackage",null,[0,1]);var Ue=d(1353),tf=d(521),cg=d(1144);class fg extends Oo.a{constructor(){super();this.Prompt=0;this.FileId=null}$m(){return ik.a.xQm}static construct(Q,Da){const eb=new fg;eb.FileId=Q;eb.Prompt=Da;return eb}}Object(f.a)(fg,"GraphMergeConsentChangedRequest",Oo.a,[]);var Mg=d(510);class Fh extends Mg.a{constructor(){super();this.Location=this.FileId=null}$m(){return ik.a.w9n}static construct(Q,
Da){const eb=new Fh;eb.FileId=Q;eb.Location=Da;return eb}}Object(f.a)(Fh,"PlayGraphMergeReplayRequest",Mg.a,[]);class zj{constructor(Q,Da,eb,Tb,Ac,hd=null,Ud=null){this.fm=!1;this.wQ=null;this.GCh=this.YXe=!1;this.bqf=()=>{if(this.hFa.a$d)this.YXe=!0;else if(this.YXe=!1,!this.ZMo){this.GCh=!0;var Ee=this.WPa.gDa;Ca.ULS.sendTraceTag(39084353,300,50,"GraphMerge consent given: {0}",Ee===cg.a.cqf);if(Ee===cg.a.IVc||Ee===cg.a.cqf)Ee=fg.construct(this.ZS(),Ee),this.kt(Ee)}};this.WKi=(Ee,Me)=>{Me&&Me.Q7f&&
Me.Q7f.lsf&&!this.hFa.K1i&&(this.hFa.g4j(),this.hFa.a$d=!0,this.kt(Me.Q7f.lsf))};this.UKi=(Ee,Me)=>{Me&&Me.Ctd&&this.hFa.g4j()};this.VKi=(Ee,Me)=>{Me&&(Me.ShowMergePrompt&&this.WPa.hEj(this.bqf),m.AFrameworkApplication.gh&&(m.AFrameworkApplication.gh.SessionMergeInfo|=Me.PartMergeInfo))};this.ZS=Q;this.uPd=eb;this.hFa=Tb;this.WPa=Ac;this.uPd&&this.uPd.NZk(this.WKi);this.BH=hd||yf.a.instance;if(!Ud){const Ee=new tf.a;Ud=Me=>Ee.Eaa(0,Me)}this.Pmk=Ud}get prn(){return this.YXe}get ZMo(){return this.GCh}kt(Q){const Da=
new Mn.a;Da.Wq=Q;Da.status=gj.a.nH;Da.vE="GraphMerge";const eb=this.Pmk(()=>{this.Skd(Da,Q.$m()===ik.a.R8h)});eb.CG(Da);eb.g_()}Skd(Q,Da){this.fm||(Da&&(this.hFa.a$d=!1),2===Q.statusCode&&!ma.a.SSb(Q.fk)&&1===Q.fk.length&&Q.fk[0]?(Q=Q.fk[0],Q.StatusCode?this.hFa.fzg():Da&&this.WPa.hEj(this.bqf),this.BH.cPa(Q),this.prn&&this.bqf()):this.hFa.fzg())}qvb(Q){this.wQ=Q;this.wQ.OJb(this.UKi);this.wQ.lcc(this.VKi)}dispose(){this.fm||(this.uPd&&this.uPd.Oxo(this.WKi),this.wQ&&(this.wQ.XYb(this.UKi),this.wQ.$jd(this.VKi)),
this.fm=!0)}}Object(f.a)(zj,"GraphMergeBackupManager",null,[1296,10]);class om{constructor(Q,Da=null,eb=null,Tb=null){this.jKe=0;this.RWe=!1;this.gqh=new Date(0);this.a$d=!1;this.WPa=Q;this.nB=Da||(()=>new Date);eb||(eb=m.AFrameworkApplication.J?m.AFrameworkApplication.J.ic("WordEditorGraphMergeBackupDelayInMs",12E4):12E4);this.NCk=eb;Tb||(Tb=m.AFrameworkApplication.J?m.AFrameworkApplication.J.ic("WordEditorGraphMergeMaxBackups",1):1);this.Vsh=Tb}get Ypn(){return+this.nB()-+this.gqh<this.NCk}get K1i(){return this.WPa.gDa===
cg.a.automatic?!1:this.WPa.gDa===cg.a.IVc?!0:this.RWe||this.a$d||this.Ypn}g4j(){this.gqh=this.nB();this.jKe++;this.jKe>=this.Vsh&&this.fzg()}fzg(){this.RWe||(this.RWe=!0,Ca.ULS.sendTraceTag(39084356,300,50,"Permanently throttling merge reports after creating {0} out of a maximum of {1} reports.",this.jKe,this.Vsh))}}Object(f.a)(om,"GraphMergeBackupThrottler",null,[1295]);class ej{constructor(Q,Da,eb=null){this.djh=!1;this.r9=Q;this.ktk=Da;null==eb&&(eb=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("WordEditorGraphMergeBypassConsentPrompt"));
this.d4e=eb?cg.a.automatic:cg.a.jqe}get gDa(){return this.d4e}hEj(Q){if(!this.djh&&this.gDa===cg.a.jqe){var Da=this.ktk.value;Da&&Da.isFeatureEnabled(45)&&(this.djh=!0,this.r9.execute(eb=>{eb.d4o(()=>{this.swl(Q)},()=>{this.IVc(Q)})}))}}IVc(Q){this.gDa===cg.a.jqe&&(Ca.ULS.sendTraceTag(42333270,300,50,"Consent denied for investigating merge failures."),this.d4e=cg.a.IVc,Q());this.CAj()}swl(Q){this.gDa===cg.a.jqe&&(Ca.ULS.sendTraceTag(42333271,300,50,"Consent received for investigating merge failures."),
this.d4e=cg.a.cqf,Q());this.CAj()}CAj(){this.r9.execute(Q=>{Q.CYm()})}}Object(f.a)(ej,"GraphMergeCollectionConsentManager",null,[1294]);class Kj extends Sys.EventArgs{constructor(Q){super();this.Q7f=Q}}Object(f.a)(Kj,"GraphMergeCompleteEventArgs",Sys.EventArgs,[]);var Tl=d(871),nj=d(1025),Nn=d(611),ui;(function(Q){Q[Q.none=0]="none";Q[Q.Zj=1]="failure";Q[Q.Jza=2]="crash";Q[Q.success=3]="success"})(ui||(ui={}));Object(f.b)("GraphMergeReplayReason",ui);var oq=d(1771),rp=d(1768),Am=d(59),Bh=d(221),ml=
d(175);class nl{constructor(Q,Da,eb,Tb,Ac,hd){this.Dmg=this.Ug=null;this.k$c=this.DNg=!1;this.Tl=null;this.xod=Q.runtime.xod;this.hu=Q;this.kf=Da;this.ih=eb;this.Po=Tb;this.gwl=Ac;this.VJi=hd}}Object(f.a)(nl,"GraphNodeComplexMergeState",null,[]);var um=d(1464),jr=d(1441);class oi{constructor(Q,Da=null){this.vg=Q;this.M8b=Da||this.Y2c()}get yub(){return this.M8b}get kf(){return this.vg}Y2c(){return[Object(R.a)(this,this.F6o,"simpleMerge"),Object(R.a)(this,this.svl,"complexMerge")]}sYo(Q,Da,eb,Tb,Ac,
hd){Da=new nl(Q,eb,new tb.a(()=>new um.a(Tb?Tb.Bm:null,Ac)),new tb.a(()=>new um.a(Tb?Tb.Bm:null,hd)),new tb.a(()=>new um.a(hd,Ac)),Da.S8h(Ac,()=>Q.runtime.sc));Da.Ug=Tb.Oac;Da.Dmg=new Bh.a;return Da}merge(Q,Da,eb,Tb,Ac,hd){Da=this.sYo(Q,Da,eb,Tb,Ac,hd);eb=!0;for(Tb=0;Tb<this.yub.length&&eb;Tb++)(eb=(0,this.yub[Tb])(Da))||Q.logger.Che("GraphNodeMerge.GetMergeFunctions()",Tb);if(Q=Da.k$c&&Da.Tl?new jr.a(Da.Tl,!1):null)switch(Q.IWo(Da.Ug),(Q?Q.Bm:Ac).wc){case Am.a.Wd:Da.hu.runtime.lse.Dxl.Z(Q.Bm.id,
Q.Bm);break;case Am.a.wmb:Da.hu.runtime.lse.sbl.Z(Q.Bm.id,Q.Bm);break;case Am.a.XK:Da.hu.runtime.lse.kul.Z(Q.Bm.id,Q.Bm);break;case Am.a.paragraphNode:Da.hu.runtime.Rie.add(Q.Bm.id)}return{returnValue:Da.k$c,Tl:Q}}F6o(Q){if(Q.hu.runtime.sc&&Q.hu.runtime.sc.frb(1000005)&&0<Q.Ug.count)return!0;var Da=Q.VJi.rqe;return Q.Po.value.j8c(Da)&&Q.gwl.value.j8c(Da)?Q.ih.value.j8c(Da)?!0:(Da=Q.Po.value.Lf,Q.k$c=!0,Q.Tl=Da.JO(),!1):(Q.k$c=!0,!1)}svl(Q){const Da=Q.Po.value.Lf;Q.xod&&ml.a.instance.Ua(4018183,1,
4,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",Da.id,Da.wc);const eb=Q.VJi.uJg(Q);Q.k$c=eb;ml.a.instance.Ua(4018184,1,eb?5:4,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",eb?"Succeeded":"Failed",Da.id,Da.wc,!!Q.Tl);return eb}}Object(f.a)(oi,"GraphNodeMerge",null,[1422]);var Qo;(function(Q){Q[Q.none=0]="none";Q[Q.GTp=1]="crashesOnly";Q[Q.jeq=2]="rejectionsAndCrashes";Q[Q.YPp=3]="allMerges"})(Qo||(Qo={}));Object(f.b)("GraphMergeBackupCases",Qo);var sp=d(1317),
bq=d(1264);class rs extends Oo.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=this.FileId=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=sp.a.none;this.RequestId=this.ObjectSpaceId=null;this.Source=bq.a.none;this.Reason=ui.none;this.Prompt=0}$m(){return ik.a.R8h}static construct(Q,Da,eb,Tb,Ac,hd,Ud,Ee,Me,Kf,th){const Fj=new rs;Fj.FileId=Q;Fj.BaseRevisions=Da;Fj.TheirRevisions=eb;Fj.YourRevisions=Tb;Fj.IgnoreConflictsInLastServerRevision=
Ac;Fj.MergeHint=hd;Fj.ObjectSpaceId=Ud?ro.a(Ud):null;Fj.RequestId=Ee?ro.a(Ee):null;Fj.Source=Me;Fj.Reason=Kf;Fj.Prompt=th;return Fj}}Object(f.a)(rs,"CreateGraphMergeReplayRequest",Oo.a,[]);var yi=d(803),cq=d(241),Ho=d(14),fj=d(1905),Qj=d(1990);class Yq{constructor(Q,Da=null,eb=null){this.kUl=(Tb,Ac)=>{let hd=Tb;var Ud=Ac,Ee=this.sjb.get(Tb);if(!Ee)return{vNa:hd,oZb:Ud};Ud=new Bh.a;Ud.add(Ee);var Me=this.FFb.get(Tb)||this.vH.K(Tb);Ee=new Bh.a;Ee.add(Me);Me=new Bh.a;Me.add(this.vH.K(Tb));Ca.ULS.sendTraceTag(17409890,
318,50,"Performing CpMerge: [Source: {0}] [MergeHint: {1}] [LocalRevisionObjects: {2}] [ServerRevisionObjects: {3}]",this.uJ.gPf,this.uJ.lma,this.iAi(Ee),this.iAi(Ud));var Kf=this.EAi(this.uJ.lma);this.B8l(Kf,Tb,Ud);Ee=new fj.a(Kf,Me,Kf.input.lma===sp.a.hBc?Ee:Ud,Kf.input.lma===sp.a.hBc?Ud:Ee,this.EAi(sp.a.hBc),Ee,Ud);Ud=new Bh.a;for(Me=0;Me<Ac.length;Me++){this.uJ.$I("GraphMergeSelectionRecordUpdater.DoParagraphMergeForModifiedObject");const th=({idb:hd,Xua:Kf}=Ee.osd(Tb,Ac.K(Me))).returnValue;Ud.add(Kf);
th?Ca.ULS.sendTraceTag(17409891,318,50,"UpdateSelectionRecordsForParagraph: Updating the selection record for [Paragraph: {0}] [Cp: {1}] to [Result Paragraph: {2}] [Result Cp: {3}] ",Tb,Ac.K(Me),hd,Kf):Ca.ULS.sendTraceTag(4339677,318,15,"UpdateSelectionRecordsForParagraph: UpdateCpAccordingToIncomingChange was unable to update the cp for [Paragraph: {0}]",Tb)}return{vNa:hd,oZb:Ud}};this.uJ=Q;this.vH=Q.Cn;this.sjb=Q.lgp;this.FFb=Q.AHp;this.KBk=Q.ryn;this.vg=Da||new nj.a;this.jGk=eb||this.kUl}NYc(Q){const Da=
new Bh.a;for(let eb=0;eb<Q.length;eb++){const Tb=this.cUl(Q.K(eb));Da.add(Tb)}return Da}MYc(Q,Da,eb){const Tb=Q.sv===Q.HA&&Q.startCp===Q.endCp;Da&&({vNa:Q.sv,Xua:Q.startCp}=this.r0a(Q.sv,Q.startCp,Q.sv),Tb&&(Q.HA=Q.sv,Q.endCp=Q.startCp));eb&&!Tb&&({vNa:Q.HA,Xua:Q.endCp}=this.r0a(Q.HA,Q.endCp,Q.HA));return Q}cUl(Q){if(Q.sv===Q.HA){var Da=new Bh.a;Da.add(Q.startCp);Da.add(Q.endCp);({vNa:Q,oZb:Da}=this.ILg(Q.sv,Da));return new yi.a(Q,Da.K(0),Q,Da.K(1))}Da=new Bh.a;var eb=new Bh.a;let Tb;Da.add(Q.startCp);
({vNa:Da,oZb:Tb}=this.ILg(Q.sv,Da));eb.add(Q.endCp);({vNa:Q,oZb:eb}=this.ILg(Q.HA,eb));return new yi.a(Da,Tb.K(0),Q,eb.K(0))}ILg(Q,Da){let eb=Q,Tb=Da;if(!this.vH.K(Q))return Ca.ULS.sendTraceTag(4339675,318,50,"UpdateSelectionRecordsForParagraph: Not updating the selection record for [Paragraph: {0}] as it is new in this revision",Q),{vNa:eb,oZb:Tb};if(this.sjb.get(Q))({vNa:eb,oZb:Tb}=this.jGk(Q,Da,eb,Tb));else if(this.uJ.wTf&&!this.uJ.wTf.K(this.uJ.wTf.length-1).k3(Q)){Tb=new Bh.a;for(let Ac=0;Ac<
Da.length;Ac++){let hd;({vNa:eb,Xua:hd}=this.r0a(Q,Da.K(Ac),eb));Tb.add(hd)}}return{vNa:eb,oZb:Tb}}iAi(Q){let Da="";Q.forEach(eb=>{Da+=eb.kzc();Da+=" ";return!0});return Da}EAi(Q){const Da=La.a.instance.Oa(12),eb=new Qj.a;eb.input.source=this.uJ.gPf;eb.input.lma=this.uJ.lma;eb.input.x_c=()=>Da;eb.runtime.Cn=this.vH;eb.runtime.wIa=this.uJ.Nul;Q===sp.a.hBc?(eb.runtime.IA=this.FFb,eb.runtime.uv=this.sjb,eb.runtime.B1d=this.uJ.S3i,eb.runtime.xDe=this.uJ.n4i):Q===sp.a.HBe&&(eb.runtime.IA=this.sjb,eb.runtime.uv=
this.FFb,eb.runtime.B1d=this.uJ.n4i,eb.runtime.xDe=this.uJ.S3i);eb.runtime.sc=Da;return eb}B8l(Q,Da,eb){if(Q.runtime.IA.lb(cq.a.QN)){var Tb=Q.runtime.IA.K(cq.a.QN);Tb=this.vg.getPropertyObjectIds(Tb,Ff.a.uY);if(1===Tb.length&&(Tb=Tb.K(0),Q.runtime.IA.lb(Tb)&&(Tb=Q.runtime.IA.K(Tb),3===this.vg.getPropertyInt32(Tb,Ff.a.bAb)))){const Ac=this.vg.getPropertyString(Tb,Ff.a.Xna),hd=this.vg.getPropertyString(Tb,Ff.a.X1b);Da.toString()===Ac&&Ac===hd&&(Da=this.vg.getPropertyObjectId(Tb,Ff.a.ssd),Q.runtime.IA.lb(Da)&&
eb.add(Q.runtime.IA.K(Da)))}}}NBm(Q,Da){let eb=0;for(let Tb=0;Tb<Q.length;Tb++)if(Da.equals(Q.K(Tb)))return eb=Tb,{returnValue:!0,idx:eb};return{returnValue:!1,idx:eb}}r0a(Q,Da){const eb=this.KBk&&!!this.FFb.K(Q)&&!this.vH.K(Q);let Tb=Q,Ac=Da,hd=!1,Ud=!1;(eb?this.FFb:this.sjb).forEach((Ee,Me)=>{this.uJ.$I("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");if(this.zZf(Me.wc)&&this.vH.K(Ee)){Me=null;if(eb){Me=this.u3c(th=>this.FFb.K(th)||this.vH.K(th),Ee);var Kf=this.aee(Me,
Q)}else Kf=this.u3c(th=>this.vH.K(th),Ee),Kf=this.aee(Kf,Q);if(Kf&&(Ud=!0,Me||(Me=this.u3c(th=>this.FFb.K(th)||this.vH.K(th),Ee)),Ee=this.u3c(th=>this.sjb.K(th)||this.vH.K(th),Ee),Kf=0,({idx:Kf}=this.NBm(Me,Q)).returnValue)){for(let th=Kf+1;th<Me.length;th++)if(this.aee(Ee,Me.K(th)))return Ac=0,Tb=Me.K(th),hd=!0,!1;for(--Kf;0<=Kf;Kf--)if(this.aee(Ee,Me.K(Kf)))return Ac=Number.MAX_VALUE,Tb=Me.K(Kf),hd=!0,!1}}return!0});hd||(Ca.ULS.sendTraceTag(4339678,318,15,"UpdateSelectionRecordForDeletedParagraph: Was unable to reposition the selection record [ObjectID : {0}] [Cp: {1}] [IsNewParaInRejectedLocalChange: {2}] [FoundDeletedNode: {3}]",
Q,Da,eb,Ud),this.uJ.gPf===bq.a.undo&&(Ca.ULS.sendTraceTag(17340240,318,50,"UpdateSelectionRecordForDeletedParagraph: Unable to position IP, Trying to update to first para in server revision for Undo",Tb),({Bni:Da}=this.iqm()).returnValue?(Tb=Da,Ac=0,Ca.ULS.sendTraceTag(17340241,318,15,"UpdateSelectionRecordForDeletedParagraph: Did not find any paragraphs that were common on client and server. Repositioning to the start of the first [Paragraph:{0}] in the incoming revision",Tb)):Ca.ULS.sendTraceTag(17340242,
318,15,"UpdateSelectionRecordForDeletedParagraph: Unable to get the first para in an incoming change",Tb)));return{vNa:Tb,Xua:Ac}}iqm(){let Q=kc.a.nil,Da=new Bh.a;this.sjb.forEach((eb,Tb)=>{this.uJ.$I("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");return this.zZf(Tb.wc)?(Da=this.u3c(Ac=>this.sjb.K(Ac)||this.vH.K(Ac),eb),!1):!0});return 0<Da.length?(Q=Da.K(0),{returnValue:!0,Bni:Q}):{returnValue:!1,Bni:Q}}zZf(Q){return Q===Am.a.hH||Q===Am.a.qp||Q===Am.a.Ina||Q===Am.a.Bca}u3c(Q,
Da){var eb=Q(Da);Da=new Bh.a;if(!this.zZf(eb.wc))return Da;eb=this.vg.getPropertyObjectIds(eb,Ho.a.pg);for(let Tb=0;Tb<eb.length;Tb++){const Ac=new Bh.a;this.sLf(Q,eb.K(Tb),Ac);Da.iD(Da.length,Ac)}return Da}sLf(Q,Da,eb){var Tb=Q(Da);if(Tb)if(Tb.wc===Am.a.paragraphNode)eb.add(Da);else if(Tb.wc===Am.a.MX)Da=this.vg.getPropertyObjectIds(Tb,Ho.a.oF).sg(0),this.sLf(Q,Da,eb);else if(Tb.wc===Am.a.qp||Tb.wc===Am.a.Ina||Tb.wc===Am.a.Bca)for(Da=this.vg.getPropertyObjectIds(Tb,Ho.a.pg),Tb=0;Tb<Da.length;Tb++)this.sLf(Q,
Da.K(Tb),eb)}aee(Q,Da){for(let eb=0;eb<Q.length;eb++)if(Da.equals(Q.K(eb)))return!0;return!1}}Object(f.a)(Yq,"GraphMergeSelectionRecordUpdater",null,[]);var uk=d(642),Zq=d(287);class Wr extends oq.a{constructor(Q=null,Da=null,eb=null,Tb=null,Ac=null,hd=null,Ud=null,Ee=null,Me=null,Kf=null,th=null){var Fj;super();this.t$h=uh=>{const hi=uh.DJ,kk=ld.StaticActiveAppFrame.za().kb.$c;return Object(uk.b)({cB:uh,vm:hi,fileId:kk.fileId,Mga:kk.Mga,contextId:kk.contextId,j1d:hi?hi.id:kc.a.nil,ldb:this.ldb,ede:!1,
sae:!0,cellId:kk.Ic.id},!0,kk.Ic.store)};this.ZS=Q||(()=>m.AFrameworkApplication.rootQuerySignature);Da||(Da=uh=>new Tl.a(uh));this.mBh=Da;this.vg=eb||new nj.a;this.K$g=Ud||new rp.ChildNodeListMerge(this.kf);this.f$b=Ee;this.ldb||(this.f$b=(uh,hi,kk)=>new Nn.a(uh,hi,kk));this.M8b=Tb||this.Y2c();this.kib=Ac||new Nh.a;this.Jih=hd||new oi(this.kf);this.cth=(null===(Fj=m.AFrameworkApplication.J)||void 0===Fj?void 0:Fj.ic("WordEditorGraphMergeMaxBrowserTimeInMs",750))||750;this.hFa=Me;this.WPa=Kf;this.o9d=
this.hQl(th);this.ggh=()=>La.a.instance.Oa(12)}hQl(Q){Q||(Q=Qo.none,Q=m.AFrameworkApplication.J?m.AFrameworkApplication.J.ic("WordEditorGraphMergeBackupCasesBrowser",Q):Q);return Q}fKa(){return(new Date).getTime()}YWj(Q,...Da){return String.format.apply(null,[Q].concat(Da))}Kgp(Q){throw cj.a.invalidOperation(Q);}s5d(Q){return String.format("Name: {0}, Message: {1}, Stack: {2}",Q.name,Q.message,Q.stack)}mbo(Q){if(this.hFa&&this.hFa.K1i||!this.jcp(Q))return null;this.sBn(Q);let Da;({I$k:Tb,kgp:Ac,zHp:Da}=
this.EHl(Q,this.t$h));const eb=oq.a.zrm(Q);var Tb=rs.construct(this.ZS(),Tb.sEa(),Ac.sEa(),Da.sEa(),Q.input.sRb,Q.input.lma,Q.input.ml,Q.input.iVb,Q.input.source,eb,this.WPa.gDa);var Ac=Q.output.LL;eb===ui.success&&0<Ac.length&&(Tb.MergedRevision=this.t$h(Q.output.LL.last()));return Tb}NYc(Q,Da){return(new Yq(Q)).NYc(Da)}MYc(Q,Da,eb,Tb){return(new Yq(Q)).MYc(Da,eb,Tb)}}Object(f.a)(Wr,"GraphMerger",oq.a,[]);Object(Zq.a)(oi,{merge:!0});class Io extends Wr{constructor(Q,Da=null,eb=null){super(Q,void 0,
void 0,void 0,void 0,void 0,void 0,void 0,Da,eb);this.sa=new W.a}get gDa(){return this.WPa?this.WPa.gDa:cg.a.unknown}get VMb(){return null}set VMb(Q){}NZk(Q){this.sa.addHandler(Io.fPf,Q)}Oxo(Q){this.sa.removeHandler(Io.fPf,Q)}iBg(){return!1}gVb(Q,Da,eb,Tb,Ac,hd,Ud){(Q=super.gVb(Q,Da,eb,Tb,Ac,hd,Ud))&&this.sa.raiseEvent(Io.fPf,new Kj(Q));return Q}}Io.fPf="GMC";Object(f.a)(Io,"WordEditorGraphMerger",Wr,[1291,1292,1293]);class ho{constructor(){this.W=null}get name(){return"WordEditor.GraphMerge"}uc(Q){this.W=
Q;this.W.ia("WordEditor.GraphMerge.GraphMergeCollectionConsentManager",()=>new ej(this.W.Ra(675),new tb.a(()=>Q.Oa(12)))).as(691).ha();this.W.ia("WordEditor.GraphMerge.GraphMergeBackupThrottler",()=>new om(this.W.resolve(691))).as(1254).ha();this.W.ia("WordEditor.GraphMerge.WordEditorGraphMerger",()=>new Io(()=>m.AFrameworkApplication.rootQuerySignature,this.W.resolve(1254),this.W.resolve(691))).as(1255).ha();this.W.ia("WordEditor.GraphMerge.GraphMergeBackupManager",()=>new zj(()=>m.AFrameworkApplication.rootQuerySignature,
m.AFrameworkApplication.va,this.W.resolve(1255),this.W.resolve(1254),this.W.resolve(691))).as(700).ha()}init(){Ri.a.sS||(Ri.a.sS=Ue.a.kaa());const Q=this.W.resolve(1255);Ri.a.sS.Bal(Q);this.W.resolve(700)}dispose(){let Q=this.W.Oa(700);Q&&Q.dispose()}}Object(f.a)(ho,"GraphMergePackage",null,[0,1]);var Aj=d(285);class Ls{constructor(Q){this.rMe="FontPicker";this.vWe=null;this.bOb=Da=>{this.vWe=Da.isEnabled;Da=appChrome.actions.updateFontPickerLicenseState(this.rMe,Da.isEnabled);appChrome.api.dispatch(Da)};
this.qgb=Q;this.lAd=this.qgb.Nua(Aj.a.gUb,this.bOb);this.qgb.isFeatureEnabled(Aj.a.gUb,!1).then(Da=>{this.vWe=Da})}get isLicensed(){return this.vWe}dispose(){this.qgb.VYb(Aj.a.gUb,this.lAd)}}Object(f.a)(Ls,"ModernFontPickerFeatureHelper",null,[1890,10]);var pq=d(482),Ms=d(633),vn=d(1643);class Jo{constructor(){this.type="FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(f.a)(Jo,"FontInfoTaskPaneProps",
null,[]);class On{constructor(Q,Da,eb,Tb=null){this.qaf=this.WY=this.lAd=null;this._state=this.j8b=0;this.onOpen=()=>{this._state=2;this.ON()};this.onShow=Ac=>{0!==this._state&&(this._state=2,1===Ac&&(this.j8b=Ac),this.ON())};this.onClose=()=>{this.j8b=this._state=0;this.blur()};this.onHide=()=>{this._state=1;this.j8b=0};this.onUpsellButtonClicked=()=>{this.qgb.launchUpsellExperience(vn.a.experienceId)};this.pZe=Q;this.qgb=Da;this.Nmk=eb;this.Yb=Tb}get Rb(){return this.pZe.value}initialize(){this.Rb.qa(x.a.ftg,
z.a.frame,Object(R.a)(this,this.ftg,"requestFontInfo"));this.lAd=this.qgb.Nua(Aj.a.gUb,Object(R.a)(this,this.bOb,"featureStateChangeCallback"));this.tna()}kS(Q=!1){const Da=Uj.UISurfaces.Iv(),eb=this.qgb.isFeatureEnabled(Aj.a.gUb,!1),Tb=[];Tb.push(Da);Tb.push(eb);Promise.all(Tb).then(Ac=>{Ac[0].showTaskPane(vn.a.zOb,this.EB(Ac[1]));Q&&this.ON()})}Dvp(Q){Uj.UISurfaces.Iv().then(Da=>{Da.updateTaskPane(vn.a.zOb,this.EB(Q));return null})}bOb(Q){this.Dvp(Q.isEnabled)}ftg(Q,Da,eb,Tb,Ac){this.WY=Ac.CommandValueId;
this.qaf=Ac.Trigger;this.j8b=Ac.InputMethod;this.kS(2===this._state&&1===this.j8b);return 32}EB(Q){const Da=new Jo;Da.onUpsellButtonClicked=this.onUpsellButtonClicked;Da.fontName=this.WY;Da.isLicensed=Q;Da.trigger=this.qaf;Da.helpArticleUrl=this.Ewl();Da.paneId=vn.a.zOb;Q=this.c3m();Q.contentProps=Da;return Q}c3m(){return Object.assign(new Pi.a,{title:vn.a.Nsc,hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:this.onOpen,onClose:this.onClose,
onShow:this.onShow,onHide:this.onHide})}tna(){if(this.Yb){var Q=this.Yb.ie(vn.a.zOb);Q.parent=Af.AFrame.Eq;Q.HL=!0}}ON(){this.Yb&&1===this.j8b&&this.Yb.Jg(vn.a.zOb)}blur(){this.Yb&&this.Yb.currentScope&&this.Yb.currentScope.name===vn.a.zOb&&this.Yb.Jg(this.Yb.IW)}dispose(){this.qgb.VYb(Aj.a.gUb,this.lAd)}Ewl(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",this.Nmk,this.vsm(),"WDWAENDUSER",m.AFrameworkApplication.lcid)}vsm(){switch(this.qaf){case "missing":return"hlpFontInfoMissingFont";
case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return On.ddl(this.WY)}static ddl(Q){let Da="hlpFontInfo";for(let eb=0;eb<Q.length;++eb){const Tb=Ya.a.charAt(Q,eb);if(255<Q.charCodeAt(eb)||Ya.a.I7c(Tb))Da+=Tb}return Da}}Object(f.a)(On,"FontInfoPane",null,[1868,10]);class tp extends On{constructor(Q,Da,eb,Tb,Ac){super(Q,Da,Tb.ib("FontInfoHelpBaseUrl"),Ac);this.V5=eb}kS(Q){this.i2();super.kS(Q)}bOb(Q){super.bOb(Q);
ld.StaticActiveAppFrame.za().Fe()}i2(){this.V5.nUa()}}Object(f.a)(tp,"WordEditorFontInfoPane",On,[]);class ss{constructor(){this.K6b=this.qGd=this.ZGc=this.W=null}get name(){return"WordEditor.ModernFontPicker"}uc(Q){this.W=Q;Q.ia(1256,()=>new Ls(this.W.resolve(4))).ha();Q.ia(1257,()=>new tp(new tb.a(()=>m.AFrameworkApplication.va),this.W.resolve(4),Ml.a.instance,m.AFrameworkApplication.J,Sf.FocusManager.instance())).ha()}init(){this.qGd=this.W.resolve(1256);this.ZGc=this.W.resolve(1257);this.ZGc.initialize();
m.AFrameworkApplication.J.$("IsAnonymousUser")||((this.K6b=this.W.Oa(Ms.a))?this.K6b.initialize():Ca.ULS.sendTraceTag(557061451,3021,15,"IFontPinningStore service is not available."));ld.StaticActiveAppFrame.za().Fe()}dispose(){this.ZGc&&(this.ZGc.dispose(),this.ZGc=null);this.qGd&&(this.qGd.dispose(),this.qGd=null);this.K6b&&(this.K6b.nza(),this.K6b=null)}static main(){Object(pq.a)()&&C.a.instance.Lc(new ss)}}Object(f.a)(ss,"ModernFontPickerPackage",null,[0,1]);var Ih=d(68),Xf=d(6),Ii=d(747),dm=
d(31),wn=d(1088);class yg{constructor(Q,Da,eb,Tb,Ac,hd,Ud,Ee,Me,Kf,th,Fj=null){this.X0=eb;this.Zc=Q;this.Qc=Da;this.Oh=Ac;this.GPa=hd;this.HY=Ud;this.o$g=Ee;this.n$g=Me;this.rz=Kf;this.iqk=Fj||yg.vx}get Mh(){return this.rz?this.rz.Mh:!1}SQi(Q){return this.XKa(Q,0)}I6m(Q){return this.XKa(Q,1)}XKa(Q,Da){let eb=null;if(this.Mh&&this.HY&&(this.n$g.instance&&this.n$g.instance.OOa(Q),Da?1===Da&&(eb=this.HY.mAi(Q.node)):eb=this.HY.hHf(Q.node,Q.cpBegin,Q.Fb),eb&&!eb.ka(Ff.a.aba,!1)))return Ca.ULS.shipAssertTag(24749379,
368,!1,"Try to insert page break to inconvertible inline content control"),2;const Tb=Xf.a.WW(this.Zc.Rl());Tb.set(Q.node);Tb.vb(10);const Ac=this.Qc.Nc(15);Ac.mu(Tb);Da?dm.OutlineElementNavigator.je(Tb):(this.cEa(Tb,Q),this.X0.Uzc(Q.node,fk.a.Nu));Q=ii.ParagraphReader.Om(Tb.currentNode);this.g8m(Tb);this.Mh&&eb&&this.o$g&&(Da=new kb.a,Da.add(Tb.currentNode),this.o$g.qLh(Da,eb.id));this.XRo(Q);Ac.dispose();return 32}XRo(Q){Q=Wf.SelectionFactory.ue(Q,0);Cg.a.instance.Kc(Q)}g8m(Q){this.Oh.SA(Q,!0,!0,
null,!1,!1);Q=dm.OutlineElementNavigator.Me(Q);this.K6m(Q)}cEa(Q,Da){const eb=dm.OutlineElementNavigator.je(Q);if(Da.cpBegin||this.Mh&&(!this.Mh||-1!==Da.Fb)){Ed.a.ud().Co&&Da.cpBegin!==ii.ParagraphReader.textLength(Da.node)&&Ed.a.ud().Ak.xG(Da.node);this.Oh.SA(Q,!1,!0,null,!1,!0);var Tb=Xf.a.WW(this.Zc.Rl());Tb.set(eb);this.Oh.xca(Tb,Q,Da,!0,!0,!0)}}K6m(Q){Q=this.iqk(Q);this.GPa.pRi(Q)}static LG(){return new yg(new Dd.a,new nh.a,La.a.instance.resolve(70),wn.a.instance,La.a.instance.resolve(18),La.a.instance.resolve(951),
La.a.instance.Oa(14),La.a.instance.Oa(205),La.a.instance.Ra(87),La.a.instance.Oa(11),La.a.instance.resolve(10))}static get instance(){return null!=yg.HYg?yg.HYg:yg.HYg=yg.LG()}static vx(Q){return Bd.a.vx(Q)}}Object(f.a)(yg,"PageBreakInserter",null,[1324]);class Ro{constructor(Q,Da,eb,Tb,Ac,hd,Ud,Ee){this.j8m=(Me,Kf,th,Fj)=>{var uh=Kf.view,hi=uh.mb.Mg;if(!hi)return 2;if(!this.knf(Kf))return 8;if(1===th)return 32;let kk=!0;th=8;const kl=this.vXe(hi);hi=this.Qc.Nc(15);hi.Bb(uh.od);hi.Ii=Me;kl||(th=this.ga.Nf(Kf,
Gd.a.Ira,2,!0,Fj,null),Me=32===th,Ca.ULS.shipAssertTag(4208012,314,Me),kk=Me);kk&&(uh=uh.mb.Mg,Me=this.vXe(uh),Ca.ULS.shipAssertTag(4208013,314,Me,"{0}",{["ContextId"]:Kf.contextId}),th=8,Me&&(th=this.eVe.SQi(uh),Ca.ULS.shipAssertTag(4208014,314,32===th)));hi.dispose();32===th&&this.Yd.Yu(10);return th};this.i8m=(Me,Kf,th)=>{if(!Kf||Kf.contextId!==Uc.a.Xc)return 8;if(1===th)return Kf.contextId===Uc.a.Xc?32:8;if(2===th){if(!this.knf(Kf))return 8;Me=this.eVe.SQi(Kf);32===Me&&this.Yd.Yu(10);return Me}return 32};
this.h8m=(Me,Kf,th)=>{if(!Kf||Kf.contextId!==Uc.a.table)return 8;if(1===th)return 32;if(2===th){if(!this.knf(Kf))return 8;Me=this.eVe.I6m(Kf);32===Me&&this.Yd.Yu(10);return Me}return 32};this.ga=Q;this.eVe=Da;this.Qc=eb;this.Sn=Tb;this.vXe=Ac;this.xl=hd;this.lzk=Ud;this.Yd=Ee}Xb(){this.ga.qa(hg.a.XKa,Uc.a.view,this.j8m);this.ga.qa(hg.a.XKa,Uc.a.Xc,this.i8m);this.ga.qa(hg.a.XKa,Uc.a.table,this.h8m);this.ga.Pc(hg.a.XKa,4)}k8(){const Q=Sf.FocusManager.instance().ie(Ih.a.uF);Af.AFrame.$i(Q,gd.KeyInputManager.mc(fk.a.Nu,
gd.KeyInputManager.li),hg.a.XKa)}Hin(Q){return this.ny(Q.iterator)}xmn(Q){Q=Q.K(0);const Da=gg.a.uk(Q,!0,!1);if(this.ny(Da.Qa.iterator))return!0;Q=gg.a.uk(Q,!1,!1);return this.ny(Q.Qa.iterator)}ny(Q){return Q.vb(14)}knf(Q){let Da=null,eb=Q;if(eb.contextId===Uc.a.view){Da=eb.view;if(!Da.features.wFg)return!1;eb=Da.mb.Mg;if(!eb)return!1}else{const Tb=Xf.a.Za(eb.node);if(Tb.vb(36)||Tb.vb(38)||Tb.vb(40)||Tb.vb(14))return!1}return Ii.a.Jla(Q)?!1:eb.contextId===Uc.a.table?this.xl.rin(eb.node):!this.xl.pin(eb)||
this.Sn&&this.Sn.instance&&this.Sn.instance.sX(eb)?!1:((Q=this.vXe(eb))?this.Hin(eb):this.xmn(Da.mb.gb))||Q&&this.lzk(eb,!0)?!1:!0}static LG(){return new Ro(m.AFrameworkApplication.va,yg.instance,new nh.a,La.a.instance.Ra(51),gg.a.pf,Tg.a.instance,Bf.a.QBa,La.a.instance.resolve(46).instance)}static get instance(){return null!=Ro.zXg?Ro.zXg:Ro.zXg=Ro.LG()}}Object(f.a)(Ro,"PageBreakActor",null,[1286]);class ri{constructor(){this.h2e=this.W=null}get name(){return"WordEditor.PageBreak"}uc(Q){this.W=Q}init(){this.W.resolve(12).us.continueWith(()=>
{this.Fo()})}Fo(){this.h2e=Ro.instance;this.h2e.Xb();this.h2e.k8();ld.StaticActiveAppFrame.za().Fe()}dispose(){}}Object(f.a)(ri,"PackageManager",null,[0,1]);var kr=d(1354),Fk=d(1355),Wj=d(294),En=d(203),qq=d(227),si=d(274),Zl=d(471);class Rk{constructor(Q,Da,eb,Tb,Ac,hd,Ud){this.DGb=null;this.sa=new W.a;this.LNe=1;this.bFd=-1;this.F3a=null;this.mua=()=>{this.Rlf()};this.hb=Da;this.Gb=eb;this.ozd=Tb;this.IK=Ac;this.oC=hd;this.P5=Ud;this.enable()}get uYd(){return this.LNe}bPj(Q){this.LNe!==Q&&(this.LNe=
Q,this.sa.raiseEvent("X"),this.lee&&this.rLg())}get lee(){const Q=La.a.instance.Oa(1258);return Q?Q.lee:!0}get tl(){return this.IK.value}get Zk(){return ne.a.instance}XYk(Q){this.sa.addHandler("X",Q)}rLg(){this.Zk.$d(()=>{this.P5.eS(Zl.a.Voj)},"CPC:UPN")}enable(){this.hb.tA(this.mua);this.Rlf()}Rlf(){if(!this.F3a||1>=this.F3a.count)this.bPj(1);else{var Q=this.hb.gb.currentSelection;if(Q){var Da=Q.Kf?Q.Wc:Q.Qa;!Da||0>Da.cpBegin||(Q=Da.node)&&ii.ParagraphReader.Vb(Q)&&this.Yhn(Q)&&(this.DGb&&(this.Gb.uf(this.DGb),
this.DGb=null),this.DGb=new ud.a(2,1,400,eb=>{this.X5l(eb,Da)},62),this.Gb.Zb(this.DGb))}}}Yhn(Q){Q=Xf.a.Za(Q);return Q.vb(35)||Q.vb(37)||Q.vb(39)?!1:!0}I6j(Q){this.F3a=Q;this.a5j()}a5j(){if(-1!==this.bFd){var Q=this.Y5l(this.bFd);-1!==Q&&this.bPj(Q)}}X5l(Q,Da){this.DGb===Q&&(this.DGb=null,this.bFd=this.pdm(Da),-1!==this.bFd&&this.a5j())}Y5l(Q){if(!this.F3a)return-1;for(let Da=0;Da<this.F3a.count;Da++){const eb=this.F3a.K(Da);if(Q>eb.bKh&&Q<eb.bKh+eb.height)return eb.Ch}return-1}pdm(Q){var Da=this.fCm(Q);
if(!Da||!Da.htmlElement)return-1;const eb=Da.getBounds();Q=this.plm(Q,Da);if(!Q)return-1;Da=ka.a.RVa(this.ozd.hcb,Da.htmlElement).y;return Q.y+Math.floor(Q.height/2)-eb.y+Da}fCm(Q){return Q.node.Be(this.tl.pc)}plm(Q,Da){Q=this.oC?this.oC.Eza(Q,!0):Q.cpBegin;return si.a.Ar(Da,Q)}disable(){this.hb.Rga(this.mua)}}Object(f.a)(Rk,"CurrentPageCalculator",null,[1398,1392]);class Fn{constructor(Q){Fn.i1=Q}get fuf(){return Fn.i1}get uYd(){return this.fuf.uYd}jYl(){this.fuf.enable()}LRl(){this.fuf.disable()}}
Fn.i1=null;Object(f.a)(Fn,"WebViewCurrentPageManager",null,[1397]);var bp=d(110);class cp extends Sys.EventArgs{constructor(Q,Da){super();this.Zej=Da}}Object(f.a)(cp,"DocumentBottomChangeEventArgs",Sys.EventArgs,[]);class vm extends Sys.EventArgs{constructor(Q,Da,eb){super();this.delta=Q;this.Zej=eb}}Object(f.a)(vm,"PageContentSizeChangeEventArgs",Sys.EventArgs,[]);class st{constructor(Q,Da,eb){this.Wyh=this.kJd=-1;this.lMc=null;this.sa=new W.a;this.n0e=!1;this.opj=(Tb,Ac)=>{this.n0e=this.yml();Ac.Lvb||
this.BGc.value.measure(this.rml)};this.rml=()=>{const Tb=this.hcb.clientHeight;this.qml(Tb);this.Bml(Tb)};this.khg=(Tb,Ac)=>{Ac.property===bp.a.NJ&&(Tb=Ac.node)&&Tb.ka(bp.a.NJ,!1)&&(Tb=Tb.Be(this.tl.pc))&&(Tb=Tb.htmlElement)&&this.A3a.add(Tb)};this.IK=Q;this.BGc=Da;this.A3a=new kb.a;this.fSf();this.mga=this.mga.bind(this);eb.QJb(this.mga);0===eb.Kw&&this.ZL()}ZL(){this.tl.eOh(this.opj)}m0a(){this.tl.YBj(this.opj)}get tl(){return this.IK.value}mga(Q,Da){this.lMc=null;0===Da.jMa?this.ZL():this.m0a()}get hcb(){this.lMc||
(this.lMc=this.tl.od.Be(this.tl.pc).hcb,Ca.ULS.shipAssertTag(34136386,336,!!this.lMc));return this.lMc}b_k(Q){this.sa.addHandler("OnPageContentSizeChangeKey",Q)}qml(Q){Q!==this.Wyh&&(this.sa.raiseEvent("OnDocumentBottomChangeKey",new cp(Q,this.n0e)),this.Wyh=Q)}Bml(Q){Q!==this.kJd&&(-1!==this.kJd&&this.sa.raiseEvent("OnPageContentSizeChangeKey",new vm(Q-this.kJd,Q,this.n0e)),this.kJd=this.hcb.clientHeight)}yml(){let Q=!1;for(let Da=this.A3a.count-1;0<=Da;Da--)this.A3a.K(Da).hasChildNodes()&&(this.A3a.removeAt(Da),
Q=!0);return Q}fSf(){Ri.a.gf.Ll.jf(23).jo(this.khg)}}Object(f.a)(st,"DocumentSizeManager",null,[]);var Ko=d(55),Lm=d(228);class Al{constructor(Q){this.IK=Q}get tl(){const Q=this.IK.value;Ca.ULS.shipAssertTag(37820298,336,Q.gj,"OutlineManager.PageView is not a PageView.");return Q}axe(Q,Da){const eb=Ko.a.qj(Al.tg.dD(Q),1);Da+=eb;Q.Be(this.tl.pc).htmlElement.firstChild.style.minHeight=Da+"px"}Xwi(){const Q=Xf.a.Za(this.tl.od);Q.pq();Q.Zd();Ca.ULS.shipAssertTag(37820299,336,10===Q.ko.type);return Q.ko}Azi(){const Q=
Xf.a.Za(this.tl.od);Q.pq();Q.y_();Ca.ULS.shipAssertTag(37820300,336,10===Q.ko.type);return Q.ko}aEm(Q){const Da=Xf.a.Za(this.tl.od);Da.pq();Da.Zd();let eb=Da.ko,Tb=null;for(;Q!==eb&&Da.Gk();)Tb=eb,eb=Da.ko;Ca.ULS.shipAssertTag(37820301,336,10===Da.ko.type);return Tb}static get tg(){return Lm.a.instance}}Object(f.a)(Al,"OutlineManager",null,[1394]);class dl{constructor(Q){this.sGa=0;this.V4=null;this.WBg=Da=>{for(const eb of Da.Yl)this.VBg(eb)};this.Gb=Q}Dne(){this.V4||(this.V4=this.aXc())}qVd(){this.V4&&
0<dl.o1c(this.V4).length&&this.Gb.Zb(this.V4);this.V4=null}aXc(){return Object.assign(new ud.a(3,1,250,this.WBg,166),{Yl:[]})}Tyg(Q){this.sGa=Q}Eod(Q){if(Q){Q.style.width=this.sGa+"px";if(this.V4)var Da=this.V4;else Da=this.aXc(),this.Gb.Zb(Da);dl.o1c(Da).push(Q)}}y5c(Q){Q&&(Q.style.width="0px",this.ORf(Q))}gsd(Q,Da){Da?this.Eod(Q):this.y5c(Q)}VBg(Q){Q.style.width===this.sGa+"px"&&(this.C1c(Q).style.visibility="visible")}ORf(Q){Q&&(this.C1c(Q).style.visibility="hidden")}C1c(Q){Q=Q.childNodes;Ca.ULS.shipAssertTag(24958351,
336,1===Q.length,"Expected 1 child div in the page adornment, found "+Q.length);return Q[0]}static o1c(Q){return Q.Yl}}Object(f.a)(dl,"PageAdornmentAnimationManager",null,[1395]);class em{constructor(Q){this.Wm=Q;this.Bda=new qe.a;this.Cda=new qe.a}AIa(Q){Q=Xf.a.Za(Q);if(Q.pq()&&Q.zq()){Q.Zd();do 10===Q.mf&&this.hkg(Q.currentNode),Q.Au();while(8!==Q.mf)}}$_b(Q){const Da=Q.Ch;var eb=this.kQb(Q.x1b);if(!this.Bda.lb(eb))return Ca.ULS.sendTraceTag(24958352,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+
eb),!1;Q=this.Bda.K(eb);Ca.ULS.shipAssertTag(24958353,336,this.Cda.lb(eb),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");eb=this.Cda.K(eb);return this.JRf(Q,Da,eb)}Z_b(Q){const Da=Q.Ch;var eb=this.kQb(Q.x1b);if(!this.Bda.lb(eb))return Ca.ULS.sendTraceTag(24958354,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+eb),!1;Q=this.Bda.K(eb);Ca.ULS.shipAssertTag(24958355,336,this.Cda.lb(eb),
"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");eb=this.Cda.K(eb);return this.KDf(Q,Da,eb)}ENf(Q){if(!Q)return Ca.ULS.sendTraceTag(24979136,336,10,"Null container input into GetTemplateSelectionFromContainer."),0;var Da=Q.$Sd;if(!Da)return Ca.ULS.sendTraceTag(24979137,336,10,String.format("Container of page number {0} has a null EndSectionNode.",Q.Ch)),0;Da=this.Wm.qPb(Da);if(!Da)return Ca.ULS.sendTraceTag(24979138,336,10,"Header footer container node expected not to be null."),
0;Da=this.Wm.ila(Da);const eb=1===Q.Ch;Q=!(Q.Ch%2);return 1===Da?1:2===Da?eb?2:1:3===Da?Q?3:4:eb?2:Q?3:4}hkg(Q){if(10===Q.type){var Da=new qe.a,eb=this.Wm.qPb(Q);Ca.ULS.shipAssertTag(24958356,336,!!eb,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var Tb=this.Wm.ila(eb);Q=this.kQb(Q);this.GLg(Q,Tb);this.FLg(Q,Da);eb=Xf.a.Za(eb);if(eb.zq()){eb.Zd();do Q=eb.currentNode,Tb=this.Wm.E2c(Q),Q=this.Wm.PMi(Q),Da.add(Tb,Q),eb.Au();
while(36===eb.mf)}}}GLg(Q,Da){this.Cda.lb(Q)?this.Cda.Z(Q,Da):this.Cda.add(Q,Da)}FLg(Q,Da){this.Bda.lb(Q)?this.Bda.Z(Q,Da):this.Bda.add(Q,Da)}kQb(Q){Ca.ULS.shipAssertTag(24958358,336,10===Q.type,"Expected node of type Outline but received node of type "+Q.type);return Q.ka(Ff.a.jna,0)}JRf(Q,Da,eb){const Tb=1===Da;Da=!(Da%2);switch(eb){case 2:if(Tb){if(Q.lb(2))return Q.K(2)}else if(Q.lb(0))return Q.K(0);break;case 3:if(Da){if(Q.lb(1))return Q.K(1)}else if(Q.lb(0))return Q.K(0);break;case 4:if(Tb){if(Q.lb(2))return Q.K(2)}else if(Da){if(Q.lb(1))return Q.K(1)}else if(Q.lb(0))return Q.K(0);
break;case 1:if(Q.lb(0))return Q.K(0)}return!1}KDf(Q,Da,eb){const Tb=1===Da;Da=!(Da%2);switch(eb){case 2:if(Tb){if(Q.lb(5))return Q.K(5)}else if(Q.lb(3))return Q.K(3);break;case 3:if(Da){if(Q.lb(4))return Q.K(4)}else if(Q.lb(3))return Q.K(3);break;case 4:if(Tb){if(Q.lb(5))return Q.K(5)}else if(Da){if(Q.lb(4))return Q.K(4)}else if(Q.lb(3))return Q.K(3);break;case 1:if(Q.lb(3))return Q.K(3)}return!1}}Object(f.a)(em,"PageAdornmentContentManager",null,[1393]);var tt=d(842);class io{constructor(Q,Da,eb,
Tb,Ac,hd,Ud,Ee,Me){this.OMg(Q,Da,eb,hd,Ud,Ee,Me);this.Ch=Q;this.yr=Da;this.Tu=eb;this.x1b=Tb;this.$Sd=Ac;this.tnb=hd;this.slc=Ud;this.iic=Ee;this.epj=Me}get top(){return this.yr}get height(){return this.Tu}Lnd(Q){this.yr!==Q&&(this.tnb.style.top=Q+"px",this.yr=Q)}xyg(Q){this.height!==Q&&(this.tnb.style.height=Q+"px",this.Tu=Q)}OMg(Q,Da,eb,Tb,Ac,hd,Ud){Ca.ULS.shipAssertTag(37244961,336,0<Q,"PageAdornmentContainer: pageNumber parameter value {0} is unexpected value.",Q);Ca.ULS.shipAssertTag(37244962,
336,0<=Da,"PageAdornmentContainer: top parameter value {0} is unexpected value.",Da);Ca.ULS.shipAssertTag(37244963,336,0<=eb,"PageAdornmentContainer: height parameter value {0} is unexpected value.",eb,Da);Ca.ULS.shipAssertTag(37244992,336,!!Tb,"PageAdornmentContainer: containerDomElement parameter is null.");Ca.ULS.shipAssertTag(37244993,336,!!Ac,"PageAdornmentContainer: headerLabelDomElement parameter is null.");Ca.ULS.shipAssertTag(37244994,336,!!hd,"PageAdornmentContainer: footerLabelDomElement parameter is null.");
Ca.ULS.shipAssertTag(37244995,336,!!Ud,"PageAdornmentContainer: pageNumberLabelDomElement parameter is null.")}}Object(f.a)(io,"PageAdornmentContainer",null,[1425]);class vi{constructor(Q,Da,eb,Tb,Ac,hd,Ud,Ee,Me,Kf,th,Fj){this.Cjh="headerFooterTab";this.zNd=null;this.Ut=!0;this.qTe=0;this.GYe=null;this.T9a=!1;this.jWb=uh=>{this.gRn(uh.Ny);return!0};this.pD=()=>!0;this.YQb=()=>{this.vrf()&&(this.T9a=!1,this.Oqp(),this.GYe=new Date)};this.oWb=uh=>{this.T9a||this.DY.Eod(uh.Ny);return!0};this.nWb=uh=>
{this.T9a||(uh=uh.Ny,this.ABg(uh)||this.DY.y5c(uh));return!0};this.pqo=()=>{let uh=Array.dequeue(this.W4e);for(;uh;)this.ZL(uh),uh=Array.dequeue(this.W4e);this.zNd=null};this.IK=Q;this.Dg=Da;this.cG=eb;this.uoa=Tb;this.ga=Ac;this.gl=hd;this.DY=Ud;this.xFa=Ee;this.aRa=Me;this.Gb=Kf;this.Ga=th;this.W4e=[];this.Q4=new Map;this.Fy=Fj;this.aRa.OQd(this.YQb);this.Rx=!!m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib.m3;if(this.DDd=(this.rVe=!!this.Ga&&this.Ga.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&
!!this.Ga&&this.Ga.$("DisableHeaderFooterTabForSmallScreenModeIsEnabled"))"Small"===ld.StaticActiveAppFrame.za().NK.getLayoutBreakpoint()&&(this.Ut=!1),ld.StaticActiveAppFrame.za().NK.registerLayoutBreakpointChanged(this.Cjh,uh=>{switch(uh){case "Small":this.nNi();break;default:this.cTj()}})}get tl(){return this.IK.value}cTj(){try{this.O4o()}catch(Q){Ca.ULS.shipAssertTag(37244997,336,!1,"Exception was caught in ShowPageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}nNi(){try{this.FYm()}catch(Q){Ca.ULS.shipAssertTag(37244998,
336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}hwo(){for(const Q of this.Q4.keys())this.Tse(Q)}AIa(){try{this.Dvl()}catch(Q){Ca.ULS.shipAssertTag(37244999,336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}I6j(Q){try{this.wvp(Q)}catch(Da){Ca.ULS.shipAssertTag(37245E3,336,!1,"Exception was caught in UpdatePageElements. Message: {0}",Da.message)}}dispose(){try{this.mpp(),this.Tpp(),this.aRa&&this.aRa.fCj(this.YQb)}catch(Q){Ca.ULS.shipAssertTag(37245001,
336,!1,"Exception was caught in PageAdornmentManager.Dispose. Message: {0} Stack: {1}",Q.message,Q.stack)}}gRn(Q){const Da=this.G8c(Q),eb=this.jui(Q);eb?(ce.b("OpenHeaderFooterFromWebViewAdornment"),Q=this.xFa.ENf(eb),this.ga.Pb(Da?hg.a.lFe:hg.a.std,2,Q),this.T9a=!0):(Ca.ULS.sendTraceTag(37245002,336,10,"GetContainerFromElement returned a null container for element with id "+Q.id),this.ga.Ob(hg.a.Yae,2))}mpp(){this.Q4.forEach(Q=>{this.m0a(Q)})}Tpp(){this.Rx&&(this.DDd&&(ld.StaticActiveAppFrame.za().NK.unregisterLayoutBreakpointChanged(this.Cjh),
this.DDd=!1),this.Rx=!1)}m0a(Q){if(Q){var Da=Q.slc;Q=Q.iic;pd.a.Fta(Da)&&pd.a.Fta(Q)?(this.gl.xc(U.a.UR,Da,this.oWb),this.gl.xc(U.a.UR,Q,this.oWb),this.gl.xc(U.a.ML,Da,this.nWb),this.gl.xc(U.a.ML,Q,this.nWb),this.Dg.xc(U.a.click,Da,this.jWb),this.Dg.xc(U.a.click,Q,this.jWb),this.cG.xc(Da,vi.aWb),this.cG.xc(Q,vi.aWb),this.uoa.xc(U.a.az,Da,this.pD),this.uoa.xc(U.a.az,Q,this.pD)):Ca.ULS.sendTraceTag(37245003,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}tio(Q){this.W4e.push(Q);
this.zNd||(this.zNd=new ud.a(2,1,50,this.pqo),this.Gb.Zb(this.zNd))}ZL(Q){if(Q){var Da=Q.slc;Q=Q.iic;pd.a.Fta(Da)&&pd.a.Fta(Q)?(this.gl.nb(U.a.UR,Da,this.oWb),this.gl.nb(U.a.UR,Q,this.oWb),this.gl.nb(U.a.ML,Da,this.nWb),this.gl.nb(U.a.ML,Q,this.nWb),this.Dg.nb(U.a.click,Da,this.jWb),this.Dg.nb(U.a.click,Q,this.jWb),this.cG.nb(Da,vi.aWb),this.cG.nb(Q,vi.aWb),this.uoa.nb(U.a.az,Da,this.pD),this.uoa.nb(U.a.az,Q,this.pD)):Ca.ULS.sendTraceTag(37245004,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}O4o(){if(!this.Ut){for(const Q of this.Q4.values())Q.tnb.style.display=
"block";this.Ut=!0}}FYm(){this.Ut&&(this.Q4.forEach(Q=>{Q.tnb.style.display="none"}),this.Ut=!1)}Dvl(){this.xFa.AIa(this.tl.od)}wvp(Q){this.DY.Dne();var Da=0;const eb=new kb.a;this.AIa();const Tb=this.Vum();for(var Ac of Q)Q=Ac.Ch,this.v4n(Ac)||this.Tse(Ac.Ch),this.Q4.has(Q)?this.csp(Ac):this.hCl(Ac),Da=Q,eb.add(Q);for(Ac=1;Ac<=Da;Ac++)eb.contains(Ac)||this.Tse(Ac);for(Da+=1;Da<=Tb;Da++)this.Tse(Da);this.DY.qVd()}v4n(Q){return this.Q4.has(Q.Ch)?this.Q4.get(Q.Ch).x1b.id===Q.x1b.id:!1}Vum(){let Q=0;
this.Q4.forEach((Da,eb)=>{eb>Q&&(Q=eb)});return Q}hCl(Q){const Da=Q.x1b.Be(this.tl.pc);if(Da){var eb=Q.Ch;Q=this.HWc(eb,Q.top,Q.height,Da.Mea,Q.x1b,Q.$Sd);this.tio(Q);this.xKg(Q);this.XLg(Q);this.DDd&&!this.Ut&&(Q.tnb.style.display="none");this.Q4.set(eb,Q)}}HWc(Q,Da,eb,Tb,Ac,hd){const Ud=wg.b("div","","PageAdornmentContainer");Ud.style.top=Da+"px";Ud.style.height=eb+"px";Tb.appendChild(Ud);this.Tlf(Ud,WordEditorIntl.WordEditorStrings.l_Header,WordEditorIntl.WordEditorStrings.l_Footer);Tb=this.Tsf(Q);
Ud.appendChild(Tb);const Ee=this.osf(Q);Ud.appendChild(Ee);const Me=this.esf(Q);Ud.appendChild(Me);m.AFrameworkApplication.isRtl&&(Ud.classList.add("Rtl"),Ee.classList.add("Rtl"),Me.classList.add("Rtl"));return new io(Q,Da,eb,Ac,hd,Ud,Ee,Me,Tb)}osf(Q){Q=wg.b("div","h"+Q,this.Fy?"PageAdornmentHeaderLabelThemed":"PageAdornmentHeaderLabel");this.Fy?Q.classList.add("PageAdornmentHeaderFooterBorderThemed"):Q.style.borderColor=tt.a.VAc;const Da=wg.b("span","","");Da.innerText=WordEditorIntl.WordEditorStrings.l_Header;
Da.style.whiteSpace="nowrap";Q.appendChild(Da);return Q}esf(Q){Q=wg.b("div","f"+Q,this.Fy?"PageAdornmentFooterLabelThemed":"PageAdornmentFooterLabel");this.Fy?Q.classList.add("PageAdornmentHeaderFooterBorderThemed"):Q.style.borderColor=tt.a.VAc;const Da=wg.b("span","","");Da.innerText=WordEditorIntl.WordEditorStrings.l_Footer;Da.style.whiteSpace="nowrap";Q.appendChild(Da);return Q}Tsf(Q){const Da=wg.b("div","","PageAdornmentNumberLabel");Da.innerText=Q.toString();return Da}Tlf(Q,Da,eb){if(!this.qTe){const Tb=
wg.b("p","","");Tb.innerText=Da;Tb.style.whiteSpace="nowrap";Tb.style.visibility="hidden";Q.appendChild(Tb);Da=wg.b("p","","");Da.innerText=eb;Da.style.whiteSpace="nowrap";Da.style.visibility="hidden";Q.appendChild(Da);this.qTe=Q.clientWidth;this.DY.Tyg(this.qTe);Q.removeChild(Tb);Q.removeChild(Da)}}Tse(Q){if(this.Q4.has(Q)){var Da=this.Q4.get(Q);this.m0a(Da);pd.a.wy(Da.tnb);this.Q4.delete(Q)}}csp(Q){if(this.Q4.has(Q.Ch)){var Da=this.Q4.get(Q.Ch);Da.Lnd(Q.top);Da.xyg(Q.height);this.xKg(Da);this.XLg(Da)}else Ca.ULS.sendTraceTag(37245005,
324,15,"We called UpdateContainerForPage, but a container doesn't exist for the given page.")}Oqp(){this.DY.Dne();this.AIa();this.Q4.forEach(Q=>{this.xKg(Q);this.XLg(Q)});this.DY.qVd()}xKg(Q){const Da=Q.slc,eb=Q.iic,Tb=this.xFa.$_b(Q),Ac=this.xFa.Z_b(Q);this.Fxp(Q,Tb,Ac);this.DY.gsd(Da,Tb);this.DY.gsd(eb,Ac)}Fxp(Q,Da=!0,eb=!0){const Tb=Q.slc;Q=Q.iic;3!==m.AFrameworkApplication.va.mode?(Tb.title=WordEditorIntl.WordEditorStrings.l_OpenHeader,Q.title=WordEditorIntl.WordEditorStrings.l_OpenFooter):(Tb.title=
Da?WordEditorIntl.WordEditorStrings.l_EditHeader:WordEditorIntl.WordEditorStrings.l_AddHeader,Q.title=eb?WordEditorIntl.WordEditorStrings.l_EditFooter:WordEditorIntl.WordEditorStrings.l_AddFooter)}ABg(Q){const Da=this.jui(Q);return Da?this.G8c(Q)?this.xFa.$_b(Da):this.xFa.Z_b(Da):(Ca.ULS.sendTraceTag(37245006,336,10,"GetContainerFromElement returned null."),!1)}jui(Q){Q=Q.id;Q=Q.substring(1,Q.length);Q=Number.parseInvariant(Q);return this.Q4.has(Q)?this.Q4.get(Q):(Ca.ULS.sendTraceTag(37245007,336,
10,"Adornment container map does not contain the page number "+Q),null)}G8c(Q){return Q.id.length?"h"===Q.id.substring(0,1):(Ca.ULS.sendTraceTag(37245008,336,10,"Empty ID found for adornment"),!0)}XLg(Q){const Da=Q.height;Da<vi.eKn?(Q.slc.classList.add(vi.zrb),Q.iic.classList.add(vi.zrb)):(Q.slc.classList.remove(vi.zrb),Q.iic.classList.remove(vi.zrb));Da<vi.fKn?(Q.epj.classList.add(vi.zrb),Q.tnb.classList.add(vi.zrb)):(Q.epj.classList.remove(vi.zrb),Q.tnb.classList.remove(vi.zrb))}vrf(){return!this.GYe||
X.a.ARf(this.GYe,500)}static aWb(){return!0}}vi.zrb="Hidden";vi.eKn=120;vi.fKn=50;Object(f.a)(vi,"PageAdornmentManager",null,[1391,10,1392]);class Bp{constructor(Q,Da){this.ioe=new kb.a;this.ioe.add(Q);this.ioe.add(Da)}}Object(f.a)(Bp,"PageElementManagerList",null,[]);var Dr=d(56);class Mm{constructor(Q,Da){this.Xn=Q;this.l9b=[];this.IM=Da}Wzj(){for(let Q=0,Da=this.l9b.length;Q<Da;Q++)pd.a.wy(this.l9b[Q]);Array.clear(this.l9b)}Qvi(Q,Da,eb,Tb,Ac,hd){let Ud=Math.min(Tb.x-hd.x,Ac.x-hd.x);Tb=Math.min(hd.x+
hd.width-(Tb.x+Tb.width),hd.x+hd.width-(Ac.x+Ac.width));Da+=Ac.y-hd.y;({Dma:Da,qba:Ud,fna:Tb}=this.l1k(Da,Ud,Tb));Q=this.dBm(Q,Ud,Tb,Ud,Tb,eb);Q.style.top=Da+"px";Q.style.zIndex="0";this.l9b.push(Q);Dr.d(Q,!0);return Q}a7d(Q){return Q?Q.querySelector(".PageBreakBorderSpan"):null}dBm(Q,Da,eb,Tb,Ac,hd){return Q?this.HKm(Da,eb,Tb,Ac,hd):this.xBm(Tb,Ac,hd)}l1k(Q,Da,eb){Da/=this.Xn.instance.yj;eb/=this.Xn.instance.yj;Q/=this.Xn.instance.yj;return{Dma:Q,qba:Da,fna:eb}}fhn(Q){return this.w2i(Q)&&this.apj(Q)?
(Q=this.YPb(Q))&&Q.offsetParent?!1:!0:!1}ehn(Q){return!this.w2i(Q)||this.apj(Q)?!1:!0}HU(){}YPb(Q){if(!Q.xig)return null;let Da=null;Q.Nsb&&!Q.Tfa?(Q=this.a7d(Q.xig))&&(Da=Q):Da=Q.xig;return Da}w2i(Q){return Q.Nsb&&!Q.Tfa&&Q.paragraphNode?!0:!1}apj(Q){Q=Q.paragraphNode;return!!Q&&!!Q.anchor}vYh(Q,Da){Q=ka.a.bKa(Q);Da=ka.a.bKa(Da);return(Q-Da)/this.Xn.instance.yj}Xlf(Q,Da){Q=ka.a.bKa(Q);Da=ka.a.bKa(Da);return(Q-Da)/this.Xn.instance.yj}Tbd(){this.K6j(!1)}Sbd(){this.K6j(!0)}K6j(Q){for(let Da=0,eb=this.l9b.length;Da<
eb;Da++){const Tb=this.l9b[Da];"PageEndMarker.Para"===Tb.id?Mm.O6j(Tb,Q):"PageEndMarker.Table"===Tb.id&&Mm.J7j(Tb,Q)}}xBm(Q,Da,eb){if(!Mm.gbc){Mm.gbc=wg.b("div","PageEndMarker.Para","PageEndMarker");var Tb=wg.b("div","","Current FullWidth");Tb.style.borderTopColor=this.IM.QAa();Mm.gbc.appendChild(Tb);Tb=wg.b("div","","Stale LeftWing");const Ac=wg.b("div","","Stale RightWing");Tb.style.borderTopColor=this.IM.QAa();Ac.style.borderTopColor=this.IM.QAa();Mm.gbc.appendChild(Tb);Mm.gbc.appendChild(Ac)}Tb=
Mm.gbc.cloneNode(!0);Tb.childNodes[1].style.width=Q-10+"px";Tb.childNodes[2].style.width=Da-10+"px";Mm.O6j(Tb,eb);return Tb}HKm(Q,Da,eb,Tb,Ac){if(!Mm.VIb){Mm.VIb=wg.b("div","PageEndMarker.Table","PageEndMarker");var hd=wg.b("div","","Current LeftWing"),Ud=wg.b("div","","Current RightWing");hd.style.borderTopColor=this.IM.QAa();Ud.style.borderTopColor=this.IM.QAa();Mm.VIb.appendChild(hd);Mm.VIb.appendChild(Ud);hd=wg.b("div","","Stale LeftWing");Ud=wg.b("div","","Stale RightWing");hd.style.borderTopColor=
this.IM.QAa();Ud.style.borderTopColor=this.IM.QAa();Mm.VIb.appendChild(hd);Mm.VIb.appendChild(Ud)}hd=Mm.VIb.cloneNode(!0);hd.childNodes[0].style.width=Q+"px";hd.childNodes[1].style.width=Da+"px";hd.childNodes[2].style.width=eb-10+"px";hd.childNodes[3].style.width=Tb-10+"px";Mm.J7j(hd,Ac);return hd}static O6j(Q,Da){Da?Mm.XEn(Q):Mm.YEn(Q)}static YEn(Q){Q.childNodes[0].style.display="none";Q.childNodes[1].style.display="block";Q.childNodes[2].style.display="block"}static XEn(Q){Q.childNodes[0].style.display=
"block";Q.childNodes[1].style.display="none";Q.childNodes[2].style.display="none"}static J7j(Q,Da){Da?Mm.cFn(Q):Mm.dFn(Q)}static dFn(Q){Q.childNodes[0].style.display="none";Q.childNodes[1].style.display="none";Q.childNodes[2].style.display="block";Q.childNodes[3].style.display="block"}static cFn(Q){Q.childNodes[0].style.display="block";Q.childNodes[1].style.display="block";Q.childNodes[2].style.display="none";Q.childNodes[3].style.display="none"}}Mm.gbc=null;Mm.VIb=null;Object(f.a)(Mm,"PageEndDOMHelper",
null,[]);class Qm{constructor(Q,Da){this.PGb=this.bzh=null;this.Xn=Q;this.kj=Da}HEg(Q,Da){try{this.Lap(Q,Da)}catch(eb){Ca.ULS.sendTraceTag(35005339,336,10,"Exception was caught in PageEndMarkerPositionComparer.StorePositions. Message: {0}",eb.message)}}Zul(Q,Da,eb,Tb,Ac,hd){this.kj.$d(()=>{try{this.$ul(Q,Da,eb,Tb,Ac,hd)}catch(Ud){Ca.ULS.sendTraceTag(35005341,336,10,"Exception was caught in PageEndMarkerPositionComparer.ComparePositions. Message: {0}",Ud.message)}},"PEMPC:CP")}Lap(Q,Da){this.bzh=Q;
this.PGb=Da}$ul(Q,Da,eb,Tb,Ac,hd){var Ud=this.bzh;if(Ud&&Q){var Ee=Ud.count,Me=Q.count;if(Ee&&Me){var Kf=this.A6l(Ud,Q);if(Kf.count){var th=this.Xn.yj,Fj=this.Mec(Kf)/th,uh=this.u4h(Kf)/th;Q=this.w2d(Ud,Q);if(Q.count){Ud=this.Mec(Q)/th;th=this.u4h(Q)/th;var hi=!0;for(var kk=0;kk<Kf.count;kk++)if(Kf.K(kk)){hi=!1;break}var kl=kk=0;this.PGb&&Da&&(kk=this.Ngl(this.PGb,Da),kl=Da.count-this.PGb.count);Ca.ULS.sendTraceTag(35005343,336,50,"{0}",{["HardPageBreakExists"]:Tb,["EstimatedPageCount"]:Ee,["CalculatedPageCount"]:Me,
["InOrderAverageDelta"]:Fj,["InOrderStandardDeviation"]:uh,["ShortestAverageDelta"]:Ud,["ShortestStandardDeviation"]:th,["PositionsShouldBeUpdated"]:eb,["DocumentHeightChanged"]:Ac,["DeltasAllZero"]:hi,["HeaderFooterOpenSinceLastResponse"]:hd,["DeltaInViewport"]:kk,["ChangeInViewportMarkerCount"]:kl});Ac||hd||hi||(Ca.ULS.sendTraceTag(36557839,336,15,"Assumed redundant pagination request but there were changes in the page end marker positions."),Da=Kf.toArray().toString(),eb=Q.toArray().toString(),
Ca.ULS.sendTraceTag(35726603,336,50,"{0} {1}",Da,eb))}}}}else Ca.ULS.sendTraceTag(35005342,336,10,"estimatedPositions or calculatedPositions are null in PageEndMarkerPositionComparer.ComparePositionsInternal.")}Ngl(Q,Da){const eb=new kb.a;for(const Tb of Q)eb.add(Tb.top);if(!eb.count)return-1;Q=new kb.a;for(const Tb of Da)Q.add(Tb.top);if(!Q.count)return-1;Da=this.w2d(eb,Q);return this.Mec(Da)/this.Xn.yj}Mec(Q){if(!Q.count)return 0;let Da=0;for(let eb=0;eb<Q.count;eb++)Da+=Q.K(eb);return Da/Q.count}u4h(Q){if(!Q.count)return 0;
const Da=this.Mec(Q);let eb=0;for(let Tb=0;Tb<Q.count;Tb++){const Ac=Q.K(Tb)-Da;eb+=Ac*Ac}return Math.sqrt(eb/Q.count)}A6l(Q,Da){const eb=new kb.a;if(!Q.count||!Da.count)return eb;Q.Sc((Ac,hd)=>Ac-hd);Da.Sc((Ac,hd)=>Ac-hd);const Tb=Math.min(Q.count,Da.count);for(let Ac=0;Ac<Tb;Ac++){const hd=Math.abs(Q.K(Ac)-Da.K(Ac));eb.add(hd)}return eb}w2d(Q,Da){const eb=new kb.a;if(!Q.count||!Da.count)return eb;var Tb=Q.count<=Da.count;const Ac=Tb?Q:Da;Q=Tb?Da:Q;for(Da=0;Da<Ac.count;Da++){Tb=Ac.K(Da);let Ud=Math.abs(Tb-
Q.K(0)),Ee=0;for(let Me=1;Me<Q.count;Me++){var hd=Q.K(Me);hd=Math.abs(Tb-hd);hd<Ud&&(Ud=hd,Ee=Me)}eb.add(Ud);Q.removeAt(Ee)}return eb}}Object(f.a)(Qm,"PageEndMarkerPositionComparer",null,[1390]);var So=d(400),xn=d(589);class pm{constructor(Q,Da,eb,Tb,Ac,hd,Ud,Ee,Me,Kf){this.yr=Q;this._pageNumber=Da;this.Nsb=eb;this.Tfa=Tb;this.xig=Ac;this.LF=hd;this.hH=Ud;this.bxh=Ee;this.paragraphNode=Me;this.OX=Kf}get top(){return this.yr}get Ch(){return this._pageNumber}get L3n(){return this.bxh}Lnd(Q){this.yr=
Q}bxe(Q){this._pageNumber=Q}nNj(Q){this.bxh=Q}}Object(f.a)(pm,"PageEndMarker",null,[]);class mn{constructor(){this.Df=null;this.gfj=0}}Object(f.a)(mn,"PageEndMarkerToRestore",null,[]);class yn{constructor(Q,Da,eb,Tb,Ac,hd,Ud){this.khg=(Ee,Me)=>{Me.property===bp.a.NJ&&(Ee=Me.node)&&Ee.ka(bp.a.NJ,!1)&&this.fPd.contains(Ee.id)&&(Me=Ee.Be(this.tl.pc))&&(Me=Me.htmlElement)&&(this.fPd.remove(Ee.id),this.A3a.add(Me))};this.IK=Q;this.Xn=Da;this.WRa=eb;this.zz=Tb;this.l2e=Ac;this.F1=hd;this.Jq=Ud;this.ru=
new kb.a;this.m9b=new kb.a;this.UIb=new qe.a;this.fPd=new xn.a(new So.a);this.A3a=new kb.a;this.p9b=!!Ac;this.fSf()}get tl(){const Q=this.IK.value;Ca.ULS.shipAssertTag(37052750,336,Q.gj,"PageEndMarkerPositionUpdater.PageView is not a PageView.");return Q}iAc(Q){try{this.Wup(Q)}catch(Da){this.zz.HU(Da.message+" "+Da.stack),Ca.ULS.sendTraceTag(38405270,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateMarkers. Exception: {0}",Da.message)}}DWk(Q){try{this.EWk(Q)}catch(Da){this.zz.HU(Da.message+
" "+Da.stack),Ca.ULS.sendTraceTag(38405271,336,10,"Exception caught in PageEndMarkerPositionUpdater.AddRenderedMarker. Exception: {0}",Da.message)}}Nhl(Q){try{return this.Ohl(Q)}catch(Da){this.zz.HU(Da.message+" "+Da.stack),Ca.ULS.sendTraceTag(37052752,336,10,"Exception caught in PageEndMarkerPositionUpdater.CalculatePositions. Exception: {0}",Da.message)}return!1}nEo(){try{this.oEo()}catch(Q){this.zz.HU(Q.message+" "+Q.stack),Ca.ULS.sendTraceTag(37052753,336,10,"Exception caught in PageEndMarkerPositionUpdater.RestorePositions. Exception: {0}",
Q.message)}}H3c(){try{return this.wFm()}catch(Q){return this.zz.HU(Q.message+" "+Q.stack),Ca.ULS.sendTraceTag(38405273,336,10,"Exception caught in PageEndMarkerPositionUpdater.GetRenderedPageEndMarkers. Exception: {0}",Q.message),null}}ELg(){try{this.zwp()}catch(Q){this.zz.HU(Q.message+" "+Q.stack),Ca.ULS.sendTraceTag(37820302,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateSectionLastPageHeight. Exception: {0}",Q.message)}}Bnf(){try{return this.$nl()}catch(Q){return this.zz.HU(Q.message+
" "+Q.stack),Ca.ULS.sendTraceTag(38405274,336,10,"Exception caught in PageEndMarkerPositionUpdater.CheckVirtualizedHardBreaks. Exception: {0}",Q.message),!1}}Z7m(Q){try{this.$7m(Q)}catch(Da){this.zz.HU(Da.message+" "+Da.stack),Ca.ULS.sendTraceTag(38916953,336,10,"Exception caught in PageEndMarkerPositionUpdater.InsertOrDeleteRenderedMarkers. Exception: {0}",Da.message)}}Wup(Q){if(Q){this.Opl();for(let Da=0;Da<Q.length;Da++){const eb=Da+1,Tb=this.Nwl(Q[Da],eb);this.ru.add(Tb);this.UIb.add(eb,Tb)}}}$7m(Q){let Da=
!1;for(const eb of Q)if(eb)if(0<eb.Xw)for(const Tb of eb.aVf)Da=this.wQd(Tb,eb.hH)||Da;else if(0>eb.Xw){Da=!0;for(const Tb of eb.qZd)this.kOl(Tb.Ch)}Da&&this.Dsg()}EWk(Q){const Da=this.nui(Q.paragraphNode);this.wQd(Q,Da)&&this.Dsg()}kOl(Q){const Da=Q-1;0>Da||this.ru.count<=Da||(this.ru.removeAt(Da),this.UIb.lb(Q)&&this.UIb.remove(Q))}wFm(){const Q=new kb.a;for(const Da of this.ru)this.aoc(Da)&&Q.add(Da);return Q}wQd(Q,Da){if(!Q)return Ca.ULS.sendTraceTag(38385033,336,15,"pageEndDetails is null in PageEndMarkerPositionUpdater.AddRenderedMarkerInternal."),
!1;Da=this.Lwl(Q,Da);Q=Q.xcn?-1:Q.Ch;let eb=!1,Tb;this.UIb.lb(Q)?(Tb=this.UIb.K(Q).Ch,Da.bxe(Tb),this.ru.Z(Tb-1,Da),this.UIb.remove(Q)):(Tb=Da.Ch,this.ru.insert(Tb-1,Da),eb=!0);return eb}Nwl(Q,Da){return new pm(0,Da,Q.HardBreak,!1,null,null,null,0,null,null)}Lwl(Q,Da){const eb=Q.Pvb,Tb=Q.Ch,Ac=Q.OX,hd=!!Ac&&Ac.HardBreak,Ud=Q.Tfa,Ee=Q.paragraphNode,Me=this.RBi(Da),Kf=Q.LF;var th=this.jLf(Kf);if(!th)return Ca.ULS.sendTraceTag(37782370,336,15,"Given an outline node with a null DOM element in ConstructPageEndMarker."),
null;let Fj=null;hd&&(Fj=this.zz.a7d(Q.Pvb));Q=this.zz.vYh(Fj||eb,Me);th=this.zz.Xlf(Fj||eb,th);return new pm(th,Tb,hd,Ud,eb,Kf,Da,Q,Ee,Ac)}Ohl(Q){this.m9b=new kb.a;this.p9b&&this.l2e.reset();this.Zuo();this.N7o();this.m1k();this.Bhl(Q);return 0<this.m9b.count}Zuo(){for(let Q=0;Q<this.ru.count;Q++){const Da=this.ru.K(Q);this.zz.fhn(Da)?this.sDn(Da):(this.zz.ehn(Da)||this.aoc(Da)&&!this.jLf(Da.LF))&&this.bBj(Da)}}m1k(){let Q=0,Da=null;var eb=0;let Tb=0;for(let Ac=0;Ac<this.ru.count;Ac++){const hd=
this.ru.K(Ac);this.aoc(hd)&&(hd.Nsb&&(Tb+=this.rYh(hd,eb,Tb)),Da&&Da.id===hd.LF.id||(Da=hd.LF,Tb=Q=0),hd.Nsb&&!hd.Tfa&&(Q=this.zhl(hd)),eb=hd.top+Q+Tb,hd.Lnd(eb))}this.rYh(null,eb,Tb);this.Ruo()}rYh(Q,Da,eb){let Tb=null;this.p9b&&(Tb=this.l2e.Chl(Q,Da,eb));return Tb?Tb.delta:0}oEo(){if(this.m9b){for(let Q=0;Q<this.m9b.count;Q++){const Da=this.m9b.K(Q);pd.a.aQo(Da.Df,Da.gfj)}this.p9b&&this.l2e.kEo()}}zwp(){if(!this.p9b){var Q=this.WRa.Azi();if(this.ru.count){var Da=this.WRa.Xwi();for(let Ac=0;Ac<this.ru.count;Ac++){var eb=
this.ru.K(Ac);if(this.aoc(eb)&&eb.Tfa){eb=this.WRa.aEm(eb.LF);var Tb=0<Ac?this.ru.K(Ac-1).LF:Da;Tb=Ac&&eb.id===Tb.id?this.ru.K(Ac-1).top:0;this.WRa.axe(eb,Tb)}}Da=this.ru.K(this.ru.count-1);Da.Tfa?this.WRa.axe(Q,0):this.WRa.axe(Q,Da.top)}else this.WRa.axe(Q,0)}}N7o(){this.ru.Sc((Q,Da)=>Q.Ch-Da.Ch)}Dsg(){for(let Q=0;Q<this.ru.count;Q++)this.ru.K(Q).bxe(Q+1)}zhl(Q){return Q?this.uYh(Q)-Q.top:(Ca.ULS.sendTraceTag(37306776,336,15,"CalculatePageEndMarkerDelta called with a null PageEndMarker."),0)}Lhl(Q){if(!Q)return 0;
const Da=this.RBi(Q.hH);return Da?this.zz.vYh(this.zz.YPb(Q),Da):0}uYh(Q){if(!Q)return 0;const Da=this.zz.YPb(Q);Q=this.jLf(Q.LF);return Q?this.zz.Xlf(Da,Q):(Ca.ULS.sendTraceTag(37782371,336,50,"The given pageEndMarker contains an outline node with a null DOM element in CalculatePageEndMarkerPosition."),0)}Ruo(){let Q=0,Da=!1,eb=null,Tb=!1;for(let Ac=this.ru.count-1;0<=Ac;Ac--){const hd=this.ru.K(Ac);this.aoc(hd)&&(eb&&eb.id===hd.LF.id||(Da=!eb,eb=hd.LF,Q=this.NAm(eb)),hd.Nsb?(Da=!1,Q=hd.top):this.p9b&&
Da||!(hd.top>Q)||(this.bBj(hd),pd.a.wy(this.zz.YPb(hd)),Tb=!0))}Tb&&this.Dsg()}bBj(Q){this.ru.contains(Q)&&(this.p9b&&this.F1.iwo(Q),this.ru.remove(Q))}aoc(Q){return Q?(Q=this.zz.YPb(Q))&&Q.offsetParent?!0:!1:(Ca.ULS.sendTraceTag(38385035,324,50,"PageEndMarker is null in IsPageEndMarkerRendered."),!1)}$nl(){let Q=!1;for(let Da=this.A3a.count-1;0<=Da;Da--)this.A3a.K(Da).hasChildNodes()&&(this.A3a.removeAt(Da),Q=!0);return Q}sDn(Q){(Q=this.nui(Q.paragraphNode))&&(this.fPd.contains(Q.id)||this.fPd.add(Q.id))}fSf(){this.Jq&&
this.Jq.jf(23).jo(this.khg)}Bhl(Q){for(let Da=this.ru.count-1;0<=Da;Da--){const eb=this.ru.K(Da);this.aoc(eb)&&this.Ahl(eb,Q)}}Ahl(Q,Da){const eb=this.uYh(Q),Tb=this.Lhl(Q);Q.Nsb?(Q.Lnd(eb),Q.nNj(Tb)):(Da=Da?eb-Q.top:Tb-Q.L3n,Q.Lnd(eb-Da),Q.nNj(Tb-Da),1<Math.abs(Da)&&this.MUo(this.zz.YPb(Q),Da))}jLf(Q){if(!Q)return null;Q=Q.Be(this.tl.pc);return Q?Q.htmlElement:(Ca.ULS.sendTraceTag(37782401,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeTop."),null)}RBi(Q){return Q?(Q=Q.Be(this.tl.pc))?
Q.htmlElement:null:null}nui(Q){Q=Xf.a.Za(Q);return Q.vb(23)?Q.ld(23):null}MAm(Q){if(!Q)return null;Q=Q.Be(this.tl.pc);return Q?ka.a.getElementBounds(Q.htmlElement):(Ca.ULS.sendTraceTag(37888197,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeBounds."),null)}NAm(Q){return(Q=this.MAm(Q))?Q.height/this.Xn.yj:0}MUo(Q,Da){Da=(pd.a.lom(Q)-Da)*this.Xn.yj;this.m9b.add(Object.assign(new mn,{Df:Q,gfj:Da}))}Opl(){this.ru=new kb.a;this.UIb=new qe.a}}Object(f.a)(yn,"PageEndMarkerPositionUpdater",null,
[1389]);var Im=d(356),Bm=d(182),dp=d(27),Pn=d(353),rq=d(16),pl;(function(Q){Q[Q.kcb=0]="para";Q[Q.lep=1]="tableSplit";Q[Q.Njq=2]="tableRowSplit"})(pl||(pl={}));Object(f.b)("PageEndType",pl);class el{constructor(Q,Da,eb,Tb,Ac,hd,Ud=!1,Ee=!1,Me=!1,Kf=!1,th=!1){this.OMg(Da,eb,Tb,Ac,hd,Me,th);this.position=Q;this.Ch=Da;this.paragraphNode=eb;this.OX=Tb;this.Pvb=Ac;this.LF=hd;this.cab=Ud;this.R1i=Ee;this.xcn=Me;this.Tfa=Kf;this.uee=th}bxe(Q){this.Ch=Q}OMg(Q,Da,eb,Tb,Ac,hd,Ud){Ud||(Ca.ULS.shipAssertTag(38326881,
336,!!Ac,"PageEndDetails: outlineNode parameter value is null."),Ca.ULS.shipAssertTag(24126528,336,0<=Q,"PageEndDetails: pageNumber parameter value {0} is unexpected value.",Q),Ca.ULS.shipAssertTag(24126529,336,!!Da||hd,"PageEndDetails: paragraphNode parameter is null for a page that is not client-only."),Ca.ULS.shipAssertTag(24126530,336,!!eb||hd,"PageEndDetails: pageEnd parameter is null for a page that is not client-only."),Ca.ULS.shipAssertTag(24126531,336,!!Tb||hd,"PageEndDetails: pageEndDomElement parameter is null for a page that is not client-only."))}static wEl(Q,
Da){return el.Prf(0,Q,null,Da,!0,!1)}static xEl(Q){return el.Prf(0,0,null,Q,!1,!0)}static Prf(Q,Da,eb,Tb,Ac,hd){return new el(Q,Da,null,null,eb,Tb,Ac,hd,!0)}static pfc(Q,Da){return new el(0,Q,null,Da,null,null,void 0,void 0,void 0,void 0,!0)}}Object(f.a)(el,"PageEndDetails",null,[]);class Fl{constructor(Q,Da,eb,Tb,Ac,hd,Ud,Ee,Me,Kf,th,Fj,uh,hi,kk,kl,Aa,Qa,Fa,xa){this.Jxa=!0;this.oNe=0;this.fId=this.rTe=this.sTe=this.rPe=this.j2e=this.bTe=!1;this.$Jd=this.jHb=null;this.MWe=!0;this.$Vb=()=>{this.Tbd()};
this.feg=()=>{this.sTe=!1};this.geg=()=>{this.rTe=this.sTe=!0};this.TXn=(Wa,Db)=>{1>=Math.abs(Db.delta)||(this.rPe=!0,this.J6j(!Db.Zej))};this.Eoo=Wa=>{Wa===this.jHb&&(this.jHb=null);if(this.Jxa){var Db=Wa.Yl;if(Wa=this.B3a.get(Db.id))for(this.B3a.Z(Db.id,new kb.a),Ca.ULS.sendTraceTag(6558539,336,50,"PageEndMarkers: Redraw page ends for Outline Group [Count: {0}] [Outline group: {1}]",Wa.count,Db.id),this.Dda&&this.Dda.AIa(),Db=0;Db<Wa.count;Db++){const Yb=Wa.K(Db),rc=Yb.OX;rc.HardBreak||(pd.a.wy(Yb.Pvb),
this.psg(rc))}}};this.Doo=()=>{this.$Jd=null;this.Jxa&&this.Ema&&0<this.Ema.count&&(Ca.ULS.sendTraceTag(6579856,336,50,"PageEndMarkers: Redraw all page ends in the document"),this.iAc(this.Ema.toArray(),this.Jxa))};this.IK=Q;this.Di=Da;this.Dda=eb;this.zQ=Tb;this.kxh=Ac;this.Kjb=hd;Fl.zz=Ee;this.tih=Me;this.KK=Kf;this.Gb=th;this.Tuk=Fj;this.Xd=hi;this.F1=kl;this.n2e=Aa;this.r9b=Qa;this.i1=Fa;this.V8b=new Im.a;this.n9b=new kb.a;this.Ema=new kb.a;this.B3a=new Im.a;this.mQ=uh;this.jG=xa;this.ooe=this.ooe.bind(this);
this.qoe=this.qoe.bind(this);this.djd=this.djd.bind(this);this.mga=this.mga.bind(this);this.mQ.TRc(this.$Vb);this.k2e=!1;kk&&(kk.IOh(this.geg),kk.OQd(this.feg));Ud&&Ud.b_k(this.TXn);this.jG.QJb(this.mga)}get lee(){return this.MWe}get tl(){return this.IK.value}get Dj(){return this.Di.value}iAc(Q,Da){const eb=this.Xd.Wf("Task","UpdateMarkers");this.Jap();this.Jxa=Da;Fl.zz.Wzj();this.V8b=new Im.a;this.n9b.clear();this.Ema.clear();this.B3a=new Im.a;this.MWe=this.bTe=!1;this.zQ&&this.zQ.iAc(Q);this.l_l();
this.oNe=Q.length;this.F1&&this.F1.reset(Q);this.Dda&&this.Dda.AIa();for(const Tb of Q)this.Ema.add(Tb),this.psg(Tb);Da&&this.zQ&&this.n2e&&this.n2e.isEnabled&&(Q=this.zQ.H3c(),this.n2e.aIa(Q));this.Yul();this.rPe=this.j2e=!1;this.rTe=this.sTe;Object(Bm.a)()&&Fl.aTf&&this.zQ.ELg();this.Kjb.uvp(this.zQ.H3c(),this.Ema.count);this.MWe=!0;this.i1.rLg();eb.stop();Ca.ULS.sendTraceTag(25048922,336,50,"UpdateMarkers stopwatch stopped: {0}",{["DurationInMs"]:eb.Ei,["RenderedLineCount"]:this.oNe,["AvgDurationPerPageInMs"]:eb.Ei/
this.ZBi()})}aCi(){const Q=this.zQ.H3c();if(!Q)return null;const Da=pd.a.dX(),eb=new kb.a;for(const Tb of Q)this.gln(Tb,Da)&&eb.add(Tb);return eb}gln(Q,Da){if(!Q)return!1;Q=Fl.zz.YPb(Q);if(!Q)return!1;Q=ka.a.bKa(Q);return 0<=Q&&Q<=Da}dri(){const Q=new kb.a;if(!this.B3a)return Ca.ULS.sendTraceTag(35005382,336,10,"_outlineGroupsWithPageEndDetails is null in PageEndMarkers.GetAbsolutePageEndMarkerPositions."),Q;const Da=this.B3a.keys;for(let Ac=0;Ac<Da.length;Ac++){var eb=Da.K(Ac);if(eb=this.B3a.K(eb))for(let hd=
0;hd<eb.count;hd++){var Tb=eb.K(hd);Tb.OX.HardBreak||Tb.Pvb.classList.contains("Hidden")||(Tb=ka.a.bKa(Tb.Pvb),Q.add(Tb))}}return Q}Jap(){const Q=this.dri(),Da=this.aCi();this.kxh.HEg(Q,Da);this.r9b&&this.r9b.isEnabled&&this.r9b.HEg(Da)}Yul(){if(!(25<this.ZBi())){var Q=this.dri(),Da=this.aCi();this.kxh.Zul(Q,Da,this.j2e,this.bTe,this.rPe,this.rTe);this.r9b&&this.r9b.isEnabled&&this.r9b.aIa(Da)}}mga(){this.Dda.hwo();this.Ndi()}Ndi(){this.fId&&(this.tl.YBj(this.ooe),this.tl.iyo(this.qoe),this.tl.Pxo(this.djd),
this.fId=!1)}l_l(){this.fId||(this.tl.eOh(this.ooe),this.tl.L_k(this.qoe),this.tl.DOh(this.djd),this.fId=!0)}psg(Q){if(this.k2e)return!0;Q=this.nzo(Q);if(!Q)return!1;this.F1&&this.F1.MTm(Q);this.zQ&&(this.zQ.DWk(Q),this.Kjb.G6j(this.zQ.H3c()),Object(Bm.a)()&&Fl.aTf&&this.zQ.ELg());return!0}nzo(Q){let Da=this.QJ(Q.ParaId);if(!Da)return null;if(!Da.anchor||!Da.mk)return this.zNh(Q,Da),null;let eb,Tb;if(Q.HardBreak){var Ac=ii.ParagraphReader.xg(Da,!0,!0,!0);this.D5n(Ac)&&(Da=Ac);if(!({Dma:Ac,hH:eb,Nvb:Tb}=
this.dmp(Q,Da)).returnValue)return null;this.bTe=!0}else if(!({joe:Ac,hH:eb,Nvb:Tb}=this.ozo(Q,Da)).returnValue)return null;return this.wQd(Da,Q,Ac,eb,Tb)}D5n(Q){return Q?(Q=Q.Be(this.tl.pc))?!!Fl.zz.a7d(Q.htmlElement):!1:!1}ozo(Q,Da){var eb=Q.PageEndType;let Tb,Ac=0,hd=null;if(!eb){if(!({Dma:Q,fig:Tb}=this.bCi(Q,Da)).returnValue)return{returnValue:!1,joe:Ac,hH:hd,Nvb:null}}else if(!({Dma:Q,cBe:Tb}=this.eBm(Q,Da)).returnValue)return{returnValue:!1,joe:Ac,hH:hd,Nvb:null};var Ud=Xf.a.Za(Da);Ud.Kd();
hd=Ud.ld(23);Da=hd.Be(this.tl.pc).getBounds();Ud=Ud.UZa().Be(this.tl.pc);if(!Ud)return Ca.ULS.sendTraceTag(50997218,314,50,"outlineGroupViewElement is null for ViewId: {0}.",this.tl.pc),{returnValue:!1,joe:Ac,hH:hd,Nvb:null};const Ee=Ud.getBounds();Ac=Q-Da.y;eb=Fl.zz.Qvi(eb,Ac,this.Jxa,Tb,Da,Ee);Ud.Mea.appendChild(eb);return{returnValue:!0,joe:Ac,hH:hd,Nvb:eb}}dmp(Q,Da){let eb=null;const Tb=Da.Be(this.tl.pc);var Ac=0;let hd=null;if(this.Qfe(Q,Tb,Da))return{returnValue:!1,Dma:Ac,hH:eb,Nvb:hd};eb=Fl.Fej(Da);
const Ud=eb.Be(this.tl.pc);if(!Ud)return Ca.ULS.sendTraceTag(50446550,314,15,"outlineGroupViewElement is null for ViewId: {0}.",this.tl.pc),{returnValue:!1,Dma:Ac,hH:eb,Nvb:hd};Ac=Ud.getBounds();Ac=si.a.Ar(Tb,Q.CP).y-Ac.y;hd=this.Urm(Da);return{returnValue:!0,Dma:Ac,hH:eb,Nvb:hd}}Urm(Q){return Q.Be(this.tl.pc).htmlElement}QJ(Q){const Da=this.KK.Jqb(Q);if(Da!==kc.a.nil){const eb=this.Dj.Eb(Da);if(eb)return eb}Ca.ULS.sendTraceTag(6398172,336,10,"PageEndMarkers: Cannot find graph node for para Id {0} objectId {1}",
Q,Da);return null}bCi(Q,Da){const eb=Q.CP;let Tb=0,Ac=null;const hd=Da.Be(this.tl.pc);if(this.Qfe(Q,hd,Da))return{returnValue:!1,Dma:Tb,fig:Ac};Ac=hd.getBounds();Tb=eb?this.tih(Object(Va.a)(105,hd),eb):Ac.y-this.Tuk(hd);return{returnValue:!0,Dma:Tb,fig:Ac}}eBm(Q,Da){let eb=null,Tb=0;var Ac=Q.PageEndType;let hd=Xf.a.Za(Da);hd.Kd();if(!dp.TableReader.ny(hd))return Ca.ULS.sendTraceTag(6398173,336,50,"PageEndMarkers: Para {0} has moved out from inside the table, treating as normal paragraph.",Q.ParaId),
{returnValue:({Dma:Tb,fig:eb}=this.bCi(Q,Da)).returnValue,Dma:Tb,cBe:eb};if(Ac===pl.lep){rq.returnToContainingRow(hd);Ac=hd.currentNode.Be(this.tl.pc);if(this.Qfe(Q,Ac,Da))return{returnValue:!1,Dma:Tb,cBe:eb};Tb=Ac.getBounds().y}else{Ac=Da.Be(this.tl.pc);if(this.Qfe(Q,Ac,Da))return{returnValue:!1,Dma:Tb,cBe:eb};Tb=this.tih(Object(Va.a)(105,Ac),Q.CP)}--Tb;Da=null;do Q=Da,Da=hd.ld(14);while(Da);hd=Xf.a.Za(Q);hd.Kd();rq.moveToFirstRow(hd);eb=hd.currentNode.Be(this.tl.pc).getBounds();return{returnValue:!0,
Dma:Tb,cBe:eb}}Qfe(Q,Da,eb){if(!Da||Da.nma(16))return this.zNh(Q,eb),!0;Da=Da.getBounds();return Da.width||Da.height?!1:(this.GMh(Q),!0)}GMh(Q){this.n9b.contains(Q)||this.n9b.add(Q)}zNh(Q,Da){Da=Da.id;let eb;({value:eb}=this.V8b.Ac(Da)).returnValue||(eb=new kb.a,this.V8b.Z(Da,eb));eb.add(Q)}ooe(){const Q=new kb.a;for(let Da=this.n9b.count-1;0<=Da;Da--){const eb=this.n9b.K(Da);this.psg(eb)||Q.add(eb)}this.n9b=Q;this.Bnf()}Bnf(){this.zQ&&this.zQ.Bnf()&&this.J6j(!1)}J6j(Q){this.zQ&&(this.zQ.Nhl(Q)&&
(this.j2e=!0),this.zQ.nEo(),this.Kjb.G6j(this.zQ.H3c()),Object(Bm.a)()&&Fl.aTf&&this.zQ.ELg())}qoe(Q,Da){try{const eb=Da.id;if(this.V8b.lb(eb)){const Tb=this.V8b.K(eb);for(Q=0;Q<Tb.count;Q++)this.GMh(Tb.K(Q));this.V8b.remove(eb)}}catch(eb){}}Tbd(){this.Jxa&&(this.Jxa=!1,Fl.zz.Tbd())}Sbd(){this.Jxa||(this.Jxa=!0,Fl.zz.Sbd())}dTj(){this.k2e=!1;this.Ema&&this.iAc(this.Ema.toArray(),this.Jxa);this.Dda&&this.Dda.cTj()}oNi(){this.k2e=!0;Fl.zz.Wzj();this.Dda&&this.Dda.nNi();this.F1&&this.F1.GYm()}wQd(Q,
Da,eb,Tb,Ac){const hd=this.Ema.indexOf(Da)+1;if(0>hd)return null;const Ud=qq.WordSectionNavigator.instance.WR(Q),Ee=this.Tfa(Da,Q);Q=new el(eb,hd,Q,Da,Ac,Ud,!Q||!Da||!Ac,!1,!1,Ee);this.B3a.lb(Tb.id)||this.B3a.Z(Tb.id,new kb.a);this.B3a.K(Tb.id).add(Q);return Q}Tfa(Q,Da){if(!Q||!Q.HardBreak)return!1;Q=Xf.a.Za(Da);Q.vb(7);if(Q.RJ())return!1;Q.ld(23);return Q.RJ()?!1:!0}ypg(Q){this.Jxa&&(Q.anchor&&Q.mk?!(Q=Fl.Fej(Q))||this.jHb&&this.jHb.Yl&&this.jHb.Yl.id===Q.id||(this.jHb=Object.assign(new ud.a(3,1,
500,this.Eoo),{Yl:Q}),this.Gb.Zb(this.jHb)):Ca.ULS.sendTraceTag(6607198,336,10,"PageEndMarkers: Invalid node while redrawing page ends for outline group"))}djd(){this.Jxa&&!this.$Jd&&this.Ema&&0<this.Ema.count&&(this.$Jd=new ud.a(3,1,500,this.Doo),this.Gb.Zb(this.$Jd))}dispose(){this.tl&&this.Ndi();this.jG.Prg(this.mga);this.mQ.kte(this.$Vb)}static get aTf(){null==Fl.vUe&&(Fl.vUe=m.AFrameworkApplication.J.$("ImageOverflowUpdateHeightIsEnabled"));return Fl.vUe}static Qrm(Q){let Da=0;try{const eb=Q.htmlElement,
Tb=pd.a.zP(eb.firstChild.style.marginTop);Q=0;const Ac=Fl.OLf(eb.parentNode);if(Ac){const hd=Ac.firstChild;hd&&hd.classList.contains("ParaWrappingDiv")&&(Q=pd.a.zP(hd.firstChild.style.marginBottom))}Da=Math.max(Tb,Q)/2}catch(eb){}return Da}static OLf(Q){let Da=Q.previousSibling;if(!Da){var eb=Q.parentNode;pd.a.SYf(eb)&&(eb=eb.parentNode)&&(Da=eb.previousSibling)}if(!Da&&(Q=Q.parentNode,Q.classList.contains("OutlineGroup")||Ca.ULS.sendTraceTag(19711369,314,15,"Expected OutlineGroup but encountered a {0} element with classname {1}.",
Q.tagName,Q.className),(Q=Q.previousSibling)&&Q.hasChildNodes())){Da=Q.lastChild;do{if(Da.classList.contains("OutlineElement")||pd.a.SYf(Da)&&Da.classList.contains(Pn.a.Upc))break;Da=Da.previousSibling}while(Da)}if(Da){if(Da.classList.contains(Pn.a.Upc))return Da.lastChild.lastChild;if(pd.a.SYf(Da))return Da.lastChild}return Da}static Fej(Q){Q=Xf.a.Za(Q);return Q.vb(23)?Q.ld(23):null}ZBi(){return this.oNe+1}}Fl.zz=null;Fl.vUe=null;Object(f.a)(Fl,"PageEndMarkers",null,[1287,1288,10]);var Qn=d(171);
class To{constructor(Q,Da,eb){this.H3n=".Outline";this.IK=Q;this.Xn=Da;this.zz=eb}get tl(){const Q=this.IK.value;Ca.ULS.shipAssertTag(38416594,336,Q.gj,"Invalid PageView.");return Q}ajc(Q){return(Q=Q.LF)?this.PBi(Q):(Ca.ULS.shipAssertTag(38336522,336,!0,"Error getting last Outline DOM."),null)}PBi(Q){let Da,eb;return(Da=Q.Be(this.tl.pc))&&(eb=Da.htmlElement)?eb.querySelector(this.H3n):(Ca.ULS.shipAssertTag(39662425,336,!0,"Error getting last Outline DOM."),null)}mui(Q){Q=dm.OutlineElementNavigator.jm(Q.paragraphNode);
let Da;return Q&&(Da=Q.Be(this.tl.pc))?Da.htmlElement:(Ca.ULS.shipAssertTag(38336525,336,!0,"Error calculating containing OE DOM."),null)}hYh(Q,Da){const eb=this.QOm(Q);return this.Ghl(Q,Da)-eb}Mvi(Q){return this.UBi(Q.LF,Q.Ch)}UBi(Q,Da){if(!Q)return-1;var eb=Q.ka(Ff.a.rw,-1);eb=Ko.a.qj(eb,1);var Tb=Q.ka(Ff.a.marginTop,-1);Tb=Ko.a.qj(Tb,1);Q=Q.ka(Ff.a.marginBottom,-1);Q=Ko.a.qj(Q,1);return 1===Da?eb-Q:eb-(Tb+Q)}iOl(Q){Q&&pd.a.wy(Q.Pvb)}KLf(Q){if(Q.R1i||Q.Tfa)return 0;if(Q.cab)return Q=this.ajc(Q),
ka.a.getElementBounds(Q).height/this.Xn.yj;const Da=this.ajc(Q);return this.zz.Xlf(this.$Bi(Q),Da)}SBl(Q,Da,eb){eb=eb.Be(this.tl.pc).getBounds();Q=Q.Be(this.tl.pc);const Tb=Q.getBounds();eb.y=Tb.y;Da=this.zz.Qvi(pl.kcb,Da*this.Xn.yj,!1,eb,eb,Tb);Q.Mea.appendChild(Da);return Da}HRi(Q,Da){if(Q&&!Q.uee)if(Q.cab){if(Q=this.ajc(Q))Q.style.paddingBottom=Da+"px"}else if(Q.OX&&Q.OX.HardBreak)if(Q.Tfa){if(Q=this.wDi(Q))Q.style.paddingBottom=Da+"px"}else{if(Q=this.mui(Q))Q.style.paddingTop=Da+"px"}else Ca.ULS.shipAssertTag(39077394,
336,!1,"Applying blank space on a page which is not hard break or last page.")}yPh(Q,Da){Da=this.ajc(Da);Q=this.ajc(Q);return ka.a.bKa(Da)-ka.a.bKa(Q)}xDi(Q){Q=Xf.a.Za(Q.LF);Q.vb(7);return Q.RJ()}GZi(Q){if(!Q||Q.uee)return!1;if(Q.cab||Q.R1i)return!0;Q=this.$Bi(Q);return!!Q&&pd.a.Qea(Q)}HU(Q){this.zz.HU(Q)}wDi(Q){return(Q=this.xDi(Q))?(Q=Q.sl(this.tl.pc).htmlElement,Q?Q:(Ca.ULS.shipAssertTag(39126080,336,!0,"Section dom is null."),null)):null}$Bi(Q){return Q.OX&&Q.OX.HardBreak&&!Q.Tfa?this.zz.a7d(Q.Pvb):
Q.Pvb}QOm(Q){if(Q.cab){Q=this.ajc(Q);if(!Q)return Ca.ULS.shipAssertTag(38336528,336,!0,"Last outline dom is null."),-1;Q=Qn.a.QB(Q);return pd.a.cla(Q.paddingBottom)}if(Q.OX&&Q.OX.HardBreak){if(Q.Tfa)return(Q=this.wDi(Q))?pd.a.cla(Q.style.paddingBottom):-1;Q=this.mui(Q);return Q?pd.a.cla(Q.style.paddingTop):(Ca.ULS.shipAssertTag(38336529,336,!0,"Containing outline element Dom is null."),-1)}return 0}Ghl(Q,Da){return this.KLf(Q)-Da}}Object(f.a)(To,"PageFullHeightDOMHelper",null,[]);class yh{constructor(){this.delta=
this.J$j=this.Xw=0;this.Cma=null;this.YUa=this.ptj=0;this.hH=null;this.DIa=0;this.aVf=new kb.a;this.qZd=new kb.a;this.pNn=new kb.a}}Object(f.a)(yh,"PageFullHeightInfo",null,[]);class Xr{constructor(Q,Da){this.HGa=Q;this.Az=Da}sYh(Q,Da){try{return this.Dhl(Q,Da)}catch(eb){return this.Az.HU(eb.message+" "+eb.stack),Ca.ULS.sendTraceTag(38416595,336,10,"Exception caught in CalculatePageFullHeightInfo. Exception: {0}",eb.message),null}}Dhl(Q,Da){Ca.ULS.shipAssertTag(38416596,336,Q.cab||Q.OX.HardBreak);
const eb=this.Az.KLf(Q),Tb=this.Az.hYh(Q,Da),Ac=this.HGa.dYh(Q,Tb);Q=Object.assign(new yh,{DIa:Tb,YUa:Ac,Cma:Q});this.dup(Q);Q.J$j=Q.YUa-Q.DIa;Q.delta=Da+Ac+Q.delta-eb;return Q}dup(Q){Q.DIa>Q.YUa?this.eup(Q):0>Q.DIa&&this.eLg(Q)}eLg(Q){let Da=Q.Cma.Ch;for(;0>Q.DIa;)Q.Xw--,Q.delta-=this.HGa.i2c(Da),Q.DIa+=this.HGa.i2c(Da-1),Da--;Q.YUa=this.HGa.i2c(Da)}eup(Q){const Da=this.Az.Mvi(Q.Cma);Q.Xw=Math.floor((Q.DIa-Q.YUa)/Da)+1;Q.delta=Q.Xw*Da;Q.DIa-=Q.YUa+(Q.Xw-1)*Da;Q.YUa=Da}}Object(f.a)(Xr,"PageFullHeightInfoCalculator",
null,[]);class ut{constructor(Q,Da,eb,Tb){this.b5a=0;this.XSa=null;this.HGa=Q;this.oGb=Da;this.IZ=eb;this.Az=Tb;this.pAh=new kb.a}get C0(){return this.pAh}MTm(Q){try{this.FQf(Q)}catch(Da){this.Az.HU(Da.message+" "+Da.stack),Ca.ULS.sendTraceTag(38148114,336,10,"Exception caught in HandlePageFullHeight. Exception: {0}",Da.message)}}reset(Q){try{this.FCo(Q)}catch(Da){this.Az.HU(Da.message+" "+Da.stack),Ca.ULS.sendTraceTag(38637723,336,10,"Exception caught in PageFullHeightManager.Reset. Exception: {0}",
Da.message)}}GYm(){try{this.HYm()}catch(Q){this.Az.HU(Q.message+" "+Q.stack),Ca.ULS.sendTraceTag(39153856,336,10,"Exception caught in PageFullHeightManager.HidePageFullHeights. Exception: {0}",Q.message)}}a8m(Q){try{this.b8m(Q)}catch(Da){this.Az.HU(Da.message+" "+Da.stack),Ca.ULS.sendTraceTag(38916954,336,10,"Exception caught in PageFullHeightManager.InsertOrDeleteRenderedPages. Exception: {0}",Da.message)}}iwo(Q){try{this.jwo(Q)}catch(Da){this.Az.HU("Pagination: "+Da.message+" "+Da.stack),Ca.ULS.sendTraceTag(39387716,
336,10,"Exception caught in PageFullHeightManager.RemovePageEndDetails. Exception: {0}",Da.message)}}i4m(){var Q=this.IZ.JIf(),Da=this.IZ.uzi();Q=el.xEl(Q);Da=el.wEl(this.b5a,Da);this.C0.Z(0,Q);this.FQf(Da)}JCo(){var Q=qq.WordSectionNavigator.instance.uzi();(Q=this.Az.PBi(Q).parentNode)&&""!==Q.style.minHeight&&(Q.style.minHeight="")}i5m(Q){this.pAh=new kb.a;this.C0.add(null);for(let Da=0;Da<Q.length;Da++){const eb=el.pfc(Da+1,Q[Da]);this.C0.add(eb)}this.C0.add(el.pfc(Q.length+1,null))}T4m(Q){this.HGa.PCo(Q)}nDo(){if(this.C0)for(const Q of this.C0)Q&&
this.lXi(Q)&&this.Az.HRi(Q,0)}FQf(Q){const Da=this.VDm(Q);if(this.Az.GZi(Da)){let eb=this.Az.KLf(Da);Q.LF!==Da.LF&&(eb+=this.Az.yPh(Q,Da));this.Lgl(Q,eb);this.lXi(Q)&&this.qsg(Q,eb)}else this.XSa.add(Q),20<this.XSa.count&&Ca.ULS.sendTraceTag(39982428,336,15,"Count of _waitingForPreviousPage is "+this.XSa.count);this.C0.Z(Q.Ch,Q);this.ATm(Q)}HYm(){this.nDo()}FCo(Q){this.b5a=Q.length+1;this.XSa=new kb.a;this.i5m(Q);this.T4m(this.b5a);this.i4m();this.JCo()}b8m(Q){this.HGa.yvp(Q);for(const Da of Q){if(!Da){Ca.ULS.sendTraceTag(38916955,
336,10,"info is null.");return}if(0<Da.Xw){Q=Da.Cma.Ch;for(const eb of Da.aVf)this.C0.insert(Q,eb),Q++}else if(0>Da.Xw)for(const eb of Da.qZd)this.C0.remove(eb),this.XSa.contains(eb)&&this.XSa.remove(eb)}this.bDj()}jwo(Q){Q=Q.Ch;this.HGa.kwo(Q);this.C0.removeAt(Q);for(const Da of this.XSa)Da.Ch===Q&&this.XSa.remove(Da);this.bDj()}Lgl(Q,Da){Da=this.Az.hYh(Q,Da);this.HGa.dYh(Q,Da)}qsg(Q,Da){Q.OX&&Q.OX.HardBreak||this.oGb.qsg(Q,Da)}ATm(Q){Q=Q.Ch+1;for(const Da of this.XSa)if(Da&&Da.Ch===Q){this.FQf(Da);
this.XSa.remove(Da);break}}bDj(){for(let Q=0;Q<this.C0.count;Q++){const Da=this.C0.K(Q);Da&&Da.bxe(Q)}}lXi(Q){Q=this.ZAm(Q);return 2===Q||1===Q}VDm(Q){return this.C0.K(Q.Ch-1)}ZAm(Q){return Q.cab?2:Q.OX&&Q.OX.HardBreak?1:0}}Object(f.a)(ut,"PageFullHeightManager",null,[1420]);class Nq{constructor(Q,Da,eb,Tb){this.oGb=Q;this.HGa=Da;this.IZ=eb;this.Az=Tb}create(){return new ut(this.HGa,this.oGb,this.IZ,this.Az)}}Object(f.a)(Nq,"PageFullHeightManagerFactory",null,[]);var Cp=d(1070),so=d(705);class Sp{constructor(Q,
Da,eb,Tb,Ac){this.o9b=null;this.F1=Q;this.zQ=Da;this.nMc=eb;this.oGb=Tb;this.Az=Ac}reset(){this.o9b=new kb.a}Chl(Q,Da,eb){try{return this.Ehl(Q,Da,eb)}catch(Tb){return Ca.ULS.sendTraceTag(38897350,336,10,"Exception caught in PageFullHeightPositionUpdater.CalculatePageFullHeight. Exception: {0}",Tb.message),null}}kEo(){try{this.lEo()}catch(Q){Ca.ULS.sendTraceTag(38897351,336,10,"Exception caught in PageFullHeightPositionUpdater.RestorePageFullHeights. Exception: {0}",Q.message)}}Ehl(Q,Da,eb){if(!this.F1.C0.count)return null;
const Tb=this.cBm(Q,!Q);if(!Tb||Tb.uee)return Ca.ULS.sendTraceTag(38897352,336,10,"PageEndDetail is null for the given PageEndMarker"),null;if(Tb.OX&&Tb.OX.HardBreak)return null;var Ac=this.F1.C0.K(Tb.Ch-1);return this.Az.GZi(Ac)&&(Da-=eb,Tb.LF!==Ac.LF&&(Da+=this.Az.yPh(Tb,Ac)),(Ac=this.nMc.sYh(Tb,Da))&&1<Math.abs(Ac.delta))?(Ac.ptj=Da,Ac.hH=this.KAm(Q,Tb),this.o9b.add(Ac),this.eLg(Ac),Ac):null}KAm(Q,Da){return Da&&Da.cab?(Q=Object(Va.a)(so.a,ii.ParagraphReader.bD(Da.LF)),Q=Xf.a.Za(Q),Q.pq(),Object(Va.a)(Cp.a,
Q.ld(23))):Q&&Q.Nsb?Q.hH:null}lEo(){this.o9b.Sc((Q,Da)=>Da.Cma.Ch-Q.Cma.Ch);for(const Q of this.o9b)this.oGb.PCj(Q);this.Cvp()}Cvp(){this.zQ.value.Z7m(this.o9b);this.F1.a8m(this.o9b)}cBm(Q,Da){return Da?this.F1.C0.K(this.F1.C0.count-1):this.F1.C0.K(Q.Ch)}eLg(Q){let Da=Q.Cma.Ch;const eb=-Q.Xw;for(let Tb=0;Tb<eb;Tb++)Da--,Q.qZd.add(this.F1.C0.K(Da))}}Object(f.a)(Sp,"PageFullHeightPositionUpdater",null,[1421]);class ts{constructor(Q,Da,eb,Tb,Ac){this.F1=Q;this.zQ=Da;this.nMc=eb;this.oGb=Tb;this.Az=Ac}create(){return new Sp(this.F1,
this.zQ,this.nMc,this.oGb,this.Az)}}Object(f.a)(ts,"PageFullHeightPositionUpdaterFactory",null,[]);class Tp{constructor(Q,Da){this.Az=Q;this.nMc=Da}qsg(Q,Da){try{this.rzo(Q,Da)}catch(eb){this.Az.HU(eb.message+" "+eb.stack),Ca.ULS.sendTraceTag(38285912,336,10,"Exception caught in RenderPageFullHeight. Exception: {0}",eb.message)}}PCj(Q){try{this.qzo(Q)}catch(Da){this.Az.HU(Da.message+" "+Da.stack),Ca.ULS.sendTraceTag(38855577,336,10,"Exception caught in RenderPageFullHeightInfo. Exception: {0}",Da.message)}}rzo(Q,
Da){Ca.ULS.shipAssertTag(38285913,336,Q.cab||Q.OX.HardBreak);Q=this.nMc.sYh(Q,Da);this.PCj(Q)}qzo(Q){this.pzo(Q);this.hzo(Q)}hzo(Q){0<Q.Xw?this.k8m(Q):0>Q.Xw&&this.jOl(Q)}pzo(Q){this.Az.HRi(Q.Cma,Q.J$j)}k8m(Q){let Da=Q.ptj+Q.YUa;for(let Tb=0;Tb<Q.Xw;Tb++){var eb=Q.Cma.Ch+Tb;const Ac=Q.Cma.Tfa?this.Az.xDi(Q.Cma):Q.Cma.LF;eb=this.RBl(Ac,Q.hH,Da,eb);Q.aVf.add(eb);Q.pNn.add(Da);Da+=Q.YUa}}jOl(Q){for(const Da of Q.qZd)this.Az.iOl(Da)}RBl(Q,Da,eb,Tb){Da=this.Az.SBl(Q,eb,Da);return el.Prf(eb,Tb,Da,Q,!1,
!1)}}Object(f.a)(Tp,"PageFullHeightRenderer",null,[]);class Ns{constructor(Q){this.Nog=Q}}Object(f.a)(Ns,"PageHeightDeltaResult",null,[1325]);class us{constructor(Q,Da,eb){this.Rp=null;this.Az=Q;this.kj=Da;eb.execute(Tb=>{Tb.register(this)})}get Hcd(){return"PageHeightDelta"}get result(){return this.Rp}get hbg(){return 1}get Pvg(){return 500}get isEnabled(){return!0}vbg(){this.Rp=null}aIa(Q){this.kj.$d(()=>{try{this.PTc(Q)}catch(Da){Ca.ULS.sendTraceTag(39188045,324,10,"Exception caught in PageHeightDeltaMetric.Calculate. Exception: {0}",
Da.message)}},"PHDM:C")}PTc(Q){this.Rp=null;Q=this.QTc(Q);-1!==Q&&(this.Rp=new Ns(Q))}QTc(Q){if(!Q.count)return-1;let Da=0,eb=0;for(const Tb of Q)Q=this.Fhl(Tb),-1!==Q&&(Da+=Q,eb++);return eb?Da/eb:-1}Fhl(Q){if(!Q.Jfn)return-1;const Da=this.Az.UBi(Q.$Sd,Q.Ch);return-1===Da?-1:Math.abs(Q.height-Da)}}Object(f.a)(us,"PageHeightDeltaMetric",null,[1289]);class ct{constructor(Q){this.i2a=null;this.Az=Q}i2c(Q){return this.i2a.K(Q-1)}PCo(Q){this.i2a=new kb.a;for(let Da=0;Da<Q;Da++)this.i2a.add(-1)}dYh(Q,
Da){if(this.hln(Q))return this.i2a.K(Q.Ch-1);Da=this.ehl(Q,Da);this.Kap(Q,Da);return Da}yvp(Q){for(const Da of Q)this.xvp(Da)}Kap(Q,Da){this.i2a.Z(Q.Ch-1,Da)}kwo(Q){this.i2a.removeAt(Q-1)}xvp(Q){if(Q)if(0<Q.Xw){var Da=Q.Cma.Ch;for(var eb=0;eb<Q.Xw;eb++)this.i2a.insert(Da,Q.YUa)}else if(0>Q.Xw)for(Da=-Q.Xw,Q=Q.Cma.Ch-Da,eb=0;eb<Da;eb++)this.i2a.removeAt(Q)}hln(Q){return-1!==this.i2a.K(Q.Ch-1)}ehl(Q,Da){if(Q.cab||Q.OX.HardBreak)Q=this.Az.Mvi(Q),Da=Da<Q?Q:Da;return Da}}Object(f.a)(ct,"PageHeightStorage",
null,[]);var $l=d(252);class Fc{constructor(Q){this.Nog=Q}}Object(f.a)(Fc,"PageLevelDeltaResult",null,[1325]);class nn{constructor(Q,Da,eb,Tb){this.Rp=null;this.IK=Q;this.rya=Da;this.kj=eb;Tb.execute(Ac=>{Ac.register(this)})}get tl(){const Q=this.IK.value;Ca.ULS.shipAssertTag(39081438,336,Q.gj,"PageLevelDeltaMetric.PageView is not a PageView.");return Q}get Hcd(){return"PageLevelDelta"}get result(){return this.Rp}get hbg(){return 0}get Pvg(){return 60}get isEnabled(){return!0}vbg(){this.Rp=null}aIa(Q){this.kj.$d(()=>
{try{this.PTc(Q)}catch(Da){Ca.ULS.sendTraceTag(39081440,324,10,"Exception caught in PageLevelDeltaMetric.Calculate. Exception: {0}",Da.message)}},"PLDM:C")}PTc(Q){this.Rp=null;Q=this.QTc(Q);-1!==Q&&(this.Rp=new Fc(Q))}QTc(Q){if(!Q.count)return-1;let Da=0,eb=0;for(const Tb of Q)Q=this.Hhl(Tb),-1!==Q&&(Da+=Q,eb++);return eb?Da/eb:-1}Hhl(Q){if(Q.Nsb)return-1;var Da=Q.OX.CP;Q=Q.paragraphNode;Ca.ULS.shipAssertTag(39081441,336,!!Q);Q=Q.Be(this.tl.pc);Ca.ULS.shipAssertTag(39081442,324,Object($l.a)(105,Q));
let eb;({u7h:Da,d5i:Q,jGj:eb}=this.thl(Q,pd.a.Pz(Q.htmlElement).length,Da));return Q&&eb?Math.min(Da.x-Q.x,eb.x-Da.x):(Ca.ULS.sendTraceTag(39081443,336,50,"There was a problem calculating the line boundaries in PageLevelDeltaMetric.CalculatePageLevelDelta."),-1)}thl(Q,Da,eb){let Tb,Ac,hd,Ud=Ac=eb,Ee=hd=Tb=null;if(eb>Da)return Ca.ULS.sendTraceTag(39081472,336,50,"cp > paragraph text length in FidelityTelemetryManager.CalculatePageLevelDelta."),{u7h:Ee,xvn:Ud,d5i:hd,SFo:Ac,jGj:Tb};Ee=this.rya.Ar(Q,
eb);for(var Me=0,Kf=eb;Me<=Kf;){const th=Math.floor((Me+Kf)/2),Fj=this.rya.Ar(Q,th);if(Me===Kf){Ud=th;hd=Fj;break}Fj.y+Fj.height<=Ee.y?Me=th+1:Kf=th}for(;eb<=Da;){Me=Math.ceil((eb+Da)/2);Kf=this.rya.Ar(Q,Me);if(eb===Da){Ac=Me;Tb=Kf;break}Kf.y>=Ee.y+Ee.height?Da=Me-1:eb=Me}return{u7h:Ee,xvn:Ud,d5i:hd,SFo:Ac,jGj:Tb}}}Object(f.a)(nn,"PageLevelDeltaMetric",null,[1289]);class $q{constructor(Q,Da,eb,Tb,Ac,hd,Ud){this.Ch=Q;this.top=Da;this.bKh=eb;this.height=Tb;this.x1b=Ac;this.$Sd=hd;this.Jfn=Ud}}Object(f.a)($q,
"Page",null,[]);class Lj{constructor(Q,Da,eb,Tb,Ac){this.i9b=null;this.FFh=0;this.IK=Q;this.ozd=Da;this.jxh=eb;this.WRa=Tb;this.lxh=Ac;this.F3a=new kb.a}get tl(){const Q=this.IK.value;Ca.ULS.shipAssertTag(37007393,336,Q.gj,"PageManager.PageView is not a PageView.");return Q}get El(){return this.F3a}G6j(Q){Q=this.pxj(Q);this.H6j(Q)}uvp(Q,Da){this.FFh=Da;Q=this.pxj(Q);this.H6j(Q);this.lxh.isEnabled&&this.lxh.aIa(Q)}pxj(Q){this.F3a=new kb.a;this.i9b=new Im.a(0);const Da=new kb.a;if(!Q)return this.El;
var eb=0,Tb=null;for(let Ac=0;Ac<Q.count;Ac++){const hd=Q.K(Ac);eb=hd.Ch;Tb=this.PXd(eb,Tb,hd);this.El.add(Tb);!Lj.l0e&&0>Tb.height&&Da.add(Tb);Tb=hd}Q=this.PXd(eb+1,Tb,null);this.El.add(Q);!Lj.l0e&&0>Q.height&&Da.add(Q);for(const Ac of Da)Lj.l0e=!0,Ca.ULS.shipAssertTag(50968670,336,!1,"Page: height parameter value is negative for page "+Ac.Ch);return this.El}PXd(Q,Da,eb){const Tb=Da?Da.LF:this.WRa.Xwi(),Ac=eb?eb.LF:this.WRa.Azi();var hd=this.VBi(Tb);const Ud=this.VBi(Ac),Ee=Da?this.pYh(Da):0;hd=
Ee+hd;const Me=eb?this.pYh(eb):this.ozd.hcb.clientHeight-Ud;return new $q(Q,Ee,hd,Tb.id===Ac.id?Me-Ee:Me+Ud-hd,Tb,Ac,(eb?eb.Ch:this.FFh+1)===(Da?Da.Ch:0)+1)}pYh(Q){return Q.Tfa?0:Q.top}H6j(Q){if(this.jxh.ioe)for(const Da of this.jxh.ioe)Da&&Da.I6j(Q)}VBi(Q){this.i9b||(this.i9b=new Im.a(0));if(this.i9b.lb(Q.id))return this.i9b.K(Q.id);var Da=Q.Be(this.tl.pc);if(!Da)return Ca.ULS.sendTraceTag(37052758,336,15,"OutlineViewElement is null in PageManager.GetOutlineTop."),0;Da=ka.a.RVa(this.ozd.hcb,Da.htmlElement).y;
this.i9b.Z(Q.id,Da);return Da}}Lj.l0e=!1;Object(f.a)(Lj,"PageManager",null,[1290]);var Cm=d(1248);class vk{constructor(Q,Da,eb,Tb,Ac,hd,Ud,Ee){this.WTj=Ee;this.CMg=this.icb=!1;this.zrc=(Me,Kf)=>{0!==Kf.jMa||this.CMg?this.Kei():this.dii()};this.ga=Q;this.P5=Da;this.qJh=eb;this.ru=Tb;this.wj=Ac;this.oxh=hd;this.nO=Ud;Ee||(this.icb=0===this.nO.Kw,this.nO.mcc(this.zrc))}Xb(){this.ga.fb(hg.a.lid,Uc.a.application,this.lid.bind(this),96);this.ga.fb(hg.a.Cre,Uc.a.application,this.Cre.bind(this),96);this.ga.fb(hg.a.lCe,
Uc.a.application,this.lCe.bind(this),96);this.ga.fb(hg.a.iCe,Uc.a.application,this.iCe.bind(this),8)}lCe(Q,Da,eb){return 1===eb?32:this.ga.Ob(hg.a.$_a,2)}iCe(Q,Da,eb,Tb){if(1===eb)return this.WTj?8:0===this.nO.Kw?32:8;this.icb?(this.Kei(),this.CMg=!0):(this.dii(),this.CMg=!1);this.wj.Fe();Tb.Bt=this.icb?1:0;return 32}lid(Q,Da,eb,Tb,Ac){if(1===eb)return 32;Q=this.oxh.getTotalPageCount();-1===Q?Q="":this.icb||1===this.nO.Kw||2===this.nO.Kw?(Da=this.oxh.bmm(),Da>Q&&(Q=Da),Q=String.format(WordEditorIntl.WordEditorStrings.l_CurrentPageAndCount,
Da,Q)):Q=1===Q?String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCountSingular,Q):String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCount,Q);Ac[Cm.a.Visible]=!0;Ac[Cm.a.LabelText]=Q;return 32}Cre(Q,Da,eb,Tb,Ac){if(1===eb)return 32;Ac[wb.a.On]=this.icb;return 32}dii(){this.icb||this.WTj||(this.qJh.jYl(),this.ru.dTj(),this.icb=!0)}Kei(){this.icb&&(this.qJh.LRl(),this.ru.oNi(),this.icb=!1)}}Object(f.a)(vk,"PaginationActor",null,[]);class Rm{constructor(Q){this.Nog=Q}}Object(f.a)(Rm,"PaginationDeltaResult",
null,[1325]);class qm{constructor(Q,Da){this.PGb=this.pAd=null;this.kj=Q;Da.execute(eb=>{eb.register(this)})}get Hcd(){return"PaginationDelta"}get result(){return this.pAd}get hbg(){return 1}get Pvg(){return 200}get isEnabled(){return!0}vbg(){this.pAd=null}aIa(Q){this.kj.$d(()=>{try{this.PTc(Q)}catch(Da){Ca.ULS.sendTraceTag(39686615,324,10,"Exception caught in PaginationDeltaMetric.Calculate. Exception: {0}",Da.message)}},"PDM:C")}HEg(Q){this.PGb=Q}PTc(Q){this.pAd=null;Q=this.QTc(this.PGb,Q);-1!==
Q&&(this.pAd=new Rm(Q))}QTc(Q,Da){if(!(Q&&Da&&Q.count&&Da.count))return-1;const eb=new kb.a;for(const Tb of Q)eb.add(Tb.top);Q=new kb.a;for(const Tb of Da)Q.add(Tb.top);Da=this.w2d(eb,Q);return this.Mec(Da)}Mec(Q){if(!Q.count)return 0;let Da=0;for(let eb=0;eb<Q.count;eb++)Da+=Q.K(eb);return Da/Q.count}w2d(Q,Da){const eb=new kb.a;if(!Q.count||!Da.count)return eb;var Tb=Q.count<=Da.count;const Ac=Tb?Q:Da;Q=Tb?Da:Q;for(Da=0;Da<Ac.count;Da++){Tb=Ac.K(Da);let Ud=Math.abs(Tb-Q.K(0)),Ee=0;for(let Me=1;Me<
Q.count;Me++){var hd=Q.K(Me);hd=Math.abs(Tb-hd);hd<Ud&&(Ud=hd,Ee=Me)}eb.add(Ud);Q.removeAt(Ee)}return eb}}Object(f.a)(qm,"PaginationDeltaMetric",null,[1289]);var sq=d(459),hj=d(1268),Oq=d(2086);class Pq extends sq.a{constructor(Q,Da,eb,Tb,Ac,hd,Ud,Ee=null){super();this.wQ=null;this.nNe=0;this.b5a=-1;this.JDb=!1;this.SU=()=>{Ca.ULS.sendTraceTag(7422755,336,50,"PaginationReplicator: disabling replication as user kicked out");this.Mei()};this.ceg=()=>{if(0==this.jG.Kw){var Me=this.wQ.kr;kc.a.xt(Me,this.r8b)||
(this.r8b=Me,this.JWn(this.a3a,this.r8b))}};this.jG=Q;this.mga=this.mga.bind(this);this.jG.QJb(this.mga);this.ga=Da;this.ru=eb;this.i1=Tb;this.Ppa=Ac;this.vZe=Ee||yf.a.instance;this.r8b=this.a3a=kc.a.nil;this.YAk=Ud;hd.CWR(()=>hd.result.iC.Oya(this.SU));this.lgc();this.fl=new hj.a(1E3);this.fl.o7a();this.Ppa.register(this)}get mma(){return"Pagination"}get Jxf(){return this.YAk.value}get FOa(){return this.b5a}LXo(Q){this.b5a!==Q&&(this.b5a=Q,this.i1.rLg())}mga(){this.a3a=this.r8b=kc.a.nil;this.lgc()}qvb(Q){this.wQ=
Q;this.wQ.OJb(this.ceg);this.Tbc(this.wQ.node)}JWn(Q,Da){kc.a.xt(Q,Da)?(this.ru.Sbd(),this.lgc()):(this.ru.Tbd(),this.t$o())}sYl(){this.enabled=2}lgc(){this.enabled=0}t$o(){this.nNe=0;this.sYl();this.WC(null,null,null)}kBa(){return Ri.a.JU||Ed.a.ud().iC.Do?!1:!!(this.enabled&2)&&this.fl.D_()}WC(){this.fl.WJa();this.Ppa.bY()}xF(){}Saa(){return 0===this.enabled?!1:this.ke&&this.ke.status===gj.a.jS?!0:this.kBa()}oNa(){if(1===this._state)this.ke.Wq=Oq.a.Cea(m.AFrameworkApplication.rootQuerySignature,
this.a3a),this.ke.vE="Pagination",this.ke.status=gj.a.nH,this._state=3;else if(3===this._state&&this.ke&&this.ke.status===gj.a.jS)if(m.AFrameworkApplication.Sl)this._state=4;else if(this.fl.E4(),this.fl.Waa(),this._state=1,this.nNe++,2!==this.ke.statusCode)this.mgc();else if(1!==(this.ke.fk?this.ke.fk.length:0))this.mgc();else{var Q=this.ke.fk[0];this.vZe.cPa(Q);104===Q.StatusCode?this.Mei():101===Q.StatusCode?this.mgc():3===Q.StatusCode?this.mgc():Q.StatusCode?this.mgc():Q.PageEnds?(this.LXo(Q.PageEnds.length+
1),this.a3a=ro.b(Q.LastKnownPaginationRevision),Ca.ULS.sendTraceTag(7479449,336,50,"PaginationReplicator: Start rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.b5a,this.a3a),this.ru.iAc(Q.PageEnds,kc.a.xt(this.a3a,this.r8b)),this.Jxf.Ema=Q.PageEnds,this.i1.Rlf(),Ca.ULS.sendTraceTag(5870302,336,50,"PaginationReplicator: Finished rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.b5a,this.a3a),
this.URl()):this.mgc()}}Mei(){this.wQ&&this.wQ.XYb(this.ceg);this.lgc()}mgc(){60<this.nNe&&this.lgc()}URl(){kc.a.xt(this.a3a,this.r8b)&&this.lgc()}dispose(){this.wQ&&(this.wQ.XYb(this.ceg),this.wQ.node&&this.Ljd(this.wQ.node),this.wQ=null);this.jG.Prg(this.mga)}Tbc(Q){Q&&(Q.addListener(this),this.JDb=!0)}Ljd(Q){this.JDb&&Q&&(Q.removeListener(this),this.JDb=!1)}iWb(Q){this.Ljd(Q)}qMa(){}Obb(Q){(Q=Q.td.xm)&&this.DTn(this.a3a,Q.id)}DTn(Q,Da){kc.a.xt(Q,Da)&&this.ru.Sbd()}}Object(f.a)(Pq,"PaginationReplicator",
sq.a,[1285,10,151]);class ql{get lee(){return!0}iAc(){}Tbd(){}Sbd(){}dTj(){}oNi(){}dispose(){}ypg(){}djd(){}}Object(f.a)(ql,"PageEndMarkersNoOp",null,[1287,1288,10]);class lr{dispose(){}qvb(){}get FOa(){return-1}}Object(f.a)(lr,"PaginationReplicatorNoOp",null,[1285,10]);class Qq{constructor(){this.Dda=this.ru=this.i1=this.MNe=this.tJ=null;this.xxa=!1;this.c4k=()=>{this.wQh()}}get name(){return"WordEditor.Pagination"}uc(Q){this.W=Q;this.Bd=this.W.resolve(12);this.W.ia(1262,()=>new Bp(this.W.resolve(1259),
this.W.resolve(1260))).ha();this.W.ia(1263,()=>new Al(new tb.a(()=>ld.StaticActiveAppFrame.za().kb.Jc))).as("WordEditor.Pagination.IOutlineManager").ha();this.W.ia("WordEditor.Pagination.PageManager",()=>new Lj(new tb.a(()=>ld.StaticActiveAppFrame.za().kb.Jc),this.W.resolve(1261),this.W.resolve(1262),this.W.resolve(1263),this.W.resolve(1264))).as(1279).ha();this.W.ia(481,()=>this.W.resolve(114).Hra?new lr:new Pq(this.W.resolve(76),m.AFrameworkApplication.va,this.W.resolve(1258),this.W.resolve(1260),
sh.a.K0,Ed.a.Isa(),new tb.a(()=>this.W.resolve(485)))).ha();this.W.ia(483,()=>new Fn(this.W.resolve(1260))).ha();this.W.ia("WordEditor.Pagination.PageLevelDeltaMetric",()=>new nn(new tb.a(()=>ld.StaticActiveAppFrame.za().kb.Jc),this.W.resolve(20),ne.a.instance,this.W.Ra(1265))).ha();this.W.ia(1264,()=>new us(this.W.resolve(1266),ne.a.instance,this.W.Ra(1265))).ha();this.W.ia(1280,()=>new qm(ne.a.instance,this.W.Ra(1265))).ha();this.W.ia(1268,()=>new ct(this.W.resolve(1266))).ha();this.W.ia(1266,()=>
new To(new tb.a(()=>ld.StaticActiveAppFrame.za().kb.Jc),this.W.resolve(6),this.W.resolve(1267))).ha();this.W.ia(1269,()=>new Xr(this.W.resolve(1268),this.W.resolve(1266))).ha();this.W.ia(1272,()=>new Tp(this.W.resolve(1266),this.W.resolve(1269))).ha();this.W.ia(1273,()=>new ts(this.W.resolve(1270),this.W.rf(1271),this.W.resolve(1269),this.W.resolve(1272),this.W.resolve(1266))).ha();this.W.ia(1274,()=>this.W.resolve(1273).create()).ha();this.W.ia(1271,()=>new yn(new tb.a(()=>ld.StaticActiveAppFrame.za().kb.Jc),
this.W.resolve(6),this.W.resolve(1263),this.W.resolve(1267),this.W.resolve(1274),this.W.resolve(1270),Ri.a.gf.Ll)).as(1277).ha();this.W.ia(1275,()=>new Nq(this.W.resolve(1272),this.W.resolve(1268),qq.WordSectionNavigator.instance,this.W.resolve(1266))).ha();this.W.ia(1270,()=>this.W.resolve(1275).create()).ha();this.W.ia("WordEditor.Pagination.PageEndMarkerPositionComparer",()=>new Qm(this.W.resolve(6),ne.a.instance)).as(1278).ha();this.W.ia(1284,()=>new vk(m.AFrameworkApplication.va,this.W.resolve(584),
this.W.resolve(483),this.W.resolve(1258),m.AFrameworkApplication.ua,this.W.resolve(484),this.W.resolve(76),this.W.resolve(114).Hra)).ha();this.W.ia(1261,()=>new st(new tb.a(()=>ld.StaticActiveAppFrame.za().kb.Jc),kr.a.get_instance(),this.W.resolve(76))).ha();this.W.ia(1260,()=>new Rk(m.AFrameworkApplication.va,Cg.a.instance,Jh.a.instance,this.W.resolve(1261),new tb.a(()=>ld.StaticActiveAppFrame.za().kb.Jc),this.W.Oa(19),this.W.resolve(584))).as(1281).ha();this.W.ia(1258,()=>{this.W.resolve(114).Hra?
this.ru=new ql:this.ru=new Fl(new tb.a(()=>ld.StaticActiveAppFrame.za().kb.Jc),new tb.a(()=>ld.StaticActiveAppFrame.za().kb.$c.td),this.W.resolve(1276),this.W.resolve(1277),this.W.resolve(1278),this.W.resolve(1279),this.W.resolve(1261),this.W.resolve(1267),si.a.o3c,this.W.resolve(440),Jh.a.instance,Fl.Qrm,this.W.resolve(230),new Fk.a,this.W.resolve(981),this.W.resolve(1270),null,this.W.resolve(1280),this.W.resolve(1281),this.W.resolve(76));return this.ru}).as(649).ha();this.W.ia(1267,()=>new Mm(this.W.Ra(6),
this.W.resolve(318))).ha();this.W.ia("WordEditor.Pagination.PageAdornmentAnimationManager",()=>new dl(m.AFrameworkApplication.oc)).as(1282).ha();this.W.ia("WordEditor.Pagination.PageAdornmentContentManager",()=>new em(this.W.resolve(465))).as(1283).ha();this.W.ia(1259,()=>this.Dda=new vi(new tb.a(()=>ld.StaticActiveAppFrame.za().kb.Jc),ji.a.instance,Wj.a.instance,xc.a.instance,m.AFrameworkApplication.va,En.a.instance,this.W.resolve(1282),this.W.resolve(1283),this.W.resolve(981),Jh.a.instance,m.AFrameworkApplication.J,
!!Ri.a.instance&&Ri.a.instance.sta)).as(1276).ha()}init(){this.Bd.us.continueWith(()=>{this.Fo()})}Fo(){const Q=ld.StaticActiveAppFrame.za().kb;Q.HBa?this.wQh():Q.vja(this.c4k)}wQh(){this.xxa||(this.xxa=!0,this.MNe=La.a.instance.resolve(483),this.i1=La.a.instance.resolve(1281),this.tJ=La.a.instance.resolve(481),La.a.instance.resolve(1284).Xb())}dispose(){this.Dda&&(this.Dda.dispose(),this.Dda=null);this.ru&&(this.ru.dispose(),this.ru=null);this.tJ&&(this.tJ.dispose(),this.tJ=null);this.i1&&(this.i1.disable(),
this.i1=null);this.MNe&&(this.MNe=null)}}Object(f.a)(Qq,"PackageManager",null,[0,1]);class Os{constructor(){this.W=null}uc(Q){this.W=Q||La.a.instance}dispose(){}}Object(f.a)(Os,"TellMePackage",null,[0,1]);var Sm=d(1373),Er=d(1377),Di=d(346),fm=d(1372),Lo=d(1254);class jl{constructor(Q=null,Da=null,eb=null,Tb,Ac=null){this.VIe=null;this.n7g=!1;this.Ggh=this.U3b=null;this.zLk=this.yDh=this.Klk=this.Hgh=!1;this.Wxd=null;this.amk=null==Da?m.AFrameworkApplication.hKb:Da;this.Ixk=null==eb?m.AFrameworkApplication.Y2:
eb;this.eMk=null==Ac?m.AFrameworkApplication.neb:Ac;this.lwk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeHelpOnHelpIsEnabled");this.RNk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeCommandHookIsEnabled");this.JXo(!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeIgnoreQueryForHelp"));this.INk=!!m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib.t$c;this.JNk=!fm.a.kta()&&!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMePeopleSuggestionIsEnabled");
this.HNk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeFileSuggestionIsEnabled");this.otk=!!m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib.a0b;this.KNk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.fLk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("HelpShowsTopSearchResult");this.nFk=this.nod||this.lod;this.lFk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("OnlineCommandSuggestionsIsEnabled");
this.mFk=this.eZf;this.Zzk=!!m.AFrameworkApplication.J&&this.T_a&&m.AFrameworkApplication.J.$("StyledHeaderInLabelIsEnabled");this.Kuk=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.pvk=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.yuk=m.AFrameworkApplication.J?parseFloat(m.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold",
"-0.6")):-.6;this.Vzk=!!m.AFrameworkApplication.J&&(m.AFrameworkApplication.J.$("SmartLookupNoteSearchIsEnabled")||m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.Azk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTOChatPPTCopilot",!1);this.vAk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotPaneEnabled",
!1);this.eyk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenCopilotFromTellMe",!1)&&(this.Ern||this.aln);this.U$b=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceActionAIEnabled",!1);this.OMk=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):
"https://substrate.office.com/search/api/v1/suggestions";this.svk=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.gLk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.SLk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",
!1);this.vLk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("ShowFindInDocumentInZeroTermSearchBox")||this.mS;this.jAk=!!m.AFrameworkApplication.J&&(m.AFrameworkApplication.J.$("TellMeTemplateProviderIsEnabled")||m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.wzk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",!1);
this.Ozk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeIsRuleBasedSortingEnabled")&&"en-US"===m.AFrameworkApplication.uiCulture;this.gAk=!!m.AFrameworkApplication.J&&(m.AFrameworkApplication.J.$("TellMeFeedbackProviderIsEnabled")||m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.xAk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeZeroTermContextualCommandSuggestionsEnabled");this.Nlk=this.T_a&&
!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.Svk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.YLk=!!m.AFrameworkApplication.J&&(m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==m.AFrameworkApplication.J.ib("Application"));
this.knk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.IPk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMePerformanceMarkerEnabled");this.gyk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);this.kyk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",
!1);this.ovk=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.iAk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeNotesSuggestionIsEnabled")||this.Lpn;this.iyk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",!1);this.jyk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",
!1);this.hyk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",!1);this.rsk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1);this.ssk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMeMVP",!1);this.qsk=!!m.AFrameworkApplication.J&&
m.AFrameworkApplication.M6h&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableBumblebeeEntryPointInTellMe",!1);this.LNk=this.D1i&&(this.Kgg||this.Lgg||this.kfd||this.T_a&&fm.a.yta()&&!!m.AFrameworkApplication.J&&(this.Zwc||this.f0b||this.g0b||this.h0b||this.i0b||m.AFrameworkApplication.J.$("ShowAnswerSearchResults")||m.AFrameworkApplication.J.$("ShowDefinitionSearchResults")||m.AFrameworkApplication.J.$("ShowEntitySearchResults")||m.AFrameworkApplication.J.$("ShowWolframSearchResults")));
this.Mkk=!!m.AFrameworkApplication.J&&!m.AFrameworkApplication.J.$("AppsForOfficeThirdPartyIsDisabled")&&m.AFrameworkApplication.J.$("AppsForOfficeAllowExternalMarketplace")&&m.AFrameworkApplication.O5a;this.Nkk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("AppsForOfficePrivateCatalogIsEnabled");this.T3m(Q||{});this.J6e="2918242107";this.I6e="1454393937";this.wGb={};this.ilb=[];this.Byl=[fm.a.aDe]}get application(){return this.U3b}get hKb(){return this.amk}get HJo(){return this.J6e}get GJo(){return this.I6e}get pCf(){return this.Ggh}get Qmi(){return this.Hgh}get Y2(){return this.Ixk}get neb(){return this.eMk}get fKb(){return this.Klk}get pYm(){return this.lwk}get Bfp(){return this.RNk}get D1i(){return!0}get qfp(){return this.LNk}get O_o(){return this.yDh}JXo(Q){this.yDh=
Q}get T_a(){return this.INk}get zqd(){return this.JNk}get xqd(){return this.HNk}get s4l(){return this.otk}get ofp(){return this.KNk}get JCe(){return!1}get kfd(){return this.nFk}get Kgg(){return this.lFk}get Lgg(){return this.mFk}get Aab(){return!1}get ofe(){return!1}get W_f(){return this.Zzk}get uye(){return this.zLk}get Zwc(){return!1}get v1o(){return!1}get tvn(){return""}get wKf(){return 2}get OEm(){return 4}get PEm(){return 5}get qFi(){return""}get jpm(){return this.Kuk}get HFi(){return this.pvk}get sFi(){return 1E3}get rFi(){return 1E-6}get Mbp(){return this.OMk}get fFg(){return!1}get xXj(){return!1}get snn(){return this.Ozk}get Vee(){return!1}get Wee(){return!1}get PYi(){return!1}get OYi(){return!1}get Lpn(){return!1}get E1i(){return!1}get j2d(){return!1}get tyb(){return!1}get f0b(){return!1}get g0b(){return!1}get h0b(){return!1}get i0b(){return!1}get nod(){return this.fLk}get Vwc(){return this.gLk}get lod(){return!1}get oHf(){return null}get Nee(){return!1}get mye(){return this.vLk}get vBi(){return 0}get Zim(){return this.yuk}get nGi(){return this.svk}get Fon(){return this.Vzk}get YVf(){return this.eyk}get lye(){return this.U$b}get dym(){return-3.9}get mS(){return this.SLk}get u$c(){return this.jAk}get tZf(){return this.wzk}get p0f(){return this.gAk}get hmb(){return this.Nlk}get Nrn(){return this.xAk}get hBa(){return this.Svk}get kUj(){return this.YLk}get ucl(){return this.knk}get IEe(){return this.IPk}get bce(){return this.gyk}get Han(){return this.kyk}get iw(){return this.ovk}get ztb(){return this.iAk}get Fan(){return this.iyk}get Gan(){return this.jyk}get Ean(){return this.hyk}get H0k(){return this.Mkk}get I0k(){return this.Nkk}get vka(){return this.rsk}get b0d(){return this.ssk}get bhc(){return this.qsk}get Ern(){return this.vAk}get aln(){return this.Azk}get lTb(){return!!m.AFrameworkApplication.ua&&
m.AFrameworkApplication.ua.Ib.As}get As(){return!!m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib.As}get Tjn(){return!!m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib.Xwc}get PNn(){return jf.getImageClass("OfficeAssistant_32x32x32")}A5d(){return Promise.reject("GetFindMatchCount method is not overridden")}Hfe(Q){return Array.contains(appChrome.selectors.getVisibleControlIds(),Q)}Gce(){return!1}get Vde(){return!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeModelRankerEnabled")}get oZj(){return m.AFrameworkApplication.J?
m.AFrameworkApplication.J.ib("TellMeServiceHelpClassifierModelName"):""}get eZf(){return!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeMultiLingualCommandModelEnabled")}get XQb(){return"NoOpHeaderUi"}get uyl(){return this.Wxd}get parameterData(){return this.wGb}get enp(){return this.ilb}P_l(){if(this.VIe&&!this.n7g&&(this.n7g=!0,this.lyb(this.VIe),this.As)){var Q=La.a.instance.resolve(663);Q=(new Lo.a(Q)).P3d(this.VIe.bJ);appChrome.api.dispatch(Q)}}lyb(){}zQl(Q){const Da=[];for(let eb=
0;eb<Q.length;++eb)Q[eb].u2o?Da.push(new Di.a(Q[eb].Bn,fm.a.D2j+eb.toString())):Da.push(new Di.a(Q[eb].standard,fm.a.aDe+eb.toString()));return Da}T3m(Q){const Da={};for(const eb in Q){const Tb=eb,Ac=Q[eb];for(const hd in Ac){const Ud=hd,Ee=Ac[hd];(Da[Ud]||(Da[Ud]={}))[Tb]=Ee}}this.Wxd=Da}get pZj(){return""}get $Sj(){return!1}}Object(f.a)(jl,"TellMeApplicationData",null,[1896]);class wm{constructor(Q,Da=null,eb=!1){this.standard=Q;this.Bn=Da;this.u2o=eb}}Object(f.a)(wm,"TryQuerySet",null,[]);class Vn{constructor(){this.Qth=
this.Rth=null}get IKn(){return this.Qth}eka(Q){this.Rth=Q;return this.Jsf(Q)}dPn(){this.Qth=this.Rth}q6d(Q){return 8===Q.type?String.format(CommonUIStrings.l_FindInDocumentText,Q.tE):Q.tE}PGf(Q){return Q.tE}}Object(f.a)(Vn,"ParameterizedCommand",null,[]);class tq extends Vn{constructor(Q){super();this.e$c=Q}get commandId(){return this.e$c?"DefinitionsParameterized":"DefinitionButton"}get uig(){return"Definition"}Jsf(Q){const Da=Ya.a.Jf(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,
Q.tE));return re.a(fm.a.ztf(Q.value),x.a.avf.toString(),Da,fm.a.eVf,null,Ya.a.Jf(fm.a.qMb(Q.tE)),Da,null,null)}q6d(Q){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,Q.tE)}PGf(Q){return fm.a.qMb(Q.tE)}}Object(f.a)(tq,"DefinitionsParameterizedCommand",Vn,[]);class lq extends Vn{constructor(Q){super();this.e$c=Q}get commandId(){return this.e$c?m.AFrameworkApplication.ua.Ib.$fn?"FindWithMatchesParameterized":"FindParameterized":"EditingFind"}get uig(){return"Find"}Jsf(Q){const Da=
Ya.a.Jf(String.format(WordEditorIntl.WordEditorStrings.L_ParamFindInDocTitle,Q.tE));return re.a(fm.a.ztf(Q.value),x.a.Uhc.toString(),Da,"Find_16x16x32",null,Ya.a.Jf(Q.tE),Da,null,null)}q6d(Q){return String.format(CommonUIStrings.l_TextWithQuotation,Q.tE)}}Object(f.a)(lq,"FindParameterizedCommand",Vn,[]);class vt extends Vn{constructor(Q){super();this.e$c=Q}get commandId(){return this.e$c?"SynonymsParameterized":"SynonymButton"}get uig(){return"Synonym"}Jsf(Q){const Da=Ya.a.Jf(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_SynonymsParam,
Q.tE));return re.a(fm.a.ztf(Q.value),x.a.avf.toString(),Da,fm.a.eVf,null,Ya.a.Jf(fm.a.qMb(Q.tE)),Da,null,null)}q6d(Q){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,Q.tE)}PGf(Q){return fm.a.qMb(Q.tE)}}Object(f.a)(vt,"SynonymsParameterizedCommand",Vn,[]);var Dp=d(2104),Wn=d(2132),Fr=d(2138),Ia=d(2090),Bb=d(2091),jc=d(1509);class Ic extends Dp.a{constructor(){super(...arguments);this.jT=null;this.W4a=Wn.a.createInstance(this,Fr.a.instance,jc.a.instance,!0,
!0)}static get instance(){return Ic._instance}Shc(){this.jT(this.W4a.zk.Pna);this.W4a.m6a(!0)}A5d(Q){const Da=new Promise((eb,Tb)=>{this.jT=eb;setTimeout(()=>{Tb("Find manager execution timed out");this.W4a.m6a(!0)},500)});Q=Ia.a.createQuery(Q,Bb.a.none);this.W4a.find(Q);return Da}}Ic._instance=new Ic;Object(f.a)(Ic,"TellMeFindStatusSpy",Dp.a,[]);class zd extends jl{constructor(Q){super({});this.U3b="Word";this.Xuk=Q;m.AFrameworkApplication.J.$("TellMeFindInDocumentIsEnabled")&&(this.Hgh=!0,this.Ggh=
this.j2d?"FindWithMatchesParameterized":"FindParameterized");Q=new tq(this.lTb);const Da=new vt(this.lTb);this.parameterData[Q.commandId]=Q;this.parameterData[Da.commandId]=Da;Q=new lq(this.lTb);this.parameterData[Q.commandId]=Q;m.AFrameworkApplication.J.$("TellMeTryQueriesIsEnabled")&&(Q=[new wm(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery01,"",!1),new wm(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery02,"",!1),new wm(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery03,"",!1),new wm(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery04,
"",!1),new wm(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery05,"",!1)],this.ilb=this.zQl(Q))}A5d(Q){return Ic.instance.A5d(Q)}get ndb(){return Ih.a.$ua}get XQb(){return Ih.a.mWa}lyb(Q){var Da=m.AFrameworkApplication.J;Q=Q.bJ;Q.WordCountFlyout=!this.Xuk();Q.SelectAllButton=!Da.$("TellMeSelectAllResultIsEnabled");const eb=Da.$("TellMeDesktopUpSellIsEnabled");let Tb=m.AFrameworkApplication.pfe;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TryOfficeUpsell",!Tb));Tb=!1;Q.TextBoxUpSellButton=
!eb||Tb;Q.TableOfContentsUpSellButton=!eb||Tb;Q.SmartArtUpSellButton=!eb||Tb;Q.WordArtUpSellButton=!eb||Tb;Q.MultiColumnLayoutUpSellButton=!eb||Tb;Q.InsertEquationUpSellButton=!eb||Tb;Q.TrackChangesUpSellButton=!eb||Tb;Q.ShapesUpSellButton=!eb||Tb;Q.LabelsUpSellButton=!eb||Tb;Q.InsertCitationUpSellButton=!eb||Tb;Q.TextBoxUpSellButtonEnterprise=!eb||!Tb;Q.TableOfContentsUpSellButtonEnterprise=!eb||!Tb;Q.SmartArtUpSellButtonEnterprise=!eb||!Tb;Q.WordArtUpSellButtonEnterprise=!eb||!Tb;Q.MultiColumnLayoutUpSellButtonEnterprise=
!eb||!Tb;Q.InsertEquationUpSellButtonEnterprise=!eb||!Tb;Q.TrackChangesUpSellButtonEnterprise=!eb||!Tb;Q.ShapesUpSellButtonEnterprise=!eb||!Tb;Q.LabelsUpSellButtonEnterprise=!eb||!Tb;Q.InsertCitationUpSellButtonEnterprise=!eb||!Tb;Da=!Da.$("WordEditorTellMeDefinitionsAndSynonymsIsEnabled")||!m.AFrameworkApplication.Y2;Q.SynonymButton=Da;Q.DefinitionButton=Da}get pZj(){return m.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeMultiLanguageModelName","")}get fFg(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeServiceAADAuthIsEnabled",
!1)}get oZj(){return m.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeHelpClassifierModelName","")}get Zwc(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowImageSearchResults",!1)}get eZf(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeMLCModelIsEnabled",!1)}get wKf(){return m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.TellMeMenuUpdatePolicy",0)}get $Sj(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowMoreFileResults",
!1)}get ofe(){return m.AFrameworkApplication.J.$("TellMeRankerLoggingIsEnabled")&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableTellMeRankerLogging",!1)}get Vde(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerEnabled",!1)}get Vee(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierEnabled",!1)}get Wee(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierSwapLogicEnabled",
!1)}get sFi(){return m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerTimeOut",1E3)}get rFi(){return 1E-6*m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerSuppressionScore",1)}get PYi(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionEnabled",!1)}get OYi(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionDebugEnabled",
!1)}get qFi(){return m.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerModelName","")}get E1i(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermNotesSuggestionIsEnabled",!1)}get vBi(){return m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.NumberOfNotesSuggestionsToShow",2)}get D1i(){return m.AFrameworkApplication.J.$("TellMeServiceForSearchIsEnabled")}get JCe(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeTrimAndShowOptimalResults",
!1)}get Aab(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeNoHeadingUIV2",!1)}get uye(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeUseFeatureIcons",!1)}get xXj(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.SubstrateResultsForContextMenuIsEnabled",!1)}get Nee(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.SelectionBasedZeroTermSuggestionsEnabled",
!1)}get f0b(){return m.AFrameworkApplication.J.$("ShowAnswerSearchResults")}get g0b(){return m.AFrameworkApplication.J.$("ShowDefinitionSearchResults")}get h0b(){return m.AFrameworkApplication.J.$("ShowEntitySearchResults")}get i0b(){return m.AFrameworkApplication.J.$("ShowWolframSearchResults")}get oHf(){return m.AFrameworkApplication.J.$("ModernFontPickerIsEnabled")?{["FontName"]:"FontPicker"}:{["FontPicker"]:"FontName"}}}Object(f.a)(zd,"WordEditorTellMeApplicationData",jl,[]);var ue=d(1439),gf;
(function(Q){Q[Q.none=0]="none";Q[Q.xNg=1]="waitAll";Q[Q.Ijq=2]="synchronizeFast";Q[Q.adp=3]="synchronizeSlow"})(gf||(gf={}));Object(f.b)("ProviderSynchronizationType",gf);var Be;(function(Q){Q[Q.immediate=0]="immediate";Q[Q.xNg=1]="waitAll";Q[Q.Gjq=2]="synchronizeAndWaitAll";Q[Q.Hjq=3]="synchronizeAndWaitForRanker"})(Be||(Be={}));Object(f.b)("MenuUpdatePolicy",Be);var S=d(1381),fa=d(1379),gb=d(1586),Qb=d(1382),hc=d(1429),Gc=d(120),wa=d(291);class Ma extends Dp.a{constructor(Q){super();this.GQk=Q}Shc(){this.GQk.update()}}
Object(f.a)(Ma,"TellMeFindStatusManager",Dp.a,[]);class rb{constructor(Q){this.elb=this.J9g=null;this.ji=0;this.gDd="TellMeWAC.";const Da=Q.pCf;this.kc=Q;this.zAd=Da;this.mZe=Object.assign(new ue.a,{landingTab:"Indoc",data:null});Q=new Ma(this);this.W4a=Wn.a.createInstance(Q,Fr.a.instance,jc.a.instance,!0,!0)}oN(){return"WordFindInDocument"}bX(){return this.kc.wKf?this.kc.wKf===Be.xNg?gf.xNg:gf.adp:gf.none}WJ(Q,Da){this.Yqn(Q)?(this.elb=Q,this.J9g=Da,Q=Ia.a.createQuery(Q.Wg,Bb.a.none),this.ji=window.performance.now(),
this.W4a.find(Q)):Da.Nt(new S.a(Q))}update(){this.FMo(Math.round(window.performance.now()-this.ji));var Q=String.format(CommonUIStrings.l_TextWithQuotation,this.elb.Wg);var Da=m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib.tyb?fm.a.oUa(this.elb.Wg,15,this.mZe):Ya.a.Jf(this.elb.Wg);const eb=[];eb.push(appChrome.actions.setControlLabel(this.zAd,Q));eb.push(appChrome.actions.setCompoundButtonCommandValueId(this.zAd,Da));eb.push(appChrome.actions.updateCompoundButtonDescription(this.zAd,this.dOf()));
appChrome.api.dispatch(eb);Q=new fa.a(this.zAd,gb.a.IGe,this.elb.Wg,this.W4a.zk.Pna.toString());Da=new Qb.a(hc.a.IGe);Da.displayName=WordEditorIntl.WordEditorStrings.L_FindInDocument;Da.Xx(Q);const Tb=new S.a(this.elb);Tb.dw(Da);window.requestAnimationFrame(()=>{this.J9g.Nt(Tb)});this.W4a.m6a(!0);this.GMo(Math.round(window.performance.now()-this.ji))}dOf(){const Q=this.W4a.zk.Pna.toString();return"1"===Q?String.format(CommonUIStrings.l_SearchResultText,Q):String.format(CommonUIStrings.l_SearchResultsText,
Q)}Yqn(Q){return!!Q&&!!Q.Wg&&""!==Q.Wg.trim()}FMo(Q){const Da={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"ApiCall",["Service"]:"FindApi",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.elb.Wg.length};this.sendActivityEvent(Da,Q)}GMo(Q){const Da={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"Provider",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.elb.Wg.length};this.sendActivityEvent(Da,Q)}sendActivityEvent(Q,Da){Q=
Gc.a.$H(Q);Jg.a.JNa(Object.assign(new wa.a,{name:"Latency",dataFields:Q,durationMs:Da}),this.gDd)}}Object(f.a)(rb,"WordFindInDocumentWithMatchesProvider",null,[1399]);class dc{constructor(Q,Da){this.Rb=Q;this.ube=Da}s$a(Q,Da,eb){return this.ube.s$a(0,Q,Da,eb)}insertHtmlText(Q){return Q?32===this.CUf(Q):!1}CUf(Q){return this.executeCommand(Gd.a.Iqa,Q)}executeCommand(Q,Da){const eb=new yb.DictionaryPropertySet;eb.setValue(Wb.a.QX,Da);eb.setValue(Wb.a.KDa,!1);Da=this.Rb.Ob(Q,1);32===Da&&(Da=this.Rb.Pb(Q,
2,eb));return Da}}Object(f.a)(dc,"WordInsertContentHandler",null,[1284]);class yc extends Os{constructor(){super();this.fz=()=>{if(m.AFrameworkApplication.SGg){var Q=ld.StaticActiveAppFrame.za().Ib.QMf(x.a.ou);Q.m8c?this.Urj():Q.a2(this.iJo);var Da=new zd(()=>!1);Sm.TellMeActor.instance.initialize(Da,null,null,null,null,null,Object(R.a)(ld.StaticActiveAppFrame.za(),ld.StaticActiveAppFrame.za().w3d,"forceUpdateRibbonControls"),m.AFrameworkApplication.J,this.W.Ra(4),this.W.Ra(5),this.W.Ra(2));Sm.TellMeActor.instance.mpo(Q);
Sm.TellMeActor.instance.xro(new dc(m.AFrameworkApplication.va,this.W.Oa(696)));Da.Qmi&&Da.j2d&&Sm.TellMeActor.instance.DG(new rb(Da),Er.a.ou)}};this.iJo=()=>{this.Urj()}}get name(){return"WordEditor.TellMe"}init(){m.AFrameworkApplication.J.Uo(this.fz)}Urj(){ld.StaticActiveAppFrame.za().Fe()}}Object(f.a)(yc,"WordEditorTellMePackage",Os,[]);class Wc{constructor(){this.W=null;this.rZj=(Q,Da,eb)=>{2===eb&&(Q=new zg.StandardDialog,Q.Fd=0,Q.yna(WordEditorIntl.WordEditorStrings.L_WordTestFeature,WordEditorIntl.WordEditorStrings.L_WordTestFeatureDialogText,
null));return 32}}get name(){return"WordEditor.TestFeature"}init(){this.W.resolve(12).us.continueWith(()=>{this.Fo()})}dispose(){}Fo(){if(this.W.resolve(12).isFeatureEnabled(119)){m.AFrameworkApplication.va.fb(hg.a.Kak,Uc.a.view,this.rZj,96);var Q=Sf.FocusManager.instance().ie(Ih.a.uF);Af.AFrame.$i(Q,gd.KeyInputManager.mc(fk.a.$fb,5|gd.KeyInputManager.li),hg.a.Kak)}}uc(Q){this.W=Q}static main(){C.a.instance.Lc(new Wc)}}Object(f.a)(Wc,"WordEditorTestFeaturePackage",null,[0,1]);var kd=d(1342),Ld=d(112);
class le{constructor(Q,Da){this.OGj=Q;this.Rb=Da;this.Ove=(eb,Tb,Ac,hd,Ud)=>{if(1===Ac)return 32;this.OGj.fC(9,Ud,!1);return 32};this.aS=(eb,Tb)=>{if(9===Tb.type){var Ac;(eb=Tb.iA)?("string"===typeof eb?Ac=eb:"data"===eb.type&&(Ac=Ld.a.u$h(eb.jco,eb.newState,eb.NXo)),Ac&&le.KRc(Ac)):Ca.ULS.sendTraceTag(556103040,376,15,"TrackChangeSettingUpdateNotificationEventArgs is null")}};this.gjd()}gjd(){this.Rb.qa(hg.a.Ove,z.a.frame,this.Ove);this.OGj.BO(this.aS)}dispose(){}static KRc(Q){Q=ld.StaticActiveAppFrame.za().$J.cka(Q,
!1);Q.image=5;Q.sla="CoAuth_AuthorStatus_16x16x32";ld.StaticActiveAppFrame.za().$J.Jz(Q)}}Object(f.a)(le,"TrackChangeNotificationActor",null,[]);class je{constructor(){this.Yh=this.kaf=this.W=null;this.Yed=()=>{if(this.Yh=kd.a.o4c().result)this.W.ia(1285,()=>new le(this.Yh,m.AFrameworkApplication.va)).ha(),this.kaf=this.W.resolve(1285)}}get name(){return"WordEditor.TrackChangeNotificationActor"}uc(Q){this.W=Q}init(){this.W.resolve(12).us.continueWith(()=>{this.Fo()})}Fo(){kd.a.o4c().continueWith(this.Yed)}dispose(){this.kaf&&
this.kaf.dispose()}}Object(f.a)(je,"WordEditorTrackChangeNotificationActorPackageManager",null,[0,1]);var wf=d(103),Kg=d(1350),Uf=d(2082);class uf{}uf.nKg="UnsavedChanges";uf.oKg="UnsavedChangesThemed";uf.lIo="SavedChanges";uf.N3j="UnsavedChangesOpenPipe";uf.kqp="UnsavedChangesOpenPipeCssClassNameThemed";uf.M3j="UnsavedChangesClosePipe";uf.hqp="UnsavedChangesClosePipeThemed";uf.iqp="UnsavedChanges";uf.jqp="UnsavedChangesThemed";uf.pKg="UnsavedChangesIndicatorPositionRef";Object(f.a)(uf,"UnsavedChangesHighlightUtils",
null,[]);class Si extends Kg.a{constructor(Q,Da){super();this.xia=Q;this.Fy=Da;this.w5=[this.Fy?new Uf.a(uf.oKg,uf.jqp):new Uf.a(uf.nKg,uf.iqp)]}get wfa(){return!0}get Erb(){return 4}get Y9a(){return this.w5}zMa(Q,Da){if(this.xia){var eb=this.xia.q8f;if(eb&&eb.count&&eb.contains(Q.id))for(Q=Da.ZMa("span"),Da=0;Da<Q.length;Da++)eb=Q[Da],Da||eb.classList.add(this.Fy?uf.kqp:uf.N3j),Da===Q.length-1&&eb.classList.add(this.Fy?uf.hqp:uf.M3j),eb.classList.add(this.Fy?uf.oKg:uf.nKg)}}q9a(){}}Object(f.a)(Si,
"UnsavedChangesHighlightActor",Kg.a,[]);var Ei=d(1021);class Gf{constructor(Q){this.ONe=null;this.xia=Q;this.qWe=!1}get key(){return"UnsavedChangesHighlight"}get Cv(){return"UnsavedChanges"}reset(Q){if(this.xia){Q=Q.node;if(ii.ParagraphReader.Vb(Q)){const Da=this.xia.q8f;if(Da&&Da.contains(Q.id)){this.qWe=!0;this.ONe=Q.id;return}}this.qWe=!1;this.ONe=kc.a.nil}}wEa(){let Q=null;return this.qWe?(Q=Object.assign(new Ei.a,{NF:this.key,contentObject:this.ONe,description:null}),{returnValue:!0,yG:Q}):{returnValue:!1,
yG:Q}}}Object(f.a)(Gf,"UnsavedChangesHighlightCpContentDetailsProvider",null,[256,257]);class Ze{constructor(Q,Da,eb,Tb,Ac,hd,Ud){this.Oth=null;this.u9=Q;this.tf=Da;this.vZ=eb;this.U9=Tb;this.XGh=Ac;this.Tpa=hd;this.Fy=Ud;this.tf.Oya(this.SU.bind(this))}get q8f(){return this.Oth}hZm(){if(this.u9){if(1===this.u9.Uof){if(0===this.u9.W1f&&this.u9.Knj()){this.Oth=this.u9.jje;const Q=this.u9.esd;this.u9.mIo.forEach(this.ARl.bind(this));Q.forEach(this.iZm.bind(this));0<Q.length&&this.mTl(this.vZ);return 0}return this.elo(this.u9.W1f)}return 2}return 1}elo(Q){switch(Q){case 0:return this.u9.vMi()?
5:6;case 3:case 12:case 5:case 11:return 4;default:return 6}}uNi(Q,Da,eb){if(Da)if(eb){eb=Da.querySelectorAll("span");for(let Tb=0;Tb<eb.length;Tb++){const Ac=eb[Tb];Tb||Ac.classList.add(uf.N3j);Tb===eb.length-1&&Ac.classList.add(uf.M3j);Ac.classList.add(this.Fy?uf.oKg:uf.nKg)}Da.classList.add(uf.pKg);Q&&this.U9.gAc(Q)}else Da.classList.add(uf.lIo)}xlc(Q,Da){const eb=this.hMm(Q);if(Q&&(Q=Q.Be(ld.StaticActiveAppFrame.za().kb.Jc.pc)))if(Q.mg&&Q.mg.Aj&&0!==Q.mg.Aj.count)for(const Tb of Q.mg.Aj)this.uNi(eb,
Tb,Da);else this.uNi(eb,Q.htmlElement,Da)}hMm(Q){return this.XGh&&(Q=this.XGh.uQb(Q))&&Q&&(Q=Q.Be(ld.StaticActiveAppFrame.za().kb.Jc.pc))?Q:null}iZm(Q){this.xlc(Q,!0);return!0}ARl(Q){this.xlc(Q,!1);return!0}mTl(Q){Q&&Q.continueWith(()=>{Q.result.logActivity("UnsavedChangesHighlightEnableSurvey","WordUnsavedChangesHighlightingSurveyGateIsEnabled",0)})}SU(Q,Da){Da===Sys.EventArgs.Empty?Ca.ULS.sendTraceTag(572364513,306,50,"HighlightUnsavedChanges Not Run: Empty Event Args"):Da&&Da.errorCode?this.Tpa.AU||
(Q=this.hZm(),Ca.ULS.sendTraceTag(576528923,306,15,"HighlightUnsavedChanges Run Result: {0}",Q),ua.Health.instance.recordKpiUsage("UnsavedChangesHighlight",0,"wwrelfc",null),0!==Q&&4!==Q&&this.Djp(Q)):Ca.ULS.sendTraceTag(572364514,306,50,"HighlightUnsavedChanges Not Run: No {0}",Da?"Error Code":"Kickout Event Args")}Djp(Q){let Da;const eb=new Jl.a;eb.extendedProperties=new Map;eb.extendedProperties.set("HighlightUnsavedChangesResult",Q.toString());eb.extendedProperties.set("UnsavedChangesCollectionResult",
"-1");switch(Q){case 1:case 2:case 6:Da="HighlightInternalError";break;case 5:Da="ChangeOutsideCanvas"}6!==Q&&5!==Q||eb.extendedProperties.set("UnsavedChangesCollectionResult",this.u9.W1f.toString());Da&&(ua.Health.instance.recordQosError(Da,["UnsavedContentNotHighlighted"],!0,!0,!1,!1,eb),ua.Health.instance.recordKpiFailure("UnsavedChangesHighlight",Da,!0,!0,eb))}dispose(){this.tf.YYb(this.SU.bind(this))}}Object(f.a)(Ze,"UnsavedChangesHighlighter",null,[10]);var rf=d(853),Ng=d(699),Yg=d(1348);class Gk extends Yg.a{constructor(Q,
Da){super();this.xia=Q;this.Fy=Da}u_a(Q){if(!this.xia)return!1;const Da=this.xia.q8f;return Da?Da.contains(Q.Cb.id)||Q.htmlElement.querySelector(".UnsavedChanges")?!0:!1:!1}rhl(Q,Da){Da=Q.TKa?Q.TKa[Da]?Q.TKa[Da].style?Q.TKa[Da].style.marginLeft:null:null:null;var eb=Q.qba;Q=1440<=eb?-(eb/1440*96):Q.j6a(0,96,this.zoom);eb=0;Da&&(Da=Da.match(/^(\d+)px/))&&Da[1]&&(eb=Number(Da[1]));return Q-eb}Zhl(Q,Da,eb){return Sys.UI.DomElement.getBounds(Q).y-eb.m7[Da].y}hhl(Q){return Sys.UI.DomElement.getBounds(Q).height}L9h(Q,
Da,eb,Tb){let Ac;Ac=this.rhl(eb,Da);Da=this.Zhl(Q,Da,eb);Q=this.hhl(Q);Tb=rf.a.createElement(Tb,Ng.a.div);Tb.className=this.Fy?"UnsavedChangesIndicatorThemed":"UnsavedChangesIndicator";Tb.style.left=Ac+"px";Tb.style.top=Da+"px";Tb.style.height=Q+"px";return Tb}a9h(Q,Da,eb,Tb){const Ac=[],hd=Q.querySelectorAll("."+uf.pKg);if(0===hd.length&&Q.classList.contains(uf.pKg))eb=this.L9h(Q,Da,eb,Tb),eb.Vja=Da,Ac.push(eb);else for(Q=0;Q<hd.length;Q++){const Ud=this.L9h(hd[Q],Da,eb,Tb);Ud.Vja=Da;Ac.push(Ud)}return Ac}kUa(Q){let Da=
[];var eb=Q.H3;const Tb=eb.uh.ownerDocument;if(eb.Kj){let Ac=0;for(const hd of eb.mg.Aj)(eb=this.a9h(hd,Ac,Q,Tb))&&(Da=Da.concat(eb)),Ac+=1}else Da=this.a9h(eb.htmlElement,0,Q,Tb);return Da}}Object(f.a)(Gk,"UnsavedChangesIndicatorActor",Yg.a,[]);class ij{constructor(){this.ZY=this.Ey=this.SQa=this.U9=this.RCd=this.xia=null}get name(){return"WordEditor.UnsavedChangesHighlight"}uc(){}init(){this.U9=La.a.instance.resolve(362).instance;this.xia=new Ze(La.a.instance.resolve(487),Ce.SessionStatusManager.instance,
zk.a.Yp(La.a.instance.Ra(616)),this.U9,La.a.instance.resolve(595),La.a.instance.resolve(436),!!Ri.a.instance&&Ri.a.instance.sta);this.SQa=La.a.instance.Ra(324);this.ZY=La.a.instance.resolve(368).instance;this.RCd=new Gk(this.xia,!!Ri.a.instance&&Ri.a.instance.sta);this.U9.iNa(this.RCd);this.SQa&&this.SQa.execute(Q=>{Q.XX(new Gf(this.xia))});this.Ey=new Si(this.xia,!!Ri.a.instance&&Ri.a.instance.sta);this.ZY.Ucb(this.Ey)}dispose(){this.U9&&this.RCd&&this.U9.EDe(this.RCd);this.ZY&&this.Ey&&this.ZY.eKg(this.Ey);
wf.a.vD(this.xia)}static main(){C.a.instance.Lc(new ij)}}Object(f.a)(ij,"WordEditorUnsavedChangesHighlightPackage",null,[0,1,10]);var Nk=d(123);class di{constructor(Q,Da,eb){this.ga=Q;this.Xn=Da;this.Ga=eb}Xb(){this.Ga.$("ZoomPopupDialogIsEnabled")&&(this.ga.qa(x.a.vxc,z.a.frame,Object(R.a)(this.Xn,this.Xn.vxc,"showZoomDialog")),this.ga.fb(x.a.pio,z.a.frame,Object(R.a)(this.Xn,this.Xn.vlj,"onQueryZoomText"),96),this.ga.qa(x.a.Ztd,z.a.frame,Object(R.a)(this.Xn,this.Xn.ebk,"zoomDialogTabFocusHandler")),
this.ga.qa(x.a.Ytd,z.a.frame,Object(R.a)(this.Xn,this.Xn.ebk,"zoomDialogTabFocusHandler")));this.Ga.$("ZoomSliderIsEnabled")&&(this.ga.fb(x.a.Svj,z.a.frame,Object(R.a)(this.Xn,this.Xn.ZYn,"onQueryZoomPercentage"),96),this.ga.fb(x.a.gbk,z.a.frame,Object(R.a)(this.Xn,this.Xn.E1n,"onZoomToPercentage"),96),this.ga.qa(x.a.QHp,z.a.frame,Nk.ActionManager.Zf))}}Object(f.a)(di,"CommonZoomActor",null,[1859]);class Gl extends di{constructor(Q,Da,eb){super(Q,Da,eb);this.oja=Da}Xb(){super.Xb();this.Ga.$("ZoomPopupDialogIsEnabled")&&
(this.ga.qa(hg.a.COg,z.a.frame,Nk.ActionManager.Zf),this.ga.qa(hg.a.eGe,z.a.frame,Object(R.a)(this.oja,this.oja.PHp,"zoomTo100")));this.ga.qa(hg.a.V2b,z.a.frame,Object(R.a)(this.oja,this.oja.V2b,"zoomToPageWidth"));this.ga.qa(x.a.Wrb,z.a.frame,Object(R.a)(this.oja,this.oja.Wrb,"increaseZoom"));this.ga.qa(x.a.eob,z.a.frame,Object(R.a)(this.oja,this.oja.eob,"decreaseZoom"));this.ga.qa(hg.a.pwg,z.a.frame,Object(R.a)(this.oja,this.oja.xXo,"setZoomLevelFromRibbon"));this.ga.fb(hg.a.Awb,z.a.frame,Object(R.a)(this.oja,
this.oja.vlj,"onQueryZoomText"),96);this.ga.fb(hg.a.Jre,Uc.a.application,Object(R.a)(this.oja,this.oja.YYn,"onQueryZoomLevelLabelText"),96);this.ga.qa(Gd.a.sai,z.a.frame,Nk.ActionManager.Zf);this.ga.qa(Gd.a.rai,z.a.frame,Nk.ActionManager.Zf);this.ga.qa(Gd.a.wai,z.a.frame,Nk.ActionManager.Zf);this.ga.qa(Gd.a.tai,z.a.frame,Nk.ActionManager.Zf);this.ga.qa(hg.a.$na,z.a.frame,Nk.ActionManager.Zf)}}Object(f.a)(Gl,"WordEditorZoomActor",di,[]);class uq{constructor(Q,Da){this.zoom=Q;this.E2k=Da}}Object(f.a)(uq,
"SetCustomZoomArgs",null,[]);var Av=d(1101);class vs{constructor(Q,Da){this.ILl=[CommonUIStrings.l_FullPage,CommonUIStrings.l_PageWidth,"200%","150%","100%","75%","50%"];this.JLl=[vs.iwf,vs.EZd,"200","150","100","75","50"];this.Dra=3;this.pQ=0;this.delta=.1;this.Q2f=0;this.ed=new W.a;this.zi=null;this.J=Q;this.Rb=Da;this.dPj(1)}get yj(){return this.pQ}dPj(Q){this.pQ=Q}get zXc(){return Math.round(100*this.yj)}get CNn(){return Math.floor(this.zXc/10)/10+this.delta}get BNn(){return Math.ceil(this.zXc/
10)/10-this.delta}get ga(){return m.AFrameworkApplication.va}t0k(Q){this.ed.addHandler("ZoomChanged",Q)}wyo(Q){this.ed.removeHandler("ZoomChanged",Q)}YX(Q){this.t0k(Q)}nNa(Q){this.wyo(Q)}pzj(){}hBj(){}ozj(){}gBj(){}$td(Q){this.fbk(Q,this.yj)}fbk(Q,Da){null!==Q&&Qn.a.PNj(Q,Da)}cAg(Q,Da=!0){let eb=Q*=100;this.J&&this.J.$("DoNotAutoScrollAfterPinchIsEnabled")&&(eb=new uq(Q,Da));this.ILj(eb)}wXo(Q,Da=!1){this.$na(Q,3|(Da?0:4))}C1n(Q,Da,eb){if(1===Q)return 32;Q=eb/100;Q<this.Lcd?Q=this.Lcd:Q>this.ocd&&
(Q=this.ocd);this.$na(Q,1);Da&&(Da.Bt=Math.floor(100*Q));return 32}vlj(Q,Da,eb,Tb,Ac){if(1===eb)return 32;Q=Ya.a.XJa(this.zXc,6,m.AFrameworkApplication.numberFormat);Ac.Value=Q;Ac.LabelText=Q;return 32}E1n(Q,Da,eb,Tb,Ac){return 1===eb?32:this.C1n(eb,Tb,Ac.value)}ZYn(Q,Da,eb,Tb,Ac){Ac.MinValue=100*this.Lcd;Ac.MaxValue=100*this.ocd;Ac.value=this.zXc;return 32}XIi(){return this.ILl}YIi(){return this.JLl}gmm(){let Q=Math.floor(100*this.yj).toString();1===this.Dra?Q=vs.iwf:2===this.Dra&&(Q=vs.EZd);return Q}Wrb(Q,
Da,eb){if(1===eb)return 32;this.Bbd(this.Rb?this.Rb.aE:0,"IncreaseZoom");this.Dra=0;this.$na(this.CNn);return 32}eob(Q,Da,eb){if(1===eb)return 32;this.Bbd(this.Rb?this.Rb.aE:0,"DecreaseZoom");this.Dra=0;this.$na(this.BNn);return 32}xXo(Q,Da,eb,Tb,Ac){if(1===eb)return 32;this.Bbd(this.Rb?this.Rb.aE:0,"SetZoomLevelFromRibbon");Q=Ac.Value;if(Q.toLowerCase().startsWith("fit"))return Q=new ud.a(0,1,0,()=>{this.V2b(0,null,2,null,null)},138,void 0,!0),Jh.a.instance.Zb(Q),32;Q=parseInt(Q)/100;if(isNaN(Q))return 2;
this.Dra=0;this.$na(Q);return 32}Bbd(Q,Da){Ca.ULS.sendTraceTag(42341577,353,50,"Update Zoom. CommandLocation: {0}; Command: {1}; IsSLR: {2}",Q,Da,m.AFrameworkApplication.ua.Ib.As)}vxc(Q,Da,eb){if(1===eb)return 32;Ca.ULS.sendTraceTag(7176728,353,50,"Customer is trying to trigger the Zoom dialog");this.showDialog();return 32}showDialog(){const Q=this.gmm();this.zi=new Av.a(this.XIi(),this.YIi(),Object(R.a)(this,this.oVm,"handleZoomDialogResult"),Sf.FocusManager.instance(),!0);this.zi.vxc(CommonUIStrings.l_ZoomDialogTitle,
Q)}ven(Q){return Q.toLowerCase()===vs.iwf.toLowerCase()}wen(Q){return Q.toLowerCase()===vs.EZd.toLowerCase()}oVm(Q){if(Q){if(this.ven(Q)){this.Dra=1;var Da=32}else if(this.wen(Q))this.Dra=2,Da=this.V2b(0,null,2,null,null);else if(Da=Number.parseInvariant(Q)){this.Dra=0;let eb=Da;this.J&&this.J.$("DoNotAutoScrollAfterPinchIsEnabled")&&(eb=new uq(Da,!0));Da=this.ILj(eb)}else Da=8;32===Da?Ca.ULS.sendTraceTag(7176729,353,50,"Succeeded to Zoom: {0}",{["DialogResult"]:Q}):Ca.ULS.sendTraceTag(7156360,353,
10,"Failed to Zoom: {0}",{["DialogResult"]:Q})}else Ca.ULS.sendTraceTag(529290753,353,10,"Failed to Zoom: {0}",{["DialogResult"]:Q})}fko(){this.ed.raiseEvent("ZoomChanged",null)}twj(){}Dog(){}ebk(Q){if(!this.zi)return 2;var Da=this.zi.focusManager.au().Nk.zra;if(Da===this.zi.lB&&Q===x.a.Ztd||Da===this.zi.jJ&&Q===x.a.Ytd)this.zi.yJb||this.zi.rKo(),this.zi.focusManager.au().Nk.hA(this.zi.yJb);else if(Da.id.startsWith(this.zi.xid)||Da.className.startsWith(this.zi.$vj))Da=null,Q===x.a.Ztd?Da=this.zi.jJ:
Q===x.a.Ytd&&(Da=this.zi.lB),this.zi.focusManager.au().Nk.hA(Da),Sys.UI.DomElement.removeCssClass(this.zi.yJb.parentNode,this.zi.mog);else if(Q===x.a.Ztd)this.zi.focusManager.au().Vqc();else if(Q===x.a.Ytd)this.zi.focusManager.au().Tqc();else return 2;return 32}}vs.iwf="FullPage";vs.EZd="PageWidth";Object(f.a)(vs,"ZoomManager",null,[1256]);var Yr;(function(Q){Q[Q.Caj=0]="manual";Q[Q.hYp=1]="fitToFullPage";Q[Q.Kni=2]="fitWidth";Q[Q.Xcg=3]="onBoot"})(Yr||(Yr={}));Object(f.b)("ZoomStatus",Yr);d(1249);
var up;(function(Q){Q[Q.normal=0]="normal";Q[Q.Fio=1]="quiet";Q[Q.Oei=2]="disableScrollUpdate";Q[Q.aSl=4]="disableUiControlUpdate"})(up||(up={}));Object(f.b)("ZoomUpdateFlags",up);var Vw=d(277),Gr=d(332),vq=d(1010);class Uo extends vs{constructor(Q,Da,eb,Tb,Ac,hd,Ud){super(Q,Da);this.$Dp=[CommonUIStrings.l_PageWidth,"200%","150%","125%","100%","75%","50%"];this.aEp=[vs.EZd,"200","150","125","100","75","50"];this.cbf=this.UEj=!1;this.z8g="AutoFitForAdaptiveLayout";this.Ktk="FitPageWidthFailure";this.xPk=
"UpdateZoomFailure";this.SQk="wwf";this.scf=null;this.oyj=()=>{this.Dra===Yr.Kni&&this.YCf()};this.OJl=Ee=>{if(Ee.ctrlKey){m.AFrameworkApplication.va.Ob(Gd.a.tai,2);Ee=Ee.VCp;if(!Ee)return!1;this.$na(this.yj-(0<Ee?.1:-.1));this.Bbd(6,"CtrlScroll");return!0}return!1};this.D1n=()=>{Ca.ULS.sendTraceTag(42341578,353,50,"Click event detected on Zoom Label. IsSLR: {0}",!0);return!0};this.IZ=eb;this.gl=Tb;this.Yb=Ac;this.Dg=hd;this.nHc=Ud;this.Pph=Q.$("KeepViewAfterZoomIsEnabled");this.TQk=Q.$("ZoomShortCutIsEnabled");
this.MPk=Q.$("DoNotAutoScrollAfterPinchIsEnabled");this.ryk=(this.rVe=Q.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&Q.$("AutoFitForSmallScreenModeIsEnabled");this.Krk=Q.$("DoNotProcessUpdateZoomActionIsEnabled");this.UQk=Q.$("ZoomSliderIsEnabled");this.$A()}get appName(){return"WordEditor"}get ocd(){return 4}get Lcd(){return.1}get PJl(){return wacBoot.CtrlWheelMetrics}S_k(Q){this.ed.addHandler("PinchStart",Q)}lyo(Q){this.ed.removeHandler("PinchStart",Q)}R_k(Q){this.ed.addHandler("PinchEnd",Q)}kyo(Q){this.ed.removeHandler("PinchEnd",
Q)}get tH(){return null!=this.$2g?this.$2g:this.$2g=La.a.instance.Oa(584)}Y7j(Q){Q=!(Q&up.aSl);const Da=ob.a.get_instance().isCompleted(7);return Q&&Da?(Q={SelectZoomOption:"ComboBoxModel"},ld.StaticActiveAppFrame.za()&&ld.StaticActiveAppFrame.za().eJ(Q),this.Wxp(),!0):!1}$na(Q,Da=up.normal){let eb=!0;this.Krk||m.AFrameworkApplication.va.Ob(hg.a.$na,2);if(this.yj===Q)return this.cbf||(this.cbf=this.Y7j(Da)),eb;Q>this.ocd?Q=this.ocd:Q<this.Lcd&&(Q=this.Lcd);var Tb=!!(Da&up.Fio);1===Q||Tb||m.AFrameworkApplication.va.Ob(hg.a.COg,
2);try{Tb=null;ld.StaticActiveAppFrame.za()&&Object($l.a)(vq.a,ld.StaticActiveAppFrame.za().kb.Jc)&&(Tb=ld.StaticActiveAppFrame.za().kb.Jc);let Ac=-1,hd=-1,Ud=-1;const Ee=!(Da&up.Oei);this.Pph&&Ee&&(Ac=gg.a.mOm(Cg.a.instance.gb.currentSelection,Tb),hd=Tb.bM.scrollLeft,Ud=Tb.bM.scrollTop);const Me=this.yj;this.dPj(Q);this.fko();this.cbf=this.Y7j(Da);Ee&&this.wwp(Tb,Ac,hd,Ud,Me)}catch(Ac){eb=!1,Ca.ULS.sendTraceTag(7185431,353,10,"UpdateZoom error:{0}",Ac)}return eb}wwp(Q,Da,eb,Tb,Ac){Q&&Q.isActive?
this.Pph?0<=Da&&100>=Da?Q.ns.Z3(100-Da,!0,!0):Q.ns.Gsn(eb,Tb,Ac,this.yj):Q.ns.Z3():Ca.ULS.sendTraceTag(7185430,353,10,"UpdateZoom: Failed to get PageView to scroll content")}PHp(Q,Da,eb){2===eb&&(this.Bbd(this.Rb?this.Rb.aE:0,"ZoomTo100"),this.Dra=Yr.Caj,this.$na(1));return 32}ILj(Q){this.Dra=Yr.Caj;let Da,eb=!0;if(this.MPk){if(!Object($l.a)(uq,Q))return Ca.ULS.sendTraceTag(51644238,353,10,"actiondata is not a SetCustomZoomArgs"),8;Da=Q.zoom/100;eb=Q.E2k}else Da=Number.parseInvariant(String.format("{0}",
Q))/100;Ca.ULS.sendTraceTag(7410915,353,50,"Word Editor - Zoom to custom value: {0}",Da);Q=up.normal;eb||(Q=up.Oei);this.$na(Da,Q);return 32}V2b(Q,Da,eb){if(1===eb)return 32;Ca.ULS.sendTraceTag(7410944,353,50,"Word Editor - Zoom to fit page width");Object(ce.a)("ZoomToPageWidth",!0);this.Dra=Yr.Kni;this.u_l();return this.YCf()}YYn(Q,Da,eb,Tb,Ac){if(1===eb)return 32;Q=Ya.a.XJa(this.zXc,6,m.AFrameworkApplication.numberFormat);Ac[Vw.a.labelText]=Q;return 32}XIi(){return this.$Dp}YIi(){return this.aEp}u_l(){this.UEj||
(ld.StaticActiveAppFrame.za()?(ld.StaticActiveAppFrame.za().b2(this.oyj),this.UEj=!0):Ca.ULS.sendTraceTag(7185432,353,10,"EnsureResizeEventRegistered: Failed to get PageManager to register event"))}YCf(){var Q=this.IZ.JIf();if(!Q)return 8;for(var Da=0;Q;)Da=Math.max(Da,Lm.a.instance.Gv(Q)),Q=this.IZ.d3c(Q);Q=Ko.a.qj(Da,0);(Da=this.nHc())&&Da.Uxe()&&(Q+=wacBoot.ShiftUtils.getFloatingObjectsContainerWidth());Q+=2*Gr.a.gOg;Q=ld.StaticActiveAppFrame.za().XF.offsetWidth/Q;this.$na(Q);return 32}Wxp(){this.tH&&
(this.UQk?(this.tH.eS(Zl.a.KHp),this.tH.eS(Zl.a.MHp)):this.tH.eS(Zl.a.NHp))}iap(Q){Q||(Q=window.self.CtrlWheelMetrics);if(Q){var Da=Q.ctrlWheelOccurred;if("boolean"!==typeof Da)Ca.ULS.sendTraceTag(594346948,353,15,"ctrlWheelMetrics module not found");else{Ca.ULS.sendTraceTag(594346947,353,50,"ctrlWheelOccurred: {0}",Da);try{Q.stop()}catch(eb){Ca.ULS.sendTraceTag(594346946,326,15,"Exception: {0}",eb)}}}else Ca.ULS.sendTraceTag(594346949,353,15,"ctrlWheelMetrics module not found")}$A(){this.iap(this.PJl);
if(this.gl){var Q=document.getElementById(Ih.a.l_d);Q&&this.gl.nb(U.a.Dub,Q,this.OJl)}this.Yb&&(Q=this.Yb.ie(Ih.a.uF),this.TQk&&(Q.bindAction(gd.KeyInputManager.mc(fk.a.yAc,gd.KeyInputManager.li),x.a.Wrb),Q.bindAction(gd.KeyInputManager.mc(fk.a.gtd,gd.KeyInputManager.li),x.a.Wrb),Q.bindAction(gd.KeyInputManager.mc(fk.a.zAc,gd.KeyInputManager.li),x.a.eob),Q.bindAction(gd.KeyInputManager.mc(fk.a.BAc,gd.KeyInputManager.li),x.a.eob),Q.bindAction(gd.KeyInputManager.mc(fk.a.evd,gd.KeyInputManager.li),hg.a.eGe)));
this.Dg&&(this.scf=document.getElementById("LabelShowZoomValue-MediumCompact"))&&this.Dg.nb(U.a.click,this.scf,this.D1n);this.ryk&&(ld.StaticActiveAppFrame.za().NK.registerLayoutBreakpointChanged("canvas",Da=>{this.Sif(Da)}),ld.StaticActiveAppFrame.za().NK.registerBoundingWindowRectsChanged("canvas",()=>{this.Sif(ld.StaticActiveAppFrame.za().NK.getLayoutBreakpoint())}))}Sif(Q){let Da=!0,eb="";if(this.Dra!==Yr.Xcg)return Da;ua.Health.instance.recordKpiUsage(this.z8g,0,this.SQk,null);switch(Q){case "Small":8===
this.YCf()&&(eb=this.Ktk,Da=!1);break;default:1===this.yj||this.$na(1)||(eb=this.xPk,Da=!1)}Da||ua.Health.instance.recordKpiFailure(this.z8g,eb,!0,!0,null);return Da}pzj(Q){this.S_k(Q)}hBj(Q){this.lyo(Q)}ozj(Q){this.R_k(Q)}gBj(Q){this.kyo(Q)}twj(){this.ed.raiseEvent("PinchStart",null)}Dog(){this.ed.raiseEvent("PinchEnd",null)}}Object(f.a)(Uo,"WordEditorZoomManager",vs,[1255,1256]);class Dm{constructor(){this.W=null}get name(){return"WordEditor.Zoom"}init(){if(m.AFrameworkApplication.J.$("ZoomPopupDialogIsEnabled")){const Q=
this.W.resolve(1286),Da=this.W.resolve(1287);Q.Xb();Sys.UI.DomElement.overrideGetBounds=!0;m.AFrameworkApplication.J.$("AdaptiveLayoutForSmallScreenModeIsEnabled")&&m.AFrameworkApplication.J.$("AutoFitForSmallScreenModeIsEnabled")&&Da&&ob.a.get_instance().Tk(4,()=>{Da.Sif(ld.StaticActiveAppFrame.za().NK.getLayoutBreakpoint())||Ca.ULS.sendTraceTag(578326819,353,15,"Auto fit for adaptive layout failed during boot.")})}}dispose(){}uc(Q){this.W=Q;m.AFrameworkApplication.J.$("ZoomPopupDialogIsEnabled")&&
(this.W.ia(1287,()=>new Uo(m.AFrameworkApplication.J,m.AFrameworkApplication.va,qq.WordSectionNavigator.instance,En.a.instance,Sf.FocusManager.instance(),ji.a.instance,()=>Q.Oa(361))).ha().as(6).as(604),this.W.ia(1286,()=>new Gl(m.AFrameworkApplication.va,this.W.resolve(1287),m.AFrameworkApplication.J)).ha())}static main(){C.a.instance.Lc(new Dm)}}Object(f.a)(Dm,"ZoomPackage",null,[0,1]);var ep=window.FormatPictureTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},
children:[{name:"TaskPane",attrs:{Id:"FormatPictureTaskPane",Title:"STR@L_FormatPicture",Width:"300",ImageCollapsedArrow:"IMGMAP@we@ArrowCollapsedRest_16x16x32",ImageExpandedArrow:"IMGMAP@we@ArrowExpandedRest_16x16x32",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageCheckMark:"IMGMAP@we@CheckboxChecked_16x16x32",ImageUncheckMark:"IMGMAP@we@CheckboxUnchecked_16x16x32"},
children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupFormatPictureControls",IsStretched:"false"},children:[{name:"Section",attrs:{Id:"GroupFormatPictureControlsSection"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Large30",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnProperties",Command:"0x62A2D4C0",Image30by30:"IMGMAP@we@FormatObjectProperties_30x30x32",LabelText:"STR@L_Properties"}},{name:"Button",attrs:{Id:"btnPicture",
Command:"0x7136810D",Image30by30:"IMGMAP@we@FormatObjectPictureOptions_30x30x32",LabelText:"STR@L_Picture"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupAllInOne",IsStretched:"true",TextAlign:"Right"},children:[{name:"CollapsibleSection",attrs:{Id:"AltTextCollapsibleSection",Title:"STR@l_AlternativeTextDialogTitle"},children:[{name:"Section",attrs:{Id:"altTextSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextTitle",
Alt:"STR@l_AlternativeTextTitleCaption",LabelText:"STR@l_AlternativeTextTitleCaption",Command:"0x3507A2B1",QueryCommand:"0x36DB7495",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"30px",IsStretchedHorizontally:"true"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextDescription",Alt:"STR@l_AlternativeTextDescriptionCaption",LabelText:"STR@l_AlternativeTextDescriptionCaption",
Command:"0x61FE1E53",QueryCommand:"0x416A13E3",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"180px",IsStretchedHorizontally:"true",IsMultiline:"true"}}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"CropCollapsibleSection",Title:"STR@L_Crop"},children:[{name:"Section",attrs:{Id:"leftCropSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropTop",LabelText:"STR@L_Top",
For:"spnCropTop"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropBottom",LabelText:"STR@L_Bottom",For:"spnCropBottom"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropLeft",LabelText:"STR@L_Left",For:"spnCropLeft"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",
attrs:{Id:"lblCropRight",LabelText:"STR@L_Right",For:"spnCropRight"}}]}]}]},{name:"Section",attrs:{Id:"rightCropSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropTop",Alt:"STR@L_CropTopTooltip",Command:"0xDF8DEBBA",QueryCommand:"0xB9089B94",LabelledBy:"CropCollapsibleSection-Title lblCropTop-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",
Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropBottom",Alt:"STR@L_CropBottomTooltip",Command:"0x091D0734",QueryCommand:"0xA3D9079E",LabelledBy:"CropCollapsibleSection-Title lblCropBottom-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",
attrs:{Id:"spnCropLeft",Alt:"STR@L_CropLeftTooltip",Command:"0x2F92B28A",QueryCommand:"0x037C5130",LabelledBy:"CropCollapsibleSection-Title lblCropLeft-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropRight",Alt:"STR@L_CropRightTooltip",Command:"0x52A3310D",QueryCommand:"0x2AA307AB",LabelledBy:"CropCollapsibleSection-Title lblCropRight-Medium"},
children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"RotateCollapsibleSection",Title:"STR@L_Rotation"},children:[{name:"Section",attrs:{Id:"leftRotateSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblRotationAngle",LabelText:"STR@L_RotationAngle",For:"spnRotateAngle"}}]}]}]},{name:"Section",attrs:{Id:"rightRotateSection",
HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnRotateAngle",Alt:"STR@L_RotationSpinnerTooltip",Command:"0x97B9E874",QueryCommand:"0xD63D3722",LabelledBy:"RotateCollapsibleSection-Title lblRotationAngle-Medium"},children:[{name:"Unit",attrs:{UnitType:"degree",MinimumValue:"0",MaximumValue:"360",Step:"1"}}]}]}]}]}]}]}]}]}]},ws;(function(Q){Q[Q.CKp=0]="Healthy";Q[Q.yLp=1]="MissedScan";
Q[Q.KLp=2]="NeedsReset";Q[Q.jJp=3]="CriticalUnresponsive";Q[Q.aLp=4]="KickoutComponent"})(ws||(ws={}));Object(f.b)("TimerBasedWatchDogStatus",ws);class Ps{constructor(Q,Da,eb){this.YKd=this.mqh=this.qrh=this.k5b=this.tGa=0;this.Wcj=3;this.TYd=3E4;this.Gac=Q;this.RBb=Da;this.NJi=eb}zDa(){this.tGa=0}async EKn(){const Q=Date.now(),Da=this.Gac.ypc;this.YKd++;if(this.mqh==Da&&this.P1o(Q,this.qrh))return{["WatchDogScanTime"]:Q,["LastComponentScanTime"]:Da,["ComponentStatus"]:ws[this.k5b],["ActionTaken"]:"None. Skipping to Match Interval"};
this.mqh=Da;this.qrh=Q;this.RBb=this.Gac.Bai;this.k5b=this.hui(Q,Da);3===this.k5b&&(await this.kop(),this.k5b=this.hui(Q,this.Gac.ypc));return this.W2k(this.k5b,Q,Da)}rrn(){return 0===this.k5b}hui(Q,Da){let eb=0;Q>Da+Math.max(this.RBb,this.TYd)+this.NJi&&(eb=0===this.tGa?1:this.tGa<this.Wcj?2:this.tGa===this.Wcj?3:4);return eb}W2k(Q,Da,eb){const Tb={};Tb.WatchDogScanNumber=this.YKd;Tb.WatchDogScanTime=Da;Tb.LastComponentScanTime=eb;Tb.ComponentStatus=ws[Q];Tb.ExpectedComponentScanInterval=this.RBb;
Tb.GraceTimeInMS=this.NJi;Tb.ActualTimeBetweenWatchDogAndComponentScans=Da-eb;switch(Q){case 0:Tb.ActionTaken="None";this.tGa=0;break;case 1:this.tGa++;Tb.ActionTaken="Missed Scan, Wait to Restart component";break;case 2:this.tGa++;Tb.ActionTaken="Component restarted";Ca.ULS.sendTraceTag(509686347,3037,20,"Restarting Component with interval {0}",this.RBb);this.Gac.zWj();this.Gac.GVj(Math.min(this.RBb,this.TYd/2));break;case 3:this.tGa++;Tb["ActionTaken?"]="Attempted Synchronous run: "+ws[Q];break;
case 4:Ca.ULS.sendTraceTag(512570578,3037,15,"Component is not Responding. WatchDog would kickout now"),Tb["ActionTaken?"]="Kickout",Tb.ShouldKickout=!0,this.tGa++}Tb.NextExpectedComponentScanTimeInMs=eb+(this.tGa+1)*this.RBb;Tb.MissedScans=this.tGa;return Tb}async kop(){return this.Gac.qpi()}P1o(Q,Da){return Da+this.RBb>Q}}Object(f.a)(Ps,"TimerBasedWatchDog",null,[1546]);class Qs{constructor(Q,Da,eb,Tb,Ac,hd,Ud,Ee){this.TY=null;this.NMc=this.Uia=0;this.YEb=new Date(Date.UTC(0,1,1,0,0));this.xK={};
this.gOc=this.fOc=0;this.u0h=async()=>{var Me;Ca.ULS.sendTraceTag(509372107,3038,50,"Running RunawayDataLossMonitor task. Run count: {0}",this.fOc++);if(this.tf.Do)this.Lkd(),this.stop(),Ca.ULS.sendTraceTag(522818053,3038,50,"The application kicked out. RSNManager was tracking {0} unsavedRevision(s) ",this.Tx.l0a);else{this.YEb=new Date;var Kf={};Kf.DocxSaveMonitor_IsUpToDate=null===(Me=this.TY)||void 0===Me?void 0:Me.AU;Kf.RSNManager_IsUpToDate=this.Tx.AU;Kf.RSNManager_CountRevisionsWithOutServerRevisionSequenceNumbers=
this.Tx.ffc();Kf.RSNManager_CountRevisionsWithServerRevisionSequenceNumbers=this.Tx.nXd();Ca.ULS.sendTraceTag(521413850,3038,50,"Logging IsUpToDate state for RSNManager and DocxSaveMonitor : {0}",Kf);if(this.tk&&!this.tk.isVisible)Ca.ULS.sendTraceTag(524154191,3038,50,"App is hidden. RSNManager is tracking {0} unsavedRevision(s)",this.Tx.l0a),this.kbo();else if(Me=this.Tx.yWc(this.VKd),0<Me){Me=this.Zri(Me);Ca.ULS.sendTraceTag(526192649,3038,15,JSON.stringify(Me));this.EQl&&Ca.ULS.sendTraceTag(524158796,
3038,15,"Diagnostic Log :{0}",this.ZC());if(0==this.Uia)this.NMc=this.ypc;else if(1<this.Uia){Ca.ULS.sendTraceTag(524137233,3038,15,"StaleRevision(s) persist for more than {0} scans and {1} ms",this.Uia,this.ypc-this.NMc);if(this.ocn&&(!await this.Tx.U9d(this.QVm)||0===this.Tx.yWc(this.VKd))){this.Lkd();return}this.Iaj(Me,this.ypc);this.xK.ShouldKickout&&(Ca.ULS.sendTraceTag(523547595,3038,50,JSON.stringify(this.xK)),this.C1.JTb(this.Ium()))}this.Uia++}else this.Lkd(),this.qnl()}};this.v0h=async()=>
{await this.u0h();this.NVj()};this.Tx=Q;this.tf=Da;this.C1=Ud;this.oKk=Ee;this.TBh=Tb;this.VKd=Ac;this.JJk=hd;this.TY=La.a.instance.Oa(434);this.xK.ShouldKickout=!1;this.vjg=this.D8n;this.wrj=this.E8n;eb.execute(Me=>{this.tk=Me});this.tf.Oya(this.SU.bind(this))}get ypc(){return this.YEb.getTime()}Zri(Q){return{["NumberOfStaleRevisions"]:Q,["BrowserIsOnline"]:Yl.a[this.tf.networkState],["NavigatorOnLine"]:window.navigator.onLine,["IsKickedOut"]:this.tf.Do,["IsSessionExpired"]:this.tf.dba,["IsSessionLost"]:this.tf.Snc,
["HasEmergencyViewDeployed"]:this.tf.Hk,["IsVisible"]:window.document.visibilityState,["HasFocus"]:document.hasFocus(),["VisibilityManager_AppVisibilityState"]:this.tk?Og.a[this.tk.uA]:"undefined"}}SU(Q,Da){if(Da){Q=Date.now();var eb=this.Tx.yWc(this.VKd);0<eb&&(eb=this.Zri(eb),this.Iaj(eb,Q));this.PGo();this.hBn(Da.errorCode)}this.stop();this.TY=La.a.instance.Oa(434)}qnl(){this.Tx.f$d(this.JJk)&&this.uqp()}uqp(){Ca.ULS.sendTraceTag(520663501,3038,15,"Cancelling all blocked operations in server replication scheduler.");
this.oKk.wmf();Xi.a.ZDf(cm.a.DGo)}Ium(){return this.jon?Mk.a.bFp:this.tf.dba?Mk.a.Bak:Mk.a.aFp}stop(){0!==this.gOc&&(window.clearInterval(this.gOc),this.gOc=0);Ca.ULS.sendTraceTag(509215701,3038,50,"Stopping RDLM task")}async qpi(){this.iPp&&this.stop();this.v0h();Ca.ULS.sendTraceTag(509101133,3038,50,"RDLM running Synchronously")}e$o(Q){this.gOc=window.setTimeout(this.v0h,Q);Ca.ULS.sendTraceTag(509162245,3038,50,"Running RDLM Once");this.Lkd()}NVj(){this.gOc=window.setInterval(this.u0h,this.TBh);
Ca.ULS.sendTraceTag(509215700,3038,50,"Starting RDLM task");this.Lkd()}PGo(){this.kqi(this.xK);Ca.ULS.sendTraceTag(523114659,3038,50,JSON.stringify(this.xK))}get hHj(){const Q=Object.assign({},this.xK);this.kqi(Q);return Q}kqi(Q){Q.shouldKickout||(0==this.Tx.yWc(this.VKd)?(Q.NoKickoutReason="No Stale Revisions",Q.OldestRevisionCreationTime=this.Tx.fjc()):this.tk&&!this.tk.isVisible?(Q.NoKickoutReason="Session not active",Q.VisibilityManager_AppVisibilityState=this.tk.uA):this.x0i&&this.Uia<=this.wrj?
(Q.NoKickoutReason="Persistent Runaway dataloss does not exceed minimum threshold",Q.ScansWithPersistentRunawayDataLoss=this.Uia):this.Uia<=this.vjg?(Q.NoKickoutReason="Persistent Runaway dataloss does not exceed maximum threshold",Q.ScansWithPersistentRunawayDataLoss=this.Uia):Q.NoKickoutReason="undefined");Q.LastScanTime=this.YEb.toISOString();Q.RunCounter=this.fOc}ZC(){const Q={};this.TY&&(Q.DSM=this.TY.ZC());this.Tx&&(Q.RSN=this.Tx.ZC());return Q}Lkd(){Ca.ULS.sendTraceTag(509215699,3038,50,"Resetting RDLM scans and timer. Previous persistent runaway dataloss scan count: {0}, Previous runaway dataloss timer: {1}",
this.Uia,this.NMc);this.NMc=this.Uia=0}kbo(){this.Uia=Math.min(this.vjg-1,this.Uia);this.NMc=Date.now()}x0i(){return 0===this.tk.uA&&this.tf.WA&&!this.tf.Snc&&!this.tf.dba&&!this.tf.Hk}Iaj(Q,Da){this.Uia>this.wrj&&this.x0i()?this.xK.ShouldKickout||(this.xK.ShouldKickout=!0,this.lqi("Persistent RunawayDataLoss detected in active session",Da,Q)):this.Uia>this.vjg&&!this.xK.ShouldKickout&&(this.xK.ShouldKickout=!0,this.lqi("Runaway DataLoss persists for more than 3 minutes.",Da,Q))}lqi(Q,Da,eb){this.xK.KickoutTime=
(new Date(Da)).toISOString();this.xK.KickoutReason=Q;this.xK.DSM_isUpToDate=this.TY?this.TY.AU:"Undefined";this.xK.SessionInfo=eb}hBn(Q){const Da=this.xK.ShouldKickout;ua.Health.instance.recordKpiUsage(Qs.fHe,1,Qs.E1d,null);const eb=new Map;Q&&eb.set("ErrorCode",Q.toString());Da?(eb.set("ShouldKickout","true"),eb.set("KickoutTime",this.xK.KickoutTime),eb.set("Reason",this.xK.KickoutReason),ua.Health.instance.recordKpiSuccess(Qs.fHe,Object.assign(new Jl.a,{extendedProperties:eb}))):(eb.set("ShouldKickout",
"false"),Q=this.xK.NoKickoutReason,eb.set("Reason",Q),ua.Health.instance.recordKpiFailure(Qs.fHe,Q,!1,!1,Object.assign(new Jl.a,{extendedProperties:eb})))}zWj(){Ca.ULS.sendTraceTag(509686349,3037,50,"RunawayDataLossMonitor stopped");this.stop()}GVj(Q){Ca.ULS.sendTraceTag(509686348,3037,50,"RunawayDataLossMonitor started with interval {0}",Q);this.e$o(Q)}get EQl(){return null!=this.VTg?this.VTg:this.VTg=m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DiagnosticLoggingForRunawayDatalossMonitorIsEnabled",
!0)}get QVm(){return null!=this.QWg?this.QWg:this.QWg=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.RDLMHasDataLossTimeOutInMs",3E3):3E3}get ocn(){return null!=this.lZg?this.lZg:this.lZg=m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckForHasDataLossIsEnabled",!0)}get E8n(){return null!=this.L1g?this.L1g:this.L1g=m.AFrameworkApplication.J.ic("RunawayDataLossMinimumScansBeforeKickout",1)}get D8n(){return null!=this.K1g?
this.K1g:this.K1g=m.AFrameworkApplication.J.ic("RunawayDataLossMaximumScansBeforeKickout",5)}get jon(){return 1===this.tf.networkState||3===this.tf.networkState}get Bai(){return this.TBh}}Qs.fHe="RunAwayDataLossKickout";Qs.E1d="wwrelfc";Object(f.a)(Qs,"RunawayDataLossMonitor",null,[1244,1245]);class Rs{constructor(){this.Pch=3E4;this.Qqk=24E4;this.Rqk=12E4;this.W=this.WKd=null}get name(){return 441}init(){if(Ri.a.yt||Ri.a.hn)this.WKd=this.W.resolve(this.name),this.WKd.NVj(),this.W.resolve(1288),0==
m.AFrameworkApplication.gh.RunawayDatalossSystemStartedAt&&m.AFrameworkApplication.gh.Saj()}uHl(){return new Qs(this.W.resolve(436),this.W.resolve(117)||Ce.SessionStatusManager.instance,this.W.Ra(103),m.AFrameworkApplication.J.ic("RunawayDataLossScanIntervalInMs",this.Pch),this.cHo,this.Rqk,La.a.instance.Oa(453),Pm.WoncaApp.WF)}uc(Q){if(Ri.a.yt||Ri.a.hn)this.W=Q,Q.ia(this.name,this.uHl.bind(this)).as("WordEditor.IRunawayDataLossMonitor").ha(),this.yqg()}dispose(){this.WKd&&this.WKd.stop()}static main(){C.a.instance.Lc(new Rs)}yqg(){this.W.ia(1288,
()=>new Ps(this.W.resolve(this.name),m.AFrameworkApplication.J.ic("RunawayDataLossScanIntervalInMs",this.Pch),m.AFrameworkApplication.J.ic("TimerBasedWatchDogGracePeriodInMs",18E4))).ha()}get cHo(){return m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.RunawayDataLossKickoutIntervalInMs",this.dHo)}get dHo(){return m.AFrameworkApplication.J.ic("RunawayDataLossKickoutIntervalInMs",this.Qqk)}}Object(f.a)(Rs,"WordEditorRunawayDataLossMonitorPackage",null,[0,1]);class gw{constructor(Q,
Da){this.oJk=Q;this.pJk=Da}}Object(f.a)(gw,"LastSavedToHostDetailsEventArgs",null,[1276]);class Nt{constructor(Q,Da,eb,Tb,Ac,hd,Ud){this.tOk=5E4;this.C$e=0;this.YEb=new Date(Date.UTC(0,1,1,0,0));this.vqk=6E4;this.fOc=this.o8b=0;this.sa=new W.a;this.tMo=()=>{Ca.ULS.sendTraceTag(509372108,3037,50,"Running LastSavedToHostDetailsManager task.  Run count: {0}",this.fOc++);this.tf.Do||this.oic().then(Ee=>{this.sa.raiseEvent(Nt.h4i,Ee);this.erh=new Date;Ee=this.pac;this.tk&&!this.tk.isVisible&&(Ee=this.PMk);
this.FEa(Ee)}).catch(Ee=>{this.FEa(this.TLm(Ee))})};this.iMd=Q;this.tf=eb;this.BH=Ac;this.Tx=hd;this.pac=Da.ic("LastSavedToHostDetailsIntervalMs",6E4);this.eDb=Da.ic("LastSavedToHostDetailsFailureIntervalMs",5E3);this.PMk=Da.ic("LastSavedToHostDetailsSuccessIntervalOnHidden",this.pac);this.IOc=Da.ic("LastSavedToHostDetailsSentTimeoutMs",12E4);this.t4e=Da.ic("Microsoft.Office.WordOnline.LastSavedToHostDetailsQueueTimeoutMs",3E4);this.erh=new Date;Tb.execute(Ee=>{this.tk=Ee;this.tk.IHa((Me,Kf)=>{this.A_(Kf)})});
this.Gf=Ud;0==m.AFrameworkApplication.gh.RunawayDatalossSystemStartedAt&&m.AFrameworkApplication.gh.Saj();this.FEa(this.pac)}A_(Q){0!==Q.newState&&1!==Q.newState||0===Q.oldState||1===Q.oldState||this.tf.Do||(this.FEa(this.C$e),Ca.ULS.sendTraceTag(521412808,3037,50,"LastSavedToHostDetails Pending since {0}, The next tick of LastSavedToHostDetails will be in {1} ms",this.erh,this.C$e))}pta(){return 1==this.tf.networkState}oic(){this.YEb=new Date;return new Promise((Q,Da)=>{if(this.pta())Ca.ULS.sendTraceTag(525214230,
3037,15,"Network is offline. Not Attempting to send request."),Da(0);else if(this.tf.dba)Ca.ULS.sendTraceTag(524154146,3037,15,"Waiting for token to refresh. Not attempting to send request."),Da(2);else if(this.Tx.AU)Ca.ULS.sendTraceTag(509641685,3037,50,"Session is up to date. Not attempting to send request."),Da(3);else{var eb=qo.b(El.construct(this.Ckc())),Tb={"Content-Type":"application/json; charset=utf-8"};Ca.ULS.sendTraceTag(524154147,3037,50,"Sending LastSavedToHostDetails Request");if(this.W1o)Ri.a.Xyc.kt({url:Nt.serviceUrl,
method:"POST",body:eb,headers:Tb,Xvc:this.IOc,UWf:!0}).then(hd=>{this.feo(hd,Q,Da)}).catch(()=>{Da(0)});else if(this.X1o){var Ac=0;Ac=this.Gf.Wj(Nt.serviceUrl,2,eb,Tb,!1,0,hd=>this.i4i(hd,Q,Da),hd=>this.j4i(hd,Da),null,null,!1,this.t4e,this.IOc,null,null,!0);0>=Ac&&(Ca.ULS.sendTraceTag(525214231,3037,15,"Invalid request id returned "+Ac.toString()),Da(0))}else Ac=0,Ac=this.iMd.Wj(Nt.serviceUrl,2,eb,Tb,!1,0,hd=>this.i4i(hd,Q,Da),hd=>this.j4i(hd,Da),null,null,!0,this.IOc),0>=Ac&&(Ca.ULS.sendTraceTag(508650827,
3037,15,"Invalid request id returned "+Ac.toString()),Da(0))}})}feo(Q,Da,eb){const Tb={},Ac=Q.headers.get(Xk.a.s2);Tb.HttpStatus=Q.status;Tb.Correlation=Ac;Ca.ULS.sendTraceTag(508650831,3037,50,"LastSavedRevisionID Response Summary: {0}",Tb);Q.ok?Q.text().then(hd=>{hd=this.AUa(hd);hd||(Ca.ULS.sendTraceTag(508650829,3037,15,"LastSavedRevisionResponse is null"),eb(2));this.BH.cPa(hd);Da(new gw(hd.LastSavedRevisionId,hd.RevisionSequenceNumber))}).catch(hd=>{Ca.ULS.sendTraceTag(508650828,3037,15,"Failed to parse LastSavedRevisionResponse. Exception: {0}",
hd.toString());eb(2)}):(Ca.ULS.sendTraceTag(508650830,3037,15,"LastSavedRevisionResponse failed with status code: {0}",Q.status),Q.status===ki.a.g8?eb(1):Q.status===ki.a.bxb?eb(0):eb(2))}j4i(Q,Da){let eb=2;if(Q=Q.data){if(5===Q.status)eb=1;else if(7===Q.status||13===Q.status)eb=this.MZo?0:1;Ca.ULS.sendTraceTag(525214232,3037,15,String.format("Request Failed with status {0}. Failed getting LastSavedToHostDetails",Q.status))}else Ca.ULS.sendTraceTag(525214233,3037,15,"Failed to get LastSavedToHostDetails");
Da(eb)}i4i(Q,Da,eb){if(Q=Q.data){var Tb={},Ac=Q.vi?Q.vi[Xk.a.s2]:"";Tb.HttpStatus=Q.Ie;Tb.Correlation=Ac;Tb.Id=Q.id;Ca.ULS.sendTraceTag(525214235,3037,50,"LastSavedRevisionID Response Summary: {0}",Tb);(Q=this.AUa(Q.De))?(this.BH.cPa(Q),Da(new gw(Q.LastSavedRevisionId,Q.RevisionSequenceNumber))):(Ca.ULS.sendTraceTag(525214237,3037,15,"Deserialized response is null"),eb(2))}else Ca.ULS.sendTraceTag(525214234,3037,15,"Request succeeded with null item."),eb(2)}FEa(Q){0!==this.o8b&&window.clearTimeout(this.o8b);
this.o8b=window.setTimeout(this.tMo,Q);Ca.ULS.sendTraceTag(525100416,3037,50,"LastSavedToHostDetails request queued with timeout "+Q)}Ckc(){const Q=ld.StaticActiveAppFrame.za().kb.Jc;return Q?Q.od:null}TLm(Q){return 1===Q?this.C$e:0===Q?this.tOk:3===Q?this.pac:this.eDb}AUa(Q){let Da;return({group:Da}=Fo.a.z4(Q)).returnValue?Da.Responses[0]:null}p0k(Q){this.sa.addHandler(Nt.h4i,Q)}async qpi(){const Q=new Promise((Da,eb)=>{window.setTimeout(eb,3E3)});await Promise.race([Q,this.oic()]).then(()=>{Ca.ULS.sendTraceTag(509100305,
3038,50,"LSTHDM ran Synchronously: Success")}).catch(()=>{Ca.ULS.sendTraceTag(509100304,3038,15,"LSTHDM ran Synchronously: Failure")})}zWj(){0!==this.o8b&&(Ca.ULS.sendTraceTag(509215702,3037,50,"LastSavedToHostDetails Stopped"),window.clearTimeout(this.o8b),this.o8b=0)}GVj(Q){Ca.ULS.sendTraceTag(509686350,3037,50,"LastSavedToHostDetails started with interval {0}",Q);this.FEa(Q)}get ypc(){return this.YEb.getTime()}get Bai(){return this.vqk}ZC(){const Q={};Q.LastScanTime=this.YEb.toISOString();Q.RunCounter=
this.fOc;return Q}get MZo(){return null!=this.C2g?this.C2g:this.C2g=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldDelayOnTimeout",!1):!1}get W1o(){return null!=this.H2g?this.H2g:this.H2g=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.UseCRMV2",!1):!1}get X1o(){return null!=this.I2g?this.I2g:this.I2g=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.SwitchToClientRequestManager",
!1):!1}}Nt.h4i="ULSTHD";Nt.serviceUrl=Ri.a.webServiceBase+"OneNote.ashx?perfTag=LastSavedToHostDetailsRequest";Object(f.a)(Nt,"LastSavedToHostDetailsManager",null,[1246,1245]);class Nm{constructor(Q,Da,eb){this.PWm=Q;this.DDa=Da;this.Ttn=eb;this.ajg=()=>{const Tb=this.PWm();return 32!==Tb?Tb:!this.DDa||this.DDa.AU?32:8};this.xup=(Tb,Ac,hd,Ud,Ee)=>{this.Ttn.FEa(parseInt(Ee.toString()));return 32}}Xb(Q){Q.qa(hg.a.ajg,Uc.a.view,this.ajg);Q.qa(hg.a.k5j,Uc.a.view,this.xup);Q.Pc(hg.a.k5j,101)}}Object(f.a)(Nm,
"LastSavedToHostDetailsManagerActor",null,[]);class Ey{constructor(){this.W=null}get name(){return"WordEditor.LastSavedToHost"}uc(Q){const Da=m.AFrameworkApplication.J;this.W=Q;const eb=new Vg(m.AFrameworkApplication.userSessionId,m.AFrameworkApplication.Ee.Q0,m.AFrameworkApplication.Ee.UYd);this.W.ia(401,()=>new Nt(eb,Da,this.W.Oa(117)||Ce.SessionStatusManager.instance,this.W.Ra(103),yf.a.instance,this.W.resolve(436),m.AFrameworkApplication.Ee)).ha();this.yqg()}init(){(new Nm(()=>Pm.WoncaApp.WF.hMi(),
this.W.resolve(436),this.W.resolve(401))).Xb(m.AFrameworkApplication.va);this.W.resolve(401);this.W.resolve(1289)}dispose(){}static main(){C.a.instance.Lc(new Ey)}yqg(){this.W.ia(1289,()=>new Ps(this.W.resolve(401),m.AFrameworkApplication.J.ic("LastSavedToHostDetailsIntervalMs",6E4),m.AFrameworkApplication.J.ic("TimerBasedWatchDogGracePeriodInMs",18E4))).ha()}}Object(f.a)(Ey,"LastSavedToHostDetailsPackage",null,[0,1]);var Nl=d(1408),Zr=d(1463);class Ww{constructor(Q,Da,eb,Tb,Ac){this.Fzl=Q;this.Izl=
Da;this.S6a=eb;this.Ezl=Tb;this.appSettings=Ac;this.Nml=async()=>{const hd=Zr.b.fEa(),Ud=Promise.race([this.zWn(),new Promise(Ee=>setTimeout(()=>Ee(!1),5E3))]);Ca.ULS.sendTraceTag(508863558,3048,50,"Copilot Compose feature condition check took: {0}ms",hd.O_d);return Ud};this.zWn=async()=>{if(!this.Ufn||!this.Vbn)return!1;await this.yNg();return await this.Ezl.pUc()&&this.Fzl.pUc()&&await this.Izl.pUc()?!0:!1};this.tfn=new tb.a(this.Nml)}async isEnabled(){return this.tfn.value}get Ufn(){const Q=this.S6a.isInsertActionEnabled,
Da=this.S6a.isRewriteActionEnabled,eb=this.S6a.isVisualizeAsTableEnabled;return this.S6a.isStartActionEnabled||Q||Da||eb}get Vbn(){return zb.a.uj?this.S6a.isFirefoxAllowed:!0}async yNg(){return new Promise(Q=>{this.appSettings.Uo(()=>{Q(!0)})})}}Object(f.a)(Ww,"CopilotComposeFeatureCondition",null,[]);class su{constructor(Q){this.wed=async()=>{const Da=await this.Y5i.value;await this.Q6c(Da);return Da};this.n4n=C.a.instance;this.Y5i=new tb.a(Q);this.I4m=new tb.a(this.wed)}async N6(){await this.Y5i.value}async MZc(){return await this.I4m.value}async Q6c(Q){C.a.instance.Lc(Q);
return new Promise(Da=>{this.n4n.registerOnPackageInit(Q.name,Da)})}}Object(f.a)(su,"LazyLoadedPackage",null,[]);var xs=d(2141),to=d(2105);const Qu=new su(()=>Promise.all([d.e(4),d.e(2),d.e(11)]).then(d.bind(null,2125)).then(Q=>Q.instance));class mr{constructor(Q,Da){this.pEp=Q;this.logger=Da;this.wed=async()=>{await this.logger.measureActivityPerformanceAsync(this.txf,{name:"Initialize",dataFields:[...Object(to.a)(xs.a.getFields({featureName:"CopilotCompose",Hmf:xs.a.nBc.ContentGeneration,Ihc:xs.a.Ufb.IsEnabled,
isUserInitiated:!1}))]})};this.txf=async()=>{await Promise.all([Qu.N6(),this.pEp.loadChunk("copilotComposeUx")]);await Qu.MZc()}}initialize(){this.wed().catch(Q=>{Ca.ULS.cA(508913495,3048,10,Q,"Failed to initialize CopilotCompose")})}}Object(f.a)(mr,"CopilotComposeInitializer",null,[]);const Hr="CH DE FR EU UK NO SE NL PIE".split(" "),Fy=["Exchange Online Consumer","OneDriveWOPI"];class gi{constructor(Q){this.S6a=Q}pUc(){var Q,Da,eb,Tb,Ac;if(this.S6a.isBypassDatacenterConditionEnabled)return!0;const hd=
null!==(Da=null===(Q=m.AFrameworkApplication.sessionStartInfoSettings)||void 0===Q?void 0:Q.WACDatacenter)&&void 0!==Da?Da:"unknown";Q=null!==(Tb=null===(eb=m.AFrameworkApplication.sessionStartInfoSettings)||void 0===eb?void 0:eb.Ring)&&void 0!==Tb?Tb:"unknown";eb=null===(Ac=m.AFrameworkApplication.sessionStartInfoSettings)||void 0===Ac?void 0:Ac.Host;return this.Oan(hd,Q,eb)}Oan(Q,Da,eb){if("1"===Da||"unknown"===Q||Fy.includes(eb))return!0;const Tb=Q.toUpperCase();return!Hr.some(Ac=>Tb.includes(Ac))}}
Object(f.a)(gi,"CopilotComposeDatacenterCondition",null,[]);class MA{constructor(Q,Da){this.appSettings=Q;this.Y4k=Da;this.W2f="Copilot";this.agl="Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped";this.c4n="Microsoft.Office.WordOnline.CopilotLicensePaywallNoPassOverrideEnabled"}async pUc(){const Q=await this.lnl();Ca.ULS.sendTraceTag(508859584,3048,50,"License check result: {0}",Q);return 1===Q||0===Q}async lnl(){if(this.Fil())return 0;const Q=Zr.b.fEa(),Da=await this.lRf();Ca.ULS.sendTraceTag(508863556,
3048,50,"License check took: {0}ms",Q.O_d);return Da?this.n0o()?3:1:2}Fil(){return this.appSettings.getBooleanFeatureGate(this.agl,!1)}n0o(){return this.appSettings.getBooleanFeatureGate(this.c4n,!1)}async lRf(){return(await Object(Dk.c)(this.Y4k)).isFeatureEnabled(this.W2f,!1)}}Object(f.a)(MA,"CopilotComposeLicenseCondition",null,[]);class Sk{constructor(Q){this.appSettings=Q}get isStartActionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsStartActionEnabled",
!1)}get isInsertActionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsInsertActionEnabled",!1)}get isRewriteActionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsRewriteActionEnabled",!1)}get isStreamingEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsStreamingEnabled",!1)}get isAutoOpenOnStartEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsAutoOpenOnStartEnabled",
!1)}get isNonEmptyStartEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsNonEmptyStartEnabled",!1)}get isCiqEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCopilotComposeCiqEnabled",!1)}get isCiqMultilingualEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsCiqMultilingualEnabled",!1)}get isCopilotPluginsEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.isCopilotPluginsEnabled",
!1)}get isTableRenderingEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.Augloop.CopilotCompose.isTableRenderingEnabled",!1)}get isStylizedTableRenderingEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.isStylizedTableRenderingEnabled",!1)}get isGranularStreamingEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsGranularStreamingEnabled",!1)}get streamingWordsPerSecond(){return this.appSettings.getIntFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.StreamingWordsPerSecond",
0)}get isFirefoxAllowed(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsFirefoxAllowed",!1)}get streamingChunkGenerationTimeoutMs(){return this.appSettings.getIntFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.StreamingChunkGenerationTimeoutMs",2E4)}get isAdminControlEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCopilotAdminControlEnabled",!1)}get isBypassDatacenterConditionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.BypassDatacenterCondition",
!1)}get isFeedbackSdkEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.FeedbackSdkEnabled",!1)}get isSupportedLanguagesLinkEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsSupportedLanguagesLinkEnabled",!1)}get isAutoAcceptFixEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsAutoAcceptFixEnabled",!1)}get isMultiTurnEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsMultiTurnEnabled",
!1)}get isProactiveSurveysEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsProactiveSurveysEnabled",!1)}get isRewriteV2Enabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsRewriteStreamingWorkflowEnabled",!1)}get isMultiTurnExpandedInputEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsMultiTurnExpandedInputEnabled",!1)}get isDesignerSuggestionsSuppressionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsDesignerSuggestionsSuppressionEnabled",
!1)}get isSetParagraphLanguageEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsSetParagraphLanguageEnabled",!1)}get isWrongIntentUnhighlightEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsWrongIntentUnhighlightEnabled",!0)}get isDynamicAnchoringEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsDynamicAnchoringEnabled",!1)}get isVisualizeAsTableEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsVisualizeAsTableEnabled",
!1)}get isNewLineAutoAcceptFixEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsNewLineAutoAcceptFixEnabled",!0)}get isUneditedGenerateEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsUneditedGenerateEnabled",!0)}get isRewriteMultiParagraphEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsRewriteMultiParagraphEnabled",!1)}get isPromptAssistanceEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsPromptAssistanceEnabled",
!1)}get aiRewriteStreamingChunkGenerationTimeoutMs(){return this.appSettings.getIntFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.AiRewriteStreamingChunkGenerationTimeoutMs",6E4)}}Object(f.a)(Sk,"CopilotComposeFeatureGatesImpl",null,[]);class Bv{constructor(Q,Da){this.cVc=Q;this.S6a=Da}async pUc(){if(!this.S6a.isAdminControlEnabled)return!0;const Q=Zr.b.fEa();try{return!await (await Object(Dk.c)(this.cVc)).qL("CopilotContentGeneration",!0)}finally{Ca.ULS.sendTraceTag(508651538,3048,50,"Admin policy check took: {0}ms",
Q.O_d)}}}Object(f.a)(Bv,"CopilotComposeAdminPolicyCondition",null,[]);class Ir extends Nl.a{constructor(){super(...arguments);this.name="WordEditor.Copilot.ComposeEntry"}GUa(Q){Q.ia(1292,()=>new Zr.a(Q.resolve(1290),"CopilotCompose")).ha()}IUa(){const Q=La.a.instance;(new mr(Q.resolve(1291),Q.resolve(1292))).initialize()}HUa(){}static main(){Ir.hlm().isEnabled().then(Q=>{Q&&C.a.instance.Lc(new Ir)}).catch(()=>{Ca.ULS.sendTraceTag(508859807,3048,10,"Feature condition check for Copilot Compose failed with error")})}static hlm(){const Q=
La.a.instance;Q.ia(1294,()=>new gi(Q.resolve(1293))).ha();Q.ia(1293,()=>new Sk(m.AFrameworkApplication.J)).ha();Q.ia(1295,()=>new MA(m.AFrameworkApplication.J,Q.Ra(4))).ha();Q.ia(1296,()=>new Bv(Q.Ra(84),Q.resolve(1293))).ha();Q.ia(689,()=>new Ww(Q.resolve(1294),Q.resolve(1295),Q.resolve(1293),Q.resolve(1296),m.AFrameworkApplication.J)).ha();return Q.resolve(689)}}Object(f.a)(Ir,"CopilotComposeEntryPackage",Nl.a,[]);var Em=d(1411);class dq extends Em.a{constructor(Q){var Da;super("BooleanFeatureGateConditionId");
this.Hs=Q.Hs;this.w_c=Q.w_c;this.defaultValue=null!==(Da=Q.defaultValue)&&void 0!==Da?Da:!1}initialize(){super.initialize();const Q=m.AFrameworkApplication.J;Q.Uo(()=>{const Da=Q.getBooleanFeatureGate(this.w_c,this.defaultValue);this.Sh(Da)})}Sh(Q){super.Sh(Q);Ca.ULS.sendTraceTag(512369937,3028,50,this.v2(this.Hs,Q,`featureGate=${this.w_c}`))}}Object(f.a)(dq,"BooleanFeatureGateCondition",Em.a,[]);class tu extends Em.a{constructor(Q){var Da;super("DocumentOwnerConditionId");this.Hs=Q.Hs;this.JAg=null!==
(Da=Q.JAg)&&void 0!==Da?Da:!0}initialize(){super.initialize();const Q=m.AFrameworkApplication.J;Q.Uo(()=>{const Da=Q.$("IsDocumentOwner");this.Sh(Da===this.JAg)})}Sh(Q){super.Sh(Q);Ca.ULS.sendTraceTag(508958623,3028,50,this.v2(this.Hs,Q))}}Object(f.a)(tu,"DocumentOwnerCondition",Em.a,[]);var wt=d(1374);class eq extends wt.a{constructor(Q,Da,eb){super("LicensePaywallCondition");this.Tac=Q.Hs;this.ltk=Q.H3l;this.Ga=Da;this.pu=eb}initialize(){super.initialize();this.Lzl()}Vd(){super.Vd()}Lzl(){this.Ga.Uo(()=>
{!this.Ga.$("IsAnonymousUser")&&this.pu?this.pu.execute(Q=>{this.kZe=Date.now();Q.isFeatureEnabled(this.ltk,!1).then(Da=>{this.kZe=Date.now()-this.kZe;this.Sh(Da)})}):this.Sh(!1)})}Sh(Q){super.Sh(Q);Ca.ULS.sendTraceTag(508884163,3028,50,this.v2(this.Tac,Q,"Latency for license check: "+this.kZe.toString()+"ms"))}}Object(f.a)(eq,"LicensePaywallCondition",wt.a,[]);var Ti=d(1735),nr=d(1448);class Ru extends nr.a{constructor(Q){super(23,Q,null,3028,"SkittleInitializationTriggered")}}Object(f.a)(Ru,"SkittleInitializationTriggerModel",
nr.a,[]);var of=d(529);class Gn{constructor(){this.qga=(Q,Da)=>{Da.succeeded||Ca.ULS.sendTraceTag(508618435,3049,10,"Async loading of skittle module failed")}}o5m(Q){const Da=of.a.Instance().RPb().Qqb("WordEditor.Skittles");Da.Onc()||this.Xxn(Q).then(()=>{Da.bqc(this.qga)}).catch(()=>{Ca.ULS.sendTraceTag(508618436,3049,10,"Async loading of skittle ux chunk failed")})}async Xxn(Q){return m.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("copilotSummarySkittleUx"):(await Object(Dk.c)(Q)).JD.loadScript("copilotSummarySkittleUx")}}
Object(f.a)(Gn,"SkittlesProxyConsumerImpl",null,[1317]);class cn{static BIm(){return new Gn}}Object(f.a)(cn,"SkittlesProxyConsumerFactory",null,[]);class on{constructor(Q,Da){this.rUj=Q;this.Qvg=Da;this.NUi=!1;this.dfd=async(eb,Tb)=>{if(Tb.mha){Object(ce.a)("SkittleInitializationTriggered");for(const Ac of this.rUj)Ac.vDa(this.dfd),Ac.Vd();this.NUi||(this.NUi=!0,cn.BIm().o5m(this.Qvg))}}}initialize(){Ca.ULS.sendTraceTag(508621533,3049,50,"SkittleInitializer has begun initializing skittle trigger models");
for(const Q of this.rUj)Q.yqa(this.dfd),Q.initialize()}}Object(f.a)(on,"SkittleInitializer",null,[]);class Cv extends Nl.a{get name(){return"WordEditor.SkittleEntryPackage"}GUa(Q){this.container=Q}IUa(){const Q=new kb.a;if(m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotSummarySkittle",!1)){var Da=Q.push,eb=this.container,Tb=eb.resolve(1165);eb=eb.Ra(4);var Ac=new dq({Hs:24,w_c:"Microsoft.Office.WordOnline.CopilotSummarySkittle"});const hd=new dq({Hs:24,w_c:"Microsoft.Office.WordOnline.CopilotPaneEnabled"}),
Ud=new tu({Hs:24,JAg:!1});Ac=new kb.a([Ac,hd,Ud]);m.AFrameworkApplication.vd("fbc73697;a29b4114");m.AFrameworkApplication.J&&!m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped",!1)&&(eb=new eq({Hs:24,H3l:"Copilot"},m.AFrameworkApplication.J,eb),Ac.add(eb));m.AFrameworkApplication.vd("f5gia801;0f27g313");m.AFrameworkApplication.J&&!m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotSkittleSummaryGenerationSkipped",
!1)&&(Tb=new Ti.a({Hs:24},Tb),Ac.add(Tb));Da.call(Q,new Ru(Ac))}0!==Q.count&&(new on(Q,this.container.Ra(77))).initialize()}HUa(){}static main(){C.a.instance.Lc(new Cv)}}Object(f.a)(Cv,"SkittleEntryPackage",Nl.a,[]);Type.registerNamespace("B4RT");Type.registerNamespace("Box4.AccessibilityChecker");Type.registerNamespace("Box4.Symbols");Type.registerNamespace("WEDSM");Type.registerNamespace("WEFP");Type.registerNamespace("WETF");Type.registerNamespace("WEUCH");Type.registerNamespace("WordEditor.AccessibilityChecker");
Type.registerNamespace("WordEditor.CoauthSurveys");Type.registerNamespace("WordEditor.ComponentStateLogging");Type.registerNamespace("WordEditor.FirstRunExperience");Type.registerNamespace("WordEditor.FrameTiming");Type.registerNamespace("WordEditor.GraphMerge");Type.registerNamespace("WordEditor.InteractivePerfTaskPane");Type.registerNamespace("WordEditor.ModernFontPicker");Type.registerNamespace("WordEditor.PageBreak");Type.registerNamespace("WordEditor.Pagination");Type.registerNamespace("WordEditor.TellMe");
Type.registerNamespace("WordEditor.TrackChange");Type.registerNamespace("WordEditor.Zoom");bj.main();Type.registerNamespace("Common.App.AccessibilityChecker");Type.registerNamespace("Common.App.Assistance");G;Type.registerNamespace("CACPU");va.main();Type.registerNamespace("CAEventTimingMeter");qb.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");ib.main();Type.registerNamespace("Common.App.GestureInput");Ab.main();Type.registerNamespace("Common.App.GestureManager");mc.main();
Type.registerNamespace("Common.ModernFontPicker");null==m.AFrameworkApplication.J||m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableOfflineLogger",!1)||(Type.registerNamespace("Common.App.OfflineLogger"),C.a.instance.Lc(new me));Type.registerNamespace("Common.App.O365Shell");oc.main();Type.registerNamespace("Common.App.PhoneLink");we.main();Type.registerNamespace("Common.App.SensitiveLogging");$h.main();Type.registerNamespace("Common.App.Rename");C.a.instance.Lc(new ph,
7);Type.registerNamespace("Common.App.Rename.RenameExecutor");C.a.instance.Lc(new eh);Type.registerNamespace("Common.App.SaveAsToHost");ug.main();Type.registerNamespace("Common.App.SaveToCloudStorage");Pf.main();Type.registerNamespace("Common.App.SaveACopy");Ni.main();Type.registerNamespace("Common.App.SaveToSharePoint");ig.main();Type.registerNamespace("Common.App.SharedFilePicker");af.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");
Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");Type.registerNamespace("CATypingSpeedMeter");ec.main();fe;C.a.instance.Lc(new Qq);qp.main();ep;Rd.main();C.a.instance.Lc(new Go);ss.main();Ge.a.prototype.toString=og.a.prototype.toString;Hi.a.WJi=new Nh.a;C.a.instance.Lc(new ho);Dm.main();C.a.instance.Lc(new Dn);C.a.instance.Lc(new ri);C.a.instance.Lc(new yc);Wc.main();go.main();ij.main();Type.registerNamespace("NLRT");C.a.instance.Lc(new fc);Type.registerNamespace("Common.App.AccessibilitySettings");
K.main();Type.registerNamespace("Common.App.RibbonSettings");Qi.main();C.a.instance.Lc(new je);jk.main();Cv.main();Ir.main();Rs.main();Ey.main();window.EventTiming={EventTimingMeter:Hc,FrameTimingMeter:Tc}},2141:function(J,L,d){function m(u,v,E){return{name:u,dataType:0,value:v,classification:E?E:4}}function f(u,v,E,y,H){void 0===H&&(H=4);y&&u.push(m("".concat(v?v+"."+E:E),y,H))}function a(u,v,E,y){if("boolean"===typeof y){var H=u.push;v="".concat(v?v+"."+E:E);H.call(u,{name:v,dataType:1,value:y,
classification:4})}}d.d(L,"a",function(){return z});var l;(function(u){u.Web="Web";u.Desktop="Desktop";u.Universal="Universal";u.Mobile="Mobile";u.Win32="Win32";u.iOS="iOS";u.Android="Android"})(l||(l={}));var w;(function(u){u.Automation="Automation";u.Dogfood="Dogfood";u.Microsoft="Microsoft";u.Insiders="Insiders";u.Production="Production"})(w||(w={}));var z;(function(u){(function(v){v.IsEnabled="IsEnabled";v.IsSeen="IsSeen";v.IsTried="IsTried";v.IsKept="IsKept";v.IsRejected="IsRejected"})(u.Ufb||
(u.Ufb={}));(function(v){v.ContentGeneration="Content Generation";v.Commanding="Commanding";v.QAandSummaries="QA and Summaries";v.Collaboration="Collaboration";v.Suggestions="Suggestions"})(u.nBc||(u.nBc={}));(function(v){v.Chat="Chat";v.Canvas="Canvas"})(u.EntryPoint||(u.EntryPoint={}));u.getFields=function(v){var E=[];f(E,"Copilot","FeatureActionType",v.Ihc);a(E,"Copilot","IsUserInitiated",v.isUserInitiated);f(E,"Copilot","FeatureName",v.featureName);f(E,"Copilot","Capability",v.Hmf);a(E,"Copilot",
"IsThumbsUp",v.t0f);f(E,"Copilot","EntryPoint",v.entryPoint);E.push(m("zC.".concat("Copilot"),"Office.System.Copilot"));return E}})(z||(z={}));var x;(function(u){(function(v){v.Pillar="Pillar";v.Error="Error"})(u.EventType||(u.EventType={}));u.getFields=function(v){var E=[];f(E,"Asha","EventType",v.eventType);f(E,"Asha","Pillar",v.e9n);f(E,"Asha","Scenario",v.scenario);f(E,"Asha","Veto",v.KAc);f(E,"Asha","Error",v.error);a(E,"Asha","InStaging",v.inStaging);a(E,"Asha","IsSessionEndingError",v.isSessionEndingError);
a(E,"Asha","IsIntentional",v.isIntentional);a(E,"Asha","IsInternal",v.isInternal);E.push(m("zC.".concat("Asha"),"Office.System.Asha"));return E}})(x||(x={}))}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/22495436/wdjs/WordEditorDS.box4.dll2.js.map