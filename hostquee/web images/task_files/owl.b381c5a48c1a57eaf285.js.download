/*! For license information please see owl.b381c5a48c1a57eaf285.js.LICENSE.txt */
var Microsoft;(()=>{var e,n,t,i,o={3918:(e,n,t)=>{e.exports=t(8322)},6310:(e,n,t)=>{"use strict";var i=t(2274),o=t(365),r=t(9544),a=t(8270),u=t(1948),s=t(75),c=t(1964),l=t(9790),d=t(1157),f=t(1256);e.exports=function(e){return new Promise((function(n,t){var v,h=e.data,p=e.headers,m=e.responseType;function S(){e.cancelToken&&e.cancelToken.unsubscribe(v),e.signal&&e.signal.removeEventListener("abort",v)}i.isFormData(h)&&delete p["Content-Type"];var H=new XMLHttpRequest;if(e.auth){var w=e.auth.username||"",b=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";p.Authorization="Basic "+btoa(w+":"+b)}var g=u(e.baseURL,e.url);function I(){if(H){var i="getAllResponseHeaders"in H?s(H.getAllResponseHeaders()):null,r={data:m&&"text"!==m&&"json"!==m?H.response:H.responseText,status:H.status,statusText:H.statusText,headers:i,config:e,request:H};o((function(e){n(e),S()}),(function(e){t(e),S()}),r),H=null}}if(H.open(e.method.toUpperCase(),a(g,e.params,e.paramsSerializer),!0),H.timeout=e.timeout,"onloadend"in H?H.onloadend=I:H.onreadystatechange=function(){H&&4===H.readyState&&(0!==H.status||H.responseURL&&0===H.responseURL.indexOf("file:"))&&setTimeout(I)},H.onabort=function(){H&&(t(l("Request aborted",e,"ECONNABORTED",H)),H=null)},H.onerror=function(){t(l("Network Error",e,null,H)),H=null},H.ontimeout=function(){var n=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",i=e.transitional||d;e.timeoutErrorMessage&&(n=e.timeoutErrorMessage),t(l(n,e,i.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",H)),H=null},i.isStandardBrowserEnv()){var A=(e.withCredentials||c(g))&&e.xsrfCookieName?r.read(e.xsrfCookieName):void 0;A&&(p[e.xsrfHeaderName]=A)}"setRequestHeader"in H&&i.forEach(p,(function(e,n){void 0===h&&"content-type"===n.toLowerCase()?delete p[n]:H.setRequestHeader(n,e)})),i.isUndefined(e.withCredentials)||(H.withCredentials=!!e.withCredentials),m&&"json"!==m&&(H.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&H.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&H.upload&&H.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(v=function(e){H&&(t(!e||e&&e.type?new f("canceled"):e),H.abort(),H=null)},e.cancelToken&&e.cancelToken.subscribe(v),e.signal&&(e.signal.aborted?v():e.signal.addEventListener("abort",v))),h||(h=null),H.send(h)}))}},8322:(e,n,t)=>{"use strict";var i=t(2274),o=t(7670),r=t(6624),a=t(756),u=function e(n){var t=new r(n),u=o(r.prototype.request,t);return i.extend(u,r.prototype,t),i.extend(u,t),u.create=function(t){return e(a(n,t))},u}(t(8125));u.Axios=r,u.Cancel=t(1256),u.CancelToken=t(9881),u.isCancel=t(8999),u.VERSION=t(4856).version,u.all=function(e){return Promise.all(e)},u.spread=t(5606),u.isAxiosError=t(2842),e.exports=u,e.exports.default=u},1256:e=>{"use strict";function n(e){this.message=e}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,e.exports=n},9881:(e,n,t)=>{"use strict";var i=t(1256);function o(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var n;this.promise=new Promise((function(e){n=e}));var t=this;this.promise.then((function(e){if(t.H){var n,i=t.H.length;for(n=0;n<i;n++)t.H[n](e);t.H=null}})),this.promise.then=function(e){var n,i=new Promise((function(e){t.subscribe(e),n=e})).then(e);return i.cancel=function(){t.unsubscribe(n)},i},e((function(e){t.reason||(t.reason=new i(e),n(t.reason))}))}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.prototype.subscribe=function(e){this.reason?e(this.reason):this.H?this.H.push(e):this.H=[e]},o.prototype.unsubscribe=function(e){if(this.H){var n=this.H.indexOf(e);-1!==n&&this.H.splice(n,1)}},o.source=function(){var e;return{token:new o((function(n){e=n})),cancel:e}},e.exports=o},8999:e=>{"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},6624:(e,n,t)=>{"use strict";var i=t(2274),o=t(8270),r=t(2974),a=t(7490),u=t(756),s=t(263),c=s.validators;function l(e){this.defaults=e,this.interceptors={request:new r,response:new r}}l.prototype.request=function(e,n){"string"==typeof e?(n=n||{}).url=e:n=e||{},(n=u(this.defaults,n)).method?n.method=n.method.toLowerCase():this.defaults.method?n.method=this.defaults.method.toLowerCase():n.method="get";var t=n.transitional;void 0!==t&&s.assertOptions(t,{silentJSONParsing:c.transitional(c.boolean),forcedJSONParsing:c.transitional(c.boolean),clarifyTimeoutError:c.transitional(c.boolean)},!1);var i=[],o=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(n)||(o=o&&e.synchronous,i.unshift(e.fulfilled,e.rejected))}));var r,l=[];if(this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)})),!o){var d=[a,void 0];for(Array.prototype.unshift.apply(d,i),d=d.concat(l),r=Promise.resolve(n);d.length;)r=r.then(d.shift(),d.shift());return r}for(var f=n;i.length;){var v=i.shift(),h=i.shift();try{f=v(f)}catch(e){h(e);break}}try{r=a(f)}catch(e){return Promise.reject(e)}for(;l.length;)r=r.then(l.shift(),l.shift());return r},l.prototype.getUri=function(e){return e=u(this.defaults,e),o(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},i.forEach(["delete","get","head","options"],(function(e){l.prototype[e]=function(n,t){return this.request(u(t||{},{method:e,url:n,data:(t||{}).data}))}})),i.forEach(["post","put","patch"],(function(e){l.prototype[e]=function(n,t,i){return this.request(u(i||{},{method:e,url:n,data:t}))}})),e.exports=l},2974:(e,n,t)=>{"use strict";var i=t(2274);function o(){this.handlers=[]}o.prototype.use=function(e,n,t){return this.handlers.push({fulfilled:e,rejected:n,synchronous:!!t&&t.synchronous,runWhen:t?t.runWhen:null}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(e){i.forEach(this.handlers,(function(n){null!==n&&e(n)}))},e.exports=o},1948:(e,n,t)=>{"use strict";var i=t(5984),o=t(9865);e.exports=function(e,n){return e&&!i(n)?o(e,n):n}},9790:(e,n,t)=>{"use strict";var i=t(108);e.exports=function(e,n,t,o,r){var a=new Error(e);return i(a,n,t,o,r)}},7490:(e,n,t)=>{"use strict";var i=t(2274),o=t(2759),r=t(8999),a=t(8125),u=t(1256);function s(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new u("canceled")}e.exports=function(e){return s(e),e.headers=e.headers||{},e.data=o.call(e,e.data,e.headers,e.transformRequest),e.headers=i.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),i.forEach(["delete","get","head","post","put","patch","common"],(function(n){delete e.headers[n]})),(e.adapter||a.adapter)(e).then((function(n){return s(e),n.data=o.call(e,n.data,n.headers,e.transformResponse),n}),(function(n){return r(n)||(s(e),n&&n.response&&(n.response.data=o.call(e,n.response.data,n.response.headers,e.transformResponse))),Promise.reject(n)}))}},108:e=>{"use strict";e.exports=function(e,n,t,i,o){return e.config=n,t&&(e.code=t),e.request=i,e.response=o,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e}},756:(e,n,t)=>{"use strict";var i=t(2274);e.exports=function(e,n){n=n||{};var t={};function o(e,n){return i.isPlainObject(e)&&i.isPlainObject(n)?i.merge(e,n):i.isPlainObject(n)?i.merge({},n):i.isArray(n)?n.slice():n}function r(t){return i.isUndefined(n[t])?i.isUndefined(e[t])?void 0:o(void 0,e[t]):o(e[t],n[t])}function a(e){if(!i.isUndefined(n[e]))return o(void 0,n[e])}function u(t){return i.isUndefined(n[t])?i.isUndefined(e[t])?void 0:o(void 0,e[t]):o(void 0,n[t])}function s(t){return t in n?o(e[t],n[t]):t in e?o(void 0,e[t]):void 0}var c={url:a,method:a,data:a,baseURL:u,transformRequest:u,transformResponse:u,paramsSerializer:u,timeout:u,timeoutMessage:u,withCredentials:u,adapter:u,responseType:u,xsrfCookieName:u,xsrfHeaderName:u,onUploadProgress:u,onDownloadProgress:u,decompress:u,maxContentLength:u,maxBodyLength:u,transport:u,httpAgent:u,httpsAgent:u,cancelToken:u,socketPath:u,responseEncoding:u,validateStatus:s};return i.forEach(Object.keys(e).concat(Object.keys(n)),(function(e){var n=c[e]||r,o=n(e);i.isUndefined(o)&&n!==s||(t[e]=o)})),t}},365:(e,n,t)=>{"use strict";var i=t(9790);e.exports=function(e,n,t){var o=t.config.validateStatus;t.status&&o&&!o(t.status)?n(i("Request failed with status code "+t.status,t.config,null,t.request,t)):e(t)}},2759:(e,n,t)=>{"use strict";var i=t(2274),o=t(8125);e.exports=function(e,n,t){var r=this||o;return i.forEach(t,(function(t){e=t.call(r,e,n)})),e}},8125:(e,n,t)=>{"use strict";var i=t(2274),o=t(5382),r=t(108),a=t(1157),u={"Content-Type":"application/x-www-form-urlencoded"};function s(e,n){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=n)}var c,l={transitional:a,adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(c=t(6310)),c),transformRequest:[function(e,n){return o(n,"Accept"),o(n,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(s(n,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)||n&&"application/json"===n["Content-Type"]?(s(n,"application/json"),function(e,n,t){if(i.isString(e))try{return(0,JSON.parse)(e),i.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var n=this.transitional||l.transitional,t=n&&n.silentJSONParsing,o=n&&n.forcedJSONParsing,a=!t&&"json"===this.responseType;if(a||o&&i.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(a){if("SyntaxError"===e.name)throw r(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};i.forEach(["delete","get","head"],(function(e){l.headers[e]={}})),i.forEach(["post","put","patch"],(function(e){l.headers[e]=i.merge(u)})),e.exports=l},1157:e=>{"use strict";e.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}},4856:e=>{e.exports={version:"0.26.1"}},7670:e=>{"use strict";e.exports=function(e,n){return function(){for(var t=new Array(arguments.length),i=0;i<t.length;i++)t[i]=arguments[i];return e.apply(n,t)}}},8270:(e,n,t)=>{"use strict";var i=t(2274);function o(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,n,t){if(!n)return e;var r;if(t)r=t(n);else if(i.isURLSearchParams(n))r=n.toString();else{var a=[];i.forEach(n,(function(e,n){null!=e&&(i.isArray(e)?n+="[]":e=[e],i.forEach(e,(function(e){i.isDate(e)?e=e.toISOString():i.isObject(e)&&(e=JSON.stringify(e)),a.push(o(n)+"="+o(e))})))})),r=a.join("&")}if(r){var u=e.indexOf("#");-1!==u&&(e=e.slice(0,u)),e+=(-1===e.indexOf("?")?"?":"&")+r}return e}},9865:e=>{"use strict";e.exports=function(e,n){return n?e.replace(/\/+$/,"")+"/"+n.replace(/^\/+/,""):e}},9544:(e,n,t)=>{"use strict";var i=t(2274);e.exports=i.isStandardBrowserEnv()?{write:function(e,n,t,o,r,a){var u=[];u.push(e+"="+encodeURIComponent(n)),i.isNumber(t)&&u.push("expires="+new Date(t).toGMTString()),i.isString(o)&&u.push("path="+o),i.isString(r)&&u.push("domain="+r),!0===a&&u.push("secure"),document.cookie=u.join("; ")},read:function(e){var n=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},5984:e=>{"use strict";e.exports=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}},2842:(e,n,t)=>{"use strict";var i=t(2274);e.exports=function(e){return i.isObject(e)&&!0===e.isAxiosError}},1964:(e,n,t)=>{"use strict";var i=t(2274);e.exports=i.isStandardBrowserEnv()?function(){var e,n=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");function o(e){var i=e;return n&&(t.setAttribute("href",i),i=t.href),t.setAttribute("href",i),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:"/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname}}return e=o(window.location.href),function(n){var t=i.isString(n)?o(n):n;return t.protocol===e.protocol&&t.host===e.host}}():function(){return!0}},5382:(e,n,t)=>{"use strict";var i=t(2274);e.exports=function(e,n){i.forEach(e,(function(t,i){i!==n&&i.toUpperCase()===n.toUpperCase()&&(e[n]=t,delete e[i])}))}},75:(e,n,t)=>{"use strict";var i=t(2274),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var n,t,r,a={};return e?(i.forEach(e.split("\n"),(function(e){if(r=e.indexOf(":"),n=i.trim(e.substr(0,r)).toLowerCase(),t=i.trim(e.substr(r+1)),n){if(a[n]&&o.indexOf(n)>=0)return;a[n]="set-cookie"===n?(a[n]?a[n]:[]).concat([t]):a[n]?a[n]+", "+t:t}})),a):a}},5606:e=>{"use strict";e.exports=function(e){return function(n){return e.apply(null,n)}}},263:(e,n,t)=>{"use strict";var i=t(4856).version,o={};["object","boolean","number","function","string","symbol"].forEach((function(e,n){o[e]=function(t){return typeof t===e||"a"+(n<1?"n ":" ")+e}}));var r={};o.transitional=function(e,n,t){return function(o,a,u){if(!1===e)throw new Error(function(e,n){return"[Axios v"+i+"] Transitional option '"+e+"'"+n+(t?". "+t:"")}(a," has been removed"+(n?" in "+n:"")));return n&&!r[a]&&(r[a]=!0),!e||e(o,a,u)}},e.exports={assertOptions:function(e,n,t){if("object"!=typeof e)throw new TypeError("options must be an object");for(var i=Object.keys(e),o=i.length;o-- >0;){var r=i[o],a=n[r];if(a){var u=e[r],s=void 0===u||a(u,r,e);if(!0!==s)throw new TypeError("option "+r+" must be "+s)}else if(!0!==t)throw Error("Unknown option "+r)}},validators:o}},2274:(e,n,t)=>{"use strict";var i=t(7670),o=Object.prototype.toString;function r(e){return Array.isArray(e)}function a(e){return void 0===e}function u(e){return"[object ArrayBuffer]"===o.call(e)}function s(e){return null!==e&&"object"==typeof e}function c(e){if("[object Object]"!==o.call(e))return!1;var n=Object.getPrototypeOf(e);return null===n||n===Object.prototype}function l(e){return"[object Function]"===o.call(e)}function d(e,n){if(null!=e)if("object"!=typeof e&&(e=[e]),r(e))for(var t=0,i=e.length;t<i;t++)n.call(null,e[t],t,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&n.call(null,e[o],o,e)}e.exports={isArray:r,isArrayBuffer:u,isBuffer:function(e){return null!==e&&!a(e)&&null!==e.constructor&&!a(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"[object FormData]"===o.call(e)},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&u(e.buffer)},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:s,isPlainObject:c,isUndefined:a,isDate:function(e){return"[object Date]"===o.call(e)},isFile:function(e){return"[object File]"===o.call(e)},isBlob:function(e){return"[object Blob]"===o.call(e)},isFunction:l,isStream:function(e){return s(e)&&l(e.pipe)},isURLSearchParams:function(e){return"[object URLSearchParams]"===o.call(e)},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:d,merge:function e(){var n={};function t(t,i){c(n[i])&&c(t)?n[i]=e(n[i],t):c(t)?n[i]=e({},t):r(t)?n[i]=t.slice():n[i]=t}for(var i=0,o=arguments.length;i<o;i++)d(arguments[i],t);return n},extend:function(e,n,t){return d(n,(function(n,o){e[o]=t&&"function"==typeof n?i(n,t):n})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},4988:(e,n,t)=>{"use strict";t.d(n,{y:()=>c});var i=t(7280),o=t(6955),r=t(995),a=t(7120);function u(e){return e}var s=t(2362),c=function(){function e(e){this.A=!1,e&&(this.F=e)}return e.prototype.lift=function(n){var t=new e;return t.source=this,t.operator=n,t},e.prototype.subscribe=function(e,n,t){var a=this.operator,u=function(e,n,t){if(e){if(e instanceof i.L)return e;if(e[o.b])return e[o.b]()}return e||n||t?new i.L(e,n,t):new i.L(r.c)}(e,n,t);if(a?u.add(a.call(u,this.source)):u.add(this.source||s.v.useDeprecatedSynchronousErrorHandling&&!u.syncErrorThrowable?this.F(u):this.P(u)),s.v.useDeprecatedSynchronousErrorHandling&&u.syncErrorThrowable&&(u.syncErrorThrowable=!1,u.syncErrorThrown))throw u.syncErrorValue;return u},e.prototype.P=function(e){try{return this.F(e)}catch(n){s.v.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=n),function(e){for(;e;){var n=e,t=n.closed,o=n.destination,r=n.isStopped;if(t||r)return!1;e=o&&o instanceof i.L?o:null}return!0}(e)&&e.error(n)}},e.prototype.forEach=function(e,n){var t=this;return new(n=l(n))((function(n,i){var o;o=t.subscribe((function(n){try{e(n)}catch(e){i(e),o&&o.unsubscribe()}}),i,n)}))},e.prototype.F=function(e){var n=this.source;return n&&n.subscribe(e)},e.prototype[a.L]=function(){return this},e.prototype.pipe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return 0===e.length?this:(0===(t=e).length?u:1===t.length?t[0]:function(e){return t.reduce((function(e,n){return n(e)}),e)})(this);var t},e.prototype.toPromise=function(e){var n=this;return new(e=l(e))((function(e,t){var i;n.subscribe((function(e){return i=e}),(function(e){return t(e)}),(function(){return e(i)}))}))},e.create=function(n){return new e(n)},e}();function l(e){if(e||(e=s.v.Promise||Promise),!e)throw new Error("no Promise impl found");return e}},995:(e,n,t)=>{"use strict";t.d(n,{c:()=>r});var i=t(2362),o=t(4419),r={closed:!0,next:function(e){},error:function(e){if(i.v.useDeprecatedSynchronousErrorHandling)throw e;(0,o.z)(e)},complete:function(){}}},9595:(e,n,t)=>{"use strict";t.d(n,{xQ:()=>d});var i=t(9628),o=t(4988),r=t(7280),a=t(6479),u=t(3785),s=function(e){function n(n,t){var i=e.call(this)||this;return i.subject=n,i.subscriber=t,i.closed=!1,i}return i.ZT(n,e),n.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,n=e.observers;if(this.subject=null,n&&0!==n.length&&!e.isStopped&&!e.closed){var t=n.indexOf(this.subscriber);-1!==t&&n.splice(t,1)}}},n}(a.w),c=t(6955),l=function(e){function n(n){var t=e.call(this,n)||this;return t.destination=n,t}return i.ZT(n,e),n}(r.L),d=function(e){function n(){var n=e.call(this)||this;return n.observers=[],n.closed=!1,n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return i.ZT(n,e),n.prototype[c.b]=function(){return new l(this)},n.prototype.lift=function(e){var n=new f(this,this);return n.operator=e,n},n.prototype.next=function(e){if(this.closed)throw new u.N;if(!this.isStopped)for(var n=this.observers,t=n.length,i=n.slice(),o=0;o<t;o++)i[o].next(e)},n.prototype.error=function(e){if(this.closed)throw new u.N;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var n=this.observers,t=n.length,i=n.slice(),o=0;o<t;o++)i[o].error(e);this.observers.length=0},n.prototype.complete=function(){if(this.closed)throw new u.N;this.isStopped=!0;for(var e=this.observers,n=e.length,t=e.slice(),i=0;i<n;i++)t[i].complete();this.observers.length=0},n.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},n.prototype.P=function(n){if(this.closed)throw new u.N;return e.prototype.P.call(this,n)},n.prototype.F=function(e){if(this.closed)throw new u.N;return this.hasError?(e.error(this.thrownError),a.w.EMPTY):this.isStopped?(e.complete(),a.w.EMPTY):(this.observers.push(e),new s(this,e))},n.prototype.asObservable=function(){var e=new o.y;return e.source=this,e},n.create=function(e,n){return new f(e,n)},n}(o.y),f=function(e){function n(n,t){var i=e.call(this)||this;return i.destination=n,i.source=t,i}return i.ZT(n,e),n.prototype.next=function(e){var n=this.destination;n&&n.next&&n.next(e)},n.prototype.error=function(e){var n=this.destination;n&&n.error&&this.destination.error(e)},n.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},n.prototype.F=function(e){return this.source?this.source.subscribe(e):a.w.EMPTY},n}(d)},7280:(e,n,t)=>{"use strict";t.d(n,{L:()=>l});var i=t(9628),o=t(4965),r=t(995),a=t(6479),u=t(6955),s=t(2362),c=t(4419),l=function(e){function n(t,i,o){var a=e.call(this)||this;switch(a.syncErrorValue=null,a.syncErrorThrown=!1,a.syncErrorThrowable=!1,a.isStopped=!1,arguments.length){case 0:a.destination=r.c;break;case 1:if(!t){a.destination=r.c;break}if("object"==typeof t){t instanceof n?(a.syncErrorThrowable=t.syncErrorThrowable,a.destination=t,t.add(a)):(a.syncErrorThrowable=!0,a.destination=new d(a,t));break}default:a.syncErrorThrowable=!0,a.destination=new d(a,t,i,o)}return a}return i.ZT(n,e),n.prototype[u.b]=function(){return this},n.create=function(e,t,i){var o=new n(e,t,i);return o.syncErrorThrowable=!1,o},n.prototype.next=function(e){this.isStopped||this.O(e)},n.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._(e))},n.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this.B())},n.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},n.prototype.O=function(e){this.destination.next(e)},n.prototype._=function(e){this.destination.error(e),this.unsubscribe()},n.prototype.B=function(){this.destination.complete(),this.unsubscribe()},n.prototype.Z=function(){var e=this.X;return this.X=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this.X=e,this},n}(a.w),d=function(e){function n(n,t,i,a){var u,s=e.call(this)||this;s.Y=n;var c=s;return(0,o.m)(t)?u=t:t&&(u=t.next,i=t.error,a=t.complete,t!==r.c&&(c=Object.create(t),(0,o.m)(c.unsubscribe)&&s.add(c.unsubscribe.bind(c)),c.unsubscribe=s.unsubscribe.bind(s))),s.$=c,s.O=u,s._=i,s.B=a,s}return i.ZT(n,e),n.prototype.next=function(e){if(!this.isStopped&&this.O){var n=this.Y;s.v.useDeprecatedSynchronousErrorHandling&&n.syncErrorThrowable?this.__tryOrSetError(n,this.O,e)&&this.unsubscribe():this.__tryOrUnsub(this.O,e)}},n.prototype.error=function(e){if(!this.isStopped){var n=this.Y,t=s.v.useDeprecatedSynchronousErrorHandling;if(this._)t&&n.syncErrorThrowable?(this.__tryOrSetError(n,this._,e),this.unsubscribe()):(this.__tryOrUnsub(this._,e),this.unsubscribe());else if(n.syncErrorThrowable)t?(n.syncErrorValue=e,n.syncErrorThrown=!0):(0,c.z)(e),this.unsubscribe();else{if(this.unsubscribe(),t)throw e;(0,c.z)(e)}}},n.prototype.complete=function(){var e=this;if(!this.isStopped){var n=this.Y;if(this.B){var t=function(){return e.B.call(e.$)};s.v.useDeprecatedSynchronousErrorHandling&&n.syncErrorThrowable?(this.__tryOrSetError(n,t),this.unsubscribe()):(this.__tryOrUnsub(t),this.unsubscribe())}else this.unsubscribe()}},n.prototype.__tryOrUnsub=function(e,n){try{e.call(this.$,n)}catch(e){if(this.unsubscribe(),s.v.useDeprecatedSynchronousErrorHandling)throw e;(0,c.z)(e)}},n.prototype.__tryOrSetError=function(e,n,t){if(!s.v.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{n.call(this.$,t)}catch(n){return s.v.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=n,e.syncErrorThrown=!0,!0):((0,c.z)(n),!0)}return!1},n.prototype.ee=function(){var e=this.Y;this.$=null,this.Y=null,e.unsubscribe()},n}(l)},6479:(e,n,t)=>{"use strict";t.d(n,{w:()=>u});var i=t(6357),o=t(895),r=t(4965),a=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,n){return n+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),u=function(){function e(e){this.closed=!1,this.X=null,this.ne=null,e&&(this.te=!0,this.ee=e)}var n;return e.prototype.unsubscribe=function(){var n;if(!this.closed){var t=this,u=t.X,c=t.te,l=t.ee,d=t.ne;if(this.closed=!0,this.X=null,this.ne=null,u instanceof e)u.remove(this);else if(null!==u)for(var f=0;f<u.length;++f)u[f].remove(this);if((0,r.m)(l)){c&&(this.ee=void 0);try{l.call(this)}catch(e){n=e instanceof a?s(e.errors):[e]}}if((0,i.k)(d)){f=-1;for(var v=d.length;++f<v;){var h=d[f];if((0,o.K)(h))try{h.unsubscribe()}catch(e){n=n||[],e instanceof a?n=n.concat(s(e.errors)):n.push(e)}}}if(n)throw new a(n)}},e.prototype.add=function(n){var t=n;if(!n)return e.EMPTY;switch(typeof n){case"function":t=new e(n);case"object":if(t===this||t.closed||"function"!=typeof t.unsubscribe)return t;if(this.closed)return t.unsubscribe(),t;if(!(t instanceof e)){var i=t;(t=new e).ne=[i]}break;default:throw new Error("unrecognized teardown "+n+" added to Subscription.")}var o=t.X;if(null===o)t.X=this;else if(o instanceof e){if(o===this)return t;t.X=[o,this]}else{if(-1!==o.indexOf(this))return t;o.push(this)}var r=this.ne;return null===r?this.ne=[t]:r.push(t),t},e.prototype.remove=function(e){var n=this.ne;if(n){var t=n.indexOf(e);-1!==t&&n.splice(t,1)}},e.EMPTY=((n=new e).closed=!0,n),e}();function s(e){return e.reduce((function(e,n){return e.concat(n instanceof a?n.errors:n)}),[])}},2362:(e,n,t)=>{"use strict";t.d(n,{v:()=>o});var i=!1,o={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){i=e},get useDeprecatedSynchronousErrorHandling(){return i}}},7120:(e,n,t)=>{"use strict";t.d(n,{L:()=>i});var i=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}()},6955:(e,n,t)=>{"use strict";t.d(n,{b:()=>i});var i=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}()},3785:(e,n,t)=>{"use strict";t.d(n,{N:()=>i});var i=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}()},4419:(e,n,t)=>{"use strict";function i(e){setTimeout((function(){throw e}),0)}t.d(n,{z:()=>i})},6357:(e,n,t)=>{"use strict";t.d(n,{k:()=>i});var i=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}()},4965:(e,n,t)=>{"use strict";function i(e){return"function"==typeof e}t.d(n,{m:()=>i})},895:(e,n,t)=>{"use strict";function i(e){return null!==e&&"object"==typeof e}t.d(n,{K:()=>i})},9628:(e,n,t)=>{"use strict";t.d(n,{ZT:()=>o});var i=function(e,n){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])},i(e,n)};function o(e,n){function t(){this.constructor=e}i(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}},9850:(e,n,t)=>{"use strict";t.d(n,{CR:()=>u,Jh:()=>r,XA:()=>a,ev:()=>s,mG:()=>o,pi:()=>i});var i=function(){return i=Object.assign||function(e){for(var n,t=1,i=arguments.length;t<i;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},i.apply(this,arguments)};function o(e,n,t,i){return new(t||(t=Promise))((function(o,r){function a(e){try{s(i.next(e))}catch(e){r(e)}}function u(e){try{s(i.throw(e))}catch(e){r(e)}}function s(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,u)}s((i=i.apply(e,n||[])).next())}))}function r(e,n){var t,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function u(u){return function(s){return function(u){if(t)throw new TypeError("Generator is already executing.");for(;r&&(r=0,u[0]&&(a=0)),a;)try{if(t=1,i&&(o=2&u[0]?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,i=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=n.call(e,a)}catch(e){u=[6,e],i=0}finally{t=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}}function a(e){var n="function"==typeof Symbol&&Symbol.iterator,t=n&&e[n],i=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(e,n){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var i,o,r=t.call(e),a=[];try{for(;(void 0===n||n-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return a}function s(e,n,t){if(t||2===arguments.length)for(var i,o=0,r=n.length;o<r;o++)!i&&o in n||(i||(i=Array.prototype.slice.call(n,0,o)),i[o]=n[o]);return e.concat(i||Array.prototype.slice.call(n))}Object.create,Object.create},8087:(e,n,t)=>{"use strict";var i;t.d(n,{L8:()=>d}),function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(i||(i={}));var o,r,a=t(3869),u=t(4177),s=function(){function e(e){var n=this;this.ie=3e4,this.oe=30,this.re=0,this.ae=[],this.ue=(0,u.Ks)(),this.se=[],this.ce="",this.le=0,this.flushOnClose=function(){n.de(!1,!1)},this.flush=function(){n.fe()},this.flushAndSetNewEndpoint=function(e,t){var i,o=n.ve(e);o.localeCompare(null!==(i=n.he)&&void 0!==i?i:"",void 0,{sensitivity:"accent"})&&(n.se.push((function(){n.he=o,t&&t()})),n.de(!0,!0))},this.ve=function(e){return e+"?usid="+n.ce+"&officeserverversion="+function(){try{return __VERSION_PLACEHOLDER__}catch(e){return"###VERSION###"}}()},this.fe=function(){window.setTimeout((function(){return n.de(!0,!0)}),0)},this.de=function(e,t){var i,o,r,a,s,c,l,d=(0,u.u3)();window.clearTimeout(n.pe),n.he&&(n.ae.length>0&&(n.re+=1,function(e,n,t){if(n){var i=window.navigator;if(i&&i.sendBeacon)try{return void i.sendBeacon(n,e)}catch(e){}!function(e,n,t){var i=new XMLHttpRequest;i.readyState!==XMLHttpRequest.UNSENT&&i.readyState!==XMLHttpRequest.DONE||(i.open("POST",n,t),i.send(e))}(e,n,t)}}((i=n.ae.splice(0,e?n.oe:n.ae.length),o=n.ce,r=n.re,a=n.ue,s=[],c=i.map((function(e){return function(e,n,t){var i={};if(i.G=e.tag,i.T=e.timestamp-n,i.M=e.message,i.C=e.category,e.correlationId){var o=t.findIndex((function(n){return n===e.correlationId}));o<0&&(o=t.push(e.correlationId)-1),i.I=o}var r=1e3*e.type+e.level;return i.D=r,i}(e,a,s)})),l=function(e,n,t,i,o){var r={};return r.T=e,r.L=n,r.S=t,r.I=i,o&&o.length>0&&(r.W=o),r.V=1,r}(a,c,o,r,s),JSON.stringify(l)),n.he,t),n.ue=(0,u.Ks)()),0===n.ae.length&&n.se.length>0&&(n.se.forEach((function(e){"requestIdleCallback"in window?window.requestIdleCallback(e):window.setTimeout(e,0)})),n.se=[]),e&&(n.pe=window.setTimeout((function(){n.fe()}),n.ae.length>n.oe||n.se.length>0?1e3:n.ie)),n.le+=(0,u.u3)()-d)},e&&this.configure(e)}return e.prototype.getTimeSpentLogging=function(){return this.le},e.prototype.addLoggingTime=function(e){this.le+=e},e.prototype.configure=function(e){var n=this,t=(0,u.u3)();if(e.uploadCadenceInMs&&(this.ie=e.uploadCadenceInMs),e.uploadTriggerSize&&(this.oe=e.uploadTriggerSize),e.sessionId&&(this.ce=e.sessionId),e.remoteUlsEndpoint){if(!e.sessionId&&this.he)throw new Error("Remote ULS endpoint is already set");this.he=this.ve(e.remoteUlsEndpoint),this.ue=(0,u.Ks)(),window.setTimeout((function(){return n.de(!0,!0)}),0)}this.le+=(0,u.u3)()-t},e.prototype.handleTrace=function(e){var n=(0,u.u3)();e.message.length>3072&&(e.message=e.message.substring(0,3059)+"... [Trimmed]"),this.ae.push(e),(this.ae.length>this.oe||e.level===a.G.Error)&&this.fe(),this.le+=(0,u.u3)()-n},e.prototype.getUserSessionId=function(){return this.ce},e}(),c=[];!function(e){e.me="BootstrapperMaxUlsHeartbeatTime",e.Se="BootstrapperNoCompleteWarning1Time",e.He="BootstrapperNoCompleteWarning2Time",e.we="RemoteUlsETag",e.be="RemoteUlsSuppressions",e.ge="BootstrapperSettingsFetchPeriod",e.Ie="timestamp",e.Ae="BootstrapperUlsHeartbeatIntervalMs",e.Ce="BootstrapperUlsHeartBeatIsEnabled",e.Ue="BootstrapperUlsUploadCadenceMs",e.Re="WordConsumptionViewToEditRedirectIsEnabled",e.ye="RequestedCallThrottlingDefaultToViewMinimumValue",e.Ne="BulsEndpointUrl",e.Te="EnableCommonHostDiagnosticsParams",e.Ee="EnableOnSubmitCallbackForWacFrame"}(r||(r={}));var l=6e4;function d(e){var n=new s(e);function t(e,t,o,r){var a=(0,u.u3)();if(!function(e){return 1===c[e]}(e)){var s={timestamp:(0,u.Ks)(),category:t,tag:e,level:o,type:i.Trace,message:r,correlationId:""};n.addLoggingTime((0,u.u3)()-a),n.handleTrace(s)}}return{ULS:{sendTraceTag:function(e,n,i,o){t(e,n,i,o)},shipAssertTag:function(e,n,i,o){i&&t(e,n,a.G.Error,o)},debugAssertTag:function(e,n,t,i){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:n.flush,flushOnClose:n.flushOnClose,setCorrelationId:function(){}},configure:function(e){n.configure(e)},settingsChangeHandler:function(e){var t,i;t=e.Fe.getValue(r.be,""),i=e.Fe.getValue(r.we,""),o&&i===o||(c=[],o=i,t&&t.split(",").forEach((function(e){var n=parseInt(e,10);n&&(c[n]=1)}))),n.configure({uploadCadenceInMs:e.Fe.getValue(r.Ue,l)});var a=e.Fe.getValue(r.Ne,"").toString();""!==a&&n.flushAndSetNewEndpoint(a)},getTimeSpentLogging:function(){return n.getTimeSpentLogging()},getUserSessionId:function(){return n.getUserSessionId()},flushAndSetNewEndpoint:function(e,t){n.flushAndSetNewEndpoint(e,t)}}}},9508:(e,n,t)=>{"use strict";function i(e){return JSON.stringify(e,Object.getOwnPropertyNames(e))}t.d(n,{n:()=>r});var o=t(4177);function r(){var e=new Uint8Array(31),n=function(e){var n={crypto:!1,perfNow:!1,exceptions:[]},t=window.crypto||window.msCrypto;if(t){n.crypto=!0;try{return t.getRandomValues(e),n}catch(e){n.exceptions.push("crypto: ".concat(i(e)))}}n.perfNow=o.Xm;for(var r=0;r<e.length;r+=1){try{if(o.Xm){var a=Math.floor(100*window.performance.now())%10;(a<0||a>9)&&(a=0);for(var u=0;u<a;u+=1)Math.random()}}catch(e){n.exceptions.push("Math.random: ".concat(i(e)))}e[r]=Math.floor(16*Math.random())}return n}(e),t=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(n){var i=15&e[t];return t+=1,("x"===n?i:3&i|8).toString(16)})),n]}},4177:(e,n,t)=>{"use strict";t.d(n,{Ks:()=>a,Xm:()=>o,u3:()=>r});var i,o=function(){try{var e=window.performance;return e&&e.now&&e.now()!==1/0}catch(e){return!1}}();function r(){return o?window.performance.now():Date.now()}function a(){if(!i){var e=window.performance;i=o&&e.timing&&e.timing.navigationStart?function(){return Math.round(e.now()+e.timing.navigationStart)}:Date.now?Date.now:function(){return(new Date).getTime()}}return i()}},4084:(e,n,t)=>{"use strict";t.d(n,{o:()=>i});var i,o=t(6741),r=t(9850),a=function(){function e(){this.blockedEvents=new Map,this.eventHitCounts=new Map,this.eventDurations=new Map,this.eventDurationsTotal=new Map}return e.prototype.isEventBlocked=function(e){var n=this.blockedEvents.get(e);return!!n&&(Date.now()>=n?(this.unblockEvent(e),!1):(this.aggregateEventCount(e),!0))},e.prototype.blockEvent=function(e,n){var t=Date.now()+n;this.blockedEvents.set(e,t),this.updateEventHitCount(e,0),this.eventDurations.delete(e),this.eventDurationsTotal.delete(e)},e.prototype.unblockEvent=function(e){this.blockedEvents.delete(e)},e.prototype.getEventHitCount=function(e){return this.eventHitCounts.get(e)},e.prototype.updateEventHitCount=function(e,n){this.eventHitCounts.set(e,n)},e.prototype.aggregateEventCount=function(e){var n=this.getEventHitCount(e);"number"==typeof n&&this.updateEventHitCount(e,++n)},e.prototype.getEventDurations=function(e){return this.eventDurations.get(e)},e.prototype.aggregateEventDuration=function(e,n){var t,i=(null!==(t=this.getEventHitCount(e))&&void 0!==t?t:0)+1,o=this.eventDurationsTotal.get(e),a=this.eventDurations.get(e);if(void 0!==a){var u=(0,r.ev)([],a,!0);a[0]>n&&(u[0]=n),a[1]<n&&(u[1]=n);var s=void 0;void 0!==o&&o.length<10?(o.push(n),s=o.reduce((function(e,n){return e+n}),0)/i):(s=a[2]+(n-a[2])/i,this.eventDurationsTotal.delete(e)),u[2]=s,this.eventDurations.set(e,u)}else this.eventDurations.set(e,[n,n,n]),this.eventDurationsTotal.set(e,[n])},e}(),u=function(){function e(e,n,t,i,o){this.healthLogger=e,this.featureConfig=n,this.kpiUsageEventBlocker=t,this.kpiFailureEventBlocker=i,this.kpiSuccessEventBlocker=o}return e.prototype.logKpiUsage=function(n,t,i,o){var r=this.getKpiKey(n+e.USAGE_KPI,null==i?void 0:i.extendedProperties);if(this.kpiUsageEventBlocker.isEventBlocked(r))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(i),this.recordKpiUsage(n,t,i,r),0!==o){var a=null!=o?o:3e5;this.kpiUsageEventBlocker.blockEvent(r,a)}return!0},e.prototype.logKpiFailure=function(n,t,i,o,r){var a,u,s,c=this.getKpiKey(n+e.FAILURE_KPI+t,null===(a=null==i?void 0:i.additionalValues)||void 0===a?void 0:a.extendedProperties);if("number"==typeof(null===(u=null==i?void 0:i.additionalValues)||void 0===u?void 0:u.durationMs)&&this.kpiFailureEventBlocker.aggregateEventDuration(c,i.additionalValues.durationMs),this.kpiFailureEventBlocker.isEventBlocked(c))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(),this.recordKpiFailure(n,t,i,c),o&&this.recordQosError(null!==(s=o.errorNameOverride)&&void 0!==s?s:t,o.name,o),0!==r){var l=null!=r?r:3e5;this.kpiFailureEventBlocker.blockEvent(c,l)}return!0},e.prototype.logKpiSuccess=function(n,t,i){var o,r,a=this.getKpiKey(n+e.SUCCESS_KPI,null===(o=null==t?void 0:t.additionalValues)||void 0===o?void 0:o.extendedProperties);if("number"==typeof(null===(r=null==t?void 0:t.additionalValues)||void 0===r?void 0:r.durationMs)&&this.kpiSuccessEventBlocker.aggregateEventDuration(a,t.additionalValues.durationMs),this.kpiSuccessEventBlocker.isEventBlocked(a))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(),this.recordKpiSuccess(n,t,a),0!==i){var u=null!=i?i:3e5;this.kpiSuccessEventBlocker.blockEvent(a,u)}return!0},e.prototype.ensureFeatureDenominatorLoggedAndVetoPillarRegistered=function(n){var t,o=this.featureConfig.topLevelKpiName,r=this.getKpiKey(this.featureConfig.topLevelKpiName,null==n?void 0:n.extendedProperties);if(!this.kpiUsageEventBlocker.isEventBlocked(null!=r?r:"")){this.recordKpiUsage(o,i.FailureBased,n);var a=null!==(t=this.featureConfig.vetoPillar)&&void 0!==t?t:this.featureConfig.areaName;a&&e.QOS_PILLARS_LIST.includes(a)&&this.healthLogger.addQosPillar(a),this.kpiUsageEventBlocker.blockEvent(null!=r?r:"",864e5)}},e.prototype.recordKpiUsage=function(e,n,t,i){var o;void 0===t&&(t={});var r=(o=t||{}).extendedProperties,a=o.isForAlertableKpi,u=this.createExtendedPropertiesWithMoreFields(r,i);a?this.healthLogger.recordKpiUsageForAlertableKpi(e,this.featureConfig.crewAlias,u):this.healthLogger.recordKpiUsage(e,n,this.featureConfig.crewAlias,u)},e.prototype.getKpiKey=function(e,n){var t=this.getKpiAreaName(n),i=this.getKpiFeatureName(n),o=this.getKpiPivot(n);return"".concat(t,".").concat(i,".").concat(null!=e?e:"").concat(o&&0===o.length?"."+o:"")},e.prototype.getKpiAreaName=function(n){var t,i,o;return null!==(o=null!==(i=null!==(t=null==n?void 0:n.get(e.AREA_NAME_COLUMN_KEY))&&void 0!==t?t:this.featureConfig.areaName)&&void 0!==i?i:this.featureConfig.vetoPillar)&&void 0!==o?o:""},e.prototype.getKpiFeatureName=function(n){var t,i;return null!==(i=null!==(t=null==n?void 0:n.get(e.FEATURE_NAME_COLUMN_KEY))&&void 0!==t?t:this.featureConfig.featureName)&&void 0!==i?i:""},e.prototype.getKpiPivot=function(n){var t=null==n?void 0:n.get(e.PIVOT_TYPE_COLUMN_KEY),i=null==n?void 0:n.get(e.PIVOT_VALUE_COLUMN_KEY);return t&&0!==t.length&&i&&0!==i.length?"".concat(t,"=").concat(i):""},e.prototype.recordKpiFailure=function(e,n,t,i){var o;void 0===t&&(t={});var r=(o=t||{}).isIntentional,a=o.isInternal,u=o.additionalValues,s=o.hasImpliedUsage,c=this.createAdditionalValuesWithMoreFields(u,i);!1===s?this.healthLogger.recordKpiFailure(e,n,r,a,c):this.healthLogger.recordKpiImpliedFailure(e,n,r,a,this.featureConfig.crewAlias,c)},e.prototype.recordKpiSuccess=function(e,n,t){var i;void 0===n&&(n={});var o=(i=n||{}).additionalValues,r=i.hasImpliedUsage,a=this.createAdditionalValuesWithMoreFields(o,t);!1===r?this.healthLogger.recordKpiSuccess(e,a):this.healthLogger.recordKpiImpliedSuccess(e,this.featureConfig.crewAlias,a)},e.prototype.recordQosError=function(e,n,t){void 0===t&&(t={});var i=t.isIntentional,o=t.isInternal,r=t.alertOnPillar,a=t.isSessionEndingError,u=t.additionalValues,s=this.createAdditionalValuesWithMoreFields(u);this.healthLogger.recordQosError(e,[n],i,o,r,a,s)},e.prototype.createExtendedPropertiesWithMoreFields=function(n,t){var i=new Map(n||new Map);if(i.get(e.FEATURE_NAME_COLUMN_KEY)||i.set(e.FEATURE_NAME_COLUMN_KEY,this.getKpiFeatureName(n)),i.set(e.AREA_NAME_COLUMN_KEY,this.getKpiAreaName(i)),i.has(e.SKIP_ARIA_COLUMN_KEY)||i.has("skipAria")||i.set(e.SKIP_ARIA_COLUMN_KEY,"true"),!this.featureConfig.doNotEmitAggregatedCount&&t){var o=this.getEventBlocker(t);if(o){var r=o.getEventHitCount(t);if(r){i.set(e.AGGREGATED_COUNT_COLUMN_KEY,r.toString());var a=o.getEventDurations(t);r>1&&a&&i.set(e.AGGREGATED_DURATION_COLUMN_KEY,a.map((function(e){return Math.round(100*e)/100})).toString())}}}return i},e.prototype.createAdditionalValuesWithMoreFields=function(e,n){var t={};return(t=(0,r.pi)({},e)).extendedProperties=this.createExtendedPropertiesWithMoreFields(null==e?void 0:e.extendedProperties,n),t},e.prototype.getEventBlocker=function(n){return n.endsWith(e.USAGE_KPI)?this.kpiUsageEventBlocker:n.includes(e.FAILURE_KPI)?this.kpiFailureEventBlocker:n.endsWith(e.SUCCESS_KPI)?this.kpiSuccessEventBlocker:void 0},e.FEATURE_NAME_COLUMN_KEY="FeatureName",e.AREA_NAME_COLUMN_KEY="AreaName",e.AGGREGATED_COUNT_COLUMN_KEY="AggCount",e.AGGREGATED_DURATION_COLUMN_KEY="AggMs",e.SKIP_ARIA_COLUMN_KEY="SkipAria",e.PIVOT_TYPE_COLUMN_KEY="PivotType",e.PIVOT_VALUE_COLUMN_KEY="PivotValue",e.QOS_PILLARS_LIST=["Interruptions","Open","NotebookNavigation","Fidelity","AsyncCollab","Present","ContentConsumption","bSqmCompatibility","Boot"],e.USAGE_KPI=".Usage",e.SUCCESS_KPI=".Success",e.FAILURE_KPI=".Failure.",e}(),s=function(){function e(n,t,o,a,s){var c,l,d,f=this;this.healthLogger=n,this.featureConfig=t,this.kpiUsageEventBlocker=o,this.kpiFailureEventBlocker=a,this.kpiSuccessEventBlocker=s,this.featureUsageAndHealthLogger=new u(this.healthLogger,this.featureConfig,null!==(c=this.kpiUsageEventBlocker)&&void 0!==c?c:e.kpiUsageBlocker,null!==(l=this.kpiSuccessEventBlocker)&&void 0!==l?l:e.kpiFailureBlocker,null!==(d=this.kpiFailureEventBlocker)&&void 0!==d?d:e.kpiSuccessBlocker),this.executeCallbackWithLogging=function(e,n){var t,o,a,u=function(e){return"VetoFailureLoggingParams".includes(e)};(null==n?void 0:n.kpiUsageLoggingParams)?(o="Usage",a=null==n?void 0:n.kpiUsageLoggingParams):(null==n?void 0:n.kpiSuccessLoggingParams)?(o="UsageWithSuccess",a=null==n?void 0:n.kpiSuccessLoggingParams):(null==n?void 0:n.kpiFailureLoggingParams)?(o="UsageWithFailure",a=null==n?void 0:n.kpiFailureLoggingParams):(o="UsageWithVetoFailure",a=null==n?void 0:n.vetoFailureLoggingParams);var s=null==a?void 0:a.usageName,c=null==a?void 0:a.usageKpiType;f.logKpiUsage({kpiName:s,kpiType:null!=c?c:i.FailureBased});try{null==e||e(),"UsageWithSuccess"===o&&"KpiSuccessLoggingParams".includes(a)&&f.logKpiSuccess({kpiName:s,optionalProperties:a.successOptionalProperties})}catch(e){if("UsageWithFailure"===o&&"KpiFailureLoggingParams".includes(a)||"UsageWithVetoFailure"===o&&u(a)){var l=void 0;u(a)&&(l=(0,r.pi)({name:null!==(t=a.vetoName)&&void 0!==t?t:""},a.vetoOptionalProperties)),f.logKpiFailure({kpiName:a.usageName,errorName:a.failureErrorName,optionalProperties:a.failureOptionalProperties,optionalVeto:l})}throw e}}}return e.getInstance=function(n,t,i,o,r){return new e(n,t,i,o,r)},e.prototype.logKpiUsage=function(e){var n;return!(!e||!e.kpiName)&&this.featureUsageAndHealthLogger.logKpiUsage(e.kpiName,null!==(n=e.kpiType)&&void 0!==n?n:i.FailureBased,e.optionalProperties,e.blockFutureEmissionDurationInMs)},e.prototype.logKpiFailure=function(e){return!!(e&&e.kpiName&&e.errorName)&&this.featureUsageAndHealthLogger.logKpiFailure(e.kpiName,e.errorName,e.optionalProperties,e.optionalVeto,e.blockFutureEmissionDurationInMs)},e.prototype.logKpiSuccess=function(e){return!(!e||!e.kpiName)&&this.featureUsageAndHealthLogger.logKpiSuccess(e.kpiName,e.optionalProperties,e.blockFutureEmissionDurationInMs)},e.prototype.ensureFeatureDenominatorLoggedAndVetoPillarRegistered=function(e){this.featureUsageAndHealthLogger.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(e)},e.kpiUsageBlocker=new a,e.kpiFailureBlocker=new a,e.kpiSuccessBlocker=new a,e}(),c=function(){function e(){}return e.prototype.getHealthInstance=function(e){if(e)return o.S.getInstance().initialize(e),o.S.getInstance()},e.prototype.getExtendedHealthInstance=function(e,n){if(e&&n)return s.getInstance(e,n)},e}();!function(e){e[e.FailureBased=0]="FailureBased",e[e.SuccessBased=1]="SuccessBased"}(i||(i={})),new c},6741:(e,n,t)=>{"use strict";t.d(n,{S:()=>u});var i=t(9850);function o(e){if(e){var n={};return e.forEach((function(e,t){t&&(n[t]=e)})),n}}function r(e,n){var t=[],i=new Set;return e.concat(n).forEach((function(e){return i.add(e)})),i.forEach((function(e){return t.push(e)})),t}var a=t(4084),u=function(){function e(){var e=this;this.De={},this.ke={},this.Pe=[],this.Oe={},this.xe=0,this.Ke={We:3e5,Me:!1,je:!1,Ge:!1,_e:3e4,Le:25,Be:"",Je:864e5,Ve:"",qe:"",ze:3,Ze:3,Qe:15e3,Xe:new Set},this.Ye=!1,this.$e=-1,this.en=!1,this.nn=0,this.tn=!0,this.rn=function(){return!1},this.an={},this.un=[],this.sn=0,this.cn=0,this.ln=void 0,this.dn=[],this.fn=[],this.vn=[],this.hn=[],this.pn=0,this.mn=0,this.Sn=0,this.Hn=[],this.wn=!1,this.bn=0,this.gn=!1,this.In=function(){e.pn&&(window.clearTimeout(e.pn),e.pn=0)},this.An=function(){e.un=[],e.dn=[],e.fn=[],e.ln=void 0,e.vn=[],e.hn=[],e.sn=0,e.cn=0},this.Cn=function(){try{if(e.sn<=0)return;var n=e.Un();e.Rn(n,e.xe,e.Ke.Ze),e.An()}catch(e){}},this.Un=function(){return{d:e.Oe,a:e.yn(),b:e.un,e:e.fn,h:e.ln,q:e.vn,k:e.dn,l:e.hn,type:"h_v2"}},this.yn=function(){return e.Ke.Ge&&(e.un&&e.un.length>0||e.fn&&e.fn.length>0)&&Object.keys(e.ke).length>0?(0,i.pi)((0,i.pi)({},e.De),e.ke):e.De},this.Nn=function(n,t,i,o){var r;if(void 0===o&&(o=!1),t&&!e.Ke.Xe.has(i))if(e.tn){switch(n){case 0:e.un.push(t);break;case 1:e.dn.push(t);break;case 2:e.fn.push(t);break;case 3:-1===e.vn.map((function(e){return e.n})).indexOf(t.n)&&e.vn.push(t);break;case 4:e.hn.push(t)}if(e.sn+=1,4!==n&&3!==n&&(e.cn+=1),e.rn()&&!o)return void e.Cn();e.sn>=e.Ke.Le&&(e.In(),e.Tn())}else t.o=(new Date).toJSON(),null===(r=e.En)||void 0===r||r.postMessage({t:n,k:"".concat(e.Oe.w,".").concat(e.xe),m:e.Oe,c:e.yn(),v:t})},this.Fn=function(){e.In(),e.pn=window.setTimeout((function(){e.Tn()}),e.Ke._e)},this.Tn=function(n){void 0===n&&(n=!1),n&&e.cn<=0||(e.Cn(),e.Fn())},this.Dn=function(){if(e.Hn||e.an){e.ln&&-1!==e.$e||(e.$e=(e.$e+1)%1e3),e.ln||(e.sn+=1);var n={p:e.ln?r(e.ln.p,e.Hn):e.Hn,k:e.ln?r(e.ln.k,e.Pe):e.Pe,i:e.Ke.We,o:e.$e};e.ln=n}},this.kn=function(n,t,i,r,a,u,s,c,l,d){if(n&&(!t||e.an[n])){t||e.Pn(n,c,l,d);var f=e.an[n],v={n:f.k,e:i,t:f.t,a:f.a,f:f.o,d:null==r?void 0:r.durationMs,p:o(null==r?void 0:r.extendedProperties)};if(a){var h={n:a,x:s,z:u};v.k=h}e.Nn(1,v,n)}},this.On=function(){var n,t,i,o,r,a,u,s,c,l,d,f,v,h,p,m,S,H,w,b,g,I,A,C,U,R,y,N,T,E,F,D,k,P,O,x,K,W=e.Ke.Oe;W&&(e.Oe={a:null!==(n=W.application)&&void 0!==n?n:void 0,b:null!==(t=W.applicationLcid)&&void 0!==t?t:void 0,c:null!==(i=W.applicationMode)&&void 0!==i?i:void 0,d:null!==(o=W.applicationModeExtended)&&void 0!==o?o:void 0,e:null!==(r=W.arrVersion)&&void 0!==r?r:void 0,f:null!==(a=W.browser)&&void 0!==a?a:void 0,g:null!==(u=W.browserLcid)&&void 0!==u?u:void 0,h:null!==(s=W.browserMajorVersion)&&void 0!==s?s:void 0,i:null!==(c=W.browserVersion)&&void 0!==c?c:void 0,j:null!==(l=W.clientVersion)&&void 0!==l?l:void 0,k:null!==(d=W.datacenter)&&void 0!==d?d:void 0,l:null!==(f=W.dataCulture)&&void 0!==f?f:void 0,m:null!==(v=W.flightsImpressionId)&&void 0!==v?v:void 0,n:null!==(h=W.host)&&void 0!==h?h:void 0,o:null!==(p=W.isAnonymousUser)&&void 0!==p?p:void 0,p:null!==(m=W.isBusinessUser)&&void 0!==m?m:void 0,q:null!==(S=W.isEduUser)&&void 0!==S?S:void 0,r:null!==(H=W.isSynthetic)&&void 0!==H?H:void 0,s:null!==(w=W.loggableUserId)&&void 0!==w?w:void 0,t:null!==(b=W.loggableUserIdSpace)&&void 0!==b?b:void 0,u:null!==(g=W.ring)&&void 0!==g?g:void 0,v:null!==(I=W.serverDocId)&&void 0!==I?I:void 0,w:null!==(A=W.session_id)&&void 0!==A?A:void 0,x:null!==(C=W.sessionOrigin)&&void 0!==C?C:void 0,y:null!==(U=W.tenantId)&&void 0!==U?U:void 0,z:null!==(R=W.uiHost)&&void 0!==R?R:void 0,aa:null!==(y=W.wfeVersion)&&void 0!==y?y:void 0,ab:null!==(N=W.fileExtension)&&void 0!==N?N:void 0,ac:null!==(T=W.uiHostIntegrationType)&&void 0!==T?T:void 0,ad:null!==(E=W.osVersion)&&void 0!==E?E:void 0,af:null!==(F=W.networkDownlink)&&void 0!==F?F:void 0,ag:null!==(D=W.networkDownlinkMax)&&void 0!==D?D:void 0,ah:null!==(k=W.networkEffectiveType)&&void 0!==k?k:void 0,ai:null!==(P=W.networkRTT)&&void 0!==P?P:void 0,aj:null!==(O=W.networkSaveData)&&void 0!==O?O:void 0,ak:null!==(x=W.networkType)&&void 0!==x?x:void 0,al:null!==(K=W.userLicenseType)&&void 0!==K?K:void 0})},this.xn=function(){e.Dn(),e.nn=window.setTimeout((function(){e.xn()}),e.Ke.We)},this.Kn=function(){e.Hn&&e.Hn.forEach((function(n){n&&e.Wn(n,!0)}))},this.Wn=function(n,t){var i={};i.n=n,e.Nn(3,i,n,t)},this.Mn=function(){e.Hn&&(e.mn=Date.now(),e.Kn()),e.jn()},this.jn=function(n){void 0===n&&(n=e.Ke.Je),e.Sn=window.setTimeout((function(){e.Mn()}),n)},this.Gn=function(){e.Ye||(e.Ye=!0,e.en=!0,e.xn())},this._n=function(){0!==e.Sn&&(window.clearTimeout(e.Sn),e.Sn=0)},this.Ln=function(){if(e.Ke.Me&&e.Ke.je&&e.Ke.qe&&""!==e.Ke.qe&&e.Ke.Be&&""!==e.Ke.Be)try{if("undefined"==typeof Worker)return void e.Bn(1);if(!e.Ke.Be)return void e.Bn(2);e.Bn(3);var n=new Blob(["try{importScripts('".concat(encodeURI(e.Ke.Be),"');}catch(e){self.postMessage({i:14,l:'W',r:e.toString()})}")],{type:"application/javascript"});e.En=new Worker(URL.createObjectURL(n)),e.En.onmessage=function(n){try{var t=n.data;e.Bn(t.i,t.r)}catch(n){e.Bn(5,n.toString())}},e.En.postMessage({t:5,v:e.Ke.qe}),e.En.postMessage({t:6})}catch(n){e.Bn(6,n.toString())}},this.Jn=function(n,t){var i;if(n.b.length>0||n.e.length>0||n.q.length>0||n.k.length>0||n.l.length>0)try{return null===(i=e.En)||void 0===i||i.postMessage({t:7,k:"".concat(n.d.w,".").concat(t),v:n}),0}catch(n){var o=e.Vn(n);return e.Bn(15,o),1}return 2},this.Pn=function(n,t,i,o){n&&void 0!==t&&(e.an[n]||(e.an[n]={k:n,t,a:!0===i,o:null!=o?o:void 0},i&&(e.Pe.push(n),e.Dn())))},this.qn=function(n){e.$e=-1,n?(e.mn=Date.now(),e.jn(),e.Gn()):e.Dn()},this.zn=function(n){return!!e.gn||(e.Bn(0,null==n?void 0:n.toString()),!1)},this.Rn=function(n,t,o){if(n){var r=e.Ke.Ve;if(e.wn&&(o<=0||!e.tn)&&1!==e.Jn(n,t))return;if(!(o<=0)){var a=e.Zn(n,!1);if(null!==a){if(e.rn())try{if(void 0!==navigator.sendBeacon){if(a.length>=65536&&e.Ke.Ge){var u=(0,i.pi)((0,i.pi)({},n),{a:e.De}),s=e.Zn(u,!0);if(null===s)return;navigator.sendBeacon(r,s)}else navigator.sendBeacon(r,a);return}}catch(e){}var c=new XMLHttpRequest;c.open("POST",r,!0),c.onreadystatechange=function(){c.readyState===XMLHttpRequest.DONE&&(200===c.status?e.wn||(e.wn=!0):e.bn<e.Ke.ze?(e.bn+=1,window.setTimeout((function(){e.bn-=1,e.Rn(n,t,o-1)}),e.Ke.Qe)):e.wn&&e.Jn(n,t))},c.send(a)}}}},this.Bn=function(n,t){var i={i:n,r:t};e.Nn(4,i,n.toString())},this.Vn=function(e){var n=void 0;return"string"==typeof e?n=e:e instanceof Error&&(n=e.name+" "+e.message,e.stack&&(n+=" "+e.stack)),n},this.Zn=function(n,t){try{return o=n,JSON.stringify(o)}catch(n){var i=e.Vn(n);return i="ModifiedPayload: "+t+" | "+i,e.Bn(16,i),null}var o}}return e.getInstance=function(){return e.Qn||(e.Qn=new e),this.Qn},e.prototype.initialize=function(e){if(e)try{return this.Ke=function(e){var n,t,i,o,r,a,u,s,c,l,d,f,v,h,p;return{Oe:null!==(n=e.dimensions)&&void 0!==n?n:void 0,We:null!==(t=e.heartbeatIntervalMs)&&void 0!==t?t:3e5,Me:null!==(i=e.isHealthEnabled)&&void 0!==i&&i,je:null!==(o=e.isOfflineEnabled)&&void 0!==o&&o,Ge:null!==(r=e.isErrorPartCEnabled)&&void 0!==r&&r,_e:null!==(a=e.loggerMaxIntervalMs)&&void 0!==a?a:3e4,Le:null!==(u=e.loggerMaxQueueSize)&&void 0!==u?u:25,Be:null!==(s=e.offlineWorkerUrl)&&void 0!==s?s:"",qe:null!==(c=e.absoluteRemoteTelemetryUrlForOfflineWorker)&&void 0!==c?c:"",Je:null!==(l=e.recordPillarToWarmPipelineIntervalMs)&&void 0!==l?l:864e5,Ve:null!==(d=e.remoteTelemetryUrl)&&void 0!==d?d:"",ze:null!==(f=e.maxConcurrentRetries)&&void 0!==f?f:3,Ze:null!==(v=e.retryMaxAttempts)&&void 0!==v?v:3,Qe:null!==(h=e.retryDelayMs)&&void 0!==h?h:15e3,Xe:null!==(p=e.disabledHealthEvents)&&void 0!==p?p:new Set}}(e),this.On(),this.Fn(),this.Ln(),this.gn=!0,void this.Bn(7)}catch(e){}this.gn=!1},e.prototype.addOrUpdatePartCDimension=function(e,n){this.zn(0)&&e&&(this.De.hasOwnProperty(e)&&this.De[e]===n||(this.Tn(!0),this.De[e]=n,this.xe+=1,this.Dn(),this.Kn()))},e.prototype.addOrUpdateErrorPartCDimension=function(e,n){this.Ke.Ge&&e&&(this.ke[e]=n)},e.prototype.addQosPillar=function(e){if(e){var n=0===this.Hn.length;-1===this.Hn.indexOf(e)&&(this.Hn.push(e),this.Wn(e,!1),this.qn(n))}},e.prototype.recordBsqmQosError=function(e,n,t){if(this.zn(1)&&(this.Xn(!1),this.Kn(),e)){var i={b:e,v:n,d:null==t?void 0:t.durationMs,p:o(null==t?void 0:t.extendedProperties),s:this.Hn,i:null==t?void 0:t.inStaging};this.Nn(0,i,e),this.shutdown(!0)}},e.prototype.recordKpiFailure=function(e,n,t,i,o){this.kn(e,!0,0,o,n,i,t)},e.prototype.recordKpiImpliedFailure=function(e,n,t,i,o,r){this.kn(e,!1,1,r,n,i,t,a.o.FailureBased,!1,o)},e.prototype.recordKpiImpliedSuccess=function(e,n,t){this.kn(e,!1,2,t,void 0,void 0,void 0,a.o.FailureBased,!1,n)},e.prototype.recordKpiSuccess=function(e,n){this.kn(e,!0,3,n)},e.prototype.recordKpiUsage=function(e,n,t,i){this.kn(e,!1,4,{extendedProperties:i},void 0,void 0,void 0,n,!1,t)},e.prototype.recordKpiUsageForAlertableKpi=function(e,n,t){if(e){var i=!0,o=this.an[e];o&&(i=o.t===a.o.FailureBased),this.kn(e,!1,4,{extendedProperties:t},void 0,void 0,void 0,a.o.FailureBased,!0,n),i&&this.Gn()}},e.prototype.recordQosError=function(e,n,t,i,r,a,u){if((!a||this.zn(2))&&e&&n){var s={n:e,x:t,z:i,l:r,v:n,e:a,d:null==u?void 0:u.durationMs,p:o(null==u?void 0:u.extendedProperties),s:this.Hn,i:null==u?void 0:u.inStaging};this.Nn(2,s,e),a&&(this.Xn(!1),this.Kn(),this.shutdown(!0))}},e.prototype.removeQosPillar=function(e){if(e){var n=this.Hn.indexOf(e);n>-1&&(this.Hn.splice(n,1),this.qn(!1)),0===this.Hn.length&&this._n()}},e.prototype.resumeAllHealthTimers=function(){if(this.Ye&&!this.en&&this.xn(),0===this.Sn&&0!==this.mn){var e=Date.now()-this.mn;e>=this.Ke.Je||e<=0?this.Mn():this.jn(this.Ke.Je-e)}},e.prototype.setHandlerForIsAppShuttingDown=function(e){e&&(this.rn=e)},e.prototype.setIsAppOnline=function(e){var n;this.zn(3)&&(!this.tn&&e&&(null===(n=this.En)||void 0===n||n.postMessage({t:6,v:this.rn()})),this.tn=e)},e.prototype.shutdown=function(e){var n;void 0===e&&(e=!1),this.Ke.Me&&(this.In(),this.Xn(!1),this.rn=function(){return!0},this.Cn(),(!e||e&&this.tn)&&(null===(n=this.En)||void 0===n||n.terminate()))},e.prototype.stopAllHealthTimers=function(){this.Xn(!0)},e.prototype.Xn=function(e){this.en=!1,this.$e=-1,0!==this.nn&&(window.clearTimeout(this.nn),this.nn=0),this._n(),e&&this.Cn()},e.prototype.updatePartADimensions=function(e){var n=this;if(e&&this.zn(4)){var t=!1;Object.keys(e).forEach((function(i){void 0!==e[i]&&null!==e[i]&&""!==e[i]&&n.Ke.Oe[i]!==e[i]&&(n.Ke.Oe[i]=e[i],t=!0)})),t&&(this.Tn(),this.On(),this.xe+=1,this.Dn(),this.Kn())}},e.prototype.flushAndSetNewEndpoint=function(e,n){var t;e.localeCompare(null!==(t=this.Ke.Ve)&&void 0!==t?t:"",void 0,{sensitivity:"accent"})&&(this.Tn(!1),this.Ke.Ve=e,n&&n())},e}()},6499:(e,n,t)=>{"use strict";var i,o,r,a,u,s;t.d(n,{Xv:()=>o,Yn:()=>a,nd:()=>r,sX:()=>u}),function(e){e[e.external=0]="external",e[e.msa=1]="msa",e[e.aad=2]="aad"}(i||(i={})),function(e){e.init="SharedAuth_Init",e.showSignInCancelButtons="SharedAuth_ShowSignInCancelButtons",e.tryGetToken="SharedAuth_TryGetToken",e.tryLogin="SharedAuth_TryLogin"}(o||(o={})),function(e){e.closeDialog="SharedAuth_CloseDialog",e.getTokenResponse="SharedAuth_GetTokenResponse",e.hideDialog="SharedAuth_HideDialog",e.interactiveFlowReady="SharedAuth_InteractiveFlowReady",e.loginResponse="SharedAuth_LoginResponse",e.scriptInitialized="SharedAuth_ScriptInitialized",e.scriptLoaded="SharedAuth_ScriptLoaded"}(r||(r={})),function(e){e.registerPrimary="SharedAuthWorker_RegisterPrimary",e.unregisterPrimary="SharedAuthWorker_UnregisterPrimary",e.getToken="SharedAuthWorker_GetToken",e.postToken="SharedAuthWorker_PostToken"}(a||(a={})),function(e){e.registrationResponse="SharedAuthWorker_RegistrationResponse",e.brokerToken="SharedAuthWorker_BrokerToken",e.tokenReady="SharedAuthWorker_TokenReady",e.noPrimaryReady="SharedAuthWorker_NoPrimaryReady"}(u||(u={})),function(e){e.timeout="Timeout",e.general="Token Renewal Failed",e.renewal="token_renewal_error"}(s||(s={}))},1515:(e,n,t)=>{"use strict";t.d(n,{Eq:()=>r,Fd:()=>u,WR:()=>o,e0:()=>i,nU:()=>a});var i=new URL(window.location.href);function o(e){return e&&["aad","msa"].includes(e)?e:"aad"}function r(e){return"93d53678-613d-4013-afc1-62e9e444a0a5"===e}function a(e){return e instanceof Error?"".concat(e.name,": ").concat(e.message):"string"==typeof e?e:JSON.stringify(e)}var u=function(){function e(){var e=this;this.startTime=0,this.$n=function(){},this.et=function(){},this.promise=new Promise((function(n,t){e.$n=n,e.et=t}))}return e.prototype.resolve=function(e){this.$n(e)},e.prototype.reject=function(e){this.et(e)},e}()},7442:(e,n,t)=>{"use strict";var i;t.d(n,{W:()=>i}),function(e){e[e.nt=0]="msoulscat_ES_EWAJS",e[e.tt=1]="msoulscat_ES_EWAJSGrid",e[e.it=6]="msoulscat_ES_EWAJSChart",e[e.ot=202]="msoulscat_MSOSP_FileMenuCommands",e[e.rt=225]="msoulscat_MSOSP_OTelJS",e[e.ut=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.st=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.ct=301]="msoulscat_Wac_WordViewer",e[e.lt=306]="msoulscat_Wac_BrowserGeneral",e[e.ft=320]="msoulscat_Wac_TaskPane",e[e.vt=339]="msoulscat_Wac_OneNoteGeneral",e[e.ht=340]="msoulscat_Wac_Ribbon",e[e.St=356]="msoulscat_Wac_WacFeedback",e[e.Ht=379]="msoulscat_Wac_WopiPendingApplication",e[e.wt=383]="msoulscat_Wac_Telemetry",e[e.bt=391]="msoulscat_Wac_WacCatchUpActivities",e[e.gt=394]="msoulscat_Wac_Dictation",e[e.It=395]="msoulscat_Wac_OneNoteSync",e[e.At=700]="msoulscat_Wac_VisioApp",e[e.Ct=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.Ut=800]="msoulscat_Wac_PptAnimation",e[e.Rt=833]="msoulscat_Wac_PptLive",e[e.yt=834]="msoulscat_Wac_PptMWeb",e[e.Nt=844]="msoulscat_Wac_PptDataSync",e[e.Tt=848]="msoulscat_Wac_PptFluidRuntime",e[e.Et=815]="msoulscat_Wac_PptShape",e[e.Ft=817]="msoulscat_Wac_PptSession",e[e.Dt=830]="msoulscat_Wac_PptSlideshow",e[e.kt=822]="msoulscat_Wac_PptView",e[e.Pt=846]="msoulscat_Wac_PptVideos",e[e.Ot=2300]="msoulscat_Wac_VersionHistory",e[e.xt=302]="msoulscat_Wac_WordPresence",e[e.Kt=3e3]="msoulscat_Wac_OAuth",e[e.Wt=3005]="msoulscat_Wac_WordVersionHistory",e[e.Mt=3006]="msoulscat_Wac_LivePersonaCard",e[e.jt=3012]="msoulscat_Wac_CatchUpFlyout",e[e.Gt=3016]="msoulscat_Wac_WordDesigner",e[e._t=3021]="msoulscat_Wac_ModernFontPicker",e[e.Lt=3027]="msoulscat_Wac_UnifiedUiHost",e[e.Bt=3033]="msoulscat_Wac_EquationTools",e[e.Jt=1401]="msoulscat_Osf_Latency",e[e.Vt=1402]="msoulscat_Osf_Notification",e[e.qt=1403]="msoulscat_Osf_Runtime",e[e.zt=3041]="msoulscat_Wac_AiMaker",e[e.Zt=3043]="msoulscat_Wac_AiRewrite",e[e.Qt=3044]="msoulscat_Wac_AiInsert",e[e.Xt=3047]="msoulscat_Wac_AiSummarize",e[e.Yt=3048]="msoulscat_Wac_CopilotCompose",e[e.$t=3049]="msoulscat_Wac_Skittles"}(i||(i={}))},3869:(e,n,t)=>{"use strict";var i;t.d(n,{G:()=>i}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(i||(i={}))},2424:(e,n,t)=>{"use strict";t.d(n,{o:()=>u});var i=t(7442),o=t(3869),r=t(7710),a=t(5e3);function u(e,n,t,s,c,l,d){void 0===s&&(s=!1),void 0===c&&(c=!1),void 0===l&&(l=!0),void 0===d&&(d=!1);var f=Date.now();return(0,a.p)()&&window.performance.mark("wopiDataStartTime"),n(e,s,c,t).then((function(n){var u,s,c,l;if(!n){var d="Graph call failed";return null==t||t.ULS.sendTraceTag(553726284,i.W.Lt,o.G.Error,"GetWopiData: Failed to get the driveItem. [ErrorMessage: ".concat(d,"]")),Promise.reject(d)}var v={docUrl:null!==(u=n.webDavUrl)&&void 0!==u?u:e.docUrl,driveId:null!==(c=null===(s=null==n?void 0:n.parentReference)||void 0===s?void 0:s.driveId)&&void 0!==c?c:e.driveId,docId:null!==(l=null==n?void 0:n.id)&&void 0!==l?l:e.docId,fileName:n.name};null==t||t.ULS.sendTraceTag(553726285,i.W.Lt,o.G.Info,"GetWopiData: Fetched documentIdentifier. [IsValid: ".concat(!!v,"]"));var h=Promise.resolve(v);null==t||t.ULS.sendTraceTag(553726286,i.W.Lt,o.G.Info,"GetWopiData: Fetched documentIdentifier. [IsValid: ".concat(!!h,"]"));var p=(0,r.YI)(n,t);null==t||t.ULS.sendTraceTag(553726287,i.W.Lt,o.G.Info,"GetWopiData: Getting WopiHostData from drive item. [IsValid: ".concat(!!p,"]"));var m={startTime:f,endTime:Date.now()};return(0,a.p)()&&window.performance.mark("wopiDataEndTime"),{fetchedDocumentIdentifier:h,wopiHostData:p,fetchDiagnostics:m}})).catch((function(r){return null==t||t.ULS.sendTraceTag(520729472,i.W.Lt,o.G.Warning,"GetWopiData: General getWopiData error. [Error: ".concat(JSON.stringify(r),"][FailureReason: ").concat(null==r?void 0:r.failure,"]")),l&&(null==r?void 0:r.retry)?(null==t||t.ULS.sendTraceTag(544306772,i.W.Lt,o.G.Error,"GetWopiData: Retrying getWopiData. [Error: ".concat(JSON.stringify(r),"][FailureReason: ").concat(null==r?void 0:r.failure,"]")),u(e,n,t,s,c,!1)):l&&d&&"accessDenied"===(null==r?void 0:r.errorCode)?new Promise((function(e){setTimeout(e,3e3),null==t||t.ULS.sendTraceTag(523269073,i.W.Lt,o.G.Warning,"GetWopiData: Retrying getWopiData after retryIntervalForWopiDataRequest: ".concat(3e3,"ms. [Error: ").concat(JSON.stringify(r),"][FailureReason: ").concat(null==r?void 0:r.failure,"]"))})).then((function(){return u(e,n,t,s,c,!1)})):(null==t||t.ULS.sendTraceTag(544306773,i.W.Lt,o.G.Error,"GetWopiData: Not retrying getWopiData. [Error: ".concat(JSON.stringify(r),"][ShouldRetry: ").concat(l,"][FailureReason: ").concat(null==r?void 0:r.failure,"]")),Promise.reject(r))}))}},7710:(e,n,t)=>{"use strict";t.d(n,{YI:()=>s,q_:()=>u});var i=t(9850),o=t(7442),r=t(3869),a=t(8577);function u(e){return e.shareUrl?e.shareUrl:e.docId&&e.driveId?"".concat(e.driveId,"_").concat(e.docId):e.docUrl?e.docUrl:e.isNewFile&&e.fileName?"".concat(e.fileName,"_").concat(a.T[e.fileType]):e.baseUrl&&e.fileId?"".concat(e.baseUrl,"_").concat(e.fileId):void 0}function s(e,n){var t,a,u,s,c,l,d,f=!!(null==e?void 0:e.openWith),v=!!(null===(t=null==e?void 0:e.openWith)||void 0===t?void 0:t.wac);return null==n||n.ULS.sendTraceTag(553916429,o.W.Lt,r.G.Info,"GetWopiHostDataFromItem: [ValidOpenWith: ".concat(f,"][ValidWac: ").concat(v,"]")),{bundleStaleness:e.officeBundle?e.officeBundle.bundleStaleness:0,bundleUrl:e.officeBundle?e.officeBundle.url:"",bundleVersion:e.officeBundle?e.officeBundle.version:"",sharepointSiteUrl:e.sharepointIds?e.sharepointIds.siteUrl:"",downloadUrl:e["@content.downloadUrl"]||e["@microsoft.graph.downloadUrl"],eTag:e.eTag,fileName:e.name,fileSize:e.size,irmEnabled:(null===(a=e.file)||void 0===a?void 0:a.contentSensitivityLabelProtected)||(null===(u=e.file)||void 0===u?void 0:u.irmEffectivelyEnabled)||(null===(s=e.sensitivityLabel)||void 0===s?void 0:s.protectionEnabled)||(null===(c=e.file)||void 0===c?void 0:c.irmEnabled),isNewFile:!1,readOnly:e.currentUserRole&&e.currentUserRole.readOnly,blocksDownload:e.currentUserRole&&e.currentUserRole.blocksDownload,wac:e.openWith.wac,sharePointInfo:(0,i.pi)({},e.sharepointIds),webUrl:e.webUrl,preSeededSessionKey:null===(l=null==e?void 0:e.wacSession)||void 0===l?void 0:l.preSeededSessionKey,preSeededWacSessionId:null===(d=null==e?void 0:e.wacSession)||void 0===d?void 0:d.preSeededWacSessionId,webDavUrl:e.webDavUrl}}},8076:(e,n,t)=>{"use strict";t.d(n,{R:()=>u});var i,o=t(7442),r=t(3869),a=t(3737);function u(e,n,t,u,s){if(u){var c=function(e){switch(e){case a.KX.PostMessage_RefreshSessionInfo:return i.sendSessionInfo;case a.KX.PostMessage_GrantPermissions:return i.sendUserAccessAndPermissions;case a.KX.PostMessage_SetAuthToken:return i.sendAuthToken;case a.KX.PostMessage_HostAccessibilityLoopComplete:return i.continueAccessibilityLoop;case a.KX.PostMessage_SetHostWopiInfoFromUrl:return i.sendWopiInfo;case a.KX.PostMessage_MoveToFolderCompleted:return i.moveToFolder;case a.KX.PostMessage_CompleteFilePicker:return i.completeSharedFilePicker;case a.KX.PostMessage_SendCustomAuthConfig:return i.sendCustomAuthConfig;case a.KX.PostMessage_SetDavUrlFromIds:return i.sendDavUrl;case a.KX.PostMessage_BlurFocus:return i.blurFocus;case a.KX.PostMessage_PopState:return i.popState;case a.KX.PostMessage_GrabFocus:return i.grabFocus;case a.KX.PostMessage_HostGetClientUrl:return i.getClientUrl;case a.KX.PostMessage_HostGetWebUrl:return i.getWebUrl;case a.KX.PostMessage_OwlFrameDiagnostics:return i.sendOwlFrameDiagnostics;default:return}}(e);if(c){var l=c;u.run(l,n).catch((function(e){return null==s?void 0:s.ULS.sendTraceTag(512337544,o.W.Lt,r.G.Warning,"Failed to send post message. officeDocumentSession.run returned error: ".concat(e))}))}}else t?t.then((function(t){t?function(e,n,t,i){var a,u=null;try{u=new URL(e)}catch(n){return void(null==i||i.ULS.sendTraceTag(541180047,o.W.Lt,r.G.Warning,"Failed to send post message. could not create url from ".concat(e," with error: ").concat(n)))}var s=u.origin,c={MessageId:n,SendTime:(new Date).getTime(),Values:t},l=JSON.stringify(c),d=document.getElementById("WebApplicationFrame");d?null===(a=null==d?void 0:d.contentWindow)||void 0===a||a.postMessage(l,s):null==i||i.ULS.sendTraceTag(541180048,o.W.Lt,r.G.Warning,"Failed to send post message. Could not find iframe")}(t,e,n,s):null==s||s.ULS.sendTraceTag(541180045,o.W.Lt,r.G.Warning,"Failed to send post message. appUrl is null")})).catch((function(e){return null==s?void 0:s.ULS.sendTraceTag(512337543,o.W.Lt,r.G.Warning,"Failed to send post message. appUrlPromise failed to resolve with error: ".concat(e))})):null==s||s.ULS.sendTraceTag(541180046,o.W.Lt,r.G.Warning,"Failed to send post message. Both documentSession and appUrlPromise are null")}!function(e){e.blurFocus="blurFocus",e.boot="boot",e.completeCreateNew="completeCreateNew",e.continueAccessibilityLoop="continueAccessibilityLoop",e.createNew="createNew",e.dispose="dispose",e.grabFocus="grabFocus",e.moveToFolder="moveToFolder",e.popState="popState",e.sendChannelId="sendChannelId",e.sendConvId="sendConvId",e.teamsUsersReply="teamsUsersReply",e.teamsUserMentionReply="teamsUserMentionReply",e.backButtonPressed="backButtonPressed",e.getClientUrl="getClientUrl",e.getWebUrl="getWebUrl",e.sendOwlFrameDiagnostics="sendOwlFrameDiagnostics",e.rename="rename",e.completeSharedFilePicker="completeSharedFilePicker",e.sendAccessToken="sendAccessToken",e.sendAuthToken="sendAuthToken",e.sendCustomAuthConfig="sendCustomAuthConfig",e.sendEmbeddedViewUrl="sendEmbeddedViewUrl",e.sendFrameTrustResult="sendFrameTrustResult",e.sendHWRTelemetry="sendHWRTelemetry",e.sendSessionInfo="sendSessionInfo",e.sendUserAccessAndPermissions="sendUserAccessAndPermissions",e.sendWopiInfo="sendWopiInfo",e.sendDavUrl="sendDavUrl",e.switchMode="switchMode",e.signalShared="signalShared"}(i||(i={}))},6481:(e,n,t)=>{"use strict";var i;function o(e){var n=e.toUpperCase();return"CHC"===n||"DEC"===n||"EUC"===n||"EURPPC"===n||"FRC"===n||"SEC"===n||"NOC"===n?i.EuropeanUnion:i.RestOfWorld}t.d(n,{U:()=>i,g:()=>o}),function(e){e[e.RestOfWorld=0]="RestOfWorld",e[e.EuropeanUnion=1]="EuropeanUnion"}(i||(i={}))},3448:(e,n,t)=>{"use strict";t.d(n,{A8:()=>s,PO:()=>c,S$:()=>a,XQ:()=>u,Y6:()=>d,fy:()=>r,tf:()=>f,w8:()=>l,wl:()=>o});var i=t(6481);function o(e,n){switch(e){case"FASTFOOD":return"https://ffc-common.online.office.com/suite/";case"MSIT":return"https://ppc-common.online.office.com/suite/";case"PRODUCTION":default:return n===i.U.EuropeanUnion?"https://euc-common.online.office.com/suite/":"https://common.online.office.com/suite/";case"GALLATIN":return"https://common.partner.officewebapps.cn/suite/";case"USGOV":return"https://gbc-common.online.office.com/suite/";case"TRAILBLAZER":return"https://common.gov.online.office365.us/suite/";case"PATHFINDER":return"https://common.dod.online.office365.us/suite/";case"AIRGAP08":return"https://common.wac.online.office.eaglex.ic.gov/suite/";case"AIRGAP09":return"https://common.wac.online.office.microsoft.scloud/suite/"}}function r(e,n){return o(e,n)+"RemoteUls.ashx"}function a(e,n,t){var i=o(e,t)+"RemoteTelemetry.ashx";return n&&(i+="?usid="+n),i}function u(e){return o(e)+"OpenDocument.ashx"}function s(e){switch(e){case"GALLATIN":return"https://microsoftgraph.chinacloudapi.cn";case"TRAILBLAZER":return"https://graph.microsoft.us";case"PATHFINDER":return"https://dod-graph.microsoft.us";case"AIRGAP08":return"https://graph.eaglex.ic.gov";case"AIRGAP09":return"https://graph.microsoft.scloud";default:return"https://graph.microsoft.com"}}function c(e){switch(e){case"TRAILBLAZER":return"https://admin.onedrive.us/share";case"PATHFINDER":return"https://od.apps.mil/share";case"AIRGAP08":return"https://odweba.svc.ms.eaglex.ic.gov";case"AIRGAP09":return"https://odweba.svc.ms.microsoft.scloud";default:return"https://www.odwebp.svc.ms/share"}}function l(){return"res.cdn.office.net/officehub"}function d(){return"https://microsoft-my.sharepoint.com"}function f(){return"https://microsoft.sharepoint.com"}},2106:(e,n,t)=>{"use strict";var i;t.d(n,{W:()=>i}),function(e){e[e.Unknown=0]="Unknown",e[e.OK=200]="OK",e[e.Created=201]="Created",e[e.NoContent=204]="NoContent",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.RequestTimeout=408]="RequestTimeout",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.RangeNotSatisfiable=416]="RangeNotSatisfiable",e[e.Locked=423]="Locked",e[e.Throttled=429]="Throttled",e[e.InternalServiceError=500]="InternalServiceError",e[e.NotImplemented=501]="NotImplemented",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.InsufficientStorage=507]="InsufficientStorage",e[e.UnexpectedResponse=700]="UnexpectedResponse",e[e.TokenRefreshFailed=701]="TokenRefreshFailed",e[e.TokenUnavailable=702]="TokenUnavailable",e[e.RetryFailed=703]="RetryFailed",e[e.AlternateResponse=704]="AlternateResponse",e[e.Cancelled=705]="Cancelled",e[e.Offline=706]="Offline",e[e.Timeout=707]="Timeout",e[e.DecryptionError=708]="DecryptionError",e[e.CacheMiss=709]="CacheMiss"}(i||(i={}))},3737:(e,n,t)=>{"use strict";var i,o,r,a;t.d(n,{Dm:()=>o,E_:()=>i,KX:()=>r}),function(e){e.Event_DocumentReboot="DocReboot",e.Event_SetOverlayContent="SetOverlayContent",e.Event_GetWopiInfoFromUrl="WopiInfoFromUrl",e.Event_Unloaded="Unloaded",e.Event_MoveToFolder="MoveToFolder",e.Event_SharedFilePicker="FilePicker",e.Event_GetCustomAuthConfig="GetCustomAuthConfig",e.Event_GetDavUrlFromIds="DavUrlFromIds"}(i||(i={})),function(e){e.PostMessage_FileRenamed="File_Rename",e.PostMessage_Close="UI_Close",e.PostMessage_EditModeSwitch="UI_Edit",e.PostMessage_FileVersion="UI_FileVersions",e.PostMessage_SaveStatus="UI_SaveStatus",e.PostMessage_Share="UI_Sharing",e.PostMessage_Workflow="UI_Workflow",e.PostMessage_UserActivity="User_Activity",e.PostMessage_EditNotification="Edit_Notification",e.PostMessage_CheckUserAccess="UI_CheckUserAccessAndGrantPermissions",e.PostMessage_PostMessageDocReboot="App_DocReboot",e.PostMessage_AppRefreshSessionInfo="App_RefreshSessionInfo",e.PostMessage_AppCreateNewDocument="App_CreateNewDocument",e.PostMessage_GetAuthToken="App_GetAuthToken",e.PostMessage_AccessibilityLoopComplete="App_AccessibilityLoopComplete",e.PostMessage_GetClientUrlComplete="App_GetClientUrlComplete",e.PostMessage_GetWebUrlComplete="App_GetWebUrlComplete",e.PostMessage_ActionComplete="Wac_ActionComplete",e.PostMessage_OpenInBrowser="UI_OpenInBrowser",e.PostMessage_AppGetCustomAuthConfig="App_GetCustomAuthConfig",e.PostMessage_AppPushState="App_PushState",e.PostMessage_CAAEMessage="CAAEMessage",e.PostMessage_FileEmbed="UI_FileEmbed"}(o||(o={})),function(e){e.PostMessage_RefreshSessionInfo="Host_RefreshSessionInfo",e.PostMessage_GrantPermissions="CheckUserAccessAndGrantPermissions_Result",e.PostMessage_SetOverlayContent="SetOverlayContent",e.PostMessage_SetAuthToken="Host_SetAuthToken",e.PostMessage_SetHostWopiInfoFromUrl="Host_WopiInfoFromUrl",e.PostMessage_HostAccessibilityLoopComplete="Host_AccessibilityLoopComplete",e.PostMessage_HostGetClientUrl="Host_GetClientUrl",e.PostMessage_HostGetWebUrl="Host_GetWebUrl",e.PostMessage_MoveToFolderCompleted="Host_MoveToFolder",e.PostMessage_CompleteFilePicker="Host_FilePicker",e.PostMessage_SendCustomAuthConfig="Host_SetCustomAuthConfig",e.PostMessage_SetDavUrlFromIds="Host_DavUrlFromIds",e.PostMessage_BlurFocus="Blur_Focus",e.PostMessage_PopState="App_PopState",e.PostMessage_GrabFocus="Grab_Focus",e.PostMessage_OwlFrameDiagnostics="OwlFrameDiagnostics"}(r||(r={})),function(e){e.AccessToken="AccessToken",e.FileGetUrl="FileGetUrl"}(a||(a={}))},8880:(e,n,t)=>{"use strict";t.d(n,{G2:()=>u,pb:()=>c,zP:()=>s});var i=t(9850),o=t(8087),r=t(6741),a=t(3448),u=function(){function e(e,n){var t;"string"==typeof e?this.sessionId=e:(t=(0,i.CR)(e,1),this.sessionId=t[0]),this.environment=n,this.logger=this.setUlsLogger(this.sessionId)}return e.prototype.setUlsLogger=function(e){var n=(0,a.fy)(this.environment);return(0,o.L8)({remoteUlsEndpoint:n,sessionId:e})},e}(),s=function(e,n,t,i,o,u){var s,c=(0,a.S$)(t,e),l={application:n.toString(),applicationMode:"UnifiedUiHost",applicationModeExtended:"UNIFIEDUIHOST",session_id:e,clientVersion:null!=i?i:"n/a",isSynthetic:u};this.health=r.S.getInstance(),this.health.initialize({isHealthEnabled:!0,isOfflineEnabled:!1,remoteTelemetryUrl:c,dimensions:l}),this.health.addOrUpdatePartCDimension("UUIHTargetApp",n.toString()),this.health.addOrUpdatePartCDimension("HealthSourceComponent","UnifiedUiHost"),this.health.addOrUpdatePartCDimension("WiseEnvironment",t.toString()),this.health.addOrUpdatePartCDimension("Exposure",null!==(s=null==o?void 0:o.toString())&&void 0!==s?s:"n/a")};function c(e){var n,t=performance.getEntriesByType("navigation"),i=e?null===(n=t[0])||void 0===n?void 0:n.toJSON():t[0].toJSON();return{connectEnd:i.connectEnd,connectStart:i.connectStart,decodedBodySize:i.decodedBodySize,domainLookupEnd:i.domainLookupEnd,domainLookupStart:i.domainLookupStart,domComplete:i.domComplete,domContentLoadedEventEnd:i.domContentLoadedEventEnd,domContentLoadedEventStart:i.domContentLoadedEventStart,domInteractive:i.domInteractive,duration:i.duration,encodedBodySize:i.encodedBodySize,entryType:i.entryType,fetchStart:i.fetchStart,initiatorType:i.initiatorType,loadEventEnd:i.loadEventEnd,loadEventStart:i.loadEventStart,nextHopProtocol:i.nextHopProtocol,redirectCount:i.redirectCount,redirectEnd:i.redirectEnd,redirectStart:i.redirectStart,requestStart:i.requestStart,responseEnd:i.responseEnd,responseStart:i.responseStart,secureConnectionStart:i.secureConnectionStart,serverTiming:i.serverTiming,startTime:i.startTime,transferSize:i.transferSize,type:i.type,unloadEventEnd:i.unloadEventEnd,unloadEventStart:i.unloadEventStart,workerStart:i.workerStart}}},6324:(e,n,t)=>{"use strict";var i,o,r,a,u,s;t.d(n,{$c:()=>i,AU:()=>u,DG:()=>a,I$:()=>s,J4:()=>c,c:()=>l,cS:()=>r,yv:()=>o}),function(e){e.DriveId="drive",e.ItemId="item",e.DocUrl="file",e.ContentUri="contenturi",e.Nav="nav"}(i||(i={})),function(e){e.ei="DavUrlFromIds",e.ni="WopiAuthRefresh",e.ti="WopiAuthFetch",e.ii="WopiInfoFromUrl"}(o||(o={})),function(e){e.QosVeto_ShareDialogExperienceDegraded="ShareDialogExperienceDegraded",e.QosVeto_CreateNewExperienceDegraded="CreateNewExperienceDegraded",e.QosVeto_ExternalLinksExperienceDegraded="ExternalLinksExperienceDegraded",e.QosVeto_WopiAuthExperienceDegraded="WopiAuthExperienceDegraded",e.QosVeto_FilePickerFailed="FilePickerFailed",e.QosVeto_OpenInExperienceFailed="OpenInExperienceFailed",e.QosVeto_OwlFrameExperienceFailed="OwlFrameExperienceFailed"}(r||(r={})),function(e){e.QosError_VroomWopiFailure="VroomWopiFailure",e.QosError_OfficeBootstrapperNotLoaded="OfficeBootstrapperNotLoaded",e.QosError_EncounteredJsApiError="EncounteredJsApiError",e.QosError_FailedToLoadDocument="FailedToLoadDocument",e.QosError_AttemptingToBootDocumentFailed="AttemptingToBootDocumentFailed",e.QosError_DavUrlFromIdsFailure="DavUrlFromIdsFailure",e.QosError_ShareDialogHandlerInitFailure="ShareDialogHandlerInitFailure",e.QosError_ShareDialogHandlerHostReportedFailure="ShareDialogHandlerHostReportedFailure",e.QosError_ShareDialogHandlerGenericFailure="ShareDialogHandlerGenericFailure",e.QosError_ShareDialogHandlerPerfFailure="ShareDialogHandlerPerfFailure",e.QosError_CreateNewHandlerRebootSessionFailure="CreateNewHandlerRebootSessionFailure",e.QosError_CreateNewHandlerCreateDocumentFailure="CreateNewHandlerCreateDocumentFailure",e.QosError_CreateNewHandlerEndSessionFailure="CreateNewHandlerEndSessionFailure",e.QosError_CreateNewHandlerGenericFailure="CreateNewHandlerGenericFailure",e.QosError_WopiRefreshAuthTokenFailure="WopiRefreshAuthTokenFailure",e.QosError_WopiFetchAuthTokenFailure="WopiFetchAuthTokenFailure",e.QosError_WopiInfoFromUrlFailure="WopiInfoFromUrlFailure",e.QosError_FilePickerBootFailed="FilePickerBootFailed",e.QosError_RetrievingWopiHostDataFailed="RetrievingWopiHostDataFailed",e.QosError_SelectedItemNotReturned="SelectedItemNotReturned",e.QosError_SelectedItemMissingProperties="SelectedItemMissingProperties",e.QosError_UrlNotProvided="UrlNotProvided",e.QosError_CallbackNotDefined="CallbackNotDefined",e.QosError_OwlFrameCreationFailure="OwlFrameCreationFailure"}(a||(a={})),function(e){e.oi="Bootstrapfile_WacDocumentVroomError",e.ri="LoadDocument_WacDocumentVroomError",e.si="WacDocumentBootstrapperLoadError",e.ci="WacInitializeWopiPendingError",e.li="WacDocumentGenericBootError",e.di="WacDocumentJsApiV1Error",e.fi="WacDocumentJsApiV2Error"}(u||(u={})),function(e){e.PermissionError="PermissionError",e.NotFound="NotFound",e.Throttling="Throttling",e.Offline="Offline",e.Other="Other"}(s||(s={}));var c,l={};!function(e){e.New="NEW",e.BackstageMru="BACKSTAGE-MRU",e.Reboot="REBOOT"}(c||(c={}))},8563:(e,n,t)=>{"use strict";t.d(n,{Fh:()=>v,vJ:()=>S,i0:()=>H,dt:()=>m});var i=t(7442),o=t(3869),r=function(){function e(){}return e.toFeatureGateConfig=function(e,n){if(null==e||""===e||"null"===e)return[];try{return function(e,n,t){return c(e,n,u,t)}(JSON.parse(e),l(d("FeatureGateConfig")),n)}catch(t){return null==n||n.ULS.sendTraceTag(521413921,i.W.Lt,o.G.Error,'Unable to parse JSON string: "'.concat(e,'", due to expection: ').concat(t)),[]}},e.featureGateConfigToJson=function(e,n){return JSON.stringify(function(e,n,t){return c(e,n,s,t)}(e,l(d("FeatureGateConfig")),n),null,2)},e}();function a(e,n,t,r){if(void 0===r&&(r=""),r?null==t||t.ULS.sendTraceTag(521414033,i.W.Lt,o.G.Error,'Invalid value for key "'.concat(r,'". Expected type ').concat(JSON.stringify(e)," but got ").concat(JSON.stringify(n))):null==t||t.ULS.sendTraceTag(521414034,i.W.Lt,o.G.Error,"Invalid value ".concat(JSON.stringify(n)," for type ").concat(JSON.stringify(e))),"boolean"==typeof e){if("string"==typeof n){var a=function(e){try{var n=JSON.parse(e.toLowerCase());return"boolean"==typeof n&&n}catch(e){return!1}}(n);if("boolean"==typeof a)return a}return!1}return"string"==typeof e?"":"number"==typeof e?0:typeof e==typeof[]?[]:"Date"===e?new Date:"array"===e?[]:"object"===e?{}:void 0}function u(e){if(void 0===e.jsonToJS){var n={};e.props.forEach((function(e){return n[e.json]={key:e.js,typ:e.typ}})),e.jsonToJS=n}return e.jsonToJS}function s(e){if(void 0===e.jsToJSON){var n={};e.props.forEach((function(e){return n[e.js]={key:e.json,typ:e.typ}})),e.jsToJSON=n}return e.jsToJSON}function c(e,n,t,i,o){void 0===o&&(o="");var r=n;if("any"===r)return e;if(null===r)return null===e?e:a(r,e,i);if(!1===r)return a(r,e,i);for(;"object"==typeof r&&void 0!==r.ref;)r=h[r.ref];return Array.isArray(r)?function(e,n){return-1!==e.indexOf(n)?n:a(e,n,i)}(r,e):"object"==typeof r?r.hasOwnProperty("unionMembers")?function(e,n){for(var o=e.length,r=0;r<o;r++){var u=e[r];try{return c(n,u,t,i)}catch(e){}}return a(e,n,i)}(r.unionMembers,e):r.hasOwnProperty("arrayItems")?function(e,n){return Array.isArray(n)?n.map((function(n){return c(n,e,t,i)})):a("array",n,i)}(r.arrayItems,e):r.hasOwnProperty("props")?function(e,n,o){if(null===o||"object"!=typeof o||Array.isArray(o))return a("object",o,i);var r={};return Object.getOwnPropertyNames(e).forEach((function(n){var a=e[n],u=Object.prototype.hasOwnProperty.call(o,n)?o[n]:void 0;r[a.key]=c(u,a.typ,t,i,a.key)})),Object.getOwnPropertyNames(o).forEach((function(a){Object.prototype.hasOwnProperty.call(e,a)||(r[a]=c(o[a],n,t,i,a))})),r}(t(r),r.additional,e):a(r,e,i):r===Date&&"number"!=typeof e?function(e){if(null===e)return null;var n=new Date(e);return isNaN(n.valueOf())?a("Date",e,i):n}(e):function(e,n){return typeof e==typeof n?n:a(e,n,i,o)}(r,e)}function l(e){return{arrayItems:e}}function d(e){return{ref:e}}var f,v,h={FeatureGateConfig:(f=[{json:"ConfigId",js:"ConfigId",typ:""},{json:"IsEnabled",js:"IsEnabled",typ:!0},{json:"SettingsRings",js:"SettingsRings",typ:""}],{props:f,additional:!1})},p=t(2685);function m(e,n,t){null==t||t.ULS.sendTraceTag(521164238,i.W.Lt,o.G.Info,"".concat(e,": ").concat(n?"Enabled":"Disabled"))}function S(e,n){if(!n)return!1;if(!n.has(e))return!1;var t=n.get(e);return null!=t&&"boolean"==typeof t&&t}function H(e,n,t){var a,u=[];null==n||n.ULS.sendTraceTag(522299220,i.W.Lt,o.G.Verbose,'Attempting to parse Feature Gate Config String: "'.concat(e,'"'));try{u=null!==(a=r.toFeatureGateConfig(e,n))&&void 0!==a?a:[]}catch(t){return null==n||n.ULS.sendTraceTag(524814532,i.W.Lt,o.G.Error,'Unable to parse Feature Gate Config string: "'.concat(e,'", due to Exception: ').concat(t)),new Map}null==n||n.ULS.sendTraceTag(522299221,i.W.Lt,o.G.Verbose,"Successfully parsed Feature Gate Config String to JSON: ".concat(JSON.stringify(u)));var s=new Map,c=t;return c=c?null==t?void 0:t.toLocaleLowerCase():"",u.forEach((function(e){var n,t=(null!==(n=e.SettingsRings)&&void 0!==n?n:"").replace(/\s+/g,"").toLocaleLowerCase().split(",");c&&t.includes(c)&&s.set(e.ConfigId,e.IsEnabled)})),null==n||n.ULS.sendTraceTag(522299222,i.W.Lt,o.G.Info,"Successfully filtered Feature Gate Config JSON: ".concat(JSON.stringify(u),", to ring id: ").concat(c,", with result map: ").concat((0,p.z)(s))),s}!function(e){e.FeatureGate_EcsHootGate="EcsHootGate",e.FeatureGate_VisioJsApiV2Gate="VisioJsApiV2Gate",e.FeatureGate_HideCloseButtonGate="HideCloseButtonGate",e.FeatureGate_StartPageUseOWLGate="StartPageUseOWLGate",e.FeatureGate_GrabFocusOnFilePickerCloseGate="GrabFocusOnFilePickerCloseGate",e.FeatureGate_BlurAndGrabFocusForShareDialogGate="BlurAndGrabFocusForShareDialogGate",e.FeatureGate_CreateNewImprovementGate="CreateNewImprovementGate",e.FeatureGate_Vroom21SupportGate="Vroom21SupportGate",e.FeatureGate_FetchWacAndSpoTokenGate="FetchWacAndSpoTokenGate",e.FeatureGate_CommandingAshaVetoes="CommandingAshaVetoes",e.FeatureGate_DisableEUDBBrowserULSRouting="DisableEUDBBrowserULSRouting",e.FeatureGate_DisableEUDBHealthTelemetryRouting="DisableEUDBHealthTelemetryRouting",e.FeatureGate_ESSForXLGate="ESSForXL",e.FeatureGate_iOSNullCheckFeatureGate="iOSNullCheckFeatureGate",e.FeatureGate_Locale1JSGate="Locale1JSGate",e.FeatureGate_BypassOPTIONSCall="BypassOPTIONSCall",e.FeatureGate_EnableOwlFrame="IsOwlIFrameExperimentEnabled",e.FeatureGate_EnableOwlFrameTreatment="IsOwlIFrameExperimentTreatment",e.FeatureGate_EnableBootOwlFrame="IsOwlIFrameBootEnabled",e.FeatureGate_EnableBootOwlFrameTreatment="IsOwlIFrameBootTreatment",e.FeatureGate_Vroom21ForWord="Vroom21ForWord",e.FeatureGate_Vroom21ForExcel="Vroom21ForExcel",e.FeatureGate_OwlTelemetryFunctions="OwlTelemetryFunctions",e.FeatureGate_ManifestCachingGate="ManifestCachingGate",e.FeatureGate_ManualRedirectOnTenantChangeGate="ManualRedirectOnTenantChangeGate",e.FeatureGate_IsOwlWacOAuthExperimentTreatmentEnabled="IsOwlWacOAuthExperimentTreatment"}(v||(v={}))},8425:(e,n,t)=>{"use strict";function i(){var e=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(n){var t=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===n?t:3&t|8).toString(16)}))}t.d(n,{c:()=>i})},2685:(e,n,t)=>{"use strict";t.d(n,{d:()=>r,z:()=>o});var i=t(9850);function o(e){var n,t,o="{ ";try{for(var r=(0,i.XA)(e.entries()),a=r.next();!a.done;a=r.next()){var u=a.value;o+="{ key: ".concat(u[0],", value: ").concat(u[1]," },")}}catch(e){n={error:e}}finally{try{a&&!a.done&&(t=r.return)&&t.call(r)}finally{if(n)throw n.error}}return o.substring(0,o.length-1)+" }"}function r(e){var n,t,o={};try{for(var r=(0,i.XA)(e.entries()),a=r.next();!a.done;a=r.next()){var u=(0,i.CR)(a.value,2),s=u[0],c=u[1];o[String(s)]=c}}catch(e){n={error:e}}finally{try{a&&!a.done&&(t=r.return)&&t.call(r)}finally{if(n)throw n.error}}return JSON.stringify(o)}},6130:(e,n,t)=>{"use strict";t.d(n,{J:()=>s});var i,o,r,a=t(3448),u=function(e){var n=document.getElementById("unified-ui-host-config"),t=n&&n.textContent;if(t)return JSON.parse(t)}(),s={version:"v1",officeHomeCdnDomain:null!==(i=null==u?void 0:u.officeHomeCdnDomain)&&void 0!==i?i:(0,a.w8)(),genericFeatureGates:null!==(o=null==u?void 0:u.genericFeatureGates)&&void 0!==o?o:null,deploymentEnvironment:null!==(r=null==u?void 0:u.deploymentEnvironment)&&void 0!==r?r:"Not_specified"}},8024:(e,n,t)=>{"use strict";t.d(n,{JK:()=>s,Th:()=>S,VJ:()=>r,XU:()=>u,Y$:()=>p,aE:()=>m,bM:()=>d,gG:()=>h,k$:()=>v,o4:()=>i,pK:()=>a,sj:()=>f});var i,o=t(9850),r=/http[s]?:\/\/[\S]*?\.sharepoint[\S]*?\.com/,a=/http[s]?:\/\/[\S]*?-my\.sharepoint[\S]*?\.com/,u=/http[s]?:\/\/d\.docs\.live\.net/,s=/https:\/\/[\S]*?graph\.[\S]/,c="https://graph.microsoft.com",l=new RegExp(["^(https?:)//","(([^:/?#]*)(?::([0-9]+))?)","(/{0,1}[^?#]*)","(\\?[^#]*|)","(#.*|)$"].join(""));function d(e){if(!e)return"";try{return decodeURIComponent(e)}catch(e){return""}}function f(e){return e?e.substring(0,e.lastIndexOf("/")):""}function v(e){if(e&&e.length){var n=e.match(l);if(n)return{href:e,protocol:n[1],host:n[2],hostname:n[3],port:n[4],path:n[5],search:n[6],hash:n[7]}}}function h(e){if(e&&e.length){if(e.match(a)||e.match(u))return"OneDrive";if(e.match(r))return"SharePoint";if(e.startsWith(c))return"Graph"}}function p(e,n,t){var i=e,r="",a=!0;for(var u in n&&(i=(0,o.pi)((0,o.pi)({},n),i)),i){var s,c=i[u];if(!t||"object"!=typeof c&&c||"object"==typeof c&&c&&c.uriValue||"number"==typeof c||"boolean"==typeof c)a?a=!1:r+="&",s="object"==typeof c&&c&&c.uriValue?c.uriValue:encodeURIComponent("".concat(c)),r+="".concat(u,"=").concat(s)}return r}function m(e){if(e&&e.length){if(e.match(a)||e.match(u))return i.OneDrive;if(e.match(r))return i.SharePoint}}function S(e,n){var t=e.toLowerCase(),i=function(e){var n=v(e);return n&&n.hostname||""}(n),o=function(e){var n=e.toLowerCase();return!n||n.startsWith("http:")||n.startsWith("https:")||n.startsWith("mailto:")||n.startsWith("sip:")||n.startsWith("tel:")||n.startsWith("im:")?n:"https://"+n}(i),r=f(n);return 0===t.indexOf("https://")||0===t.indexOf("http://")?t:"/"===t.charAt(0)?"".concat(o).concat(t):"".concat(r,"/").concat(t)}!function(e){e.OneDrive="Documents",e.SharePoint="Sites"}(i||(i={}))},1380:(e,n,t)=>{"use strict";var i,o,r,a;t.d(n,{J7:()=>i,L5:()=>r,hx:()=>o}),function(e){e.CacheOnly="cache-only",e.NetworkFirst="network-first",e.NetworkOnly="network-only"}(i||(i={})),function(e){e.Delete="DELETE",e.Get="GET",e.Head="HEAD",e.Options="OPTIONS",e.Post="POST",e.Put="PUT",e.Patch="PATCH"}(o||(o={})),function(e){e.CorrelationId="X-OfficeHome-CorrelationId",e.Mock="ohp-mock",e.TestTraffic="X-OfficeHome-TestTraffic"}(r||(r={})),function(e){e.Json="json",e.Text="text",e.ArrayBuffer="arraybuffer",e.Blob="blob"}(a||(a={}))},1171:(e,n,t)=>{"use strict";t.d(n,{Ko:()=>h,sm:()=>p});var i=t(9850),o=t(7442),r=t(3869),a=t(3918),u=t.n(a),s=t(2106),c=t(1380),l=3e5,d=-1,f=u().create(),v=function(e,n){return n===c.J7.CacheOnly?Promise.reject("Cache unsupported"):Promise.resolve(e)};function h(e,n,t,a,h,p,w,b,g,I,A){void 0===g&&(g={});var C=b;return I===c.J7.CacheOnly&&(C="None"),function(e,n,t,i,a,u,l,d,f,v,h,p){return new Promise((function(S,w){var b=a||"None",g="None"===b||"OfficeHome"===b&&!t,I=f||new Set;I.add(401);var A=function(e){var n=e.status,t=Number.NaN;!g&&I.has(n)?t=s.W.TokenRefreshFailed:v&&v(n)&&(t=s.W.RetryFailed),t!==Number.NaN&&(null==p||p.ULS.sendTraceTag(509723938,o.W.Lt,r.G.Error,"requestWithAuthAndRetry failed with status ".concat(n," and customErrorCode ").concat(t))),w({httpResponse:e})};if(u){var C=H(u);C&&(n.headers||(n.headers={}),n.headers[c.L5.Mock]=C)}(g?Promise.resolve(void 0):i(b,!1,l)).then((function(t){if(!g){if(!t||!t.success){var a=t?t.error:"";return null==p||p.ULS.sendTraceTag(509723937,o.W.Lt,r.G.Error,"requestWithAuthAndRetry failed on get token with error ".concat(a)),void w({httpResponse:{data:"CAP_Error"===a?a:null,status:s.W.TokenUnavailable,headers:{},ok:!1,statusText:"Failed to fetch access token",fromCache:!1}})}m(n,t,d,h)}e(n).then(S,(function(t){var a,u;!g&&I.has(t.status)?i(b,!0,l).then((function(i){i.success?(m(n,i,d,h),e(n).then(S,A)):A(t)})).catch((function(e){null==p||p.ULS.sendTraceTag(509723936,o.W.Lt,r.G.Error,"getAccessToken failed with error ".concat(e))})):v&&v(t.status)?(a=n,setTimeout((function(){e(a).then(S,A)}),(u=[0,11,22,33])[Math.floor(1e3*Math.random())%u.length])):w({httpResponse:t})}))})).catch((function(e){null==p||p.ULS.sendTraceTag(509723935,o.W.Lt,r.G.Error,"getAccessToken failed with error ".concat(e))}))}))}((function(e){return function(e,n,t,a,h,p,m,w,b){var g="".concat(n,"/");return e.url.startsWith("http")&&!g.startsWith("http")&&(g="".concat(window.location.origin,"/").concat(g)),0===e.url.lastIndexOf(g,0)&&function(e,n){e.headers||(e.headers={}),e.headers[c.L5.CorrelationId]=n;var t=H("testtraffic");t&&(e.headers[c.L5.TestTraffic]=t)}(e,t),function(e,n,t,a,h,p,m){var H=n===c.J7.CacheOnly,w=function(e,n,t,a,l,h,p){var m=this;return new Promise((function(H,w){return(0,i.mG)(m,void 0,void 0,(function(){var m,b,g,I,A;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:if(m=t===c.J7.CacheOnly,b={url:e.url,method:e.method,headers:e.headers,params:e.params,data:e.body,timeout:n,responseType:e.responseType,onUploadProgress:a,onDownloadProgress:l},h&&(g=u().CancelToken,I=g.source(),b.cancelToken=I.token,h.onCancel((function(){return I.cancel()})).catch((function(e){null==p||p.ULS.sendTraceTag(509723933,o.W.Lt,r.G.Error,"getResponse failed with error ".concat(e))}))),!v)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,v(b,t||c.J7.NetworkOnly)];case 2:return i.sent(),[3,4];case 3:return A=i.sent(),w(S(s.W.NotImplemented,m,A)),[2];case 4:return f.request(b).then((function(e){H({data:e.data,status:e.status,headers:e.headers,ok:!0,statusText:e.statusText,fromCache:m})}),(function(e){u().isCancel(e)?w(S(s.W.Cancelled,m)):"ECONNABORTED"===e.code?w(S(s.W.Timeout,m)):e.response?w({data:e.response.data,status:e.response.status,headers:e.response.headers,ok:!1,statusText:e.response.statusText,fromCache:!1}):window.navigator&&"boolean"==typeof window.navigator.onLine&&!window.navigator.onLine?w(S(s.W.Offline,m)):w(S(d,m))})),[2]}}))}))}))}(e,p||l,n,t,a,h,m),b=h?h.onCancel((function(){return Promise.resolve(S(s.W.Cancelled,H))})):new Promise((function(){}));return Promise.race([w,b]).catch((function(e){null==m||m.ULS.sendTraceTag(509723934,o.W.Lt,r.G.Error,"requestWithInstrumentation failed with error ".concat(e))})),w}(e,a,h,p,m,w,b)}(e,p,w,I,g.onUploadProgress,g.onDownloadProgress,g.cancellationToken,g.timeoutInMs,A)}),(0,i.pi)((0,i.pi)({},t),{url:e,method:c.hx.Post,body:n}),a,h,C,g.mockParam,g.resourceUrl,g.rpsHeaderPrefix,g.additionalAuthErrors,g.isRetriableError,g.updateRequestWithAuth,A)}function p(e,n,t){var i=n;if(!e||!e.success)return null!=i?i:{};i||(i={});var o="RPSCompact"===e.format?t||"":"Bearer ";return i.Authorization="".concat(o).concat(e.token).trim(),i}function m(e,n,t,i){e&&(e.headers=p(n,e.headers,t),i&&i(e,n))}function S(e,n,t){return{data:void 0,status:e,headers:{},ok:!1,statusText:t&&"string"==typeof t?t:e.toString(),fromCache:n}}function H(e){return new URLSearchParams(window.location.search).get(e)}},8577:(e,n,t)=>{"use strict";var i;t.d(n,{T:()=>i}),function(e){e.Excel="Excel",e.None="None",e.OneNote="OneNote",e.PowerPoint="PowerPoint",e.Visio="Visio",e.Word="Word"}(i||(i={}))},5e3:(e,n,t)=>{"use strict";function i(){return window.performance&&"object"==typeof window.performance&&"function"==typeof window.performance.mark}t.d(n,{p:()=>i})}},r={};function a(e){var n=r[e];if(void 0!==n)return n.exports;var t=r[e]={id:e,exports:{}};return o[e](t,t.exports,a),t.exports}a.m=o,a.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return a.d(n,{a:n}),n},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,a.t=function(t,i){if(1&i&&(t=this(t)),8&i)return t;if("object"==typeof t&&t){if(4&i&&t.__esModule)return t;if(16&i&&"function"==typeof t.then)return t}var o=Object.create(null);a.r(o);var r={};e=e||[null,n({}),n([]),n(n)];for(var u=2&i&&t;"object"==typeof u&&!~e.indexOf(u);u=n(u))Object.getOwnPropertyNames(u).forEach((e=>r[e]=()=>t[e]));return r.default=()=>t,a.d(o,r),o},a.d=(e,n)=>{for(var t in n)a.o(n,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce(((n,t)=>(a.f[t](e,n),n)),[])),a.u=e=>(({36:"hi-in-owl-strings-json",98:"sd-arab-pk-owl-strings-json",399:"lb-lu-owl-strings-json",666:"sr-cyrl-ba-owl-strings-json",712:"ga-ie-owl-strings-json",856:"gd-gb-owl-strings-json",921:"zh-tw-owl-strings-json",1e3:"el-gr-owl-strings-json",1029:"sl-si-owl-strings-json",1102:"ms-my-owl-strings-json",1105:"ca-es-owl-strings-json",1133:"be-by-owl-strings-json",1350:"bn-in-owl-strings-json",1406:"ca-es-valencia-owl-strings-json",1489:"et-ee-owl-strings-json",1532:"uk-ua-owl-strings-json",1608:"nl-nl-owl-strings-json",1635:"es-mx-owl-strings-json",1771:"ne-np-owl-strings-json",1791:"ar-sa-owl-strings-json",1825:"kk-kz-owl-strings-json",1993:"kok-in-owl-strings-json",2046:"ta-in-owl-strings-json",2129:"quz-pe-owl-strings-json",2281:"ur-pk-owl-strings-json",2289:"ha-latn-ng-owl-strings-json",2394:"te-in-owl-strings-json",2772:"ro-ro-owl-strings-json",2792:"pt-br-owl-strings-json",2811:"km-kh-owl-strings-json",2855:"pa-in-owl-strings-json",2902:"lt-lt-owl-strings-json",3041:"fr-fr-owl-strings-json",3075:"en-gb-owl-strings-json",3102:"cy-gb-owl-strings-json",3247:"da-dk-owl-strings-json",3268:"id-id-owl-strings-json",3395:"tt-ru-owl-strings-json",3622:"lo-la-owl-strings-json",3787:"qps-ploc-owl-strings-json",3872:"ky-kg-owl-strings-json",4051:"fi-fi-owl-strings-json",4144:"ja-jp-owl-strings-json",4335:"it-it-owl-strings-json",4525:"kn-in-owl-strings-json",4628:"mk-mk-owl-strings-json",4630:"owl.handlers",4654:"fr-ca-owl-strings-json",4809:"tk-tm-owl-strings-json",5167:"af-za-owl-strings-json",5383:"as-in-owl-strings-json",5467:"nn-no-owl-strings-json",5760:"fa-ir-owl-strings-json",5848:"mi-nz-owl-strings-json",5874:"am-et-owl-strings-json",6099:"si-lk-owl-strings-json",6233:"vi-vn-owl-strings-json",6251:"sq-al-owl-strings-json",6338:"bn-bd-owl-strings-json",6664:"cs-cz-owl-strings-json",6727:"hr-hr-owl-strings-json",6774:"nb-no-owl-strings-json",6795:"hy-am-owl-strings-json",6798:"bs-latn-ba-owl-strings-json",6832:"tr-tr-owl-strings-json",6974:"pl-pl-owl-strings-json",7e3:"sw-ke-owl-strings-json",7027:"chr-cher-us-owl-strings-json",7332:"or-in-owl-strings-json",7335:"mt-mt-owl-strings-json",7447:"zh-cn-owl-strings-json",7610:"ml-in-owl-strings-json",7681:"ka-ge-owl-strings-json",7805:"az-latn-az-owl-strings-json",7986:"sv-se-owl-strings-json",8102:"es-es-owl-strings-json",8217:"gl-es-owl-strings-json",8225:"bg-bg-owl-strings-json",8253:"hu-hu-owl-strings-json",8294:"prs-af-owl-strings-json",8342:"ko-kr-owl-strings-json",8361:"fil-ph-owl-strings-json",8438:"en-us-owl-strings-json",8507:"ru-ru-owl-strings-json",8530:"sr-latn-rs-owl-strings-json",8660:"gu-in-owl-strings-json",8692:"ug-cn-owl-strings-json",8793:"pt-pt-owl-strings-json",8869:"owl.auth",8904:"eu-es-owl-strings-json",9054:"lv-lv-owl-strings-json",9173:"th-th-owl-strings-json",9264:"mr-in-owl-strings-json",9275:"de-de-owl-strings-json",9355:"qps-plocm-owl-strings-json",9545:"he-il-owl-strings-json",9660:"mn-mn-owl-strings-json",9729:"sr-cyrl-rs-owl-strings-json",9743:"sk-sk-owl-strings-json",9754:"is-is-owl-strings-json",9779:"uz-latn-uz-owl-strings-json",9894:"qps-ploca-owl-strings-json"}[e]||e)+"."+{36:"ef5791183931dd6a43a4",64:"abe3d33921c3c683f5d2",98:"cac8d0d413bc56fa3a68",135:"729dd34f82decb01dd39",142:"75a33ba4ea2154832538",188:"2806db7cc26e0a2563d6",193:"638284ca5b88c13d7658",336:"f030bf893a568c31d43b",399:"eba2b17f6dea77de9d3e",402:"2cccfcf24b5d7d6d8e7a",478:"83e820273d16e1e29c05",498:"9aab004489cf83ffe0ed",504:"c6c38c91927adac9cbc2",552:"61334837f68a033ba7e6",594:"3a35f6d854fb50c8b4ae",663:"ed9271dc929d91fc132e",664:"36ca99cfe5a87d63ec8e",666:"1d0c674c73ac2215b56f",676:"d5a242a9090a3da1755a",712:"cffcf0f45e207f677abf",856:"59e37ef89fb5b27a8c9a",896:"5b09105644bc5440c509",903:"49dddd9dfc37baace7ac",921:"b3b7560c62f8fd5e5dfb",984:"b2d068adf0482a811ac9",1e3:"d9d10cd1c72efd53c958",1029:"bd26a879f1dd01df442c",1030:"bbe821e7b6324409db69",1102:"734f140c6f91cb93d267",1105:"98967ee1666fc6a41c58",1133:"83f215a964e288f04de1",1154:"7dd9cf5e6b72aa732b45",1212:"ef828ba6d976e0e2e117",1224:"31275581822c15846e2a",1282:"5cc5b5113ad05894660f",1299:"4eee4e25ad330edae3be",1308:"9995c0294e53a651c7fa",1350:"ede0a576407461480049",1406:"ff09e486c5ee39f7df24",1419:"fdfa5d57b323092b4b50",1436:"5dd7af5ae8f574d22e06",1462:"541b99c860920dcc779a",1489:"8e2236f212cc19d7bd87",1532:"005f95a3977a4493e059",1570:"b0cd8cab335fd7f3528b",1575:"7bcde4c8dfe34916498a",1608:"f822ba4035d6eec2a375",1635:"27ce7b20450d411f9598",1771:"0fe5abea35ff68fbc2ca",1786:"5103ad1622d77704825a",1791:"c002c6c419902f26240f",1825:"e4c4f0b2826c7c36acbd",1849:"821337d0dfc517b97a12",1853:"ba077d4980b50c44b355",1877:"20102507095daffb136f",1883:"8e1ba1192eb8128ece89",1886:"b9fbe284a610a0d7260a",1907:"9337aa34f5995335d74b",1908:"c649a473c706d1387457",1937:"3864b96b791dc3ab053b",1938:"d5a53c834871c625b973",1954:"337e608d1483a0e43776",1993:"30fad92db8ae06b97fde",2046:"9038e3055f98e1342df9",2084:"0cdeeea411ef5f49e3ac",2115:"9ea8f1e644e19a616430",2129:"58aff344dd5e6ffeb6e7",2243:"4d57e3832b37b752ec40",2262:"a2c6f0651fd5bc76fb83",2281:"b88871b2dd34af7081b6",2289:"97443f629587404e0b2b",2340:"dd2e886e471ec3240876",2388:"4271c47372c0eb9ed1fb",2394:"6f2cc8eba5b9393ede83",2396:"b48872348581c77618e1",2422:"f32ca1cca4ec0713a804",2442:"a8aafc8e1d5501784a45",2517:"17ff2945df15a415a6bd",2551:"5525b9c955050e7b6b15",2565:"a6620d28c0edb9fe6c5b",2590:"cbfa5918f6fb091d7fbf",2615:"89a504956520c6b5d66f",2770:"1c799b1ed13824c911e5",2772:"38129b1b1a487c219c76",2792:"45cc0dd5f7d26683555c",2811:"8f5da644656338149d19",2821:"7c6d3f09275b5ae9a2b1",2842:"a9cd94f8389e4ce8e3bb",2855:"fe41fe5564fa2e59cb73",2867:"dc8e332764934625259a",2869:"5beaa929a8ee455c5e0b",2902:"347b85448a468565565f",2965:"ddbdfdf5f17ff13ac3a0",2977:"6ef0681c7a772c9d5fb2",2978:"f351e23c6acc2e5924be",3010:"61936083a9f0a8f16f72",3031:"adf9e459035f593ec8c6",3041:"1f84748e3d7f5045e9bf",3057:"2807c07ed04a86e65913",3075:"49edf1abde6492220dae",3102:"d1cf19047099481153eb",3103:"369562f0607eb7a5d459",3117:"eac9c7c5e2b765929b2f",3121:"e2d61ea065372e30a380",3173:"d76db452d1dc4cedcdad",3247:"f71a2d4c5da5d36947f4",3250:"798dc0302e6ed5b097f9",3268:"78141ab8414fd2dca295",3384:"1178cb5d96300bad29c5",3395:"ad6388e2842a4550a9ec",3467:"0d1226ad0091a3e8f2dc",3502:"58c3063c06a8f27164fb",3536:"daa8130ffaa9b7682aa0",3622:"906cf46f60b42ea3a45e",3635:"488554cbcaeb27806887",3659:"4989f43180e0bafa30c9",3676:"8a358ef224002de967c7",3710:"f3e5fbbcbd75424c2d1e",3757:"6d42fba9da847a4bd8b1",3758:"4525314a0bf99d362f89",3787:"f1ed99628877cd4311b3",3811:"9365e497a5ad7208af5a",3814:"2aa05357c00dfacf7f69",3872:"8b952f8d57a25355cee1",3903:"395ddd73fd1194a0f225",3988:"b2988a09a7bbe246b2dc",4051:"1336cbdd3431eb722f66",4057:"ed9ba99f371830c968f2",4130:"140af36f945d15d16e9f",4144:"514e24f69fa87e1c9054",4335:"ef7a6b37b49f22c7d290",4525:"f14d7f3e7162eab87ddc",4565:"44f2c5363149e3325d96",4569:"f683658d7ec622dbb36a",4584:"200c201396b7470fe149",4620:"11b2401472ce863dce4a",4628:"ce17da5f2a33e28e5766",4630:"44848c0f3e1bae87aa33",4654:"38cd0b2feaec41890ae8",4699:"bbb04a2c2ad2ce9085f4",4736:"5ee0f479c643d4c1cd03",4809:"8074601cb42683208e1d",4925:"9ac336e0a6727a04cb20",4981:"e0282c7d224fad30633a",5001:"03690e60d8ea8a963e72",5167:"44ab6693f8aa5c89bcde",5172:"d9fc8fd7d8109116d0c1",5222:"cbf300604d4990a0d19a",5271:"11ff414c5929784b47f8",5383:"e7d74d788bbfbb870a96",5393:"062f1eb0baabbf3c4a34",5410:"4ab46ccc0b56b1ae87c7",5467:"080e251c13b8659b3af1",5604:"18d712ce5163fb4de4c2",5760:"848566bf511071e3ec30",5774:"d7a6467a9db7f05225c8",5777:"cced36a90c7c9965ccb3",5786:"8a6524b1295c13b78c55",5848:"0853243634f625f617c4",5874:"853392adab14d8627fd8",6009:"2c8f16395b6962e54a34",6014:"f1492d3ef82d2b481868",6034:"255e7e82500d6e513d66",6099:"549bab3037fe6a581534",6139:"09ab46d80e7a562fec3f",6154:"62e9c17e128bbede46ff",6233:"a28df423be00acd37a64",6251:"7dc656ab1214f6bd7f5a",6256:"e4a8c735fc3eafa38474",6266:"f64b5d841d9714468025",6294:"0e4f46cb01c247acd6c7",6309:"e0143651612354bb4a84",6338:"a6686996985fcf7b9b89",6354:"c733ce1ab4462bab8b7f",6452:"3626e9b06bf104fbe0f8",6471:"3c2bf8bf6e6da3985f3c",6485:"06346f6243482ede07ad",6537:"6a28698f522ef1bfc616",6553:"6ea37a91b938eb2bf4b9",6577:"67b5f6d0a40faf7a9ec0",6599:"5413afee73ca95917757",6607:"f2f27e731db953729fcc",6664:"7ebfe9747c96e2f5ac4b",6701:"c35d775d23f12fc4dc55",6727:"0c7e176bb249f666b996",6769:"fbb03d20d522a6d2b2b4",6774:"e18c878c6d54a0b53797",6795:"cd70eba7fd5889f006d4",6798:"d674a884de2341bff534",6817:"5c2ecd19cc5da97b70a9",6818:"122e3864fdffae087e6c",6822:"e22c84239263a310d401",6832:"b03415fb45b6592fc9d7",6974:"e09a8a11e5fe58968d9a",6983:"8b3ad1da6541ee6104ad",7e3:"6f9b41085e6b3ed610c5",7027:"dd1d170124c046261857",7031:"e40bc22024361117dae7",7142:"0fa5ecddb39a2d5be1f2",7156:"4c363da2dacb6d563a52",7168:"05ecd46bd016b1232094",7250:"9ae53525409fcd20f87b",7274:"120e490305c6d2211f9c",7331:"9f11826b950466be0f7b",7332:"1f1b16ab96c1e44d05b0",7335:"fa366736e59bd742fd89",7348:"502b9a329fe2c52d34f6",7399:"97e327fa1c7879d8eac4",7420:"9e8e19e3496fa8957f51",7437:"dcc6bb02995427517bac",7447:"70280f6c28feab8ab783",7581:"479e3e4f6fb647d1afe3",7610:"8f6ae209960b812f9efd",7674:"83e6aa3762d714a70aa1",7681:"eb35bf2e44293f4049ef",7716:"4d119377cc29634dcf5f",7761:"136169206ae1a6504391",7805:"d4358330767c1476a5be",7879:"adb096c188ae638471d0",7912:"c2147ae593ba230bb59d",7938:"9aa6b6361e7edefc7440",7960:"52e37b89fc6543fd4937",7986:"28fdd208e3228067e62c",8102:"3fd331f58acb5bcea597",8217:"e8a6ce48f1a6691bee28",8225:"e0ef3286edcc5d990448",8226:"624113f4a376caeee94d",8235:"eda208ed2c00ecb2d216",8253:"1d2e44ed2f4a027a2b5c",8266:"80944e842d36d574a126",8267:"5c4ff4c44dbb54174321",8294:"4b137508a0706c3046b0",8342:"d73e816c282e68eff888",8361:"743b18839bbb8c48d366",8394:"423b17ff9f285be085af",8438:"c051618b49d3b05d6f16",8466:"52a19915b819860c2d01",8507:"268a7dc252bbe481c71d",8530:"cc4ed66be54d8ae9ead3",8579:"9ae713f5d17740d1d41b",8581:"8b1f4bf49484b47a6705",8602:"cdcbf2da2c8ff5465944",8660:"fe1088d32a51f8f6311e",8692:"c247b10bdc439fe309a7",8771:"48f0ab8409f9333d8416",8793:"a9e1f06bcb6de2e3aa5f",8869:"ded6be023a2ddd97a764",8904:"ddf62b8a12f1450afac0",8975:"1c6af0d36890eb77fc04",9022:"ee1f73c7985bf21ad551",9054:"b754a35872be60e57424",9105:"162a45f1ca120750ba5c",9173:"20442e8e3e963a686152",9179:"8f1dd18fc8d35137aa6e",9264:"b9009ec0817b759581f6",9275:"cf7c8778f9727706102b",9310:"d6f3a2d6d1550d1765b8",9324:"c99468b52c304b4265cc",9355:"39fd547cfe2d0e5f1920",9371:"40ce5a4a71d67e9a0fa7",9414:"c3b4922b7e57372c6330",9526:"b4cf6a20401463796e2f",9545:"826ca93497f65f3d827a",9648:"d1f37f69495afd4c944e",9660:"a7b190e605304b1319a5",9705:"576d7c607d199313164e",9729:"af59bb50612a68ab1c98",9743:"80c8053e4bb4ad67e8ec",9754:"b261eea5a2aefa2189bc",9779:"61bddde822565ecc5931",9806:"cc8e2cf9feb56c398948",9830:"0d1dab6faef3e18405c5",9843:"2a81dab4f997348a9828",9894:"a1bb75c2c7f4dafb684c",9898:"e288a01a178be3738c90",9920:"2606f1b3e8bf642c0d59",9955:"5b7114d9e033227a56bf",9962:"269920511e87079a3033"}[e]+".js"),a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),t={},i="Microsoft.Office.OWL:",a.l=(e,n,o,r)=>{if(t[e])t[e].push(n);else{var u,s;if(void 0!==o)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var d=c[l];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==i+o){u=d;break}}u||(s=!0,(u=document.createElement("script")).charset="utf-8",u.timeout=120,a.nc&&u.setAttribute("nonce",a.nc),u.setAttribute("data-webpack",i+o),u.src=e,0!==u.src.indexOf(window.location.origin+"/")&&(u.crossOrigin="anonymous"),u.integrity=a.sriHashes[r],u.crossOrigin="anonymous"),t[e]=[n];var f=(n,i)=>{u.onerror=u.onload=null,clearTimeout(v);var o=t[e];if(delete t[e],u.parentNode&&u.parentNode.removeChild(u),o&&o.forEach((e=>e(i))),n)return n(i)},v=setTimeout(f.bind(null,void 0,{type:"timeout",target:u}),12e4);u.onerror=f.bind(null,u.onerror),u.onload=f.bind(null,u.onload),s&&document.head.appendChild(u)}},a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var n=a.g.document;if(!e&&n&&(n.currentScript&&(e=n.currentScript.src),!e)){var t=n.getElementsByTagName("script");if(t.length)for(var i=t.length-1;i>-1&&!e;)e=t[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),a.sriHashes={36:"sha384-Q/4l14q+ZOPEur5x/fjqwD+rOmU2zbDUgQEQIlw3EJuUtob8KOp7sjkSVyE9k/OG",64:"sha384-BX1cveOW5dljYYxgcz2kuQayV3Y4cJpyqMGw3qs4Xk5MukB81vlxpH5PHRy7YRvU",98:"sha384-nk7mjZ9kHUXVo+BW85/nntHy90IdZliHNnIhFu3fQShGHoYHnFY6gVpCaCd+FNQ7",135:"sha384-nKTMswKPBMyTR5ru7SeA8HKsBtDHzxyO2lUOvRxHAAB0ecdTxpovx8CV7PsWLQ4H",142:"sha384-E+IHbaZR0w4s42nCu5u28zah7O0qnQj7NDBYaKv9/eb+onqJbRS2J0rRabhNAZ0S",188:"sha384-Z9fy8EeKrvR/cHKSpNMyBT+vU6p5eGiLHsNYxMBVohnRl7fsvGu/mxJhszbFfdoi",193:"sha384-dkUz/lhE12yBZGoVxzrjjQhg5Q0w4feVPAlQc0EDB94OzsBjGrd+WshPInUt5/De",336:"sha384-J21A2XQRRZL0Ls2E4BC5enETZGbOqLRBu3yxIviqBu15ddBUoNTPWIwSL/aozl6/",399:"sha384-at7TDVkyfylq8JLk1RXsel4i9FepzBh7AfJG2/7pQ8mw/A3iWkVcfNVHGH9aYEfY",402:"sha384-bUx4lHjUANmV9mUHqbxBrfPaSpvQzj4NyMrEFmitnni5FO+QoEqDU7TxjwTWKHwA",478:"sha384-SqsYPMnqVMKjcHP2XyCVcOJLW+ZlbO1zahutrUG4JY9uGflCwuixFvHC2u1uFQH3",498:"sha384-29Zx1G8FJ++qCmwyCmulCV0hLszD9JI9N2sCmzDUGLqhPj0tB/cQLiKuBIEIAC9C",504:"sha384-nuIOPwYcXkTlu9V88ORGE04NoUlwB/kHvo9nktkFWcfPq1xBQzLgf++MUkcjahsj",552:"sha384-dWbEFBFHj9vWMhTn5vd9vU0kEXTIQa8cClklP2bMEyOnFIYNpJq2nEneTmmKpbSu",594:"sha384-9om4jIamwTZt6lAGGRe3jQeU+2nsEbFdtgUs+li63wuPQBF9HRzU0UYtP4UMd4Wg",663:"sha384-LUJijphWhypeVlDHh37jq/AFzzLWxY4xSsiE/k/DiR2xTnXk4C0yp5sE3QD3BG0V",664:"sha384-BjvF4/POzzaOpGNdR/EAeVmDV60Nu0u6Em6KxSyHcmq+1Qq2P+qbVJseVKSrfDDF",666:"sha384-OYkxvwvBObzcioIBNvuvCqJbHhhjOYatLR4S/EM0+gyKFKJSuo5aIRU+K5eqnq7m",676:"sha384-Kefl9Ovf9ng2cB+J1FmMAXD03GRknN6pbxNNiZjCvUPI2Vs1uU6XBwA5Q1LNVX+k",712:"sha384-21YHr8xxXw2sWcDGC1dxZuYvF3yzxmrabf7SAKK99T78WFIBRCWlzAiqFj1/BZ01",856:"sha384-omhm9Ngpns2uYyiAuN05Wv1k83fT4iAukEpikOGD1b17o2bCQ79PCGg7Y0Vy5Tm+",896:"sha384-3e8eVXNMR6K6XFONCTtX/BV54EbaMUt9cGGzTmoSwfkQX2qM5aZXHR+9JvYWqO2m",903:"sha384-4X1oSOSpk/cb9rU+eYAyLS0h03mt8HdJnnZJfDgwYZ9rpZUe62BKP6dm2DZVPDy/",921:"sha384-hASwpVUHX0+dBwj3zYYYCtJp5fnP9Fxp80C5coHkE0rYu1jQfx/mRxmU0PwpNFEI",984:"sha384-ohwTGb/L3g664d+3w+0HOyJcz+KmPA4gahzhzd+4vy1JqLivzp0HyukUeSiHAlRB",1e3:"sha384-/b3aTZQSlODkKNkDrET1jqD223pbpt1HXkuu8LBPB4Kyi/ocXK10Gh2XUYO+G8l9",1029:"sha384-hTw7kIoWWlWVVshTxffjW6ImXBtcG+JyPzy4qNJQdhAYS8Ljz2DF76DZCA+oUDaI",1030:"sha384-M0U1C1kgASANAscEn3FREZ36lbrzVBMgqSsH70m4557AxOQFPaSgjF04sAC17Mss",1102:"sha384-Y0hACzgJvOJ5p2VE8QDhOgTqsflUuTOb1TlGC6KHefbxGZhQF9drRE/jbcTEdR83",1105:"sha384-mpDT3L4FojuZDH8R6AkVO7sxIQ5HoOWlhjmK5VdZCNL/Fgfo2NzO40xSHf0i4Hej",1133:"sha384-QrXU6MhpBYUmS/hjCLbzsA6iFpkP1AmRXmHgtSIuKA9ZDMKNviGnzD99vH/J7WIv",1154:"sha384-W5o5MFgUHkf34ToiZAMN8k1d5rHbr98qAlkY/9bAoO6yqIfNZn/SNcF888Ozntby",1212:"sha384-2yCX25f1xC5WvsYupWi0Wp3ibz25q0ghspC73F1Z8ptNmE2twEO5UHuwZyvMDwvJ",1224:"sha384-92N7J5iZLDwyQ0m/ZpwsS1fEQcSF2pf079hdoPY2SsFc5JyCprPVv1HvLRBccryL",1282:"sha384-zTUX9Munq60A4qHZse+xCYPPPza1tdpQFp1c+37v0jySWaeizTU/DPWcw3gwTsHd",1299:"sha384-YsSsc6I0QFaScKhMBNdze7HXbWUg4fU+Ev1UDKJwcpXB0jOp6uWP8yvmQG8CN7Nt",1308:"sha384-MAwW2XhQIxqXv5YtLDrKhnBUioKOXpvqUdgypdfRo1FJUxb54XgirZJe4hVnMcxx",1350:"sha384-VroymWy1NXCUQqF737/KHRXAc82e6ZlE0XBV73Lj7ix8IBlwH4IIjSLumi84JG6h",1406:"sha384-ybZPxEDBE3z+LU6wZrQJvkEhCyZdizeEar7sVJ4KZjRfJeVxwVSwcr4j3jfrhKSH",1419:"sha384-dtDPQPlHrPcRYqa3GF2pKsjggFIOvz9Ai7EDEIPV55iVViDbpZ4+iZCbqvMH6lpf",1436:"sha384-Hr/V61OPRFlYn+r0p+psvuuE/4KKhzJjl9TcvWp5+xGQ197IPVq35ZnKmRRY/v8E",1462:"sha384-9FHahv/27x3gKPYu2hyukkg+h5C4erbCkwQSeV75YcYMLriiibGtiPsFypaw1gw6",1489:"sha384-ZKf55rLl9ICx2T7KNda2Ij45yb4r7uD9iJP8TwoHv1P2W9p1kHAXINLrvQPkCoUr",1532:"sha384-hCQIpBDEHMwy2RHxbotkuLJ6HddkSpS8YiZ5gSJZFiAIvDPHUx/YGJcqF/iOITl1",1570:"sha384-YIZqChUKcyXRANtAAeWzH0mDZEXEoEJQoeLj0gqXI5E+xQ05zt7e3YEmvyVKqU9Y",1575:"sha384-lw5wTxiUanPQGhu2bb+VqhH5TI/BpBGiAoaV43Ye2RVtRmAy4DB4rDQJwYHGcbWC",1608:"sha384-/O/ahZKvntJAXpNCjoBFx07dk38MBdNKyAJ1A+bAs2oO2O20dTg79t6B/PMoStcE",1635:"sha384-m7U4ObPuaUwbWfauSrzD/4wdJUGQk2ktD6FUGTIqsBm5/3cO+keu3qcP8KTPvs+Q",1771:"sha384-+1nTK2mPSNbHfdHpkFHEgmCd5YksoU9EWS4f470srRg37E2ZKS1q3Qp5psMkuw7u",1786:"sha384-f5FIhvIhqsQFe6vF4duyczdK5JsQAot1f0LqjG/8L6ODGuKYf99XPS14HFS0P6H0",1791:"sha384-jAE2SQXYShcWj/PKm1+zWNd3LiN2Up8rWDOrrvDN6vK4xJowy4rZ1NBjHbZFtZEo",1825:"sha384-2WqgOK6ewktCibrvZL+1E3u6aHV4/gatDf1xuHsam5PfhKwZ0SUHaIBTztFU6rBk",1849:"sha384-W8jR6fwZ6hMAA207cxf+XXpWE4TRcggrGLhXfb2MnfuMvX1yuBhBll+6c9mAkwkK",1853:"sha384-t4pRDicRJkHzYZ8gLGpMquLznTuWaHR6GPll098ZTTtyjPh52r+5RQ2513E8ggm6",1877:"sha384-CYM5CfEKlF9fSQum0YsMAo8YUnZYrGH7dMnRrmbuBnC3ySThhUFXVy2H4dSyjB13",1883:"sha384-DC9IqYKcSnVWhT2IQ+YJvUCAiNbb1yZSByQRjEKUThz3fqoZYGiCXzKBAxkGsFRI",1886:"sha384-Tv0sek68PYzf7hdyjE2zO+jC2H5XB4x3AsSmDE1qt/LfjuKIbGWtzyGWpMamur8l",1907:"sha384-UYwotbuvpCDkC+iYL6vJXJ3qhn5KQ0dkRo2xbWuVQAms4P01QjGQW6S5Vd0UWi8B",1908:"sha384-L/IuC8AaLq14fq5Hn67Ur7PkHNhGKRnIUi79nn6/YTvu8bz9HHz9pDKt5vAzMvY5",1937:"sha384-wezkqOJYwfliwoVgftIU6mrCB8dnsJJ6QBmMqs/KU8I/rdgNGoItD370eB2ocsn3",1938:"sha384-nfZtNV/0IUpWdI2bLUwlvo1YvvI20P2x1dCeiKdNDJsuYmysKi3Gx+MAfxfcjDr7",1954:"sha384-dC9Gvdeo27W8Px2e7Y+AdWNpAOaGUJ6rQAVy06hecYqefVDEdnC7TgerEDyAyLaM",1993:"sha384-hajf0RmMecoDtbcOLS3eTEV9X/vJShLhAqZ2AUzaRIJEtLHyF57MlnB7t1a6NRcn",2046:"sha384-QAUqhAvvgZSUX3Dop0dUQQCNtYpEN72E+vSyg/oSqy4FrdVGldVAEWYFO5Hn4vbx",2084:"sha384-Hb9BOjsbA6zg9VPc8mGw28ZYzgy2+wcRivwvsEB3msaQjTKwnnKelr8hrCtABL9W",2115:"sha384-R673WaN/1V3E3CFJYcJ3+ph6tXwpEri7hJ3HxlwOC8E6QGog4QY4dRcsqwFKNZyg",2129:"sha384-wrA9sTN2MegHU5tYxxxXK6BFxjp1WQTbHFKXMfWvwi3hFSfsqq+uV2gjgl1A2uh/",2243:"sha384-BNjeyriIQyOh2H4CW621B3CedPwe2JMRNdxkwxnAOaDDM+fiETfhe9KuwLszWJ5W",2262:"sha384-L1Iygfq4SeKSNP+sOe0QQqi+TgZmxjgdadgHZhRyiJ0p9/nSP09w/ai+4+QBxThq",2281:"sha384-k/537csEpyoAkLdhSZCqrSrfWJuGj3T3hrzKN9y6q0qZN+ffk8p7TrcgwcUlNJ+n",2289:"sha384-PhrVaHfbjnlc2i95/BNZMyd06W2dLh0TLahU7MSwc5zFVoNgBf2YBjnq9d64rUJD",2340:"sha384-DBbw0K+wg0ZC/snmz+ehX47cvgD3tT2pIuxnuRY2ZbKxmoUOA2sVslQjphAaCZdw",2388:"sha384-49rj+kBqoW4+urGtX/F7EO6X8fuCg5Lh1H9JRNvWKTWaRy8sQ5zWwnDm3XmhWZzf",2394:"sha384-Ecp9zPsqc5/SnrNiTmvaWSULm/vbQyvCRvZbKRUTauzaZGP57V+3z/L3t/3Pdcii",2396:"sha384-iVlX5QJKSY2UINpqR72l8QCiMSMA1wO8I+ZP2XHfnjRX0DvFk+XmIqj5LgnQGAEj",2422:"sha384-W77SZ/SNSO01pnAIPC+aMeiYblAKRRFpaeoir9yP0tqvYFq5+4bPsmJECgnvysXK",2442:"sha384-IrC/rsSDO4leQK6fd4HNm3RYS0Vp0M3h7uBcI/4I6VVw+AikSE7ambHBquYSGmI1",2517:"sha384-Bry92m+6/eZ+zaiEA8ZOHt1qK3KyLWvgSEiU2+wd/ousZrWPDvMWpf2iNKX69N4S",2551:"sha384-kO+dQKuThbMmACfQ/LK7yv9lIZdRKBr2FY18IZ1rABqcpgDyJ4Yy+XIbDbDQntVJ",2565:"sha384-ImpXGFyOpm3nIVl7P9EZv0wUDF0pD3DmjqCtgamxITTUUgEnqQaTRV4nsuVBD8kE",2590:"sha384-FJTxOsos6/qzCstm1MxLC2jOy+ZDTtk83GxXBAV1vTYE+HBRCey9pGS+KRGYmwSB",2615:"sha384-eevncp7rtGwrd27+S2f3vxG/0PuPKPbimduRXPIatV03EQAZOGVZbO0BZKIAdrah",2770:"sha384-KnClT/dTlvVZvbbIt6gCZauVNLzrLN4hffXveaJElSuzmBOHn20qO1pVcFZ8JxOv",2772:"sha384-DJZAPxOR1vV/DrrYrAy9VbET1WetwbaTOX1YFnc1YmL1AXfOh0MlXCm6uaLs3vfq",2792:"sha384-OvkehA3pZRP9LQ29Hvw3HNLyk8imOsG5aezixc4ri/qc0YoEfZKWRJDVgioZTqh3",2811:"sha384-RRLw6b8+L9Oi+Ak+CFthHEExB1apdYP1C4rWrfF0qHrtE2/r0AtXTNFfRoocISfE",2821:"sha384-hZ30hufIWLuAtLemJagi+FWK8GbBseLunYxqD3uFCNJy3mw24lpan3Xgrs5aJHwE",2842:"sha384-DkcSyTmixyJ2RcrkWKuOeYASIKtIDbbUPC7H6TEvz+Z3nyzExXFudptsGaRZ1ZZ6",2855:"sha384-nV1+t8zHAEDjoZ4rJJ9dSR6Q6BkkIFMvICMJzIrb0YQCb89dUD0WAOBjQ1jTu+gx",2867:"sha384-Fx5ToT8NcwfFbu+qDngkcJPLc4hIE/WAZW5kuXECNBqqN/6qJ8aimAuUBIfLBW2T",2869:"sha384-+DULAxnTkewkcvH8COrzTFoM2uMOC9zmEpDTnPxErw0oidpeTU8a4n5jlCzWeLiX",2902:"sha384-d3eej2zlNIHAX5Vo2fsgR/DIOu+cOh/swFkPE8cvdDa6c3Y0QKnTlnF/mXYw9Tm3",2965:"sha384-6AU2EIakt9wW7E97hS4DFXm6k5RpL6yvybe6hFL/4ziwFJvPBgbYqNGSUu0MxzoB",2977:"sha384-oyH/Qyujo0qfDEg2CQvCAe8JlfbceMNTAv3LGiQTObh1tv4QW/B6Ho/1iMXP2yXT",2978:"sha384-xBqGLDnCZ9keid99fvc8N4iJrWCmg+fGCXe3sB5sRZrCRfeYD2vHedd1CoKckB9C",3010:"sha384-q6S2FowsZ5QgKdbjjAR5fNakTKjPdsMt5MEyDwss+NJY1CVdeo80VARohrvTU5Yp",3031:"sha384-Gf1gtY5ConN5qx9uqZ1BvhiQkOT7bxw1Nh6rOkRP/sHmFmF8mSLSEgs/AFg2+Bm5",3041:"sha384-Kc7EWX3ScAyata5crZNpBRINkQg2J+jbmlg7r8AUMG9hjpMGYcEqdSfbVJkIaNeq",3057:"sha384-FObEBR04hCh7Kl6YXgsgKa3Gcemltg9iRv6s350PZmsnkvas+F9as9Sz4t4bSRmp",3075:"sha384-WcCWfQjc+qwfNwhtcNXWXUNo1FUxJsHjriC8TzdxgqgL9pr1bPTzm1b7GjyZ6Mzj",3102:"sha384-qpizynRTv1lu2tIW7l40fh9wt4AZMF+4qohbHDxmeoUVALKAViSvLf2RafmNqz06",3103:"sha384-/DGz5iDDdJanCJTAU4jJLUMPQDmOBZURq9kjvStJ5S9461skQBb6WNbyE41QPc5Y",3117:"sha384-y6N6mNkwJH2VSi03SFZ5NMB9rtTlSnxw/7KeIbkl0NXks8ACKkcyw0P2db6Cp0Jr",3121:"sha384-w3Zt9A3uZXLQ+o3tARfqZUsTh4X0ql8cE5xlt1u3FMiBS7cjr5jndA0L0kbHwQgh",3173:"sha384-vavuTPEVgJ5pAXYS4wqa4m8g4khpmQC4LvYLBnCejri4A5GR1zGC3dDp3+Kv6G/O",3247:"sha384-Va3AEx39IzkO8bYf0HiiJpfw1OYnURiupikqyNfEI+EmifFEIR7dQEZCthOZSuI8",3250:"sha384-N7BYNCe4dbiVmD4/RXw6E0NZ+4Z9fyYUQjx6LFXfOsEOlZ89PDDOb7uWRgT8E8iT",3268:"sha384-GzIXFQt5wCY2ZXa+SmPLSvUTS8KvbFZS2dD6jZlwRtDcGlSDc7LAI53LlGn8b7R/",3384:"sha384-GfgJE1p33DgStauk0IYbYuIJDKf0RIfF0cBRN3zU2H8jN2dPZbMPeThvVV8VLTSZ",3395:"sha384-u238GRvKmKAtoegRgNg57FaZ2PvAe8CLdpuBPmquFKLMp409vrrAmL3iiNI2hTrd",3467:"sha384-A3V2WFquHVHzorIFFwNy1dUFVUnUGaQUOotlbkvr+npHMFZWnj2QMdce0h/ShHyU",3502:"sha384-uyQ+ZCBNP2TUSu7XMlp35Udaapw4mIvLoKAG8TqZwGetcEMMaaIFwxA5xu2NAwhP",3536:"sha384-U4mLFXouTXn/vOfEIZ5lDCMwcRtst0Osr543LscnnKeoY3Ozi30F7bObvJ1cZerI",3622:"sha384-TrK0jM+ppliJB0ogSXbJFjZZsNRnD7/5yLKbvBJkhhTDUhH+PiwgXyzqF0yG64Ln",3635:"sha384-gAj2unTt+5kCA1KHFwr/JuYhpozXYsgtpy4E8L+vV1ZV0O5ABTDCXWRS0KJUOC3y",3659:"sha384-Cu7HmJwrnCBNVNZ7LNXrdFmqXL4hQ4RKLf0fiVCk4uNx9FczsJBrCDb+uFlStxTy",3676:"sha384-I53jsnyn1YtogaywuQKayWz0HEAIQ6hb6jvzuAPTVjrD3ZiM6tEqbkT5JR3lU8uG",3710:"sha384-mcWAPUUJA5FEQ5VecRYu7NUNlKULc2UzK38fBieR1OkNyhjwdIOq0FDHt78s+cNU",3757:"sha384-OI2cK6/bzOLrNlN7rDAirnJUbu9rLHKsJrQ8EGms5qPRgfBoNeBdd1gbITMNM0iE",3758:"sha384-7WOHUE/xPwHfgDai+cy8xGkgpim6BQPaP/nFuaidcuka3jt6Ju7agjsfCva8gaKu",3787:"sha384-1M4Pso4uuS/lbVsSsFs5gy6kSLdai6pDJOdbd7KXmo08B1PnCR33UIuawR4yHgex",3811:"sha384-SbDCZK+D8UsDcvc6Q/amol39uYi39Lz3oUgesVOVcD8twKShkKMSYEmypJDcqbH2",3814:"sha384-iwKeZj4aRRPoHAperAHYL8L0efU6OJ/r3s+rjQq9p8UcI6vUFX1fcN90hWJsbsU5",3872:"sha384-yB+/hYhNzKp+UIvk8+ysm6ueJ7qklZwLiBUUgc1OsatUWzMfpza9jwGKseu5co/r",3903:"sha384-nClVp4Py0lZH+bFtgeKND8LLArX9km/uwKVqBzrEnD9koZ6FQ6a5/GzHDBK1crQN",3988:"sha384-lXzkv8AV7DAgZ27CPqwtIrnozhiXYL3aIHGh0IXJHG7zKcBSPo5w74xymhAwvFmT",4051:"sha384-ZYcy75Ukl8Lqhs7SFKXYkuciBPwm3rxVUrmEF45Z3c3ZsNZFBz22d2gDL25mSnQY",4057:"sha384-5EittyfPT1yzZtgdZZXzZ/0pMkLkDJJbvSAwGygXM2yb1vbn982fzanBEzGm89Df",4130:"sha384-NqQVMo9+/WDLywg8XuJO7pk3d4wE2Aqex4IvS0aV2drIPM8dnqbLB1KjATrWSicn",4144:"sha384-SXmXcXUBgedgiC4Y0kK5utwGnur68KgPoHClK2lPm+WCR2cG0JIo68E6LD3foYQ+",4335:"sha384-uTym7k5SBCC5QFlT5Jxf83JMB40hJc6mbeToxTGn7RNajC2BdWRPR55jVtC5EunU",4525:"sha384-t8Do4QPvviwqOPisMSVX4UhmlC3Mql/9wb7+M1FcS4jnGhvzvS3oDX7h77zMewX4",4565:"sha384-scxkbbHrc7ryuwgvuK/Ntz3uYSUig8HmAPHvcfl6HP4PMI0MoNgXK0k0fZ8FuNyF",4569:"sha384-Y10ecll+M8mqcDxwTNv0aXCiEyzDA73H+zby755U+bNY51Fuq4IIVwCtEG2E1/0C",4584:"sha384-NjjStypFIxcGJ/znpHfDLOBZ4rH2Iqd+BGKQULC3CvDMWAbrNQeJbr1MQDraIS7J",4620:"sha384-wx+1N5AAt0W6Jtm9q7iT4wOgML1KHvxC4+pck9S5CLvKxEtJQ/8T/stsgk/6LSdO",4628:"sha384-zsyWtzhgSmzmRSWFs+CmJv63pqSoHitIKj4Jjn536JYhNtLspWZY85BmLxta5hfB",4630:"sha384-/au+ccR0ejZjW6thqiAIzIItJgqcDamvWlRrjwHAn812TYUSs9yPX7/1ncVv8HS5",4654:"sha384-VttVnqrOlc6vCrruruJMQGNL7T++2+dBaHYyccn3akdxgw69XbLqWDDgEMrYUJ6f",4699:"sha384-c0E3+S462RJAs/zrOX1faGL/ctsoIgmDUnyJeJn1dtnXELd/raezxGIP/ets4ntc",4736:"sha384-RLuMf+xIWodnJpu0o4msMPDuKkDu4HpHRaFKzvVIi5xf/iPaH05uhpzRe0f/cg3A",4809:"sha384-HxVvF2wO1XhyDZEIgFetKSJ3iSHKBUpmxEfzQLEe+Mu3nFh8sMf+MbKse0jLMndr",4925:"sha384-ZZntBpXR2OPaPEOSsNfPpWsSQeUTj7/p3Q/OJFr0OIb50vp1yNgG00uzJoGdnQCE",4981:"sha384-/neBFkH4Y1fQoyNQ0YEVJ0KtqtgMAq5fuW1uq855OWzN6AwKTv0HpRko9yA96gSv",5001:"sha384-cPkPzggzwnX8PKtLQN6B426WdkJnojw+qN/17v2qnPApDBtKTyDnJzHtU9sTAlK8",5167:"sha384-h0GJgTUEOiRbm6jdN8anze37ibk24xixfnfgFqv4o8rW6v0eWFvoecjcadKbCUeL",5172:"sha384-M88jH1bE3q6Bo7VX+gosy8wJPdHLWuKwGVbNJFwcTErgPMKZtMHESmFazzeNWLR8",5222:"sha384-cAIHYGu/2xzpP6eDsSJ4rRTrNT8+BLiXs+0GBKkimIVY2IC7ZiewvPEkkFswuZCt",5271:"sha384-EqoF14iJjowLGzhiqR7DhciZgUSbgP96Cc+BCXxFBLHZio7Pz5c6chZBew1N+iiq",5383:"sha384-XuxqOkYWOowd5nRq7gZMZtkKt2tf4vIi/RTuUIB3rz3eSqBxgN8oU2LLxJ/s7dDR",5393:"sha384-HS0qc6oyvcxMUZydVmThhyBBtQu1emM6swYuMMrV7KD5WAme7emRLTKhdmgGOlQm",5410:"sha384-3dhvcmXYqw4E1juQjEXZwJIdGmKoGdOTfMMwA10yoH3Seg1itRWmGu5a4kHiUTXk",5467:"sha384-9vtfCTyLpzBJuFdF9JaTWGHNBDchQ8wsGe2YPsRAvk53OT3LNyjG/aOL8kkGVLwY",5604:"sha384-VXPI4dOeMrSDoFgolHbDA/OtjrLtlC5VT5WvwkwEoLsbBQdQZ14RYcR+2BiINb8E",5760:"sha384-zW+dpSMj4/6FQsq9mTxmKrQMchrWY/zZXVZhbRfzJHRmwsBi1UHR9MOPnxjT0QhN",5774:"sha384-bppUlKP/IxrsL73OfvMsr4KzTE2u8OPExxuXVbbReanX+bsIaQ9k1xtcL6T4UIE/",5777:"sha384-PNLWOP2XNqebh99CVUqh0Da1N/qYCCMTXoW+kNpAdBt7k9VgrOH0hao1uZj1z0Sm",5786:"sha384-eC/G3nQQIlTjc0cqU6pwYiaDmWaomGvPjqCaxxEUhC6yFfxc0Mv3NiYKD2nrAnCK",5848:"sha384-fWHT8BQ8dVQo+Bu6+wV/7PUXnKICjI4vqbVf5xNBjdFjKN/tst1zhCFgNyh+GWf6",5874:"sha384-ef16GGOMEgjbvh3kknzPc1vFCDW3WxqkgbxCSkoRPl6Du7Q8UjI8INFAz4OmvVIh",6009:"sha384-csjOvk3YivFezoQA6GoZC6Ovm8O1mU7PZ2pNIj/WY+schfTaVCPQ46mlIBJCi/ef",6014:"sha384-tJRCXJkbgojUcgSDpzxIdqhzLeUZxzE/r9TEXLfH/xZzJMAVhvRiwRXW/z7zuA/B",6034:"sha384-Tzwi6kZrACMeBOIP+Fhknhfz34zBqy6xu71eI6c59Y+ZM2c+mDWrwX5EuMKe5j6h",6099:"sha384-322vu4d8xd9P77BufL85zcjrKcB3ilMiUYkuBfd0IEIw5v0BjnJQvPVVbyNVir+r",6139:"sha384-K/pfbytl/RNWHiQLKFQTpFtOFR6829G3XFKvlfbT2UFQBPlla12mM1ebVuQoofMh",6154:"sha384-Jelm9VHNJQfZbSauloUBxkmrkQ3GPVSLd5oqE47tWCxAQtnPmsWhIeYmSHug8cNW",6233:"sha384-xhtexaiLZY1tfKcYga+DG7IRqObBN/7kiJkceTMJXXhjzMSSUe1KCGmt2IbLxgsJ",6251:"sha384-UQDV+KMgWH6Umk9huDFrSBoor6+qlfDfEZSeg0p4x7vm/cnQv0kDLxLHEiws13G6",6256:"sha384-rV1SqSe4BeccZlVZKueb+AQUokBY9cszIgZyQnXewO5mdUEbd5+pJGKa4hOIcaGo",6266:"sha384-NHPgy16X6t5M1TAS+81s839XCk+OyDlQyFiEHWMtHIcjPLDV62mUPpEb1oWiKEuA",6294:"sha384-614F7gq/jQNbreasbPaPwxAEug04oNnhexCjxfQzIaY0IeRxHAQb5dDuFO2BIQhm",6309:"sha384-v80nqv9+ulo0DbHC6O4hU7Oca9jui+0aMkvbuXkRlNoXENz9Buurnq+ekyIBe0nF",6338:"sha384-ZaAU6Wwmm5chYBpiZioGDaal+c5QsIlELOIHqBFSHf9NZOXk7OE69SlLOx/oJG5C",6354:"sha384-aPl1TMqloCLw3wkVnZBC6J3wU+sDmIey4zFmYNVUyzsSN6ZWnuXARPmJ4VTHdygQ",6452:"sha384-Z9iRQl3hCwcg2KGN2ymEGo+hRdqcPcRij19mw9kvLxrStOMmb3RkjEK3xiUvXfOa",6471:"sha384-DQQJgfbPMtAy9XzOUoCSHiBvumigEV0ZaQ16Ovv+LExAs1u4CmgiVPZVa07kgXiB",6485:"sha384-K0BTEjMu9maABoLMYBAkvdzxecbGFo93es8TxNjWTa5/s9WJWQus69Zqks1veQrZ",6537:"sha384-JZyamZEmJASWDBhNieEAUS3n3QTg8I/EKkoq9M7VpRsqDWzr7JNqaeiFqu44lIso",6553:"sha384-3xeOVu7qadYZUXLOrOE6BjCZqGIBqgxsPuDNZyDrlxX+7i9qgwvNlmgdDFBAxmjz",6577:"sha384-6OYwdRklFKVIXy67u6/yzhRgOtC41TVg2OyZglPSO5JLLvpqqzpv214GtYYC2rav",6599:"sha384-XcMPgY1EV4B7vpv8pUMHa5lXMb32P/SZyLpwNKLAsZVSWdtbg3VKP72Vayd9LOs/",6607:"sha384-MZANjcCo2nqepB/83pFRUaQBsX4Z/XLEr1fNSSC9g0O3D4H9mwT4M9ABl8bblpLL",6664:"sha384-dQ59qJOcNXCJzh5IJE1UIl3FVQPMvu4nQDkH9To8q+qp32bhhaiqhnYFxJeuR4JS",6701:"sha384-iQ26L6wfm95eWyA0GnkjW7/O4DyovS1oiKAt+hGtk9Nvk9TAHX6LHrKlPvSr3NRv",6727:"sha384-QP2kixDlXAv7QUA5pOm4BxagZV2QbNnKdB+YvIpbCgqUvmXjFWNjTIiaAvS4J1Fr",6769:"sha384-DOiVEC8LiISVCMHsEwyxtYSWf04LWwJHpjJyDIZQB/EGvebfkeSOivCwlPuNORbo",6774:"sha384-ExeqP024ei/9nBTdHwOBZ9WjxZpdqcOBcVfjYnXY/rIR4W2l/tEjSutjFH4aR8BZ",6795:"sha384-63hb8nVq1U6kBtgEK0X9p3sDmsqkr223SYD11DgiHLUPxYOMYFVB8EBmoRBGy5zT",6798:"sha384-Jxm8FU6SVcE0ybhTIydo8XjQWcRns2TA7XbudHMABfqPlCX1DJJ8yz7xLGy/8MeO",6817:"sha384-PooKf9LCcTH4pz64nE4/nJWzdz97+TIuRQVWKj0ca6ZLZreF3ZDWpuBXC/DPt4AI",6818:"sha384-ol4wq5gMSZ4J1Ww8DOo66gpGvW7ykdXtk+BXxMK1HooCHD6PrrOgKvreaObDIEgA",6822:"sha384-OgL/QIbHSVHkq20a8lyNRqM0kUCeB5VhaR4bsRtFOii6Dx5AfOLjXLJftWlcHNpS",6832:"sha384-+kSo+jk6aHXM6/h8oxeQmAktGDfYKaRPDzSHas4Mr99Zg4CXHzP2FJxeekLvgCgl",6974:"sha384-ZFGYXZsFRA7MsgKqTpMGSQNWacQAuyPiA3XABMERVgd9HER39VqGlawMmAt76LJZ",6983:"sha384-JI1U9n1TBksF7j15ah2iY02o0OlPz1BZxGDHbWDumSJJlmkdEdQU1hsQzzg/wIXT",7e3:"sha384-Kbjnc60hkd4NEpciMcdhTR/BKVoTykTES9MGmQxevXBQ7QpmV2gp+iMRzgWH1Bgd",7027:"sha384-SCpx5ktI8/ZhvcFLJDlRXg4e5v9iksembh+3bXczk/5TPHpJEemh3DgNeG1XV6nl",7031:"sha384-56mc84kwXlYEEL8PrrP85MPTCetN957wS8jxsSkdR5j2SqlZqe2PRY0Qzt2/iGHy",7142:"sha384-SBqNkJTjRablnR3uboo6ZtSqqlqq2mQY8zzVvnkSGly9oUq1Tgd3p92zKSjEMSLL",7156:"sha384-9vRgiXHbAdexQ3b3F/tMqGtQwzpSn8uqOaETWhr/fyS4DhNOgCFpzFg4kfkaZzus",7168:"sha384-ZG6ZOKqh5w/F5mFgxcnbPoLhuXMlguskV8zt6BoKfomeL35E6b1rOBwFBYLIcSqG",7250:"sha384-zd7RzrKj3Dmcwatp2XIGV3p1VgOwrMryJpKtEpw6a/cX6vPwNsgTuh6FLOGu9d5T",7274:"sha384-yb0+YRJz6Ajpnsm1RWQ4DP0uzhLgzWw7sAI9T8l3a7RG4PfgSMvdjU1qhMfmlO6E",7331:"sha384-YFrpyipW/1F5EUZ5gHrNBwZgy23adyU9i9ilSeZQxnAZKiO5lVAVHJZQRZr/IPVA",7332:"sha384-VbeB1dO6/2F7I+MCqSDUah5fscfF/VQEwtJdRa+kku9EG+n3ecGpmPotBfeWrsB1",7335:"sha384-aImKOzUOH144iuXYNu+dp+sRmmSZf/0nqQmAUJJNs7S4KErZ/AfF6F/RRyvC6l63",7348:"sha384-0VJs4Gkw+WO/D8dy3iIckBztyEj4/P77MyLM4tJM512VoKL6f2OJwC0NCUcqsS3c",7399:"sha384-WYjo7HonqZ1WZ9EDFhlBIQvDtjkcehzY187/9ZO11fnqC/Qsnhkj5TQjIINARkK/",7420:"sha384-CNUT20KephmH3oi/Q2hjqKrRLEk70O5lx/JKkb23ADOUgDBKj3JKY99V/rQWzWP4",7437:"sha384-j4QA8siUaAciWJajCvYSwPKt2KgIJ1HqZZl6MfOpDNCqeKofHIwnPFdv2BYlxB49",7447:"sha384-S76GgSW/rv2hqtwbyN6WfmABeBtcUwjETt2HvmpYVGpzcRwmrQFeCtGi40QYPBuA",7581:"sha384-lZgVelkVcRkDwx9fKkxiEvMkGdhxWJpU+K3/NfRgqhwsNPxVIas1hMK1Evz/4s4i",7610:"sha384-IM4ngF2yDRf6v4VWKDgE7Wh0xicUafPVoEuIuAnmdjEbofsYqZEts9j4swcJE6+k",7674:"sha384-CWLIBZXZqjWMoedJA/Dm4icX11B3W1AEqxKFE7uvz1Q8cMy4VWccpoE+eHUoGfKw",7681:"sha384-avJNa8nh/jW9nSEPVYvvILh1PIg9UDVUEM4dv/nyUKIZWv1l9CVM9YJlH9A00kER",7716:"sha384-C8omSdp8AlrHOaWp7pJGLHdWcZJ4Vx9J3vIw+4oF53zHLSEN0CN0CyCk4q3wcIXP",7761:"sha384-DKcdMtt0igNAZ6PuBLjKtaidavSeRFzZvGDBKfxc598sx+Oa4eDKITrGTx2q/Pl/",7805:"sha384-OchCStT5TwXpFFMjDEM78U9c7Dc/SzHZlB7GQayX8Se3YPWG9gOnk9ICUBk+qiG7",7879:"sha384-WlPamrSbHvT6YvJF21aWyjMOEUZs+o62X+/TTVjBojRg8V6hDRsrjK1qK/6VcU3o",7912:"sha384-+0ZVffyogCAgCPNRKSPGgwclT1yHAHLcaTP6wxSS5jRLvaIHutgrE9AqIkXXz91d",7938:"sha384-A9D6LUp3cipNqFt6wZYT1lWQyvzHetfO1d1l3cCfyMlVqrgcaaKIzIkxvKKv1Tou",7960:"sha384-Cd4awWGVC+BEiIGjds1pKhZYUQCEcg7Q1fg4qzahlHw3awPGJSPzNaQ3+/tHiHP+",7986:"sha384-R9qYiSnBPgeG+I9mz/1HbSUSmI5psJLXLmZIrAmh61LQx8Xp5CwVxcCf+w2HPzKO",8102:"sha384-nxnjIvQxPMFRRGu3ZuhJUQyL7Y1jW6xnQiomX10nTd86mBR4FdYYeHCy7vAGjx80",8217:"sha384-B7J2iD/2XCE7oVmNfN/Vh81/l1mSTrvMnU4h/BT0FxdFN0FNTshnvdWAQdEkOUK1",8225:"sha384-1COXh2LooAbhy3BGNmkEzsaeqlTJCYt+RMqVcRs6a7aPaoz6wj+YTo3Phy3uA6uW",8226:"sha384-84DeZ/18RqcLSabAZFCZ1lprmRifkl0Qnx3IQgYEi6tE0tDgPM3w3oaMknWH9ICi",8235:"sha384-i/NM+VyXcYubYQhmIzxZfxVlLWaL4YwkZ7ErjfdqEK/yq70btHghgpDyeVUmxpih",8253:"sha384-48DO13FlJ+uMIAq+eIH0aGX9RxeAq8captvYYbLO5ciTyq0ogIRny7xDZpxOTrGw",8266:"sha384-BdaNhwaVuJI0e4kR5Z4LseVV+3Xq1lgG2RyvQ+GIGZRaVSe0WzcWroP8+PyhZGMt",8267:"sha384-qj/Els/biti3GLdpTehvdlnRklS3Kw68GBhzC4+sXPQWgHPak9/rmnhy0KssK3mO",8294:"sha384-V8r6IfNOW+ygDEFD5LuUVLfC+dcQm34q39aeJZB1hAIn7+VvizJssFKPB8gURcE9",8342:"sha384-vxwhU0wVfAjBlvlt0xICDfSI/SuhdVCvnhYRh5xrV6dd4sM6uvOtu36mpD/zctlZ",8361:"sha384-5ld53Pfg98+6jZjuAdm3y8VcudWjdvB5US0eeC4IOdmUUqm5HpVeAciljWuYJ20i",8394:"sha384-bgru573dwQMQqvsx1UThSbnI3JTY3OjB9HzHbr6lptJ2etC3gkhax/ZR6upTmRKJ",8438:"sha384-nx0NeMRWjw95xPyCBtKTEuOC2esZKcgF+10HaHL/+YbNZJ5621+khbF4LAF6JmFj",8466:"sha384-TvZkTJjhAaK5D/eZnTa7I7E6nEVO6O/kiCvdObgFD8nfz4PRjd/VjTciKwDyVqVw",8507:"sha384-u0dArgonFO8CGIOm1C0eujF6ixbgPe6M/VeeB8CpgpdX1HksW4vc5rFNbcYGBChP",8530:"sha384-rv4wKSNZ2Nvs8moJXN6PzGyMRaoN65OdVN0NFVr5z90U9TxBIsBEgtjr+m/0hens",8579:"sha384-96ii68YqsWQX3NwXYs2x4x/zBShW7Lbh5Znsa4bcg+7f7hQD+PELXtzk/ET3PqbT",8581:"sha384-XsOEI0Y/hYkBjmN5CYdZmZOoAK9wFGdqTKzj0OH/AcgqpeOg6B2AHTCidc8EZxvC",8602:"sha384-ywpSFIebQiI45exRu8rlb2rG3TJWyEVdMvee8Zu04DRqgRc8I//F7B+DnikPots4",8660:"sha384-DBSRce2Hh+cNvbP3AkfUS7YP5vzVjNwaq72lXUSx8+JksxSq0tHTKTP++ZZrmjJK",8692:"sha384-Aep98rupg1oOZFXhPcH5TrH0qLDG/eQTMnzKkTVtPKjlSjoGp/c9eHtWdbcTMH1T",8771:"sha384-uhwRO17tmHdnqXLFs1ILYfCOqG7VNlzLsxxK9zuO6VA1Jyf50gJdklDZeTyPej1G",8793:"sha384-mZbHAiS4JQNm0STBBMMeZX7utClbRzC3wccpieJ57RnSVtCleG7y4Afcd0trDWnp",8869:"sha384-NKrWz1AAUL7lo+blhbexbrs+Jnql8U5Y90ze2THalbgKuIsNZYPoDTTUgOfaQke1",8904:"sha384-Wqu5m+EbL8ENDaT5jqj84PwLKRzX6na9MTeaEROnQhH5sg3gjfIK46yQOO+bu+nq",8975:"sha384-uqieOv6do/Zb1sofpCTZ7cYsdSjR1JjSwpDHzWUiL1DKlxjzeCRrkVcmEIIyqSoQ",9022:"sha384-BPDcFt/bwKofJ0YHSyybesbB1PdKc2MUdyDEsC2bAFy5ctoz8DAQCGJgW4GyX+DM",9054:"sha384-2VcQW0DJ2yBOLxoagz8z4ph2stD0B8zT6ODt80Wnk638/lLkoVUySc53ooJhpjtd",9105:"sha384-mGKtXPOivsrHiMt2GpqaSaVVe7x5pzMO/ZF26k2d4/tkJDKeb/VtTw7HMsqIjYEE",9173:"sha384-js4ocydzsE82QQvio3Z1ZuXGFqfc4PpNk+BFg7FbDKsh6eSM8V743P7a9VDFRWZy",9179:"sha384-nryHr+NhtqMIdsXFp5qhX2fOIk1C6VzC05tDCd7qHHB8GvallRJKA91VlTjSRKqJ",9264:"sha384-xWyPsMybIG8KtXaKp3eWeK7h8N7cZox6V3pCUL8Rzh/U9ESBzn7MQ3uyNalTWnKE",9275:"sha384-VEswPy3FafKT89ClgfRN05T3t+/Y69/Vwj1rchE2knKbpawhmCZCEM5b9DdgvPVs",9310:"sha384-WETT05y3TFmLV5qRn/R6Z0FufeDuKzNSer3bsKCDCfuE6Xai4Ox3sFnhx/Prm2ho",9324:"sha384-6q1k+OSa0dA+PQEI927QO2TZQXFRofIXl6BhFwKvVn9Vfte8610r6jAOVtqgB+95",9355:"sha384-tW92wypvimREYimW3lBAH0zZ30sH5e15CJg///o4X9NE3iMAFOwQR9/5RAq+tROG",9371:"sha384-Lqpv2AvMpAyG9UZp06smGhDHAqqjV9aOTIyMVUfJhtppsHz5KjjPAptIAK0XmE04",9414:"sha384-sbeC3IlfbEwqONsu+xf8d70PSP6mGV8GpWjHfFioE2sE5u1rpU0r/UtyvZLrJs1P",9526:"sha384-fyrPSpG48wakl3/j16tYYiZ/rUEeo5lQl5XVN6bOJCAD4RUUoaICE4Whni2gEZkX",9545:"sha384-jckIlPPid2WaZXE92BysEgdvzf8uWf/vWCdc8j64XE64oXG9eNOJ9MnTcLl4xLyo",9648:"sha384-lrgtiG1QXjPX0A+pjcdKfAJ8Bz+cQFJuiJmpbMawCfZie/Xx5oG7MuIB9+fkBOQe",9660:"sha384-+5Ovh9vlbYNUvmzEPzFP3p/U4sa15pAVyOWM3GXEpAOgCzJDY5FGnWp2xlA4C/HI",9705:"sha384-eAV3dnxUtFqu1YZT8/Fe7A+Gomq7PRTkP1NW8H7LTpMedbZAg19kn9Zjl2ESm3pa",9729:"sha384-gNo5fUfFYRt09snOXD+dIur9VZT/MHXJAefDFd+lcNgyPnO3nL/qp16uGiJSftdB",9743:"sha384-jc1/9JdVs3RzObGJ8b3vPhI95Jua+qPUW6szJb++pZFYENHidxZjfQmimUR7oDSR",9754:"sha384-SsxrI3Xcs2b7hURf0evqlD/1noLTN6IDJ3a2ORUbGe1qu60uBPgQAyMKp06dEjWA",9779:"sha384-2BlRGa594E3B7zD+K8Umk2exo0JXszpmZ4Iwn/sFJliNXgZMzXe/TF4JV/dBca2J",9806:"sha384-ZzUz+i4UbVk1IOYnnIQthOlYgx9gXZj7H609kP8ENoWTR+zlPKEEUDYteeeWh14Z",9830:"sha384-DmCsswKeMSBk7DztVuM/51H03NXyIiOf9JQMNo6ggWIFYVZHxeEixZgbeD34nfay",9843:"sha384-FveG7WrCjNa8lcNg1dzr3N8w/KcKD/uQE7FnU2zh6gL++kAdP8Y44XOzxfEfveqQ",9894:"sha384-hTlFUBgka1tsKW/kLJPrMTqtq4Vi78hRFxRfB+Tt50u6R7Mo2a9gcy3QFd/l7vOJ",9898:"sha384-5W4yqHpdDViTRJvZT8DPhRB9V6wzq/BLtfIchLFmm3v+ukJFHPnmtDRMz7hAwqRW",9920:"sha384-cmioNLBaLei4x8iCCFICLXphQuGItTdERH/AVq6g2aCBWsg9jbl1YxnY1KBSYkYC",9955:"sha384-835Ox/FRk3YHJUttbMuMXXqHNyGUgffVUgg9H6zmyUJip26HYvgUZf+OpjgEjcRo",9962:"sha384-CyOJcGoh429MeIBZBnvtR2+MSmKKjN5mrzuYHSNmYR3b5QWVsaIOv+78mGrOJMia"},(()=>{if(void 0!==a){var e=a.u,n=a.e,t={},i={};a.u=function(n){return e(n)+(t.hasOwnProperty(n)?"?"+t[n]:"")},a.e=function(o){return n(o).catch((function(n){var r=i.hasOwnProperty(o)?i[o]:5;if(r<1){var u=e(o);throw n.message="Loading chunk "+o+" failed after 5 retries.\n("+u+")",n.request=u,n}return new Promise((function(e){var n=5-r+1;setTimeout((function(){var u="cache-bust=true&retry-attempt="+n;t[o]=u,i[o]=r-1,e(a.e(o))}),0)}))}))}}})(),(()=>{var e={9520:0};a.f.j=(n,t)=>{var i=a.o(e,n)?e[n]:void 0;if(0!==i)if(i)t.push(i[2]);else{var o=new Promise(((t,o)=>i=e[n]=[t,o]));t.push(i[2]=o);var r=a.p+a.u(n),u=new Error;a.l(r,(t=>{if(a.o(e,n)&&(0!==(i=e[n])&&(e[n]=void 0),i)){var o=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;u.message="Loading chunk "+n+" failed.\n("+o+": "+r+")",u.name="ChunkLoadError",u.type=o,u.request=r,i[1](u)}}),"chunk-"+n,n)}};var n=(n,t)=>{var i,o,r=t[0],u=t[1],s=t[2],c=0;if(r.some((n=>0!==e[n]))){for(i in u)a.o(u,i)&&(a.m[i]=u[i]);s&&s(a)}for(n&&n(t);c<r.length;c++)o=r[c],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0},t=self.webpackChunkMicrosoft_Office_OWL=self.webpackChunkMicrosoft_Office_OWL||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))})(),a.nc=void 0;var u={};(()=>{"use strict";a.r(u),a.d(u,{DocRebootSupportMode:()=>Yi,ExpectedFailureReason:()=>be.I$,FeatureGateConstants:()=>l.Fh,FileType:()=>N.T,Health:()=>no.S,HealthLogger:()=>w.zP,KpiType:()=>Cn.o,LogCategory:()=>r.W,QosErrorName:()=>be.DG,TraceLevel:()=>s.G,UlsLogger:()=>w.G2,WacErrorName:()=>be.AU,bootDiagnostics:()=>be.c,bootDocument:()=>Ii,bootDocumentWithCustomFunctions:()=>Ai,createNewGuid:()=>x.n,forceEndSession:()=>Hi,getClientUrlForOpenInMobileApp:()=>bi,getDefaultResourceString:()=>pi,getDocumentInfoFromWindow:()=>to,getExpectedFailureReason:()=>Oe,getFeatureGateConfigByName:()=>l.vJ,getFeatureGatesFromString:()=>l.i0,getFetchAccessToken:()=>Ci,getFetchItemFromNetwork:()=>Ui,getFileTypeFromExtension:()=>io,getFileTypeFromPath:()=>oo,getHootEndpoint:()=>c.XQ,getPrebootSessionId:()=>et,getShareEndpoint:()=>c.PO,getWebUrlForCopyLinkToPage:()=>gi,getWiseEnvironmentFromTeamsRing:()=>Zn,initPackage:()=>vi,isExpectedError:()=>Pe,isMobilePhone:()=>Xi,isNetworkError:()=>ke,localStorage:()=>Ie,logFeatureGateUsage:()=>l.dt,notifyHostAccessibilityLoopComplete:()=>wi,prebootApplication:()=>Yn,prebootDocument:()=>$n,removePrebootSessionId:()=>nt,setWacDataCenterValueToCache:()=>D,unifiedUiHostConfigs:()=>rt.J});var e,n,t=a(9850);!function(e){e.vi="App_AccessibilityLoopComplete",e.hi="Wac_ActionComplete",e.mi="WacInitialize_Ready",e.Si="Wac_AppFailed",e.Hi="Wac_AppBootState",e.wi="Wac_AppCompleted",e.bi="BrowserEvent",e.gi="UI_Close",e.Ii="App_CloseTab",e.Ai="UI_Conversation",e.Ci="UI_CopyAndEdit",e.Ui="App_CreateNewDocument",e.Ri="Wac_AppDataSavedStatus",e.yi="UI_Download",e.Ni="UI_Edit",e.Ti="Error",e.Ei="UI_FileEmbed",e.Fi="UI_FileProperties",e.Di="File_Rename",e.ki="File_RenameFailed",e.Pi="UI_FileVersions",e.Oi="StateChanged",e.xi="App_IsFrameTrusted",e.Ki="GetAccessToken",e.Wi="App_GetAuthToken",e.Mi="App_GetCustomAuthConfig",e.ji="App_GetHostKeyValue",e.Gi="App_WopiInfoFromUrl",e._i="App_DavUrlFromIds",e.Li="App_LoadingStatus",e.Bi="App_SwitchMode",e.Ji="App_MoveToFolder",e.Vi="UI_OpenInMobileApp",e.qi="UI_OpenInBrowser",e.zi="UI_OpenInClient",e.Zi="PageChanged",e.Qi="App_PushCommentContext",e.Xi="App_PushState",e.Yi="App_DocReboot",e.$i="UI_RedeemForCommenting",e.eo="App_RefreshSessionInfo",e.no="UI_ReplyWithChanges",e.io="UI_ReportAbuse",e.oo="App_FilePicker",e.ro="UI_SaveStatus",e.ao="WopiSession_Complete_Ack",e.uo="SetOverlayContent",e.so="UI_Sharing",e.co="UI_ShareForm",e.lo="UI_SignIn",e.do="App_StoreHostKeyValue",e.fo="App_Unloaded",e.vo="App_UlsLog",e.ho="Wac_UnloadingApp",e.po="App_UpdateBootComplete",e.mo="PageCount",e.So="UI_CheckUserAccessAndGrantPermissions",e.Ho="User_Activity",e.wo="Edit_Notification",e.bo="UI_Workflow",e.Io="ZoomChanged",e.Ao="CAAEMessage",e.Co="Excel_HostFrameCacheSave",e.Uo="Excel_HostFrameCacheEvict",e.Ro="Excel_RegenerateFileBundle",e.yo="App_SwitchToWacFrame",e.No="App_SaveSSRData",e.To="App_PurgeDataInHostCache",e.Eo="App_SaveHostRenderingV2Data",e.Fo="App_SaveHostUtilsData",e.Do="AcquireOAuthTokenTeams",e.ko="App_SwitchNotebook",e.Po="FailedBoot_CheckFileInfo",e.Oo="GetTeamsUsers",e.xo="SendTeamsUserMention",e.Wo="NavigateBackToHost",e.Mo="App_GetClientUrlComplete",e.jo="App_GetWebUrlComplete",e.Go="App_CopyLinkComplete",e._o="App_SendConversationId",e.Lo="CloseTeamsConversation",e.Bo="PageLoaded",e.Jo="Visio_BRS",e.Vo="Visio_SendLicenseInfo",e.qo="Visio_Consumption_CLTComplete",e.zo="Visio_SwitchMode_FromViewFrame",e.Zo="Visio_ModeSwitch_ToHost_Ack",e.Qo="Visio_UpdateEditUrl",e.Xo="Visio_PageViewLoaded",e.Yo="Visio_ActiveAppFrameLoadFailed",e.$o="Visio_DisposeBkgFrame",e.er="Visio_ReadyToReceiveDocData",e.nr="Visio_DocReboot_HostNav",e.tr="Visio_SwitchToVisioFrame",e.ir="WacAppPerfMetric",e.rr="App_ModifyURLState"}(e||(e={})),function(e){e.ar="Ack",e.ur="WacInitialize_Ready_Ack",e.sr="Wac_BeforeUnloadApp",e.cr="Blur_Focus",e.lr="Wac_AppFailed_Ack",e.dr="Wac_AppCompleted_Ack",e.vr="WopiStartSession_Complete",e.hr="WopiPendingSession_Complete",e.pr="Host_AccessibilityLoopComplete",e.xi="Host_IsFrameTrusted",e.mr="Grab_Focus",e.Sr="HostCacheDiagnostic",e.Hr="Host_KeyValue",e.wr="JsApiDiagnostics",e.Ji="Host_MoveToFolder",e.br="PageChanged_Ack",e.gr="App_PopState",e.Ir="Host_SendChannelId",e.Ar="Host_SendConversationId",e.Cr="GetTeamsUsers_Reply",e.Ur="SendTeamsUserMention_Reply",e.Rr="Host_BackButtonPressed",e.yr="Host_GetClientUrl",e.Nr="Host_GetWebUrl",e.Tr="OwlFrameDiagnostics",e.Er="File_Rename",e.oo="Host_FilePicker",e.Fr="PostAccessToken",e.Dr="Host_SetAuthToken",e.kr="Host_SetCustomAuthConfig",e.Pr="App_PushCommentContext",e.Or="CanEmbed",e.Kr="Host_RefreshSessionInfo",e.Wr="CheckUserAccessAndGrantPermissions_Result",e.Mr="Host_WopiInfoFromUrl",e.jr="Host_DavUrlFromIds",e.Gr="SetCurrentPage",e._r="SetZoomLevel",e.Lr="WopiPendingSession_Fail",e.Br="SetOverlayContent",e.Jr="WopiPendingApplicationComplete_Received",e.Vr="Host_SwitchMode",e.qr="Host_Unload",e.zr="PageCount_Ack",e.Zr="ZoomChanged_Ack",e.Qr="Host_ShareUI",e.Xr="Host_Telemetry",e.Yr="Visio_ConsumptionCLTComplete_Ack",e.$r="Visio_SwitchMode_FromHF_Ack",e.ea="Visio_SwitchMode_FromHostFrame",e.na="Visio_FallbackToLegacySwitch",e.ta="Visio_DocumentData"}(n||(n={}));var i=function(){function i(i,o,r,a){void 0===a&&(a=!1),this.ia=new Map,this.oa=i,this.ra=o,this.ua=new Set(this.enumValues(e)),this.sa=new Set(this.enumValues(n)),this.ca=a,this.la="",r?"string"==typeof r?this.da=new Set([o,r]):Array.isArray(r)?this.da=new Set((0,t.ev)([o],r,!0)):"function"==typeof r?(this.da=new Set([this.ra]),this.fa=r):("string"==typeof r.validOrigins?this.da=new Set([o,r.validOrigins]):this.da=new Set((0,t.ev)([o],r.validOrigins,!0)),this.fa=r.validateOrigin):this.da=new Set([o]),this.va=this.receiveMessage.bind(this),window.addEventListener("message",this.va)}return i.prototype.registerHandler=function(e,n){var t=this.ia.get(e);t?t.push(n):this.ia.set(e,[n])},i.prototype.sendMessage=function(e,n){var i,o,r=null!==(i=null==n?void 0:n.window)&&void 0!==i?i:this.oa,a=null!==(o=null==n?void 0:n.origin)&&void 0!==o?o:this.ra;if(this.validateOrigin(a)){var u=void 0;try{u=crypto.randomUUID()}catch(e){u=crypto.getRandomValues(new Uint8Array(16)).join("")}var s=(0,t.pi)((0,t.pi)({},e),{correlationId:u,sendTime:Date.now()});return r.postMessage(JSON.stringify(s),a),u}return!1},i.prototype.dispose=function(){window.removeEventListener("message",this.va)},i.prototype.receiveMessage=function(e){if(e.data&&"string"==typeof e.data&&this.validateOrigin(e.origin))try{var n=JSON.parse(e.data);if("MessageId"in n&&"SendTime"in n&&"CorrelationId"in n&&"Values"in n)this.ca&&this.handleCrossDocumentMessage(e.data,n,e.origin);else if(n.id){var t=this.ia.get(n.id);null==t||t.forEach((function(e){return e(n)}))}}catch(e){}},i.prototype.validateOrigin=function(e){var n,t=!1;return this.da.has(e)?t=!0:(null===(n=this.fa)||void 0===n?void 0:n.call(this,e))&&(this.da.add(e),t=!0),t},i.prototype.handleCrossDocumentMessage=function(e,n,t){if(n.MessageId){if(t===this.ra&&this.sa.has(n.MessageId))return window.parent.postMessage(e,this.la),!0;if(t.endsWith("officeapps.live.com")&&this.ua.has(n.MessageId))return this.la||(this.la=t),this.oa.postMessage(e,this.ra),!0}return!1},i.prototype.enumValues=function(e){return Object.keys(e).map((function(n){return e[n]}))},i}(),o=a(8087),r=a(7442),s=a(3869),c=a(3448),l=a(8563),d=a(2685),f=new RegExp("(^| )".concat("OwlFrameMode","=([^;]+)")),v="/suite/WebLoader.aspx",h="",p=function(){function e(){}return Object.defineProperty(e,"isOwlFrame",{get:function(){return"boolean"==typeof e.ha?e.ha:"https:"===location.protocol&&location.origin.indexOf("common.online.office.com")>-1&&location.pathname===v},enumerable:!1,configurable:!0}),e.isOwlFrameEnabled=function(n,t){return"boolean"==typeof e.pa?e.pa:n?(e.pa=!e.isOwlFrame&&(0,l.vJ)(l.Fh.FeatureGate_EnableOwlFrameTreatment,n),(0,l.dt)(l.Fh.FeatureGate_EnableOwlFrameTreatment,e.pa,t),e.pa):(e.pa=!1,e.pa)},e.isOwlFrameBootEnabled=function(n,t){return void 0!==e.ma?e.ma:n?(e.ma=!e.isOwlFrame&&(0,l.vJ)(l.Fh.FeatureGate_EnableBootOwlFrameTreatment,n),(0,l.dt)(l.Fh.FeatureGate_EnableBootOwlFrameTreatment,e.ma,t),e.ma):(e.ma=!1,e.ma)},e.showOwlFrame=function(n,t){return e.isOwlFrameEnabled(n,t)&&e.isOwlFrameBootEnabled(n,t)},e.checkOwlFrameCookie=function(e,n){if(n&&"FASTFOOD"===e){var t=document.cookie.match(f);if(t){var i=t[2];"0"===i?(n.delete(l.Fh.FeatureGate_EnableOwlFrame),n.delete(l.Fh.FeatureGate_EnableOwlFrameTreatment),n.delete(l.Fh.FeatureGate_EnableBootOwlFrame),n.delete(l.Fh.FeatureGate_EnableBootOwlFrameTreatment)):"1"===i?(n.delete(l.Fh.FeatureGate_EnableOwlFrame),n.set(l.Fh.FeatureGate_EnableOwlFrameTreatment,!0),n.delete(l.Fh.FeatureGate_EnableBootOwlFrame),n.delete(l.Fh.FeatureGate_EnableBootOwlFrameTreatment)):"2"===i?(n.delete(l.Fh.FeatureGate_EnableOwlFrame),n.set(l.Fh.FeatureGate_EnableOwlFrameTreatment,!0),n.delete(l.Fh.FeatureGate_EnableBootOwlFrame),n.set(l.Fh.FeatureGate_EnableBootOwlFrameTreatment,!0)):"3"===i&&(n.delete(l.Fh.FeatureGate_EnableOwlFrame),n.set(l.Fh.FeatureGate_EnableOwlFrameTreatment,!0),n.delete(l.Fh.FeatureGate_EnableBootOwlFrame),n.set(l.Fh.FeatureGate_EnableBootOwlFrameTreatment,!0),n.set(l.Fh.FeatureGate_EcsHootGate,!0),h="https://login.microsoftonline.com/")}}},e}();function m(e,n,t,i,o,r){return"Frame Experiment Status: ".concat(p.isOwlFrameEnabled(t,r)?"TREATMENT":"CONTROL",", Boot Experiment Status: ").concat(p.isOwlFrameBootEnabled(t,r)?"TREATMENT":"CONTROL",", FileType: ").concat(e,", Environment: ").concat(n,", Feature Gates: ").concat(t?(0,d.d)(t):"{}",", UiHost: ").concat(i,", Integration Type: ").concat(o)}var S,H,w=a(8880);function b(e){var n,t;void 0===e&&(e="");var i=p.isOwlFrame?null===(n=window.performance.getEntriesByName(S.OwlFrameTimeOrigin)[0])||void 0===n?void 0:n.startTime:null===(t=window.performance.getEntriesByName(S.OwlHostTimeOrigin)[0])||void 0===t?void 0:t.startTime;return window.performance.getEntriesByType("mark").filter((function(n){return n.name.startsWith(e)})).reduce((function(e,n){return n.name!==S.OwlFrameTimeOrigin&&n.name!==S.OwlHostTimeOrigin?e[n.name]=i+n.startTime:e[n.name]=n.startTime,e}),{})}function g(){var e;try{e=JSON.stringify((0,w.pb)())}catch(n){e="[]"}return{bootTelemetryData:e,owlTelemetryData:JSON.stringify(b("owl"))}}!function(e){e.OwlBootAppMessageSend="owlBootAppMessageSend",e.OwlBootAppMessageReceive="owlBootAppMessageReceive",e.OwlLoadedMessageSend="owlLoadedMessageSend",e.OwlLoadedMessageReceive="owlLoadedMessageReceive",e.OwlBootAppWithCustomFunctionsMessageSend="owlBootAppWithCustomFunctionsMessageSend",e.OwlBootAppWithCustomFunctionsMessageReceive="owlBootAppWithCustomFunctionsMessageReceive",e.OwlWithCustomFunctionsStart="owlWithCustomFunctionsStart",e.OwlWithCustomFunctionsEnd="owlWithCustomFunctionsEnd",e.OwlStart="owlStart",e.OwlEnd="owlEnd",e.OwlHostTimeOrigin="owlHostTimeOrigin",e.OwlFrameTimeOrigin="owlFrameTimeOrigin",e.OwlOnBootComplete="owlOnBootComplete",e.OwlCreateFrameStart="owlCreateFrameStart",e.OwlCreateFrameEnd="owlCreateFrameEnd",e.OwlTokenFetchingExperimentMessageSend="owlTokenFetchingExperimentMessageSend",e.OwlTokenFetchingExperimentMessageReceived="owlTokenFetchingExperimentMessageReceived",e.OwlDynamicallyLoadSharedAuthStart="owlDynamicallyLoadSharedAuthStart",e.OwlDynamicallyLoadSharedAuthEnd="owlDynamicallyLoadSharedAuthEnd",e.OwlSharedAuthInitStart="owlSharedAuthInitStart",e.OwlSharedAuthInitEnd="owlSharedAuthInitEnd",e.OwlGetDriveItemWithSharedAuthStart="owlGetDriveItemWithSharedAuthStart",e.OwlGetDriveItemWithSharedAuthEnd="owlGetDriveItemWithSharedAuthEnd",e.OwlTryGetWacTokenStart="owlTryGetWacTokenStart",e.OwlTryGetWacTokenEnd="owlTryGetWacTokenEnd",e.OwlGetDriveItemStart="owlGetDriveItemStart",e.OwlGetDriveItemEnd="owlGetDriveItemEnd"}(S||(S={}));var I=null===(H=document.getElementById("owl"))||void 0===H?void 0:H.dataset,A="e03a13ee-9730-4cae-8525-47559c8cf18a",C="243c63a3-247d-41c5-9d83-7788c43f1c43",U="9188040d-6c67-4c5b-b112-36a304b66dad";function R(e){var n,t;return{appIds:[C],authority:null!==(n=h||(null==I?void 0:I.authority))&&void 0!==n?n:"",authorityType:e.tenantId===U?"msa":"aad",upn:(null!==(t=e.loginHint)&&void 0!==t?t:"string"==typeof e.customAuthConfigValue)?JSON.parse(e.customAuthConfigValue).login_Hint:""}}function y(e,n){var t=null!=n?n:{};return e.isSuccess&&e.response.Token?(t.Authorization="Bearer ".concat(e.response.Token).trim(),t):t}var N=a(8577),T="WacDataCenter";function E(e){switch(e){case N.T.Word:case N.T.PowerPoint:case N.T.Excel:case N.T.OneNote:case N.T.Visio:return"".concat(e.toString()).concat(T);default:return}}function F(e){var n,t=E(e),i=t?null===localStorage||void 0===localStorage?void 0:localStorage.getItem(t):void 0;return null!==(n=null!=i?i:null===localStorage||void 0===localStorage?void 0:localStorage.getItem(T))&&void 0!==n?n:void 0}function D(e,n){if(n){null===localStorage||void 0===localStorage||localStorage.setItem(T,n);var t=E(e);t&&(null===localStorage||void 0===localStorage||localStorage.setItem(t,n))}}var k,P,O,x=a(9508),K=a(9595);function W(e,n){var i=this;return null==ji||ji.registerHandler(k.GetAuthToken,(function(n){return(0,t.mG)(i,void 0,void 0,(function(){var i,o,r,a,u,s;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,3,4]),r=n.data,a=r.resourceUrl,u=r.claims,[4,e.getAuthToken(a,u)];case 1:return i=t.sent(),[3,4];case 2:return s=t.sent(),o=s,[3,4];case 3:return null==ji||ji.sendMessage({id:P.GetAuthTokenResponse,data:{token:i,error:o,correlationId:n.correlationId}}),[7];case 4:return[2]}}))}))})),G(e.eventHandlers,n,e.sessionConfig.wiseEnvironment,e.uiHostConfig,e.sessionConfig.logger)}function M(e){var n=this,i=G(e,e.documentBootInfo,e.sessionConfig.wiseEnvironment,e.uiHostConfig,e.sessionConfig.logger);return null==ji||ji.registerHandler(k.FetchItemFromNetwork,(function(i){return(0,t.mG)(n,void 0,void 0,(function(){var n,o,r,a,u,s,c;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,3,4]),r=i.data,a=r.docBootInfo,u=r.forceRefresh,s=r.zeroByte,[4,e.fetchItemFromNetwork(a,u,s)];case 1:return n=t.sent(),[3,4];case 2:return c=t.sent(),o=c,[3,4];case 3:return null==ji||ji.sendMessage({id:P.FetchItemFromNetworkResponse,data:{correlationId:i.correlationId,item:n,error:o}}),[7];case 4:return[2]}}))}))})),null==ji||ji.registerHandler(k.FetchAccessToken,(function(i){return(0,t.mG)(n,void 0,void 0,(function(){var n,o,r,a,u,s,c,l,d;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return n=i.data,o=n.tokenConsumer,r=n.forceFetch,a=n.resourceUrl,u=n.scope,s=n.isBoot,c=n.claims,l=n.silent,[4,e.fetchAccessToken(o,r,a,u,s,c,l)];case 1:return d=t.sent(),null==ji||ji.sendMessage({id:P.FetchAccessTokenResponse,data:{correlationId:i.correlationId,response:d}}),[2]}}))}))})),null==ji||ji.registerHandler(k.OpenShareControl,(function(i){return(0,t.mG)(n,void 0,void 0,(function(){var n,o,r;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return n=i.data,o=n.shareProps,r=n.isShareDialogueZoomEnabled,[4,e.openShareControl(o,r)];case 1:return t.sent(),null==ji||ji.sendMessage({id:P.OpenShareControlResponse,data:{correlationId:i.correlationId}}),[2]}}))}))})),null==ji||ji.registerHandler(k.CreateDocument,(function(i){return(0,t.mG)(n,void 0,void 0,(function(){var n,o,r,a,u;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return n=i.data,o=n.createNewInfo,r=n.template,[4,null===(u=e.createDocument)||void 0===u?void 0:u.call(e,o,r)];case 1:return(a=t.sent())?null==ji||ji.sendMessage({id:P.CreateDocumentResponse,data:{correlationId:i.correlationId,url:a}}):null==ji||ji.sendMessage({id:P.CreateDocumentResponse,data:{correlationId:i.correlationId,error:"Failed to create document"}}),[2]}}))}))})),null==ji||ji.registerHandler(k.UserActivity,(function(n){var t;return null===(t=e.onUserActivity)||void 0===t?void 0:t.call(e)})),null==ji||ji.registerHandler(k.CAAEMessage,(function(n){var t;return null===(t=e.onCAAEMessage)||void 0===t?void 0:t.call(e,n.data)})),null==ji||ji.registerHandler(k.UserAccess,(function(n){var t;return null===(t=e.onUserAccess)||void 0===t?void 0:t.call(e,n.data)})),null==ji||ji.registerHandler(k.MoveToFolder,(function(n){var t;return null===(t=e.onMoveToFolder)||void 0===t?void 0:t.call(e,n.data)})),null==ji||ji.registerHandler(k.SharedFilePicker,(function(n){var t;return null===(t=e.onSharedFilePicker)||void 0===t?void 0:t.call(e,n.data)})),null==ji||ji.registerHandler(k.Rename,(function(n){var t;return null===(t=e.onRename)||void 0===t?void 0:t.call(e,n.data.newName)})),null==ji||ji.registerHandler(k.FrameChange,(function(n){var t;return null===(t=e.onFrameChange)||void 0===t?void 0:t.call(e,n.data)})),null==ji||ji.registerHandler(k.InvokeSessionRefreshInfoPopupBlockedDialog,(function(n){var t;null===(t=e.invokeSessionRefreshInfoPopupBlockedDialog)||void 0===t||t.call(e,{visible:n.data.visible,handleRefresh:function(){return null==Gi?void 0:Gi.sendMessage({id:P.SessionRefreshInfoDialogHandleRefresh,data:{}})},handleCancel:function(){return null==Gi?void 0:Gi.sendMessage({id:P.SessionRefreshInfoDialogHandleCancel,data:{}})},onDismiss:function(){return null==Gi?void 0:Gi.sendMessage({id:P.SessionRefreshInfoDialogOnDismiss,data:{}})}})})),null==ji||ji.registerHandler(k.FileEmbed,(function(n){var t;return null===(t=e.onFileEmbed)||void 0===t?void 0:t.call(e)})),i}function j(e,n,i,o,a,u){var c=this;null==Gi||Gi.registerHandler(P.EndSession,(function(n){return(0,t.mG)(c,void 0,void 0,(function(){var i,o,r;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,3,4]),[4,e()];case 1:return i=t.sent(),[3,4];case 2:return r=t.sent(),o=r,[3,4];case 3:return null==Gi||Gi.sendMessage({id:k.EndSessionResponse,data:{result:i,error:o,correlationId:n.correlationId}}),[7];case 4:return[2]}}))}))})),null==Gi||Gi.registerHandler(P.HostAccessibilityLoopComplete,(function(e){return n(e.data.navigateForward)})),null==Gi||Gi.registerHandler(P.GetClientUrl,(function(e){return i()})),null==Gi||Gi.registerHandler(P.GetWebUrl,(function(e){return o()})),null==Gi||Gi.registerHandler(P.GetAuthTokenResponse,_i.getHandler(P.GetAuthTokenResponse,O.Token)),null==Gi||Gi.registerHandler(P.FetchItemFromNetworkResponse,_i.getHandler(P.FetchItemFromNetworkResponse,O.Item)),null==Gi||Gi.registerHandler(P.FetchAccessTokenResponse,_i.getHandler(P.FetchAccessTokenResponse,O.Response)),null==Gi||Gi.registerHandler(P.OpenShareControlResponse,_i.getHandler(P.OpenShareControlResponse)),null==Gi||Gi.registerHandler(P.CreateDocumentResponse,_i.getHandler(P.CreateDocumentResponse,O.URL)),null==Gi||Gi.registerHandler(P.TelemetryData,(function(e){var n=e.data,i=n.context,o=n.hostData,c=n.frameData,l=function(e,n){var i,o=e[S.OwlStart]||e[S.OwlWithCustomFunctionsStart],r=(e[S.OwlBootAppMessageSend]||e[S.OwlBootAppWithCustomFunctionsMessageSend])-o,a=n[S.OwlBootAppMessageReceive]||n[S.OwlBootAppWithCustomFunctionsMessageReceive],u=n[S.OwlOnBootComplete];return{hostTime:r,frameTime:u-a,totalTime:u-o,owlPerformanceTimeline:(0,t.pi)((0,t.pi)((0,t.pi)({},e),n),((i={})[S.OwlStart]=o,i[S.OwlEnd]=u,i))}}(JSON.parse(o.owlTelemetryData),JSON.parse(c.owlTelemetryData));a&&a(l.owlPerformanceTimeline),null==u||u.ULS.sendTraceTag(508614159,r.W.Lt,s.G.Important,i+", OwlFrame Telemetry Data: "+JSON.stringify(l)),null==u||u.ULS.sendTraceTag(508614158,r.W.Lt,s.G.Important,i+", Boot Telemetry Data: "+JSON.stringify({hostBoot:o.bootTelemetryData,frameBoot:c.bootTelemetryData}))}))}function G(e,n,t,i,o){var r=e.onBootComplete,a=e.onBootFailure,u=e.onSuccessNotification,s=e.onReturnFocus,c=e.onDocumentClose,l=e.onOpenInMobileApp,d=new K.xQ;return null==ji||ji.registerHandler(k.EndSessionObservable,(function(e){d.next(e.data.rebootInfo),d.complete()})),null==ji||ji.registerHandler(k.BootComplete,(function(e){var n=e.data,t=n.docInfo,i=n.wacBootDiagnostics;null==r||r(t,i)})),null==ji||ji.registerHandler(k.BootFailure,(function(e){return null==a?void 0:a(e.data.errorInfo,e.data.docInfo)})),null==ji||ji.registerHandler(k.ReturnFocus,(function(e){return null==s?void 0:s(e.data.navigateForward)})),null==ji||ji.registerHandler(k.SuccessNotification,(function(e){return null==u?void 0:u()})),null==ji||ji.registerHandler(k.DocumentClose,(function(e){return null==c?void 0:c()})),null==ji||ji.registerHandler(k.OpenInMobileApp,(function(e){var n;return null==l?void 0:l(e.data.openInAppUrl,null!==(n=e.data.storeUrl)&&void 0!==n?n:"")})),null==ji||ji.registerHandler(k.EndSessionResponse,(function(e){Li.getHandler(k.EndSessionResponse,O.Result)(e),zi()})),null==ji||ji.registerHandler(k.TelemetryData,(function(e){!function(e,n,t,i,o){var r=g(),a=r.bootTelemetryData,u=r.owlTelemetryData;null==ji||ji.sendMessage({id:P.TelemetryData,data:{context:m(n,t,null==i?void 0:i.featureGates,null==i?void 0:i.uiHostName,null==i?void 0:i.uiHostIntegrationType,o),hostData:{bootTelemetryData:a,owlTelemetryData:u},frameData:e}})}(e.data,n.fileType,t,i,o)})),d.asObservable()}!function(e){e.FrameLoaded="Frame_FrameLoaded",e.GetAuthToken="Frame_GetAuthToken",e.BootComplete="Frame_BootComplete",e.SuccessNotification="Frame_OnSuccessNotification",e.BootFailure="Frame_BootFailure",e.ReturnFocus="Frame_ReturnFocus",e.DocumentClose="Frame_DocumentClose",e.OpenInMobileApp="Frame_OpenInMobileApp",e.FetchItemFromNetwork="Frame_FetchItemFromNetwork",e.FetchAccessToken="Frame_FetchAccessToken",e.OpenShareControl="Frame_OpenShareControl",e.CreateDocument="Frame_CreateDocument",e.SetTitle="Frame_SetTitle",e.UserActivity="Frame_UserActivity",e.CAAEMessage="Frame_CAAEMessage",e.UserAccess="Frame_UserAccess",e.MoveToFolder="Frame_MoveToFolder",e.SharedFilePicker="Frame_SharedFilePicker",e.Rename="Frame_Rename",e.FrameChange="Frame_FrameChange",e.InvokeSessionRefreshInfoPopupBlockedDialog="Frame_InvokeSessionRefreshInfoPopupBlockedDialog",e.FileEmbed="Frame_FileEmbed",e.EndSessionResponse="Frame_EndSessionResponse",e.EndSessionObservable="Frame_EndSessionObservable",e.TelemetryData="Frame_TelemetryData"}(k||(k={})),function(e){e.BootApplication="Host_BootApplication",e.BootApplicationWithCustomFunctions="Host_BootApplicationWithCustomFunctions",e.GetAuthTokenResponse="Host_GetAuthTokenResponse",e.EndSession="Host_EndSession",e.HostAccessibilityLoopComplete="Host_AccessibilityLoopComplete",e.GetClientUrl="Host_GetClientUrl",e.GetWebUrl="Host_GetWebUrl",e.FetchItemFromNetworkResponse="Host_FetchItemFromNetworkResponse",e.FetchAccessTokenResponse="Host_FetchAccessTokenResponse",e.OpenShareControlResponse="Host_OpenShareControlResponse",e.CreateDocumentResponse="Host_CreateDocumentResponse",e.SessionRefreshInfoDialogHandleRefresh="Host_SessionRefreshInfoDialogHandleRefresh",e.SessionRefreshInfoDialogHandleCancel="Host_SessionRefreshInfoDialogHandleCancel",e.SessionRefreshInfoDialogOnDismiss="Host_SessionRefreshInfoDialogOnDismiss",e.SharingLinkTokenProvider="Host_SharingLinkTokenProvider",e.TelemetryData="Host_TelemetryData",e.TokenFetchingExperiment="Host_TokenFetchingExperiment"}(P||(P={})),function(e){e.Item="item",e.Response="response",e.Result="result",e.Token="token",e.URL="url"}(O||(O={}));var _=function(){function e(e){var n=this;this.Sa=!1,this.Ha="",this.wa=[],this.ba=function(e){n.Sa||(n.Sa=!0,n.Ha=e?"timeout":"cancelled",n.wa.map((function(e){return e()})),n.wa=[])},this.ga=e,window.setTimeout((function(){return n.ba(!0)}),e)}return Object.defineProperty(e.prototype,"isCancelled",{get:function(){return this.Sa},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timeoutInMs",{get:function(){return this.ga},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this.Ha},enumerable:!1,configurable:!0}),e.prototype.cancel=function(){this.ba(!1)},e.prototype.subscribe=function(e){this.Sa?e():this.wa.push(e)},e}(),L=a(9628),B=a(3785),J=function(e){function n(n){var t=e.call(this)||this;return t.Ia=n,t}return L.ZT(n,e),Object.defineProperty(n.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),n.prototype.F=function(n){var t=e.prototype.F.call(this,n);return t&&!t.closed&&n.next(this.Ia),t},n.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new B.N;return this.Ia},n.prototype.next=function(n){e.prototype.next.call(this,this.Ia=n)},n}(K.xQ),V=a(4988),q=a(6357),z=a(4965),Z=a(7280);function Q(e,n){return function(t){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return t.lift(new X(e,n))}}var X=function(){function e(e,n){this.project=e,this.thisArg=n}return e.prototype.call=function(e,n){return n.subscribe(new Y(e,this.project,this.thisArg))},e}(),Y=function(e){function n(n,t,i){var o=e.call(this,n)||this;return o.project=t,o.count=0,o.thisArg=i||o,o}return L.ZT(n,e),n.prototype.O=function(e){var n;try{n=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(n)},n}(Z.L);function $(e,n,t,i){return(0,z.m)(t)&&(i=t,t=void 0),i?$(e,n,t).pipe(Q((function(e){return(0,q.k)(e)?i.apply(void 0,e):i(e)}))):new V.y((function(i){ee(e,n,(function(e){arguments.length>1?i.next(Array.prototype.slice.call(arguments)):i.next(e)}),i,t)}))}function ee(e,n,t,i,o){var r;if(function(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}(e)){var a=e;e.addEventListener(n,t,o),r=function(){return a.removeEventListener(n,t,o)}}else if(function(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}(e)){var u=e;e.on(n,t),r=function(){return u.off(n,t)}}else if(function(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}(e)){var s=e;e.addListener(n,t),r=function(){return s.removeListener(n,t)}}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(var c=0,l=e.length;c<l;c++)ee(e[c],n,t,i,o)}i.add(r)}var ne=a(4419);function te(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var ie=te(),oe=a(7120);var re=a(895),ae=function(e){if(e&&"function"==typeof e[oe.L])return r=e,function(e){var n=r[oe.L]();if("function"!=typeof n.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return n.subscribe(e)};if((n=e)&&"number"==typeof n.length&&"function"!=typeof n)return o=e,function(e){for(var n=0,t=o.length;n<t&&!e.closed;n++)e.next(o[n]);e.complete()};var n;if(function(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}(e))return i=e,function(e){return i.then((function(n){e.closed||(e.next(n),e.complete())}),(function(n){return e.error(n)})).then(null,ne.z),e};if(e&&"function"==typeof e[ie])return t=e,function(e){for(var n=t[ie]();;){var i=void 0;try{i=n.next()}catch(n){return e.error(n),e}if(i.done){e.complete();break}if(e.next(i.value),e.closed)break}return"function"==typeof n.return&&e.add((function(){n.return&&n.return()})),e};var t,i,o,r,a=(0,re.K)(e)?"an invalid object":"'"+e+"'";throw new TypeError("You provided "+a+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")},ue=a(6479),se=function(e){function n(n){var t=e.call(this)||this;return t.parent=n,t}return L.ZT(n,e),n.prototype.O=function(e){this.parent.notifyNext(e)},n.prototype._=function(e){this.parent.notifyError(e),this.unsubscribe()},n.prototype.B=function(){this.parent.notifyComplete(),this.unsubscribe()},n}(Z.L),ce=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return L.ZT(n,e),n.prototype.notifyNext=function(e){this.destination.next(e)},n.prototype.notifyError=function(e){this.destination.error(e)},n.prototype.notifyComplete=function(){this.destination.complete()},n}(Z.L);function le(e,n,t){return void 0===t&&(t=Number.POSITIVE_INFINITY),"function"==typeof n?function(i){return i.pipe(le((function(t,i){return(o=e(t,i),o instanceof V.y?o:new V.y(ae(o))).pipe(Q((function(e,o){return n(t,e,i,o)})));var o}),t))}:("number"==typeof n&&(t=n),function(n){return n.lift(new de(e,t))})}var de=function(){function e(e,n){void 0===n&&(n=Number.POSITIVE_INFINITY),this.project=e,this.concurrent=n}return e.prototype.call=function(e,n){return n.subscribe(new fe(e,this.project,this.concurrent))},e}(),fe=function(e){function n(n,t,i){void 0===i&&(i=Number.POSITIVE_INFINITY);var o=e.call(this,n)||this;return o.project=t,o.concurrent=i,o.hasCompleted=!1,o.buffer=[],o.active=0,o.index=0,o}return L.ZT(n,e),n.prototype.O=function(e){this.active<this.concurrent?this.Aa(e):this.buffer.push(e)},n.prototype.Aa=function(e){var n,t=this.index++;try{n=this.project(e,t)}catch(e){return void this.destination.error(e)}this.active++,this.Ca(n)},n.prototype.Ca=function(e){var n=new se(this),t=this.destination;t.add(n);var i=function(e,n){if(!n.closed){if(e instanceof V.y)return e.subscribe(n);var t;try{t=ae(e)(n)}catch(e){n.error(e)}return t}}(e,n);i!==n&&t.add(i)},n.prototype.B=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},n.prototype.notifyNext=function(e){this.destination.next(e)},n.prototype.notifyComplete=function(){var e=this.buffer;this.active--,e.length>0?this.O(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},n}(ce),ve=function(){function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e}(),he=function(){function e(e){if(this.total=e,this.total<0)throw new ve}return e.prototype.call=function(e,n){return n.subscribe(new pe(e,this.total))},e}(),pe=function(e){function n(n,t){var i=e.call(this,n)||this;return i.total=t,i.count=0,i}return L.ZT(n,e),n.prototype.O=function(e){var n=this.total,t=++this.count;t<=n&&(this.destination.next(e),t===n&&(this.destination.complete(),this.unsubscribe()))},n}(Z.L);function me(e,n){return function(t){return t.lift(new Se(e,n))}}var Se=function(){function e(e,n){this.predicate=e,this.thisArg=n}return e.prototype.call=function(e,n){return n.subscribe(new He(e,this.predicate,this.thisArg))},e}(),He=function(e){function n(n,t,i){var o=e.call(this,n)||this;return o.predicate=t,o.thisArg=i,o.count=0,o}return L.ZT(n,e),n.prototype.O=function(e){var n;try{n=this.predicate.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}n&&this.destination.next(e)},n}(Z.L),we=a(5e3),be=a(6324),ge=a(8024),Ie=function(){var e=void 0;try{e=window.localStorage}catch(e){}return e}(),Ae="officecom";function Ce(){return JSON.stringify({pmo:window.location.origin,pmshare:!0,surl:void 0,curl:void 0,vurl:void 0,eurl:void 0})}function Ue(e){switch((0,ge.aE)(e)){case ge.o4.OneDrive:return"OneDrive";case ge.o4.SharePoint:return"SharePoint Online";default:return"Unknown"}}function Re(e,n,i,o,a,u,c){void 0===o&&(o={startTime:0,endTime:0}),void 0===a&&(a={startTime:0,endTime:0});var l=window.performance.timing,f=window.performance.navigation,v=f.redirectCount||0,h=l.navigationStart||0,p=l.fetchStart||0,m=l.responseEnd||0,S=l.requestStart||0,H=l.responseStart||0,w=l.responseEnd||0,b=l.domComplete||0,g=a.startTime||0,I=a.endTime||0,A=Date.now();(0,we.p)()&&window.performance.mark("officeInitializationTime");var C,U,R=null==u?void 0:u.logger,y=(null==u?void 0:u.bootDiagnostics)||{},N=y.tabsCacheHit,T=y.packageEntryTime,E=y.isTestMode,F=y.ringId,D="UNKNOWN";switch(f.type){case 0:D="NAVIGATE";break;case 1:D="RELOAD";break;case 2:D="BACK_FORWARD";break;case 255:D="RESERVED"}e&&(C=A-e),T&&(U=A-T);var k=(0,t.pi)((0,t.pi)((0,t.pi)({},y),be.c),{bootStrapStartTime:(null==a?void 0:a.startTime)||0,bootStrapEndTime:(null==a?void 0:a.endTime)||0,wopiDataStartTime:(null==o?void 0:o.startTime)||0,wopiDataEndTime:(null==o?void 0:o.endTime)||0,isCookieBlocked:!Ie,createNewEndTime:y.createNewStartTime?Date.now():void 0,owlFeatureGates:c?(0,d.d)(c):void 0});return be.c.accessTokenStartTime=void 0,be.c.accessTokenEndTime=void 0,be.c.fetchWacAndSpoTokenStartTime=void 0,be.c.fetchWacAndSpoTokenEndTime=void 0,be.c.driveItemStartTime=void 0,be.c.driveItemEndTime=void 0,be.c.driveItemFromWacStartTime=void 0,be.c.driveItemFromWacEndTime=void 0,be.c.spRequestGuid=void 0,be.c.createNewStartTime=void 0,be.c.createNewEndTime=void 0,be.c.loadManifestStartTime=void 0,be.c.loadManifestEndTime=void 0,be.c.loadOwlStartTime=void 0,be.c.loadOwlEndTime=void 0,be.c.isVroom21=!1,null==R||R.ULS.sendTraceTag(556613895,r.W.Lt,s.G.Info,"getDiagnostics: [SessionOrigin: ".concat(i,"][TabsCacheHit: ").concat(N,"][IsTestMode: ").concat(E,"][RingId: ").concat(F,"][TimeElapsedSinceUserClick:").concat(C,"][TimeElapsedSincePackageEntry: ").concat(U,"]")),{entryPoint:i,userClickTime:e,hostPageNavigationStartTime:h,hostPageFetchStartTime:p,hostPageFetchEndTime:m,hostPageFirstFlushTime:n,hostPageRequestStartTime:S,hostPageResponseStartTime:H,hostPageResponseEndTime:w,hostPageDomCompleteTime:b,hostPageRedirectCount:v,officeBootstrapperStartTime:g,officeBootstrapperEndTime:I,officeInitializationTime:A,unifiedUiHostDiagnostics:k,hostPageNavigationType:D}}var ye=function(e){var n=new URL(e);return n.searchParams.delete("wopisrc"),n.href};function Ne(e){return function(n){var t=n;switch(n){case"OfficeComWordJsApiV2":case"OfficeComExcelJsApiV2":case"OfficeComPptJsApiV2":return!0;case"OfficeUnifiedUiHostTeams":t="unifiedUiHostInTeams"}if((null==e?void 0:e.experiments)&&t in(null==e?void 0:e.experiments))return function(e){switch(e){case 0:return!1;case 1:return!0;default:return}}(null==e?void 0:e.experiments[t])}}function Te(e,n,t){switch(e){case N.T.Word:case N.T.PowerPoint:case N.T.Excel:return!0;case N.T.Visio:var i=(0,l.vJ)(l.Fh.FeatureGate_VisioJsApiV2Gate,n);return(0,l.dt)(l.Fh.FeatureGate_VisioJsApiV2Gate,i,t),i;default:return!1}}function Ee(e,n,t,i,o){var r,a,u=e?(null===(r=e.wac)||void 0===r?void 0:r.applicationUrl)||(null===(a=e.wac)||void 0===a?void 0:a.editUrl):ye(n);return u?function(e,n,t,i,o,r){var a="".concat(e,"&uih=").concat(n);return(null==r||r)&&(a="".concat(a,"&uiEmbed=1")),i&&(a="".concat(a,"&wdTpl=").concat(i)),o&&(a="".concat(a,"&wdlcid=").concat(o)),t&&(a="".concat(a,"&actNavId=").concat(t)),a}(u,t,i.navId,i.templateId,i.rebootOverrideData?i.rebootOverrideData.lcid:i.uiCulture,o):""}function Fe(e){var n;return e?((n={}).wd=encodeURIComponent(e),n):{}}var De=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.value=null,n.hasNext=!1,n.hasCompleted=!1,n}return L.ZT(n,e),n.prototype.F=function(n){return this.hasError?(n.error(this.thrownError),ue.w.EMPTY):this.hasCompleted&&this.hasNext?(n.next(this.value),n.complete(),ue.w.EMPTY):e.prototype.F.call(this,n)},n.prototype.next=function(e){this.hasCompleted||(this.value=e,this.hasNext=!0)},n.prototype.error=function(n){this.hasCompleted||e.prototype.error.call(this,n)},n.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&e.prototype.next.call(this,this.value),e.prototype.complete.call(this)},n}(K.xQ);function ke(e){return!(!e||!e.failure)&&"TypeError: Failed to fetch"===e.failure}function Pe(e,n){if(n)return!0;if(!e)return!1;switch(e){case 401:case 403:case 404:case 429:return!0;default:return!1}}function Oe(e,n){if(n)return be.I$.Offline;switch(e){case 401:case 403:return be.I$.PermissionError;case 404:return be.I$.NotFound;case 429:return be.I$.Throttling;default:return be.I$.Other}}var xe,Ke=a(6481);function We(e){var n=function(e){var n=e.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i);return n&&n[1]?n[1]:"public"}(e);return{region:n,dataBoundary:(0,Ke.g)(n)}}function Me(e){return new Map([["ErrorName","".concat(e.wacErrorName)+(e.errorName?"_".concat(e.errorName):"")],["ErrorMessage",e.errorMessage?e.errorMessage:""],["ErrorStack",e.errorStack?e.errorStack:""],["HttpErrorCode","".concat(e.httpErrorCode)],["NetworkError","".concat(e.networkError)]])}var je,Ge,_e=a(2424),Le=a(7710),Be=function(e){return je?"".concat(e,".").concat(je.size):e},Je=a(3737);!function(e){e.Unavailable="Service Unavailable",e.UnableToConnect="Unable to connect to service",e.NoData="No data retrieved",e.ManyRequest="Too many requests",e.FailToFetchToken="Failed to fetch access token",e.UrlIsNull="Url is null",e.ItemIdOrDriveIdIsNull="ItemId or DriveId is null"}(Ge||(Ge={}));var Ve=a(2106);function qe(e){var n={Id:"",Details:""},t=Ve.W.InternalServiceError,i=Ve.W.ServiceUnavailable,o=Ve.W.Unknown,r=e.status,a=e.errorCode,u=e.message;switch(r){case Ve.W.OK:n="MissingProperty"===a?{Id:t.toString(),Details:Ge.NoData}:"ParsingResponseFailed"===a?{Id:t.toString(),Details:u.toString()}:{Id:null!=a?a:t.toString(),Details:u.toString()};break;case Ve.W.Unknown:n={Id:o.toString(),Details:Ge.UnableToConnect};break;case Ve.W.ServiceUnavailable:n={Id:i.toString(),Details:Ge.Unavailable};break;default:n={Id:r.toString(),Details:u.toString()}}return n}var ze,Ze=a(8076);!function(e){e[e.GetWopiInfoFromUrl=0]="GetWopiInfoFromUrl",e[e.GetDavUrlFromIds=1]="GetDavUrlFromIds"}(ze||(ze={}));var Qe=[],Xe=!1;function Ye(e){switch(e){case ze.GetWopiInfoFromUrl:return Je.KX.PostMessage_SetHostWopiInfoFromUrl;case ze.GetDavUrlFromIds:return Je.KX.PostMessage_SetDavUrlFromIds}}function $e(e){switch(e){case ze.GetWopiInfoFromUrl:return be.yv.ii;case ze.GetDavUrlFromIds:return be.yv.ei}}function en(e){switch(e){case ze.GetWopiInfoFromUrl:return be.DG.QosError_WopiInfoFromUrlFailure;case ze.GetDavUrlFromIds:return be.DG.QosError_DavUrlFromIdsFailure}}function nn(e,n,t,i,o,r,a){var u,s,c,l,d,f=$e(e),v=en(e),h=Ye(e),p={Url:n.Url,ItemId:n.ItemId,DriveId:n.DriveId,Error:t};try{d=JSON.parse(t.Details)}catch(e){d=void 0}null==a||a.recordKpiFailure(f),null==a||a.recordQosError(v,[be.cS.QosVeto_ExternalLinksExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorName",null!==(s=null===(u=null==d?void 0:d.error)||void 0===u?void 0:u.code)&&void 0!==s?s:t.Id],["ErrorMessage",null!==(l=null===(c=null==d?void 0:d.error)||void 0===c?void 0:c.message)&&void 0!==l?l:t.Details],["HttpErrorCode",t.Id]])}),(0,Ze.R)(h,p,o,i,r)}function tn(e,n,t,i,o,a){var u;Xe=!0;var c=Qe.shift();if(c){var l={docUrl:(0,ge.Th)(null!==(u=c.eventArgs.Url)&&void 0!==u?u:"",e.docUrl),docId:c.eventArgs.ItemId,driveId:c.eventArgs.DriveId,fileType:e.fileType,wdOrigin:e.wdOrigin,wdValue:e.wdValue,uiCulture:e.uiCulture,dataCulture:e.dataCulture,puid:e.puid,clickTime:e.clickTime};(0,_e.o)(l,n).then((function(e){!function(e,n,t,i,o,a,u){var c=$e(e),l=en(e),d=Ye(e);t.fetchedDocumentIdentifier.then((function(r){var s,l,f,v,h,p,m,S,H,w={DriveId:null!==(s=n.DriveId)&&void 0!==s?s:r.driveId,ItemId:null!==(l=n.ItemId)&&void 0!==l?l:r.docId,Url:e===ze.GetWopiInfoFromUrl?n.Url:null===(f=t.wopiHostData)||void 0===f?void 0:f.webDavUrl,WopiSrc:null===(h=null===(v=t.wopiHostData)||void 0===v?void 0:v.wac)||void 0===h?void 0:h.wopiSrc,AccessToken:null===(m=null===(p=t.wopiHostData)||void 0===p?void 0:p.wac)||void 0===m?void 0:m.accessToken,AccessTokenExpiry:null===(H=null===(S=t.wopiHostData)||void 0===S?void 0:S.wac)||void 0===H?void 0:H.accessTokenExpiry};null==u||u.recordKpiSuccess(c),(0,Ze.R)(d,w,o,i,a)})).catch((function(e){var n;null==u||u.recordKpiFailure(c),null==u||u.recordQosError(l,[be.cS.QosVeto_ExternalLinksExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorName","Failed to fetch document identifier"],["ErrorMessage",e instanceof Error?"".concat(e.name,": ").concat(e.message):"string"==typeof e?e:JSON.stringify(e)],["HttpErrorCode",null!==(n=e.errorCode)&&void 0!==n?n:"0"]])}),null==a||a.ULS.sendTraceTag(512337542,r.W.Lt,s.G.Warning,"Failed to fetch document identifier with error: ".concat(e))}))}(c.eventType,c.eventArgs,e,t,i,o,a)})).catch((function(e){var n={status:(null==e?void 0:e.status)||0,errorCode:(null==e?void 0:e.errorCode)||"",message:(null==e?void 0:e.message)||""};nn(c.eventType,c.eventArgs,qe(n),t,i,o,a)})).finally((function(){Xe=!1,Qe.length>0&&tn(e,n,t)}))}}function on(e,n,i,o,r,a,u,s){return(0,t.mG)(this,void 0,void 0,(function(){var c,l,d,f,v,h;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:null==s||s.addQosPillar("ContentConsumption"),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,i()];case 2:return c=t.sent(),[3,4];case 3:return l=t.sent(),d={Id:"Failed to get current document info",Details:l instanceof Error?"".concat(l.name,": ").concat(l.message):"string"==typeof l?l:JSON.stringify(l)},[2,nn(e,n,d,a,r,u,s)];case 4:return e===ze.GetWopiInfoFromUrl?n.Url||(f={Id:"Url is null",Details:Ge.UrlIsNull.toString()}):e===ze.GetDavUrlFromIds&&(n.ItemId&&n.DriveId||(f={Id:"ItemId or DriveId is null",Details:Ge.ItemIdOrDriveIdIsNull.toString()})),f?[2,nn(e,n,f,a,r,u,s)]:Qe.length>=100?(v=Ve.W.Throttled,f={Id:v.toString(),Details:Ge.ManyRequest.toString()},[2,nn(e,n,f,a,r,u,s)]):(h={eventType:e,eventArgs:n},Qe.push(h),Xe||tn(c,o,a,r,u,s),[2])}}))}))}var rn,an,un=700,sn=525,cn=2;function ln(e,n,t){var i,o,r=qe({status:n,errorCode:null!==(i=t.errorCode)&&void 0!==i?i:"",message:null!==(o=t.message)&&void 0!==o?o:""});return e.map((function(e){return{Name:e,Errors:[{Id:r.Id.toString(),Details:r.Details}],SPCorrelationId:t.SPRequestGuid}}))}function dn(e){var n;n=e?"MobileViewer.Label.LinkCopied":"MobileViewer.Label.ErrorCopyingLink";var t=document.createElement("div");t.style.visibility="visible",t.style.position="fixed",t.style.bottom="5px",t.style.backgroundColor="#000000",t.style.color="#fff",t.style.padding="16px",t.style.borderRadius="4px",t.style.height="16px",t.style.left="6px",t.style.right="6px",t.style.fontSize="14px",t.style.fontFamily="-apple-system, Roboto",t.style.display="flex",t.style.alignItems="center",t.textContent=n,document.body.appendChild(t),setTimeout((function(){t.style.visibility="hidden"}),3e3)}!function(e){e[e.Unattempted=0]="Unattempted",e[e.InProgress=1]="InProgress",e[e.NotHandled=2]="NotHandled",e[e.HandleExternally=4]="HandleExternally",e[e.Failed=8]="Failed",e[e.Error=16]="Error",e[e.Succeeded=32]="Succeeded",e[e.Delayed=64]="Delayed"}(rn||(rn={})),function(e){e.android="android",e.ios="ios",e.ipados="ipados"}(an||(an={}));var fn,vn="PushStateHandler";function hn(e){window.history.pushState(e.State,window.document.title,e.Url)}!function(e){e.AccessibilityLoopCompleted="AccessibilityLoopCompleted",e.ActionCompleted="ActionCompleted",e.BrowserEvent="BrowserEvent",e.CAAEMessage="CAAEMessage",e.Close="Close",e.Conversation="Conversation",e.CopyAndEdit="CopyAndEdit",e.CreateNewDocument="CreateNewDocument",e.Download="Download",e.Edit="Edit",e.Error="Error",e.FileEmbed="FileEmbed",e.FileProperties="FileProperties",e.FileRenamed="FileRenamed",e.FileVersions="FileVersions",e.FrameStateChanged="FrameStateChanged",e.FrameTrust="FrameTrust",e.GetAccessToken="GetAccessToken",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.GetWopiInfoFromUrl="GetWopiInfoFromUrl",e.GetDavUrlFromIds="GetDavUrlFromIds",e.ModeSwitched="ModeSwitched",e.MoveToFolder="MoveToFolder",e.OpenInMobileApp="OpenInMobileApp",e.OpenInBrowser="OpenInBrowser",e.OpenInClient="OpenInClient",e.PageChanged="PageChanged",e.PushState="PushState",e.Reboot="Reboot",e.RedeemForCommenting="RedeemForCommenting",e.RefreshSessionInfo="RefreshSessionInfo",e.ReplyWithChanges="ReplyWithChanges",e.ReportAbuse="ReportAbuse",e.SharedFilePicker="SharedFilePicker",e.SaveStatus="SaveStatus",e.Share="Share",e.ShareForm="ShareForm",e.SignIn="SignIn",e.UserAccessAndPermissions="UserAccessAndPermissions",e.UserActivity="UserActivity",e.UserEditActivity="UserEditActivity",e.Workflow="Workflow",e.ZoomChanged="ZoomChanged",e.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",e.LoadingStatus="LoadingStatus",e.SwitchNotebook="SwitchNotebook",e.FailedBootCheckFileInfo="FailedBootCheckFileInfo",e.GetTeamsUsers="GetTeamsUsers",e.SendTeamsUserMention="SendTeamsUserMention",e.NavigateBackToHost="NavigateBackToHost",e.GetClientUrlComplete="GetClientUrlComplete",e.GetWebUrlComplete="GetWebUrlComplete",e.CopyLinkComplete="CopyLinkComplete",e.SendConversationId="SendConversationId",e.CloseTeamsConversation="CloseTeamsConversation",e.PageLoaded="PageLoaded",e.FrameChanged="FrameChanged"}(fn||(fn={}));var pn="officeapps.live.com",mn=2e3,Sn=9e3,Hn=9500,wn=6e5;function bn(e){var n,i,u,d=Date.now(),f=e.documentBootInfo,v=e.fetchItemFromNetwork,h=e.fetchAccessToken,H=e.sessionConfig,w=e.container,g=e.setTitle,I=e.onBootComplete,A=e.onBootFailure,C=e.onReturnFocus,U=e.onDocumentClose,R=e.onSuccessNotification,y=e.uiHostConfig,T=e.createDocument,E=e.openShareControl,F=e.onOpenInMobileApp,D=e.sharingLinkTokenProvider,k=e.onUserActivity,P=e.onCAAEMessage,O=e.onUserAccess,x=e.onMoveToFolder,W=e.onSharedFilePicker,M=e.onRename,j=e.initPackageParams,G=e.onFrameChange,L=e.invokeSessionRefreshInfoPopupBlockedDialog,B=e.onFileEmbed,q=null==y?void 0:y.supportsExplicitUnload;H.logger||(H.logger=(0,o.L8)());var z=H.hostCorrelationId,Z=H.isMsa,X=H.tenantId,Y=H.shareApiEndpoint,ee=H.organizationName,ne=H.logger,te=H.hostClientType,ie=H.health,oe=Te(f.fileType,null==y?void 0:y.featureGates,ne);null==ne||ne.ULS.sendTraceTag(576578584,r.W.Lt,s.G.Info,"Lean Ui Host: bootApp");var re,ae=(0,l.vJ)(l.Fh.FeatureGate_CreateNewImprovementGate,null==y?void 0:y.featureGates),ue=new _(wn),se=[],ce=function(e){return new Promise((function(n){oe&&!ue&&n("No active session to close. Return from here.");var i=function(e){null==ne||ne.ULS.sendTraceTag(575411776,r.W.Lt,s.G.Info,"Dispose the WAC frame. And reboot: ".concat(e?"true":"false")),Ge.next(e),Ge.complete(),zi(),n("WAC frame disposed")},o=function(){f.fileType===N.T.Excel&&(Qe=[]),null==Oe||Oe.unsubscribe(),null==Ke||Ke.unsubscribe()};if(!ve)return null==ne||ne.ULS.sendTraceTag(529093076,r.W.Lt,s.G.Warning,"No active session exists, when endSession is called!! Bail out endSession"),void i(e);if(oe)null==ve||ve.removeEventListener(re),null==ue||ue.cancel(),null==ve||ve.dispose().catch((function(e){null==ne||ne.ULS.sendTraceTag(527257879,r.W.Lt,s.G.Error,"Error waiting for Unloaded event from WAC. Force to dispose session if app is not unloaded. appUnloaded: ".concat(ye,", Error: ").concat(e))})).finally((function(){o(),i(e)}));else if(se.forEach((function(e){var n=(0,t.CR)(e,2),i=n[0],o=n[1];ve.RemoveEventHandler(i,o)})),null==ve||ve.Dispose(q,function(e){if(e===N.T.OneNote)return Sn}(f.fileType)),o(),q){ve.RegisterEventHandler(Je.E_.Event_Unloaded,(function(){null==ne||ne.ULS.sendTraceTag(575411777,r.W.Lt,s.G.Info,"Receive Unloaded Event from WAC"),ye=!0,clearTimeout(a),i(e)}));var a=window.setTimeout((function(){null==ne||ne.ULS.sendTraceTag(575411778,r.W.Lt,s.G.Info,"Time out on waiting for Unloaded event from WAC. Force to dispose session if app is not unloaded. appUnloaded: ".concat(ye)),ye||i(e)}),f.fileType===N.T.OneNote?Hn:mn)}else null==ne||ne.ULS.sendTraceTag(575271647,r.W.Lt,s.G.Info,"No Explicit Unload. Tear down the WAC frame to end session."),i(e)}))},de=function(e,n,i){var o,u,c,d,p=Promise.resolve(null===(o=null==e?void 0:e.wac)||void 0===o?void 0:o.applicationUrl),m=function(){return n.asObservable().pipe((function(e){return e.lift(new he(1))})).toPromise()},S=(0,l.vJ)(l.Fh.FeatureGate_BlurAndGrabFocusForShareDialogGate,null==y?void 0:y.featureGates),b=null!==(u=null==y?void 0:y.sessionOriginPrefix)&&void 0!==u?u:"TEAMS.UNIFIEDUIHOST.",g=function(e){var n=this,i=e.getCurrentDocumentInfo,o=e.getWdOrigin,r=e.reboot;return function(e){return(0,t.mG)(n,void 0,void 0,(function(){var n,a,u,s,c,l;return(0,t.Jh)(this,(function(d){switch(d.label){case 0:return[4,i()];case 1:if(n=d.sent(),a=e.previousSessionId,u=e.mode,s={},e.queryOverrides&&"string"==typeof e.queryOverrides)try{s=JSON.parse(e.queryOverrides)}catch(e){s={}}else s=e.queryOverrides||{};return c=e.isNewSession,l={previousSessionId:a,mode:u,queryOverrides:s,isNewSession:c},"1"===e.rebootMode?r({docUrl:e.documentUrl,fileType:n.fileType,wdOrigin:o(be.J4.BackstageMru),uiCulture:n.uiCulture,dataCulture:n.dataCulture,puid:n.puid,rebootOverrideData:l,clickTime:Date.now()},!1):r((0,t.pi)((0,t.pi)({},n),{wdOrigin:o(be.J4.Reboot),rebootOverrideData:l,clickTime:Date.now()}),!0),[2]}}))}))}}({getCurrentDocumentInfo:m,health:ie,getWdOrigin:function(e){return"".concat(b).concat(e)},reboot:function(e,n){ce({documentBootInfo:e,navigationRequired:!n}).catch((function(){null==ne||ne.ULS.sendTraceTag(512296464,r.W.Lt,s.G.Error,"endSession: endSession error in DocumentReboot")}))}}),I=function(e){var n=this;return function(i){return(0,t.mG)(n,void 0,void 0,(function(){return(0,t.Jh)(this,(function(n){switch(n.label){case 0:return[4,Promise.all([a.e(6553),a.e(4630)]).then(a.bind(a,3404))];case 1:return[4,n.sent().renameHandler(e,i)];case 2:return n.sent(),[2]}}))}))}}({bootedDocumentInfo:n,getCurrentDocumentInfo:m,hostRenameCallback:M,health:ie}),A=function(e){var n=this,i=e.supportsRefreshTokenReauthPopUp,o=e.hostUrl,a=e.documentBootInfo,u=e.fetchItemFromNetwork,c=e.officeDocumentSession,l=e.appUrlPromise,d=e.invokePopupBlockedDialog,f=e.logger,v=e.health,h=0,p=!1,m=!1;return function(e){return(0,t.mG)(n,void 0,void 0,(function(){var n,S,H,w,b,g,I,A,C,U,R,y,N,T,E,F,D,k;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,11]),null==v||v.addQosPillar("Interruptions"),null==f||f.ULS.sendTraceTag(512247693,r.W.Lt,s.G.Info,"Start token refresh: Application : ".concat(a.fileType,", Origin: ").concat(a.wdOrigin)),[4,(0,_e.o)(a,u,f,!0,!1,!1)];case 1:return n=t.sent(),S=null==n?void 0:n.wopiHostData.wac,H=e.Tokens.map((function(e){return n=e,i=(t=S).accessTokenExpiry,(o=t[n.charAt(0).toLowerCase()+n.slice(1)])?{Name:n,Expiry:i,Value:o.toString()}:{Name:n,Errors:[{Id:"404",Details:"Could not find this token"}]};var n,t,i,o})),null==v||v.recordKpiSuccess(be.yv.ni),(0,Ze.R)(Je.KX.PostMessage_RefreshSessionInfo,{Tokens:H},l,c,f),h>0&&(null==f||f.ULS.sendTraceTag(509441036,r.W.Lt,s.G.Info,"Resetting popup retry count to 0 from ".concat(h," after successful token acquistion")),h=0),[3,11];case 2:w=t.sent(),(b=null!==(T=w.status)&&void 0!==T?T:(null===(E=w.httpResponse)||void 0===E?void 0:E.status)===Ve.W.TokenUnavailable?Ve.W.Unauthorized:null===(F=w.httpResponse)||void 0===F?void 0:F.status)||(null==f||f.ULS.sendTraceTag(508913162,r.W.Lt,s.G.Warning,"Unable to parse status from error: ".concat(JSON.stringify(w,Object.getOwnPropertyNames(w)),"; status: ").concat(b)),b=0),g=qe({status:b,errorCode:null!==(D=w.errorCode)&&void 0!==D?D:"",message:null!==(k=w.message)&&void 0!==k?k:""}),t.label=3;case 3:return t.trys.push([3,9,,10]),void 0===b?[3,7]:(null==f||f.ULS.sendTraceTag(512549194,r.W.Lt,s.G.Warning,"Error while refreshing token - "+w.status),"string"!=typeof o?[3,4]:(A=o,[3,6]));case 4:return[4,o];case 5:A=t.sent(),t.label=6;case 6:return I=A,i&&e.AllowAADPopup&&I&&function(e,n,t){return n<cn&&(e===Ve.W.Unauthorized||e===Ve.W.Forbidden&&t.indexOf("aadInteractionRequired")>-1)}(b,h,g.Details)?(C=function(){var n=e.Tokens.map((function(e){return{Name:e,Errors:[{Id:"202",Details:"AAD Interaction Required"}],SPCorrelationId:w.SPRequestGuid}}));(0,Ze.R)(Je.KX.PostMessage_RefreshSessionInfo,{Tokens:n},l,c,f)},U=function(){if(document.hidden&&h>0||m)C();else{var n=h;h++;var t=function(e,n,t){var i=e.concat("?wacreauth=1"),o=void 0!==window.screenLeft?window.screenLeft:screen.left,r=void 0!==window.screenTop?window.screenTop:screen.top,a=(window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width)/2-n/2+o,u=(window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height)/2-t/2+r,s=window.open(i,"","scrollbars=yes, width="+n+", height="+t+", top="+u+", left="+a);try{null==s||s.focus()}catch(e){return null}return s}(I,un,sn);if(t)m=!0,setTimeout((function(){t.close(),m=!1}),2e4),C();else{null==f||f.ULS.sendTraceTag(509646289,r.W.Lt,s.G.Warning,"401 - Popup blocked [retry: ".concat(n,"]"));var i=function(){var n=ln(e.Tokens,b,w);null==v||v.recordKpiFailure(be.yv.ni),null==v||v.recordQosError(be.DG.QosError_WopiRefreshAuthTokenFailure,[be.cS.QosVeto_WopiAuthExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorMessage","Background Auth refresh failure. Supported pop-up did not open."],["AuthError","".concat(g.Details)],["HttpErrorCode","".concat(g.Id.toString())]])}),(0,Ze.R)(Je.KX.PostMessage_RefreshSessionInfo,{Tokens:n},l,c,f)};!d||p||document.hidden?document.hidden?(null==f||f.ULS.sendTraceTag(509084357,r.W.Lt,s.G.Warning,"Document is hidden"),C()):i():(p=!0,null==f||f.ULS.sendTraceTag(509136921,r.W.Lt,s.G.Info,"Popup blocked dialog invoked"),d({visible:!0,handleRefresh:function(){null==f||f.ULS.sendTraceTag(509136920,r.W.Lt,s.G.Info,"Retry button clicked. Resetting retry from ".concat(h," to 0.")),h=0,U()},handleCancel:function(){null==f||f.ULS.sendTraceTag(509136919,r.W.Lt,s.G.Info,"Continue button clicked"),i()},onDismiss:function(){null==f||f.ULS.sendTraceTag(509136918,r.W.Lt,s.G.Info,"Dialog was dismissed"),i()}}))}}},U()):(R=ln(e.Tokens,b,w),y="",h>=cn?y="Exceeded maximum 401 reauth retry attempts at ".concat(h):b!==Ve.W.Unauthorized||i?b!==Ve.W.Unauthorized||e.AllowAADPopup?b!==Ve.W.Unauthorized&&(y="Do not retry on status codes other than 401"):y="No reauth pop-up support from the application":y="No reauth pop-up support from the host",null==v||v.recordKpiFailure(be.yv.ni),null==v||v.recordQosError(be.DG.QosError_WopiRefreshAuthTokenFailure,[be.cS.QosVeto_WopiAuthExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorMessage","Background Auth refresh failure.".concat(y?" ".concat(y,"."):"")],["AuthError","".concat(g.Details)],["HttpErrorCode","".concat(g.Id.toString())]])}),(0,Ze.R)(Je.KX.PostMessage_RefreshSessionInfo,{Tokens:R},l,c,f)),[3,8];case 7:null==v||v.recordKpiFailure(be.yv.ni),null==v||v.recordQosError(be.DG.QosError_WopiRefreshAuthTokenFailure,[be.cS.QosVeto_WopiAuthExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorMessage","Background Auth refresh failure. Status is undefined. This should not happen."],["AuthError","".concat(g.Details)],["HttpErrorCode","".concat(g.Id.toString())]])}),null==f||f.ULS.sendTraceTag(512549195,r.W.Lt,s.G.Error,"Unexpected error refreshing token ("+JSON.stringify(w)+")"),t.label=8;case 8:return[3,10];case 9:return N=t.sent(),null==v||v.recordKpiFailure(be.yv.ni),null==v||v.recordQosError(be.DG.QosError_WopiRefreshAuthTokenFailure,[be.cS.QosVeto_WopiAuthExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorMessage","Background Auth refresh failure. Failed to parse error response."],["AuthError","".concat(g.Details)],["HttpErrorCode","".concat(g.Id.toString())]])}),null==f||f.ULS.sendTraceTag(510248914,r.W.Lt,s.G.Error,"Unexpected error when parsing error ("+N+")"),[3,10];case 10:return[3,11];case 11:return[2]}}))}))}}({hostUrl:null==H?void 0:H.hostUrl,supportsRefreshTokenReauthPopUp:null==y?void 0:y.supportsRefreshTokenReauthPopUp,getCurrentDocumentInfo:m,documentBootInfo:f,fetchItemFromNetwork:v,officeDocumentSession:i,appUrlPromise:p,invokePopupBlockedDialog:L,logger:ne,health:ie}),R=function(e){var n=this;return function(i){return(0,t.mG)(n,void 0,void 0,(function(){return(0,t.Jh)(this,(function(n){switch(n.label){case 0:return[4,Promise.all([a.e(6553),a.e(4630)]).then(a.bind(a,3404))];case 1:return[4,n.sent().shareHandler(e,i)];case 2:return n.sent(),[2]}}))}))}}({getCurrentDocumentInfo:m,sharePointInfo:e.sharePointInfo,shareApiEndPointBase:Y,fetchAccessToken:h,openShareControl:E,correlationId:Se,isMsa:Z,tenantId:X,organizationName:ee,onOpen:function(){(0,l.dt)(l.Fh.FeatureGate_BlurAndGrabFocusForShareDialogGate,S,ne),S&&(0,Ze.R)(Je.KX.PostMessage_BlurFocus,void 0,Ie,Pe,ne)},onClose:function(){(0,l.dt)(l.Fh.FeatureGate_BlurAndGrabFocusForShareDialogGate,S,ne),S&&(0,Ze.R)(Je.KX.PostMessage_GrabFocus,void 0,Ie,Pe,ne)},health:ie,featureGates:null==y?void 0:y.featureGates,logger:ne}),K=null!=O?O:function(e){var n=this,i=e.shareHandler,o=e.officeDocumentSession,r=e.appUrlPromise,a=e.logger;return function(e){return(0,t.mG)(n,void 0,void 0,(function(){var n;return(0,t.Jh)(this,(function(t){return n=function(n,t){(0,Ze.R)(Je.KX.PostMessage_GrantPermissions,{Persons:e.Persons.map((function(e){return{Id:e.Id,Provider:e.Provider,Status:n?0:3,Reason:""}})),DialogCanceled:null!=t&&t,Id:e.Id},r,o,a)},i({wdUserSession:e.wdUserSession,mode:"atMention",onGrantAccessComplete:n,defaultRecipients:e.Persons.map((function(e){return e.Id}))}),[2]}))}))}}({getCurrentDocumentInfo:m,shareHandler:R,officeDocumentSession:i,appUrlPromise:p,logger:ne,health:ie}),_=function(e){var n=this,i=e.onUserActivity;return function(){return(0,t.mG)(n,void 0,void 0,(function(){return(0,t.Jh)(this,(function(e){return i&&i(),[2]}))}))}}({getCurrentDocumentInfo:m,onUserActivity:k,health:ie}),J=function(e){var n=this;return function(i){return(0,t.mG)(n,void 0,void 0,(function(){return(0,t.Jh)(this,(function(n){switch(n.label){case 0:return[4,Promise.all([a.e(6553),a.e(4630)]).then(a.bind(a,3404))];case 1:return[4,n.sent().createNewHandler(e,i)];case 2:return n.sent(),[2]}}))}))}}({getCurrentDocumentInfo:m,createDocument:T,getWdOrigin:function(e){return"".concat(b).concat(e)},reboot:function(e,n){ce({documentBootInfo:e,navigationRequired:!n}).catch((function(e){var n=(0,l.vJ)(l.Fh.FeatureGate_CommandingAshaVetoes,null==y?void 0:y.featureGates);(0,l.dt)(l.Fh.FeatureGate_CommandingAshaVetoes,n,ne),n&&(null==ie||ie.recordQosError(be.DG.QosError_CreateNewHandlerEndSessionFailure,[be.cS.QosVeto_CreateNewExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorName",be.DG.QosError_CreateNewHandlerEndSessionFailure],["CorrelationId","".concat(Se)],["Reason",e]])})),null==ne||ne.ULS.sendTraceTag(512296463,r.W.Lt,s.G.Error,"endSession: endSession error in DocumentCreate")}))},logger:ne,isBackstageCreateNewImprovementEnabled:ae,health:ie,correlationId:Se}),V=function(e){var n=this,i=e.getCurrentDocumentInfo,o=e.fetchAccessToken,r=e.officeDocumentSession,a=e.appUrlPromise,u=e.logger,s=e.health,c=e.correlationId;return function(e){return(0,t.mG)(n,void 0,void 0,(function(){var n,l,d,f,v;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return[4,i()];case 1:n=t.sent(),t.label=2;case 2:return t.trys.push([2,4,,5]),h=null!==(v=n.docUrl)&&void 0!==v?v:"",l=(0,ge.aE)(h)===ge.o4.OneDrive?"OneDrive":"SharePoint",[4,o(l,!1,e.Resource)];case 3:return d=t.sent(),null==s||s.recordKpiSuccess(be.yv.ti),(0,Ze.R)(Je.KX.PostMessage_SetAuthToken,{RequestId:e.RequestId,AuthToken:d.token,TokenExpiration:d.expiryMs?new Date(d.expiryMs):void 0},a,r,u),[3,5];case 4:return f=t.sent(),null==s||s.recordKpiFailure(be.yv.ti),null==s||s.recordQosError(be.DG.QosError_WopiFetchAuthTokenFailure,[be.cS.QosVeto_WopiAuthExperienceDegraded],!1,!1,!1,!1,{extendedProperties:new Map([["ErrorName",be.DG.QosError_WopiFetchAuthTokenFailure],["CorrelationId","".concat(c)],["AuthError","".concat(null==f?void 0:f.error)],["ErrorCategory","".concat(null==f?void 0:f.errorCategory)]])}),(0,Ze.R)(Je.KX.PostMessage_SetAuthToken,{RequestId:e.RequestId,Error:"string"==typeof f?f:JSON.stringify(f)},a,r,u),[3,5];case 5:return[2]}var h}))}))}}({getCurrentDocumentInfo:m,fetchAccessToken:h,officeDocumentSession:i,appUrlPromise:p,logger:ne,health:ie}),q=function(e){var n=this,i=e.onReturnFocus,o=e.logger;return function(e){return(0,t.mG)(n,void 0,void 0,(function(){return(0,t.Jh)(this,(function(n){if(!i)return null==o||o.ULS.sendTraceTag(576217558,r.W.Lt,s.G.Error,"Receiving AccessibilityLoopComplete message, but no OnReturnFocus callback is defined!"),[2];switch(e.Direction){case"forward":i(!0);break;case"backward":i(!1);break;default:i()}return[2]}))}))}}({getCurrentDocumentInfo:m,onReturnFocus:C,health:ie}),z=function(e){var n=this,i=e.getCurrentDocumentInfo,o=e.hostClientType,a=e.logger,u=e.openInMobileAppCallback;return function(e){return(0,t.mG)(n,void 0,void 0,(function(){var n,c;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return null==a||a.ULS.sendTraceTag(526242818,r.W.Lt,s.G.Info,"Trying to open the ClientUrl}"),e?e.Status!==rn.Succeeded.toString()?(null==a||a.ULS.sendTraceTag(526242820,r.W.Lt,s.G.Error,"Host_GetClientUrl failed with status code ".concat(e.Status)),[2]):(n=e.Url,[4,i()]):(null==a||a.ULS.sendTraceTag(526242819,r.W.Lt,s.G.Info,"Response not present"),[2]);case 1:return t.sent().fileType!==N.T.OneNote?(null==a||a.ULS.sendTraceTag(525682274,r.W.Lt,s.G.Info,"This handler is not supported for fileType: ".concat(N.T)),[2]):(o===an.android?c="market://details?id=com.microsoft.office.onenote":o===an.ios||o===an.ipados?c="https://itunes.apple.com/us/app/appname/id410395246":(null==a||a.ULS.sendTraceTag(526242821,r.W.Lt,s.G.Info,"HostClientType: ".concat(o," not supported.")),c=""),u?(u(n,c),[2]):(null==a||a.ULS.sendTraceTag(512337545,r.W.Lt,s.G.Error,"openInMobileApp callback is not defined"),[2]))}}))}))}}({getCurrentDocumentInfo:m,hostClientType:te,logger:ne,openInMobileAppCallback:F,health:ie}),Q=function(e){var n=this,i=e.getCurrentDocumentInfo,o=e.hostClientType,a=e.logger;return function(e){return(0,t.mG)(n,void 0,void 0,(function(){var n,u;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return null==a||a.ULS.sendTraceTag(508352280,r.W.Lt,s.G.Info,"Trying to copy the WebUrl to clipboard for HostClientType: ".concat(o)),e?e.Status!==rn.Succeeded.toString()?(null==a||a.ULS.sendTraceTag(508352279,r.W.Lt,s.G.Error,"Host_GetWebUrl failed with status code ".concat(e.Status," for HostClientType: ").concat(o)),[2]):e.Url?[4,i()]:(null==a||a.ULS.sendTraceTag(508352277,r.W.Lt,s.G.Info,"Web Url not present in the response for HostClientType: ".concat(o)),[2]):(null==a||a.ULS.sendTraceTag(508352278,r.W.Lt,s.G.Info,"Response not present"),[2]);case 1:return t.sent().fileType!==N.T.OneNote?[3,5]:((n=document.createElement("textarea")).style.position="absolute",n.style.opacity="0",n.value=e.Url,document.body.appendChild(n),document.execCommand("RemoveFormat"),u=document.execCommand("copy"),document.body.removeChild(n),u?[3,3]:[4,navigator.clipboard.writeText(e.Url).then((function(){null==a||a.ULS.sendTraceTag(508352276,r.W.Lt,s.G.Info,"navigator.clipboard command succeeded for HostClientType: ".concat(o,"!")),dn(!0)})).catch((function(e){null==a||a.ULS.sendTraceTag(508352275,r.W.Lt,s.G.Error,"navigator.clipboard command failed for HostClientType: ".concat(o,", Error: ").concat(e)),dn(!1)}))]);case 2:return t.sent(),[3,4];case 3:null==a||a.ULS.sendTraceTag(508352274,r.W.Lt,s.G.Info,"ExecCommand 'copy' succeeded for HostClientType: ".concat(o,"!")),dn(!0),t.label=4;case 4:return[3,6];case 5:return null==a||a.ULS.sendTraceTag(508352273,r.W.Lt,s.G.Info,"This handler is not supported for fileType: ".concat(N.T)),[2];case 6:return[2]}}))}))}}({getCurrentDocumentInfo:m,hostClientType:te,logger:ne,health:ie}),$=function(e){var n=this,i=e.getCurrentDocumentInfo,o=e.fetchItemFromNetwork,r=e.officeDocumentSession,a=e.appUrlPromise,u=e.logger,s=e.health;return function(e){return(0,t.mG)(n,void 0,void 0,(function(){return(0,t.Jh)(this,(function(n){switch(n.label){case 0:return[4,on(ze.GetWopiInfoFromUrl,e,i,o,a,r,u,s)];case 1:return n.sent(),[2]}}))}))}}({getCurrentDocumentInfo:m,fetchItemFromNetwork:v,officeDocumentSession:i,appUrlPromise:p,logger:ne,health:ie}),oe=function(e){var n=this,i=e.getCurrentDocumentInfo,o=e.fetchItemFromNetwork,r=e.officeDocumentSession,a=e.appUrlPromise,u=e.logger,s=e.health;return function(e){return(0,t.mG)(n,void 0,void 0,(function(){return(0,t.Jh)(this,(function(n){switch(n.label){case 0:return[4,on(ze.GetDavUrlFromIds,e,i,o,a,r,u,s)];case 1:return n.sent(),[2]}}))}))}}({getCurrentDocumentInfo:m,fetchItemFromNetwork:v,officeDocumentSession:i,appUrlPromise:p,logger:ne,health:ie}),re=function(e){var n=this;return function(i){return(0,t.mG)(n,void 0,void 0,(function(){return(0,t.Jh)(this,(function(n){switch(n.label){case 0:return[4,Promise.all([a.e(6553),a.e(4630)]).then(a.bind(a,3404))];case 1:return[4,n.sent().actionCompleteHandler(e,i)];case 2:return n.sent(),[2]}}))}))}}({getCurrentDocumentInfo:m,logger:ne,webUrl:null!==(c=e.webUrl)&&void 0!==c?c:"",health:ie}),ue=function(e){var n=this;return function(){return(0,t.mG)(n,void 0,void 0,(function(){return(0,t.Jh)(this,(function(n){switch(n.label){case 0:return[4,Promise.all([a.e(6553),a.e(4630)]).then(a.bind(a,3404))];case 1:return n.sent().openInBrowserHandler(e),[2]}}))}))}}({getCurrentDocumentInfo:m,logger:ne,webUrl:null!==(d=e.webUrl)&&void 0!==d?d:"",health:ie,correlationId:Se}),se=function(e){var n=this;return function(i){return(0,t.mG)(n,void 0,void 0,(function(){return(0,t.Jh)(this,(function(n){switch(n.label){case 0:return[4,Promise.all([a.e(6553),a.e(4630)]).then(a.bind(a,3404))];case 1:return n.sent().openInMobileAppHandler(e,i),[2]}}))}))}}({getCurrentDocumentInfo:m,logger:ne,openInMobileAppCallback:F,health:ie,correlationId:Se}),le={appUrlPromise:p,container:w,fetchAccessToken:h,fetchItemFromNetwork:v,getCurrentDocumentInfo:m,host:null==y?void 0:y.uiHostName,health:ie,logger:ne,officeDocumentSession:i,wopiHostData:e,sessionConfig:H,uiHostConfig:y,initPackageParams:j},de=null!=x?x:function(e){var n=this;return function(i){return(0,t.mG)(n,void 0,void 0,(function(){return(0,t.Jh)(this,(function(n){switch(n.label){case 0:return[4,Promise.all([a.e(6553),a.e(4630)]).then(a.bind(a,3404))];case 1:return[4,n.sent().moveToFolderFilePickerHandler(e,i)];case 2:return n.sent(),[2]}}))}))}}(le),fe=null!=W?W:function(e){var n=this;return function(i){return(0,t.mG)(n,void 0,void 0,(function(){return(0,t.Jh)(this,(function(n){switch(n.label){case 0:return[4,Promise.all([a.e(6553),a.e(4630)]).then(a.bind(a,3404))];case 1:return[4,n.sent().commonPickerHandler(e,i)];case 2:return n.sent(),[2]}}))}))}}(le),ve=function(e){var n=this,i=e.customAuthConfigValue,o=e.officeDocumentSession,r=e.appUrlPromise,a=e.logger;return function(){return(0,t.mG)(n,void 0,void 0,(function(){var e,n;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return"string"!=typeof i?[3,1]:(n=i,[3,3]);case 1:return[4,i];case 2:n=t.sent(),t.label=3;case 3:return(e=n)&&(0,Ze.R)(Je.KX.PostMessage_SendCustomAuthConfig,{AuthConfig:e},r,o,a),[2]}}))}))}}({customAuthConfigValue:null==H?void 0:H.customAuthConfigValue,getCurrentDocumentInfo:m,officeDocumentSession:i,appUrlPromise:p,logger:ne,health:ie}),pe=function(e){var n=this,i=e.supportsPopAndPushState,o=e.logger,a=e.sharingLinkTokenProvider;return function(e){return(0,t.mG)(n,void 0,void 0,(function(){return(0,t.Jh)(this,(function(n){return i?(a&&a.TokenPromise?(null==o||o.ULS.sendTraceTag(528004815,r.W.Lt,s.G.Info,"".concat(vn,": Handling push state with sharing link token")),a.TokenPromise.then((function(n){if(n){var t=new URL(e.Url);t.searchParams.set(n.Key,n.Value),e.Url=t.toString()}hn(e)})).catch((function(e){null==o||o.ULS.sendTraceTag(528004816,r.W.Lt,s.G.Error,"".concat(vn,": Handling push state with sharing link token error ").concat(e))}))):(null==o||o.ULS.sendTraceTag(528004817,r.W.Lt,s.G.Info,"".concat(vn,": Handling push state without sharing link token")),hn(e)),[2]):[2]}))}))}}({getCurrentDocumentInfo:m,supportsPopAndPushState:null==y?void 0:y.supportsPopAndPushState,logger:ne,sharingLinkTokenProvider:D,health:ie}),me=function(e){var n=this,i=e.onCAAEMessage;return function(e){return(0,t.mG)(n,void 0,void 0,(function(){return(0,t.Jh)(this,(function(n){return i&&i(e),[2]}))}))}}({getCurrentDocumentInfo:m,onCAAEMessage:P,health:ie}),He=function(e){var n=e.appUrlPromise,t=e.logger,i=e.officeDocumentSession;return function(e){var o={State:e.state,Url:window.location.href};(0,Ze.R)(Je.KX.PostMessage_PopState,o,n,i,t)}}({getCurrentDocumentInfo:m,appUrlPromise:p,logger:ne,officeDocumentSession:i,health:ie});!function(e){var n=e.onPopState;e.supportsPopAndPushState&&window.addEventListener("popstate",n)}({getCurrentDocumentInfo:m,onPopState:He,supportsPopAndPushState:null==y?void 0:y.supportsPopAndPushState,health:ie});var we=function(e){var n=this,i=e.onFrameChange;return function(e){return(0,t.mG)(n,void 0,void 0,(function(){return(0,t.Jh)(this,(function(n){return i&&i(e),[2]}))}))}}({getCurrentDocumentInfo:m,onFrameChange:G,health:ie});return{documentRebootHandler:g,renameHandler:I,sessionRefreshInfoHandler:A,shareHandler:R,userAccessHandler:K,userActivityHandler:_,createNewHandler:J,getAuthTokenHandler:V,accessibilityLoopCompleteHandler:q,getClientUrlCompleteHandler:z,getWebUrlCompleteHandler:Q,wopiInfoFromUrlHandler:$,davUrlFromIdsHandler:oe,onCloseHandler:function(){null==ne||ne.ULS.sendTraceTag(575545427,r.W.Lt,s.G.Info,"Handle UI_Close post message from WAC. onCloseHandler exist: ".concat(U?"true":"false")),U&&U()},actionCompleteHandler:re,openInBrowserHandler:ue,openInMobileAppHandler:se,moveToFolderPickerHandler:de,commonFilePickerHandler:fe,getCustomAuthConfigHandler:ve,pushStateHandler:pe,caaeMessageHandler:me,frameChangedHandler:we,fileEmbedHandler:function(){B&&B()}}},fe=(null==j?void 0:j.jsApiUrlInfos)?null==j?void 0:j.jsApiUrlInfos:new Map;0===fe.size&&fe.set(N.T.Word,{jsApiUrl:null===(n=null==j?void 0:j.wordBootstrapperUrlInfo)||void 0===n?void 0:n.url,jsApiSri:null===(i=null==j?void 0:j.wordBootstrapperUrlInfo)||void 0===i?void 0:i.sri,PreloadedInBootStrapper:null===(u=null==j?void 0:j.wordBootstrapperUrlInfo)||void 0===u?void 0:u.wordJsApiPreloadedInBootStrapper});var ve,pe=function(e,n,i,o,a,u,d,f,v,h,p){if(void 0===d&&(d=!1),je||(je=new Map),!e.isNewFile||!e.createNewInfo){var m=(0,Le.q_)(e);if(!m)return{correlationId:n,bootstrapperObservable:("Not enough document information was provided",new V.y((function(e){return e.error("Not enough document information was provided")}))),fileNamePromise:Promise.reject("No name was provided"),applicationUrlPromise:Promise.reject("No applicationUrl")};var S=je.get(m);if(S)return S}return function(e,n,i,o,a,u,d,f,v,h,p){var m,S,H;void 0===d&&(d=!1);var w=Be(n),b=null==a?void 0:a.logger;(null===(m=null==p?void 0:p.get(e.fileType))||void 0===m?void 0:m.jsApiUrl)&&!(null===(S=null==p?void 0:p.get(e.fileType))||void 0===S?void 0:S.PreloadedInBootStrapper)&&function(e){new Promise((function(n,t){var i=document.createElement("link");i.href=e,i.rel="preload",i.as="script",i.onload=function(){return n()},i.onerror=function(){return t(new Error("".concat(e," failed to load")))},document.documentElement.appendChild(i)}))}(null===(H=null==p?void 0:p.get(e.fileType))||void 0===H?void 0:H.jsApiUrl);var g=(0,_e.o)(e,i,b,d,!(!e.isNewFile&&!e.templateId),!0,!!(null==a?void 0:a.meeting)),I=new De;g.then((function(n){n.fetchedDocumentIdentifier.then((function(i){var c;!function(e,n,i,o,a,u,c,l){var d=this,f=e.loadFunctionSubject,v=e.documentBootInfo,h=e.correlationId,p=e.wopiFetchData,m=void 0===p?{wopiHostData:void 0,fetchDiagnostics:void 0}:p,S=v.fileType,H=v.wdOrigin,w=v.puid,b=v.uiCulture,g=v.dataCulture,I=v.clickTime,A=v.rebootOverrideData,C=m.wopiHostData,U=m.fetchDiagnostics,R=null==i?void 0:i.logger,y=null==i?void 0:i.health;if(!(C&&C.wac&&C.wac.bootstrapperUrl&&C.wac.applicationUrl)){var T=!!C,E=!!(null==C?void 0:C.wac),F=new Map([["WopiHostDataPresent","".concat(T)],["WopiWacDataPresent","".concat(E)]]),D=JSON.stringify(Array.from(F.entries())),k={wacErrorName:be.AU.oi,qosErrorName:be.DG.QosError_VroomWopiFailure,errorMessage:D};return null==R||R.ULS.sendTraceTag(554964098,r.W.Lt,s.G.Info,"".concat(be.AU.oi,": Failed to get wopi data for the item, ").concat(D)),void(o&&o(k))}var P=l||C.wac.bootstrapperUrl,O=C.wac.applicationUrl;C.wac.userId&&(null==y||y.updatePartADimensions({loggableUserId:C.wac.userId}));var x=new Promise((function(e,n){setTimeout((function(){return n("jsApi timed out after 60 seconds")}),6e4)})),K=new Promise((function(e,l){return(0,t.mG)(d,void 0,void 0,(function(){return(0,t.Jh)(this,(function(d){return f.subscribe((function(){return e("jsApi successfully loaded")})),function(e,n,t){xe||(xe=new Map);var i=xe.get(t);if(i)return i;var o=new Promise((function(i,o){var r=Date.now();!function(e,n,t,i,o,r,a){if(void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===a&&(a=!1),!document)return null;if(o){var u=document.getElementById(o);if(null!=u)return n&&n(),u}var s=document.createElement("script");if(s.src=e,o&&(s.id=o),n&&(s.onload=n),t&&(s.onerror=function(){var e;t(),a&&(null===(e=s.parentNode)||void 0===e||e.removeChild(s))}),r&&(s.crossOrigin="anonymous"),i){var c=document.getElementsByTagName("script")[0];if(c&&c.parentNode)return c.parentNode.insertBefore(s,c)}document.body.appendChild(s)}(e,(function(){var t=Date.now();i({bootstrapperUrl:e,applicationUrl:n,performance:{startTime:r,endTime:t}})}),(function(){o("Load bootstrapper script failed")}),!1,"".concat(N.T[t],"_bootstrapper"))}));return xe.set(t,o),o}(P,O,S).then((function(e){var l,d=(0,t.CR)(function(e){var n=window.Microsoft;if(void 0===n)return[void 0,"Microsoft is undefined"];var t=n.Office,i=N.T[e];return t&&t[i]?[t[i],void 0]:[void 0,"Failed to find bootstrapper for app: ".concat(i)]}(S),2),p=d[0],m=d[1];if(!m&&p){var T,E,F=Ee(C,e.applicationUrl,null!==(l=null==n?void 0:n.uiHostName)&&void 0!==l?l:"UUIH",v,null==n?void 0:n.uiEmbed);try{E=new URLSearchParams(new URL(F).search).get("sc")||void 0}catch(e){null==R||R.ULS.sendTraceTag(520135565,r.W.Lt,s.G.Info,"Error trying to get session context from app URL: ".concat(JSON.stringify(e)))}Te(S,null==n?void 0:n.featureGates,R)?(null==y||y.addOrUpdatePartCDimension("JsApiVersion","V2"),T=function(o){var l=o.container,d=o.flushTime;return new V.y((function(o){var f,m,S,y,N,T,D,k,O,x={host:{storageHostName:Ue(null!==(y=v.docUrl)&&void 0!==y?y:""),capabilities:{isFeatureEnabledCallback:Ne(i),moveToFolder:null==n?void 0:n.supportsMoveToFolder,commonFilePicker:null==n?void 0:n.supportsCommonFilePicker,rebootDoc:null==n?void 0:n.supportsDocumentReboot,createNewDoc:null==n?void 0:n.supportsCreateNewDocument,authToken:null==n?void 0:n.supportsAuthToken,excelExternalLinks:null==n?void 0:n.supportsExcelExternalLinks,refreshAccessToken:null==n?void 0:n.supportsRefreshAccessToken,atMentions:null==n?void 0:n.supportsAtMentions,accessibilityLoop:null==n?void 0:n.supportsAccessibilityLoop,customAuthConfig:null==n?void 0:n.supportsCustomAuthConfig,directPrint:null==n?void 0:n.supportsDirectPrint,directDownload:null==n?void 0:n.supportsDirectDownload},uiHostName:(null==n?void 0:n.uiHostName)||Ae,requireExplicitUnload:null==n?void 0:n.supportsExplicitUnload,metaUiHostVersion:null==i?void 0:i.metaUiHostVersion,uiHostIntegrationType:null==n?void 0:n.uiHostIntegrationType,owlVersion:null==i?void 0:i.owlVersion,owlRollout:null==i?void 0:i.owlRollout},user:{id:C?C.wac.userId:w,isSynthetic:null==i?void 0:i.isSynthetic},bootstrapperUrl:P,ui:{uiEmbed:null===(N=null==n?void 0:n.uiEmbed)||void 0===N||N,controls:(null==n?void 0:n.supportsHostUiControls)?[{id:"close",visibility:(null==n?void 0:n.showCloseButton)?1:0},{id:"share",visibility:(null==n?void 0:n.supportsShare)?1:0},{id:"ellipsisOpenInBrowser",visibility:(null==n?void 0:n.openInBrowserEnabled)?1:0},{id:"ellipsisDownload",visibility:(null==n?void 0:n.ellipsisDownloadACopyButtonEnabled)?1:0},{id:"copyLink",visibility:(null==n?void 0:n.copyLinkEnabled)?1:0}]:void 0,language:b,hideHeader:null==n?void 0:n.hideHeader,hideAppLauncherInHeader:null==n?void 0:n.hideAppLauncherInHeader,hideSearchInHeader:null==n?void 0:n.hideSearchInHeader,hideMeInHeader:null==n?void 0:n.hideMeInHeader,hideChatInHeader:null==n?void 0:n.hideChatInHeader,hideWorkflowInHeader:null==n?void 0:n.hideWorkflowInHeader,hideSettingsInHeader:null==n?void 0:n.hideSettingsInHeader,showAppIconInHeader:null==n?void 0:n.showAppIconInHeader,useNeutralColorInHeader:null==n?void 0:n.useNeutralColorInHeader,highContrast:"invert"===(null==i?void 0:i.highContrastMode)?"invert":void 0,openLinksInNewWindow:null==n?void 0:n.openLinksInNewWindow,contentAssemblyMode:null==n?void 0:n.contentAssemblyMode}},K=p.createApplication(x),W={hostSessionId:h},M=K.createSession(W);u&&u(K,C,v,M),a&&a();var j={appUrl:F,file:(0,t.pi)({name:C.fileName,getUrl:(null===(T=C.wac)||void 0===T?void 0:T.fileGetUrl)||C.downloadUrl,size:C.fileSize,eTag:C.eTag},v.docId&&{uniqueId:v.docId}),customFontCatalogUrl:C.wac.customFontCatalogUrl,contentBundle:{majorVersion:C.bundleVersion?Number(C.bundleVersion):0,url:null!==(D=C.bundleUrl)&&void 0!==D?D:"",staleness:C.bundleStaleness||0},newFileTemplate:v.newFileTemplate,container:l,wopi:{source:C.wac.wopiSrc,accessToken:C.wac.accessToken,expiry:parseInt(C.wac.accessTokenExpiry,10)},bootParams:{readOnly:C.readOnly,irmEnabled:C.irmEnabled,viewOnly:C.blocksDownload,disableChat:!0,openViewByDefault:"view"===v.intent,dataLanguage:g},diagnostics:Re(I,d,H,U,e.performance,i,null==n?void 0:n.featureGates),sessionContext:E||Ce(),preseededSession:{key:C.preSeededSessionKey,id:C.preSeededWacSessionId},wdParams:(0,t.pi)((0,t.pi)((0,t.pi)({},v.templateId&&(f={},f.wdTpl=v.templateId,f)),A&&A.lcid&&(m={},m.wdlcid=A.lcid,m)||v.uiCulture&&(S={},S.wdlcid=v.uiCulture,S)),Fe(v.wdValue)),hostGeneratedSessionId:null==i?void 0:i.sessionId,meeting:null==i?void 0:i.meeting,rebootOverride:A,throttling:{protection:null===(k=C.wac)||void 0===k?void 0:k.clientThrottlingProtection,request:null===(O=C.wac)||void 0===O?void 0:O.requestedCallThrottling}};M.boot(j,c).then((function(e){var n,t,i;if("success"===e.completion)o.next({wopiHostData:C,officeApplication:K,bootedDocumentInfo:new J(v),officeDocumentSession:M,wacBootDiagnostics:null===(n=null==M?void 0:M.diagnostics)||void 0===n?void 0:n.appInitDiagnostics}),o.complete();else if("cancelled"===e.completion)null==R||R.ULS.sendTraceTag(509646293,r.W.Lt,s.G.Info,"User cancelled document session boot");else{var a=void 0,u=void 0;"failure"===e.completion?(a=null===(t=e.error)||void 0===t?void 0:t.message,u=null===(i=e.error)||void 0===i?void 0:i.stack):a="timeout"===e.completion?"operation timed out":"unexpected error";var c={wacErrorName:be.AU.fi,qosErrorName:be.DG.QosError_EncounteredJsApiError,errorMessage:a,errorStack:u,error:e.error},l=Me(c),d=JSON.stringify(Array.from(l.entries()));null==R||R.ULS.sendTraceTag(575419404,r.W.Lt,s.G.Error,d),o.error(c)}})).catch((function(e){return null==R?void 0:R.ULS.sendTraceTag(512337547,r.W.Lt,s.G.Error,"officeDocumentSession.boot threw error: ".concat(e))}))}))}):(null==y||y.addOrUpdatePartCDimension("JsApiVersion","V1"),T=function(o){var u=o.container,c=o.flushTime;return new V.y((function(o){var l,d=function(e,n,t,i,o,r,a,u){return{HostName:"office.com",HostSessionId:n,UserId:e,OwnerId:void 0,UiLocale:t,DataLocale:i,DisableChat:!0,CookieCompliant:!0,WdParams:a,DisableFocusOnBoot:!1,SessionContext:u||Ce(),HighContrastMode:null==r?void 0:r.highContrastMode,HideHeader:null==o?void 0:o.hideHeader,HideAppLauncherInHeader:null==o?void 0:o.hideAppLauncherInHeader,HideSearchInHeader:null==o?void 0:o.hideSearchInHeader,HideMeInHeader:null==o?void 0:o.hideMeInHeader,HideChatInHeader:null==o?void 0:o.hideChatInHeader,HideWorkflowInHeader:null==o?void 0:o.hideWorkflowInHeader,HideSettingsInHeader:null==o?void 0:o.hideSettingsInHeader,ShowAppIconInHeader:null==o?void 0:o.showAppIconInHeader,UseNeutralColorInHeader:null==o?void 0:o.useNeutralColorInHeader,SupportsDocReboot:null==o?void 0:o.supportsDocumentReboot,SupportsCreateNewDocument:null==o?void 0:o.supportsCreateNewDocument,SupportsAuthToken:null==o?void 0:o.supportsAuthToken,SupportsAtMentions:null==o?void 0:o.supportsAtMentions,SupportsMoveToFolder:null==o?void 0:o.supportsMoveToFolder,SupportsCommonFilePicker:null==o?void 0:o.supportsCommonFilePicker,SupportsDirectPrint:null==o?void 0:o.supportsDirectPrint,SupportsDirectDownload:null==o?void 0:o.supportsDirectDownload,MetaUiHostVersion:null==r?void 0:r.metaUiHostVersion,SupportsAccessibilityLoop:null==o?void 0:o.supportsAccessibilityLoop,SupportsExcelExternalLinks:null==o?void 0:o.supportsExcelExternalLinks,UiHostIntegrationType:null==o?void 0:o.uiHostIntegrationType,OpenLinksInNewWindow:null==o?void 0:o.openLinksInNewWindow,UiHostTabId:null==r?void 0:r.uiHostTabId,Upn:null==r?void 0:r.upn,TenantId:null==r?void 0:r.tenantId,Meeting:null==r?void 0:r.meeting,SupportsCustomAuthConfig:null==o?void 0:o.supportsCustomAuthConfig,ContentAssemblyMode:null==o?void 0:o.contentAssemblyMode,SupportsRefreshAccessToken:null==o?void 0:o.supportsRefreshAccessToken,IsSynthetic:null==r?void 0:r.isSynthetic,OwlVersion:null==r?void 0:r.owlVersion,OwlRollout:null==r?void 0:r.owlRollout}}(C?C.wac.userId:w,h,b,g,n,i,Fe(v.wdValue),E),f=function(e,n){var i,o,r,a=e.docId,u=e.isNewFile,s=e.fileName,c=e.intent;return n?(0,t.pi)((0,t.pi)({FileName:n.fileName,FileGetUrl:(null===(i=n.wac)||void 0===i?void 0:i.fileGetUrl)||n.downloadUrl,CustomFontCatalogUrl:n.wac.customFontCatalogUrl,FileSize:n.fileSize,BundleInfo:{Url:n.bundleUrl,MajorVersion:n.bundleVersion,BundleStaleness:n.bundleStaleness},ReadOnly:n.readOnly,IrmEnabled:n.irmEnabled,ViewOnly:n.blocksDownload,ETag:n.eTag,ClientThrottlingProtection:null===(o=n.wac)||void 0===o?void 0:o.clientThrottlingProtection,RequestedCallThrottling:null===(r=n.wac)||void 0===r?void 0:r.requestedCallThrottling,IsNewFile:!!u||n.isNewFile},a&&{DocUniqueId:a}),{OpenViewByDefault:"view"===c}):(0,t.pi)({FileName:s,IsNewFile:!0},a&&{DocUniqueId:a})}(v,C),m=Re(I,c,H,U,e.performance,i,null==n?void 0:n.featureGates),S=null==n?void 0:n.uiHostName,A={WopiSrc:(l=C.wac).wopiSrc,AccessToken:l.accessToken,AccessTokenExpiry:new Date(parseInt(l.accessTokenExpiry,10))},y=function(e,n,i,a,u,c,l,d,f,v,h,p,m,S,H,w,b,g,I){var A=n.applicationUrl,C=n.bootstrapperUrl;void 0===f&&(f="officecom"),void 0===I&&(I={});var U={HostUIControls:g?[{id:"close",visibility:p?1:0},{id:"share",visibility:m?1:0},{id:"ellipsisOpenInBrowser",visibility:S?1:0},{id:"ellipsisDownload",visibility:H?1:0},{id:"copyLink",visibility:w?1:0}]:void 0,additionalApplicationParameters:I},y=Ee(h,A,f,v,b);return(0,t.pi)({BootstrapperUrl:C,Container:e,SessionInformation:a,ApplicationUrl:y,WopiPrecheckInfo:u,ApplicationCustomSettings:U,Diagnostics:c,FnOnInitializeSuccess:l,FnOnInitializeFailure:function(e){var n=e.errorObject.message,t=e.errorObject.stack,i={wacErrorName:be.AU.di,qosErrorName:be.DG.QosError_EncounteredJsApiError,errorName:e.errorType,errorMessage:n,errorStack:t,error:e},a=Me(i),u=JSON.stringify(Array.from(a.entries()));null==R||R.ULS.sendTraceTag(575419405,r.W.Lt,s.G.Error,u),o.error(i)},FnIsFeatureEnabled:Ne(),RebootOverrideData:v.rebootOverrideData},i?{WopiInfo:i}:{})}(u,e,A,d,f,m,(function(e,n){o.next({wopiHostData:C,officeApplication:e,bootedDocumentInfo:new J(v),wacBootDiagnostics:n}),o.complete()}),0,S,v,C,null==n?void 0:n.showCloseButton,null==n?void 0:n.supportsShare,null==n?void 0:n.openInBrowserEnabled,null==n?void 0:n.ellipsisDownloadACopyButtonEnabled,null==n?void 0:n.copyLinkEnabled,null==n?void 0:n.uiEmbed,null==n?void 0:n.supportsHostUiControls,null==i?void 0:i.additionalApplicationParameters),N=Date.now();null==R||R.ULS.sendTraceTag(576578583,r.W.Lt,s.G.Info,"BootStrapFile: About to call InitializeWopiPending");var T=p.Application.InitializeWopiPending(y,void 0,null==i?void 0:i.sessionId),F=Date.now()-N;null==R||R.ULS.sendTraceTag(570775769,r.W.Lt,s.G.Info,"BootStrapFile: InitializeWopiPending returned. [IsValidWopiPendingApp: ".concat(!!T,"][TimeElapsed: ").concat(F,"]"));var D=Date.now();if(T){a&&a(),T.Complete(A);var k=Date.now(),P=k-D,O=k-N;null==R||R.ULS.sendTraceTag(570775770,r.W.Lt,s.G.Info,"BootStrapFile: Complete returned.[TimeElapsedInComplete: ".concat(P,"][TimeElapsedSinceInitializeWopiPending: ").concat(O,"]"))}else{var x={wacErrorName:be.AU.ci,qosErrorName:be.DG.QosError_EncounteredJsApiError,errorMessage:"WOPI pending failed"},K=Me(x),W=JSON.stringify(Array.from(K.entries()));o.error(x),null==R||R.ULS.sendTraceTag(575419406,r.W.Lt,s.G.Error,W)}}))}),f.next(T),f.complete()}else{var D=null!=m?m:"Error message undefined. BootStrapped not loaded: ".concat(!p);null==R||R.ULS.sendTraceTag(575419403,r.W.Lt,s.G.Error,D);var k={wacErrorName:be.AU.si,qosErrorName:be.DG.QosError_OfficeBootstrapperNotLoaded,errorMessage:D,error:m,inStaging:!1};o&&o(k)}})).catch((function(e){l(e)})),[2]}))}))}));Promise.race([x,K]).catch((function(e){var n=(null!=e?e:"Failed to load the document")+", bootstrapperUrl: ".concat(P.replace(/^https?:\/\//,"")),t={wacErrorName:be.AU.ci,qosErrorName:be.DG.QosError_FailedToLoadDocument,errorMessage:n,error:e,inStaging:!1};null==R||R.ULS.sendTraceTag(575419407,r.W.Lt,s.G.Error,"".concat(be.AU.ci,": ").concat(n)),o&&o(t)}))}({documentBootInfo:(0,t.pi)((0,t.pi)({},e),i),correlationId:w,loadFunctionSubject:I,wopiFetchData:n},o,a,u,f,v,h,null===(c=null==p?void 0:p.get(e.fileType))||void 0===c?void 0:c.jsApiUrl)})).catch((function(e){null==b||b.ULS.sendTraceTag(509723932,r.W.Lt,s.G.Error,"Failed to fetch document identifier for document with error: ".concat(e))}))})).catch((function(n){if(u){var t=JSON.stringify(n),i={wacErrorName:be.AU.ri,qosErrorName:be.DG.QosError_VroomWopiFailure,errorMessage:t,error:n,httpErrorCode:n.status,networkError:ke(n)};u(i,e)}}));var A={correlationId:w,bootstrapperObservable:I.asObservable(),fileNamePromise:e.fileName?Promise.resolve(e.fileName):g.then((function(e){return e.wopiHostData.fileName})),applicationUrlPromise:new Promise((function(e,n){g.then((function(n){var t,i;return e(null===(i=null===(t=null==n?void 0:n.wopiHostData)||void 0===t?void 0:t.wac)||void 0===i?void 0:i.applicationUrl)})).catch((function(e){n(e)}))}))};return a&&a.wiseEnvironment&&function(e,n,t,i,o,a){if(t){var u=(0,l.vJ)(l.Fh.FeatureGate_DisableEUDBBrowserULSRouting,o);e.then((function(e){if(e&&((0,l.dt)(l.Fh.FeatureGate_DisableEUDBBrowserULSRouting,u,t),!u)){var i=We(e),o=(0,c.fy)(n,i.dataBoundary);t.flushAndSetNewEndpoint(o,(function(){null==t||t.ULS.sendTraceTag(509612803,r.W.Lt,s.G.Info,"Updated ULS endpoint. Environment: ".concat(n,", DataBoundary: ").concat(i.dataBoundary,", Region: ").concat(i.region))}))}})).catch((function(e){null==t||t.ULS.sendTraceTag(509875042,r.W.Lt,s.G.Warning,"Failed to identify data boundary-aware bULS endpoint. Error: ".concat(e.message))}))}if(i){var d=(0,l.vJ)(l.Fh.FeatureGate_DisableEUDBHealthTelemetryRouting,o);e.then((function(e){if(e&&((0,l.dt)(l.Fh.FeatureGate_DisableEUDBHealthTelemetryRouting,d,t),!d)){var o=We(e),u=(0,c.S$)(n,a,o.dataBoundary);i.flushAndSetNewEndpoint(u,(function(){null==t||t.ULS.sendTraceTag(509612802,r.W.Lt,s.G.Info,"Updated Health endpoint. Environment: ".concat(n,", DataBoundary: ").concat(o.dataBoundary,", Region: ").concat(o.region))}))}})).catch((function(e){null==t||t.ULS.sendTraceTag(509875041,r.W.Lt,s.G.Warning,"Failed to identify data boundary-aware Health endpoint. Error: ".concat(e.message))}))}}(A.applicationUrlPromise,a.wiseEnvironment,b,a.health,null==o?void 0:o.featureGates,a.sessionId),A}(e,n,i,o,a,u,d,f,(function(e,n,t,i){ve=e;var o=new J(t),r=de(n,o,i),a=r.documentRebootHandler,u=r.renameHandler,s=r.sessionRefreshInfoHandler,c=r.shareHandler,l=r.userAccessHandler,d=r.userActivityHandler,f=r.createNewHandler,v=r.getAuthTokenHandler,h=r.accessibilityLoopCompleteHandler,p=r.getClientUrlCompleteHandler,m=r.wopiInfoFromUrlHandler,S=r.davUrlFromIdsHandler,H=r.onCloseHandler,w=r.actionCompleteHandler,b=r.openInBrowserHandler,g=r.openInMobileAppHandler,I=r.moveToFolderPickerHandler,A=r.commonFilePickerHandler,C=r.getCustomAuthConfigHandler,U=r.pushStateHandler,R=r.caaeMessageHandler,y=r.frameChangedHandler,N=r.fileEmbedHandler;re=function(e){var n=e.data;switch(e.type){case fn.Reboot:a(n);break;case fn.FileRenamed:u(n);break;case fn.UserAccessAndPermissions:l(n);break;case fn.Share:c(n);break;case fn.UserActivity:d(n);break;case fn.CreateNewDocument:f(n);break;case fn.RefreshSessionInfo:s(n);break;case fn.GetAuthToken:v(n);break;case fn.AccessibilityLoopCompleted:h(n);break;case fn.GetClientUrlComplete:p(n);break;case fn.GetWopiInfoFromUrl:m(n);break;case fn.Close:H();break;case fn.ActionCompleted:w(n);break;case fn.OpenInBrowser:b(n);break;case fn.OpenInMobileApp:g(n);break;case fn.MoveToFolder:I(n);break;case fn.SharedFilePicker:A(n);break;case fn.GetCustomAuthConfig:C(n);break;case fn.GetDavUrlFromIds:S(n);break;case fn.PushState:U(n);break;case fn.CAAEMessage:R(n);break;case fn.FrameChanged:y(n);break;case fn.FileEmbed:N()}},ve.addEventListener(re)}),h,p)}(f,z,v,y,H,A,!1,R,0,ue,fe),Se=pe.correlationId,He=pe.bootstrapperObservable,we=pe.fileNamePromise,Ie=pe.applicationUrlPromise;null==ne||ne.ULS.sendTraceTag(546182048,r.W.Lt,s.G.Info,"BootApp: Load document returned"),we.then((function(e){return null==g?void 0:g(e)})).catch((function(){return"obligatory catch"}));var ye,Pe=void 0,Oe=void 0,Ke=void 0,Ge=new K.xQ;return Oe=function(e,n,t){return e.pipe(le((function(e){return e({container:n,flushTime:t})}),void 0,1))}(He,w,d).subscribe((function(e){var n=e.officeApplication,i=e.bootedDocumentInfo,o=e.wopiHostData,a=e.officeDocumentSession,u=e.wacBootDiagnostics;ve=n,Pe=a;var c=$(window,"message").pipe(me((function(e){return!!e.data&&!!e.origin&&e.origin.endsWith(pn)})),Q((function(e){return JSON.parse(e.data)})),me((function(e){return!(!e||!e.MessageId)})));if(!oe){var l=de(o,i,a),d=l.documentRebootHandler,v=l.renameHandler,h=l.sessionRefreshInfoHandler,w=l.shareHandler,g=l.userAccessHandler,A=l.userActivityHandler,C=l.createNewHandler,U=l.getAuthTokenHandler,R=l.accessibilityLoopCompleteHandler,T=l.getClientUrlCompleteHandler,E=l.getWebUrlCompleteHandler,F=l.wopiInfoFromUrlHandler,D=l.davUrlFromIdsHandler,k=l.onCloseHandler,P=l.actionCompleteHandler,O=l.openInBrowserHandler,x=l.moveToFolderPickerHandler,K=l.commonFilePickerHandler,W=l.getCustomAuthConfigHandler,M=l.pushStateHandler,j=l.caaeMessageHandler,G=l.fileEmbedHandler;se=[[Je.Dm.PostMessage_AccessibilityLoopComplete,R],[Je.Dm.PostMessage_GetClientUrlComplete,T],[Je.E_.Event_DocumentReboot,d],[Je.Dm.PostMessage_FileRenamed,v],[Je.Dm.PostMessage_CheckUserAccess,g],[Je.Dm.PostMessage_Share,w],[Je.Dm.PostMessage_UserActivity,A],[Je.Dm.PostMessage_AppCreateNewDocument,C],[Je.Dm.PostMessage_OpenInBrowser,O],[Je.E_.Event_MoveToFolder,x],[Je.E_.Event_SharedFilePicker,K],[Je.E_.Event_GetCustomAuthConfig,W],[Je.Dm.PostMessage_CAAEMessage,j]],f.fileType===N.T.Excel&&(se.push([Je.E_.Event_GetWopiInfoFromUrl,F]),se.push([Je.E_.Event_GetDavUrlFromIds,D])),se.forEach((function(e){var i=(0,t.CR)(e,2),o=i[0],r=i[1];n.RegisterEventHandler(o,r)})),Ke=c.subscribe((function(e){switch(e.MessageId){case Je.Dm.PostMessage_AppRefreshSessionInfo:h(e.Values);break;case Je.Dm.PostMessage_GetAuthToken:U(e.Values);break;case Je.Dm.PostMessage_Close:k();break;case Je.Dm.PostMessage_ActionComplete:P(e.Values);break;case Je.Dm.PostMessage_AppPushState:M(e.Values);break;case Je.Dm.PostMessage_GetClientUrlComplete:T(e.values);break;case Je.Dm.PostMessage_GetWebUrlComplete:E(e.values);break;case Je.Dm.PostMessage_FileEmbed:G()}}))}if(I){if(null==ne||ne.ULS.sendTraceTag(546182049,r.W.Lt,s.G.Info,"BootApp: About to execute OnBootComplete"),yi(S.OwlOnBootComplete),!p.isOwlFrame&&!p.isOwlFrameEnabled(null==y?void 0:y.featureGates,ne)){var _=function(e){var n,i=e[S.OwlStart]||e[S.OwlWithCustomFunctionsStart],o=e[S.OwlOnBootComplete];return{totalTime:o-i,owlPerformanceTimeline:(0,t.pi)((0,t.pi)({},e),((n={})[S.OwlStart]=i,n[S.OwlEnd]=o,n))}}(b("owl"));null==ne||ne.ULS.sendTraceTag(508568928,r.W.Lt,s.G.Important,m(f.fileType,H.wiseEnvironment,null==y?void 0:y.featureGates,null==y?void 0:y.uiHostName,null==y?void 0:y.uiHostIntegrationType,ne)+", OwlTraditional Telemetry Data: "+JSON.stringify(_))}I(f,u)}}),(function(e){A&&(null==ne||ne.ULS.sendTraceTag(546182050,r.W.Lt,s.G.Info,"BootApp: About to execute OnBootFailure"),A(e)),null==Oe||Oe.unsubscribe(),null==Ke||Ke.unsubscribe()})),{endSession:ce,sessionEndObservable:Ge.asObservable(),hostAccessibilityLoopComplete:function(e){return(0,Ze.R)(Je.KX.PostMessage_HostAccessibilityLoopComplete,{Direction:e?"forward":"backward"},Ie,Pe,ne),!0},hostGetClientUrl:function(){(0,Ze.R)(Je.KX.PostMessage_HostGetClientUrl,{},Ie,Pe,ne)},hostGetWebUrl:function(){(0,Ze.R)(Je.KX.PostMessage_HostGetWebUrl,{},Ie,Pe,ne)},postFrameDiagnostics:function(e){(0,Ze.R)(Je.KX.PostMessage_OwlFrameDiagnostics,{FrameDiagnostics:e},Ie,Pe,ne)}}}var gn=a(6499),In=a(1515),An=function(){function e(e,n){var i=this;this.Ua=0,this.Ra=0,this.initAuthLibrary=function(e){return(0,t.mG)(i,void 0,void 0,(function(){var n,i;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:n=this.storePromiseWrapper("initAuthLibrary"),t.label=1;case 1:return t.trys.push([1,3,,4]),this.ya=e,[4,this.Na];case 2:return t.sent(),this.Ta.contentWindow&&this.Ta.contentWindow.postMessage(JSON.stringify({MessageId:gn.Xv.init,Values:{upn:this.ya.upn,authority:this.ya.authority,interactive:this.ya.interactive,authorityType:this.ya.authorityType,appIds:this.ya.appIds,enableConsoleLogging:this.ya.enableConsoleLogging,enablePopupFlash:this.ya.enablePopupFlash,skipUpnCheck:this.ya.skipUpnCheck,correlationId:this.Ea.getUserSessionId()}}),"*"),[3,4];case 3:throw i=t.sent(),this.Ea.ULS.sendTraceTag(508929187,r.W.Kt,s.G.Error,"[AUTH-BOOTSTRAPPER] Error when initializing authLibrary: ".concat(i)),i;case 4:return[2,n]}}))}))},this.tryGetToken=function(e){return(0,t.mG)(i,void 0,void 0,(function(){var n;return(0,t.Jh)(this,(function(t){n=this.storePromiseWrapper("tryGetToken");try{this.Fa=e,this.Ta.contentWindow&&this.Ta.contentWindow.postMessage(JSON.stringify({MessageId:gn.Xv.tryGetToken,Values:{appId:this.Fa.appId,target:this.Fa.target,claims:this.Fa.claims,withPopup:this.Fa.withPopup,messageCorrelationId:this.Fa.messageCorrelationId}}),"*")}catch(e){this.Ea.ULS.sendTraceTag(508929186,r.W.Kt,s.G.Error,"[AUTH-BOOTSTRAPPER] Error when trying to get token")}return[2,n]}))}))},this.receiveMessage=function(e){return(0,t.mG)(i,void 0,void 0,(function(){var n,i,o,a;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:if(e.origin!==this.Da)return[2];n=JSON.parse(e.data),t.label=1;case 1:switch(t.trys.push([1,9,,10]),n.MessageId){case gn.nd.scriptLoaded:return[3,2];case gn.nd.scriptInitialized:return[3,3];case gn.nd.getTokenResponse:return[3,5]}return[3,7];case 2:return i=n.Values,o=performance.now()-this.ka,this.Pa.scriptLoaded.resolve(),this.Ea.ULS.sendTraceTag(508934364,r.W.Kt,s.G.Info,"[AUTH-BOOTSTRAPPER] WacOAuth.aspx loaded in ".concat(o," [success: ").concat(i.Success,"] [authLibrary: ").concat(i.AuthLibrary,"]")),[3,8];case 3:return[4,this.libraryInit(n.Values)];case 4:return t.sent(),this.Ea.ULS.sendTraceTag(508859403,r.W.Kt,s.G.Info,"[AUTH-BOOTSTRAPPER] Script initialized"),[3,8];case 5:return[4,this.handleTokenResponse(n.Values)];case 6:return t.sent(),this.Ea.ULS.sendTraceTag(508859402,r.W.Kt,s.G.Info,"[AUTH-BOOTSTRAPPER] getToken response received"),[3,8];case 7:this.Ea.ULS.sendTraceTag(508934362,r.W.Kt,s.G.Info,"[AUTH-BOOTSTRAPPER] Unsupported Message ID, ".concat(n.MessageId)),t.label=8;case 8:return[3,10];case 9:return a=t.sent(),this.Ea.ULS.sendTraceTag(508934361,r.W.Kt,s.G.Error,"[AUTH-BOOTSTRAPPER] Caught error trying to process PostMessage, ".concat(n.MessageId,": ").concat((0,In.nU)(a))),[3,10];case 10:return[2]}}))}))},this.Ea=null!=n?n:this.createLogger(e),this.Pa={},this.Na=this.storePromiseWrapper("scriptLoaded");var o="".concat(this.getAuthUrlForEnvironment(e),"?replyUrl=&webworker=1&standalone=1&usid=").concat(this.Ea.getUserSessionId());if(this.Ta=document.createElement("iframe"),this.Da=new URL(o).origin,this.Ta.src=o,this.Ta.style.cssText="height:0; width:0; display:none;",window.addEventListener("message",this.receiveMessage),this.ka=performance.now(),document.body.appendChild(this.Ta),!this.Ta.contentWindow)throw this.Ea.ULS.sendTraceTag(508934363,r.W.Kt,s.G.Error,"[AUTH-BOOTSTRAPPER] The shared auth iframe has no contentWindow"),new Error("iframe has no contentWindow")}return e.prototype.createLogger=function(e){var n,t={remoteUlsEndpoint:this.getLogUrlForEnvironment(e),sessionId:null!==(n=In.e0.searchParams.get("usid"))&&void 0!==n?n:void 0};return(0,o.L8)(t)},e.prototype.libraryInit=function(e){return(0,t.mG)(this,void 0,void 0,(function(){var n;return(0,t.Jh)(this,(function(t){return n=this.Pa.initAuthLibrary,e.isSuccess?(n.resolve(!0),this.Ua=performance.now()-n.startTime,this.Ea.ULS.sendTraceTag(508569551,r.W.Kt,s.G.Info,"[AUTH-BOOTSTRAPPER] Auth library init succeeded, ".concat(this.Ua)),[2,e.response]):(n.reject(!1),this.Ea.ULS.sendTraceTag(508934360,r.W.Kt,s.G.Error,"[AUTH-BOOTSTRAPPER] Auth library init failed"),[2])}))}))},e.prototype.handleTokenResponse=function(e){return(0,t.mG)(this,void 0,void 0,(function(){var n;return(0,t.Jh)(this,(function(t){if(n=this.Pa.tryGetToken,e.isSuccess){if(n.resolve(!0),this.Ra=performance.now()-n.startTime,this.Ea.ULS.sendTraceTag(508569550,r.W.Kt,s.G.Info,"[AUTH-BOOTSTRAPPER] Get token time, ".concat(this.Ra)),i=window.location.href,new Array("https://www.office.com").includes(i))return[2,e.response];this.Ea.ULS.sendTraceTag(508934359,r.W.Kt,s.G.Warning,"[AUTH-BOOTSTRAPPER] Untrusted frame, cannot send token back")}else n.reject(!1),this.Ea.ULS.sendTraceTag(508934358,r.W.Kt,s.G.Error,"[AUTH-BOOTSTRAPPER] Get token failed");var i;return[2]}))}))},e.prototype.storePromiseWrapper=function(e){var n=new In.Fd;return n.startTime=performance.now(),this.Pa[e]=n,n.promise},e.prototype.getAuthUrlForEnvironment=function(e){switch(e){case"FASTFOOD":return"https://ffc-oauth.online.office.com/oa/WacOAuth.aspx";case"MSIT":return"https://ppc-oauth.online.office.com/oa/WacOAuth.aspx";case"PRODUCTION":return"https://oauth.online.office.com/oa/WacOAuth.aspx";case"GALLATIN":return"https://oauth.partner.officewebapps.cn/oa/WacOAuth.aspx";case"USGOV":return"https://gbc-oauth.online.office.com/oa/WacOauth.aspx";case"TRAILBLAZER":return"https://oauth.gov.online.office365.us/oa/WacOauth.aspx";case"PATHFINDER":return"https://oauth.dod.online.office365.us/oa/WacOAuth.aspx";case"AIRGAP08":return"https://oauth.wac.online.office.eaglex.ic.gov/oa/WacOAuth.aspx";case"AIRGAP09":return"https://oauth.wac.online.office.microsoft.scloud/oa/WacOAuth.aspx"}},e.prototype.getLogUrlForEnvironment=function(e){switch(e){case"FASTFOOD":return"https://ffc-oauth.online.office.com/oa/RemoteUls.ashx";case"MSIT":return"https://ppc-oauth.online.office.com/oa/RemoteUls.ashx";case"PRODUCTION":return"https://oauth.online.office.com/oa/RemoteUls.ashx";case"GALLATIN":return"https://oauth.partner.officewebapps.cn/oa/RemoteUls.ashx";case"USGOV":return"https://gbc-oauth.online.office.com/oa/RemoteUls.ashx";case"TRAILBLAZER":return"https://oauth.gov.online.office365.us/oa/RemoteUls.ashx";case"PATHFINDER":return"https://oauth.dod.online.office365.us/oa/RemoteUls.ashx";case"AIRGAP08":return"https://oauth.wac.online.office.eaglex.ic.gov/oa/RemoteUls.ashx";case"AIRGAP09":return"https://oauth.wac.online.office.microsoft.scloud/oa/RemoteUls.ashx"}},e}(),Cn=a(4084);function Un(e){var n,i,o,r,a,u,s,c,l,d,f,v,h,p,m,S,H,b,g,I,A,C,U,R,y,N,T,E,F,D,k,P,O,x,K,W;return{documentIdentifier:e.documentIdentifier,sessionConfig:{hostCorrelationId:e.sessionConfig.hostCorrelationId,isMsa:e.sessionConfig.isMsa,tenantId:e.sessionConfig.tenantId,organizationName:e.sessionConfig.organizationName,sessionId:e.sessionConfig.sessionId,isESSEnabled:e.sessionConfig.isESSEnabled,experiments:e.sessionConfig.experiments,highContrastMode:e.sessionConfig.highContrastMode,additionalApplicationParameters:e.sessionConfig.additionalApplicationParameters,bootDiagnostics:{tabsCacheHit:null===(n=e.sessionConfig.bootDiagnostics)||void 0===n?void 0:n.tabsCacheHit,packageEntryTime:null===(i=e.sessionConfig.bootDiagnostics)||void 0===i?void 0:i.packageEntryTime,isTestMode:null===(o=e.sessionConfig.bootDiagnostics)||void 0===o?void 0:o.isTestMode,isManifestCachingEnabled:null===(r=e.sessionConfig.bootDiagnostics)||void 0===r?void 0:r.isManifestCachingEnabled,isOwlBootstrapperEnabled:null===(a=e.sessionConfig.bootDiagnostics)||void 0===a?void 0:a.isOwlBootstrapperEnabled,isPrebooted:null===(u=e.sessionConfig.bootDiagnostics)||void 0===u?void 0:u.isPrebooted,isVroom21:null===(s=e.sessionConfig.bootDiagnostics)||void 0===s?void 0:s.isVroom21,ringId:null===(c=e.sessionConfig.bootDiagnostics)||void 0===c?void 0:c.ringId,teamsContextStartTime:null===(l=e.sessionConfig.bootDiagnostics)||void 0===l?void 0:l.teamsContextStartTime,teamsContextEndTime:null===(d=e.sessionConfig.bootDiagnostics)||void 0===d?void 0:d.teamsContextEndTime,wopiDataStartTime:null===(f=e.sessionConfig.bootDiagnostics)||void 0===f?void 0:f.wopiDataStartTime,wopiDataEndTime:null===(v=e.sessionConfig.bootDiagnostics)||void 0===v?void 0:v.wopiDataEndTime,bootStrapStartTime:null===(h=e.sessionConfig.bootDiagnostics)||void 0===h?void 0:h.bootStrapStartTime,bootStrapEndTime:null===(p=e.sessionConfig.bootDiagnostics)||void 0===p?void 0:p.bootStrapEndTime,driveItemStartTime:null===(m=e.sessionConfig.bootDiagnostics)||void 0===m?void 0:m.driveItemStartTime,driveItemEndTime:null===(S=e.sessionConfig.bootDiagnostics)||void 0===S?void 0:S.driveItemEndTime,driveItemFromWacStartTime:null===(H=e.sessionConfig.bootDiagnostics)||void 0===H?void 0:H.driveItemFromWacStartTime,driveItemFromWacEndTime:null===(b=e.sessionConfig.bootDiagnostics)||void 0===b?void 0:b.driveItemFromWacEndTime,accessTokenStartTime:null===(g=e.sessionConfig.bootDiagnostics)||void 0===g?void 0:g.accessTokenStartTime,accessTokenEndTime:null===(I=e.sessionConfig.bootDiagnostics)||void 0===I?void 0:I.accessTokenEndTime,fetchWacAndSpoTokenStartTime:null===(A=e.sessionConfig.bootDiagnostics)||void 0===A?void 0:A.fetchWacAndSpoTokenStartTime,fetchWacAndSpoTokenEndTime:null===(C=e.sessionConfig.bootDiagnostics)||void 0===C?void 0:C.fetchWacAndSpoTokenEndTime,isCookieBlocked:null===(U=e.sessionConfig.bootDiagnostics)||void 0===U?void 0:U.isCookieBlocked,meetingLiveDiagnostics:null===(R=e.sessionConfig.bootDiagnostics)||void 0===R?void 0:R.meetingLiveDiagnostics,spRequestGuid:null===(y=e.sessionConfig.bootDiagnostics)||void 0===y?void 0:y.spRequestGuid,createNewStartTime:null===(N=e.sessionConfig.bootDiagnostics)||void 0===N?void 0:N.createNewStartTime,createNewEndTime:null===(T=e.sessionConfig.bootDiagnostics)||void 0===T?void 0:T.createNewEndTime,loadManifestStartTime:null===(E=e.sessionConfig.bootDiagnostics)||void 0===E?void 0:E.loadManifestStartTime,loadManifestEndTime:null===(F=e.sessionConfig.bootDiagnostics)||void 0===F?void 0:F.loadManifestEndTime,loadOwlStartTime:null===(D=e.sessionConfig.bootDiagnostics)||void 0===D?void 0:D.loadOwlStartTime,loadOwlEndTime:null===(k=e.sessionConfig.bootDiagnostics)||void 0===k?void 0:k.loadOwlEndTime,owlBootstrapperStartTime:null===(P=e.sessionConfig.bootDiagnostics)||void 0===P?void 0:P.owlBootstrapperStartTime,owlBootstrapperEndTime:null===(O=e.sessionConfig.bootDiagnostics)||void 0===O?void 0:O.owlBootstrapperEndTime,isOdcMigrated:null===(x=e.sessionConfig.bootDiagnostics)||void 0===x?void 0:x.isOdcMigrated,perfNavigationTiming:(0,w.pb)()},uiHostTabId:e.sessionConfig.uiHostTabId,upn:e.sessionConfig.upn,meeting:e.sessionConfig.meeting,customAuthConfigValue:e.sessionConfig.customAuthConfigValue,wiseEnvironment:e.sessionConfig.wiseEnvironment,isSynthetic:e.sessionConfig.isSynthetic,hostUrl:e.sessionConfig.hostUrl,owlVersion:e.sessionConfig.owlVersion,owlRollout:e.sessionConfig.owlRollout,fileType:e.sessionConfig.fileType,clickTime:e.sessionConfig.clickTime,uiCulture:e.sessionConfig.uiCulture,dataCulture:e.sessionConfig.dataCulture,puid:e.sessionConfig.puid,isNewFile:e.sessionConfig.isNewFile,wdValue:e.sessionConfig.wdValue,sessionOrigin:e.sessionConfig.sessionOrigin,intent:e.sessionConfig.intent,hostClientType:e.sessionConfig.hostClientType,isPopOut:e.sessionConfig.isPopOut,teamType:e.sessionConfig.teamType,initPackageParams:e.sessionConfig.initPackageParams&&(0,t.pi)((0,t.pi)({},e.sessionConfig.initPackageParams),{jsApiUrlInfos:(null===(K=e.sessionConfig.initPackageParams)||void 0===K?void 0:K.jsApiUrlInfos)&&qn(null===(W=e.sessionConfig.initPackageParams)||void 0===W?void 0:W.jsApiUrlInfos)})},uiHostConfig:(0,t.pi)((0,t.pi)({},e.uiHostConfig),{featureGates:e.uiHostConfig.featureGates&&qn(e.uiHostConfig.featureGates)})}}function Rn(e){var n,i,o,r,a,u;return(0,t.mG)(this,void 0,void 0,(function(){var s,c,l,d,f,v,h;return(0,t.Jh)(this,(function(p){switch(p.label){case 0:return null===(o=null===(i=null===(n=e.sharingLinkTokenProvider)||void 0===n?void 0:n.TokenPromise)||void 0===i?void 0:i.then)||void 0===o||o.call(i,(function(e){s=e})).catch((function(e){c=e})).finally((function(){return null==ji?void 0:ji.sendMessage({id:P.SharingLinkTokenProvider,data:{token:s,error:c}})})),v={documentBootInfo:e.documentBootInfo},l=[(0,t.pi)({},e.sessionConfig)],h={},"string"!=typeof e.sessionConfig.customAuthConfigValue?[3,1]:(d=e.sessionConfig.customAuthConfigValue,[3,3]);case 1:return[4,e.sessionConfig.customAuthConfigValue];case 2:d=p.sent(),p.label=3;case 3:return h.customAuthConfigValue=d,"string"!=typeof e.sessionConfig.hostUrl?[3,4]:(f=e.sessionConfig.hostUrl,[3,6]);case 4:return[4,e.sessionConfig.hostUrl];case 5:f=p.sent(),p.label=6;case 6:return[2,(v.sessionConfig=t.pi.apply(void 0,l.concat([(h.hostUrl=f,h.bootDiagnostics=(0,t.pi)((0,t.pi)({},e.sessionConfig.bootDiagnostics),{perfNavigationTiming:(0,w.pb)()}),h.logger=void 0,h.health=void 0,h)])),v.uiHostConfig=(0,t.pi)((0,t.pi)({},e.uiHostConfig),{featureGates:(null===(r=e.uiHostConfig)||void 0===r?void 0:r.featureGates)&&qn(e.uiHostConfig.featureGates)}),v.additionalApplicationParameters=e.additionalApplicationParameters,v.sharingLinkTokenProvider=!!e.sharingLinkTokenProvider,v.initPackageParams=e.initPackageParams&&(0,t.pi)((0,t.pi)({},e.initPackageParams),{jsApiUrlInfos:(null===(a=e.initPackageParams)||void 0===a?void 0:a.jsApiUrlInfos)&&qn(null===(u=e.initPackageParams)||void 0===u?void 0:u.jsApiUrlInfos)}),v)]}}))}))}function yn(e,n){yi(S.OwlOnBootComplete),null==Gi||Gi.sendMessage({id:k.BootComplete,data:{docInfo:e,wacBootDiagnostics:n}}),function(){var e=g(),n=e.bootTelemetryData,t=e.owlTelemetryData;null==Gi||Gi.sendMessage({id:k.TelemetryData,data:{bootTelemetryData:n,owlTelemetryData:t}})}()}function Nn(e,n){null==Gi||Gi.sendMessage({id:k.BootFailure,data:{errorInfo:e,docInfo:n}})}function Tn(e){null==Gi||Gi.sendMessage({id:k.ReturnFocus,data:{navigateForward:e}})}function En(){null==Gi||Gi.sendMessage({id:k.DocumentClose,data:{}})}function Fn(){null==Gi||Gi.sendMessage({id:k.SuccessNotification,data:{}})}function Dn(e,n){null==Gi||Gi.sendMessage({id:k.OpenInMobileApp,data:{openInAppUrl:e,storeUrl:n}})}function kn(e,n,i,o){return(0,t.mG)(this,void 0,void 0,(function(){return(0,t.Jh)(this,(function(t){return[2,_i.getMessagePromise(P.FetchItemFromNetworkResponse,{id:k.FetchItemFromNetwork,data:{docBootInfo:e,forceRefresh:n,zeroByte:i}})]}))}))}function Pn(e,n,i,o,r,a,u){return(0,t.mG)(this,void 0,void 0,(function(){return(0,t.Jh)(this,(function(t){return[2,_i.getMessagePromise(P.FetchAccessTokenResponse,{id:k.FetchAccessToken,data:{tokenConsumer:e,forceFetch:n,resourceUrl:i,scope:o,isBoot:r,claims:a,silent:u}})]}))}))}function On(e,n){return(0,t.mG)(this,void 0,void 0,(function(){return(0,t.Jh)(this,(function(t){return[2,_i.getMessagePromise(P.OpenShareControlResponse,{id:k.OpenShareControl,data:{shareProps:e,isShareDialogueZoomEnabled:n}})]}))}))}function xn(e,n){return(0,t.mG)(this,void 0,void 0,(function(){return(0,t.Jh)(this,(function(t){return[2,_i.getMessagePromise(P.CreateDocumentResponse,{id:k.CreateDocument,data:{createNewInfo:e,template:n}})]}))}))}function Kn(e){null==Gi||Gi.sendMessage({id:k.SetTitle,data:{title:e}})}function Wn(){null==Gi||Gi.sendMessage({id:k.UserActivity,data:{}})}function Mn(){var e=document.createElement("div");return e.id="owl-container",e}function jn(e){null==Gi||Gi.sendMessage({id:k.UserActivity,data:e})}function Gn(e){null==Gi||Gi.sendMessage({id:k.UserAccess,data:e})}function _n(e){null==Gi||Gi.sendMessage({id:k.MoveToFolder,data:e})}function Ln(e){null==Gi||Gi.sendMessage({id:k.SharedFilePicker,data:e})}function Bn(e){null==Gi||Gi.sendMessage({id:k.Rename,data:{newName:e}})}function Jn(e){null==Gi||Gi.sendMessage({id:k.FrameChange,data:e})}function Vn(){null==Gi||Gi.sendMessage({id:k.FileEmbed,data:{}})}function qn(e){return JSON.stringify(Array.from(e.entries()))}function zn(e){if(e)try{return new Map(JSON.parse(e))}catch(e){return}}function Zn(e){switch(e){case"ring0":case"ring1":case"ring2":return"FASTFOOD";case"ring3_9":return"MSIT";case"general_gcc":return"USGOV";case"gcchigh":return"TRAILBLAZER";case"dod":return"PATHFINDER";case"ag08":return"AIRGAP08";case"ag09":return"AIRGAP09";case"gallatin":return"GALLATIN";default:return"PRODUCTION"}}var Qn="PrebootDocument",Xn="owlfc";function Yn(e,n,t){var i=Date.now(),a=(0,o.L8)(),u=(0,Le.q_)(e);if(u)if(Ie){var c=Ie.getItem(u);if(c)null==a||a.ULS.sendTraceTag(545036514,r.W.Lt,s.G.Verbose,"prebootDocument: Session is already prebooted with sessionid: "+c);else{var l=(0,x.n)()[0];Ie.setItem(u,l);var d=new w.zP(l,e.fileType,t).health;null==d||d.updatePartADimensions({applicationLcid:e.uiCulture,loggableUserId:e.puid,sessionOrigin:e.wdOrigin}),null==d||d.addOrUpdatePartCDimension("IsNewFile",(!!e.isNewFile).toString());var f=new Map;f.set("StartTime",(new Date).toUTCString()),null==d||d.recordKpiUsage(Qn,Cn.o.FailureBased,Xn,f),f.delete("StartTime"),(0,_e.o)(e,n,a).then((function(e){null==a||a.ULS.sendTraceTag(558158863,r.W.Lt,s.G.Info,"prebootDocument: Attempting to preboot document with sessionid: "+l),function(e,n){var t;if(!e||!n)return!1;var i="access_token="+encodeURIComponent(n.wac.accessToken)+"&access_token_ttl="+encodeURIComponent(n.wac.accessTokenExpiry)+"&bundleSrc="+encodeURIComponent(null!==(t=n.bundleUrl)&&void 0!==t?t:"")+"&user_id="+encodeURIComponent(n.wac.userId),o=function(e){if(!e)return null;var n=(0,ge.k$)(e);if(!n)return null;var t=n.path.substring(0,n.path.lastIndexOf("/"))+"/preboot.ashx";return n.protocol+"//"+n.hostname+t}(n.wac.applicationUrl);if(!o)return!1;var r=encodeURIComponent(n.wac.wopiSrc),a=Ce(),u=new XMLHttpRequest;return u.open("POST",o+"?op=preboot&usid="+encodeURI(e)+"&wopisrc="+r+"&sc="+a),u.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),u.send(i),!0}(l,e.wopiHostData)?a.ULS.sendTraceTag(558158864,r.W.Lt,s.G.Info,"prebootDocument: Preboot request sent successfully with sessionid: "+l):(null==Ie||Ie.removeItem(u),a.ULS.sendTraceTag(545036515,r.W.Lt,s.G.Info,"prebootDocument: Preboot request cannot be made with sessionid: "+l),f.set("FailureTime",(new Date).toUTCString()),null==d||d.recordKpiFailure(Qn,"PrebootRequestFailed",!1,!0,{durationMs:Date.now()-i,extendedProperties:f}))})).catch((function(e){a.ULS.sendTraceTag(558158865,r.W.Lt,s.G.Warning,"prebootDocument: Failed to send Preboot request with WacDocumentVroomError:"+JSON.stringify(e)),f.set("DriveItemError",JSON.stringify(e)),f.set("FailureTime",(new Date).toUTCString()),null==d||d.recordKpiFailure(Qn,"PrebootDriveItemRequestFailed",!1,!1,{durationMs:Date.now()-i,extendedProperties:f}),null==Ie||Ie.removeItem(u)}))}}else null==a||a.ULS.sendTraceTag(527471828,r.W.Lt,s.G.Warning,"prebootDocument: 3rd Party Cookie is blocked! Cannot perform preboot. Bail out.");else null==a||a.ULS.sendTraceTag(558158862,r.W.Lt,s.G.Verbose,"prebootDocument: Not enough document information was provided. Cannot get unique identifier.")}function $n(e,n,t){Yn(e,n,Zn(t))}function et(e){var n=(0,Le.q_)(e);return n&&Ie?Ie.getItem(n):null}function nt(e,n){if(n){var t=(0,Le.q_)(e);if(t)return null==Ie||Ie.removeItem(t),!0}return!1}var tt=["id","openWith","officebundle","currentUserRole","eTag","name","size","content.downloadUrl","file","sharepointIds","sensitivityLabel","webUrl","webDavUrl","parentReference"];function it(e,n,t,i,o,r,a,u,s,c,l,d,f,v,h,p){var m=new w.zP(e,t,n,s,u,c).health;return null==m||m.addQosPillar("Open"),null==m||m.updatePartADimensions({applicationLcid:i,loggableUserId:o,tenantId:r,uiHost:l,uiHostIntegrationType:d,sessionOrigin:f}),null==m||m.addOrUpdatePartCDimension("HostCorrelationId",a),null==m||m.addOrUpdatePartCDimension("AppSessionId",e),null==m||m.addOrUpdatePartCDimension("HostRingId",null!=v?v:"n/a"),null==m||m.addOrUpdatePartCDimension("IsNewFile",(!!h).toString()),null==m||m.addOrUpdatePartCDimension("isOdcMigrated",(!!p).toString()),null==m||m.addOrUpdatePartCDimension("IsTestMode",window.location.pathname.endsWith("/test").toString()),m}var ot,rt=a(6130),at=a(1380),ut=a(8425);function st(e,n,i,o,a){var u=this;void 0===i&&(i=!1),be.c.driveItemStartTime=Date.now(),(0,we.p)()&&window.performance.mark("driveItemStartTime"),ot||(ot=new Map);var c=ot.get(e);if(!i&&c&&c.promise&&(!c.expiryTime||c.expiryTime>new Date))return be.c.driveItemEndTime=Date.now(),(0,we.p)()&&window.performance.mark("driveItemEndTime"),null==o||o.ULS.sendTraceTag(553726288,r.W.Lt,s.G.Info,"GetDriveItem: Returning drive item from the cache"),c.promise;null==o||o.ULS.sendTraceTag(553726289,r.W.Lt,s.G.Info,"GetDriveItem: Invalidating the cache"),ot.delete(e),null==o||o.ULS.sendTraceTag(546182045,r.W.Lt,s.G.Info,"GetDriveItem: About to make the fetch call to get drive item");var d=e,f={method:at.hx.Get,headers:n.headers};if((0,l.dt)(l.Fh.FeatureGate_BypassOPTIONSCall,a,o),a){d=e.concat("&ump=1");var v=function(e){var n=(0,ut.c)(),i=[];return i.push("--".concat(n)),void 0!==e&&Object.entries(e).forEach((function(e){var n=(0,t.CR)(e,2),o=n[0],r=n[1];void 0!==r&&i.push("".concat(o,": ").concat(r))})),i.push("X-HTTP-Method-Override: GET"),i.push("\r\n--".concat(n,"--")),{body:i.join("\r\n"),headers:{"Content-Type":"multipart/form-data;boundary=".concat(n)}}}(n.headers),h=v.body,p=v.headers;f={method:at.hx.Post,headers:p,body:h},null==o||o.ULS.sendTraceTag(508961629,r.W.Lt,s.G.Info,"GetDriveItem: POST request to get drive item: content-length : ".concat(h.length))}var m=fetch(d,f).catch((function(e){return Promise.reject({api:"getItem",failure:e,message:"Fetch call failed",retry:!0})})).then((function(n){return(0,t.mG)(u,void 0,void 0,(function(){var i,a,u,c,l,d,f,v,h,p;return(0,t.Jh)(this,(function(S){switch(S.label){case 0:if(200===n.status)return i=n.json().then((function(e){return e||Promise.reject({api:"getItem",status:n.status,message:"Ok httpStatus, invalid response"})})),a=new Map,c=null===(l=null==n?void 0:n.headers)||void 0===l?void 0:l.get("SPRequestGuid"),be.c.spRequestGuid=null!=c?c:void 0,a.set("SPRequestGuid",c),null==o||o.ULS.sendTraceTag(554964099,r.W.Lt,s.G.Info,"GetDriveItem:  [VroomResponseHeaders: ".concat(JSON.stringify(a),"]")),ot.set(e,{promise:m,expiryTime:(H=new Date,new Date(H.getFullYear(),H.getMonth(),H.getDate(),H.getHours()+24,H.getMinutes(),H.getSeconds(),H.getMilliseconds()))}),[2,i];S.label=1;case 1:return S.trys.push([1,3,,4]),[4,n.json()];case 2:return u=S.sent(),c=null===(d=null==n?void 0:n.headers)||void 0===d?void 0:d.get("SPRequestGuid"),be.c.spRequestGuid=null!=c?c:void 0,[2,Promise.reject((0,t.pi)({api:"getItem",SPRequestGuid:c,status:n.status,errorCode:null===(f=null==u?void 0:u.error)||void 0===f?void 0:f.code,innerErrorCode:null===(h=null===(v=null==u?void 0:u.error)||void 0===v?void 0:v.innerError)||void 0===h?void 0:h.code,message:null===(p=null==u?void 0:u.error)||void 0===p?void 0:p.message,redirectLocation:(null==u?void 0:u.error)?null==u?void 0:u.error["@error.redirectLocation"]:void 0},ct(n)))];case 3:return S.sent(),[2,Promise.reject({api:"getItem",status:n.status,message:"request failed, could not retrieve error object."})];case 4:return[2]}var H}))}))})).finally((function(){be.c.driveItemEndTime=Date.now(),(0,we.p)()&&window.performance.mark("driveItemEndTime")}));return m}function ct(e){var n,i,o,r=null===(o=null==e?void 0:e.headers)||void 0===o?void 0:o.get("www-authenticate"),a=void 0,u=void 0;if(r){var s=r.split(",");if(s)try{for(var c=(0,t.XA)(s),l=c.next();!l.done;l=c.next()){var d=l.value,f=d&&d.trim();f&&f.startsWith("error=")?a=f.split('"')[1]:f&&f.startsWith("claims=")&&(u=[f.split('"')[1]])}}catch(e){n={error:e}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}}return{claimsError:a,claims:u}}var lt=a(1171);function dt(e){if(e&&e.length){if(e.match(ge.pK)||e.match(ge.XU))return"OneDrive";if(e.match(ge.VJ))return"SharePoint";if(e.match(ge.JK))return"Graph"}}var ft=function(e){return"action=".concat(e)},vt=function(e){return(null==e?void 0:e.isESSEnabled)&&(null==e?void 0:e.wacDataCenter)?[ht(null==e?void 0:e.wacDataCenter),pt(null==e?void 0:e.sessionId),mt(null==e?void 0:e.hostCorrelationId)]:[]},ht=function(e){return e?"WacDataCenter=".concat(e):void 0},pt=function(e){return e?"usid=".concat(e):void 0},mt=function(e){return e?"hid=".concat(e):void 0},St=function(e){return e&&e.length?"$select="+e.join(","):void 0};function Ht(e){return(0,lt.sm)(e,{accept:"application/json",prefer:"allow-zerobyte"})}function wt(e,n,i,o,a,u,c,d,f){return void 0===a&&(a=!1),void 0===f&&(f=Ht),(0,t.mG)(this,void 0,void 0,(function(){var v;return(0,t.Jh)(this,(function(h){return e?((0,l.dt)(l.Fh.FeatureGate_FetchWacAndSpoTokenGate,c,u),c?(be.c.fetchWacAndSpoTokenStartTime=Date.now(),(0,we.p)()&&window.performance.mark("fetchWacAndSpoTokenStartTime"),v=function(e,n,i,o){return(0,t.mG)(this,void 0,void 0,(function(){var r;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return r=e(n,o,i,void 0,!0),[4,e("None",o,"e03a13ee-9730-4cae-8525-47559c8cf18a",void 0,!0)];case 1:return t.sent(),[2,r]}}))}))}(n,i,o,a),be.c.fetchWacAndSpoTokenEndTime=Date.now(),(0,we.p)()&&window.performance.mark("fetchWacAndSpoTokenEndTime")):v=n(i,a,o,void 0,!0),[2,v.then(f).then((function(n){return st(e,{headers:n},a,u,d)})).catch((function(t){return null==u||u.ULS.sendTraceTag(512255580,r.W.Lt,s.G.Warning,"GetDriveItemWithUrl: error when trying to getDriveItem: ".concat(t)),t&&401===t.status&&"insufficient_claims"===t.claimsError&&"authChallengeRequired"===t.innerErrorCode&&t.claims?(null==u||u.ULS.sendTraceTag(523076960,r.W.Lt,s.G.Warning,"GetDriveItemWithUrl: vroom call failed with claims challenge. Retry with claims"),n(i,a,o,void 0,!0,t.claims).then(f).then((function(n){return st(e,{headers:n},a,u,d)}))):Promise.reject(t)}))]):[2,Promise.reject("No api endpoint given")]}))}))}function bt(e){var n={accept:"application/json",prefer:"redeemSharingLink,allow-zerobyte,manualRedirect"};return(0,lt.sm)(e,n),n}var gt,It,At=function(e){return e?"expand=thumbnails":""};function Ct(e,n,i,o,a,u,c,l,d,f){void 0===o&&(o=!1),void 0===a&&(a="open"),void 0===u&&(u=!1);var v=i.inMockMode,h=i.getAccessToken,p=function(e,n){try{null==n||n.ULS.sendTraceTag(541870043,r.W.Lt,s.G.Info,"getSharesUrl: Start constructing shares Url");for(var t=e.replace(/[,@+$#]/g,(function(e){return encodeURIComponent(e)})),i=window.btoa((u=encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,(function(e,n){return String.fromCharCode(parseInt(n,16))})),c=void 0,(c=u)&&(c=c.replace(/#/g,"%23")),c)),o=i.length-1;"="===i.charAt(o);)--o;var a=i.slice(0,o+1).replace(/\+/g,"-").replace(/\//g,"_");return"shares/u!".concat(a,"/driveItem")}catch(e){return void(null==n||n.ULS.sendTraceTag(541872152,r.W.Lt,s.G.Error,"getSharesUrl: Failed to get Share Url. ".concat(e)))}var u,c}(e,c);if(!p)return Promise.reject("No shareUrl");var m=function(e,n,t){var i,o=n.isConsumer,a=n.oneDriveResourceId,u=new URL(e);if(u&&u.protocol&&u.host){var c=o?a:"".concat(u.protocol,"//").concat(u.host),l=o?function(e){return e.inMockMode?e.officeHomeApiRoot:e.oneDriveConsumerApi}(n):function(e,n,t,i){void 0===t&&(t=!1),void 0===i&&(i=!1);var o=n.inMockMode?n.officeHomeApiRoot:e;return"".concat(o,t?"/_api":i?"/_api/v2.1":"/_api/v2.0")}(c||"",n),d=o?"OneDrive":null!==(i=dt(c||""))&&void 0!==i?i:"None";if(c&&l&&d)return{baseUrl:l,tokenType:d,resourceUrl:c,hostname:u.hostname};null==t||t.ULS.sendTraceTag(542492316,r.W.Lt,s.G.Error,"GetApiInfo failed. [InvalidResourceUrl: ".concat(!c,"][InvalidBaseUrl: ").concat(!l,"][InvalidTokenType: ").concat(!d,"]"))}else null==t||t.ULS.sendTraceTag(542492315,r.W.Lt,s.G.Error,"GetApiInfo failed. [InvalidParsedUrl: ".concat(!u,"][InvalidProtocol: ").concat(!(null==u?void 0:u.protocol),"][Invalidhost: ").concat(!(null==u?void 0:u.host),"]"))}(e,i,c);if(!m)return Promise.reject("No apiInfo");var S=new Date;S.setSeconds(0,0);var H=(0,t.ev)([St(n),ft(a),At(u)],(0,t.CR)(vt(l)),!1).filter((function(e){return!!e})).join("&"),w=v?"shares?itemUrl=".concat(encodeURIComponent(p),"&currentDate=").concat(S.toISOString()):"".concat(p,"?").concat(H);return wt("".concat(m.baseUrl,"/").concat(w),h,m.tokenType,m.resourceUrl,o,c,d,f,bt)}function Ut(e){if(!e)return null;var n=new URL(e);return n.protocol+"//"+n.host}function Rt(e,n,i,o,a,u,l,d,f,v){var h;void 0===o&&(o=!1),void 0===a&&(a="open");var p=e.driveId,m=e.docId,S=e.baseUrl,H=e.docUrl;if(!p||!m)return Promise.reject("Not enough document information was given to retrieve the item");var w,b,g=(0,t.ev)([St(n),ft(a)],(0,t.CR)(vt(d)),!1).filter((function(e){return!!e})).join("&"),I=Ut(null!=S?S:H);I?(b=I,w="".concat(S||I,"/_api/v2.0"),null==l||l.ULS.sendTraceTag(543958855,r.W.Lt,s.G.Info,"making vroom service call with driveId+docId")):(b=(0,c.A8)(u),w="".concat(b,"/v1.0"),null==l||l.ULS.sendTraceTag(543958856,r.W.Lt,s.G.Info,"making graph service call with driveId+docId"));var A="".concat(w,"/drives/").concat(encodeURIComponent(p),"/items/").concat(encodeURIComponent(m),"/?").concat(g),C=null!==(h=dt(b))&&void 0!==h?h:"None";return wt(A,i.getAccessToken,C,b,o,l,f,v)}function yt(e){var n={accept:"application/json",prefer:"allow-zerobyte,manualRedirect"};return(0,lt.sm)(e,n),n}function Nt(e,n,i,o,r,a,u,s,c,d,f){var v;if(void 0===r&&(r=!1),void 0===a&&(a="open"),!e||!n)return Promise.reject("Not enough document information was given to retrieve the item");var h,p=new URL(n),m="".concat(p.protocol,"//").concat(p.host),S=(0,t.ev)([St(i),ft(a)],(0,t.CR)(vt(s)),!1).filter((function(e){return!!e})).join("&");(0,l.dt)(l.Fh.FeatureGate_Vroom21SupportGate,c,u),be.c.isVroom21=c,h=c?"".concat(n,"/_api/v2.1/sites/root/items/").concat(encodeURIComponent(e),"/driveItem?").concat(S):"".concat(n,"/_api/v2.0/sites/root/items/").concat(encodeURIComponent(e),"/driveItem?").concat(S);var H=null!==(v=dt(n))&&void 0!==v?v:"None";return wt(h,o.getAccessToken,H,m,r,u,d,f,yt)}var Tt,Et="getItemFromWac",Ft="x-behind-service-response-status",Dt="GetDriveItem",kt=new Map,Pt="owlfc";function Ot(e,n,i){return(0,t.mG)(this,void 0,void 0,(function(){var o;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:gt=Date.now(),kt.set("StartTime",gt.toString()),i||null==n||n.ULS.sendTraceTag(526951836,r.W.Lt,s.G.Info,"GetDriveItem: Health object not initialized"),null==i||i.recordKpiUsage(Dt,Cn.o.FailureBased,Pt,kt),kt.delete("StartTime"),be.c.driveItemFromWacStartTime=Date.now(),(0,we.p)()&&window.performance.mark("driveItemFromWacStartTime"),t.label=1;case 1:return t.trys.push([1,3,4,5]),null==n||n.ULS.sendTraceTag(523867683,r.W.Lt,s.G.Info,"GetDriveItem: About to make the fetch call to get drive item"),[4,fetch(e.url,{method:e.method,headers:e.headers,body:JSON.stringify(e.body)})];case 2:return[2,xt(t.sent(),n,i)];case 3:return o=t.sent(),It=Date.now(),kt.set("DriveItemError",JSON.stringify(o)),kt.set("FailureTime",It.toString()),null==i||i.recordKpiFailure(Dt,"GetDriveItemRequestFailed",!1,!1,{durationMs:It-gt,extendedProperties:kt}),[2,Promise.reject({api:Et,failure:o,message:"Fetch vroom response from wac call failed"})];case 4:return be.c.driveItemFromWacEndTime=Date.now(),(0,we.p)()&&window.performance.mark("driveItemFromWacEndTime"),[7];case 5:return[2]}}))}))}function xt(e,n,i){var o,r,a;return(0,t.mG)(this,void 0,void 0,(function(){var u,s;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:if(e.status===Ve.W.OK)return[2,Kt(e,n)];It=Date.now(),kt.set("FailureTime",It.toString()),null==i||i.recordKpiFailure(Dt,"WacHootServiceNotAvailable",!1,!0,{durationMs:It-gt,extendedProperties:kt}),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,e.json()];case 2:return u=t.sent(),s=null===(o=null==e?void 0:e.headers)||void 0===o?void 0:o.get("SPRequestGuid"),be.c.spRequestGuid=null!=s?s:void 0,[2,Promise.reject({api:Et,SPRequestGuid:s,status:e.status,errorCode:null===(r=null==u?void 0:u.error)||void 0===r?void 0:r.code,message:null===(a=null==u?void 0:u.error)||void 0===a?void 0:a.message})];case 3:return t.sent(),[2,Promise.reject({api:Et,status:e.status,message:"Request to wac failed, could not reach out wac for retrieving object."})];case 4:return[2]}}))}))}function Kt(e,n){var i,o,a=null===(i=null==e?void 0:e.headers)||void 0===i?void 0:i.get(Ft),u=a?parseInt(a,10):Ve.W.InternalServiceError,c=new Map,l=null===(o=null==e?void 0:e.headers)||void 0===o?void 0:o.get("SPRequestGuid");return be.c.spRequestGuid=null!=l?l:void 0,c.set("SPRequestGuid",l),null==n||n.ULS.sendTraceTag(526951837,r.W.Lt,s.G.Info,"GetDriveItemFromWac: [VroomResponseHeaders: ".concat(JSON.stringify(c),"]. The http response status code from downstream service to wac: ").concat(u.toString())),u===Ve.W.OK?e.json().then((function(n){return n||Promise.reject({api:Et,SPRequestGuid:l,status:e.status,message:"Ok httpStatus, invalid response"})})):Promise.reject((0,t.pi)({api:Et,SPRequestGuid:l,status:e.status,sharePointCallStatus:u,message:"Request to wac succeed, wac failed to retrieve object in downstream service."},ct(e)))}var Wt,Mt,jt,Gt,_t,Lt,Bt,Jt,Vt,qt,zt,Zt,Qt,Xt,Yt,$t="e03a13ee-9730-4cae-8525-47559c8cf18a",ei="getItemFromWac";function ni(e,n,i,o,r){var a={Authorization:(0,lt.sm)(o).Authorization,SessionId:i,SharePointToken:(0,lt.sm)(r).Authorization},u=(0,t.pi)((0,t.pi)({},n),{optionsHttpRequestHeaders:a});return{url:Tt,method:at.hx.Post,headers:e,body:u}}function ti(e,n){if(e&&e.KMSI){var t={token:n,expiryTime:e.wacTokenExpTime};null==Ie||Ie.setItem($t,JSON.stringify(t))}}function ii(e,n){if(e)try{return JSON.parse(e.graphDriveItem)}catch(e){null==n||n.ULS.sendTraceTag(520439698,r.W.Lt,s.G.Error,"GetDriveItemFromWacWithUrl: Failed to parse vroom response from string to JSON. [Error: ".concat(JSON.stringify(e),"]"))}return Promise.reject({api:ei,message:"Failed to parse response data from string to JSON due to invalid data or format"})}function oi(e,n,t,i){var o,r,a,u=Ut(null!==(r=null!==(o=n.shareUrl)&&void 0!==o?o:n.baseUrl)&&void 0!==r?r:n.docUrl);!u&&n.driveId&&n.docId&&(u=(0,c.A8)(t));var s=null!==(a=dt(u||""))&&void 0!==a?a:"None";return e.getAccessToken(s,!1,null!=u?u:void 0,void 0,!0,i)}var ri,ai,ui=!1,si=!1,ci=!1,li="owl-container",di="PrebootDocumentOpen",fi="owlfc";function vi(e){var n,t,i;if(!(null===(n=null==e?void 0:e.clientVersion)||void 0===n?void 0:n.trim()))throw new Error("invalid clientVersion");if(!e.exposure||e.exposure<=0||e.exposure>100)throw new Error("invalid exposure ("+(null!==(t=e.exposure)&&void 0!==t?t:"undefined")+")");e.wiseEnvironment=null===(i=e.wiseEnvironment)||void 0===i?void 0:i.toLocaleUpperCase(),zt=e}function hi(e){var n;return null!==(n=document.getElementById(li))&&void 0!==n?n:Si(e,li)}function pi(e){switch(e){case"Graph":return(0,c.A8)(Yt);case"OneDrive":return(0,c.Y6)();case"SharePoint":return(0,c.tf)();default:return""}}function mi(e){var n;if(e){var t;try{t=new URL(e)}catch(e){return}return null!==(n=new URLSearchParams(t.search).get("nav"))&&void 0!==n?n:void 0}}function Si(e,n){var t=document.createElement("div");return t.id=n,e.appendChild(t)}function Hi(e){return Wt?Wt(e):Promise.reject("endSession not defined")}function wi(e){return Mt?Mt(e):(null==Lt||Lt.ULS.sendTraceTag(555872272,r.W.Lt,s.G.Error,"hostAccessibilityLoopComplete no defined"),!1)}function bi(){if(jt)return null==Lt||Lt.ULS.sendTraceTag(508355844,r.W.Lt,s.G.Info,"Trying to get hostGetClientUrl."),void jt();null==Lt||Lt.ULS.sendTraceTag(526152082,r.W.Lt,s.G.Error,"hostGetClientUrl not defined")}function gi(){if(Gt)return null==Lt||Lt.ULS.sendTraceTag(508352272,r.W.Lt,s.G.Info,"Trying to get WebUrl"),void Gt();null==Lt||Lt.ULS.sendTraceTag(508352271,r.W.Lt,s.G.Error,"hostGetWebUrl not defined")}function Ii(e){var n,i,o,u,d=this,f=Date.now();(0,we.p)()&&window.performance.mark("packageEntryTime"),Ni(),yi(S.OwlStart);var v=e.documentIdentifier,h=e.sessionConfig,m=e.uiHostConfig,H=e.getAuthToken,b=e.eventHandlers,g=e.container;Yt=null!==(n=null==zt?void 0:zt.wiseEnvironment)&&void 0!==n?n:h.wiseEnvironment;var I=(0,t.pi)((0,t.pi)({},v),{fileType:h.fileType,wdOrigin:null!==(i=h.sessionOrigin)&&void 0!==i?i:"TEAMS.UNIFIEDUIHOST.OPEN",wdValue:h.wdValue,uiCulture:h.uiCulture,dataCulture:h.dataCulture,puid:h.puid,clickTime:h.clickTime,isNewFile:h.isNewFile,navId:mi(null!==(o=v.shareUrl)&&void 0!==o?o:v.docUrl),templateId:v.templateId,intent:null!==(u=h.intent)&&void 0!==u?u:"open"}),A=et(I),C=h.sessionId||A||(0,x.n)()[0];h.bootDiagnostics=h.bootDiagnostics||{};var U=h.bootDiagnostics.ringId;h.bootDiagnostics.packageEntryTime=h.bootDiagnostics.packageEntryTime||f,Lt=new w.G2(C,Yt).logger,h.logger=Lt;var y=C===A,T=null==h?void 0:h.isNewFile;if(h.bootDiagnostics.isPrebooted=y,function(e,n,t,i,o,r){var a,u,s,c,l=e.wiseEnvironment;e.health=null!==(a=e.health)&&void 0!==a?a:it(n,l,e.fileType,e.uiCulture,e.puid,e.tenantId,e.hostCorrelationId,null==r?void 0:r.exposure,null==r?void 0:r.clientVersion,e.isSynthetic,t.uiHostName,t.uiHostIntegrationType,e.sessionOrigin,i,o),e.hostClientType&&(null===(u=e.health)||void 0===u||u.addOrUpdatePartCDimension("HostClientType",e.hostClientType)),e.teamType&&(null===(s=e.health)||void 0===s||s.addOrUpdatePartCDimension("TeamType",e.teamType)),e.isPopOut&&(null===(c=e.health)||void 0===c||c.addOrUpdatePartCDimension("IsPopOut",(!!e.isPopOut).toString()))}(h,C,m,U,T,zt),Bt=h.health,p.checkOwlFrameCookie(Yt,m.featureGates),p.isOwlFrameEnabled(m.featureGates,Lt)&&p.isOwlFrameBootEnabled(m.featureGates,Lt)&&(si=!0,Di.createOwlFrameWithTelemetry(Yt,h.fileType,g,!0).then((function(n){yi(S.OwlCreateFrameEnd),n.status===Wi.Success?(e.sessionConfig.initPackageParams=zt,yi(S.OwlBootAppMessageSend),null==ji||ji.sendMessage({id:P.BootApplication,data:Un(e)}),null==Lt||Lt.ULS.sendTraceTag(508432458,r.W.Lt,s.G.Info,"CreateOwlFrame: Succeeded and now booting document")):(null==Bt||Bt.recordQosError(be.DG.QosError_OwlFrameCreationFailure,[be.cS.QosVeto_OwlFrameExperienceFailed],!1,!1,!1,!1,{inStaging:!0}),null==Lt||Lt.ULS.sendTraceTag(508432456,r.W.Lt,s.G.Error,"CreateOwlFrame: Failed to create frame"))})).catch((function(e){null==Bt||Bt.recordQosError(be.DG.QosError_OwlFrameCreationFailure,[be.cS.QosVeto_OwlFrameExperienceFailed],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["Error","".concat(e)]])}),null==Lt||Lt.ULS.sendTraceTag(508432455,r.W.Lt,s.G.Error,"CreateOwlFrame: Exception: ".concat(e))})),p.isOwlFrameBootEnabled(m.featureGates,Lt))){var E=W(e,I),D=qi();return Wt=D.endSession,Mt=D.hostAccessibilityLoopComplete,jt=D.hostGetClientUrl,Gt=D.hostGetWebUrl,(0,t.pi)((0,t.pi)({},D),{sessionEndObservable:E})}if(Vt=(0,l.vJ)(l.Fh.FeatureGate_EcsHootGate,m.featureGates),p.isOwlFrame&&Vt&&h.loginHint&&(ai=new Promise((function(e){return(0,t.mG)(d,void 0,void 0,(function(){var n,i,o,r,u,s,c;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return[4,Promise.all([a.e(676),a.e(8869)]).then(a.bind(a,2439))];case 1:return n=t.sent(),[4,(i=new n.SharedAuthManagerImpl("".concat(h.wiseEnvironment,".").concat(null!==(u=null!==(r=h.owlRollout)&&void 0!==r?r:null==zt?void 0:zt.exposure)&&void 0!==u?u:"UnknownExposure",".").concat(null!==(c=null!==(s=h.owlVersion)&&void 0!==s?s:null==zt?void 0:zt.clientVersion)&&void 0!==c?c:"UnknownVersion"),!1,!1)).init(R(h))];case 2:return o=t.sent(),e({sharedAuthManager:i,initAuthResult:o}),[2]}}))}))}))),zt||(zt=h.initPackageParams),qt=(0,l.vJ)(l.Fh.FeatureGate_CreateNewImprovementGate,m.featureGates),Qt=(0,l.vJ)(l.Fh.FeatureGate_FetchWacAndSpoTokenGate,m.featureGates),Zt=function(e,n){switch(e){case N.T.PowerPoint:return(0,l.vJ)(l.Fh.FeatureGate_Vroom21SupportGate,n.featureGates);case N.T.Word:return(0,l.vJ)(l.Fh.FeatureGate_Vroom21ForWord,n.featureGates);case N.T.Excel:return(0,l.vJ)(l.Fh.FeatureGate_Vroom21ForExcel,n.featureGates);default:return!1}}(h.fileType,m),ui=(0,l.vJ)(l.Fh.FeatureGate_iOSNullCheckFeatureGate,m.featureGates),ri=(0,l.vJ)(l.Fh.FeatureGate_BypassOPTIONSCall,m.featureGates),Xt=(0,l.vJ)(l.Fh.FeatureGate_OwlTelemetryFunctions,m.featureGates),ci=(0,l.vJ)(l.Fh.FeatureGate_ManualRedirectOnTenantChangeGate,m.featureGates),y){var k=new Map;k.set("StartTime",(new Date).toUTCString()),nt(I,C),null==Bt||Bt.recordKpiUsage(di,Cn.o.FailureBased,fi,k)}if(Jt=hi(g),v.docUrl||v.driveId&&v.docId||v.shareUrl||v.baseUrl&&v.fileId){var O,K=Ci(H),M={correlationId:h.hostCorrelationId,officeHomeApiRoot:"",getAccessToken:K},j=(0,t.pi)((0,t.pi)({},h),{shareApiEndpoint:(0,c.PO)(Yt),metaUiHostVersion:rt.J.version,logger:Lt,sessionId:C}),G={isESSEnabled:j.isESSEnabled,wacDataCenter:j.isESSEnabled?F(h.fileType):void 0,sessionId:j.sessionId,hostCorrelationId:j.hostCorrelationId};(0,l.dt)(l.Fh.FeatureGate_EcsHootGate,Vt,Lt),Vt&&p.isOwlFrame?(null==Lt||Lt.ULS.sendTraceTag(520757324,r.W.Lt,s.G.Info,"FetchItemFromWac: Hoot endpoint enabled in ECS, fetch driveItem from Wac"),O=Ri(I)?Ui(M,Yt,G,qt,Zt,void 0,ri):function(e,n,i,o){return function(a,u,l,d){return void 0===u&&(u=!1),void 0===l&&(l=!1),null==d||d.ULS.sendTraceTag(526951838,r.W.Lt,s.G.Info,"Item to be fetched through wac service"),function(e,n,i,o,a,u,l){var d=this,f={docBootInfo:i,essOptions:a};return Tt=(0,c.XQ)(o),oi(e,i,o).then((function(a){return function(e,n){return(0,t.mG)(this,void 0,void 0,(function(){var i,o;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:if(i=null==Ie?void 0:Ie.getItem($t))try{if((o=JSON.parse(i))&&o.token&&o.expiryTime&&parseInt(o.expiryTime,10)>(new Date).getTime()/1e3)return null==n||n.ULS.sendTraceTag(524821017,r.W.Lt,s.G.Info,"GetDriveItemFromWacWithUrl: Fetched valid access token from the windows local storage cache"),[2,o.token];null==Ie||Ie.removeItem($t)}catch(e){null==Ie||Ie.removeItem($t)}return[4,e("None",!0,$t,void 0,!0)];case 1:return[2,t.sent()]}}))}))}(e.getAccessToken,u).then((function(c){var v={accept:"application/json"},h=ni(v,f,n,c,a);return Ot(h,u,l).then((function(e){return ti(e,c),ii(e,u)})).catch((function(a){return(0,t.mG)(d,void 0,void 0,(function(){return(0,t.Jh)(this,(function(t){return null==u||u.ULS.sendTraceTag(526471961,r.W.Lt,s.G.Error,"GetDriveItemFromWacWithUrl: Retrying getDriveItemFromWac. [Error: ".concat(JSON.stringify(a),"][FailureReason: ").concat(null==a?void 0:a.failure,"]")),a&&401===a.sharePointCallStatus&&"insufficient_claims"===a.claimsError&&a.claims?(null==u||u.ULS.sendTraceTag(512492100,r.W.Lt,s.G.Warning,"GetDriveItemFromWacWithUrl: Wac call vroom failed with claims challenge. Retry with claims"),[2,oi(e,i,o,a.claims).then((function(e){return Ot(ni(v,f,n,c,e),u,l).then((function(e){return ti(e,c),ii(e,u)}))}))]):[2,Ot(h,u,l).then((function(e){return ti(e,c),ii(e,u)}))]}))}))}))}))}))}(e,n,a,i,o,d,Bt)}}(M,C,Yt,G)):(null==Lt||Lt.ULS.sendTraceTag(520757325,r.W.Lt,s.G.Info,"FetchItemFromVroom: Hoot endpoint disabled in ECS, fetch driveItem from Vroom"),O=Ui(M,Yt,G,qt,Zt,Qt,ri));var _={documentBootInfo:I,fetchItemFromNetwork:O,fetchAccessToken:K,openShareControl:function(e){return(0,t.mG)(d,void 0,void 0,(function(){return(0,t.Jh)(this,(function(n){switch(n.label){case 0:return[4,Promise.all([a.e(6553),a.e(4630)]).then(a.bind(a,8337))];case 1:return[2,n.sent().openVanillaJsShareControl(e,{},Jt)]}}))}))},sessionConfig:j,onBootComplete:b.onBootComplete,onBootFailure:b.onBootFailure,onReturnFocus:b.onReturnFocus,onDocumentClose:function(){b.onDocumentClose&&b.onDocumentClose(),null==Bt||Bt.shutdown()},onSuccessNotification:b.onSuccessNotification,onOpenInMobileApp:b.onOpenInMobileApp,onRename:b.onRename,uiHostConfig:m,createDocument:function(e){return(0,t.mG)(d,void 0,void 0,(function(){var n,i,o,r;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return[4,Promise.all([a.e(6553),a.e(4630)]).then(a.bind(a,9623))];case 1:return n=t.sent(),i={fileType:e.fileType,wdOrigin:"TEAMS.UNIFIEDUIHOST.NEW",uiCulture:h.uiCulture,dataCulture:h.dataCulture,puid:h.puid,clickTime:e.clickTime,isNewFile:!0},o=(0,l.vJ)(l.Fh.FeatureGate_Locale1JSGate,m.featureGates),(0,l.dt)(l.Fh.FeatureGate_Locale1JSGate,o,Lt),[2,n.createNewDocument(M,i,e,Yt,Lt,o,null===(r=h.bootDiagnostics)||void 0===r?void 0:r.isOwlBootstrapperEnabled)]}}))}))},container:g};return Xt?Di.bootDocumentWithCustomFunctionsWithTelemetry(_):Ai(_)}null==Lt||Lt.ULS.sendTraceTag(576217559,r.W.Lt,s.G.Error,"No document url is found. Exit")}function Ai(e){var n,i,o,u,c,d,f,v,h,m,H=this,b=Date.now();yi(S.OwlWithCustomFunctionsStart),Ni();var I=null!==(n=null==zt?void 0:zt.wiseEnvironment)&&void 0!==n?n:e.sessionConfig.wiseEnvironment,A=!!e.sessionConfig.health,C=function(e,n){var i,o,r,a,u,s,c,l,d,f,v,h=null!==(i=null==n?void 0:n.wiseEnvironment)&&void 0!==i?i:e.sessionConfig.wiseEnvironment,p=e.sessionConfig.sessionId||(0,x.n)();(e.sessionConfig.logger||(e.sessionConfig.logger=new w.G2(p,h).logger),e.sessionConfig.owlRollout="".concat(h,".").concat(null==n?void 0:n.exposure),e.sessionConfig.owlVersion=null==n?void 0:n.clientVersion,e.sessionConfig.health)||(v="string"==typeof p?p:(0,t.CR)(p,1)[0],e.sessionConfig.health=it(v,h,null===(o=e.documentBootInfo)||void 0===o?void 0:o.fileType,null===(r=e.documentBootInfo)||void 0===r?void 0:r.uiCulture,null===(a=e.documentBootInfo)||void 0===a?void 0:a.puid,e.sessionConfig.tenantId,e.sessionConfig.hostCorrelationId,null==n?void 0:n.exposure,null==n?void 0:n.clientVersion,e.sessionConfig.isSynthetic,null===(u=e.uiHostConfig)||void 0===u?void 0:u.uiHostName,null===(s=e.uiHostConfig)||void 0===s?void 0:s.uiHostIntegrationType,null===(c=e.documentBootInfo)||void 0===c?void 0:c.wdOrigin,null===(l=e.sessionConfig.bootDiagnostics)||void 0===l?void 0:l.ringId,null===(d=e.documentBootInfo)||void 0===d?void 0:d.isNewFile,null===(f=e.sessionConfig.bootDiagnostics)||void 0===f?void 0:f.isOdcMigrated));return e}(e,zt),U=null!==(i=C.sessionConfig.sessionId)&&void 0!==i?i:(0,x.n)()[0];e.sessionConfig.sessionId=U,p.checkOwlFrameCookie(I,null===(o=e.uiHostConfig)||void 0===o?void 0:o.featureGates),Vt||(Vt=(0,l.vJ)(l.Fh.FeatureGate_EcsHootGate,null===(u=C.uiHostConfig)||void 0===u?void 0:u.featureGates)),p.isOwlFrame&&Vt&&e.sessionConfig.loginHint&&(ai||(ai=new Promise((function(n){return(0,t.mG)(H,void 0,void 0,(function(){var i,o,r,u,s,c,l;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return[4,Promise.all([a.e(676),a.e(8869)]).then(a.bind(a,2439))];case 1:return i=t.sent(),[4,(o=new i.SharedAuthManagerImpl("".concat(e.sessionConfig.wiseEnvironment,".").concat(null!==(s=null!==(u=e.sessionConfig.owlRollout)&&void 0!==u?u:null==zt?void 0:zt.exposure)&&void 0!==s?s:"UnknownExposure",".").concat(null!==(l=null!==(c=e.sessionConfig.owlVersion)&&void 0!==c?c:null==zt?void 0:zt.clientVersion)&&void 0!==l?l:"UnknownVersion"),!1,!1)).init(R(e.sessionConfig))];case 2:return r=t.sent(),n({sharedAuthManager:o,initAuthResult:r}),[2]}}))}))}))),Ri(e.documentBootInfo)||(e.fetchItemFromNetwork=function(n,t,i,o){return void 0===t&&(t=!1),void 0===i&&(i=!1),Pi(n,{isESSEnabled:e.sessionConfig.isESSEnabled,wacDataCenter:e.sessionConfig.isESSEnabled?F(e.documentBootInfo.fileType):void 0,sessionId:e.sessionConfig.sessionId,hostCorrelationId:e.sessionConfig.hostCorrelationId},ai,e.sessionConfig.wiseEnvironment,U,o,Bt)})),A||(Bt=C.sessionConfig.health),Lt||(Lt=C.sessionConfig.logger);var y=(0,l.vJ)(l.Fh.FeatureGate_IsOwlWacOAuthExperimentTreatmentEnabled,null===(c=e.uiHostConfig)||void 0===c?void 0:c.featureGates);if((0,l.dt)(l.Fh.FeatureGate_IsOwlWacOAuthExperimentTreatmentEnabled,y,Lt),y)try{!function(e,n){var t=Date.now(),i=Date.now(),o=!1,a=function(e,n){var t="";if("string"==typeof e.sessionConfig.customAuthConfigValue){try{t=JSON.parse(e.sessionConfig.customAuthConfigValue).login_Hint}catch(e){return void(null==Lt||Lt.ULS.sendTraceTag(508372803,r.W.Lt,s.G.Error,"[OWL] Failed to parse the customAuthConfigValue from bootAppParams.sessionConfig with error: ".concat(e)))}var i="";switch(n){case"FASTFOOD":case"MSIT":case"PRODUCTION":i="https://login.microsoftonline.com/";break;default:return void(null==Lt||Lt.ULS.sendTraceTag(508372802,r.W.Lt,s.G.Info,"[OWL] Not running OWL auth experiment for wise environment: ".concat(n)))}return{upn:t,authority:i,authorityType:e.sessionConfig.isMsa?"msa":"aad",appIds:["243c63a3-247d-41c5-9d83-7788c43f1c43"],enableConsoleLogging:!1,enablePopupFlash:!1,skipUpnCheck:!1,interactive:!1,correlationId:""}}}(e,n);if(void 0!==a){var u=Date.now(),c=new An(n,Lt),l=Date.now()-u;null==Lt||Lt.ULS.sendTraceTag(508348052,r.W.Lt,s.G.Info,"[OWL] wacOAuthBootstrapper instantiation Time : ".concat(l));var d=Date.now();c.initAuthLibrary(a).then((function(e){var n=Date.now()-d;return null==Lt||Lt.ULS.sendTraceTag(508355041,r.W.Lt,s.G.Info,"[OWL] initAuthLibrary Result :".concat(e,", Time: ").concat(n)),!!e&&(i=Date.now(),c.tryGetToken({appId:"243c63a3-247d-41c5-9d83-7788c43f1c43",target:"e03a13ee-9730-4cae-8525-47559c8cf18a",withPopup:!1,messageCorrelationId:(0,x.n)()[0]}))})).then((function(e){var n=Date.now()-i;e?(o=!0,null==Lt||Lt.ULS.sendTraceTag(508355040,r.W.Lt,s.G.Info,"[OWL] Successfully ran tryGetToken of the wacOAuthBootstrapper class.")):null==Lt||Lt.ULS.sendTraceTag(508355039,r.W.Lt,s.G.Info,"[OWL] Token Fetching Failed"),null==Lt||Lt.ULS.sendTraceTag(508355038,r.W.Lt,s.G.Info,"[OWL] TokenFetchingTime:".concat(n))})).catch((function(e){null==Lt||Lt.ULS.sendTraceTag(508372801,r.W.Lt,s.G.Error,"[OWL] Error occurred while running iFrameExperiment : ".concat(e))})).finally((function(){var e=Date.now()-t;null==Lt||Lt.ULS.sendTraceTag(508354771,r.W.Lt,s.G.Info,"[OWL] isIframeExperimentSuccessful:".concat(o)),null==Lt||Lt.ULS.sendTraceTag(508372800,r.W.Lt,s.G.Info,"[OWL] IframeCreationTime:".concat(e))}))}else null==Lt||Lt.ULS.sendTraceTag(508354772,r.W.Lt,s.G.Info,"[OWL] Failed to run owl auth experiment - Error getting Auth Library init parameters")}(e,I)}catch(e){null==Lt||Lt.ULS.sendTraceTag(508372804,r.W.Lt,s.G.Error,"[OWL] Failed to run the owl iFrame experiment, encountered error: ".concat(e))}if(function(e,n){var t,i,o,r;e.sessionConfig.bootDiagnostics=e.sessionConfig.bootDiagnostics||{},e.sessionConfig.bootDiagnostics.packageEntryTime=e.sessionConfig.bootDiagnostics.packageEntryTime||n,e.sessionConfig.bootDiagnostics.perfNavigationTiming=e.sessionConfig.bootDiagnostics.perfNavigationTiming||(0,w.pb)(ui),e.sessionConfig.bootDiagnostics.loadManifestStartTime=e.sessionConfig.bootDiagnostics.loadManifestStartTime||(null===(t=null==zt?void 0:zt.owlBootstrapperDiagnostics)||void 0===t?void 0:t.loadManifestStartTime),e.sessionConfig.bootDiagnostics.loadManifestEndTime=e.sessionConfig.bootDiagnostics.loadManifestEndTime||(null===(i=null==zt?void 0:zt.owlBootstrapperDiagnostics)||void 0===i?void 0:i.loadManifestEndTime),e.sessionConfig.bootDiagnostics.loadOwlStartTime=e.sessionConfig.bootDiagnostics.loadOwlStartTime||(null===(o=null==zt?void 0:zt.owlBootstrapperDiagnostics)||void 0===o?void 0:o.loadOwlStartTime),e.sessionConfig.bootDiagnostics.loadOwlEndTime=e.sessionConfig.bootDiagnostics.loadOwlEndTime||(null===(r=null==zt?void 0:zt.owlBootstrapperDiagnostics)||void 0===r?void 0:r.loadOwlEndTime)}(C,b),!si&&p.isOwlFrameEnabled(null===(d=e.uiHostConfig)||void 0===d?void 0:d.featureGates,Lt)&&p.isOwlFrameBootEnabled(null===(f=e.uiHostConfig)||void 0===f?void 0:f.featureGates,Lt)&&(si=!0,Di.createOwlFrameWithTelemetry(I,e.documentBootInfo.fileType,e.container,!0).then((function(n){return(0,t.mG)(H,void 0,void 0,(function(){var i,o,a;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return yi(S.OwlCreateFrameEnd),n.status!==Wi.Success?[3,4]:(e.sessionConfig.initPackageParams=zt,yi(S.OwlBootAppWithCustomFunctionsMessageSend),null!=ji?[3,1]:[3,3]);case 1:return o=(i=ji).sendMessage,a={id:P.BootApplicationWithCustomFunctions},[4,Rn(e)];case 2:o.apply(i,[(a.data=t.sent(),a)]),t.label=3;case 3:return null==Lt||Lt.ULS.sendTraceTag(508432454,r.W.Lt,s.G.Info,"CreateOwlFrame: Succeeded and now booting document"),[3,5];case 4:null==Bt||Bt.recordQosError(be.DG.QosError_OwlFrameCreationFailure,[be.cS.QosVeto_OwlFrameExperienceFailed],!1,!1,!1,!1,{inStaging:!0}),null==Lt||Lt.ULS.sendTraceTag(508432452,r.W.Lt,s.G.Error,"CreateOwlFrame: Failed to create frame"),t.label=5;case 5:return[2]}}))}))})).catch((function(e){null==Bt||Bt.recordQosError(be.DG.QosError_OwlFrameCreationFailure,[be.cS.QosVeto_OwlFrameExperienceFailed],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["Error","".concat(e)]])}),null==Lt||Lt.ULS.sendTraceTag(508432451,r.W.Lt,s.G.Error,"CreateOwlFrame: Exception: ".concat(e))})),p.isOwlFrameBootEnabled(null===(v=e.uiHostConfig)||void 0===v?void 0:v.featureGates,Lt))){var N=M(e),T=qi();return Wt=T.endSession,Mt=T.hostAccessibilityLoopComplete,jt=T.hostGetClientUrl,Gt=T.hostGetWebUrl,(0,t.pi)((0,t.pi)({},T),{sessionEndObservable:N})}var E=C.container;Jt=hi(C.container),C.container=Jt;var D=et(C.documentBootInfo),O=U===D,K=C.onBootFailure;if(C.onBootFailure=function(e,n){var t,i,o,r=e.httpErrorCode,a=function(e){switch(e){case be.AU.oi:case be.AU.ri:return!1;default:return!0}}(e.wacErrorName),u=null!==(t=e.networkError)&&void 0!==t&&t;if(null==Bt||Bt.recordQosError(e.qosErrorName,["UnifiedUiHostBootstrappingFailed"],Pe(r,u),a,!0,!0,{inStaging:null===(i=e.inStaging)||void 0===i||i,extendedProperties:Me(e)}),O){var s=new Map;s.set("FailureTime",(new Date).toUTCString()),s.set("Error",e.error),n&&s.set("DocumentBootInfo",JSON.stringify(n)),r&&s.set("HttpErrorCode",r),null==Bt||Bt.recordKpiFailure(di,"PrebootDocumentOpenFailed",!1,!0,{durationMs:Date.now()-((null===(o=C.sessionConfig.bootDiagnostics)||void 0===o?void 0:o.packageEntryTime)||b),extendedProperties:s})}K&&K(e,n),null==Bt||Bt.shutdown()},p.isOwlFrameEnabled(null===(h=C.uiHostConfig)||void 0===h?void 0:h.featureGates,Lt)&&!p.isOwlFrameBootEnabled(null===(m=C.uiHostConfig)||void 0===m?void 0:m.featureGates,Lt)){var W=e.onBootComplete;e.onBootComplete=function(e,n){(function(e,n,i){return(0,t.mG)(this,void 0,void 0,(function(){var o,a,u;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),yi(S.OwlCreateFrameStart),[4,Di.createOwlFrameWithTelemetry(i.sessionConfig.wiseEnvironment,n,e,!1)];case 1:return o=t.sent(),yi(S.OwlCreateFrameEnd),o.status===Wi.Success&&(yi(S.OwlTokenFetchingExperimentMessageSend),null==ji||ji.sendMessage({id:P.TokenFetchingExperiment,data:{bootParams:i}})),a=g().owlTelemetryData,null==Lt||Lt.ULS.sendTraceTag(508168084,r.W.Lt,s.G.Important,"[Auth Token Experiment Data (Host)]: ".concat(a)),[3,3];case 2:return u=t.sent(),o={status:Wi.Error,error:"Caught unexpected exception: ".concat(u)},null==Bt||Bt.recordQosError(be.DG.QosError_OwlFrameCreationFailure,[be.cS.QosVeto_OwlFrameExperienceFailed],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["Error","".concat(u)]])}),[3,3];case 3:return null==Lt||Lt.ULS.sendTraceTag(508168083,r.W.Lt,s.G.Info,JSON.stringify(o)),[2]}}))}))})(C.container,C.documentBootInfo.fileType,C).catch((function(e){return null==Lt?void 0:Lt.ULS.sendTraceTag(508168085,r.W.Lt,s.G.Error,"Caught unexpected error running HOOT experiment: ".concat(e))})),null==W||W(e,n)}}var G=(0,t.pi)((0,t.pi)({},C),{initPackageParams:zt}),_=Xt?Di.bootAppWithTelemetry(G):bn(G);Wt=_.endSession,Mt=_.hostAccessibilityLoopComplete,jt=_.hostGetClientUrl,Gt=_.hostGetWebUrl,_t=_.postFrameDiagnostics,p.isOwlFrame&&j(Wt,Mt,jt,Gt,_t,Lt);var L=function(e){var n=e.subscribe((function(e){var i,o;if(e&&(null===(i=C.uiHostConfig)||void 0===i?void 0:i.supportsInternalReboot)){var r=(0,x.n)(),a=new w.G2(r,I);C.sessionConfig.sessionId=a.sessionId,C.sessionConfig.logger=a.logger,C.sessionConfig.bootDiagnostics=(o=C.sessionConfig.bootDiagnostics,(0,l.dt)(l.Fh.FeatureGate_iOSNullCheckFeatureGate,ui,Lt),{tabsCacheHit:!0,packageEntryTime:Date.now(),isTestMode:null==o?void 0:o.isTestMode,isPrebooted:!1,ringId:null==o?void 0:o.ringId,teamsContextStartTime:0,teamsContextEndTime:0,perfNavigationTiming:(0,w.pb)(ui),meetingLiveDiagnostics:void 0}),C.sessionConfig.highContrastMode=e.theme,E&&Jt&&Jt.parentNode===E&&E.removeChild(Jt),Jt=Si(E,li);var u=bn((0,t.pi)((0,t.pi)({},C),{container:Jt,documentBootInfo:e.documentBootInfo,initPackageParams:zt}));Wt=u.endSession,Mt=u.hostAccessibilityLoopComplete,jt=u.hostGetClientUrl,Gt=u.hostGetWebUrl,n.unsubscribe(),L(u.sessionEndObservable)}else E&&Jt&&Jt.parentNode===E&&E.removeChild(Jt),n.unsubscribe();null==Bt||Bt.shutdown()}))};return L(_.sessionEndObservable),p.isOwlFrame&&_.sessionEndObservable.subscribe((function(e){null==Gi||Gi.sendMessage({id:k.EndSessionObservable,data:{rebootInfo:e}})})),yi([S.OwlEnd,S.OwlWithCustomFunctionsEnd]),_}function Ci(e){return function(n,t,i,o,a,u){return null==Lt||Lt.ULS.sendTraceTag(546182046,r.W.Lt,s.G.Info,"FetchAccessToken: Start"),a&&(be.c.accessTokenStartTime=Date.now(),(0,we.p)()&&window.performance.mark("accessTokenStartTime")),e(i||pi(n),u).then((function(e){return{success:!0,token:e,format:"JWT",source:"OfficeHome"}})).catch((function(e){return Promise.reject({api:"getAuthToken",failure:e,message:"Failed to retrieve auth token"})})).finally((function(){null==Lt||Lt.ULS.sendTraceTag(546182047,r.W.Lt,s.G.Info,"FetchAccessToken: End"),a&&(be.c.accessTokenEndTime=Date.now(),(0,we.p)()&&window.performance.mark("accessTokenEndTime"))}))}}function Ui(e,n,i,o,u,c,l){var d=this;return function(f,v,h,p){return void 0===v&&(v=!0),void 0===h&&(h=!1),(0,t.mG)(d,void 0,void 0,(function(){var d,v,m;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return d=!0,v=h?"editnew":"view"===f.intent?"view":"edit"===f.intent?"edit":"open",(null==i?void 0:i.isESSEnabled)&&i.wacDataCenter&&!tt.includes("wacSession")&&tt.push("wacSession"),o&&f.isNewFile&&f.createNewInfo?[4,Promise.all([a.e(6553),a.e(4630)]).then(a.bind(a,9623))]:[3,2];case 1:return[2,t.sent().createAndGetNewDocument(e,f,f.createNewInfo,n,tt)];case 2:return f.shareUrl?(null==p||p.ULS.sendTraceTag(572634827,r.W.Lt,s.G.Info,"Item to be fetched using shareUrl"),[2,Ct(f.shareUrl,tt,e,d,v,!1,p,i,c,l).catch((function(n){if(n&&404===n.status&&"The site has been moved to a new location."===n.message&&n.redirectLocation&&f.shareUrl){null==p||p.ULS.sendTraceTag(546120988,r.W.Lt,s.G.Info,"Get item failed due to site move. Retry with the redirect location");var t=new URL(n.redirectLocation),o=new URL(f.shareUrl);return f.shareUrl=f.shareUrl.replace(o.hostname,t.hostname),Ct(f.shareUrl,tt,e,d,v,!1,p,i,c,l)}throw n}))]):f.driveId&&f.docId?(null==p||p.ULS.sendTraceTag(572634828,r.W.Lt,s.G.Info,"Item to be fetched using driveId and docId"),[2,Rt(f,tt,e,d,v,n,p,i,c,l)]):f.fileId&&f.baseUrl?(null==p||p.ULS.sendTraceTag(572343521,r.W.Lt,s.G.Info,"Item to be fetched using fileId and baseUrl"),[2,Nt(f.fileId,f.baseUrl,tt,e,d,v,p,i,u,c,l).catch((function(n){if(ci&&n&&404===n.status&&n.redirectLocation){if(null==p||p.ULS.sendTraceTag(508380358,r.W.Lt,s.G.Important,"Get item failed due to site move. Retry with the redirect location"),f.baseUrl){var t=new URL(f.baseUrl),o=new URL(n.redirectLocation);f.baseUrl=f.baseUrl.replace(t.hostname,o.hostname)}return Nt(f.fileId||"",f.baseUrl||"",tt,e,d,v,p,i,u,c,l)}throw n}))]):(null==p||p.ULS.sendTraceTag(572634829,r.W.Lt,s.G.Info,"Item to be fetched using docUrl"),[2,Ct(null!==(m=f.docUrl)&&void 0!==m?m:"",tt,e,d,v,!1,p,i,c,l).catch((function(e){throw e}))])}}))}))}}function Ri(e){return!(e.shareUrl||!e.docId||!e.driveId||e.baseUrl||e.docUrl)}function yi(e){window.performance&&window.performance.mark&&(Array.isArray(e)?e.forEach((function(e){window.performance.mark(e)})):window.performance.mark(e))}function Ni(){var e,n;window.performance&&!((null===(e=window.performance.getEntriesByName(S.OwlHostTimeOrigin))||void 0===e?void 0:e.length)>0||(null===(n=window.performance.getEntriesByName(S.OwlFrameTimeOrigin))||void 0===n?void 0:n.length)>0)&&window.performance.mark("".concat(p.isOwlFrame?S.OwlFrameTimeOrigin:S.OwlHostTimeOrigin),{startTime:window.performance.timeOrigin})}var Ti,Ei=function(){return void 0===Ti&&(Ti=p.isOwlFrame?"Frame":"Host"),Ti};function Fi(e,n){return function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];yi("owl".concat(Ei()).concat(n,"Start"));var r=e.apply(void 0,(0,t.ev)([],(0,t.CR)(i),!1));return yi("owl".concat(Ei()).concat(n,"End")),r}}var Di={bootAppWithTelemetry:Fi(bn,"BootApp"),bootDocumentWithCustomFunctionsWithTelemetry:Fi(Ai,"BootDocumentWithCustomFunctions"),bootDocumentWithTelemetry:Fi(Ii,"BootDocument"),createOwlFrameWithTelemetry:Fi((function(e,n,o,r){return(0,t.mG)(this,void 0,void 0,(function(){var a,u,s,l;return(0,t.Jh)(this,(function(t){return a=function(e){return new URL((0,c.wl)(e)).origin}(e),(u=document.createElement("iframe")).src="".concat(a).concat(v,"?filetype=").concat(n,"&hostorigin=").concat(encodeURIComponent(window.location.origin),"&env=").concat(e),u.id=Ji,u.allowFullscreen=!0,u.allow="microphone ".concat(a,"; autoplay ").concat(a,"; camera ").concat(a,"; clipboard-read ").concat(a,"; clipboard-write ").concat(a,"; keyboard-map ").concat(a,"; display-capture ").concat(a),u.setAttribute("style","inset: 0px; height: ".concat(r?"100%":"0px","; width: ").concat(r?"100%":"0px","; display: block; position: absolute; background-color: transparent; border: none; visibility: ").concat(r?"visible":"hidden",";")),o.appendChild(u),s=new Promise((function(e){u.contentWindow&&(ji=new i(u.contentWindow,a),Li=new Mi(ji,k.EndSessionResponse),ji.registerHandler(k.FrameLoaded,(function(n){yi(S.OwlLoadedMessageReceive),e(n.data.success?{status:Wi.Success}:{status:Wi.Error,error:n.data.error})})))})),l=new Promise((function(e){return setTimeout((function(){return e({status:Wi.Timeout,error:"Timed out waiting for OWL frame to load after ".concat(Vi," ms.")})}),Vi)})),[2,Promise.race([s,l])]}))}))}),"CreateOwlFrame"),initOwlFrameWithTelemetry:Fi((function(e){var n=this;Gi=new i(window.parent,e),_i=new Mi(Gi,P.GetAuthTokenResponse,P.FetchItemFromNetworkResponse,P.FetchAccessTokenResponse,P.OpenShareControlResponse,P.CreateDocumentResponse),Gi.registerHandler(P.BootApplication,(function(e){yi(S.OwlBootAppMessageReceive);var n=e.data;Di.bootDocumentWithTelemetry(function(e){var n,i,o,r,a,u,s,c,l,d,f,v,h,p,m,S,H,w,b,g,I,A,C,U,R,y,N,T,E,F,D,O,x,K,W,M;return{documentIdentifier:e.documentIdentifier,sessionConfig:{hostCorrelationId:e.sessionConfig.hostCorrelationId,isMsa:e.sessionConfig.isMsa,tenantId:e.sessionConfig.tenantId,organizationName:e.sessionConfig.organizationName,sessionId:e.sessionConfig.sessionId,isESSEnabled:e.sessionConfig.isESSEnabled,experiments:e.sessionConfig.experiments,highContrastMode:e.sessionConfig.highContrastMode,additionalApplicationParameters:e.sessionConfig.additionalApplicationParameters,bootDiagnostics:{tabsCacheHit:null===(n=e.sessionConfig.bootDiagnostics)||void 0===n?void 0:n.tabsCacheHit,packageEntryTime:null===(i=e.sessionConfig.bootDiagnostics)||void 0===i?void 0:i.packageEntryTime,isTestMode:null===(o=e.sessionConfig.bootDiagnostics)||void 0===o?void 0:o.isTestMode,isManifestCachingEnabled:null===(r=e.sessionConfig.bootDiagnostics)||void 0===r?void 0:r.isManifestCachingEnabled,isOwlBootstrapperEnabled:null===(a=e.sessionConfig.bootDiagnostics)||void 0===a?void 0:a.isOwlBootstrapperEnabled,isPrebooted:null===(u=e.sessionConfig.bootDiagnostics)||void 0===u?void 0:u.isPrebooted,isVroom21:null===(s=e.sessionConfig.bootDiagnostics)||void 0===s?void 0:s.isVroom21,ringId:null===(c=e.sessionConfig.bootDiagnostics)||void 0===c?void 0:c.ringId,teamsContextStartTime:null===(l=e.sessionConfig.bootDiagnostics)||void 0===l?void 0:l.teamsContextStartTime,teamsContextEndTime:null===(d=e.sessionConfig.bootDiagnostics)||void 0===d?void 0:d.teamsContextEndTime,wopiDataStartTime:null===(f=e.sessionConfig.bootDiagnostics)||void 0===f?void 0:f.wopiDataStartTime,wopiDataEndTime:null===(v=e.sessionConfig.bootDiagnostics)||void 0===v?void 0:v.wopiDataEndTime,bootStrapStartTime:null===(h=e.sessionConfig.bootDiagnostics)||void 0===h?void 0:h.bootStrapStartTime,bootStrapEndTime:null===(p=e.sessionConfig.bootDiagnostics)||void 0===p?void 0:p.bootStrapEndTime,driveItemStartTime:null===(m=e.sessionConfig.bootDiagnostics)||void 0===m?void 0:m.driveItemStartTime,driveItemEndTime:null===(S=e.sessionConfig.bootDiagnostics)||void 0===S?void 0:S.driveItemEndTime,driveItemFromWacStartTime:null===(H=e.sessionConfig.bootDiagnostics)||void 0===H?void 0:H.driveItemFromWacStartTime,driveItemFromWacEndTime:null===(w=e.sessionConfig.bootDiagnostics)||void 0===w?void 0:w.driveItemFromWacEndTime,accessTokenStartTime:null===(b=e.sessionConfig.bootDiagnostics)||void 0===b?void 0:b.accessTokenStartTime,accessTokenEndTime:null===(g=e.sessionConfig.bootDiagnostics)||void 0===g?void 0:g.accessTokenEndTime,fetchWacAndSpoTokenStartTime:null===(I=e.sessionConfig.bootDiagnostics)||void 0===I?void 0:I.fetchWacAndSpoTokenStartTime,fetchWacAndSpoTokenEndTime:null===(A=e.sessionConfig.bootDiagnostics)||void 0===A?void 0:A.fetchWacAndSpoTokenEndTime,isCookieBlocked:null===(C=e.sessionConfig.bootDiagnostics)||void 0===C?void 0:C.isCookieBlocked,meetingLiveDiagnostics:null===(U=e.sessionConfig.bootDiagnostics)||void 0===U?void 0:U.meetingLiveDiagnostics,spRequestGuid:null===(R=e.sessionConfig.bootDiagnostics)||void 0===R?void 0:R.spRequestGuid,createNewStartTime:null===(y=e.sessionConfig.bootDiagnostics)||void 0===y?void 0:y.createNewStartTime,createNewEndTime:null===(N=e.sessionConfig.bootDiagnostics)||void 0===N?void 0:N.createNewEndTime,loadManifestStartTime:null===(T=e.sessionConfig.bootDiagnostics)||void 0===T?void 0:T.loadManifestStartTime,loadManifestEndTime:null===(E=e.sessionConfig.bootDiagnostics)||void 0===E?void 0:E.loadManifestEndTime,loadOwlStartTime:null===(F=e.sessionConfig.bootDiagnostics)||void 0===F?void 0:F.loadOwlStartTime,loadOwlEndTime:null===(D=e.sessionConfig.bootDiagnostics)||void 0===D?void 0:D.loadOwlEndTime,owlBootstrapperStartTime:null===(O=e.sessionConfig.bootDiagnostics)||void 0===O?void 0:O.owlBootstrapperStartTime,owlBootstrapperEndTime:null===(x=e.sessionConfig.bootDiagnostics)||void 0===x?void 0:x.owlBootstrapperEndTime,isOdcMigrated:null===(K=e.sessionConfig.bootDiagnostics)||void 0===K?void 0:K.isOdcMigrated,perfNavigationTiming:null===(W=e.sessionConfig.bootDiagnostics)||void 0===W?void 0:W.perfNavigationTiming},uiHostTabId:e.sessionConfig.uiHostTabId,upn:e.sessionConfig.upn,meeting:e.sessionConfig.meeting,customAuthConfigValue:e.sessionConfig.customAuthConfigValue,wiseEnvironment:e.sessionConfig.wiseEnvironment,isSynthetic:e.sessionConfig.isSynthetic,hostUrl:e.sessionConfig.hostUrl,owlVersion:e.sessionConfig.owlVersion,owlRollout:e.sessionConfig.owlRollout,fileType:e.sessionConfig.fileType,clickTime:e.sessionConfig.clickTime,uiCulture:e.sessionConfig.uiCulture,dataCulture:e.sessionConfig.dataCulture,puid:e.sessionConfig.puid,isNewFile:e.sessionConfig.isNewFile,wdValue:e.sessionConfig.wdValue,sessionOrigin:e.sessionConfig.sessionOrigin,intent:e.sessionConfig.intent,hostClientType:e.sessionConfig.hostClientType,isPopOut:e.sessionConfig.isPopOut,teamType:e.sessionConfig.teamType,initPackageParams:e.sessionConfig.initPackageParams&&(0,t.pi)((0,t.pi)({},e.sessionConfig.initPackageParams),{jsApiUrlInfos:zn(null===(M=e.sessionConfig.initPackageParams)||void 0===M?void 0:M.jsApiUrlInfos)})},uiHostConfig:(0,t.pi)((0,t.pi)({},e.uiHostConfig),{featureGates:e.uiHostConfig.featureGates?zn(e.uiHostConfig.featureGates):void 0}),getAuthToken:function(e,n){return _i.getMessagePromise(P.GetAuthTokenResponse,{id:k.GetAuthToken,data:{resourceUrl:e,claims:n}})},eventHandlers:{onBootComplete:yn,onBootFailure:Nn,onReturnFocus:Tn,onDocumentClose:En,onSuccessNotification:Fn,onOpenInMobileApp:Dn},container:document.getElementById("owl-container")||Mn()}}(n))})),Gi.registerHandler(P.BootApplicationWithCustomFunctions,(function(n){yi(S.OwlBootAppWithCustomFunctionsMessageReceive);var o=n.data;Di.bootDocumentWithCustomFunctionsWithTelemetry(function(e,n){var o,r,a;return{documentBootInfo:e.documentBootInfo,fetchItemFromNetwork:kn,fetchAccessToken:Pn,openShareControl:On,sessionConfig:(0,t.pi)((0,t.pi)({},e.sessionConfig),{bootDiagnostics:(0,t.pi)((0,t.pi)({},e.sessionConfig.bootDiagnostics),{perfNavigationTiming:null===(o=e.sessionConfig.bootDiagnostics)||void 0===o?void 0:o.perfNavigationTiming})}),container:document.getElementById("owl-container")||Mn(),createDocument:xn,setTitle:Kn,onBootComplete:yn,onBootFailure:Nn,onReturnFocus:Tn,onDocumentClose:En,onSuccessNotification:Fn,onOpenInMobileApp:Dn,onUserActivity:Wn,uiHostConfig:(0,t.pi)((0,t.pi)({},e.uiHostConfig),{featureGates:(null===(r=e.uiHostConfig)||void 0===r?void 0:r.featureGates)?zn(e.uiHostConfig.featureGates):void 0}),additionalApplicationParameters:e.additionalApplicationParameters,sharingLinkTokenProvider:e.sharingLinkTokenProvider?{TokenPromise:new Promise((function(e,n){null==Gi||Gi.registerHandler(P.SharingLinkTokenProvider,(function(t){t.data.token?e(t.data.token):n(t.data.error)}))}))}:void 0,onCAAEMessage:jn,onUserAccess:Gn,onMoveToFolder:_n,onSharedFilePicker:Ln,onRename:Bn,initPackageParams:e.initPackageParams&&(0,t.pi)((0,t.pi)({},e.initPackageParams),{jsApiUrlInfos:zn(null===(a=e.initPackageParams)||void 0===a?void 0:a.jsApiUrlInfos)}),onFrameChange:Jn,invokeSessionRefreshInfoPopupBlockedDialog:function(e){var t=new i(window.parent,n);t.registerHandler(P.SessionRefreshInfoDialogHandleRefresh,(function(){t.dispose(),e.handleRefresh()})),t.registerHandler(P.SessionRefreshInfoDialogHandleCancel,(function(){t.dispose(),e.handleCancel()})),t.registerHandler(P.SessionRefreshInfoDialogOnDismiss,(function(){t.dispose(),e.onDismiss()})),null==Gi||Gi.sendMessage({id:k.InvokeSessionRefreshInfoPopupBlockedDialog,data:{visible:e.visible}})},onFileEmbed:Vn}}(o,e))})),Gi.registerHandler(P.TokenFetchingExperiment,(function(e){return(0,t.mG)(n,void 0,void 0,(function(){var n,i,u,l,d,f,v=this;return(0,t.Jh)(this,(function(h){switch(h.label){case 0:Ni(),yi(S.OwlTokenFetchingExperimentMessageReceived),n=e.data.bootParams,i=new Promise((function(e){return(0,t.mG)(v,void 0,void 0,(function(){var i,o,r,u,s;return(0,t.Jh)(this,(function(t){switch(t.label){case 0:return yi(S.OwlDynamicallyLoadSharedAuthStart),[4,Promise.all([a.e(676),a.e(8869)]).then(a.bind(a,2439))];case 1:return i=t.sent(),yi(S.OwlDynamicallyLoadSharedAuthEnd),o=new i.SharedAuthManagerImpl("".concat(n.sessionConfig.wiseEnvironment,".").concat(null!==(u=n.sessionConfig.owlRollout)&&void 0!==u?u:"UnknownExposure",".").concat(null!==(s=n.sessionConfig.owlVersion)&&void 0!==s?s:"UnknownVersion"),!1,!1),yi(S.OwlSharedAuthInitStart),[4,o.init(R(n.sessionConfig))];case 2:return r=t.sent(),yi(S.OwlSharedAuthInitEnd),e({sharedAuthManager:o,initAuthResult:r}),[2]}}))}))})),u=(0,o.L8)({remoteUlsEndpoint:(0,c.fy)(n.sessionConfig.wiseEnvironment),sessionId:n.sessionConfig.sessionId}),l={isESSEnabled:n.sessionConfig.isESSEnabled,wacDataCenter:n.sessionConfig.isESSEnabled?F(n.documentBootInfo.fileType):void 0,sessionId:n.sessionConfig.sessionId,hostCorrelationId:n.sessionConfig.hostCorrelationId},h.label=1;case 1:return h.trys.push([1,3,,4]),yi(S.OwlGetDriveItemWithSharedAuthStart),[4,Pi(n.documentBootInfo,l,i,n.sessionConfig.wiseEnvironment,n.sessionConfig.sessionId,u)];case 2:return h.sent(),yi(S.OwlGetDriveItemWithSharedAuthEnd),[3,4];case 3:return d=h.sent(),null==u||u.ULS.sendTraceTag(508168087,r.W.Lt,s.G.Error,"Failed to get drive item with shared auth, error: ".concat(d)),[3,4];case 4:return f=g().owlTelemetryData,null==u||u.ULS.sendTraceTag(508168086,r.W.Lt,s.G.Important,"[Auth Token Experiment Data (Frame)]: ".concat(f)),[2]}}))}))})),yi(S.OwlLoadedMessageSend),Gi.sendMessage({id:k.FrameLoaded,data:{success:!0}})}),"InitOwlFrame"),registerBootDocumentHostHandlersWithTelemetry:Fi(W,"RegisterBootDocumentHostHandlers"),registerBootDocumentWithCustomFunctionsHostHandlersWithTelemetry:Fi(M,"RegisterBootDocumentWithCustomFunctionsHostHandlers"),registerFrameHandlersWithTelemetry:Fi(j,"RegisterFrameHandlers")},ki="Failed to parse stringified drive item.";function Pi(e,n,i,o,a,u,l){return(0,t.mG)(this,void 0,void 0,(function(){var d,f,v,h,p,m,H,w,b,g,I,U,R,y,N,T,E,F,D;return(0,t.Jh)(this,(function(k){switch(k.label){case 0:return[4,i];case 1:return d=k.sent(),f=d.sharedAuthManager,d.initAuthResult.isSuccess?(v={docBootInfo:e,essOptions:n},h=(0,c.XQ)(o),p=(0,t.CR)((0,x.n)(),1),m=p[0],H=xi(f,e,o),yi(S.OwlTryGetWacTokenStart),w=f.tryGetToken({target:A,appId:C,messageCorrelationId:m}).then((function(e){return yi(S.OwlTryGetWacTokenEnd),e})),[4,Promise.all([H,w])]):[2,Promise.reject("Auth initialization failed")];case 2:if(b=t.CR.apply(void 0,[k.sent(),2]),g=b[0],I=b[1],!g.isSuccess&&!I.isSuccess)return[2,Promise.reject("Failed to fetch necessary token. SPO: ".concat(g.isSuccess,", WAC: ").concat(I.isSuccess))];R=Oi(U={accept:"application/json"},v,h,a,I,g),k.label=3;case 3:return k.trys.push([3,5,,10]),yi(S.OwlGetDriveItemStart),[4,Ot(R,u,l)];case 4:if(F=k.sent(),yi(S.OwlGetDriveItemEnd),!(D=Ki(F,u)))throw new SyntaxError(ki);return[2,D];case 5:return(y=k.sent())instanceof SyntaxError||null==u||u.ULS.sendTraceTag(508354962,r.W.Lt,s.G.Warning,"Failed to get vroom data from WAC. [Error: ".concat(JSON.stringify(y),"] [Reason: ").concat(null==y?void 0:y.failure,"]")),y&&401===y.sharePointCallStatus&&"insufficient_claims"===y.claimsError&&y.claims?(null==u||u.ULS.sendTraceTag(508354961,r.W.Lt,s.G.Warning,"WAC Vroom call failed with claims challenge, retrying with claims."),[4,xi(f,e,o,y.claims)]):[3,8];case 6:return N=k.sent(),[4,Ot(Oi(U,v,h,a,I,N),u,l)];case 7:return T=k.sent(),(E=Ki(T,u))?[2,E]:[2,Promise.reject(ki)];case 8:return[4,Ot(R,u,l)];case 9:return F=k.sent(),(D=Ki(F,u))?[2,D]:[2,Promise.reject(ki)];case 10:return[2]}}))}))}function Oi(e,n,i,o,r,a){var u,s,c={Authorization:null!==(u=y(r).Authorization)&&void 0!==u?u:"",SessionId:o,SharePointToken:null!==(s=y(a).Authorization)&&void 0!==s?s:""},l=(0,t.pi)((0,t.pi)({},n),{optionsHttpRequestHeaders:c});return{url:i,method:at.hx.Post,headers:e,body:l}}function xi(e,n,i,o){var r,a,u,s=(0,t.CR)((0,x.n)(),1)[0],l=(null!==(u=Ut(null!==(a=null!==(r=n.shareUrl)&&void 0!==r?r:n.baseUrl)&&void 0!==a?a:n.docUrl))&&void 0!==u?u:n.driveId&&n.docId)?(0,c.A8)(i):"";return e.tryGetToken({target:l,appId:C,messageCorrelationId:s,claims:o})}function Ki(e,n){try{return JSON.parse(e.graphDriveItem)}catch(e){return null==n||n.ULS.sendTraceTag(508354960,r.W.Lt,s.G.Error,"Failed to parse Vroom response from JSON string. [".concat(e.name,": ").concat(e.message,"]")),null}}var Wi,Mi=function(){function e(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];this.Oa=e,this.xa=new Map(n.map((function(e){return[e,new Map]})))}return e.prototype.registerHandlers=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];n.forEach((function(n){return e.xa.set(n,new Map)}))},e.prototype.getHandler=function(e,n,t){void 0===n&&(n=""),void 0===t&&(t="error");var i=this.xa.get(e);return function(e){if(i){var o=i.get(e.data.correlationId);o&&(i.delete(e.data.correlationId),n?e.data[n]?o.resolve(e.data[n]):o.reject(e.data[t]||t):o.resolve())}}},e.prototype.getMessagePromise=function(e,n){var t=this,i=this.xa.get(e);return i?new Promise((function(e,o){var r;t.Oa||o("frameToHostMessenger does not exist");var a=null===(r=t.Oa)||void 0===r?void 0:r.sendMessage(n);a?i.set(a,{resolve:e,reject:o}):o("Encountered error sending message to host")})):Promise.reject("No registered handlers ")},e}();!function(e){e[e.Success=0]="Success",e[e.Error=1]="Error",e[e.Timeout=2]="Timeout"}(Wi||(Wi={}));var ji,Gi,_i,Li,Bi,Ji="OwlFrame",Vi=3e4;function qi(){return{endSession:function(e){return Li.getMessagePromise(k.EndSessionResponse,{id:P.EndSession,data:{rebootInfo:e}})},hostAccessibilityLoopComplete:function(e){return null==ji||ji.sendMessage({id:P.HostAccessibilityLoopComplete,data:{navigateForward:e}}),!0},hostGetClientUrl:function(){null==ji||ji.sendMessage({id:P.GetClientUrl,data:{}})},hostGetWebUrl:function(){null==ji||ji.sendMessage({id:P.GetWebUrl,data:{}})}}}function zi(){Gi&&Gi.dispose(),ji&&ji.dispose(),window.performance&&window.performance.getEntriesByType&&window.performance.clearMarks&&window.performance.getEntriesByType("mark").filter((function(e){return e.name.startsWith("owl")})).forEach((function(e){return window.performance.clearMarks(e.name)}));var e=document.getElementById(Ji);e&&e.remove()}!function(e){e[e.Firefox=0]="Firefox",e[e.Opera=1]="Opera",e[e.IE=2]="IE",e[e.Edge=3]="Edge",e[e.Chrome=4]="Chrome",e[e.Safari=5]="Safari",e[e.TeamsElectron=6]="TeamsElectron",e[e.Unknown=7]="Unknown"}(Bi||(Bi={}));var Zi=window.navigator,Qi=Zi?Zi.userAgent:void 0;function Xi(){return!!Qi&&Qi.indexOf("iPhone")>=0||/android.+mobile/i.test(Zi.userAgent)}var Yi,$i,eo,no=a(6741);function to(){var e=window.location.search,n=new URLSearchParams(e),t=n.get(be.$c.ItemId),i=n.get(be.$c.DriveId),o=n.get(be.$c.DocUrl);return{docId:null!=t?t:void 0,driveId:null!=i?i:void 0,docUrl:null!=o?o:void 0}}function io(e){return eo||(eo=function(){$i||(($i={})[N.T[N.T.Excel]]=["xls","xlsx","xlb","xlc","xlsb","xlsm","xlt","xltx","xltm","xlm","xla","xll","xlam","xlw","excel","csv"],$i[N.T[N.T.Visio]]=["vsd","vss","vst","vdx","vsx","vtx","vsl","vsu","vsw","vsdx","vsdm","vssm","vstx","vstm"],$i[N.T[N.T.PowerPoint]]=["ppt","pptx","pot","potx","potm","ppam","ppsx","ppsm","sldx","sldm","ppa","pps","pptm","powerpoint"],$i[N.T[N.T.Word]]=["doc","dot","docx","docm","dotx","dotm","docb","word"],$i[N.T[N.T.OneNote]]=["one"]),eo={};var e=function(e){if(!$i.hasOwnProperty(e))return"continue";var n=$i[e];if(!n)return"continue";n.forEach((function(n){eo[n]=N.T[e]}))};for(var n in $i)e(n);return eo}()),e&&eo[e.toLowerCase()]||N.T.None}function oo(){var e=window.location.pathname.split("/");if(4===e.length||5===e.length)return function(e){switch(e){case"word":return N.T.Word;case"excel":return N.T.Excel;case"powerpoint":return N.T.PowerPoint;case"onenote":return N.T.OneNote;case"visio":return N.T.Visio;default:return}}(e[2].toLowerCase())}!function(e){e[e.NotSupported=0]="NotSupported",e[e.SameDocOnly=1]="SameDocOnly",e[e.AnyDoc=2]="AnyDoc",e[e.OtherMode=4]="OtherMode"}(Yi||(Yi={})),function(){var e,n;if(p.isOwlFrame){var t=new URLSearchParams(location.search),i=document.getElementById("owl"),o=t.get("hostorigin"),r="true"===(null===(n=null===(e=null==i?void 0:i.dataset)||void 0===e?void 0:e.validHost)||void 0===n?void 0:n.toLowerCase());o&&r&&Di.initOwlFrameWithTelemetry(o)}}()})(),((Microsoft=void 0===Microsoft?{}:Microsoft).Office=Microsoft.Office||{}).OWL=u})();