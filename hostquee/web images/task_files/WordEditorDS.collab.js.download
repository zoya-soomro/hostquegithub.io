'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1389:function(J,L,d){d.r(L);d.d(L,"RtcUtils",function(){return l});J=d(0);var m=d(7),f=d(29),a=d(1577);class l{static mLb(w,z=a.a.cVb){let x;try{x=f.c(w)}catch(u){throw w=String.format("Failed to JSON-serialize payload : {0}",u),m.ULS.sendTraceTag(508396173,500,10,w),Error.argument("payload",w);}if(x.length>z)throw w=String.format("Payload exceeds maximum length: {0} > {1}.",x.length,z),m.ULS.sendTraceTag(508396171,
500,10,w),Error.argument("payload",w);return x}static deserialize(w,z,x){if(!w)return null;if(Object.getType(w)!==String){var u=String.format("Failed to deserialize [{0}] - object is not of type [String] and is instead of type [{1}]. ExtraInfo: [{2}].",z,Object.getType(w).getName(),x);m.ULS.sendTraceTag(508396170,500,10,u);return null}u=null;try{u=f.a(w)}catch(v){w=String.format("Failed to deserialize [{0}]. Exception deserializing the object : [{1}]. ExtraInfo: [{2}].",z,v,x),m.ULS.sendTraceTag(508396168,
500,10,w)}return u}static pma(w){if(!w)return"";if("string"===typeof w)return w.toString();try{return f.c(w)}catch(z){return w.toString()}}static wBf(w){let z,x,u;z=0;u=x=null;if(!w)return{R5c:z,S5c:x,vk:u};try{const v=w.source;v&&Object.getType(v)===String&&(u=v);const E=w.context;E&&(w=E,z=w.status?w.status:0,x=w.statusText?w.statusText:null)}catch(v){}return{R5c:z,S5c:x,vk:u}}}Object(J.a)(l,"RtcUtils",null,[])},1432:function(J,L,d){d.r(L);J=d(0);var m=d(7),f=d(108),a=d(86),l;(function(u){u[u.SendNotification=
0]="SendNotification";u[u.SendPersistentState=1]="SendPersistentState";u[u.FindSession=2]="FindSession";u[u.Last=3]="Last"})(l||(l={}));Object(J.b)("ApiType",l);var w;(function(u){u[u.AttemptCount=0]="AttemptCount";u[u.SuccessCount=1]="SuccessCount";u[u.DropCount=2]="DropCount";u[u.FailedCount=3]="FailedCount";u[u.LatencyOverThresholdCount=4]="LatencyOverThresholdCount";u[u.LatencyUnderThresholdCount=5]="LatencyUnderThresholdCount";u[u.ThrottledCount=6]="ThrottledCount";u[u.Last=7]="Last"})(w||(w=
{}));Object(J.b)("EventCountType",w);var z=d(1576);d.d(L,"FrequentLoggingMetrics",function(){return x});class x{constructor(u){this.GVc=this.X_c=null;this.hcd=this.K0c=0;this.Lk=null;this.pKc=this.sFb=0;this.Gf=u;this.hUf();this.dDb=this.RGc=this.CFb=!1;this.e3a=0}get kBf(){return this.dDb}hEg(u){this.pKc=u;window.setInterval(Object(f.a)(this,this.DUb,"logMetricsBatchAndReset"),u);this.sFb=(new Date).getTime()}Ts(u,v){this.IAg(u)&&!this.RGc||this.kBf||!window.navigator.onLine||this.Gf.pta||(this.Lk[u][v]++,
this.CFb=!0)}hUf(){this.Lk=Array(3);for(let u=0;3>u;u++){this.Lk[u]=Array(7);for(let v=0;7>v;v++)this.Lk[u][v]=0}}llf(){const u={};for(let v=0;3>v;v++)for(let E=0;7>E;E++)this.K0f(v,E)&&(u[l[v]+w[E]]=this.Lk[v][E]);u.FSDomain=this.X_c;u.ConnectionDomain=this.GVc;u.FSRetryInterval=this.K0c;u.MaxPayloadSize=this.hcd;u.LogNumber=this.e3a;1===this.e3a&&(u.FSLatencies=z.a.instance.DIf(),u.ConLatencies=z.a.instance.XGf());return u}K0f(u,v){return 2===u&&3!==v&&0!==v?!1:!0}IAg(u){return 2===u?!1:!0}DUb(){if(this.CFb){this.e3a++;
if((new Date).getTime()-this.sFb<5E3+this.pKc){var u=a.a.toJSON(this.llf());m.ULS.sendTraceTag(50644352,500,15,u)}this.sFb=(new Date).getTime();for(u=0;3>u;u++)for(let v=0;7>v;v++)this.Lk[u][v]=0;this.CFb=!1}}Y6f(){this.RGc=!0}static get instance(){return x._instance}static create(u){x.instance||(x._instance=new x(u));return x.instance}}x._instance=null;Object(J.a)(x,"FrequentLoggingMetrics",null,[1798])},1576:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m{constructor(){this.EPc=!1;
this.OGa=null;this.FEc=0;this.mDb=this.oXc(6);this.r1a=this.oXc(6);this.bda=this.cpa=0;this.Tp=()=>new Date}get hFg(){return this.EPc}oXc(f){f=Array(f);for(let a=0;a<f.length;a++)f[a]=0;return f}DIf(){return this.mDb.toString()}XGf(){return this.r1a.toString()}iEg(){this.OGa=this.Tp()}hNa(f,a,l=!1){this.hFg||(l&&(this.EPc=!0),l=this.Tp(),0===f&&5<this.cpa||1===f&&5<this.bda||(this.FEc<f?(1===this.cpa%2&&(this.mDb[this.cpa]=-1,this.cpa++),this.FEc=f,1===a&&(this.r1a[this.bda]=-1,this.bda++),this.r1a[this.bda]=
this.G0b(l),this.bda++):0===f?(this.mDb[this.cpa]=this.G0b(l),this.cpa++):(this.r1a[this.bda]=this.G0b(l),this.bda++)))}G0b(f){const a=f.getTime()-this.OGa.getTime();this.OGa=f;return a}static get instance(){m._instance||(m._instance=new m);return m._instance}static set instance(f){m._instance=f}}m._instance=null;Object(J.a)(m,"LatencyMetrics",null,[])},1577:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m{}m.icd=31E3;m.cVb=8E3;Object(J.a)(m,"RealtimeChannelStaticConstants",null,[])},
1608:function(J,L,d){d.r(L);J=d(0);var m=d(7),f=d(108),a=d(333),l=d(874),w=d(94),z=d(2),x=d(1892),u=d(46),v=d(1576);class E{constructor(ua,Sa){this.data=ua;this.timeStamp=Sa}}Object(J.a)(E,"PresenceData",null,[]);class y{constructor(ua){this.X5=!1;this.kHa=0;this.UBb=!1;this.E5f=()=>{m.ULS.sendTraceTag(4539720,500,50,"Usage statement for the Rtc_ConnectedEver KPI for [{0}]",this.Ck)};this.setTimeout=y.SMb;this.clearTimeout=y.QMb;this.R5f=this.E5f;this.Ck=ua}vdg(){this.X5||(this.kHa=this.setTimeout(()=>
{this.X5=!1;this.xbd()},8E3),this.X5=!0,this.UBb=!1)}Hdg(){this.GT()}$fg(){this.xbd()}xbd(){this.GT();this.UBb||(this.UBb=!0,this.R5f())}GT(){this.X5&&this.clearTimeout(this.kHa);this.kHa=0;this.X5=!1}static SMb(ua,Sa){return window.setTimeout(ua,Sa)}static QMb(ua){window.clearTimeout(ua)}}Object(J.a)(y,"ConnectedUsageKpiLogger",null,[1813]);class H{constructor(){this.Sid=this.qYb;this.Vid=this.tYb;this.Uid=this.sYb;this.Xid=this.vYb;this.Wid=this.uYb;this.AYb=this.BYb;this.Rcb=this.yYb;this.Jga=
this.wYb;this.Mua=this.xYb;this.Tid=this.rYb;this.yCa=this.yVb;this.mYa=this.zVb}qYb(){}tYb(){}sYb(){}vYb(){}uYb(){}yYb(){}xYb(){}wYb(){}BYb(){}rYb(){}yVb(){}zVb(){}}Object(J.a)(H,"NoopRealtimeChannelMetrics",null,[1806,325]);class I{}I.ePa="presenceUpdated";I.updateNotification="updateNotification";I.tgd="persistentStateCleared";I.updatePersistentState="persistentStateUpdated";Object(J.a)(I,"RtcClientMethodNames",null,[]);class F{}F.BSf="realtimeChannelHub";F.ePa="UpdatePresence";F.fC="SendUpdateNotification";
F.cPb="GetCompletePersistentStateWithMetadata";F.updatePersistentState="UpdatePersistentState";F.c9="UpdateClientInfo";Object(J.a)(F,"RtcHubMethodNames",null,[]);class C{constructor(ua){this.Qp=ua}oqg(ua){this.Qp.on(I.ePa,ua)}vqg(ua){this.Qp.on(I.updateNotification,ua)}mqg(ua){this.Qp.on(I.updatePersistentState,ua)}lqg(ua){this.Qp.on(I.tgd,ua)}iKg(ua){this.Qp.off(I.ePa,ua)}lKg(ua){this.Qp.off(I.updateNotification,ua)}hKg(ua){this.Qp.off(I.updatePersistentState,ua)}gKg(ua){this.Qp.off(I.tgd,ua)}ePa(ua){return this.Qp.invoke(F.ePa,
ua)}c9(ua){return this.Qp.invoke(F.c9,ua)}fC(ua,Sa){return this.Qp.invoke(F.fC,ua,Sa)}cPb(ua){return this.Qp.invoke(F.cPb,ua)}updatePersistentState(ua,Sa){return this.Qp.invoke(F.updatePersistentState,ua,Sa)}}Object(J.a)(C,"RealtimeChannelProxy",null,[1810,1811,1812]);var P=d(1577);class K{constructor(){this.pBb=this.SCc=!1;this.oBb=0;this.IBb=this.VHb=this.UHb=this.fBb=!1;this.nDb=0;this.bOc=!1;this.aOc=this.$Nc=0;this.uHb=!1;this.yHb=this.wHb=this.zHb=this.vHb=0;this.xHb=!1}get ajf(){return this.pBb}get $if(){return this.oBb}get SPh(){return this.fBb}get cBg(){return this.UHb}get dBg(){return this.VHb}get kof(){return this.IBb}get i8a(){return this.nDb}get jvg(){return this.bOc}get xld(){return this.$Nc}get ivg(){return this.aOc}get fvg(){return this.uHb}get gvg(){return this.vHb}get Cld(){return this.zHb}get yld(){return this.wHb}get Ald(){return this.yHb}get zld(){return this.xHb}static createInstance(ua){return ua?
Object.assign(new K,{SCc:ua.$("AwayStatusManagerIsEnabled"),pBb:ua.$("AwayStatusOneMinuteTimeoutIsEnabled"),oBb:ua.ic("AwayCoauthorThresholdMs",9E5),fBb:ua.$("RtcAllowCrossDomainAccessEnabled"),UHb:ua.$("ShouldLogOnContentNotification"),VHb:ua.$("ShouldLogOnHostSubscriptionNotification"),IBb:ua.$("RtcClientMetricsEnabled"),nDb:ua.ic("RtcFindSessionRequestTimeoutInMS",6E4),bOc:ua.$("RtcJsClientFrequentlyLogsMetrics"),$Nc:ua.ic("RtcJsClientFrequentMetricsLatencyThresholdInMS",1E3),aOc:ua.ic("RtcJsClientFrequentMetricsLogIntervalInMS",
3E5),uHb:ua.$("RtcClientMessageTelemetryEnabled"),vHb:ua.ic("RtcClientMessageTelemetrySampleSize",5),zHb:ua.ic("RtcSendTelemetryMessageIntervalInMS",3E5),wHb:ua.ic("RtcLogClientMessageMetricsTimeOutInMs",2E4),yHb:ua.ic("RtcMaxPayloadSizeInCharactersOverride",P.a.cVb),xHb:ua.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RTCLogSignalrHeartBeatMessages",!1)}):Object.assign(new K,{SCc:!1,pBb:!1,oBb:9E5,fBb:!1,UHb:!1,VHb:!0,IBb:!1,nDb:9E4,uHb:!1,vHb:5,zHb:3E5,wHb:2E4,yHb:P.a.cVb,xHb:!1})}}Object(J.a)(K,
"RealtimeChannelSettings",null,[1809]);var G=d(1763),R=d(83),W=d(152);class Z{constructor(ua){this.Zda=null;this.eV=0;this.Vea=!1;this.Ae=ua;this.Ae.NZ(Object(f.a)(this,this.DN,"onConnectionStateChanged"))}DN(ua,Sa){this.eV=Sa.newState}cfd(){m.ULS.sendTraceTag(18637070,500,15,"Too many undelivered messages. Restarting RTC connection.");this.Ae.Mcb()}QTf(ua){this.Zda.init(ua)}}Object(J.a)(Z,"ARtcMessageHandler",null,[]);var T=d(300),N=d(1708),U=d(86);class ba{constructor(ua,Sa=""){this.JHb=ua;this.gZ=
Sa}send(){return this.JHb()}get messageId(){return this.gZ}}Object(J.a)(ba,"MessageHandler",null,[1820]);var X=d(1620);class Y extends Sys.EventArgs{constructor(ua,Sa,Ta,zb){super();this.dZb=ua;this.reconnectDelay=Sa;this.reason=Ta;this.WZb=zb}}Object(J.a)(Y,"RefreshConnectionReconnectArgs",Sys.EventArgs,[]);var ca=d(1704);class ia{constructor(){this.kIb=this.ji=null}get Ei(){return this.ji?this.kIb?this.kIb.getTime()-this.ji.getTime():(new Date).getTime()-this.ji.getTime():0}start(){this.ji=new Date}stop(){this.kIb=
new Date}}Object(J.a)(ia,"SimpleStopwatch",null,[]);var la=d(1709),ta=d(1894),za=d(758),Ha=d(597),Na=d(598);class ya extends Z{constructor(ua,Sa,Ta,zb,Ra,qb,kb,Va,Za,Ka){super(kb);this.Qp=null;this.kKc=this.lKc=!1;this.gZ=0;this.CGb=new W.a;this.xYe=ya.lHf();this.nGb=z.AFrameworkApplication.J.ib("OwningFeatureCrewForRtcNotificationKpis");this.Ne=ua;this.vLc=this.uLc=0;this.Zda=Sa;this.Zda.G5a(Object(f.a)(this,this.cfd,"onTooManyUndeliveredMessages"));this._clientId=Ta;this.o4e=Ra;this.Ae.tff(Object(f.a)(this,
this.Ued,"onRefreshProxyRequired"));this.Ae.rff(Object(f.a)(this,this.Ted,"onRefreshAllPersistentStateRequest"));this.Ae.xff(Object(f.a)(this,this.fC,"sendUpdateNotification"));this.Ae.Uef(Object(f.a)(this,this.Bed,"onInternalPresenceUpdated"));this.Ae.Vef(Object(f.a)(this,this.Ced,"onInternalUpdateNotificationReceived"));this.Ae.Tef(Object(f.a)(this,this.Aed,"onInternalPersistentStateUpdated"));this.Ae.Sef(Object(f.a)(this,this.zed,"onInternalPersistentStateCleared"));this.Ae.wff(Object(f.a)(this,
this.NDa,"sendPersistentState"));this.Ae.Cff(Object(f.a)(this,this.c9,"updateClientInfo"));this.Xd=qb;this.Ck=zb;this.Lk=Va;this.Xv=Za;this.rGa=Ka;this.Vha=Object(R.a)(String,z.AFrameworkApplication.sessionStartInfoSettings.Application)||""}Ued(ua,Sa){this.Qp=this.o4e(Sa.hubConnection);this.Zda.reset();this.Qp.oqg(Object(f.a)(this,this.TU,"onPresenceUpdated"));this.Qp.mqg(Object(f.a)(this,this.sga,"onPersistentStateUpdated"));this.Qp.lqg(Object(f.a)(this,this.DYa,"onPersistentStateCleared"));this.Qp.vqg(Object(f.a)(this,
this.aS,"onUpdateNotificationReceived"))}DN(ua,Sa){this.eV=Sa.newState;2===Sa.newState&&this.Rwg()}Rwg(){for(const ua of this.CGb)this.fC(null,new ca.a(ua.key,ua.value,!1,new a.a));this.CGb=new W.a}Ted(ua,Sa){Sa.qLb();for(ua=0;3>ua;++ua)this.Lwg(ua,Sa)}Lwg(ua,Sa){try{this.Qp.cPb(ua).done(Ta=>{Sa.awa(Sa.aUa,"GetCompletePresenceSuccess")&&(Sa.aqf.$fg(),m.ULS.sendTraceTag(3249540,500,50,"Successfully retrieved complete session state for [{0}] of type [{1}]",this.Ck,ua),this.Ae.Hog(),this.sfg(ua,Ta),
this.Ae.uog(Ta),Sa.k_c.lb(ua)&&this.Ae.Gid(ua,Sa.k_c.K(ua),new a.a))}).fail(Ta=>{const {RtcUtils:zb}=d(1389);Sa.awa(Sa.aUa,"GetCompletePresenceFail")&&(m.ULS.sendTraceTag(3249541,500,15,"Failed to retrieve complete session state : {0} for [{1}] of type [{2}]",zb.pma(Ta),this.Ck,ua),this.Ae.Mcb())}).always(()=>{Sa.kz&&Sa.kz.stop()})}catch(Ta){m.ULS.sendTraceTag(595132428,500,10,"Exception thrown while calling hub method GetCompletePersistentStateWithMetadata. Promise not even created. Current event token: {0}, Exception message: {1}",
Sa.aUa,Ta.message)}}NDa(ua,Sa){var {RtcUtils:Ta}=d(1389);ua=Sa.JI;let zb;const Ra=Sa.Kna;this.Xv.Ts(1,0);try{zb=Ta.mLb(ua,this.rGa)}catch(kb){this.Xv.Ts(1,3);m.ULS.sendTraceTag(574407636,500,10,"Exception thrown while trying to serialize presence. Exception message: {0}",kb.message);Ra.setException(kb);return}Ta=new w.a;Ta.Z(this._clientId,Object.assign(new N.a,{Presence:ua,TimeStamp:(new Date).getTime()}));this.Ae.Iid(Sa.type,Ta);if(2!==this.eV)this.Lk.Jga(),this.Xv.Ts(1,2),Ra.hg(null);else{var qb=
this.gZ.toString();++this.gZ;ua=new ba(()=>this.Swg(Sa.type,zb,qb),qb);ua=this.Kqd(0,Sa.type).add(ua);ua.Vbb(kb=>{2===kb&&(this.Xv.Ts(1,6),this.kKc||2!==Sa.type||m.ULS.sendTraceTag(508651234,500,15,"First persistent state update of type LiveMeeting for [{0}] was throttled",this.Ck));Ra.hg(null)});ua.Ubb(()=>{})}}Swg(ua,Sa,Ta){let zb=null;const Ra=new ia,qb=new X.a;m.ULS.sendTraceTag(3249501,500,50,"Sending presence update for [{0}] of type [{1}]",this.Ck,ua);if(2!==this.eV)return this.Lk.Jga(),this.Xv.Ts(1,
2),m.ULS.sendTraceTag(7934171,500,15,"Connection is lost - unable to send the message for [{0}] of type [{1}]",this.Ck,ua),qb.VUb(),qb;this.Xd&&20>this.uLc&&(zb=this.Xd.Wf("WebServiceCall","Send Presence Message"),this.uLc++);Ra.start();qb.VLa(1);try{this.Qp.updatePersistentState(ua,Sa).done(()=>{this.Lk.Rcb();this.Xv.Ts(1,1);m.ULS.sendTraceTag(3249502,500,50,"Successfully delivered presence update message [{0}] for [{1}] of type [{2}]",Ta,this.Ck,ua);qb.K7(1);Ra&&(Ra.stop(),Ra.Ei>this.Ne.xld?this.Xv.Ts(1,
4):this.Xv.Ts(1,5))}).fail(kb=>{const {RtcUtils:Va}=d(1389);this.Vea||(this.Lk.Jga(),this.Xv.Ts(1,3),this.kKc||2!==ua||m.ULS.sendTraceTag(508651233,500,15,"First persistent state update of type LiveMeeting for [{0}] failed",this.Ck),m.ULS.sendTraceTag(3249503,500,15,"Server failed to process the presence update message [{0}]: [{1}] for [{2}]",Ta,Va.pma(kb),this.Ck));qb.K7(2)}).always(()=>{zb&&zb.stop()})}catch(kb){m.ULS.sendTraceTag(593072906,500,15,"Exception when invoking hub method UpdatePersistentState, error: {1}",
kb.message),this.Xv.Ts(1,3),this.kKc||2!==ua||m.ULS.sendTraceTag(508651232,500,15,"First persistent state update of type LiveMeeting for [{0}] hit an exception",this.Ck),qb.K7(2)}return qb}c9(ua,Sa){({RtcUtils:ua}=d(1389));const Ta=Sa.Q1h,zb=Sa.Kna;let Ra;try{Ra=ua.mLb(Ta,this.rGa)}catch(qb){m.ULS.sendTraceTag(544318999,500,10,"Exception thrown while trying to serialize clientInfo. Exception message: {0}",qb.message);zb.setException(qb);return}try{this.Qp.c9(Ra).done(()=>{m.ULS.sendTraceTag(544319E3,
500,50,"Successfully delivered clientInfo.")}).fail(qb=>{const {RtcUtils:kb}=d(1389);this.Vea||m.ULS.sendTraceTag(544319001,500,15,"Server failed to process udpate clientInfo: {0}.",kb.pma(qb));zb.hg(null)})}catch(qb){m.ULS.sendTraceTag(544319002,500,15,"Exception when invoking hub method UpdateClientInfo: error: {0}",qb.message),zb.hg(null)}}fC(ua,Sa){({RtcUtils:ua}=d(1389));const Ta=Sa.type,zb=Sa.iA,Ra=Sa.Hvf,qb=Sa.Kna;let kb;this.Xv.Ts(0,0);try{kb=ua.mLb(zb,this.rGa)}catch(Za){this.Xv.Ts(0,3);
m.ULS.sendTraceTag(574407637,500,10,"Exception thrown while trying to serialize updateHint. Exception message: {0}",Za.message);qb.setException(Za);return}if(2!==this.eV)Ra?this.CGb.Z(Ta,zb):(this.Lk.Jga(),this.Xv.Ts(0,2)),qb.hg(null);else{var Va=this.gZ.toString();++this.gZ;Sa=new ba(()=>this.jxg(Ta,kb,Va),Va);Sa=this.Kqd(1,Ta).add(Sa);Sa.Vbb(Za=>{2===Za&&this.Xv.Ts(0,6);qb.hg(null)});Sa.Ubb(()=>{})}}jxg(ua,Sa,Ta){let zb=null;const Ra=new ia,qb=new X.a;m.ULS.sendTraceTag(3249505,500,50,"Sending update notification for [{0}] of type [{1}]",
this.Ck,ua);if(2!==this.eV)return this.Lk.Jga(),this.Xv.Ts(0,2),m.ULS.sendTraceTag(7934172,500,15,"Connection is lost - unable to send the message for [{0}]",this.Ck),qb.VUb(),qb;this.Xd&&3===ua&&20>this.vLc&&(zb=this.Xd.Wf("WebServiceCall","Send WetContent Update"),this.vLc++);Ra.start();qb.VLa(1);this.Qp.fC(ua,Sa).done(()=>{this.Lk.Rcb();this.Xv.Ts(0,1);m.ULS.sendTraceTag(3249506,500,50,"Successfully delivered update notification message [{0}] for [{1}] of type [{2}]",Ta,this.Ck,ua);qb.K7(1);Ra&&
(Ra.stop(),Ra.Ei>this.Ne.xld?this.Xv.Ts(0,4):this.Xv.Ts(0,5))}).fail(kb=>{const {RtcUtils:Va}=d(1389);this.Vea||(this.Lk.Jga(),this.Xv.Ts(0,3),m.ULS.sendTraceTag(3249507,500,15,"Server failed to process the update notification message [{0}] : [{1}] for [{2}]",Ta,Va.pma(kb),this.Ck));qb.K7(2)}).always(()=>{zb&&zb.stop()});return qb}tY(){this.Qp.iKg(Object(f.a)(this,this.TU,"onPresenceUpdated"));this.Qp.hKg(Object(f.a)(this,this.sga,"onPersistentStateUpdated"));this.Qp.gKg(Object(f.a)(this,this.DYa,
"onPersistentStateCleared"));this.Qp.lKg(Object(f.a)(this,this.aS,"onUpdateNotificationReceived"))}awf(){this.Dtg();this.Ae.Xrg(Object(f.a)(this,this.Ued,"onRefreshProxyRequired"));this.Ae.Vrg(Object(f.a)(this,this.Ted,"onRefreshAllPersistentStateRequest"));this.Ae.asg(Object(f.a)(this,this.fC,"sendUpdateNotification"));this.Ae.Lrg(Object(f.a)(this,this.Bed,"onInternalPresenceUpdated"));this.Ae.Mrg(Object(f.a)(this,this.Ced,"onInternalUpdateNotificationReceived"));this.Ae.Krg(Object(f.a)(this,this.Aed,
"onInternalPersistentStateUpdated"));this.Ae.Jrg(Object(f.a)(this,this.zed,"onInternalPersistentStateCleared"));this.Ae.$rg(Object(f.a)(this,this.NDa,"sendPersistentState"));this.Ae.csg(Object(f.a)(this,this.c9,"updateClientInfo"))}Bed(ua,Sa){this.TU(Sa.Oha,Sa.AYc)}TU(ua){this.Lk.Mua();this.sga(0,ua)}Aed(ua,Sa){this.sga(Sa.type,Sa.Oha)}sfg(ua,Sa){const Ta={};for(const zb in Sa)Ta[zb]=Sa[zb].Presence;this.Ned(ua,Ta,Sa)}sga(ua,Sa){this.Lk.Mua();this.Ned(ua,Sa)}Ned(ua,Sa,Ta=null){var {RtcUtils:zb}=d(1389);
if(m.ULS.i4(500,100))for(var Ra in Sa);delete Sa[this._clientId];if(!U.a.isEmpty(Sa)){for(var qb in Sa)Ra=qb,Sa[Ra]=zb.deserialize(Sa[qb],"Presence",Ra,!1,this.rGa);zb=new w.a;qb=(new Date).getTime();for(const kb in Sa){Ra=Sa[kb];const Va=kb;let Za;Ta?(Za=Ta[Va],Za.Presence=Ra):Za=Object.assign(new N.a,{Presence:Ra,TimeStamp:qb});zb.Z(Va,Za)}this.Ae.Iid(ua,zb);switch(ua){case 0:this.lKc||(m.ULS.sendTraceTag(4539734,500,50,"Raising first presence update notification for [{0}]",this.Ck),this.lKc=!0,
z.AFrameworkApplication.gh&&z.AFrameworkApplication.gh.Haj());this.Ae.Cid(Sa,[]);break;case 2:this.kKc||(m.ULS.sendTraceTag(508867081,500,50,"Raising first live meeting update notification for [{0}]",this.Ck),this.kKc=!0);this.Ae.dse(ua,Sa);break;default:this.Ae.dse(ua,Sa)}}}zed(ua,Sa){this.DYa(Sa.dnb)}DYa(ua){this.Lk.Mua();if(m.ULS.i4(500,100))for(let Sa=0;Sa<ua.length;++Sa);ua.length&&(this.Ae.Kog(ua),this.Ae.Cog(ua),this.Ae.Cid({},ua))}Ced(ua,Sa){this.aS(Sa.type,Sa.iA)}aS(ua,Sa=null){this.Ne.cBg&&
0===ua&&m.ULS.sendTraceTag(40128990,500,50,"Received ContentUpdate notification from the server");if(0===ua&&this.nGb&&0<this.nGb.length){var Ta=Object.assign(new za.a,{topLevelKpiName:"ContentUpdateNotificationReceived",featureName:"RtcNotification",crewAlias:this.nGb,vetoPillar:"RealTimeCoauth"});(Ta=T.a.getInstance(Ta))&&Ta.logKpiUsage(this.xYe)}this.Ne.dBg&&13===ua&&m.ULS.sendTraceTag(575221780,500,50,String.format("Received HostSubscription notification from the server : {0}",Sa||"<none>"));
this.Lk.Mua();5===ua?(Sa=(ua=this.Gig(Sa))?String.format("Received client reconnection request from the server. Reason: {0}, Backoff time: {1} ",ua.reason,ua.reconnectDelay):"Received client reconnection request from the server without params.",m.ULS.sendTraceTag(18637071,500,50,Sa),this.Ae.Mcb(ua)):(Sa=d(1389).RtcUtils.deserialize(Sa,String.format("UpdateNotification-{0}",ta.a[ua]),null,!1,this.rGa),this.Ae.Jog(ua,Sa))}Gig(ua){try{if(!ua||""===ua)return null;const Sa=JSON.parse(ua);return new Y(Sa[la.a.FZb],
Sa[la.a.evg],Sa[la.a.hvg],Sa[la.a.WZb])}catch(Sa){return m.ULS.sendTraceTag(593844380,500,15,"Error when parsing reconnect hint: {0}",Sa.message),null}}Kqd(ua,Sa){return this.Zda.RNf(this.SNf(ua,Sa))}SNf(ua,Sa){return ua+","+Sa}Dtg(){this.Zda.reset();this.Zda.ckd(Object(f.a)(this,this.cfd,"onTooManyUndeliveredMessages"))}static lHf(){var ua=new Map;ua.set("SkipAria","True");ua=Object.assign(new Ha.a,{extendedProperties:ua});return Object.assign(new Na.a,{kpiName:"ContentUpdateNotificationReceived",
kpiType:0,optionalProperties:ua,blockFutureEmissionDurationInMs:3E5})}}Object(J.a)(ya,"RtcMessageHandler",Z,[]);class ma{ZWc(ua,Sa=""){const {MaxOutstandingThrottler:Ta}=d(1705);return Ta.createInstance(ua,Sa)}Hsf(ua,Sa=""){const {MaxRateThrottler:Ta}=d(1707);return Ta.createInstance(ua,Sa)}}Object(J.a)(ma,"ThrottlerFactory",null,[1808]);var Ea=d(88),Ba=d(1710);class $a{constructor(ua){this.Ne=null;this.ui=!1;this.sa=new Ea.a;this.yFb=new w.a;this.xFb=new w.a;this.FIb=ua;this.hpa=this.FIb.ZWc(Sa=>
Sa.send(),"GlobalMaxOustandingThrottler");this.hpa.G5a(()=>{this.sa.raiseEvent("TMUDM")})}init(ua){this.ui||(this.Ne=ua,this.hpa.init(this.Ne.U8,this.Ne.VOf),this.ui=!0)}RNf(ua){var {MaxRateThrottler:Sa}=d(1707),{MaxOutstandingThrottler:Ta}=d(1705);this.ui||this.init(new Ba.a(Sa.RXc,Ta.VXc,Ta.TXc,$a.n7f));({value:Sa}=this.yFb.Ac(ua)).returnValue||(({value:Sa}=this.xFb.Ac(ua)).returnValue||(Sa="MaxOutstandingThrottler-"+ua,Sa=this.FIb.ZWc(Object(f.a)(this.hpa,this.hpa.add,"add"),Sa),Sa.init(this.Ne.U8,
this.Ne.m7f),Sa.G5a(()=>{this.sa.raiseEvent("TMUDM")}),this.xFb.add(ua,Sa)),Ta="MaxRateThrottler-"+ua,Sa=this.FIb.Hsf(Object(f.a)(Sa,Sa.add,"add"),Ta),Sa.init(this.Ne.V7f),this.yFb.add(ua,Sa));return Sa}reset(){for(const ua of this.yFb)ua.value.zYb();for(const ua of this.xFb)ua.value.zYb(),ua.value.reset();this.hpa.zYb();this.hpa.reset()}G5a(ua){this.sa.addHandler("TMUDM",ua)}ckd(ua){this.sa.removeHandler("TMUDM",ua)}}$a.n7f=1E3;Object(J.a)($a,"ThrottlerManager",null,[1807]);var ea=d(1895);const ka=
(ua,Sa,Ta,zb,Ra,qb,kb,Va,Za=null,Ka=null,bb=null,Ib=null)=>{const ib=K.createInstance(z.AFrameworkApplication.J),jb=z.AFrameworkApplication.buildVersion?z.AFrameworkApplication.buildVersion:"1.0",hb=La(ua,Sa,kb,jb),pb=ib.kof?d(1893).RealtimeChannelMetrics.createInstance(hb):new H;var ob=d(1432).FrequentLoggingMetrics.create(Ra);ib.jvg&&ob.hEg(ib.ivg);var sb="";sb=Za&&""!==Za?Za:"/rtc2/";ob.X_c=u.a.kU(sb);const Ab=sb+"signalr";Za=sb+"findsession";const nc=F.BSf;sb=new ma;bb=bb||G.a.getInstance();m.ULS.shipAssertTag(508396228,
500,ib.Ald<=P.a.icd,"Client attempting to override max payload size beyond absolute limit");const qc=Math.min(ib.Ald,P.a.icd);ob.hcd=qc;ob=new ya(ib,new $a(sb),ua,hb,Jc=>new C(Jc.createHubProxy(nc)),Va,bb,pb,ob,qc);Ka||(Ka=d(1986).FindSessionStrategy.createInstance(Sa,Ra,Za,Va,jb,kb,ua,hb,bb,qb,zb,Ib));Ka.i8a=ib.i8a;Sa=new y(hb);Ta=Ta?Ta.split(","):null;ua=new (d(1608).RealtimeChannel)(ua,Ta,hb,Va,()=>$.hubConnection(Ab),Ka,ob,Sa,bb,pb,ib,Ra);ua.init();return ua},La=(ua,Sa,Ta)=>String.format("ClientID={0}, App={1}, ClientType={2}, SessionId={3}",
ua,va(ea.a[Ta]),va("browser"),Sa),va=ua=>ua?ua.charAt(0).toLocaleUpperCase()+ua.substring(1,ua.length):ua;d.d(L,"RealtimeChannel",function(){return Ca});class Ca{constructor(ua,Sa,Ta,zb,Ra,qb,kb,Va,Za,Ka,bb,Ib){this.jIb=!1;this.wH=null;this.Hy=new w.a;this.ywa=1;this.eia=null;this.fm=!1;this.h8b=(new Date(0)).getTime();this.Qkb=0;this.Apd=()=>{const ib=this.ywa;this.jIb=!1;this.Lk.Sid();this.o9.vMf(this.Ypf,this.oed,Object(f.a)(this.D0,this.D0.QTf,"initThrottlerManager"),Object(f.a)(this,this.awa,
"verifyConnectionToken"),ib)};this.oed=(ib=null)=>{this.Lk.Uid();let jb=null;!ib||"documentsessiondeleted"!==(jb=ib.toLowerCase())&&"documentsessionexpired"!==jb?this.mJa():(m.ULS.sendTraceTag(508396225,500,15,"In RealtimeChannel method OnFailureToConnect: Disconnect was called for [{0}], due to non-retriable RtcErrorCode:{1}",this.Ck,ib),this.disconnect())};this.mJa=(ib,jb=null)=>{m.ULS.sendTraceTag(508396224,500,50,"Disconnecting the connection [{0}]",this.wH);ib=(ib=2===this.ik||1===this.ik)&&
!this.D0.Vea;let hb=!0,pb=0;jb&&Object.getType(jb)!==Object.getType(Sys.EventArgs.Empty)&&jb.dZb&&""!==jb.dZb&&(ib=!0,this.o9.pzg(jb.dZb),hb=jb.WZb,pb=jb.reconnectDelay);ib&&this.DN(1,this.ik);++this.ywa;this.D0.tY();this.BEg(hb);this.o9.kxf();this.cXc();ib&&window.setTimeout(this.Apd,Math.min(pb,3E4))};this.ksd=()=>{let ib=null;const jb=({correlationId:ib}=this.o9.m2c()).returnValue;this.eia.qs=jb;m.ULS.sendTraceTag(40768457,500,50,"Connection parameters refresh finished for client [{0}], CorrelationId:{1}",
this.Ck,ib)};this.Ypf=ib=>{const {FrequentLoggingMetrics:jb}=d(1432);this.h8b=(new Date).getTime();let hb=null;this.eia.qs=({correlationId:hb}=this.o9.m2c()).returnValue;this.Ne.SPh&&(this.eia.url=ib,jb.instance&&(jb.instance.GVc=u.a.kU(ib)));let pb=null;this.Xd&&(pb=this.Xd.Wf("WebServiceCall","ConnectToServer"));m.ULS.sendTraceTag(3290048,500,50,"Connecting to server for client [{0}]",this.Ck);ib={};this.pQc&&(ib.transport=1===this.pQc.length?this.pQc[0]:this.pQc);ib.pingInterval=null;v.a.instance.hNa(1,
0);ib.waitForPageLoad=!1;this.eia.start(ib,null).done(ob=>{this.Lk.Vid();v.a.instance.hNa(1,1,!0);m.ULS.sendTraceTag(508396195,500,50,"Successfully connected to server using connection [{0}], CorrelationId:{1}",ob.id,hb)}).fail(ob=>{m.ULS.sendTraceTag(3457858,500,15,"Failed to connect to server : connection string: {0}, CorrelationId:{1},  ClientDetails: [{2}]",this.o9.ew,hb,this.Ck);this.oed();this.Lk.Tid(ob);v.a.instance.hNa(1,1,!1);this.Ae.Eid(0,{["CorrelationId"]:hb,["ErrorDetails"]:ob,["ConnectionState"]:l.a[this.ik]})}).always(()=>
{const {FrequentLoggingMetrics:ob}=d(1432);pb&&pb.stop();ob.instance&&(ob.instance.dDb=!1)})};this.ffd=(ib,jb)=>{for(const hb of jb.$Lg)this.Hy.lb(hb.key)||this.Hy.Z(hb.key,new W.a),ib=hb.value,this.Hy.K(hb.key).Z(jb.type,new E(ib.Presence,new Date(ib.TimeStamp))),hb.key===this._clientId&&0===jb.type&&this.Ae.yog(ib.Presence)};this.efd=(ib,jb)=>{for(const hb of jb.dnb)this.Hy.remove(hb)};this.qLb=()=>{let ib;const jb=[];({value:ib}=this.Hy.Ac(this._clientId)).returnValue&&this.Hy.remove(this._clientId);
for(const hb of this.Hy.keys)Array.add(jb,hb);for(const hb of jb)this.Hy.remove(hb);ib&&this.Hy.Z(this._clientId,ib);this.Ae.wog(jb)};this._clientId=ua;this.pQc=Sa;this.ik=0;this.Xd=zb;this.TBb=Va;this.h6e=kb;this.hIe=Za;this.MMe=Ra;this.o9=qb;this.Ck=Ta;this.Lk=Ka;this.Ne=bb;this.Gf=Ib;this.ePc=1>100*Math.random()}get yba(){return this.o9.yba}set yba(ua){this.o9.yba=ua}get D0(){return this.h6e}get Ae(){return this.hIe}init(){this.Ae.sff(this.mJa);this.Ae.Eff(this.ffd);this.Ae.Dff(this.efd);this.Gf.y5a(this.Lk);
z.AFrameworkApplication.XI(()=>{const {FrequentLoggingMetrics:ua}=d(1432);this.Lk.AYb();ua.instance&&ua.instance.DUb()});this.cXc();this.YRl();this.Ae.yff(this.ksd)}YRl(){try{const Ta=$.signalR;if(!Ta)throw Error.invalidOperation("Failed to retrieve Signalr object");const zb=Ta.version;if(!zb)throw Error.invalidOperation("Signalr object is missing version information");if("2.1.1"===zb){var ua=Ta.transports;if(!ua)throw Error.invalidOperation("Failed to retrieve transports object");var Sa=ua.longPolling;
if(!Sa)throw Error.invalidOperation("Failed to retrieve longPolling object");if(!Sa.supportsKeepAlive)throw Error.invalidOperation("LongPolling object does not have a field called supportsKeepAlive");Sa.supportsKeepAlive=this.LHl()}}catch(Ta){m.ULS.sendTraceTag(508396227,500,15,"Failed to disable longPolling KeepAlives: {0}",Ta.message)}}LHl(){return()=>!1}cXc(){const ua=++this.ywa;this.h8b=(new Date(0)).getTime();this.eia=this.MMe();this.Ae.Gog(this.eia);this.eia.stateChanged(Sa=>{this.wdg(Sa,ua)});
this.eia.connectionSlow(Object(f.a)(this,this.$me,"onSlowConnection"));this.eia.error(Object(f.a)(this,this.Yme,"onSignalRError"));this.eia.log=Object(f.a)(this,this.Zme,"onSignalRLog")}awa(ua,Sa){return ua!==this.ywa?(m.ULS.sendTraceTag(508396226,500,50,"ConnectionToken verification failed for {0}",Sa),!1):!0}connect(){2!==this.ik&&1!==this.ik&&(m.ULS.sendTraceTag(4539721,500,50,"Starting a new RTC connection for client [{0}]",this.Ck),this.TBb.vdg(),v.a.instance.iEg(),this.DN(1,this.ik),this.Apd())}disconnect(){const {FrequentLoggingMetrics:ua}=
d(1432);0===this.ik?m.ULS.sendTraceTag(508396194,500,50,"Disconnect for [{0}] was called but the channel is already Disconnected",this.Ck):(this.Lk.Wid(),ua.instance&&(ua.instance.dDb=!0),m.ULS.sendTraceTag(508396193,500,50,"Starting explicit disconnect for [{0}]",this.Ck),this.D0.Vea=!0,this.TBb.Hdg(),this.DN(0,this.ik),this.mJa(),this.D0.Vea=!1)}BEg(ua){const Sa=this.$lf(),Ta=this.eia,zb=this.wH,Ra=()=>{if(this.jIb)m.ULS.sendTraceTag(508396191,500,15,"Stop connection was called twice, possibly on the same connection.");
else try{this.jIb=!0,Ta.stop(!0,ua)}catch(qb){m.ULS.sendTraceTag(508396192,500,15,"Stopping connection failed: {0}",qb.message)}};0<Sa?(m.ULS.sendTraceTag(508396190,500,50,"Waiting to stop connection [{0}]: [{1}] ms.",zb,Sa),window.setTimeout(Ra,Sa)):(m.ULS.sendTraceTag(508396189,500,50,"Stopping connection [{0}].",zb),Ra())}$lf(){let ua=0;0===this.eia.state&&(ua=this.h8b+Ca.n$j-(new Date).getTime(),0>ua&&(ua=0));return ua}get connectionState(){return this.ik}NZ(ua){this.Ae.NZ(ua)}GZa(ua){this.Ae.GZa(ua)}Twg(ua){this.NDa(0,
ua)}NDa(ua,Sa){const Ta=new a.a;this.Ae.Gid(ua,Sa,Ta);return Ta.task}Qya(ua){this.Ae.Qya(ua)}HZa(ua){this.Ae.HZa(ua)}Rlb(ua){this.Ae.Rlb(ua)}Uwb(ua){this.Ae.Uwb(ua)}Qlb(ua){this.Ae.Qlb(ua)}Twb(ua){this.Ae.Twb(ua)}Okc(ua){return this.uOf(ua,0)}Ypb(){return this.Xpb(0)}Xpb(ua){const Sa={};for(const Ta of this.Hy)Ta.value.lb(ua)&&(Sa[Ta.key]=Ta.value.K(ua).data);return Sa}uOf(ua,Sa){return this.Hy.lb(ua)&&this.Hy.K(ua).lb(Sa)?this.Hy.K(ua).K(Sa).data:null}CFf(){const ua=new W.a;if(!this.Hy.lb(this._clientId))return ua;
for(const Sa of this.Hy.K(this._clientId))ua.Z(Sa.key,Sa.value.data);return ua}fC(ua,Sa=null,Ta=!1){const zb=new a.a;this.Ae.lYb(ua,Sa,Ta,zb);return zb.task}BO(ua){this.Ae.BO(ua)}wDa(ua){this.Ae.wDa(ua)}UVa(ua){let Sa,Ta;return({value:Sa}=this.Hy.Ac(ua)).returnValue&&({value:Ta}=Sa.Ac(0)).returnValue?new x.a(this.vOf(Ta),Ta.timeStamp):null}Iic(){const ua={};for(const Sa of this.Hy)Sa.value.Ac(0).returnValue&&(ua[Sa.key]=this.UVa(Sa.key));return ua}c9(ua){const Sa=new a.a;this.Ae.fse(ua,Sa);return Sa.task}get clientId(){return this._clientId}get cDg(){return this.ePc}dispose(){var ua;
const {FrequentLoggingMetrics:Sa}=d(1432);if(!this.fm){if(null===(ua=z.AFrameworkApplication.J)||void 0===ua?0:ua.$("DetachRtcEventHandlerOnDispose"))this.$vf(),this.D0.awf();this.D0.tY();this.Gf.Duc(this.Lk);this.Lk.AYb();Sa.instance&&Sa.instance.DUb();this.fm=!0}}wdg(ua,Sa){this.awa(Sa,"StateChangedSignalR")&&this.DN(this.kWc(ua.newState),this.kWc(ua.oldState))}DN(ua,Sa){var {FrequentLoggingMetrics:Ta}=d(1432),{ClientToClientMessageTelemetry:zb}=d(1779);if((1!==this.ik||0!==Sa||1!==ua)&&this.ik!==
Sa){const Ra=String.format.apply(null,["Unexpected connection state change : Current state is '{0}' while the event indicates ('{1}'->'{2}') transition"].concat([this.ik,Sa,ua]));m.ULS.sendTraceTag(508396188,500,10,Ra)}if(this.ik!==ua){switch(ua){case 2:Ta.instance&&Ta.instance.Y6f();this.wH=this.eia.id;m.ULS.sendTraceTag(3249539,500,50,"Established connection [{0}] for client [{1}]",this.wH,this.Ck);this.N5f(this.eia);m.ULS.sendTraceTag(508396186,500,50,"Retrieving complete session state");Ta=null;
this.Xd&&(Ta=this.Xd.Wf("WebServiceCall","Receive First Presence"));zb=this.ywa;this.Ae.Fog(Object(f.a)(this,this.awa,"verifyConnectionToken"),zb,this.TBb,this.qLb,this.CFf(),Ta);this.Ne.fvg&&(Ta=100*Math.random()<=this.Ne.gvg,d(1779).ClientToClientMessageTelemetry.Fqb(this.Ae,this.Ne,Ta).start());break;case 1:2===Sa&&m.ULS.sendTraceTag(508396185,500,50,"Lost connection [{0}] to the server ...trying to re-establish it",this.wH);break;case 0:if(zb.instance&&zb.instance.stop(),this.D0.Vea)m.ULS.sendTraceTag(508396182,
500,50,"Connection [{0}] has been explicitly closed",this.wH);else{1===Sa&&(m.ULS.sendTraceTag(508396184,500,50,"Signalr detected an unexpected disconnect event while attempting to re-establish connection [{0}]. Kicking off global reconnect logic ...",this.wH),this.Lk.Xid());2===Sa&&m.ULS.sendTraceTag(508396183,500,50,"Signalr detected a disconnect event triggered by a period of client inactivity for connection [{0}]. Kicking off global reconnect logic ...",this.wH);this.mJa();return}}this.ik=ua;
this.Ae.pog(ua,Sa)}}$vf(){this.Ae.Wrg(this.mJa);this.Ae.esg(this.ffd);this.Ae.dsg(this.efd);this.Ae.bsg(this.ksd)}N5f(ua){if(ua&&ua.transport&&ua.transport.name){ua=ua.transport.name;var Sa=ua.toLowerCase();"websockets"===Sa?m.ULS.sendTraceTag(4290723,500,50,"Transport name - {0} for [{1}]",ua,this.Ck):"serversentevents"===Sa?m.ULS.sendTraceTag(4290752,500,50,"Transport name - {0} for [{1}]",ua,this.Ck):"foreverframe"===Sa?m.ULS.sendTraceTag(4290753,500,50,"Transport name - {0} for [{1}]",ua,this.Ck):
"longpolling"===Sa?m.ULS.sendTraceTag(4290754,500,50,"Transport name - {0} for [{1}]",ua,this.Ck):"mocktransport"!==Sa&&m.ULS.sendTraceTag(508396180,500,15,"Unknown transport protocol encountered - '{0}'",ua)}else m.ULS.sendTraceTag(508396181,500,10,"Transport protocol name is missing")}$me(){if(this.Ne.zld){const ua=u.a.wL(this.yba,"mid");m.ULS.sendTraceTag(508396178,500,15,"Detected that the connection [{0}] is slow for target machine [{1}]",this.wH,ua)}else m.ULS.sendTraceTag(508396177,500,50,
"Detected that the connection [{0}] is slow",this.wH)}Yme(){m.ULS.sendTraceTag(508396176,600,15,"SignalR ERROR for connection [{0}];",this.wH)}Zme(ua){ua=d(1389).RtcUtils.pma(ua);if(this.Ne.zld&&ua.startsWith("Keep alive timed out.")){const Sa=u.a.wL(this.yba,"mid");m.ULS.sendTraceTag(508396175,500,15,"SignalR lib: {0}. Target Machine: {1}",ua,Sa)}else this.cDg&&2E3>this.Qkb&&!ua.startsWith("Invok")&&!ua.startsWith("Trigger")&&(m.ULS.sendTraceTag(508396174,500,50,"SignalR lib: {0}",ua),this.Qkb++)}kWc(ua){switch(ua){case 0:return 1;
case 2:return 1;case 1:return 2;case 4:return 0;default:throw Error.argumentOutOfRange("state",ua,"Unknown SignalR state");}}vOf(ua){return ua&&ua.timeStamp?(new Date).getTime()-ua.timeStamp.getTime()>(this.Ne.ajf?6E4:this.Ne.$if)?2:1:1}static createInstance(ua,Sa,Ta,zb,Ra,qb,kb,Va=null,Za=null,Ka=null,bb=null,Ib=null,ib=null){return ka(ua,Sa,Ta,ib,zb,Ra,qb,kb,Va,Za,Ka,Ib,bb)}}Ca.n$j=15E3;Object(J.a)(Ca,"RealtimeChannel",null,[1783,1573])},1620:function(J,L,d){J=d(0);class m{constructor(){this.tDc=
this.PBb=!1;this.callback=null}jvb(a){this.callback=a;this.Brd()}Xbd(a){this.PBb||(this.PBb=!0,this.GMe=a,this.Brd())}Brd(){this.PBb&&this.callback&&!this.tDc&&(this.tDc=!0,this.callback(this.GMe))}}Object(J.a)(m,"CompletionTask",null,[]);d.d(L,"a",function(){return f});class f{constructor(){this.PKc=new m;this.NKc=new m}Vbb(a){this.PKc.jvb(a)}Ubb(a){this.NKc.jvb(a)}VLa(a){this.PKc.Xbd(a)}K7(a){this.NKc.Xbd(a)}VUb(){this.VLa(2);this.K7(2)}}Object(J.a)(f,"MessageStatus",null,[1819])},1704:function(J,
L,d){d.d(L,"a",function(){return m});J=d(0);class m extends Sys.EventArgs{constructor(f,a,l,w){super();this.type=f;this.iA=a;this.Hvf=l;this.Kna=w}}Object(J.a)(m,"SendUpdateNotificationEventArgs",Sys.EventArgs,[])},1705:function(J,L,d){d.r(L);d.d(L,"MaxOutstandingThrottler",function(){return a});J=d(0);var m=d(88);L=d(1706);var f=d(1620);class a extends L.a{constructor(l,w=""){super(l,w);this.Yta=this.U8=0;this.sa=new m.a;this.qpa=!1;this.A1a=this.s1a=this.EIb=0;this.dxg=()=>{this.qpa=!1;if(this.ota){const z=
this.Z4a,x=this.mqa;this.nIa(!1);this.INa(z,x)}};this.Seg=()=>{++this.A1a;this.A1a>Math.floor(this.Yta/2)&&(this.A1a=-1E9,this.sa.raiseEvent("TMUDM"))};this.t3a=0;this.EQ=[];this.clearTimeout=a.QMb}add(l){this.rpa||this.init(a.VXc,a.TXc);this.$da++;const w=new f.a;this.ota?this.Xdb(l,w):this.t3a<this.Yta?this.INa(l,w):(this.Xdb(l,w),this.qpa=!1);return w}INa(l,w){l=this.FOc(l);const z=this.setTimeout(this.Seg,this.U8);++this.t3a;Array.add(this.EQ,z);const x=this.s1a;l.Vbb(u=>{w.VLa(u)});l.Ubb(u=>
{this.s1a===x&&(this.Reg(x,z),w.K7(u))})}Reg(l,w){this.s1a===l&&(--this.t3a,this.clearTimeout(w),Array.remove(this.EQ,w),this.ota&&this.cxg())}cxg(){this.ota&&!this.qpa&&(this.EIb=this.setTimeout(this.dxg,0),this.qpa=!0)}G5a(l){this.sa.addHandler("TMUDM",l)}ckd(l){this.sa.removeHandler("TMUDM",l)}reset(){this.$da=this.jHa=this.LFa=this.A1a=0;++this.s1a;for(const l of this.EQ)this.clearTimeout(l);this.t3a=0;this.EQ=[];this.nIa(!0);this.qpa&&(this.clearTimeout(this.EIb),this.EIb=0,this.qpa=!1)}init(l,
w){this.rpa||(this.U8=l,this.Yta=w,this.rpa=!0)}static createInstance(l,w=""){return new a(l,w)}static QMb(l){window.clearTimeout(l)}}a.VXc=15E3;a.TXc=5;Object(J.a)(a,"MaxOutstandingThrottler",L.a,[1816,1817])},1706:function(J,L,d){d.d(L,"a",function(){return f});J=d(0);var m=d(7);class f{constructor(a,l=""){this.LFa=this.jHa=0;this.vEb=!1;this.mqa=this.Z4a=null;this.rpa=!1;this.FOc=a;this.Lqd=l;this.setTimeout=f.SMb;this.$da=this.jHa=this.LFa=0}zYb(){0<this.$da&&0<this.LFa&&m.ULS.sendTraceTag(36545635,
500,50,"Throttler [{0}] dropped [{1}] messages out of [{2}]",this.Lqd,this.LFa,this.$da);0<this.$da&&0<this.jHa&&m.ULS.sendTraceTag(36545634,500,50,"Throttler [{0}] throttled [{1}] messages out of [{2}]",this.Lqd,this.jHa,this.$da)}get ota(){return this.vEb}Xdb(a,l){this.jHa++;this.nIa(!0);this.vEb=!0;this.Z4a=a;this.mqa=l}nIa(a){this.vEb=!1;this.mqa&&a&&(this.LFa++,this.mqa.VUb());this.mqa=this.Z4a=null}static SMb(a,l){return window.setTimeout(a,l)}}Object(J.a)(f,"ThrottlerBase",null,[])},1707:function(J,
L,d){d.r(L);d.d(L,"MaxRateThrottler",function(){return f});J=d(0);L=d(1706);var m=d(1620);class f extends L.a{constructor(a,l=""){super(a,l);this.cua=0;this.bxg=()=>{if(this.ota){const w=this.Z4a,z=this.mqa;this.nIa(!1);this.INa(w,z)}};this.nGa=(new Date(0)).getTime();this.currentTime=()=>(new Date).getTime()}init(a){this.rpa||(this.cua=a,this.rpa=!0)}add(a){this.rpa||this.init(f.RXc);this.$da++;const l=this.currentTime(),w=new m.a;this.nGa>l&&(this.nGa=l);this.ota?(this.nIa(!0),this.Xdb(a,w)):this.nGa+
this.cua<=l?this.INa(a,w):(this.Xdb(a,w),this.setTimeout(this.bxg,this.nGa+this.cua-l));return w}INa(a,l){this.nGa=this.currentTime();a=this.FOc(a);a.Vbb(w=>{l.VLa(w)});a.Ubb(w=>{l.K7(w)})}static createInstance(a,l=""){return new f(a,l)}}f.RXc=200;Object(J.a)(f,"MaxRateThrottler",L.a,[1818,1817])},1708:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m{constructor(){this.Presence=null;this.TimeStamp=0}}Object(J.a)(m,"PresenceDataEntryForClients",null,[])},1709:function(J,L,d){d.d(L,"a",
function(){return m});J=d(0);class m{}m.FZb="rr";m.hvg="rd";m.evg="rbp";m.WZb="sa";Object(J.a)(m,"RtcReconnectParams",null,[])},1710:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m{constructor(f,a,l,w){this.V7f=f;this.U8=a;this.m7f=l;this.VOf=w}}Object(J.a)(m,"ThrottlerManagerSettings",null,[])},1763:function(J,L,d){J=d(0);var m=d(1886),f=d(1891),a=d(1887),l=d(1890),w=d(1889),z=d(1885),x=d(1888);class u extends Sys.EventArgs{constructor(){super()}}Object(J.a)(u,"GotCompletePersistentStateWithMetadataEventArgs",
Sys.EventArgs,[]);class v extends Sys.EventArgs{constructor(R,W,Z,T,N,U){super();this.awa=R;this.aUa=W;this.aqf=Z;this.k_c=N;this.qLb=T;this.kz=U}}Object(J.a)(v,"RefreshAllPersistentStateEventArgs",Sys.EventArgs,[]);class E extends Sys.EventArgs{constructor(R){super();this.hubConnection=R}}Object(J.a)(E,"RefreshProxyEventArgs",Sys.EventArgs,[]);class y extends Sys.EventArgs{constructor(R,W){super();this.Xea=R;this.errorMessage=W}}Object(J.a)(y,"RtcConnectFailedEventArgs",Sys.EventArgs,[]);class H extends Sys.EventArgs{constructor(R,
W,Z){super();this.type=R;this.JI=W;this.Kna=Z}}Object(J.a)(H,"SendPersistentStateEventArgs",Sys.EventArgs,[]);var I=d(1704);class F extends Sys.EventArgs{constructor(){super()}}Object(J.a)(F,"SessionPropertiesChangedEventArgs",Sys.EventArgs,[]);class C extends Sys.EventArgs{constructor(R){super();this.dnb=R}}Object(J.a)(C,"UpdatePersistentStateClearedRequestEventArgs",Sys.EventArgs,[]);class P extends Sys.EventArgs{constructor(R,W){super();this.type=R;this.$Lg=W}}Object(J.a)(P,"UpdatePersistentStateRequestEventArgs",
Sys.EventArgs,[]);var K=d(88);d.d(L,"a",function(){return G});class G{constructor(){this.sa=new K.a}pog(R,W){this.sa.raiseEvent("CSC",new m.a(R,W))}Gog(R){this.sa.raiseEvent("RP",new E(R))}Mcb(R){this.sa.raiseEvent("RC",R)}Hog(){this.sa.raiseEvent("RMID")}Fog(R,W,Z,T,N,U){this.sa.raiseEvent("RPS",new v(R,W,Z,T,N,U))}Iid(R,W){this.sa.raiseEvent("UPSR",new P(R,W))}Cid(R,W){this.sa.raiseEvent("PU",new z.a(R,W))}yog(R){this.sa.raiseEvent("MPU",new a.a(R))}lYb(R,W,Z,T){this.sa.raiseEvent("SUN",new I.a(R,
W,Z,T))}Jog(R,W){this.sa.raiseEvent("UNR",new x.a(R,W))}Gid(R,W,Z){this.sa.raiseEvent("SP",new H(R,W,Z))}dse(R,W){this.sa.raiseEvent("PSU",new w.a(R,W))}Cog(R){this.sa.raiseEvent("PSC",new l.a(R))}wog(R){this.sa.raiseEvent("IPSC",new l.a(R))}Kog(R){this.sa.raiseEvent("UPSC",new C(R))}Iog(R,W){this.sa.raiseEvent("SPC",new F(R,W))}Eid(R,W){this.sa.raiseEvent("RCF",new y(R,W))}uog(R){this.sa.raiseEvent("CPSWM",new u(R))}fse(R,W){this.sa.raiseEvent("UCI",new f.a(R,W))}NZ(R){this.sa.addHandler("CSC",R)}GZa(R){this.sa.removeHandler("CSC",
R)}tff(R){this.sa.addHandler("RP",R)}Xrg(R){this.sa.removeHandler("RP",R)}sff(R){this.sa.addHandler("RC",R)}Wrg(R){this.sa.removeHandler("RC",R)}uff(R){this.sa.addHandler("RMID",R)}rff(R){this.sa.addHandler("RPS",R)}Vrg(R){this.sa.removeHandler("RPS",R)}Eff(R){this.sa.addHandler("UPSR",R)}esg(R){this.sa.removeHandler("UPSR",R)}Qya(R){this.sa.addHandler("PU",R)}HZa(R){this.sa.removeHandler("PU",R)}Uef(R){this.sa.addHandler("IPU",R)}Lrg(R){this.sa.removeHandler("IPU",R)}Cff(R){this.sa.addHandler("UCI",
R)}csg(R){this.sa.removeHandler("UCI",R)}xff(R){this.sa.addHandler("SUN",R)}asg(R){this.sa.removeHandler("SUN",R)}Vef(R){this.sa.addHandler("IUNR",R)}Mrg(R){this.sa.removeHandler("IUNR",R)}BO(R){this.sa.addHandler("UNR",R)}wDa(R){this.sa.removeHandler("UNR",R)}Rlb(R){this.sa.addHandler("PSU",R)}Uwb(R){this.sa.removeHandler("PSU",R)}Tef(R){this.sa.addHandler("IPSU",R)}Krg(R){this.sa.removeHandler("IPSU",R)}Qlb(R){this.sa.addHandler("PSC",R)}Twb(R){this.sa.removeHandler("PSC",R)}Sef(R){this.sa.addHandler("IPSC",
R)}Jrg(R){this.sa.removeHandler("IPSC",R)}Dff(R){this.sa.addHandler("UPSC",R)}dsg(R){this.sa.removeHandler("UPSC",R)}wff(R){this.sa.addHandler("SP",R)}$rg(R){this.sa.removeHandler("SP",R)}yff(R){this.sa.addHandler("SPC",R)}bsg(R){this.sa.removeHandler("SPC",R)}static getInstance(){return G._instance||(G._instance=new G)}}G._instance=null;Object(J.a)(G,"RtcEventHub",null,[1592])},1779:function(J,L,d){d.r(L);J=d(0);var m=d(7),f=d(333),a=d(48),l=d(75);class w{constructor(x){this.messageId=x;this.exg=
(new Date).getTime();this.WTb=new l.a}}Object(J.a)(w,"MessageLatencyDetails",null,[]);d.d(L,"ClientToClientMessageTelemetry",function(){return z});class z{constructor(x,u,v){this.eT=null;this.tFb=this.KHb=0;this.sendMessage=()=>{if(this.aHa){const E=a.a.create().toString();this.eT=new w(E);this.Ae.lYb(16,E,!1,new f.a);window.setTimeout(()=>{this.u5f(E)},this.tFb)}};this.cpg=(E,y)=>{16===y.type?this.Ae.lYb(17,y.iA,!1,new f.a):17===y.type&&this.aHa&&y.iA&&this.processMessage(y.iA)};this.Ne=u;this.QKc=
v;this.aHa=!1;this.Ae=x;this.Ae.BO(this.cpg)}start(){if(this.QKc&&!this.aHa){const x=this.Ne.Cld;this.tFb=this.Ne.yld;x<=this.tFb?(m.ULS.sendTraceTag(570975114,500,15,"LogMetrics cannot be started because configuration values are incorrect. RtcSendTelemetryMessageIntervalInMS({0}) should be greater than RtcLogClientMessageMetricsTimeOutInMs({1})",this.Ne.Cld,this.Ne.yld),this.QKc=!1):(this.aHa=!0,this.KHb=window.setInterval(this.sendMessage,x))}}u5f(x){this.eT&&this.eT.messageId===x&&(0<this.eT.WTb.count?
(x=this.eT.WTb.toArray().join(","),m.ULS.sendTraceTag(571339719,500,15,"ClientMessageLatencies:[{0}]",x)):m.ULS.sendTraceTag(562312150,500,50,"No client message latencies recorded"),this.eT=null)}stop(){this.KHb&&(window.clearInterval(this.KHb),this.aHa=!1)}processMessage(x){x&&this.eT&&x.toString()===this.eT.messageId&&(x=(new Date).getTime()-this.eT.exg,this.eT.WTb.add(x))}static get instance(){return z._instance}static Fqb(x,u,v){return z.instance||(z._instance=new z(x,u,v))}}z._instance=null;
Object(J.a)(z,"ClientToClientMessageTelemetry",null,[])},1885:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m extends Sys.EventArgs{constructor(f,a){super();this.Oha=f;this.AYc=a}}Object(J.a)(m,"PresenceUpdatedEventArgs",Sys.EventArgs,[])},1886:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m extends Sys.EventArgs{constructor(f,a){super();this.newState=f;this.oldState=a}}Object(J.a)(m,"ChangedConnectionStateEventArgs",Sys.EventArgs,[])},1887:function(J,L,d){d.d(L,"a",
function(){return m});J=d(0);class m extends Sys.EventArgs{constructor(f){super();this.JI=f}}Object(J.a)(m,"MyPresenceUpdatedEventArgs",Sys.EventArgs,[])},1888:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m extends Sys.EventArgs{constructor(f,a=null){super();this.Mk=f;this.rPk=a}get type(){return this.Mk}get iA(){return this.rPk}}Object(J.a)(m,"UpdateNotificationEventArgs",Sys.EventArgs,[])},1889:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m extends Sys.EventArgs{constructor(f,
a){super();this.type=f;this.Oha=a}}Object(J.a)(m,"PersistentStateUpdateEventArgs",Sys.EventArgs,[])},1890:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m extends Sys.EventArgs{constructor(f){super();this.dnb=f}}Object(J.a)(m,"PersistentStateClearedEventArgs",Sys.EventArgs,[])},1891:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m extends Sys.EventArgs{constructor(f,a){super();this.Q1h=f;this.Kna=a}}Object(J.a)(m,"ClientInfoEventArgs",Sys.EventArgs,[])},1892:function(J,
L,d){d.d(L,"a",function(){return m});J=d(0);class m{constructor(f,a){this.status=f;this.Bpc=a}}Object(J.a)(m,"UserStatusInfo",null,[])},1893:function(J,L,d){d.r(L);d.d(L,"RealtimeChannelMetrics",function(){return w});J=d(0);var m=d(7),f=d(179),a=d(86),l=d(1389);class w{constructor(){this.ALc=this.BLc=this.CLc=this.xLc=this.wLc=this.yLc=this.zGa=this.RFb=0;this.jda=this.bFb=this.oGa=this.WEb=this.upa=this.TEb=this.C5=this.lGa=this.tpa=this.SEb=this.m2a=this.Zoa=null;this.wFb=this.qGa=this.KOc=this.ODc=
0;this.TKc=!1;this.Sid=this.qYb;this.Vid=this.tYb;this.Uid=this.sYb;this.Xid=this.vYb;this.Wid=this.uYb;this.AYb=this.BYb;this.Rcb=this.yYb;this.Jga=this.wYb;this.Mua=this.xYb;this.Tid=this.rYb;this.yCa=this.yVb;this.mYa=this.zVb}qYb(){this.RFb++;this.SEb=new Date;this.Zoa||(this.Zoa=new Date)}tYb(){this.zGa++;this.C5=new Date;this.m2a||(this.m2a=this.C5);this.oGa=this.C5;this.Opf()}sYb(){this.yLc++;this.TEb=new Date}vYb(){this.wLc++;this.tpa=new Date}uYb(){this.xLc++;this.lGa=new Date}yYb(){this.upa=
new Date;this.CLc++}xYb(){this.jda||(this.jda=new Date);this.BLc++}wYb(){this.WEb=new Date;this.ALc++}BYb(){!this.TKc&&this.RFb&&(m.ULS.sendTraceTag(39321871,500,15,a.a.toJSON(this.Qof())),this.TKc=!0)}rYb(z){const {R5c:x,S5c:u,vk:v}=l.RtcUtils.wBf(z);x&&x!==f.a.pz&&(m.ULS.sendTraceTag(40157596,500,15,a.a.toJSON({["HttpErrorCode"]:x,["HttpErrorStatus"]:u,["Exception"]:v})),f.a.qce(x)&&this.ODc++,f.a.Xee(x)&&this.KOc++)}yVb(){this.bFb=new Date}zVb(){this.tpa=this.oGa=new Date}Qof(){return{["numberOfConnectionAttempts"]:this.RFb,
["numberOfSuccessfulConnections"]:this.zGa,["numberOfFailedConnections"]:this.yLc,["numberOfDisconnectedConnections"]:this.wLc,["numberOfExplicitDisconnectedConnections"]:this.xLc,["numberOfSentMessages"]:this.CLc,["numberOfReceivedMessages"]:this.BLc,["numberOfLostMessages"]:this.ALc,["firstConnectionAttempt"]:this.Zoa?this.Zoa:null,["firstMessageReceived"]:this.jda?this.jda:null,["firstConnectionSuccess"]:this.m2a?this.m2a:null,["lastConnectionAttempt"]:this.SEb?this.SEb:null,["lastConnectionSuccess"]:this.C5?
this.C5:null,["lastConnectionFailure"]:this.TEb?this.TEb:null,["lastMessageSent"]:this.upa?this.upa:null,["lastMessageLost"]:this.WEb?this.WEb:null,["lastDisconnect"]:this.tpa?this.tpa:null,["lastExplicitDisconnect"]:this.lGa?this.lGa:null,["lastTimeOnline"]:this.oGa?this.oGa:null,["lastTimeOffline"]:this.bFb?this.bFb:null,["maxDisconnectedTimeMs"]:this.qGa,["maxExplicitDisconnectedTimeMs"]:this.wFb,["clientConnectionErrors"]:this.ODc,["serverConnectionErrors"]:this.KOc}}Opf(){this.Zoa&&1===this.zGa&&
(this.qGa=Math.max(this.qGa,this.C5.getTime()-this.Zoa.getTime()));this.tpa&&1<this.zGa&&(this.qGa=Math.max(this.qGa,this.C5.getTime()-this.tpa.getTime()));this.lGa&&1<this.zGa&&(this.wFb=Math.max(this.wFb,this.C5.getTime()-this.lGa.getTime()))}static createInstance(z){w._instance||(w._instance=new w,m.ULS.sendTraceTag(39321870,500,50,"RealtimeChannelMetrics initialized for client {0}",z));return w._instance}}w._instance=null;Object(J.a)(w,"RealtimeChannelMetrics",null,[1806,325])},1894:function(J,
L,d){d.d(L,"a",function(){return m});J=d(0);var m;(function(f){f[f.Z5h=0]="contentUpdate";f[f.PVp=1]="editorsTableUpdate";f[f.gOb=2]="fileNameUpdate";f[f.UCp=3]="wetContentUpdate";f[f.Lcq=4]="persistedContentUpdate";f[f.Aql=5]="clientRtcReconnectRequest";f[f.Neq=6]="replicationTelemetry";f[f.N3p=7]="lockUpdate";f[f.ESp=8]="collabServiceContentUpdate";f[f.$kq=9]="trackChangeSettingUpdate";f[f.cgq=10]="saveTargetUpdate";f[f.dmq=11]="uploadToOcsUpdate";f[f.P2p=12]="labelUpdate";f[f.KZm=13]="hostNotificationSubscriptionStatus";
f[f.sjq=14]="subscribeOrExtend";f[f.UVp=15]="elapsedBootTelemetry";f[f.V1h=16]="clientToClientTelemetryMessage";f[f.U1h=17]="clientToClientResponseMessage";f[f.umq=18]="verifyNotificationPipeline";f[f.m0p=19]="hostNotificationHeartbeat";f[f.Cgq=20]="secondaryMetadataUpdate";f[f.last=21]="last"})(m||(m={}));Object(J.b)("UpdateNotificationType",m)},1895:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);var m;(function(f){f[f.unspecified=0]="unspecified";f[f.word=1]="word";f[f.I0l=2]="excel";f[f.Gsj=
3]="powerPoint";f[f.test=4]="test";f[f.wacFrontEnd=5]="wacFrontEnd";f[f.Fnj=6]="oneNote";f[f.bCp=7]="visio";f[f.Iaq=8]="officeMobile";f[f.ETp=9]="cosmosDBChangefeed";f[f.last=10]="last"})(m||(m={}));Object(J.b)("RtcClientAppName",m)},1986:function(J,L,d){d.r(L);J=d(0);var m=d(7),f=d(108),a=d(75),l=d(874);class w{}w.cua="throttling_messageDelay";w.ALa="enabled";w.U8="throttling_timeToWaitForResponse";w.Yta="throttling_maxNumberOfOutstandingMessages";w.p4c="throttling_globalMaxNumberOfOutstandingMessages";
w.errorMessage="errorMessage";w.$od="url";w.EP="queryString";w.ew="connectionString";w.Zvc="netcore";Object(J.a)(w,"RtcFindSessionOutputFieldNameConstants",null,[]);var z=d(2),x=d(46),u=d(41),v=d(1244),E=d(86),y=d(17),H=d(124);class I{constructor(){this.q4c=this.fcd=this.gcd=this.jcd=0;this.nab=!1;this.correlationId=this.ew=this.EP=this.ILb=this.errorMessage=null}get Fpf(){return this.ILb+"?"+this.EP}}Object(J.a)(I,"FindSessionResponse",null,[]);var F=d(588);class C{constructor(X,Y,ca,ia,la,ta){this.H5=
null;this.q4e=X;X=String.format("{0}={1}",F.a.clientId,y.a.Yi(ia));X=String.format("{0}&{1}={2}",X,F.a.userSessionId,y.a.Yi(la));X=String.format("{0}&{1}={2}",X,F.a.LEe,y.a.Yi(ca.toString()));X=String.format("{0}&{1}={2}",X,F.a.userType,y.a.Yi("1"));X=String.format("{0}&{1}={2}",X,F.a.REe,y.a.Yi(Y));X=String.format("{0}&{1}={2}",X,F.a.iVd,y.a.Yi(C.wql));(Y=C.n1c(ca,ta))&&(X=String.format("{0}&{1}",X,Y));this.NMe=X}fjd(){this.H5=this.q4e()}generate(){this.H5&&""!==this.H5||(this.fjd(),m.ULS.sendTraceTag(575784194,
500,this.H5&&""!==this.H5?50:15,"Query signature delegate called for refresh returned: {0} ",this.H5));const X=String.format("{0}={1}",F.a.Lcb,y.a.Yi(this.H5));return String.format("{0}&{1}",X,this.NMe)}static n1c(X,Y){return 4===X?String.format("{0}={1}",F.a.mke,"1"):Y?Y.wOf():null}}C.wql="1.0";Object(J.a)(C,"FindSessionQueryStringGenerator",null,[]);var P=d(1432),K=d(1576),G=d(1389),R=d(1710);class W{}W.HCf="FSType";Object(J.a)(W,"RtcFindSessionRequestHeaders",null,[]);class Z{}Z.Vog="polling";
Object(J.a)(Z,"RtcFindSessionTypes",null,[]);var T=d(1709);class N{}N.VMg="RTC-TokenProofkey";N.T0f="RTC-IsWacJsBootFsRequest";Object(J.a)(N,"RtcRequestHeaders",null,[]);var U=d(69);d.d(L,"FindSessionStrategy",function(){return ba});class ba{constructor(X,Y,ca,ia,la,ta,za,Ha,Na,ya,ma,Ea,Ba=null){this.BJc=(new Date(0)).getTime();this.vKc=0;this.h3a=!1;this.LOc=null;this.JYb=36E5;this.Joa=ba.J6c;this.SFa=0;this.Uga=null;this.eV=0;this.cva=this.HVc=null;this.x5e=[w.ALa,w.errorMessage,w.$od,w.ew,w.EP,
w.p4c,w.Yta,w.U8,w.cua];this.w5e=[w.ALa,w.errorMessage];this.ew=this.yba=null;this.NGc=new C(ma?ma:()=>z.AFrameworkApplication.um,la,ta,za,X,Y);this.oFa=Ea;this.Xd=ia;this.Gf=Y;this.OGc=ca;this.Ck=Ha;this.Ae=Na;this.Ywa=Ba;this.PGc=!1;this.i8a=9E4;ya&&ya.execute($a=>{$a.kTa(()=>{m.ULS.sendTraceTag(40768456,500,50,"Connection parameters refresh requested for client [{0}]",this.Ck);this.NGc.fjd()})});2>=100*Math.random()&&(this.JYb=3E5);P.FrequentLoggingMetrics.instance&&(P.FrequentLoggingMetrics.instance.K0c=
this.JYb)}pzg(X){this.cva=X}init(){this.Ae.uff(Object(f.a)(this,this.Gtg,"resetGetMachineIdDelay"));this.Ae.NZ(Object(f.a)(this,this.DN,"onConnectionStateChanged"))}DN(X,Y){this.eV=Y.newState;2===Y.newState&&(this.SFa=0)}m2c(){let X;X=this.Uga.correlationId;return{returnValue:String.format("{0}&{1}={2}",this.Uga.EP,ba.kXd,y.a.Yi(X)),correlationId:X}}vMf(X,Y,ca,ia,la){this.Kwg(()=>{ia(la,"GetMachineIdSuccess")&&(m.ULS.sendTraceTag(17956951,500,50,"Successfully retrieved Rtc MachineId [{0}] for [{1}]",
this.ew,this.Ck),X(this.LOc),ca(this.TNf()))},ta=>{ia(la,"GetMachineIdFailure")&&(m.ULS.sendTraceTag(4060129,500,15,"Failed to retrieve Rtc MachineId for [{0}]",this.Ck),Y(ta))},ia,la)}kxf(){this.MUc();this.xTf()}Kwg(X,Y,ca,ia){m.ULS.sendTraceTag(17956952,500,50,"Retrieving Rtc MachineId from server. Getting from last findsession, connectionString is [{0}]",this.ew);if(this.ew)X();else{var la=this.Slf();window.setTimeout(()=>{this.sendFindSessionRequestToServerInternal(X,Y,ca,ia)},la)}}sendFindSessionRequestToServerInternal(X,
Y,ca,ia){ca(ia,"RequestMachineId")&&(this.BJc=(new Date).getTime(),ca=u.a.Ge(),this.nPb(la=>{const ta=u.a.Ge();this.Zfd(la);this.q_b();X();la=u.a.Ge()-ta;m.ULS.sendTraceTag(577356039,345,50,"SFSRTS Success - TimeElapsed: {0}",la)},la=>{const ta=u.a.Ge();this.MUc();P.FrequentLoggingMetrics.instance&&P.FrequentLoggingMetrics.instance.Ts(2,3);Y(la);la=u.a.Ge()-ta;m.ULS.sendTraceTag(577356040,345,50,"SFSRTS Failure - TimeElapsed: {0}",la)},!1),ca=u.a.Ge()-ca,m.ULS.sendTraceTag(577599296,345,50,"SFSRTS - TimeElapsed: {0}",
ca))}xTf(){this.Joa+=ba.rKf;this.Joa=Math.min(this.Joa,ba.j7f)}Slf(){var X=(new Date).getTime();X=this.BJc+this.Joa-X;0>X&&(X=0);return X}Zfd(X){try{this.Uga=X,this.yba=X.Fpf,this.ew=X.ew,this.HVc=X.EP,this.LOc=X.ILb}catch(Y){m.ULS.sendTraceTag(17956953,500,10,"FindSession response contains invalid fields. Exception {0}, is thrown",Y.toString())}}MUc(){this.ew=null;this.NUc()}q_b(){this.NUc();this.h3a=!0;this.vKc=window.setTimeout(Object(f.a)(this,this.Hpg,"refreshMachineId"),this.JYb)}NUc(){this.h3a&&
(window.clearTimeout(this.vKc),this.h3a=!1)}Hpg(){this.h3a=!1;this.nPb(X=>{const Y=this.HVc!==X.EP,ca=this.ew!==X.ew,ia=this.ew;this.Zfd(X);0!==this.eV&&(ca?(m.ULS.sendTraceTag(17956955,500,15,"Recycling RTC connection due to RTC machine id change. old={0}, new={1}",ia||"null",X.ew),this.Ae.Mcb()):(this.Ae.Iog(Y,ca),this.q_b()))},()=>{P.FrequentLoggingMetrics.instance&&P.FrequentLoggingMetrics.instance.Ts(2,3);this.q_b()},!0)}Gtg(){this.Joa=ba.J6c}TNf(){return new R.a(this.Uga.jcd,this.Uga.gcd,this.Uga.fcd,
this.Uga.q4c)}UIg(X){if(Object.getType(X)!==Object)return null;for(let Y in X);return this.dsf(X)}dsf(X){if(!(w.ALa in X))return null;const Y=X[w.ALa];var ca=Y?this.x5e:this.w5e;for(const ia of ca)if(!(ia in X))return null;ca=Object.assign(new I,{nab:X[w.ALa],errorMessage:X[w.errorMessage],correlationId:H.a.create().toString()});Y&&(ca.ILb=X[w.$od],ca.EP=X[w.EP],ca.ew=X[w.ew],ca.q4c=X[w.p4c],ca.fcd=X[w.Yta],ca.gcd=X[w.U8],ca.jcd=X[w.cua]);return ca}EIf(X,Y){m.ULS.sendTraceTag(50448152,500,50,"Using FindSessionUtils find session response");
this.Ywa.u2d.continueWith(()=>{this.Ywa.u2d.result?(m.ULS.sendTraceTag(50448153,500,50,"FindSessionUtils find Session resulted in success"),X(this.Ywa.v2d)):(m.ULS.sendTraceTag(50448154,500,15,"FindSessionUtils find Session resulted in error"),Y(this.Ywa.v2d))})}Fkd(X,Y,ca,ia,la=!1){return ta=>{K.a.instance.hNa(0,1);X&&X.stop();this.oFa=this.cva=null;this.wbd(ta.data,!0,Y);var za=G.RtcUtils.deserialize(ta.data.De,"FindSession",null);if(za)if(za=this.UIg(za)){if(za.nab&&za.EP&&za.ew){m.ULS.sendTraceTag(4317446,
500,50,"Successfully retrieved MachineId from server for [{0}]",this.Ck);this.b5f(ta.data);ca(za);return}Y.FindSessionFailureReason="FindSessionInvalidResponse";Y.IsRtcEnabled=za.nab;Y.IsQueryStringEmpty=!za.EP;Y.IsConnectionStringEmpty=!za.ew;m.ULS.sendTraceTag(4290720,500,15,"Response did not contain valid MachineId [ConnectionUrl and/or QueryString] for [{0}]; IsRtcEnabled:{1}; IsQueryStringEmpty:{2}; IsConnectionStringEmpty:{3}",this.Ck,za.nab,!za.EP,!za.ew)}else Y.FindSessionFailureReason="FindSessionTranslateServerResponseFailed",
m.ULS.sendTraceTag(8745097,500,15,"Could not translate server response to findSession response for [{0}]",this.Ck);else Y.FindSessionFailureReason="FindSessionDeserializeServerResponseFailed",m.ULS.sendTraceTag(7372827,500,10,"Could not deserialize response data for [{0}]",this.Ck);this.Fid(Y,la);ia(null)}}Ckd(X,Y,ca,ia=!1){return la=>{K.a.instance.hNa(0,1);X&&X.stop();this.oFa=this.cva=null;this.wbd(la.data,!1,Y);let ta=null;var za="unknown";let Ha="unknown";la.data&&((za=la.data.vi)&&ba.ANa in za&&
(ta=za[ba.ANa].toString()),za=v.a[la.data.status],Ha=la.data.Ie.toString());Y.FindSessionFailureReason="FindSessionRequestFailed";Y.HttpErrorCode=Ha;Y.HttpErrorStatus=za;Y[ba.ANa]=ta;m.ULS.sendTraceTag(4290721,500,15,"Request for MachineId failed with Status='{0}'; HttpStatus='{1}' for [{2}]; RtcErrorCode='{3}'. Polling: '{4}' '",za,Ha,this.Ck,ta,ia);this.Fid(Y,ia);ca(Ha)}}nPb(X,Y,ca=!1){let ia=null;m.ULS.sendTraceTag(4317445,500,50,"Getting MachineId from server for [{0}]",this.Ck);const la={};var ta=
this.NGc.generate();la[U.a.s2]=H.a.create().toString();this.cva&&""!==this.cva?ta=String.format("{0}&{1}={2}",ta,T.a.FZb,this.cva):this.oFa&&""!==this.oFa&&(ta=String.format("{0}&{1}={2}",ta,T.a.FZb,this.oFa),la[N.VMg]="True",la[N.T0f]="True");ta=this.OGc+"?"+ta;ca&&(la[W.HCf]=Z.Vog);const za={};za.IsNetworkOfflineBeforeSendRequest=this.Gf.pta;za.HasAvailableConnectionsBeforeSendRequest=this.Gf.$4c;za.MaxConnectionsAllowed=this.Gf.bVb;za.IsRefreshMachineId=ca;this.Ywa&&!this.PGc?(this.EIf(this.Fkd(null,
za,X,Y,ca),this.Ckd(null,za,Y,ca)),this.PGc=!0):(this.Xd&&(ia=this.Xd.Wf("WebServiceCall","GetMachineIdFromTheServer")),P.FrequentLoggingMetrics.instance&&P.FrequentLoggingMetrics.instance.Ts(2,0),0>this.Gf.A5a(ta,1,null,la,[ba.V6a,ba.ANa,ba.lMa,ba.EZb,ba.Vcd,ba.Mdd,ba.Ldd],1,this.Fkd(ia,za,X,Y,ca),this.Ckd(ia,za,Y,ca),null,!1,null,this.i8a,"3",null,!0)&&(5<this.SFa&&200>this.SFa&&m.ULS.sendTraceTag(578166985,500,15,"FindSession request not scheduled due to expired token. Manually triggered failure callback {0} times.",
this.SFa),window.setTimeout(()=>{this.SFa++;Y("-1")},1E3)))}wbd(X,Y,ca){ca||(ca={});ca.IsNetworkOfflineAfterRequestComplete=this.Gf.pta;ca.IsRequestSucceeded=Y;X&&(ca.EnqueueTime=X.Yra,ca.InvokedTime=X.bH,ca.CompletedTime=X.MO,X.vi&&(ba.V6a in X.vi&&(ca.CorrelationId=X.vi[ba.V6a]),ba.lMa in X.vi&&(ca[ba.lMa]=X.vi[ba.lMa])));m.ULS.sendTraceTag(38633565,500,Y?50:15,G.RtcUtils.pma(ca))}Fid(X,Y){X||(X={});X.ConnectionState=l.a[this.eV];Y||this.Ae.Eid(1,X)}b5f(X){try{var Y=!1,ca=!1,ia=X.vi,la=x.a.kU(X.request.get_url());
if(ia&&ba.EZb in ia){const ya=ia[ba.EZb].toString().toLocaleLowerCase();ca="true"===ya;Y="false"===ya}ia=!1;const Na=0<=la.toLocaleLowerCase().indexOf("collab");ca&&!Na?ia=!0:Y&&Na&&(ia=!0);if(ia){Y={};Y.HostName=la;Y.Status=v.a[X.status];Y.HttpStatus=X.Ie.toString();var ta=X.request.get_headers();for(let ya in ta){var za=ta[ya];(la=ya)&&0<la.length&&(ca=0,za&&(ca=za.toString().length),Y["r_"+la]=ca)}if(X.vi){const ya=new a.a;ya.add(ba.V6a);ya.add(ba.lMa);ya.add(ba.ANa);ya.add(ba.Mdd);ya.add(ba.Ldd);
ya.add(ba.Vcd);ba.ief(Y,X.vi,ya)}ba.eef(X.request.get_url(),Y);var Ha=E.a.toJSON(Y);m.ULS.sendTraceTag(559437006,500,15,Ha)}}catch(Na){m.ULS.sendTraceTag(559437007,500,10,"DomainLandingIncorretDC exception[{0}]",Na.toString())}}static createInstance(X,Y,ca,ia,la,ta,za,Ha,Na,ya,ma,Ea=null){return ba.Asf(X,Y,ca,ia,la,ta,za,Ha,Na,ya,null,ma,Ea)}static Asf(X,Y,ca,ia,la,ta,za,Ha,Na,ya,ma,Ea,Ba=null){X=X||H.a.create().toString();X=new ba(X,Y,ca,ia,la,ta,za,Ha,Na,ya,ma,Ea,Ba);X.init();return X}static ief(X,
Y,ca){for(let ia of ca)ia in Y&&(X[ia]=Y[ia])}static eef(X,Y){if(X){var ca=X.indexOf("?");if(-1!==ca)for(X=X.substr(ca+1).split("&"),ca=0;ca<X.length;++ca){var ia=X[ca].split("=");if(2===ia.length){const la=ia[0];if(la&&0<la.length){let ta=0;if(ia=ia[1])ta=ia.length;Y["q_"+la]=ta}}}}}}ba.rKf=3E3;ba.j7f=3E5;ba.J6c=1E3;ba.V6a="X-CorrelationId";ba.kXd="corrid";ba.ANa="RtcErrorCode";ba.lMa="X-OfficeCluster";ba.EZb="X-NewEnv";ba.Vcd="X-MSEdge-Ref";ba.Ldd="X-OFFICEFD";ba.Mdd="X-OfficeFE";Object(J.a)(ba,
"FindSessionStrategy",null,[1805])},2124:function(J,L,d){d.r(L);var m=d(2),f=d(0);class a{constructor(pa,Hb){this.Qxa=null;this.vga=()=>{a.MSh(this.Qxa.Zpb())&&(this.Qxa.fsg(this.vga),this.LGk.IsRealCoauthSession=!0)};this.LMc=pa;this.LGk=Hb}init(){this.LMc.continueWith(()=>{this.Qxa=this.LMc.result;this.Qxa.qcc(this.vga)})}static MSh(pa){let Hb=null;for(const Ob of pa)if(Ob)if(pa=Ob.isAnonymous||!Ob.email?Ob.clientId:Ob.email.toUpperCase(),!Hb)Hb=pa;else if(Hb!==pa)return!0;return!1}}Object(f.a)(a,
"CoauthTelemetry",null,[794]);var l=d(7),w=d(333),z=d(83),x;(function(pa){pa[pa.SQp=0]="badStatePreventedTelemetry";pa[pa.notImplemented=1]="notImplemented";pa[pa.Deq=2]="renderHandled";pa[pa.Eeq=3]="renderHandledWithVeto"})(x||(x={}));Object(f.b)("CoauthorGalleryTelemetryEndResult",x);var u=d(87),v=d(86),E=d(133);class y{constructor(pa,Hb,Ob,Dc,nd,Od,ye,Oe,Cf){this.fyh=this.sah=this.bF=null;this.zne=()=>{this.vga()};this.weg=()=>{const Bg=this.ng.hv("AppInitStatus_interactivityReady");l.ULS.shipAssertTag(42259235,
325,!!this.SNd);const Zg=this.SNd-Bg,Qg={};Qg.InteractiveTime=Bg;Qg.ReactRenderComplete=this.SNd;Qg.HadTabSwitch=this.xBb();Qg.IsModernGallery=this.KQc;l.ULS.sendTraceTag(594883104,325,50,v.a.toJSON(Qg));this.KQc?(l.ULS.sendTraceTag(42062997,325,15,Zg.toString()),this.AMd.rV(this.xBp(Zg)?3:2)):l.ULS.sendTraceTag(594883103,325,15,Zg.toString())};this.j9=pa;this.AMd=new w.a;this.Ga=Ob;this.mMe=Hb;this.V0=Dc;this.ng=nd;this.b3e=Od;this.Sjb=ye;this.Olk=Oe;this.Ajh=this.ujh=!1;this.SNd=0;this.qah=1;this.xBb=
Cf;this.KQc=this.Ga.$("PeoplesWellExtraButtonInfoIsEnabled");this.Vha=Object(z.a)(String,m.AFrameworkApplication.sessionStartInfoSettings.Application)||""}get oWj(){return this.AMd.task}init(){E.Task.WAA.call(null,this.Sjb,this.mMe,this.b3e).continueWith(()=>{this.bF=this.Sjb.result;this.sah=this.mMe.result;this.fyh=this.b3e.result;E.Task.WAA.call(null,this.mMe.result.zec,this.b3e.result.f_j).continueWith(()=>{this.qah=this.sah.zec.result;this.SNd=this.fyh.f_j.result;this.bF.qcc(this.zne);this.bF.Zpb().length&&
this.vga()})})}vga(){this.Olk(this.bF.Zpb())?(this.bF.fsg(this.zne),this.bVn(this.ujh)):this.AMd.rV(1);this.ujh=!0}bVn(pa){this.Ajh?this.oWj.continueWith(()=>{l.ULS.sendTraceTag(42062996,325,15,"We already attempted to log a render of coauthor gallery: {0}",x[this.oWj.result])}):(this.Ajh=!0,this.$eo(0===this.qah&&!pa))}$eo(pa){pa?this.V0.Tk(4,this.weg):this.AMd.rV(1)}xBp(pa){const Hb=pa>this.Ga.ic("CoauthorGalleryTimeToRenderDurationMs",1E4);var Ob="Word"===this.Vha;const Dc="PowerPoint"===this.Vha;
if(this.xBb())return l.ULS.sendTraceTag(50455714,325,50,Hb.toString()),!1;Ob&&u.Health.instance.recordKpiUsage("CoauthGalleryExperienceDegraded",0,"wordcollabrel",null);Hb&&(Ob&&u.Health.instance.recordKpiFailure("CoauthGalleryExperienceDegraded","CoauthorGalleryTimeToRenderDurationIsTooLong",!1,!0,null),Ob=m.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.PPTClientCoauthorGalleryRenderLatencyQoSError"),Dc&&Ob&&pa<this.Ga.ic("CoauthorGalleryTimeToRenderCutoffThresholdMs",
3E4)&&u.Health.instance.recordQosError("CoauthorGalleryTimeToRenderDurationIsTooLong",["CoauthGalleryExperienceDegraded"],!1,!0,!0,!1,null),l.ULS.sendTraceTag(42062998,325,15,pa.toString()));return Hb}}Object(f.a)(y,"CoauthorGalleryTelemetry",null,[793]);class H{constructor(pa){this.bF=null;this.mxd={};this.FId={};this.oIc=null;this.vga=()=>{this.Y6j()};this.bvl=(Hb,Ob)=>Hb.DXa>Ob.DXa?1:Hb.DXa<Ob.DXa?-1:0;this.Sjb=pa}B7d(pa){const Hb=new w.a;this.init().continueWith(()=>{pa in this.mxd?Hb.rV(this.mxd[pa]):
this.FId[pa]=Hb});return Hb.task}init(){if(this.oIc)return this.oIc.task;this.oIc=new w.a;this.Sjb.continueWith(()=>{this.bF=this.Sjb.result;this.bF.qcc(this.vga);this.Y6j();this.oIc.hg(null)});return this.oIc.task}Y6j(){const pa=this.bF.Zpb();pa.sort(this.bvl);this.mxd={};for(let Hb=0;Hb<pa.length&&pa[Hb]&&pa[Hb].DXa;Hb++)this.qWk(this.mxd,pa[Hb].clientId,Hb)}qWk(pa,Hb,Ob){pa[Hb]=Ob;Hb in this.FId&&(this.FId[Hb].rV(Ob),delete this.FId[Hb])}}Object(f.a)(H,"CoauthorPositionFinder",null,[792]);var I=
d(589),F=d(276),C=d(513),P=d(75),K=d(124);class G{constructor(){this.rHa=null;this.nDc=Array(32)}xor(pa){if(!pa)throw Error.argumentNull("Guid argument cannot be null");const Hb=new G,Ob=new Sys.StringBuilder;for(let Dc=0;Dc<pa.nDc.length;Dc++){const nd=this.nDc[Dc]^pa.nDc[Dc];Hb.nDc[Dc]=nd;Ob.append(nd.toString(16));7!==Dc&&11!==Dc&&15!==Dc&&19!==Dc||Ob.append("-")}Hb.rHa=K.a.Cf(Ob.toString());return Hb}toString(){return this.rHa.toString()}equals(pa){if(!pa)throw Error.argumentNull("Guid argument cannot be null");
return this.rHa.equals(pa.rHa)}static Mpb(pa){if(!pa)throw Error.argumentNull("String input cannot be null");const Hb=new G;Hb.rHa=K.a.Cf(pa);const Ob=Hb.rHa.toString();let Dc=0;for(let Od=0;Od<Ob.length;Od++){var nd=pa.charAt(Od);if(G.ohn(nd))nd=G.qYm(nd,pa.charCodeAt(Od)),Hb.nDc[Dc++]=nd;else if(!G.Jgn(nd))throw Error.argument("String contains characters not valid in Guids");}return Hb}static ohn(pa){return"0"<=pa&&"9">=pa||"A"<=pa&&"F">=pa||"a"<=pa&&"f">=pa}static Jgn(pa){return"{"===pa||"}"===
pa||"-"===pa}static qYm(pa,Hb){if("0"<=pa&&"9">=pa)return Hb-48;if("A"<=pa&&"F">=pa)return Hb-65+10;if("a"<=pa&&"f">=pa)return Hb-97+10;throw Error.argument("Char is not valid hex digit");}}Object(f.a)(G,"Guid",null,[]);class R{constructor(pa,Hb,Ob,Dc){this.Qxa=null;this.Kch=this.fuh=!1;this.krh=0;this.vga=()=>{this.nsl(this.Qxa.Zpb())};this.LMc=pa;this.E9e=Hb;this.Ga=Ob;this.Q8b=Dc;this.hlk=m.AFrameworkApplication.z2b||m.AFrameworkApplication.Mta;this.vsh=new I.a(F.a.th())}get puf(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",
!1)}init(){this.LMc.continueWith(()=>{this.Qxa=this.LMc.result;this.Qxa.qcc(this.vga)})}nsl(pa){var Hb=0;const Ob=new C.a(F.a.th());for(const Dc of pa)if(Dc&&Dc.isAnonymous){m.AFrameworkApplication.vd("70eb6120;2gfeb930");if(Ob.lb(Dc.userName))Ob.K(Dc.userName).add(Dc.clientId);else{let nd;Ob.add(Dc.userName,(nd=new P.a,nd.add(Dc.clientId),nd))}Dc.clientId!==this.Q8b?(Hb++,2<=Hb&&!this.fuh&&this.EBn()):!this.Kch&&this.puf&&"Guest"===Dc.userName&&(l.ULS.sendTraceTag(509726851,302,50,"User was assigned 'Guest' name"),
this.Kch=!0)}if(this.puf&&this.krh!==Hb){l.ULS.sendTraceTag(512553562,302,50,"Total guests updated to: {0}",Hb+(this.hlk?1:0));this.krh=Hb;for(const Dc of Ob.keys)2<=Ob.K(Dc).count&&(pa=this.Tnm(Ob.K(Dc)),this.vsh.contains(pa)||(Hb={},Hb.guestsWithSameName=Ob.K(Dc).count,Hb.identifier=pa,l.ULS.sendTraceTag(526394833,302,50,"Duplicate guest friendly name detected: {0}",Hb),this.vsh.add(pa)))}}EBn(){l.ULS.sendTraceTag(525112603,302,50,"Multiple guests simultaneously coauthoring");this.fuh=!0;this.puf&&
this.E9e&&this.E9e.continueWith(()=>{window.setTimeout(()=>{this.E9e.result.logActivity("MultipleGuestsCoauthoring",null)},15E3)})}Tnm(pa){if(!pa||1>=pa.count)return"";let Hb=G.Mpb(pa.K(0));for(let Ob=1;Ob<pa.count;Ob++)Hb=Hb.xor(G.Mpb(pa.K(Ob)));return Hb.toString()}}Object(f.a)(R,"GuestCoauthTelemetry",null,[]);var W=d(267);class Z{constructor(){this.id=null;this.d=this.tp=this.mp=this.st=this.et=0;this.ct=null;this.vc=!1}}Object(f.a)(Z,"PL",null,[]);var T=d(29);class N{constructor(){this.ct=this.vt=
this.d=0}static qKj(pa,Hb,Ob){const Dc=new N;Dc.d=pa;Dc.vt=Hb;Dc.ct=Ob;return T.c(Dc)}}Object(f.a)(N,"VD",null,[]);var U=d(95);class ba{constructor(pa,Hb,Ob,Dc,nd,Od,ye,Oe,Cf){this.ji=0;this.UCh=!1;this._id=pa;this.LEh=Hb;this.rt=Ob;this.d0e=Dc;this.r$e=nd;this.eJb=Od;this.rCb=ye;this.uok=Oe;this.xBb=Cf;this.Vha=Object(z.a)(String,m.AFrameworkApplication.sessionStartInfoSettings.Application)||""}KAc(pa){E.Task.WAA(this.LEh,this.d0e,this.r$e).continueWith(()=>{if(this.d0e.result<=this.r$e.result)pa.rV(!1);
else{this.ji=this.LEh.result;var Hb=this.rt-this.ji,Ob=new Z;Ob.id=this._id;Ob.et=this.rt;Ob.st=this.ji;Ob.d=this.rt-this.ji;Ob.mp=this.d0e.result;Ob.tp=this.r$e.result;Ob.ct=this.djm(this.uok);Ob.vc=this.xBb();var Dc=T.c(Ob),nd="Word"===this.Vha,Od="PowerPoint"===this.Vha;l.ULS.sendTraceTag(42078597,302,15,Dc);if(nd){const ye=new Map;ye.set("data",Dc);u.Health.instance.recordKpiUsage("PresenceExperienceDegraded",0,"wordcollabrel",ye)}Hb>this.eJb.value&&!this.UCh&&!Ob.vc&&(this.UCh=!0,pa.rV(!0),Ob=
Object.assign(new U.a,{inStaging:!0,extendedProperties:new Map}),Ob.extendedProperties.set("data",Dc),nd&&u.Health.instance.recordKpiFailure("PresenceExperienceDegraded","PresenceRenderDurationIsTooLong",!1,!0,Ob),Hb<this.rCb.value&&(l.ULS.sendTraceTag(42078598,302,15,N.qKj(Hb,this.eJb.value,this.rCb.value)),Hb=m.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.PPTClientThumbnailPresenceRenderLatencyQoSError"),Od&&Hb&&(Ob.inStaging=!1,u.Health.instance.recordQosError("PresenceRenderDurationIsTooLong",
["PresenceExperienceDegraded"],!1,!0,!0,!1,Ob))));pa.task.isCompleted||pa.rV(!1)}})}djm(pa){switch(pa){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";default:return"Unknown"}}}Object(f.a)(ba,"PresenceLatencyActivityLogger",null,[]);class X{constructor(pa,Hb,Ob){this.c$g=this.oah=this.Swd=this.lxd=this.J3b=0;this._id=pa;this.eJb=Hb;this.rCb=Ob;this.Vha=Object(z.a)(String,m.AFrameworkApplication.sessionStartInfoSettings.Application)||""}get EPh(){return this.J3b}set EPh(pa){this.J3b=
pa;this.jnf()}get y2h(){return this.lxd}set y2h(pa){this.lxd=pa;this.jnf()}get wZh(){return this.Swd}set wZh(pa){this.Swd=pa;this.jnf()}get z2h(){return 0!==this.oah}get xZh(){return 0!==this.c$g}jnf(){!this.z2h&&this.J3b&&this.lxd&&(this.oah=this.KAc(this.lxd,"CoauthGalleryLightupDurationTooLong"));!this.xZh&&this.J3b&&this.Swd&&(this.c$g=this.KAc(this.Swd,"CanvasPresenceLightupDurationTooLong"))}KAc(pa,Hb){const Ob=pa-this.J3b;var Dc=new Z;Dc.id=this._id;Dc.et=pa;Dc.st=this.J3b;Dc.d=Ob;var nd=T.c(Dc);
pa="Word"===this.Vha;Dc="CanvasPresenceLightupDurationTooLong"===Hb?"PresenceExperienceDegraded":"CoauthGalleryExperienceDegraded";"CanvasPresenceLightupDurationTooLong"===Hb?l.ULS.sendTraceTag(572289499,302,15,nd):l.ULS.sendTraceTag(571524118,302,15,nd);if(pa){var Od=new Map;Od.set("data",nd);u.Health.instance.recordKpiUsage(Dc,0,"wordcollabrel",Od)}return Ob>this.eJb.value?(Od=Object.assign(new U.a,{inStaging:!0,extendedProperties:new Map}),Od.extendedProperties.set("data",nd),nd=Ob<this.rCb.value,
Od.extendedProperties.set("cash",nd?"true":"false"),pa&&u.Health.instance.recordKpiFailure(Dc,Hb,!1,!0,Od),l.ULS.sendTraceTag(572289500,302,15,N.qKj(Ob,this.eJb.value,this.rCb.value)),nd?2:1):3}}Object(f.a)(X,"PresenceLightupLatencyLogger",null,[]);class Y{constructor(pa,Hb,Ob,Dc,nd,Od,ye,Oe=null,Cf=null,Bg=null){this.jzh={};this.lMe={};this.Nph=new P.a;this.zwd=this.pIc=this.bF=this.Yh=null;this.KEh=this.JEh=0;this.d_n=(Zg,Qg)=>{if(!this.d9g&&2===Qg.newState){var Sg=this.Wyi();Sg.continueWith(()=>
{var Qk=Sg.result;Qk=Date.now()-Qk;const bk={};bk.clientId=this.Bej;bk.bootTime=Qk;this.d9g=!0;this.Yh.fC(15,bk)})}};this.aTn=(Zg,Qg)=>{if(15===Qg.type){Zg=Date.now();Qg=Qg.iA;var Sg=Qg.bootTime;this.ZJf(Qg.clientId).EPh=Zg-Sg}};this.zne=()=>{this.vga()};this.eJb=new W.a(()=>Oe.O2("PresenceBootLatencyThreshold",1E4));this.rCb=new W.a(()=>Oe.O2("PresenceBootLatencyCutoffThreshold",6E4));this.iQk=new W.a(()=>Oe.O2("PresenceLightupLatencyThreshold",2E3));this.Bqk=new W.a(()=>Oe.O2("PresenceLightupLatencyCutoffThreshold",
1E4));this.V0=Dc;this.TGk=nd;this.rah=pa;this.KBh=Hb;this.Sjb=Ob;this.ng=Od;this.Q8b=Cf;this.xBb=ye;this.Hjh=Bg;this.d9g=!1;this.init()}EZc(pa,Hb,Ob=null,Dc=0){Ob&&(l.ULS.shipAssertTag(42274970,302,!this.Q8b||this.Q8b===Ob,"_myClientId is already set and you are trying to update it to something different"),this.Q8b=Ob);const nd=new w.a;this.init().continueWith(()=>{this.NYn(pa);this.WYl(nd,pa,Hb,Dc)})}get Bej(){return this.Q8b||"{"+m.AFrameworkApplication.userSessionId+"}"}init(){if(this.pIc)return this.pIc.task;
this.pIc=new w.a;this.xBb()&&l.ULS.sendTraceTag(50951700,302,15,"TabSwitched Session");this.rah.continueWith(()=>{const pa=this.rah.result,Hb=pa.zec,Ob=pa.JKn;Ob.continueWith(()=>{Hb.continueWith(()=>{this.Hjh&&this.Hjh.addQosPillar("RealTimeCoauth");this.qEg(Hb.result,Ob.result);this.pIc.hg(null)})})});this.KBh.continueWith(()=>{this.Yh=this.KBh.result;this.Yh.NZ(this.d_n);this.Yh.BO(this.aTn)});this.Sjb.continueWith(()=>{this.bF=this.Sjb.result;this.bF.qcc(this.zne);0<this.bF.Zpb().length&&this.vga()});
return this.pIc.task}Wyi(){this.zwd||(this.zwd=new w.a,this.V0.Tk(4,()=>{this.zwd.rV(this.ng.hv("AppInitStatus_interactivityReady"))}));return this.zwd.task}vga(){const pa=Date.now();var Hb=this.bF.Zpb();const Ob=new P.a;for(const Dc of Hb)this.Nph.contains(Dc.clientId)||(this.Nph.add(Dc.clientId),Ob.add(Dc.clientId));if(0<Ob.count)for(const Dc of Ob)Hb=this.ZJf(Dc),Hb.z2h||(Hb.y2h=pa)}NYn(pa){pa=this.ZJf(pa);pa.xZh||(pa.wZh=Date.now())}ZJf(pa){return pa in this.lMe?this.lMe[pa]:this.lMe[pa]=new X(pa,
this.iQk,this.Bqk)}qEg(pa,Hb=0){this.JEh=pa;this.KEh=Hb?Hb:(new Date).getTime()}WYl(pa,Hb,Ob,Dc){Ob=Ob?Ob.getTime():(new Date).getTime();Hb in this.jzh?pa.Tna():(Dc=new ba(Hb,this.bJm(),Ob,this.B7d(this.Bej),this.B7d(Hb),this.eJb,this.rCb,Dc,this.xBb),this.jzh[Hb]=Dc,Dc.KAc(pa))}bJm(){return 1===this.JEh?E.Task.X6(this.KEh):this.Wyi()}B7d(pa){return this.TGk.B7d(pa)}}Object(f.a)(Y,"PresenceBootTelemetry",null,[782]);var ca=d(125),ia=d(177),la=d(39),ta=d(166),za=d(153),Ha=d(19),Na=d(534);class ya{get name(){return"Common.App.CoauthTelemetry"}uc(pa){pa.register(a,
1632).as("Common.App.CoauthTelemetry.ICoauthTelemetry").ha().Sd(()=>new a(Na.a.Yp(pa.Ra(613)),m.AFrameworkApplication.gh));pa.register(y,"Common.App.CoauthTelemetry.CoauthorGalleryTelemetry").as(1634).ha().Sd(()=>new y(m.AFrameworkApplication.va,Na.a.Yp(pa.Ra(157)),m.AFrameworkApplication.J,ca.a.get_instance(),ta.a.instance,Na.a.Yp(pa.Ra(1630)),Na.a.Yp(pa.Ra(613)),a.MSh,()=>this.eWh()));pa.register(Y,"Common.App.CoauthTelemetry.PresenceBootTelemetry").as(1635).ha().Sd(()=>new Y(Na.a.Yp(pa.Ra(157)),
Na.a.Yp(pa.Ra(138)),Na.a.Yp(pa.Ra(613)),ca.a.get_instance(),pa.resolve(1631),ta.a.instance,()=>this.eWh(),m.AFrameworkApplication.J,null,u.Health.instance));pa.register(H,"Common.App.CoauthTelemetry.CoauthorPositionFinder").as(1631).ha().Sd(()=>new H(Na.a.Yp(pa.Ra(613))));pa.register(R,1633).ha().Sd(()=>new R(Na.a.Yp(pa.Ra(613)),Na.a.Yp(pa.Ra(2)),m.AFrameworkApplication.J,"{"+m.AFrameworkApplication.userSessionId+"}"))}init(){m.AFrameworkApplication.J.Uo(()=>{Ha.a.instance.resolve(1632).init();Ha.a.instance.resolve(1633).init();
m.AFrameworkApplication.J.$("CoauthorGalleryTelemetryIsEnabled")&&Ha.a.instance.resolve(1634).init();m.AFrameworkApplication.J.$("CashTelemetryIsEnabled")&&(Ha.a.instance.resolve(1635),Ha.a.instance.resolve(1631))})}dispose(){}eWh(){return za.a.LKb&&ta.a.instance.GJ(la.a.dtd)?0<ta.a.instance.hv(la.a.dtd)[la.a.d$j]:!1}static main(){ia.a.instance.Lc(new ya)}}Object(f.a)(ya,"CoauthTelemetryPackage",null,[0,1]);class ma extends Sys.EventArgs{constructor(){super()}}Object(f.a)(ma,"RtcHostNotificationEventArgs",
Sys.EventArgs,[]);var Ea;(function(pa){pa[pa.gaq=0]="notYetStarted";pa[pa.Wcq=1]="polling";pa[pa.tjq=2]="subscribed";pa[pa.MUh=3]="blocked";pa[pa.Kcq=4]="permanentlyStopped"})(Ea||(Ea={}));Object(f.b)("RtcHostNotificationSubscriptionState",Ea);var Ba=d(92),$a=d(1275),ea=d(88);class ka{constructor(pa,Hb,Ob,Dc,nd,Od,ye,Oe,Cf){this.ii=!1;this.Sda=this.T9b=this.jja=this.m4a=null;this.axg=()=>{this.m4a=null;if(this.u0i){l.ULS.sendTraceTag(573100181,502,50,"HostNotifications: Send event when connected.  Current state: {0}",
Ea[this.ayc]);let Bg=null;this.f6e&&this.f6e.length&&(Bg={},Bg.etts=this.f6e);this.T9b.fC(14,Bg,!0);this.fIj(this.GJk)}else this.Vkb.event(3)};this.gkp=()=>{this.jja=null;2===this.ayc&&(this.Vkb.event(1),l.ULS.shipAssertTag(573100185,502,!!this.m4a,"Missing task to ensure that we re-subscribe."))};this.zma=()=>{this.PRm()};this.aS=(Bg,Zg)=>{if(13===Zg.type&&(Bg=Zg.iA,l.ULS.sendTraceTag(573100183,502,50,"HostNotifications: Subscription status: {0}",{["SerializableHostNotificationSubscription"]:Bg,
["DurationBeforeExpirationToResubscribeInSec"]:this.QKd}),Zg=Bg.cts,!this.cnp(Zg))){if(Bg.sb){var Qg=2;this.RIo(Bg.cts)}else Qg=1,this.CPc=ka.jIe,this.jja&&(this.Gb.uf(this.jja),this.jja=null);this.Vkb.event(Qg);this.m4a?this.Gb.X3(this.m4a,1E3*Zg):this.fIj(Zg)}};this.e0n=(Bg,Zg)=>{Bg=Zg.newState;const Qg=Zg.nlg,Sg={};Sg.NewState=Ea[Bg];Sg.PreviousState=Ea[Qg];Sg.PreviousStateHits=Zg.olg;Sg.PreviousStateTransitionTime=Zg.plg.toISOString();Sg.IsSubscribed=this.V0i;this.CPc!==ka.jIe&&(Sg.SubscriptionExpiringTime=
this.CPc.toISOString());l.ULS.sendTraceTag(572346515,502,4===Bg?15:50,"HostNotificationChanged: {0}",Sg);this.sa.raiseEvent("HN",new ma(Qg,Bg))};this.CPc=ka.jIe;this.sa=new ea.a;this.Vkb=new $a.a(0);this.Vkb.Aff(this.e0n);this.GJk=pa;this.QKd=Hb;this.FJk=Ob;this.f6e=Dc;this.Gb=nd;this.tf=Od;ye.execute(Bg=>{this.ii||(this.T9b=Bg,this.T9b.BO(this.aS),this.start())});Oe.execute(Bg=>{this.ii||(this.Sda=Bg,Bg.kTa(this.zma))});this.PNd=Cf}get ayc(){return this.Vkb.currentState}get u0i(){return!this.tf||
this.tf.jCa}get V0i(){return 2===this.ayc&&this.PNd()<this.CPc}start(){0!==this.ayc?l.ULS.sendTraceTag(573100178,502,15,"HostNotifications: Tried starting poll when in state {0}",Ea[this.ayc]):(this.Vkb.event(1),this.axg(null))}fIj(pa){this.m4a=Ba.a.oaa(1E3*pa,this.axg,this.QKd,192,"RtcHostNotificationSubscribe");this.Gb.Zb(this.m4a)}RIo(pa){pa=1E3*(pa+this.FJk);const Hb=this.PNd().getTime()+pa;this.CPc=new Date(Hb);pa-=this.QKd;this.jja?this.Gb.X3(this.jja,pa):(this.jja=Ba.a.oaa(pa,this.gkp,this.QKd/
2,194,"RtcHostNotificationTransitionToPolling"),this.Gb.Zb(this.jja))}PRm(){3===this.ayc&&this.u0i&&(this.Vkb.event(this.V0i?2:1),this.axg(null))}cnp(pa){if(!isNaN(pa)&&isFinite(pa)&&0<pa)return!1;this.DWj(!1);return!0}DWj(pa){this.m4a&&(this.Gb.uf(this.m4a),this.m4a=null);this.jja&&(this.Gb.uf(this.jja),this.jja=null);this.T9b&&(this.T9b.wDa(this.aS),this.T9b=null);this.Sda&&(this.Sda.$Yb(this.zma),this.Sda=null);pa||this.Vkb.event(4)}dispose(){this.ii||(this.ii=!0,this.DWj(!0),this.jja&&(this.Gb.uf(this.jja),
this.jja=null))}}ka.jIe=new Date(0);Object(f.a)(ka,"RtcHostNotificationSubscriptionManager",null,[780,10]);var La=d(467);class va{constructor(){this.ui=this.ii=!1}get name(){return"RtcHostNotificationSubscription"}uc(pa){pa.register(ka,1637).as(1636).ha().Sd(()=>{const Hb=m.AFrameworkApplication.J;return new ka(Hb.ic("RtcHostNotificationRetryIntervalIdeallyInSeconds",1800),Hb.ic("RtcHostNotificationRetryIntervalBufferInSeconds",120),Hb.ic("RtcHostNotificationSubscriptionLostBufferInSeconds",60),this.KGm(Hb),
m.AFrameworkApplication.oc,La.SessionStatusManager.instance,pa.Ra(138),pa.Ra(720),()=>new Date)})}init(){m.AFrameworkApplication.J.Uo(()=>{!this.ii&&m.AFrameworkApplication.J.$("RtcHostNotificationEnabled")&&(this.ui=!0,Ha.a.instance.resolve(1636))})}dispose(){this.ii||(this.ii=!0,this.ui&&Ha.a.instance.resolve(1637).dispose())}KGm(pa){return pa.Zx("RtcEventTypesToSubscribe")?pa.cD("RtcEventTypesToSubscribe"):null}static main(){ia.a.instance.Lc(new va)}}Object(f.a)(va,"RtcHostNotificationSubscriptionPackage",
null,[0,1]);var Ca=d(477),ua=d(639);class Sa{constructor(pa,Hb,Ob,Dc,nd,Od,ye,Oe,Cf,Bg,Zg){this.clientId=pa;this.SkypeChatThreadId=Ob;this.chatThreadDiscoveryUri=Dc;this.inChat=nd;this.localColbaltSessionId=Hb;this.capabilities=Od;this.email=ye;this.isReadOnly=Oe;this.userName=Cf;this.isAnonymous=Bg;this.presenceStatus=Zg}}Object(f.a)(Sa,"SerializablePresenceUserData",null,[]);class Ta extends Ca.a{constructor(pa,Hb,Ob,Dc,nd=null,Od=null,ye=null,Oe=null,Cf=null,Bg=!1,Zg=!1,Qg=!1,Sg=null){super(pa,
Hb,Ob,Dc,Od,ye,Oe,Cf,Bg,Zg,Qg);this.GF=nd;this.presenceStatus=Sg}getData(){return new Sa(this.clientId,this.GF,this.oUc,this.chatThreadDiscoveryUri,this.inChat,this.capabilities.capabilities,this.email,this.isReadOnly,this.userName,this.isAnonymous,this.presenceStatus)}C7d(pa){return(pa=pa.value)?pa.user:null}clone(){return new Ta(this.clientId,this.userName,this.color,this.capabilities.clone(),this.GF,this.oUc,this.email,this.client,this.chatThreadDiscoveryUri,this.isAnonymous,this.inChat,this.isReadOnly,
this.presenceStatus)}static cMb(pa){return pa.clientId?new Ta(pa.clientId,pa.userName,null,new ua.a(void 0===pa.capabilities?0:pa.capabilities),pa.localColbaltSessionId,pa.SkypeChatThreadId,pa.email,null,pa.chatThreadDiscoveryUri,pa.isAnonymous,pa.inChat,pa.isReadOnly,pa.presenceStatus):null}static K8h(pa,Hb,Ob,Dc=null,nd=null,Od=null,ye=null,Oe=null,Cf=!1,Bg=!1,Zg=!1,Qg=null){return pa?new Ta(pa,Hb,null,new ua.a(void 0===Ob?0:Ob),Dc,nd,Od,ye,Oe,Zg,Cf,Bg,Qg):null}}Object(f.a)(Ta,"PresenceUser",Ca.a,
[1576,1577,736]);class zb extends Ta{constructor(){super();this.Dtc=this.G4f=null}bym(){const pa=m.AFrameworkApplication.userName,Hb=m.AFrameworkApplication.J.ib("UserPrincipalName"),Ob=this.G4f?this.G4f.GF:null,Dc=m.AFrameworkApplication.z2b||m.AFrameworkApplication.Mta,nd=this.Dtc?this.Dtc.getStatus():null;return new Ta(this.clientId,pa,this.color,this.capabilities,Ob,this.oUc,Hb,this.client,this.chatThreadDiscoveryUri,Dc,this.inChat,this.isReadOnly,nd)}}Object(f.a)(zb,"MyPresenceUser",Ta,[1575,
736]);var Ra=d(21),qb=d(64),kb=d(1007);class Va{constructor(pa,Hb,Ob,Dc,nd){this.Ne=pa;this._clientId=Hb;this.Brk=nd;this.zvk=Ob||(()=>null);this.Avk=Dc||(()=>null)}get id(){return this.Ne.id}get IPd(){return this.Ne.IPd}get MPd(){return this.Ne.MPd}get LPd(){return this.Ne.LPd}get KPd(){return this.Ne.KPd}get JPd(){return this.Ne.JPd}get OPd(){return this.Ne.OPd}get Gcf(){return this.Ne.Gcf}get yxc(){return this.Ne.yxc}get qze(){return this.Ne.qze}get Oje(){return this.Ne.Oje}get clientId(){return this._clientId}get Okc(){return this.zvk}get UVa(){return this.Avk}get iTl(){return this.Brk}static createInstance(pa,
Hb,Ob,Dc,nd=!1){return new Va(pa,Hb,Ob,Dc,nd)}}Object(f.a)(Va,"PeoplesWellSettings",null,[]);var Za=d(108),Ka=d(80),bb=d(178),Ib=d(114),ib=d(207),jb=d(226),hb=d(411),pb=d(339);class ob extends ib.a{constructor(){super();this.JoinTimeInMS=0;this.IsAnonymous=!1;this.ImageUrl=null;this.CanJump=this.ActiveStatus=!1;this.Upn=null}get ControlType(){return 5}}Object(f.a)(ob,"PeopleButtonProps",ib.a,[]);var sb=d(480),Ab=d(17),nc=d(94);class qc{constructor(pa){this.etd=new nc.a;this.nuf=null;this.clientId=
pa}dXo(pa){this.tuo();this.uPo(pa);for(const Hb of pa)Hb.clientId!==this.clientId&&this.HNh(Hb)}get AMg(){const pa=[];for(const Hb of this.etd.values){const Ob=this.$Ij(Hb);Array.add(pa,Ob)}return pa}get cvb(){return this.etd.count}Gef(pa,Hb){pa=pa.toUpperCase();let Ob;({value:Ob}=this.etd.Ac(pa)).returnValue||(Ob=[],this.etd.Z(pa,Ob));Array.add(Ob,Hb)}tuo(){this.etd=new nc.a}uPo(pa){for(const Hb of pa)if(Hb.clientId===this.clientId){this.nuf=Hb;break}}}Object(f.a)(qc,"UserTracker",null,[1892]);class Jc extends qc{constructor(pa,
Hb){super(pa);this.Bvk=Hb}HNh(pa){pa.isAnonymous||!pa.email?this.Gef(pa.clientId,pa):this.nuf&&F.a.th().equals(this.nuf.email,pa.email)||this.Gef(pa.email,pa)}$Ij(pa){let Hb=new Date(0),Ob=0<pa.length?pa[0]:null;for(const Dc of pa)(pa=this.Bvk(Dc.clientId))&&Hb.getTime()<pa.Bpc.getTime()&&(Hb=pa.Bpc,Ob=Dc);return Ob}}Object(f.a)(Jc,"UniqueUserTracker",qc,[]);class ad extends qc{constructor(pa){super(pa)}HNh(pa){this.Gef(pa.clientId,pa)}$Ij(pa){return pa[0]}}Object(f.a)(ad,"UserInstanceTracker",qc,
[]);const Kc=(pa,Hb,Ob)=>Ob?new Jc(pa,Hb):new ad(pa);var Jb=d(89),Zb=d(1240),xb=d(13);class $b{constructor(pa,Hb=null,Ob=null){this.bF=null;this.y$e=new w.a;this.bTn=(Dc,nd,Od,ye,Oe)=>{this.y$e.rV(Oe.RenderTime);return 32};this.Ne=pa;this.Zoe=Hb;Ob&&Ob.continueWith(()=>{this.bF=Ob.result;this.bF.qcc(Object(Za.a)(this,this.vga,"onUsersUpdated"));this.Ase()});new Ca.a(this.settings.clientId,"Anonymous user","#cccccc",new ua.a(7));this.bYf=this.EXe=!0;this.lTe=this.a3e=!1;this.KEa=Kc(this.settings.clientId,
this.settings.UVa,pa.iTl)}get settings(){return this.Ne}get Jcn(){return m.AFrameworkApplication.J?m.AFrameworkApplication.J.$("ColorPresenceHashIsEnabled"):!1}get Fcn(){return m.AFrameworkApplication.J?m.AFrameworkApplication.J.$("PeoplesWellExtraButtonInfoIsEnabled"):!1}$km(){let pa,Hb,Ob,Dc;var nd=this.alm();this.KEa.cvb?1===this.KEa.cvb?(pa=!0,Hb=this.settings.yxc.cluster,Ob=this.settings.yxc.iYd,Dc=this.KEa.AMg[0].color):(pa=!0,Hb=this.settings.Oje.cluster,Ob=this.settings.Oje.iYd,Dc=""):(pa=
!1,Dc=Ob=Hb="");const Od=nd[0];nd=nd.slice(1);return{t3n:Od,u3n:nd,p3n:pa,bcq:Hb,r3n:Ob,q3n:Dc}}alm(){if(2<=this.KEa.cvb)return[String.format(CommonUIStrings.l_PeoplesWellStateNumberOfOtherPeopleEditingHere,this.KEa.cvb)];if(1===this.KEa.cvb){const pa=this.KEa.AMg[0],Hb=this.settings.UVa(pa.clientId);return Hb&&2===Hb.status?[CommonUIStrings.l_PeoplesWellStateUserIsInactive,pa.userName]:[pa.isReadOnly?CommonUIStrings.l_PeoplesWellStateUserIsAlsoViewing:CommonUIStrings.l_PeoplesWellStateUserIsAlsoEditing,
pa.userName]}return[CommonUIStrings.l_PeoplesWellStateYouAreAllByYourself]}ONm(pa){return this.PNm(pa)}YYh(pa,Hb,Ob){return Hb?this.ajl(Hb)?(pa=this.settings.UVa(pa))&&2===pa.status?!1:!0:(Ob&&l.ULS.sendTraceTag(4482394,325,50,"User has presence data but app can't use it"),!1):(Ob&&l.ULS.sendTraceTag(4482393,325,50,"User does not have any presence data"),!1)}iJm(pa){return pa.isReadOnly?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOffline:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}PNm(pa){if(!pa.capabilities.BKa(1))return this.iJm(pa);
const Hb=pa.isReadOnly,Ob=this.settings.UVa(pa.clientId);pa=this.settings.Okc(pa.clientId);if(!Ob)return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;switch(Ob.status){case 1:return pa?Hb?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOnline:this.Bzl(pa)||CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;case 2:return CommonUIStrings.l_PeoplesWellUserStatusIsInactive;default:return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}}vtm(pa){if(this.Zoe.I$c)return this.Zoe.sMb(pa.email,
"O365",m.AFrameworkApplication.um,0)}BNm(pa){pa=this.settings.UVa(pa.clientId);return!pa||pa&&1===pa.status?!0:!1}ENm(pa){var Hb=String.format("buttonPeoplesWellUser-{0}",pa.clientId),Ob=pa.clientId,Dc=this.ONm(pa);const nd=pa.userName,Od=pa.color;var ye=Object,Oe=ye.assign,Cf=new ob,Bg=this.settings.OPd.toString(),Zg=this.settings.qze.cluster,Qg=this.settings.qze.iYd,Sg=this.Jvi(),Qk=pa.isAnonymous,bk;if(bk=[nd],bk.length){var df=new Sys.StringBuilder("STRARRY@");for(const fc of bk)df.append(fc?
fc.length:0),df.append(","),df.append(fc),df.append(",");bk=df.toString().slice(0,-1)}else bk=null;Hb=Oe.call(ye,Cf,{Id:Hb,Command:Bg,LabelText:"{0}",Image32by32:Zg,Image32by32Class:Qg,MenuItemId:Ob,CommandValueId:Ob,Alt:nd,DisplayMode:Sg,LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",Description:Dc,ImageBackColor:Od,IsAnonymous:Qk,LabelTextUserGeneratedPlaceholderReplacements:bk,Upn:pa.email});m.AFrameworkApplication.J.$("PeoplesWellExtraButtonInfoIsEnabled")&&
this.Zoe&&(Ob=this.vtm(pa),Dc=this.BNm(pa),Hb.ImageUrl=Ob,Hb.ActiveStatus=Dc,Hb.JoinTimeInMS=pa.DXa,pa=this.YYh(pa.clientId,this.settings.Okc(pa.clientId),!1),Hb.CanJump=pa,""===Ob&&l.ULS.sendTraceTag(40969413,302,50,"ImageURL collection failed"));return Hb}Hrm(){return Object.assign(new ib.a,{Id:"BasicChat",Command:"2288458806",LabelText:CommonUIStrings.l_StartGroupChat,LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word"})}Jvi(){return this.Jcn?"Initials":
"Menu32"}FNm(pa){const Hb=[];for(const Ob of pa)pa=this.ENm(Ob),Array.add(Hb,pa);return Hb}Gce(){return 0<this.KEa.cvb}mio(pa){if(!this.EXe)return!0;this.bYf||(pa[Zb.a.Visible]=!0);const {t3n:Hb,u3n:Ob,p3n:Dc,r3n:nd,q3n:Od}=this.$km();pa[Zb.a.LabelText]=Hb;Ob&&Ob.length&&(pa[Zb.a.LabelTextUserGeneratedPlaceholderReplacements]=Ob);pa[Zb.a.ImageIsVisible]=Dc;pa[Zb.a.Image16by16Class]=nd;pa[Zb.a.ImageBackColor]=Od;this.EXe=!1;return!0}p$n(pa){if(0>=this.KEa.cvb)return!1;var Hb=this.T7o(this.KEa.AMg),
Ob=this.FNm(Hb);Hb=Object.assign(new hb.a,{Id:"menuCoauthors",MaxWidth:"220px",MenuSectionList:[]});Ob=Object.assign(new pb.a,{Id:"msCoauthors",ControlsId:"msCoauthorsControls",DisplayMode:this.Jvi(),ControlList:Ob});m.AFrameworkApplication.J.$("WordEditorDisplayPeoplesWellLabelIsEnabled")&&this.Zoe&&(Ob.Title=CommonUIStrings.l_PeoplesWellFlyoutLabel,Ob.TitleId="menuCoauthorsTitle",Ob.Theme="Light");Array.add(Hb.MenuSectionList,Ob);m.AFrameworkApplication.J.$("DocChatIsEnabled")&&m.AFrameworkApplication.J.$("PeoplesWellExtraButtonInfoIsEnabled")&&
m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib.As&&(Ob=[],Array.add(Ob,this.Hrm()),Ob=Object.assign(new pb.a,{Id:"msGroupChat",ControlsId:"msGroupChatControl",ControlList:Ob}),Array.add(Hb.MenuSectionList,Ob));m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib.As?pa.MenuItems=Hb:pa.PopulationXML=jb.o(Hb);return!0}yMg(pa){l.ULS.sendTraceTag(4482395,325,50,"PeoplesWell: Received user button click");pa=pa.MenuItemId;if(!pa)return!1;const Hb=this.settings.Okc(pa);if(!this.YYh(pa,Hb,
!0))return!1;this.wsn(Hb);return!0}Roo(){const pa=this.Xem();this.KEa.dXo(pa);this.bYf&&1<=this.KEa.cvb&&(l.ULS.sendTraceTag(6092429,325,50,"PeoplesWell: User is no longer forever alone."),this.bYf=!1);this.EXe=!0}vga(){this.lTe||(window.setTimeout(()=>{this.Ase();this.lTe=!1},3E3),this.lTe=!0)}Xem(){let pa;pa=this.Wem()||[];for(const Hb of pa)this.tHo(Hb);return pa}tHo(pa){pa.clientId||(pa.clientId=K.a.create().toString());pa.userName||(pa.userName="Anonymous user");pa.capabilities||(pa.capabilities=
new ua.a);pa.color||(pa.color="#cccccc");pa.DXa||(pa.DXa=0)}T7o(pa){const Hb=[];Array.addRange(Hb,pa);Hb.sort($b.$2n);return Hb}vso(){m.AFrameworkApplication.J.$("CoauthorGalleryTelemetryIsEnabled")&&!this.a3e&&(m.AFrameworkApplication.va.H2(xb.a.J2h)&&sb.a.isSharedUxGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DoNotRegisterCoauthorsRenderedMultiplTimes")||m.AFrameworkApplication.va.fb(xb.a.J2h,Jb.a.frame,this.bTn,96));this.wso();this.a3e=!0;this.Ase()}get f_j(){return this.y$e.task}Ase(){if(!this.a3e&&
(this.y$e.rV((new Date).getTime()),l.ULS.sendTraceTag(42567504,325,50,"We are trying to render the coauthor gallery before we are ready to record the render time"),this.Fcn))return;this.Roo();this.Soo()}dispose(){this.bF&&(this.bF.fsg(Object(Za.a)(this,this.vga,"onUsersUpdated")),this.bF=null)}static $2n(pa,Hb){return pa.capabilities.BKa(1)&&Hb.capabilities.BKa(1)||!pa.capabilities.BKa(1)&&!Hb.capabilities.BKa(1)?Ab.a.localeCompare(pa.userName,Hb.userName):pa.capabilities.BKa(1)?-1:1}}Object(f.a)($b,
"APeoplesWell",null,[1837,10]);var Xb=d(11);const Lb=()=>!0;class gc extends $b{constructor(pa,Hb,Ob=null,Dc=null){super(pa,Ob,Dc);this.wdn=(nd,Od,ye,Oe,Cf)=>this.M9a(ye,Cf,()=>this.Gce(),Lb);this.nio=(nd,Od,ye,Oe,Cf)=>this.M9a(ye,Cf,Bg=>this.mio(Bg),Lb);this.q$n=(nd,Od,ye,Oe,Cf)=>this.M9a(ye,Cf,Lb,Bg=>this.p$n(Bg));this.htl=(nd,Od,ye,Oe,Cf)=>this.M9a(ye,Cf,Lb,Lb);this.gtl=(nd,Od,ye,Oe,Cf)=>this.M9a(ye,Cf,Lb,Lb);this.vzp=(nd,Od,ye,Oe,Cf)=>this.M9a(ye,Cf,Lb,Bg=>this.yMg(Bg));this.Y7n=(nd,Od,ye,Oe,
Cf)=>this.M9a(ye,Cf,Lb,()=>{this.Ase();return!0});this.ga=Hb}M9a(pa,Hb,Ob,Dc){let nd=!1;switch(pa){case 1:nd=Ob(Hb);break;case 2:nd=Dc(Hb)}return nd?32:8}wso(){this.ga.qa(this.settings.IPd,Xb.a.application,this.wdn);this.ga.fb(this.settings.MPd,Xb.a.application,this.nio,96);this.ga.fb(this.settings.KPd,Xb.a.application,this.htl,96);this.ga.fb(this.settings.JPd,Xb.a.application,this.gtl,96);this.ga.fb(this.settings.LPd,Xb.a.application,this.q$n,96);this.ga.qa(this.settings.OPd,Xb.a.application,this.vzp);
this.ga.fb(this.settings.Gcf,Xb.a.application,this.Y7n,96)}}Object(f.a)(gc,"ABox4PeoplesWell",$b,[]);var qa=d(3),ra=d(119),Ya=d(51),ab=d(8),cb=d(26),Eb=d(163);class mc{static isSupported(pa){for(let Hb=0;Hb<mc.HXj.length;Hb++)if(pa===mc.HXj[Hb])return!0;return!1}}mc.HXj=[1];Object(f.a)(mc,"RTTDataVersion",null,[]);var tb=d(1575);const Xa=pa=>{if("number"!==typeof pa.RK||"number"!==typeof pa.DK)return!1;let Hb,Ob=!1,Dc=!1,nd=!1;switch(pa.RK){case 0:Dc=Hb=!0;break;case 1:nd=Ob=Dc=Hb=!0;break;case 2:if(null!=
pa.PE&&"number"!==typeof pa.PE)return!1;Hb=!0;break;case 4:Hb=!0;break;case 3:Dc=Hb=!0;break;case 5:Ob=Hb=!0;break;default:return!1}return Hb&&("number"!==typeof pa.PS||"number"!==typeof pa.TS)||Dc&&("object"!==typeof pa.OS||!pa.OS||!tb.validateVersionedCpData(pa.OS))||Ob&&("number"!==typeof pa.PE||"number"!==typeof pa.TE)||nd&&("object"!==typeof pa.OE||!pa.OE||!tb.validateVersionedCpData(pa.OE))?!1:!0},Mb=pa=>{let Hb="";if("number"!==typeof pa.I)return{returnValue:!1,Bla:"Invalid PacketId Type"};
if("number"!==typeof pa.O)return{returnValue:!1,Bla:"Invalid Operation Type"};if("string"!==typeof pa.A)return{returnValue:!1,Bla:"Invalid ClientId Type"};if("object"!==typeof pa.AN)return{returnValue:!1,Bla:"Invalid Anchor Object Type"};if(!pa.AN)return{returnValue:!1,Bla:"Null AnchorObject"};if(!Xa(pa.AN)){let Ob;try{Ob=T.c(pa.AN)}catch(Dc){Ob=String.format("Failed to JSON-serialize payload : {0}",Dc)}8E3<Ob.length&&(Ob=String.format("Payload exceeds maximum length: {0} > {1}, not logging",Ob.length,
8E3));Hb="Invalid AnchorObject: "+Ob+", Client: "+pa.C;return{returnValue:!1,Bla:Hb}}return!pa.O&&pa.AN.RK?(Hb="Invalid RangeKind:"+pa.AN.RK+" for Caret",{returnValue:!1,Bla:Hb}):2===pa.O&&("number"!==typeof pa.TF||"undefined"!==typeof pa.TX&&"string"!==typeof pa.TX||1!==pa.AN.RK&&pa.AN.RK)?{returnValue:!1,Bla:"Invalid TypingData"}:3!==pa.O||"object"===typeof pa.AP&&pa.AP&&"number"===typeof pa.AP.TFA&&"number"===typeof pa.AP.PN&&"number"===typeof pa.AP.TN&&2===pa.AN.RK?6!==pa.O||"object"===typeof pa.MP&&
pa.MP&&"number"===typeof pa.MP.PM&&"number"===typeof pa.MP.TM&&5===pa.AN.RK?4!==pa.O||"object"===typeof pa.SP&&pa.SP&&"number"===typeof pa.SP.PA&&"number"===typeof pa.SP.TA&&"number"===typeof pa.SP.PB&&"number"===typeof pa.SP.TBS&&3===pa.AN.RK&&(pa.AN.PS===pa.SP.PA||pa.AN.PS===pa.SP.PB)?7!==pa.O||"object"===typeof pa.SPS&&pa.SPS&&"string"===typeof pa.SPS.SF&&"boolean"===typeof pa.SPS.SL?null!=pa.ISS&&"number"!==typeof pa.ISS?{returnValue:!1,Bla:"invalid StrictlySequentialId"}:{returnValue:!0,Bla:Hb}:
{returnValue:!1,Bla:"Invalid SymbolData"}:{returnValue:!1,Bla:"Invalid SplitParaData"}:{returnValue:!1,Bla:"Invalid RemoveParaData"}:{returnValue:!1,Bla:"Invalid AddParaData"}};var cc=d(1530);class oc{constructor(pa,Hb=null,Ob=null){this.u4=this.Yhg=this.mHg=null;null!=pa&&(this.mHg=pa);null!=Hb&&(this.Yhg=Hb);null!=Ob&&(this.u4=Ob)}}Object(f.a)(oc,"AddParaData",null,[]);class Pc{constructor(pa=null,Hb=null){this.Qyc=this.Xhg=null;null!=pa&&(this.Xhg=pa);null!=Hb&&(this.Qyc=Hb)}}Object(f.a)(Pc,"MergeRemoveParaData",
null,[]);class vb{constructor(pa,Hb,Ob,Dc,nd,Od,ye=null,Oe=null,Cf=null,Bg=null,Zg=null,Qg=null,Sg=0,Qk=null){this.iqd=this.text=this.i1b=this.B0b=this.Ecd=this.Ybc=this.foa=null;this.packetId=pa;this.client=Ob;this.operationType=Dc;this.clientId=Hb.toLowerCase();this.sW=nd;this.version=Sg;Od&&(this.foa=Od);null!=ye&&(this.i1b=ye);void 0!==Oe&&null!==Oe&&(this.text=Oe);Cf&&(this.Ybc=Cf);Bg&&(this.Ecd=Bg);Zg&&(this.B0b=Zg);Qg&&(this.iqd=Qg);this.strictlySequentialId=Qk}}Object(f.a)(vb,"RTTData",null,
[]);class jd{constructor(pa=null,Hb=null,Ob=null,Dc=null){this.lHg=this.Whg=this.iHg=this.Vhg=null;null!=pa&&(this.Vhg=pa);null!=Hb&&(this.iHg=Hb);null!=Ob&&(this.Whg=Ob);null!=Dc&&(this.lHg=Dc)}}Object(f.a)(jd,"SplitParaData",null,[]);class ud{constructor(pa=null,Hb=null){this.NFg=this.MFg=null;pa&&(this.MFg=pa);null!=Hb&&(this.NFg=Hb)}}Object(f.a)(ud,"SymbolData",null,[]);class qe{constructor(pa,Hb=null,Ob=null){null!=pa&&(this.TFA=pa);null!=Hb&&(this.PN=Hb);null!=Ob&&(this.TN=Ob)}}Object(f.a)(qe,
"SerializableAddParaDataV1",null,[]);class Ae{constructor(pa=null,Hb=null){null!=pa&&(this.PM=pa);null!=Hb&&(this.TM=Hb)}}Object(f.a)(Ae,"SerializableMergeRemoveParaDataV1",null,[]);class hf{}Object(f.a)(hf,"SerializableRTTDataV1",null,[]);class Qe{constructor(pa=null,Hb=null,Ob=null,Dc=null){null!=pa&&(this.PA=pa);null!=Hb&&(this.TA=Hb);null!=Ob&&(this.PB=Ob);null!=Dc&&(this.TBS=Dc)}}Object(f.a)(Qe,"SerializableSplitParaDataV1",null,[]);class vf{constructor(pa=null,Hb=null){pa&&(this.SF=pa);null!=
Hb&&(this.SL=Hb)}}Object(f.a)(vf,"SerializableSymbolDataV1",null,[]);const Jd=pa=>{var Hb;if(!({Bla:Hb}=Mb(pa)).returnValue)return l.ULS.sendTraceTag(9188759,302,15,"Failed to parse RTT packet, InvalidFieldInfo {0}",Hb),null;let Ob=Hb=null,Dc=null,nd=null,Od=null,ye=null,Oe=null,Cf=null;pa.WD&&(Hb=pa.WD);null!=pa.TF&&(Ob=pa.TF);void 0!==pa.TX&&null!==pa.TX&&(Dc=pa.TX);pa.AP&&(nd=new oc(pa.AP.TFA,pa.AP.PN,pa.AP.TN));pa.MP&&(Od=new Pc(pa.MP.PM,pa.MP.TM));pa.SP&&(ye=new jd(pa.SP.PA,pa.SP.TA,pa.SP.PB,
pa.SP.TBS));pa.SPS&&(Oe=new ud(pa.SPS.SF,pa.SPS.SL));null!=pa.ISS&&(Cf=pa.ISS);return new vb(pa.I,pa.A,pa.C,pa.O,cc.a(pa.AN),Hb,Ob,Dc,nd,Od,ye,Oe,1,Cf)},mh=pa=>{let Hb=pa;if("number"===typeof Hb.V){if(1===Hb.V)return Jd(pa);l.ULS.sendTraceTag(9188758,302,15,"Unsupported Version");return null}let Ob=0,Dc=null;for(let nd=0;nd<pa.length;nd++)Hb=pa[nd],mc.isSupported(Hb.V)&&Hb.V>Ob&&(Ob=Hb.V,Dc=pa[nd]);return 1===Ob?Jd(Dc):null},gh=pa=>{if(pa){const Hb=new hf;Hb.I=pa.packetId;Hb.V=1;Hb.A=pa.clientId;
Hb.C=pa.client;Hb.O=pa.operationType;Hb.AN=cc.c(pa.sW);pa.foa&&(Hb.WD=pa.foa);null!=pa.i1b&&(Hb.TF=pa.i1b);void 0!==pa.text&&null!==pa.text&&0<pa.text.length&&(Hb.TX=pa.text);pa.Ybc&&(Hb.AP=new qe(pa.Ybc.mHg,pa.Ybc.Yhg,pa.Ybc.u4));pa.Ecd&&(Hb.MP=new Ae(pa.Ecd.Xhg,pa.Ecd.Qyc));pa.B0b&&(Hb.SP=new Qe(pa.B0b.Vhg,pa.B0b.iHg,pa.B0b.Whg,pa.B0b.lHg));pa.iqd&&(Hb.SPS=new vf(pa.iqd.MFg,pa.iqd.NFg));Hb.ISS=pa.strictlySequentialId;pa=Hb}else pa=null;return pa};var Td=d(48);class Vc{constructor(pa,Hb,Ob,Dc,nd,
Od,ye,Oe,Cf){this.LocalCobaltSessionId=pa;this.SkypeChatThreadId=Hb;this.ChatThreadDiscoveryUri=Ob;this.InChat=Dc;this.Capabilities=nd;this.Email=Od;this.UserName=ye;this.IsAnonymous=Oe;this.PresenceStatus=Cf}}Object(f.a)(Vc,"SerializableWacData",null,[]);class id{constructor(){this.rMd=this.qMd=0}Tym(){this.rMd===Number.MAX_VALUE&&(this.rMd=0);this.rMd++;return this.rMd}Sym(){this.qMd===Number.MAX_VALUE&&(this.qMd=0);this.qMd++;return this.qMd}static get instance(){return id.oMk}}id.oMk=new id;Object(f.a)(id,
"StrictlySequentialIdGenerator",null,[795]);var Re=d(1428);class cf{constructor(pa,Hb,Ob,Dc,nd,Od,ye,Oe=0){this.Kxa=null;this.dryDeletion=0;this.KK=pa;this.RRa=Od;this.yd=nd;this.sJb=ye;this.Yc=Hb;this.shapeId=Oe;this.OMa=Ob;this.Wba=ye.create(this,Dc,nd,Od)}clone(){return new cf(this.KK,this.Yc,this.OMa,this.Wba.T2b,this.yd,this.RRa,this.sJb,this.shapeId)}get paragraphId(){return this.Kxa?this.Kxa:this.KK.Jqb(this.Yc)}wfg(){this.Kxa||(this.Kxa=this.paragraphId,this.Wba.wfg())}isValid(){return 0<=
this.Wba.cp}getData(){const pa=this.Wba.T2b;return pa?new Re.a(0,this.Yc,this.OMa,pa,null,null,null,0,this.shapeId):null}static cMb(pa,Hb,Ob,Dc,nd){return Hb?new cf(Hb,parseInt(pa.PYa),pa.Keb,pa.RU,Ob,Dc,nd,pa.shapeId):null}}Object(f.a)(cf,"WordPresenceIp",null,[784,43,785]);class me{constructor(pa,Hb,Ob){this.z_a=this.Rfa=this.CKc=!1;this.Jjb=pa;this.G2a=Ob;this.user=Hb}get ip(){return this.G2a}get Fqc(){return this.CKc}set Fqc(pa){(this.CKc=pa)&&this.ip.wfg()}LMf(){const pa=id.instance.Sym();return new vb(this.Jjb,
this.user.clientId,1,0,this.ip?this.ip.getData():null,new Vc(this.user.GF,this.user.oUc,this.user.chatThreadDiscoveryUri,this.user.inChat,this.user.capabilities.capabilities,this.user.email,this.user.userName,this.user.isAnonymous,this.user.presenceStatus),void 0,void 0,void 0,void 0,void 0,void 0,void 0,pa)}Kxi(){return this.user.clientId+(this.ip?this.ip.paragraphId.toString():Td.a.nil.toString())}isValid(){const pa=!!this.user&&this.user.isValid(),Hb=!this.ip||this.ip.isValid();return pa&&Hb}clone(){const pa=
new me;pa.Jjb=this.Jjb;pa.CKc=this.CKc;pa.user=this.user?this.user.clone():null;pa.G2a=this.ip?this.ip.clone():null;pa.Rfa=this.Rfa;pa.z_a=this.z_a;return pa}static isf(pa,Hb,Ob,Dc,nd){if(!pa||!Hb)return null;if(pa.operationType)return l.ULS.sendTraceTag(7685324,302,15,"Presence packet is of unexpected operationType {0}",pa.operationType),null;let Od;Od=void 0!==pa.foa&&null!==pa.foa?Ta.K8h(pa.clientId,pa.foa.UserName,pa.foa.Capabilities,pa.foa.LocalCobaltSessionId,pa.foa.SkypeChatThreadId,pa.foa.Email,
pa.client,pa.foa.ChatThreadDiscoveryUri,pa.foa.InChat,!1,pa.foa.IsAnonymous,pa.foa.PresenceStatus):Ta.K8h(pa.clientId,null,0,void 0,void 0,void 0,pa.client);return new me(pa.packetId,Od,cf.cMb(pa.sW,Hb,Ob,Dc,nd))}}Object(f.a)(me,"WordPresenceInfo",null,[791,43]);class ce extends gc{constructor(pa,Hb,Ob,Dc,nd,Od,ye,Oe,Cf,Bg,Zg,Qg,Sg,Qk){super(pa,Od,Qk,Hb);this.Unk=Ob;this.QJk=Dc;this.hIk=nd;this.hb=ye;ce.Ky=Oe;this.KK=Cf;this.yd=Bg;this.RRa=Zg;this.icf=Qg;this.VPa=Sg}yMg(pa){this.VPa.n3i(pa.CommandValueId);
return super.yMg(pa)}wsn(pa){let Hb;({Ykg:Hb}=this.RZf(pa)).returnValue&&(this.QJk(Hb.ip.paragraphId,Hb.ip.Wba.cp),m.AFrameworkApplication.J.$("WordEditorMoveIpToUserLocationIsEnabled")&&(pa=ce.NHm(Hb),void 0!==pa&&null!==pa?(l.ULS.sendTraceTag(20764574,325,50,"Attempting to move IP to the editing location of the selected user"),this.hb.Kc(pa),Ka.FocusManager.nM()&&Ka.FocusManager.instance().Jg(bb.AFrame.Ro)):l.ULS.sendTraceTag(20764575,325,50,"IP will not be moved since the selection is either null or undefined")),
pa=new Ba.a(2,1,0,()=>{this.ga.Pb(qa.a.Sye,2,Hb)}),Ib.a.instance.Zb(pa))}nDi(pa){return pa?(pa=me.isf(mh(pa),this.KK,this.yd,this.RRa,this.icf.instance))&&pa.isValid()&&pa.ip?pa:null:null}ajl(pa){return this.fmn(pa)?this.rjl(pa)?!0:(l.ULS.sendTraceTag(41236613,325,50,"Cannot jump to user location because paragraph has not been loaded yet"),!1):(l.ULS.sendTraceTag(41236612,325,50,"Cannot jump to user location because presence is not valid"),!1)}fmn(pa){return!!this.nDi(pa)}RZf(pa){pa=this.nDi(pa);
return{returnValue:!!pa,Ykg:pa}}rjl(pa){let Hb;return({Ykg:Hb}=this.RZf(pa)).returnValue?this.Unk(Hb.ip.paragraphId,Hb.ip.Wba.cp):!1}Wem(){if(!this.bF)return[];const pa=[];for(const Hb of this.bF.Zpb())Hb.userName?pa.push(Hb):l.ULS.sendTraceTag(592229832,304,15,"The looked up RTC User has no name");return pa}Bzl(pa){let Hb;return({Ykg:Hb}=this.RZf(pa)).returnValue&&Hb.user&&Hb.user.presenceStatus&&"0"!==Hb.user.presenceStatus?String.format(WordEditorIntl.WordEditorStrings.l_PresenceStatusOnPage,Hb.user.presenceStatus):
CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}Soo(){this.hIk(this.settings.id)}static createInstance(pa,Hb,Ob,Dc,nd,Od,ye){const Oe=Ra.StaticActiveAppFrame.za().kb,Cf=m.AFrameworkApplication.va,Bg=Ya.a.instance,Zg=Ha.a.instance.resolve(425);return new ce(pa,Hb,Qg=>Oe.Jc.gj?Oe.Jc.pmf(Qg,!0):!1,(Qg,Sg)=>{Oe.Jc.gj&&Oe.Jc.QZb(Qg,Sg,!0,!0,!1,!1)},()=>{ra.a.GC.WK.ysd()},Cf,Bg,Oe,Ob,Dc,nd,Od,Zg,ye)}static NHm(pa){const Hb=ce.Ky.$c.td.Eb(pa.ip.paragraphId);if(void 0===Hb||null===Hb)return l.ULS.sendTraceTag(20764576,
325,15,"The node could not be obtained"),null;if(!ab.ParagraphReader.Vb(Hb))return l.ULS.sendTraceTag(20764577,325,15,"The obtained node is not a paragraph node"),null;pa=cb.a.Tc(Hb,pa.ip.Wba.cp);return new Eb.Selection([pa],!0)}}ce.Ky=null;Object(f.a)(ce,"WordEditorPeoplesWell",gc,[]);class Ie{constructor(){this.fz=()=>{m.AFrameworkApplication.Xqj?Ie.bva.aD().continueWith(this.Yed):l.ULS.sendTraceTag(23196872,325,50,"PeoplesWell control is explicitly disabled. Skipping initialization attempt")};
this.Yed=()=>{Ie.Yh=Ie.bva.aD().result;if(Ie.Yh){var pa=()=>{const Hb=Ra.StaticActiveAppFrame.za().kb;return Hb?Hb.$c?Hb.$c.td:(l.ULS.sendTraceTag(23196876,325,15,"ActivePage is null"),null):(l.ULS.sendTraceTag(23196875,325,15,"Workspace is null"),null)};qb.a.Isa().continueWith(()=>{const Hb=qb.a.Isa().result.Bj,Ob=kb.a.NCm(m.AFrameworkApplication.Ss,m.AFrameworkApplication.Ss,m.AFrameworkApplication.Ss,m.AFrameworkApplication.Ss),Dc=Va.createInstance(Ob,Hb,Object(Za.a)(Ie.Yh.Kue,Ie.Yh.Kue.Okc,"getUserPresence"),
Object(Za.a)(Ie.Yh.Kue,Ie.Yh.Kue.UVa,"getUserStatusInfo"),m.AFrameworkApplication.J.$("WordEditorPresenceDedupeMultipleCoauthorInstances"));Ha.a.instance.ia("RealtimePresenceUI.WordEditorPeoplesWell",()=>ce.createInstance(Dc,Na.a.Yp(Ie.W.Ra(613)),Ie.W.Oa(440),Ie.W.Oa(1244),pa,Ie.W.Ra(1638),Ie.W.resolve(142))).as(1630).ha();Ie._instance=Ha.a.instance.resolve(1630);Ie._instance.vso();l.ULS.sendTraceTag(23196877,325,50,"PeoplesWellControl is fully initialized")})}else l.ULS.sendTraceTag(23196873,325,
15,"Can't initialize the PeoplesWell control because can't get a handle to RtcProxy")}}get name(){return"WordEditor.PeoplesWellControl"}uc(pa){Ie.W=pa}init(){m.AFrameworkApplication.J.Uo(this.fz)}dispose(){Ie._instance&&(Ie._instance.dispose(),Ie._instance=null)}static get bva(){return null!=Ie.f2g?Ie.f2g:Ie.f2g=Ha.a.instance.resolve(543)}}Ie._instance=null;Ie.W=null;Ie.Yh=null;Object(f.a)(Ie,"WordEditorPeoplesWellControlPackage",null,[0,1]);var Le=d(103),we=d(260);class xf{constructor(pa,Hb,Ob,Dc,
nd,Od,ye,Oe,Cf=!1){this.hgb=null;this.zRe=!0;this.G3e=this.Yk=this.eKe=null;this.sa=new ea.a;this.P2m=()=>{this.tO.result&&this.Myh.result&&(this.Yk=this.tO.result,this.G3e=this.Myh.result,this.Yk.Qya(this.TU),this.eKe=new Ba.a(2,2,this.H8g,this.frp,88),xf.Gb.Zb(this.eKe))};this.TU=(Bg,Zg)=>{(this.zRe||this.vlo(Zg.Oha))&&xf.Gb.X3(this.eKe,0)};this.frp=Bg=>{var Zg=this.Yk.Iic();if(Zg){var Qg=new Date,Sg=!1;if(this.zRe){this.hgb=Zg;this.zRe=!1;var Qk=this.hgb;for(var bk in Qk){Zg=bk;var df=Qk[bk];df.Bpc<
Qg&&(Qg=df.Bpc);2===df.status&&(Sg=!0,this.G3e.Wjd(Zg))}Sg&&this.Dwj();xf.Gb.X3(Bg,this.YAi(Qg))}else{df=new P.a;bk=!1;var fc=this.hgb;for(Qk in fc){fc=Qk;if(!(fc in this.hgb)||this.LRa.clientId===fc)continue;var vd=this.hgb[fc];const Uc=Zg[fc];if(vd&&Uc){vd=vd.status;const ze=Uc.status;2===vd&&1===ze?(df.add(fc),l.ULS.sendTraceTag(38052609,392,50,fc+" returned from away")):1===vd&&2===ze&&(bk=Sg=!0,this.G3e.Wjd(fc),l.ULS.sendTraceTag(38052610,392,50,fc+" went away"));1===ze&&Uc.Bpc<Qg&&(Qg=Uc.Bpc)}}this.hgb=
Zg;xf.Gb.X3(Bg,this.YAi(Qg));(0<df.count||Sg)&&this.Dwj();0<df.count&&!this.rIk?(Bg=this.mjm(df),this.Khp(Bg)):Bg=new P.a;(bk||0<Bg.count)&&this.jHk(xb.a.wVd,2)}}};this.LRa=pa;this.tO=Hb;this.Myh=Ob;this.YMc=Dc;this.H8g=Od;xf.Gb=nd;this.jHk=ye;this.h$=Oe;this.rIk=Cf;E.Task.WAA(Hb,Ob).continueWith(this.P2m)}s0k(pa){this.sa.addHandler("u",pa)}Dwj(){this.sa.raiseEvent("u",null,this)}vlo(pa){for(const Ob in pa){var Hb=this.YMc.C7d({key:Ob,value:pa[Ob]});if(Hb&&Hb.clientId&&(Hb=Hb.clientId.toLowerCase(),
(Hb=this.hgb[Hb]||this.hgb[Hb.toUpperCase()])&&2===Hb.status))return!0}return!1}Khp(pa){if(pa.count)for(const Hb of pa)pa=this.h$.cka(String.format(CommonUIStrings.l_EditorsToastArriving,Hb),!1),pa.image=5,pa.sla="CoAuth_AuthorStatus_16x16x32",this.h$.Jz(pa)}mjm(pa){const Hb=this.Yk.Ypb(),Ob=new P.a;for(const Dc in Hb){const nd={key:Dc,value:Hb[Dc]};if(pa.contains(nd.key)){const Od=this.YMc.C7d(nd);Od&&(Ob.add(Od.userName),pa.remove(nd.key))}}Ob.count||l.ULS.sendTraceTag(38052611,392,10,"There were no coauthor names found");
return Ob}YAi(pa){const Hb=new Date;return Math.max(pa.getTime()+this.H8g-Hb.getTime(),0)}}xf.Gb=null;Object(f.a)(xf,"AwayManager",null,[]);var Ig=d(778);class jg{constructor(pa=0){this.updates=pa}get DRf(){return 0!==this.updates}BKa(pa){return!!(this.updates&pa)}Hdb(pa){this.updates|=pa}toString(){if(this.BKa(0))return"none";const pa=new P.a;this.BKa(1)&&pa.add("user(s) joined");this.BKa(2)&&pa.add("user(s) disconnected");this.BKa(4)&&pa.add("user(s) updated");return pa.toArray().join(", ")}}Object(f.a)(jg,
"UserUpdateEvent",null,[]);var kg=d(24);class eh{constructor(pa,Hb,Ob,Dc,nd=null){this.sa=new ea.a;this.zM=this.Yh=null;this.iuh=this.Juh=this.fm=!1;this.ar=new nc.a;this.WLg=()=>{if(this.Yh){var Od=!1,ye=this.Yh.Iic();for(const Cf in ye){var Oe=ye[Cf];const Bg=Cf;this.users.lb(Bg)&&(Oe=this.S0j(Oe),Od=this.users.K(Bg).uLb!==Oe||Od,this.users.K(Bg).uLb=Oe)}Od&&(Od=new jg(4),this.Pve(Od))}};this.fmj=(Od,ye)=>{2===ye.newState&&(Od=this.S7f(this.Yh.Ypb()),Od.DRf&&this.Pve(Od))};this.led=(Od,ye)=>{Od=
new jg;var Oe=this.zM.d1c();l.ULS.sendTraceTag(561894485,302,50,"editorstablemanager coauthors count is {0}, editorstableupdate old count of coauthors is {1}, editorstableupdate new count of coauthors is {2}",Oe.length,ye.OQn,ye.$ej);const Cf=new nc.a;for(var Bg of Oe){Oe=Bg.Id;const Zg=this.W$h(Oe);this.VLg(Od,Zg);Cf.Z(Oe,Zg)}if((ye=ye.N2f)&&0<ye.length)for(Bg=0;Bg<ye.length;Bg++)l.ULS.sendTraceTag(562415168,302,50,"{0} users in coauth gallery. User leaving the editor table: {1}",this.users.count,
ye.K(Bg).Id),({value:Oe}=this.users.Ac(ye.K(Bg).Id)).returnValue?Oe?(this.users.remove(ye.K(Bg).Id),Od.Hdb(2),Cf.Z(ye.K(Bg).Id,Oe)):l.ULS.sendTraceTag(561287839,302,50,"Empty entry in PIP users: {0}",ye.K(Bg).Id):l.ULS.sendTraceTag(570426140,302,15,"Disconnected user not found: {0}",ye.K(Bg).Id);ye=this.Yh.Ypb();for(const Zg in ye)Bg=this.YMc.C7d({key:Zg,value:ye[Zg]}),Cf.Z(Bg.clientId,Bg);for(const Zg of this.users)Cf.lb(Zg.value.clientId)||(l.ULS.sendTraceTag(561287840,302,15,"Coauth Gallery contains user not in Editors Table or RTC presence: {0}",
Zg.key),this.users.remove(Zg.key),Od.Hdb(2));Od.DRf&&this.Pve(Od)};this.hmj=(Od,ye)=>{Od=this.S7f(ye.Oha);for(const Oe of ye.AYc)this.users.lb(Oe)&&(Od.Hdb(2),this.users.K(Oe).uLb=2);Od.DRf&&this.Pve(Od)};pa.continueWith(()=>{this.Yh=pa.result;this.Yh.Qya(this.hmj);this.Yh.NZ(this.fmj);this.WLg(null,null)});Hb.continueWith(()=>{this.zM=Hb.result;this.zM.Olb(this.led)});nd&&nd.continueWith(()=>{nd.result.s0k(this.WLg);this.WLg(null,null)});this.dSa=Ob;this.YMc=Dc}get users(){return this.ar}qcc(pa){this.sa.addHandler("UU",
pa)}fsg(pa){this.sa.removeHandler("UU",pa)}S0j(pa){return 1===pa.status?0:1}Zpb(){this.users.count||(this.Juh||(kg.b(42316242,302,50,"No users available at PeopleInfoProvider.GetAllUsers call"),this.Juh=!0),this.Q$n());const pa=[];for(const Hb of this.users)Array.add(pa,Hb.value);return pa}Q$n(){if(this.Yh){var pa=this.Yh.Ypb();this.S7f(pa)}if(this.zM){pa=this.zM.d1c();for(const Hb of pa)Hb.Id&&(pa=this.W$h(Hb.Id),this.VLg(new jg,pa))}}$5f(pa){({value:pa}=this.users.Ac(pa));return pa}dispose(){this.fm||
(this.Yh&&(this.Yh.HZa(this.hmj),this.Yh.GZa(this.fmj)),this.zM&&this.zM.PBj(this.led),this.fm=!0)}S7f(pa){const Hb=new jg;if(!pa)return Hb;for(const Dc in pa){var Ob=this.YMc.C7d({key:Dc,value:pa[Dc]});Ob&&(Ob=Ob.clone(),this.VLg(Hb,Ob))}return Hb}VLg(pa,Hb){if(Hb){var Ob=Hb.clientId,Dc=this.PDo(Hb);({value:Hb}=this.users.Ac(Ob)).returnValue?Hb.equals(Dc)||(pa.Hdb(4),this.users.Z(Ob,Dc)):(l.ULS.sendTraceTag(562415169,302,50,"{0} users in coauth gallery. User joining: {1}",this.users.count,Ob),pa.Hdb(1),
this.users.Z(Ob,Dc))}}W$h(pa){return this.users.lb(pa)?this.users.K(pa):Ca.a.IDl(pa)}PDo(pa){if(!pa||!pa.clientId||!this.zM)return pa;const Hb=pa.clone();Hb.uLb=this.ljm(pa);if(pa=this.zM.$ic(Hb.clientId))Hb.isReadOnly=Hb.isReadOnly||pa.IsReadOnly?!0:!1,Hb.userName=this.ODo(Hb,pa),Hb.capabilities=this.bJn(Hb.capabilities,pa.Capabilities),Hb.email=Hb.email||pa.SIPAddress||pa.EmailAddress,pa.JoinCoauthTime&&(Hb.DXa=pa.JoinCoauthTime);Hb.color=this.dSa.Nkc(new Ig.a(Hb.email,void 0,Hb.userName,void 0,
Hb.isAnonymous,Hb.clientId),3);return Hb}ljm(pa){if(!this.Yh)return 2;if(pa&&pa.clientId){const Hb=this.Yh.Iic();if(pa.clientId in Hb)return this.S0j(Hb[pa.clientId])}return 2}Uul(pa,Hb){Hb.Name&&pa.userName&&Hb.Name!==pa.userName&&!this.iuh&&(this.iuh=!0,kg.b(42316243,302,15,"User names in EditorsTable and RTC don't match"))}bJn(pa,Hb){pa=pa||new ua.a;Hb&&(Hb.SupportsRealtimeChannel&&pa.Hdb(1),Hb.SupportsRename&&pa.Hdb(2),Hb.SupportsChat&&pa.Hdb(4));return pa}ODo(pa,Hb){this.Uul(pa,Hb);return Hb.Name||
pa.userName||(pa.isAnonymous||Hb.IsAnonymous?CommonUIStrings.l_GuestUserName:null)}Pve(pa){l.ULS.sendTraceTag(42316245,302,100,"PeopleInfoProvider update detected: {0}",pa.toString());this.sa.raiseEvent("UU")}}Object(f.a)(eh,"PeopleInfoProvider",null,[1893,10]);var zg;(function(pa){pa[pa.pMn=0]="multipleBrowsersImageClassName";pa[pa.W7n=1]="peopleImageClassName";pa[pa.X7n=4]="peopleImageClusterPath";pa[pa.oMn=5]="multipleBrowserImageClusterPath";pa[pa.uRb=6]="imageDimension";pa[pa.rtl=8]="rtl";pa[pa.Agd=
9]="pointerInputManager";pa[pa.YZ=10]="clickInputManager";pa[pa.vertical=11]="vertical";pa[pa.zIndex=12]="zIndex";pa[pa.bWc=13]="contextMenuInputManager";pa[pa.R0p=14]="imageDomElement";pa[pa.imq=15]="useIdleTooltip";pa[pa.NBp=16]="viewportBoundsCallback";pa[pa.pYp=17]="flipHorizontalDirection";pa[pa.kYp=18]="fixRemoveFadeOutElementCrash";pa[pa.R_m=19]="ignoreEventOnExpandedTooltip";pa[pa.han=20]="ipWidthAdjustForFlyout"})(zg||(zg={}));Object(f.b)("PresenceTooltipSettingKeys",zg);class Gi{constructor(){this.Wv=
{}}get(pa,Hb=null){pa=zg[pa];return"number"===typeof Hb?(Hb=this.Wv[pa])?Number.parseInvariant(Hb.toString()):0:this.Wv[pa]}add(pa,Hb){this.Wv[zg[pa]]=Hb}iTa(pa,Hb){zg[pa]in this.Wv||(this.Wv[zg[pa]]=Hb)}remove(pa){delete this.Wv[zg[pa]]}}Object(f.a)(Gi,"PresenceTooltipSettings",null,[]);class jj extends ea.a{constructor(pa){super();this._element=null;this.element=pa}get element(){return this._element}set element(pa){this._element=pa}get visible(){return"visible"===this.element.style.visibility}set visible(pa){this.element.style.visibility=
pa?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(pa){this.element.dir=pa?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(pa){this.element.style.zIndex=String(pa)}dispose(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(pa){return this.element.ownerDocument.createElement(pa)}Cna(){return!0}static j$h(pa){return"prControl"+(pa?"Rtl":"")}}Object(f.a)(jj,"BasePresenceControl",
ea.a,[10,1872]);class Dg extends Sys.EventArgs{constructor(pa,Hb){super();this.type=pa;this.Gp=Hb}}Dg.oX="InteractivityChanged";Object(f.a)(Dg,"InteractivityChangedEventArgs",Sys.EventArgs,[]);class Jf{static smm(pa){return Jf.tmm(pa)}static tmm(pa){const Hb=document.createElementNS(Jf.zOg,"svg");Hb.setAttribute("viewBox",String.format(Jf.LKl,Jf.T9j,Jf.S9j));Hb.appendChild(Jf.XJm(pa));return Hb}static XJm(pa){const Hb=Jf.T9j/pa,Ob=2*Hb,Dc=Jf.S9j/2;pa=(pa-12-8)*Hb/2;const nd=document.createElementNS(Jf.zOg,
"g");Sys.UI.DomElement.addCssClass(nd,Jf.KKl);for(let Od=1;3>=Od;Od++)nd.appendChild(Jf.Wim(Od,Ob,pa+(6*Od-2)*Hb,Dc));return nd}static Wim(pa,Hb,Ob,Dc){const nd=document.createElementNS(Jf.zOg,"circle");Sys.UI.DomElement.addCssClass(nd,String.format("{0}-{1}",Jf.kol,pa));nd.setAttribute("cx",String.format("{0}",Ob));nd.setAttribute("cy",String.format("{0}",Dc));nd.setAttribute("r",String.format("{0}",Hb));return nd}}Jf.zOg="http://www.w3.org/2000/svg";Jf.KKl="prDancingDots";Jf.kol="prAnimateCircle";
Jf.LKl="0 0 {0} {1}";Jf.S9j=40;Jf.T9j=120;Object(f.a)(Jf,"ModernPresenceTooltipDancingDots",null,[]);var xg=d(98),Vi=d(97),Lf=d(10),ac=d(71),xc=d(171),gd=d(79);class Hd extends jj{constructor(pa,Hb){super(pa);this.zIh=this.Uhb=this.TLe=this._img=this.cG=this.mx=this.Dg=null;this.xSa=Hb.get(8,!1);this.Ahb=Hb.get(6,0);this.HPk=Hb.get(15,!1);this.Ne=Hb;this.Wfh=0;this.element=pa;this.element.className=Hd.nDf;this._span=document.createElement("span");this.element.appendChild(this._span);this.bsk=Jf.smm(Hb.get(6,
0));this.zE(Hb);this._state=5}NJb(pa){this.addHandler(Dg.oX,pa)}WYb(pa){this.removeHandler(Dg.oX,pa)}get user(){return this.zIh}get state(){return this._state}dispose(){this.element&&(this.Dg.xc(Lf.a.click,this.element,Object(Za.a)(this,this.onClick,"onClick")),this.Dg.xc(Lf.a.PC,this.element,Object(Za.a)(this,this.Cna,"stopPropagationAndPreventDefaultBehavior")),this.mx.xc(Lf.a.gt,this.element,Object(Za.a)(this,this.rE,"onPointerDown")),this.mx.xc(Lf.a.jH,this.element,Object(Za.a)(this,this.OL,"onPointerOut")),
this.mx.xc(Lf.a.UL,this.element,Object(Za.a)(this,this.$R,"onPointerOver")),this.cG.xc(this.element,Object(Za.a)(this,this.Cna,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}zE(pa){this.Dg=pa.get(10);this.Dg.nb(Lf.a.click,this.element,Object(Za.a)(this,this.onClick,"onClick"));this.Dg.nb(Lf.a.PC,this.element,Object(Za.a)(this,this.Cna,"stopPropagationAndPreventDefaultBehavior"));this.mx=pa.get(9);this.mx.nb(Lf.a.UL,this.element,Object(Za.a)(this,this.$R,"onPointerOver"));this.mx.nb(Lf.a.jH,
this.element,Object(Za.a)(this,this.OL,"onPointerOut"));this.mx.nb(Lf.a.gt,this.element,Object(Za.a)(this,this.rE,"onPointerDown"));this.cG=pa.get(13);this.cG.nb(this.element,Object(Za.a)(this,this.Cna,"stopPropagationAndPreventDefaultBehavior"))}hide(pa=null,Hb=0,Ob=0){this.HPk&&pa?this.o4o(pa,Hb,Ob):(3===this.state&&this.zAj(),this.visible=!1,this._state=5)}o4o(pa,Hb,Ob=0){this.show(pa,Hb,15,4,void 0,Ob)}gSj(pa,Hb,Ob=!1,Dc=!1,nd=!1,Od=0){this.show(pa,Hb,20,Ob?2:Dc?1:0,nd,Od)}L3o(pa,Hb,Ob,Dc=!1,
nd=0){this.show(pa,Hb,Ob+20,3,Dc,nd)}show(pa,Hb,Ob,Dc=3,nd=!1,Od=0){!pa||Dc===this.state&&this.dXm(Hb,Ob)||(this.fTk(Dc,nd,Od),this.uja(pa,Dc,Od),this._state=Dc,4===Od||0===Od&&!this.xSa?this.element.style.left=Hb+"px":this.element.style.right=Hb+"px",this.element.style.top=Ob+"px",this.visible=!0)}uja(pa,Hb,Ob){this.zIh=pa;gd.a.lF(this._span);xc.a.Zpl(this._span);this._span.id="fly_"+pa.clientId;this._span.style.backgroundColor=pa.color;4!==Hb?(this._span.style.height=this.Ahb+"px",this._span.style.lineHeight=
this.Ahb+"px",xc.a.G_b(this._span,"border-radius",this.Ahb+"px")):4===Ob||0===Ob&&!this.xSa?this._span.style.left="0px":this._span.style.right="0px";2!==Hb&&(4===Hb?gd.a.Jx(this._span,""):1===Hb?this._span.appendChild(this.bsk):(this._span.setAttribute("dir","auto"),Ob=Ab.a.Ttm(pa.userName),(!pa.isAnonymous||m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1))&&Ob||0!==Hb?(pa=pa.userName,0===Hb&&(pa=Ob,xc.a.G_b(this._span,"text-align","center")),
gd.a.Jx(this._span,pa)):(this._img||(this._img=this.pBl()),this._span.appendChild(this._img),xc.a.G_b(this._span,"text-align","start"))))}onClick(pa){if(0===this.state)return this.raiseEvent(Dg.oX,new Dg(1,pa)),!0;3===this.state&&l.ULS.sendTraceTag(50436114,302,50,"User clicked on presence pill.");return!1}OL(pa){3===this.state&&this.raiseEvent(Dg.oX,new Dg(3,pa));return!1}$R(pa){3!==pa.zg&&this.raiseEvent(Dg.oX,new Dg(2,pa));return!1}rE(pa){if(3!==pa.zg)return!0;this.raiseEvent(Dg.oX,new Dg(4,pa));
return!1}pBl(){const pa=document.createElement("img");pa.src=xg.a.yea("doughperson_white_glyph.svg");pa.setAttribute("Unselectable","on");ac.a.Gs(pa,ac.a.Ph,ac.a.wA);return Vi.createClusteredImageFromClusterWithImageClass(this.Ahb,this.Ahb,null,null,Hd.H9l,"",!1,"",this.element.ownerDocument,pa)}fTk(pa,Hb=!1,Ob=0){if(!this.Y7c(this.state)||!this.Y7c(pa))switch(Sys.UI.DomElement.removeCssClass(this.element,this.TLe),this.state){case 4:3===pa?this.v5a(Hd.oDf,Hd.loi):this.Y7c(pa)&&this.v5a(Hd.mDf,Hd.loi);
break;case 3:4===pa?this.v5a(Hd.rDf,Hd.koi):this.Y7c(pa)&&(Hb&&this.zAj(),this.v5a(Hd.mDf,Hd.koi,Hb?Hd.G9l:""));break;case 0:case 1:case 2:4===pa?this.v5a(Hd.rDf,Hd.pDf):3===pa&&(Hb&&this.qUk(),this.v5a(Hd.oDf,Hd.pDf,Hb?Hd.moi:"",3===Ob?Hd.K9l:Hd.I9l));break;default:4===pa?this.v5a(Hd.rDf):3===pa?this.v5a(Hd.oDf):this.Y7c(pa)&&this.v5a(Hd.mDf)}}v5a(...pa){this.TLe=pa.join(" ");Sys.UI.DomElement.addCssClass(this.element,this.TLe)}qUk(){this.Wfh=window.setTimeout(()=>{this.element&&(this.Uhb=this.element.cloneNode(!0),
this.element.parentNode.appendChild(this.Uhb),this.element.style.zIndex="2",this.Uhb.style.zIndex="1")},300)}zAj(){window.clearTimeout(this.Wfh);this.Uhb&&(Sys.UI.DomElement.removeCssClass(this.Uhb,Hd.pDf+" "+Hd.moi),Sys.UI.DomElement.addCssClass(this.Uhb,Hd.F9l),E.Task.delay(300).continueWith(()=>{this.element&&this.element.parentNode===this.Uhb.parentNode&&this.element.parentNode.removeChild(this.Uhb)}),xc.a.Huc(this.element,"z-index"))}Y7c(pa){return 0===pa||1===pa||2===pa}dXm(pa,Hb){const Ob=
xc.a.v0(this.element.style.top);return xc.a.v0(this.element.style.left)===pa&&Ob===Hb}otg(pa){3===pa&&xc.a.qea(this.element,"left")?(pa=xc.a.v0(this.element.style.left),xc.a.Huc(this.element,"left"),this.element.style.right=-1*pa+"px"):4===pa&&xc.a.qea(this.element,"right")&&(pa=xc.a.v0(this.element.style.right),xc.a.Huc(this.element,"right"),this.element.style.left=-1*pa+"px")}}Hd.nDf="prModernFlyout UIFont";Hd.rDf="flyoutIdle";Hd.oDf="flyoutExpanded";Hd.mDf="flyoutCollapsed";Hd.loi="flyoutFromIdle";
Hd.koi="flyoutFromExpanded";Hd.pDf="flyoutFromCollapsed";Hd.moi="flyoutStacked";Hd.G9l="flyoutFromStacked";Hd.F9l="flyoutFadeOut";Hd.H9l="cui-img-cont-float cui-img-20by20";Hd.I9l="flyoutLtrDir";Hd.K9l="flyoutRtlDir";Object(f.a)(Hd,"ModernPresenceTooltipFlyoutControl",jj,[]);class ie{constructor(pa,Hb,Ob=2,Dc=4){this.offsetTop=pa;this.offsetLeft=Hb;this.P9j=Ob;this.CNi=Dc}}Object(f.a)(ie,"FlyoutsPositioningInfo",null,[]);var Je=d(41);class Xe{constructor(pa=!1,Hb=!1){this.Xm=pa;this.ERe=Hb}kvm(pa,
Hb,Ob,Dc,nd){const Od=nd.y,ye=nd.height;var Oe=this.mhm(Dc);const Cf=Oe+Hb,Bg=pa*Ob+2*(pa-1);Ob=null;1===pa||this.Ril(Oe,Bg,Od,ye)?pa=new ie(0,0,2):(pa=this.XCf(Cf,Bg,Od,ye),pa.offsetTop-=Oe);this.ERe?Ob=new ie(0,0,void 0,this.Xm?4:3):(Dc=this.lhm(Dc,nd),Oe=Math.max(0,nd.x),nd=nd.width,Hb=Dc+Hb,this.Sil(Dc,Oe,nd)?Ob=new ie(0,0,void 0,this.Xm?3:4):this.Til(Hb,Oe)&&(Ob=new ie(0,0,void 0,this.Xm?4:3)),Ob||(Ob=this.s8l(Dc,Hb,Oe,nd)));return new ie(pa.offsetTop,Ob.offsetLeft,pa.P9j,Ob.CNi)}mhm(pa){return Je.a.bKa(pa)}lhm(pa,
Hb){return this.Xm?Hb.width-Je.a.Hsi(pa):Je.a.lGf(pa)}Ril(pa,Hb,Ob,Dc){return pa+Hb<=Ob+Dc}XCf(pa,Hb,Ob,Dc){let nd=1,Od=Math.max(Ob,pa-Hb);Hb>pa-Ob&&(nd=2,Od=Hb<Dc?Dc-Hb:Ob);return new ie(Od,0,nd)}Sil(pa,Hb,Ob){return pa+150<=Hb+Ob}Til(pa,Hb){return 150<=pa-Hb}s8l(pa,Hb,Ob,Dc){Dc-Hb>=pa-Ob?pa=4:(Hb=pa,pa=3);return new ie(0,Hb,void 0,pa)}}Object(f.a)(Xe,"ModernPresenceTooltipPositioner",null,[]);class Tf{constructor(pa,Hb,Ob,Dc,nd,Od,ye){this.kda=pa;this._parent=Hb;this.tah=Ob;this.Pok=Dc;this.Swk=
nd;this.xac=Od;this.xSa=ye;this._element=document.createElement("div");this.element.className="prTouchTarget"}get element(){return this._element}update(pa,Hb){if(3!==pa)if(5!==pa&&this.kda&&this.kda.length){if(4===pa){var Ob=this.Swk;var Dc=(this.xac-Ob)/2;this.element.style.height=this.xac+"px";this.element.style.width=this.xac+"px";pa=xc.a.v0(this.kda[0].element.style.top);Hb=xc.a.v0(this.xSa?this.kda[0].element.style.right:this.kda[0].element.style.left)}else Ob=this.tah,Dc=(this.xac-Ob)/2,this.element.style.height=
this.xac+"px",this.element.style.width=this.pjm()+2*Dc+"px",pa=xc.a.v0(this.kda[this.kda.length-1].element.style.top),Hb=this.Vhl(this.kda[this.kda.length-1].element,Ob,Hb);xc.a.G_b(this.element,"border-radius",this.xac+"px");this.element.style.top=pa-Dc-Ob+"px";this.xSa?this.element.style.right=Hb-Dc+"px":this.element.style.left=Hb-Dc+"px";this.element.parentNode||this._parent.insertBefore(this.element,this._parent.firstChild)}else this.element.parentNode&&this.element.parentNode.removeChild(this.element)}Vhl(pa,
Hb,Ob){return this.xSa&&!Ob?xc.a.v0(pa.style.right):this.xSa||Ob?this.xSa&&Ob?-xc.a.v0(pa.style.left)-Hb:-xc.a.v0(pa.style.right)-Hb:xc.a.v0(pa.style.left)}pjm(){return this.kda&&this.kda.length?this.tah+Math.min(this.kda.length-1,2)*this.Pok:0}}Object(f.a)(Tf,"ModernPresenceTooltipTarget",null,[]);var Zh=d(151),se=d(187);class Gg extends jj{constructor(pa,Hb,Ob){super(pa);this.X9b=this.iRa=this.clh=this.vDb=!1;this.ar=[];this.zYa=(Dc,nd)=>{Dc=this.w1b;this.Pal()||2!==nd.type&&(4!==nd.type||3===Dc)?
4===nd.type&&3===Dc?(this.iRa&&(this.iRa=!1),this.Nof()):3!==nd.type||3!==Dc||this.vDb||(1<this.n8a?(this.iRa=!0,E.Task.delay(250).continueWith(()=>{this.Aec(!0);this.iRa=!1})):this.Nof()):(this.iRa&&(this.iRa=!1),3!==Dc&&(this.Kki(),3===nd.Gp.zg&&this.Nof(2E3)));this.raiseEvent(Dg.oX,nd)};this.Mrc=Dc=>{3===Dc.zg?this.zYa(this,new Dg(4,Dc)):Dc.eventName===Lf.a.UL?this.zYa(this,new Dg(2,Dc)):Dc.eventName===Lf.a.jH&&this.zYa(this,new Dg(3,Dc));return!1};this.pCd={};this.Ne=Ob;this.Xm=Ob.get(8,!1);this.Pjh=
Ob.get(15,!1);this.Vqk=Ob.get(12,0);this.Cmb=Ob.get(6,0);this.Xpa=Hb;this.VIh=Ob.get(16);this.ERe=Ob.get(17,!1);this.Vwk=Ob.get(19,!1);this.$Gk=Ob.get(20,!1);this.dFd=0;this.UGk=new Xe(this.Xm,this.ERe);this.mCc=this.ovi();this.BGb=!1;this.A3b=[];this.bIc=[];this.element.id=Gg.Ppb();this.element.className=jj.j$h(this.Xm);this.q7a&&(this.zIndex=this.q7a);this.rtl=this.Xm;this.ayg(Hb);this.K9=this.createElement("div");this.K9.className="prFlyoutContainer";this.element.appendChild(this.K9);this.kda=
[];this.tib=new Tf(this.U6,this.element,this.Cmb,4,6,32,this.Xm);this.mx=Ob.get(9);this.mx.nb(Lf.a.gt,this.tib.element,this.Mrc);this.mx.nb(Lf.a.UL,this.tib.element,this.Mrc);this.mx.nb(Lf.a.jH,this.tib.element,this.Mrc)}get Ppe(){return se.a.clone(this.ar)}get U6(){return this.kda}get q7a(){return this.Vqk}get n8a(){return this.U6?this.U6.length:0}get w1b(){return 0<this.n8a?this.U6[0].state:5}get JXf(){return 3===this.w1b&&!this.vDb}NJb(pa){this.addHandler(Dg.oX,pa)}WYb(pa){this.removeHandler(Dg.oX,
pa)}dispose(){if(this.JXf)this.BGb=!0;else{if(this.U6)for(const pa of this.U6)pa.WYb(this.zYa),Le.a.vD(pa);this.kda=null;this.mx.xc(Lf.a.gt,this.tib.element,this.Mrc);this.mx.xc(Lf.a.UL,this.tib.element,this.Mrc);this.mx.xc(Lf.a.jH,this.tib.element,this.Mrc);super.dispose()}}mxc(){this.Aec();this.visible=!0}Lod(){this.visible=!0;this.Kki();this.vDb=!0}XBg(){this.Lod()}hide(){this.eBj();this.V9a();this.tib.update(this.w1b,this.X9b)}uja(pa){const Hb=this.w1b,Ob=this.vDb;pa.clientId||(pa.clientId=(Gg.vIc++).toString());
if(pa.clientId in this.pCd){var Dc=this.lOb(pa.clientId);if(0<=Dc){Dc=this.ar[Dc];if(Dc.color===pa.color&&Dc.userName===pa.userName)return;this.Ycb(pa.clientId)}}this.hide();Dc=new Hd(this.createElement("div"),this.Ne);Dc.NJb(this.zYa);this.K9.insertBefore(Dc.element,this.K9.firstChild);this.pCd[pa.clientId]=Dc;Array.add(this.ar,pa);Array.add(this.U6,Dc);this.V7j(Hb,Ob);this.visible=!0}Ycb(pa){if(this.JXf)Array.add(this.bIc,pa);else{var Hb=this.w1b,Ob=this.vDb;this.hide();this.Vjd(pa);this.V7j(Hb,
Ob)}}Mdj(pa){const Hb=this.lOb(pa);if(!(0>=Hb)){var Ob=this.ar[Hb];pa=this.pCd[pa];Array.removeAt(this.ar,Hb);Array.insert(this.ar,0,Ob);Array.removeAt(this.U6,Hb);Array.insert(this.U6,0,pa);this.K9.removeChild(pa.element);this.K9.appendChild(pa.element);this.Aec()}}V7j(pa,Hb){0>=this.ar.length?this.hide():3===pa&&Hb?this.Lod():this.mxc()}GAf(pa){if(this.JXf&&this.Vwk)return!1;pa=Gg.dMf(pa);if(this.K9!==pa&&gd.a.VWa(this.K9,pa))return!0;for(const Hb of this.U6)if(gd.a.VWa(Hb.element,pa))return!0;
return!1}position(pa,Hb){this.element.style.top=Hb+"px";this.element.style.left=pa+"px"}Aec(pa=!1){if(!pa||this.iRa){this.clh&&this.ZNj(!0);var Hb=Math.min(3,this.n8a)-1;pa=0;var Ob=1,Dc=0;this.X9b&&(pa=this.mCc,Ob=-1,Dc=-this.Cmb);for(let nd=this.n8a-1;nd>Hb;nd--)this.U6[nd].gSj(this.ar[nd],-4*Hb*Ob+Dc,!0,!1,!0,pa);for(;0<=Hb;Hb--)this.U6[Hb].gSj(this.ar[Hb],-4*Hb*Ob+Dc,0<Hb,Array.contains(this.A3b,this.ar[Hb].clientId),Hb!==this.dFd,pa);this.dFd=0;this.tib.update(0,this.X9b);this.zIndex=this.q7a;
this.vDb=!1;this.eBj(0);this.BGb&&this.dispose()}}Kki(){this.clh&&this.ZNj(!1);this.zIndex=this.q7a+1;const {offsetX:pa,offsetY:Hb,BNi:Ob}=this.kSo();for(let Dc=0;Dc<this.n8a;Dc++)this.U6[Dc].L3o(this.ar[Dc],pa,Hb+(this.Cmb+2)*Dc,Dc!==this.dFd,Ob)}V9a(){let pa=0,Hb=0;this.X9b&&(pa=this.mCc,Hb=-6);for(let Ob=0;Ob<this.n8a;Ob++)this.U6[Ob].hide(this.ar[Ob],Hb,pa);this.zIndex=this.q7a;this.visible=this.vDb=!1;this.BGb&&this.dispose()}Nof(pa=0){pa?(this.iRa=!0,E.Task.delay(pa).continueWith(()=>{this.Pjh?
this.TYm():this.Aec(!0);this.iRa=!1})):this.Pjh?this.hide():this.Aec()}TYm(){this.iRa&&this.hide()}Pal(){if(m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Ib.bCa&&Zh.c()){const pa=appChrome.selectors.getShyState();return pa.isActive&&0!==pa.state}return!1}ayg(pa){this.element.style.width=pa+"px";this.element.style.height=this.Cmb+"px"}Vjd(pa){this.iuo(pa);pa=this.lOb(pa);if(!(0>pa)){var Hb=this.ar[pa];Array.removeAt(this.ar,pa);delete this.pCd[Hb.clientId];Hb=this.U6[pa];this.K9.removeChild(Hb.element);
this.Ne.get(18,!1)&&Hb.WYb(this.zYa);Array.removeAt(this.U6,pa);Hb.dispose()}}eBj(pa=5){if(this.bIc.length){this.visible&&this.V9a();for(let Hb=0;Hb<this.bIc.length;Hb++)this.Vjd(this.bIc[Hb]);Array.clear(this.bIc);0>=this.ar.length||5===pa?this.hide():0===pa&&this.mxc()}}lOb(pa){for(let Hb=0;Hb<this.ar.length;Hb++)if(this.ar[Hb].clientId===pa)return Hb;return-1}iuo(pa){-1===this.lOb(pa)?l.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.A3b,
pa)&&(Array.remove(this.A3b,pa),this.ar[0].clientId===pa&&0<this.A3b.length&&this.Mdj(this.A3b[this.A3b.length-1]),this.ar[0].clientId===pa&&1===this.w1b&&this.Aec())}ZNj(pa){pa?Sys.UI.DomElement.addCssClass(this.K9,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.K9,"prBackgroundSelection")}kSo(){let pa,Hb;Hb=pa=0;var Ob=this.mCc;if(this.VIh){const Dc=this.VIh(this);if(!Dc)return{offsetX:pa,offsetY:Hb,BNi:Ob};const nd=4===this.w1b;Ob=this.UGk.kvm(this.n8a,nd?6:this.Cmb,this.Cmb,this.element,
Dc);Hb=Ob.offsetTop;this.dFd=this.Htm(Ob.P9j,Ob.offsetTop);Ob=Ob.CNi;Ob!==this.mCc&&(this.otg(Ob),this.element.dir=3===Ob?"rtl":"ltr",this.mCc=Ob);Ob!==this.ovi()?(pa=this.$Gk?-2:nd?-6:-this.Cmb,this.X9b=!0):this.X9b=!1}return{offsetX:pa,offsetY:Hb,BNi:Ob}}Htm(pa,Hb){if(1===pa)return this.n8a-1;pa=Math.abs(Hb);return 0<pa?pa/(this.Cmb+2):0}otg(pa){for(let Hb=0;Hb<this.n8a;Hb++)this.U6[Hb].otg(pa)}ovi(){return this.Xm?3:4}static Ppb(){return String.format("{0}-{1}","presencetooltip",Gg.vIc++)}static dMf(pa){return pa.Nb.rawEvent.relatedTarget}}
Gg.vIc=0;Object(f.a)(Gg,"ModernPresenceTooltipControl",jj,[1875,10]);var mf=d(292),Ne=d(294);class Fb{constructor(pa){this.Ne=pa;this.Ne.iTa(10,mf.a.instance);this.Ne.iTa(9,we.a.instance);this.Ne.iTa(6,20);this.Ne.iTa(13,Ne.a.instance);this.Ne.iTa(17,!1)}Rrf(pa,Hb=!1){this.Ne.iTa(15,Hb);return new Gg(pa,20,this.Ne)}}Object(f.a)(Fb,"ModernPresenceTooltipFactory",null,[1874]);class Vb extends jj{constructor(pa,Hb){super(pa);this.ar=null;this.xSa=Hb.get(8,!1);this.Ahb=Hb.get(6,0);this.element=pa;this.element.className=
Vb.nDf;this._ul=this.createElement("ul");this.element.appendChild(this._ul);this.Dg=Hb.get(10);this.Dg.nb(Lf.a.click,this.element,Object(Za.a)(this,this.onClick,"onClick"));this.mx=Hb.get(9);this.mx.nb(Lf.a.jH,this.element,Object(Za.a)(this,this.OL,"onPointerOut"));this.mx.nb(Lf.a.gt,this.element,Object(Za.a)(this,this.Cna,"stopPropagationAndPreventDefaultBehavior"));this.cG=Hb.get(13);this.cG.nb(this.element,Object(Za.a)(this,this.Cna,"stopPropagationAndPreventDefaultBehavior"))}NJb(pa){this.addHandler(Dg.oX,
pa)}WYb(pa){this.removeHandler(Dg.oX,pa)}get users(){return this.ar}dispose(){this.element&&(this.Dg.xc(Lf.a.click,this.element,Object(Za.a)(this,this.onClick,"onClick")),this.mx.xc(Lf.a.gt,this.element,Object(Za.a)(this,this.Cna,"stopPropagationAndPreventDefaultBehavior")),this.mx.xc(Lf.a.jH,this.element,Object(Za.a)(this,this.OL,"onPointerOut")),this.cG.xc(this.element,Object(Za.a)(this,this.Cna,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}hide(){this.visible=!1}show(pa,Hb,Ob){this.hide();
!pa||0>=pa.length||(this.xSa?this.element.style.right=Hb+"px":this.element.style.left=Hb+"px",this.element.style.top=Ob+"px",this.kYk(pa),this.visible=!0)}kYk(pa){this.ar=pa;gd.a.lF(this._ul);for(let Hb=pa.length-1;0<=Hb;Hb--)this.uja(pa[Hb])}uja(pa){const Hb=document.createElement("li");Hb.style.backgroundColor=pa.color;Hb.style.height=this.Ahb+"px";Hb.id="fly_"+pa.clientId;Hb.style.lineHeight=this.Ahb+"px";gd.a.Jx(Hb,pa.userName);Hb.setAttribute("dir","auto");this._ul.appendChild(Hb)}onClick(){this.hide();
return!1}OL(pa){this.raiseEvent(Dg.oX,new Dg(3,pa));return!1}}Vb.nDf="prFlyout UIFont";Object(f.a)(Vb,"PresenceTooltipFlyoutControl",jj,[]);class Qc extends jj{constructor(pa,Hb,Ob){super(pa);this._img=null;this.ar=[];this.element.className="prGlyph";this.Ne=Hb;this.D9b=this.Ne.get(9);this.rr=this.Ne.get(10);this.cG=this.Ne.get(13);this.rZm();this.uja(Ob);this.eWe=!1}get Hbb(){return this.ar.length}get users(){return this.ar}NJb(pa){this.addHandler(Dg.oX,pa)}WYb(pa){this.removeHandler(Dg.oX,pa)}dispose(){this.Rop();
super.dispose()}uja(pa){Array.add(this.ar,pa);2===this.Hbb?this.Zna(!0):1===this.Hbb?this.Zna(!1):this.Zna(this.eWe)}Ycb(pa){this.K5l(pa)&&(1<this.Hbb&&this.Zna(!0),1===this.Hbb?this.Zna(!1):1>this.Hbb&&this.hide())}show(){this.Zna(2<=this.Hbb);this.visible=!0}hide(){this.visible=!1}ttm(pa){return pa?this.Lti(0,5):this.Lti(1,4)}K5l(pa){for(let Hb=0;Hb<this.Hbb;Hb++)if(this.ar[Hb].clientId===pa)return pa=this.ar[Hb],Array.removeAt(this.ar,Hb),pa;return null}Zna(pa){this.eWe!==pa&&(this._img&&this.element.removeChild(this._img),
this._img=this.ttm(pa),this.element.appendChild(this._img),this.eWe=pa);this._img.childNodes[0].style.backgroundColor=this.ar[this.ar.length-1].color}Lti(pa,Hb){const Ob=this.Ne.get(6,0),Dc=this.Ne.get(14);return Vi.createClusteredImageFromClusterWithImageClass(Ob,Ob,this.Ne.get(pa),this.Ne.get(Hb),"cui-img-cont-float cui-img-16by16","",!1,"",this.element.ownerDocument,Dc?Dc.cloneNode(!0):null)}$R(pa){3!==pa.zg&&this.raiseEvent(Dg.oX,new Dg(2,pa));return!1}onClick(pa){this.raiseEvent(Dg.oX,new Dg(1,
pa));return!0}OL(pa){3!==pa.zg&&this.raiseEvent(Dg.oX,new Dg(3,pa));return!1}Rop(){this.element&&(this.D9b.xc(Lf.a.gt,this.element,Object(Za.a)(this,this.Cna,"stopPropagationAndPreventDefaultBehavior")),this.D9b.xc(Lf.a.UL,this.element,Object(Za.a)(this,this.$R,"onPointerOver")),this.D9b.xc(Lf.a.jH,this.element,Object(Za.a)(this,this.OL,"onPointerOut")),this.rr.xc(Lf.a.PC,this.element,Object(Za.a)(this,this.Cna,"stopPropagationAndPreventDefaultBehavior")),this.rr.xc(Lf.a.click,this.element,Object(Za.a)(this,
this.onClick,"onClick")),this.cG.xc(this.element,Object(Za.a)(this,this.Cna,"stopPropagationAndPreventDefaultBehavior")))}rZm(){this.element&&(this.D9b.nb(Lf.a.gt,this.element,Object(Za.a)(this,this.Cna,"stopPropagationAndPreventDefaultBehavior")),this.D9b.nb(Lf.a.UL,this.element,Object(Za.a)(this,this.$R,"onPointerOver")),this.D9b.nb(Lf.a.jH,this.element,Object(Za.a)(this,this.OL,"onPointerOut")),this.rr.nb(Lf.a.PC,this.element,Object(Za.a)(this,this.Cna,"stopPropagationAndPreventDefaultBehavior")),
this.rr.nb(Lf.a.click,this.element,Object(Za.a)(this,this.onClick,"onClick")),this.cG.nb(this.element,Object(Za.a)(this,this.Cna,"stopPropagationAndPreventDefaultBehavior")))}}Object(f.a)(Qc,"PresenceTooltipGlyph",jj,[]);class yd extends jj{constructor(pa,Hb,Ob){super(pa);this.ar=[];this.MM=[];this.NRa=0;this.dPc=this.N6b=!1;this.$6g=null;this.zYa=(Dc,nd)=>{var Od=Object(z.a)(Qc,Dc);Od=Od?this.Kmi(Od):-1;if(2===nd.type||1===nd.type&&-1!==Od&&!this.Zea[Od].visible)this.Hpe(Dc);else if(1===nd.type)this.V9a(),
this.N6b=!1;else if(3===nd.type){if(this.GAf(nd.Gp))return;this.N6b||this.V9a()}this.raiseEvent(Dg.oX,nd)};this.qCd={};this.Ne=Ob;this.Xm=Ob.get(8,!1);this.spa=Ob.get(11,!1);pa=Ob.get(12,0);this.uRb=Ob.get(6,0);this.Xpa=Hb;this.element.id=yd.Ppb();this.element.className=jj.j$h(this.Xm);pa&&(this.zIndex=pa);this.rtl=this.Xm;this.ayg(Hb);this.ZFa=this.createElement("div");this.ZFa.className=this.spa?"prContainerV":"prContainerHr";this.element.appendChild(this.ZFa);this.fhh=Array(this.NRa);for(Hb=0;Hb<
this.NRa;Hb++)this.Zea[Hb]=new Vb(this.createElement("div"),this.Ne),this.Zea[Hb].NJb(this.zYa),this.element.appendChild(this.Zea[Hb].element)}get Ppe(){return se.a.clone(this.ar)}get Zea(){return this.fhh}get SKh(){return this.$6g}get yze(){return this.uRb+2}get width(){return this.spa?this.yze:this.Xpa}get height(){return this.spa?this.Xpa:this.yze}NJb(pa){this.addHandler(Dg.oX,pa)}WYb(pa){this.removeHandler(Dg.oX,pa)}dispose(){if(this.Zea)for(const pa of this.Zea)pa.WYb(this.zYa),Le.a.vD(pa);Le.a.rvg(this.MM);
this.MM=this.fhh=null;super.dispose()}mxc(){this.V9a();this.jCg();this.visible=!0;this.N6b=!1}Lod(){!this.MM||1>this.MM.length||(this.V9a(),this.visible=!0,this.jCg(),this.Hpe(this.MM[this.MM.length-1]),this.N6b=!0)}XBg(){if(this.MM&&!(1>this.MM.length)){this.visible=!0;this.jCg();var pa=0;for(const Hb of this.MM)this.Hpe(Hb,pa++);this.N6b=!1;this.dPc=!0}}hide(){this.visible=!1;this.V9a();for(let pa=0;pa<this.MM.length;pa++)this.MM[pa].hide();this.N6b=!1}b0h(){if(!this.dPc)return!1;let pa=0;for(const Hb of this.Zea)Hb.visible&&
pa++;return this.dPc=0<pa&&(this.ar.length<=this.NRa?pa===this.ar.length:pa===this.NRa)}uja(pa){if(!(0>=this.NRa)){pa.clientId||(pa.clientId=(yd.vIc++).toString());if(pa.clientId in this.qCd){var Hb=this.lOb(pa.clientId);if(0<=Hb){Hb=this.ar[Hb];if(Hb.color===pa.color&&Hb.userName===pa.userName)return;this.Ycb(pa.clientId)}}Hb=this.b0h();var Ob=0;if(this.ar.length<this.NRa){var Dc=new Qc(this.createElement("div"),this.Ne,pa);Dc.NJb(this.zYa);this.Xm&&!this.spa&&0<this.ar.length?this.ZFa.insertBefore(Dc.element,
this.ZFa.firstChild):(this.ZFa.appendChild(Dc.element),Ob=this.MM.length);Array.add(this.MM,Dc)}else this.Xm&&!this.spa?Dc=this.MM[0]:(Ob=this.MM.length-1,Dc=this.MM[Ob]),Dc.uja(pa);Dc.show();this.qCd[pa.clientId]=Dc;Array.add(this.ar,pa);this.x5j(Dc,Ob);Hb&&this.XBg()}}Ycb(pa){const Hb=this.b0h();Hb&&this.V9a();this.Vjd(pa);this.ar.length>=this.NRa&&this.MM.length<this.NRa&&this.Blo();0>=this.ar.length?this.hide():Hb&&this.XBg()}Mdj(){}Vjd(pa){var Hb=this.lOb(pa);0>Hb||(pa=this.ar[Hb],Array.removeAt(this.ar,
Hb),Hb=this.qCd[pa.clientId],delete this.qCd[pa.clientId],Hb.Ycb(pa.clientId),this.x5j(Hb),0>=Hb.Hbb&&(this.ZFa.removeChild(Hb.element),Array.remove(this.MM,Hb),Hb.dispose()))}Blo(){var pa=this.RAm();!pa||1>=pa.users.length||(pa=Array.clone(this.ar),pa.forEach(Hb=>{this.Vjd(Hb.clientId)}),pa.forEach(Hb=>{this.uja(Hb)}))}lOb(pa){for(let Hb=0;Hb<this.ar.length;Hb++)if(this.ar[Hb].clientId===pa)return Hb;return-1}RAm(){return this.Xm&&!this.spa?this.MM[0]:this.MM[this.MM.length-1]}position(pa,Hb){this.element.style.top=
Hb+"px";this.element.style.left=pa+"px"}jCg(){for(let pa=0;pa<this.MM.length;pa++)this.MM[pa].show()}V9a(){for(let pa=0;pa<this.NRa;pa++)this.Zea[pa].hide();this.dPc=!1}Hpe(pa,Hb=0){if(pa)if(this.$6g=pa,this.spa){const Ob=this.uRb;if(1<pa.users.length)this.Zea[Hb].show(pa.users,Ob,this.height-this.uRb);else{const Dc=this.ZFa.children.length;for(let nd=0;nd<this.ZFa.children.length;nd++)pa.element===this.ZFa.children[nd]&&this.Zea[Hb].show(pa.users,Ob,this.height-(Dc-nd)*this.yze+2)}}else this.Zea[Hb].show(pa.users,
this.width,0)}GAf(pa){pa=yd.dMf(pa);let Hb=!1;for(const Ob of this.Zea)if(gd.a.VWa(Ob.element,pa)){Hb=!0;break}return this.ZFa!==pa&&gd.a.VWa(this.ZFa,pa)||Hb}x5j(pa,Hb=0){const Ob=this.san(pa);Ob&&0>=pa.Hbb?this.Zea[Hb].hide():Ob?this.Hpe(pa):this.Zea[Hb].hide()}Kmi(pa){let Hb=0;for(const Ob of this.MM){if(pa===Ob)return Hb;Hb++}return-1}san(pa){const Hb=this.Kmi(pa);return!!this.SKh&&pa===this.SKh&&-1!==Hb&&this.Zea[Hb].visible}ayg(pa){this.NRa=pa===this.uRb?1:Math.floor(pa/this.yze);this.spa?(this.element.style.height=
pa+"px",this.element.style.width=this.uRb+"px"):(this.element.style.width=pa+"px",this.element.style.height=this.uRb+"px")}static Ppb(){return String.format("{0}-{1}","presencetooltip",yd.vIc++)}static dMf(pa){pa=pa.Nb.rawEvent;return pa.relatedTarget||pa.toElement}}yd.vIc=0;Object(f.a)(yd,"PresenceTooltipControl",jj,[1875,10]);class Ce{constructor(pa){this.Ne=pa;this.Ne.iTa(10,mf.a.instance);this.Ne.iTa(9,we.a.instance);this.Ne.iTa(6,16);this.Ne.iTa(13,Ne.a.instance)}Rrf(pa){return new yd(pa,16,
this.Ne)}}Object(f.a)(Ce,"PresenceTooltipFactory",null,[1874]);var sf=d(242),lh=d(126),Ef=d(55),ng=d(5),Dh=d(111),Af=d(6),Jh=d(12),vg=d(77),Hk=d(523),tg=d(310),wh=d(252);class Hg extends Sys.EventArgs{constructor(pa,Hb){super();this.paragraphId=pa;this.yvn=Hb}}Object(f.a)(Hg,"PresenceControlRenderedEventArgs",Sys.EventArgs,[]);class Sf extends jj{constructor(pa,Hb,Ob,Dc,nd,Od=null,ye=null){super(null);this.jCd=this.Vn=null;this.Ead=!1;this.Qva=0;this.kq=pa;this.fQc=Hb;this.mx=Ob;this.Vj=Dc;this.VPa=
nd;Sf.NDb=0;this.nQh=new nc.a;this.cFj=new nc.a;this.vZ=Od;this.Ga=ye;this.Ttk=this.Ga.ic("PresenceIpRenderedFloodgateTimeLapseSec",30);this.SOk=this.Ga.ic("PresenceIpRenderedFloodgateTriggerThreshold",3);this.fhb=0}get ubb(){return m.AFrameworkApplication.J.$("PeoplesWellExtraButtonInfoIsEnabled")}VYk(pa){this.addHandler("CR",pa)}NBj(pa){this.removeHandler("CR",pa)}cse(){this.raiseEvent("CR",new Hg(this.kq.ip.paragraphId,this.Ead))}M8f(){if(Object(wh.a)(Gg,this.Vn)){const pa=Object(z.a)(Gg,this.Vn);
Sf.NDb=0<Sf.NDb?Sf.NDb+1:pa.q7a+1;pa.zIndex=Sf.NDb;this.element.style.zIndex=String(Sf.NDb)}}TCo(){if(Object(wh.a)(Gg,this.Vn)){const pa=Object(z.a)(Gg,this.Vn);Sf.NDb=pa.q7a;pa.zIndex=pa.q7a;this.element.style.zIndex=String(pa.q7a)}}z9i(){this.vZ&&!this.Skp()&&this.vZ.continueWith(()=>{this.vZ.result.logActivity("PresenceIpRendered","PresenceIpRenderedFloodgateEnabled",this.Ttk)&&this.fhb++})}Skp(){return this.fhb>=this.SOk}static S8i(){Sf.Qgh||(Sf.Qgh=!0,l.ULS.sendTraceTag(4006594,302,50,"First presence ip rendered on the page"))}static Ppb(pa){return Sf.I_m+
pa.Kxi()}}Sf.gtj="data-presence-control";Sf.Koj="OverlayControlElementOwner";Sf.I_m="ipId_";Sf.htj="WacPresence";Sf.p4n="PresenceIpPaddingDiv";Sf.Qgh=!1;Sf.NDb=0;Object(f.a)(Sf,"APresenceControl",jj,[1607,10]);class ph{constructor(){this.rotation=this.height=this.width=this.top=this.left=0;this.Zdb=!1}}Object(f.a)(ph,"PresenceImageControlStyle",null,[1608]);var Mh=d(182);class Qf extends Sf{constructor(pa,Hb,Ob,Dc,nd,Od=null,ye=null){super(pa,Hb,Ob,Dc,nd,Od,ye);this.OL=()=>{this.Qcj();return!1};this.rne=
Oe=>{this.Vn&&3===Oe.zg&&(2!==this.Qva?(this.M8f(),this.t0b()):this.Qcj());return!1}}Ycb(pa){this.Vn&&this.Vn.Ycb(pa)}NEe(){return this.Vn?this.Vn.Ppe.length:0}updatePosition(pa){if(this.element&&this.element.parentNode){var Hb=this.lyi(pa);if(Hb){var Ob=Sys.UI.DomElement.getBounds(this.element.parentNode),Dc,nd;({left:Ob,top:Dc,height:nd,width:Hb}=this.BDm(Hb,Ob,this.element.parentNode,this.Vj.instance));this.element.style.top=Dc+"px";this.element.style.left=Ob+"px";this.element.style.height=nd+
"px";this.element.style.width=Hb+"px";Ob=this.ryi(pa);xc.a.y8(this.element,Ob);pa=this.uJf(pa,this.kq.ip.shapeId);this.COj(Ob,Hb,this.isSelected(pa),m.AFrameworkApplication.isRtl);this.t0b()}}}B0(){this.element&&(gd.a.wy(this.element),this.Vn.Ycb(this.kq.user.clientId),this.cse())}v4h(pa,Hb,Ob,Dc){Hb=new ph;if(!Dc||!Ob)return Hb;Ob=this.lyi(pa);if(!Ob)return Hb;Hb.top=Ob.y;Hb.left=Ob.x;Hb.height=Ob.height;Hb.width=Ob.width;Hb.rotation=this.iGm(pa);Hb.Zdb=!0;return Hb}KCj(pa,Hb,Ob,Dc){Sf.S8i();this.jCd=
pa;if(Dc){const nd=this.uJf(pa,this.kq.ip.shapeId);if(!nd)return;const Od=!this.element;Od&&this.Vrf(Hb.ownerDocument,pa);Od||!this.element.parentNode?nd.appendChild(this.element):this.element.parentNode!==nd&&(this.element.parentNode.removeChild(this.element),nd.appendChild(this.element));this.Vn.uja(this.kq.user);this.element.style.borderColor=this.kq.user.color;this.element.id=Sf.Ppb(this.kq);Ob.Zdb&&(this.element.style.height=Ob.height+"px",this.element.style.top=Ob.top+"px",this.element.style.left=
Ob.left+"px",this.element.style.width=Ob.width+"px",xc.a.y8(this.element,Ob.rotation),xc.a.y8(this.Vn.element,-1*Ob.rotation),this.COj(Ob.rotation,Ob.width,this.isSelected(nd),m.AFrameworkApplication.isRtl),this.t0b())}this.Ead=!Dc;this.cse()}iGm(pa){return this.element&&this.element.parentNode&&this.IEi(xc.a.getTransform(this.element.parentNode))?this.IEi(xc.a.getTransform(this.element)):this.ryi(pa)}IEi(pa){return pa&&-1<pa.indexOf("deg")&&(pa=parseInt(pa.substring(pa.indexOf("(")+1,pa.indexOf("deg"))),
!isNaN(pa))?pa:0}X4j(pa){this.element.style.borderColor=this.kq.user.color;this.element.id=Sf.Ppb(this.kq);this.updatePosition(pa)}Vrf(pa,Hb){this.element=pa.createElement("div");this.element.setAttribute(Sf.gtj,!0);lh.a.Dm(this.element,Sf.Koj,this);this.element.className=Qf.Xbo;(pa=Hb.Cb)&&pa.PT&&(this.element.style.pointerEvents="none");this.element.dir=m.AFrameworkApplication.isRtl?"rtl":"ltr";this.Vn=this.fQc.Rrf(this.createElement("div"),!0);this.Vn.uja(this.kq.user);this.Vn.hide();this.mx.nb(Lf.a.jH,
this.Vn.element,this.OL);this.mx.nb(Lf.a.gt,this.Vn.element,this.rne);this.Vn.element.classList.add(Sf.htj);this.element.appendChild(this.Vn.element)}BDm(pa,Hb,Ob,Dc){let nd=pa.y,Od=pa.x,ye=pa.height;pa=pa.width;(1<Math.abs(Hb.width-Ob.offsetWidth)||1<Math.abs(Hb.height-Ob.offsetHeight))&&Dc&&(nd=Math.round(nd/Dc.yj),Od=Math.round(Od/Dc.yj),ye=Math.round(ye/Dc.yj),pa=Math.round(pa/Dc.yj));return{left:Od,top:nd,height:ye,width:pa}}isSelected(pa){return pa.classList.contains(tg.a.Xfc)}COj(pa,Hb,Ob,
Dc){this.Vn.element.style.left="auto";this.Vn.element.style.top="auto";this.Vn.element.style.right="auto";this.Vn.element.style.bottom="auto";Ob=Ob?Math.round(.5*Qf.Ova)+Qf.Bip:0;0<=pa&&90>pa||360===pa?(this.Vn.element.style.top=-.5*Qf.Ova-Ob+"px",Dc?this.Vn.element.style.right=Hb-.5*Qf.Ova+"px":this.Vn.element.style.left=Hb-.5*Qf.Ova+"px"):90<=pa&&180>pa?(this.Vn.element.style.left=-.5*Qf.Ova-Ob+"px",Dc?this.Vn.element.style.bottom=-.5*Qf.Ova+"px":this.Vn.element.style.top=-.5*Qf.Ova+"px"):180<=
pa&&270>pa?(this.Vn.element.style.bottom=-.5*Qf.Ova-Ob+"px",Dc?this.Vn.element.style.left=Hb-.5*Qf.Ova+"px":this.Vn.element.style.right=Hb-.5*Qf.Ova+"px"):(this.Vn.element.style.right=-.5*Qf.Ova-Ob+"px",Dc?this.Vn.element.style.top=-.5*Qf.Ova+"px":this.Vn.element.style.bottom=-.5*Qf.Ova+"px")}Wi(pa,Hb){const Ob=this.V5d(pa,Hb);return Ob?Ob.properties:(pa=this.qyi(pa,Hb))?pa.properties:null}uJf(pa,Hb){var Ob=this.V5d(pa,Hb);return Ob&&(Ob=Ob.TAa(pa.uh,pa))?Ob.element:(Hb=this.qyi(pa,Hb))?Object(z.a)(Hk.a,
Hb).Be(pa.pc).htmlElement:null}V5d(pa,Hb){pa=vg.i(pa.Cb,5);for(const Ob of pa)if(Ob.properties.getValue(ng.a.Aob)===Hb)return Ob;return null}qyi(pa,Hb){pa=Af.a.Za(pa.Cb);let Ob=pa.Ub(6);for(;Ob;){const Dc=Ob.properties.getValue(ng.a.Aob);if(Jh.ImageReader.It(Ob)&&Dc===Hb)return Ob;Ob=pa.Mf(6)}return null}itm(pa){const Hb=Ef.a.xf(Jh.ImageReader.RB(pa),0);pa=Ef.a.xf(Jh.ImageReader.$C(pa),1);return{ioa:Hb,lYm:pa}}ryi(pa){pa=this.Wi(pa,this.kq.ip.shapeId);return Jh.ImageReader.L2(pa)}lyi(pa){var Hb=this.kq.ip;
if(!Hb||!Hb.shapeId)return null;var Ob=this.Wi(pa,Hb.shapeId);const Dc=this.uJf(pa,Hb.shapeId);if(!Ob||!Dc)return null;let nd=pa=1,Od;({ioa:Hb,lYm:Od}=this.itm(Ob));Object(Mh.d)(Ob)?(Ob=Jh.ImageReader.qsa(Ob),pa=Ef.a.xf(Ob[Dh.a.left],0),nd=Ef.a.xf(Ob[Dh.a.top],1)):Ob.hasProperty(ng.a.Ega)?(Ob=Ob.getValue(ng.a.Ega),pa+=Ef.a.xf(Ob[Dh.a.left],0),nd+=Ef.a.xf(Ob[Dh.a.top],1)):(pa+=0<Dc.offsetWidth?(Dc.offsetWidth-Hb)/2:2,nd+=0<Dc.offsetHeight?(Dc.offsetHeight-Od)/2:2);return new Sys.UI.Bounds(Math.round(pa),
Math.round(nd),Math.round(Hb),Math.round(Od))}Qcj(){this.Vn&&(this.Vn.mxc(),this.Qva=1)}t0b(){for(const pa of this.Vn.Ppe)if(pa.clientId===this.kq.user.clientId&&!pa.equals(this.kq.user)){this.Vn.uja(this.kq.user);break}if(this.kq.z_a||2===this.Qva)this.Vn.Lod(),this.kq.z_a=!1,this.kq.Rfa=!0,this.Qva=2;this.kq.Rfa&&1!==this.Qva||(this.Vn.mxc(),this.kq.Rfa=!0,this.Qva=1)}}Qf.Xbo="WACImgPresenceHighlight";Qf.Ova=20;Qf.Bip=6;Object(f.a)(Qf,"PresenceImageControl",Sf,[]);var Qi=d(274);class Cl{constructor(){this.height=
this.top=this.left=this.mTi=0;this.Zdb=!1;this.sw=this.Hh=null}}Object(f.a)(Cl,"PresenceIpControlStyle",null,[1608]);var tl=d(62);class pf extends Sf{constructor(pa,Hb,Ob,Dc,nd,Od=null,ye=null,Oe=null){super(pa,Hb,Ob,Dc,nd,Od,ye);this.mPc=this.H2a=this.Y$b=null;this.$R=Cf=>{!this.Vn||this.ubb&&!this.Vn.GAf(Cf)||(this.M8f(),this.gve(Cf));this.X4j(this.jCd);return!1};this.OL=()=>{this.Vn&&this.qU();return!1};this.rne=Cf=>{this.Vn&&3===Cf.zg&&(2!==this.Qva?(this.M8f(),this.gve(Cf)):this.qU());return!1};
this.bF=Oe}Vrf(pa){this.element=pa.createElement("div");this.element.setAttribute(Sf.gtj,!0);lh.a.Dm(this.element,Sf.Koj,this);this.element.className=Sf.p4n;this.element.dir=m.AFrameworkApplication.isRtl?"rtl":"ltr";this.mx.nb(Lf.a.UL,this.element,this.$R);this.ubb&&(this.mx.nb(Lf.a.jH,this.element,this.OL),this.mx.nb(Lf.a.gt,this.element,this.rne));this.H2a=this.createElement("div");this.H2a.className=pf.Ybo;this.ubb||(this.mPc=this.createElement("div"),this.mPc.className=pf.aco,this.H2a.appendChild(this.mPc));
this.Vn=this.fQc.Rrf(this.createElement("div"),this.ubb);pa=this.Ga.$("NoPresenceUserLookUpBeforeRender");this.bF&&!pa&&(this.kq.user=this.bF.$5f(this.kq.user.clientId)||this.kq.user);this.Vn.uja(this.kq.user);this.Vn.hide();this.Vn.element.classList.add(this.ubb?Sf.htj:pf.O7n);this.H2a.appendChild(this.Vn.element);this.element.appendChild(this.H2a)}VNl(){this.Y$b&&(Ib.a.instance.uf(this.Y$b),this.Y$b=null)}t0b(pa){for(var Hb of this.Vn.Ppe)if(Hb.clientId===this.kq.user.clientId&&!Hb.equals(this.kq.user)){this.Vn.uja(this.kq.user);
break}Hb=!1;pf.ELl===this.kq.user.color?({value:Hb}=this.nQh.Ac(this.kq.user.clientId,!1),Hb||(this.nQh.Z(this.kq.user.clientId,!0),l.ULS.sendTraceTag(17954772,302,50,'{ "ClientID" : "'+this.kq.user.clientId+'" , "Event" : "RenderGrayPawn"}'))):({value:Hb}=this.cFj.Ac(this.kq.user.clientId,!1),Hb||(this.cFj.Z(this.kq.user.clientId,!0),l.ULS.sendTraceTag(17954773,302,50,'{ "ClientID" : "'+this.kq.user.clientId+'" , "Event" : "RenderColoredPawn"}')));return pa||this.kq.z_a||2===this.Qva?(this.z9i(),
this.Vn.Lod(),this.kq.z_a=!1,this.kq.Rfa=!0,this.Qva=2,pf.fhp):this.kq.Rfa&&1!==this.Qva?0:(this.z9i(),this.Vn.mxc(),this.kq.Rfa=!0,this.Qva=1,pf.ehp)}gve(pa=null){this.VNl();const Hb=this.t0b(!!pa);this.ubb&&pa&&pa.eventName===Lf.a.UL||this.HIo(Hb)}qU(){this.Vn&&this.Qva&&(this.TCo(),this.Vn.hide(),this.Qva=0)}HIo(pa){this.Y$b=new Ba.a(2,1,pa,()=>{this.Y$b=null;this.qU()},56);Ib.a.instance.Zb(this.Y$b)}updatePosition(pa){if(this.element&&this.element.parentNode){var Hb=this.azi(pa);if(Hb){pa=Sys.UI.DomElement.getBounds(this.element.parentNode);
Hb=new Sys.UI.Bounds(Hb.x-pa.x,Hb.y-pa.y,pf.qTi,Hb.height);var Ob;({left:pa,top:Hb,height:Ob}=this.EDm(Hb,pa,this.element.parentNode,this.Vj.instance));this.element.style.height=2*pf.Gsc+Ob+"px";this.element.style.top=Hb-pf.Gsc+"px";this.element.style.left=pa-pf.Gsc+"px";this.H2a.style.height=Math.max(pf.Fcj,Ob)+"px";this.gve()}}}B0(){this.element&&(gd.a.wy(this.element),this.cse())}v4h(pa,Hb,Ob,Dc,nd){const Od=new Cl;if(!Dc||!Ob)return Od;Dc=this.azi(pa);if(!Dc)return Od;var ye=Ob;Ob=pa;if(pa.Kj){var Oe=
pa.jc;ye=pa.mg.vkc(this.kq.ip.Wba.cp);0>ye&&0==ye;pa.jc.KBa?gd.a.VWa(Oe.editingElement,pa.mg.Aj.K(ye))||(Ob=Object(tl.a)().Ad.sl(pa.source),Hb=Ob.mg.Aj.K(ye)):Hb=Ob.mg.Aj.K(ye);ye=Hb.getBoundingClientRect()}ye=new Sys.UI.Bounds(Dc.x-ye.x,Dc.y-ye.y,pf.qTi,Dc.height);pa=ye.y;Dc=ye.x;ye=ye.height;Oe=this.Vj.instance;nd&&Oe&&(nd=Oe.yj,pa=Math.round(pa/nd),Dc=Math.round(Dc/nd),ye=Math.round(ye/nd));Od.top=pa-pf.Gsc;Od.left=Dc-pf.Gsc;Od.height=2*pf.Gsc+ye;Od.mTi=Math.max(pf.Fcj,ye);Od.Zdb=!0;Od.Hh=Hb;Od.sw=
Ob;return Od}KCj(pa,Hb,Ob,Dc){Sf.S8i();this.jCd=pa;pa=Ob.Hh;Hb=Ob.sw;if(pa&&Hb){if(Dc){const nd=!this.element;nd&&this.Vrf(pa.ownerDocument);nd||!this.element.parentNode?pa.appendChild(this.element):this.element.parentNode!==pa&&(this.element.parentNode.removeChild(this.element),pa.appendChild(this.element));this.jCd=Hb;pa=this.kq.user.color;this.H2a.style.borderColor=pa;this.ubb||(this.mPc.style.borderColor=pa);this.element.id=Sf.Ppb(this.kq);Ob.Zdb&&(this.element.style.height=Ob.height+"px",this.element.style.top=
Ob.top+"px",this.element.style.left=Ob.left+"px",this.H2a.style.height=Ob.mTi+"px",this.gve())}this.Ead=!Dc;this.cse()}else l.ULS.sendTraceTag(520950942,302,50,`Skip IpControl rendering due to paragraphElement is null:${!pa} or paragraphViewElement is null:${!Hb}`)}dispose(){this.element&&(this.B0(),this.mx.xc(Lf.a.UL,this.element,this.$R),this.ubb&&(this.mx.xc(Lf.a.jH,this.element,this.OL),this.mx.xc(Lf.a.gt,this.element,this.rne)),Le.a.vD(this.Vn),this.element=this.Vn=null);super.dispose()}X4j(pa){const Hb=
this.kq.user.color;this.H2a.style.borderColor=Hb;this.ubb||(this.mPc.style.borderColor=Hb);this.element.id=Sf.Ppb(this.kq);this.updatePosition(pa)}EDm(pa,Hb,Ob,Dc){let nd=pa.y,Od=pa.x;pa=pa.height;(1<Math.abs(Hb.width-Ob.offsetWidth)||1<Math.abs(Hb.height-Ob.offsetHeight))&&Dc&&(nd=Math.round(nd/Dc.yj),Od=Math.round(Od/Dc.yj),pa=Math.round(pa/Dc.yj));return{left:Od,top:nd,height:pa}}azi(pa){const Hb=this.kq.ip;if(!Hb)return null;let Ob;try{const Dc=Hb.Wba.cp;Ob=Qi.a.h2(Dc,pa,0<Dc,!1,!1,!1)}catch(Dc){l.ULS.sendTraceTag(4301318,
302,15,"Could not determine the bounds of IP: isYielding={0} message={1} stack={2}",Ib.a.instance.Yy,Dc.message,Dc.stack),Ob=null}return Ob}}pf.O7n="WacPawn";pf.qTi=2;pf.ehp=7E3;pf.fhp=2E3;pf.Gsc=5;pf.Ybo="presenceIp";pf.aco="PresenceSmallBox";pf.Fcj=10;pf.ELl="0xcccccc";Object(f.a)(pf,"PresenceIpControl",Sf,[]);class Wk{constructor(pa,Hb,Ob,Dc,nd=null,Od=null,ye=null){this.MEc={};this.KEc={};this.X$g={};this.fQc=pa;this.mx=Hb;this.Xn=Ob;this.VPa=Dc;this.vZ=nd;this.Ga=Od;this.bF=ye}get $Jl(){return this.MEc}get Aai(){return this.KEc}ADm(pa){const Hb=
!!this.Ga&&this.Ga.$("PeoplesWellExtraButtonInfoIsEnabled");return pa.ip.shapeId&&Hb?this.FDm(pa):this.GDm(pa)}FDm(pa){const Hb=pa.ip.shapeId.toString();this.X$g[pa.user.clientId]=Hb;const Ob=this.KEc[Hb];return Ob?(Ob.kq=pa,{returnValue:Ob,KEe:!0}):{returnValue:this.KEc[Hb]=new Qf(pa,this.fQc,this.mx,this.Xn,this.VPa,this.vZ,this.Ga),KEe:!1}}GDm(pa){const Hb=pa.user.clientId,Ob=this.MEc[Hb];return Ob&&Ob.kq.user.equals(pa.user)?(Ob.kq=pa,{returnValue:Ob,KEe:!0}):{returnValue:this.MEc[Hb]=new pf(pa,
this.fQc,this.mx,this.Xn,this.VPa,this.vZ,this.Ga,this.bF),KEe:!1}}bzi(pa){return this.MEc[pa]}etm(pa){return(pa=this.KEc[this.X$g[pa]])&&!pa.NEe()?pa:null}rTl(){var pa=this.MEc;for(const Hb in pa)pa[Hb].dispose();pa=this.KEc;for(const Hb in pa)pa[Hb].dispose()}}Object(f.a)(Wk,"PresenceControlProvider",null,[]);var Eh=d(615);class Li{constructor(){this.Jjb=0}cBi(){this.Jjb++;this.Jjb===Number.MAX_VALUE&&(this.Jjb=1);return this.Jjb}static get instance(){return Li.kMc}}Li.kMc=new Li;Object(f.a)(Li,
"PacketIdGenerator",null,[790]);class Dj{constructor(pa,Hb,Ob){this.VIo=pa;this.n1m=Hb;this.$3i=Ob}}Object(f.a)(Dj,"SuccessfulInboundReplicationCallbackData",null,[]);class xi{constructor(pa,Hb,Ob,Dc,nd,Od,ye){this.uGo=(Oe,Cf)=>{Cf.type||(Oe=this.em.nhi>=this.fsk,this.hOk&&Oe?(Oe=this.CSe())?Oe.$zf():l.ULS.sendTraceTag(19682513,500,15,"ActivePage ContentReplicator was null, we are abandoning the inbound attempt."):this.WC())};this.i0n=Oe=>{if(Oe=Object(z.a)(Dj,Oe)){var Cf=Oe.n1m.Ei.toString(),Bg=
this.CSe(),Zg=Bg.kr,Qg="";Zg!==Oe.$3i&&(l.ULS.sendTraceTag(19964236,500,50,"Time saved due to force inbound on update notification message = {0} ms",Oe.VIo.toString()),Qg=this.yym(Bg,Zg,Oe.$3i));l.ULS.sendTraceTag(19964237,500,50,"Revisions: {0}, InboundDuration: {1}",Qg,Cf)}else l.ULS.sendTraceTag(19964235,500,10,"The callback data was null")};this.sGo=pa;this.CSe=Hb;this.em=Ob;this.hOk=nd;this.fsk=Od;this.W7b=Dc;this.Kp=ye;this.sGo.BO(this.uGo)}WC(){const pa=this.CSe();if(!pa)l.ULS.sendTraceTag(19682514,
500,15,"ActivePage ContentReplicator was null, we are abandoning the inbound attempt.");else if(!this.W7b()&&pa.gad){let Hb=-1;null!=pa&&(Hb=pa.Tua());const Ob=this.Kp.Wf("Task","ShoulderTapInboundReplicationTimer");pa.WC(this.i0n,null,new Dj(Hb,Ob,pa.kr))}}yym(pa,Hb,Ob){const Dc=new Sys.StringBuilder;pa=pa.node.td.store.getRevision(Hb);if(!pa)return l.ULS.sendTraceTag(19964238,500,10,"The revision we got from the last replicator revisionId was null - {0}",{["lastRevisionId"]:Hb}),"";for(Dc.append(pa.id.du);Hb!==
Ob;){Dc.append(", ");Dc.append(Hb.du);pa=pa.vm;if(!pa)break;Hb=pa.id}return Dc.toString()}}Object(f.a)(xi,"ContentNotificationManager",null,[]);class pg extends xi{constructor(pa,Hb,Ob,Dc,nd,Od,ye){super(pa,Hb,Ob,Dc,nd,Od,ye)}static get bva(){return null!=pg.h2g?pg.h2g:pg.h2g=Ha.a.instance.resolve(543)}static init(){if(Ra.StaticActiveAppFrame.za()){var pa=Ra.StaticActiveAppFrame.za().kb;pa&&(pa.vja(pg.Ydd),pa=pa.$c)&&(pg.tJ=pa.wg,pg.tJ&&qb.a.Isa().continueWith(pg.jdg))}}static jdg(){pg.nxd=qb.a.Isa().result;
pg.nxd&&pg.nxd.Co&&pg.bva.aD().continueWith(pg.Yed)}static Yed(){pg.Yh=pg.bva.aD().result;if(pg.Yh){var pa=m.AFrameworkApplication.J,Hb=pa.$("Box4ThrottleInboundRequests");pa=pa.ic("Box4ThrottleInboundsAtUserCount",20);pg.tJ.pkc=()=>pg.Yh.yba;pg.kxd=pg.kxd||new pg(pg.Yh,()=>pg.tJ,pg.nxd,()=>m.AFrameworkApplication.Sl,Hb,pa,Ra.StaticActiveAppFrame.za().Vr);pg.kxd.WC()}}static Ydd(pa){pg.kxd||(pa.$cb(pg.Ydd),pg.init())}}pg.kxd=null;pg.Yh=null;pg.tJ=null;pg.nxd=null;Object(f.a)(pg,"WordContentNotificationManager",
xi,[]);class Mi{constructor(pa,Hb,Ob,Dc,nd,Od){this.eyd=null;this.Kyh=pa;this.yd=Ob;this.RRa=Dc;this.oC=nd;this.ri=Od;this.T2b=Hb}clone(){return new Mi(this.Kyh,this.T2b.clone(),this.yd,this.RRa,this.oC,this.ri)}get cp(){if(null!=this.eyd)return this.eyd;var pa=this.Kyh.paragraphId;if(pa.equals(Td.a.nil))return 0;var Hb=this.RRa();if(!Hb)return 0;pa=Hb.Eb(pa);if(!pa)return l.ULS.sendTraceTag(7685326,302,15,"Paragraph Node is null so returning a CP with value 0"),0;Hb=this.yd.YLb(this.yd.TYa(pa.characterData,
pa.ra),this.T2b);if(this.oC){const Ob=cb.a.Tc(pa,Hb);this.ri&&pa.Jv&&(Ob.Fb=this.ri.IKf(pa,Hb,this.T2b.CIa));Hb=this.oC.Eza(Ob,!0)}return Hb}wfg(){null==this.eyd&&(this.eyd=this.cp)}equals(pa){return pa?this.T2b.isEqual(pa.T2b,!1):!1}}Object(f.a)(Mi,"WordPresenceCp",null,[818,43,819]);class Vl{constructor(pa,Hb){this.oC=pa;this.ri=Hb}create(pa,Hb,Ob,Dc){return new Mi(pa,Hb,Ob,Dc,this.oC,this.ri)}}Object(f.a)(Vl,"Factory",null,[789]);class ki extends Sys.EventArgs{constructor(pa,Hb,Ob){super();this.paragraphId=
pa;this.JI=Hb;this.aWf=Ob}}Object(f.a)(ki,"ParagraphChangedEventArg",Sys.EventArgs,[]);class Th{constructor(pa){this.cp=pa}equals(pa){return pa?this.cp===pa.cp:!1}clone(){return new Th(this.cp)}}Object(f.a)(Th,"PresenceCp",null,[818,43]);class hh{constructor(pa,Hb,Ob,Dc,nd){this.paragraphId=pa;this.cp=Hb;this.length=Ob;this.shapeId=Dc;this.dryDeletion=nd}}Object(f.a)(hh,"SerializablePresenceIpData",null,[]);class Fe{constructor(pa,Hb,Ob,Dc=0,nd=0){this.Kxa=null;pa&&(this.Kxa=Td.a.Cf(pa));this.Jyh=
new Th(Hb);this.OMa=Ob;this.iDh=Dc;this.Aeh=nd}get paragraphId(){return this.Kxa}get Wba(){return this.Jyh}get shapeId(){return this.iDh}get dryDeletion(){return this.Aeh}isValid(){return 0<=this.Wba.cp&&!!this.paragraphId&&!this.paragraphId.equals(Td.a.nil)}getData(){return new hh(this.paragraphId.toString(),this.Wba.cp,this.OMa,this.shapeId,this.dryDeletion)}clone(){const pa=new Fe;pa.Kxa=this.paragraphId;pa.Jyh=this.Wba?this.Wba.clone():null;pa.OMa=this.OMa;pa.iDh=this.shapeId;pa.Aeh=this.dryDeletion;
return pa}static cMb(pa){return pa.paragraphId&&void 0!==pa.cp&&null!==pa.cp&&void 0!==pa.length&&null!==pa.length?new Fe(pa.paragraphId,pa.cp,pa.length,void 0,pa.dryDeletion):null}}Object(f.a)(Fe,"PresenceIp",null,[784,43]);class tj{constructor(pa,Hb){this.ip=pa;this.user=Hb}}Object(f.a)(tj,"SerializablePresenceData",null,[]);class Ni{constructor(pa,Hb){this.z_a=this.Rfa=this.Fqc=!1;this.G2a=Hb;this.user=pa}get ip(){return this.G2a}LMf(){return new tj(this.ip?this.ip.getData():null,this.user.getData())}Kxi(){return this.user.clientId+
(this.G2a?this.G2a.paragraphId.toString():Td.a.nil.toString())}isValid(){const pa=!!this.user&&this.user.isValid(),Hb=!this.ip||this.ip.isValid();return pa&&Hb}clone(){const pa=new Ni;pa.user=this.user?this.user.clone():null;pa.G2a=this.G2a?this.G2a.clone():null;pa.Rfa=this.Rfa;pa.Fqc=this.Fqc;pa.z_a=this.z_a;return pa}static cMb(pa){return pa?new Ni(Ta.cMb(pa.user),pa.ip?Fe.cMb(pa.ip):null):null}}Object(f.a)(Ni,"PresenceInfo",null,[791,43]);class bh extends ea.a{constructor(){super();this.wMc={};
this.l1a={};this.Lgh=!1}get v5n(){return this.wMc}get rZi(){return!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("PeoplesWellExtraButtonInfoIsEnabled")}SOh(pa){this.addHandler("PPC",pa)}tCj(pa){this.removeHandler("PPC",pa)}q3c(pa){return pa.ip.paragraphId.toString()}cef(pa,Hb=!1){this.Lgh||(this.Lgh=!0,l.ULS.sendTraceTag(4289312,302,50,"First presence added to data manager"));var Ob=({Zbo:Dc}=this.Cqn(pa)).returnValue;if(Dc&&!Hb)(Ob=this.l1a[pa.user.clientId])&&0<=Ob.length&&(Ob[Ob.length-
1].ip.OMa=pa.ip.OMa);else{Ob||this.jBj(pa.user.clientId);this.rZi&&Ob&&this.Ztp(pa);Hb=this.q3c(pa);var Dc=pa.user.clientId;var nd=this.wMc[Hb]||[],Od=this.l1a[Dc]||[];Od.length>=bh.rbj&&(Od=Od.splice(-bh.UPn,bh.rbj));Ob||nd.push(Dc);Od.push(pa);this.wMc[Hb]=nd;this.l1a[Dc]=Od;pa.ip.paragraphId.equals(Td.a.nil)||this.Aog(pa.ip.paragraphId,pa,!0)}}Cqn(pa){var Hb=this.l1a[pa.user.clientId];const Ob=!Hb||0>=Hb.length?null:Hb[Hb.length-1],Dc=!!Ob&&this.q3c(Ob)===this.q3c(pa);Hb=Dc&&Ob.ip.Wba.equals(pa.ip.Wba)&&
Ob.user.equals(pa.user);this.rZi&&Hb&&Ob.ip.shapeId&&pa.ip.shapeId&&Ob.ip.shapeId!==pa.ip.shapeId&&(Hb=!1);return{returnValue:Dc,Zbo:Hb}}Ztp(pa){const Hb=this.mKl(pa);Hb&&Hb.ip.shapeId&&(pa.ip.shapeId&&pa.ip.shapeId===Hb.ip.shapeId||this.Aog(Hb.ip.paragraphId,Hb,!1))}mKl(pa){pa=this.l1a[pa.user.clientId];return!pa||0>=pa.length?null:pa[pa.length-1]}jBj(pa){const Hb=this.l1a[pa];if(Hb&&0<Hb.length){const Ob=Hb[0].ip.paragraphId,Dc=this.q3c(Hb[0]);delete this.l1a[pa];this.Vvo(Dc,pa);Ob.equals(Td.a.nil)||
this.Aog(Ob,Hb[0],!1)}}Eti(pa){return this.wMc[pa]}h1c(pa,Hb,Ob,Dc=!1){const nd=[],Od=this.Eti(pa);if(!Od)return nd;for(let ye=0;ye<Od.length;ye++){const Oe=Od[ye],Cf=this.l1a[Oe];let Bg=!1;for(let Zg=Cf.length-1;0<=Zg;Zg--){const Qg=Cf[Zg];if(Dc){if(Qg.Rfa&&Qg.ip.paragraphId.equals(Td.a.Cf(pa))){Bg=!0;nd.push(Qg);break}}else if(Object(wh.a)(Ni,Qg)?Qg.ip.OMa===Hb:Qg.ip.OMa===Ob){Bg=!0;Qg.Fqc=!0;nd.push(Qg);this.l1a[Oe]=Cf.splice(Zg,Cf.length);break}}!Bg&&0<Cf.length&&Cf[0].Fqc&&Cf[0].ip.paragraphId.equals(Td.a.Cf(pa))&&
nd.push(Cf[0])}return nd}Oem(pa){if(!pa||!pa.Qa||!pa.Qa.node)return null;pa=this.h1c(pa.Qa.node.id.toString(),0,0,!0);pa=this.TNm(pa);pa.sort((Hb,Ob)=>{if(!(Hb&&Hb.userName&&Ob&&Ob.userName))return l.ULS.sendTraceTag(542165082,302,15,"Missing presence user info for user in PresenceInfos"),0});return pa}TNm(pa){if(!pa||!pa.length)return[];const Hb=[],Ob=new I.a(F.a.th());for(let Dc=0;Dc<pa.length;Dc++){const nd=pa[Dc].user;nd.isAnonymous&&Ob.contains(nd.clientId)||!nd.isAnonymous&&nd.email&&Ob.contains(nd.email)||
(Hb.push(nd),Ob.add(nd.isAnonymous?nd.clientId:nd.email))}return Hb}Aog(pa,Hb,Ob){this.raiseEvent("PPC",new ki(pa,Hb,Ob))}Vvo(pa,Hb){Array.remove(this.wMc[pa],Hb)}}bh.rbj=10;bh.UPn=2;Object(f.a)(bh,"PresenceDataManager",ea.a,[1582]);class rk extends bh{constructor(pa){super();this.lG=pa}cef(pa,Hb=!1){super.cef(pa,Hb)}q3c(pa){return pa.ip.Yc.toString()}Eti(pa){pa=this.lG.Eb(Td.a.Cf(pa));if(!pa)return null;pa=pa.ka(ng.a.Yc,0);return this.v5n[pa.toString()]}}Object(f.a)(rk,"WordPresenceDataManager",
bh,[]);var Qd=d(1354),kf=d(1249),sk=d(1885),al=d(38),he=d(1260);class qd{constructor(pa,Hb,Ob,Dc,nd,Od,ye,Oe,Cf,Bg,Zg,Qg,Sg,Qk,bk,df,fc,vd,Uc,ze,Gd,Ej,bd,gg){this.TSa=Array(5);this.Vaf=this._started=this.f7e=!1;this.D3e=null;this.kzh=new I.a(F.a.th());this.sId={};this.hXe=!1;this.c5n=()=>{if(!this.Vaf&&!this.Gl.mz){var Wf=new Ba.a(0,1,20,()=>{const Rg=new P.a;var ii=this.Vjb.$Jl;for(var fo in ii){const na=ii[fo];na.Ead&&Rg.add(na.kq.ip.paragraphId)}if(this.Qke){ii=this.Vjb.Aai;for(const na in ii)fo=
ii[na],fo.Ead&&!Rg.contains(fo.kq.ip.paragraphId)&&Rg.add(fo.kq.ip.paragraphId)}this.Jri(Rg);this.Vaf=!1},72);this.Gb.Zb(Wf);this.Vaf=!0}};this.vjj=()=>{this.f7e&&(this.Hwg(),this.f7e=!1)};this.W7=(Wf,Rg)=>{this.dKj(Rg.Rm.currentSelection)};this.TU=(Wf,Rg)=>{Wf=Rg.Oha;for(var ii in Wf){const fo=Wf[ii];this.Ga.$("CashTelemetryIsEnabled")&&this.EZc(fo,new Date,null);fo.ip?this.Udf(fo):this.Wjd(fo.user.clientId)}Rg=Rg.AYc;for(ii=0;ii<Rg.length;++ii)this.IOl(Rg[ii]);this.ste()};this.xfg=(Wf,Rg)=>{Rg.paragraphId?
this.dwp(Rg.paragraphId.toString(),Rg.yvn,this.sId):l.ULS.shipAssertTag(8758481,302,!1,"null paraid")};this.itj=(Wf,Rg)=>{Rg.paragraphId&&(Wf=this.vK.Eb(Rg.paragraphId))&&((Object(wh.a)(Ni,Rg.JI)?this.sSe(Wf):this.tSe(Wf))===Rg.JI.ip.OMa&&this.OIo(Rg.paragraphId),this.Qke&&this.$bo(Rg))};this.Qp=pa;this.hb=Dc;this.bF=nd;this.LGb=Od;this.Gl=Cf;this.dsk=Bg;this.Vjb=Zg;this.vK=Ob;this.sSe=Sg;this.tSe=Qk;this.gkk=ye;this.gsk=Oe;this.LRa=bk;this.Jq=df;this.Qc=fc;this.Gb=vd;this.zGh=Ej;this.aIk=gg;this.E3e=
ze;this.Ga=Gd;this.VHd=Hb;qd.ZId=new nc.a;for(pa=0;pa<this.VHd.length;pa++)this.VHd[pa].lso(this);this.LGb.SOh(this.itj);this.Qp.Qya(this.TU);bd&&this.Gl.g6(this.c5n);this.Qp.Jse(this)}get Qke(){return!!this.Ga&&this.Ga.$("PeoplesWellExtraButtonInfoIsEnabled")}ste(pa=!1){this.zGh&&!pa||this.GCj()}GCj(){const pa=new P.a,Hb=this.sId;for(const Ob in Hb)pa.add(Td.a.Cf(Ob));this.Jri(pa);this.sId={}}Hwg(){this.hb.gb&&this.dKj(this.hb.gb.currentSelection,!0)}dKj(pa,Hb=!1){this.aIk||(this.vK.xm.Vla||Hb?pa?
(Hb=this.JGl(pa))?this.Qp.Uwg(Hb):(this.Qp.Uwg(null),l.ULS.sendTraceTag(4281418,302,50,"Not supported selection context {0}",pa.Qa.contextId)):this.Qp.Uwg(null):this.f7e=!0)}JGl(pa){if(!this.Qke||!pa.Dtb)if(pa=al.a.uk(pa,!0,!1),!al.a.Am(pa))return null;return this.BWh(pa)}BWh(pa){const Hb=pa.Qa.cpBegin,Ob=pa.Qa.node.id;pa=this.sSe(pa.Qa.node);return new Fe(Ob.toString(),Hb,pa)}EZc(pa,Hb,Ob){if(this.E3e)if(pa&&pa.user&&pa.user.clientId){var Dc=pa.user.clientId;this.kzh.contains(Dc)||(this.D3e?(this.D3e.EZc(Dc,
Hb,null,qd.sGm(Ob||pa.user.client)),this.kzh.add(Dc)):this.E3e.continueWith(()=>{this.D3e=this.E3e.result;this.EZc(pa,Hb,Ob)}))}else l.ULS.sendTraceTag(42262876,302,15,"invalid presence")}CDm(pa){const Hb=new P.a;for(let Ob=0;Ob<pa.length;Ob++)Hb.add(this.KNm(pa[Ob]));return Hb}Udf(pa){var Hb=null;pa&&pa.user&&(Hb=pa.user.client);pa=pa.clone();pa.user=this.bF.$5f(pa.user.clientId)||pa.user;this.Ga.$("CashTelemetryIsEnabled")&&this.EZc(pa,new Date,Hb);pa.isValid()&&!pa.user.sN()&&(Hb=pa.user.clientId,
qd.ZId.lb(Hb)||this.tKi(Hb),this.Tvp(Hb),pa.user.userName=CommonUIStrings.l_AnonymousUserName);this.LGb.cef(pa,!1)}Tvp(pa){const {value:Hb}=qd.ZId.Ac(pa,!1);Hb||(qd.ZId.Z(pa,!0),l.ULS.sendTraceTag(17954774,302,50,'{ "ClientID" : "'+pa+'" , "Event" : "CreateAnonymousGrayPawn"}'))}tKi(){}Wjd(pa){this.LGb.jBj(pa)}IOl(pa){this.Wjd(pa);const Hb=this.Vjb.bzi(pa);Hb&&(Hb.NBj(this.xfg),Hb.dispose());this.Qke&&(pa=this.Vjb.etm(pa))&&(pa.NBj(this.xfg),pa.dispose())}Yjc(pa){if(12!==pa.type)return new P.a;pa=
this.LGb.h1c(pa.id.toString(),this.sSe(pa),this.tSe(pa));return 0>=pa.length?new P.a:this.CDm(pa)}dwp(pa,Hb,Ob){!Hb&&pa in Ob&&delete Ob[pa]}dispose(){this.stop();this.LGb.tCj(this.itj);this.Qp.HZa(this.TU);this.Qp.jKg(this);for(let pa=0;pa<this.VHd.length;pa++)this.VHd[pa].Ppp(this);Le.a.rvg([this.gkk,this.gsk,this.Qp]);this.Vjb.rTl()}KNm(pa){let Hb=!1;pa=({KEe:Hb}=this.Vjb.ADm(pa)).returnValue;Hb||pa.VYk(this.xfg);return pa}sIi(pa){pa=this.vK.Eb(pa);if(!pa)return this.TSa[0]||(l.ULS.sendTraceTag(4281420,
302,50,"Could not find the node in object space"),this.TSa[0]=!0),null;if(!ab.ParagraphReader.Vb(pa))return this.TSa[1]||(l.ULS.sendTraceTag(4281421,302,50,"Not a paragraph node"),this.TSa[1]=!0),null;if(!pa.Be(this.Gl.pc))return this.TSa[2]||(l.ULS.sendTraceTag(4281422,302,50,"No ViewElement found for this node"),this.TSa[2]=!0),null;if(!pa.anchor)return this.TSa[3]||(l.ULS.sendTraceTag(4281423,302,50,"node is not anchored"),this.TSa[3]=!0),null;this.TSa[4]||(l.ULS.sendTraceTag(4564931,302,50,"Valid paragraph node found for rendering ip"),
this.TSa[4]=!0);return pa}PAj(pa){pa=this.LGb.h1c(pa.toString(),-1,-1,!0);if(!se.a.Tf(pa))for(const Hb of pa)(pa=this.Vjb.bzi(Hb.user.clientId))&&pa.element&&pa.B0()}Jri(pa){if(pa.count){var Hb=new P.a;for(var Ob of pa)(pa=this.sIi(Ob))?Hb.add(pa):this.PAj(Ob);if(Hb.count){Ob=this.Qc.Nc(2);try{Ob.set(this.Jq);for(const Dc of Hb)this.Ifi(Dc)}finally{Ob&&Ob.dispose()}}}}Ifi(pa){pa.qI(this.Gl.pc,32,!0);pa.qI(this.dsk,32,!0)}OIo(pa){this.sId[pa.toString()]=null;this.zGh&&!this.hXe&&(pa=new Ba.a(0,1,200,
()=>{this.hXe=!1;this.GCj()},70),this.Gb.Zb(pa),this.hXe=!0)}$bo(pa){if(pa.JI.ip.shapeId&&!pa.aWf){var Hb=this.Vjb.Aai[pa.JI.ip.shapeId.toString()];Hb&&Hb.Ycb(pa.JI.user.clientId)}}stop(){this._started&&(this._started=!1,this.hb.Rga(this.W7),he.a.instance.oCj(this.vjj))}start(){if(!this._started){this._started=!0;this.hb.tA(this.W7);he.a.instance.PQd(this.vjj);var pa=this.Qp.Ypb();delete pa[this.LRa.clientId];this.TU(null,new sk.a(pa,[]));this.Hwg()}}Sye(pa){if(pa&&pa.isValid()&&pa.ip){var Hb=this.LGb.h1c(pa.ip.paragraphId.toString(),
-1,-1),Ob=!1,Dc=null;for(let nd=0;nd<Hb.length;nd++)if(Dc=Hb[nd],Dc.user.clientId===pa.user.clientId){Ob=Dc.z_a=!0;break}if(Ob)if(Hb=Dc.ip.paragraphId,pa=this.sIi(Hb)){Hb=this.Qc.Nc(2);try{Hb.Bb(pa),this.Ifi(pa)}finally{Hb&&Hb.dispose()}}else this.PAj(Hb)}}static sGm(pa){return pa?pa?1===pa?1:2===pa?2:0:2:0}}qd.ZId=null;Object(f.a)(qd,"PresenceManager",null,[1578,10,757,1579,1580,1581]);class hl{constructor(pa,Hb,Ob,Dc){this.s5b=null;this._started=this.IVe=!1;this.bJb=null;this.mua=(nd,Od)=>{if(!m.AFrameworkApplication.Sl&&
(nd=this.$5j(Od.Rm),this.s5b&&nd)){nd=this.hOe.h1c(this.s5b.toString(),-1,-1,!0);for(Od=0;Od<nd.length;Od++)this.bJb[nd[Od].user.clientId]=nd[Od];0>=nd.length||(nd=this.eDl(nd),this.Mp.sendNotification(nd,!0))}};this.ilj=(nd,Od)=>{this.hb.gb&&!m.AFrameworkApplication.Sl&&this.IVe&&this.s5b&&this.s5b.equals(Od.paragraphId)&&(nd=null,!Od.aWf||Od.JI.user.clientId in this.bJb?Od.aWf||(nd=this.T9h(Od.JI.user.userName,!1),delete this.bJb[Od.JI.user.clientId]):(nd=this.T9h(Od.JI.user.userName,!0),this.bJb[Od.JI.user.clientId]=
Od.JI),nd&&this.Mp.sendNotification(nd,!0))};this.Yh=Dc;this.hb=Hb;this.hOe=pa;this.Mp=Ob;this.Yh.Jse(this)}start(){this._started||(this._started=!0,this.bJb={},this.hOe.SOh(this.ilj),this.hb.tA(this.mua),this.$5j(this.hb.gb))}stop(){this._started&&(this._started=!1,this.bJb=null,this.hOe.tCj(this.ilj),this.hb.Rga(this.mua))}eDl(pa){if(1===pa.length)return String.format(Box4Intl.Box4Strings.l_OtherUsersEditingParagraphSingle,pa[0].user.userName);const Hb=[],Ob=pa.length;for(let Dc=0;Dc<Ob;Dc++)Hb.push(pa[Dc].user.userName);
return String.format(Box4Intl.Box4Strings.l_OtherUsersEditingParagraphMany,Hb.join(Box4Intl.Box4Strings.l_DisplayNameSeparator))}T9h(pa,Hb){return String.format(Hb?Box4Intl.Box4Strings.l_UserJoiningParagraph:Box4Intl.Box4Strings.l_UserLeavingParagraph,pa)}dispose(){this.Yh.jKg(this);this.stop()}$5j(pa){if(!pa)return!1;pa=pa.currentSelection;if(!pa)return!1;pa=pa.Qa;if(!pa)return!1;this.IVe=al.a.pf(pa);pa=pa.node.id;if(pa.equals(this.s5b)||!this.IVe)return!1;this.s5b=pa;this.bJb={};return!0}}Object(f.a)(hl,
"PresenceAccessibilityManager",null,[10,757]);class ug{constructor(pa,Hb){this._started=!1;this.zM=null;this.qDd=!1;this.led=()=>{this._started&&this.PJj()};this.Yh=pa;Hb&&(this.zM=Hb,this.zM.Olb(this.led));this.Yh.Jse(this)}start(){this._started||(this._started=!0,this.zM?this.PJj():this.Yh.fC(1,this.y8h()))}PJj(){const pa=this.qDd;(this.qDd=!!this.zM.$y)&&!pa&&this.Yh.fC(1,this.y8h())}y8h(){const pa={};pa.Id="{"+m.AFrameworkApplication.userSessionId.toUpperCase()+"}";pa.HQ=!1;pa.NT=1;pa.WEB=!0;
return pa}stop(){this._started&&(this._started=this.qDd=!1)}dispose(){this.Yh.jKg(this);this.zM&&this.zM.PBj(this.led)}}Object(f.a)(ug,"EditorsTableNotifier",null,[10,757]);var Tj=d(337),xk=d(20);class ff extends qd{constructor(pa,Hb,Ob,Dc,nd,Od,ye,Oe,Cf,Bg,Zg,Qg,Sg,Qk,bk,df,fc,vd,Uc,ze,Gd,Ej,bd,gg,Wf,Rg,ii,fo,na,db,Pb){super(pa,Hb,Ob,Dc,nd,Od,ye,Oe,Cf,Bg,Zg,Sg,Qk,bk,df,Uc,ze,Gd,Ej,bd,gg,Wf,Rg,na);this.em=null;this.iXl=Rb=>{const sc=!!this.em.gA.$ic(Rb);l.ULS.sendTraceTag(579179741,302,50,"ClientId:{0} isPresentAfterPoll:{1}",
Rb,sc)};this.hXl=(Rb,sc)=>{l.ULS.sendTraceTag(579179742,302,15,"EditorsReplicator failed with {0} when looking for ClientId {1}",sc,Rb)};this.zma=()=>{if(2===ff.Yh.connectionState&&!La.SessionStatusManager.instance.dba){const Rb={};Rb.qs=m.AFrameworkApplication.rootQuerySignature;ff.Yh.c9(Rb)}};Qg.fb(xk.a.a5o,Xb.a.application,ff.sWk,64);Qg.fb(xk.a.mrg,Xb.a.application,ff.mrg,64);Qg.fb(xk.a.Sng,Xb.a.application,ff.Sng,96);Qg.fb(qa.a.Sye,Xb.a.application,ff.$4o,64);this.KK=fc;this.yd=vd;this.sJb=ii;
this.LRa.Dtc=fo;this.LRa.Dtc.W_k(ff.jlj);db.continueWith(()=>{this.em=db.result});l.ULS.sendTraceTag(4006600,302,50,"WordPresenceManager Initialized");(this.L1=Pb)&&this.L1.execute(Rb=>{Rb.kTa(this.zma)})}ckc(pa){if(!pa||!pa.anchor)return null;for(pa=pa.anchor.gr;pa;pa=pa.YB)if(pa.pLa)return pa.at.node;return null}BWh(pa){var Hb=null;Hb=m.AFrameworkApplication.J.$("PeoplesWellExtraButtonInfoIsEnabled");var Ob=pa.Qa.cpBegin,Dc=pa.Qa.node;Hb&&Jh.ImageReader.It(Dc)&&(Dc=this.ckc(Dc));if(!Dc)return l.ULS.sendTraceTag(51242309,
302,15,"selectedNode is null"),null;Dc=this.tSe(Dc);const nd=pa.Qa.node.ka(ng.a.Yc,0);if(!this.KK)return l.ULS.sendTraceTag(35997152,302,15,"paragraphWordIdMapping is null"),null;var Od=this.KK.value.Jqb(nd);const ye=ff.lG.Eb(Od);if(!ye)return l.ULS.sendTraceTag(16791249,302,15,"Can't find pid "+Od),null;Ob=this.yd.cBc(this.yd.TYa(ye.characterData,ye.ra),Ob);Ob.CIa=-1===pa.Qa.Fb?0:pa.Qa.Fb;Od=0;Hb&&pa.Dtb&&(Od=this.eIm(pa));return Hb=new cf(this.KK.value,nd,Dc,Ob,this.yd,()=>ff.lG,this.sJb,Od)}eIm(pa){const Hb=
Jh.ImageReader.lKa(pa.Qa);return Hb?Hb.properties.ka(ng.a.Aob,0):pa.Qa.node.properties.ka(ng.a.Aob,0)}tKi(pa){this.em&&this.em.Sra&&this.em.Sra.WC(this.iXl,this.hXl,pa)}dispose(){this.L1&&this.L1.execute(pa=>{pa.$Yb(this.zma)});super.dispose()}static get Cw(){return Ha.a.instance.resolve(26)}static aD(){return ff.wIc.task}static get_instance(){return ff.YId.task}static HDm(){return ff.Lyh.task}static get bva(){return null!=ff.g2g?ff.g2g:ff.g2g=Ha.a.instance.resolve(543)}static init(){ff.YId||(ff.YId=
new w.a);ff.Xgh&&(l.ULS.sendTraceTag(4256585,302,50,"WordPresenceManager Init"),ff.Xgh=!1);if(Ra.StaticActiveAppFrame.za()){var pa=Ra.StaticActiveAppFrame.za().kb;pa?(pa.vja(ff.Ydd),ff.rMc=pa.Jc,pa.qta()?(ff.wQ=pa.$c.wg,ff.wQ?(ff.lG=pa.$c.td,ff.lG?ff.bva.aD().continueWith(ff.e_n):l.ULS.sendTraceTag(4006599,302,15,"Can't initialize the WordPresenceManager because we can't get a reference to content ObjectSpace of the app")):l.ULS.sendTraceTag(4252228,302,15,"Can't initialize the WordPresenceManager because we can't get a reference to the GraphSpaceReplicator object")):
l.ULS.sendTraceTag(4006598,302,50,"PageView doesn't seem to have been initialized yet. Will try again once we know it's initialized")):l.ULS.sendTraceTag(4006597,302,15,"Can't initialize the WordPresenceManager because workspace is not initialized")}else l.ULS.sendTraceTag(4006596,302,15,"Can't initialize the WordPresenceManager because active AppFrame is not initialized")}static e_n(){ff.Yh=ff.bva.aD().result;if(ff.Yh){var pa=[ff.rMc.Afd,ff.rMc.Le.Afd],Hb=Ya.a.instance,Ob=Ha.a.instance.resolve(1639),
Dc=new hl(Ob,Hb,ff.Cw,ff.Yh),nd=m.AFrameworkApplication.J.$("DoNotAddToEditorsTableOnFrameIsEnabled")?qb.a.ud().gA:null;nd=new ug(ff.Yh,nd);var Od=Ha.a.instance.rf(694),ye=Ha.a.instance.resolve(1244),Oe=Ha.a.instance.resolve(613);ff._instance=new ff(ff.Yh,pa,ff.lG,Hb,Oe,Ob,Dc,nd,ff.rMc,ff.rMc.Le.pc,Ha.a.instance.resolve(1640),m.AFrameworkApplication.va,ff.wQ,ab.ParagraphReader.textLength,ab.ParagraphReader.Tra,Ha.a.instance.resolve(1641),Od,ye,ra.a.gf.Ll,new Tj.a,Ib.a.instance,Qd.a.get_instance(),
Na.a.Yp(Ha.a.instance.Ra(1635)),m.AFrameworkApplication.J,m.AFrameworkApplication.J.$("Box4ThrottleAndBatchPresenceRendering"),m.AFrameworkApplication.J.$("Box4DoNotRenderPresenceOutOfView"),Ha.a.instance.resolve(1638),Ha.a.instance.resolve(1642),!ra.a.yt&&!ra.a.hn,qb.a.Isa(),Ha.a.instance.Ra(720));l.ULS.sendTraceTag(23196878,302,50,"WordPresenceManager instance created");ff.YId.hg(ff._instance);ff.wIc.hg(ff._instance);ff.Lyh.hg(ff._instance);pa=Ha.a.instance;pa.ia(1643,()=>ff._instance).as("Common.IPresenceRemover").as("Common.IPresenceSender").ha();
pa.resolve(1643)}else l.ULS.sendTraceTag(4203468,302,15,"Can't initialize the WordPresenceManager because can't get a handle to RtcProxy")}static Ydd(pa){ff._instance||(l.ULS.sendTraceTag(4006601,302,50,"WordPresenceManager.OnAppIsInteractive: Trying to initialize again"),(pa=Object(z.a)(766,pa))&&pa.$cb(ff.Ydd),ff.init())}static jlj(){ff._instance.Hwg()}static sWk(pa,Hb,Ob,Dc,nd){Ob=nd.split(",");if(!Ob||3!==Ob.length)return 8;pa=Ob[0].trim();Hb=Ob[1].trim();Ob=Number.parseInvariant(Ob[2].trim());
pa=new Ni(new Ta(pa),new Fe(Hb,Ob,-1));if(!ff.wIc.task.isCompleted)return 8;Hb=ff.aD().result;Hb.Udf(pa);Hb.ste();return 32}static mrg(pa,Hb,Ob,Dc,nd){if(!ff.wIc.task.isCompleted)return 8;pa=ff.aD().result;pa.Wjd(nd);pa.ste();return 32}static $4o(pa,Hb,Ob,Dc,nd){if(!ff.wIc.task.isCompleted)return 8;pa=ff.aD().result;if(!pa)return 8;pa.Sye(nd);return 32}static Sng(pa,Hb,Ob,Dc,nd){if(1===Ob)return 32;if(!ff.bva.aD().isCompleted)return 8;pa=ff.bva.aD().result;if(!pa)return l.ULS.sendTraceTag(4301136,
302,10,"rtcProxy is null when trying to display RTC connection status"),8;nd[kf.a.Value]=2===pa.connectionState?WordEditorIntl.WordEditorStrings.L_RtcConnected:1===pa.connectionState?WordEditorIntl.WordEditorStrings.L_RtcConnecting:"";return 32}}ff._instance=null;ff.Xgh=!0;ff.YId=new w.a;ff.wIc=new w.a;ff.Lyh=new w.a;ff.lG=null;ff.rMc=null;ff.wQ=null;ff.Yh=null;Object(f.a)(ff,"WordPresenceManager",qd,[]);class Oi{constructor(pa){this.sa=new ea.a;this.i1=pa;this.i1.CWR(()=>this.i1.result.XYk(()=>{this.sa.raiseEvent("X")}))}W_k(pa){this.sa.addHandler("X",
pa)}nyo(pa){this.sa.removeHandler("X",pa)}getStatus(){return this.i1.isCompleted&&this.i1.result?this.i1.result.uYd.toString():"0"}}Object(f.a)(Oi,"WordPresenceStatusProvider",null,[788]);class Ph{constructor(pa,Hb,Ob,Dc){this.Yh=null;this.Pgh=this.VZe=!1;this.f_n=()=>{this.tO.isCompleted&&this.tO.result?(this.Yh=this.tO.result,this.Yh.Qya(this.TU),l.ULS.sendTraceTag(5604372,302,50,"Presence Update Monitor is ready.")):l.ULS.sendTraceTag(5604373,302,15,"RtcTask did not complete successfully. No monitoring")};
this.TU=(nd,Od)=>{nd=Od.Oha;for(const ye in nd)if(Od=nd[ye],!this.VZe&&Od.user.GF&&Od.user.GF!==this.BH.GF){l.ULS.sendTraceTag(5604375,302,15,"Presence received from different local cobalt session Mine:{0} Theirs:{1}",this.BH.GF,Od.user.GF);this.VZe=!0;break}this.VZe&&this.Yh.HZa(this.TU);this.Pgh||(l.ULS.sendTraceTag(5604374,302,50,"First presence received"),this.Pgh=!0)};this.em=pa;this.BH=Hb;this.tO=Ob;Ob.continueWith(this.f_n);this.ZCk=Dc;this.ZCk.G4f=this.BH}}Object(f.a)(Ph,"WordPresenceUpdateMonitor",
null,[]);var ni=d(421),Pf=d(1608),Yh=d(1342),Qh=d(221),fk=d(1889),km=d(1890),gk=d(1763);class Ij{constructor(pa,Hb,Ob,Dc,nd,Od,ye){this.sa=new ea.a;this.Fnh=this.Bph=this.hYe=this.ssh=!1;this.abf=this.HOd=0;this.cbc=null;this.LRa=Od;this.LRa.clientId=pa.clientId;this.Yk=pa;this.Yca=Hb;this.vda=Dc;this.fuk=nd;this.Gb=Ob;this.vhb=new Qh.a;this.sq=ye;this.Yca&&this.Yca.continueWith(()=>{this.Yca.kp||this.Yca.fj||this.Yca.result.ONh(Object(Za.a)(this,this.zhj,"onAmIAloneChanged"))})}get connectionState(){return this.Yk.connectionState}Qya(pa){this.sa.addHandler("PU",
pa)}HZa(pa){this.sa.removeHandler("PU",pa)}NZ(pa){this.sa.addHandler("CSC",pa)}GZa(pa){this.sa.removeHandler("CSC",pa)}Rlb(pa){this.sa.addHandler("PSU",pa)}Uwb(pa){this.sa.removeHandler("PSU",pa)}Qlb(pa){this.sa.addHandler("PSC",pa)}Twb(pa){this.sa.removeHandler("PSC",pa)}Twg(){}get clientId(){return this.Yk.clientId}BO(pa){this.sa.addHandler("UN",pa)}wDa(pa){this.sa.removeHandler("UN",pa)}f3m(){this.cbc=Array(12);for(let pa=0;12>pa;pa++)this.cbc[pa]=0;this.Bph=this.sq?this.sq.$("UpdateNotificationTaskExperimentIsEnabled"):
!0;m.AFrameworkApplication.XI(()=>{this.kDn()})}init(){this.Yk.NZ(Object(Za.a)(this,this.DN,"onConnectionStateChanged"));this.Yk.Qya(Object(Za.a)(this,this.TU,"onPresenceUpdated"));this.Yk.Rlb(Object(Za.a)(this,this.sga,"onPersistentStateUpdated"));this.Yk.Qlb(Object(Za.a)(this,this.DYa,"onPersistentStateCleared"));this.Yk.BO(Object(Za.a)(this,this.aS,"onUpdateNotificationReceived"));this.L4h();this.f3m()}Jse(pa){this.vhb.contains(pa,(Hb,Ob)=>Hb===Ob)||(this.vhb.add(pa),2===this.connectionState&&
pa.start())}jKg(pa){for(let Hb=0;Hb<this.vhb.length;Hb++)if(this.vhb.K(Hb)===pa){this.vhb.YH(Hb);break}}connect(){this.hYe||this.Yk.connect()}disconnect(){this.Yk.disconnect()}get Kue(){return this.Yk}udi(pa){return Ni.cMb(pa)}rxg(pa,Hb){return(new Ni(pa,Hb)).LMf()}Uwg(pa){pa&&pa.isValid()&&!this.vda()?this.Yk.Twg(this.rxg(this.LRa.bym(),pa)):E.Task.X6(null)}NDa(pa,Hb){return this.Yk.NDa(pa,Hb)}Xpb(pa){return this.Yk.Xpb(pa)}Iic(){return this.Yk.Iic()}fC(pa,Hb,Ob=!1){return this.Yk.fC(pa,Hb,Ob)}Ypb(){return this.o8h(this.Yk.Ypb())}c9(pa){const Hb=
new w.a;gk.a.getInstance().fse(pa,Hb);return Hb.task}get yba(){return this.Yk.yba}DN(pa,Hb){2===Hb.newState&&this.vhb.forEach(Ob=>{Ob.start();return!0});Hb.newState||this.sq.$("SendRTCMessagesWhileDisconnectedIsEnabled")&&!this.hYe||this.vhb.forEach(Ob=>{Ob.stop();return!0});this.sa.raiseEvent("CSC",Hb)}ZCf(pa){return pa.toLowerCase()}TU(pa,Hb){if(!this.vda()){pa=this.o8h(Hb.Oha);Hb=this.q8h(Hb.AYc);var Ob=new sk.a(pa,Hb);Hb=new Ba.a(0,1,0,()=>{this.sa.raiseEvent("PU",Ob)},57);this.Gb.Zb(Hb)}}o8h(pa){const Hb=
{};for(const Dc in pa){var Ob=Dc;const nd=this.udi(pa[Dc]);nd&&nd.isValid()?Hb[this.ZCf(Ob)]=nd:l.ULS.sendTraceTag(562661590,302,50,"No Valid User {0}",Ob)}return Hb}q8h(pa){const Hb=Array(pa.length);for(let Ob=0;Ob<pa.length;Ob++)Hb[Ob]=this.ZCf(pa[Ob]);return Hb}sga(pa,Hb){if(!this.vda()){var Ob={};pa=Hb.Oha;for(var Dc in pa)Ob[this.ZCf(Dc)]=pa[Dc];Dc=new Ba.a(0,1,0,()=>{this.sa.raiseEvent("PSU",new fk.a(Hb.type,Ob))},80);this.Gb.Zb(Dc)}}DYa(pa,Hb){if(!this.vda()){pa=this.q8h(Hb.dnb);var Ob=new km.a(pa);
pa=new Ba.a(0,1,0,()=>{this.sa.raiseEvent("PSC",Ob)},81);this.Gb.Zb(pa)}}aS(pa,Hb){this.Bph?this.vnj(Hb):(pa=new Ba.a(0,1,0,()=>{this.vnj(Hb)},58),this.Gb.Zb(pa))}vnj(pa){var Hb=Date.now();this.sa.raiseEvent("UN",pa);Hb=Date.now()-Hb;500<=Hb&&(this.HOd++,l.ULS.sendTraceTag(42563487,302,15,"Update Notification Heuristics: UpdateNotification Type {0} took {1} ms",pa.type,Hb),this.G7l(pa));this.abf++}G7l(pa){0>pa.type||21<=pa.type?l.ULS.sendTraceTag(42541602,302,15,"Update Notification Heuristics: UpdateNotification Type out of range {0}",
pa.type):this.cbc[pa.type]++}kDn(){if(!this.Fnh){var pa={};pa.TC=this.abf;pa.HRC=this.HOd;this.cbc&&0<this.HOd&&(pa.TBC=this.cbc);this.HOd=this.abf=0;this.cbc=null;l.ULS.sendTraceTag(42541603,302,50,"UpdateNotificationHeuristics: {0}",pa);this.Fnh=!0}}dispose(){this.vhb=new Qh.a;this.Yk.GZa(Object(Za.a)(this,this.DN,"onConnectionStateChanged"));this.Yk.HZa(Object(Za.a)(this,this.TU,"onPresenceUpdated"));this.Yk.Uwb(Object(Za.a)(this,this.sga,"onPersistentStateUpdated"));this.Yk.Twb(Object(Za.a)(this,
this.DYa,"onPersistentStateCleared"));this.Yk.wDa(Object(Za.a)(this,this.aS,"onUpdateNotificationReceived"));this.Yca&&this.Yca.continueWith(()=>{this.Yca.kp||this.Yca.fj||this.Yca.result.oxo(Object(Za.a)(this,this.zhj,"onAmIAloneChanged"))});this.Yk.disconnect();l.ULS.sendTraceTag(4564935,302,50,"Disposing of rtcProxyCompleted")}zhj(){this.L4h()}L4h(){let pa=!1;this.Yca?this.Yca.continueWith(()=>{this.Yca.kp||this.Yca.fj||(pa=!this.Yca.result.wq);this.Yk.connectionState||!pa&&!this.fuk()?2!==this.Yk.connectionState||
pa||(this.disconnect(),l.ULS.sendTraceTag(4564937,302,50,"Disconnecting because there are no other users in the doc")):(this.connect(),l.ULS.sendTraceTag(4564936,302,15,"Connecting because there are other authors in the doc"));!this.ssh&&pa&&(l.ULS.sendTraceTag(4203466,302,50,"There are other real-time authors in this session"),this.ssh=!0)}):(this.connect(),l.ULS.sendTraceTag(589321547,302,50,"Connecting to rtc because Rtc Always On is enabled"))}ogc(){this.hYe=!0;this.disconnect();l.ULS.sendTraceTag(4564938,
302,50,"DisconnectForever")}}Object(f.a)(Ij,"RtcProxy",null,[1572,10,1573,1574]);class Wl extends Ij{constructor(pa,Hb,Ob,Dc,nd,Od,ye,Oe,Cf,Bg,Zg,Qg,Sg){super(pa,Hb,Ob,Dc,nd,Od,Sg);this.P5=null;this.KK=ye;this.yd=Oe;this.RRa=Cf;this.kMc=Bg;this.S8e=Zg;this.sJb=Qg}get tH(){return this.P5||(this.P5=this.S8e())}DN(pa,Hb){2===Hb.newState&&l.ULS.sendTraceTag(4315102,302,50,"RTC Connected");this.twp();super.DN(pa,Hb)}twp(){this.tH&&this.tH.eS("RtcConnectionStatusLabel")}udi(pa){return me.isf(mh(pa),this.KK,
this.yd,this.RRa,this.sJb)}rxg(pa,Hb){return Object(wh.a)(cf,Hb)?(pa=new me(this.kMc.cBi(),pa,Hb),gh(pa.LMf())):super.rxg(pa,Hb)}}Object(f.a)(Wl,"WordRtcProxy",Ij,[]);class lm{constructor(pa,Hb,Ob,Dc,nd,Od,ye,Oe,Cf,Bg,Zg,Qg,Sg){this.Nq=new w.a;this.QDh=!0;this.Xd=Hb;this.Gb=Ob;this.vda=Dc;this.LRa=nd;this.KK=Od;this.zya=ye;this.RRa=Oe;this.kMc=Cf;this.S8e=Bg;this.L1=Zg;this.sJb=Qg;this.Ga=Sg}aD(){this.zlp();return this.Nq.task}yPb(){return ni.a.then(this.aD(),pa=>pa)}zlp(){if(this.QDh)if(this.QDh=
!1,ra.a.J_f()&&ra.a.HYf()){var pa=m.AFrameworkApplication.Ee;if(pa){var Hb="{"+m.AFrameworkApplication.userSessionId+"}",Ob=m.AFrameworkApplication.userSessionId,Dc=m.AFrameworkApplication.kvg,nd=this.Ga.$("RtcAlwaysOnEnabled"),Od=Oe=>{const Cf=new Wl(Oe,nd?null:qb.a.Isa(),this.Gb,this.vda,lm.V$l,this.LRa,this.KK,this.zya,this.RRa,this.kMc,this.S8e,this.sJb,m.AFrameworkApplication.J);Yh.a.zUo(Cf);this.bso(Cf);Cf.init();Eh.a.BNa=Cf;this.L1.execute(Bg=>{Bg.Plb(()=>{Cf.ogc()})});this.Nq.hg(Cf)};if(m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.LoadRtcFrom1JS",
!1))Promise.all([d.e(4),d.e(2),d.e(10)]).then(d.bind(null,2116)).then(Oe=>{ye=Oe.RealtimeChannelNetCore.createInstance(Hb,Ob,Dc,pa,this.L1,1,this.Xd,this.Ga.ib("RtcEndpointUrl"),void 0,void 0,null,this.Ga.$("FindSessionOnBootIsEnabled")?Ha.a.instance.resolve(156):null,this.Ga.ib("RtcBootToken"));Od(ye)});else{var ye=Pf.RealtimeChannel.createInstance(Hb,Ob,Dc,pa,this.L1,1,this.Xd,this.Ga.ib("RtcEndpointUrl"),void 0,void 0,null,this.Ga.$("FindSessionOnBootIsEnabled")?Ha.a.instance.resolve(156):null,
this.Ga.ib("RtcBootToken"));Od(ye)}}else l.ULS.sendTraceTag(8206365,302,15,"Can't initialize the RtcProxy because ClientRequestManager is null")}else l.ULS.sendTraceTag(8206362,302,10,"Can't initialize the RtcProxy because dependent scripts are not loaded")}bso(pa){const Hb=Ha.a.instance;Hb.ia("WordEditor.Presence.WordRtcProxy",()=>pa).as("Box4.Presence.IRtcProxy").as(138).ha();Hb.resolve(138)}static V$l(){return!1}}Object(f.a)(lm,"WordRtcProxyProvider",null,[786,787]);class il{constructor(){this.W=
null;this.fm=!1}get name(){return"WordEditor.Presence"}init(){l.ULS.sendTraceTag(50995799,302,50,"PresencePackage Init");ra.a.qak&&(this.W.resolve(1644).aD(),ff.init(),this.W.resolve(1645));ra.a.XVc&&pg.init();this.W.resolve(1646);this.W.resolve(613);if(il.snh){const pa=this.W.resolve(76);pa.QJb(this.psc);il.NWe=1===pa.Kw||2===pa.Kw}}dispose(){if(!this.fm){this.fm=!0;ff.aD().continueWith(()=>{Le.a.vD(ff.aD().result)});var pa=this.W.resolve(1641);pa&&pa.Dtc&&pa.Dtc.nyo(ff.jlj)}}uc(pa){this.W=pa;this.W.ia(1641,
()=>new zb).as(1647).as(1648).as(1649).ha();pa.ia(1638,()=>new Vl(pa.resolve(19),pa.resolve(14))).ha();pa.ia(1645,()=>new Ph(new W.a(()=>qb.a.ud()),sf.a.instance,pa.resolve(1644).yPb(),pa.resolve(1647))).ha();pa.ia(1644,()=>new lm(m.AFrameworkApplication.buildVersion,Ra.StaticActiveAppFrame.za().Vr,Ib.a.instance,()=>m.AFrameworkApplication.Sl,Ha.a.instance.resolve(1647),Ha.a.instance.Oa(440),Ha.a.instance.resolve(1244),()=>m.AFrameworkApplication.ua&&Ra.StaticActiveAppFrame.za().kb&&Ra.StaticActiveAppFrame.za().kb.$c?
Ra.StaticActiveAppFrame.za().kb.$c.td:null,Li.instance,()=>Ha.a.instance.Oa(584),Ha.a.instance.Ra(720),Ha.a.instance.resolve(1638),m.AFrameworkApplication.J)).ha().as(543).as(140);pa.ia(1640,()=>new Wk(il.KIl(),we.a.instance,Ha.a.instance.Ra(6),Ha.a.instance.resolve(425),Na.a.Yp(Ha.a.instance.Ra(616)),m.AFrameworkApplication.J,pa.resolve(613))).ha();pa.ia(1646,()=>new xf(Ha.a.instance.resolve(1648),Ha.a.instance.resolve(1644).yPb(),ff.HDm(),Ha.a.instance.resolve(1649),Ib.a.instance,m.AFrameworkApplication.J.$("AwayStatusOneMinuteTimeoutIsEnabled")?
6E4:m.AFrameworkApplication.J.ic("AwayCoauthorThresholdMs",9E5),Object(Za.a)(m.AFrameworkApplication.va,m.AFrameworkApplication.va.Ob,"processAction"),Ra.StaticActiveAppFrame.za().$J,m.AFrameworkApplication.J.$("PeoplesWellExtraButtonInfoIsEnabled"))).ha();pa.ia("WordEditor.Presence.WordPresenceStatusProvider",()=>new Oi(Na.a.Yp(Ha.a.instance.Ra(1281)))).as(1642).ha();pa.ia("Common.App.Presence.PeopleInfoProvider",()=>new eh(pa.resolve(1644).yPb(),qb.a.Isa().CWR(()=>qb.a.Isa().result.gA),pa.resolve(151),
pa.resolve(1649),Na.a.Yp(pa.Ra(1646)))).as(613).ha();pa.ia(1639,()=>new rk(Ra.StaticActiveAppFrame.za().kb.$c.td)).as(1080).ha()}psc(pa,Hb){Ra.StaticActiveAppFrame.za()&&Ra.StaticActiveAppFrame.za().XF&&(il.SHd=null,il.NWe=1===Hb.jMa||2===Hb.jMa)}static get Aoj(){!il.SHd&&Ra.StaticActiveAppFrame.za()&&Ra.StaticActiveAppFrame.za().XF&&(il.SHd=Eh.a.Mm.XF.getElementsByClassName(il.NWe&&il.snh?"PaginatedContentContainerDisplayWrapper":"OutlineContainerDisplayWrapper")[0]);return il.SHd}static KIl(){const pa=
m.AFrameworkApplication.J.$("PeoplesWellExtraButtonInfoIsEnabled"),Hb=m.AFrameworkApplication.J.$("PresenceIgnoreEventOnExpandedTooltip"),Ob=m.AFrameworkApplication.J.$("PresenceIpWidthAdjustForFlyout"),Dc=new Gi;Dc.add(zg.pMn,Vi.getImageClassWithCluster(m.AFrameworkApplication.xfa,"MoreUsersGlyph16"));Dc.add(zg.oMn,m.AFrameworkApplication.Ss);Dc.add(zg.W7n,Vi.getImageClassWithCluster(m.AFrameworkApplication.xfa,pa?"DoughboyWhiteGlyph_20x20x32":"SingleCollabUserGlyph16"));Dc.add(zg.X7n,m.AFrameworkApplication.Ss);
Dc.add(zg.zIndex,1);Dc.add(zg.rtl,m.AFrameworkApplication.isRtl);Dc.add(zg.NBp,il.wOm);Dc.add(zg.R_m,Hb);Dc.add(zg.han,Ob);return pa?new Fb(Dc):new Ce(Dc)}static wOm(){return il.Aoj?Je.a.getElementBounds(il.Aoj):null}}il.NWe=!0;il.snh=m.AFrameworkApplication.J.$("FlippedFlyoutForPaginationViewIsEnabled");il.SHd=null;Object(f.a)(il,"WordPresencePackage",null,[0,1]);var kn=d(1022),Jl=d(1269),Zm=d(1032),bl=d(193);class $m{constructor(pa,Hb){this.Vdf=pa;this.paragraphId=Hb}get opType(){return 2}get operation(){return this.Vdf}}
Object(f.a)($m,"RttAppliedAddParagraphOp",null,[783]);class Tk{constructor(pa,Hb){this.DAo=pa;this.paragraphId=Hb}get opType(){return 6}get operation(){return this.DAo}}Object(f.a)(Tk,"RttAppliedReplaceSymbolRangeOp",null,[783]);class zm{constructor(pa,Hb){this.HAo=pa;this.paragraphId=Hb}get opType(){return 1}get operation(){return this.HAo}}Object(f.a)(zm,"RttAppliedReplaceTextRangeOp",null,[783]);class yk{constructor(pa,Hb,Ob){this.sVj=pa;this.xze=Hb;this.pXc=Ob}get opType(){return 4}get operation(){return this.sVj}get fRk(){return this.sVj.mfc()?
this.pXc:this.xze}}Object(f.a)(yk,"RttAppliedSplitParagraphOp",null,[783]);class Kl{constructor(){this.vgb=new nc.a}v1f(pa){return pa.toString()}qRc(pa,Hb){pa=this.v1f(pa);this.vgb.lb(pa)||this.vgb.Z(pa,new P.a);this.vgb.K(pa).add(Hb)}efg(pa){switch(pa.opType){case 1:var Hb=Object(z.a)(zm,pa);this.qRc(Hb.paragraphId,pa);break;case 6:Hb=Object(z.a)(Tk,pa);this.qRc(Hb.paragraphId,pa);break;case 4:Hb=Object(z.a)(yk,pa);this.qRc(Hb.xze,pa);this.qRc(Hb.pXc,pa);break;case 2:Hb=Object(z.a)($m,pa),this.qRc(Hb.paragraphId,
pa)}}JVn(pa){return this.ovb(pa)}ovb(pa){pa=this.v1f(pa);if(!this.vgb.lb(pa))return new P.a;const Hb=this.vgb.K(pa);this.vgb.remove(pa);for(const Ob of Hb)Ob.operation&&(Ob.operation.J$=null);return Hb}jAm(pa){let Hb;return({value:Hb}=this.vgb.Ac(this.v1f(pa),Hb)).returnValue?Hb:new P.a}Zdm(pa){for(const Hb of this.vgb.values){if(!Hb.count)continue;if(2!==Hb.K(0).opType)continue;const Ob=Hb.K(0);if(Ob.Vdf.Iag===pa)return Ob}return null}}Object(f.a)(Kl,"RttAppliedOpTracker",null,[765]);var li=d(254),
Tn;(function(pa){pa[pa.$1l=0]="expired";pa[pa.DVp=1]="dried"})(Tn||(Tn={}));Object(f.b)("RemoveChangeReason",Tn);class Uk{constructor(){this.QEa=new li.a}aTk(pa){if(!pa)return l.ULS.sendTraceTag(7685333,355,15,"Cannot add a null change to RTTStore"),!1;const Hb=pa.Yc,Ob=pa.Uj;this.QEa.lb(Hb)||this.QEa.add(Hb,new li.a);this.QEa.K(Hb).Z(Ob,pa);return this.JKl(Hb,Ob)?(l.ULS.sendTraceTag(7619921,355,15,"Detected an infinite loop in paragraph {0}, dropping the last packet!",Hb),this.QEa.K(Hb).remove(Ob),
!1):!0}MKf(pa,Hb){if(!this.QEa.lb(pa))return null;pa=this.QEa.K(pa);return pa.lb(Hb)?pa.K(Hb):null}X6d(pa){const Hb=new P.a;for(const Ob of this.QEa.keys){const Dc=this.QEa.K(Ob);for(const nd of Dc.keys){const Od=Dc.K(nd);pa(Od)&&Hb.add(Od)}}return Hb}aBj(pa,Hb){let Ob=null;({value:Ob}=this.QEa.Ac(pa.Yc,Ob)).returnValue?(pa.activity.ddg(Tn[Hb]),Ob.remove(pa.Uj),Ob.count||this.QEa.remove(pa.Yc)):l.ULS.sendTraceTag(50938848,355,15,"Cannot remove an op that not exist in _changes. WordId: {0}; Reason: {1}",
pa.Yc,Hb)}Vqg(pa){this.aBj(pa,1)}Yqg(pa){this.aBj(pa,0)}JKl(pa,Hb){if(!this.QEa.lb(pa))return!1;pa=this.QEa.K(pa);if(!pa.lb(Hb))return!1;for(var Ob=pa.K(Hb);Ob;){Ob=Ob.u4;if(Ob===Hb)return!0;if(!pa.lb(Ob))break;Ob=pa.K(Ob)}return!1}}Object(f.a)(Uk,"RttDataStore",null,[762,763]);var zk=d(280),Ik=d(42),ig=d(271),ul=d(198),pe=d(14),Ln=d(59);class $h{constructor(pa,Hb){this.Qle=(Ob,Dc)=>{4===this.ep.opType?l.ULS.shipAssertTag(9204866,355,12===Dc.node.type||11===Dc.node.type,"Unexpected graph modification detected during RTT edit"):
l.ULS.shipAssertTag(9204867,355,!1,"Unexpected graph modification detected during RTT edit")};this.ovb=()=>{l.ULS.shipAssertTag(9204868,355,!1,"Unexpected graph modification detected during RTT edit")};this.wjj=()=>{l.ULS.shipAssertTag(9204869,355,!1,"Unexpected graph modification detected during RTT edit")};this.ep=pa;if(this.Im=Hb)pa=this.Im.jf(12),pa.wt(this.Qle),pa.Yx(this.ovb),pa.jo(this.wjj)}dispose(){if(this.Im){const pa=this.Im.jf(12);pa.hS(this.Qle);pa.Rua(this.ovb);pa.JP(this.wjj)}}}Object(f.a)($h,
"GraphChangeValidator",null,[10]);class ll{constructor(pa,Hb,Ob,Dc){this.id=pa;this.cpBegin=Hb;this.cpEnd=Ob;this.Cll=Dc}sAp(pa){var Hb=this.id===pa.id;Hb&&(Hb=this.Cll.replace("\u00a0"," "),pa=pa.characterData.substr(this.cpBegin,this.cpEnd-this.cpBegin).replace("\u00a0"," "),Hb=Hb===pa);return Hb}}Object(f.a)(ll,"RttOpValidator",null,[817]);class zf{constructor(pa,Hb){this.J$=this.IAc=this.activity=null;this.opType=pa;this.metadata=Hb}INf(){return""}serialize(){return null}}Object(f.a)(zf,"RttOp",
null,[781]);class af extends zf{constructor(pa,Hb,Ob,Dc,nd,Od,ye,Oe,Cf){super(Cf,Oe);this.Yc=pa;this.Uj=Hb;this.RU=Ob;this.P7=Dc;this.u4=nd;this.uzb=Od;this.KJ=ye}r$h(){return this.RU.isEqual(this.P7,!0)?new Re.a(0,this.Yc,this.Uj,this.RU,void 0,void 0,void 0,this.KJ):new Re.a(1,this.Yc,this.Uj,this.RU,this.Yc,this.Uj,this.P7,this.KJ)}static N1j(pa){let Hb,Ob;var Dc=pa.sW;if(1===Dc.kse&&(Dc.PYa!==Dc.IMa||Dc.Keb!==Dc.Pyc))return l.ULS.sendTraceTag(8914769,355,15,"We received a ReplaceRange operation spanning multiple paragraphs"),
Ob=Hb=null,pa=Dc=-1,{returnValue:!1,RU:Ob,P7:Hb,Yc:pa,Uj:Dc};if(Dc.KJ)return Ob=Hb=null,pa=Dc=-1,{returnValue:!1,RU:Ob,P7:Hb,Yc:pa,Uj:Dc};Hb=Ob=Dc.RU;1===Dc.kse&&(Hb=Dc.P7);pa=Dc.PYa;Dc=Dc.Keb;return{returnValue:!0,RU:Ob,P7:Hb,Yc:pa,Uj:Dc}}}Object(f.a)(af,"RttReplaceRangeOp",zf,[]);var Eg=d(1268),Ag=d(459),nb=d(985),Nb=d(510),ec=d(446);class Hc extends Nb.a{constructor(){super();this.RttStatusRecords=this.FileId=null}$m(){return ec.a.yGo}static Cea(pa,Hb){const Ob=new Hc;Ob.FileId=pa;Ob.RttStatusRecords=
Hb;return Ob}}Object(f.a)(Hc,"RttStatusRequest",Nb.a,[]);class Tc{}Object(f.a)(Tc,"RttStatusOp",null,[]);class xd{constructor(){this.contentState=this.contentType=this.timeToRender=this.strictlySequentialId=this.packetVersion=this.clientType=this.clientId=this.packetId=null}}Object(f.a)(xd,"WireRttStatusOpRecord",null,[]);class ld extends Ag.a{constructor(){super();this.s$b=new P.a;this.k6e=new P.a;this.fl=new Eg.a(m.AFrameworkApplication.J.ic("WordEditorRttStatusReplicatorIntervalMs",6E4));this.enabled=
1;Eh.a.K0.register(this)}fhk(){const pa=Date.now();for(const Hb of this.s$b)Hb.DWb&&1===Hb.DWb&&(Hb.DWb=2,Hb.timeToRender=pa-Hb.metadata.DHg)}mGe(pa){const Hb=new Tc;Hb.metadata=pa.operation.metadata;Hb.opType=pa.opType;Hb.DWb=1;this.s$b.add(Hb)}get mma(){return"RttStatusReplicator"}Saa(){return this.ke&&this.ke.status===nb.a.jS?!0:1===this.enabled&&this.fl.D_()?this.mI():!1}mI(){for(const pa of this.s$b)if(pa.DWb&&2===pa.DWb)return!0;return!1}oNa(){if(1===this._state){this._state=3;const Hb=this.s$b.toArray().filter(Ob=>
2===Ob.DWb);var pa=this.zCl(Hb);pa=Hc.Cea(m.AFrameworkApplication.rootQuerySignature,pa);Hb.forEach(Ob=>this.s$b.remove(Ob));Hb.forEach(Ob=>this.k6e.add(Ob));this.ke.Wq=pa;this.ke.vE="RttStatusRequest";this.ke.status=nb.a.nH}else 3===this._state&&this.ke&&this.ke.status===nb.a.jS&&(this.fl.E4(),2!==this.ke.statusCode&&this.s$b.iD(0,this.k6e),this.k6e.clear(),this._state=1)}zCl(pa){const Hb=[];pa.forEach(Ob=>{const Dc=new xd;Dc.clientId=Ob.metadata.clientId;Dc.clientType=Ob.metadata.clientType;Dc.packetId=
Ob.metadata.packetId;Dc.packetVersion=Ob.metadata.packetVersion;Dc.strictlySequentialId=Ob.metadata.strictlySequentialId;Dc.contentType=Ob.opType;Dc.contentState=Ob.DWb;Dc.timeToRender=Ob.timeToRender;Hb.push(Dc)});return Hb}e0b(){return!0}WC(){}xF(){}}Object(f.a)(ld,"RttStatusReplicator",Ag.a,[]);class Ed{constructor(pa,Hb,Ob,Dc,nd,Od){this.packetId=pa;this.clientId=Hb;this.clientType=Ob;this.DHg=Dc;this.packetVersion=nd;this.strictlySequentialId=Od}static create(pa){let Hb=null;null!=pa.strictlySequentialId&&
(Hb=pa.strictlySequentialId);return new Ed(pa.packetId,pa.clientId,pa.client,Date.now(),pa.version,Hb)}}Object(f.a)(Ed,"RttOpMetadata",null,[]);class Zd extends zf{constructor(pa,Hb,Ob,Dc,nd,Od,ye,Oe,Cf){super(4,Cf);this.u4=0;this.Yc=pa;this.Uj=Hb;this.offset=Ob;this.KJ=Dc;this.dOg=nd;this.jHg=Od;this.OFe=ye;this.kHg=Oe;this.dOg===this.Yc?this.u4=this.jHg:this.OFe===this.Yc?this.u4=this.kHg:(l.ULS.sendTraceTag(8397766,355,10,"Bad data passed to RttSplitParagraphOp"),this.u4=0)}mfc(){return this.Yc===
this.OFe}get Rfp(){return this.u4}get lEp(){return this.mfc()?this.dOg:this.OFe}get xZj(){return this.mfc()?this.jHg:this.kHg}serialize(){const pa=new Re.a(3,this.Yc,this.Uj,this.offset,null,null,null,this.KJ),Hb=new jd(this.dOg,this.jHg,this.OFe,this.kHg);return new vb(this.metadata.packetId,this.metadata.clientId,1,4,pa,null,void 0,void 0,void 0,void 0,Hb,void 0,void 0,this.metadata.strictlySequentialId)}static create(pa){const Hb=pa.sW,Ob=pa.B0b;return new Zd(Hb.PYa,Hb.Keb,Hb.RU,Hb.KJ,Ob.Vhg,Ob.iHg,
Ob.Whg,Ob.lHg,Ed.create(pa))}static BGm(pa,Hb,Ob){if(1!==pa.type)return null;const Dc=Ob.TYa(pa.Q7.characterData,pa.Q7.ra);return new Zd(pa.Q7.Yc,pa.Q7.Uj,Ob.cBc(Dc,pa.eVj),pa.KJ,pa.vJb.Yc,pa.vJb.Uj,pa.bTc.Yc,pa.bTc.Uj,Hb)}}Object(f.a)(Zd,"RttSplitParagraphOp",zf,[760,781]);class If{constructor(pa,Hb,Ob,Dc){this.HRn=()=>{this.BHb.fhk()};this.Aoa=pa;this.GLc=Hb;this.kpa=Ob;this.BIb=Dc;null!=m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorRttStatusReplicatorIsEnabled",
!1)&&(this.BHb=new ld,zk.a.instance.NNh(this.HRn))}o6k(pa,Hb,Ob,Dc=null){if(Hb.isDirty)return Dc&&Dc.properties.Z(If.Mpj,"1"),!1;const nd=new $h(pa,Hb.mk);try{if(1===pa.opType||6===pa.opType){const Oe=Object(z.a)(af,pa),Cf=this.$xl(Oe,Hb);var Od=Cf.node.characterData;const Bg=10<=Cf.cpBegin?Cf.cpBegin-10:0;let Zg=Cf.cpEnd+10<=Od.length?Cf.cpEnd+10:Od.length;const Qg=Od.substr(Bg,Cf.cpBegin-Bg),Sg=Od.substr(Cf.cpEnd,Zg-Cf.cpEnd);Zg=Zg+Oe.uzb.length-(Cf.cpEnd-Cf.cpBegin);var ye=new ll(Cf.node.id,Bg,
Zg,Qg+Oe.uzb+Sg);const Qk=6===Oe.opType;Od="";Qk&&(Od=Oe.font);if(!this.mAo(Cf,Oe.uzb,Qk,Od,Dc))return!1;let bk;bk=1===pa.opType?new zm(Oe,Hb.id):new Tk(Oe,Hb.id);Hb.Tra=pa.u4;Oe.IAc=ye;pa.J$=bk;Ob.efg(bk);null!=this.BHb&&this.BHb.mGe(bk)}else return 4===pa.opType?this.n6k(pa,Hb,Ob):!1}finally{nd&&nd.dispose()}return!0}n6k(pa,Hb,Ob){const Dc=Object(z.a)(Zd,pa);var nd=this.BIb.TYa(Hb.characterData,Hb.ra);nd=this.BIb.YLb(nd,Dc.offset);if(!this.g0i(cb.a.createTextRange(Hb,0,ab.ParagraphReader.textLength(Hb))))return!1;
var Od=Af.a.Za(Hb);Od.vb(10);if(this.oee(Od))return!1;let ye;Od=this.kpa.Nc(3);try{Od.Bb(Hb);const Oe=Hb.I0();try{const Cf=Af.a.Za(Hb);Cf.vb(10);Cf.ld(11);let Bg=Cf.currentNode;Dc.mfc()&&(Cf.PXf?Bg=null:(Cf.RJ(),Bg=Cf.currentNode));Cf.rc();const Zg=this.GLc.Rnb();Cf.UJ(Zg,Bg,89);Cf.Yj(Zg);ye=Hb.clone();const Qg=ye.I0();try{ye.setValue(ng.a.Yc,Dc.lEp);ye.setValue(ng.a.Uj,Dc.xZj);ye.isDirty=!1;Cf.Vf(ye,2);Cf.Yj(ye);this.Xzl(Hb,ye);const Sg=Dc.mfc()?ye:Hb,Qk=Dc.mfc()?Hb:ye;Sg.RQ=!0;Qk.RQ=!0;this.Aoa.Psg(this.LIa(Sg,
nd,ab.ParagraphReader.textLength(Sg)),"",!1,"");this.Aoa.Psg(this.LIa(Qk,0,nd),"",!1,"");Hb.Tra=Dc.Rfp;ye.Tra=Dc.xZj}finally{Qg&&Qg.dispose()}}finally{Oe&&Oe.dispose()}Od.c_a()}finally{Od&&Od.dispose()}Hb=new yk(Dc,Hb.id,ye.id);pa.J$=Hb;Ob.efg(Hb);null!=this.BHb&&this.BHb.mGe(Hb);return!0}oee(pa){const Hb=new Af.a;Hb.hd(pa);Hb.ld(11);return Ik.ListItemReader.Cg(Hb)?(l.ULS.sendTraceTag(16868566,355,50,"Blocked RTT para operation: in a list"),!0):!1}L6l(pa,Hb,Ob){var Dc=Hb.Jqb(pa.Yc);if(Dc.equals(Td.a.nil))return null;
Dc=Ob.Eb(Dc);if(!Dc||!ab.ParagraphReader.Vb(Dc)||!Dc.isConnected)return null;const nd=Af.a.Za(Dc);if(!nd.vb(23))return null;if(pa.cOg){pa=Hb.Jqb(pa.cOg);if(pa.equals(Td.a.nil))return null;Ob=Ob.Eb(pa);if(!Ob||!ab.ParagraphReader.Vb(Ob)||!Ob.isConnected)return null;Ob=Af.a.Za(Ob);if(!Ob.vb(23))return null;Ob.ld(11);Ob.RJ();Ob.Zd();if(Ob.currentNode!==Dc)return null}return this.oee(nd)?null:nd}rlp(pa,Hb,Ob,Dc){const nd=Hb.currentNode,Od=this.kpa.Nc(3);try{Od.Bb(nd);Hb.ld(11);const ye=Hb.currentNode;
Hb.rc();const Oe=this.GLc.Rnb();Hb.UJ(Oe,ye,89);Hb.Yj(Oe);const Cf=ig.a.instance.createInstance(Ln.a.paragraphNode),Bg=Cf.I0();try{Cf.setValue(pe.a.Pn,""),Cf.qLa=!0,Dc.UYb(Cf),Dc=[0],Cf.setValue(ng.a.Gq,Dc),Cf.setValue(ng.a.Lt,Dc),Cf.qLa=!1,Cf.setValue(ng.a.Yc,pa.Iag),Cf.setValue(ng.a.Uj,pa.Hag),Cf.isDirty=!1,Hb.Vf(Cf,2),Cf.RQ=!0,Cf.Tra=pa.Hag}finally{Bg&&Bg.dispose()}Od.c_a();pa.J$=new $m(pa,Cf.id);Ob.efg(pa.J$);null!=this.BHb&&this.BHb.mGe(pa.J$)}finally{Od&&Od.dispose()}return!0}LIa(pa,Hb,Ob){return Hb===
Ob?cb.a.Tc(pa,Hb):cb.a.createTextRange(pa,Hb,Ob)}mAo(pa,Hb,Ob,Dc,nd=null){const Od=pa.node;if(pa.cpBegin!==pa.cpEnd&&!this.g0i(pa))return nd&&nd.properties.Z(If.L3j,"1"),!1;nd=this.kpa.Nc(3);try{nd.Bb(Od);const ye=Od.I0();try{Od.RQ=!0,this.Aoa.Psg(pa,Hb,Ob,Dc)}finally{ye&&ye.dispose()}nd.c_a()}finally{nd&&nd.dispose()}return!0}Xzl(pa,Hb){Hb.qLa=!0;Hb.kva(pa.characterData);Hb.Tra=pa.Tra;Hb.ra.clear();for(var Ob=0;Ob<pa.ra.length;Ob++){const Dc=pa.ra.K(Ob).cra(Hb);Hb.ra.add(Dc)}Hb.Ml();if(Hb.se.length)for(pa=
0;pa<Hb.ra.length;pa++){if((Ob=Hb.ra.K(pa).formatting)&&-1!==Ob.pe)for(;Hb.se.length<=Ob.pe;)Hb.se.mX(Hb.se.length-1,256)}else l.ULS.sendTraceTag(9204881,355,15,"Cannot update WordRunProperties after splitting paragraph");Hb.qLa=!1}U0f(pa){pa=Af.a.Za(pa);pa.vb(23);pa.rc();return{returnValue:89===pa.role,iterator:pa}}Grg(pa){const Hb=new Af.a;Hb.hd(pa);Hb.rc();const Ob=this.kpa.Nc(3);try{Ob.Bb(Hb.currentNode),pa.Rg()}finally{Ob&&Ob.dispose()}}vuo(pa){if(pa.anchor)if(({iterator:Hb}=this.U0f(pa)).returnValue)this.Grg(Hb);
else{var Hb=pa.Ic.xm;var Ob=this.kpa.Nc(3);try{Ob.Bb(pa),pa.load(Object(ul.d)(Hb).Eb(pa.id)),pa.anchor.V_(4)}finally{Ob&&Ob.dispose()}}}Cug(pa,Hb,Ob){for(let Od=Hb.count-1;0<=Od;Od--){var Dc=Hb.K(Od);switch(Dc.opType){case 4:Dc=Object(z.a)(yk,Dc);if(!pa.id.equals(Dc.xze)){l.ULS.shipAssertTag(9204885,355,pa.id.equals(Dc.pXc));continue}Dc=Ob.Eb(Dc.pXc);if(!Dc)break;if(!Dc||!ab.ParagraphReader.Vb(Dc)){l.ULS.shipAssertTag(9204886,355,!1);break}if(!Dc.isConnected)continue;var nd=({iterator:Dc}=this.U0f(Dc)).returnValue;
l.ULS.shipAssertTag(9204887,355,nd);nd&&this.Grg(Dc);break;case 2:(Dc=Object(z.a)($m,Dc),pa.id.equals(Dc.paragraphId))?pa.isConnected&&(nd=({iterator:Dc}=this.U0f(pa)).returnValue,l.ULS.shipAssertTag(16820002,355,nd),nd&&this.Grg(Dc)):l.ULS.shipAssertTag(16820001,355,!1)}}}$xl(pa,Hb){const Ob=this.BIb.TYa(Hb.characterData,Hb.ra),Dc=this.BIb.YLb(Ob,pa.RU);pa=this.BIb.YLb(Ob,pa.P7);return Dc===pa?cb.a.Tc(Hb,Dc):cb.a.createTextRange(Hb,Dc,pa)}g0i(pa){const Hb=pa.node.ra,Ob=pa.cpBegin;pa=pa.cpEnd;for(let Dc=
0;Dc<Hb.length;Dc++){const nd=Hb.K(Dc);if(nd.cp>=pa)break;if(nd.cp>=Ob){if(nd.lf)return l.ULS.sendTraceTag(8242647,355,15,"Rejected unsafe wet change: range contains comment"),!1;if(nd.blob)return l.ULS.sendTraceTag(8242648,355,15,"Rejected unsafe wet change: range contains blob"),!1;if(nd.fc||nd.cCa||nd.pnc)return l.ULS.sendTraceTag(8242649,355,15,"Rejected unsafe wet change: range contains field"),!1}}return!0}}If.Mpj="ParagraphAlreadyDirty";If.L3j="UnsafeWetChange";Object(f.a)(If,"RttEditor",null,
[764]);var qg=d(18),ch=d(1311),mk=d(255);class qj{constructor(){this.Gvd=new P.a}add(pa){this.Gvd.add(pa);return!0}X6d(pa){const Hb=new P.a;for(const Ob of this.Gvd)pa(Ob)&&Hb.add(Ob);return Hb}Vqg(pa){pa.activity.ddg("dried");this.Gvd.remove(pa)}Yqg(pa){pa.activity.ddg("expired");this.Gvd.remove(pa)}}Object(f.a)(qj,"RttAddParagraphDataStore",null,[]);class ne extends zf{constructor(pa,Hb,Ob,Dc,nd,Od,ye,Oe){super(2,Oe);this.Yc=pa;this.Uj=Hb;this.u4=Ob;this.cOg=Dc;this.Iag=nd;this.Hag=Od;this.KJ=ye}serialize(){const pa=
new Re.a(2,this.Yc,this.Uj,null,this.cOg,null,null,this.KJ),Hb=new oc(this.u4,this.Iag,this.Hag);return new vb(this.metadata.packetId,this.metadata.clientId,1,3,pa,null,void 0,void 0,Hb,void 0,void 0,void 0,void 0,this.metadata.strictlySequentialId)}static create(pa){const Hb=pa.sW,Ob=pa.Ybc;let Dc=null;null!=pa.sW.IMa&&(Dc=pa.sW.IMa);return new ne(Hb.PYa,Hb.Keb,Ob.mHg,Dc,Ob.Yhg,Ob.u4,Hb.KJ,Ed.create(pa))}static xGm(pa,Hb){return 3!==pa.type?null:new ne(pa.iua.Yc,pa.iua.Uj,pa.bNn.Uj,pa.uYa?pa.uYa.Yc:
null,pa.BCa.Yc,pa.BCa.Uj,pa.KJ,Hb)}}Object(f.a)(ne,"RttAddParagraphOp",zf,[]);class Se{constructor(pa){this.AY=pa}Hxj(){this.AY&&this.AY.properties.Z(Se.oli,"1")}Tlo(pa){this.AY&&(this.AY.properties.lb(Se.Y8f)||this.AY.properties.Z(Se.Y8f,(pa-this.AY.startTime).toString()))}ddg(pa){this.AY&&(this.AY.properties.Z(Se.vCj,pa),this.AY.end())}qno(pa){this.AY&&this.AY.properties.Z(Se.Qoj,pa.toString())}ono(pa){this.AY&&this.AY.properties.Z(Se.koj,pa)}static HTf(pa){pa.r8(xk.a.GZb,Se.oli,ch.a.CXj);pa.r8(xk.a.GZb,
Se.o3l,ch.a.CXj);pa.r8(xk.a.GZb,Se.Y8f,ch.a.j$k);pa.r8(xk.a.GZb,Se.vCj,ch.a.Gza);pa.r8(xk.a.GZb,Se.Qoj,ch.a.Gza);pa.r8(xk.a.GZb,Se.koj,ch.a.Gza)}static create(pa){if(!pa)return null;pa=pa.nq(xk.a.GZb,Se.TCp);return new Se(pa)}}Se.oli="FailedToFindInitialParaID";Se.o3l="FailedToFindInitialTextID";Se.Y8f="MsecUntilApplied";Se.vCj="RemovedBecause";Se.Qoj="PacketVersions";Se.koj="OperationType";Se.TCp=48E4;Object(f.a)(Se,"RttOpActivity",null,[]);var aj;(function(pa){pa[pa.unknown=0]="unknown";pa[pa.Meq=
1]="replaceTextRangeOp";pa[pa.NPp=2]="addParagraphOp";pa[pa.yUp=3]="deleteParagraphOp";pa[pa.gjq=4]="splitParagraphOp";pa[pa.A4p=5]="mergeParagraphOp";pa[pa.Leq=6]="replaceSymbolRangeOp"})(aj||(aj={}));Object(f.b)("RttOpType",aj);var te=d(104);class hk extends af{constructor(pa,Hb,Ob,Dc,nd,Od,ye,Oe,Cf,Bg,Zg){super(Dc,nd,Od,ye,Oe,Cf,Bg,Zg,6);this.font=pa;this.Bvn=Hb}INf(){return"OffsetStart: "+this.RU+"OffsetEnd: "+this.P7}serialize(){const pa=this.r$h();return new vb(this.metadata.packetId,this.metadata.clientId,
1,7,pa,null,this.u4,this.uzb,void 0,void 0,void 0,void 0,void 0,this.metadata.strictlySequentialId)}static create(pa){let Hb,Ob,Dc,nd;if(!({RU:Hb,P7:Ob,Yc:Dc,Uj:nd}=af.N1j(pa)).returnValue)return null;let Od,ye;if(1===pa.text.length)Od=!1,ye=te.AParagraphNode.gE;else if(2===pa.text.length)if(Ab.a.pXi(pa.text,0)&&Ab.a.VA(pa.text,1))Od=!0,ye=pa.text;else return l.ULS.sendTraceTag(8914772,355,15,"RTT symbol packet has text length 2 but is not a valid surrogate pair",pa.operationType),null;else return l.ULS.sendTraceTag(8914773,
355,15,"RTT symbol packet text is of unsupported length (length must be 1 or 2)",pa.operationType),null;const Oe=pa.iqd,Cf=Ed.create(pa);return new hk(Oe.MFg,Oe.NFg,Od,Dc,nd,Hb,Ob,pa.i1b,ye,pa.sW.KJ,Cf)}}Object(f.a)(hk,"RttReplaceSymbolRangeOp",af,[760,781]);class ak extends af{constructor(pa,Hb,Ob,Dc,nd,Od,ye,Oe){super(pa,Hb,Ob,Dc,nd,Od,ye,Oe,1)}INf(){return"OffsetStart: "+this.RU+"OffsetEnd: "+this.P7+"TextAddedLength: "+this.uzb.length}serialize(){const pa=this.r$h();return new vb(this.metadata.packetId,
this.metadata.clientId,1,2,pa,null,this.u4,this.uzb,void 0,void 0,void 0,void 0,void 0,this.metadata.strictlySequentialId)}static create(pa){let Hb,Ob,Dc,nd;if(!({RU:Hb,P7:Ob,Yc:Dc,Uj:nd}=af.N1j(pa)).returnValue)return null;let Od="";pa.text&&(Od=pa.text);const ye=Ed.create(pa);return new ak(Dc,nd,Hb,Ob,pa.i1b,Od,pa.sW.KJ,ye)}static AFm(pa,Hb,Ob){if(pa.type)return null;const Dc=Ob.TYa(pa.Q7.characterData,pa.Q7.ra);return new ak(pa.Q7.Yc,pa.Q7.Uj,Ob.cBc(Dc,pa.cpBegin),Ob.cBc(Dc,pa.cpEnd),pa.BCa.Uj,
pa.Bba,pa.KJ,Hb)}}Object(f.a)(ak,"RttReplaceTextRangeOp",af,[760,781]);class lj{constructor(pa,Hb,Ob,Dc,nd,Od,ye,Oe,Cf,Bg,Zg,Qg,Sg,Qk,bk,df,fc,vd,Uc,ze,Gd){this.J7=ze;this.Ohc=Gd;this.Yk=null;this.iXe=this.rJh=!1;this.yzd=!0;this.fvh=0;this.ICh=this.g7e=this.KCh=this.HCh=this.JCh=!1;this.Lfg=()=>{l.ULS.sendTraceTag(7685328,355,50,"All prerequisite ready for RttManager");this.Yk=this.tO.result;l.ULS.sendTraceTag(7685330,355,50,"Subscribing to presence updates");this.Yk.BO(this.aS)};this.aS=(Ej,bd)=>
{if(3===bd.type||10===bd.type)if(10===bd.type)this.fvh="boolean"===typeof bd.iA?bd.iA?1:0:bd.iA;else{if(ra.a.wna){if(ra.a.Ak&&ra.a.Ak.urb){l.ULS.sendTraceTag(508351552,355,15,"RTT channel did not get disconnected on lock release");return}}else if(this.E8b.value&&!this.E8b.value.urb){l.ULS.sendTraceTag(8454939,355,15,"RTT channel did not get disconnected on lock release");return}if(!bd.iA)l.ULS.sendTraceTag(7685331,355,15,"RTT packet was empty");else if(!this.Ohc||2!==this.J7.Kw)if(this.Dno(),(Ej=
this.$Ol(bd.iA))&&1!==Ej.metadata.clientType&&(this.Cno(),(!this.xp||this.xp.lba||qg.a.ysb||qg.a.LR||qg.a.ysb||qg.a.LR)&&2!==this.fvh))switch(this.yzd&&(this.r$b.Txj(),this.yzd=!1),this.rJh||this.h3m(),Ej.opType){case 1:case 6:case 4:if(!({Og:Ej}=this.bTk(Ej)).returnValue)break;this.AGh?this.hIj(Ej):this.O2j(Ej);break;case 2:this.sCc.add(Ej),this.OPi(Ej),this.AGh?this.hIj(Td.a.nil):this.N2j(Ej)}}};this.Z1l=()=>{const Ej=this.Di.value;if(Ej){var bd=this.XE()-lj.Huo,gg=this.tCb.X6d(Rg=>Rg.metadata.DHg<
bd);0<gg.count&&this.Ulo();var Wf=new mk.a;for(const Rg of gg)if(this.tCb.Yqg(Rg),Rg.J$)switch(Rg.J$.opType){case 1:Wf.add(Rg.J$.paragraphId.toString());break;case 6:Wf.add(Rg.J$.paragraphId.toString());break;case 4:Wf.add(Rg.J$.xze.toString()),Wf.add(Rg.J$.pXc.toString())}gg=this.sCc.X6d(Rg=>Rg.metadata.DHg<bd);for(const Rg of gg)this.sCc.Yqg(Rg),Rg.J$&&Wf.add(Rg.J$.paragraphId.toString());for(const Rg of Wf)(Wf=Ej.Eb(Td.a.Cf(Rg)))?Wf.RQ?(this.AHb.vuo(Wf),Wf.RQ||this.gKc.value.LBj(Wf)):l.ULS.sendTraceTag(8765829,
355,15,"Expiring wet change from paragraph with no applied changes"):l.ULS.sendTraceTag(8765828,355,15,"Expiring wet change with invalid object ID")}else this.Di.ERf&&l.ULS.sendTraceTag(7685332,355,10,"Failed to find the IObjectSpace! Wet changes will never expire")};this.AHb=pa;this.tCb=Hb;this.gKc=Ob;this.E8b=Dc;this.KK=nd;this.tO=Od;this.Di=ye;this.Gb=Oe;this.XE=Cf;this.BIb=Bg;this.xd=Zg;this.H3e=Sg;this.Qc=Qk;this.AGh=bk;this.r$b=df;this.mBb=fc;this.icf=vd;this.xMc=new I.a(F.a.th());this.sCc=
new qj;Qg.execute(lj.HTf);this.xp=Uc}h3m(){const pa=new Ba.a(3,2,lj.Owo,this.Z1l);this.Gb.Zb(pa);this.rJh=!0}init(){return this.tO?this.tO.continueWith(this.Lfg):E.Task.X6(!1)}$Ol(pa){pa=mh(pa);if(!pa)return null;switch(pa.operationType){case 2:return ak.create(pa);case 7:return hk.create(pa);case 4:return Zd.create(pa);case 3:return ne.create(pa);default:return l.ULS.sendTraceTag(8459668,355,50,"RTT packet is of unexpected operationType {0}",pa.operationType),null}}bTk(pa){let Hb=Td.a.nil;if(!this.tCb.aTk(pa))return{returnValue:!1,
Og:Hb};this.OPi(pa);if(!this.KK)return{returnValue:!1,Og:Hb};const Ob=this.KK.Jqb(pa.Yc);if(Ob.equals(Td.a.nil)||!this.Di.value.Eb(Ob))return pa.activity.Hxj(),{returnValue:!1,Og:Hb};this.Vxj();return{returnValue:!0,Og:Ob}}hIj(pa){pa.equals(Td.a.nil)||this.xMc.add(pa.toString());this.iXe||(pa=new Ba.a(0,1,200,()=>{this.rnp();this.iXe=!1},71),this.Gb.Zb(pa),this.iXe=!0)}CIo(pa){pa=new Ba.a(0,1,0,pa,71);this.Gb.Zb(pa)}OPi(pa){pa.activity=Se.create(this.xd);pa.activity.qno(pa.metadata.packetVersion);
pa.activity.ono(aj[pa.opType])}rnp(){var pa=this.sCc.X6d(Ob=>!Ob.J$);for(const Ob of pa)this.N2j(Ob);if(this.xMc.count){pa=null;for(var Hb of this.xMc){Hb=Td.a.Cf(Hb);pa=this.Di.value.Eb(Hb);break}Hb=this.Qc.Nc(3);try{Hb.Bb(pa);for(const Ob of this.xMc)this.O2j(Td.a.Cf(Ob))}finally{Hb&&Hb.dispose()}this.xMc.clear()}}O2j(pa){pa=this.Di.value.Eb(pa);let Hb;const Ob=this.Qc.Nc(3);try{Ob.Bb(pa);Hb=this.xd.nq(xk.a.XRh);const Dc=this.bSh(pa,Hb);Hb.end();Dc&&this.rWk(Dc)}finally{Ob&&Ob.dispose(),this.r$b.npg(1),
this.yzd=!0}}N2j(pa){var Hb=this.AHb.L6l(pa,this.KK,this.Di.value);Hb&&(this.Vxj(),this.AHb.rlp(pa,Hb,this.mBb,Ha.a.instance.resolve(348))&&(Hb=this.Di.value.Eb(pa.J$.paragraphId),this.uSh(Hb,pa),this.r$b.npg(1),this.yzd=!0))}rWk(pa){this.H3e.continueWith(()=>{if(1===pa.opType){var Hb=this.DDm(pa);Hb&&(this.H3e.result.Udf(Hb),this.H3e.result.ste(!0))}})}DDm(pa){const Hb=pa.serialize();if(2!==Hb.operationType||Hb.sW.IMa&&Hb.sW.PYa!==Hb.sW.IMa)return null;const Ob=pa.RU.clone();0<pa.uzb.length&&(Ob.K1h(),
Ob.cp+=pa.uzb.length);Hb.operationType=0;Hb.text=null;Hb.sW.kse=0;Hb.sW.RU=Ob;Hb.sW.Keb=Hb.i1b;Hb.sW.IMa=null;Hb.sW.Pyc=null;Hb.sW.P7=null;Hb.i1b=null;return me.isf(Hb,this.KK,this.BIb,()=>this.Di.value,this.icf.instance)}uSh(pa,Hb){return this.gKc.value?this.gKc.value.KRk(pa,Hb.metadata.clientId).returnValue?!0:(l.ULS.sendTraceTag(7866379,355,15,"Unable to apply a wet change lock"),!1):(l.ULS.shipAssertTag(7866378,355,!!this.gKc.value,"Unable to apply wet changes as LockManager unavailable"),!1)}aSh(pa,
Hb){this.bSh(pa,Hb)}bSh(pa,Hb){if(!pa)return null;if(!pa.anchor)return Hb&&Hb.properties.Z(lj.Ffj,"1"),null;if(!pa.hasProperty(ng.a.Yc))return l.ULS.sendTraceTag(7619922,355,15,"Paragraph is missing the WordId property"),null;if(!pa.hasProperty(ng.a.Uj))return l.ULS.sendTraceTag(8197722,355,15,"Paragraph is missing the TextId property"),null;if(pa.hasProperty(ng.a.Lei)&&pa.getValue(ng.a.Lei))return l.ULS.sendTraceTag(16815506,355,50,"RTT edit disabled in paragraph"),null;const Ob=pa.getValue(ng.a.Yc);
var Dc=pa.Tra;Hb&&(Hb.properties.Z(lj.aOn,Dc.toString()),Hb.properties.Z(lj.cOn,Ob.toString()));Dc=this.tCb.MKf(Ob,Dc);if(!Dc)return Hb&&Hb.properties.Z(lj.tfj,"1"),null;if(!this.uSh(pa,Dc))return Hb&&Hb.properties.Z(lj.o7h,"1"),null;let nd=0,Od=null;for(;Dc;){if(!this.AHb.o6k(Dc,pa,this.mBb,Hb)){Hb&&Hb.properties.Z(lj.E$j,"1");break}nd++;Dc.activity.Tlo(this.XE());Od=Dc;Dc=pa.Tra;Dc=this.tCb.MKf(Ob,Dc)}0<nd&&this.uxj();Hb&&Hb.properties.add(lj.F$j,nd.toString());return Od}Zse(pa){if(pa.hasProperty(ng.a.Yc)&&
pa.hasProperty(ng.a.Uj)){var Hb=pa.getValue(ng.a.Yc),Ob=pa.ka(ng.a.Uj,0),Dc=this.xd.nq(xk.a.Qzj),nd=this.mBb.JVn(pa.id);0<nd.count&&(this.AHb.Cug(pa,nd,this.Di.value),this.dvo(pa,nd,Ob));var Od=this.mBb.Zdm(Hb);if(Od&&!pa.id.equals(Od.paragraphId)){const ye=this.Di.value;this.CIo(()=>{const Oe=this.mBb.ovb(Od.paragraphId),Cf=ye.Eb(Od.paragraphId);l.ULS.shipAssertTag(16820032,355,!!Cf,"Could not find added graph node");Cf&&(this.AHb.Cug(Cf,Oe,ye),this.sCc.Vqg(Od.Vdf))})}this.tCb.MKf(Hb,Ob)||this.gKc.value.LBj(pa);
this.aSh(pa,Dc);Dc.end()}}dvo(pa,Hb,Ob){let Dc=!1;for(let Od=Hb.count-1;0<=Od;Od--){var nd=Hb.K(Od);switch(nd.opType){case 1:case 6:case 4:nd=Object(z.a)(760,nd.operation);break;default:continue}nd.u4===Ob&&(Dc=!0,nd.IAc&&!nd.IAc.sAp(pa)&&l.ULS.sendTraceTag(8765831,355,15,"Validating wet change location failed. Type {0} OffsetInfo {1} NodeId {2} ValidatorNodeId {3} ValidatorNodeCpBegin {4} ValidatorNodeCpEnd {5}",nd.opType,nd.INf(),pa.id,nd.IAc.id,nd.IAc.cpBegin,nd.IAc.cpEnd));Dc&&this.tCb.Vqg(nd)}Dc&&
this.uxj()}Jed(pa){const Hb=this.mBb.ovb(pa.id);0<Hb.count&&(2===Hb.K(0).opType&&Hb.removeAt(0),this.AHb.Cug(pa,Hb,this.Di.value))}Sxe(pa){var Hb=this.mBb.jAm(pa.id);for(const Ob of Hb)if(4===Ob.opType&&(Hb=Object(z.a)(yk,Ob),pa.id.equals(Hb.fRk)))return!0;return!1}Dno(){this.JCh||(l.ULS.sendTraceTag(8704354,355,50,"Received a wet change"),this.JCh=!0)}Cno(){this.HCh||(l.ULS.sendTraceTag(8185606,355,50,"Received a wet change that we could deserialize"),this.HCh=!0)}Vxj(){this.KCh||(l.ULS.sendTraceTag(17147533,
355,50,"Received a usable wet change"),this.KCh=!0)}uxj(){this.g7e||(l.ULS.sendTraceTag(8185607,355,50,"Successfully applied a wet change"),this.g7e=!0)}Ulo(){this.g7e||this.ICh||(l.ULS.sendTraceTag(8185608,355,15,"Failed to apply any wet changes so far"),this.ICh=!0)}static HTf(pa){const Hb=[xk.a.XRh,xk.a.Qzj];for(const Ob of Hb)pa.r8(Ob,lj.F$j,ch.a.Gza),pa.r8(Ob,lj.tfj,ch.a.Gza),pa.r8(Ob,lj.Ffj,ch.a.Gza),pa.r8(Ob,lj.o7h,ch.a.Gza),pa.r8(Ob,lj.E$j,ch.a.Gza),pa.r8(Ob,If.Mpj,ch.a.Gza),pa.r8(Ob,If.L3j,
ch.a.Gza);Se.HTf(pa)}}lj.Owo=6E4;lj.Huo=18E4;lj.F$j="WetChangeCount";lj.tfj="NoChangesToApply";lj.Ffj="NodeNotConnected";lj.o7h="CouldNotGetLock";lj.E$j="WetChangeBlocked";lj.cOn="NodeWordId";lj.aOn="NodeTextId";Object(f.a)(lj,"RttManager",null,[761]);class bm{constructor(pa,Hb){this.QGj=0;this.Rj=pa;this.xGo=Hb}Txj(){this.QGj=this.Rj()}npg(pa){const Hb=this.Rj()-this.QGj;0<=Hb&&this.xGo.track(Math.round(Hb),0===pa?"CTB":"RTP")}}Object(f.a)(bm,"RttPerfCounter",null,[758]);var Oa=d(2E3);class kc{constructor(){this.cOc=
new Oa.a}TWk(pa,Hb){this.cOc.back()&&Hb&&this.cOc.back().E6a(pa)||this.cOc.enqueue(pa)}Cym(){return this.cOc.isEmpty?null:this.cOc.dequeue()}}Object(f.a)(kc,"RttSendDataStore",null,[759]);class Oc extends zf{constructor(pa,Hb,Ob,Dc){super(3,Dc);this.Yc=pa;this.Uj=Hb;this.KJ=Ob}get u4(){return 0}serialize(){const pa=new Re.a(4,this.Yc,this.Uj,null,null,null,null,this.KJ);return new vb(this.metadata.packetId,this.metadata.clientId,1,5,pa,null,void 0,void 0,void 0,void 0,void 0,void 0,void 0,this.metadata.strictlySequentialId)}static create(pa){const Hb=
pa.sW;return new Oc(Hb.PYa,Hb.Keb,Hb.KJ,Ed.create(pa))}static yGm(pa,Hb){return 4!==pa.type?null:new Oc(pa.bgc.Yc,pa.bgc.Uj,pa.KJ,Hb)}}Object(f.a)(Oc,"RttDeleteParagraphOp",zf,[760,781]);class Cd extends zf{constructor(pa,Hb,Ob,Dc,nd,Od,ye,Oe){super(5,Oe);this.bOg=pa;this.wZj=Hb;this.kEp=Ob;this.Sfp=Dc;this.KJ=nd;this.tak=Od;this.Qyc=ye}get Yc(){return this.bOg}get Uj(){return this.wZj}get u4(){return this.bOg===this.tak?this.Qyc:0}serialize(){const pa=new Re.a(5,this.bOg,this.wZj,null,this.kEp,this.Sfp,
null,this.KJ),Hb=new Pc(this.tak,this.Qyc);return new vb(this.metadata.packetId,this.metadata.clientId,1,6,pa,null,void 0,void 0,void 0,Hb,void 0,void 0,void 0,this.metadata.strictlySequentialId)}static create(pa){const Hb=pa.sW,Ob=pa.Ecd;return new Cd(Hb.PYa,Hb.Keb,Hb.IMa,Hb.Pyc,Hb.KJ,Ob.Xhg,Ob.Qyc,Ed.create(pa))}static zGm(pa,Hb){return 2!==pa.type?null:new Cd(pa.iua.Yc,pa.iua.Uj,pa.uYa.Yc,pa.uYa.Uj,pa.KJ,pa.Qie.Yc,pa.Qie.Uj,Hb)}}Object(f.a)(Cd,"RttMergeParagraphOp",zf,[760,781]);class Ve{constructor(pa,
Hb,Ob,Dc,nd,Od){this.HOc=this.Yh=null;this.Dia=!1;this.Z$e=this.ZGh=0;this.QMd=this.nIh=!1;this.j6e=0;this.Lfg=()=>{l.ULS.sendTraceTag(8245954,355,50,"All prerequisites ready for RttSendManager");this.Yh=this.tO.result;this.Yh.Jse(this)};this.Xkj=(ye,Oe)=>{if(this.Yh&&(m.AFrameworkApplication.vd("i100g733;fbhi3553"),!(m.AFrameworkApplication.J.getBooleanFeatureGate("StopRTTMessageWhenAlone",!1)&&this.San()||2!==this.Yh.connectionState)&&(ye=Oe.YG,ye.length)))if(Oe.S$)100>this.Z$e&&(this.Z$e++,l.ULS.sendTraceTag(8270467,
355,50,"Blocking send. Reason: {0} OverallSends: {1} OverallBlocked: {2}",Oe.Sal,this.ZGh,this.Z$e));else{for(Oe=0;Oe<ye.length;Oe++)if(!this.Rqn(ye[Oe]))return;for(Oe=0;Oe<ye.length;Oe++){const Cf=ye[Oe];this.MBh.TWk(Cf,!Cf.type&&!Oe)}this.HOc||this.ykj(this.HOc,this.Yh)}};this.tO=pa;this.MBh=Hb;this.cjb=Ob;this.Ky=Dc;this.zya=nd;this.r$b=Od}get Dn(){return this.cjb.value}init(){return this.tO?this.tO.continueWith(this.Lfg):E.Task.X6(!1)}start(){this.Dia||(this.Ky.$c?(this.Ky.$c.YG.Q_k(this.Xkj),
this.Dia=!0):l.ULS.sendTraceTag(522740420,355,10,"No activePage, RttSendManager not started"))}stop(){this.Dia&&(this.Dia=!1,this.Ky.$c.YG.jyo(this.Xkj))}San(){return this.Dn&&this.Dn.gA.ILa?!0:!1}Rqn(pa){return pa&&-1!==pa.KJ?pa.type&&3!==pa.type&&1!==pa.type?!1:!0:!1}xCn(){this.QMd||(this.nIh||(l.ULS.sendTraceTag(8270468,355,50,"Preparing to send RTT change"),this.nIh=!0),!this.QMd&&5>=this.j6e&&this.j6e++)}LCn(){!this.QMd&&5>=this.j6e&&(l.ULS.sendTraceTag(8270469,355,50,"Sent Rtt Message"),this.QMd=
!0)}ykj(pa,Hb){this.xCn();pa&&(pa.fj||pa.kp)&&l.ULS.sendTraceTag(8245956,355,15,"Task is faulted or cancelled with exception {0}",pa.vk);this.r$b.Txj();(pa=this.AGm(this.MBh.Cym()))?(this.ZGh++,this.HOc=Hb.fC(3,gh(pa.serialize())),this.LCn(),this.r$b.npg(0),this.HOc.continueWith(Ob=>{this.ykj(Ob,Hb)})):this.HOc=null}AGm(pa){if(!pa)return null;if(!this.Dn)return l.ULS.sendTraceTag(8245957,355,15,"GetParagraphAnchoredOpFromGraphTransactionOperation: CoAuth manager is null"),null;const Hb=new Ed(Li.instance.cBi(),
this.Dn.Bj,1,0,0,id.instance.Tym());let Ob=null;switch(pa.type){case 0:Ob=ak.AFm(pa,Hb,this.zya);break;case 4:Ob=Oc.yGm(pa,Hb);break;case 3:Ob=ne.xGm(pa,Hb);break;case 2:Ob=Cd.zGm(pa,Hb);break;case 1:Ob=Zd.BGm(pa,Hb,this.zya)}return Ob}}Object(f.a)(Ve,"RttSendManager",null,[757]);class Fd{constructor(){this.W=null;this.twm=()=>qb.a.ud()&&qb.a.ud().Ak?qb.a.ud().Ak:(l.ULS.sendTraceTag(7866377,304,15,"Unable to get the lock manager"),null)}get name(){return"WordEditor.RealTimeTyping"}uc(pa){const Hb=
Na.a.Yp(pa.Ra(18)),Ob=Na.a.Yp(pa.Ra(12)),Dc=Na.a.Yp(pa.Ra(181)),nd=Na.a.Yp(pa.Ra(1244)),Od=Na.a.Yp(pa.Ra(266));this.W=pa;const ye=new Tj.a;E.Task.WAA.call(null,Hb,Ob,Dc,nd,Od).continueWith(()=>{pa.ia(1650,()=>new If(pa.resolve(322),pa.resolve(18),ye,pa.resolve(1244))).ha();pa.register(bm,"WordEditor.RttPerfCounter").as(1651).ha().Sd(()=>new bm(Je.a.Ge,kn.a.TG(17,1,new Jl.a(new Zm.a(.25)))));pa.ia(1652,()=>new lj(pa.resolve(1650),new Uk(bl.a.instance),new W.a(this.twm),new W.a(()=>ra.a.nV),pa.resolve(440),
pa.resolve(543).aD(),new W.a(()=>Ra.StaticActiveAppFrame.za().kb&&Ra.StaticActiveAppFrame.za().kb.$c?Ra.StaticActiveAppFrame.za().kb.$c.td:(l.ULS.sendTraceTag(522740419,304,10,"No activePage or workspace."),null)),Ib.a.instance,()=>Date.now(),pa.resolve(1244),bl.a.instance,pa.Ra(181),ff.aD(),ye,m.AFrameworkApplication.J.$("WordEditorThrottleAndBatchRTTRendering"),pa.resolve(1651),new Kl,pa.Ra(1638),pa.resolve(266),pa.resolve(76),pa.resolve(114).Ohc)).as(682).ha();pa.ia(1653,()=>new Ve(pa.resolve(543).aD(),
new kc,new W.a(()=>qb.a.ud()),Ra.StaticActiveAppFrame.za().kb,pa.resolve(1244),pa.resolve(1651))).ha();this.ITf()})}ITf(){this.W.resolve(1652).init();this.W.resolve(1653).init()}init(){}dispose(){}static main(){ia.a.instance.Lc(new Fd)}}Object(f.a)(Fd,"WordEditorRealTimeTypingPackage",null,[0,1]);Type.registerNamespace("BPr");Type.registerNamespace("Box4.Presence");Type.registerNamespace("RealtimePresenceUI");Type.registerNamespace("WERTT");Type.registerNamespace("WordEditor.PeoplesWellControl");
Type.registerNamespace("WordEditor.Presence");null!=m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.LoadRtcFrom1JS",!1)?Promise.all([d.e(4),d.e(2),d.e(10)]).then(d.bind(null,2116)).then(pa=>pa.initRealtimechannel()):Type.registerNamespace("AppRealtimeChannel");Type.registerNamespace("Common.App.CoauthTelemetry");ya.main();Type.registerNamespace("Common.App.CollabControls");Ta.prototype.toString=Ca.a.prototype.toString;zb.prototype.toString=Ca.a.prototype.toString;
ia.a.instance.Lc(new il);Fd.main();Type.registerNamespace("RealtimePresenceUI");ia.a.instance.Lc(new Ie);Type.registerNamespace("Common.App.RtcHostNotificationSubscription");va.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/22495436/wdjs/WordEditorDS.collab.js.map