var wacBoot=function(t){function n(n){for(var e,r,o=n[0],a=n[1],s=0,c=[];s<o.length;s++)r=o[s],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&c.push(i[r][0]),i[r]=0;for(e in a)Object.prototype.hasOwnProperty.call(a,e)&&(t[e]=a[e]);for(u&&u(n);c.length;)c.shift()()}var e={},i={1:0};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.e=function(t){var n=[],e=i[t];if(0!==e)if(e)n.push(e[2]);else{var o=new Promise((function(n,r){e=i[t]=[n,r]}));n.push(e[2]=o);var a,s=document.createElement("script");s.charset="utf-8",s.timeout=120,r.nc&&s.setAttribute("nonce",r.nc),s.src=function(t){return r.p+""+({0:"pasLogger"}[t]||t)+".min.js"}(t),0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous");var u=new Error;a=function(n){s.onerror=s.onload=null,clearTimeout(c);var e=i[t];if(0!==e){if(e){var r=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;u.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",u.name="ChunkLoadError",u.type=r,u.request=o,e[1](u)}i[t]=void 0}};var c=setTimeout((function(){a({type:"timeout",target:s})}),12e4);s.onerror=s.onload=a,document.head.appendChild(s)}return Promise.all(n)},r.m=t,r.c=e,r.d=function(t,n,e){r.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,n){if(1&n&&(t=r(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)r.d(e,i,function(n){return t[n]}.bind(null,i));return e},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="",r.oe=function(t){throw console.error(t),t};var o=window.wacBootChunks=window.wacBootChunks||[],a=o.push.bind(o);o.push=n,o=o.slice();for(var s=0;s<o.length;s++)n(o[s]);var u=a;return r(r.s=19)}([function(t,n,e){"use strict";e.r(n);var i=window.__foldables_env_vars__,r=function(){function t(t,n,e,i,r){void 0===r&&(r=!1),this.left=t,this.right=t+e,this.top=n,this.bottom=n+i,this.x=t,this.y=n,this.width=e,this.height=i,this.pixelDepth=0,this.devicePixelRatio=0,this.isOccluded=r}return t.prototype.toJSON=function(){return JSON.stringify(this)},t}();function o(){"function"!=typeof window.CustomEvent&&(window.CustomEvent=function(t,n){var e=n||{bubbles:!1,cancelable:!1,detail:null},i=document.createEvent("CustomEvent");return i.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),i}),"function"!=typeof window.DOMRect&&(window.DOMRect=function(t){return{x:0,y:0,width:window.innerWidth,height:window.innerHeight}}),"object"!=typeof window.onBoundingWindowRectsChange&&(window.onBoundingWindowRectsChange=new CustomEvent("onBoundingWindowRectsChange",{bubbles:!1,cancelable:!1}),window.addEventListener("resize",a)),"function"!=typeof window.getWindowSegments&&(window.getWindowSegments=function(){var t=window.innerWidth,n=window.innerHeight;try{if(window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")){if(window.matchMedia&&window.matchMedia("(orientation: portrait)").matches&&n>=1300&&964===t)return i&&i.update({spanning:"single-fold-horizontal"}),[new r(0,0,t,n/2),new r(0,n/2,t,n/2)];if(window.matchMedia&&window.matchMedia("(orientation: landscape)").matches&&n>=820&&1440===t)return i&&i.update({spanning:"single-fold-vertical"}),[new r(0,0,t/2,n),new r(t/2,0,t/2,n)];i&&i.update({spanning:"none"})}}catch(t){}return[new r(0,0,t,n)]})}function a(){window.dispatchEvent(window.onBoundingWindowRectsChange)}function s(){Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw TypeError('"this" is null or not defined');var n=Object(this),e=n.length>>>0;if("function"!=typeof t)throw TypeError("predicate must be a function");for(var i=arguments[1],r=0;r<e;){var o=n[r];if(t.call(i,o,r,n))return o;r+=1}},configurable:!0,writable:!0})}function u(){"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t,n){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i+=1){var r=arguments[i];if(null!=r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},writable:!0,configurable:!0})}var c={},l={},f={},d={Small:{Portrait:720,Landscape:960,DP:1440,DL:1920},Large:{Portrait:721,Landscape:961,DP:1441,DL:1921}},h=[],v=void 0,m=-1,p="Undefined",b="Default",w=!1;function g(){var t;return null===(t=null===window||void 0===window?void 0:window.matchMedia)||void 0===t?void 0:t.call(window,"(prefers-reduced-motion: reduce)").matches}function y(){return"DP"===N()}function S(){return"DL"===N()}function C(t){return x(t,0)}function x(t,n){if(t&&h&&!(h.length<=0)){if(1===h.length)return R(h[0],n);var e;if("string"==typeof t){var i=document.querySelector(t);if(!i)return;e=i.getBoundingClientRect()}else if(void 0!==t.preventDefault){var o=t;e=new r(o.clientX,o.clientY,1,1)}else if(t.getBoundingClientRect)e=t.getBoundingClientRect();else if(t.current)e=t.current.getBoundingClientRect();else{if(!t)return;var a=t;e=new r(a.x,a.y,1,1)}var s=O(e);return s&&R(s,n)}}function k(t,n){return x(t,8)}function R(t,n){return u(),t&&Object.assign({},t,{top:t.top+n,left:t.left+n,right:t.right-n,bottom:t.bottom-n,width:t.width-2*n,height:t.height-2*n})}function O(t){return A(t)?h[0]:(s(),h.find((function(n){return _(t,n)})))}function _(t,n){return t.left>=n.left&&t.top>=n.top&&t.right<=n.left+n.width&&t.bottom<=n.top+n.height}function P(t){return void 0!==t&&("DL"===N()||"DP"===N())&&A(t.getBoundingClientRect())}function A(t){return!(h.length<=1)&&(t.right>h[0].left+h[0].width?t.left<h[1].left:t.bottom>h[0].top+h[0].height&&t.top<h[1].top)}function E(t,n){if(h.length<=1)return-1;if(n){if(t.left<h[1].left)return t.right-h[0].right;if(t.top<h[1].top)return t.bottom-h[0].bottom}else{if(t.right>h[0].left+h[0].width)return h[1].left-t.left;if(t.bottom>h[0].top+h[0].height)return h[1].top-t.top}return-1}function L(t,n){c[t]=n}function W(t){void 0!==c[t]&&delete c[t]}function I(t,n){l[t]=n}function D(t){void 0!==l[t]&&delete l[t]}function F(t,n){f[t]=n}function T(t){void 0!==f[t]&&delete f[t]}function j(){window.getWindowSegments||o();var t=window.getWindowSegments(),n=!1;if(t.length!==h.length&&(n=!0),1===(h=t).length){var e=h[0];p=e.width>e.height?"Landscape":"Portrait"}else h.length<=1||h[0].top!==h[1].top?h.length<=1||h[0].left!==h[1].left||(n=n||"DP"===p,p="DL"):(n=n||"DL"===p,p="DP");var i=b;"Landscape"===p||"DL"===p?b=h[0].width<=960?"Small":"Large":"Portrait"!==p&&"DP"!==p||(b=h[0].width<=720?"Small":"Large"),function(){var t=h;for(var n in v&&t.push(v),l)l[n](t,p)}(),n&&function(t){for(var n in c)c[n](t,p)}("DL"===p||"DP"===p),i!==b&&function(){for(var t in f)f[t](b)}()}function N(){if("Undefined"===p){var t=window.getWindowSegments?window.getWindowSegments():void 0;return!t||t.length<=1?window.innerWidth>window.innerHeight?"Landscape":"Portrait":window.innerWidth>window.innerHeight?"DP":"DL"}return p}function M(){return b}function B(){return v}function V(){return h}function U(){w||("undefined"!=typeof navigator&&navigator.virtualKeyboard&&void 0!==navigator.virtualKeyboard.overlaysContent&&(window===top&&(navigator.virtualKeyboard.overlaysContent=!0),navigator.virtualKeyboard.addEventListener("overlaygeometrychange",H)),o(),window.addEventListener("onBoundingWindowRectsChange",j),h&&0!==h.length||j(),w=!0)}function H(t){var n=t.boundingRect,e=n.width,i=n.height,r=n.left;0===e||0===i?(v=void 0,m=-1):((v=t.boundingRect).isOccluded=!0,m=r>0||"DL"===N()?1:0),j()}function z(){if(v)return h[m]}U(),e.d(n,"WindowSegment",(function(){return r})),e.d(n,"ensureWindowsAPIs",(function(){return o})),e.d(n,"arrayFindPolyfill",(function(){return s})),e.d(n,"objectAssignPolyfill",(function(){return u})),e.d(n,"LayoutBreakpointSizes",(function(){return d})),e.d(n,"isReducedAnimations",(function(){return g})),e.d(n,"isDPMode",(function(){return y})),e.d(n,"isDLMode",(function(){return S})),e.d(n,"getBoundingWindow",(function(){return C})),e.d(n,"getBoundingWindowWithPadding",(function(){return x})),e.d(n,"getBoundingWindowWithPaddingFabric",(function(){return k})),e.d(n,"getBoundingRect",(function(){return O})),e.d(n,"isRectWithin",(function(){return _})),e.d(n,"isElementSpanning",(function(){return P})),e.d(n,"isRectSpanning",(function(){return A})),e.d(n,"getRectSpanningOffset",(function(){return E})),e.d(n,"registerSpanningChanged",(function(){return L})),e.d(n,"unregisterSpanningChanged",(function(){return W})),e.d(n,"registerBoundingWindowRectsChanged",(function(){return I})),e.d(n,"unregisterBoundingWindowRectsChanged",(function(){return D})),e.d(n,"registerLayoutBreakpointChanged",(function(){return F})),e.d(n,"unregisterLayoutBreakpointChanged",(function(){return T})),e.d(n,"onWindowRectsChange",(function(){return j})),e.d(n,"getWindowMode",(function(){return N})),e.d(n,"getLayoutBreakpoint",(function(){return M})),e.d(n,"getKeyboardSegment",(function(){return B})),e.d(n,"getWindowRectsWithoutKeyboard",(function(){return V})),e.d(n,"initializeBaseWindowUtil",(function(){return U})),e.d(n,"getWindowRectForKeyboardSegment",(function(){return z}))},function(t,n,e){"use strict";e.r(n),e.d(n,"__extends",(function(){return r})),e.d(n,"__assign",(function(){return o})),e.d(n,"__rest",(function(){return a})),e.d(n,"__decorate",(function(){return s})),e.d(n,"__param",(function(){return u})),e.d(n,"__esDecorate",(function(){return c})),e.d(n,"__runInitializers",(function(){return l})),e.d(n,"__propKey",(function(){return f})),e.d(n,"__setFunctionName",(function(){return d})),e.d(n,"__metadata",(function(){return h})),e.d(n,"__awaiter",(function(){return v})),e.d(n,"__generator",(function(){return m})),e.d(n,"__createBinding",(function(){return p})),e.d(n,"__exportStar",(function(){return b})),e.d(n,"__values",(function(){return w})),e.d(n,"__read",(function(){return g})),e.d(n,"__spread",(function(){return y})),e.d(n,"__spreadArrays",(function(){return S})),e.d(n,"__spreadArray",(function(){return C})),e.d(n,"__await",(function(){return x})),e.d(n,"__asyncGenerator",(function(){return k})),e.d(n,"__asyncDelegator",(function(){return R})),e.d(n,"__asyncValues",(function(){return O})),e.d(n,"__makeTemplateObject",(function(){return _})),e.d(n,"__importStar",(function(){return A})),e.d(n,"__importDefault",(function(){return E})),e.d(n,"__classPrivateFieldGet",(function(){return L})),e.d(n,"__classPrivateFieldSet",(function(){return W})),e.d(n,"__classPrivateFieldIn",(function(){return I}));var i=function(t,n){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(t,n)};function r(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}i(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}var o=function(){return(o=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)};function a(t,n){var e={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(e[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)n.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(e[i[r]]=t[i[r]])}return e}function s(t,n,e,i){var r,o=arguments.length,a=o<3?n:null===i?i=Object.getOwnPropertyDescriptor(n,e):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,n,e,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(n,e,a):r(n,e))||a);return o>3&&a&&Object.defineProperty(n,e,a),a}function u(t,n){return function(e,i){n(e,i,t)}}function c(t,n,e,i,r,o){function a(t){if(void 0!==t&&"function"!=typeof t)throw new TypeError("Function expected");return t}for(var s,u=i.kind,c="getter"===u?"get":"setter"===u?"set":"value",l=!n&&t?i.static?t:t.prototype:null,f=n||(l?Object.getOwnPropertyDescriptor(l,i.name):{}),d=!1,h=e.length-1;h>=0;h--){var v={};for(var m in i)v[m]="access"===m?{}:i[m];for(var m in i.access)v.access[m]=i.access[m];v.addInitializer=function(t){if(d)throw new TypeError("Cannot add initializers after decoration has completed");o.push(a(t||null))};var p=(0,e[h])("accessor"===u?{get:f.get,set:f.set}:f[c],v);if("accessor"===u){if(void 0===p)continue;if(null===p||"object"!=typeof p)throw new TypeError("Object expected");(s=a(p.get))&&(f.get=s),(s=a(p.set))&&(f.set=s),(s=a(p.init))&&r.push(s)}else(s=a(p))&&("field"===u?r.push(s):f[c]=s)}l&&Object.defineProperty(l,i.name,f),d=!0}function l(t,n,e){for(var i=arguments.length>2,r=0;r<n.length;r++)e=i?n[r].call(t,e):n[r].call(t);return i?e:void 0}function f(t){return"symbol"==typeof t?t:"".concat(t)}function d(t,n,e){return"symbol"==typeof n&&(n=n.description?"[".concat(n.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:e?"".concat(e," ",n):n})}function h(t,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,n)}function v(t,n,e,i){return new(e||(e=Promise))((function(r,o){function a(t){try{u(i.next(t))}catch(t){o(t)}}function s(t){try{u(i.throw(t))}catch(t){o(t)}}function u(t){var n;t.done?r(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,s)}u((i=i.apply(t,n||[])).next())}))}function m(t,n){var e,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(e=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,i=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=n.call(t,a)}catch(t){s=[6,t],i=0}finally{e=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}var p=Object.create?function(t,n,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(n,e);r&&!("get"in r?!n.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,r)}:function(t,n,e,i){void 0===i&&(i=e),t[i]=n[e]};function b(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||p(n,t,e)}function w(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function g(t,n){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var i,r,o=e.call(t),a=[];try{for(;(void 0===n||n-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(r)throw r.error}}return a}function y(){for(var t=[],n=0;n<arguments.length;n++)t=t.concat(g(arguments[n]));return t}function S(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var i=Array(t),r=0;for(n=0;n<e;n++)for(var o=arguments[n],a=0,s=o.length;a<s;a++,r++)i[r]=o[a];return i}function C(t,n,e){if(e||2===arguments.length)for(var i,r=0,o=n.length;r<o;r++)!i&&r in n||(i||(i=Array.prototype.slice.call(n,0,r)),i[r]=n[r]);return t.concat(i||Array.prototype.slice.call(n))}function x(t){return this instanceof x?(this.v=t,this):new x(t)}function k(t,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=e.apply(t,n||[]),o=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(t){r[t]&&(i[t]=function(n){return new Promise((function(e,i){o.push([t,n,e,i])>1||s(t,n)}))})}function s(t,n){try{(e=r[t](n)).value instanceof x?Promise.resolve(e.value.v).then(u,c):l(o[0][2],e)}catch(t){l(o[0][3],t)}var e}function u(t){s("next",t)}function c(t){s("throw",t)}function l(t,n){t(n),o.shift(),o.length&&s(o[0][0],o[0][1])}}function R(t){var n,e;return n={},i("next"),i("throw",(function(t){throw t})),i("return"),n[Symbol.iterator]=function(){return this},n;function i(i,r){n[i]=t[i]?function(n){return(e=!e)?{value:x(t[i](n)),done:!1}:r?r(n):n}:r}}function O(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,e=t[Symbol.asyncIterator];return e?e.call(t):(t=w(t),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(e){n[e]=t[e]&&function(n){return new Promise((function(i,r){!function(t,n,e,i){Promise.resolve(i).then((function(n){t({value:n,done:e})}),n)}(i,r,(n=t[e](n)).done,n.value)}))}}}function _(t,n){return Object.defineProperty?Object.defineProperty(t,"raw",{value:n}):t.raw=n,t}var P=Object.create?function(t,n){Object.defineProperty(t,"default",{enumerable:!0,value:n})}:function(t,n){t.default=n};function A(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var e in t)"default"!==e&&Object.prototype.hasOwnProperty.call(t,e)&&p(n,t,e);return P(n,t),n}function E(t){return t&&t.__esModule?t:{default:t}}function L(t,n,e,i){if("a"===e&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof n?t!==n||!i:!n.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===e?i:"a"===e?i.call(t):i?i.value:n.get(t)}function W(t,n,e,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof n?t!==n||!r:!n.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(t,e):r?r.value=e:n.set(t,e),e}function I(t,n){if(null===n||"object"!=typeof n&&"function"!=typeof n)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof t?n===t:t.has(n)}},,,,,,function(t,n,e){"use strict";e.r(n);var i=function(){function t(t){this.regionComposerRootClassName="regionComposerRoot",this.regionElements={},this.positioningElements={Top:void 0,Left:void 0,Right:void 0,Bottom:void 0},this.positionCounts={Top:0,Left:0,Right:0,Bottom:0};var n=t.container,e=t.styleSheet;this.containerElement=n,this.styleSheet=e,void 0===this.styleSheet.ownerRule&&0===this.styleSheet.cssRules.length&&this.styleSheet.parentStyleSheet&&!this.styleSheet.parentStyleSheet.parentStyleSheet&&1===this.styleSheet.parentStyleSheet.cssRules.length?((this.styleSheet.parentStyleSheet||this.styleSheet).insertRule(".".concat(this.regionComposerRootClassName,"{display: grid; position: absolute; width: 100%; height: 100%; z-index: 1;}"),0),this.containerElement&&(this.dockPanel=document.createElement("div"),this.dockPanel.classList.add(this.regionComposerRootClassName),this.addPositioningElements(this.dockPanel),this.containerElement.appendChild(this.dockPanel))):this.containerElement&&(this.dockPanel=this.containerElement,this.getPositioningElements(this.dockPanel)),this.styleSheet.insertRule(".".concat(this.regionComposerRootClassName,"{}"),0),this.regionComposerRootStyle=this.styleSheet.cssRules[0]}return t.prototype.dispose=function(){this.positionCounts={Top:0,Left:0,Right:0,Bottom:0},this.regionElements={},this.containerElement&&this.dockPanel&&this.containerElement.removeChild(this.dockPanel),this.dockPanel=void 0,this.containerElement=void 0},t.prototype.addRegion=function(t){if(this.dockPanel){var n,e=this.styleSheet.insertRule(".".concat(t.id,"{display:block;}"),this.styleSheet.cssRules.length),i=this.regionElements[t.id];this.containerElement&&((i=i||this.containerElement.querySelector(".".concat(t.id)))?n=i:(n=document.createElement("div")).classList.add(t.id));var r=this.getGridArea(t.position,!1);return this.updateTemplate(t.position),void 0!==this.lastChildIndex&&this.lastChildOriginalGridArea&&(this.styleSheet.cssRules[this.lastChildIndex].style.gridArea=this.lastChildOriginalGridArea),this.lastChildOriginalGridArea=r,r=this.getGridArea(t.position,!0),this.styleSheet.cssRules[e].style.gridArea=r,n&&!i&&(this.appendRegion(t.position,n),this.regionElements[t.id]=n),this.lastChildIndex=e,this.positionCounts[t.position]=this.positionCounts[t.position]+1,n}},t.prototype.updateTemplate=function(t){if(this.dockPanel)switch(t){case"Top":var n="repeat(".concat(this.positionCounts.Top+1,", min-content) 1fr repeat(").concat(Math.max(1,this.positionCounts.Bottom),", min-content)");return void(this.regionComposerRootStyle?this.regionComposerRootStyle.style.gridTemplateRows=n:this.styleSheet.insertRule(".".concat(this.regionComposerRootClassName,"{grid-template-rows: ").concat(n),this.styleSheet.cssRules.length));case"Left":return n="repeat(".concat(this.positionCounts.Left+1,", min-content) 1fr repeat(").concat(Math.max(1,this.positionCounts.Right),", min-content)"),void(this.regionComposerRootStyle?this.regionComposerRootStyle.style.gridTemplateColumns=n:this.styleSheet.insertRule(".".concat(this.regionComposerRootClassName,"{grid-template-columns: ").concat(n),this.styleSheet.cssRules.length));case"Right":return n="repeat(".concat(Math.max(1,this.positionCounts.Left),", min-content) 1fr repeat(").concat(this.positionCounts.Right+1,", min-content)"),void(this.regionComposerRootStyle?this.regionComposerRootStyle.style.gridTemplateColumns=n:this.styleSheet.insertRule(".".concat(this.regionComposerRootClassName,"{grid-template-columns: ").concat(n),this.styleSheet.cssRules.length));case"Bottom":return n="repeat(".concat(Math.max(1,this.positionCounts.Top),", min-content) 1fr repeat(").concat(this.positionCounts.Bottom+1,", min-content)"),void(this.regionComposerRootStyle?this.regionComposerRootStyle.style.gridTemplateRows=n:this.styleSheet.insertRule(".".concat(this.regionComposerRootClassName,"{grid-template-rows: ").concat(n),this.styleSheet.cssRules.length))}},t.prototype.addPositioningElements=function(t){var n=this;Object.keys(this.positioningElements).forEach((function(e){var i=document.createElement("div");i.style.setProperty("display","none"),i.id=e,n.positioningElements[e]=i,t.appendChild(i)}))},t.prototype.getPositioningElements=function(t){var n=this;Object.keys(this.positioningElements).forEach((function(e){var i=t.querySelector("#".concat(e));i&&(n.positioningElements[e]=i)}))},t.prototype.appendRegion=function(t,n){var e=this.positioningElements[t];if(e){var i=e.parentNode;i&&!i.contains(n)&&(i.insertBefore(n,e.nextSibling),"Top"!==t&&"Left"!==t||(this.positioningElements[t]=n))}},t.prototype.getGridArea=function(t,n){if(!this.dockPanel)return"";switch(t){case"Top":return" ".concat(this.positionCounts.Top+1," / ").concat(this.positionCounts.Left+1," / ").concat(n?-1*(this.positionCounts.Bottom+1):this.positionCounts.Top+2," / ").concat(-1*(this.positionCounts.Right+1));case"Left":return" ".concat(this.positionCounts.Top+1," / ").concat(this.positionCounts.Left+1," / ").concat(-1*(this.positionCounts.Bottom+1)," / ").concat(n?-1*(this.positionCounts.Right+1):this.positionCounts.Left+2);case"Right":return"".concat(this.positionCounts.Top+1," / ").concat(-1*(this.positionCounts.Right+1)," / ").concat(-1*(this.positionCounts.Bottom+1)," / ").concat(n?this.positionCounts.Left+1:-1*(this.positionCounts.Right+2));case"Bottom":return" ".concat(-1*(this.positionCounts.Bottom+1)," / ").concat(this.positionCounts.Left+1," / ").concat(n?this.positionCounts.Top+1:-1*(this.positionCounts.Bottom+2)," / ").concat(-1*(this.positionCounts.Right+1))}},Object.defineProperty(t.prototype,"dockPanelRootElement",{get:function(){return this.dockPanel},enumerable:!1,configurable:!0}),t}(),r=e(0),o=function(){function t(t){var n=this;this.layoutRegions={Portrait:{Default:void 0,Small:void 0,Large:void 0},Landscape:{Default:void 0,Small:void 0,Large:void 0},DP:{Default:void 0,Small:void 0,Large:void 0},DL:{Default:void 0,Small:void 0,Large:void 0}},this.accountForKeyboardRegions={Portrait:{Default:void 0,Small:void 0,Large:void 0},Landscape:{Default:void 0,Small:void 0,Large:void 0},DP:{Default:void 0,Small:void 0,Large:void 0},DL:{Default:void 0,Small:void 0,Large:void 0}},this.regionContainers={},this.unsupportedRules=[],this.setOffsetForActiveAccountForKeyboardRegions=function(t){var e=t?void 0:n.getWindowRectForKeyboardSegment(),i="Undefined"===n.windowMode?"Landscape":n.windowMode,r=n.getAffectedAccountForKeyboardRegions(e,i,n.layoutBreakpoint);if(r){var o=e?e.top+e.height:0;r.forEach((function(e){if(t)e.style.marginBottom="0px";else{var i=e.getBoundingClientRect(),r=Math.max(0,n.keyboardSegment.height-(o-i.bottom));e.style.marginBottom="".concat(r,"px")}}))}},this.boundingWindowRectsChanged=function(t,e){var i=t.find((function(t){return!!t.isOccluded})),r=n.windowMode!==e||n.keyboardSegment!==i;n.setOffsetForActiveAccountForKeyboardRegions(!0),n.windowMode=e,n.keyboardSegment=i,n.render(r)},this.layoutBreakpointChanged=function(t){n.layoutBreakpoint=t,n.render(!0)},this.getWindowRectForKeyboardSegment=function(){if(n.keyboardSegment)return Object(r.getBoundingRect)(n.keyboardSegment)},this.props=t,this.windowMode=Object(r.getWindowMode)(),this.layoutBreakpoint=Object(r.getLayoutBreakpoint)(),this.keyboardSegment=Object(r.getKeyboardSegment)(),this.styleSheet=this.createStyleSheet(),this.createRegions(),Object(r.arrayFindPolyfill)(),Object(r.objectAssignPolyfill)(),Object(r.registerBoundingWindowRectsChanged)("regionComposer",this.boundingWindowRectsChanged),Object(r.registerLayoutBreakpointChanged)("regionComposer",this.layoutBreakpointChanged),this.render()}return t.prototype.render=function(t){var n=this;t&&(this.keyboardSegment?(void 0!==this.setOffsetRafId&&cancelAnimationFrame(this.setOffsetRafId),this.setOffsetRafId=requestAnimationFrame((function(){n.setOffsetForActiveAccountForKeyboardRegions(),d()}))):(void 0!==this.setOffsetRafId&&(cancelAnimationFrame(this.setOffsetRafId),this.setOffsetRafId=void 0),d()))},t.prototype.dispose=function(){var t=this;Object.keys(this.layoutRegions).forEach((function(n){Object.keys(t.layoutRegions[n]).forEach((function(e){var i=t.layoutRegions[n][e];i&&i.dispose()}))})),Object.keys(this.regionContainers).forEach((function(n){var e=t.regionContainers[n];e&&document.removeChild(e),t.regionContainers[n]=void 0})),Object(r.unregisterBoundingWindowRectsChanged)("regionComposer"),Object(r.unregisterLayoutBreakpointChanged)("regionComposer"),this.regionContainers={}},t.prototype.getRegion=function(t){return this.regionContainers[t]},t.prototype.createRegions=function(){var t=this,n=this.props.layoutCollection;Object.keys(n).forEach((function(e){var i=n[e];i&&t.createRegion(i,e)}));var e="";if(Object.keys(this.regionContainers).forEach((function(t){e+=".".concat(t,", ")})),e.length&&(e=e.substr(0,e.length-2),e+="{display: none; position: relative;}",this.styleSheet.insertRule(e,0)),this.styleElement){var i=this.styleSheet.cssRules;this.unsupportedRules=this.unsupportedRules.reverse();for(var r=0;r<i.length;r+=1){i[r].cssRules&&i[r].insertRule(e,0);var o="".concat(this.styleElement.innerHTML).concat(i[r].cssText);o.indexOf("@media not all")>=0&&this.unsupportedRules.length>0&&(o=o.replace("@media not all",this.unsupportedRules.pop())).replace(new RegExp("and (spanning: single-fold-.*)","g"),"{.multipleWindowRects"),this.styleElement.innerHTML=o,this.styleElement.innerHTML="".concat(this.styleElement.innerHTML).concat("")}this.styleSheet=this.styleElement.sheet}},t.prototype.createRegionContainer=function(t){if(this.regionContainers[t.id])return this.regionContainers[t.id];var n=document.createElement("div");return n.setAttribute("style","width: ".concat("Header"===t.id?"100vw":"100%","; height: 100%; display: flex; flex: auto;")),this.regionContainers[t.id]=n,n},t.prototype.createRegion=function(t,n){var e=this;Object.keys(t).forEach((function(r){var o=t[r];e.addSelectorForLayoutDefinition(e.styleSheet,n,r);var a=e.rootDockPanel||(e.props.dockPanelProps?e.props.dockPanelProps.container:void 0),s=new i(Object.assign(e.props.dockPanelProps,{container:a,styleSheet:e.getLastChild(e.styleSheet)}));o.forEach((function(t){var i=e.createRegionContainer(t),o=s.addRegion(t);o&&i&&!o.contains(i)&&o.appendChild(i),t.accountForKeyboard&&o&&(e.accountForKeyboardRegions[n][r]||(e.accountForKeyboardRegions[n][r]=[]),e.accountForKeyboardRegions[n][r].push(o))})),!e.rootDockPanel&&s.dockPanelRootElement&&(e.rootDockPanel=s.dockPanelRootElement),e.layoutRegions[n][r]=s}))},t.prototype.getLastChild=function(t){for(var n=t.cssRules[t.cssRules.length-1];n.cssRules&&n.cssRules.length>0;)n=n.cssRules[n.cssRules.length-1];return n.cssRules?n:n.parentStyleSheet},t.prototype.getAffectedAccountForKeyboardRegions=function(t,n,e){if(void 0===n&&(n="Landscape"),void 0===e&&(e="Default"),this.accountForKeyboardRegions){var i=this.accountForKeyboardRegions[n][e]||this.accountForKeyboardRegions[n].Default||void 0;return t&&i?i.filter((function(n){return Object(r.isRectWithin)(n.getBoundingClientRect(),t)})):i}},t.prototype.createStyleSheet=function(){return this.styleElement=document.createElement("style"),document.head.appendChild(this.styleElement),this.styleElement.sheet},t.prototype.addSelectorForLayoutDefinition=function(t,n,e){var i,o,a="Small"===e?"max-width":"Large"===e?"min-width":void 0;if("Portrait"===n||"Landscape"===n)i="@media only screen and (orientation: ".concat(n.toLowerCase(),") ").concat(a&&"Default"!==e?"and (".concat(a,": ").concat(r.LayoutBreakpointSizes[e][n],"px ){"):"{","}");else{var s=void 0,u=void 0;"DP"===n?(s="landscape",u="single-fold-vertical"):(s="portrait",u="single-fold-horizontal"),o="@media only screen and (orientation: ".concat(s,") and (spanning: ").concat(u,")"),this.unsupportedRules.push(o),i="".concat(o," ").concat(a&&"Default"!==e?"and (".concat(a,": ").concat(r.LayoutBreakpointSizes[e][n],"px ){"):"{","}")}t.insertRule(i,t.cssRules.length)},t}(),a=!1;function s(){return a}function u(t){var n;a=t&&!("undefined"!=typeof navigator&&(n=navigator.userAgent,/rv:11.0/i.test(n)||/Edge\//i.test(n)||/Safari/i.test(n)&&!/Chrome/i.test(n)&&!/Version\/[1-9][1-9]\.[0-9].*Safari/i.test(navigator.userAgent))),Object(r.initializeBaseWindowUtil)()}var c={};function l(t,n){c[t]=n}function f(t){void 0!==c[t]&&delete c[t]}function d(){for(var t in c)c[t]()}e.d(n,"RegionComposer",(function(){return o})),e.d(n,"shouldUseRegionComposer",(function(){return s})),e.d(n,"initializeWindowUtil",(function(){return u})),e.d(n,"registerAfterRegionsRendered",(function(){return l})),e.d(n,"unregisterAfterRegionsRendered",(function(){return f}))},function(t,n,e){
/*! @license DOMPurify 2.4.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.1/LICENSE */
t.exports=function(){"use strict";function t(n){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(n)}function n(t,e){return(n=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,e)}function e(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function i(t,r,o){return(i=e()?Reflect.construct:function(t,e,i){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return i&&n(o,i.prototype),o}).apply(null,arguments)}function r(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return o(t,void 0);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?o(t,void 0):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,i=new Array(n);e<n;e++)i[e]=t[e];return i}var a=Object.hasOwnProperty,s=Object.setPrototypeOf,u=Object.isFrozen,c=Object.getPrototypeOf,l=Object.getOwnPropertyDescriptor,f=Object.freeze,d=Object.seal,h=Object.create,v="undefined"!=typeof Reflect&&Reflect,m=v.apply,p=v.construct;m||(m=function(t,n,e){return t.apply(n,e)}),f||(f=function(t){return t}),d||(d=function(t){return t}),p||(p=function(t,n){return i(t,r(n))});var b,w=A(Array.prototype.forEach),g=A(Array.prototype.pop),y=A(Array.prototype.push),S=A(String.prototype.toLowerCase),C=A(String.prototype.toString),x=A(String.prototype.match),k=A(String.prototype.replace),R=A(String.prototype.indexOf),O=A(String.prototype.trim),_=A(RegExp.prototype.test),P=(b=TypeError,function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return p(b,n)});function A(t){return function(n){for(var e=arguments.length,i=new Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];return m(t,n,i)}}function E(t,n,e){e=e||S,s&&s(t,null);for(var i=n.length;i--;){var r=n[i];if("string"==typeof r){var o=e(r);o!==r&&(u(n)||(n[i]=o),r=o)}t[r]=!0}return t}function L(t){var n,e=h(null);for(n in t)m(a,t,[n])&&(e[n]=t[n]);return e}function W(t,n){for(;null!==t;){var e=l(t,n);if(e){if(e.get)return A(e.get);if("function"==typeof e.value)return A(e.value)}t=c(t)}return function(t){return console.warn("fallback value for",t),null}}var I=f(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),D=f(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),F=f(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),T=f(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),j=f(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),N=f(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),M=f(["#text"]),B=f(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),V=f(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),U=f(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),H=f(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),z=d(/\{\{[\w\W]*|[\w\W]*\}\}/gm),G=d(/<%[\w\W]*|[\w\W]*%>/gm),q=d(/\${[\w\W]*}/gm),J=d(/^data-[\-\w.\u00B7-\uFFFF]/),K=d(/^aria-[\-\w]+$/),X=d(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Q=d(/^(?:\w+script|data):/i),Y=d(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Z=d(/^html$/i),$=function(){return"undefined"==typeof window?null:window},tt=function(n,e){if("object"!==t(n)||"function"!=typeof n.createPolicy)return null;var i=null;e.currentScript&&e.currentScript.hasAttribute("data-tt-policy-suffix")&&(i=e.currentScript.getAttribute("data-tt-policy-suffix"));var r="dompurify"+(i?"#"+i:"");try{return n.createPolicy(r,{createHTML:function(t){return t},createScriptURL:function(t){return t}})}catch(t){return console.warn("TrustedTypes policy "+r+" could not be created."),null}};return function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$(),i=function(t){return n(t)};if(i.version="2.4.1",i.removed=[],!e||!e.document||9!==e.document.nodeType)return i.isSupported=!1,i;var o=e.document,a=e.document,s=e.DocumentFragment,u=e.HTMLTemplateElement,c=e.Node,l=e.Element,d=e.NodeFilter,h=e.NamedNodeMap,v=void 0===h?e.NamedNodeMap||e.MozNamedAttrMap:h,m=e.HTMLFormElement,p=e.DOMParser,b=e.trustedTypes,A=l.prototype,nt=W(A,"cloneNode"),et=W(A,"nextSibling"),it=W(A,"childNodes"),rt=W(A,"parentNode");if("function"==typeof u){var ot=a.createElement("template");ot.content&&ot.content.ownerDocument&&(a=ot.content.ownerDocument)}var at=tt(b,o),st=at?at.createHTML(""):"",ut=a,ct=ut.implementation,lt=ut.createNodeIterator,ft=ut.createDocumentFragment,dt=ut.getElementsByTagName,ht=o.importNode,vt={};try{vt=L(a).documentMode?a.documentMode:{}}catch(t){}var mt={};i.isSupported="function"==typeof rt&&ct&&void 0!==ct.createHTMLDocument&&9!==vt;var pt,bt,wt=z,gt=G,yt=q,St=J,Ct=K,xt=Q,kt=Y,Rt=X,Ot=null,_t=E({},[].concat(r(I),r(D),r(F),r(j),r(M))),Pt=null,At=E({},[].concat(r(B),r(V),r(U),r(H))),Et=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Lt=null,Wt=null,It=!0,Dt=!0,Ft=!1,Tt=!1,jt=!1,Nt=!1,Mt=!1,Bt=!1,Vt=!1,Ut=!1,Ht=!0,zt=!1,Gt="user-content-",qt=!0,Jt=!1,Kt={},Xt=null,Qt=E({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Yt=null,Zt=E({},["audio","video","img","source","image","track"]),$t=null,tn=E({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),nn="http://www.w3.org/1998/Math/MathML",en="http://www.w3.org/2000/svg",rn="http://www.w3.org/1999/xhtml",on=rn,an=!1,sn=null,un=E({},[nn,en,rn],C),cn=["application/xhtml+xml","text/html"],ln="text/html",fn=null,dn=a.createElement("form"),hn=function(t){return t instanceof RegExp||t instanceof Function},vn=function(n){fn&&fn===n||(n&&"object"===t(n)||(n={}),n=L(n),pt=pt=-1===cn.indexOf(n.PARSER_MEDIA_TYPE)?ln:n.PARSER_MEDIA_TYPE,bt="application/xhtml+xml"===pt?C:S,Ot="ALLOWED_TAGS"in n?E({},n.ALLOWED_TAGS,bt):_t,Pt="ALLOWED_ATTR"in n?E({},n.ALLOWED_ATTR,bt):At,sn="ALLOWED_NAMESPACES"in n?E({},n.ALLOWED_NAMESPACES,C):un,$t="ADD_URI_SAFE_ATTR"in n?E(L(tn),n.ADD_URI_SAFE_ATTR,bt):tn,Yt="ADD_DATA_URI_TAGS"in n?E(L(Zt),n.ADD_DATA_URI_TAGS,bt):Zt,Xt="FORBID_CONTENTS"in n?E({},n.FORBID_CONTENTS,bt):Qt,Lt="FORBID_TAGS"in n?E({},n.FORBID_TAGS,bt):{},Wt="FORBID_ATTR"in n?E({},n.FORBID_ATTR,bt):{},Kt="USE_PROFILES"in n&&n.USE_PROFILES,It=!1!==n.ALLOW_ARIA_ATTR,Dt=!1!==n.ALLOW_DATA_ATTR,Ft=n.ALLOW_UNKNOWN_PROTOCOLS||!1,Tt=n.SAFE_FOR_TEMPLATES||!1,jt=n.WHOLE_DOCUMENT||!1,Bt=n.RETURN_DOM||!1,Vt=n.RETURN_DOM_FRAGMENT||!1,Ut=n.RETURN_TRUSTED_TYPE||!1,Mt=n.FORCE_BODY||!1,Ht=!1!==n.SANITIZE_DOM,zt=n.SANITIZE_NAMED_PROPS||!1,qt=!1!==n.KEEP_CONTENT,Jt=n.IN_PLACE||!1,Rt=n.ALLOWED_URI_REGEXP||Rt,on=n.NAMESPACE||rn,n.CUSTOM_ELEMENT_HANDLING&&hn(n.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Et.tagNameCheck=n.CUSTOM_ELEMENT_HANDLING.tagNameCheck),n.CUSTOM_ELEMENT_HANDLING&&hn(n.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Et.attributeNameCheck=n.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),n.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof n.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Et.allowCustomizedBuiltInElements=n.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Tt&&(Dt=!1),Vt&&(Bt=!0),Kt&&(Ot=E({},r(M)),Pt=[],!0===Kt.html&&(E(Ot,I),E(Pt,B)),!0===Kt.svg&&(E(Ot,D),E(Pt,V),E(Pt,H)),!0===Kt.svgFilters&&(E(Ot,F),E(Pt,V),E(Pt,H)),!0===Kt.mathMl&&(E(Ot,j),E(Pt,U),E(Pt,H))),n.ADD_TAGS&&(Ot===_t&&(Ot=L(Ot)),E(Ot,n.ADD_TAGS,bt)),n.ADD_ATTR&&(Pt===At&&(Pt=L(Pt)),E(Pt,n.ADD_ATTR,bt)),n.ADD_URI_SAFE_ATTR&&E($t,n.ADD_URI_SAFE_ATTR,bt),n.FORBID_CONTENTS&&(Xt===Qt&&(Xt=L(Xt)),E(Xt,n.FORBID_CONTENTS,bt)),qt&&(Ot["#text"]=!0),jt&&E(Ot,["html","head","body"]),Ot.table&&(E(Ot,["tbody"]),delete Lt.tbody),f&&f(n),fn=n)},mn=E({},["mi","mo","mn","ms","mtext"]),pn=E({},["foreignobject","desc","title","annotation-xml"]),bn=E({},["title","style","font","a","script"]),wn=E({},D);E(wn,F),E(wn,T);var gn=E({},j);E(gn,N);var yn=function(t){var n=rt(t);n&&n.tagName||(n={namespaceURI:on,tagName:"template"});var e=S(t.tagName),i=S(n.tagName);return!!sn[t.namespaceURI]&&(t.namespaceURI===en?n.namespaceURI===rn?"svg"===e:n.namespaceURI===nn?"svg"===e&&("annotation-xml"===i||mn[i]):Boolean(wn[e]):t.namespaceURI===nn?n.namespaceURI===rn?"math"===e:n.namespaceURI===en?"math"===e&&pn[i]:Boolean(gn[e]):t.namespaceURI===rn?!(n.namespaceURI===en&&!pn[i])&&!(n.namespaceURI===nn&&!mn[i])&&!gn[e]&&(bn[e]||!wn[e]):!("application/xhtml+xml"!==pt||!sn[t.namespaceURI]))},Sn=function(t){y(i.removed,{element:t});try{t.parentNode.removeChild(t)}catch(n){try{t.outerHTML=st}catch(n){t.remove()}}},Cn=function(t,n){try{y(i.removed,{attribute:n.getAttributeNode(t),from:n})}catch(t){y(i.removed,{attribute:null,from:n})}if(n.removeAttribute(t),"is"===t&&!Pt[t])if(Bt||Vt)try{Sn(n)}catch(t){}else try{n.setAttribute(t,"")}catch(t){}},xn=function(t){var n,e;if(Mt)t="<remove></remove>"+t;else{var i=x(t,/^[\r\n\t ]+/);e=i&&i[0]}"application/xhtml+xml"===pt&&on===rn&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");var r=at?at.createHTML(t):t;if(on===rn)try{n=(new p).parseFromString(r,pt)}catch(t){}if(!n||!n.documentElement){n=ct.createDocument(on,"template",null);try{n.documentElement.innerHTML=an?"":r}catch(t){}}var o=n.body||n.documentElement;return t&&e&&o.insertBefore(a.createTextNode(e),o.childNodes[0]||null),on===rn?dt.call(n,jt?"html":"body")[0]:jt?n.documentElement:o},kn=function(t){return lt.call(t.ownerDocument||t,t,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT,null,!1)},Rn=function(t){return t instanceof m&&("string"!=typeof t.nodeName||"string"!=typeof t.textContent||"function"!=typeof t.removeChild||!(t.attributes instanceof v)||"function"!=typeof t.removeAttribute||"function"!=typeof t.setAttribute||"string"!=typeof t.namespaceURI||"function"!=typeof t.insertBefore||"function"!=typeof t.hasChildNodes)},On=function(n){return"object"===t(c)?n instanceof c:n&&"object"===t(n)&&"number"==typeof n.nodeType&&"string"==typeof n.nodeName},_n=function(t,n,e){mt[t]&&w(mt[t],(function(t){t.call(i,n,e,fn)}))},Pn=function(t){var n;if(_n("beforeSanitizeElements",t,null),Rn(t))return Sn(t),!0;if(_(/[\u0080-\uFFFF]/,t.nodeName))return Sn(t),!0;var e=bt(t.nodeName);if(_n("uponSanitizeElement",t,{tagName:e,allowedTags:Ot}),t.hasChildNodes()&&!On(t.firstElementChild)&&(!On(t.content)||!On(t.content.firstElementChild))&&_(/<[/\w]/g,t.innerHTML)&&_(/<[/\w]/g,t.textContent))return Sn(t),!0;if("select"===e&&_(/<template/i,t.innerHTML))return Sn(t),!0;if(!Ot[e]||Lt[e]){if(!Lt[e]&&En(e)){if(Et.tagNameCheck instanceof RegExp&&_(Et.tagNameCheck,e))return!1;if(Et.tagNameCheck instanceof Function&&Et.tagNameCheck(e))return!1}if(qt&&!Xt[e]){var r=rt(t)||t.parentNode,o=it(t)||t.childNodes;if(o&&r)for(var a=o.length-1;a>=0;--a)r.insertBefore(nt(o[a],!0),et(t))}return Sn(t),!0}return t instanceof l&&!yn(t)?(Sn(t),!0):"noscript"!==e&&"noembed"!==e||!_(/<\/no(script|embed)/i,t.innerHTML)?(Tt&&3===t.nodeType&&(n=t.textContent,n=k(n,wt," "),n=k(n,gt," "),n=k(n,yt," "),t.textContent!==n&&(y(i.removed,{element:t.cloneNode()}),t.textContent=n)),_n("afterSanitizeElements",t,null),!1):(Sn(t),!0)},An=function(t,n,e){if(Ht&&("id"===n||"name"===n)&&(e in a||e in dn))return!1;if(Dt&&!Wt[n]&&_(St,n));else if(It&&_(Ct,n));else if(!Pt[n]||Wt[n]){if(!(En(t)&&(Et.tagNameCheck instanceof RegExp&&_(Et.tagNameCheck,t)||Et.tagNameCheck instanceof Function&&Et.tagNameCheck(t))&&(Et.attributeNameCheck instanceof RegExp&&_(Et.attributeNameCheck,n)||Et.attributeNameCheck instanceof Function&&Et.attributeNameCheck(n))||"is"===n&&Et.allowCustomizedBuiltInElements&&(Et.tagNameCheck instanceof RegExp&&_(Et.tagNameCheck,e)||Et.tagNameCheck instanceof Function&&Et.tagNameCheck(e))))return!1}else if($t[n]);else if(_(Rt,k(e,kt,"")));else if("src"!==n&&"xlink:href"!==n&&"href"!==n||"script"===t||0!==R(e,"data:")||!Yt[t])if(Ft&&!_(xt,k(e,kt,"")));else if(e)return!1;return!0},En=function(t){return t.indexOf("-")>0},Ln=function(n){var e,r,o,a;_n("beforeSanitizeAttributes",n,null);var s=n.attributes;if(s){var u={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Pt};for(a=s.length;a--;){var c=e=s[a],l=c.name,f=c.namespaceURI;if(r="value"===l?e.value:O(e.value),o=bt(l),u.attrName=o,u.attrValue=r,u.keepAttr=!0,u.forceKeepAttr=void 0,_n("uponSanitizeAttribute",n,u),r=u.attrValue,!u.forceKeepAttr&&(Cn(l,n),u.keepAttr))if(_(/\/>/i,r))Cn(l,n);else{Tt&&(r=k(r,wt," "),r=k(r,gt," "),r=k(r,yt," "));var d=bt(n.nodeName);if(An(d,o,r)){if(!zt||"id"!==o&&"name"!==o||(Cn(l,n),r=Gt+r),at&&"object"===t(b)&&"function"==typeof b.getAttributeType)if(f);else switch(b.getAttributeType(d,o)){case"TrustedHTML":r=at.createHTML(r);break;case"TrustedScriptURL":r=at.createScriptURL(r)}try{f?n.setAttributeNS(f,l,r):n.setAttribute(l,r),g(i.removed)}catch(t){}}}}_n("afterSanitizeAttributes",n,null)}},Wn=function t(n){var e,i=kn(n);for(_n("beforeSanitizeShadowDOM",n,null);e=i.nextNode();)_n("uponSanitizeShadowNode",e,null),Pn(e)||(e.content instanceof s&&t(e.content),Ln(e));_n("afterSanitizeShadowDOM",n,null)};return i.sanitize=function(n){var r,a,u,l,f,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((an=!n)&&(n="\x3c!--\x3e"),"string"!=typeof n&&!On(n)){if("function"!=typeof n.toString)throw P("toString is not a function");if("string"!=typeof(n=n.toString()))throw P("dirty is not a string, aborting")}if(!i.isSupported){if("object"===t(e.toStaticHTML)||"function"==typeof e.toStaticHTML){if("string"==typeof n)return e.toStaticHTML(n);if(On(n))return e.toStaticHTML(n.outerHTML)}return n}if(Nt||vn(d),i.removed=[],"string"==typeof n&&(Jt=!1),Jt){if(n.nodeName){var h=bt(n.nodeName);if(!Ot[h]||Lt[h])throw P("root node is forbidden and cannot be sanitized in-place")}}else if(n instanceof c)1===(a=(r=xn("\x3c!----\x3e")).ownerDocument.importNode(n,!0)).nodeType&&"BODY"===a.nodeName||"HTML"===a.nodeName?r=a:r.appendChild(a);else{if(!Bt&&!Tt&&!jt&&-1===n.indexOf("<"))return at&&Ut?at.createHTML(n):n;if(!(r=xn(n)))return Bt?null:Ut?st:""}r&&Mt&&Sn(r.firstChild);for(var v=kn(Jt?n:r);u=v.nextNode();)3===u.nodeType&&u===l||Pn(u)||(u.content instanceof s&&Wn(u.content),Ln(u),l=u);if(l=null,Jt)return n;if(Bt){if(Vt)for(f=ft.call(r.ownerDocument);r.firstChild;)f.appendChild(r.firstChild);else f=r;return Pt.shadowroot&&(f=ht.call(o,f,!0)),f}var m=jt?r.outerHTML:r.innerHTML;return jt&&Ot["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&_(Z,r.ownerDocument.doctype.name)&&(m="<!DOCTYPE "+r.ownerDocument.doctype.name+">\n"+m),Tt&&(m=k(m,wt," "),m=k(m,gt," "),m=k(m,yt," ")),at&&Ut?at.createHTML(m):m},i.setConfig=function(t){vn(t),Nt=!0},i.clearConfig=function(){fn=null,Nt=!1},i.isValidAttribute=function(t,n,e){fn||vn({});var i=bt(t),r=bt(n);return An(i,r,e)},i.addHook=function(t,n){"function"==typeof n&&(mt[t]=mt[t]||[],y(mt[t],n))},i.removeHook=function(t){if(mt[t])return g(mt[t])},i.removeHooks=function(t){mt[t]&&(mt[t]=[])},i.removeAllHooks=function(){mt={}},i}()}()},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e(1);i.__exportStar(e(17),n),i.__exportStar(e(18),n)},,,,,,,,function(t,n,e){"use strict";var i;Object.defineProperty(n,"__esModule",{value:!0}),n.isChangeGateEnabled=n.setChangeGatesManager=void 0,n.setChangeGatesManager=function(t){i=t},n.isChangeGateEnabled=function(t){return!i||i.isChangeGateEnabled(t)}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0})},function(t,n,e){"use strict";e.r(n);var i=e(0),r=function(){function t(t){var n=this;this.accountForKeyboardRegionElements={Portrait:{Default:[],Small:[],Large:[]},Landscape:{Default:[],Small:[],Large:[]},DP:{Default:[],Small:[],Large:[]},DL:{Default:[],Small:[],Large:[]}},this.regionComposerRootId="regionComposerRoot",this.regionContainers={},this.setOffsetForActiveAccountForKeyboardRegions=function(t){var e=t?void 0:n.getWindowRectForKeyboardSegment(),i="Undefined"===n.windowMode?"Landscape":n.windowMode,r=n.getAffectedAccountForKeyboardRegions(e,i,n.layoutBreakpoint);if(r&&0!==r.length){var o=e?e.top+e.height:0;r.forEach((function(e){if(t)e.style.marginBottom="0px";else{var i=e.getBoundingClientRect(),r=Math.max(0,n.keyboardSegment.height-(o-i.bottom));e.style.marginBottom="".concat(r,"px")}}))}},this.boundingWindowRectsChanged=function(t,e){for(var i=void 0,r=t.length-1;r>=0;r-=1)if(t[r].isOccluded){i=t[r];break}var o=n.windowMode!==e||n.keyboardSegment!==i;n.setOffsetForActiveAccountForKeyboardRegions(!0),n.windowMode=e,n.keyboardSegment=i,n.render(o)},this.layoutBreakpointChanged=function(t){n.layoutBreakpoint=t,n.render(!0)},this.getWindowRectForKeyboardSegment=function(){if(n.keyboardSegment)return Object(i.getBoundingRect)(n.keyboardSegment)},this.props=t,this.windowMode=Object(i.getWindowMode)(),this.layoutBreakpoint=Object(i.getLayoutBreakpoint)(),this.keyboardSegment=Object(i.getKeyboardSegment)(),this.regionComposerRoot=this.getRegionComposer(),this.regionComposerRoot&&(t.container&&t.container.appendChild(this.regionComposerRoot),this.registerAccountForKeyboardRegionElements(),Object(i.registerBoundingWindowRectsChanged)("regionComposer",this.boundingWindowRectsChanged),Object(i.registerLayoutBreakpointChanged)("regionComposer",this.layoutBreakpointChanged),this.render())}return t.prototype.render=function(t){var n=this;t&&(this.keyboardSegment?(void 0!==this.setOffsetRafId&&cancelAnimationFrame(this.setOffsetRafId),this.setOffsetRafId=requestAnimationFrame((function(){n.setOffsetForActiveAccountForKeyboardRegions(),a()}))):(void 0!==this.setOffsetRafId&&(cancelAnimationFrame(this.setOffsetRafId),this.setOffsetRafId=void 0),a()))},t.prototype.dispose=function(){var t=this;Object.keys(this.regionContainers).forEach((function(n){var e=t.regionContainers[n];e&&document.removeChild(e),t.regionContainers[n]=void 0})),Object(i.unregisterBoundingWindowRectsChanged)("regionComposer"),Object(i.unregisterLayoutBreakpointChanged)("regionComposer"),this.regionContainers={}},t.prototype.getRegion=function(t){if(this.regionComposerRoot)return this.regionContainers[t]||(this.regionContainers[t]=this.regionComposerRoot.querySelector("[id=".concat(t,"Region]"))),this.regionContainers[t]},t.prototype.getRegionComposer=function(){return document.getElementById(this.regionComposerRootId)},t.prototype.registerAccountForKeyboardRegionElements=function(){var t=this,n=this.props.layoutCollection;Object.keys(n).forEach((function(e){var i=n[e];i&&t.registerAccountForKeyboardRegionElementsForRegionLayoutAndWindowMode(i,e)}))},t.prototype.registerAccountForKeyboardRegionElementsForRegionLayoutAndWindowMode=function(t,n){var e=this;Object.keys(t).forEach((function(i){var r;null===(r=t[i])||void 0===r||r.forEach((function(t){var r=e.getRegion(t.id);r&&e.accountForKeyboardRegionElements[n][i].push(r)}))}))},t.prototype.getAffectedAccountForKeyboardRegions=function(t,n,e){void 0===n&&(n="Landscape"),void 0===e&&(e="Default");var r=this.accountForKeyboardRegionElements[n][e]||this.accountForKeyboardRegionElements[n].Default||void 0;return t&&r&&0!==r.length?r.filter((function(n){return Object(i.isRectWithin)(n.getBoundingClientRect(),t)})):r},t}(),o={};function a(){for(var t in o)o[t]()}var s=void 0;function u(t){return s?s.getRegion(t):void 0}function c(){s&&(s.dispose(),s=void 0)}var l=function(){function t(){}return t.initialize=function(){t.ctrlWheelOccurred=!1,document.addEventListener("wheel",t.handleWheel)},t.stop=function(){document.removeEventListener("wheel",t.handleWheel)},t.handleWheel=function(n){n.ctrlKey&&(t.ctrlWheelOccurred=!0)},t}();l.initialize();var f,d={g_initialRequestMade:!1,g_initialRequestCompleted:!1,g_getCellsFromFrameRequest:void 0,g_getCellsUuid:void 0,g_initialRequestResponseObject:void 0,g_acquireLockStartTime:void 0,g_acquireLockEndTime:void 0,g_acquireLockRequestStatus:void 0,g_getDocumentStartTime:void 0,g_getDocumentEndTime:void 0,g_getDocumentRequestStatus:void 0,g_getCellsStartTime:void 0,g_getCellsEndTime:void 0,g_getInitializeLocalCobaltStartTime:void 0,g_getInitializeLocalCobaltEndTime:void 0,g_initialResponseTime:void 0,g_initialResponseReadyTime:void 0,g_fastViewOpenTime:void 0,g_initialRequestInvokedTime:void 0,g_onInitialResponseReady:void 0,g_isUserCreatingPersonalNotebookFirstTime:!1,g_networkType:void 0,g_bootSSRData:void 0,g_bootSSRHtmlStringLength:void 0},h={fastView:void 0,initialParaId:0,fastBootError:void 0},v=function(){function t(){}return t.getElement=function(t){if(this.DOMElements.hasOwnProperty(t))return this.DOMElements[t];var n=document.getElementById(t);return n?this.DOMElements[t]=n:null},t.removeElement=function(t){t&&this.DOMElements.hasOwnProperty(t.id)&&delete this.DOMElements[t.id],t&&t.parentNode&&t.parentNode.removeChild(t)},t.removeElementById=function(t){this.removeElement(this.getElement(t))},t.DOMElements={},t}(),m=function(){function t(){}return t.initialize=function(t,n,e,i,r,o,a,s,u,c,l,f,d,h,v,m,p){this.isViewMode=t&&!v,this.isEmbedMode=n,this.isInTouchMode="ontouchstart"in window,this.isSimplifiedReactRibbonInTreatment=e,this.isOldRibbonCollapsedCookieOn="false"!==C.getCookie(i).toLowerCase(),this.isSimplifiedRibbonCookieOn="false"!==C.getCookie(r).toLowerCase(),this.isNewHeaderShown=!this.isViewMode,this.isSimplifiedReactRibbonShown=this.isSimplifiedReactRibbonInTreatment&&this.isSimplifiedRibbonCookieOn&&!this.isViewMode,this.isOldRibbonExpandedAndShown=!this.isSimplifiedReactRibbonShown&&!this.isOldRibbonCollapsedCookieOn&&!this.isViewMode,this.isOldRibbonCollapsedAndShown=!this.isSimplifiedReactRibbonShown&&this.isOldRibbonCollapsedCookieOn&&!this.isViewMode,this.isViewModeAndRibbonPanelSmall=this.isViewMode&&this.isOldRibbonCollapsedCookieOn&&!this.isSimplifiedReactRibbonInTreatment,this.isViewModeAndRibbonPanelLarge=this.isViewMode&&(!this.isOldRibbonCollapsedCookieOn||this.isSimplifiedReactRibbonInTreatment),this.isSnackbarNavPaneEnabled=o,this.isTwoPaneNavEnabled=a,this.isCssPositionRewriteEnabled=s,this.hideSkeletalHeader=u,this.hideSkeletalRibbon=c,this.hideSkeletalNavPane=l,this.embedViewer=f,this.isHostRenderingEnabled=d,this.postMessageOrigin=h,this.isOneNoteNavPaneCollapseOnSmallScreenEnabled=m,this.regionComposerIsEnabled=p},t}();!function(t){t[t.HideAnimationTime=256]="HideAnimationTime",t[t.MinWidthToShowPageColumnPane=900]="MinWidthToShowPageColumnPane",t[t.MinWidthToShowNavpane=499]="MinWidthToShowNavpane",t[t.MinWidthToResizeTwoPaneNav=425]="MinWidthToResizeTwoPaneNav",t[t.MinWidthForTwoPaneNav=300]="MinWidthForTwoPaneNav"}(f||(f={}));var p=0,b=!1,w=!1,g=function(){function t(){}return t.clearAriaLoadingAttributes=function(){var t=document.getElementById("applicationOuterContainer");t&&(t.removeAttribute("aria-busy"),t.removeAttribute("aria-hidden"))},t.getFastViewSkeletalClass=function(){return m.isCssPositionRewriteEnabled?this.u():this.h()},t.updateRibbonPanel=function(){m.regionComposerIsEnabled||(m.isCssPositionRewriteEnabled&&m.isSimplifiedRibbonCookieOn?this.g():this.S())},t.updateWacDocumentPanel=function(){m.isCssPositionRewriteEnabled&&m.isSimplifiedRibbonCookieOn?this.C():this.k()},t.customizeSkeletalExperience=function(){p=document.body.clientWidth,m.isSimplifiedReactRibbonShown?v.removeElementById("SkeletalAdditionOldRibbon"):v.removeElementById("SkeletalNewRibbon"),m.isEmbedMode||m.embedViewer?(v.removeElementById("SkeletalHeader"),v.removeElementById("SkeletalNewHeader")):m.isNewHeaderShown?v.removeElementById("SkeletalHeader"):v.removeElementById("SkeletalNewHeader"),m.hideSkeletalRibbon&&v.removeElementById("SkeletalRibbon"),m.hideSkeletalNavPane&&v.removeElementById("SkeletalNavpane"),this.R()},t.bringFastViewToForegroundOfSkeletalCanvas=function(){var t=v.getElement("WACFastView");t&&(t.style.position="initial")},t.removeAllSubunitsFromSkeletalCanvas=function(){var t=v.getElement("SkeletalCanvas");if(t)for(var n=t.children.length-1;n>=0;n-=1){var e=t.children.item(n);e&&"WACFastView"!==e.id&&t.removeChild(e)}},t.fadeOutAndRemoveElement=function(t,n){var e=v.getElement(t);e&&(e.style.background="transparent",e.style.opacity="0",e.className+=" skeletalCover",window.setTimeout((function(){v.removeElement(e),n&&n()}),f.HideAnimationTime))},t.setMainContentEditable=function(){if(!b){b=!0,this.fadeOutAndRemoveElement("SkeletalNavpane"),this.fadeOutAndRemoveElement("SkeletalMainContent");var t=document.getElementById("load_back");t&&(t.style.height="auto")}},t.u=function(){return t.h()},t.h=function(){var t="";return y()?t="SkeletalFastViewRtl":(t="SkeletalFastView",m.isTwoPaneNavEnabled&&!m.isEmbedMode?t="SkeletalFastView":m.isEmbedMode||p<=f.MinWidthToShowNavpane?t="SkeletalFastViewNoNavpane":p<=f.MinWidthToShowPageColumnPane&&(t="SkeletalFastViewPageColumnNavpane")),m.isViewModeAndRibbonPanelLarge&&(t+=" SkeletalFastViewViewMode"),m.isEmbedMode&&(t+=" SkeletalFastViewEmbedMode"),t},t.O=function(){m.isCssPositionRewriteEnabled?t._():t.P()},t._=function(){t.P()},t.P=function(){var t=v.getElement("SkeletalMainContent");t&&!m.isCssPositionRewriteEnabled&&(t.className+=m.isEmbedMode?" collapsedRibbonEmbedMode":" collapsedRibbon"),v.removeElementById("SkeletalRibbonExtension")},t.g=function(){if(!w)if(m.isViewMode)w=!0;else{document.getElementById("WACRibbonPanel")&&(w=!0);var t=document.getElementsByClassName("WACReadingBarPanel").item(0);t&&(t.style.display="none")}},t.S=function(){if(!w){var t=document.getElementsByClassName("WACReadingBarPanel").item(0);if(m.isViewMode&&t)w=!0,m.isViewModeAndRibbonPanelLarge?t.className+=" RibbonPanelMaximizedViewMode":m.isViewModeAndRibbonPanelSmall&&(t.className+=" RibbonPanelMinimized");else{if(!m.regionComposerIsEnabled){var n=document.getElementById("WACRibbonPanel");null!=n&&(w=!0,m.isSimplifiedReactRibbonShown?(n.className+=" RibbonPanelSLRMode",n.className+=" RibbonPanelNewSLRMode"):m.isOldRibbonExpandedAndShown&&!m.isInTouchMode?n.className+=" RibbonPanelMaximized":m.isOldRibbonExpandedAndShown&&m.isInTouchMode?n.className+=" RibbonPanelMaximizedTouchMode":m.isOldRibbonCollapsedAndShown&&(n.className+=" RibbonPanelMinimized"))}t&&(t.style.display="none")}}},t.C=function(){var t=document.getElementById("WACDocumentPanelContent");null!=t&&(t.style.border="unset")},t.k=function(){var t=document.getElementById("WACDocumentPanel"),n=document.getElementById("WACDocumentPanelContent");null!=t&&(t.className+=" skeletalEnabled",m.isViewModeAndRibbonPanelLarge?t.style.top="40px":m.isViewModeAndRibbonPanelSmall?t.style.top="30px":m.isSimplifiedReactRibbonShown?t.style.top="77px":m.isOldRibbonCollapsedCookieOn||m.isInTouchMode||(t.style.top="124px"),y()?t.style.right="0px":m.isTwoPaneNavEnabled&&!m.isEmbedMode?p<f.MinWidthForTwoPaneNav?t.style.left=f.MinWidthToShowNavpane.toFixed()+"px":p<f.MinWidthToResizeTwoPaneNav?t.style.left=p.toFixed()+"px":t.style.left="426px":m.isEmbedMode||p<=f.MinWidthToShowNavpane?t.style.left="0px":p<=f.MinWidthToShowPageColumnPane?t.style.left="198px":m.isSnackbarNavPaneEnabled?t.style.left="426px":t.style.left="393px"),null!=n&&(n.style.border="unset")},t.R=function(){var n=v.getElement("SkeletalMainContent"),e=v.getElement("SkeletalExperience"),i=v.getElement("SkeletalRibbon");if(m.hideSkeletalHeader&&e&&(e.className+=" noHeader"),m.hideSkeletalRibbon&&e&&(e.className+=" noRibbon"),m.hideSkeletalNavPane&&e&&(e.className+=" noNavPane"),m.isViewMode?(e&&m.isCssPositionRewriteEnabled&&e.classList.remove("skeletalSLRGridRows"),i&&(i.innerHTML=""),m.isViewModeAndRibbonPanelSmall?(n&&!m.isCssPositionRewriteEnabled&&(n.style.top=m.isEmbedMode?"30px":"78px"),e&&m.isCssPositionRewriteEnabled&&(e.className+=" skeletalLegacyRibbonGridRows"),i&&!m.isCssPositionRewriteEnabled&&(i.className="skeletalRibbon skeletalRibbonCollapsedViewMode")):m.isViewModeAndRibbonPanelLarge?(i&&!m.isCssPositionRewriteEnabled&&(i.className="skeletalRibbon skeletalRibbonExpandedViewMode"),m.isCssPositionRewriteEnabled&&e?e.className+=" skeletalReadingRibbonGridRows":!m.isCssPositionRewriteEnabled&&n&&(n.style.top=m.isEmbedMode?"40px":"88px")):e&&m.isCssPositionRewriteEnabled&&(e.className+=" skeletalReadingRibbonGridRows")):e&&!m.isSimplifiedReactRibbonShown&&m.isCssPositionRewriteEnabled&&(m.isOldRibbonExpandedAndShown&&!m.isInTouchMode?e.className+=" skeletalLegacyRibbonMaximizedGridRows":m.isOldRibbonExpandedAndShown&&m.isInTouchMode?e.className+=" skeletalLegacyRibbonMaximizedTouchModeGridRows":m.isOldRibbonCollapsedAndShown&&(e.className+=" skeletalLegacyRibbonGridRows")),m.isSimplifiedReactRibbonShown?i&&(i.className=m.isCssPositionRewriteEnabled?"skeletalPositionRewriteRibbon":"skeletalSLRNewVisual"):i&&m.isCssPositionRewriteEnabled&&(i.className="skeletalPositionRewriteRibbon",m.isViewMode&&(i.className+=" viewMode")),m.isEmbedMode){i&&(m.isCssPositionRewriteEnabled||(i.style.top="0px"));var r=v.getElement("SkeletalAdditionOldRibbon");r&&!m.isCssPositionRewriteEnabled&&(r.style.top="0px")}if(y()&&t.A(),m.isOldRibbonCollapsedAndShown?t.O():m.isOldRibbonExpandedAndShown&&m.isEmbedMode&&n&&!m.isCssPositionRewriteEnabled&&(n.style.top="125px"),m.isTwoPaneNavEnabled&&!m.isEmbedMode&&(p>f.MinWidthToShowNavpane||!m.isOneNoteNavPaneCollapseOnSmallScreenEnabled)){var o=v.getElement("SkeletalNavpane"),a=v.getElement("SkeletalNavpaneSectionColumn"),s=v.getElement("SkeletalNavpanePageColumn"),u=v.getElement("SkeletalCanvas"),c=v.getElement("SkeletalExperience");if(null!=o&&null!=a&&null!=s&&null!=u&&null!=c)if(p<=f.MinWidthForTwoPaneNav)m.isCssPositionRewriteEnabled?c.className+=" skeletalOreoTwopaneShrunkGridColumns":(o.style.width="300px",u.style.left="299px"),a.style.width="124px",s.style.width="124px";else if(p<=f.MinWidthToResizeTwoPaneNav){m.isCssPositionRewriteEnabled?c.style.gridTemplateColumns=p.toFixed()+"px 100%":(o.style.width=p.toFixed()+"px",u.style.left=p-1+"px");var l=.5*p-24;a.style.width=l.toFixed()+"px",s.style.width=l.toFixed()+"px"}}else if(m.isEmbedMode||p<=f.MinWidthToShowNavpane){v.removeElementById("SkeletalNavpane"),u=v.getElement("SkeletalCanvas");var d=v.getElement("SkeletalExperience");m.isCssPositionRewriteEnabled&&d&&!m.hideSkeletalNavPane?m.isTwoPaneNavEnabled?d.className+=" skeletalNoTwopaneGridColumns":d.className+=" skeletalNoNavpaneGridColumns":!m.isCssPositionRewriteEnabled&&u&&(u.style.left="0px")}else if(p<=f.MinWidthToShowPageColumnPane){o=v.getElement("SkeletalNavpane");var h=v.getElement("SkeletalNotebookName"),b=(u=v.getElement("SkeletalCanvas"),v.getElement("SkeletalExperience"));v.removeElementById("SkeletalNavpaneSectionColumn"),v.removeElementById("skeletalNavpaneTab"),m.isCssPositionRewriteEnabled&&b?b.className+=" skeletalLegacyNavpanePageOnlyGridColumns":m.isCssPositionRewriteEnabled&&null!=o&&null!=u&&(o.style.width="201px",u.style.left="200px"),h&&(h.style.right="42px")}if(m.isSimplifiedReactRibbonShown&&null!=n)m.isCssPositionRewriteEnabled||(n.style.paddingTop=m.isEmbedMode?"74px":"126px",n.style.top="0px");else if(m.isOldRibbonCollapsedAndShown){var w=document.getElementsByClassName("skeletalRibbonBoxContainer").item(0),g=v.getElement("SkeletalRibbonBar");null!=n&&null!=g&&null!=w&&(v.removeElement(w),g.style.height="29px",g.style.borderBottom="1px solid #d2d2d2",m.isCssPositionRewriteEnabled||(n.style.top="0px"))}else if(m.isOldRibbonExpandedAndShown&&m.isInTouchMode){var S=v.getElement("SkeletalRibbonExtension");null==n||null==S||m.isCssPositionRewriteEnabled||(S.style.height="108px",n.style.top="187px")}},t.A=function(){var t=["SkeletalHeader","SkeletalNewHeader","SkeletalRibbonAppTitle","SkeletalSLRAppTitle","SkeletalRibbon","SkeletalAdditionOldRibbon","SkeletalMainContent","SkeletalCanvas"];for(var n in t){var e=v.getElement(t[n]);e&&(e.className+=" skeletalRTL")}var i=v.getElement("SkeletalCanvas");i&&(i.className+=" skeletalCanvasRtl")},t}();function y(){var t=v.getElement("SkeletalExperience");return null!=t&&"rtl"===t.getAttribute("direction")}function S(t,n){window._bB&&window._bB.sendBeacon(t,n)}var C=function(){function t(){}return t.ensureCookieCompliance=function(t,n){if(t){var e=[];n&&(e=JSON.parse(n)),WacCookieCompliance.requestConsentWithSettings(new CookieComplianceSettings(e))}},t.getCookie=function(t){if(!t)return"";if(t.indexOf("=")>=0)throw new RangeError(" = is not found in the cookie");var n=""+document.cookie,e=new RegExp("(?:^|; )"+t+"=([^;]*)"),i=n.match(e);return!i||i.length<2?"":i[1]},t.isDocumentEmpty=function(t){function n(t,n){return-1===(" "+t.className+" ").indexOf(" "+n+" ")}var e=t.querySelectorAll(".Paragraph");return!(!e||1!==e.length||2!==e[0].childElementCount||n(e[0].children[0],"TextRun")||n(e[0].children[1],"EOP")||""!==e[0].children[0].innerText)},t}();function x(){function t(){return navigator.maxTouchPoints>0}return navigator.userAgent.indexOf("Android")>=0||navigator.userAgent.indexOf("iPad")>=0||navigator.userAgent.indexOf("Macintosh")>=0&&t()&&!(navigator.userAgent.indexOf("iPhone")>=0)||t()}function k(t,n,e,i){var r;if(r=t.cssPositionRewriteIsEnabled&&!i?"WACFastViewPositionRewrite":t.isRegionComposerShown&&!i?"".concat("WACFastView"," regionComposer"):"WACFastView",t.wordIsSkeletalDeepLinkOn&&t.isDeepLinkScenario&&(r+=" Deeplink"),t.showRibbon||(r+=" HideRibbon"),t.showNavPane||(r+=" HideNavPane"),t.isOneNoteMobileViewerNavigationEnabled&&(r+=" ShowMobileViewerNavigation"),t.positionAbsolute){if(r+=" WACFastViewAbsolute",t.showRibbon?t.showRibbonHeader||(r+=" HeaderHidden"):r+=" HeaderAndRibbonHidden",t.showNavPane?t.showNavSections||(r+=" SectionsHidden"):r+=" NavHidden",t.simplifiedReactRibbonUxIsEnabled)r+=" OneLineRibbon",r+=" OneLineRibbonWithTabHeaderRefresh";else{var o=n(t.ribbonPreferenceCookieName);(!t.ribbonExpandedByDefault&&"false"===o||t.ribbonExpandedByDefault&&"true"!==o)&&(r+=" RibbonPinned",e&&(r+=" Touch"))}t.skeletalBootUXIsEnabled&&(r+=" "+g.getFastViewSkeletalClass()),t.snackbarNavPaneIsEnabled&&(r+=" Snackbar"),t.twoPaneNavIsEnabled&&(r+=" TwoPaneNav")}return r}function R(){var t=document.getElementById("load_img");t&&(t.style.opacity="0",t.style.height="1px");var n=document.getElementById("load_back");n&&(n.style.opacity="0",n.style.height="1px"),function(){var t,n=window.performance&&window.performance.now?window.performance.now():0;if(n>0&&window.g_splashScreenShownHighResTime>0){var e=n-window.g_splashScreenShownHighResTime;t="{'k':[{'e': 3,'n':'BBISS', 'd': ".concat(e,", 'p':{'DismissedFrom':'FastView'}}]}")}else t="{'k':[{'e': 3,'n':'BBISS', 'p':{'DismissedFrom':'FastView'}}]}";S(t,"Kpi")}()}function O(t,n){if(!(n.wordIsSkeletalDeepLinkOn&&n.isDeepLinkScenario||0===h.initialParaId)){var e=document.querySelector("p[paraid='"+h.initialParaId+"']");if(!e||!e.getBoundingClientRect)return;var i=e.getBoundingClientRect().bottom,r=t.getBoundingClientRect().bottom;t.firstElementChild&&(t.firstElementChild.scrollTop=i-r+70)}}function _(){var t=document.getElementById("application");t&&(t.style.top="0")}var P,A=function(t,n){return n};function E(t,n){return P&&P[t]?P[t]:n}var L=function(){function t(){}return t.launchExperience=function(n){m.initialize("false"===n.IsEditMode,"true"===n.IsEmbedMode,"true"===n.SimplifiedReactRibbonUxIsEnabled,n.RibbonPreferenceCookieNameHint,n.IsSimplifiedRibbonOnCookieName,"true"===n.SnackbarNavPaneIsEnabled,"true"===n.OneNoteTwoPaneNavPaneIsEnabled,"true"===n.OneNoteCssPositionRewriteIsEnabled,"true"===n.HideHeaderEmbedded,"true"===n.HideRibbonEmbedded||"true"===n.IsQuickNote,"true"===n.ONHideNavEmbedded,"true"===n.MobileEmbedViewer,"true"===n.PageSSRHostRenderingIsEnabled,n.PostMessageOrigin,"true"===n.OneNoteModeSwitcherIsEnabled,"true"===n.OneNoteNavPaneCollapseOnSmallScreenIsEnabled,"true"===n.RegionComposerIsEnabled),g.customizeSkeletalExperience(),this.showSkeletalUx(),window.setTimeout((function(){t.dismissSkeletalBootUx(!0)}),this.FORCE_DISMISS_AFTER)},t.showSkeletalUx=function(){var t=v.getElement("SkeletalExperience");if(t){var n=v.getElement("SkeletalCanvas");"true"===E("MobileEmbedViewerIsEnabled","false")&&n&&(n.style.left="-28px"),t.style.opacity="1",t.className+=" skeletalShow"}},t.setRibbonReady=function(){this.L||(this.W=!0,!this.tryDismissSkeletalBootUxIfAllComponentsReady()&&this.I&&g.fadeOutAndRemoveElement("SkeletalRibbon",(function(){self.dispatchEvent(new CustomEvent("RibbonVisible"))})))},t.setPageReady=function(){this.L||(g.updateRibbonPanel(),g.updateWacDocumentPanel(),this.I=!0,this.tryDismissSkeletalBootUxIfAllComponentsReady()||this.dismissSkeletalCanvas())},t.setNavpaneReady=function(){this.L||(g.updateRibbonPanel(),this.D=!0,!this.tryDismissSkeletalBootUxIfAllComponentsReady()&&this.I&&g.fadeOutAndRemoveElement("SkeletalNavpane",(function(){g.setMainContentEditable()})))},t.sendPostMessageToHostWindowRendering=function(){var t=this;window.requestAnimationFrame((function(){window.requestAnimationFrame((function(){if(!t.F){var n=window.parent,e={MessageId:"App_SwitchToWacFrame",SendTime:(new Date).getTime(),CorrelationId:"",Values:{entryPoint:"FastView"}};""!==m.postMessageOrigin&&n.postMessage(JSON.stringify(e),m.postMessageOrigin),t.F=!0}}))}))},t.setFastViewReady=function(){this.L||(m.isHostRenderingEnabled?this.dismissSkeletalCanvas(this.sendPostMessageToHostWindowRendering.bind(this)):this.dismissSkeletalCanvas())},t.showFastViewOnSkeletalCanvas=function(){var t=this;if(g.bringFastViewToForegroundOfSkeletalCanvas(),g.removeAllSubunitsFromSkeletalCanvas(),m.isHostRenderingEnabled){var n=document.querySelector(".skeletalShow");n&&n.addEventListener("animationend",(function(){t.sendPostMessageToHostWindowRendering()})),window.setTimeout((function(){t.sendPostMessageToHostWindowRendering()}),this.POST_MESSAGE_FOR_HOST_RENDERING)}},t.tryDismissSkeletalBootUxIfAllComponentsReady=function(){return!!(this.I&&this.D&&this.W)&&this.dismissSkeletalBootUx()},t.dismissSkeletalBootUx=function(n){if(void 0===n&&(n=!1),this.L)return!1;var e=document.getElementById("load_back"),i=document.getElementById("WACDocumentPanel"),r=document.getElementById("WACRibbonPanel");return e&&i&&r?(t.removeSkeletalExperience(),t.adjustElementsAfterSkeletalDismissal(e,i,r),this.L=!0,!0):(n&&t.removeSkeletalExperience(),!1)},t.removeSkeletalExperience=function(){var t=v.getElement("SkeletalExperience");t&&v.removeElement(t)},t.adjustWacRibbonAfterDismissSkeletal=function(t){m.regionComposerIsEnabled?t.style.height="100%":m.isCssPositionRewriteEnabled?this.adjustPositionRewriteWacRibbonAfterDismissSkeletal(t):this.adjustAbsoluteWacRibbonAfterDismissSkeletal(t)},t.adjustPositionRewriteWacRibbonAfterDismissSkeletal=function(t){t.style.height="auto"},t.adjustAbsoluteWacRibbonAfterDismissSkeletal=function(t){m.isSimplifiedReactRibbonShown?t.style.height="77px":t.style.height="auto"},t.adjustWacCanvasAfterDismissSkeletal=function(t){m.isCssPositionRewriteEnabled&&m.isSimplifiedReactRibbonShown||this.adjustAbsoluteWacCanvasAfterDismissSkeletal(t)},t.adjustAbsoluteWacCanvasAfterDismissSkeletal=function(t){t.className="SkeletalWacDocumentPanel skeletalEnabled "+t.className},t.dismissSkeletalCanvas=function(t){var n=this,e=document.getElementById("WACFastView");if(!this.L||e&&e.parentElement&&"SkeletalCanvas"===e.parentElement.id){this.I=!0;var i=document.getElementById("load_back");null!=i&&(this.preDismissSkeletalCanvas(i),g.fadeOutAndRemoveElement("SkeletalCanvas",(function(){t&&t(),n.D&&g.setMainContentEditable()})))}},t.preDismissSkeletalCanvas=function(t){m.isCssPositionRewriteEnabled?this.preDismissPositionRewriteSkeletalCanvas(t):this.preDismissAbsoluteSkeletalCanvas(t)},t.preDismissPositionRewriteSkeletalCanvas=function(t){this.preDismissAbsoluteSkeletalCanvas(t)},t.preDismissAbsoluteSkeletalCanvas=function(t){var n=document.getElementById("WACRibbonPlaceholder"),e=v.getElement("SkeletalRibbonExtension");if(null!=n&&null!=e&&(n.style.height="124px"),t.style.background="transparent",y()){var i=document.getElementById("application");i&&(i.style.minWidth="0px")}if(!m.isEmbedMode){var r=document.getElementById("AppHeaderPanel");r&&(r.style.height="48px")}},t.adjustElementsAfterSkeletalDismissal=function(t,n,e){t&&(t.style.display="none",t.style.height="1px",t.style.opacity="0",t.setAttribute("aria-hidden","true"),g.clearAriaLoadingAttributes()),n&&this.adjustWacCanvasAfterDismissSkeletal(n),e&&this.adjustWacRibbonAfterDismissSkeletal(e)},t.W=!1,t.I=!1,t.D=!1,t.L=!1,t.F=!1,t.FORCE_DISMISS_AFTER=2e4,t.POST_MESSAGE_FOR_HOST_RENDERING=500,t}(),W=function(){function t(){}return t.getFloatingObjectsContainerWidth=function(){return this.canvasAndFcOuterSurfaceOffset+this.floatingContainersOuterSurfaceWidth},t.shouldShiftFastView=function(n,e,i){return t.shouldShiftBasedOnScreenSize(i)&&t.shouldShiftBasedOnNumSections(e)&&n},t.shouldShiftRealCanvas=function(n,e,i,r,o){if(!t.shouldShiftBasedOnScreenSize(n))return!1;var a=e(i);return!!t.shouldShiftBasedOnNumSections(a)&&r(o)},t.shouldShiftBasedOnScreenSize=function(t){return"Small"!==t},t.shouldShiftBasedOnNumSections=function(t){return 1===t},t.canvasAndFcOuterSurfaceOffset=30,t.floatingContainersOuterSurfaceWidth=240,t}(),I=function(){return!!window&&!!window.performance&&!!window.performance.mark};function D(){return"PerformanceObserver"in window&&"function"==typeof PerformanceObserver}function F(t){return D()&&PerformanceObserver.supportedEntryTypes&&-1!==PerformanceObserver.supportedEntryTypes.indexOf(t)}var T=function(t){if(I())try{window.performance.mark(t)}catch(t){}};function j(t,n,e){if(I()&&window.performance.measure)try{window.performance.measure(t,n,e)}catch(t){}}var N=function(t,n){this.eventName=t,this.timeStamp=(new Date).getTime()-n},M=function(){function t(t,n,e,i,r,o,a,s,u,c){void 0===r&&(r="Default"),void 0===o&&(o=C.getCookie),void 0===a&&(a=!1),void 0===s&&(s=!1),void 0===u&&(u=0),void 0===c&&(c=function(t){});var l=this;this.getTopbarContainerFunc=t,this.getRibbonContainerFunc=n,this.getDocumentContainerFunc=e,this.appearance=i,this.entry=r,this.getCookieFunc=o,this.fastViewOnSkeletal=a,this.hasUnresolvedComments=s,this.numSections=u,this.displayToastFunc=c,this.T=x(),this.j=function(t){"Shift"!==t.key&&"Control"!==t.key&&"Alt"!==t.key&&(l.N(),l.M(t.type))},this.B=function(t){(13===t.keyCode||t.ctrlKey&&(66===t.keyCode||73===t.keyCode||85===t.keyCode))&&(t.preventDefault(),l.N(),l.M(t.key))},this.V=function(t){if(void 0!==l.isEditable&&void 0!==l.htmlElement&&void 0!==l.U&&l.isEditable&&l.appearance.pasteLoadingUI&&!l.isPasteLoading&&l.htmlElement.parentElement){l.isPasteLoading=!0;var n=function(t){var n=document.createElement("div");n.id="WACLoadingPasteUI";var e=document.createElement("div");e.className="WACFastLoadingBoxUI";var i,r=document.createElement("img");return r.src=t,r.className="WACProgressIcon",e.appendChild(r),n.appendChild(e),n.appendChild(((i=document.createElement("div")).className="WACFastLoadingOverlay WACDialogOverlay",i)),n.setAttribute("aria-busy","true"),n.setAttribute("role","progressbar"),n}(l.appearance.loadingUIGif);l.htmlElement.parentElement.appendChild(n),l.pasteData=function(t){var n={};if(null!=t&&null!=t.types){var e=t.types[0];n.type=e,n.data=t.getData(e)}else{var i=window.clipboardData,r=i.getData("text");null!==r?(n.type="text/plain",n.data=r):i.files.length>0&&(n.type="image/png",n.data=i.files[0])}return n}(t.clipboardData),l.U.removeAttribute("contentEditable"),t.preventDefault()}else l.H(t);l.N()},this.H=function(t){l.M(t.type),t.preventDefault()},this.M=function(t){l.eventLogs&&l.openTime&&l.eventLogs.push(new N(t,l.openTime))},this.N=function(){l.appearance.isBrowserSideCacheEnabled&&(l.displayToastFunc(l.appearance.isRtl),l.M("Toast shown"))},this.G=function(t){if(l.N(),l.M(t.type),l.U&&t.target!==l.U){if(l.U.focus(),window.getSelection){var n=window.getSelection();n&&n.collapseToEnd()}t.preventDefault()}},this.q=function(t){var n=t.querySelector(".PageContentContainer");n&&(n.className+=" WACFastViewEditor",n.addEventListener("mousedown",(function(t){l.G(t)}))),l.U=t.querySelector(".NormalTextRun"),l.U&&(l.U.contentEditable="true",l.U.style.outline="0px",l.U.spellcheck=!1,l.U.setAttribute("aria-hidden","true"),l.U.focus(),l.U.addEventListener("paste",(function(t){l.V(t)})),l.U.addEventListener("keydown",(function(t){l.B(t)})))},this.J=function(t){S(t,"BootPhaseCompleted")},this.K=function(t){if(null!=t){var n=t.querySelector(".OutlineContainer"),e=t.querySelector(".PageContentContainer");if(null!=n&&null!=e){var i=document.createElement("div"),r=W.getFloatingObjectsContainerWidth()+"px";l.appearance.isRtl?i.style.paddingLeft=r:i.style.paddingRight=r,e.appendChild(i),i.appendChild(n)}}},this.X=function(){l.appearance.positionAbsolute&&l.appearance.showRibbon&&!l.Y&&!l.appearance.skeletalBootUXIsEnabled&&(l.showRibbonPlaceholder(),l.Y=!0)},this.eventLogs=[],this.openTime=0,this.hasShifted=!1}return t.prototype.removeKeypressEventListener=function(){this.appearance.fixRemoveKeypressEventListenerInFastView?document.removeEventListener("keydown",this.j):this.Z&&document.removeEventListener("keydown",this.Z)},t.prototype.showRibbonPlaceholder=function(){var t=this;function n(t,n){var e=document.createElement("div");return e.className="ribbonBar",e.setAttribute("unselectable","on"),e.appendChild(t),e.appendChild(n),e}if(!document.getElementById("ExternalHeaderFullTopBars")){var e=this.getTopbarContainerFunc(),i=this.appearance.showHeaderPlaceholder?document.getElementById("HeaderPlaceholder"):void 0;if(e&&this.appearance.showRibbonHeader)if(i)this.topbarPlaceholderElement=i;else{var r=document.createElement("div");r.className="cui-topBar2",this.appearance.darkModeEnabled&&(r.className+=" SharedUXDarkModeFastViewHeader"),r.setAttribute("unselectable","on");var o=document.createElement("div");o.id="WACTopbarPlaceholder";var a=function(){var n=document.createElement("div");n.className="cui-topBar1",t.appearance.reactSharedHeaderIsEnabled?n.className+=" cui-topBar1-transitionalReactHeaderUI":n.className+=" cui-topBar1-transistionalHeaderUI",t.appearance.darkModeEnabled&&(n.className+=" SharedUXDarkModeFastViewHeader"),n.setAttribute("unselectable","on");var e="",i="";t.appearance.headerBackgroundColorOverride&&(e="background-color:".concat(t.appearance.headerBackgroundColorOverride,";")),t.appearance.headerTextColorOverride&&(i="color:".concat(t.appearance.headerTextColorOverride,";")),t.appearance.reactSharedHeaderIsEnabled&&(e||i)&&n.setAttribute("style","".concat(e).concat(i));var r=document.createElement("span");r.className="cui-QATRowLeft BreadcrumbContainer";var o=document.createElement("span");o.className="AppAndBrandContainer",t.appearance.reactSharedHeaderIsEnabled&&e&&o.setAttribute("style",e);var a=document.createElement("div");a.className="WACFastBootLoader";var s=document.createElement("span");s.className="BreadcrumbItem";var u=t.appearance.reactSharedHeaderIsEnabled&&t.appearance.headerAppLauncherIsHidden;u?s.setAttribute("style","width:8px;height:48px;display:inline-block;"):s.setAttribute("style","width:48px;height:48px;display:inline-block;"),document.createElement("span").className="OfficeOnlineBrandSwitcherSeparator";var c=document.createElement("span");return c.className="headBrand",t.appearance.reactSharedHeaderIsEnabled?c.setAttribute("style","line-height:48px;margin-left:2px;"):c.setAttribute("style","line-height:48px;"),c.appendChild(document.createTextNode(t.appearance.appBrandedName)),o.appendChild(s),o.appendChild(c),u||o.appendChild(a),r.appendChild(o),n.appendChild(r),t.appearance.appColorUpdateIsEnabled&&(n.className+=" cui-color-update",o.className+=" cui-color-update"),n}();o.appendChild(a),o.appendChild(r),e.appendChild(o),this.topbarPlaceholderElement=o}var s=this.getRibbonContainerFunc();if(s&&0===s.children.length){var u=document.createElement("div");if(u.id="WACRibbonPlaceholder",u.className=u.id,this.appearance.showRibbon&&!this.appearance.skeletalBootUXIsEnabled)if(this.appearance.simplifiedReactRibbonUxIsEnabled)(c=function(e,i){var r=document.createElement("div");r.className=e?"oneLineRibbonUpperWithAnimation":"oneLineRibbonUpper",r.className+=" oneLineRibbonUpperWithTabHeaderRefresh";var o=document.createElement("div");return o.className=e?"oneLineRibbonLowerWithAnimation":"oneLineRibbonLower",t.appearance.darkModeEnabled&&(r.className+=" SharedUXDarkModeFastViewRibbon",o.className+=" SharedUXDarkModeFastViewRibbon"),i&&(o.style.height="90px"),n(r,o)}(this.appearance.simplifiedReactRibbonAnimationIsEnabled,this.appearance.reactMultiLineRibbonIsVisible)).addEventListener("click",(function(){t.N(),t.M("ribbonClick")})),u.appendChild(c);else if(this.appearance.showRibbonImage&&this.appearance.ribbonExpandedByDefault&&"true"!==this.getCookieFunc(this.appearance.ribbonPreferenceCookieName)){var c;(c=function(t,e){var i=document.createElement("div");i.className="ribbonUpper";var r=document.createElement("div");r.className="ribbonLower";var o=document.createElement("div");o.className="ribbonLeft";var a=function(t,n){var e=n;return t&&(e=n.replace("bgapp_word_topleft","bgapp_word_topleft_touch")),e}(t,e);return o.style.backgroundImage="url('".concat(a,"')"),t&&(r.className+=" ribbonTouch",o.className+=" ribbonTouch"),i.appendChild(o),n(i,r)}(this.T,this.appearance.ribbonImageBase)).addEventListener("click",(function(){t.N(),t.M("ribbonClick")})),u.appendChild(c)}else u.style.height="30px";else u.className="cui-exth";s.appendChild(u),this.ribbonPlaceholderElement=u}}},t.prototype.open=function(t,n){var e=this;void 0===n&&(n=!1),this.appearance.showRibbonHeader||_(),this.X();var r=this.getDocumentContainerFunc();if(!r||!t)return!1;var o="canvasWrap"===r.id,a=document.createElement("div"),s=k(this.appearance,this.getCookieFunc,this.T,o);this.appearance.isRegionComposerShown&&(s+=" WACFastViewRegionComposer"),this.appearance.reactMultiLineRibbonIsVisible&&(s+=" WACFastViewMLRVisible"),a.className=s,a.id="WACFastView";var u=document.getElementById("CachedViewThemedCanvasBackgroundContainer");if(this.appearance.isBrowserSideCacheEnabled&&u?(r.removeChild(u),a.appendChild(u),u.innerHTML=t):a.innerHTML=t,this.appearance.isOneNoteCanvasZoomEnabled&&this.appearance.currentZoomLevel&&1!==this.appearance.currentZoomLevel){var c=a.querySelector(".PageContentOrigin");null!==c&&(c.style.transform="scale(".concat(this.appearance.currentZoomLevel,")"))}if(this.htmlElement=a,this.appearance.editable&&(this.isEditable=C.isDocumentEmpty(a)),n)a.style.visibility="hidden";else{this.appearance.fixRemoveKeypressEventListenerInFastView?document.addEventListener("keydown",this.j):(this.Z=this.j,document.addEventListener("keydown",(function(t){e.Z&&e.Z(t)})));var l=function(t){e.M(t.type),e.N()};a.firstChild&&(a.firstChild.addEventListener("scroll",l),a.firstChild.addEventListener("click",l),a.firstChild.addEventListener("dblclick",l),a.firstChild.addEventListener("contextmenu",(function(t){e.N(),e.H(t)})),o&&a.firstChild.classList.add("WACFastViewNavOreoGrid")),W.shouldShiftFastView(this.hasUnresolvedComments,this.numSections,i.getLayoutBreakpoint())?(this.M("Shifting Fast View"),this.appearance.isBrowserSideCacheEnabled||this.K(a),this.hasShifted=!0):this.M("Not shifting Fast View"),this.M("HasUnresolvedComments: "+this.hasUnresolvedComments+", NumSections == 1: "+(1===this.numSections)+", ScreenSize == Small: "+("Small"===i.getLayoutBreakpoint())),r.appendChild(a),navigator.userAgent.indexOf("Macintosh")>=0&&document.body.classList.add("Mac"),this.appearance.wordIsSkeletalDeepLinkOn&&this.appearance.isDeepLinkScenario&&document.body.classList.add("Deeplink"),this.fastViewOnSkeletal?L.showFastViewOnSkeletalCanvas():d.g_isUserCreatingPersonalNotebookFirstTime||(this.appearance.skeletalBootUXIsEnabled?L.setFastViewReady():R()),O(a,this.appearance),this.J("RecordContentDisplayed"),this.isEditable&&(a.className+=" WACFastViewEditable",this.q(a),this.J("RecordAppInteractive"))}return this.openTime=(new Date).getTime(),T("ViewableEnd"),j("Viewable","StartWacBoot","ViewableEnd"),!0},t.prototype.isOpen=function(){return!(!this.htmlElement||!this.htmlElement.parentNode)},t.cssClass="WACFastView",t.cssPositionRewriteClass="WACFastViewPositionRewrite",t.cssClassAbsolute="WACFastViewAbsolute",t}();Object(i.objectAssignPolyfill)();var B=function(){function t(){}var n;return t.initialize=function(n){t.$=n,t.tt||(t.tt=!0,t.nt=document.createElement("div"),t.nt.setAttribute("unselectable","on"),Object.assign(t.nt.style,{pointerEvents:"none",width:"100%",height:"100%",zIndex:"1000",position:"absolute",visibility:"hidden",transition:"opacity "+t.et+"ms"}),t.nt.id=t.it,t.nt.className=t.nt.id)},t.launchExperience=function(n,e){var i="applicationOuterContainer";n&&(i=n),e&&(t.rt=e),document.getElementById(i).appendChild(t.nt),t.ot(),window.setTimeout((function(){return t.dismissSkeletalBootUx()}),t.rt)},t.setComponentReady=function(n){var e=t.st(n);!t.L&&e&&(e.isReady=!0,t.ut()||t.fadeOutAndRemove(n))},t.dismissSkeletalBootUx=function(){if(t.L)return!1;for(var n in t.fadeOutAndRemove(t.it),t.ct)t.fadeOutAndRemove(n);return t.ct={},t.L=!0,self.dispatchEvent(new CustomEvent("RibbonVisible")),!0},t.getSkeletalComponentColor=function(n,e){return n?e?"#3D3D3D":"#323130":e?"#EBEBEB":t.lt},t.getSkeletalBackgroundColor=function(n,e){return n?e?"#141414":"#252423":e?"#F5F5F5":t.ft},t.addComponent=function(n){t.ct[n.element.id]=n,n.element.style.transition="opacity "+t.et+"ms",t.nt.appendChild(n.element),this.dt.push(n.element.id)},t.addComponentOutsideSkeletalContainer=function(n){t.ct[n.element.id]=n,n.element.style.transition="opacity "+t.et+"ms"},t.addShimmerToElement=function(t){if(!Object(i.isReducedAnimations)()){var n=document.getElementById(t);if(n){this.ht();var e=document.createElement("div");e.id=t+"_Shimmer",Object.assign(e.style,{height:"200px",top:"-200px",width:"100000%",left:"-99900%",backgroundColor:"linear-gradient(rgba(255,255,255, 0), rgba(255,255,255,.4), rgba(255,255,255,.8), rgba(255,255,255,.4), rgba(255,255,255,0))",position:"absolute",transformOrigin:"left",zIndex:"1000",animation:"SkeletalShimmer 3s infinite linear"}),n.appendChild(e)}}},t.fadeOutAndRemove=function(n,e){var i=void 0,r=void 0;n===t.it?i=t.nt:(r=t.st(n))&&(i=r.element),i&&(i.style.opacity="0",window.setTimeout((function(){t.vt(i),r&&(t.pt(n),r.onRemoval&&r.onRemoval()),e&&e()}),t.et))},t.isSkeletalDeepLink=function(){return t.$},t.skeletalBootLoggingData=function(){return"isSkeletalBootShown: ".concat(this.bt,", skeletalComponentsAdded: ").concat(this.dt)},n=t,t.tt=!1,t.L=!1,t.rt=3e4,t.it="SkeletalContainer",t.et=Object(i.isReducedAnimations)()?.001:200,t.ct={},t.lt="#EDEBE9",t.ft="#F3F2F1",t.$=!1,t.wt=!1,t.bt=!1,t.dt=[],t.ot=function(){t.nt&&(t.nt.style.visibility="visible",t.nt.style.opacity="1",n.bt=!0)},t.gt=function(){for(var n in t.ct)if(!t.ct[n].isReady)return!1;return!0},t.ut=function(){return!!t.gt()&&t.dismissSkeletalBootUx()},t.ht=function(){if(!t.wt){var n=document.createElement("style");n.type="text/css",n.appendChild(document.createTextNode("@keyframes SkeletalShimmer {       100% { -webkit-transform: rotate(0.06deg); transform: rotate(0.06deg); }      }")),document.getElementsByTagName("head")[0].appendChild(n),t.wt=!0}},t.st=function(n){return t.ct[n]},t.pt=function(n){delete t.ct[n]},t.vt=function(t){t&&t.parentNode&&t.parentNode.removeChild(t)},t}(),V=function(){function t(){}return t.initialize=function(){this.metrics={initialVisibility:document.visibilityState,initializeTime:new Date,events:[]},document.addEventListener("visibilitychange",t.handleVisibilityChange)},t.stop=function(){document.removeEventListener("visibilitychange",this.handleVisibilityChange)},t.handleVisibilityChange=function(){var n={visibility:document.visibilityState,time:new Date};t.metrics.events.push(n)},t}();V.initialize();var U,H=function(){function t(t,n,e){void 0===e&&(e=""),this.yt=t,this.St=n,this.Ct=e}return Object.defineProperty(t.prototype,"result",{get:function(){return this.yt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSuccess",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"errorMessage",{get:function(){return this.Ct},enumerable:!1,configurable:!0}),t}();!function(t){t.DocumentCacheItemCacheMiss="CacheMiss",t.DocumentCacheItemInvalidSchemaVersion="InvalidSchemaVersion",t.DocumentCacheItemExpired="CacheExpired",t.DocumentCacheItemInvalidColorViewMode="InvalidColorView",t.DocumentCacheItemInvalidCanvasViewMode="InvalidCanvasView",t.DocumentCacheItemValid="CacheValid"}(U||(U={}));var z=function(){function t(){}return t.validateDocumentCacheItem=function(n,e){return n?Date.now()-n.timeStamp>=t.TIMEOUT_IN_MILLISECONDS?U.DocumentCacheItemExpired:n.schemaVersion!==e?U.DocumentCacheItemInvalidSchemaVersion:U.DocumentCacheItemValid:U.DocumentCacheItemCacheMiss},t.validateDocumentCacheItemViewMode=function(t,n,e){return t?t.isPaginatedView!==n?U.DocumentCacheItemInvalidCanvasViewMode:t.isDarkCachedView!==e?U.DocumentCacheItemInvalidColorViewMode:U.DocumentCacheItemValid:U.DocumentCacheItemCacheMiss},t.validateDocumentCacheItemColorViewModeOnly=function(t,n){return t?t.isDarkCachedView!==n?U.DocumentCacheItemInvalidColorViewMode:U.DocumentCacheItemValid:U.DocumentCacheItemCacheMiss},t.MILLISECONDS_IN_A_DAY=864e5,t.TIMEOUT_IN_DAYS=30,t.TIMEOUT_IN_MILLISECONDS=t.TIMEOUT_IN_DAYS*t.MILLISECONDS_IN_A_DAY,t.LOG_CATEGORY="DocumentCacheUtilsLogs",t}(),G=e(8),q=e.n(G),J=function(t,n,e,i,r,o,a,s){this.documentViewport=t,this.timeStamp=n,this.schemaVersion=e,this.isPaginatedView=i,this.documentItemSize=r,this.hasUnresolvedComments=o,this.numSections=a,this.isDarkCachedView=s},K=function(){function t(){}return t.executeStorageAction=function(t,n,e){try{return t()}catch(t){return new H(e,!1,"Unexpected error in "+n+": "+(t.message||"Unknown"))}},t.getAndLoadDocumentCache=function(n,e){return void 0===e&&(e=!1),this.executeStorageAction((function(){return n.loadDocumentCache(e)}),this.LOAD_LOG_CATEGORY,t.defaultDocumentCacheItem)},t.getLoadedDocumentCacheItem=function(n){if(!n.getDocumentBrowserCache().isSupported())return S("Cache is not supported",t.LOAD_LOG_CATEGORY),null;var e=null;try{e=n.getDocumentCacheItemFromStorage(),S("getDocumentCacheItemFromStorage result: ".concat(e),t.LOAD_LOG_CATEGORY)}catch(n){S("Exception in DocumentCacheLoader: "+n.message,t.LOAD_LOG_CATEGORY)}return e},t.saveDocument=function(t,n,e,i,r,o,a,s){return void 0===e&&(e=!0),void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===o&&(o=1),void 0===a&&(a=""),void 0===s&&(s=""),this.executeStorageAction((function(){return t.saveDocument(n,e,i,r,o,a,s)}),this.SAVE_LOG_CATEGORY,"")},t.evictInvalidCacheEntries=function(n){try{var e=n.evictInvalidCacheItems();S("DocumentCacheRemover.evictInvalidCacheEntries result: ".concat(e),t.REMOVE_LOG_CATEGORY)}catch(n){S("Exception in DocumentCacheRemover.evictInvalidCacheEntries: "+n.message,t.REMOVE_LOG_CATEGORY)}},t.evictSpecifiedCacheItem=function(n,e){try{var i=n.evictSpecifiedCacheItem(e);S("DocumentCacheRemover.evictSpecifiedCacheItem result: ".concat(i),t.REMOVE_LOG_CATEGORY)}catch(n){S("Exception in DocumentCacheRemover.evictSpecifiedCacheItem: "+n.message,t.REMOVE_LOG_CATEGORY)}},t.evictAllCacheItems=function(n){try{var e=n.evictAllCacheItems();S("DocumentCacheRemover.evcitAllCacheItem result: ".concat(e),t.REMOVE_LOG_CATEGORY)}catch(n){S("Exception in DocumentCacheRemover.evictAllCacheItems: "+n.message,t.REMOVE_LOG_CATEGORY)}},t.LOAD_LOG_CATEGORY="GetAndLoadDocumentCache",t.SAVE_LOG_CATEGORY="SaveDocument",t.REMOVE_LOG_CATEGORY="RemoveInvalidDocumentCacheItem",t.defaultDocumentCacheItem=new J("",0,"",!1,0,!1,0,!1),t}(),X=function(){function t(t,n,e,i,r,o,a){this.documentCacheItem=null,this.documentBrowserCache=t,this.documentId=n,this.currentSchemaVersion=e,this.isPaginatedMode=i,this.isDarkCanvasBackground=r,this.createDarkModeThemeContainer=o,this.toastMessage=a}return t.prototype.getDocumentBrowserCache=function(){return this.documentBrowserCache},t.prototype.loadDocumentCache=function(t){void 0===t&&(t=!1);var n=this.getDocumentCacheItemFromStorage(),e=z.validateDocumentCacheItem(n,this.currentSchemaVersion);if(e===U.DocumentCacheItemValid&&(e=t?z.validateDocumentCacheItemColorViewModeOnly(n,this.isDarkCanvasBackground):z.validateDocumentCacheItemViewMode(n,this.isPaginatedMode,this.isDarkCanvasBackground)),e!==U.DocumentCacheItemValid)return new H(K.defaultDocumentCacheItem,!1,e);if((null==n?void 0:n.isDarkCachedView)&&!this.createDarkModeThemeContainer())throw"DarkModeThemeContainer creation failed";var i=window.self.g_instantApp;if(!i||!n)throw"Instant app is null";var r=q.a.sanitize(n.documentViewport);return i.launchFastView(r,!1,n.hasUnresolvedComments,n.numSections,this.toastMessage),new H(n,!0)},t.prototype.getDocumentCacheItemFromStorage=function(){if(this.documentCacheItem)return this.documentCacheItem;var t=this.documentBrowserCache.getCacheKey(this.documentId);return this.documentCacheItem=this.documentBrowserCache.getDocumentCacheItem(t),this.documentCacheItem},t.MILLISECONDS_IN_A_DAY=864e5,t.TIMEOUT_IN_DAYS=30,t.LOG_CATEGORY="CanvasLoaderLogs",t}(),Q=function(){function t(t,n){this.documentBrowserCache=t,this.currentSchemaVersion=n}return t.prototype.evictInvalidCacheItems=function(){for(var t=this.documentBrowserCache.getKeysInCache(),n=0,e=0;e<t.length;e++){var i=t[e],r=this.documentBrowserCache.getDocumentCacheItem(i);z.validateDocumentCacheItem(r,this.currentSchemaVersion)!==U.DocumentCacheItemValid&&(this.documentBrowserCache.removeDocumentCacheItem(i),n++)}return n},t.prototype.evictSpecifiedCacheItem=function(t){var n=this.documentBrowserCache.getCacheKey(t);return!!this.documentBrowserCache.getDocumentCacheItem(n)&&(this.documentBrowserCache.removeDocumentCacheItem(n),!0)},t.prototype.evictAllCacheItems=function(){return this.documentBrowserCache.clearBrowserCache()},t}(),Y=function(){function t(t,n,e,i,r,o){this.OpenWorkbookIcon="%3Csvg%20width%3D%2220%22%20height%3D%2218%22%20viewBox%3D%220%200%2020%2018%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0D%0A%3Cpath%20d%3D%22M8.17383%207.24219C8.02409%207.48307%207.84831%207.70443%207.64648%207.90625C7.45117%208.10156%207.23307%208.27409%206.99219%208.42383L7.49023%209.63477L6.33789%2010.1035L5.83984%208.90234C5.57943%208.96745%205.29948%209%205%209C4.70052%209%204.42057%208.96745%204.16016%208.90234L3.66211%2010.1035L2.50977%209.63477L3.00781%208.42383C2.76693%208.27409%202.54557%208.10156%202.34375%207.90625C2.14844%207.70443%201.97591%207.48307%201.82617%207.24219L0.615234%207.74023L0.146484%206.58789L1.34766%206.08984C1.28255%205.82943%201.25%205.54948%201.25%205.25C1.25%204.95052%201.28255%204.67057%201.34766%204.41016L0.146484%203.91211L0.615234%202.75977L1.82617%203.25781C2.12565%202.76953%202.51953%202.37565%203.00781%202.07617L2.50977%200.865234L3.66211%200.396484L4.16016%201.59766C4.42057%201.53255%204.70052%201.5%205%201.5C5.29948%201.5%205.57943%201.53255%205.83984%201.59766L6.33789%200.396484L7.49023%200.865234L6.99219%202.07617C7.48047%202.37565%207.87435%202.76953%208.17383%203.25781L9.38477%202.75977L9.85352%203.91211L8.65234%204.41016C8.71745%204.67057%208.75%204.95052%208.75%205.25C8.75%205.54948%208.71745%205.82943%208.65234%206.08984L9.85352%206.58789L9.38477%207.74023L8.17383%207.24219ZM5%207.75C5.34505%207.75%205.66732%207.6849%205.9668%207.55469C6.27279%207.42448%206.53971%207.24544%206.76758%207.01758C6.99544%206.78971%207.17448%206.52604%207.30469%206.22656C7.4349%205.92057%207.5%205.59505%207.5%205.25C7.5%204.90495%207.4349%204.58268%207.30469%204.2832C7.17448%203.97721%206.99544%203.71029%206.76758%203.48242C6.53971%203.25456%206.27279%203.07552%205.9668%202.94531C5.66732%202.8151%205.34505%202.75%205%202.75C4.65495%202.75%204.32943%202.8151%204.02344%202.94531C3.72396%203.07552%203.46029%203.25456%203.23242%203.48242C3.00456%203.71029%202.82552%203.97721%202.69531%204.2832C2.5651%204.58268%202.5%204.90495%202.5%205.25C2.5%205.59505%202.5651%205.92057%202.69531%206.22656C2.82552%206.52604%203.00456%206.78971%203.23242%207.01758C3.46029%207.24544%203.72396%207.42448%204.02344%207.55469C4.32943%207.6849%204.65495%207.75%205%207.75ZM18.75%2012.125C18.75%2012.4831%2018.7044%2012.8444%2018.6133%2013.209L19.9512%2013.7559L19.4824%2014.918L18.1348%2014.3613C17.7507%2014.9993%2017.2428%2015.5072%2016.6113%2015.8848L17.168%2017.2227L16.0059%2017.7012L15.459%2016.3633C15.0944%2016.4544%2014.7331%2016.5%2014.375%2016.5C14.0169%2016.5%2013.6556%2016.4544%2013.291%2016.3633L12.7441%2017.7012L11.582%2017.2227L12.1387%2015.8848C11.5007%2015.5072%2010.9928%2014.9993%2010.6152%2014.3613L9.26758%2014.918L8.79883%2013.7559L10.1367%2013.209C10.0456%2012.8444%2010%2012.4831%2010%2012.125C10%2011.7669%2010.0456%2011.4056%2010.1367%2011.041L8.79883%2010.4941L9.26758%209.33203L10.6152%209.88867C10.9928%209.25716%2011.5007%208.74935%2012.1387%208.36523L11.582%207.01758L12.7441%206.54883L13.291%207.88672C13.6556%207.79557%2014.0169%207.75%2014.375%207.75C14.7331%207.75%2015.0944%207.79557%2015.459%207.88672L16.0059%206.54883L17.168%207.01758L16.6113%208.36523C17.2428%208.74935%2017.7507%209.25716%2018.1348%209.88867L19.4824%209.33203L19.9512%2010.4941L18.6133%2011.041C18.7044%2011.4056%2018.75%2011.7669%2018.75%2012.125ZM14.375%2015.25C14.8047%2015.25%2015.2083%2015.1686%2015.5859%2015.0059C15.9635%2014.8431%2016.2923%2014.6217%2016.5723%2014.3418C16.8587%2014.0553%2017.0833%2013.7233%2017.2461%2013.3457C17.4154%2012.9616%2017.5%2012.5547%2017.5%2012.125C17.5%2011.6953%2017.4154%2011.2917%2017.2461%2010.9141C17.0833%2010.5365%2016.8587%2010.2077%2016.5723%209.92773C16.2923%209.64128%2015.9635%209.41667%2015.5859%209.25391C15.2083%209.08464%2014.8047%209%2014.375%209C13.9453%209%2013.5384%209.08464%2013.1543%209.25391C12.7767%209.41667%2012.4447%209.64128%2012.1582%209.92773C11.8783%2010.2077%2011.6569%2010.5365%2011.4941%2010.9141C11.3314%2011.2917%2011.25%2011.6953%2011.25%2012.125C11.25%2012.5547%2011.3314%2012.9616%2011.4941%2013.3457C11.6569%2013.7233%2011.8783%2014.0553%2012.1582%2014.3418C12.4447%2014.6217%2012.7767%2014.8431%2013.1543%2015.0059C13.5384%2015.1686%2013.9453%2015.25%2014.375%2015.25Z%22%20fill%3D%22%23797775%22%2F%3E%0D%0A%3C%2Fsvg%3E",this.hasSpinner=null!=o&&o,this.isRTL=i,this.elementsMargin=i?"margin-left: 8px;":"margin-right: 8px;",this.toastIconElement=this.createToastIcon(r),this.toastElement=this.createToastContainer(),this.setTitle(n),this.setMessage(e),t.appendChild(this.toastElement)}return t.prototype.setVisibility=function(t){this.toastElement.style.visibility=t?"visible":"hidden"},t.prototype.dispose=function(){var t;null===(t=this.toastElement.parentNode)||void 0===t||t.removeChild(this.toastElement)},t.prototype.setTitle=function(t){t?this.toastTitleElement?this.toastTitleElement.innerText=t:(this.toastTitleElement=this.createToastTitle(t),this.toastElement.appendChild(this.toastTitleElement)):this.toastTitleElement&&(this.toastElement.removeChild(this.toastTitleElement),this.toastTitleElement=void 0)},t.prototype.setMessage=function(t){t?this.toastMessageElement?this.toastMessageElement.innerText=t:(this.toastMessageElement=this.createToastMessage(t),this.toastElement.appendChild(this.toastMessageElement)):this.toastMessageElement&&(this.toastElement.removeChild(this.toastMessageElement),this.toastMessageElement=void 0)},t.prototype.setIcon=function(t,n){this.hasSpinner=!!n,this.toastElement.removeChild(this.toastIconElement),this.toastIconElement=this.createToastIcon(t),this.toastElement.insertBefore(this.toastIconElement,this.toastElement.firstChild)},t.prototype.createToastContainer=function(){var t=document.createElement("div");return t.id="UnavailabilityToast",t.setAttribute("role","alert"),t.setAttribute("style",'display: flex;\n      visibility: hidden;\n      padding: 12px 16px;\n      background-color: #FFF4CE;\n      color: #484644;\n      font-size: 14px;\n      line-height: 20px;\n      box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 10px 0 rgba(0, 0, 0, 0.19);\n      border-radius: 4px;\n      font-family: "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif;\n      -webkit-touch-callout: none;\n      -webkit-user-select: none;\n      -moz-user-select: none;\n      -ms-user-select: none;\n      user-select: none;\n      pointer-events: auto;\n      border: 2px solid transparent;'),t.appendChild(this.toastIconElement),t},t.prototype.createToastIcon=function(t){var n=document.createElement("span");if(n.id="UnavailabilityToastIcon",this.hasSpinner)!function(t,n){var e=document.createElement("div");e.id="UnavailbilitySpinner",e.setAttribute("style","border: 1.5px solid black;\n    border-top: 1.5px solid gray;\n    border-radius: 100%;\n    font-size: 12px;\n    width: 20px;\n    height: 20px;\n    -webkit-animation: spin 1.2s linear infinite; /* Safari */\n    animation: spin 1.2s linear infinite;"),n?e.style.marginLeft="7px":e.style.marginRight="7px";var i=document.createElement("style");i.type="text/css";var r=document.createTextNode("  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    20% { transform: rotate(50deg); }\n    70% { transform: rotate(270deg); }\n    100% { transform: rotate(360deg); }\n  }\n  \n  @-webkit-keyframes spin {\n    0% { -webkit-transform: rotate(0deg); }\n    20% { -webkit-transform: rotate(50deg); }\n    70% { -webkit-transform: rotate(270deg); }\n    100% { -webkit-transform: rotate(360deg); }\n  }\n  ");i.appendChild(r),e.appendChild(i),t.appendChild(e)}(n,this.isRTL);else{var e=null!=t?t:this.OpenWorkbookIcon;n.setAttribute("style",'display: inline-block;\n        height: 20px;\n        width: 20px;\n        background-repeat: no-repeat;\n        background-image: url("data:image/svg+xml;charset=utf8,'.concat(e,'");')+this.elementsMargin)}return n},t.prototype.createToastTitle=function(t){var n=document.createElement("span");return n.id="UnavailabilityToastTitle",n.innerText=t,n.setAttribute("style","font-weight: 600;"+this.elementsMargin),n},t.prototype.createToastMessage=function(t){var n=document.createElement("span");return n.id="UnavailabilityToastText",n.innerText=t,n},t}(),Z=function(){function t(){}return t.createInstance=function(t,n,e,i,r,o){return new Y(t,n,e,i,r,o)},t}(),$=e(26),tt=e(24),nt=e(25);var et,it=e(9),rt={},ot=function(t){var n,e;return e=function(){return n=E(t,""),new Set(n.toLowerCase().trim().split(",").map((function(t){return t.trim()})).filter((function(t){return Boolean(t)})));var n},rt[n=t]&&rt[n].size||(rt[n]=e()),rt[n]},at=function(t,n){return"string"==typeof n?function(t,n){return t.indexOf(n)>-1}(t,n):function(t,n){return n.filter((function(n){return at(t,n)})).length>0}(t,n)},st=["SharedOnline.","WordOnline.","ExcelOnline.","PowerPointOnline.","OneNoteOnline.","VisioOnline."],ut=function(t){!function(t){if(!function(t){return function(t){return st.filter((function(n){return 0===t.indexOf(n)&&t.length>n.length})).length>0}(t)&&at(t,".ChangeGate.")}(t)){var n="Change Gate Name validation failed: ".concat(t," should follow change gate naming convention.");throw $.a.shipAssertTag(538972812,tt.a.msoulscat_Wac_Ribbon,!1,n),Error(n)}}(t);var n=t.toLowerCase();return!!A(0,"").toLowerCase().includes(n)||!A(0,"").toLowerCase().includes(n)&&!ot("SharedUxSafeVelocityStoppedGates").has(n)&&Object(it.isChangeGateEnabled)(t)},ct=function(){function t(){this.toast=void 0,this.isVisible=!1}return t.getInstance=function(){return et||(et=new t),et},t.prototype.showToast=function(t,n,e,i,r,o,a,s){if(!this.isToastVisible()||s){if(this.toast)this.toast.setIcon(i,r),this.toast.setTitle(t),this.toast.setMessage(n);else{var u=document.createElement("div");u.setAttribute("style",function(t){return"position: absolute;\n        display: flex;\n        z-index: 2000;\n        left: 0px;\n        right: 0px;\n        top: ".concat(t?"40px":"8px",";\n        margin: auto;\n        align-items: center;\n        justify-content: center;\n        pointer-events: none;\n        opacity : 0;\n        transition: opacity 0.35s;\n        transition-timing-function: ease-in;")}(o)),document.body.appendChild(u),this.toast=Z.createInstance(u,t,n,e,i,r),requestAnimationFrame((function(){u.style.opacity="1"}))}this.isToastVisible()||(this.toast.setVisibility(!0),this.isVisible=!0),this.logToastVisibilityChange(!0,a),this.displayTime=window.performance.now()}},t.prototype.dismissToast=function(t){var n;this.isToastVisible()&&(null===(n=this.toast)||void 0===n||n.setVisibility(!1),this.isVisible=!1,this.logToastVisibilityChange(!1,t),this.displayTime=void 0)},t.prototype.isToastVisible=function(){var t,n;return ut("SharedOnline.ChangeGate.IsToastVisibleModified")?this.isVisible||"visible"===(null===(t=document.getElementById("UnavailabilityToast"))||void 0===t?void 0:t.style.visibility)&&!function t(n,e){return n?e(n)?n:t(n.parentElement,e):null}(document.getElementById("UnavailabilityToast"),(function(t){return"none"===getComputedStyle(t).display})):this.isVisible||"visible"===(null===(n=document.getElementById("UnavailabilityToast"))||void 0===n?void 0:n.style.visibility)},t.prototype.logToastVisibilityChange=function(t,n){var e="Unavailability Toast Visibility Changed: ".concat(t?"Shown":"Dismissed");!t&&this.displayTime&&(e+=", Duration Visible: ".concat(Math.trunc(window.performance.now()-this.displayTime))),n&&(e+=", Kind: ".concat(n)),$.a.sendTraceTag(537249949,tt.a.msoulscat_Wac_Telemetry,nt.a.Info,e)},t}(),lt=function(){function t(){}return t.showToast=function(t,n){this.toastDismissed||ct.getInstance().showToast(n,"",t,void 0,void 0,!0,"DocumentCache")},t.dismissToast=function(){this.toastDismissed=!0,ct.getInstance().dismissToast("DocumentCache"),S("dismissToastTriggered",t.DOCUMENTCACHETOASTMANAGER_LOG_CATEGORY)},t.toastDismissed=!1,t.DOCUMENTCACHETOASTMANAGER_LOG_CATEGORY="DocumentCacheToast",t}(),ft=function(){function t(){}return t.prototype.isSupported=function(){try{var t="__storage_test__";return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&localStorage&&0!==localStorage.length}},t.prototype.getDocumentCacheItem=function(t){var n=localStorage.getItem(t);return n?JSON.parse(n):null},t.prototype.saveDocumentCacheItem=function(t,n){if(!n)return!1;var e=JSON.stringify(n);return localStorage.setItem(t,e),!0},t.prototype.removeDocumentCacheItem=function(t){localStorage.removeItem(t)},t.prototype.clearBrowserCache=function(){for(var n=0,e=Object.keys(localStorage),i=0;i<e.length;i++){var r=e[i];r.startsWith(t.KEY_PREFIX)&&(localStorage.removeItem(r),n++)}return n},t.prototype.getItemsInCache=function(){for(var n=[],e=Object.keys(localStorage),i=0;i<e.length;i++){var r=e[i];if(r.startsWith(t.KEY_PREFIX)){var o=this.getDocumentCacheItem(r);o&&n.push({key:r,item:o})}}return n},t.prototype.getKeysInCache=function(){for(var n=[],e=Object.keys(localStorage),i=0;i<e.length;i++){var r=e[i];r.startsWith(t.KEY_PREFIX)&&n.push(r)}return n},t.prototype.getCacheKey=function(n){if(!n)throw new Error("documentId is an empty string");return t.KEY_PREFIX+n},t.KEY_PREFIX="WordCachedDoc_",t}(),dt=function(){function t(){}return t.prototype.isSupported=function(){return!0},t.prototype.getDocumentCacheItem=function(t){var n=localStorage.getItem(t);return JSON.parse(n)},t.prototype.saveDocumentCacheItem=function(t,n){var e=new J("test",1633560587,"1.0",!1,5,!1,0,!1),i=JSON.stringify(e);return localStorage.setItem(t,i),!0},t.prototype.removeDocumentCacheItem=function(t){localStorage.removeItem(t)},t.prototype.clearBrowserCache=function(){return 0},t.prototype.getItemsInCache=function(){return[]},t.prototype.getKeysInCache=function(){return[]},t.prototype.getCacheKey=function(t){return"WordCachedDoc_"+t},t}(),ht=function(){function t(n,i,r,o,a,s){!function(t){P=t;try{JSON.parse(E("DisabledChangeGates","{}"))}catch(t){}}(a);var u,c,l=function(t){return"true"===a[t]},f=(u="AppChromeOverrideEnabled",void 0===c&&(c=!1),(P&&P[u]&&"true"===P[u].toLowerCase()||function(t,n){return void 0===n&&(n=!1),n}(0,c)?E("AppChromeBaseScriptUrlOverride",""):E("StaticContentUrl",""))+(l("IsWebpack5RibbonEnabled")?"wp5/":""));e.p=f,this.fastBootEnabled=l("FastBoot"),t.slice0Name=a.Slice0Name,this.appearance={positionAbsolute:!l("OneNoteCssPositionRewriteIsEnabled"),showRibbon:!l("HideRibbonEmbedded"),ribbonExpandedByDefault:n,ribbonPreferenceCookieName:a.RibbonPreferenceCookieNameHint,showRibbonImage:i,ribbonImageBase:a.RibbonImageBase,shouldStretchPageToBottom:r,appBrandedName:a.BrandedWebAppName,showRibbonHeader:!l("HideHeaderEmbedded"),showNavPane:o&&!l("ONHideNavEmbedded"),showNavSections:!l("ONHideSectionsEmbedded"),editable:!1,pasteLoadingUI:l("PasteInBootLoadingUIIsEnabled"),loadingUIGif:a.ProgressGifResource,simplifiedReactRibbonUxIsEnabled:!0,simplifiedReactRibbonAnimationIsEnabled:vt(a),skeletalBootUXIsEnabled:l("OneNoteSkeletalBootUXIsEnabled"),snackbarNavPaneIsEnabled:l("SnackbarNavPaneIsEnabled"),twoPaneNavIsEnabled:l("OneNoteTwoPaneNavPaneIsEnabled"),reactSharedHeaderIsEnabled:l("ReactSharedHeaderIsEnabled"),headerAppLauncherIsHidden:l("AppLauncherIsHidden"),headerBackgroundColorOverride:decodeURIComponent(C.getCookie("ThemedHeaderBackgroundColor")),headerTextColorOverride:decodeURIComponent(C.getCookie("ThemedHeaderTextColor")),cssPositionRewriteIsEnabled:l("OneNoteCssPositionRewriteIsEnabled"),wordIsSkeletalDeepLinkOn:l("WordIsSkeletalDeepLinkOn"),isDeepLinkScenario:l("IsDeepLinkScenario"),reactMultiLineRibbonIsVisible:t.isReactMultilineRibbonVisible(a),renderFastViewOnSkeletalUXIsEnabled:l("OneNoteRenderFastViewOnSkeletalIsEnabled"),isRegionComposerShown:!!s,appColorUpdateIsEnabled:l("AppColorUpdateIsEnabled"),isRtl:l("Rtl"),showHeaderPlaceholder:l("ShowHeaderPlaceholder"),darkModeEnabled:t.isDarkModePreferenceOn(a),isOneNoteCanvasZoomEnabled:!1,currentZoomLevel:1,isOneNoteMobileViewerNavigationEnabled:l("OneNoteMobileViewerNavigationIsEnabled"),isBrowserSideCacheEnabled:l("IsBrowserSideCacheEnabled"),fixRemoveKeypressEventListenerInFastView:l("FixRemoveKeypressEventListenerInFastView"),fluent2StylesEnabled:l("Fluent2StyleIsEnabled")}}return t.prototype.launchFastView=function(t,n,e,i,r,o,a){if(void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===o&&(o=0),void 0===a&&(a=function(t){}),S("Launching FastView from entry point "+n,"BootLogs"),this.appearance.editable=e,this.fastBootEnabled&&!h.fastView&&!document.getElementById("PageContentContainer")){var s,u=document.getElementById("canvasWrap");if(null!=u&&this.appearance.cssPositionRewriteIsEnabled)s=u;else{var c=this.appearance.renderFastViewOnSkeletalUXIsEnabled&&i?"SkeletalCanvas":"WACInnerFrame";s=document.getElementById(c)}h.fastView=new M((function(){return document.getElementById("AppHeaderPanel")}),(function(){return document.getElementById("WACRibbonPanel")}),(function(){return s}),this.appearance,n,C.getCookie,i,r,o,a);try{return h.fastView.open(t)}catch(t){return h.fastBootError="FastView open failed: "+t.message+"\r\n"+t.stack,!1}}return!1},t.getSlice0=function(){if(null!=t.slice0Name&&t.slice0Name.length>0){var n=document.createElement("script");n.type="text/javascript",n.src=t.slice0Name,document.getElementsByTagName("head")[0].appendChild(n)}},t.isReactMultilineRibbonVisible=function(n){var e=t.userHasMLRPreference(n);return"true"===n.ReactMultilineRibbonIsEnabled&&("true"===e||"false"===C.getCookie(n.IsSimplifiedRibbonOnCookieName).toLowerCase()||t.defaultMLRIsEnabled(n))},t.isDarkModePreferenceOn=function(t){return"true"===t.WordDarkModeIsEnabled&&"true"===t.DarkModeIsOn},t.defaultMLRIsEnabled=function(t){return"true"===t.IsDefaultMLRForLargeScreenEnabled&&window.innerWidth>=1024&&window.innerHeight>=600},t.userHasMLRPreference=function(t){return C.getCookie(t.ReactRibbonMLRPreferenceCookieName).toLowerCase()},t}();function vt(t){return"true"===t.OneLineRibbonAnimationIsEnabled}var mt=function(t,n,e,i){void 0===e&&(e=!1),void 0===i&&(i=1),this.pageHtml=t,this.editable=n,this.hasUnresolvedComments=e,this.numSections=i};function pt(t,n,e,i){var r;return{baseDocId:t.BaseDocId,documentCacheItemSchemaVersion:t.DocumentCacheItemSchemaVersion,fastBootEnabled:"true"===t.FastBoot,getCachedSSR:"true"===t.GetCachedSSR,indexedDBPageTargetKey:"",initParagraphId:parseInt(t.InitialParaId,16),isIndexedDBEnabled:"true"===t.OneNoteIndexedDbCacheIsEnabled,isIndexedDBDefaultPageEnabled:"true"===t.OneNoteIndexedDBCacheDefaultPageIsEnabled,isOneNoteQuickloadCacheLocalStorageEnabled:"true"===t.OneNoteQuickloadCacheLocalStorageIsEnabled,isNewFile:"true"===t.CreateNew,isOneNoteHierarchySyncOnBootEnabled:"true"===t.OneNoteHierarchySyncIsEnabled,isOneNoteSyncConnectOnBootEnabled:"true"===t.OneNoteSyncConnectOnBootEnabled,isOneNoteSyncHeartBeatEnabled:"true"===t.OneNoteSyncHeartBeatIsEnabled,isOneNoteSyncHeartBeatNoShutdownEnabled:"true"===t.OneNoteSyncHeartBeatNoShutdownEnabled,isOneNoteAddUUIDForGetCellsEnabled:"true"===t.OneNoteAddUUIDForGetCellsIsEnabled,isOneNoteConvergedStackParsingEnabled:"true"===t.OneNoteConvergedStackParsing,isUserCreatingPersonalNotebookFirstTime:"true"===t.IsUserCreatingPersonalNotebookFirstTime,isRemoveSsrEnabled:"true"===t.IsRemoveSsrEnabled,IsBrowserSideCacheEnabled:"true"===t.IsBrowserSideCacheEnabled,isRemoveSsrEnabledForDarkMode:ht.isDarkModePreferenceOn(t),oneNoteShouldSendQuerySignatureOnSocketSetup:"true"===t.OneNoteShouldSendQuerySignatureOnSocketSetup,contentSyncVersion:parseInt(t.OneNoteContentSyncVersion,10),optimizedForNewFile:e,pageTarget:t.PageTarget,pageTargetHtml:t.PageTargetHtml,requestOptions:bt(t,n,i),sessionStartJson:null!==(r=t.SessionStartInfoJson)&&void 0!==r?r:"UNKNOWN",skipPageHtmlInGetCellsResponse:"true"===t.SkipPageHtmlInGetCellsResponse,slice0Name:t.Slice0Name,syncHeartBeatSendInterval:parseInt(t.OneNoteSyncHeartBeatSendIntervalMs,10),syncHeartBeatWaitInterval:parseInt(t.OneNoteSyncHeartBeatWaitIntervalMs,10),channelOutboundTimeoutInterval:parseInt(t.OneNoteSyncChannelOutboundTimeoutIntervalMs,10),userId:t.UserId}}function bt(t,n,e){return{accessToken:e?e.AccessToken:t.AccessToken,accessTokenTtl:e?e.AccessTokenTtl:"",applicationModeExtended:t.SessionStartInfoJson?JSON.parse(t.SessionStartInfoJson).ApplicationModeExtended:"UNKNOWN",buildVersion:t.BuildVersion,canary:t.Canary,feMachineId:t.FEMachineId,logHostRequests:"true"===t.LogHostRequests?1:0,onenoteSyncEndpoint:t.ONOnlineSyncEndpoint,pageTarget:t.PageTarget,renderingMode:t.AddServerSideRenderingHeader,requestHeadMode:n,rootQuerySignature:t.RootQuerySignature,sessionOrigin:t.SessionOrigin?t.SessionOrigin:"UNKNOWN",url:t.WebServiceBase,userSessionId:t.SessionId,userType:t.UserType,wacCluster:t.WacCluster,wacUserAgent:t.WacUserAgent}}var wt=function(){function t(t,n){var i,r,o=this;this.onGetCellsRequestCompleted=function(t){if(S("Get cells response received:"+t.status,"BootLogs"),!d.g_initialRequestCompleted){if(Ct(t.responseText,!1),!h.fastView&&!o.shouldDisableSSR()){var n=function(t){if(t&&t.Responses[0]&&t.Responses[0][1]&&t.Responses[0][1].Cells)for(var n=t.Responses[0][1].Cells,e=0;e<n.length;e+=1){var i=n[e];if(i&&i.PageHtml)return new mt(i.PageHtml,!!i.IsPageHtmlEditable,!!i.HasUnresolvedComments,i.NumSections)}}(d.g_initialRequestResponseObject);n&&n.pageHtml&&o.xt&&o.xt.launchFastView(n.pageHtml,"WacBootGetCells",n.editable,!1,n.hasUnresolvedComments,n.numSections)}d.g_fastViewOpenTime=new Date}},this.onInitialResponseReady=function(){d.g_onInitialResponseReady&&d.g_onInitialResponseReady()},this.kt=function(t){var n=t.responseText;if(!h.fastView){var e=function(t){var n=xt(t);if(n&&n.Responses[0]&&n.Responses[0][1]&&n.Responses[0][1].Html)return n.Responses[0][1].Html}(n);e&&o.xt&&o.xt.launchFastView(e,"WacBootRenderPage")}},this.xt=t,this.Rt=n,(null===(r=null===(i=window.location)||void 0===i?void 0:i.search)||void 0===r?void 0:r.match(/wdpa=1/gi))&&e.e(0).then(e.bind(null,27)).then((function(t){o.Ot=t.subscribeToMetricLogging(),t.subscribeToInteractivityMetricsLogging()}),(function(){}))}return t.prototype.dispose=function(){var t;null===(t=this.Ot)||void 0===t||t.call(this)},t.prototype.shouldDisableSSR=function(){return this.Rt.isRemoveSsrEnabled||this.Rt.isRemoveSsrEnabledForDarkMode||this.Rt.IsBrowserSideCacheEnabled},t.prototype.makeGetCellsRequest=function(t,n){S("Making GetCells Request","BootLogs"),h.initialParaId=this.Rt.initParagraphId||0;var e=JSON.stringify(window.location.href),i=',"SearchQuery":null,"IsNewFile":'+(this.Rt.isNewFile&&this.Rt.optimizedForNewFile).toString()+',"InitialParaId":'+h.initialParaId+',"RequestUrl":'+e+',"SkipPageHtmlInResponse":'+this.Rt.skipPageHtmlInGetCellsResponse.toString();this.Rt.sessionStartJson&&(i=i+',"SessionStartInfoJson":'+JSON.stringify(this.Rt.sessionStartJson));var r=gt(1,i,this.Rt.requestOptions,{IsRemoveSsrEnabled:this.shouldDisableSSR()});return yt(this.Rt.requestOptions.url+"OneNote.ashx"+(n?"?perfTag=GetCells_1&GetCellsBootstrapper=1":""),r,this.Rt,t,St)},t.prototype.makeRenderPageRequest=function(t){if(!this.Rt.isNewFile||!this.Rt.optimizedForNewFile){var n=gt(46,"",this.Rt.requestOptions,t);yt(this.Rt.requestOptions.url+"OneNote.ashx?IsRenderPage=1",n,this.Rt,this.kt,(function(){}))}},t.prototype.makeStartSessionRequest=function(t,n){yt(this.Rt.requestOptions.url+t,"",this.Rt,n,(function(){}))},t.getCellsFromFrameRequest=function(t){d.g_initialRequestCompleted||(Ct(t,!0),d.g_fastViewOpenTime=new Date)},t}();function gt(t,n,e,i){var r=JSON.stringify(e.rootQuerySignature);r&&(r=r.substring(1,r.length-1));var o=JSON.stringify(e.pageTarget);o&&(o=o.substring(1,o.length-1));var a='{"Mode":'+e.requestHeadMode+',"srs":[[',s=',{"FileId":"'+r+'","PageTarget":"'+o+'","OperationId":1';for(var u in i)s+=',"'+u+'":'+i[u];return a+t+s+n+"}]]}"}function yt(t,n,e,i,r){var o=new XMLHttpRequest,a={};for(var s in o.onreadystatechange=function(){if(o&&4===o.readyState){if(void 0===o.status||0===o.status)return;try{i&&i(o)}finally{null!=o&&(o.onreadystatechange=function(){},o=void 0)}}},o.open("Post",t,!0),function(t,n){var e=n.requestOptions;if(t["X-xhr"]="1",e.userSessionId&&(t["X-UserSessionId"]=e.userSessionId),e.buildVersion&&(t["X-OfficeVersion"]=e.buildVersion),t["Content-Type"]="application/json; charset=utf-8",e.canary&&(t["X-Key"]=e.canary),e.accessToken&&(t["X-AccessToken"]=e.accessToken),e.accessTokenTtl&&(t["X-AccessTokenTtl"]=e.accessTokenTtl),e.userType&&(t["X-UserType"]=e.userType),1===e.logHostRequests&&(t["X-LogHostRequests"]="1"),e.wacCluster&&(t["X-WacCluster"]=e.wacCluster),e.wacUserAgent&&(t["X-WacUserAgent"]=e.wacUserAgent),e.renderingMode&&(t["X-ServerSideRendering"]=e.renderingMode),e.feMachineId&&(t["X-FEMachineId"]=e.feMachineId),n.sessionStartJson&&(t["X-SessionStartDimensions"]=function(t){if(!t||"UNKNOWN"===t)return t;var n={},e=JSON.parse(t);return n.Application=e.Application,n.ApplicationVersion=e.ApplicationVersion,n.Browser=e.Browser,n.BrowserMajorVersion=e.BrowserMajorVersion,n.BrowserVersion=e.BrowserVersion,n.Host=e.Host,n.IsSynthetic=e.IsSynthetic,n.Os=e.Os,n.Ring=e.Ring,n.RoutedVia=e.RoutedVia,n.SessionOrigin=e.SessionOrigin,n.UiHost=e.UiHost,n.UserSessionApplicationMode=e.UserSessionApplicationMode,n.WACDatacenter=e.WACDatacenter,JSON.stringify(n)}(n.sessionStartJson)),n.isOneNoteAddUUIDForGetCellsEnabled){var i="".concat(1e7,"-").concat(1e3,"-").concat(4e3,"-").concat(8e3,"-").concat(1e11).replace(/[018]/g,(function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)}));d.g_getCellsUuid=i,t["X-GetCellsUUID"]=i}t["X-Requested-With"]="XMLHttpRequest"}(a,e),a)o.setRequestHeader(s,a[s]);var u=n;return n||(u=""),r(),o.send(u),o}function St(){d.g_initialRequestInvokedTime=new Date,d.g_initialRequestMade=!0,T("InitialRequestStart")}function Ct(t,n){d.g_getCellsFromFrameRequest=n,d.g_initialRequestCompleted=!0,d.g_initialResponseTime=new Date,T("InitialRequestEnd"),T("InitialResponseProcessStart"),j("InitialRequest","InitialRequestStart","InitialRequestEnd");var e=xt(t);if(d.g_initialRequestResponseObject=e,e&&e.Responses&&e.Responses[0]&&e.Responses[0][1]){var i=e.Responses[0][1];d.g_acquireLockStartTime=i.AcquireLockStartTime,d.g_acquireLockEndTime=i.AcquireLockEndTime,d.g_acquireLockRequestStatus=i.AcquireLockRequestStatus,d.g_getDocumentStartTime=i.GetDocumentStartTime,d.g_getDocumentEndTime=i.GetDocumentEndTime,d.g_getDocumentRequestStatus=i.GetDocumentrequestStatus,d.g_getCellsStartTime=i.GetCellsStartTime,d.g_getCellsEndTime=i.GetCellsEndTime,d.g_getInitializeLocalCobaltStartTime=i.InitializeLocalCobaltStartTime,d.g_getInitializeLocalCobaltEndTime=i.InitializeLocalCobaltEndTime}d.g_initialResponseReadyTime=new Date,T("InitialResponseProcessEnd"),j("InitialResponseProcess","InitialResponseProcessStart","InitialResponseProcessEnd")}function xt(t){try{return JSON.parse(t)}catch(t){h.fastBootError="JSON.parse failed: "+t.message+"\r\n"+t.stack}}function kt(){var t=window.performance;return t&&t.timeOrigin?t.timeOrigin:t&&t.timing&&t.timing.navigationStart?t.timing.navigationStart:0}function Rt(){var t=window.performance;return t&&t.now?t.now():(new Date).getDate()-kt()}function Ot(){var t=window.performance;return t&&t.now?kt()+t.now():(new Date).getDate()}function _t(t){return kt()+t}function Pt(t,n){void 0===window.wacPerfObserver&&(window.wacPerfObserver={}),window.wacPerfObserver[t]=n}function At(t){t.disconnect(),Pt("timeOrigin",kt()),"function"==typeof window.CustomEvent&&window.dispatchEvent(new CustomEvent("WacStableInteractive",window.wacPerfObserver))}function Et(t){var n=document.getElementById("WACFastView"),e=n.querySelector(".WACViewPanel"),i=n.querySelector(".PaginatedContentContainer"),r=n.querySelector(".PagesContainer");i&&(i.style.minHeight="0",i.style.left="-140px"),e&&(e.style.overflow="hidden");var o=document.createElement("div");return o.id="SkeletalPage",o.className=o.id,o.style.position="absolute",o.style.width="100%",o.style.height="100%",o.style.left="0px",o.style.right="0",o.style.top="19px",o.style.zIndex="1",o.appendChild(function(t){var n=document.createElement("div");n.id="SkeletalCanvas",n.className=n.id,n.style.width="auto",n.style.height="100%",n.style.overflow="hidden",n.style.position="relative",n.style.padding="96px";var e=document.getElementById("WACFastView").querySelector(".OutlineContent"),i=document.createElement("div");i.style.width="100%",i.style.height="100%",i.style.boxSizing="border-box",e&&(i.style.paddingLeft=e.style.paddingLeft,i.style.paddingRight=e.style.paddingRight,i.style.paddingTop=e.style.paddingTop);for(var r=[],o=0;o<2;o+=1)r[o]=document.createElement("div"),r[o].style.backgroundColor=t,r[o].style.height="18px",r[o].style.marginBottom="16px";r[0].style.width="150px",r[1].style.width="220px";var a=[];for(o=0;o<21;o+=1)a[o]=document.createElement("div"),a[o].style.backgroundColor=t,a[o].style.height="14px",a[o].style.marginBottom="6px";for(a[0].style.width="92%",a[1].style.width="100%",a[2].style.width="93%",a[3].style.width="80%",a[3].style.marginBottom="16px",a[4].style.width="92%",a[5].style.width="100%",a[6].style.width="55%",a[6].style.marginBottom="16px",a[7].style.width="95%",a[8].style.width="38%",a[8].style.marginBottom="26px",a[9].style.width="90%",a[10].style.width="100%",a[11].style.width="98%",a[12].style.width="100%",a[13].style.width="33%",a[13].style.marginBottom="16px",a[14].style.width="91%",a[15].style.width="90%",a[16].style.width="100%",a[17].style.width="85%",a[17].style.marginBottom="40px",a[18].style.width="92%",a[19].style.width="100%",a[20].style.width="93%",i.appendChild(r[0]),o=0;o<=17;o+=1)i.appendChild(a[o]);for(i.appendChild(r[1]),o=18;o<=19;o+=1)i.appendChild(a[o]);return n.appendChild(i),n}(t)),r&&(r.style.overflow="visible",r.appendChild(o)),{isReady:!1,element:o}}var Lt=e(1);function Wt(t){return"visually-ready"===t||"functionally-ready"===t||"visually-perceived"===t}function It(t,n){var e;for(var i in t)if(!(null===(e=t[i].states[n])||void 0===e?void 0:e.final))return!1;return!0}function Dt(t,n){return n&&t&&Wt(n)&&t.states[n]}var Ft=[];function Tt(t,n,e,i){var r,o=Number(Rt().toFixed()),a="[rum:".concat(o,"]").concat(n," ").concat(e?JSON.stringify(e):"");Ft.push({level:t,message:a}),i&&(r={traces:Object(Lt.__spreadArray)([],Object(Lt.__read)(Ft),!1)},Ft=[],function(t,n){try{var e=new CustomEvent(t,{detail:n});self.dispatchEvent(e)}catch(t){Tt(nt.a.Error,"dispatchRumShepherdEvent failed with exception:",t)}}("Wac-AppLoadTrace",r))}function jt(t){return t?Object(Lt.__assign)({},t):{}}function Nt(t){var n=[];for(var e in t){var i=t[e];n.push({id:i.id,rootElementId:i.rootElementId,subComponents:Bt(i.subComponents)})}return n}function Mt(t){var n=[];for(var e in t){var i=t[e];n.push({id:i.id,rootElementId:i.rootElementId,subComponents:Vt(i.subComponents)})}return n}function Bt(t){var n=[];for(var e in t){var i=t[e];i.nonReporting||n.push({id:i.id,initTime:_t(i.initTime),optional:i.optional,unused:i.unused,nonReporting:i.nonReporting,states:Ut(i.states)})}return n}function Vt(t){var n=[];for(var e in t){var i=t[e];i.nonReporting&&n.push({id:i.id,initTime:_t(i.initTime),optional:i.optional,unused:i.unused,nonReporting:i.nonReporting,states:Ut(i.states)})}return n}function Ut(t){var n={};for(var e in t){var i=t[e];(null==i?void 0:i.time)&&(n[e]=_t(i.time))}return n}function Ht(t,n){var e=t.subComponents;for(var i in e){var r=e[i];if(!(r.states[n]||r.unused||r.nonReporting))return!1}return!0}function zt(t){var n=Number.POSITIVE_INFINITY;for(var e in t.subComponents){var i=t.subComponents[e];n=Math.min(n,i.initTime)}return n}function Gt(t,n){if(!t)return!1;var e=t.states[n];return t.optional||(null==e?void 0:e.time)&&e.promotedFromPreviousState}function qt(t,n){return"visually-ready"===n&&Dt(t,"visually-perceived")}function Jt(t,n){return{start:t.start,time:null!=n?n:t.time,error:t.error,monitor:t.monitor,measures:jt(t.measures),data:jt(t.data)}}function Kt(t,n,e,i){"then"in t?t.then((function(t){i(t)})).catch((function(t){var r="Error in invokeMonitor [".concat(e,"}]");Tt(nt.a.Error,r,t),i({start:n,time:n,monitor:"",error:"".concat(r,": ").concat(t)})})):i(t)}var Xt=function(){function t(t){this._t=null!=t?t:{}}return t.prototype.getBooleanSetting=function(t,n){var e=this._t[t];if(!e)return n;switch(e.trim().toLowerCase()){case"true":return!0;case"false":return!1;default:return n}},t.prototype.getStringSetting=function(t,n){return this._t[t]||n},t}(),Qt=function(){function t(t){var n=this;this.timeoutInMs=t,this.Pt="",this.At=function(t){n.Pt||(n.Pt=t?"timeout":"cancelled",n.Et&&n.Et())},this.cancel=function(){n.At(!1)},t>0&&window.setTimeout((function(){return n.At(!0)}),t)}return Object.defineProperty(t.prototype,"timeout",{get:function(){return this.timeoutInMs},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"reason",{get:function(){return this.Pt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onCancelled",{set:function(t){this.Et=t},enumerable:!1,configurable:!0}),t}();function Yt(t){return new Qt(null!=t?t:0)}var Zt=function(){function t(t){var n=this;this.Lt={},this.Wt={},this.It=0,this.Dt=t,function(t){var n="hidden"===document.visibilityState?0:1/0;t(n),document.addEventListener("visibilitychange",(function(e){n=Math.min(n,e.timeStamp),t(n)}),{once:!0})}((function(t){return n.It=t}))}return Object.defineProperty(t.prototype,"tabHideTime",{get:function(){return this.It},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metrics",{get:function(){return this.Lt},enumerable:!1,configurable:!0}),t.prototype.startMonitors=function(t,n){var e=this;Tt(nt.a.Verbose,"startMonitors",{appState:t});var i=function(t,i){if(Tt(nt.a.Verbose,"onCompleteWithInputCheck",{metric:t}),i){if(!i.error){var r=e.Lt["first-input"]?e.Lt["first-input"].time:0,o=e.Lt["first-interaction"]?e.Lt["first-interaction"].time:0;r>0&&r<i.time&&(0===o||r<=o)&&(i.error="first-input"),o>0&&o<i.time&&(i.error="first-interaction")}n(t,i)}};"visually-ready"===t&&(this.monitorMetric("first-input",n),this.monitorMetric("first-interaction",n),this.monitorMetric("first-idle",i),this.monitorMetric("stable-interactivity",i,12e4))},t.prototype.cancelMonitors=function(t){var n=this;if("visually-ready"===t){Tt(nt.a.Info,"cancelAppStateMonitors",t);var e=function(t){var e;null===(e=n.Wt[t])||void 0===e||e.cancel(),n.Wt[t]=void 0,n.Lt[t]=void 0};e("stable-interactivity"),e("first-idle")}},t.prototype.monitorMetric=function(t,n,e){if(Tt(nt.a.Verbose,"monitorMetric",t),this.Wt[t])Tt(nt.a.Verbose,"monitorMetric:already-running",t);else{var i=Yt(e);this.Wt[t]=i;var r=Rt();Kt((0,this.Dt.monitors[t])(r,i),r,t,(function(e){Tt(nt.a.Verbose,"monitorMetric:complete",t),n(t,e)}))}},t}();function $t(t,n,e,i,r){r&&n.nonReporting||(t.states[e]={result:Jt(i),monitoring:void 0,final:Ht(t,e)})}var tn=function(){function t(t){var n,e,i=this;this.Ft={},this.Tt={},this.jt=function(t){if(i.Tt[t])return!1;var n=It(i.Ft,t);return Tt(nt.a.Verbose,"canAppStateMetricBeReported:metric-final:",{metric:t,isFinal:n}),n},this.Nt=function(t){if("stable-interactivity"===t||"first-idle"===t){var n=i.Mt.metrics[t],e=It(i.Ft,"visually-ready");return Tt(nt.a.Verbose,"canMonitorMetricBeReported:si-error:",{metric:t,error:null==n?void 0:n.error,vrStateFinal:e}),!!n&&"cancelled"!==n.error&&e}return!0},this.Bt=function(t){var n=i.Tt[t],e=i.Nt(t);!n&&e?i.Vt(t):Tt(nt.a.Info,"reportMonitorMetricIfReady:not-ready",{metric:t,isReported:n,canMetricBeReported:e})},this.Ut=function(t){i.jt(t)&&i.Vt(t)},this.Vt=function(t){try{var n=i.Mt.metrics[t],e={metric:t,timeOrigin:i.Ht,time:n.time,error:n.error||(i.Mt.tabHideTime<n.time?"tab-switch":void 0),monitor:n.monitor,measures:jt(n.measures),data:jt(n.data),auxMetrics:[],componentsData:Nt(i.Ft),nonReportingComponentData:Mt(i.Ft)},r=e.measures;if(r.tabsSwitch=i.Mt.tabHideTime<n.time?i.Mt.tabHideTime:0,r.start=n.start,r.reportedTime=Rt(),"stable-interactivity"===t){var o=i.Mt.metrics["visually-ready"];r["visually-ready"]=o?o.time:0;var a=i.Mt.metrics["functionally-ready"];r["functionally-ready"]=a?a.time:0}if(Wt(t)){for(var s in i.Ft){var u=i.Ft[s];if(u){var c=u.states[t].result;if(c){r[s]=c.time,e.error=e.error||c.error;var l={metric:"".concat(t,"-").concat(s),time:c.time,monitor:c.monitor,error:c.error,measures:jt(c.measures)};l.measures.start=c.start,l.measures.init=zt(u),e.auxMetrics.push(l)}}}var f=i.Mt.metrics["stable-interactivity"];f&&f.error&&"cancelled"!==f.error&&!e.error&&(e.error="si-error")}i.Dt.appLoadMetricReportCallback&&(i.Tt[t]=!0,Tt(nt.a.Info,"reportMetric:reporting",t,!0),i.Dt.appLoadMetricReportCallback(e))}catch(t){Tt(nt.a.Error,"reportMetric:error",t)}},this.zt=function(){var t,n={time:Ot(),allMetricsReported:(t=i.Tt,!!(t["visually-ready"]&&t["functionally-ready"]&&t["stable-interactivity"]&&t["first-input"]&&t["first-interaction"]&&t["first-idle"])),metrics:i.Mt.metrics,components:Nt(i.Ft),timeOrigin:kt()};i.Dt.appLoadStateLoggingCallback(n)},this.Gt=function(t,n,e,r,o){if(Dt(n,o)){var a=n.states[o];n.states[e]={time:a.time,promotedFromPreviousState:!0}}else n.states[e]={time:r,promotedFromPreviousState:!1};if(Tt(nt.a.Verbose,"processSubComponentState",{component:t.id,subComponent:n.id,state:e}),function(t,n){var e=t.subComponents;for(var i in e){var r=e[i].states[n];if(!((null==r?void 0:r.time)||e[i].optional||qt(e[i],n)))return!1}return!0}(t,e)){var s=function(t,n){n&&(Tt(nt.a.Info,"processSubComponentState:complete-monitor-metric",t),i.metrics[t]=Jt(n),i.Bt(t))},u=function(t,n){var e=function(t,n){var e,i,r=0;for(var o in t){var a=null===(i=null===(e=t[o].states[n])||void 0===e?void 0:e.result)||void 0===i?void 0:i.time;if(!a)return;r=Math.max(r,a)}return r}(i.Ft,t);Tt(nt.a.Verbose,"processSubComponentState:appStateTime",{time:e,state:t}),e&&(function(t,n,e){n&&(Tt(nt.a.Info,"processSubComponentState:complete-appstate-metric",t),i.metrics[t]=Jt(n,e),i.Ut(t))}(t,n,e),i.Mt.startMonitors(t,s))};i.Mt.cancelMonitors(e);var c=i.qt.getBooleanSetting("RumShepherdNonReportingComponentsIsEnabled",!1),l=Dt(n,o),f=function(t,n){if(n&&t&&t.states[n]){var e=t.states[n];return(null==e?void 0:e.result)&&(null==e?void 0:e.final)}return!1}(t,o),d=i.qt.getBooleanSetting("RumShepherdStatePromotionFixIsEnabled",!1);if(l&&f){if(function(t,n){if(!t||!n)return!1;var e=t.subComponents;for(var i in e)if(!Gt(e[i],n))return!1;return!0}(t,e)){var h=t.states[o];return $t(t,n,e,h.result,c),void u(e,h.result)}if(d)return}d&&void 0!==o&&Tt(nt.a.Verbose,"processSubComponentState:starting monitor although we are promoting",{component:t.id,subComponent:n.id,promotedFromState:o,state:e,isPreviousStateExists:l,isPreviousStateHasAFinalResult:f});var v=i.Dt.monitors[e];Tt(nt.a.Verbose,"processSubComponentState:start-monitor",{state:e}),function(t,n,e,i){var r=t.states[n];if(!(null==r?void 0:r.final)){(null==r?void 0:r.monitoring)&&(null==r||r.monitoring.cancel());var o=Rt(),a=Yt(5e3);t.states[n]={monitoring:a,final:Ht(t,n)},Kt(e(o,a,t),o,n,i)}}(t,e,v,(function(i){Tt(nt.a.Verbose,"processSubComponentState:monitor-complete",{state:e}),$t(t,n,e,i,c),u(e,i)}))}else Tt(nt.a.Verbose,"processSubComponentState:component-not-ready",{component:t.id,state:e})},this.Jt=function(t,n){Tt(nt.a.Verbose,"processSubComponentUnused",{subComponent:n.id}),n.unused=!0;var e=t.subComponents,r=!0;for(var o in e)e[o].unused||(r=!1);r?(i.Gt(t,n,"visually-ready",Rt()),Tt(nt.a.Verbose,"processSubComponentUnused:vr-final",{component:t.id,VISUALLY_READY:"visually-ready"}),t.states["visually-ready"].final=!0,i.Ut("visually-ready"),i.Gt(t,n,"functionally-ready",Rt()),Tt(nt.a.Verbose,"processSubComponentUnused:fr-final",{component:t.id,FUNCTIONALLY_READY:"functionally-ready"}),t.states["functionally-ready"].final=!0,i.Ut("functionally-ready")):i.ProcessUnusedComponentFinal(t),i.Bt("stable-interactivity"),i.Bt("first-idle")},this.Kt=function(t,n,e,i,r){e?t.ignoredSubComponents[n]=!0:t.subComponents[n]||(t.subComponents[n]={id:n,initTime:Rt(),optional:i,unused:!1,nonReporting:r,states:{}})},Tt(nt.a.Info,"initialize"),this.Ht=Number(kt().toFixed()),this.Dt=Object(Lt.__assign)({},t),this.Mt=new Zt(this.Dt),this.qt=new Xt(this.Dt.appSettings);try{for(var r=Object(Lt.__values)(t.components),o=r.next();!o.done;o=r.next()){var a=o.value;this.Ft[a.id]={id:a.id,rootElementId:a.rootElementId,ignoreNewSubComponents:!1,subComponents:{},states:{},ignoredSubComponents:{}}}}catch(t){n={error:t}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(n)throw n.error}}window.setTimeout((function(){return i.zt()}),12e4)}return t.prototype.ProcessUnusedComponentFinal=function(t){for(var n in t.states){var e=n,i=t.states[e];!i.final&&Ht(t,e)&&(Tt(nt.a.Verbose,"processSubComponentUnused:unused-final",{component:t.id,state:e}),i.final=!0,this.Ut(e))}},t.prototype.addSubComponents=function(t){if(t&&t.component&&t.subComponents){var n=this.Ft[t.component];if(n){var e=n.ignoreNewSubComponents;if(function(t){for(var n in t.states)if(t.states[n].final)return!1;return!0}(n)||e){Tt(nt.a.Verbose,"addSubComponents",{ignore:e,data:t});try{for(var i=Array.isArray(t.subComponents)?t.subComponents:[t.subComponents],r=0;r<i.length;r+=1)this.Kt(n,i[r],e,!1,!1);if(t.optionalSubComponents)for(r=0;r<t.optionalSubComponents.length;r+=1)this.Kt(n,t.optionalSubComponents[r],e,!0,!1);if(t.nonReportingSubComponents)for(r=0;r<t.nonReportingSubComponents.length;r+=1)this.Kt(n,t.nonReportingSubComponents[r],e,!0,!0)}catch(t){Tt(nt.a.Error,"addSubComponents",t)}}else Tt(nt.a.Error,"Component cannot be modified",t)}else Tt(nt.a.Error,"Invalid component",t)}else Tt(nt.a.Error,"Invalid data",t)},t.prototype.setSubComponentState=function(t){var n,e=Rt();if(t&&t.subComponent&&t.component&&t.state){var i=this.Ft[t.component];if(i){if(!i.ignoredSubComponents[t.subComponent]){i.ignoreNewSubComponents=i.ignoreNewSubComponents||!!t.ignoreNewSubComponents;var r=i.subComponents[t.subComponent];if(r)if("unused"!==t.state){var o=t.state;if(Wt(o))if(null===(n=i.states[o])||void 0===n?void 0:n.final)Tt(nt.a.Error,"Component state final. Can't set",t);else if(r.unused||r.states[o])Tt(nt.a.Error,"SubComponent unused or set",t);else{var a=t.promoteStateFrom;this.qt.getBooleanSetting("RumShepherdStagePromotionIsEnabled",!1)&&a?this.Gt(i,r,o,e,a):this.Gt(i,r,o,e)}else Tt(nt.a.Error,"Unknown state reported",t)}else this.Jt(i,r);else Tt(nt.a.Error,"Unexpected sub-component",t)}}else Tt(nt.a.Error,"Invalid component",t)}else Tt(nt.a.Error,"Invalid data",t)},Object.defineProperty(t.prototype,"components",{get:function(){return this.Ft},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metrics",{get:function(){return this.Mt.metrics},enumerable:!1,configurable:!0}),t}();function nn(t,n){return window.requestAnimationFrame?new Promise((function(e){var i,r=function(r){void 0===r&&(r=0),cancelAnimationFrame(i),e({start:t,time:r,monitor:"rAF",error:n.reason})};n.onCancelled=r,i=requestAnimationFrame((function(){r(Rt())}))})):Promise.resolve({start:t,time:0,monitor:"",error:"rAF Unsupported"})}function en(t,n){return new Promise((function(e){var i,r,o=function(o){void 0===o&&(o=0),cancelAnimationFrame(i),clearTimeout(r),e({start:t,time:o,monitor:"rAF-setTimeout",error:n.reason})};n.onCancelled=function(){return o()},i=requestAnimationFrame((function(){r=window.setTimeout((function(){o(Rt())}),0)}))}))}function rn(t,n,e){void 0===e&&(e=1e3);var i=n||Yt(12e3);if(!F("longtask"))return function(t,n){var e=Rt();if(!window.requestAnimationFrame)return Promise.resolve({start:e,time:0,monitor:"",error:"rAF unsupported"});var i=Rt(),r=0,o=i,a=0,s=0,u=i;return new Promise((function(i){var c,l=function(n){void 0===n&&(n=0),cancelAnimationFrame(c);var o={start:e,time:n,monitor:"long-frames",error:t.reason,measures:{longTasksCount:r,longestTaskDuration:s,longTasksDuration:a}};i(o)};t.onCancelled=l;var f=function(t){var e=t-o,i=t-u;if(u=t,i>=50&&(e=0,a+=i,r+=1,o=t,s=Math.max(s,i)),e>=n)return l(o),void on();c=window.requestAnimationFrame(f)};c=window.requestAnimationFrame(f)}))}(i,e);var r=performance.now(),o=0,a=r,s=0,u=0;return new Promise((function(n){var r,c=function(){clearTimeout(r),l&&l.disconnect();var e=Rt()-t,c={start:t,time:a,monitor:"longtask-api",error:i.reason,measures:{longTasksDuration:s,longTasksCount:o,longestTaskDuration:u,monitoredTime:e}};n(c)};i.onCancelled=c;var l=new PerformanceObserver((function(t){t.getEntries().forEach((function(t){o+=1,s+=t.duration;var n=t.startTime+t.duration;a=Math.max(n,a),u=Math.max(u,t.duration)}))}));l.observe({entryTypes:["longtask"]});var f=function(){var t=performance.now()-a;if(t>=e)c(),on();else{var n=e-t;r=window.setTimeout(f,n)}};r=window.setTimeout(f,e)}))}function on(){try{self.dispatchEvent(new CustomEvent("StableInteractivityDetected"))}catch(t){Tt(nt.a.Error,"".concat("StableInteractivityDetected"," failed with exception: ").concat(t))}}function an(t,n){return F("first-input")?new Promise((function(e){var i,r=function(n,r,o){i&&i.disconnect(),e({start:t,time:n,monitor:"first-input-api",error:o,measures:{fid:r}})};try{n.onCancelled=function(){return r(0,0,n.reason)},(i=new PerformanceObserver((function(t){t.getEntries().forEach((function(t){return function(t){var n=t.processingStart,e=n-t.startTime;r(n,e)}(t)}))}))).observe({type:"first-input",buffered:!0})}catch(t){r(0,0,"exception")}})):Promise.resolve({start:t,time:0,monitor:"",error:"FID unsupported"})}function sn(t,n){var e=["click","mousedown","keydown","touchstart","pointerdown","wheel","select","contextmenu","scroll"],i={passive:!0,capture:!0},r=Ot();return new Promise((function(o){var a=function(e,i,r){u(removeEventListener);var a={start:t,time:e,monitor:"first-interaction",error:n.reason,data:{eventName:i},measures:{delay:r}};o(a)};n.onCancelled=function(){return a(0,"",0)};var s=function(t){if(t.cancelable){var n=Ot(),e=t.timeStamp>1e12,i=(e?Ot():performance.now())-t.timeStamp;(i<0||i>n-r)&&(i=0),a(e?t.timeStamp-kt():t.timeStamp,t.type,i)}},u=function(t){e.forEach((function(n){t(n,s,i)}))};u(addEventListener)}))}function un(t,n){return window.requestIdleCallback?new Promise((function(e){var i,r=function(n,r){window.cancelIdleCallback(i),e({start:t,time:n,monitor:"first-idle",error:r})};try{i=window.requestIdleCallback((function(t){return r(Rt(),t.didTimeout?"timeout":"")}),{timeout:n.timeout}),n.onCancelled=function(){return r(0,n.reason)}}catch(t){r(0,"exception")}})):Promise.resolve({start:t,time:0,monitor:"",error:"requestIdleCallback unsupported"})}var cn,ln,fn,dn,hn=0,vn=function(t){var n="report ".concat(t.metric,":").concat(t.time,"ms");Tt(nt.a.Info,n,t);var e=new CustomEvent("Wac-AppLoadMetricReport",{detail:t});self.dispatchEvent(e)},mn=function(t){Tt(nt.a.Info,"reporting the application load state at epoch time: ".concat(t.time,"; with the status of all metrics reported as ").concat(t.allMetricsReported),t);var n=new CustomEvent("Wac-AppLoadStateReport",{detail:t});self.dispatchEvent(n)},pn=function(t,n,e){if(e){var i="vr-".concat(e.id,"-").concat(hn);hn+=1;var r=document.documentElement;return function(t,n,e,i){var r=i?function(t,n,e,i){if(F("element")){var r="testimg-"+e,o=function(t){var n=document.createElement("img");if(t){if(!("elementTiming"in n))return;n.elementTiming=t}return n.style.position="absolute",n.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",n.ariaHidden="true",n}(r);if(o){var a=null!=i?i:document.documentElement;return new Promise((function(e){var i=function(n,i){void 0===n&&(n=0),s&&s.disconnect(),e({start:t,time:n,monitor:"image-paint-api",error:i})},s=new PerformanceObserver((function(t){var n,e,s=t.getEntries();try{for(var u=Object(Lt.__values)(s),c=u.next();!c.done;c=u.next()){var l=c.value;if(l.identifier===r){try{o.hidden=!0,a.removeChild(o)}catch(t){Tt(nt.a.Error,"measureImagePaintTime",t)}return void i(l.renderTime)}}}catch(t){n={error:t}}finally{try{c&&!c.done&&(e=u.return)&&e.call(u)}finally{if(n)throw n.error}}}));n.onCancelled=function(){return i(0,n.reason)},s.observe({type:"element",buffered:!0}),a.appendChild(o)}))}}}(t,n,e,i):void 0;return r||(r=nn(t,n)),r}(t,n,i,null!=r?r:void 0)}return nn(t,n)};function bn(){cn&&!ln&&fn&&(cn.launchFastView('<div class="Ltr SingleOutlineLayout WACViewPanel CssCenteredSection" style="--pageBackgroundSolidFill:#ffffff; --pageEndMarkerColor:WindowText;"><div class="PageContentOrigin"><div class="PageContentContainer" id="PageContentContainer"><div class="PaginatedContentContainer" style="width: 816px; margin-left: auto; margin-right: auto;"><div class="PaginatedContentContainerDisplayWrapper" style="width: 816px;"><div class="PagesContainer" id="PagesContainer"><div class="Page" aria-label="Page 1" style="width: 816px; height: 1056px; background-color: var(--pageBackgroundSolidFill); z-index: 1;"></div></div></div></div></div></div></div>',"skeletalUX")&&B.addComponentOutsideSkeletalContainer(Et(B.getSkeletalComponentColor(ln,void 0))),B.addShimmerToElement("SkeletalCanvas"))}function wn(t,n){if(n){"true"===t.WacPerfObserverEntriesIsEnabled&&(D()&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("paint")&&new PerformanceObserver((function(t){t.getEntries().forEach((function(t){"first-paint"===t.name?Pt("firstPaint",t.startTime):"first-contentful-paint"===t.name&&Pt("firstContentfulPaint",t.startTime)}))})).observe({type:"paint",buffered:!0}),D()&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("largest-contentful-paint")&&new PerformanceObserver((function(t){var n=t.getEntries();Pt("largestContentfulPaint",n[n.length-1].startTime)})).observe({type:"largest-contentful-paint",buffered:!0}),function(){if(D()&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("element"))var t=new PerformanceObserver((function(n){n.getEntries().forEach((function(t){Pt("elementPaint_".concat(t.id),t.startTime)})),t.observe({type:"element",buffered:!0})}))}(),window.addEventListener("WacAppInteractive",(function(){!function(t,n){if(void 0===t&&(t=[5e3]),void 0===n&&(n=12e4),D()&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("longtask")&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("first-input")&&0!==t.length){var e=performance.now(),i=0,r=e,o=0,a=void 0,s=void 0,u=0,c=new PerformanceObserver((function(t){t.getEntries().forEach((function(t){if("longtask"===t.entryType){i+=1,o+=t.duration;var n=t.startTime+t.duration;r=n>r?n:r}else"first-input"===t.entryType&&(a=t.processingStart,s=a-t.startTime)}))}));c.observe({entryTypes:["longtask","first-input"]});var l=function(){var f=performance.now(),d=f-r;if(s)Pt("firstInputProcessingStart",a),Pt("FID",s),At(c);else{for(;u<t.length;u+=1){var h=t[u];if(!(d>=h-10))break;Pt("TTSI_".concat(h),r),Pt("longTaskCount_".concat(h),i),Pt("totalLongTasksDuration_".concat(h),o)}var v=f-e;if(u<t.length&&v<n){var m=t[u]-d;setTimeout(l,m)}else At(c)}};t.sort((function(t,n){return t-n})),setTimeout(l,t[0])}}([500,1e3,2e3,3e3,5e3])})));var i="true"===t.HideHeaderEmbedded;if("true"===t.RumShepherdIsEnabled){var r=[{id:"ribbon",rootElementId:"WACRibbonPanel"},{id:"canvas"}];i||r.push({id:"header",rootElementId:"AppHeaderPanel"}),function(t,n){var e=new tn({appLoadMetricReportCallback:vn,appLoadStateLoggingCallback:mn,appSettings:n,monitors:{"visually-ready":pn,"visually-perceived":pn,"functionally-ready":en,"stable-interactivity":rn,"first-input":an,"first-interaction":sn,"first-idle":un},components:t});window.addEventListener("Wac-SubComponentsInit",(function(t){var n=t.detail;e.addSubComponents(n)})),window.addEventListener("Wac-SubComponentSetLoadState",(function(t){var n=t.detail;e.setSubComponentState(n)}))}(r,function(t){return{RumShepherdRemoteTelemetryLoggingIsEnabled:t.RumShepherdRemoteTelemetryLoggingIsEnabled,RumShepherdStagePromotionIsEnabled:t.RumShepherdStagePromotionIsEnabled,RemoteTelemetryUrl:t.RemoteTelemetryUrl,SessionId:t.SessionId}}(t))}var o="true"===t.IsRegionComposerEnabled;if(o){var a=e(7);a.initializeWindowUtil(o),o=a.shouldUseRegionComposer()}C.ensureCookieCompliance("true"===t.MSCCEnabled,t.MSCCCookies);var s=pt(t,2,!0);cn=new ht("true"!==t.BootReadOnlyUx,!0,!0,!1,t,o);var u=new wt(cn,s),c=u.makeGetCellsRequest((function(t){u.onGetCellsRequestCompleted(t),u.onInitialResponseReady()}),!0);s.getCachedSSR&&!u.shouldDisableSSR()&&u.makeRenderPageRequest({}),"true"===t.ShouldLogWordBootServerKpis&&S("{'k':[{'e': 4,'n':'BBIGC'}]}","Kpi");var l="true"===t.WordSkeletalRibbonIsEnabled||"earlydismiss"===t.WordIsSkeletalRibbonOn||"latedismiss"===t.WordIsSkeletalRibbonOn,f="true"===t.WordIsSkeletalDeepLinkOn&&"true"===t.IsDeepLinkScenario;if((l||f)&&B.initialize(f),ln=ht.isDarkModePreferenceOn(t),fn="false"===ht.userHasMLRPreference(t),l&&fn&&"false"!==C.getCookie("WordIsSimplifiedRibbonOn")){var d="true"===t.Fluent2StyleIsEnabled;B.addComponent(function(t,n,e,i){var r=["40px","60px","60px","60px","60px","55px","90px","80px","100px","10%","17%","21%","21%","6%","6%"],o=document.createElement("div");o.id="SkeletalRibbon",o.className=o.id,o.style.marginTop=e?"0":"48px";var a=document.createElement("div");a.id="ribbonContent",a.className=a.id,a.style.backgroundColor=n,a.style.height="76px",a.style.transition="opacity 0.1s",a.style.borderBottom="none",a.style.width="100%",a.style.minWidth="640px",a.setAttribute("unselectable","on");var s=document.createElement("div");s.id="topbar",s.className="topbar",s.style.height="38px",s.style.width="100%",s.style.display="flex",s.style.alignItems="center",s.style.justifyContent="space-between";var u=document.createElement("div");u.style.height="16px",u.style.display="flex",u.style.justifyContent="flex-start";for(var c=[],l=0;l<=14;l+=1)c[l]=document.createElement("div"),c[l].style.backgroundColor=t,c[l].style.borderRadius="2px",c[l].style.height="100%",c[l].style.marginLeft="8px",c[l].style.marginRight="8px",c[l].style.outline="transparent",c[l].style.border="1px solid transparent",c[l].style.width=r[l];var f=document.createElement("div");f.style.height="24px",f.style.display="flex";var d=[];for(l=0;l<4;l+=1)d[l]=document.createElement("div"),d[l].style.width="24px",d[l].style.borderRadius="50%",d[l].style.backgroundColor=t,d[l].style.marginLeft="4px",d[l].style.marginRight="4px",d[l].style.outline="transparent",d[l].style.border="1px solid transparent",f.appendChild(d[l]);f.appendChild(c[7]),f.appendChild(c[8]);var h=document.createElement("div");h.id="bottombar",h.className="bottombar",h.style.height="38px",h.style.width="100%",h.style.display="flex",h.style.alignItems="center",i&&Object.keys(i).forEach((function(t){h.style.setProperty(t,i[t])}));var v=document.createElement("div");for(v.style.height="22px",v.style.display="flex",v.style.width="100%",l=0;l<=6;l+=1)u.appendChild(c[l]);for(l=9;l<=14;l+=1)v.appendChild(c[l]);var m=[window.matchMedia("(max-width: 700px)"),window.matchMedia("(max-width: 810px)"),window.matchMedia("(max-width: 1116px)")];for(p(),l=0;l<m.length;l+=1)m[l].addListener(p);function p(){m[0].matches?(c[7].style.width="32px",c[8].style.width="32px",c[6].style.display="none",c[5].style.display="none"):m[1].matches?(c[7].style.width="32px",c[8].style.width="32px",c[6].style.display="none"):m[2].matches&&(c[7].style.width="32px",c[8].style.width="32px")}var b=document.createElement("div");return b.id="highContrastCover",b.className=b.id,b.style.height="4px",b.style.backgroundColor="rgba(0, 0, 0, 0)",s.appendChild(u),s.appendChild(f),h.appendChild(v),a.appendChild(s),a.appendChild(h),o.appendChild(a),o.appendChild(b),{isReady:!1,element:o,onRemoval:function(){for(var t=0;t<m.length;t+=1)m[t].removeListener(p)}}}(B.getSkeletalComponentColor(ln,d),B.getSkeletalBackgroundColor(ln,d),i,d?{"background-color":ln?"#292929":"#FFFFFF","border-radius":"8px",margin:"0 8px",width:"calc(100% - 16px)"}:void 0))}return(l||f)&&B.launchExperience(),c}}var gn=function(){function t(t,n,e){this.success=t,this.errorCode=n,this.extraErrorInfo=e}return t.createSuccess=function(){return new t(!0)},t.createFailure=function(n,e){return new t(!1,n,e)},t}(),yn=function(){function t(t){this.wacInitializeReadyRetryCount=0,this.wacInitializeReadyAckReceived=!1,this.wopiStartSessionCompleteReceived=!1,this.wopiPendingSessionCompleteReceived=!1,this.wopiStartSessionSentFromWacFrame=!1,this.instantBootPltDiagnostics={},this.instantAppSettings=t,this.logs=[],this.postMessageOrigin=this.instantAppSettings.PostMessageOrigin,this.acceptStartSessionComplete="true"===this.instantAppSettings.AcceptStartSessionComplete}return t.getWindow=function(){return window},t.prototype.launchFastView=function(n,i,r,o,a){void 0===r&&(r=!1),void 0===o&&(o=1),void 0===a&&(a=""),t.getWindow().g_liveBooksAppConstructed&&this.log("App constructed before launching FastView"),h.fastView&&h.fastView.isOpen()&&this.log("FastView was already opened");var s,u="true"===this.instantAppSettings.IsRegionComposerEnabled;u&&(u=e(7).shouldUseRegionComposer()),s=function(t){lt.showToast(t,a)};var c=new ht(!0,!0,!0,!1,this.instantAppSettings,u).launchFastView(n,"WordEditorInstantApp",i,!1,r,o,s);this.log(B.skeletalBootLoggingData());var l="true"===this.instantAppSettings.WordIsSkeletalDeepLinkOn&&"true"===this.instantAppSettings.IsDeepLinkScenario,f=ht.isDarkModePreferenceOn(this.instantAppSettings),d="true"===this.instantAppSettings.Fluent2StyleIsEnabled;if(l&&c)return B.addComponentOutsideSkeletalContainer(Et(B.getSkeletalComponentColor(f,d))),void B.addShimmerToElement("SkeletalCanvas");"true"===this.instantAppSettings.SkeletalParagraphIsEnabled&&c&&this.addSkeletalParagraph(f,d)},t.prototype.trackOfficeServerDiagnostics=function(t){this.officeFrameDocumentFlushTime=Date.now(),this.serverDiagnostics=t},t.prototype.sendAppFailedMessage=function(n){this.sendPostMessageToParentWindow(t.toJsApiAppFailed,{Error:{errorType:n}},"*")},t.prototype.signalReady=function(){var t=this;window.addEventListener("message",(function(n){t.receivePostMessage(n)}),!1),this.sendReadyMessage();var n=Number(this.instantAppSettings.WopiPendingSessionMessageTimeoutInMs);n||(n=1e4),window.setTimeout((function(){return t.timeoutWopiPendingSessionMessage()}),n)},t.prototype.startWacBoot=function(t){this.sendBeacon("WordEditorInstantApp.StartWacBoot","BootLogs");var n=t||this.instantAppSettings;this.getCellsConnection=wn(n,!0)},t.prototype.displayCacheViewBeforeCFI=function(){var t=this.instantAppSettings.browserCacheIdV2,n=this.instantAppSettings.DocumentCacheItemSchemaVersion;if(void 0!==t&&void 0!==n){var e=new ft,i=new X(e,t,n,!0,ht.isDarkModePreferenceOn(this.instantAppSettings),(function(){return!0}),"Loading...");K.getAndLoadDocumentCache(i,!0)}},t.prototype.abortGetCellsConnection=function(){this.getCellsConnection&&this.getCellsConnection.abort()},t.prototype.getCellsFromFrameRequest=function(t){wt.getCellsFromFrameRequest(t),this.abortGetCellsConnection()},t.prototype.addSkeletalParagraph=function(t,n){try{var e=document.getElementById("WACFastView"),i=e.querySelectorAll(".Paragraph").length;if(20!==i&&60!==i)return!1;var r=e.querySelector(".Outline");if(r){var o=function(t,n){var e=document.createElement("div");e.id="SkeletalParagraph",e.style.width="100%",e.style.overflow="hidden",e.style.position="relative";var i=document.createElement("div");i.style.width="100%",i.style.boxSizing="border-box";var r=t.querySelectorAll(".OutlineElement");-1!==r[r.length-1].className.toLowerCase().indexOf("rtl")&&(i.style.direction="rtl");var o=t.querySelector(".OutlineContent");o&&(i.style.paddingLeft=o.style.paddingLeft,i.style.paddingRight=o.style.paddingRight);for(var a=["92%","100%","93%","80%"],s=0;s<a.length;s+=1){var u=document.createElement("div");u.style.backgroundColor=n,u.style.width=a[s],u.style.height="14px",u.style.marginBottom="6px",i.appendChild(u)}return e.appendChild(i),e}(e,B.getSkeletalComponentColor(t,n));r.appendChild(o),B.addShimmerToElement(o.id)}}catch(t){return this.log("failed to add skeletal paragraph: "+t.message+"\r\n"+t.stack),!1}return!0},t.prototype.sendPostMessageToParentWindow=function(t,n,e){var i={MessageId:t,SendTime:Date.now(),Values:n},r=this.postMessageOrigin;e&&(r=e),window.parent.postMessage(JSON.stringify(i),r),this.log("Sent ".concat(t))},t.prototype.receivePostMessage=function(n){if(n.origin===this.postMessageOrigin){var e;try{e=JSON.parse(n.data)}catch(t){return}switch(e.MessageId){case t.fromJsApiInitReadyAck:this.log("WacInitialize_Ready_Ack received"),this.wacInitializeReadyAckReceived=!0;break;case t.fromJsApiPendingSessionFail:if(this.log("WopiPendingSession_Fail received"),this.wopiPendingSessionCompleteReceived)return void this.log("WopiPendingSession_Fail received after a Complete/Fail was already received previously.");this.wopiPendingSessionCompleteReceived=!0,this.wopiStartSessionCompleteReceived=!0,this.initializeAppOnFailure("WopiPendingSession_Fail");break;case t.fromJsApiPendingSessionComplete:this.log("WopiPendingSession_Complete received"),this.sendPostMessageToParentWindow(t.toJsApiSessionCompleteAck,{}),this.wopiPendingSessionCompleteReceived&&this.log("WopiPendingSession_Complete received after a Complete/Fail was already received previously."),this.wopiPendingSessionCompleteReceived=!0;var i=e.Values.WopiDetails;this.instantBootPltDiagnostics=e.Values.Diagnostics||{},this.makeStartSessionRequest(i),this.beginStartSessionTimeout(!0);break;case t.fromJsApiStartSessionComplete:if(this.log("WopiStartSession_Complete received"),this.sendPostMessageToParentWindow(t.toJsApiSessionCompleteAck,{}),this.wopiStartSessionCompleteReceived)return void this.log("WopiStartSession_Complete received after a Complete/Fail was already received previously.");if(!this.acceptStartSessionComplete)return void this.log("WopiStartSession_Complete rejected");if(!e.Values.StartSessionResponse)return void this.log("WopiStartSession_Complete invalid content");this.wopiStartSessionCompleteReceived=!0,this.wopiPendingSessionCompleteReceived||(this.wopiPendingSessionCompleteReceived=!0);var r=e.Values.StartSessionResponse;this.instantBootPltDiagnostics=e.Values.Diagnostics||{},this.processStartSessionResponse(!1,r.RequestStatus,r.ResponseText);break;case t.fromJsApiPendingAppCompleteReceived:this.log("WopiPendingApplicationComplete_Received received on wac frame"),this.wopiPendingSessionCompleteReceived||(this.wopiPendingSessionCompleteReceived=!0),this.beginStartSessionTimeout(!1)}}},t.prototype.beginStartSessionTimeout=function(t){var n=this,e=Number(this.instantAppSettings.WopiStartSessionTimeoutInMs);e||(e=1e4),t?(this.wopiStartSessionSentFromWacFrame=!0,window.setTimeout((function(){return n.timeoutWopiStartSessionFromWacFrameMessage()}),e)):window.setTimeout((function(){return n.timeoutWopiStartSessionFromJsApiMessage()}),e)},t.prototype.sendReadyMessage=function(){var n=this;this.sendPostMessageToParentWindow(t.toJsApiInitReady,{CanAcceptStartSessionComplete:this.acceptStartSessionComplete,Diagnostics:{officeSessionId:this.instantAppSettings.SessionId}}),window.setTimeout((function(){return n.timeoutWacInitializeReadyAckMessage()}),t.wacInitializeReadyAckTimeoutInMs)},t.prototype.timeoutWacInitializeReadyAckMessage=function(){this.wacInitializeReadyAckReceived||this.wopiPendingSessionCompleteReceived||(this.wacInitializeReadyRetryCount+=1,this.wacInitializeReadyRetryCount<t.wacInitializeReadyMaxRetries?(this.sendReadyMessage(),this.log("WacInitializeReadyAckTimeout. [RetriesRemain:".concat(t.wacInitializeReadyMaxRetries-this.wacInitializeReadyRetryCount,"]"))):this.log("WacInitializeReadyAckTimeout. No retries remain"))},t.prototype.timeoutWopiPendingSessionMessage=function(){this.wopiPendingSessionCompleteReceived||this.initializeAppOnFailure("WopiPendingSession_Timeout")},t.prototype.timeoutWopiStartSessionFromJsApiMessage=function(){this.wopiStartSessionCompleteReceived||this.wopiStartSessionSentFromWacFrame||this.initializeAppOnFailure("StartSession_Fail")},t.prototype.timeoutWopiStartSessionFromWacFrameMessage=function(){this.wopiStartSessionCompleteReceived||this.initializeAppOnFailure("StartSession_Fail")},t.prototype.makeStartSessionRequest=function(t){var n=this,e=pt(this.instantAppSettings,0,!0,t),i=new wt(null,e),r="WOPIsrc=".concat(encodeURIComponent(t.WopiSrc));window.location.search&&(r+="&".concat(window.location.search.substr(1))),"true"===this.instantAppSettings.FileGetUrlPresent&&(r+="&fileGetUrlPresent=1"),this.instantBootPltDiagnostics.startSessionStartTime=Date.now(),i.makeStartSessionRequest("WordEditorStartSession.ashx?".concat(r),(function(t){return n.processStartSessionResponse(!0,t.status,t.responseText)}))},t.prototype.getAppSettingsFromResponse=function(t){try{return{success:!0,appSettings:JSON.parse(t)}}catch(t){return{success:!1,errorInfo:t.message+"\r\n"+t.stack}}},t.prototype.processStartSessionResponse=function(n,e,i){var r=this,o=Date.now();if(this.wopiStartSessionCompleteReceived=!0,200===e){var a,s=this.getAppSettingsFromResponse(i);s.success?((a=s.appSettings)&&a.UrlToRedirect&&window.top&&window.top.location.replace(a.UrlToRedirect),this.instantBootPltDiagnostics.isStartSessionFromWac=n,n&&(this.instantBootPltDiagnostics.startSessionCompleteTime=o),this.instantBootPltDiagnostics.appSettingsFetchedTime=Date.now(),dn=s.appSettings,t.instantAppSettingsToPreserve.forEach((function(t){dn&&t in r.instantAppSettings&&(dn[t]=r.instantAppSettings[t])})),t.getWindow().g_appSettings=dn,t.getWindow().g_appSettingsDownloaded=!0,this.initializeApp(gn.createSuccess())):this.initializeAppOnFailure("StartSession_AppSettingsParseError",s.errorInfo)}else this.initializeAppOnFailure("StartSession_Fail","Status ".concat(e))},t.prototype.initializeAppOnFailure=function(n,e){dn=this.instantAppSettings,t.getWindow().g_appSettings=dn,t.getWindow().g_appSettingsDownloaded=!0,this.initializeApp(gn.createFailure(n,e))},t.prototype.initializeApp=function(n){n.success&&dn?this.startWacBoot(dn):(this.sendBeacon("WordEditorInstantAppBootError",{errorCode:n.errorCode,extraErrorInfo:n.extraErrorInfo}),dn&&n.errorCode&&(dn.InstantBoot_FailureCode=n.errorCode),n.errorCode&&n.extraErrorInfo&&dn&&(dn[n.errorCode]=n.extraErrorInfo)),this.sendBeacon("WordEditorInstantAppLogs",this.logs),t.getWindow().g_livebooksJsDownloaded&&(t.getWindow().Sys.Application.get_isInitialized()?t.getWindow().g_liveBooksAppConstructed||pageInit():(t.getWindow().Sys.Application.add_init(pageInit),t.getWindow().Sys.Application.initialize()))},t.prototype.log=function(t){this.logs.push({time:Date.now(),message:t})},t.prototype.sendBeacon=function(n,e){t.getWindow()._bB&&t.getWindow()._bB.sendBeacon(n,e)},t.fromJsApiInitReadyAck="WacInitialize_Ready_Ack",t.fromJsApiPendingSessionComplete="WopiPendingSession_Complete",t.fromJsApiPendingSessionFail="WopiPendingSession_Fail",t.fromJsApiPendingAppCompleteReceived="WopiPendingApplicationComplete_Received",t.fromJsApiStartSessionComplete="WopiStartSession_Complete",t.toJsApiInitReady="WacInitialize_Ready",t.toJsApiAppFailed="Wac_AppFailed",t.toJsApiSessionCompleteAck="WopiSession_Complete_Ack",t.wacInitializeReadyMaxRetries=3,t.wacInitializeReadyAckTimeoutInMs=1e3,t.instantAppSettingsToPreserve=["MSCCCookies","MSCCEnabled","MSCCMarkup","RibbonImageBase","SharedStaticContentHost","Slice1Name","StaticContentHost","WacRootDomain","WacBootNewJSIsEnabled","jQueryName","signalRName","CollabSliceName"],t}(),Sn=function(t){s||(s=new r({container:t,layoutCollection:{Landscape:{Default:[{id:"KeyboardRegion"}]},Portrait:{Default:[{id:"KeyboardRegion"}],Small:[{id:"KeyboardRegion"}]},DP:{Default:[{id:"FarPane"},{id:"KeyboardRegion"}]},DL:{Default:[{id:"KeyboardRegion"}]}}}))};e.d(n,"show",(function(){return Sn})),e.d(n,"dispose",(function(){return c})),e.d(n,"getRegion",(function(){return u})),e.d(n,"WindowUtil",(function(){return i})),e.d(n,"CtrlWheelMetrics",(function(){return l})),e.d(n,"FastViewLogEntry",(function(){return N})),e.d(n,"FastView",(function(){return M})),e.d(n,"FastViewUtils",(function(){return C})),e.d(n,"isTouchSupport",(function(){return x})),e.d(n,"cssClassAbsolute",(function(){return"WACFastViewAbsolute"})),e.d(n,"cssClass",(function(){return"WACFastView"})),e.d(n,"cssPositionRewriteClass",(function(){return"WACFastViewPositionRewrite"})),e.d(n,"getFastViewCssClasses",(function(){return k})),e.d(n,"removeSplashScreen",(function(){return R})),e.d(n,"setFastViewScrollTop",(function(){return O})),e.d(n,"makeStyleChangesToHideHeader",(function(){return _})),e.d(n,"sendWacBeacon",(function(){return S})),e.d(n,"ShiftUtils",(function(){return W})),e.d(n,"SkeletalBoot",(function(){return L})),e.d(n,"bootSettings",(function(){return d})),e.d(n,"FastViewSettings",(function(){return h})),e.d(n,"WacSkeletalBoot",(function(){return B})),e.d(n,"WindowVisibilityMetrics",(function(){return V})),e.d(n,"CanvasCacheLoader",(function(){return X})),e.d(n,"CanvasCacheRemover",(function(){return Q})),e.d(n,"DocumentCacheItem",(function(){return J})),e.d(n,"DocumentCacheManager",(function(){return K})),e.d(n,"DocumentCacheResult",(function(){return H})),e.d(n,"DocumentCacheInfo",(function(){return U})),e.d(n,"DocumentCacheToastManager",(function(){return lt})),e.d(n,"LocalStorageDocumentCache",(function(){return ft})),e.d(n,"LocalStorageDocumentCacheTest",(function(){return dt})),e.d(n,"WordEditorInstantAppResult",(function(){return gn})),e.d(n,"WordEditorInstantApp",(function(){return yn})),e.d(n,"launchFastViewForSkeletalUX",(function(){return bn})),e.d(n,"startWacBoot",(function(){return wn}))},,,,,function(t,n,e){"use strict";var i;e.d(n,"a",(function(){return i})),function(t){t[t.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",t[t.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",t[t.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",t[t.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",t[t.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",t[t.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",t[t.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",t[t.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",t[t.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",t[t.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",t[t.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",t[t.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",t[t.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",t[t.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",t[t.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",t[t.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",t[t.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",t[t.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",t[t.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",t[t.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",t[t.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",t[t.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",t[t.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",t[t.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",t[t.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",t[t.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",t[t.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",t[t.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",t[t.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",t[t.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",t[t.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",t[t.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",t[t.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",t[t.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",t[t.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",t[t.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",t[t.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",t[t.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",t[t.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",t[t.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",t[t.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",t[t.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",t[t.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",t[t.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",t[t.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",t[t.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",t[t.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",t[t.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",t[t.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles"}(i||(i={}))},function(t,n,e){"use strict";var i;e.d(n,"a",(function(){return i})),function(t){t[t.Error=10]="Error",t[t.Warning=15]="Warning",t[t.Important=20]="Important",t[t.Info=50]="Info",t[t.Verbose=100]="Verbose",t[t.Spam=200]="Spam"}(i||(i={}))},function(t,n,e){"use strict";var i=function(){function t(){}return t.prototype.sendTraceTag=function(){},t.prototype.shipAssertTag=function(){},t.prototype.debugAssertTag=function(){},t.prototype.setCorrelationId=function(){},t}();e.d(n,"a",(function(){return r}));var r=new(function(){function t(){this.externalLogger=new i}return t.prototype.setCorrelationId=function(t){this.externalLogger.setCorrelationId(t)},t.prototype.setLogger=function(t){this.externalLogger=t},t.prototype.sendTraceTag=function(t,n,e,i){this.externalLogger.sendTraceTag(t,n,e,i)},t.prototype.debugAssertTag=function(t,n,e,i){this.externalLogger.debugAssertTag(t,n,e,i)},t.prototype.shipAssertTag=function(t,n,e,i){this.externalLogger.shipAssertTag(t,n,e,i)},t}())}]);
//# sourceMappingURL=wacBoot.min.js.map