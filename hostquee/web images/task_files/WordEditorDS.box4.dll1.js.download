'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[3],{1036:function(J,L,d){function m(G,R=self){R.addEventListener("message",function T(Z){if(Z&&Z.data){var {id:N,type:U,path:ba}=Object.assign({path:[]},Z.data),X=(Z.data.PSh||[]).map(x);try{const ca=ba.slice(0,-1).reduce((la,ta)=>la[ta],G),ia=ba.reduce((la,ta)=>la[ta],G);switch(U){case "GET":var Y=ia;break;case "SET":ca[ba.slice(-1)[0]]=x(Z.data.value);Y=!0;break;case "APPLY":Y=ia.apply(ca,X);break;case "CONSTRUCT":const la=
new ia(...X);Y=Object.assign(la,{[E]:!0});break;case "ENDPOINT":const {port1:ta,port2:za}=new MessageChannel;m(G,za);Y=w(ta,[ta]);break;case "RELEASE":Y=void 0;break;default:return}}catch(ca){Y={value:ca,[I]:0}}Promise.resolve(Y).catch(ca=>({value:ca,[I]:0})).then(ca=>{const [ia,la]=z(ca);R.postMessage(Object.assign(Object.assign({},ia),{id:N}),la);"RELEASE"===U&&(R.removeEventListener("message",T),"MessagePort"===R.constructor.name&&R.close())})}});R.start&&R.start()}function f(G){if(G)throw Error("Proxy has been released and is not useable");
}function a(G,R=[],W=function(){}){let Z=!1;const T=new Proxy(W,{get(N,U){f(Z);if(U===H)return()=>u(G,{type:"RELEASE",path:R.map(ba=>ba.toString())}).then(()=>{"MessagePort"===G.constructor.name&&G.close();Z=!0});if("then"===U){if(0===R.length)return{then:()=>T};N=u(G,{type:"GET",path:R.map(ba=>ba.toString())}).then(x);return N.then.bind(N)}return a(G,[...R,U])},set(N,U,ba){f(Z);const [X,Y]=z(ba);return u(G,{type:"SET",path:[...R,U].map(ca=>ca.toString()),value:X},Y).then(x)},apply(N,U,ba){f(Z);N=
R[R.length-1];if(N===y)return u(G,{type:"ENDPOINT"}).then(x);if("bind"===N)return a(G,R.slice(0,-1));const [X,Y]=l(ba);return u(G,{type:"APPLY",path:R.map(ca=>ca.toString()),PSh:X},Y).then(x)},construct(N,U){f(Z);const [ba,X]=l(U);return u(G,{type:"CONSTRUCT",path:R.map(Y=>Y.toString()),PSh:ba},X).then(x)}});return T}function l(G){G=G.map(z);return[G.map(R=>R[0]),Array.prototype.concat.apply([],G.map(R=>R[1]))]}function w(G,R){P.set(G,R);return G}function z(G){for(const [R,W]of C)if(W.WYh(G)){const [Z,
T]=W.serialize(G);return[{type:"HANDLER",name:R,value:Z},T]}return[{type:"RAW",value:G},P.get(G)||[]]}function x(G){switch(G.type){case "HANDLER":return C.get(G.name).deserialize(G.value);case "RAW":return G.value}}function u(G,R,W){return new Promise(Z=>{const T=v();G.addEventListener("message",function ba(U){U.data&&U.data.id&&U.data.id===T&&(G.removeEventListener("message",ba),Z(U.data))});G.start&&G.start();G.postMessage(Object.assign({id:T},R),W)})}function v(){return Array(4).fill(0).map(()=>
Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}J=d(0);const E=Symbol("Comlink.proxy"),y=Symbol("Comlink.endpoint"),H=Symbol("Comlink.releaseProxy"),I=Symbol("Comlink.thrown"),F=G=>"object"===typeof G&&null!==G||"function"===typeof G,C=new Map([["proxy",{WYh:G=>F(G)&&G[E],serialize(G){const {port1:R,port2:W}=new MessageChannel;m(G,R);return[W,[W]]},deserialize(G){G.start();return a(G,[],void 0)}}],["throw",{WYh:G=>F(G)&&I in G,serialize({value:G}){return[G instanceof Error?
{XWa:!0,value:{message:G.message,name:G.name,stack:G.stack}}:{XWa:!1,value:G},[]]},deserialize(G){if(G.XWa)throw Object.assign(Error(G.value.message),G.value);throw G.value;}}]]),P=new WeakMap;d.d(L,"a",function(){return K});class K{static xjk(G){K.Qhb=G;K.NQk=a(G,[],void 0)}static get Endpoint(){return K.Qhb}static get yjk(){return K.NQk}}Object(J.a)(K,"WorkerUtils",null,[])},1047:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m{}Object(J.a)(m,"WaterlineOverrideSettings",null,[])},
1048:function(J,L,d){J=d(0);var m=d(421),f=d(405),a=d(575),l=d(257),w=d(446);class z extends l.a{constructor(){super();this.LowWaterline=this.HighWaterline=this.FileId=null}$m(){return w.a.tFf}static Cea(H,I,F){const C=new z;C.FileId=H;C.HighWaterline=I;C.LowWaterline=F;return C}}Object(J.a)(z,"GetActivitiesRequest",l.a,[]);class x extends l.a{constructor(H,I,F){super();this.Settings=this.Waterline=this.FileId=null;this.FileId=H;this.Waterline=I;this.Settings=F}$m(){return w.a.eMf}static Cea(H,I,
F){return new x(H,I,F)}}Object(J.a)(x,"GetRelevantActivitiesRequest",l.a,[]);class u extends l.a{constructor(H,I){super();this.WaterlineOverrideSettings=this.FileId=null;this.FileId=H;this.WaterlineOverrideSettings=I}$m(){return w.a.tPm}static Cea(H,I){return new u(H,I)}}Object(J.a)(u,"GetWywaActivitiesRequest",l.a,[]);class v{}Object(J.a)(v,"RelevantActivitiesSettings",null,[]);class E extends l.a{constructor(){super();this.FileId=null}$m(){return w.a.Lsd}static Cea(H){const I=new E;I.FileId=H;return I}}
Object(J.a)(E,"UpdateWaterlineRequest",l.a,[]);d.d(L,"a",function(){return y});class y{constructor(H,I,F,C,P){this.iDk=H;this.IKd=I;this.p5e=F;this.ECc=C;this.l$g=P}requestWYWAActivities(H){H=u.Cea(this.IKd(),H);return m.a.then(this.saa(H,"wywa"),I=>I)}requestActivities(H,I){H=z.Cea(this.IKd(),H,I);return m.a.then(this.saa(H,"activities"),F=>F)}$Bo(){const H=E.Cea(this.IKd());return m.a.then(this.saa(H,"waterline"),I=>I)}requestRelevantActivities(H,I){I=Object.assign(new v,{FirstDocumentOpen:I,MockDataEnabled:!1});
H=x.Cea(this.IKd(),H,I);return m.a.then(this.saa(H,"relevant"),F=>F)}updateActivityState(H){return m.a.Jqd(this.l$g,I=>I.Kqp(H.itemIds,H.activityStatesToSet,H.activityStatesToReset,H.resetUnseenCount))}requestActivityFeed(){return m.a.Jqd(this.l$g,H=>H.uFf(null))}saa(H,I){const F={"Content-Type":"application/json; charset=utf-8"};return m.a.then(m.a.Jqd(this.iDk,C=>C.kt(this.p5e,F,f.a.S4h(H,this.ECc),I)),C=>{if(!(C&&C.args&&C.args.data&&C.args.data.De))return null;({group:C}=a.a.z4(C.args.data.De));
return C&&C.Responses&&C.Responses.length?C.Responses[0]:null})}}Object(J.a)(y,"SharedActivityRepository",null,[])},1274:function(J,L,d){d.d(L,"a",function(){return f});var m;(function(a){a[a.Unknown=0]="Unknown";a[a.OKp=1]="Inference"})(m||(m={}));var f;(function(a){a[a.Unknown=0]="Unknown";a[a.pOp=1]="VoiceDictationBadge";a[a.qOp=2]="VoiceDictationPhrase"})(f||(f={}))},1474:function(J,L,d){d.d(L,"a",function(){return a});J=d(0);var m=d(2),f=d(6);class a{static get tzb(){return!!m.AFrameworkApplication.J&&
m.AFrameworkApplication.J.$("WordDesignerTelemetryPerConstructIsEnabled")}static nqb(l,w=!1){const z=f.a.Za(l);z.Kd();return(w?z.Ub(4):z.lla(4))?4:f.a.Za(l).vb(36)?16:f.a.Za(l).vb(14)?2:f.a.Za(l).vb(38)?32:1}}Object(J.a)(a,"ConstructTypeHelper",null,[])},1504:function(J,L,d){d.d(L,"a",function(){return Z});J=d(0);var m=d(193),f=d(19),a=d(238),l=d(2),w=d(236),z=d(5),x=d(75),u=d(11),v=d(747),E=d(12),y=d(256),H=d(3),I=d(85),F=d(65),C=d(37),P=d(448),K=d(164),G=d(21),R=d(253),W=d(8);class Z{static get rg(){return R.a.instance}static get Dc(){return m.a.instance}static ly(){return Z.Sn||
(Z.Sn=f.a.instance.Ra(51))}static get cC(){return null!=Z.x1g?Z.x1g:Z.x1g=f.a.instance.resolve(17)}static WLm(){this.FQ||(this.FQ=new x.a,this.FQ.add(H.a.gC),this.FQ.add(H.a.font),this.FQ.add(H.a.hY),this.FQ.add(H.a.oza),this.FQ.add(H.a.bold),this.FQ.add(H.a.eA),this.FQ.add(H.a.superscript),this.FQ.add(H.a.subscript),this.FQ.add(H.a.s6a),this.FQ.add(H.a.lza),this.FQ.add(H.a.gIa),this.FQ.add(H.a.Xmf),this.FQ.add(H.a.hIa),this.FQ.add(H.a.r6a),this.FQ.add(H.a.T2),this.FQ.add(H.a.k4),this.FQ.add(H.a.$D),
this.FQ.add(H.a.Zmb),this.FQ.add(H.a.KUc));return this.FQ}static anc(T){return Z.WLm().contains(T)?!0:!1}static qx(T,N,U,ba,X){var Y=!0;if(!N.view.te)return 2;var ca=N.view,ia=ca.mb;ia&&ia.gb.currentSelection||(Z.Dc.$b(I.a.Re,{["Reason"]:F.a.ao}),Y=!1);Object(K.a)().FIa(E.ImageReader.N8c,ca.mb.Mg)&&(Z.Dc.$b(I.a.Re,{["Reason"]:F.a.xqf}),Y=!1);if(Object(K.a)().FIa(E.ImageReader.A$a,ca.mb.Mg))return Z.Dc.$b(I.a.Re,{["Reason"]:F.a.OVc}),8;var la=!Z.anc(T);Z.rg.enc(ca.mb.Mg,la)&&(Z.Dc.$b(I.a.Re,{["Reason"]:F.a.IG}),
Y=!1);Object(K.a)().FIa(E.ImageReader.cde,ca.mb.Mg)&&(Z.Dc.$b(I.a.Re,{["Reason"]:F.a.rqf}),Y=!1);Object(K.a)().FIa(y.c,ca.mb.Mg)&&(Z.Dc.$b(I.a.Re,{["Reason"]:F.a.sqf}),Y=!1);Object(K.a)().FIa(v.a.SXf,ca.mb.Mg)&&(Z.Dc.$b(I.a.Re,{["Reason"]:F.a.qqf}),Y=!1);Object(K.a)().NEa(W.ParagraphReader.qX,ca.mb.Mg)&&(Z.Dc.$b(I.a.Re,{["Reason"]:F.a.QQ}),Y=!1);Z.ly()&&Z.ly().instance&&Z.ly().instance.sX(ca.mb.Mg)&&(Z.Dc.$b(I.a.Re,{["Reason"]:F.a.b8a}),Y=!1);var ta=null;ia&&ia.gb.currentSelection&&(ta=ia.gb.currentSelection);
if(1===U||!Y||!ta)return Y?32:8;Y=T===H.a.Npc||T===H.a.gec||T===H.a.pvc||T===H.a.Aic;ca=T===H.a.MXb||T===H.a.YMb||T===H.a.Buc;la=T===H.a.m_a||T===H.a.n_a||T===H.a.GE;const za=new C.GraphTransaction(15);za.Bb(ta.Qa.node);ta=new x.a;let Ha=!1;if(Y||ca||la)a.a.mark(7121),N=Object(K.a)().pqi(N.Ik);else{a.a.mark(7119);N=P.OutlineElementGeneralizer.Mka(ia.gb,!0);if(!N)return Z.Dc.$b(I.a.esa,{["Reason"]:F.a.v1d}),za.dispose(),8;ia=T===H.a.h$a||T===H.a.Xrb;N.Qw&&ia&&(Ha=Z.zWm(ta,N))}(T===H.a.F7||T===H.a.Npc||
T===H.a.W$||T===H.a.gec||T===H.a.p8||T===H.a.pvc||T===H.a.ZJa||T===H.a.Aic)&&N.Qw&&1<N.length&&Z.AWm(N)&&(X||(X={}),Object.getType(X)===Object&&(X.InContextSet=!0));l.AFrameworkApplication.va.Nf(N,T,U,!0,ba,X);Ha&&Z.tOn(ta,N,X);za.dispose();G.StaticActiveAppFrame.za().Fe();Y||ca||la?a.a.mark(7122):a.a.mark(7120);return 32}static zWm(T,N){if(!N.Qw)return!1;let U=!1,ba=!1;for(let Y=0;Y<N.length;Y++)if(N.getContext(Y).Al){var X=N.getContext(Y).node;X&&(X=Z.cC.zqb(X),2===X.specialIndentType?(U=!0,T.add(Y)):
1!==X.specialIndentType&&X.specialIndentType||(ba=!0))}return ba&&U}static tOn(T,N,U){if(N.Qw)for(let X=0;X<T.count;X++){var ba=N.getContext(T.K(X));if(!ba.Al)continue;ba=ba.node;const Y=Z.cC.zqb(ba);2!==Y.specialIndentType||w.a.LBa(U.value,Y.RA)||ba.setValue(z.a.he,Y.RA-Y.oha)}}static VAg(T,N){let U=!0;N.contextId!==u.a.paragraph?U=!1:Z.rg.iab(N)?(Z.Dc.$b(I.a.Nn,{["Reason"]:F.a.IG}),U=!1):Z.ly()&&Z.ly().instance&&Z.ly().instance.sX(N)?(Z.Dc.$b(I.a.Nn,{["Reason"]:F.a.b8a}),U=!1):N.Al&&(N=N.node,W.ParagraphReader.Vb(N)&&
N.PT&&(Z.Dc.$b(I.a.Nn,{["Reason"]:F.a.QQ}),U=!1));return{returnValue:1!==T&&U,Iz:U?32:8}}static AWm(T){if(!T.Qw)return!1;let N=1;for(let ba=0;ba<T.length;ba++){var U=T.getContext(ba);if(U&&U.Al&&U.contextId===u.a.paragraph&&(U=U.node))if(U=W.ParagraphReader.Sy(U),!ba)N=U;else if(U!==N)return!0}return!1}}Z.Sn=null;Z.FQ=null;Object(J.a)(Z,"FormattingActionHelper",null,[])},1508:function(J,L,d){d.d(L,"a",function(){return f});d.d(L,"b",function(){return a});var m=d(2);const f=l=>{switch(l){case 2:return WordEditorIntl.WordEditorStrings.L_ResultTypeHeader;
case 4:return WordEditorIntl.WordEditorStrings.L_ResultTypeFooter;case 8:return WordEditorIntl.WordEditorStrings.L_ResultTypeFootnote;case 16:return WordEditorIntl.WordEditorStrings.L_ResultTypeEndnote;case 32:return WordEditorIntl.WordEditorStrings.L_ResultTypeComment}return""},a=()=>{var l;return null===(l=m.AFrameworkApplication.J)||void 0===l?void 0:l.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}},1529:function(J,L,d){J=d(0);class m{constructor(z,x,u,v){this.Xpk=
z;this.fJk=x;this.dJk=u;this.gJk=v}get NWd(){return this.Xpk}get nue(){return this.fJk}get lue(){return this.dJk}get resultType(){return this.gJk}}Object(J.a)(m,"SearchContext",null,[1919]);class f{WXd(z,x,u,v){var E=u-x;let y;if(100<=E)E=x,y=u;else{E=Math.max(0,x+Math.ceil(E/2)-50);y=Math.min(z.length,E+100);E=Math.max(0,y-100);let I;if(E&&" "!==z.charAt(E-1)){I=Math.min(x,E+10);for(var H=E;H<I;++H)if(" "===z.charAt(H)){E=H+1;break}}if(y!==z.length&&" "!==z.charAt(y))for(I=Math.max(u,y-10),H=y-1;H>=
I;--H)if(" "===z.charAt(H)){y=H;break}}z=z.substring(E,y);return new m(z,x-E,u-E,v)}XXd(z){return this.WXd(z.MBi(),z.Ec,z.end,"")}}Object(J.a)(f,"SearchContextFactory",null,[1907]);var a=d(104),l=d(1508);d.d(L,"a",function(){return w});class w extends f{constructor(){super()}XXd(z){let x=z.Ec,u=z.end;const v=({Ec:x,end:u}=w.zBm(z,x,u)).returnValue;z=l.a(z.type);return this.WXd(v,x,u,z)}static get instance(){return null!=w.cYg?w.cYg:w.cYg=new w}static zBm(z,x,u){z=z.MBi();return w.uAj(z,x,u)}static uAj(z,
x,u){const v=a.AParagraphNode.dV(z);if(v.length<z.length){z=z.substring(0,x);const E=a.AParagraphNode.dV(z);z=z.length-E.length;x-=z;u-=z}return{returnValue:v,Ec:x,end:u}}}Object(J.a)(w,"EditorSearchContextFactory",f,[])},1532:function(J,L,d){J=d(0);var m=d(2),f=d(19),a=d(390),l=d(715),w=d(22),z=d(21),x=d(136),u=d(51),v=d(545),E=d(201),y=d(227),H=d(81),I=d(26),F=d(8),C=d(3),P=d(5),K=d(59),G=d(469),R=d(1030);class W{create(){return new R.a}}Object(J.a)(W,"FootnoteEndnoteContainerNodeFactory",null,
[281]);var Z=d(533);d.d(L,"a",function(){return T});class T{constructor(N,U,ba,X,Y,ca,ia,la,ta){this.COd=null;T.ga=N;this.hG=ba;this.q2e=X;this.zpk=ca;this.Zc=ia;this.hb=Y;this.cDk=la;this.Oqk=ta;T.hi=U}Dje(N,U){this.PZl(N);N.Ub(7);this.hG.VWi(N,U)||N.Mf(7)}PZl(N){if(this.q2e.JZi(N)){var U=!1,ba=!1;if(N.Ub(7)){do{const X=N.currentNode;if(37===X.type)switch(X.getValue(P.a.V6)){case 0:ba=!0;break;case 1:U=!0}}while(N.zj(7))}ba||this.CLh(N,0);U||this.CLh(N,1)}}CLh(N,U){const ba=this.zpk.create(K.a.UJa);
ba.setValue(P.a.V6,U);N.Vf(ba,7)}sKo(N){N&&this.WIj(N.isa)}WIj(N){N&&(N=w.SelectionFactory.ue(N.Jb.paragraph,N.Jb.cp+1),this.hb.Kc(N))}KMn(N){let U=this.cDk(N);void 0!==U&&null!==U?this.hG.gta(U)&&(U=this.hG.oCi(U)):U=N;return this.Oqk(U)}X5o(){this.COd?T.hi.$J.removeEntry(this.COd):this.COd=T.hi.$J.cka(WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingUnsupportedNotification,!1);T.hi.$J.Jz(this.COd)}D5k(N,U){N=this.Zc.tsa(N,37,37);let ba=!1;if(N.Zd()){do{const X=N.currentNode;this.hG.Z_f(X)?
this.GRh(X,U):ba=!0}while(N.Gk())}ba&&this.X5o()}GRh(N,U){G.f(N,ba=>{T.xam(ba,U);return!0},12)}gWm(N,U){N=this.hG.s2c(N,U);return N?(N=this.Zc.kg(N))?N.QA():!1:!1}Kwi(N,U){N=this.hG.s2c(N,U);N=this.Zc.kg(N);if(N.Zd()){do if(U=N.currentNode,1===U.getValue(P.a.jsa))return U;while(N.Gk())}return null}static t2c(){return new T(m.AFrameworkApplication.va,z.StaticActiveAppFrame.za(),Z.a.instance,x.PageReader.instance,u.a.instance,new W,new v.a,E.OutlineNavigator.EMn,y.WordSectionNavigator.Wuf)}static get instance(){return null!=
T.mYg?T.mYg:T.mYg=T.t2c()}static get nl(){return null!=T.s1g?T.s1g:T.s1g=f.a.instance.resolve(348)}static xam(N,U){U.rrb?T.nl.ir.aha(N,H.OutlineReader.q_(N)):T.nl.ir.aha(N,0);N=I.a.createTextRange(N,0,F.ParagraphReader.textLength(N));T.ga.Nf(N,C.a.font,2,!0,new a.a,new l.a(U.fontName));T.ga.Nf(N,C.a.gC,2,!0,new a.a,new l.a(U.fontSize))}}T.ga=null;T.hi=null;Object(J.a)(T,"FootnoteEndnoteEditor",null,[296])},1564:function(J,L,d){d.d(L,"a",function(){return K});J=d(0);var m=d(19),f=d(48),a=d(64),l=d(60),
w=d(37),z=d(599),x=d(136),u=d(545),v=d(115),E=d(105),y=d(5),H=d(872),I=d(766),F=d(533),C=d(1457),P=d(1532);class K{constructor(G,R,W,Z,T,N){this.hG=G;this.QQa=W;this.q2e=Z;this.mOe=T;this.Zc=N}static get Xg(){return null!=K.p3g?K.p3g:K.p3g=m.a.instance.Oa(29)}O7m(G,R,W){const Z=this.hzi(R,G.node),T=G.node.Ic;if(!T)return null;const N=new w.GraphTransaction(15);N.Bb(G.node);N.Ii=W;W=this.P7m(Z,R);K.Q7m(W,T,G,R);N.dispose();return W}hzi(G,R){const W=this.Zc.Rl();W.set(R);W.vb(7);W.ld(7);this.QQa.Dje(W,
G);return W}P7m(G,R){const W=I.a.createNode();W.properties.setValue(y.a.V6,R);G.Vf(W,8);this.mOe.ACl(W,R);return W}static get Fg(){return null!=K.PSg?K.PSg:K.PSg=m.a.instance.resolve(322)}static get R0(){return K.sT||(K.sT=new z.WACStyleSet)}static set R0(G){K.sT=G}static t2c(){const {FootnoteEndnoteDefaultContentInserter:G}=d(1685);return new K(F.a.instance,C.a.instance,P.a.instance,x.PageReader.instance,G.instance,new u.a)}static get instance(){return null!=K.WYg?K.WYg:K.WYg=K.t2c()}static Q7m(G,
R,W,Z){a.a.ud().Co&&a.a.ud().Ak.xG(W.node);const T=new v.a;T.setValue(y.a.jic,G.id);T.setValue(y.a.V6,Z);const N=R.ku(T,f.a.create());K.Fg.yla(W,U=>H.a.getInstance(U,N,G.id),K.nti(W.node,Z,Object(E.a)()))}static nti(G,R,W){let Z=null;if(G=W.Iu(G))if(G=K.R0.Oaa(G))R=R?Box4Intl.Box4Strings.L_StyleWordFootnoteReference:Box4Intl.Box4Strings.L_StyleWordEndnoteReference,this.Xg.Ln?(R=G.gv().YAa(R),Z=G.lh(l.a.Wb.ze(R))):Z=G.wKa(R);return Z}}K.sT=null;Object(J.a)(K,"FootnoteEndnoteInserter",null,[315])},
1569:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m{static gAo(f,a){m.T1e=f;m.i5e=a}static dAo(f,a){m.f5e=f;m.a5a=a}static mEi(){return m.f5e===m.a5a?String.format(WordEditorIntl.WordEditorStrings.l_ReplacedAllMessage,m.a5a,m.T1e,m.i5e):String.format(WordEditorIntl.WordEditorStrings.l_ReplacedSomeMessage,m.f5e,m.a5a,m.T1e,m.i5e)}}m.f5e=0;m.a5a=0;m.T1e=null;m.i5e=null;Object(J.a)(m,"ReplaceAllContext",null,[])},1610:function(J,L,d){d.r(L);J=d(0);var m=d(2087),f=d(48),a=d(2),l=d(450),
w=d(19),z=d(2132),x=d(21),u=d(7),v=d(267),E=d(2089),y=d(13),H=d(20),I=d(1529);class F{constructor(Jb="",Zb="",xb=!1,$b=!1){this.Xjn=xb;this.Gnn=$b;this.actionId=Jb;this.fOa=Zb}}Object(J.a)(F,"SearchEntryPointContext",null,[]);class C{constructor(Jb){this.bja=null;this.Ut=!1;this.hQ=Jb}initialize(){this.i2();this.$A();this.X$(0)}$A(){this.bja.$A()}dispose(){this.hQ=null}I3c(){return!1}get XH(){return this.bja?this.bja.XH:0}X$(Jb){this.bja.X$(Jb)}get isVisible(){return this.Ut}nef(Jb){this.bja&&this.bja.OPp(Jb)}uBj(Jb){this.bja&&
this.bja.req(Jb)}t7j(Jb){this.bja&&this.bja.$lq(Jb)}i1h(){this.bja&&this.bja.oSp()}wve(Jb){this.bja&&this.bja.wve(Jb)}}Object(J.a)(C,"FindReplacePane",null,[458,10]);var P=d(80),K=d(1857),G=d(1249),R=d(178),W=d(194),Z=d(1492),T=d(92),N=d(114),U=d(87),ba=d(43),X=d(1359),Y=d(859),ca=d(1399),ia=d(1368),la=d(1413),ta=d(1402),za=d(94),Ha=d(1057);class Na{constructor(Jb){this.KUk=(Zb,xb)=>{this.DOd.lb(Zb)?this.DOd.Z(Zb,xb):this.DOd.add(Zb,xb);(Zb=this.pfm(Zb))&&this.ZSi(xb,Zb,this.l6h(ia.a.getTypeName()))};
this.DOd=new za.a;this.EY=new za.a;this.annotationType=ca.RoleDetectionAnnotation.getTypeName();Jb.Dpo(this.KUk)}ZG(Jb,Zb){let xb;const $b=Jb.parentPath.substr(Jb.parentPath.lastIndexOf("\\")+1),Xb=Jb.content;if(!Xb||this.lnn(Xb))""!==$b&&({value:xb}=this.DOd.Ac($b,xb)).returnValue&&this.ZSi(xb,Jb,this.l6h(Zb)),Zb===ia.a.getTypeName()?(Zb=null,({value:Zb}=this.EY.Ac($b,Zb)).returnValue?this.EY.Z($b,Jb):this.EY.add($b,Jb)):Zb===la.a.getTypeName()&&this.EY.remove($b)}ZSi(Jb,Zb,xb){const $b=this.tvm(Zb);
Zb=this.qfm(Zb);0<Zb&&Jb(xb,$b,Zb)}qfm(Jb){try{return Number.parseInvariant(Jb.id.substr(2))}catch(Zb){u.ULS.sendTraceTag(554747009,367,10,Zb.toString())}return-1}pfm(Jb){let Zb;return({value:Zb}=this.EY.Ac(Jb,Zb)).returnValue?Zb:null}Ugd(Jb){if(Jb)for(const Zb of Jb)this.ZG(Zb,"AugLoop_Core_AddOperation")}tvm(Jb){if(Jb=Jb.content)switch(Jb.roleType){case ca.RoleType.Heading1:return 1;case ca.RoleType.Heading2:return 2;case ca.RoleType.Heading3:return 3;case ca.RoleType.Heading4:return 4;case ca.RoleType.Heading5:return 5;
case ca.RoleType.Heading6:return 6;case ca.RoleType.Heading7:return 7;case ca.RoleType.Heading8:return 8;case ca.RoleType.Heading9:return 9}return-1}lnn(Jb){Jb=Jb.roleType;return Jb===ca.RoleType.Heading1||Jb===ca.RoleType.Heading2||Jb===ca.RoleType.Heading3||Jb===ca.RoleType.Heading4||Jb===ca.RoleType.Heading5||Jb===ca.RoleType.Heading6||Jb===ca.RoleType.Heading7||Jb===ca.RoleType.Heading8||Jb===ca.RoleType.Heading9}l6h(Jb){if(Jb===ia.a.getTypeName()||Jb===ta.a.getTypeName())return Ha.a.DMh;if(Jb===
la.a.getTypeName())return Ha.a.rvf;throw Error.create("Invalid operation type");}}Object(J.a)(Na,"RoleDetectionAnnotationHandler",null,[229]);var ya=d(146),ma=d(62),Ea=d(1762),Ba=d(51),$a=d(75),ea=d(108);class ka{constructor(Jb){this.EY=new za.a;this.svh=Jb}ZG(Jb,Zb){Zb===ia.a.getTypeName()?(Zb=null,({value:Zb}=this.EY.Ac(Jb.id,Zb)).returnValue?this.EY.Z(Jb.id,Jb):this.EY.add(Jb.id,Jb)):Zb===la.a.getTypeName()&&this.EY.remove(Jb.id);this.svh&&this.svh()}Ugd(Jb){if(Jb)for(const Zb of Jb)this.ZG(Zb,
ia.a.getTypeName())}Kic(){var Jb;const Zb=[];if(0<(null===(Jb=this.EY)||void 0===Jb?void 0:Jb.count))for(const xb of this.EY.values)Zb.push(xb);return Zb}}Object(J.a)(ka,"ContractEntityAnnotationHandler",null,[229]);var La=d(3),va=d(1621);class Ca{constructor(Jb){this.ga=Jb}WSn(){this.STd()}ZUn(Jb){this.ga.Pb(H.a.f9d,2,Jb)}dYn(){va.a.Qrd();this.STd()}STd(){this.ga.Ob(La.a.Wdc,2)}s_n(){this.ga.Ob(La.a.vCf,2)}onSearchQueryChanged(Jb){this.ga.Pb(La.a.wCf,2,Jb)}Y0n(){this.ga.Ob(H.a.replace,2)}Z0n(){this.ga.Ob(H.a.replaceAll,
2)}U0n(){this.ga.Ob(y.a.rCf,2)}V0n(){this.ga.Ob(y.a.KCf,2)}X0n(){this.ga.Ob(La.a.hlg,2)}W0n(){this.ga.Ob(La.a.Uag,2)}auc(Jb){this.ga.Pb(H.a.auc,2,Jb)}}Object(J.a)(Ca,"FindReplaceActions",null,[479]);var ua=d(157);class Sa{}Sa.pS=ua.a.upb;Sa.Msc=0;Sa.Vza="FindReplaceTaskPaneData";Sa.qS=WordEditorIntl.WordEditorStrings.L_NavigationPaneTitle;Object(J.a)(Sa,"FindReplaceConstants",null,[]);var Ta=d(762);class zb{d2j(Jb){var Zb,xb,$b;return Y.a.Dqb(null===($b=null===(xb=null===(Zb=x.StaticActiveAppFrame.za())||
void 0===Zb?void 0:Zb.kb)||void 0===xb?void 0:xb.$c)||void 0===$b?void 0:$b.td,Jb)}clearSelection(){if(this.WYe){const Jb=this.d2j(this.WYe);Jb&&Jb.ara()}this.WYe=this.rCh=null}jKo(Jb){this.clearSelection();if(Jb){const Zb=this.d2j(Jb.parentPath);if(Zb){const xb=Jb.content;xb&&(this.rCh=Jb.id,Zb.g_a([new Ta.a(xb.range.start,xb.range.start+xb.range.length)]),Zb.Q6f(0,1));this.WYe=Jb.parentPath}}}}Object(J.a)(zb,"RangeAnnotationContentSelector",null,[]);var Ra=d(1569);class qb{constructor(Jb){this.mBk=
Jb}get zk(){return this.mBk.value}Wym(Jb){Jb=this.zk.m9a(Jb);return this.pgn(Jb)?null:Jb}pgn(Jb){return Jb.id===this.zk.NJa.id}static get instance(){return null!=qb.GXg?qb.GXg:qb.GXg=qb.LG()}static LG(){const Jb=new v.a(()=>z.a.instance.zk);return new qb(Jb)}}Object(J.a)(qb,"SearchResultOrder",null,[]);var kb=d(8),Va=d(268);class Za{constructor(Jb){this.sZe=Jb}get pH(){return this.sZe.value}getSelectedText(){var Jb=this.pH.Ika;if(Jb){const Zb=Jb.cpBegin,xb=Jb.cpEnd-Zb;if(0<xb&&(Jb=Jb.node,kb.ParagraphReader.Vb(Jb)))return Jb.characterData.substr(Zb,
xb)}return null}static getInstance(){return Za.Pm()}static Pm(){const Jb=new v.a(()=>Va.a.instance);return new Za(Jb)}}Object(J.a)(Za,"SelectionHelper",null,[]);var Ka=d(30),bb=d(95),Ib=d(857),ib=d(862),jb=d(358),hb=d(858),pb=d(1873);ua=d(196);var ob=d(237),sb=d(337),Ab=d(105),nc=d(644);class qc extends ua.a{constructor(Jb,Zb,xb){super(Jb,Zb,ob.a.Gsa());this.eNa=xb;this.VLi=!1}get X0f(){return!0}get Dla(){return super.Dla|248}static pHl(Jb){var Zb=x.StaticActiveAppFrame.za().kb.$c;const xb=sb.a.instance.Nc(3);
Zb&&(Zb=Object(Ab.a)().mU(Zb))&&(Jb=new qc(new nc.a,w.a.instance.resolve(78),Jb),xb.Qnd(Jb.pc),Jb.kF(Zb),xb.dispose(),Jb.VLi=!0)}}Object(J.a)(qc,"WordNavigationPaneReactHeadingsView",ua.a,[150,83,10]);class Jc extends C{constructor(Jb,Zb,xb,$b,Xb,Lb,gc,qa,ra,Ya,ab,cb,Eb,mc){var tb,Xa;super(Jb);this.lDb=Sa.pS;this.ENk="FindReplaceTaskPaneProps";this.Yb=P.FocusManager.instance();this.x1a=this.vSa=this.D1=this.n9e=null;this.a4b=a.AFrameworkApplication.J.$("AugLoopOperationsAreEnabled");this.Mlk=a.AFrameworkApplication.J.$("AutoDetectedHeadingsIsEnabled");
this.aDk=null===(tb=a.AFrameworkApplication.J)||void 0===tb?void 0:tb.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactEntities",!1);this.eLc=null===(Xa=a.AFrameworkApplication.J)||void 0===Xa?void 0:Xa.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneAutoFocusOnScroll",!1);this.Z5j=()=>{this.isVisible&&this.tYd===E.a.intelligentPlaceholder&&this.jn()};this.wC=new K.a;this.yih=Zb;this.jQa=E.a.headings;this.OQc=m.a.initial;this.Xwa=new $a.a;this.US="";this.LGc={matchCase:!1,
matchWholeWord:!1};this.h5e="";this.W6e=null;this.V5=xb;this.XDh=!1;this.Bkb=$b;this.hb=Xb;this.sDk=Lb;this.sHa=gc;this.FK=qa;this.xHd=!0;this.d$=this.c$=!1;this.Te=ra;this.$E=Ya;this.Gb=ab;this.CY=cb;this.mbh=Eb;this.Gl=mc;this.QJe&&this.sHa.tto(()=>{this.jn()});this.eLc&&(this.Dme=this.Dme.bind(this))}get V9e(){return 1}get QJe(){return this.a4b&&this.Mlk&&!!this.Te}get RJe(){return this.a4b&&this.aDk&&!!this.Te}get headingsReady(){return this.$E?this.$E.headingsReady:!1}set headingsReady(Jb){this.$E&&
(this.$E.headingsReady=Jb)}get tYd(){return this.jQa}ESj(){this.jQa=E.a.headings;this.jn()}n3o(){this.jQa=E.a.contracts;this.jn()}vSj(){this.jQa=E.a.find;ba.a("NavigationPaneFind");this.jn()}mTj(){this.jQa=E.a.replace;this.jn()}QSj(){this.jQa=E.a.intelligentPlaceholder;this.jn()}Jod(Jb){this.XDh=Jb;this.jn()}I3c(){return this.tYd===E.a.replace}get XH(){return this.OQc}X$(Jb){this.OQc=Jb;this.jn()}nef(Jb){this.XWk(Jb);this.jn()}XWk(Jb){const Zb=this.sDk(Jb[Jb.length-1]);if(Zb){let xb=-1;for(let $b=
0;$b<this.Xwa.count;$b++)if(Zb.id===this.Xwa.K($b).id){xb=$b;break}-1===xb?u.ULS.sendTraceTag(40776785,313,50,"Taskpane AddSearchResult gave illegal -1 index"):this.Xwa.iD(xb,this.J6h(Jb))}else this.Xwa.addRange(this.J6h(Jb))}uBj(Jb){for(const Zb of Jb)for(Jb=this.Xwa.count-1;0<=Jb;Jb--)if(this.Xwa.K(Jb).id===Zb.id){this.Xwa.removeAt(Jb);break}this.jn()}t7j(Jb){for(const Zb of Jb)for(Jb=this.Xwa.count-1;0<=Jb;Jb--)if(this.Xwa.K(Jb).id===Zb.id){this.Xwa.Z(Jb,this.I6h(Zb));break}this.jn()}i1h(){this.Xwa.clear();
this.W6e=null;this.jn()}wve(Jb){this.W6e=Jb?Jb.id:null;this.jn()}J6h(Jb){if(!Jb)return new $a.a;const Zb=new $a.a;for(const xb of Jb)Zb.add(this.I6h(xb));return Zb}I6h(Jb){const Zb=this.Bkb.XXd(Jb);return{id:Jb.id,searchBeginIndex:Zb.nue,searchEndIndex:Zb.lue,searchResult:Zb.NWd}}YDe(){}cxp(){var Jb={};this.hQ.auc(Jb);Jb=Jb[G.a.Value];this.n9e=X.c(Jb)?"":Jb;this.jn()}CVa(){return this.US}eQb(){return this.h5e}oyg(Jb){this.US=Jb;this.jn()}mIa(){}initialize(){this.cMd=window.performance.now();const Jb=
this.Yb.ie(this.lDb);Jb.parent=R.AFrame.Eq;Jb.HL=!0;this.i2();this.X$(m.a.initial)}kS(){this.isVisible?(u.ULS.sendTraceTag(527237715,312,50,"Navpane is already open, so making it the selected task pane."),W.UISurfaces.Iv().then(Jb=>{Jb.setSelectedTaskPane(this.lDb,this.V9e);this.lca();this.xHd&&this.SNj(!0);return null}).catch(Jb=>{Jc.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],Jb)})):(this.Qod(),this.xHd&&this.SNj(!1))}SNj(Jb){const Zb=this.yih();Zb?this.US=Zb:Jb&&this.US||
(this.US="");this.hQ.onSearchQueryChanged(this.US)}Lsa(){W.UISurfaces.Iv().then(Jb=>{Jb.hideTaskPane(this.lDb,this.V9e);return null}).catch(Jb=>{Jc.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],Jb)})}i2(){this.V5.nUa();this.D1=this.V5.wfc(this.Yb);this.vUk()}Qod(){W.UISurfaces.Iv().then(Jb=>{this.cMd=window.performance.now();Jb.showTaskPane(this.lDb,this.EB());Jb=[Object.assign(new Ka.a,{name:"Tab",string:this.jQa})];const Zb=window.performance.now()-this.cMd;ba.a("NavigationPaneOpen",
!0,Zb,Jb);return null}).catch(Jb=>{Jc.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],Jb)})}jn(){W.UISurfaces.Iv().then(Jb=>{Jb.updateTaskPane(this.lDb,this.EB());return null}).catch(Jb=>{Jc.recordQosError("NavPaneUpdateActionFailure",["NavPaneInteractionFailed"],Jb)})}EB(){var Jb;const Zb={activeTab:E.a.initial};this.wC.dyb(Zb);a.AFrameworkApplication.vd("ImprovedNavPaneDiscoverability;ImprovedNavPaneDiscoverabilityCf");const xb=null===(Jb=a.AFrameworkApplication.J)||void 0===
Jb?void 0:Jb.getBooleanFeatureGate("Microsoft.Office.WordOnline.ImprovedNavPaneDiscoverabilityIsEnabled",!1);return Object.assign(new Z.a,{title:Sa.qS,hideHeader:!1,width:320,location:this.V9e,contentProps:Zb,onOpen:()=>{this.Ut=!0;this.Sso();this.Rpo();this.xHd&&this.lca();a.AFrameworkApplication.vd("NavPaneAutoFocusOnScroll-tf;NavPaneAutoFocusOnScroll-cf");this.eLc&&this.Lro();x.StaticActiveAppFrame.za().Fe();x.StaticActiveAppFrame.za().E5a(this.Z5j)},onClose:()=>{try{const $b=window.performance.now();
this.bha();this.Ut=!1;this.qpp();this.Upp();this.eLc&&this.Kpp();this.hQ.dYn();this.n9e="";this.OQc=m.a.initial;x.StaticActiveAppFrame.za().Juc(this.Z5j);x.StaticActiveAppFrame.za().Fe();const Xb=window.performance.now()-$b;ba.a("NavigationPaneClose",!0,Xb)}catch($b){Jc.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],$b)}},enableResize:!1,minResizeWidth:280,maxResizeWidth:920,isModernPane:!0,isNonClosablePane:xb,showBackButton:xb,onManualClose:()=>{xb&&ba.a("NavPaneBackButtonPressed")}})}Sso(){this.QJe&&
!this.vSa&&Y.a.hm().then(()=>{this.vSa=new Na(this.sHa);this.Te.nb(this.vSa,this.vSa.annotationType);this.Te.getAnnotationsByType(this.vSa.annotationType).then(Jb=>{this.vSa.Ugd(Jb)})})}Upp(){this.QJe&&this.vSa&&(this.Te.xc(this.vSa,this.vSa.annotationType),this.vSa=null)}xkp(){if(this.RJe){var Jb=new pb.ContractEntitySignal;Jb=Object.assign(new ib.a,{parentPath:["Signal",jb.a.getTypeNameFor(Jb)],items:[Object.assign(new hb.a,{body:Jb})]});this.CY.getAugLoopRuntimeManager().submitOperation(Object.assign(new Ib.a,
{operation:Jb}))}}Rpo(){this.RJe&&!this.x1a&&Y.a.hm().then(()=>{this.x1a=new ka(this.jn);this.Te.nb(this.x1a,pb.ContractEntityAnnotation.getTypeName());this.xkp();this.Te.getAnnotationsByType(pb.ContractEntityAnnotation.getTypeName()).then(Jb=>{this.x1a.Ugd(Jb)})})}get ij(){return this.Gl}Lro(){this.ij.JYk(this.Dme)}Kpp(){this.ij.nxo(this.Dme)}qpp(){this.RJe&&this.x1a&&(this.Te.xc(this.x1a,pb.ContractEntityAnnotation.getTypeName()),this.x1a=null)}vUk(){this.wC.IN(this.Mpm());this.wC.IN(this.Opm());
this.wC.IN(this.rsm());this.wC.IN(this.Xkm());this.wC.IN(this.kum());this.wC.IN(this.Mdm());this.wC.IN(this.onLinkExecute());this.wC.IN(this.onPivotTabExecute());this.wC.IN(this.nIm());this.wC.IN(this.lLm());this.wC.IN(this.Ptm());this.wC.IN(this.ZLm());this.wC.IN(this.yFm())}ZLm(){return Jb=>{Jb.autoDetectedHeadingsToggleDisabled=this.sHa?!this.sHa.L9k():!0}}lLm(){return Jb=>{Jb.type=this.ENk}}onLinkExecute(){return Jb=>{Jb.onLinkExecute=()=>{this.hQ.s_n()}}}Dme(){this.ij.Gvc||(this.JTe&&this.Gb.uf(this.JTe),
this.JTe=new T.a(0,1,0,()=>{this.$E.fZm(this.ij.Fcm());this.jn()}),this.Gb.Zb(this.JTe))}onPivotTabExecute(){return Jb=>{Jb.onPivotTabExecute=Zb=>{switch(Zb){case E.a.headings:this.ESj();break;case E.a.replace:this.mTj();break;case E.a.contracts:this.n3o();break;case E.a.intelligentPlaceholder:this.QSj();break;default:this.vSj()}X.b(this.US)&&(this.US=this.yih(),this.US||(this.US=""),X.b(this.US)||(this.hQ.onSearchQueryChanged(this.US),this.jn()))}}}nIm(){return Jb=>{Jb.showOutOfSyncNotification=
this.XDh}}Opm(){return Jb=>{Jb.findSearchBoxContent={onSearchQueryChanged:Zb=>{this.US=Zb;this.jn();this.hQ.onSearchQueryChanged(Zb)},findOptions:this.LGc,matchCase:this.c$,matchWholeWord:this.d$,findSearchText:this.US,onClearButtonExecute:()=>{void 0!==this.US&&null!==this.US&&""!==this.US&&(this.US="",this.hb.Kc(null),this.hQ.WSn())},onMatchCaseExecute:()=>{this.LGc.matchCase=!this.LGc.matchCase;this.c$=!this.c$;this.jn();this.hQ.U0n()},onMatchWholeWordExecute:()=>{this.LGc.matchWholeWord=!this.LGc.matchWholeWord;
this.d$=!this.d$;this.jn();this.hQ.V0n()},onMenuClose:()=>{if(this.D1)this.D1.onMenuClose()},onMenuOpen:()=>{if(this.D1)this.D1.onMenuOpen()}}}}Mdm(){return Jb=>{Jb.activeTab=this.tYd}}Ptm(){return Jb=>{Jb.autoDetectedHeadingsToggleState=this.sHa?this.sHa.M9k:!1;this.$E.j_c=Jb.autoDetectedHeadingsToggleState;!Jb.autoDetectedHeadingsToggleState&&this.sHa&&this.sHa.Zqd(!1)}}Mpm(){return Jb=>{const Zb={onReplaceAllExecute:()=>{this.hQ.Z0n()},onReplaceExecute:()=>{this.hQ.Y0n()},onReplaceQueryChanged:xb=>
{this.h5e=xb;this.jn()},replaceSearchText:this.h5e};Jb.findReplaceContent={searchResults:this.Xwa.toArray(),replaceSearchBoxContent:Zb,onNextSearchResultExecute:()=>{this.hQ.W0n()},onPrevSearchResultExecute:()=>{this.hQ.X0n()},onSearchResultSelected:xb=>{const {FindReplaceUIManager:$b}=d(1610);this.hQ.ZUn(xb);$b.F9i(1)},selectedResultId:this.W6e,summaryLabel:this.n9e,explanationText:this.Zom(this.OQc),haveTooManySearchResults:this.OQc===m.a.Jha}}}Zom(Jb){switch(Jb){case m.a.initial:return WordEditorIntl.WordEditorStrings.l_LandingMessage;
case m.a.oYa:return WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;case m.a.Nuc:return Ra.a.mEi();case m.a.Jha:return WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage;default:return""}}yFm(){return Jb=>{Jb.replaceFollowUpsWithCommentsIsEnabled=!0}}kum(){return Jb=>{var Zb=this.FK.Cem();const xb=[];for(const $b of Zb)Zb=this.FK.W3d($b.Ic,$b.id),xb.push({id:$b.id.toString(),intelligentPlaceholderAnchorText:Zb});Jb.intelligentPlaceholderContent={intelligentPlaceholderContentEntry:xb,onIntelligentPlaceholderInputExecute:$b=>
{this.US=$b;this.jQa=E.a.find;this.jn();this.hQ.onSearchQueryChanged($b)},onSearchResultSelected:$b=>{this.jn();$b=f.a.Cf($b);this.FK.tKo($b)}}}}rsm(){return Jb=>{var Zb;let xb=()=>{};this.sHa&&(xb=Object(ea.a)(this.sHa,this.sHa.Zqd,"toggleAutoDetectedHeadings"));const $b=null===(Zb=a.AFrameworkApplication.J)||void 0===Zb?void 0:Zb.getBooleanFeatureGate("Microsoft.Office.WordOnline.InitialHeadingsInNavPaneFix",!1);Jb.headingsContent={onHeaderInputExecute:Xb=>{this.US=Xb;this.jQa=E.a.find;this.jn();
ba.a("NavigationPaneFind");this.hQ.onSearchQueryChanged(Xb)},renderHeadingContent:(Xb,Lb,gc)=>{this.Gb.Zb(new T.a(0,1,100,()=>{var qa=window.performance.now()-this.cMd;if($b)this.headingsReady=!0,this.jn();else{var ra=this.$E.N3;this.headingsReady=!0;this.jn();gc.style.display="none";ra.first&&(Xb.style.display="block")}this.Gb.Zb(new T.a(1,1,0,()=>{qc.pHl(this)}));ra=window.performance.now()-this.cMd;ba.a("NavigationPaneHeadingsLoaded",!0,ra,[Object.assign(new Ka.a,{name:"NavPaneReactHeadings",bool:!0})]);
qa=[Object.assign(new Ka.a,{name:"HeadingFetchStart",double:qa}),Object.assign(new Ka.a,{name:"HeadingFetchFinished",double:ra})];ba.a("NavigationPaneHeadingsLoadDetails",!0,void 0,qa)}))},autoDetectedHeadingsToggle:xb,onHeadingsUnmounted:()=>{this.headingsReady=!1},headingsReady:this.headingsReady,headingsList:this.$E.N3,onHeadingChevronClick:Xb=>{this.$E.J1l(Xb);this.jn()},onClickHeading:Xb=>{this.ij.Gvc=this.eLc;if(this.Gb.Yy){u.ULS.sendTraceTag(512328290,312,50,"OnClickHeading: TaskManager isYielding, creating an onclick task for [HeadingParagraphID: {0}]",
Xb);const Lb=window.performance.now();this.Gb.Zb(new T.a(0,1,0,()=>{this.$E.onClickHeading(Xb);this.jn();const gc=window.performance.now()-Lb;ba.a("NavigationPaneAsyncOnClickHeadingItem",!0,gc)}))}else this.$E.onClickHeading(Xb),this.jn()},onClickBookmark:Xb=>{this.ij.Gvc=this.eLc;if(this.Gb.Yy){u.ULS.sendTraceTag(512328289,312,50,"OnClickBookmark: TaskManager isYielding, creating an onclick task for [BookmarkName: {0}]",Xb);const Lb=window.performance.now();this.Gb.Zb(new T.a(0,1,0,()=>{this.$E.onClickBookmark(Xb);
this.jn();const gc=window.performance.now()-Lb;ba.a("NavigationPaneAsyncOnClickHeadingItem",!0,gc)}))}else this.$E.onClickBookmark(Xb),this.jn()},onShareHeadingClick:Xb=>{this.$E.onShareHeadingClick(Xb)},bookmarkIconUrl:ya.a.ki("BookmarkDefault.png")}}}Wkm(){var Jb,Zb=null===(Jb=this.x1a)||void 0===Jb?void 0:Jb.Kic();if(Zb){Jb=Array(Zb.length);let xb=0;for(const $b of Zb)(Zb=$b.content)&&(Jb[xb++]={id:$b.id,type:Zb.type,value:Zb.value});return Jb}return null}Xkm(){return Jb=>{Jb.contractsContent=
{onHeaderInputExecute:Zb=>{this.US=Zb;this.jQa=E.a.find;this.jn();ba.a("NavigationPaneFind");this.hQ.onSearchQueryChanged(Zb)},contractEntities:this.Wkm(),selectedEntityId:this.mbh.rCh,onEntitySelected:Zb=>{var xb;const $b=null===(xb=this.x1a)||void 0===xb?void 0:xb.Kic();if($b)for(const Xb of $b)if(Xb.id===Zb){this.mbh.jKo(Xb);break}this.jn()}}}}iNj(Jb){this.xHd=Jb}jvp(Jb){this.Gb.Zb(new T.a(0,1,0,()=>{this.$E.oLg(Jb)&&this.jn()}))}BKi(Jb){this.Gb.Zb(new T.a(0,1,0,()=>{const Zb=this.$E.PXb;this.$E.Vci(Jb)?
this.jn():0===this.$E.PXb&&0<Zb&&this.jn()}))}AKg(Jb,Zb){this.Gb.Zb(new T.a(0,1,0,()=>{const xb=this.$E.PXb;this.$E.AKg(Jb,Zb)?this.jn():0<this.$E.PXb&&0===xb&&this.jn()}))}wNl(Jb){this.Gb.Zb(new T.a(0,1,0,()=>{const Zb=this.$E.PXb;this.$E.xNl(Jb)?this.jn():0===this.$E.PXb&&0<Zb&&this.jn()}))}EWo(Jb){this.$E.Shp(Jb);this.jn()}YKg(Jb){this.$E.YKg(Jb)&&this.jn()}kZd(Jb){this.$E.kZd(Jb)&&this.jn()}sgo(){return 0<this.$E.PXb}lca(){this.Yb.Jg(this.lDb);u.ULS.sendTraceTag(40469190,312,50,"Taskpane now visible with focus on SearchBox")}bha(){if(this.zab()){var Jb;
(Jb=Object(ma.a)().Ad)?(Jb=Jb.nL,u.ULS.sendTraceTag(40469191,312,50,"Taskpane now hidden with focus on previous selection view.")):(Jb=this.Yb.IW,u.ULS.sendTraceTag(40469192,312,50,"Taskpane now hidden with focus on default scope."));this.Yb.Jg(Jb)}}zab(){return!!this.Yb.currentScope&&this.Yb.currentScope.name===this.lDb}static getInstance(){return Jc.Pm()}static Pm(){var Jb,Zb;return new Jc(new Ca(a.AFrameworkApplication.va),Object(ea.a)(Za.getInstance(),Za.getInstance().getSelectedText,"getSelectedText"),
Ea.a.instance,I.a.instance,Ba.a.instance,Object(ea.a)(qb.instance,qb.instance.Wym,"getNextSearchResult"),w.a.instance.Oa(639),w.a.instance.Oa(696),w.a.instance.Oa(451),w.a.instance.resolve(725),N.a.instance,w.a.instance.resolve(658),new zb,null===(Zb=null===(Jb=x.StaticActiveAppFrame.za())||void 0===Jb?void 0:Jb.kb)||void 0===Zb?void 0:Zb.Jc)}static recordQosError(Jb,Zb,xb){const $b=Object.assign(new bb.a,{extendedProperties:new Map});xb&&$b.extendedProperties.set("exception",xb);U.Health.instance.recordQosError(Jb,
Zb,!1,!0,!1,!1,$b)}}Object(J.a)(Jc,"ReactFindReplacePane",C,[457,458,10]);var ad=d(1508);d.d(L,"FindReplaceUIManager",function(){return Kc});class Kc{constructor(Jb,Zb,xb=null,$b=null,Xb=null,Lb=null){this.qyd=this.x5=0;this.d$=this.c$=this.AIb=!1;this.Zm=this.Puh=this.ooa=null;this.uLa=this.kXe=!1;this.Oj=Jb;this.Mp=xb;this.Bkb=$b;this.Arh=Xb;this.Xd=Lb;Kc.Mdc=new F}get o_f(){return this.kXe}set o_f(Jb){Jb!==this.kXe&&(this.kXe=Jb,this.Q_h())}Bxe(Jb){this.x5=Jb;this.update();this.x5||this.XH!==m.a.Axb&&
this.XH!==m.a.Jha?0<this.x5&&this.XH===m.a.oYa?this.X$(m.a.Axb):this.x5>Kc.S_j&&this.XH!==m.a.Jha&&(u.ULS.sendTraceTag(4065350,312,50,"Shifting to TooManyResults UI"),this.X$(m.a.Jha)):this.X$(m.a.oYa)}Xve(Jb){this.qyd=Jb;this.uLa&&this.update();this.Arh&&!this.Arh.value.mkd&&this.Lxg()}reset(){}ICf(){this.Xd&&(this.Zm=this.Xd.Wf("UserAction","Find"));if(this.uLa||!this.XH)this.uLa=!1,u.ULS.sendTraceTag(4065351,312,50,"FindStarted");this.X$(m.a.DIj)}Shc(){var Jb;this.uLa=!0;let Zb=this.x5?m.a.Axb:
m.a.oYa;if(this.XH!==m.a.Jha&&z.a.instance){const xb=z.a.instance.zk;0<xb.Pna&&(xb.Pna>Kc.S_j?Zb=m.a.Jha:this.mwp(xb))}this.X$(Zb);this.update();this.Zm&&(this.Zm.stop(),this.Zm=null);Kc.AIj=f.a.create().toString();Kc.F9i(0,this.Mfc,this.CVa().length,this.x5);Object(ad.b)()&&(null===(Jb=this.Oj)||void 0===Jb?0:Jb.isVisible)&&(Jb={},a.AFrameworkApplication.va.Pb(y.a.Bre,2,Jb),Jb[l.a.On]&&a.AFrameworkApplication.va.Pb(y.a.Nbe,2,{CommandValueId:{query:this.CVa(),matchCase:this.c$,matchWholeWordOnly:this.d$,
totalResultLimit:-1}}))}mwp(Jb){const Zb=Jb.NJa;let xb=Zb;const $b=[];do $b[$b.length]=xb,xb=Jb.m9a(xb);while(Zb!==xb);this.Oj.nef($b);this.ooa&&this.Oj.wve(this.ooa)}update(){this.Oj&&this.Oj.cxp()}get XH(){return this.Oj.XH}get Mfc(){return this.Oj.tYd}fyb(Jb){this.o_f=Jb}Q_h(){if(this.o_f)switch(this.XH){case m.a.Axb:case m.a.oYa:case m.a.Jha:this.Oj.Jod(!0)}else this.Oj.Jod(!1)}X$(Jb){if(this.Oj.isVisible){switch(Jb){case m.a.oYa:case m.a.Axb:this.XH===m.a.Jha&&(Jb=m.a.Jha)}this.Oj&&(this.Oj.X$(Jb),
this.Q_h());this.update();this.Lxg()}}dVa(Jb,Zb){const xb=this.uLa&&this.XH!==m.a.Jha;switch(Jb){case 0:xb&&this.Oj.nef(Zb);break;case 1:xb&&this.Oj.uBj(Zb);break;case 4:xb&&this.Oj.t7j(Zb);break;case 2:this.Oj.i1h();break;case 3:this.ooa=Zb[0],xb&&0<this.x5&&this.Oj.wve(this.ooa)}}get matchCase(){return this.c$}set matchCase(Jb){this.c$!==Jb&&(this.c$=Jb,this.v5j())}get matchWholeWord(){return this.d$}set matchWholeWord(Jb){this.d$!==Jb&&(this.d$=Jb,this.v5j())}v5j(){this.Oj.YDe()}CVa(){return this.Oj.CVa()}eQb(){return this.Oj.eQb()}oyg(Jb){this.Oj.oyg(Jb)}mIa(){this.Oj.mIa()}get nTj(){return 0<
this.x5&&this.XH!==m.a.Ouc&&this.XH!==m.a.Nuc}kOo(Jb){let Zb="";Jb?Zb=0<this.x5?String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplacedAndMoveToNextResult,this.CVa(),this.eQb()):String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplaceWithNoMoreResults,this.CVa(),this.eQb()):Jb||0<this.x5&&(Zb=WordEditorIntl.WordEditorStrings.l_ReadoutReplaceSkippedAndMoveToNextResult);this.Lxg(Zb)}dispose(){this.Oj.dispose()}I3c(){return this.Oj.I3c()}eTo(Jb,Zb=!0){Jb!==this.Mfc&&(Jb===E.a.headings?
(u.ULS.sendTraceTag(9056651,367,50,""),this.Oj.ESj()):Jb===E.a.find?this.Oj.vSj():Jb===E.a.replace?this.Oj.mTj():Jb===E.a.intelligentPlaceholder&&(Zb||this.Oj.iNj(Zb),this.Oj.QSj()))}fA(Jb,Zb=!0){this.Oj.iNj(Zb);Jb?(this.AIb||this.lUf(),this.Oj.kS(),this.x5||this.XH===m.a.oYa?a.AFrameworkApplication.J&&a.AFrameworkApplication.J.$("WordEditorFindReplaceCancelButtonFixIsEnabled")&&this.Oj.X$(m.a.Axb):this.X$(m.a.initial)):this.Oj.Lsa()}lUf(){this.AIb||(this.Oj.initialize(),this.AIb=!0)}Lxg(Jb=""){var Zb=
this.NFm();Zb&&(Jb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,Jb,Zb));this.Bkb&&Zb&&this.ooa&&this.XH!==m.a.Jha&&this.XH!==m.a.Ouc&&(Zb=this.Bkb.XXd(this.ooa),Jb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,Jb,Zb.NWd));(Zb=this.Yom())&&(Jb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,Jb,Zb));this.Mp&&Jb&&this.Puh!==Jb&&(this.Puh=Jb,this.Mp.sendNotification(Jb,
!0))}NFm(){let Jb="";switch(this.XH){case m.a.eWj:Jb=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case m.a.Axb:Jb=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.qyd,this.x5);break;case m.a.Jha:this.uLa&&(Jb=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.qyd,this.x5));break;case m.a.oYa:Jb=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case m.a.Ouc:Jb=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgressReadout;break;
case m.a.Nuc:Jb=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}return Jb}Yom(){let Jb="";switch(this.XH){case m.a.initial:Jb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,WordEditorIntl.WordEditorStrings.l_LandingMessage,this.Gpm());break;case m.a.oYa:Jb=WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;break;case m.a.Nuc:Jb=Ra.a.mEi();break;case m.a.Jha:Jb=WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage}return Jb}Gpm(){let Jb=
"";this.c$&&this.d$?Jb=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOptions,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):this.c$?Jb=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,WordEditorIntl.WordEditorStrings.l_MatchCase):this.d$&&(Jb=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));return Jb}static getInstance(Jb){return Kc.Pm(Jb)}static Pm(Jb){const Zb=
Jc.getInstance();return new Kc(Zb,Jb,w.a.instance.resolve(26),I.a.instance,new v.a(()=>z.a.instance.cZb),x.StaticActiveAppFrame.za().Vr)}static F9i(Jb,Zb=-1,xb=-1,$b=-1){u.ULS.sendTraceTag(4065352,312,50,"{0}",{["SearchOp"]:Jb,["SearchComplete.ResultsCount"]:$b,["SearchOpsCorrelation"]:Kc.AIj,["ActionId"]:Kc.Mdc.actionId,["SourceControlId"]:Kc.Mdc.fOa,["IsNavPanOpenedAlready"]:Kc.Mdc.Xjn,["IsSearchFromNavPane"]:Kc.Mdc.Gnn,["CurrentTab"]:Zb,["QueryLength"]:xb})}static ygl(Jb,Zb,xb){Zb=void 0!==Zb&&
null!==Zb?void 0===Zb.SourceControlId||null===Zb.SourceControlId?"Unknown":Zb.SourceControlId:Jb===H.a.Byb?"FindKeyboardShorcut":Jb===H.a.Cyb?"ReplaceKeyboardShorcut":"Unknown";switch(Jb){case H.a.lxc:Jb="ShowHeadingsPane";break;case H.a.Byb:Jb="ShowFindPane";break;case H.a.Cyb:Jb="ShowReplacePane";break;case H.a.oxc:Jb="ShowIntelligentPlaceholderPane";break;case H.a.$_a:Jb="ToggleNavigationPane";break;default:Jb="Unknown"}Kc.Mdc=new F(Jb,Zb,xb,!0)}}Kc.S_j=100;Kc.AIj=null;Kc.Mdc=null;Object(J.a)(Kc,
"FindReplaceUIManager",null,[421,422,10])},1611:function(J,L,d){d.r(L);J=d(0);var m=d(178),f=d(138),a=d(93),l=d(2),w=d(19),z=d(80),x=d(1060),u=d(68),v=d(21),E=d(7),y=d(20),H=d(478),I=d(1457),F=d(1830),C=d(71),P=d(368),K=d(10),G=d(451),R=d(38),W=d(263),Z=d(727),T=d(51),N=d(157),U=d(533),ba=d(1686);class X{constructor(Va,Za,Ka,bb,Ib,ib,jb){this.xuh=this.Pyh=this.Ahh=this.CK=this.dgb=this.u3b=this.NRe=this.GNe=this.oPe=this.XY=this.Kia=this.Via=null;this.KDe=()=>{const hb=this.Txa.ujc(this.CK),pb=this.Txa.Yqm(this.CK);
this.GNe.innerText=hb.toString();this.NRe.innerText=pb.toString();F.a.e_b(this.Via,1===hb?!1:!0);F.a.e_b(this.Kia,hb===pb?!1:!0)};this.FQo=()=>{const hb=this.Yb.getRegion(N.a.q8a);let pb;if(this.XY&&!this.XY.disabled)pb=this.XY;else if(this.Via.disabled){if(this.Kia.disabled)return;pb=this.Kia}else pb=this.Via;pb.focus();hb.Nk.hA(pb)};this.Hua=(hb,pb)=>{(hb=pb.Rm.currentSelection)&&this.XY&&F.a.e_b(this.XY,R.a.Am(hb)?!0:!1)};this.gof=()=>{if(!this.Kia.disabled){const hb=this.Txa.Lsb(this.CK)?y.a.Sje:
y.a.Rje;this.ga.Ob(hb,2)}return!0};this.hof=()=>{if(!this.Via.disabled){const hb=this.Txa.Lsb(this.CK)?y.a.Uje:y.a.Tje;this.ga.Ob(hb,2)}return!0};this.fof=()=>{this.XY&&!this.XY.disabled&&this.ga.Ob(y.a.G4i,2);return!0};this.Yb=Va;this.ga=bb;this.Dg=Ib;this.oe=ib;this.hb=jb;this.Txa=Ka;this.jaa=document.createElement("div");this.jaa.classList.add("FootnoteEndnoteActionBarControl");this.jaa.style.zIndex=String(W.a.K_d);this.jaa.style.position="relative";this.NFc=document.createElement("div");this.NFc.classList.add("FootnoteEndnoteActionBarControlDividerElement");
this.jaa.appendChild(this.NFc);this.PAl();this.jaa.appendChild(this.u3b);this.jaa.appendChild(this.dgb);this.r1=f.KeyInputManager.mc(a.a.G4,0);this.o4m();this.n4m()}Bka(Va){E.ULS.shipAssertTag(4520065,308,this.Txa.gta(Va));if(this.CK!==Va){this.CK=Va;this.KDe();Va=this.Txa.Lsb(this.CK);this.EDl(Va);this.CK.xOh(this.KDe);let Za="",Ka="";const bb=this.Txa.ujc(this.CK);-1!==bb&&(Za=(bb-1).toString(),Ka=(bb+1).toString());Va?(this.Kia.title=this.Kia.disabled?WordEditorIntl.WordEditorStrings.L_NextFootnote:
String.format(WordEditorIntl.WordEditorStrings.L_NextFootnoteWithNumber,Ka),this.Via.title=this.Via.disabled?WordEditorIntl.WordEditorStrings.L_PrevFootnote:String.format(WordEditorIntl.WordEditorStrings.L_PrevFootnoteWithNumber,Za)):(this.Kia.title=this.Kia.disabled?WordEditorIntl.WordEditorStrings.L_NextEndnote:String.format(WordEditorIntl.WordEditorStrings.L_NextEndnoteWithNumber,Ka),this.Via.title=this.Via.disabled?WordEditorIntl.WordEditorStrings.L_PrevEndnote:String.format(WordEditorIntl.WordEditorStrings.L_PrevEndnoteWithNumber,
Za));this.Iwb()}}bNb(){this.CK&&(this.XY&&this.XY.parentNode===this.u3b&&this.u3b.removeChild(this.XY),this.VOa(),this.CK.Nxo(this.KDe),this.CK=null)}dispose(){this.Yb.ie(N.a.q8a).nt(this.r1)}EDl(Va){3===this.ga.mode&&(Va=Va?WordEditorIntl.WordEditorStrings.L_FormatFootnotes:WordEditorIntl.WordEditorStrings.L_FormatEndnotes,this.XY=this.Crf("FootnoteEndnoteFormattingOptionButton","FootnoteEndnoteActionBarFormattingButton",Va,null),C.a.Gs(this.XY,C.a.Aja,Va),this.u3b.appendChild(this.XY))}PAl(){this.u3b=
document.createElement("div");this.u3b.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarLeftDiv");this.dgb=document.createElement("div");this.dgb.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarRightDiv");this.Via=this.Crf("FootnoteEndnotePreviousButton","FootnoteEndnoteActionBarNavigationButton","","LeftPageArrow_20x20x32");this.dgb.appendChild(this.Via);this.GNe=G.b("span","FootnoteEndnoteActionBarCurrentCount","FootnoteEndnoteActionBar");
this.dgb.appendChild(this.GNe);this.oPe=G.b("span","FootnoteEndnoteActionBarDivider","FootnoteEndnoteActionBar");this.oPe.innerText=" / ";this.dgb.appendChild(this.oPe);this.NRe=G.b("span","FootnoteEndnoteActionBarTotalCount","FootnoteEndnoteActionBar");this.dgb.appendChild(this.NRe);this.Kia=this.Crf("FootnoteEndnoteNextButton","FootnoteEndnoteActionBarNavigationButton","","RightPageArrow_20x20x32");this.dgb.appendChild(this.Kia)}Crf(Va,Za,Ka,bb){Va=F.a.Y6a(Va,Za,Ka,bb,void 0===bb||null===bb);Va.setAttribute(C.a.Ph,
C.a.K$);return Va}o4m(){const Va=this.Yb.ie(N.a.q8a);Va.parent=Z.a.Eq;Va.bindAction(this.r1,y.a.I6);Va.sja(this.FQo)}n4m(){var Va=new P.DOMFocusListing(()=>this.jaa);Va.$ma=!1;Va.Yn(2);Va.Yn(1);Va=this.Yb.PKb(this.jaa,this.Yb.ie(N.a.q8a),Va);Va.AZa();Va.NR=!0}Iwb(){this.XY&&(this.Dg.nb(K.a.click,this.XY,this.fof),this.Ahh=this.oe.Hwb(this.XY,this.fof,a.a.Nu));this.Dg.nb(K.a.click,this.Via,this.hof);this.Pyh=this.oe.Hwb(this.Via,this.hof,a.a.Nu);this.Dg.nb(K.a.click,this.Kia,this.gof);this.xuh=this.oe.Hwb(this.Kia,
this.gof,a.a.Nu);this.hb.tA(this.Hua)}VOa(){this.XY&&(this.Dg.xc(K.a.click,this.XY,this.fof),this.oe.Xzb(this.XY,this.Ahh));this.Dg.xc(K.a.click,this.Via,this.hof);this.oe.Xzb(this.Via,this.Pyh);this.Dg.xc(K.a.click,this.Kia,this.gof);this.oe.Xzb(this.Kia,this.xuh);this.hb.Rga(this.Hua)}static Tqm(){return X.Uqm()}static Uqm(){return new X(z.FocusManager.instance(),ba.a.instance,U.a.instance,l.AFrameworkApplication.va,v.StaticActiveAppFrame.za().KE,v.StaticActiveAppFrame.za().LE,T.a.instance)}}Object(J.a)(X,
"FootnoteEndnoteActionBarControl",null,[353]);var Y=d(292),ca=d(13),ia=d(1532),la=d(1785);class ta{constructor(Va,Za,Ka,bb,Ib,ib,jb,hb,pb,ob,sb,Ab){this.kG=null;this.WV=!1;this.ix=null;this.onClick=()=>{this.dismiss(!1,!0);return!0};this.u9b=Va;this.Pgc=Za;this.fCc=Ka;this.VEk=bb;this.f1e=Ib;this.Xm=ib;this.lib=jb;this.Dg=hb;this.txh=pb;this.Ark=sb;this.Is=this.u9b.ownerDocument.createElement("div");this.Is.id="FootnoteEndnoteControlOverlay";this.Is.className="EditingSurfaceOverlay";this.sK=this.Ykm();
this.b4(!1);this.u9b.appendChild(this.Is);this.u9b.appendChild(this.sK);this.Pgc.bind();this.zi=null;this.ga=Ab;this.QQa=ob}QCo(){const Va=this.txh();Va&&Va.gj&&(Va.xxb=0,Va.gRd())}u4j(Va){if(this.USc){const Za=this.USc.isa;Za&&(Za.$Xf=Va)}}get VJ(){return this.WV}get USc(){return this.kG}get dialog(){return this.zi}get $n(){return null!=this.AWg?this.AWg:this.AWg=w.a.instance.Ra(6)}fsf(){this.zi=la.a.brm()}Kkd(){this.zi=null}show(Va=!0){this.WV||(this.u4j(!0),this.Ark(),this.b4(!0),this.$A(),Va&&
this.setFocus())}setFocus(){this.WV&&(this.Pgc.qwc(),this.VEk())}update(){this.WV&&(this.kG.isConnected?this.fCc.KDe():this.dismiss())}dismiss(Va=!1,Za=!1){this.WV&&(this.u4j(!1),this.Jca(),this.QCo(),this.b4(!1),this.f1e(Za),this.zi&&(this.ga.Ob(ca.a.mYc,2),this.zi=null),!Va&&this.kG&&this.kG.isConnected&&this.QQa.sKo(this.kG),this.bNb())}zBo(Va){const Za=null!==this.$n.instance?this.$n.instance.yj:1;this.sK.style.width=Va.d5h*Za+"px";this.ix.style.width=Va.ZVc*Za+"px";this.sK.style.marginLeft=Va.Qec*
Za+"px";this.Xm?this.ix.style.marginRight=Va.Qqf*Za+"px":this.ix.style.marginLeft=Va.Zec*Za+"px";if(Va=this.txh())Va=Va.bM,this.sK.style.bottom=Va.offsetHeight-Va.clientHeight+"px"}Bka(Va){E.ULS.shipAssertTag(4520073,308,this.lib.gta(Va));this.kG!==Va&&(this.kG=Va,this.Pgc.Bka(Va),this.fCc.Bka(this.kG))}dispose(){this.dismiss();this.Pgc.dispose();this.fCc.dispose()}$A(){this.Dg&&this.Dg.nb(K.a.click,this.Is,this.onClick)}Jca(){this.Dg&&this.Dg.xc(K.a.click,this.Is,this.onClick)}Ykm(){let Va;Va=document.createElement("div");
Va.classList.add("FootnoteEndnoteControl");this.ix=document.createElement("div");this.ix.classList.add("FootnoteEndnoteContent");this.ix.appendChild(this.Pgc.jaa);this.ix.appendChild(this.fCc.jaa);Va.appendChild(this.ix);return Va}b4(Va){Va=(this.WV=Va)?"":"none";this.Is.style.display=Va;this.sK.style.display=Va}bNb(){this.kG&&(this.Pgc.bNb(),this.fCc.bNb(),this.kG=null)}static c7d(){const Va=v.StaticActiveAppFrame.za().kb.Jc;return Va&&Va.gj?Va:null}static Xqm(Va,Za,Ka,bb,Ib){return new ta(Va,Za,
Ka,bb,Ib,l.AFrameworkApplication.isRtl,U.a.instance,Y.a.instance,ta.c7d,ia.a.instance,ta.PSl,l.AFrameworkApplication.va)}static PSl(){l.AFrameworkApplication.va.Pb(ca.a.Arb,2,!0)}}Object(J.a)(ta,"FootnoteEndnoteControl",null,[322]);var za=d(805),Ha=d(6),Na=d(201),ya=d(31),ma=d(8),Ea=d(22),Ba=d(77),$a=d(1685),ea=d(351),ka=d(949),La=d(580),va=d(1326),Ca=d(62),ua=d(252);class Sa extends ea.a{constructor(Va,Za,Ka,bb,Ib,ib,jb,hb,pb,ob,sb,Ab,nc,qc,Jc,ad,Kc){super(N.a.Kka,Ka,bb,Ib,jb,hb,pb,ob,sb,Ab,nc,qc,
Jc,ad,Kc);this.pbh=Va;this.j4a=ib;this.j4a.uqd=this;Za(this);this.features.tFg=!0}get WWi(){return!0}GOf(){const Va=this.pbh.UEf(this);return ka.ViewReference.TG(this,Va)}Twf(Va){Object(ua.a)(Sa,Va)||this.pbh.Qwf()}M3c(){return La.a.Tcj}Pv(){super.Pv();this.j4a.uji()}kF(Va,Za=null){super.kF(Va,Za);this.j4a.gji(this.od.mk)}detach(){this.j4a.tji();super.detach()}t3d(){this.Pv()}static W6a(){const {FootnoteEndnoteControlManager:Va}=d(1611);return new Sa(Va.instance,va.a.$pf,v.StaticActiveAppFrame.za().kb,
Object(Ca.a)(),()=>w.a.instance.resolve(50),w.a.instance.resolve(726),l.AFrameworkApplication.va,w.a.instance.resolve(78),w.a.instance.resolve(159),w.a.instance.Ra(20),w.a.instance.resolve(23),w.a.instance.Ra(6),w.a.instance.Oa(288),w.a.instance.Oa(19),w.a.instance.Oa(11),w.a.instance.Oa(14),w.a.instance.Oa(13))}}Object(J.a)(Sa,"FootnoteEndnoteEditView",ea.a,[]);class Ta{constructor(Va,Za,Ka,bb=!1){this.tDb=null;this.aWe=this.f9g=!1;this.J$l=()=>{const Ib=String.format("{0} {1}",this.aWe?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:
WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText);this.Cw.sendNotification(Ib,!0)};this.Yb=Va;this.Txa=Za;this.sia=Ka();this.mDd=bb;this.jaa=document.createElement("div");this.jaa.classList.add("FootnoteEndnoteEditControl");this.NFc=document.createElement("div");this.NFc.classList.add("FootnoteEndnoteEditControlDividerElement");this.fJb=(new za.a(this.jaa,"WACViewPanel_FootnoteEndnoteEditControl")).mK;
this.jaa.appendChild(this.NFc);this.jaa.appendChild(this.fJb)}get Cw(){return null!=this.iSg?this.iSg:this.iSg=w.a.instance.resolve(26)}Bka(Va){E.ULS.shipAssertTag(4520077,308,this.Txa.gta(Va));this.tDb!==Va&&(this.tDb=Va,this.Hif(this.tDb),this.aWe=this.Txa.Lsb(this.tDb),this.mDd?(this.sia.j_b(C.a.cSd),this.Yb.ie(N.a.Kka).G$(this.J$l)):this.sia.SLj(this.aWe?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,
C.a.cSd))}bNb(){const Va=U.a.instance.Lsb(this.tDb)?"Footnote":"Endnote";E.ULS.sendTraceTag(4006494,308,50,"{0}",{["Type"]:Va,["CalloutHeight"]:this.jaa.scrollHeight});this.pob();this.tDb=null}bind(){this.f9g||(this.sia.mdc(this.fJb),this.f9g=!0)}qwc(){const Va=this.vHm();Va?this.sia.Kc(Va):this.sia.znd()}dispose(){this.pob()}Hif(Va){this.pob();this.sia.kF(Va,Va.mk)}pob(){this.sia.detach()}vHm(){let Va=0;var Za=null,Ka=Ha.a.Za(this.tDb);Na.OutlineNavigator.zba(Ka);if((Ka=ya.OutlineElementNavigator.Me(Ka))&&
ma.ParagraphReader.Vb(Ka)){if(Za=Ta.Wum(Ka)){Va=Za.Jb.cp+1;Za=$a.FootnoteEndnoteDefaultContentInserter.hci;const bb=Za.length;Va+bb<=ma.ParagraphReader.textLength(Ka)&&Ka.characterData.substr(Va,bb)===Za&&(Va+=bb)}Za=Ea.SelectionFactory.ue(Ka,Va)}return Za}static Zqm(){return Ta.$qm()}static $qm(){return new Ta(z.FocusManager.instance(),U.a.instance,()=>Sa.W6a(),l.AFrameworkApplication.J.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}static Wum(Va){Va=Ba.i(Va,10);return 0<Va.length?Va[Va.length-
1]:null}}Object(J.a)(Ta,"FootnoteEndnoteEditControl",null,[321]);var zb=d(1117);class Ra{constructor(Va,Za){this.MGa=Va;this.Xm=Za}ukc(Va,Za){Va=this.MGa.ukc(Va);var Ka=Za.clientWidth;const bb=Za.scrollLeft,Ib=Va.d5h;let ib=Va.Qec,jb=Va.Qec,hb=Ra.d8f,pb=Ra.e8f,ob=Ib,sb=Va.ZVc;this.Xm?pb=Va.Qqf-jb:hb=Va.Zec-ib;Ka<Ib&&(ib=Math.max(ib-bb,0),ob=Ka-ib,this.Xm?(Ka=Za.scrollWidth-bb-Ka,jb=Za.scrollWidth-Va.Qec-Ib,pb=Math.max(Va.Qqf-Ka-jb,Ra.e8f),sb=ob-pb-Ra.d8f):(hb=Math.max(Va.Zec-bb-ib,Ra.d8f),sb=ob-hb-
Ra.e8f));return new zb.a(ib,ob,hb,pb,sb)}}Ra.d8f=25;Ra.e8f=50;Object(J.a)(Ra,"FootnoteEndnoteViewPositionProvider",null,[]);class qb{constructor(Va,Za=0,Ka=0){this.clientWidth=Va;this.scrollLeft=Za;this.scrollWidth=Ka?Ka:Va}}Object(J.a)(qb,"PageViewScrollContainerSizeInfo",null,[]);d.d(L,"FootnoteEndnoteControlManager",function(){return kb});class kb{constructor(Va,Za,Ka,bb,Ib,ib,jb,hb){this.dG=null;this.lca=()=>{this.Zp.MK(N.a.Kka);this.Zp.MK(N.a.q8a);this.Zp.ay(m.AFrame.Ro);this.Yb.iRc(N.a.Kka);
this.Yb.Jg(N.a.Kka)};this.NQo=pb=>{this.Zp.ay(N.a.Kka);this.Zp.ay(N.a.q8a);this.Zp.MK(m.AFrame.Ro);this.Yb.IXc(N.a.Kka);(pb||this.Yb.currentScope&&(this.Yb.currentScope.name===N.a.Kka||this.Yb.currentScope.name===N.a.q8a))&&this.Yb.Jg(m.AFrame.Ro)};this.Yb=Va;this.Zp=Za;this.Ouk=Ka;this.Puk=bb;this.Nuk=Ib;this.MGa=ib;this.axa=jb;this.G1=hb;this.r1=f.KeyInputManager.mc(a.a.G4,0);this.dUf();this.rW()}get control(){return this.dG}get dialog(){return this.control.dialog}get bVi(){return this.control.VJ}fsf(){this.control.fsf()}Kkd(){this.control.Kkd()}bind(Va){this.Bwl(Va)}ZBg(Va){if(this.control.USc!==
Va.Q6a)this.control.dismiss();else if(this.bVi)return;this.pgc();this.control.Bka(Va.Q6a);this.control.show(Va.Vxe)}pgc(){if(this.G1){const Va=new x.a(!0);this.G1.cNa(Va)}}F0(){this.control.setFocus()}nsd(){this.control.update()}Qwf(Va,Za=!1){this.pgc();this.control.dismiss(Va,Za)}xBo(Va){const Za=kb.c7d().bM;Va=this.MGa.ukc(Va,new qb(Za.clientWidth,Za.scrollLeft,Za.scrollWidth));this.control.zBo(Va)}dispose(){this.control.dispose();this.Yb.ie(N.a.Kka).nt(this.r1)}UEf(Va){E.ULS.shipAssertTag(4520074,
308,!!this.control);E.ULS.shipAssertTag(4520075,308,!!this.control.USc);return this.VEf(this.control.USc.id,Va)}Bwl(Va){const Za=this.Puk(),Ka=this.Nuk();this.dG=this.Ouk(Va,Za,Ka,this.lca,this.NQo)}dUf(){const Va=this.Yb.ie(N.a.Kka);Va.parent=3===l.AFrameworkApplication.va.mode?u.a.uF:u.a.puc;this.Yb.zdf(N.a.Kka);Va.bindAction(this.r1,y.a.I6)}rW(){this.Zp.rW(N.a.Kka);this.Zp.rW(N.a.q8a)}VEf(Va,Za){return()=>{const Ka=kb.c7d().od.Ic.Eb(Va);this.axa.nhc();if(!Ka.isConnected)return E.ULS.sendTraceTag(4520076,
308,10,"{0}",{["Error"]:"Unable to restore footnoteEndnote control"}),null;this.ZBg(new H.a(Ka,!0));return Za}}static Pm(){const Va=new Ra(w.a.instance.resolve(727),l.AFrameworkApplication.isRtl);return new kb(z.FocusManager.instance(),v.StaticActiveAppFrame.za().Ay,ta.Xqm,Ta.Zqm,X.Tqm,Va,I.a.instance,w.a.instance.resolve(258),w.a.instance.resolve(71))}static c7d(){const Va=v.StaticActiveAppFrame.za().kb.Jc;return Va&&Va.gj?Va:null}static get instance(){return null!=kb.KYg?kb.KYg:kb.KYg=kb.Pm()}}
Object(J.a)(kb,"FootnoteEndnoteControlManager",null,[298])},1621:function(J,L,d){J=d(0);var m=d(2),f=d(20),a=d(43),l=d(1006),w={get interop(){var u=null===fishBowlUx||void 0===fishBowlUx?void 0:fishBowlUx.interop;if(!u)throw Error("fishBowlUx chunk is accessed before loading");return u}};d.d(L,"a",function(){return z});class z{static initialize(u,v,E,y){this.Sha=v;this.J7=E;this.cqj=y;this.Qvg=u;this.PMa=document.getElementById(this.cqj);try{this.wVb=document.createElement("div"),this.wVb.id=this.xMn,
this.wVb.classList.add(this.q8l),this.PMa.append(this.wVb),this.lyn().then(()=>{this.interop=null===w||void 0===w?void 0:w.interop;this.controller=this.interop.renderFishBowlNavButton(this.wVb,{onclick:this.yMn});this.qAg();this.BYo();a.a("MicroNavIconShown")})}catch{a.a("MicroNavFloatieInitializationFailed")}}static async qAg(){this.Sha&&this.Sha.execute(u=>{u.YX(()=>{setTimeout(this.controller.reposition,10)})})}static async BYo(){this.J7&&this.J7.execute(u=>{u.mcc((v,E)=>this.vLj(E))})}static vLj(u){0==
u.jMa?this.controller.changeContentContainer(!1):this.controller.changeContentContainer(!0)}static async lyn(){return m.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("fishBowlUx"):(await Object(l.c)(this.Qvg)).JD.loadScript("fishBowlUx")}}var x=z;z.cqj="";z.xMn="FishBowlNavButton";z.Sha=null;z.J7=null;z.q8l="FishBowlNavButton";z.controller=null;z.interop=null;z.wVb=null;z.PMa=null;z.yMn=()=>{m.AFrameworkApplication.va.Pb(f.a.$_a,2,null,void 0)};z.dispose=()=>{x.wVb&&
x.controller&&(x.J7.execute(u=>{u.jte((v,E)=>x.vLj(E))}),x.Sha.execute(u=>{u.nNa(()=>{x.controller.reposition()})}),x.interop.dispose(x.wVb))};z.ump=()=>{x.controller&&x.controller.hide()};z.Qrd=()=>{x.controller&&x.controller.show()};Object(J.a)(z,"NavButton",null,[])},1641:function(J,L,d){d.d(L,"a",function(){return u});J=d(0);var m=d(7),f=d(178),a=d(2),l=d(10),w=d(260),z=d(151),x=d(19);class u{constructor(v,E){this.Su=null;this.TJd=!1;this.njb=0;this.fqh="";this.bLe={};this.$uj=()=>{this.Yb&&this.Yb.HN(f.AFrame.Jua,
!0)};this.nme=()=>{this.DYc();this.Yei();this.gdg();this.Txb();return!0};this.ome=()=>{this.DYc();this.Yei();this.gdg();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.Txb()},0)});return!0};this.Ueg=y=>{y.stopPropagation()};this.O_e=v;this.Yb=E;this.Ovh=this.Ueg;this.Yoh=!!a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Ib.bCa;this.Rx=!!a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Ib.m3;this.Zoh=!!a.AFrameworkApplication.J&&a.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",
!1)}onMenuOpen(){0<this.njb?this.njb++:(this.njb++,a.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",!1)?window.requestAnimationFrame(()=>{window.setTimeout(this.$uj,0)}):this.$uj(),this.showModal())}dqn(){const v=document.getElementById("WACToolbarContainer");return!!v&&"block"===v.style.display}getRibbonMode(){return this.Zoh&&this.dqn()?"Toolbar":z.f()}Nhm(){const v=this.getRibbonMode(),E=appChrome.selectors.getShyState();return String.format("{0}{1}",
v,this.Yoh&&E.isActive&&0!==E.state?"_ShyRibbon":"")}lMm(v){var E=0;if(this.Rx){if(this.bLe[v])return this.bLe[v];(E=document.getElementById("BusinessBar"))||m.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");E=E?E.offsetTop:0;this.bLe[v]=E}return E}showModal(){if(!this.Su)if(this.Su=this.createElement("div"),this.Su.setAttribute("id","ReactModalDiv"),this.Su.style.position="absolute",this.Su.style.bottom="0px",this.Su.style.left=
"0px",this.Su.style.right="0px",this.Su.style.backgroundColor="white",this.Su.style.opacity="0.0",this.Rx){var v=document.getElementById("regionComposerRoot");v&&v.appendChild(this.Su)}else this.O_e.appendChild(this.Su);v=this.Nhm();if(v!==this.fqh){const y=this.lMm(v);var E=appChrome.selectors.getShyState();this.Yoh&&E.isActive&&0!==E.state?(E=this.Zoh?appChrome.api.getRibbonHeight("Multiline")-appChrome.api.getRibbonHeight("SingleLine"):appChrome.api.getRibbonHeight(z.f()),this.Su.style.top=String.format("{0}px",
y+E)):this.Su.style.top=String.format("{0}px",y);this.fqh=v}this.Su.style.display="block";this.Su.style.visibility="visible";this.Su.style.zIndex="1000";this.TJd||(window.addEventListener("wheel",this.Ovh,!0),this.Ude()?w.a.instance.nb(l.a.BP,this.Su,this.ome):w.a.instance.nb(l.a.gt,this.Su,this.nme),this.TJd=!0)}onMenuClose(){this.njb--;0<this.njb||(0>this.njb?this.njb=0:this.mNi())}gdg(){this.njb=0;this.Pwf();this.mNi()}createElement(v){v=document.createElement(v);v.setAttribute("unselectable",
"on");return v}lNi(){this.Yb&&this.Yb.currentScope&&this.Yb.currentScope.name===f.AFrame.Jua&&!a.AFrameworkApplication.oc.Yy&&this.Yb.$U(f.AFrame.Jua,!1);this.Su&&(this.Su.style.zIndex="-1",this.Su.style.visibility="hidden",this.Su.style.display="none");this.TJd&&(window.removeEventListener("wheel",this.Ovh,!0),this.Ude()?w.a.instance.xc(l.a.BP,this.Su,this.ome):w.a.instance.xc(l.a.gt,this.Su,this.nme),this.TJd=!1)}mNi(){this.Ude()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.lNi()},
0)}):this.lNi()}Txb(){4===a.AFrameworkApplication.ua.Ib.Uk&&a.AFrameworkApplication.J.$("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?a.AFrameworkApplication.ua.Txb():this.Yb.Jg(f.AFrame.Ro)}DYc(){const v=x.a.instance.Oa(728);v&&v.DYc()}Pwf(){const v=x.a.instance.Oa(728);v&&v.Pwf()}Yei(){a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Ib.qXa&&(this.Ude()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}Ude(){return a.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",
!1)}}Object(J.a)(u,"ReactModalDiv",null,[])},1671:function(J,L,d){d.d(L,"a",function(){return a});J=d(0);var m=d(1021),f=d(5);class a{constructor(l,w){this.oQ=this.LLc=null;this.jb=l;this.Ugb=w}get key(){return"COMMENT"}get Cv(){return WordEditorIntl.WordEditorStrings.L_Comment}get WO(){return this.oQ}reset(l){this.oQ=l.node}wEa(l){let w=null;if(this.LLc&&this.hVi(l,this.WO,this.LLc))return w=Object.assign(new m.a,{NF:this.key,contentObject:this.LLc}),{returnValue:!0,yG:w};this.LLc=null;const z=this.Ugb.Bsf(this.WO);
if(this.Ugb.EWf(z)){let x=z.Zd();for(;x;){if(this.hVi(l,this.WO,x))return this.LLc=x,w=Object.assign(new m.a,{NF:this.key,contentObject:x,description:this.uVa()}),{returnValue:!0,yG:w};x=z.Gk()}}return{returnValue:!1,yG:w}}hVi(l,w,z){if(this.IRj(z))return!1;const x=this.Ugb.xkc(z,!0),u=this.Ugb.xkc(z,!1);return x&&u&&this.jb.x9c(w,x,u)&&(w=this.Ugb.GAa(x,z.id,!0))&&(x!==this.WO||w.Jb.cp<=l)&&(z=this.Ugb.GAa(u,z.id,!1))&&(u!==this.WO||z.Jb.cp>l||z.Jb.cp>=l)?!0:!1}IRj(l){return l.ka(f.a.uI,!1)}uVa(){return null}}
Object(J.a)(a,"CommentDetailsProvider",null,[256,257])},1678:function(J,L,d){d.d(L,"a",function(){return f});J=d(0);L=d(515);var m=d(234);class f extends L.a{constructor(){super();this.documentTypeConfidences=null;this.H_=Object.assign(new m.a,{T_:f.getTypeName(),B_:f.getBaseTypes()})}static getTypeName(){return"AugLoop_DocumentTypeClassifier_DocumentTypeClassifierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(J.a)(f,"DocumentTypeClassifierAnnotation",L.a,[])},1684:function(J,
L,d){var m=this&&this.gQ||(Object.create?function(a,l,w,z){void 0===z&&(z=w);var x=Object.getOwnPropertyDescriptor(l,w);if(!x||("get"in x?!l.sM:x.writable||x.configurable))x={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,z,x)}:function(a,l,w,z){void 0===z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(L,"__esModule",{value:!0});f(d(1864),L);f(d(1865),L)},1685:function(J,
L,d){d.r(L);d.d(L,"FootnoteEndnoteDefaultContentInserter",function(){return C});J=d(0);var m=d(19),f=d(48),a=d(2),l=d(31),w=d(105),z=d(545),x=d(26),u=d(5),v=d(14),E=d(59),y=d(108),H=d(1132),I=d(881),F=d(1564);class C{constructor(P,K,G,R,W=null){this.Zc=P;this.nok=K;this.Xm=G;C.Oh=R;this.Rbh=W||C.CEl}get GN(){return null!=this.u0g?this.u0g:this.u0g=m.a.instance.resolve(110)}ACl(P,K){var G=this.Zc.Rl();G.set(P);this.GN.QRb(G,null,!0);C.Oh.C_b(G.currentNode,this.Xm);P=l.OutlineElementNavigator.Me(G);
C.tha.Fnd(K?Box4Intl.Box4Strings.L_StyleWordFootnoteText:Box4Intl.Box4Strings.L_StyleWordEndnoteText,P);G=this.Rbh(G.currentNode);C.Fg.Ve(G,C.hci);this.R7m(P,K)}R7m(P,K){var G=this.nok(E.a.Jma);G.setValue(u.a.ft,1===K?36:35);G.setValue(u.a.Mja,!0);G.setValue(v.a.Eca,!0);const R=P.Ic.ku(G,f.a.create());G=this.Rbh(P);C.Fg.yla(G,W=>I.a.getInstance(W,R,!0),F.a.nti(P,K,Object(w.a)()))}static Pm(){return new C(new z.a,Object(y.a)(H.a.instance,H.a.instance.createInstance,"createInstance"),a.AFrameworkApplication.isRtl,
m.a.instance.resolve(18))}static get tha(){return null!=C.a3g?C.a3g:C.a3g=m.a.instance.resolve(392)}static get Fg(){return null!=C.QSg?C.QSg:C.QSg=m.a.instance.resolve(322)}static get instance(){return null!=C.XYg?C.XYg:C.XYg=C.Pm()}static CEl(P){return x.a.Tc(P,0)}}C.hci=" ";C.Oh=null;Object(J.a)(C,"FootnoteEndnoteDefaultContentInserter",null,[327])},1686:function(J,L,d){d.d(L,"a",function(){return w});J=d(0);var m=d(545),f=d(533),a=d(1457),l=d(1564);class w{constructor(z,x){this.axa=x}j9d(z,x,u){return(z=
this.axa.XAi(z.node,u?z.cpBegin:z.cpEnd,x))?z.f7():null}MJi(z,x){return(z=this.axa.QDm(z.node,z.cpBegin,x))?z.f7():null}static t2c(){return new w(f.a.instance,a.a.instance,new m.a,l.a.instance)}static get instance(){return null!=w.vYg?w.vYg:w.vYg=w.t2c()}}Object(J.a)(w,"FootnoteEndnoteNavigator",null,[314])},1698:function(J,L,d){d.d(L,"a",function(){return w});J=d(0);var m=d(1767),f=d(2),a=d(44),l=d(19);class w{constructor(z,x,u,v,E,y){this.Exa=z;this.Fxa=x;this.XTe=u;this.$0=v;this.$yd=E;this.U3b=
y}get FSj(){return!this.Fxa&&!this.XTe}get Qgj(){return 2===this.U3b?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get Qji(){return CommonUIStrings.l_OICErrorMessageNoOffice}get jOi(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get xrb(){return CommonUIStrings.l_OICErrorHelpLink}get aNi(){return"OICFailure"}get icon(){return 3}get GPd(){return 2===this.U3b?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}Iko(z){this.bhj(z)}Ivn(z){this.bhj(z)}bhj(z){let x=
10;1===z?(l.a.instance.resolve(120).k2f(this.U3b),x=3):2===z&&((!this.XTe||this.XTe(this.$0))&&this.Fxa&&m.a.instance.SFl(this.Fxa,this.Exa,this.$0),x=5);(0===z||1===z)&&this.Exa&&this.Exa(this.$0);f.AFrameworkApplication.xkd(a.a.$nj,this.$yd,x);this.dispose()}dispose(){this.$0=this.Fxa=this.Exa=null}}Object(J.a)(w,"AOICErrorDialogWithTrial",null,[10])},1767:function(J,L,d){J=d(0);var m=d(108),f=d(7),a=d(2),l=d(44),w=d(465),z=d(19);class x{constructor(K,G,R,W){this.b_e=null;this.$yd=W;this.Exa=K;
this.Fxa=G;this.$0=R;this.DDh=this.RUb.j0o;K=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.dCk=K[0];this.cCk=K[1]}get RUb(){return this.b_e||(this.b_e=z.a.instance.resolve(729))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get xrb(){return CommonUIStrings.l_OICErrorHelpLink}get qod(){return this.DDh}get qaj(){return this.dCk}get paj(){return this.cCk}get oaj(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.DDh?3:2}get YZc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get yWd(){return!!this.Fxa}get ZZc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}Qog(K){this.Qdd(K)}T2f(K){this.Qdd(K)}Qdd(K){let G=
10;this.Fxa&&1===K&&(this.Fxa(this.$0),G=1);this.Exa&&this.Exa(this.$0);this.iS(G)}PVb(){w.Redirect.showHelp("OICFailure");this.iS(2)}fcg(){this.RUb.H4i();this.iS(4)}iS(K){f.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.$yd,K);a.AFrameworkApplication.xkd(l.a.Ynj,this.$yd,K)}dispose(){this.$0=this.Exa=this.Fxa=null}}Object(J.a)(x,"AOICErrorDialog",null,[10]);var u=d(36),v=d(173);class E extends x{constructor(K,G,R,W){super(K,G,R,W);this.ljb=this.yH=
null;K=document.createElement("span");K.id="errorMessageText";K.innerText=this.errorMessage;K.appendChild(document.createElement("br"));K.appendChild(document.createElement("br"));this.yH=document.createElement("a");this.yH.href="#";this.yH.innerText=this.xrb;K.appendChild(this.yH);u.a.addHandler(this.yH,"click",Object(m.a)(this,this.PVb,"oicErrorHelpLinkHandler"));G=new v.StandardDialog;G.Ng=this.id;this.qod?(R=document.createElement("span"),W=document.createElement("span"),R.innerText=this.qaj,
W.innerText=this.paj,this.ljb=document.createElement("a"),this.ljb.href="#",this.ljb.innerText=this.oaj,K.appendChild(document.createElement("br")),K.appendChild(R),K.appendChild(this.ljb),K.appendChild(W),u.a.addHandler(this.ljb,"click",Object(m.a)(this,this.fcg,"oicErrorMacOfferLinkHandler"))):this.yWd&&(K.appendChild(document.createElement("br")),K.appendChild(document.createElement("br")),R=document.createElement("span"),R.innerText=this.YZc,K.appendChild(R));this.yWd?(G.Fd=1,G.Qe(1,this.ZZc)):
G.Fd=0;G.Ex(this.dialogTitle,null,this.icon,Object(m.a)(this,this.T2f,"legacyOICErrorDialogHandler"),K);G.t8("errorMessageText")}dispose(){this.yH&&(u.a.removeHandler(this.yH,"click",Object(m.a)(this,this.PVb,"oicErrorHelpLinkHandler")),this.yH=null);this.ljb&&(u.a.removeHandler(this.ljb,"click",Object(m.a)(this,this.fcg,"oicErrorMacOfferLinkHandler")),this.ljb=null);super.dispose()}}Object(J.a)(E,"OICErrorDialog",x,[]);class y{constructor(K,G,R){this.Exa=G;this.Fxa=K;this.$0=R}get id(){return"OICErrorDialogWithDownload"}get Rji(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get xrb(){return CommonUIStrings.l_OICErrorHelpLink}get YZc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get ZZc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}Qog(K){this.Qdd(K)}T2f(K){this.Qdd(K)}Qdd(K){let G=
10;1===K&&(this.Fxa(this.$0),G=1);this.Exa&&this.Exa(this.$0);this.iS(G)}PVb(){w.Redirect.showHelp("OICFailure");this.iS(2)}iS(K){a.AFrameworkApplication.xkd(l.a.Znj,3,K)}dispose(){this.$0=this.Fxa=this.Exa=null}}Object(J.a)(y,"AOICErrorDialogWithDownload",null,[10]);class H extends y{constructor(K,G,R){super(K,G,R);this.yH=null;K=document.createElement("span");K.id="errorMessageText";K.innerText=this.Rji;K.appendChild(document.createElement("br"));K.appendChild(document.createElement("br"));this.yH=
document.createElement("a");this.yH.href="#";this.yH.innerText=this.xrb;K.appendChild(this.yH);u.a.addHandler(this.yH,"click",Object(m.a)(this,this.PVb,"oicErrorHelpLinkHandler"));K.appendChild(document.createElement("br"));K.appendChild(document.createElement("br"));G=document.createElement("span");G.innerText=this.YZc;K.appendChild(G);G=new v.StandardDialog;G.Ng=this.id;G.Fd=1;G.Qe(1,this.ZZc);G.Ex(this.dialogTitle,null,this.icon,Object(m.a)(this,this.T2f,"legacyOICErrorDialogHandler"),K);G.t8("errorMessageText")}dispose(){this.yH&&
(u.a.removeHandler(this.yH,"click",Object(m.a)(this,this.PVb,"oicErrorHelpLinkHandler")),this.yH=null);super.dispose()}}Object(J.a)(H,"OICErrorDialogWithDownload",y,[]);var I=d(169);class F extends x{constructor(K,G,R,W){super(K,G,R,W);G={["errorMessage"]:this.errorMessage};G.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.xrb,["onExecute"]:Z=>{this.PVb(Z)}};this.qod?(G.macOfficePreLinkText=this.qaj,G.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.oaj,
["onExecute"]:Z=>{this.fcg(Z)}},G.macOfficePostText=this.paj):this.yWd&&(G.errorFileDownloadOffer=this.YZc);K=new I.a(!1,!1,!0);this.yWd?(K.Fd=1,K.Qe(1,this.ZZc)):K.Fd=0;K.Ng=this.id;G={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:G};K.mi(this.dialogTitle,Object(m.a)(this,this.Qog,"reactOICErrorDialogHandler"),G)}}Object(J.a)(F,"ReactOICErrorDialog",x,[]);class C extends y{constructor(K,G,R){super(K,G,R);G={["errorMessage"]:this.Rji,["errorFileDownloadOffer"]:this.YZc};G.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.xrb,["onExecute"]:W=>{this.PVb(W)}};K=new I.a(!1,!1,!0);K.Fd=1;K.Qe(1,this.ZZc);K.Ng=this.id;G={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:G};K.mi(this.dialogTitle,Object(m.a)(this,this.Qog,"reactOICErrorDialogHandler"),G)}}Object(J.a)(C,"ReactOICErrorDialogWithDownload",y,[]);d.d(L,"a",function(){return P});class P{constructor(){this.sRa=!!a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Ib.cH}RFl(K,G,R){this.sRa?new F(K,G,null,R):new E(K,G,null,
R)}SFl(K,G,R){this.sRa?new C(K,G,R):new H(K,G,R)}TFl(K,G,R,W,Z){const {ReactOICErrorDialogWithTrial:T}=d(1879),{OICErrorDialogWithTrial:N}=d(1880);this.sRa?new T(K,G,R,null,W,Z):new N(K,G,R,null,W,Z)}static get instance(){return P._instance||(P._instance=new P)}}P._instance=null;Object(J.a)(P,"OICErrorDialogFactory",null,[1934])},1785:function(J,L,d){J=d(0);var m=d(169),f=d(17),a=d(71),l=d(19),w=d(2),z=d(226),x=d(615);class u{static get kh(){return m.a.Ry(u.Hn,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsFont,
WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsIndent)}}u.Hn="<div class='FootnoteEndnoteDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='FontPlaceholder'></div> </div> <div class='FootnoteEndnoteDialogIndentTitle UIFontBold' id='IndentTitle'> <label id='IndentTitleLabel' class='WACDialogLabel' for='IndentControl' >{1}</label> </div> <div class='normal' id='IndentControl'> <div id='IndentPlaceholderStyles' class='FootnoteEndnoteDialogIndentPlaceholder'></div> </div>";
Object(J.a)(u,"FootnoteEndnoteFormattingOptionsDialogHtml",null,[]);var v=d(20),E=d(3);d.d(L,"a",function(){return y});class y extends m.a{constructor(H,I,F){super();this.ejh=!1;this.WY=null;this.G$l=C=>{switch(C){case 1:this.ga.Ob(v.a.Toi,2);break;case 2:this.ga.Ob(v.a.Uoi,2);break;case 0:this.ga.Ob(v.a.Voi,2)}};this.yv=I;this.OV=!1;this.L6b=y.o$l;this.hi=H;this.ga=F;this.Ng="FootnoteEndnoteFormattingOptionsDialog";this.Fd=2;this.kh=u.kh;this.Qe(1,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyButton);
this.Qe(2,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyAllButton);this.mi(WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogTitle,this.G$l,null);this.rrb=!1;document.getElementById("FontStyleComboBox").focus()}get fontName(){return this.WY}set fontName(H){this.WY=H;if(H=document.getElementById("FontSizeComboBox"))H.focus(),this.hi.Fe()}get fontSize(){return this.L6b}get rrb(){return this.ejh}set rrb(H){this.ejh=H;this.K9n()}Cba(){this.gTd("FontStyleComboBox",
"FontPlaceholder",v.a.g3d.toString(),v.a.qvj.toString(),v.a.Igd.toString(),WoncaIntl.WoncaStrings.L_FontName,"100px");this.gTd("FontSizeComboBox","FontPlaceholder",v.a.h3d.toString(),E.a.Ihd.toString(),v.a.Jgd.toString(),WoncaIntl.WoncaStrings.L_FontSize,"32px");const H=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',
f.a.N_(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),""),I=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',f.a.N_(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),"&nbsp;&nbsp;&nbsp;&nbsp;");this.BTc("NoStyle","IndentPlaceholderStyles",
v.a.Xoi.toString(),v.a.rvj.toString(),H,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesNoIndentButtonTitle,"Size110by75");this.BTc("FirstLineIndent","IndentPlaceholderStyles",v.a.Woi.toString(),v.a.ong.toString(),I,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesFirstLineIndentButtonTitle,"Size110by75")}gTd(H,I,F,C,P,K,G){F=z.c(H,F,!0,!0,C,P,f.a.Jf(K),!0,G);this.BXd(H,I,F,"Medium")}BTc(H,I,F,C,P,K,G){F=z.f(H,F,C,f.a.Jf(P),f.a.Jf(K),G);this.BXd(H,I,F,"Large",K)}BXd(H,I,F,C,P=null){I=document.getElementById(I);
this.yv.w5a(H,F);F=this.yv.hPb(H,C);P&&a.a.IRd(F,String.format("{0}Label",H),P);I.appendChild(F);this.yv.Dua(H)}K9n(){this.yv.Dua("NoStyle");this.yv.Dua("FirstLineIndent")}dispose(){this.OV||(this.yv.B0("FontStyleComboBox"),this.yv.B0("FontSizeComboBox"),this.yv.B0("NoStyle"),this.yv.B0("FirstLineIndent"),this.OV=!0);this.hi.Fe();super.dispose()}static get W_a(){return l.a.instance.resolve(48).kha}static crm(){return new y(x.a.Mm,y.W_a,w.AFrameworkApplication.va)}static brm(){return y.crm()}}y.o$l=
-1;Object(J.a)(y,"FootnoteEndnoteFormattingOptionsDialog",m.a,[])},1821:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m{constructor(f,a){this.ji=this.tFd=0;this.Aih=a;this.wNk=f}Mub(){return this.tFd-this.ji>=this.wNk}reset(){this.ji=this.tFd=this.Aih()}update(){this.tFd=this.Aih()}}Object(J.a)(m,"TimeBasedTaskYieldStrategy",null,[671])},1834:function(J,L,d){var m=this&&this.gQ||(Object.create?function(a,l,w,z){void 0===z&&(z=w);var x=Object.getOwnPropertyDescriptor(l,w);if(!x||("get"in
x?!l.sM:x.writable||x.configurable))x={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,z,x)}:function(a,l,w,z){void 0===z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(L,"__esModule",{value:!0});f(d(1835),L);f(d(1836),L)},1835:function(J,L){Object.defineProperty(L,"__esModule",{value:!0})},1836:function(J,L,d){Object.defineProperty(L,"__esModule",{value:!0});L.EndnoteSubDocument=
L.FootnoteSubDocument=L.ShapeSubDocument=L.TextboxSubDocument=L.CommentSubDocument=L.HeaderFooterSubDocument=L.MainSubDocument=void 0;const m=d(408);class f{constructor(v){m.SchemaObject.assign(f,this,v)}static getTypeName(){return"AugLoop_Word_MainSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,[f.getTypeName()])}}L.MainSubDocument=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(v){m.SchemaObject.assign(a,
this,v)}static getTypeName(){return"AugLoop_Word_HeaderFooterSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,[a.getTypeName()])}}L.HeaderFooterSubDocument=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(v){m.SchemaObject.assign(l,this,v)}static getTypeName(){return"AugLoop_Word_CommentSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,
[l.getTypeName()])}}L.CommentSubDocument=l;l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class w{constructor(v){m.SchemaObject.assign(w,this,v)}static getTypeName(){return"AugLoop_Word_TextboxSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,[w.getTypeName()])}}L.TextboxSubDocument=w;w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class z{constructor(v){m.SchemaObject.assign(z,this,v)}static getTypeName(){return"AugLoop_Word_ShapeSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,
[z.getTypeName()])}}L.ShapeSubDocument=z;z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class x{constructor(v){m.SchemaObject.assign(x,this,v)}static getTypeName(){return"AugLoop_Word_FootnoteSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,[x.getTypeName()])}}L.FootnoteSubDocument=x;x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class u{constructor(v){m.SchemaObject.assign(u,this,v)}static getTypeName(){return"AugLoop_Word_EndnoteSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,
[u.getTypeName()])}}L.EndnoteSubDocument=u;u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()}},1864:function(J,L){Object.defineProperty(L,"__esModule",{value:!0});L.ObjectSchemaType=L.ObjectSemantic=L.SequenceType=L.IntentIds=void 0;(function(d){d.Logging="Logging";d.ZeroTermMenu="ZeroTermMenu";d.Floatie="Floatie"})(L.IntentIds||(L.IntentIds={}));(function(d){d.CommandId="CommandId";d.ControlId="ControlId"})(L.SequenceType||(L.SequenceType={}));(function(d){d.CommandIdHistory="CommandIdHistory";d.ControlIdHistory=
"ControlIdHistory";d.FilteredCommandIdHistory="FilteredCommandIdHistory";d.CanvasContext="CanvasContext";d.ApplicationContext="ApplicationContext";d.UserContext="UserContext";d.GenericSuggestions="GenericSuggestions"})(L.ObjectSemantic||(L.ObjectSemantic={}));(function(d){d.CommandExecutionSequence="CommandExecutionSequence";d.WordCanvasContext="WordCanvasContext";d.ApplicationContext="ApplicationContext";d.UserContext="UserContext";d.RankedSuggestion="RankedSuggestion"})(L.ObjectSchemaType||(L.ObjectSchemaType=
{}))},1865:function(J,L,d){Object.defineProperty(L,"__esModule",{value:!0});L.SearchSuggestionAnnotation=L.SearchSuggestionSignal=void 0;const m=d(408);class f{constructor(l){m.SchemaObject.assign(f,this,l)}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[f.getTypeName()])}}L.SearchSuggestionSignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(l){m.SchemaObject.assign(a,
this,l)}get metadata(){return this.M_}set metadata(l){this.M_=l}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[a.getTypeName()])}}L.SearchSuggestionAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1873:function(J,L,d){var m=this&&this.gQ||(Object.create?function(a,l,w,z){void 0===z&&(z=w);var x=Object.getOwnPropertyDescriptor(l,w);if(!x||
("get"in x?!l.sM:x.writable||x.configurable))x={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,z,x)}:function(a,l,w,z){void 0===z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(L,"__esModule",{value:!0});f(d(1874),L);f(d(1875),L);f(d(1876),L);f(d(1877),L)},1874:function(J,L){Object.defineProperty(L,"__esModule",{value:!0})},1875:function(J,L){Object.defineProperty(L,
"__esModule",{value:!0})},1876:function(J,L,d){Object.defineProperty(L,"__esModule",{value:!0});L.ContractEntityAnnotation=void 0;const m=d(408);class f{constructor(a){m.SchemaObject.assign(f,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntityAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}
L.ContractEntityAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1877:function(J,L,d){Object.defineProperty(L,"__esModule",{value:!0});L.ContractEntitySignal=void 0;const m=d(408);class f{constructor(a){m.SchemaObject.assign(f,this,a)}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntitySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}L.ContractEntitySignal=f;f.H_={T_:f.getTypeName(),
B_:f.getBaseTypes()}},1879:function(J,L,d){d.r(L);d.d(L,"ReactOICErrorDialogWithTrial",function(){return l});J=d(0);var m=d(108);L=d(1698);var f=d(465),a=d(169);class l extends L.a{constructor(w,z,x,u,v,E){super(w,z,x,u,v,E);z={["errorMessage"]:this.Qji,["offerString"]:this.Qgj};w=new a.a(!1,!1,!0);this.FSj?(w.Fd=1,z.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.xrb,["onExecute"]:()=>{f.Redirect.showHelp(this.aNi)}}):(w.Fd=4,w.Qe(2,this.jOi));w.Qe(1,this.GPd);w.Ng=this.id;z={["id"]:this.id,
["dialogIcon"]:this.icon,["bodyControls"]:z};w.mi(this.dialogTitle,Object(m.a)(this,this.Iko,"reactOICErrorDialogWithTrialHandler"),z)}}Object(J.a)(l,"ReactOICErrorDialogWithTrial",L.a,[])},1880:function(J,L,d){d.r(L);d.d(L,"OICErrorDialogWithTrial",function(){return a});J=d(0);var m=d(108);L=d(1698);var f=d(173);class a extends L.a{constructor(l,w,z,x,u,v){super(l,w,z,x,u,v);l=document.createElement("span");l.innerText=this.Qji;l.appendChild(document.createElement("br"));l.appendChild(document.createElement("br"));
w=document.createElement("span");w.innerText=this.Qgj;l.appendChild(w);w=new f.StandardDialog;this.FSj?(w.Fd=1,w.Edf(this.xrb,this.aNi)):(w.Fd=4,w.Qe(2,this.jOi));w.Qe(1,this.GPd);w.Ng=this.id;w.Ex(this.dialogTitle,null,this.icon,Object(m.a)(this,this.Ivn,"legacyOICErrorDialogWithTrialHandler"),l)}}Object(J.a)(a,"OICErrorDialogWithTrial",L.a,[])},1882:function(J,L,d){var m=this&&this.gQ||(Object.create?function(a,l,w,z){void 0===z&&(z=w);Object.defineProperty(a,z,{enumerable:!0,get:function(){return l[w]}})}:
function(a,l,w,z){void 0===z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(L,"__esModule",{value:!0});f(d(1883),L);f(d(1884),L)},1883:function(J,L){Object.defineProperty(L,"__esModule",{value:!0})},1884:function(J,L,d){Object.defineProperty(L,"__esModule",{value:!0});L.SearchProviderAnnotation=L.SearchProviderSignal=void 0;const m=d(408);class f{constructor(l){m.SchemaObject.assign(f,
this,l)}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[f.getTypeName()])}}L.SearchProviderSignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(l){m.SchemaObject.assign(a,this,l)}get metadata(){return this.M_}set metadata(l){this.M_=l}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,
[a.getTypeName()])}}L.SearchProviderAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1982:function(J,L,d){function m(ja){Type.registerNamespace("WordEditor.Comments");Type.registerNamespace("WordEditor.CommentsInteractive");Type.registerNamespace("Common.App.OAuth");ja?La.nso():La.main();ug.main(ja);tj.main(ja);Ba.a.instance.Lc(new Go,0,ja);Ba.a.instance.Lc(new Mk,0,ja);ck(ja);vc(ja)}var f=d(0),a=d(7),l=d(1307),w;(function(ja){ja[ja.unknown=0]="unknown";ja[ja.supported=1]="supported";ja[ja.nmq=
2]="userUnsupportedAnonymous";ja[ja.omq=3]="userUnsupportedNoLoginHint";ja[ja.r0p=4]="hostUnsupported";ja[ja.Icq=5]="perfAutomation"})(w||(w={}));Object(f.b)("SupportStatus",w);var z=d(904),x=d(1450);class u{constructor(ja){this.QCk=ja}initialize(){return Promise.resolve(0)}Zge(){return Promise.resolve(0)}pV(){a.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new x.a,{IsSuccess:!0,Token:this.QCk}))}YCe(){return Promise.resolve(Object.assign(new x.a,
{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}EAe(){return!1}Q3c(){return"MockAuthTokenStrategy"}}Object(f.a)(u,"MockAuthTokenStrategy",null,[310]);var v=d(1617);class E{static get(ja,Ua,yb){if(!yb)return ja;let Wb=0;return Promise.race([ja,new Promise(tc=>{Wb=window.setTimeout(()=>{tc(Ua)},yb)})]).then(tc=>{window.clearTimeout(Wb);return Promise.resolve(tc)}).catch(()=>{window.clearTimeout(Wb);
return Promise.resolve(Ua)})}}Object(f.a)(E,"PromiseWithTimeout",null,[]);var y=d(2),H=d(620);class I{constructor(ja,Ua,yb,Wb,tc){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=null;this.resource=ja;this.scope=Ua;this.silentLogin=yb;this.options=Wb;this.correlationId=tc}}Object(f.a)(I,"TokenRequestParameters",null,[326]);var F=d(18),C=d(19);class P{constructor(){this.vJh=null;let ja=y.AFrameworkApplication.J.ib(y.AFrameworkApplication.Uva),Ua=y.AFrameworkApplication.J.ib(y.AFrameworkApplication.mDe);
this.lac=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",ja&&""!==ja?ja:"Unspecified",Ua&&""!==Ua?Ua:"Unspecified")}initialize(){return new Promise(ja=>{C.a.instance.Ra(730).execute(Ua=>{this.vJh=Ua;ja(0)})})}ie(ja){const Ua=["HTTPS:","API:"];let yb=!1;const Wb=ja.toLocaleUpperCase();for(const tc of Ua)if(Wb.startsWith(tc)){yb=!0;break}return yb||this.chn(ja)?ja+"/.default":ja}chn(ja){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(ja)}Zge(){return Promise.resolve(0)}pV(ja,
Ua,yb,Wb,tc,Rc,Id){if(F.a.wXa){tc=H.a.iCp;if(!tc)return Ua=Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(Ua);if(!Array.contains(tc,ja))return Ua=Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+ja}),Promise.resolve(Ua)}ja=this.ie(yb);yb=new I(yb,ja,!Wb,null,y.AFrameworkApplication.userSessionId);return this.vJh.getAccessToken(yb,Ua,Id).then(Pd=>Object.assign(new x.a,
{IsSuccess:!0,Token:Pd.accessToken}),Pd=>Object.assign(new x.a,{IsSuccess:!1,ErrorCode:Pd}))}YCe(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}EAe(){return!1}Q3c(){return this.lac}}Object(f.a)(P,"ParentFrameTokenStrategy",null,[310]);var K=d(754),G=d(75);class R{constructor(){this.reject=this.resolve=null;this.startTime=0;this.Iuj=this.nUh=
null}}Object(f.a)(R,"PromiseWrapper",null,[]);class W{constructor(ja=0){this.vz=0;this.HMc=!1;this.Cz=new G.a;this._timeout=ja}enqueue(ja){return new Promise((Ua,yb)=>{this.Cz.add(Object.assign(new R,{Iuj:ja,resolve:Ua,reject:yb}));this.process()})}process(){if(this.HMc||this.vz===this.Cz.count)return!1;const ja=this.Cz.K(this.vz++);try{this.HMc=!0,ja.Iuj().then(Ua=>{this.HMc=!1;this.Epf(ja,Ua,null,!0)}).catch(Ua=>{this.HMc=!1;this.Epf(ja,null,Ua,!1)})}catch(Ua){this.HMc=!1,this.Epf(ja,null,Ua,!1)}return!0}Epf(ja,
Ua,yb,Wb){if(Wb){const tc=()=>{ja.resolve(Ua);this.process()};0<this._timeout?window.setTimeout(()=>{tc()},this._timeout):tc()}else{const tc=()=>{ja.reject(yb);this.process()};0<this._timeout?window.setTimeout(()=>{tc()},this._timeout):tc()}}}Object(f.a)(W,"PromiseQueue",null,[]);class Z{constructor(){this.correlationId=this.resolve=null}}Object(f.a)(Z,"ResolveWithCorrelation",null,[]);var T=d(83),N=d(169),U=d(933),ba=d(90);class X extends N.a{constructor(ja,Ua,yb,Wb,tc,Rc){super(!1,!1,!0);this.wdh=
this.yFa=null;this.O_n=()=>{this.ppi()};this.GDl=()=>this.vJ;this.QYo=Id=>{0===Id&&(this.TOk.reject(Object.assign(new x.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.mEb(null))};this.dya=ja;this.oHk=yb;this.ur=Wb;this.TOk=tc;this.mEb=Rc;this.vJ=document.createElement("iframe");this.vJ.id="SharedAuthInteractiveFrame";this.vJ.setAttribute("name","SharedAuthInteractiveFrame");this.vJ.setAttribute("title","SharedAuthInteractiveFrame");this.vJ.setAttribute("sandbox",
"allow-scripts allow-same-origin allow-forms allow-popups");this.vJ.style.border="0";this.vJ.style.height="48px";this.vJ.style.width="190px";$addHandler(this.vJ,"error",this.O_n);ja=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.dya,Ua,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1","&WacUserType=",y.AFrameworkApplication.userType);this.vJ.src=ja;this.mrk=new Promise(Id=>{this.wdh=Id});this.xdh=!1}x_a(){this.yFa={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.oHk,
["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:y.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:this.GDl,["resolveDialogStyles"]:this.wdh}};this.Fd=5;this.mi(CommonUIStrings.l_SignIn,this.QYo,this.yFa)}c7j(ja=!1,Ua=5){this.yFa&&this.yFa.bodyControls&&(!0!==Object(T.a)(Object,this.yFa.bodyControls).frameLoaded&&(Object(T.a)(Object,this.yFa.bodyControls).frameLoaded=!0),ja!==Object(T.a)(Object,this.yFa.bodyControls).frameLoadSuccess&&(Object(T.a)(Object,this.yFa.bodyControls).frameLoadSuccess=
ja),Ua!==this.yFa.dialogButtonsOption&&(this.yFa.dialogButtonsOption=null,this.Fd=Ua),this.update(this.yFa))}t5o(ja,Ua){const yb=new U.a(ba.a.UYo);yb.Values={["signInLabel"]:CommonUIStrings.l_SignIn,["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:y.AFrameworkApplication.isRtl,["messageCorrelationId"]:ja,["dialogStyles"]:Ua};this.ur.b_a(yb,this.vJ.contentWindow,this.dya)}ppi(){this.c7j(!1,6)}get LPj(){return this.vJ}get VQl(){return this.mrk.then(ja=>{this.xdh=!0;return ja})}get WQl(){return this.xdh}}
Object(f.a)(X,"SharedAuthConsentDialog",N.a,[351]);var Y=d(951),ca=d(87),ia=d(147),la=d(41),ta=d(124),za=d(95);class Ha{}Ha.kpiName="OAuthManager";Object(f.a)(Ha,"OAuthManagerConstants",null,[]);class Na{constructor(){this.vJ=null;this.nCd=0;this.I8b=this.Uac=this.WJe=this.mEb=this.Tda=this.tHh=null;this.YVn=()=>{const ja=la.a.Ge()-this.nCd;a.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",ja)};this.rvb=ja=>{const Ua=la.a.Ge()-this.nCd,yb=Object.assign(new za.a,
{durationMs:Ua});ca.Health.instance.recordKpiFailure(Ha.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,yb);a.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",Ua,this.cfh?JSON.stringify(ja):"")};this.r_n=ja=>{const Ua=this.$jb.loadFrame;var yb=la.a.Ge()-Ua.startTime,Wb=ja.Values.AuthLibrary.toString();ja=ja.Values.Success.toString();a.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",ja,Wb,yb);
Wb&&(this.lac="SharedAuthTokenStrategy "+Wb);Wb=Boolean.parse(ja);Wb||(ja=ia.a.KG(),void 0!==ja&&null!==ja&&(ja.set("AuthLibrary",this.Q3c()),yb=Object.assign(new za.a,{durationMs:yb,extendedProperties:ja}),ca.Health.instance.recordKpiFailure(Ha.kpiName,"SharedAuthStrategyInitFailed",!1,!0,yb)));Ua.resolve(Wb?0:1)};this.q_n=ja=>{if(ja.Values.interactive&&this.Uac&&this.Uac.Values.messageCorrelationId){const yb=this.Uac.Values.messageCorrelationId.toString();if(ja.Values.interactive&&this.Tda){this.Tda.VQl.then(Wb=>
{this.ur.b_a(this.Uac,this.Tda.LPj.contentWindow,this.dya);this.Tda.t5o(yb,Wb);this.Tda.c7j(!0);this.Uac=null});return}}ja=this.$jb.initFrame;const Ua=la.a.Ge()-ja.startTime;a.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",Ua);ja.resolve(0)};this.DVn=ja=>{if(ja.Values.messageCorrelationId&&ja.Values.messageCorrelationId.toString()){var Ua=ja.Values.messageCorrelationId.toString(),yb=this.$jb[Ua];if(yb){var Wb=la.a.Ge()-yb.startTime;a.ULS.sendTraceTag(573112906,
3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",Wb);ja.Values.isSuccess&&ja.Values.isSuccess?yb.resolve(ja.Values.response):yb.reject(ja.Values.response);this.F2j(Ua)}else a.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else a.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")};this.vWn=()=>{if(this.Tda.WQl)this.Tda.ppi();else if(this.WJe&&
this.Tda){const ja=new U.a(ba.a.OPj);ja.Values=this.UTh(this.WJe,!0);this.ur.b_a(ja,this.Tda.LPj.contentWindow,this.dya)}};this.NVn=()=>{this.Tda&&this.Tda.u$d()};this.hdg=ja=>{ja.Values.cancelled&&ja.Values.cancelled&&ja.Values.messageCorrelationId&&this.F2j(ja.Values.messageCorrelationId.toString());this.Tda&&this.Tda.hide()};this.ZWn=ja=>{if(ja.Values.messageCorrelationId&&ja.Values.messageCorrelationId.toString()){var Ua=this.$jb[ja.Values.messageCorrelationId.toString()];if(Ua){var yb=la.a.Ge()-
Ua.startTime;a.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",yb);ja.Values.isSuccess&&ja.Values.isSuccess?Ua.resolve(ja.Values.response):Ua.reject(ja.Values.response)}else a.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else a.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")};this.ur=new Y.a(null,null);this.lac=
"SharedAuthTokenStrategy Unloaded";this.dya=H.a.SYo;this.nDh=H.a.RYo;this.cfh=H.a.enableConsoleLogging;this.vsk=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.$Lk=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.NPk=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedWebWorkerEnabled",!1);this.$jb={};this.Qxk=new W(1500)}Q3c(){return this.lac}initialize(){if("loadFrame"in
this.$jb)return this.$jb.loadFrame.nUh;if(!this.dya)return ca.Health.instance.recordKpiFailure(Ha.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),a.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);const ja=this.fAe("loadFrame");this.nCd=la.a.Ge();var Ua=this.dya+this.nDh+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+y.AFrameworkApplication.userSessionId+"&WacUserType="+y.AFrameworkApplication.userType;
this.NPk&&(Ua+="&webworker=1");this.vJ=document.createElement("iframe");this.bUf(this.vJ);this.vJ.style.cssText="height:0;width:0;display:none;";this.vJ.id="SharedAuthFrame";this.vJ.setAttribute("name","SharedAuthFrame");this.vJ.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.vJ.setAttribute("title","SharedAuthFrame");this.vJ.src=Ua;document.body.appendChild(this.vJ);Ua=la.a.Ge()-this.nCd;a.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",
Ua,this.vJ.src);return ja}Zge(ja){this.WJe=ja;const Ua=new U.a(ba.a.OPj);Ua.Values=this.UTh(ja);ja=this.fAe("initFrame");this.ur.b_a(Ua,this.vJ.contentWindow,this.dya);a.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return ja}pV(ja,Ua,yb,Wb,tc,Rc){const Id=new U.a(ba.a.VYo),Pd=this.nEi();Id.Values=this.j2j(ja,Ua,yb,Wb,tc,Rc,Pd);ja=this.fAe(Pd);Wb&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",
!1)?this.Qxk.enqueue(()=>new Promise(Rd=>{this.qmp(Rc,Id,Rd,Pd)})):(this.ur.b_a(Id,this.vJ.contentWindow,this.dya),a.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",Ua));return ja}qmp(ja,Ua,yb,Wb){const tc=this.$jb[Wb];tc&&(this.Uac=Ua,this.mEb=Object.assign(new Z,{resolve:yb,correlationId:Wb}),this.Tda=new X(this.dya,this.nDh,ja,this.ur,tc,yb),this.Tda.x_a())}nEi(){return ta.a.create().toString()}j2j(ja,Ua,yb,Wb,tc,Rc,Id){const Pd={};Pd.appName=
ja;Pd.appId=Ua;Pd.target=yb;Pd.withPopup=Wb;Pd.claims=tc;Pd.promptMessage=Rc;Pd.messageCorrelationId=Id;return Pd}bUf(ja){$addHandler(ja,"load",this.YVn);$addHandler(ja,"error",this.rvb);this.ur.eea(this.dya);this.ur.Xu(ba.a.RPj);this.ur.sD(ba.a.RPj,this.r_n);this.ur.Xu(ba.a.QPj);this.ur.sD(ba.a.QPj,this.q_n);this.ur.Xu(ba.a.MPj);this.ur.sD(ba.a.MPj,this.DVn);this.ur.Xu(ba.a.SPj);this.ur.sD(ba.a.SPj,this.ZWn);this.ur.Xu(ba.a.PPj);this.ur.sD(ba.a.PPj,this.vWn);this.ur.Xu(ba.a.NPj);this.ur.sD(ba.a.NPj,
this.NVn);this.ur.Xu(ba.a.KPj);this.ur.sD(ba.a.KPj,this.hdg)}fAe(ja){const Ua=new R;Ua.startTime=la.a.Ge();const yb=new Promise((Wb,tc)=>{Ua.resolve=Wb;Ua.reject=tc});Ua.nUh=yb;this.$jb[ja]=Ua;return yb}UTh(ja,Ua=!1){const yb={};yb.appIds=this.Efm();yb.upn=ja.loginHint;yb.authority=ja.authority;yb.authorityType=Object(l.a)(z.a,ja.authorityType);yb.tenantId=ja.tenantId;yb.correlationId=y.AFrameworkApplication.userSessionId;yb.enableConsoleLogging=this.cfh;yb.enablePopupFlash=this.vsk;yb.skipUpnCheck=
this.$Lk;yb.interactive=Ua;return yb}Efm(){const ja=[],Ua=H.a.Xgf;for(const Wb in Ua){var yb=Ua[Wb];Array.contains(ja,yb)||Array.add(ja,yb)}return ja}YCe(ja,Ua,yb,Wb,tc,Rc){const Id=new U.a(ba.a.TYo),Pd=this.nEi();Id.Values=this.j2j(ja,Ua,yb,Wb,tc,Rc,Pd);this.tHh=Id;ja=this.fAe(Pd);a.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",Ua);this.V2o();return ja}EAe(){return!0}V2o(){this.I8b||(this.I8b=new K.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,
CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.I8b.id=16,this.I8b.k9c=!1,this.I8b.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{a.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.ur.b_a(this.tHh,this.vJ.contentWindow,this.dya)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),y.AFrameworkApplication.ua.Ib.Jya(this.I8b,!0)||a.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}F2j(ja){this.mEb&&
this.mEb.correlationId===ja&&(this.mEb.resolve(null),this.mEb=null)}}Object(f.a)(Na,"SharedAuthTokenStrategy",null,[310]);class ya{constructor(ja){this.o$=ja;this.lac="UnsupportedAuthTokenStrategy Reason="+w[this.o$]}initialize(){return Promise.resolve(0)}Zge(){return Promise.resolve(0)}pV(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:w[this.o$],ErrorMessage:"Unable to get a token. Reason: ["+w[this.o$]+"]"}))}YCe(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,
ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}EAe(){return!1}Q3c(){return this.lac}}Object(f.a)(ya,"UnsupportedAuthTokenStrategy",null,[310]);var ma=d(1383);class Ea{constructor(ja=null){this.T4=0;this.Uca=null;this.mHb=0;this.Coh=!!window.location.search.match(RegExp("wdpa=1","gi"));const Ua=la.a.Ge();this.wxk=this.WPl(ja).then(yb=>yb?this.n2m():(a.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",
this.OJ(),Math.floor(la.a.Ge()-Ua)),yb=ia.a.KG(),void 0!==yb&&null!==yb&&(yb.set("AuthLibrary",this.OJ()),yb=Object.assign(new za.a,{durationMs:Math.floor(la.a.Ge()-Ua),extendedProperties:yb}),ca.Health.instance.recordKpiFailure(Ha.kpiName,"StrategyPickFailed",!1,!0,yb)),Promise.resolve(1))).then(yb=>0!==yb?Promise.resolve(yb):this.Zwn())}XPl(){if(this.Coh)this.T4=5,this.Uca=new ya(this.T4);else{var ja=H.a.kKn;ja&&0<ja.length?(this.T4=1,this.Uca=new u(ja)):y.AFrameworkApplication.J.$("IsO365ConsumerHost")||
y.AFrameworkApplication.J.$("IsO365CommercialHost")?y.AFrameworkApplication.J.$("IsAnonymousUser")?(this.T4=2,this.Uca=new ya(this.T4)):(ja=v.a.getAuthContext().loginHint)&&ja.length?H.a.L5c?(this.T4=1,this.Uca=new P):(this.T4=1,this.Uca=new Na):(this.T4=3,this.Uca=new ya(this.T4)):(this.T4=4,this.Uca=new ya(this.T4))}}OJ(){return this.Uca?this.Uca.Q3c()||"Unknown":"None"}WPl(ja=null){a.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const Ua=la.a.Ge();return y.AFrameworkApplication.J.prm().then(yb=>
{yb?(this.XPl(),ja&&(this.Uca=ja),a.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",H.a.clientVersion,H.a.appVersion,H.a.FUl,this.OJ(),Math.floor(la.a.Ge()-Ua))):a.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(la.a.Ge()-Ua));return Promise.resolve(yb)},()=>{a.ULS.sendTraceTag(562128580,
3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(la.a.Ge()-Ua));return Promise.resolve(!1)})}n2m(){a.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.OJ());const ja=la.a.Ge();return E.get(this.Uca.initialize(),2,H.a.xmg).then(Ua=>{if(0===Ua)a.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.OJ(),Math.floor(la.a.Ge()-ja));else if(1===Ua){a.ULS.sendTraceTag(527827291,
3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.OJ(),Math.floor(la.a.Ge()-ja));var yb=ia.a.KG();void 0!==yb&&null!==yb&&(yb.set("AuthLibrary",this.OJ()),yb=Object.assign(new za.a,{durationMs:Math.floor(la.a.Ge()-ja),extendedProperties:yb}),ca.Health.instance.recordKpiFailure(Ha.kpiName,"StrategyInitFailed",!1,!0,yb))}else 2===Ua&&(a.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.OJ(),Math.floor(la.a.Ge()-ja)),yb=ia.a.KG(),void 0!==yb&&null!==yb&&(yb.set("AuthLibrary",this.OJ()),yb=Object.assign(new za.a,{durationMs:Math.floor(la.a.Ge()-ja),extendedProperties:yb}),ca.Health.instance.recordKpiFailure(Ha.kpiName,"StrategyInitTimedOut",!1,!0,yb)));return Promise.resolve(Ua)},()=>{a.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.OJ(),Math.floor(la.a.Ge()-ja));return Promise.resolve(1)})}Zwn(){a.ULS.sendTraceTag(562128581,
3E3,50,"Loading {0}",this.OJ());const ja=la.a.Ge();return E.get(this.Uca.Zge(v.a.getAuthContext()),2,H.a.xmg).then(Ua=>{if(0===Ua)a.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.OJ(),Math.floor(la.a.Ge()-ja));else if(1===Ua){a.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.OJ(),Math.floor(la.a.Ge()-ja));var yb=ia.a.KG();void 0!==yb&&null!==yb&&(yb.set("AuthLibrary",this.OJ()),yb=Object.assign(new za.a,
{durationMs:Math.floor(la.a.Ge()-ja),extendedProperties:yb}),ca.Health.instance.recordKpiFailure(Ha.kpiName,"StrategyLoadFailed",!1,!0,yb))}else 2===Ua&&(a.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.OJ(),Math.floor(la.a.Ge()-ja)),yb=ia.a.KG(),void 0!==yb&&null!==yb&&(yb.set("AuthLibrary",this.OJ()),yb=Object.assign(new za.a,{durationMs:Math.floor(la.a.Ge()-ja),extendedProperties:yb}),ca.Health.instance.recordKpiFailure(Ha.kpiName,
"StrategyLoadTimedOut",!1,!0,yb)));return Promise.resolve(Ua)},()=>{a.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.OJ(),Math.floor(la.a.Ge()-ja));return Promise.resolve(1)})}pV(ja,Ua,yb=null){return this.Qzc(ja,Ua,!1,null,"",yb)}k2j(ja,Ua,yb,Wb,tc=null){return this.Qzc(ja,Ua,!0,yb,Wb,tc)}Qzc(ja,Ua,yb,Wb,tc,Rc,Id=0){Id+=1;a.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",
ja,this.KZb(ja,Ua),this.OJ(),Id);var Pd=ia.a.KG();void 0!==Pd&&null!==Pd&&(Pd.set("AuthLibrary",this.OJ()),Pd.set("AppName",ja),Pd.set("Target",this.KZb(ja,Ua)),ca.Health.instance.recordKpiUsage(Ha.kpiName,0,"WacOAuthFC",Pd));if(!H.a.isEnabled||this.Coh){var Rd;return this.e5f((Rd=new x.a,Rd.IsSuccess=!1,Rd.Token=null,Rd.ErrorCode="NotEnabled",Rd.ErrorMessage="OAuthManager is disabled.",Rd),ja)}const Ue=H.a.Xgf[ja];if(void 0===Ue||null===Ue){a.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",
ja);var tf;return this.e5f((tf=new x.a,tf.IsSuccess=!1,tf.Token=null,tf.ErrorCode="DisallowedApp",tf.ErrorMessage="Disallowed appName: "+ja,tf),ja)}const cg=la.a.Ge();let fg=cg;const Mg=this;Pd=this.wxk.then(ej=>{fg=la.a.Ge();return Mg.ban(ja,Ue,Ua,yb,Wb,tc,Rc,ej)});Rd=yb?0:H.a.xmg;let Fh;tf=(Fh=new x.a,Fh.IsSuccess=!1,Fh.Token=null,Fh.ErrorCode="authTokenStrategy_timeout",Fh.ErrorMessage="Auth Strategy timed out after ["+Rd+"] ms when fetching token",Fh);const zj=this,om=this;return E.get(Pd,tf,
Rd).then(ej=>Id<=Ea.xHn&&(ej.ErrorCode===Ea.m_j||ej.ErrorCode===Ea.Qap)?(a.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",Id,Math.floor(la.a.Ge()-cg)),zj.Qzc(ja,Ua,yb,Wb,tc,Rc,Id)):ej.ErrorCode===Ea.f3i&&!yb&&(a.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",Id,Ea.cii),Ea.oYl&&zj.Uca.EAe()&&zj.Uca.YCe(ja,Ue,Ua,yb,Wb,tc).then(Kj=>Promise.resolve(zj.Ihe(Kj,ja,Ua,Ue,cg,fg))).catch(()=>
{let Kj;const Tl=(Kj=new x.a,Kj.IsSuccess=!1,Kj.Token=null,Kj.ErrorCode="authTokenStrategy_failure",Kj.ErrorMessage="LoginPopup failed, GetToken could not be called",Kj);return Promise.resolve(zj.Ihe(Tl,ja,Ua,Ue,cg,fg))}),Ea.cii)?zj.Qzc(ja,Ua,!0,Wb,tc,Rc,Id):Promise.resolve(zj.Ihe(ej,ja,Ua,Ue,cg,fg))).catch(()=>{let ej;const Kj=(ej=new x.a,ej.IsSuccess=!1,ej.Token=null,ej.ErrorCode="authTokenStrategy_failure",ej.ErrorMessage="Auth Strategy failed with an unknown error",ej);return Promise.resolve(om.Ihe(Kj,
ja,Ua,Ue,cg,fg))})}ban(ja,Ua,yb,Wb,tc,Rc,Id,Pd){return 1===Pd||2===Pd?this.e5f(Object.assign(new x.a,{IsSuccess:!1,Token:null,ErrorCode:1===Pd?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),ja):this.Uca.pV(ja,Ua,yb,Wb,tc,Rc,Id).then(Rd=>Promise.resolve(this.Pfj(Rd,!0,ja))).catch(Rd=>Promise.resolve(this.Pfj(Rd,!1,ja)))}Ihe(ja,Ua,yb,Wb,tc,Rc){const Id={},Pd=la.a.Ge()-Rc;Id.IsSuccess=ja.IsSuccess;Id.ErrorCode=ja.IsSuccess?"Success":ja.ErrorCode||"";Id.ErrorMessage=
ja.IsSuccess?"Success":this.KZb(Ua,ja.ErrorMessage||"");Id.Target=this.KZb(Ua,yb||"");Id.TimeInMS=Math.floor(Pd);Id.LoadTimeInMS=Math.floor(Rc-tc);Id.AuthLibrary=this.OJ();Id.AppName=Ua;Id.AuthorityType=Object(l.a)(z.a,v.a.e4d());Id.UserType=this.RNm(v.a.getAuthContext());Id.IsAuthSupportedInSession=w[this.T4];Id.RequestCount=++this.mHb;Id.AppId=Wb;a.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(Id));ja.IsSuccess||(yb=ia.a.KG(),void 0!==yb&&null!==yb&&(yb.set("AppName",Ua),yb.set("AuthLibrary",
this.OJ()),yb.set("ErrorCode",ja.ErrorCode),yb.set("ErrorMessage",this.KZb(Ua,ja.ErrorMessage)),Ua=Object.assign(new za.a,{durationMs:Pd,extendedProperties:yb}),ca.Health.instance.recordKpiFailure(Ha.kpiName,"TryGetTokenFailure",!1,!0,Ua)));return ja}e5f(ja,Ua){a.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",Ua,this.KZb(Ua,ja.ErrorMessage));const yb=ia.a.KG();void 0!==yb&&null!==yb&&(yb.set("AppName",Ua),yb.set("AuthLibrary",this.OJ()),
yb.set("ErrorCode",ja.ErrorCode),yb.set("ErrorMessage",this.KZb(Ua,ja.ErrorMessage)),Ua=Object.assign(new za.a,{extendedProperties:yb}),ca.Health.instance.recordKpiFailure(Ha.kpiName,"FailureBeforeGetToken",!1,!0,Ua));return Promise.resolve(ja)}XWi(ja){return ja===ma.a.NBe}KZb(ja,Ua){return this.XWi(ja)&&Ua?"REDACTED":Ua}RNm(ja){return y.AFrameworkApplication.J.$("IsAnonymousUser")?"anonymous":!ja.loginHint||1>ja.loginHint.length?"empty":-1<ja.loginHint.indexOf("guest#")?"guest":-1<ja.loginHint.indexOf("ext#")?
"external":0>ja.upn.indexOf("@")?"no-at":"supported"}qbn(){return 1===this.T4}Pfj(ja,Ua,yb){let Wb=null,tc=null,Rc=null,Id=null;ja?ja.ErrorCode||ja.ErrorMessage?(tc=ja.ErrorCode?ja.ErrorCode:Ea.lki,Rc=ja.ErrorMessage?ja.ErrorMessage:"No message"):ja.Token?Ua?Wb=ja.Token:(tc=Ea.Jto,Rc="A rejected promise returned a token."):(tc=Ea.lki,Rc=JSON.stringify(ja)):(tc=Ea.ONn,Rc="No result came from Auth Token Strategy");ja&&ja.Telemetry&&!this.XWi(yb)&&(Id=ja.Telemetry,a.ULS.sendTraceTag(579166408,3E3,50,
JSON.stringify(Id)));if(tc===Ea.GKn||tc===Ea.rip)tc=Ea.m_j,Rc="Auth Library Timed Out";tc===Ea.r9k&&-1<Rc.indexOf(Ea.ZQk)&&(tc=Ea.f3i);if(tc||Rc)Wb=null;return Object.assign(new x.a,{IsSuccess:!!Wb,Token:Wb,ErrorCode:tc,ErrorMessage:Rc,Telemetry:Id})}static get cii(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get oYl(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",
!1)}}Ea.rip="token_renewal_error";Ea.lki="Exception";Ea.ONn="NoResult";Ea.Jto="RejectToken";Ea.GKn="monitor_window_timeout";Ea.m_j="Timeout";Ea.Qap="authTokenStrategy_timeout";Ea.r9k="login_required";Ea.ZQk="AADSTS50058";Ea.f3i="Cookies Disabled";Ea.xHn=2;Object(f.a)(Ea,"OAuthManager",null,[258]);var Ba=d(177),$a=d(29),ea=d(46),ka=d(86);class La{get name(){return"Common.App.OAuth.OAuthPackage"}uc(ja){ja.register(258,722).ha().Sd(()=>new Ea)}init(){const ja=C.a.instance.resolve(722);this.vnp(ja);this.unp(ja)}unp(ja){if(y.AFrameworkApplication.J&&
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthTokenWithCAEClaimTestEnabled",!1)){var Ua=y.AFrameworkApplication.J.ib("FileSource");if(y.AFrameworkApplication.J.$("IsO365ConsumerHost")||y.AFrameworkApplication.J.$("IsO365CommercialHost")||"WopiTest"===Ua){var yb=H.a.jXd;if(yb&&yb.IsEnabled){var Wb=yb.Application,tc=H.a.authority;if(void 0!==Wb&&null!==Wb&&Wb.length&&void 0!==tc&&null!==tc&&tc.length){var Rc=w[ja.T4],Id=F.a.XD,Pd=ja.OJ(),Rd=la.a.Ge();ja.pV("CAETest",
Wb).then(Ue=>{const tf=Math.floor(la.a.Ge()-Rd);Rc=w[ja.T4];Id=F.a.XD;Pd=ja.OJ();a.ULS.sendTraceTag(508950355,3E3,50,'OAuthManager attempted to get a CAE test token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',tf,Ue.IsSuccess,Rc,Ue.ErrorCode,Ua,Id,Pd);if(Ue.IsSuccess){Ue="Bearer "+Ue.Token;y.AFrameworkApplication.Ee.SAc=Ue;var cg=yb.Endpoint;if(cg){var fg=la.a.Ge();Ue={["Authorization"]:Ue};cg=ea.a.Ap(cg,"ReturnRawToken",
"1");cg=ea.a.Ap(cg,"EnforceCAE","1");y.AFrameworkApplication.Ee.HJb(cg,1,null,Ue,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(Mg=>{var Fh=Math.floor(la.a.Ge()-fg),zj=null;Mg.kp?Mg="Canceled":Mg.fj?Mg="Faulted":(zj=Mg.result,Mg=zj.succeeded?"Completed":"Failed");Fh={["TaskResult"]:Mg,["BrowserTokenDurationMS"]:tf,["BrowserValidationDurationMS"]:Fh};zj&&(Fh.HttpStatus=zj.args.data.Ie,zj.succeeded&&(zj=$a.a(zj.args.data.De),Fh.ServerValidationDurationMS=zj.ElapsedMilliseconds,
Fh.ServerValidationResult=zj.ValidatedToken,Fh.KMSI=zj.KMSI,Fh.Scopes=zj.Scopes,Fh.TokenExpirationS=Math.floor(parseInt(zj.Expiration)-(new Date).getTime()/1E3)));a.ULS.sendTraceTag(508950354,3E3,"Completed"===Mg?50:15,ka.a.toJSON(Fh))})}}else a.ULS.sendTraceTag(508950353,3E3,15,"ValidateAccess Failed: ErrorCode: {0}, ErrorMessage: {1}",Ue.ErrorCode,Ue.ErrorMessage)}).catch(Ue=>{const tf=Math.floor(la.a.Ge()-Rd);a.ULS.sendTraceTag(508950352,3E3,15,"UNEXPECTED CATCH: {0}, duration: {1}",Ue.toString(),
tf)})}}}}}vnp(ja){const Ua=y.AFrameworkApplication.J.ib("FileSource");if(y.AFrameworkApplication.J.$("IsO365ConsumerHost")||y.AFrameworkApplication.J.$("IsO365CommercialHost")||"WopiTest"===Ua){var yb=H.a.jXd;if(yb&&yb.IsEnabled){var Wb=yb.Application,tc=H.a.authority;if(void 0!==Wb&&null!==Wb&&Wb.length&&void 0!==tc&&null!==tc&&tc.length){var Rc=w[ja.T4],Id=F.a.XD,Pd=ja.OJ();try{var Rd=new Map;void 0!==Rd&&null!==Rd?(Rd.set("SupportStatus",Rc),Rd.set("Browser",Id),Rd.set("AuthStrategy",Pd)):Rd=null}catch(tf){Rd=
null}ca.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",Rd);var Ue=la.a.Ge();ja.pV("Core",Wb).then(tf=>{const cg=Math.floor(la.a.Ge()-Ue);Rc=w[ja.T4];Id=F.a.XD;Pd=ja.OJ();a.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',cg,tf.IsSuccess,Rc,tf.ErrorCode,Ua,Id,Pd);Rd&&(Rd.set("SupportStatus",Rc),Rd.set("Browser",Id),
Rd.set("AuthStrategy",Pd));var fg=Object.assign(new za.a,{durationMs:cg,extendedProperties:Rd});if(tf.IsSuccess){if(ca.Health.instance.recordKpiSuccess("WacCorePFT",fg),tf="Bearer "+tf.Token,y.AFrameworkApplication.Ee.SAc=tf,fg=yb.Endpoint){var Mg=la.a.Ge();y.AFrameworkApplication.Ee.HJb(fg,1,null,{["Authorization"]:tf},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(Fh=>{var zj=Math.floor(la.a.Ge()-Mg),om=null;Fh.kp?Fh="Canceled":Fh.fj?Fh="Faulted":(om=Fh.result,Fh=om.succeeded?
"Completed":"Failed");zj={["TaskResult"]:Fh,["BrowserTokenDurationMS"]:cg,["BrowserValidationDurationMS"]:zj};om&&(zj.HttpStatus=om.args.data.Ie,om.succeeded&&(om=$a.a(om.args.data.De),zj.ServerValidationDurationMS=om.ElapsedMilliseconds,zj.ServerValidationResult=om.ValidatedToken,zj.KMSI=om.KMSI,zj.Scopes=om.Scopes,zj.TokenExpirationS=Math.floor(parseInt(om.Expiration)-(new Date).getTime()/1E3)));a.ULS.sendTraceTag(520632322,3E3,"Completed"===Fh?50:15,ka.a.toJSON(zj))})}}else ca.Health.instance.recordKpiFailure("WacCorePFT",
tf.ErrorCode,!1,!1,fg)}).catch(tf=>{var cg=Math.floor(la.a.Ge()-Ue);cg=Object.assign(new za.a,{durationMs:cg,extendedProperties:Rd});ca.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+tf.toString(),!1,!1,cg)})}}}}dispose(){}static main(){Ba.a.instance.Lc(new La)}static nso(){Ba.a.instance.Lc(new La,0,!0)}}Object(f.a)(La,"OAuthPackage",null,[0,1]);var va=d(373),Ca=d(356),ua=d(17);class Sa{constructor(){new Ca.a}}Object(f.a)(Sa,"SdxPaneSuppressionManager",null,[]);var Ta=d(267),zb=
d(242),Ra=d(119);class qb{constructor(ja){this.y0e=0;this.DDk=ja}Mub(){return this.y0e>=this.DDk}reset(){this.y0e=0}update(){this.y0e++}}Object(f.a)(qb,"NodeCountBasedTaskYieldStrategy",null,[671]);var kb=d(1821);class Va{constructor(){this.Emd=new Set}kNa(ja){this.Emd.add(ja)}Lpp(ja){this.Emd.delete(ja)}F_n(){return()=>{this.Emd.forEach(ja=>{ja.onSessionClose()})}}G_n(){return()=>{this.Emd.forEach(ja=>{ja.onSessionConnect()})}}H_n(){return()=>{this.Emd.forEach(ja=>{ja.onSessionDisconnect()})}}}Object(f.a)(Va,
"AlSessionLifeEventNotifier",null,[520]);var Za=d(1774),Ka=d(88),bb=d(92),Ib=d(48),ib=d(5),jb=d(1399),hb=d(515),pb=d(1368),ob=d(1413),sb=d(1402),Ab=d(358),nc=d(1423),qc=d(781),Jc=d(625),ad=d(751);class Kc{constructor(){this.token=null}}Object(f.a)(Kc,"ReleaseAnnotationParameters",null,[]);class Jb{constructor(){this.value=this.id=this.parentPath=null}}Object(f.a)(Jb,"SetAnnotationMetadataParameters",null,[]);class Zb{constructor(){this.id=this.parentPath=null;this.value=0}}Object(f.a)(Zb,"SetAnnotationStateParameters",
null,[]);var xb=d(589),$b=d(276),Xb=d(94),Lb=d(469),gc=d(1540),qa=d(307),ra=d(622),Ya=d(8),ab=d(859);class cb extends Sys.EventArgs{constructor(ja,Ua){super();this.annotation=ja;this.rTa=Ua}}Object(f.a)(cb,"AnnotationLocalStateChangedEventArgs",Sys.EventArgs,[]);var Eb=d(1639);class mc{constructor(ja){this.Qgf=this.annotations=null;if(!ja)a.ULS.sendTraceTag(41418884,389,10,"Null operation received!"),this.annotations=null;else if(ja.items&&0<ja.items.length){const Ua=mc.m7d(ja.parentPath);this.annotations=
Array(ja.items.length);let yb=0;for(const Wb of ja.items){const tc=Object.assign(new Eb.a,{id:Wb.id,parentPath:Ua,content:Wb.body,annotationType:Ab.a.getTypeNameFor(Wb.body),parentRevId:ja.parentRevId});this.annotations[yb++]=tc}this.Qgf=Ab.a.getTypeNameFor(ja)}}static m7d(ja){return ja?ja.join("\\"):""}}Object(f.a)(mc,"AnnotationOperation",null,[]);class tb extends Sys.EventArgs{constructor(ja){super();this.annotationType=ja}}Object(f.a)(tb,"AnnotationActivationEventArgs",Sys.EventArgs,[]);class Xa extends Sys.EventArgs{constructor(ja,
Ua){super();this.annotation=ja;this.opType=Ua}}Object(f.a)(Xa,"AnnotationOperationEventArgs",Sys.EventArgs,[]);class Mb{constructor(){this.newState=this.oldState=0;this.handlers=new G.a}}Object(f.a)(Mb,"AnnotationResultStateUpdateData",null,[]);var cc=d(603),oc=d(970);class Pc{constructor(){this.Ngf=this.t3k=this.Ogf=null}}Object(f.a)(Pc,"AnnotationCallbacks",null,[]);class vb{constructor(ja,Ua,yb,Wb,tc,Rc){this.tbc=null;this.zMc=new Ca.a(0);this.WQc=new Ca.a;this.Xvd=new Ca.a;this.HId=new cc.a;this.pfg=
null;this.kj=ja;this.oRa=Ua;this.zH=yb;this.ED=Wb;this.HK=tc;this.Bd=Rc}KCp(ja,Ua,yb,Wb){this.ED.Mmc(ja)&&this.kj.$d(()=>{if(!this.tbc){this.tbc=new Ca.a;var tc=Ya.ParagraphReader.Hv(ab.a.getRootNode(),!0,!0);for(const Rc of tc)Rc&&(tc=Rc.ka(ib.a.Yc,0))&&(this.tbc.add(tc,Rc.id),this.zMc.Z(Rc.id.toString(),tc))}this.oRa.ofg(ja,(Rc,Id)=>{if(Rc){var Pd=this.ED.fAi(ja);Rc.contentDescriptor.Uw===Pd&&((Pd=this.Arm(Rc))?Rc.Ylb?(Pd=this.Irf(Rc,Pd))&&(Id?yb(Id,Rc.contentDescriptor):Ua(Pd,Rc.contentDescriptor)):
Wb(Rc.contentDescriptor):this.UMl(Rc,Object.assign(new Pc,{Ogf:Ua,t3k:yb,Ngf:Wb})))}})},"PAS:FEPAOT")}Arm(ja){if(3===ja.contentDescriptor.Uw){let Ua;return({value:Ua}=this.tbc.Ac(ja.contentDescriptor.paragraphId)).returnValue?Ua:null}if(4===ja.contentDescriptor.Uw)return Ib.a.nil;a.ULS.sendTraceTag(592525442,vb.lj,15,"GetGraphNodeIdForAnnotationIfConnected: Unsupported content type");return null}Zgn(ja,Ua){if(3===ja.contentDescriptor.Uw)return Ua=this.HK.value.Eb(Ua).getValue(ib.a.Uj),ja.contentDescriptor.Uj===
Ua;if(4===ja.contentDescriptor.Uw&&Ua===Ib.a.nil)return!0;a.ULS.sendTraceTag(592525443,vb.lj,15,"IsGraphNodeValidForAnnotation: Unsupported content type");return!1}UMl(ja,Ua){if(3===ja.contentDescriptor.Uw){const yb=ja.contentDescriptor.paragraphId;this.WQc.lb(yb)||this.WQc.add(yb,new G.a);this.WQc.K(yb).add(Wb=>{12===Wb.type&&this.tbc.add(yb,Wb.id);ja.Ylb?(Wb=this.Irf(ja,Wb.id))&&Ua.Ogf(Wb,ja.contentDescriptor):Ua.Ngf(ja.contentDescriptor)})}else if(4===ja.contentDescriptor.Uw)if(ja.Ylb){const yb=
this.Irf(ja,Ib.a.nil);yb&&Ua.Ogf(yb,ja.contentDescriptor)}else Ua.Ngf(ja.contentDescriptor);else a.ULS.sendTraceTag(592525444,vb.lj,15,"DelayCallbackForAnnotation: Unsupported content type")}Irf(ja,Ua){if(this.Zgn(ja,Ua)){if(Ua=this.ED.bOn(ja.Ylb,ja.contentDescriptor,Ua.toString()))return this.Xvd.Z(Ua.id,ja.Vcb),Ua}else this.Bd.isFeatureEnabled(82)&&this.zH.FRc(ja);return null}U6j(ja,Ua){const yb=this.ED.O4d(ja);yb&&(Ua===ob.a.getTypeName()?this.Dlp(ja,yb):this.nlp(ja,yb))}Dlp(ja,Ua){this.ED.Mmc(ja.annotationType)&&
(this.zH.CZa(this.HK.value,Ua,ja.annotationType),this.Xvd.remove(ja.id))}nlp(ja,Ua){if(this.ED.Mmc(ja.annotationType)){Ua=Object.assign(new oc.a,{Ylb:this.ED.x3k(ja),contentDescriptor:Ua,annotationType:ja.annotationType});Ua=this.zH.addAnnotation(this.HK.value,Ua);this.Xvd.Z(ja.id,Ua);const yb=this.ED.VIi(ja.annotationType);yb&&this.HId.contains(yb)&&(this.kj.$d(()=>{var Wb=Ya.ParagraphReader.Hv(ab.a.getRootNode(),!0,!0);if(Wb&&0<Wb.count){const tc=new G.a;for(const Rc of Wb)(Wb=vb.i7d(Rc))&&tc.add(Wb);
0<tc.count&&this.zH.EMh(this.HK.value,yb,tc.toArray())}},"PAS:TAOCPA"),this.HId.remove(yb))}}xvb(ja){if(this.tbc)if(ja){var Ua=ja.ka(ib.a.Yc,0);if(Ua&&(this.zMc.Z(ja.id.toString(),Ua),({value:Ua}=this.WQc.Ac(Ua)).returnValue))for(const yb of Ua)yb(ja)}else a.ULS.sendTraceTag(592525445,vb.lj,10,"OnParagraphNodeConnected: Invalid node")}Rkj(ja,Ua){if(ja){var yb=ja.id.toString();ja=ja.ka(ib.a.Yc,0);var Wb=0;({value:Wb}=this.zMc.Ac(yb)).returnValue&&(3===Ua?(this.WQc.remove(Wb),this.zMc.remove(yb)):2===
Ua?this.zMc.Z(yb,ja):a.ULS.sendTraceTag(592525447,vb.lj,15,"OnParagraphNodeModified: Updating persisted annotation not supported for event"))}else a.ULS.sendTraceTag(592525446,vb.lj,10,"UpdatePersistedAnnotations: Invalid node")}sFm(ja){let Ua;return({value:Ua}=this.Xvd.Ac(ja)).returnValue?Ua:Ib.a.nil}Vxp(ja,Ua,yb){ja?Ua?this.oRa.PCi(ja,Wb=>{if(Wb){const Id=vb.i7d(Ua,yb);if(Id){var tc=Array(Wb.length),Rc=!1;for(let Pd=0;Pd<Wb.length;Pd++)if(Rc||Id!==Wb[Pd])tc[Pd]=Wb[Pd];else{const Rd=vb.i7d(Ua);if(!Rd)return;
Rc=!0;tc[Pd]=Rd;Wb[Pd]=Rd}Rc&&this.zH.EMh(this.HK.value,ja,tc)}}}):a.ULS.sendTraceTag(588863697,vb.lj,10,"UpdateWorkflowParagraphVersion: Invalid node"):a.ULS.sendTraceTag(588863696,vb.lj,10,"UpdateWorkflowParagraphVersion: null workflowType")}YTo(ja){ja?this.HId.add(ja):a.ULS.sendTraceTag(588863698,vb.lj,10,"SetPendingWorkflow: null workflowType")}Npl(ja){ja?this.HId.remove(ja):a.ULS.sendTraceTag(588105731,vb.lj,10,"ClearPendingWorkflow: null workflowType")}static i7d(ja,Ua=0){if(!ja)return null;
Ua||(Ua=ja.ka(ib.a.Uj,0));ja=Ya.ParagraphReader.nU(ja);if(Ua&&ja)return String.format("{0}{1}{2}",ja,vb.e6n,Ua);a.ULS.sendTraceTag(588091606,vb.lj,10,"GetParagraphVersion: Node with text id {0} and paragraph id {1}",Ua?"valid":"0",ja?"valid":"0");return null}}vb.lj=389;vb.e6n="-";Object(f.a)(vb,"PersistedAnnotationStorage",null,[668]);class jd{constructor(){this.config=this.token=null}}Object(f.a)(jd,"UpdateAnnotationConfigParameters",null,[]);var ud=d(127),qe=d(784),Ae=d(370),hf=d(1265),Qe=d(1313),
vf=d(268),Jd=d(753),mh=d(2074),gh=d(1824),Td=d(855),Vc=d(774);class id{constructor(ja,Ua,yb,Wb,tc,Rc,Id,Pd,Rd,Ue,tf,cg=null,fg){this.rkb=fg;this.sa=new Ka.a;this.bFa=new Xb.a;this.m9=new Xb.a;this.FD=new Xb.a;this.CRc=new Xb.a;this.yJe=new Xb.a;this.oFc=new xb.a($b.a.th());this.V1e=new G.a;this.P3b=new Xb.a;this.uJe=new Xb.a;this.Yvd=new Xb.a;this.Q3b=new Xb.a;this.CCc=new Xb.a;this.Zvd=new Xb.a;this.gyd=new Xb.a;this.QGd=[];this.RGd=[];this.xKc=null;this.EDk=new xb.a($b.a.th());this.wJe=new Map;
this.lFc=new Map;this.NDc=null;this.qoa=new Xb.a;this.yXc=null;this.Uxh=this.Ulh=0;this.v4a=null;this.RJl=()=>{if(this.QGd.length||this.RGd.length)try{0<this.QGd.length&&this.WFn(),0<this.RGd.length&&this.cpp()}finally{this.aql()}else this.Gb.uf(this.xKc),this.xKc=null};this.Ypl=()=>{const Mg=new G.a;for(const Fh of this.FD.values)if(Mg.add(Fh),Mg.count===id.NDk)break;for(const Fh of Mg)this.xUa(Fh),this.XZb(Fh,ob.a.getTypeName());this.FD.count||(this.Gb.uf(this.NDc),this.NDc=null)};this.ked=(Mg,
Fh)=>{for(const zj of Fh.xk)Mg=zj.intent,!Mg.type&&this.OZo(Mg.intent,zj.cpBegin,zj.cpEnd,zj.fUb)&&this.xUa(Mg.intent)};this.myk=ja.$("AugLoopAnnotationsAttachingIsEnabled");this.hKk=ja.cD("SendReleaseMessageAnnotationList")||[];this.Bd=Ue;this.EPa=cg;this.oRa=Rc;this.zH=Id;this.Tn=yb;this.ED=Pd;this.Gda=Rd;this.HK=Wb;this.kj=Ua;this.Gb=tc;C.a.instance.resolve(322).fff(this.ked);this.jp=tf;this.plk=ja.getBooleanFeatureGate("Microsoft.Office.WordOnline.AnnotationProcessingStateIsEnabled",!1);this.cyk=
ja.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1);this.Uzk=ja.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContext",!1);this.coh=ja.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContextLogs",!1);this.rkb&&this.WTm();this.pA=vf.a.instance}get Czj(){return this.Q3b}set Czj(ja){this.Q3b=ja}nb(ja,Ua){a.ULS.sendTraceTag(41521862,id.lj,50,"New registration for annotation type: {0}.",Ua);this.addHandler(ja,
Ua);this.Lcf(Ua).catch(yb=>{a.ULS.sendTraceTag(594396739,id.lj,10,"Failed to activate annotation type {0}: {1}",Ua,yb.toString())})}addHandler(ja,Ua){if(ja&&Ua&&""!==Ua){var yb=null;({value:yb}=this.Q3b.Ac(Ua,yb)).returnValue?yb.add(ja):(yb=new G.a,yb.add(ja),this.Q3b.add(Ua,yb))}else a.ULS.sendTraceTag(41521861,id.lj,10,"Invalid registration. Handler == null? {0} or annotationType == null? {1} or annotationType == empty? {2}.",!ja,!Ua,""===Ua)}xc(ja,Ua){a.ULS.sendTraceTag(41521863,id.lj,50,"Unregister handler for annotation type: {0}.",
Ua);let yb=null;({value:yb}=this.Q3b.Ac(Ua,yb)).returnValue&&(yb.remove(ja),yb.count||(a.ULS.sendTraceTag(41521864,id.lj,50,"Unregister all handlers for annotation type: {0}.",Ua),this.Q3b.remove(Ua),this.FRn(Ua)))}iOj(ja){this.yXc||(this.yXc=this.jp.Nc(2),this.yXc.Bb(ja))}aql(){var ja;null===(ja=this.yXc)||void 0===ja?void 0:ja.dispose();this.yXc=null}V7h(){this.xKc||(this.xKc=new bb.a(4,2,100,this.RJl,141),this.Gb.Zb(this.xKc))}WFn(){let ja;ja=Array.dequeue(this.QGd);const Ua=ab.a.PPb(this.HK.value,
ja);if(Ua)if(Ua.mk){this.iOj(Ua);var yb=null;if(({value:yb}=this.CCc.Ac(ja,yb)).returnValue){this.CCc.remove(ja);for(const Wb of yb)this.XFn(Ua,Wb)}else a.ULS.sendTraceTag(50663568,id.lj,100,"MarkIntentForAnnotationTask: No annotations for given tile id.")}else this.EDk.add(ja);else a.ULS.sendTraceTag(50436127,id.lj,15,"MarkIntentForAnnotationTask: Unable to get node from tileId.")}XFn(ja,Ua){try{const yb=Ua.content.range,Wb=new gc.a(0,yb.start,yb.start+yb.length,Ib.a.create(),Ua,tc=>{this.yJe.Z(Ua.id,
tc.toString())});this.Tn.eYa(ja,Wb);gh.a.$yb(Ua,2);this.sa.tfa&&this.sa.raiseEvent(id.Arc,new Xa(Ua,pb.a.getTypeName()))}catch(yb){gh.a.qbd(yb,[Ua],!0)}}Paj(ja){const Ua=ab.a.C9a(ja.parentPath);let yb=null;({value:yb}=this.CCc.Ac(Ua,yb)).returnValue||(yb=new G.a,this.CCc.add(Ua,yb),this.QGd.push(Ua));yb.add(ja);this.V7h()}ZFn(ja,Ua){this.kj.$d(()=>{let yb;if(({value:yb}=this.m9.Ac(ja,yb)).returnValue){var Wb=this.sRj(ja);for(const tc of yb){let Rc;({value:Rc}=this.FD.Ac(tc,Rc)).returnValue&&Ua(Rc)&&
id.aSb(Rc)&&(this.Paj(Rc),Wb&&this.sa.raiseEvent(id.Arc,new Xa(Rc,ob.a.getTypeName())))}}},"AS:MIFAT")}dpp(ja,Ua){this.kj.$d(()=>{let yb;if(({value:yb}=this.m9.Ac(ja,yb)).returnValue)for(const Wb of yb){let tc;({value:tc}=this.FD.Ac(Wb,tc)).returnValue&&Ua(tc)&&id.aSb(tc)&&(this.ZJg(tc),gh.a.$yb(tc,4))}},"AS:UIFAT")}MRn(ja){var Ua=ab.a.kI(ja);let yb=null;if(({value:yb}=this.bFa.Ac(Ua,yb)).returnValue){Ua=0;for(var Wb=new G.a;yb.count>Ua;){var tc=yb.K(Ua),Rc=null;({value:Rc}=this.FD.Ac(tc,Rc)).returnValue&&
id.aSb(Rc)?this.ED.hod(ja,Rc)?this.xUa(Rc,!this.Bd.isFeatureEnabled(82)):(tc=Rc.content.range,Rc=new gc.a(0,tc.start,tc.start+tc.length,Ib.a.create(),Rc),Wb.add(Rc),Ua++):Ua++}0<Wb.count&&this.Tn.Z6f(ja,Wb)}}cpp(){let ja=null;try{let Ua="";Ua=Array.dequeue(this.RGd);const yb=ab.a.PPb(this.HK.value,Ua);yb&&12===yb.type?(this.iOj(yb),({value:ja}=this.Zvd.Ac(Ua,ja)).returnValue?(this.Tn.dsd(Wb=>ja.contains(Wb.intent),yb,0)&&ja.toArray().forEach(Wb=>{gh.a.$yb(Wb,4)}),this.Zvd.remove(Ua)):a.ULS.sendTraceTag(50663570,
id.lj,100,"UnmarkIntentForAnnotationsTask: No annotations for given tileId.")):a.ULS.sendTraceTag(50436128,id.lj,15,"UnmarkIntentForAnnotationsTask: Unable to unmark ChPs in node")}catch(Ua){gh.a.qbd(Ua,ja.toArray(),!0)}}ZJg(ja){let Ua;({value:Ua}=this.yJe.Ac(ja.id,Ua)).returnValue||(Ua=ab.a.C9a(ja.parentPath));this.yJe.remove(ja.id);var yb=null;({value:yb}=this.Zvd.Ac(Ua,yb)).returnValue||(yb=new G.a,this.Zvd.add(Ua,yb),this.RGd.push(Ua));yb.add(ja);this.V7h();yb=null;({value:yb}=this.CCc.Ac(Ua,
yb)).returnValue&&yb.remove(ja)}$be(ja){var Ua;return Vc.a.Mri&&(null===ja||void 0===ja?0:ja.content)&&Td.a.typeGuard(ja.content)&&(null===(Ua=ja.content)||void 0===Ua?0:Ua.id)?!0:!1}FVk(ja){const Ua=ja.id;var yb=ja.annotationType;const Wb=ja.parentPath;if(this.ED.atb(ja)){var tc=ab.a.Dqb(this.HK.value,Wb);if(tc&&(tc=tc.ka(ib.a.Uj,0).toString(),ja.parentRevId&&tc!==ja.parentRevId))return!1}tc=null;({value:tc}=this.m9.Ac(yb,tc)).returnValue||(tc=new G.a,this.m9.add(yb,tc));tc.add(Ua);yb=null;({value:yb}=
this.bFa.Ac(Wb,yb)).returnValue||(yb=new G.a,this.bFa.add(Wb,yb));yb.add(Ua);this.FD.add(Ua,ja);this.$be(ja)&&this.CRc.add(ja.content.id,Ua);this.JCp(ja);return!0}JCp(ja){const Ua=this.ED.yri(ja);if(0===Ua.length)this.efi(ja);else{let yb=!1;this.oRa.sYn(Ua,ja.annotationType,(Wb,tc)=>{this.FD.lb(ja.id)?(tc=this.ED.utb(ja,ab.a.tfm(ja)),!Wb&&tc?(y.AFrameworkApplication.vd("3c7ef686;a13cd815"),this.Hhn&&(yb=!1),this.kLg(ja,10,!1)):Wb&&this.kLg(ja,Wb),yb||(this.efi(ja),yb=!0)):tc.w_a=!0})}}get Hhn(){if(null!=
this.CZg)var ja=this.CZg;else{var Ua;ja=this.CZg=null===(Ua=y.AFrameworkApplication.J)||void 0===Ua?void 0:Ua.getBooleanFeatureGate("Microsoft.Office.WordOnline.IgnoreAllFix",!1)}return ja}efi(ja){const Ua=id.aSb(ja);Ua&&this.Paj(ja);!Ua&&this.sa.tfa&&this.sa.raiseEvent(id.Arc,new Xa(ja,pb.a.getTypeName()))}m4j(ja,Ua,yb,Wb){let tc=!0;this.kj.$d(()=>{if(Wb.startsWith(ab.a.jNb)){var Rc=ja.id,Id=null;if(Ua===ob.a.getTypeName())this.xUa(ja);else if(({value:Id}=this.FD.Ac(Rc,Id)).returnValue)a.ULS.sendTraceTag(41418891,
id.lj,50,"UpdateAnnotationsStorage: Updating storage for annotation {0} of type {1}.",Rc,ja.annotationType),this.FD.Z(Rc,ja);else if(!this.FVk(ja)){tc=!1;return}yb&&Ua===pb.a.getTypeName()&&Wb!==ab.a.jNb&&this.V1e.add(ja.annotationType)}this.XZb(ja,Ua)},"AS:UAS");return tc}nPo(ja){if(ja)for(const Ua of ja)this.XZb(Ua,sb.a.getTypeName()),ja=Ua.content,this.gyd.lb(ja.categoryName)?this.gyd.Z(ja.categoryName,Ua):this.gyd.add(ja.categoryName,Ua);else a.ULS.sendTraceTag(592802119,id.lj,10,"SetCritiqueCategoryCountAndSendToHandlers: critiqueCategoryCountAnnotations null")}iZk(ja){this.sa.addHandler(id.Arc,
ja)}gOh(ja){this.sa.addHandler(id.Dhj,ja)}Lmc(ja){return this.P3b.lb(ja)}hZk(ja){this.sa.addHandler(id.$ke,ja)}Axo(ja){this.sa.removeHandler(id.$ke,ja)}sRj(ja){return!ab.a.Tf(ja)&&ra.a(ja)&&this.sa.tfa}xUa(ja,Ua=!0){if(this.FD.lb(ja.id)){var yb=this.FD.K(ja.id);this.$be(ja)&&this.CRc.remove(ja.content.id);this.FD.remove(ja.id);var Wb=null;({value:Wb}=this.bFa.Ac(ja.parentPath,Wb)).returnValue?(Wb.remove(ja.id),id.aSb(yb)&&this.ZJg(yb)):a.ULS.sendTraceTag(50734169,id.lj,15,"DeleteAnnotationFromStorage: No annotations in given parent path");
Wb=null;({value:Wb}=this.m9.Ac(ja.annotationType,Wb)).returnValue?Wb.remove(ja.id):a.ULS.sendTraceTag(50734170,id.lj,15,"DeleteAnnotationFromStorage: Annotation of this type does not exist in document");this.sRj(ja.annotationType)?this.sa.raiseEvent(id.Arc,new Xa(yb,ob.a.getTypeName())):this.XZb(ja,ob.a.getTypeName());Ua&&this.Gda.U6j(yb,ob.a.getTypeName())}}MFf(ja,Ua,yb=!1){const Wb=new G.a;var tc;if(!({value:tc}=this.m9.Ac(ja,tc)).returnValue)return Wb;for(const Rc of tc)this.FD.lb(Rc)?(ja=this.FD.K(Rc),
(tc=this.ED.O4d(ja))&&(Ua.equals(tc)||yb&&Ua.overlaps(tc))&&Wb.add(ja)):a.ULS.sendTraceTag(577843217,id.lj,50,"GetAnnotationsByDescription: Annotation {0} exists in a cache but not in storage",Rc);return Wb}eZd(ja){let Ua=null;if(({value:Ua}=this.m9.Ac(ja,Ua)).returnValue){ja=Ua.toArray();for(const yb of ja){let Wb;({value:Wb}=this.FD.Ac(yb,Wb)).returnValue&&this.xUa(Wb)}}}Edn(ja){return Ab.a.getTypeNameFor(ja)===Ae.a.getTypeName()}iVi(ja){var Ua,yb;return(null===(yb=null===(Ua=this.rkb)||void 0===
Ua?void 0:Ua.bAi)||void 0===yb?void 0:yb.call(Ua))===qe.a.yBc&&ja&&0===ja.priority?this.rkb.Bqd(ja.context.substr(ja.startInContext,ja.range.length)):!1}wuj(ja,Ua){this.kj.$d(()=>{a.ULS.i4(id.lj,100)&&a.ULS.sendTraceTag(41418894,id.lj,100,"Operation of type {0} with path {1} received",Ab.a.getTypeNameFor(ja),ja.parentPath.join("\\"));try{const yb=new mc(ja);for(const Wb of yb.annotations)if(Wb.annotationType===Qe.b.getTypeName()){const tc=Wb.content.results.map(Rc=>{var Id;const Pd=null===(Id=Rc.M_)||
void 0===Id?void 0:Id.seq;Id=void 0===Pd?Wb.id:Wb.id+"_"+Pd;return{id:Id,body:{...Rc,id:Id},source:"",revId:"",contextId:"",sourceTimestamp:Date.now()}});this.wuj({items:tc,parentPath:ja.parentPath,parentRevId:ja.parentRevId,H_:ja.H_},Ua)}else yb.Qgf===pb.a.getTypeName()&&this.F1o(Wb)?(y.AFrameworkApplication.vd("g8469255;j5hhe441"),this.coh&&(this.v4a||(this.v4a=Jd.a.hy()),this.Ulh++,this.v4a.$Pd("AnnotationSkippedDueToInvalidContextCount",this.Ulh.toString()))):this.J4c(Wb,Ua,yb.Qgf,!0)}catch(yb){a.ULS.sendTraceTag(41418898,
id.lj,10,"Exception occurred while processing annotations: Error Message {0}, Stack {1}",yb.message,yb.stack)}},"AS:PO")}F1o(ja){var Ua;y.AFrameworkApplication.vd("01dfc961;05c12706");if(this.Uzk&&ra.a(ja.annotationType)){var yb;let tc=yb=null;if(this.pA){yb=this.pA.Ika;var Wb=null===yb||void 0===yb?void 0:yb.node;yb=ab.a.C9a(ja.parentPath);if(ab.a.PPb(this.HK.value,yb)!==Wb)return!1;ja=ja.content;yb=ja.context.substring(ja.startInContext,ja.startInContext+ja.range.length);tc=null===(Ua=null===Wb||
void 0===Wb?void 0:Wb.characterData)||void 0===Ua?void 0:Ua.substring(ja.range.start,ja.range.start+ja.range.length);this.coh&&ja&&0===ja.priority&&(Ua=0<ja.range.start?Wb.characterData.charAt(ja.range.start-1):null,Wb=ja.range.start+ja.range.length<Wb.characterData.length?Wb.characterData.charAt(ja.range.start+ja.range.length):null,"en-us"==ja.language.toLocaleLowerCase()&&tc&&yb&&tc===yb&&(Ua&&Ua.match("[A-Za-z0-9]")||Wb&&Wb.match("[A-Za-z0-9]"))&&(this.v4a||(this.v4a=Jd.a.hy()),this.Uxh++,this.v4a.$Pd("partialWordAnnotationsCount",
this.Uxh.toString())))}return tc&&yb&&tc!==yb?!0:!1}return!1}J4c(ja,Ua,yb,Wb){if(this.Edn(ja.content)&&this.iVi(ja.content))this.BEa(ja,70);else{var tc=ja.parentPath;yb!==ob.a.getTypeName()&&Wb||this.oAj(ja);Wb&&yb===pb.a.getTypeName()&&ra.a(ja.annotationType)&&ja.content.isHotCritique&&this.cyk?this.lFc.set(ja.id,{annotation:ja,time:Date.now()}):(Wb=ja.annotationType,ab.a.Tf(Wb)||Wb!==nc.a.getTypeName()?!ab.a.Tf(Wb)&&ra.a(Wb)&&ja.content&&0==ja.content.priority&&ud.a.y7?(ja=ab.a.C9a(tc))&&ja==ud.a.Ldm()&&
a.ULS.sendTraceTag(539870169,id.lj,10,"Skipping the Spelling Error Annotation as Text Prediction is visible"):yb!==ob.a.getTypeName()&&this.oFc.contains(tc)?a.ULS.sendTraceTag(41418897,id.lj,50,"ProcessOperation: Parent tile {0} for annotation {1} was deleted.",tc,ja.id):this.k4j(ja,tc,yb,Ua):a.ULS.sendTraceTag(595342670,id.lj,50,"ProcessOperation: Skipping CritiqueCategoryCountAnnotation for Parent tile {0} since the counts are maintained locally.",tc))}}wuo(ja){if(ja&&ja.annotationType&&this.ED.Mmc(ja.annotationType)){var Ua;
if(({value:Ua}=this.m9.Ac(ja.annotationType,Ua)).returnValue&&(ja=this.ED.O4d(ja)))for(const yb of Ua){let Wb;({value:Wb}=this.FD.Ac(yb,Wb)).returnValue&&(Ua=this.ED.O4d(Wb))&&(ja.equals(Ua)||ja.overlaps(Ua))&&this.xUa(Wb)}}}XZb(ja,Ua){this.kj.$d(()=>{let yb=null;if(({value:yb}=this.Czj.Ac(ja.annotationType,yb)).returnValue)for(const Wb of yb)Wb.ZG(ja,Ua)},"AS:SATH")}Xpl(){a.ULS.sendTraceTag(50860999,id.lj,50,"ClearStorage: Initiated Clearing Storage");this.NDc||(this.NDc=new bb.a(4,2,100,this.Ypl,
142),this.Gb.Zb(this.NDc))}activateAnnotation(ja,Ua){let yb;if(({value:yb}=this.Yvd.Ac(ja,yb)).returnValue){if(yb.contains(Ua))return Promise.resolve(null);yb.add(Ua)}else{let Wb;this.Yvd.add(ja,(Wb=new G.a,Wb.add(Ua),Wb))}return this.Lcf(ja)}Lcf(ja){a.ULS.sendTraceTag(41521865,id.lj,50,"ActivateAnnotation: Activating annotation type {0}.",ja);if(this.P3b.lb(ja))return Promise.resolve(null);var Ua=null;if(({value:Ua}=this.uJe.Ac(ja,Ua)).returnValue)return Ua;this.bSk(ja);if(Ua=this.EPa?this.EPa():
null){const yb=new ad.a;yb.annotationType=ja;this.plk&&(this.qoa.lb(ja)||this.qoa.Z(ja,new Mb),yb.stateUpdateHandler=(Wb,tc)=>{this.qoa.K(ja).oldState=Wb;this.qoa.K(ja).newState=tc;for(const Rc of this.qoa.K(ja).handlers)Rc(ja,Wb,tc)});Ua=Ua.activateAnnotation(yb);this.uJe.add(ja,Ua);return Ua.then(Wb=>{this.uJe.remove(ja);this.P3b.add(ja,Wb.token);this.l4j(Wb.token,ja);this.sa.raiseEvent(id.$ke,new tb(ja,!0));this.UTm(ja);return Wb})}return Promise.reject(Error.create("Error during annotation activation"))}UTm(ja){const Ua=
this.ED.VIi(ja);Ua&&this.oRa.PCi(Ua,yb=>{if(this.Gda.pfg){var Wb=Ya.ParagraphReader.Hv(ab.a.getRootNode(),!0,!0);if(Wb&&0<Wb.count){let tc=0;for(const Rc of Wb){Wb=vb.i7d(Rc);if(!Wb)continue;let Id=!1;for(;tc<yb.length;){if(Wb===yb[tc]){Id=!0;break}tc++}if(!Id){this.Gda.pfg(Ua);break}tc++}}}})}bSk(ja){this.Gda.KCp(ja,(Ua,yb)=>{0<this.MFf(ja,yb,!0).count||this.m4j(Ua,pb.a.getTypeName(),!0,Ua.parentPath)},(Ua,yb)=>{if(3!==yb.Uw)a.ULS.sendTraceTag(591541786,id.lj,15,"Annotation moved to unsupported location type: {0}",
yb.Uw);else if(Ua.Uw!==yb.Uw)a.ULS.sendTraceTag(591541787,id.lj,15,"Location types are not equal. This is not currently supported. Old: {0} New: {1}",Ua.Uw,yb.Uw);else{Ua=this.MFf(ja,Ua);for(const tc of Ua){const Rc=tc.content;Ua=ab.a.Dqb(this.HK.value,tc.parentPath);if(!Ua){a.ULS.sendTraceTag(591541788,id.lj,15,"RegisterHandler.onPersistedAnnotationMoved: Unable to get node from tileId.");break}if(!this.Tn.dsd(Id=>Id.intent===Rc,Ua,0))break;var Wb=yb.Wya;Wb=new gc.a(0,Wb,Wb+yb.Vya,null,Rc);this.Tn.eYa(Ua,
Wb)}}},Ua=>{for(const yb of this.MFf(ja,Ua))this.xUa(yb,!1)})}releaseAnnotation(ja,Ua){let yb;if(({value:yb}=this.Yvd.Ac(ja,yb)).returnValue){yb.contains(Ua)&&yb.remove(Ua);if(0<yb.count)return Promise.resolve(!1);this.Yvd.remove(ja)}a.ULS.sendTraceTag(593790408,id.lj,50,"ReleaseAnnotation: Releasing annotation type {0}.",ja);return this.aKj(ja)}FRn(ja){var Ua=null;if(({value:Ua}=this.m9.Ac(ja,Ua)).returnValue){a.ULS.sendTraceTag(41418899,id.lj,50,"OnAllHandlersUnregistered: Purging all storage for annotation type {0}.",
ja);for(const yb of Ua)if(Ua=null,({value:Ua}=this.FD.Ac(yb,Ua)).returnValue){const Wb=Ua.parentPath;let tc=null;({value:tc}=this.bFa.Ac(Wb,tc)).returnValue&&(tc.remove(yb),tc.count||this.bFa.remove(Wb));this.$be(Ua)&&this.CRc.remove(Ua.content.id);this.FD.remove(yb);id.aSb(Ua)&&this.ZJg(Ua)}this.m9.remove(ja)}Array.contains(this.hKk,ja)&&this.aKj(ja)}aKj(ja){let Ua=null;const yb=this.EPa?this.EPa():null;if(yb){if(({value:Ua}=this.P3b.Ac(ja,Ua)).returnValue){const Wb=new Kc;Wb.token=Ua;this.P3b.remove(ja);
this.sa.raiseEvent(id.$ke,new tb(ja,!1));return yb.releaseAnnotation(Wb)}return Promise.resolve(!0)}return Promise.reject(Error.create("Error during annotation release"))}r5i(){this.kj.$d(()=>{if(this.myk){var ja=ab.a.getRootNode();if(ja){var Ua=new Xb.a;Lb.f(ja,yb=>{var Wb=ab.a.kI(yb),tc=null;if(({value:tc}=this.bFa.Ac(Wb,tc)).returnValue)for(const Rc of tc)Wb=null,({value:Wb}=this.FD.Ac(Rc,Wb)).returnValue&&(Wb.parent=yb,Wb.Y8c=!0,Wb.YWb=2,Ua.lb(Wb.annotationType)||Ua.Z(Wb.annotationType,new G.a),
Ua.K(Wb.annotationType).add(Rc),tc=null,({value:tc}=this.m9.Ac(Wb.annotationType,tc)).returnValue&&tc.remove(Wb.id));return!0},12);for(const yb of this.m9.keys)if(ja=null,({value:ja}=this.m9.Ac(yb,ja)).returnValue)for(const Wb of ja)if(ja=null,({value:ja}=this.FD.Ac(Wb,ja)).returnValue){let tc=null;ja.parentPath===ab.a.jNb?(ja.YWb=1,ja.parent=null):({value:tc}=this.FD.Ac(ja.parentPath,tc)).returnValue?(ja.YWb=3,ja.parent=tc):(ja.YWb=0,ja.parent=null,a.ULS.sendTraceTag(41554060,id.lj,15,"LinkAnnotations: Unknown annotation parent for annotation ID: {0}.",
ja.id));ja.Y8c=!0;Ua.lb(ja.annotationType)||Ua.Z(ja.annotationType,new G.a);Ua.K(ja.annotationType).add(Wb)}else a.ULS.sendTraceTag(41997840,id.lj,15,"LinkAnnotations: Annotation object not found for the given annotation ID: {0}.",Wb);else a.ULS.sendTraceTag(41997841,id.lj,15,"LinkAnnotations: Annotations not found for the given annotation type: {0}.",yb);this.m9=Ua;this.V1e.clear()}else a.ULS.sendTraceTag(41554058,id.lj,10,"LinkAnnotations: There is no root node in the current document.")}else a.ULS.sendTraceTag(41554057,
id.lj,50,"LinkAnnotations: Link annotations called but flags is not set.")},"AS:LA")}w3k(ja){this.wuj(ja,!0)}C0n(ja,Ua){this.kj.$d(()=>{const yb=Ua?Ua+String.format("\\{0}",ja.id):ab.a.kI(ja);a.ULS.sendTraceTag(41418900,id.lj,50,"OnTileDeleted: Tile delete event received for tile {0}.",yb);this.oFc.contains(yb)||this.oFc.add(yb);var Wb=null;if(({value:Wb}=this.bFa.Ac(yb,Wb)).returnValue){a.ULS.sendTraceTag(41418901,id.lj,100,"OnTileDeleted: Removing {0} annotations for tile {1} from storage.",Wb.count,
yb);for(const tc of Wb)Wb=null,({value:Wb}=this.FD.Ac(tc,Wb)).returnValue&&(this.XZb(Wb,ob.a.getTypeName()),this.sa.tfa&&this.sa.raiseEvent(id.Arc,new Xa(Wb,ob.a.getTypeName())),this.$be(Wb)&&this.CRc.remove(Wb.content.id),this.FD.remove(tc));this.bFa.remove(yb)}},"AS:OTD")}B0n(ja){ja=ab.a.kI(ja);this.oFc.remove(ja)&&a.ULS.sendTraceTag(41418902,id.lj,50,"OnTileAdded: Deleted tile {0} was re-added.",ja)}Zvp(ja){if(ja){a.ULS.sendTraceTag(50436131,id.lj,50,"UpdateRangeForAnnotations: Updated ranges for annotations {0}",
ja.count);var Ua=new Xb.a;for(var yb of ja)ja=null,({value:ja}=Ua.Ac(yb.parentPath,ja)).returnValue||(ja=new Xb.a,Ua.add(yb.parentPath,ja)),ja.Z(yb.id,yb);for(const Wb of Ua){Ua=ab.a.Dqb(this.HK.value,Wb.key);if(!Ua){a.ULS.sendTraceTag(50436160,id.lj,10,"UpdateRangeForAnnotations: Unable to get node for the annotation");break}yb=new qa.a([0]);for(let tc=0,Rc=Ua.ra.length;tc<Rc;tc++)ja=Ua.ra.K(tc),ja.xk&&yb.t0a(ja.xk,void 0,(Id,Pd)=>{if(Pd){var Rd=null,Ue=Pd.intent;Ue&&({value:Rd}=Wb.value.Ac(Ue.id,
Rd)).returnValue&&(Ue=new qc.a,Ue.start=Pd.Jb.cp,Ue.length=Id.Jb.cp-Ue.start,Rd.content.range=Ue,Rd.nma=!1)}})}}else a.ULS.sendTraceTag(50436130,id.lj,10,"UpdateRangeForAnnotations: annotations list null")}getAnnotationsByType(ja){a.ULS.sendTraceTag(593049729,id.lj,50,"GetAnnotationsByType: Method called for type {0}.",ja);return this.Lcf(ja).then(()=>{const Ua=new G.a;this.kj.$d(()=>{if(ab.a.Tf(ja)||ja!==nc.a.getTypeName()){this.V1e.contains(ja)&&this.r5i();var yb=null;if(({value:yb}=this.m9.Ac(ja,
yb)).returnValue){a.ULS.sendTraceTag(41418903,id.lj,50,"GetAnnotationsByType: Enumerating annotations of type {0}.",ja);var Wb=new G.a;for(const tc of yb)yb=null,({value:yb}=this.FD.Ac(tc,yb)).returnValue&&(yb.nma&&Wb.add(yb),Ua.add(yb));Wb&&0<Wb.count&&id.aSb(Wb.K(0))&&this.Zvp(Wb)}}else for(Wb of this.gyd.values)Ua.add(Wb);Ua.count||a.ULS.sendTraceTag(41418904,id.lj,50,"GetAnnotationsByType: No annotations found for type {0}!",ja)},"AS:GABT");return Ua},Ua=>{a.ULS.sendTraceTag(41418905,id.lj,10,
"Exception occurred while fetching annotations of type {0}: {1}",ja,Ua);return null})}getAnnotationById(ja){let Ua=null;return({value:Ua}=this.FD.Ac(ja,Ua)).returnValue?Ua:null}Wdm(ja){let Ua=null;return({value:Ua}=this.CRc.Ac(ja,Ua)).returnValue?(ja=null,({value:ja}=this.FD.Ac(Ua,ja)).returnValue?ja:null):null}NFf(ja){let Ua=null;if(this.bFa.lb(ja))for(const yb of this.bFa.K(ja))if(ja=this.getAnnotationById(yb))Ua||(Ua=new G.a),Ua.add(ja);return Ua}lUb(ja){return(ja=this.getAnnotationById(ja))?(ja.Y8c||
this.r5i(),ja):null}BEa(ja,Ua){this.TVo(ja,Ua);this.kLg(ja,Ua);this.XZb(ja,sb.a.getTypeName())}Vqp(ja,Ua){this.Oup(ja,Ua);this.ZSo(ja,ab.a.sfm(ja));this.XZb(ja,sb.a.getTypeName())}Wqp(ja,Ua){ja=this.ED.yri(ja);for(const yb of ja)this.zH.XKg(this.HK.value,yb,Ua)}TVo(ja,Ua){const yb=this.EPa?this.EPa():null;yb&&(ja=this.ufm(ja,Ua))&&yb.setAnnotationState(ja)}kLg(ja,Ua,yb=!0){if(ja&&id.XTi(ja)){var Wb=this.getAnnotationById(ja.id);!ja.content||Wb&&ja.content===Wb.content||ab.a.setAnnotationState(ja,
Ua);Wb&&Wb.content&&ab.a.setAnnotationState(Wb,Ua);yb&&this.sa.tfa&&(70===Ua||60===Ua)&&this.sa.raiseEvent(id.Dhj,new cb(ja,Ua))}}ufm(ja,Ua){let yb=null;ja&&(yb=Object.assign(new Zb,{id:ja.id,value:Ua}),ab.a.Tf(ja.parentPath)||(yb.parentPath=ja.parentPath.split("\\")));return yb}ZSo(ja,Ua){const yb=this.EPa?this.EPa():null;yb&&(ja=this.rfm(ja,Ua))&&yb.setAnnotationMetadata(ja)}Oup(ja,Ua){if(ja&&id.XTi(ja)){var yb=this.getAnnotationById(ja.id);!ja.content||yb&&ja.content==yb.content||ab.a.LKj(ja,Ua);
yb&&yb.content&&ab.a.LKj(yb,Ua)}}rfm(ja,Ua){if(!ja)return null;const yb=new Jb;yb.id=ja.id;yb.value=Ua;ab.a.Tf(ja.parentPath)||(yb.parentPath=ja.parentPath.split("\\"));return yb}OZo(ja,Ua,yb,Wb){if(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackCardRetentionEnabled",!1)&&(ja.annotationType===mh.b.getTypeName()||ja.annotationType===mh.d.getTypeName()))return!1;const tc=ja.content;if(this.ED.atb(ja)&&tc){const Rc=tc.range.start+tc.range.length;if(0<
Wb&&Rc<=yb||0>Wb&&Rc<=yb+Wb)return!1;if(0<Wb&&tc.range.start>=Ua||0>Wb&&tc.range.start>=yb)return tc.range.start+=Wb,!1}return!this.Bd.isFeatureEnabled(54)&&tc&&tc.M_?(ja=this.ED.utb(ja,60),!(60===tc.M_.state&&ja)):!0}lLh(ja,Ua){this.qoa.lb(Ua)||this.qoa.Z(Ua,new Mb);this.qoa.K(Ua).handlers.add(ja);ja(Ua,this.qoa.K(Ua).oldState,this.qoa.K(Ua).newState)}Yzj(ja,Ua){this.qoa.lb(Ua)&&this.qoa.K(Ua).handlers.contains(ja)&&this.qoa.K(Ua).handlers.remove(ja)}static XTi(ja){ja=Ab.a.getBaseTypesFor(ja.content);
return Array.contains(ja,hb.a.getTypeName())}static aSb(ja){if(void 0===ja.content||null===ja.content||""===ab.a.C9a(ja.parentPath))return!1;const Ua=Ab.a.getBaseTypesFor(ja.content);return Array.contains(Ua,Jc.a.getTypeName())&&ja.annotationType!==jb.RoleDetectionAnnotation.getTypeName()}Uqp(ja){ja?(this.wJe.AugLoop_Text_Critique=ja,ja=this.Lmc("AugLoop_Text_Critique")?this.P3b.K("AugLoop_Text_Critique"):null,this.l4j(ja,"AugLoop_Text_Critique")):a.ULS.sendTraceTag(540615552,id.lj,50,"Annotation configuration could not be updated for annotation type: {0}.",
"AugLoop_Text_Critique")}l4j(ja,Ua){if(ja&&this.wJe[Ua]){const yb=new jd;yb.token=ja;yb.config=this.wJe[Ua];this.EPa&&(this.EPa().updateAnnotationConfig(yb),a.ULS.sendTraceTag(540615553,id.lj,50,"Annotation configuration has been updated for annotation type: {0}.",Ua))}}oAj(ja){let Ua=null;({value:Ua}=this.FD.Ac(ja.id,Ua)).returnValue&&(ja.annotationType=Ua.annotationType);this.lFc.has(ja.id)&&this.lFc.delete(ja.id)}k4j(ja,Ua,yb,Wb){this.wuo(ja);this.m4j(ja,yb,Wb,Ua)&&this.Gda.U6j(ja,yb)}CZa(ja){const Ua=
ja.parentPath,yb=ob.a.getTypeName();this.oAj(ja);this.BEa(ja,70);this.oFc.contains(Ua)||this.k4j(ja,Ua,yb,!0)}qwm(ja){const Ua=new G.a;ja=this.m9.Ac(ja).value;if(null===ja)return Ua;for(const yb of ja)ja=this.FD.Ac(yb).value,null!==ja&&Ua.push(ja);return Ua}async WTm(){await Object(hf.b)();this.iAj()}iAj(){const ja=this.qwm(Ae.a.getTypeName());for(const Ua of ja)this.iVi(Ua.content)&&this.CZa(Ua)}}id.lj=389;id.Arc="OnAnnotationOperation";id.Dhj="OnAnnotationLocalStateChange";id.$ke="OnAnnotationActivationChange";
id.NDk=20;Object(f.a)(id,"AnnotationStorage",null,[669]);class Re{constructor(){this.sve=null;this.sod=!1}}Object(f.a)(Re,"AugmentationLoopStateManager",null,[666]);var cf=d(179),me=d(575),ce=d(109),Ie=d(594),Le=d(446),we=d(257);class xf extends we.a{constructor(){super();this.FileId=this.AugLoopSeedUrl=this.Authorization=this.OriginString=this.ExpectedEndRevisionId=null;this.AddSubDocumentKindTypeToPathIsEnabled=this.CheckOnDemandNodeVersionEnabled=this.AddDocumentKindTypeToPathIsEnabled=this.SeedBatchesInParallelIsEnabled=
!1}$m(){return Le.a.bKo}static construct(ja,Ua,yb,Wb,tc,Rc){const Id=new xf;Id.ExpectedEndRevisionId=ja;Id.OriginString=Ua;Id.Authorization=yb;Id.AugLoopSeedUrl=Wb;Id.FileId=tc;Id.SeedBatchesInParallelIsEnabled=Rc;Id.AddDocumentKindTypeToPathIsEnabled=!0;Id.CheckOnDemandNodeVersionEnabled=!0;Id.AddSubDocumentKindTypeToPathIsEnabled=!0;return Id}}Object(f.a)(xf,"FullFileAugLoopSeedingRequest",we.a,[]);class Ig{constructor(){this.authToken=this.url=this.qoj=null}}Object(f.a)(Ig,"ReseedingTaskInfo",
null,[]);var jg=d(21);class kg{constructor(ja,Ua,yb,Wb,tc,Rc){this.RE=null;this.Lhh=!1;this.K5b=null;this.z5e=0;this.nhd=(Id,Pd)=>{Id=Pd.nea;this.K5b&&ce.AT(Id,Rd=>Rd===this.K5b)&&(Pd.httpStatusCode!==cf.a.pz||Pd.aK||2!==Pd.Bjg?Pd.httpStatusCode!==cf.a.pz||Pd.aK||1!==Pd.Bjg?this.IFj(()=>{a.ULS.sendTraceTag(50861003,kg.lj,10,"ProcessReplicationStatus: ForceInbound or pinning the lastest revision failed. HttpStatusCode: {0}, OperationResult: {1}, PinRevisionForAugLoopResponse: {2}, Correlation: {3}",
Pd.httpStatusCode,Pd.aK,Pd.Bjg,Pd.dr)}):(this.BQ.sod=!1,this.RE.XYb(this.nhd),this.Te.Xpl(),a.ULS.sendTraceTag(50861002,kg.lj,50,"ProcessReplicationStatus: Initiated Full File Seeding Request"),Id=Object(T.a)(Ig,this.K5b),this.Uvj(Pd.tFo,Id.qoj,Id.url,Id.authToken)):this.IFj(()=>{a.ULS.sendTraceTag(50861001,kg.lj,50,"Replication succeeded but failed to pin the latest revision on the server for the user")}))};this.S4l=Id=>{if(void 0===Id||null===Id||void 0===Id.data||null===Id.data||void 0===Id.data.De||
null===Id.data.De)a.ULS.sendTraceTag(41445393,kg.lj,10,"FileSeedingSuccessCallback: args or args.Data or args.Data.ResponseData is null or Undefined");else if(Id.data.Ie!==cf.a.pz)a.ULS.sendTraceTag(41445394,kg.lj,10,"FileSeedingSuccessCallback: Returned unexpected args.Data.HttpStatus code: {0}",Id.data.Ie);else try{let Pd;({group:Pd}=me.a.z4(Id.data.De)).returnValue?Pd.Responses&&Pd.Responses.length?(Id=null,Pd&&Pd.Responses&&Pd.Responses.length&&(Id=Pd.Responses[0])?(this.BH.cPa(Id),Id.StatusCode?
a.ULS.sendTraceTag(41445398,kg.lj,10,"FileSeedingSuccessCallback: FullFileAugLoopSeedingResponse returned unexpected status code: {0}",Id.StatusCode):a.ULS.sendTraceTag(41445399,kg.lj,50,"FileSeedingSuccessCallback: FullFileAugLoopSeeding was successful and last revision seeded is {0}",Id.LastSeededRevisionId)):a.ULS.sendTraceTag(41445397,kg.lj,10,"FileSeedingSuccessCallback: serverResponseGroup is null or serverResponseGroup.Responses is null or serverResponseGroup.Responses is empty or response is null")):
a.ULS.sendTraceTag(41445396,kg.lj,10,"FileSeedingSuccessCallback: responseGroup or responseGroup.Responses is null or empty"):a.ULS.sendTraceTag(41445395,kg.lj,10,"FileSeedingSuccessCallback received null or empty server response group")}catch(Pd){a.ULS.sendTraceTag(41445400,kg.lj,10,"FileSeedingSuccessCallback: {0}",Pd.message)}};this.R4l=Id=>{void 0===Id||null===Id||void 0===Id.data||null===Id.data||void 0===Id.data.De||null===Id.data.De?a.ULS.sendTraceTag(41445401,kg.lj,10,"FileSeedingFailCallback: args or args.Data or args.Data.ResponseData is null or Undefined"):
a.ULS.sendTraceTag(41445402,kg.lj,10,"FileSeedingFailCallback: Editor Service token generation server request failed:{0}",Id.data.Ie)};this.omk=ja.$("AugLoopServerSideSeedingIsEnabled");this.mmk=ja.$("AugLoopReseedingIsEnabled");this.nmk=ja.$("AugLoopFFSSeedBatchesInParallelIsEnabled");this.hth=ja.ic("MaxReseedingRetries",1);this.Gf=Ua;this.hCd=yb;this.BQ=Wb;this.BH=tc;this.Te=Rc;jg.StaticActiveAppFrame.za()&&jg.StaticActiveAppFrame.za().kb&&jg.StaticActiveAppFrame.za().kb.$c&&jg.StaticActiveAppFrame.za().kb.$c.wg&&
(this.RE=jg.StaticActiveAppFrame.za().kb.$c.wg)}P5m(ja,Ua,yb){if(this.omk){var Wb=this.BQ.sve;Wb&&Wb.trim().length?this.Lhh?this.mmk&&(a.ULS.sendTraceTag(50861E3,kg.lj,50,"InitiateFullFileSeedingFlow: Initiated Reseeding Flow"),this.z5e=0,this.RE?(this.BQ.sod=!0,this.RE.OJb(this.nhd),this.K5b=Object.assign(new Ig,{qoj:ja,url:Ua,authToken:yb}),this.RE.WC(null,null,this.K5b)):a.ULS.sendTraceTag(592814793,kg.lj,50,"InitiateFullFileSeedingFlow: ContentReplicator is null")):(a.ULS.sendTraceTag(41445392,
kg.lj,50,"InitiateFullFileSeedingFlow: Initiated FullFileSeedingFlow"),this.Uvj(Wb,ja,Ua,yb),this.Lhh=!0):a.ULS.sendTraceTag(41445391,kg.lj,10,"InitiateFullFileSeedingFlow: Empty or Null SeedRevision. Unable to InitiateFullFileSeedingFlow.")}else a.ULS.sendTraceTag(41445390,kg.lj,50,"InitiateFullFileSeedingFlow: AugLoopServerSideSeeding BRS setting has been diabled. File will not be seeded to Augmentation Loop.")}IFj(ja){this.z5e<this.hth?(a.ULS.sendTraceTag(594384E3,kg.lj,50,"RetryReseeding: ForceInbound or pinning the latest revision failed. Reseeding retry #{0} of {1}",
++this.z5e,this.hth),this.RE.WC(null,null,this.K5b)):(this.BQ.sod=!1,this.RE.XYb(this.nhd),ja())}Uvj(ja,Ua,yb,Wb){const tc=xf.construct(ja,Ua,Wb,yb,y.AFrameworkApplication.rootQuerySignature,this.nmk);a.ULS.sendTraceTag(595178454,kg.lj,50,"QueueFullFileSeedingRequest: Calling AddSeedRequestToRequestManager on Host store replicator load completion.");this.hCd.k$a.execute(()=>{this.YWk(tc)})}YWk(ja){a.ULS.sendTraceTag(595178453,kg.lj,50,"InitiateFullFileSeedingFlow: Adding seed request to RequestManager");
this.Gf.Wj(Ra.a.webServiceBase+"OneNote.ashx?perfTag=FullFileAugLoopSeed",2,Ie.b(ja),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,this.S4l,this.R4l,ja);a.ULS.sendTraceTag(42016906,kg.lj,50,"InitiateFullFileSeedingFlow: Added seed request to RequestManager")}}kg.lj=389;Object(f.a)(kg,"FullFileAugLoopSeedingService",null,[]);class eh{constructor(){}}Object(f.a)(eh,"RuntimeManagerInitializationTracker",null,[]);class zg{getAugLoopRuntimeManager(){return Jd.a.hy()}}Object(f.a)(zg,"AlFactoryWrapper",
null,[534]);class Gi{hm(){return ab.a.hm()}}Object(f.a)(Gi,"UtilsWrapper",null,[531]);var jj=d(750),Dg=d(55),Jf=d(14),xg=d(40),Vi=d(176),Lf=d(2073),ac=d(6),xc=d(106),gd=d(26),Hd=d(355),ie=d(400),Je=d(102),Xe=d(42);class Tf{constructor(ja,Ua,yb,Wb,tc){this.Ga=ja;this.jg=yb;this.Pp=Wb;this.we=tc;this.dta=this.Ga.$("WordDesignerCaptionDetectionEnabled")}bRo(ja,Ua){ja.listType=this.jwm(Ua);ja.outlineLevel=Ya.ParagraphReader.PVa(Ua);ja.indentation=Tf.xJf(this.Pp.$W(Ua));ja.alignment=Tf.yFf(Ya.ParagraphReader.Sy(Ua));
ja.isInsideTable=this.isInsideTable(Ua);ja.isInsideTOC=Ua.zs;ja.rightIndentation=Tf.xJf(this.Pp.w9a(Ua));var yb=this.Pp.wkc(Ua);ja.specialIndentType=Tf.KIm(yb);ja.specialIndentBy=Tf.xJf(yb);ja.listType!==Lf.e.NoList&&this.GSo(Ua,ja);this.NVo(Ua,ja);yb=[];this.dta&&(yb=this.ndo(Ua));ja.formattedRanges=this.jrm(Ua,yb);this.dta&&null!=yb&&(ja.objectReferences=0<yb.length?yb:void 0)}jrm(ja,Ua){var yb=ja.ra?ja.ra.length:0,Wb=xc.FormattingReader.Rs(gd.a.create(ja));let tc=Je.a.eL,Rc=0,Id=Je.a.YQ/2;Wb&&
(Id=xc.FormattingReader.nj(Wb,Jf.a.fontSize,Je.a.YQ)/2,tc=xc.FormattingReader.nj(Wb,Jf.a.font,Je.a.eL),Rc=xc.FormattingReader.language(Wb));Wb="Normal";var Pd=this.we.Aq(ja);Pd&&(Wb=Pd.getValue(xg.a.la)||"Normal",Pd.hasProperty(Jf.a.font)&&(tc=Pd.getValue(Jf.a.font)));if(yb){--yb;Pd=[];let Fh=null,zj=void 0,om=null;this.dta&&ja.hasProperty(Jf.a.Qn)&&(om=ja.getValue(Jf.a.Qn));const ej=ja.properties.ka(ib.a.kka,null);for(let Kj=0;Kj<yb;Kj++){var Rd=ja.ra.K(Kj),Ue=ja.Ic,tf=null;this.dta&&(tf=Tf.MNf(ja,
om,Kj));Rd.lf&&(Fh=Tf.rsp(Ue,Rd.lf,Fh));Rd.hyperlink&&Rd.hyperlink.url?zj=Rd.hyperlink.url:Rd.pn&&(zj=void 0);var cg=ja.ra.K(Kj+1).cp-1;Ue=Rd.cp;cg=cg-Rd.cp+1;let Tl=!1,nj=!1,Nn=!1,ui=Id,oq=0,rp=0,Am=Wb,Bh=void 0,ml=Rc,nl=tc,um;if(Rd.formatting){var fg=Rd.formatting;Tl=xc.FormattingReader.nj(fg,Jf.a.bold,!1);nj=xc.FormattingReader.nj(fg,Jf.a.italic,!1);Nn=xc.FormattingReader.nj(fg,Jf.a.underline,!1);ui=xc.FormattingReader.nj(fg,Jf.a.fontSize,2*Id)/2;oq=xc.FormattingReader.nj(fg,xg.a.capitalization,
0);rp=xc.FormattingReader.nj(fg,Jf.a.fontColor,0);ml=xc.FormattingReader.language(fg)||Rc;nl=xc.FormattingReader.nj(fg,Jf.a.font,tc);Am=Wb;var Mg=fg.lo;Mg&&(Mg=Mg.ka(xg.a.Fw,null))&&!Mg.equals(Ib.a.nil)&&fg.paragraph.Ic&&(fg=this.we.qo().hla(Mg,fg.paragraph.Ic))&&(Am=fg.getValue(xg.a.la))}this.dta&&(um=this.ZKf(tf),null!=um&&this.vNh(Ua,tf,um,Pd.length,Lf.b.Inline));Fh&&(Bh=0<Fh.count);Rd={isDeleted:this.fen(ej,Rd,Kj,zj),fontFamily:nl,fontWeight:Tl?Lf.d.Bold:Lf.d.Normal,fontSize:ui,italic:nj,underline:Nn?
Lf.h.SingleLine:Lf.h.None,capitalization:Tf.F6h(oq),color:rp,styleName:Am,isFollowUp:Bh,languageId:Tf.w6h(ml),start:Ue,length:cg,link:zj,isReference:Tf.isReference(Rd)?!0:void 0,objectType:null!==um&&void 0!==um?um:void 0};tf=0<Pd.length?Pd[Pd.length-1]:void 0;Tf.djl(tf,Rd)?tf.length+=Rd.length:Pd.push(Rd)}return Pd}return[{fontFamily:tc,fontWeight:Lf.d.Normal,fontSize:Id,italic:!1,underline:Lf.h.None,capitalization:Tf.F6h(0),color:0,styleName:Wb,isFollowUp:void 0,languageId:Tf.w6h(Rc),start:0,length:ja.characterData.length}]}fen(ja,
Ua,yb,Wb){if(this.jD()){if(Ua.blob||Ua.formatting&&Ua.formatting.cache&&Ua.formatting.cache.RSb||Wb)return!0;if(ja&&yb<ja.length)return ja[yb]}return Ua.BU?!0:Ua.Vh?!0:!1}jD(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}static djl(ja,Ua){return!!ja&&!!Ua&&ja.start+ja.length===Ua.start&&ja.isDeleted===Ua.isDeleted&&ja.fontFamily===Ua.fontFamily&&ja.fontWeight===Ua.fontWeight&&ja.fontSize===Ua.fontSize&&ja.italic===
Ua.italic&&ja.underline===Ua.underline&&ja.capitalization===Ua.capitalization&&ja.color===Ua.color&&ja.highlightColor===Ua.highlightColor&&ja.styleName===Ua.styleName&&void 0===ja.link&&void 0===Ua.link&&ja.languageId===Ua.languageId&&!ja.isReference&&!Ua.isReference&&!ja.isFollowUp&&!Ua.isFollowUp&&void 0===ja.objectType&&void 0===Ua.objectType}jwm(ja){const Ua=new ac.a;Ua.set(ja);Ua.vb(11);Ua.ld(11);return(ja=this.jg.Pw(Ua))?Tf.uzl(ja.listType):Lf.e.NoList}GSo(ja,Ua){var yb=Xe.ListItemReader.Ce?
ja:this.jg.jfa(ja);if(Xe.ListItemReader.isListItem(yb)){if(Xe.ListItemReader.Ce){if(yb=Xe.ListItemReader.Lr(yb))Ua.listId=yb.listId.toString()}else yb.hasProperty(ib.a.listID)&&(Ua.listId=yb.getValue(ib.a.listID).toString());yb=this.Mzi(ja,Jf.a.font);ja=this.Mzi(ja,Jf.a.fontSize);yb&&(Ua.bulletAndNumberFontFamily=yb);ja&&(Ua.bulletAndNumberFontSize=ja)}}isInsideTable(ja){const Ua=new ac.a;Ua.set(ja);return Ua.vb(14)}NVo(ja,Ua){Ua.spacingBeforeParagraph=this.MFi(ja,ib.a.Cga,ib.a.K3,ib.a.Sj);Ua.spacingAfterParagraph=
this.MFi(ja,ib.a.Bga,ib.a.J3,ib.a.ta);Ua.lineSpacing=this.KPb(ja)}MFi(ja,Ua,yb,Wb){if(Ya.ParagraphReader.nj(ja,Ua,!1))return 0;Ua=Ya.ParagraphReader.nj(ja,yb,-1);if(0<=Ua)return Ua*Hd.a.RWb/100;ja=Ya.ParagraphReader.nj(ja,Wb,-1);return 0<=ja?ja/20:0}Mzi(ja,Ua){ja=this.Ynm(ja);if(null!=ja&&null!=ja.cache)return ja.cache.getValue(Ua)}Ynm(ja){var Ua;ja=null===(Ua=ja.ra)||void 0===Ua?void 0:Ua.last;return null!=ja&&ja.ni?ja.formatting:(a.ULS.sendTraceTag(520680196,389,50,"EOP for list item does not have any formatting applied."),
null)}KPb(ja){const Ua=Ya.ParagraphReader.nj(ja,ib.a.ya,Hd.a.ya);ja=Ya.ParagraphReader.nj(ja,ib.a.xa,Hd.a.lineSpacing);switch(Ua){case 0:return ja/240;case 1:return ja/20;default:return 0}}static rsp(ja,Ua,yb){for(let Wb=0;Wb<Ua.length;Wb++){const tc=Ua.K(Wb),Rc=tc.lk,Id=ja.Eb(Rc);Id&&Id.ka(ib.a.uI,!1)&&(yb||(yb=new xb.a(new ie.a)),tc.Vc?yb.add(Rc):yb.remove(Rc))}return yb}static w6h(ja){return(ja=jj.a.Hg(ja))&&ja.name?ja.name.toLowerCase():void 0}static xJf(ja){return ja?2===ja.unit?Math.floor(Dg.a.kLb(ja.value)/
20):Math.floor(ja.value/20):0}static KIm(ja){if(!ja)return Lf.g.Initial;switch(ja.specialIndentType){case 1:return Lf.g.FirstLine;case 2:return Lf.g.Hanging;default:return Lf.g.Initial}}static F6h(ja){switch(ja){case 2:return Lf.c.AllCaps;case 1:return Lf.c.SmallCaps;default:return Lf.c.NoCaps}}static yFf(ja){switch(ja){case 1:return Lf.a.Left;case 3:return Lf.a.Right;case 2:return Lf.a.Center;case 6:return Lf.a.Justified;case 0:return Lf.a.None;default:return Lf.a.Other}}static uzl(ja){switch(ja){case 15:return Lf.e.Any;
case 1:return Lf.e.Bullet;case 42:return Lf.e.Invalid;case 13:return Lf.e.Lim;case 14:return Lf.e.Nil;case 16:return Lf.e.NoList;case 0:return Lf.e.Numbered;default:return Lf.e.Invalid}}static isReference(ja){return ja.blob&&(7===ja.blob.Qh||10===ja.blob.Qh)||ja.Zh&&0<ja.Zh.length||ja.lf&&0<ja.lf.length||ja.Hb&&0<ja.Hb.length?!0:!1}static MNf(ja,Ua,yb){return null==Ua?null:Ua[yb]&&!Ua[yb].equals(Ib.a.nil)&&ja.Ic?ja.Ic.Eb(Ua[yb]):null}ZKf(ja){if(null==ja)return null;if(ja.hasProperty(ib.a.ft)){var Ua=
ja.getValue(ib.a.ft);if(Tf.Jrj.has(Ua))return Tf.Jrj.get(Ua)}if(ja.hasProperty(ib.a.jic)&&null!=ja.getValue(ib.a.jic))return Lf.f.FootnoteEndnote;if(ja.hasProperty(ib.a.gcb)&&ja.getValue(ib.a.gcb))return Lf.f.PageBreak;if(ja.hasProperty(ib.a.sTb)&&ja.getValue(ib.a.sTb))return Lf.f.Tab;Ua=!1;ja.hasProperty(Vi.a.Ofa)?Ua=ja.getValue(Vi.a.Ofa):ja.hasProperty(ib.a.Kla)&&(Ua=ja.getValue(ib.a.Kla));return Ua&&ja.hasProperty(ib.a.imageType)&&1==ja.getValue(ib.a.imageType)?Lf.f.Image:null}static ihn(ja){return ja.hasProperty(ib.a.qlc)&&
0<=ja.getValue(ib.a.qlc)?!0:!1}f1i(ja){return Tf.bcp.has(ja)}J9h(ja,Ua,yb,Wb){return null==ja||null==Ua?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: propertySet or objectType is undefined."),null):Wb===Lf.b.Inline&&null==yb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Inline object does not have formattedRangeIndex defined."),null):Wb===Lf.b.Floating&&null!=yb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Floating object has formattedRangeIndex defined."),
null):0>yb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: FormattedRangeIndex is a negative number."),null):Tf.ihn(ja)?null:this.f1i(Ua)?{referencedPath:["session","doc","main",ja.id.toString()],formattedRangeIndex:yb,anchorMode:null!==Wb&&void 0!==Wb?Wb:Lf.b.Unspecified,anchoredObjectType:Wb==Lf.b.Floating?Ua:void 0}:null}vNh(ja,Ua,yb,Wb,tc){Ua=this.J9h(Ua,yb,Wb,tc);null!=Ua&&null!=ja&&ja.push(Ua)}ndo(ja){const Ua=[];if(null==ja)return a.ULS.sendTraceTag(null,389,10,
"FormattingExtractor.ProcessAnchoredObjects: paragraphNode is null."),Ua;let yb=null;ja.hasProperty(ib.a.i6)&&(yb=ja.getValue(ib.a.i6));if(null!=yb)for(let Wb=0;Wb<yb.length;++Wb){const tc=Tf.MNf(ja,yb,Wb),Rc=this.ZKf(tc);null!=Rc&&this.vNh(Ua,tc,Rc,null,Lf.b.Floating)}return Ua}o5h(ja){if(null==ja||!ja.hasProperty(Jf.a.Qn))return!1;const Ua=ja.getValue(Jf.a.Qn);for(let Wb=0;Wb<Ua.length;Wb++){var yb=Tf.MNf(ja,Ua,Wb);yb=this.ZKf(yb);if(this.f1i(yb))return!0}return!1}}Tf.Jrj=new Map([[5,Lf.f.Image],
[11,Lf.f.TextBox],[7,Lf.f.Chart],[6,Lf.f.SmartArt],[10,Lf.f.Drawing],[2,Lf.f.EquationObject],[4,Lf.f.Ink],[19,Lf.f.PageBreak],[23,Lf.f.FootnoteEndnote],[24,Lf.f.FootnoteEndnote],[35,Lf.f.FootnoteEndnoteReferenceMark],[36,Lf.f.FootnoteEndnoteReferenceMark],[0,Lf.f.Other]]);Tf.bcp=new Set([Lf.f.Image,Lf.f.TextBox,Lf.f.Chart,Lf.f.SmartArt,Lf.f.Drawing,Lf.f.Ink]);Object(f.a)(Tf,"FormattingExtractor",null,[533]);var Zh=d(1160);class se extends Sys.EventArgs{constructor(ja){super();this.hlc=ja}}Object(f.a)(se,
"HasNodeEventsEventArgs",Sys.EventArgs,[]);class Gg extends Sys.EventArgs{constructor(ja){super();this.cba=ja}}Object(f.a)(Gg,"IsCollectingNodeEventsEventArgs",Sys.EventArgs,[]);class mf{constructor(ja,Ua,yb){this.vdd=ja;this.graphNode=Ua;this.fullPath=yb}}Object(f.a)(mf,"NodeEvent",null,[554]);class Ne{constructor(){this.AVe=this.gTe=!1;this.ZEb=null;this.sa=new Ka.a;this.yda=new Ca.a(0);this.gib=new Zh.a($b.a.th());this.MFb=new Zh.a($b.a.th());this.PGd=[]}YNh(ja){this.sa.addHandler("IsCollectingNodeEventsChangedKey",
ja)}Dpl(){this.yda=new Ca.a(0);this.hlc=!1}get hlc(){return this.gTe}set hlc(ja){this.gTe!==ja&&(this.gTe=ja,this.sa.raiseEvent("HasNodeEventsChangedKey",new se(ja),this))}get cba(){return this.AVe}set cba(ja){this.AVe!==ja&&(this.AVe=ja,this.sa.raiseEvent("IsCollectingNodeEventsChangedKey",new Gg(ja),this))}MZb(ja,Ua){this.gib.lb(ja)||this.gib.Z(ja,Ua)}VHo(ja,Ua){this.MFb.Z(ja,Ua)}kfm(ja){let Ua=null;this.MFb.lb(ja)&&(Ua=this.MFb.K(ja),this.MFb.remove(ja));return Ua}xse(ja,Ua){if(ja)if(this.cba){var yb=
3!==Ua&&4!==Ua&&5!==Ua||!this.gib.lb(String.format("{0}",ja.id))?ab.a.kI(ja):this.gib.K(String.format("{0}",ja.id));if(({value:Wb}=this.yda.Ac(yb)).returnValue)if(Wb||3!==Ua)if(5===Wb&&3===Ua){if(ja=yb.split("\\").pop(),this.MFb.lb(ja)){var Wb=this.MFb.K(ja);Wb===yb?(this.V5f(yb,Ua),this.yda.add(yb,Ua)):(this.MFb.Z(ja,yb),this.gib.Z(ja,Wb),this.U9i(yb),this.yda.remove(yb),this.V5f(yb,Ua),this.yda.add(Wb,5))}}else Wb&&(4!==Wb||0!==Ua&&3!==Ua&&5!==Ua)&&(this.V5f(yb,Ua),this.yda.add(yb,Ua));else this.U9i(yb),
this.yda.remove(yb);else this.zDn(yb,Ua),this.PGd.push(ja),this.yda.add(yb,Ua);this.hlc=0<this.yda.count}else a.ULS.sendTraceTag(593761369,389,15,"Can't record a node event if not in collecting mode.");else a.ULS.sendTraceTag(593761370,389,15,"node is null.")}zDn(ja,Ua){a.ULS.sendTraceTag(593761368,389,100,"Recording new event in queue for node {0} of kind {1}.",ja,Ua)}V5f(ja,Ua){a.ULS.sendTraceTag(593761366,389,100,"Recording new event for node {0} of kind {1}.",ja,Ua)}U9i(ja){a.ULS.sendTraceTag(593761367,
389,100,"Removing node {0} form _nodeIdEventKindMap.",ja)}Qwl(){let ja=null;var Ua=!1;let yb=null;for(;this.PGd.length&&!Ua;){yb=Array.dequeue(this.PGd);if(!yb)return a.ULS.sendTraceTag(593761365,389,15,"graphNode should not be null."),null;this.gib.lb(String.format("{0}",yb.id))?(ja=this.gib.K(String.format("{0}",yb.id)),this.gib.remove(String.format("{0}",yb.id)),this.PGd.push(yb)):ja=ab.a.kI(yb);Ua=this.yda.lb(ja)}if(!Ua)return a.ULS.sendTraceTag(593761364,389,15,"NodeEventCollection is empty."),
this.Dpl(),null;Ua=this.yda.K(ja);this.yda.remove(ja);this.hlc=0<this.yda.count;a.ULS.sendTraceTag(593761363,389,100,"Consuming new event for node {0} of kind {1}.",ja,Ua);return new mf(Ua,yb,ja)}Eno(ja){this.ZEb=ja}Rwl(){if(!this.ZEb)return null;for(var ja=0;ja<this.ZEb.length;ja++){var Ua=this.ZEb.K(ja);Ua=ab.a.kI(Ua.node);if(this.yda.lb(Ua))return null}ja=this.ZEb;this.ZEb=null;return ja}Vpl(){this.ZEb=null}M9o(){this.cba=!0}Hfn(ja){return this.yda.lb(ja.id.toString())}}Object(f.a)(Ne,"NodeEventsCollection",
null,[532]);var Fb=d(1352),Vb=d(1271),Qc=d(352),yd=d(91);class Ce extends Vb.a{constructor(ja,Ua,yb,Wb,tc,Rc,Id,Pd,Rd,Ue,tf){super();this.wCd=new Fb.a;this.Shb=!1;this.XFc=null;this.xma=(cg,fg)=>{(cg=fg.node)&&this.beb(cg)&&(a.ULS.sendTraceTag(40253400,389,100,"New paragraph Connect event."),ab.a.B0o(cg,this.Fpa.cba,this.a4b,this.WJk)&&(this.Fpa.xse(cg,0),this.n5j(cg)));this.Fpa.cba&&this.Gda.xvb(cg)};this.Nhj=(cg,fg)=>{cg=fg.node;this.Fpa.MZb(String.format("{0}",cg.id),ab.a.kI(cg))};this.CYa=(cg,
fg)=>{(cg=fg.node)&&this.beb(cg)&&(a.ULS.sendTraceTag(40253401,389,100,"New paragraph Disconnect event."),this.Fpa.cba&&this.Fpa.xse(cg,3));this.Fpa.cba&&this.Gda.Rkj(cg,3)};this.FN=(cg,fg)=>{cg=fg.node;fg=fg.property;cg&&this.Glk.has(fg)&&this.beb(cg)&&(a.ULS.sendTraceTag(40253402,389,100,"New paragraph Modified event."),this.Fpa.cba&&(this.Fpa.xse(cg,2),fg===ib.a.Uj&&this.n5j(cg)));this.Fpa.cba&&fg===ib.a.Yc&&this.Gda.Rkj(cg,2)};this.Ohj=(cg,fg)=>{(cg=fg.node)&&Ya.ParagraphReader.Vb(cg)&&!this.EFc.has(cg)&&
!this.vQe.has(cg)&&(this.EFc.add(cg),this.p0())};this.Tkj=(cg,fg)=>{a.ULS.sendTraceTag(51389214,389,100,"Paragraph load event.");(cg=fg.node)&&this.Te.MRn(cg)};this.dbg=()=>{this.uod()?this.ZL():this.Shb&&!this.Fpa.cba&&this.m0a()};this.PD=Ua;this.Fpa=yb;this.WJk=yd.b(Wb.sve);this.a4b=ja.$("AugLoopOperationsAreEnabled");this.Te=tc;this.Gda=Rc;this.ED=Id;this.Gb=Pd;this.Tn=Rd;this.zH=Ue;this.EFc=new Set;this.vQe=new Set;tf.hva(this,7);this.Glk=new Set([Jf.a.Pn,Jf.a.bold,Jf.a.italic,Jf.a.underline,
Jf.a.font,Jf.a.fontSize,Jf.a.fontColor,xg.a.capitalization,Jf.a.si,Jf.a.Qn,ib.a.Cga,ib.a.K3,ib.a.Sj,ib.a.Bga,ib.a.J3,ib.a.ta,ib.a.ya,ib.a.xa,ib.a.listID,ib.a.WU,ib.a.he,ib.a.ZCa,ib.a.Qv,ib.a.Uj])}get index(){return 7}get Sed(){return this.XFc}set Sed(ja){this.XFc=ja;this.Gda.pfg=ja?()=>{this.XFc()}:null}init(){this.uod()&&this.ZL();this.Fpa.YNh(this.dbg)}ZL(){this.PD?(this.Shb=!0,this.PD.wt(this.xma),this.PD.tT(this.Nhj),this.PD.Yx(this.CYa),this.PD.jo(this.FN),this.PD.EOh(this.Tkj),this.PD.uZk(this.Ohj)):
a.ULS.sendTraceTag(39403912,389,10,"RegisterEventHandlers: ParagraphNode event handlers can't be null.")}m0a(){this.PD?(this.Shb=!1,this.PD.hS(this.xma),this.PD.Pga(this.Nhj),this.PD.Rua(this.CYa),this.PD.JP(this.FN),this.PD.lCj(this.Tkj),this.PD.Gxo(this.Ohj)):a.ULS.sendTraceTag(39403913,389,10,"UnregisterEventHandlers: ParagraphNode event handlers can't be null.")}U$d(ja){ja&&this.wCd.add(ja.id,ja.ka(ib.a.Uj,0))}n5j(ja){this.wCd.lb(ja.id)?(this.Gda.Vxp(Za.a.nze,ja,this.wCd.K(ja.id)),this.wCd.remove(ja.id)):
(this.Gda.Npl(Za.a.nze),this.Sed&&this.Sed())}beb(ja){const Ua=jg.StaticActiveAppFrame.za().kb.Jc;return!!Ua&&Ua.mw&&!!Ua.od&&!!Ua.od.Ic&&!!ja&&!!ja.Ic&&ja.Ic.id===Ua.od.Ic.id}run(){if(0!==this.EFc.size){var ja=[];for(const Ua of this.EFc)ja.push(Ua),this.vQe.add(Ua),100<=ja.length&&(this.Iii(ja),ja=[]);0<ja.length&&this.Iii(ja);this.EFc.clear()}}Iii(ja){const Ua=new bb.a(4,1,500,()=>{for(const yb of ja)this.vQe.delete(yb),this.Yqp(yb)},158);this.Gb.Zb(Ua)}Yqp(ja){var Ua=this.Tn.JVa(ja,0,Wb=>this.j2o(Wb.intent));
if(0<Ua.count)for(const Wb of Ua){Ua=this.Gda.sFm(Wb.intent.id);var yb=ja.Tra;const tc=Ya.ParagraphReader.nU(ja);Wb.end<Wb.Ec||(yb=Qc.a.fXc(tc,yb,Wb.Ec,Wb.end-Wb.Ec,Wb.Ec,Wb.end-Wb.Ec,ja),this.zH.Jqg(ja.Ic,Ua,yb))}}j2o(ja){return!!ja&&this.ED.atb(ja)&&!!ja.content}uod(){return!this.Shb&&this.Fpa.cba}}Object(f.a)(Ce,"ParagraphNodeEventHandler",Vb.a,[527]);var sf=d(960),lh=d(467),Ef=d(930),ng=d(234);class Dh extends Ef.a{constructor(){super();this.H_=Object.assign(new ng.a,{T_:Dh.getTypeName(),B_:Dh.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}
Object(f.a)(Dh,"DeltaUpdateOperation",Ef.a,[]);var Af=d(858);class Jh{constructor(){this.referencedPath=null}}Object(f.a)(Jh,"ItemReference",null,[]);class vg extends Af.a{constructor(){super();this.op=this.deltas=this.delta=this.parentPath=null}}Object(f.a)(vg,"ItemWithPath",Af.a,[]);var Hk=d(1542);class tg extends Hk.a{constructor(){super();this.prevParentPath=null;this.H_=Object.assign(new ng.a,{T_:tg.getTypeName(),B_:tg.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext",
"AugLoop_Core_Operation"]}}Object(f.a)(tg,"MoveOperation",Hk.a,[]);var wh=d(1400);class Hg extends wh.a{constructor(){super();this.selectedRanges=null;this.H_=Object.assign(new ng.a,{T_:Hg.getTypeName(),B_:Hg.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(f.a)(Hg,"SelectionSignal",wh.a,[]);class Sf extends Hg{constructor(){super();this.content=null;this.H_=Object.assign(new ng.a,{T_:Sf.getTypeName(),B_:Sf.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionContentSignal"}static getBaseTypes(){return["AugLoop_Text_SelectionSignal",
"AugLoop_Signals_Signal"]}}Object(f.a)(Sf,"SelectionContentSignal",Hg,[]);class ph{constructor(){this.range=this.tileReference=null}}Object(f.a)(ph,"TextTileRange",null,[]);var Mh=d(1640),Qf=d(857),Qi=d(31),Cl=d(38);class tl{constructor(ja,Ua,yb,Wb,tc,Rc,Id,Pd){this._augLoopRuntimeManager=this.DAd=null;this.I7e=!1;this.Wpa=this.YYe=this.rLd=null;this.Wch=2E3;this.S7l=()=>{if(Ra.a.JU||lh.SessionStatusManager.instance&&lh.SessionStatusManager.instance.Do)Jd.a.hy().closeSession(),a.ULS.sendTraceTag(512623445,
389,15,"TileView.firePreparedEventsForOperations: Closing AL session"),this.Gb.uf(this.DAd);this.kj.$d(()=>{var Rd;const Ue=vf.a.instance.Ika;this.jD()&&this.fCo();for(this.RPc.reset();this.q3a.hlc&&!this.RPc.Mub();){let fg;fg=this.q3a.Qwl();if(!fg||!fg.graphNode){a.ULS.sendTraceTag(41719901,389,15,"FirePreparedEventsForOperations: nodeEvent or nodeEvent.GraphNode is null.");this.RPc.update();continue}if(!this.h0o(fg)){a.ULS.sendTraceTag(41719902,389,50,"FirePreparedEventsForOperations: Node with id {0} was not processed.",
fg.graphNode.id);this.RPc.update();continue}const Mg=fg.graphNode.id.toString();var tf=-1,cg=!0;Ue&&Cl.a.pf(Ue)&&Mg==Ue.node.id.toString()&&(tf=Ue.cpBegin,cg=!1);let Fh=null;if(this.FHb.contains(Mg))switch(fg.vdd){case 3:this.FHb.remove(Mg);Fh=3;break;default:Fh=fg.vdd}else switch(fg.vdd){case 0:case 1:this.FHb.add(Mg);Fh=0;break;case 2:this.FHb.add(Mg);Fh=0;break;case 3:this.FHb.remove(Mg);Fh=3;break;default:Fh=fg.vdd}if(null!=Fh){tf=this.JBi(fg.graphNode,fg.fullPath,Fh,tf,cg);if(4==Fh||5==Fh){if(tf.prevParentPath.join()!==
tf.parentPath.join()){cg=Object.assign(new ob.a,{parentPath:tf.prevParentPath,items:tf.items});const zj=Object.assign(new pb.a,{parentPath:tf.parentPath,items:tf.items,prevId:tf.prevId,nextId:tf.nextId});Mg!==tf.prevId&&Mg!==tf.nextId||a.ULS.sendTraceTag(512231646,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",Fh,Mg,tf.prevId,tf.nextId,fg.graphNode.type);this._augLoopRuntimeManager.submitOperation(Object.assign(new Qf.a,
{operation:cg}));this._augLoopRuntimeManager.submitOperation(Object.assign(new Qf.a,{operation:zj}));14===fg.graphNode.type&&this.MJj(fg.graphNode,tf.parentPath).forEach(om=>{this._augLoopRuntimeManager.submitOperation(Object.assign(new Qf.a,{operation:om}))})}}else this._augLoopRuntimeManager.submitOperation(Object.assign(new Qf.a,{operation:tf}));if(this.swd&&this.Wpa&&this.Wpa[0]==Mg)switch(Fh){case 3:this.Wpa=null;break;case 0:case 1:case 2:case 4:case 5:this.Wpa[1]=null===(Rd=this.yjb.Eqb(fg.graphNode))||
void 0===Rd?void 0:Rd.M1c(fg.graphNode)}a.ULS.sendTraceTag(40776388,389,100,"FirePreparedEventsForOperations: Operation with OpType {0} submitted for tileId {1}",Ab.a.getTypeNameFor(tf),Mg);switch(Fh){case 0:case 4:case 5:this.Te.B0n(fg.graphNode);break;case 3:this.Te.C0n(fg.graphNode,tf.parentPath.join("\\"))}}this.RPc.update()}(Rd=this.q3a.Rwl())&&this.MDj(Rd)},"TV:FPEFO")};this.Hua=(Rd,Ue)=>{var tf;if(Ue.Rm&&Ue.Rm.length){if(this.swd)if(Rd=ab.a.gzm(Ue.Rm),!Rd)this.Wpa=null;else if(!this.Wpa||this.Wpa[0]!=
Rd.id.toString()){const cg=this.q3a.Hfn(Rd)?null:null===(tf=this.yjb.Eqb(Rd))||void 0===tf?void 0:tf.M1c(Rd);this.Wpa=[Rd.id.toString(),cg]}this.I7e&&this.q3a.Eno(Ue.Rm.currentSelection)}};this.Ga=ja;this.q3a=Ua;this.Gb=yb;this.RPc=Wb;this.lmk=this.Ga.$("AugLoopOperationsAreEnabled");this.FHb=new xb.a($b.a.th());this.Te=tc;this.kj=Rc;this.yjb=Id;this.hb=Pd;this.swd=this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoreplaceIsEnabled",!1);this.hb.tA(this.Hua);ab.a.hm().then(()=>{this._augLoopRuntimeManager=
Jd.a.hy();this.Ga.$("AugLoopAnnotationsIsEnabled")&&this._augLoopRuntimeManager.setAnnotationResultCallback(Object.assign(new Mh.a,{handler:Rd=>{this.Te.w3k(Rd)}}));this.lmk&&this.q3a.M9o();this.C$o()}).catch(()=>{});this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.IncreasedIntervalForDelayedCritiquesIsEnabled",!1)&&(this.Wch=5E3)}fCo(){const ja=this.Te.lFc.entries();for(let Ua=0;Ua<this.Te.lFc.size;Ua++){const yb=ja.next();y.AFrameworkApplication.vd("gi204158;ef1e2812");Date.now()-yb.value[1].time>=
this.Wch&&this.Te.J4c(yb.value[1].annotation,!0,pb.a.getTypeName(),!1)}}h0o(ja){return 3===ja.vdd||ab.a.QRj(ja.graphNode)}C$o(){!this.DAd&&this.q3a.cba&&(this.DAd=new bb.a(4,2,this.Ga.ic("NodeEventsFiringInterval",500),this.S7l,131),this.Gb.Zb(this.DAd))}MJj(ja,Ua){var yb,Wb=[];const tc=ac.a.Za(ja),Rc=tc.zq();for(var Id=0;Id<Rc;Id++){let Pd=tc.WG(Id);11===Pd.type&&(Pd=Qi.OutlineElementNavigator.Me(tc));const Rd=Pd.id.toString(),Ue=null===(yb=this.yjb.Eqb(Pd))||void 0===yb?void 0:yb.Enb(Pd);Wb.push(Object.assign(new Af.a,
{body:Ue,id:Rd,revId:ab.a.WNf(Pd)}));tc.ld(ja.type)}Ua.push(ja.id.toString());yb=[];yb.push(Object.assign(new pb.a,{parentPath:Ua.slice(),items:Wb,prevId:null}));for(Wb=0;Wb<Rc;Wb++)Id=tc.WG(Wb),11===Id.type&&(Id=Qi.OutlineElementNavigator.Me(tc)),0<tc.zq()&&(yb=yb.concat(this.MJj(Id,Ua))),tc.ld(ja.type);Ua.pop();return yb}rKa(ja){return ja.split("\\").slice(0,-1)}JBi(ja,Ua,yb,Wb=-1,tc=!0){var Rc;let Id=null,Pd=null;const Rd=ja.id.toString();var Ue=null;3!==yb&&(Ue=ab.a.vfl(ja));if(Ue)for(let tf=
0;tf<Ue.length;tf++)if(Ue[tf]===Rd){Pd=tf+1<Ue.length?Ue[tf+1]:null;Id=tf?Ue[tf-1]:null;break}Rd!==Id&&Rd!==Pd||a.ULS.sendTraceTag(512231645,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",yb,Rd,Id,Pd,ja.type);Ue=null===(Rc=this.yjb.Eqb(ja))||void 0===Rc?void 0:Rc.Enb(ja,Wb,tc);Wb=[Object.assign(new Af.a,{body:Ue,id:Rd,revId:ab.a.WNf(ja)})];switch(yb){case 0:case 1:return Object.assign(new pb.a,{parentPath:this.rKa(Ua),
items:Wb,prevId:Id,nextId:Pd});case 4:return Object.assign(new tg,{parentPath:this.rKa(ab.a.kI(ja)),prevParentPath:this.rKa(Ua),items:Wb,prevId:Id,nextId:Pd});case 5:return yb=this.q3a.kfm(Rd),Object.assign(new tg,{parentPath:this.rKa(null!==yb&&void 0!==yb?yb:ab.a.kI(ja)),prevParentPath:this.rKa(Ua),items:Wb,prevId:Id,nextId:Pd});case 2:return Object.assign(new sb.a,{parentPath:this.rKa(Ua),items:Wb});case 3:return Object.assign(new ob.a,{parentPath:this.rKa(Ua),items:Wb});default:return a.ULS.sendTraceTag(42084322,
389,15,"Submitted unknown operation for NodeEventKind ${0}, tileId {1}",yb,Rd),Object.assign(new Hk.a,{parentPath:this.rKa(Ua),items:Wb,prevId:Id,nextId:Pd})}}AMm(ja){return this.Wpa&&this.Wpa[0]===ja?this.Wpa[1]:null}JMo(ja){var Ua;if(!this.swd)return a.ULS.sendTraceTag(545552581,389,10,"sendTile: autoreplace is not enabled"),!1;if(!ab.a.QRj(ja))return!1;const yb=ja.id.toString();var Wb=this.FHb.contains(yb)?2:0;Wb=this.JBi(ja,ab.a.kI(ja),Wb);this._augLoopRuntimeManager.submitOperation(Object.assign(new Qf.a,
{operation:Wb}));this.FHb.add(yb);this.Wpa=[yb,null===(Ua=this.yjb.Eqb(ja))||void 0===Ua?void 0:Ua.M1c(ja)];return!0}BLo(ja,Ua){var yb;if(this.swd){var Wb=ja.id.toString(),tc=this.rKa(ab.a.kI(ja));Ua=[Object.assign(new vg,{id:Wb,revId:ab.a.WNf(ja),parentPath:tc,delta:Ua})];tc=Object.assign(new Dh,{parentPath:tc,items:Ua});this._augLoopRuntimeManager.submitOperation(Object.assign(new Qf.a,{operation:tc}));a.ULS.sendTraceTag(545552583,389,50,"sendDeltaOperation: tileId {0}",Wb);this.Wpa=[Wb,null===
(yb=this.yjb.Eqb(ja))||void 0===yb?void 0:yb.M1c(ja)]}else a.ULS.sendTraceTag(545552582,389,10,"sendDeltaOperation: autoreplace is not enabled")}b8k(ja,Ua){if(ja.tileReference.referencedPath.length!==Ua.tileReference.referencedPath.length||ja.range.start!==Ua.range.start||ja.range.length!==Ua.range.length||ja.range.isInsertionPoint!==Ua.range.isInsertionPoint)return!1;for(let yb=0;yb<ja.tileReference.referencedPath.length;yb++)if(ja.tileReference.referencedPath[yb]!==Ua.tileReference.referencedPath[yb])return!1;
return!0}X7k(ja,Ua){if(ja.selectedRanges.length!==Ua.selectedRanges.length||ja.content!==Ua.content)return!1;for(let yb=0;yb<ja.selectedRanges.length;yb++)if(!this.b8k(ja.selectedRanges[yb],Ua.selectedRanges[yb]))return!1;return!0}MDj(ja){ja=this.getSelection(ja);if(!this.YYe||!this.X7k(ja,this.YYe)){var Ua=this.rLd?this.rLd:Ib.a.create().toString(),yb=[Object.assign(new Af.a,{body:ja,id:Ua})];this.rLd?Ua=Object.assign(new sb.a,{parentPath:["session","doc"],items:yb}):(this.rLd=Ua,Ua=Object.assign(new pb.a,
{parentPath:["session","doc"],items:yb}));this._augLoopRuntimeManager.submitOperation(Object.assign(new Qf.a,{operation:Ua}));this.YYe=ja}}getSelection(ja){var Ua;if(!ja)return null;const yb=new G.a;let Wb="";for(let Id=0;Id<ja.length;Id++){var tc=ja.K(Id),Rc=(null===(Ua=this.yjb.Eqb(tc.node))||void 0===Ua?void 0:Ua.Enb(tc.node)).content;Wb+=Rc;Rc=tc.cpBegin<Rc.length?tc.cpBegin:-1;Rc=Object.assign(new qc.a,{start:Rc,length:tc.cpEnd-tc.cpBegin});Object.assign(Rc,{isInsertionPoint:Cl.a.pf(tc)||Cl.a.ll(tc)});
const Pd=tc.node.id.toString();tc=this.rKa(ab.a.kI(tc.node));tc.push(Pd);yb.add(Object.assign(new ph,{range:Rc,tileReference:Object.assign(new Jh,{referencedPath:tc})}))}return Object.assign(new Sf,{selectedRanges:yb.toArray(),content:Wb})}FVo(ja){(this.I7e=ja)?this.Usg():this.q3a.Vpl()}Usg(){this.MDj(this.hb.gb.currentSelection)}J2(){var ja,Ua,yb=null===(ja=this.hb.gb)||void 0===ja?void 0:ja.currentSelection;if(yb){ja=new G.a;var Wb="";for(const tc of yb){yb=(null===(Ua=this.yjb.Eqb(tc.node))||void 0===
Ua?void 0:Ua.Enb(tc.node)).content;Wb+=yb;yb=Object.assign(new qc.a,{start:tc.Hj,length:tc.Oo-tc.Hj});const Rc=tc.node.id.toString(),Id=this.rKa(ab.a.kI(tc.node));Id.push(Rc);ja.add(Object.assign(new ph,{range:yb,tileReference:Object.assign(new Jh,{referencedPath:Id})}))}return Object.assign(new Sf,{selectedRanges:ja.toArray(),content:Wb})}}jD(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}}Object(f.a)(tl,
"TileView",null,[530]);var pf=d(34),Wk=d(50);class Eh{constructor(ja){Wk.a.assign(Eh,this,ja)}static getTypeName(){return"AugLoop_Table_TableRow"}static getBaseTypes(){return[]}static typeGuard(ja){return Wk.a.matchesTypesFor(ja,[Eh.getTypeName()])}}Eh.H_={T_:Eh.getTypeName(),B_:Eh.getBaseTypes()};class Li{constructor(ja){Wk.a.assign(Li,this,ja)}static getTypeName(){return"AugLoop_Table_TableCell"}static getBaseTypes(){return[]}static typeGuard(ja){return Wk.a.matchesTypesFor(ja,[Li.getTypeName()])}}
Li.H_={T_:Li.getTypeName(),B_:Li.getBaseTypes()};class Dj{constructor(ja){Wk.a.assign(Dj,this,ja)}static getTypeName(){return"AugLoop_Table_Table"}static getBaseTypes(){return[]}static typeGuard(ja){return Wk.a.matchesTypesFor(ja,[Dj.getTypeName()])}}Dj.H_={T_:Dj.getTypeName(),B_:Dj.getBaseTypes()};class xi{constructor(ja){Wk.a.assign(xi,this,ja)}static getTypeName(){return"AugLoop_Table_WordTable"}static getBaseTypes(){return["AugLoop_Table_Table"]}static typeGuard(ja){return Wk.a.matchesTypesFor(ja,
[xi.getTypeName()])}}xi.H_={T_:xi.getTypeName(),B_:xi.getBaseTypes()};class pg{constructor(ja){Wk.a.assign(pg,this,ja)}static getTypeName(){return"AugLoop_Table_WordOOXmlTableTile"}static getBaseTypes(){return["AugLoop_Table_WordTable","AugLoop_Table_Table"]}static typeGuard(ja){return Wk.a.matchesTypesFor(ja,[pg.getTypeName()])}}pg.H_={T_:pg.getTypeName(),B_:pg.getBaseTypes()};var Mi;(function(ja){ja[ja.Top=0]="Top";ja[ja.Center=1]="Center";ja[ja.Bottom=2]="Bottom"})(Mi||(Mi={}));var Vl;(function(ja){ja[ja.none=
0]="none";ja[ja.firstRow=32]="firstRow";ja[ja.lastRow=64]="lastRow";ja[ja.firstCol=128]="firstCol";ja[ja.lastCol=256]="lastCol";ja[ja.K$p=512]="noHBand";ja[ja.T$p=1024]="noVBand";ja[ja.nwCell=160]="nwCell";ja[ja.neCell=288]="neCell";ja[ja.swCell=192]="swCell";ja[ja.seCell=320]="seCell";ja[ja.aMl=1184]="defaultLook"})(Vl||(Vl={}));Object(f.b)("TableLookFlags",Vl);class ki{Enb(ja){if(ja)switch(ja.type){case 14:return this.qIl(ja);case 15:return new Eh;case 16:return this.pIl(ja)}else a.ULS.sendTraceTag(524149331,
389,10,"ConvertNodeToTile: Node can't be null.")}qIl(ja){var Ua=ja.RH||[];let yb=0;for(let Wb=0;Wb<Ua.length;Wb++)yb+=Ua[Wb];Ua=Ua.map((Wb,tc)=>({columnId:tc.toString(),widthPercent:0!=yb?100*Wb/yb:0}));return new xi({columnDefs:Ua,tableLook:ja.properties.ka(ib.a.tableLook,Vl.aMl),complexTable:ja.properties.ka(ib.a.complexTable,!1),floatingTable:ja.properties.ka(ib.a.QWi,!1)})}pIl(ja){return new Li({rowspan:ja.properties.ka(ib.a.rowSpan,1),colspan:ja.properties.ka(ib.a.colSpan,1),borderInfo:{topBorder:{color:ja.properties.ka(ib.a.X0b,
0),size:ja.properties.ka(ib.a.uyc,4),style:ja.properties.ka(ib.a.mzb,"single")},leftBorder:{color:ja.properties.ka(ib.a.V0b,0),size:ja.properties.ka(ib.a.syc,4),style:ja.properties.ka(ib.a.kzb,"single")},rightBorder:{color:ja.properties.ka(ib.a.W0b,0),size:ja.properties.ka(ib.a.tyc,4),style:ja.properties.ka(ib.a.lzb,"single")},bottomBorder:{color:ja.properties.ka(ib.a.U0b,0),size:ja.properties.ka(ib.a.ryc,4),style:ja.properties.ka(ib.a.jzb,"single")}},verticalAlignment:ja.properties.ka(ib.a.sOa,Mi.Top),
ghostCell:ja.properties.ka(ib.a.ghostCell,!1),renderCell:ja.properties.ka(ib.a.renderCell,!1),skippedCell:ja.properties.ka(ib.a.skippedCell,!1),fillColor:ja.properties.ka(Jf.a.VK,0),verticalMerge:ja.properties.ka(pf.a.vMerge,null)})}M1c(ja){return null===ja||void 0===ja?void 0:ja.properties}}Object(f.a)(ki,"TableElementNodeToTileConverter",null,[529]);class Th{constructor(ja,Ua,yb){this.Vp=Ua;this.jEa=yb;this.R0d=!1;this.XFc=null;this.Wmj=(Wb,tc)=>{this.mDa(tc.node,0)};this.Smj=(Wb,tc)=>{Wb=tc.node;
this.jEa.MZb(Wb.id.toString(),ab.a.kI(Wb))};this.Xmj=(Wb,tc)=>{this.mDa(tc.node,3)};this.lne=(Wb,tc)=>{this.mDa(tc.node,2)};this.Zmj=(Wb,tc)=>{this.mDa(tc.node,0)};this.$mj=(Wb,tc)=>{this.mDa(tc.node,3)};this.Ymj=(Wb,tc)=>{Wb=tc.node;this.jEa.MZb(Wb.id.toString(),ab.a.kI(Wb))};this.mne=(Wb,tc)=>{this.mDa(tc.node,2)};this.Umj=(Wb,tc)=>{this.mDa(tc.node,0)};this.Tmj=(Wb,tc)=>{Wb=tc.node;this.jEa.MZb(Wb.id.toString(),ab.a.kI(Wb))};this.Vmj=(Wb,tc)=>{this.mDa(tc.node,3)};this.jne=(Wb,tc)=>{var Rc;Wb=
tc.node;if(tc.property===ib.a.ghostCell){if(tc=Wb.Tg?Wb:null===(Rc=Wb.vCa)||void 0===Rc?void 0:Rc.NO){Rc=ac.a.Za(tc);var Id=Rc.zq();for(var Pd=0;Pd<Id;Pd++){Rc.WG(Pd);var Rd=Qi.OutlineElementNavigator.Me(Rc);this.jEa.MZb(Rd.id.toString(),String.format("{0}\\{1}",ab.a.kI(tc),Rd.id));this.mDa(Rd,4);Rc.ld(16)}}}else if(tc.property===Jf.a.pg){tc=ac.a.Za(Wb);Rc=tc.zq();let Ue=null;Id=[];for(Pd=0;Pd<Rc;Pd++){tc.WG(Pd);Rd=Qi.OutlineElementNavigator.Me(tc);this.jEa.VHo(Rd.id.toString(),String.format("{0}\\{1}",
ab.a.kI(Wb),Rd.id));if(14!==Rd.type){if(Ue=ab.a.kI(Rd))this.jEa.MZb(Rd.id.toString(),Ue),this.mDa(Rd,5)}else Id.push(Rd);tc.ld(16)}Ue&&Id.forEach(tf=>{this.jEa.MZb(tf.id.toString(),String.format("{0}\\{1}",Ue.split("\\").slice(0,-1).join("\\"),tf.id));this.mDa(tf,5)})}this.mDa(Wb,2)};this.dbg=()=>{this.uod()?this.ZL():this.R0d&&!this.jEa.cba&&this.m0a()};this.a4b=ja.$("AugLoopOperationsAreEnabled")}get Sed(){return this.XFc}init(){this.uod()&&this.ZL();this.jEa.YNh(this.dbg)}ZL(){const {HYj:ja,dBe:Ua,
wYj:yb}=this.jwi();if(ja&&Ua&&yb){this.R0d=!0;var Wb=this.Smj,tc=this.Xmj,Rc=this.lne;ja.wt(this.Wmj);ja.tT(Wb);ja.Yx(tc);ja.jo(Rc);Wb=this.Ymj;tc=this.$mj;Rc=this.mne;Ua.wt(this.Zmj);Ua.tT(Wb);Ua.Yx(tc);Ua.jo(Rc);Wb=this.Tmj;tc=this.Vmj;Rc=this.jne;yb.wt(this.Umj);yb.tT(Wb);yb.Yx(tc);yb.jo(Rc)}else a.ULS.sendTraceTag(524149329,389,10,"RegisterEventHandlers: TableNode event handlers can't be null.")}m0a(){const {HYj:ja,dBe:Ua,wYj:yb}=this.jwi();if(ja&&Ua&&yb){this.R0d=!1;var Wb=this.Smj,tc=this.Xmj,
Rc=this.lne;ja.hS(this.Wmj);ja.Pga(Wb);ja.Rua(tc);ja.JP(Rc);Wb=this.Ymj;tc=this.$mj;Rc=this.mne;Ua.hS(this.Zmj);Ua.Pga(Wb);Ua.Rua(tc);Ua.JP(Rc);Wb=this.Tmj;tc=this.Vmj;Rc=this.jne;yb.hS(this.Umj);yb.Pga(Wb);yb.Rua(tc);yb.JP(Rc)}else a.ULS.sendTraceTag(524149330,389,10,"UnregisterEventHandlers: TableNode event handlers can't be null.")}mDa(ja,Ua){ja&&this.beb(ja)&&this.jEa.cba&&this.a4b&&this.jEa.xse(ja,Ua)}jwi(){return{HYj:this.Vp.jf(14),dBe:this.Vp.jf(15),wYj:this.Vp.jf(16)}}beb(ja){const Ua=jg.StaticActiveAppFrame.za().kb.Jc;
return!!Ua&&Ua.mw&&!!Ua.od&&!!Ua.od.Ic&&!!ja&&!!ja.Ic&&ja.Ic.id===Ua.od.Ic.id}uod(){return!this.R0d&&!!this.jEa.cba}}Object(f.a)(Th,"TableNodeEventHandler",null,[527]);class hh{constructor(ja,Ua){this.Vpj=ja;this.Ndp=Ua}Eqb(ja){return ja?14===ja.type||15===ja.type||16===ja.type?this.Ndp:12===ja.type?this.Vpj:null:null}}Object(f.a)(hh,"NodeToTileConverterHolder",null,[526]);var Fe=d(337);class tj{get name(){return"Box4.AugmentationLoop"}uc(ja){this.W=ja;const Ua=this.W.resolve(71),yb=Ua.$("AugLoopTaskUseTimeBasedYieldStrategy"),
Wb=new Ne,tc=yb?new kb.a(Ua.ic("AugLoopTaskAllowedRunTimeBeforeYielding",10),la.a.Ge):new qb(Ua.ic("AugLoopTaskNodesToRunBeforeYielding",10));this.W.ia(734,()=>va.a.instance).ha();this.W.ia("Box4.AugmentationLoop.AugmentationLoopStateManager",()=>new Re).as(690).ha();this.W.ia(737,()=>new Ce(Ua,Ra.a.gf.Ll.jf(12),Wb,this.W.resolve(690),this.W.resolve(451),this.W.resolve(731),this.W.resolve(732),y.AFrameworkApplication.oc,this.W.resolve(733),this.W.resolve(337),this.W.resolve(201))).as("Box4.AugmentationLoop.INodeEventHandler<Box4.AParagraphNode>").ha();
ab.a.Zxe()&&this.W.ia(738,()=>new Th(Ua,Ra.a.gf.Ll,Wb)).ha();this.W.ia(1344,()=>new Sa).ha();this.W.ia(735,()=>new Tf(this.W.resolve(71),this.W.Oa(12),this.W.resolve(10),this.W.resolve(17),this.W.resolve(8))).ha();this.W.ia(732,()=>new Za.a(new Ta.a(()=>jg.StaticActiveAppFrame.za().kb.$c.td),this.W.resolve(733))).ha();this.W.ia(731,()=>new vb(this.W.resolve(734),this.W.resolve(336),this.W.resolve(337),this.W.resolve(732),new Ta.a(()=>jg.StaticActiveAppFrame.za().kb.$c.td),ja.resolve(12))).ha();const Rc=
this.W.resolve(723);this.W.ia(451,()=>new id(this.W.resolve(71),this.W.resolve(734),this.W.resolve(733),new Ta.a(()=>jg.StaticActiveAppFrame.za().kb.$c.td),y.AFrameworkApplication.oc,this.W.Oa(336),this.W.Oa(337),this.W.Oa(732),this.W.Oa(731),ja.resolve(12),Fe.a.instance,()=>{try{return Jd.a.hy()}catch(Id){return a.ULS.sendTraceTag(50935320,389,10,"Unable to GetAugLoopRuntimeManager, most likely due to al bundle not being loaded: {0}",Id),null}},Rc)).ha();this.W.ia(736,()=>new hh(new sf.a(this.W.resolve(735)),
new ki)).ha();this.W.ia(739,()=>new tl(Ua,Wb,y.AFrameworkApplication.oc,tc,this.W.resolve(451),this.W.resolve(734),this.W.resolve(736),this.W.resolve(326))).ha();a.ULS.sendTraceTag(39966347,389,50,"TileView<TextTile, AParagraphNode> registered.");this.W.ia(657,()=>new Gi).ha();this.W.ia(658,()=>new zg).ha()}init(){if(y.AFrameworkApplication.LH.BootFailed)a.ULS.sendTraceTag(512624089,389,15,"Cannot initialize Box4 Augmentation Loop package: Boot Failure");else if(y.AFrameworkApplication.J.$("AugLoopOperationsAreEnabled")){a.ULS.sendTraceTag(35190237,
389,50,"Initializing Box4 Augmentation Loop package.");const ja=new kg(this.W.resolve(71),y.AFrameworkApplication.Ee,Ra.a.Fca,this.W.resolve(690),zb.a.instance,this.W.resolve(451)),Ua=new Va;this.W.register(520,1715).ha().Izp(()=>Ua);y.AFrameworkApplication.vd("b8afb343;bjdjj400");const yb=ab.a.Xwn(this.W.resolve(77).JD,this.W.resolve(722),ja,this.W.resolve(641),Ua);this.W.ia("Box4.AugmentationLoop.RuntimeManagerInitializationTracker",()=>new eh(yb)).ha();this.W.resolve(737).init();ab.a.Zxe()&&this.W.resolve(738).init();
this.W.resolve(336).init();this.W.resolve(739)}}dispose(){}static main(ja){Ba.a.instance.Lc(new tj,0,ja);a.ULS.sendTraceTag(35190238,389,50,"Box4 Augmentation Loop package registered.")}}Object(f.a)(tj,"Box4AugmentationLoopPackage",null,[0,1]);var Ni=d(602),bh=d(37),rk=d(11),Qd=d(476),kf=d(1638);class sk{constructor(ja,Ua,yb,Wb=null,tc=null,Rc=null){this.PO=new kf.a(Ua,Wb,tc,Rc);this.Jb=ja;this.Vc=yb}get type(){return this.PO.type}get id(){return this.PO.id}get intent(){return this.PO.intent}Bf(ja){return new sk(ja,
this.type,this.Vc,this.id,this.intent,this.PO.HCa)}toString(){return String.format("Core = [{0}], IsStart = {1}",this.PO,this.Vc)}}Object(f.a)(sk,"IntentObject",null,[159]);var al=d(483),he=d(152),qd=d(254);class hl{constructor(){this.KGc=new he.a}pQd(ja,Ua,yb,Wb,tc=null,Rc=null,Id=null){ja=ja.n_(Ua,ja.ra.xlp(Ua));ja.xk||(ja.xk=new al.a(ja));ja.xk.add(new sk(ja,yb,Wb,tc,Rc,Id));ja.Q$a=!0}NAj(ja){return ja.Jb&&ja.Jb.xk&&ja.Jb.xk.Yjd(Ua=>Ua===ja,[ja.type])?!0:!1}OAj(ja,Ua){if(ja.type===Ua.type&&ja.Vc&&
!Ua.Vc&&ja.Jb&&ja.Jb.xk&&ja.Jb.xk.contains(ja)&&Ua.Jb&&Ua.Jb.xk&&Ua.Jb.xk.contains(Ua)){var yb=[ja.type];ja.Jb.xk.Yjd(Wb=>Wb===ja,yb);Ua.Jb.xk.Yjd(Wb=>Wb===Ua,yb)}}BAp(ja,Ua,yb){if(!Ua)return!1;yb=new qa.a([yb]);for(let Wb=0;Wb<ja.length;Wb++){const tc=ja.K(Wb);if(!tc.xk)continue;let Rc=!0;yb.t0a(tc.xk,void 0,Id=>{Id.id&&Ua.equals(Id.id)&&(Rc=!1)});if(!Rc)return!1}return!0}wbo(ja,Ua,yb,Wb){let tc=null,Rc=null;Ua=new qa.a([Ua]);const Id=ja.ra;for(let Pd=0;Pd<Id.length;Pd++){const Rd=Id.K(Pd);if(!Rd.xk)continue;
let Ue=!0;Ua.t0a(Rd.xk,void 0,(tf,cg)=>{if(cg){var fg=cg.Jb.cp<yb,Mg=tf.Jb.cp>Wb;fg&&tf.Jb.cp<=yb||cg.Jb.cp>=Wb&&Mg||(fg&&Mg?Ue=!1:fg?tc=tf:Mg?Rc=cg:this.OAj(cg,tf))}});if(!Ue)return!1}if(tc){if(!this.NAj(tc))return!1;this.pQd(ja,yb,tc.type,tc.Vc,tc.id,tc.intent,tc.PO.HCa)}if(Rc){if(!this.NAj(Rc))return!1;this.pQd(ja,Wb,Rc.type,Rc.Vc,Rc.id,Rc.intent,Rc.PO.HCa)}return!0}fBg(ja){let Ua;return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TestBox4Ops",!1)?!1:({value:Ua}=
this.KGc.Ac(ja.type,Ua)).returnValue?Ua.fBg(ja):!0}YFn(ja,Ua){if(this.fBg(Ua)){var yb=Ua.id,Wb=Ua.type,tc=Ua.Ec,Rc=Ua.end;if(({cpEnd:Rc}=hl.w9j(ja,tc,Rc)).returnValue){if(Qd.a(Wb)){if(!this.BAp(ja.ra,yb,Wb))return}else if(!this.wbo(ja,Wb,tc,Rc))return;this.pQd(ja,tc,Wb,!0,yb,Ua.intent,Ua.PO.HCa);this.pQd(ja,Rc,Wb,!1,yb,Ua.intent,Ua.PO.HCa)}}}rgd(ja,Ua){jg.StaticActiveAppFrame.za().Izf(ja,()=>{const yb=new bh.GraphTransaction(2);try{yb.Bb(ja);const Wb=ja.I0();try{const tc=ja.G6();try{Ua()}finally{tc&&
tc.dispose()}}finally{Wb&&Wb.dispose()}}finally{yb&&yb.dispose()}})}eYa(ja,Ua){this.rgd(ja,()=>{this.YFn(ja,Ua)})}$Fn(ja,Ua){if(Ua.count){var yb=new cc.a,Wb=new qd.a;for(var tc of Ua){var Rc=tc.value;Qd.a(tc.key)||Rc.Sc((Pd,Rd)=>Pd.Ec!==Rd.Ec?Pd.Ec-Rd.Ec:Pd.end-Rd.end);if(hl.GAp(Rc))for(var Id of Rc)Rc=Id.end,({cpEnd:Rc}=hl.w9j(ja,Id.Ec,Rc)).returnValue&&(Rc=Rc!==Id.end?new gc.a(Id.type,Id.Ec,Rc,Id.id,Id.intent,Id.PO.HCa):Id,yb.add(Rc.Ec),yb.add(Rc.end),hl.jVk(Wb,Rc))}ja.q0d(yb);ja=ja.ra;for(yb=0;yb<
ja.length;yb++){tc=ja.K(yb);if(Id=tc.xk)for(const Rd of Ua.keys)Id.HBj(Rd);let Pd;({value:Pd}=Wb.Ac(tc.cp,Pd)).returnValue||(Pd=null);if(Pd){Id||(Id=tc.xk=new al.a(tc));for(const Rd of Pd)Id.add(Rd.Bf(tc))}tc.Q$a=!0}}}Z6f(ja,Ua){const yb=new he.a;for(const Wb of Ua){let tc;({value:tc}=yb.Ac(Wb.type,tc)).returnValue||(tc=new G.a,yb.Z(Wb.type,tc));tc.add(Wb)}this.rgd(ja,()=>{this.$Fn(ja,yb)})}epp(ja,Ua,yb){ja=ja.ra;const Wb=new qa.a([8]);Ua===yb&&(yb+=1);for(let tc=0;tc<ja.length;tc++){const Rc=ja.K(tc);
Rc.xk&&Wb.t0a(Rc.xk,void 0,(Id,Pd)=>{Pd&&Math.max(Pd.Jb.cp,Ua)<Math.min(Id.Jb.cp,yb)&&this.OAj(Pd,Id)})}}$Jg(ja,Ua,yb){this.rgd(ja,()=>{this.epp(ja,Ua,yb)})}gpp(ja,Ua){ja=ja.ra;for(let yb=0;yb<ja.length;yb++){const Wb=ja.K(yb);Wb.xk&&Wb.xk.HBj(Ua)}}Wzb(ja,Ua){this.rgd(ja,()=>{this.gpp(ja,Ua)})}fpp(ja,Ua,yb){let Wb=!1;Ua=Ua.ra;yb=[yb];for(let tc=0;tc<Ua.length;tc++){const Rc=Ua.K(tc);Rc.xk&&(Wb=Rc.xk.Yjd(ja,yb)||Wb)}return Wb}dsd(ja,Ua,yb){let Wb=!1;this.rgd(Ua,()=>{Wb=this.fpp(ja,Ua,yb)});return Wb}Fjc(ja,
Ua,yb,Wb){return!ja||0>yb||Wb>ja.characterData.length||yb>Wb?new G.a:this.JVa(ja,Ua,tc=>Math.max(tc.Ec,yb)<=Math.min(tc.end,Wb))}JVa(ja,Ua,yb){return hl.oum(ja,Ua,yb)}static oum(ja,Ua,yb){const Wb=new G.a;ja=ja.ra;Ua=new qa.a([Ua]);if(!ja)return Wb;for(let tc=0;tc<ja.length;tc++){const Rc=ja.K(tc);Rc.xk&&Ua.t0a(Rc.xk,void 0,(Id,Pd)=>{Pd&&(Id=new gc.a(Pd.type,Pd.Jb.cp,Id.Jb.cp,Pd.id,Pd.intent,Pd.PO.HCa),yb(Id)&&Wb.add(Id))})}return Wb}O2c(ja,Ua){const yb=new G.a;if(!hl.Iqn(ja.contextId))return yb;
let Wb;const tc=ja.node;ja.contextId!==rk.a.paragraph?(Wb=ja.cpBegin,ja=ja.cpEnd):(Wb=0,ja=tc.characterData.length);yb.addRange(this.Fjc(tc,Ua,Wb,ja));return yb}Bro(ja){this.KGc.lb(0)||this.KGc.Z(0,ja)}static w9j(ja,Ua,yb){ja=Ya.ParagraphReader.textLength(ja);if(Ua>=ja)return{returnValue:!1,cpEnd:yb};yb>ja&&(yb=ja);return{returnValue:!0,cpEnd:yb}}static GAp(ja){if(!ja.count)return!0;const Ua=new Ni.a,yb=ja.K(0).type,Wb=Qd.a(yb);let tc=-1;for(const Rc of ja){if(Rc.type!==yb||(Qd.c(Rc.type)?Rc.Ec>Rc.end:
Rc.Ec>=Rc.end))return!1;if(Wb){ja=Rc.id;if(!ja||ja.equals(Ib.a.nil)||Ua.contains(ja))return!1;Ua.add(ja)}else if(-1===tc)tc=Rc.end;else if(tc>Rc.Ec)return!1}return!0}static jVk(ja,Ua){let yb;({value:yb}=ja.Ac(Ua.Ec,yb)).returnValue||(yb=new G.a,ja.Z(Ua.Ec,yb));yb.add(new sk(null,Ua.type,!0,Ua.id,Ua.intent,Ua.PO.HCa));({value:yb}=ja.Ac(Ua.end,yb)).returnValue||(yb=new G.a,ja.Z(Ua.end,yb));yb.add(new sk(null,Ua.type,!1,Ua.id,Ua.intent,Ua.PO.HCa))}static Iqn(ja){return ja===rk.a.Cd||ja===rk.a.Xc||ja===
rk.a.paragraph}}Object(f.a)(hl,"IntentRangeEditor",null,[535]);class ug{constructor(){this.W=null}get name(){return"Box4.Intent"}uc(ja){this.W=ja;this.W.ia("Box4.Intent.IntentRangeEditor",()=>new hl).as(733).ha()}init(){this.W.resolve(67)}dispose(){}static main(ja){Ba.a.instance.Lc(new ug,0,ja);a.ULS.sendTraceTag(512336855,306,50,"Box4 Intent package registered.")}}Object(f.a)(ug,"PackageManager",null,[0,1]);var Tj=d(999),xk=d(252),ff=d(1273);class Oi{constructor(ja){this.lEn=ja;this.hEn=[]}get handler(){return this.lEn}get csa(){return this.hEn}}
Object(f.a)(Oi,"RegisteredListener",null,[]);class Ph{constructor(ja,Ua){this.type=0;this.payload=null;this.type=ja;this.payload=Ua}}Object(f.a)(Ph,"OfficeSharedCommentsEvent",null,[1756]);class ni{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(f.a)(ni,"ViewContainerEvent",null,[1756]);var Pf=d(581);class Yh{constructor(ja){this.u6f=!1;this.Wta=new G.a;this.jie=ja}Vqo(ja){ja=new Oi(ja);this.Wta.add(ja)}G3j(ja){for(let Ua=0;Ua<this.Wta.count;++Ua)if(this.Wta.K(Ua).handler===
ja){this.Wta.removeAt(Ua);break}}ZZa(ja=!1){const Ua=()=>{if(y.AFrameworkApplication.Sl)a.ULS.sendTraceTag(40420181,201,50,"Skipped processing comment pane events since app is shutting down.");else for(let tc=0;tc<this.Wta.count;++tc){const Rc=this.Wta.K(tc);for(;0<Rc.csa.length;){var yb=Array.dequeue(Rc.csa);if(Object(xk.a)(ni,yb)){var Wb=Rc.handler;Wb(yb)}else Object(xk.a)(Ph,yb)&&(Wb=Rc.handler,Wb(yb.type,yb.payload))}}};ja?Ua():this.u6f||(this.u6f=!0,Pf.a.f6(this.jie,()=>{Ua();this.u6f=!1},ff.a.B9l))}}
Object(f.a)(Yh,"GenericEventHost",null,[]);class Qh{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(f.a)(Qh,"BasicEventPayload",null,[1802]);class fk{constructor(ja){this.nextPopulatedContextDetails=
0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=ja}}Object(f.a)(fk,"CommentContextDetails",null,[]);class km{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}Object(f.a)(km,"ContextChangeWithSelectedThreadIndex",null,[1802]);class gk{constructor(){this.tasks=this.comments=null}}Object(f.a)(gk,"LoadCommentsNoVirtualization",null,[1802]);class Ij extends Yh{constructor(ja){super(ja);
this.vBh=0}SUo(){this.vBh=1656}Iro(ja,Ua,yb,Wb,tc,Rc){ja=new Oi(ja);Rc&&Array.enqueue(ja.csa,this.LBl(Rc,this.vBh));Rc=Ua?Ua.length:0;Array.enqueue(ja.csa,this.f8h(Rc,yb,Wb,0));Rc&&Array.enqueue(ja.csa,this.m9h(Ua,tc));this.Wta.add(ja);this.ZZa()}R1b(ja){this.G3j(ja)}uLo(ja,Ua,yb,Wb=0){this.NRb(this.f8h(ja,Ua,yb,Wb));this.ZZa()}vLo(ja,Ua,yb){this.NRb(this.lCl(ja,Ua,yb));this.ZZa()}ULo(ja,Ua){this.NRb(this.m9h(ja,Ua));this.ZZa()}selectComment(ja){this.NRb(this.l$h(ja,6));this.ZZa()}highlightComment(ja){this.NRb(this.l$h(ja,
7));this.ZZa()}pLg(ja,Ua){this.NRb(this.IFl(ja,Ua));this.ZZa()}rkg(ja,Ua){this.NRb(this.SHl(ja,Ua));this.ZZa()}LBl(ja,Ua=0){const yb=new Qh;yb.modelCapabilityFlags=ja;yb.richTextCapabilityFlags=Ua;return new Ph(12,yb)}f8h(ja,Ua,yb,Wb){const tc=new Qh;tc.numberOfComments=ja;tc.numberOfThreads=Ua;tc.contextDetails=Object.assign(new fk(yb),{nextPopulatedContextDetails:Wb});tc.contextDrafts=null;tc.rehydrationDrafts=null;return new Ph(0,tc)}lCl(ja,Ua,yb){const Wb=new Qh;Wb.comments=ja;Wb.numberOfThreads=
Ua;Wb.tasks=yb;return new Ph(2,Wb)}m9h(ja,Ua){const yb=new gk;yb.comments=ja;yb.tasks=Ua;return new Ph(1,yb)}l$h(ja,Ua){const yb=new Qh;yb.commentId="";ja&&(yb.commentId=ja);return new Ph(Ua,yb)}IFl(ja,Ua){const yb=new Qh;yb.changes=[];yb.contextDetails=Object.assign(new fk(Ua),{nextPopulatedContextDetails:ja});return new Ph(10,yb)}SHl(ja,Ua){const yb=new Qh;yb.commentId=ja;yb.smartReplies=Ua;return new Ph(15,yb)}NRb(ja){for(let Ua=0;Ua<this.Wta.count;++Ua)Array.enqueue(this.Wta.K(Ua).csa,ja)}}Object(f.a)(Ij,
"OfficeSharedCommentsEventHost",Yh,[1792]);var Wl=d(292),lm=d(203),il=d(294);class kn{constructor(){this.u7e=this.Y6g=!1;this.M5=this.sq=this.xlh=this.$rh=this.aPd=this.x9b=this.aGh=this.Fah=this.JD=this.NOc=null}initialize(ja,Ua,yb,Wb=null,tc=null,Rc=null,Id=null,Pd=null,Rd=null,Ue=null){this.JD=ja;this.Fah=Ua;this.aGh=yb;this.x9b=Wb;this.aPd=tc;this.$rh=Rc;this.xlh=Id;this.sq=Pd;this.Y6g=!0;this.M5=Rd;this.NOc=Ue}lbe(ja=null,Ua=null){if(!this.Y6g)return a.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),
new Promise((yb,Wb)=>{Wb(Pf.a.rF(-2130915313))});if(this.u7e)return a.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),new Promise(()=>{});this.NOc||(y.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?this.NOc=appResourceLoader.loadChunk("sharedComments"):this.NOc=this.JD.loadScript("sharedComments"));return this.NOc.then(()=>{ja&&ja();this.u7e||(this.M5&&this.M5.execute(yb=>{yb.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate",
"InitializeFloodgateServiceInCommentsPane")}),Ua&&Ua(),sharedComments.instantiate(this.Fah,this.aGh,this.x9b,this.aPd,this.$rh,this.xlh,this.sq));this.u7e=!0})}}Object(f.a)(kn,"CommentActivationManager",null,[1832]);class Jl extends Yh{constructor(ja){super(ja)}xto(ja){this.Vqo(ja)}aqp(ja){this.G3j(ja)}TOj(ja){ja=this.iCl(ja);for(let Ua=0;Ua<this.Wta.count;++Ua)Array.enqueue(this.Wta.K(Ua).csa,ja);this.ZZa(!0)}iCl(ja){const Ua=new ni;Ua.eventType=3;Ua.viewContainerVisibilityState=ja;return Ua}$9l(){const ja=
this.ZIl();for(let Ua=0;Ua<this.Wta.count;++Ua)Array.enqueue(this.Wta.K(Ua).csa,ja);this.ZZa(!0)}ZIl(){const ja=new ni;ja.eventType=2;return ja}}Object(f.a)(Jl,"ViewContainerEventHost",Yh,[1736]);class Zm{constructor(){this.actionBehavior=this.actionType=0}}Object(f.a)(Zm,"CommentUIActionPayload",null,[]);var bl=d(305);class $m{constructor(ja,Ua){this.GKh=(yb,Wb,tc,Rc,Id)=>{if(this.iCc.lb(yb)){var Pd=this.iCc.K(yb);if(!this.TAb.lb(Pd))return 8;const Rd=this.TAb.K(Pd);if(Rd.preCallback){const Ue=Rd.preCallback(yb,
Wb,tc,Rc,Id);if(2!==Ue)return Ue}if(!Rd.registeredCallback)return 1===tc?8:2;Pd=Object.assign(new Zm,{actionType:Pd});1===tc&&(Pd.actionBehavior=1);Pd=Rd.registeredCallback(Pd);return Rd.postCallback?Rd.postCallback(Pd,yb,Wb,tc,Rc,Id):Pd?32:8}return 2};this.ga=ja;this.TAb=Ua;this.iCc=new bl.a;for(const yb of this.TAb)this.iCc.Z(yb.value.canvasActionId,yb.key),ja=yb.value,ja.delayActionsUntilRegistration||this.qa(ja)}qa(ja){ja.withFlags?this.ga.fb(ja.canvasActionId,ja.canvasContextId,this.GKh,97):
this.ga.qa(ja.canvasActionId,ja.canvasContextId,this.GKh)}xZa(ja,Ua){this.TAb.lb(ja)&&(this.TAb.K(ja).delayActionsUntilRegistration&&this.qa(this.TAb.K(ja)),this.TAb.K(ja).registeredCallback=Ua)}}Object(f.a)($m,"OfficeSharedCommentsActionHost",null,[1793]);var Tk=d(1827),zm=d(80),yk=d(125),Kl=d(1343),li=d(13),Tn=d(23),Uk=d(545),zk=d(1762),Ik=d(68),ig=d(310),ul=d(51),pe=d(16),Ln=d(1020),$h=d(1012),ll=d(1493),zf=d(178),af=d(10),Eg=d(32),Ag=d(704),nb=d(412),Nb=d(20),ec=d(2082);class Hc{constructor(ja){this.ZY=
ja;this.ltc=new Ca.a;this.X9a=new Ca.a;this.B4m();this.bZm=[new ec.a(Eg.a.u3h,Eg.a.Ltl),new ec.a(Eg.a.SVd,Eg.a.Ktl),new ec.a(Eg.a.m3h,Eg.a.ytl),new ec.a(Eg.a.MVd,Eg.a.xtl),new ec.a(Eg.a.v3h,Eg.a.Ntl),new ec.a(Eg.a.TVd,Eg.a.Mtl)]}BZa(ja){this.ZY.BZa(ja);this.Kuo(ja)}yZf(ja,Ua){return!!ja&&!!ja.objectId&&Ua.contains(Ib.a.Cf(ja.objectId))}yXa(ja){ja=Object(T.a)(642,ja);return!!ja&&!!ja.objectId}Kuo(ja){for(const Ua of this.bZm)ja.classList.remove(Ua.className,Ua.E4c);ja.classList.remove(Eg.a.Pjg,Eg.a.VVd,
Eg.a.fpf,Eg.a.UVd,Hc.PPg)}B4m(){const ja=new Ca.a,Ua=new Ca.a;ja.add(0,null);ja.add(1,Eg.a.SVd);ja.add(2,Eg.a.u3h);ja.add(3,Eg.a.VVd);Ua.add(0,null);Ua.add(1,Eg.a.MVd);Ua.add(2,Eg.a.m3h);Ua.add(3,Eg.a.fpf);this.X9a.Z(1,ja);this.X9a.Z(2,Ua);this.X9a.Z(3,Ua);this.ltc.add(0,null);this.ltc.add(1,Eg.a.TVd);this.ltc.add(2,Eg.a.v3h);this.ltc.add(3,Eg.a.UVd)}}Hc.PPg="CommentImportant";Object(f.a)(Hc,"CommentHighlightUtils",null,[]);class Tc{constructor(){this.Q_d=0;this.BLb=null}}Object(f.a)(Tc,"CommentGuidsInElementInfo",
null,[]);class xd{constructor(){this.XLi=!1;this.jra=this.FWb=null;this.aZa=this.iRb=0}}Object(f.a)(xd,"HighlightInfoForElement",null,[]);class ld{constructor(){this.tPi=this.vPi=this.uPi=-1;this.vNi=[];this.Dec=[];this.D6c=this.E6c=-1;this.FUi=!1}}Object(f.a)(ld,"HighlightInfoForElementsInPara",null,[]);class Ed{constructor(){this.WJg=this.Veg=null}}Object(f.a)(Ed,"OnAnchorMouseOutData",null,[]);var Zd=d(1380);class If{constructor(ja,Ua,yb,Wb,tc,Rc,Id,Pd){this.AMe=ja;this.Zca=Ua;this.gl=yb;this.n5=
Wb;this.ga=tc;this.Gb=Rc;this.Gj=Id;this.w3a=this.Fj=null;this.jTn=Rd=>{if(!this.Fj||this.n5.wde)return!0;if(Rd=Rd.rq){if(this.Fj.eB&&Rd[0].toString()===this.Fj.eB.objectId)return!0;this.w3a&&Rd[0].equals(this.w3a.WJg[0])?this.Gb.uf(this.w3a.Veg):(this.w3a&&(this.Gb.uf(this.w3a.Veg),this.ga.Pb(li.a.WVd,2,this.w3a.WJg)),this.Fj.Ep.GUi(Rd[0])&&!this.Gj.en||this.ga.Pb(li.a.ipf,2,Rd));this.w3a=null}return!0};this.iTn=Rd=>{if(this.n5.wde)return!0;const Ue=Rd.rq;Ue&&(Rd=new bb.a(2,1,0,()=>{this.ga.Pb(li.a.WVd,
2,Ue);this.w3a=null}),this.Gb.Zb(Rd),this.w3a=Object.assign(new Ed,{Veg:Rd,WJg:Ue}));return!0};this.pij=Rd=>{const Ue=new bb.a(2,1,0,()=>{if(this.Fj&&!this.Fj.Ep.Vy){var tf=Rd.rq;if(!tf)tf=jg.StaticActiveAppFrame.za().oq.currentScope,this.Fj.eB&&(!tf||tf.name!==zf.AFrame.lR&&tf.name!==zf.AFrame.zt)&&this.Fj.clearSelection();else if(!this.Fj.eB||tf.toString()!==this.Fj.eB.objectId)if(tf=this.Fj.Ep.I2(tf.toString()))tf=Object.assign(new Kl.a,{commentId:tf.id,g4:!1,kca:1}),this.ga.Pb(Nb.a.selectComment,
2,tf)}});this.Gb.Zb(Ue);return!1};Pd.execute(Rd=>{this.Fj=Rd})}qWh(ja,Ua,yb,Wb){const tc=new ld,Rc=[],Id=this.Zca.yXa(Ua)?Ua.objectId:null;for(let Ue=0,tf=ja.length;Ue<tf;Ue++){var Pd=ja[Ue],Rd=Zd.g(Pd);const cg=Zd.d(Pd);Pd=new Ni.a;const fg=new xd;if(Rd){const Mg=new nb.a(Zd.c);Rd=this.qmi(Rd,Id,Mg);0<Rd.length&&(this.Jtp(Rd,yb,Pd,fg,Id,Wb),Rc.push(Object.assign(new Tc,{Q_d:Ue,BLb:Mg})))}cg&&(Rd=this.qmi(cg,Id),0<Rd.length&&(this.Ltp(Rd,yb,Pd,fg,tc,Id,Wb,Ue),this.$rp(Rc,Rd,Ue,fg)));0<yb.count&&this.Mtp(Ua,
yb,fg,Wb);this.Yrp(Rc,fg);tc.vNi.push(fg)}return tc}KRh(ja,Ua,yb){let Wb=!1;for(let tc=0,Rc=ja.length;tc<Rc;tc++){const Id=ja[tc],Pd=Ua.vNi[tc],Rd=Ag.a(Id);if(1!==Rd&&2!==Rd&&3!==Rd)continue;const Ue=3===Rd||2===Rd&&-1!==Id.className.indexOf(Eg.a.xWa);this.Zca.BZa(Id);this.lWk(Id,Pd,Ue,Wb);this.NUk(Id,tc,Rd,Pd,Ua,yb);this.OUk(Id,tc,Ua,Pd);Wb=Ue}}qmi(ja,Ua,yb=null){const Wb=[];for(let tc=0;tc<ja.length;tc++)this.AMe.pQj(ja[tc],ja[tc].toString()===Ua)&&(Wb.push(ja[tc]),yb&&yb.add(ja[tc]));return Wb}Jtp(ja,
Ua,yb,Wb,tc,Rc){var Id;let Pd=!1,Rd=!1;for(const tf of ja){Ua.add(tf);yb.add(tf);var Ue=tf.toString();Ue===tc?(Ue=Rc?1:2,Wb.aZa=Ue,Wb.iRb=Ue):this.yZf(this.Fj.eB,Ua)&&(Ue===(null===(Id=this.Fj.eB)||void 0===Id?void 0:Id.objectId)&&(Rd=!0),Pd=!0)}0<ja.length&&!Wb.aZa&&(Wb.aZa=Rd?1:3,Wb.iRb=Pd?1:3)}Ltp(ja,Ua,yb,Wb,tc,Rc,Id,Pd){var Rd,Ue;const tf=new nb.a(Zd.c);Id=Id?1:2;let cg=!1;for(const fg of ja){const Mg=fg.toString();Ua.contains(fg)||(Mg===Rc?tc.tPi=Pd:(tc.uPi=Pd,Wb.aZa=3,(null===(Rd=this.Fj.eB)||
void 0===Rd?void 0:Rd.objectId)===Mg&&(tc.vPi=Pd,Wb.aZa=1)),tf.add(fg));Mg===(null===(Ue=this.Fj.eB)||void 0===Ue?void 0:Ue.objectId)&&(cg=!0);Ua.remove(fg);yb.contains(fg)&&this.Ktp(Wb,fg,Mg,Rc,Id);Mg===Rc&&(Wb.aZa=Id)}0<ja.length&&!Wb.aZa&&(Wb.aZa=cg?1:3);0<tf.count&&tc.Dec.push(Object.assign(new Tc,{Q_d:Pd,BLb:tf}))}$rp(ja,Ua,yb,Wb){0!==ja.length&&(Ua.forEach(tc=>{for(let Rc=ja.length-1;0<=Rc;Rc--){const Id=ja[Rc];if(Id.BLb.contains(tc)){Id.Q_d===yb&&(Wb.jra?Wb.jra.push(tc):Wb.jra=[tc]);Id.BLb.remove(tc);
break}}}),ja=ja.filter(tc=>0<tc.BLb.count))}Mtp(ja,Ua,yb,Wb){var tc,Rc;this.yZf(ja,Ua)?yb.iRb=Wb?1:2:yb.iRb||(yb.iRb=null!=(null===(tc=this.Fj.eB)||void 0===tc?void 0:tc.objectId)&&Ua.contains(Ib.a.Cf(null===(Rc=this.Fj.eB)||void 0===Rc?void 0:Rc.objectId))?1:3);yb.FWb||(yb.FWb=[]);for(const Id of Ua)yb.FWb.push(Id)}Yrp(ja,Ua){if(0<ja.length){Ua.jra||(Ua.jra=[]);for(const yb of ja[ja.length-1].BLb)Ua.jra.push(yb)}}Ktp(ja,Ua,yb,Wb,tc){ja.XLi=!0;ja.FWb||(ja.FWb=[]);ja.FWb.push(Ua);yb===Wb&&(ja.iRb=
tc)}yZf(ja,Ua){return!!ja&&!!ja.objectId&&Ua.contains(Ib.a.Cf(ja.objectId))}lWk(ja,Ua,yb,Wb){!Ua.aZa||yb||Wb||((yb=this.Zca.ltc.K(Ua.aZa))&&ja.classList.add(yb),Ua.XLi&&ja.classList.add(Eg.a.Pjg))}NUk(ja,Ua,yb,Wb,tc,Rc){Wb=this.Zca.X9a.K(yb).K(Wb.iRb);Ua<tc.tPi?Wb=Rc?this.Zca.X9a.K(yb).K(1):this.Zca.X9a.K(yb).K(2):Ua<tc.uPi&&!Wb&&(Wb=Ua<tc.vPi?this.Zca.X9a.K(yb).K(1):this.Zca.X9a.K(yb).K(3));Wb&&(Ua=tc.FUi,ja.classList.add(Wb),Ua&&ja.classList.add(Hc.PPg))}OUk(ja,Ua,yb,Wb){Wb.jra||(Wb.jra=this.Tjm(Ua,
yb)||Wb.FWb);Ua=null;Wb.jra&&0<Wb.jra.length&&(this.gl.nb(af.a.y3,ja,this.jTn,Wb.jra),this.gl.nb(af.a.wCa,ja,this.iTn,Wb.jra),Ua=Wb.jra[0]);this.gl.nb(af.a.click,ja,this.pij,Ua);this.gl.nb(af.a.jM,ja,this.pij,Ua)}Tjm(ja,Ua){for(;0<Ua.Dec.length&&Ua.Dec[0].Q_d===ja;)Ua.Dec.splice(0,1);if(0<Ua.Dec.length){ja=[];for(const yb of Ua.Dec[0].BLb)ja.push(yb);return ja}return null}}Object(f.a)(If,"AllMarkupModeHighlightChangeHandler",null,[636]);var qg=d(1347);class ch extends qg.a{constructor(ja){super(100,
25);this.gCc=new Ca.a(0);this.Vkk=6E4;this.w9l=()=>{const Ua=this.gCc.keys;if(Ua.length){var yb="";for(let Wb=0;Wb<Ua.length;Wb++)yb+=Ua.K(Wb)+":"+this.gCc.K(Ua.K(Wb))+";";this.Lua(yb);this.gCc=new Ca.a(0)}};this.cBb=new G.a;this.cBb.add(1);this.cBb.add(6);this.cBb.add(2);this.cBb.add(4);this.cBb.add(10);this.cBb.add(11);this.sj=ja;ja.lpg&&window.setInterval(this.w9l,this.Vkk)}gNa(ja){this.sj.Nnp&&this.sj.lpg&&(this.cBb.contains(ja)?this.Elo(ja):this.Lua(ja+""))}Elo(ja){this.gCc.Z(ja,this.gCc.Q2(ja,
0)+1)}}Object(f.a)(ch,"CommentActionInTypingRecorder",qg.a,[649]);var mk=d(1547),qj=d(236);class ne{static Zvo(ja){ja&&ja.atmention&&delete ja.atmention.isCurrentUser;return ja}}Object(f.a)(ne,"DeltaFormatHelpers",null,[]);class Se{constructor(){this.optional=this.attributes=null}}Object(f.a)(Se,"Operation",null,[]);class aj extends Se{constructor(){super();this.insert=null}}Object(f.a)(aj,"DeltaOperation",Se,[]);class te{constructor(){this.ops=null}}Object(f.a)(te,"Delta",null,[]);var hk=d(1095),
ak=d(722),lj=d(462),bm=d(165),Oa=d(148),kc=d(53),Oc=d(82),Cd=d(101),Ve=d(499),Fd=d(59),pa=d(1132),Hb=d(1545);class Ob extends Hb.ACommentFormatTranslator{constructor(ja,Ua,yb){super(ja,yb);this.we=Ua}PHg(ja){const Ua=new mk.a;for(let yb=0;yb<ja.length;yb++){const Wb=ja[yb];Wb.qSb=!0;this.H4k(Ua,Wb);Ua.Ala("\n")}return[Ua.jjc()]}Fhp(ja,Ua){ja=mk.a.rqb(ja[0]);ja=this.btj(ja);const yb=new G.a;let Wb=0,tc=null,Rc=null;for(;Wb<ja.ops.length;){const Id=ja.ops[Wb];tc||(tc=pa.a.instance.createInstance(Fd.a.paragraphNode),
tc.qSb=!0,tc.Ag(ib.a.Yc,qj.a.OF()),Ua(tc),tc.ra.clear(),tc.kva(""));"\n"===Id.insert?(Rc=this.s4f(tc,Rc),this.sXo(tc),yb.add(tc),tc=null):Rc=this.hyn(tc,Id,Rc);Wb++}return yb.toArray()}yhp(ja){ja=mk.a.rqb(ja[0]);ja=this.btj(ja);let Ua=0;const yb=new hk.a(new ak.a);for(;Ua<ja.ops.length;){var Wb=ja.ops[Ua];if("\n"===Wb.insert)Wb={2:"para"},Wb[ib.a.Yc.toString()]=qj.a.OF(),yb.HRc(new hk.b("para_"+Ua,new lj.a(yb.getLength()),new ak.b(Wb)));else{const tc=this.aGm(Wb.attributes);yb.iD(new lj.a(yb.getLength()),
Wb.insert,new ak.b(tc))}Ua++}return yb}sXo(ja){const Ua=ja.eYh();for(let yb=0;yb<Ua;yb++)ja.se.Gq.Z(yb,Ob.qNn),ja.se.Lt.Z(yb,Ob.Gag)}s4f(ja,Ua){var yb=ja.p0d();yb.cp===ja.characterData.length?yb.ni=!0:(yb=Object.assign(new bm.a(ja,ja.characterData.length),{ni:!0}),ja.ra.add(yb));yb=ja.ra.last;if(Ua){Ua=!!Ua.Dw;const Wb=this.R4h(ja,yb,!Ua,Ua,null);yb.formatting=Wb;Ua&&(ja=this.P4h(ja,yb),yb.jX=ja.Ek);yb.pn=!0;Ua=null}yb.cp||yb.formatting||(yb.formatting=new Oa.a(yb,Ib.a.nil));return Ua}hyn(ja,Ua,yb){const Wb=
ja.p0d(),tc=!!Ua.attributes&&!!Ua.attributes.link,Rc=!!Ua.attributes&&!!Ua.attributes.atmention,Id=this.R4h(ja,Wb,tc,Rc,Ua);Wb.formatting=Id;yb&&(yb.Dw&&(yb=this.P4h(ja,Wb),Wb.jX=yb.Ek),Wb.pn=!0,yb=null);if(tc||Rc)this.Dxn(Wb,ja,Ua),yb=Wb.hyperlink;ja.kva(ja.characterData+Ua.insert);return yb}P4h(ja,Ua){Ua=new Oa.a(Ua,Ib.a.create());let yb=this.RXd();yb.setValue(ib.a.pTb,!0);yb=ja.Ic.IP(yb);Ua.Ek=yb.id;return Ua}R4h(ja,Ua,yb,Wb,tc){Ua=new Oa.a(Ua,Ib.a.create());let Rc=pa.a.instance.createInstance(Fd.a.s_a);
if(yb||Wb)Rc.setValue(Jf.a.mE,!0),Rc.setValue(Jf.a.gba,!0),yb&&this.SOo(ja,Rc);tc&&tc.attributes&&this.TUo(tc.attributes,Rc);Rc=ja.Ic.IP(Rc);Ua.Ek=Rc.id;return Ua}SOo(ja,Ua){(ja=this.we.AF(ja))&&(ja=ja.lh(kc.StyleReader.$Ac))&&Ua.setValue(xg.a.Fw,ja.id)}TUo(ja,Ua){this.w_b(ja.weight>=mk.a.Jcd,Ua,Jf.a.bold,!0);this.w_b(ja.italic,Ua,Jf.a.italic,!0);this.w_b(ja.underline,Ua,Jf.a.underline,!0);this.w_b(ja.underline,Ua,Jf.a.underlineType,Je.a.Tzb);this.w_b(ja.strikethrough,Ua,Jf.a.strikethrough,!0);if(Oc.a.yTb(ja.highlight)){var yb=
Oc.a.nWa(ja.highlight);this.w_b(!!ja.highlight,Ua,Jf.a.highlight,Oc.a.eca(yb))}Oc.a.yTb(ja.color)&&(yb=Oc.a.nWa(ja.color),this.w_b(!!ja.color,Ua,Jf.a.fontColor,Oc.a.eca(yb)))}aGm(ja){const Ua={};if(ja){ja.weight>=mk.a.Jcd&&(Ua["1647"]="1",Ua["1649"]="1");ja.italic&&(Ua["1651"]="1",Ua["1653"]="1");ja.underline&&(Ua["1695"]="single");ja.strikethrough&&(Ua["1659"]="1");if(Oc.a.yTb(ja.highlight)&&ja.highlight){const yb=Oc.a.nWa(ja.highlight);Ua["1693"]=Oc.a.eca(yb)}Oc.a.yTb(ja.color)&&ja.color&&(ja=Oc.a.nWa(ja.color),
Ua["1677"]=Oc.a.eca(ja))}return Ua}w_b(ja,Ua,yb,Wb){ja&&Ua.setValue(yb,Wb)}Dxn(ja,Ua,yb){if(yb.attributes&&yb.attributes.atmention){var Wb=Cd.a.uKa(yb.attributes.atmention.email);yb=yb.optional&&yb.optional.atmention&&yb.optional.atmention.contentId?yb.optional.atmention.contentId:Ob.vcm(1===yb.attributes.atmention.resolveState);Wb=new Ve.a(ja,Wb,!0,void 0,void 0,void 0,yb);this.$Al(Wb,Ua.Ic);ja.hyperlink=Wb}else Ua=Cd.a.uKa(yb.attributes.link),Wb=this.$Dl(ja.paragraph.ra.first),ja.hyperlink=new Ve.a(ja,
Ua,!1,Wb.Ek)}$Dl(ja){let Ua=this.b$h();Ua=ja.paragraph.Ic.IP(Ua);ja=new Oa.a(ja,Ib.a.nil);ja.Ek=Ua.id;return ja}$Al(ja,Ua){var yb=String.format(' HYPERLINK "{0}"',ja.url),Wb=ja.Dw;const tc=this.RXd();tc.setValue(ib.a.ft,15);tc.setValue(ib.a.Dw,Wb);tc.setValue(ib.a.vXa,!0);tc.setValue(ib.a.E2,yb);ja.Mya(Ua.IP(tc).id);Wb=this.RXd();Wb.setValue(ib.a.ft,47);Wb.setValue(ib.a.E2,yb);ja.Mya(Ua.IP(Wb).id);yb=this.RXd();yb.setValue(ib.a.ft,16);ja.Mya(Ua.IP(yb).id)}b$h(){const ja=pa.a.instance.createInstance(Fd.a.s_a);
ja.setValue(Jf.a.mE,!0);ja.setValue(Jf.a.gba,!0);ja.setValue(Jf.a.isHidden,!0);return ja}RXd(){const ja=this.b$h();ja.setValue(Jf.a.Eca,!0);return ja}btj(ja){const Ua=new G.a;for(let yb=0;yb<ja.ops.length;yb++){const Wb=ja.ops[yb];Wb.optional=ne.Zvo(Wb.optional);if(-1!==Wb.insert.indexOf("\n")&&"\n"!==Wb.insert){const tc=Wb.insert.split("\n");for(let Rc=0;Rc<tc.length;Rc++)if(yb!==ja.ops.length-1||Rc!==tc.length-1||tc[Rc])Ua.add(Object.assign(new aj,{insert:tc[Rc],attributes:Wb.attributes,optional:Wb.optional})),
Rc!==tc.length-1&&Ua.add(Object.assign(new aj,{insert:"\n"}))}else Ua.add(Wb)}return Object.assign(new te,{ops:Ua.toArray()})}static vcm(ja){return Hb.ACommentFormatTranslator.R8k+ta.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+(ja?"Z":"")}}Ob.qNn=0;Ob.Gag=0;Object(f.a)(Ob,"CommentDeltaFormatTranslator",Hb.ACommentFormatTranslator,[]);var Dc=d(1671),nd=d(1497);class Od{get userPrincipalName(){return this.J.ib("UserPrincipalName")}constructor(ja,Ua,yb,Wb,tc){this.xj=ja;this.J=Ua;
this.TH=yb;this.Qg=Wb;this.kY=tc}yF(ja){return this.xj.yF(ja)}Ocn(ja){ja=this.xj.yF(ja);return ja?!ja.done:(a.ULS.sendTraceTag(521426529,327,10,"CommentFilterActor : Comment Not in Model. "),!1)}n8c(ja){return this.xj.n8c(ja)}isCurrentUserMentioned(ja){var Ua,yb;ja=this.xj.Ijm(ja);for(const Wb of ja){if(!Wb.text||0===Wb.text.length)continue;ja=mk.a.rqb(Wb.text[0]);let tc=0;for(;ja.ops&&tc<ja.ops.length;){const Rc=null===(yb=null===(Ua=ja.ops[tc])||void 0===Ua?void 0:Ua.attributes)||void 0===yb?void 0:
yb.atmention;if(Rc&&Rc.email===this.userPrincipalName)return!0;tc++}}return!1}qed(){this.TH.R3("OnContentFilterUpdate")}Kha(){var ja;this.Qg.en&&(null===(ja=this.kY)||void 0===ja?void 0:ja.execute(Ua=>Ua.logActivity("WordWebCommentFilterActivity","CommentFilterFpsIsEnabled")))}}Object(f.a)(Od,"CommentFilterActor",null,[646]);var ye=d(138),Oe=d(2075),Cf=d(883),Bg=d(596);class Zg{constructor(ja,Ua,yb,Wb,tc,Rc,Id,Pd,Rd){this.xi=ja;this.Gb=Ua;this.kj=yb;this.X0a=Wb;this.Gj=tc;this.f1=Rc;this.Ih=Id;this.BW=
Pd;this.lS=Rd;this.qDb=null;this.x$e=0;this.DEd=!1;this.cJd=0;this.$1b=this.Zod=this.I$g=this.iJc=this.hJb=!1;this.qAc=()=>{this.BW.JBg()&&this.Ih.qAc(this.DEd,this.Dgg)};this.evb=()=>{this.Ih.wqa.qta()&&(this.mjd(this.Ih.wqa.Jc),this.Ih.wqa.Iuc(this.evb))};this.Dgg=()=>{this.sfb();this.BW.Cgg()};this.EEg=()=>{!this.hJb&&this.BW.WAg()&&(this.cJd=this.zbf.scrollTop,this.hJb=!0,this.X0a.gNa(2))};this.xpg=(Ue,tf)=>{this.hJb&&(Ue=this.zbf.scrollTop,Ue-this.cJd?(this.iJc||tf.oFe||this.updatePosition(),
this.iJc||1!==tf.oFe||this.sfb(),this.dgf(Ue),this.BW.zfg()):this.iJc=this.hJb=!1)};this.zbf=this.Ih.Rha;this.Hma=Bg.a.Yne;this.nu=this.Ih.nu;this.Ih.F4h()}get bde(){return this.BW.I_f()}get Hma(){return this.Ih.Hma}set Hma(ja){this.Ih.Hma=ja}get CSh(){return"1"===this.nu.gH.style.opacity}CPj(ja){this.Zod||(this.Zod=!0,this.Ih.tsj(),this.qDb=ja(this.nu.xla,this.Ih.xBj,()=>{this.updatePosition()}),this.Ih.Y8i(this.qDb),this.BW.initialize(this.qDb,this),this.Ih.initialize(this.qDb,this.BW.gvb),this.Ih.Vyj(),
this.Ih.wPj(),this.Ih.xPj(),this.Ih.BPj(this.BW.yjf,this.BW.Tme,this.BW.Sme),this.iqg())}Wnd(){}Uxe(){return this.Ih.tQj()}setInitialActiveContainerId(ja,Ua,yb=null){this.Ih.setInitialActiveContainerId(ja,0,yb)}updatePosition(){if(!this.$1b&&this.bde&&this.xi.mBa()){var ja=la.a.Ge()-this.x$e<Bg.a.Z6j;ja||this.DEd||this.sfb(ja)}}zif(){this.sfb()}$Za(ja,Ua,yb){this.f1.R3("OnFloatingCommentsVisibilityChange",!0);this.Ih.$Za(ja,Ua,yb)}dJa(ja,Ua,yb=!1){this.Ih.dJa(ja,Ua,()=>{this.xi.c5c()||this.Ih.w$d();
this.BW.Edg()},yb)}Rbc(ja,Ua,yb){this.Ih.Rbc(ja,Ua,yb,this.Ih.ij,this.BW.g3c,this.BW.mcg)}Uqj(ja){this.$1b=!0;ja();this.$1b=!1}kkd(ja,Ua,yb){this.Ih.kkd(ja,Ua,yb)}pec(){this.Ih.pec()}w7j(){const ja="1"===this.nu.gH.style.opacity;switch(!0){case ja&&!this.xi.c5c():this.Ih.w$d();break;case !ja&&this.xi.c5c():this.Ih.r0b()}}cIg(ja=!0){this.BW.DBg&&this.Ih.N_j(ja)}static Gvi(ja,Ua=null){const yb=new Xb.a;for(const Wb of ja)Wb.Of||Wb.Fr!==Oe.a.VD&&(!Ua||Ua(Wb))&&Zg.wTk(yb,Wb.objectId,Wb);return yb}static wTk(ja,
Ua,yb){let Wb;({value:Wb}=ja.Ac(Ua,Wb)).returnValue||(Wb=[],ja.Z(Ua,Wb));Wb.push(yb)}mjd(ja){ja&&(ja.g6(()=>{this.qAc()}),this.cJd=this.zbf.scrollTop,ja.QOh(this.EEg),ja.ROh(this.xpg))}iqg(){this.Ih.ij?this.mjd(this.Ih.ij):this.Ih.wqa?this.Ih.wqa.jcc(this.evb):a.ULS.sendTraceTag(523011085,327,15,"Workspace undefined, failed to register page view handlers")}dgf(ja){this.nu.gH.style.top=ja-this.cJd+"px";this.iJc=!1}sfb(ja=!1){ja=new bb.a(0,1,0,()=>{this.Axf()},129,void 0,!ja);this.Gb.Zb(ja);this.DEd=
!0;this.iJc=this.hJb;this.X0a.gNa(10)}CLf(ja){return this.Ih.mUa({contentAnchorPositions:ja.contentAnchorPositions})}Axf(){this.DEd=!1;if(this.nu.xla&&this.qDb&&this.xi.mBa()){this.Ih.E0d();var ja=0;this.kj.$d(()=>{ja=this.Ih.d5d()},"FCM:UP:GET");var Ua=null,yb=null;this.kj.$d(()=>{const Wb=this.BW.dui(ja,this.Ih.ij);Ua=Wb.yul;yb=this.CLf(Wb)},"FCM:UP:GP");this.kj.$d(()=>{this.hJb?(this.Ih.Mhi(yb),this.hJb=!1):this.qDb.emitEvent(3,yb);this.f1.Zre()},"FCM:UP:RC");this.qDb.setFirstCommentRenderDone();
"0"===this.nu.gH.style.opacity&&0<Ua.count&&!this.Gj.en&&this.Gj.YNa&&this.kj.$d(()=>{this.Ih.r0b()},"FCM:UP:SFC");!this.I$g&&0<Ua.count&&(Pf.a.f6(this.Gb,this.Ih.u9i,ff.a.t9i),this.I$g=!0);this.x$e=la.a.Ge();this.X0a.gNa(6)}else this.x$e=la.a.Ge()}}Object(f.a)(Zg,"FloatingCommentManager",null,[566,567]);var Qg=d(126),Sg=d(1348),Qk;(function(ja){ja[ja.Whq=0]="singleHint";ja[ja.e$p=1]="multiHint";ja[ja.gfq=2]="resolvedHint";ja[ja.f$p=3]="multiResolvedHint";ja[ja.entryPoint=4]="entryPoint";ja[ja.unknown=
void 0]="unknown"})(Qk||(Qk={}));Object(f.b)("CommentIconType",Qk);var bk=d(151),df=d(1092);const fc={[1]:"CommentMultiHintIcon_16",[0]:"CommentHintIcon_16",[2]:"CommentResolvedHintIcon_16",[3]:"CommentResolvedMultiHintIcon_16",[4]:"NewCommentMarginEntrypoint_16",[Qk.unknown]:""},vd={[0]:["OfficeIconColors_mCommentHintIconCenter","OfficeIconColors_mCommentHintIconBorder"],[1]:["OfficeIconColors_mCommentMultiHintIconCenter","OfficeIconColors_mCommentMultiHintIconBorder"],[2]:["OfficeIconColors_mCommentResolvedHintIconCenter",
"OfficeIconColors_mCommentResolvedHintIconBorder","OfficeIconColors_mCommentResolvedHintIconStamp"],[3]:["OfficeIconColors_mCommentResolvedMultiHintIconCenter","OfficeIconColors_mCommentResolvedMultiHintIconBorder","OfficeIconColors_mCommentResolvedMultiHintIconStamp"],[4]:[],[Qk.unknown]:[]},Uc=(ja,Ua)=>{switch(ja){case "OfficeIconColors_mCommentHintIconCenter":case "OfficeIconColors_mCommentMultiHintIconCenter":case "OfficeIconColors_mCommentResolvedHintIconCenter":case "OfficeIconColors_mCommentResolvedMultiHintIconCenter":switch(Ua){case 3:return df.a.B3h;
case 2:return df.a.C3h;case 1:return df.a.D3h}break;case "OfficeIconColors_mCommentHintIconBorder":case "OfficeIconColors_mCommentMultiHintIconBorder":case "OfficeIconColors_mCommentResolvedHintIconBorder":case "OfficeIconColors_mCommentResolvedMultiHintIconBorder":switch(Ua){case 3:return df.a.y3h;case 2:return df.a.z3h;case 1:return df.a.A3h}break;case "OfficeIconColors_mCommentResolvedHintIconStamp":case "OfficeIconColors_mCommentResolvedMultiHintIconStamp":switch(Ua){case 3:return df.a.E3h;case 2:return df.a.F3h;
case 1:return df.a.G3h}}},ze=(ja,Ua)=>{bk.a("renderIcon")&&appChrome.api.renderIcon(ja,Ua)};class Gd{}Gd.xNi=16;Gd.pZm=1;Gd.ETf=20;Gd.bbk=2;Object(f.a)(Gd,"CommentIconConstants",null,[]);class Ej{constructor(){this.NVd=0;this.HSc=!1}}Object(f.a)(Ej,"CommentHintCensus",null,[]);class bd{constructor(ja,Ua,yb,Wb,tc){this.Jah=ja;this.wbc=yb;this.xrk=Wb;this.Vja=tc;this.aTa=-1;this.zMe=new Set(Ua)}get y(){if(-1!==this.aTa)return this.aTa;const ja=Sys.UI.DomElement.getBounds(this.Jah),Ua=this.Jah.getClientRects();
return this.aTa=0<Ua.length&&Ua[0]?this.xrk?ja.y/this.wbc+Gd.bbk:Math.floor(Ua[0].height)/(2*this.wbc)+ja.y/this.wbc-Gd.xNi/2:0}get RVd(){return Array.from(this.zMe)}OXk(ja){this.zMe=new Set([...this.zMe,...ja])}}Object(f.a)(bd,"HintInfo",null,[663]);class gg extends Sg.a{constructor(ja,Ua,yb,Wb,tc,Rc,Id,Pd,Rd,Ue,tf,cg,fg,Mg){super();this.sj=ja;this.Dg=Ua;this.gl=yb;this.cG=Wb;this.ga=tc;this.xi=Ue;this.xwa=tf;this.X0a=cg;this.Gj=fg;this.Wok=Mg;this.uxd=new Map;this.RDb=this.HHb=null;this.qzc={Ezb:-1,
Yag:-1}}u_a(ja){let Ua=!1;Ra.a.oak&&ja.jc.gj?va.a.instance.$d(()=>{Ua=Zd.n(ja,!0)},"CHA:SCIVE"):va.a.instance.$d(()=>{Ua=Zd.m(ja.htmlElement,!0)},"CHA:SCI");return Ua}kUa(ja){const Ua=this.zoom,yb=ja.H3,Wb=ja.TKa;let tc=0;for(let Pd=0;Pd<ja.m7.length;Pd++)if(0<ja.m7[Pd].width){tc=Pd;break}const Rc=ja.j6a(1,Gd.ETf,Ua,tc);this.X0a.gNa(1);let Id=[];Wb.forEach((Pd,Rd)=>{const Ue=ja.m7[Rd].y/Ua;Pd=this.pEl(this.Dsm(Pd,Rd),tf=>this.aEl(yb,tf,tf.y-Ue,Rc),()=>gg.eGl(yb));Id=Id.concat(Pd)});return Id}pEl(ja,
Ua,yb){yb=yb();const Wb=[];for(const tc of ja){ja=Ua(tc);for(const Id of tc.RVd)this.uxd.set(Id.toString(),ja);const Rc=this.uBi(tc.RVd);this.K5j(Rc,ja);null==yb.Vja&&(yb.Vja=tc.Vja);yb.appendChild(ja);Wb.push(ja)}this.ylc(this.RDb);this.Drb(this.HHb);return[yb]}uBi(ja){var Ua,yb;let Wb=0,tc=0;for(const Rc of ja)if(this.xi.IZf(Rc)){if(this.sj.contentFilterApiEnabled&&this.Gj.en&&(ja=this.xi.I2(Rc.toString()),null===(yb=(Ua=this.Wok).isContentInFilteredContent)||void 0===yb||!yb.call(Ua,ja.id)))continue;
this.xi.GUi(Rc)?tc+=1:Wb+=1}Ua=new Ej;Ua.NVd=Wb+tc;Ua.HSc=0===Wb;return Ua}fAc(ja){if(ja=this.uxd.get(ja.objectId)){var Ua=Zd.g(ja);Ua=this.uBi(Ua);this.K5j(Ua,ja)}}K5j(ja,Ua){let yb,Wb;if(this.sj.contentFilterApiEnabled&&0===ja.NVd)Ua.style.display="none";else if(1===ja.NVd?(yb=ja.HSc?2:0,Wb=ja.HSc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleActiveLabel):1<=ja.NVd&&(yb=ja.HSc?3:1,Wb=ja.HSc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiResolvedLabel:
WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiActiveLabel),Ua.style.display="block",ja=Ua.firstElementChild)this.zRo(ja,yb),ja.title=Wb+". "+ja.title,ze(fc[yb],ja)}zRo(ja,Ua){ja.title=WordEditorIntl.WordEditorStrings.L_CommentHintIcon_UserActionStatement;Qg.a.Dm(ja,gg.H3h,Ua)}Dsm(ja,Ua){ja=this.bEl(ja,Ua);ja.sort((yb,Wb)=>yb.y-Wb.y);return this.IIn(ja)}bEl(ja,Ua){const yb=[],Wb=this.sj.Jr,tc=this.zoom;ja=Zd.f(ja,!0);for(let Rc=0,Id=ja.length;Rc<Id;Rc++){const Pd=ja[Rc],Rd=Zd.g(Pd);Rd&&yb.push(new bd(Pd,
Rd,tc,Wb,Ua))}return yb}IIn(ja){let Ua=null;const yb=[];for(let Wb=0;Wb<ja.length;Wb++)Ua&&Math.abs(ja[Wb].y-Ua.y)<Gd.xNi+Gd.pZm?Ua.OXk(ja[Wb].RVd):(Ua=ja[Wb],yb.push(Ua));return yb}aEl(ja,Ua,yb,Wb){const tc=ja.uh.ownerDocument,Rc=tc.createElement("div");Rc.className=gg.w3h;Rc.style.top=yb+"px";Rc.style.left=Wb+"px";Rc.style.right="auto";Rc.style.zIndex="40";Qg.a.Dm(Rc,Eg.a.uVc,Ua.RVd);Ua=tc.createElement("span");this.dLg(Ua,Rc);ze(fc[0],Ua);this.zE(Ua,ja);return Rc}dLg(ja,Ua){ja.title=CommonUIStrings.l_CommentHintTooltip;
ja.setAttribute("role","button");Ua.appendChild(ja)}zE(ja,Ua){this.Dg.LI(af.a.click,ja,this.OVn.bind(this),Ua);this.Dg.nb(af.a.PC,ja,this.RVn.bind(this));this.gl.nb(af.a.y3,ja,this.TVn.bind(this));this.gl.nb(af.a.ML,ja,this.SVn.bind(this));this.cG.nb(ja,this.QVn.bind(this))}static eGl(ja){ja=ja.uh.ownerDocument.createElement("div");ja.className=gg.I3n;return ja}QVn(){return!0}RVn(){return!0}OVn(ja){const Ua=Zd.g(ja.Ny.parentNode);ja.eventName===af.a.jM&&(this.xwa.Qnf(),this.v1h());this.ga.Pb(li.a.x3h,
2,Ua);return!0}TVn(ja){this.jKa(this.RDb)!==ja.Ny&&(ja=Zd.g(ja.Ny.parentNode),this.ga.Pb(li.a.ipf,2,ja));return!0}SVn(){this.ga.Ob(li.a.WVd,2);return!0}ylc(ja){this.v1h();this.RDb=ja;this.F5k()}F5k(){this.G5k(this.jKa(this.RDb),this.jKa(this.HHb))}Drb(ja){this.qpl();this.HHb=ja;if(ja=this.jKa(this.HHb)){const Ua=this.U5d(ja);this.Cwe(ja,Ua,1)}}jKa(ja){if(!ja)return null;let Ua=null;if(ja=this.xi.I2(ja))if(ja=ja.Of?this.xi.yF(ja.Of):ja)Ua=ja.objectId;return Ua&&this.uxd.has(Ua)?this.uxd.get(Ua).firstChild:
null}v1h(){this.spl(this.jKa(this.RDb),this.jKa(this.HHb))}spl(ja,Ua){if(ja){const yb=this.U5d(ja);this.Cwe(ja,yb,ja===Ua?1:3);this.RDb=null}}G5k(ja,Ua){ja&&(ja.title=0<this.qzc.Yag&&1<this.qzc.Ezb?CommonUIStrings.l_CommentHintTooltip+String.format(CommonUIStrings.l_CommentHintNthOfTotal,this.qzc.Yag,this.qzc.Ezb):CommonUIStrings.l_CommentHintTooltip,Ua!==ja&&(Ua=this.U5d(ja),this.Cwe(ja,Ua,2)))}qpl(){const ja=this.jKa(this.RDb),Ua=this.jKa(this.HHb);if(Ua){const yb=this.U5d(Ua);this.Cwe(Ua,yb,ja===
Ua?2:3);this.HHb=null}}Cwe(ja,Ua,yb){this.qhn()?this.pRo(ja,yb):this.mTo(ja,Ua,yb)}pRo(ja,Ua){ja=null===ja||void 0===ja?void 0:ja.querySelectorAll(".OfficeIconColors_HighContrast");0<(null===ja||void 0===ja?void 0:ja.length)&&(ja[0].style.fill=2===Ua||1===Ua?"Highlight":"ButtonText")}mTo(ja,Ua,yb){Ua=vd[Ua];for(let tc=0;tc<Ua.length;tc++){var Wb=Ua[tc];const Rc=Uc(Wb,yb);if(!this.Ldn(Rc)){a.ULS.sendTraceTag(512262488,327,15,`The following CSS variable is undefined: ${Rc}.`);break}Wb=null===ja||void 0===
ja?void 0:ja.querySelectorAll("."+Wb);0<(null===Wb||void 0===Wb?void 0:Wb.length)&&(Wb[0].style.fill=`var(${Rc})`)}}qhn(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch{return!1}}U5d(ja){return Qg.a.Eb(ja,gg.H3h)}Ldn(ja){var Ua;const yb=document.getElementById(Ik.a.TYc);return!(null===(Ua=null===yb||void 0===yb?void 0:yb.style)||void 0===Ua||!Ua.getPropertyValue(ja))}}gg.w3h="clip16x16 HintContainer";gg.I3n="OutlineElementHintMargin";gg.H3h="CommentIconType";
Object(f.a)(gg,"CommentHintActor",Sg.a,[641]);var Wf=d(972);class Rg extends Wf.a{get DBg(){return this.U2()}get Gxf(){return this.GGp.CFi()}constructor(ja,Ua,yb,Wb,tc,Rc,Id,Pd,Rd,Ue,tf){super();this.Qg=ja;this.av=Ua;this.xj=yb;this.Xi=Wb;this.QPd=tc;this.TH=Rc;this.Ih=Id;this.getSelectedText=Pd;this.GGp=Rd;this.focusManager=Ue;this.H6a=tf;this.bed=()=>{};this.Nle=()=>{};this.c8g=!1;this.hll={[0]:()=>this.Ici(),[1]:()=>this.wxc.zif(),[2]:()=>this.Ici()};this.Cgg=()=>{this.QPd.gNa(11)};this.yjf=cg=>
{for(const fg of Zd.u)cg.bindAction(ye.KeyInputManager.nI(fg),Nb.a.zlf)};this.Tme=()=>{this.Nle()};this.Sme=(cg,fg)=>{if(cg.name!==zf.AFrame.zt&&fg){var Mg=this.xj.lu?this.xj.lu.id:"";this.Qg.XVb||(this.Qg.XVb=Pf.a.f6(this.Xi,()=>{this.bed(Mg)}))}};this.Cmj=()=>{};this.gvb=()=>{this.hSj()};this.mcg=(cg,fg)=>{0===fg&&(this.TH.Zre(),this.QPd.gNa(0))};this.Edg=()=>{this.QPd.gNa(5)};this.g3c=cg=>{let fg=0;const Mg=this.xj.qR();for(let Fh=0;Fh<Mg.length;Fh++){if(Mg[Fh].Of||Mg[Fh].done)continue;if((Mg[Fh].Fr===
Oe.a.VD?Mg[Fh].FA.draftId:Mg[Fh].id)===cg.contentId)break;const zj=this.gy.getContentAnchorPosition(Mg[Fh].id);!zj||4<Math.abs(cg.anchorTop-zj.anchorTop)||fg++}return fg};this.whj=()=>{this.TH.Zre()};this.zfg=()=>{this.QPd.gNa(2)};this.hSj=()=>{if(!this.c8g&&this.Ih.Rha){const cg=this.Ih.Rha.getElementsByClassName(gg.w3h);for(let fg=0;fg<cg.length;fg++)cg[fg].style.opacity="1";this.c8g=!0}}}initialize(ja,Ua){this.gy=ja;this.wxc=Ua;this.njd();this.av.ribbonCommentFilteringEnabled&&this.Yro();this.$ro()}OQo(ja,
Ua){this.Nle=ja;this.bed=Ua}pui(ja,Ua){return{K5a:this.tkm(ja,Ua),containerContentByType:{}}}dui(ja,Ua){const yb=Zg.Gvi(this.xj.qR(),this.xj.eta),Wb=[],tc=Zd.e(!0);var Rc=this.xj.qR();Ua=this.Zdo(Ua,Rc,yb);!Ua.dlg&&Ua.contentAnchorPosition&&(Wb.push(Ua.contentAnchorPosition),Ua.contentAnchorPosition=null);for(Rc=0;Rc<tc.length;Rc++){const Id=tc[Rc],Pd=Zd.g(Id);if(Pd)for(let Rd=0;Rd<Pd.length;Rd++){const Ue=this.getContentAnchorPosition(ja,yb,Id,Pd[Rd]);Ue&&(Wb.push(Ue),Ua.dlg&&Ua.contentAnchorPosition&&
Ue.contentId===Ua.dlg.id&&(Wb.push(Ua.contentAnchorPosition),Ua.contentAnchorPosition=null))}}Ua.contentAnchorPosition&&Wb.splice(0,0,Ua.contentAnchorPosition);return{yul:yb,contentAnchorPositions:Wb}}I_f(){var ja;return!(null===(ja=this.gy)||void 0===ja||!ja.getAreContainersEnabled())}U2(){return this.xj.mBa()}WAg(){return this.U2()}zod(){return this.U2()}JBg(){return this.gy&&this.Ih.Rha&&this.U2()}dip(){this.TH.R3("OnFloatingCommentsVisibilityChange",this.Qg.YNa);if(this.Qg.YNa)this.Ih.r0b();else{const ja=
this.xj.jL;ja.eB&&ja.clearSelection();this.Ih.w$d()}}rmj(ja){0!==ja&&this.bed(this.xj.lu?this.xj.lu.id:"")}getContentAnchorPosition(ja,Ua,yb,Wb){let tc=null;return({value:tc}=Ua.Ac(Wb.toString(),tc)).returnValue?(Ua=tc[0])&&!Ua.Of?{...(new Cf.a),anchorTop:(Bg.a.f2c(yb)-ja)/this.Ih.Jea,anchorLeft:0,containerContentType:0,contentId:Ua.id}:null:null}Zdo(ja,Ua,yb){var Wb,tc;const Rc={};"CREATE"===(null===(tc=null===(Wb=this.xj.Vy)||void 0===Wb?void 0:Wb.FA)||void 0===tc?void 0:tc.sessionType)&&(Wb=this.Ih.Rha.querySelectorAll(Zd.b),
ja=this.Ih.Hri((0<Wb.length?Wb[0]:null)||this.getSelectedText(),this.xj.Vy.FA.draftId,0,ja),Rc.dlg=this.oCm(Ua,yb),Rc.contentAnchorPosition=ja);return Rc}oCm(ja,Ua){var yb=Array.indexOf(ja,this.xj.Vy);for(--yb;-1<yb;yb--)if(Ua.lb(ja[yb].objectId))return ja[yb]}tkm(ja,Ua){return this.dui(ja,Ua).contentAnchorPositions}njd(){this.TH.T3("OnAfterTrackChangeMarkupViewChange",(ja,Ua)=>{if(Ua)this.hll[Ua.nk]()})}$ro(){this.TH.T3("OnFloatingCommentsToggle",this.dip.bind(this))}Ici(){const ja=Zd.i();if(0!==
ja.length){var Ua=Zg.Gvi(this.xj.qR()),yb=this.xj.jL;for(let Wb=0;Wb<ja.length;Wb++){const tc=Zd.g(ja[Wb]);for(let Rc=0;Rc<tc.length;Rc++){let Id;({value:Id}=Ua.Ac(tc[Rc].toString(),Id)).returnValue&&(Id.forEach(Pd=>{var Rd;Pd&&!Pd.Of&&(this.wxc.dJa(Pd.id,0,!1),(null===(Rd=yb.eB)||void 0===Rd?void 0:Rd.id)===Pd.id&&yb.clearSelection())}),this.focusManager.Jg(zf.AFrame.Ro))}}}}Yro(){this.TH.T3("OnContentFilterUpdate",this.YUn.bind(this))}YUn(){var ja;let Ua=[],yb=new Set;const Wb=null===(ja=this.H6a)||
void 0===ja?void 0:ja.getAllContent().filter(tc=>{if(null===tc||void 0===tc?0:tc.contentId){const Rc=tc.contentId;if(yb.has(Rc))return!1;if(!this.r1m(tc))return Ua.push(tc),!1;yb.add(Rc);return!0}return!1});this.Ih.i5l(Wb,Ua)}r1m(ja){var Ua,yb;const Wb=this.Qg.filter;return ja.contentId&&(null===(yb=(Ua=this.H6a).isDraftContent)||void 0===yb?0:yb.call(Ua,ja.contentId))?!0:Wb.mentionsToCurrentUser&&!this.H6a.isCurrentUserMentioned(ja)?!1:!0}}Object(f.a)(Rg,"CommentFloatingContainerActor",Wf.a,[644]);
var ii=d(1350),fo=d(2083),na=d(195);class db extends ii.a{constructor(ja,Ua,yb,Wb,tc,Rc,Id,Pd,Rd){super();this.uBk=ja;this.Ugb=Ua;this.AMe=yb;this.kj=tc;this.Zca=Pd;this.f1=Rd;this.Fj=null;this.nk=1;Wb.execute(Ue=>{this.Fj=Ue});this.w5=[];this.eEc=new na.ScriptSharpLegacyMap;this.Kpo(Rc,Id);this.njd()}get Dj(){return this.uBk.value}get Etl(){return this.Ugb}get wfa(){return!!this.Fj}get Erb(){return 0}get Y9a(){return this.w5}get Wjh(){return this.eEc.lb(this.nk)?this.eEc.K(this.nk):this.eEc.K(0)}yXa(ja){return this.Zca.yXa(ja)}q9a(ja,
Ua){if(ja=Object(T.a)(642,ja))for(const yb of this.qeo(ja))Ua.add(yb)}zMa(ja,Ua){this.wfa&&this.kj.$d(()=>{this.jYn(ja,Ua)},"CHA:OPHC")}jYn(ja,Ua){if(this.Fj.Ep.mBa()){var yb=this.vs.TIa,Wb=new xb.a(new ie.a),tc=Ua.ZMa("*"),Rc=this.Xjm(yb),Id=!!yb&&!yb.action||!!Rc&&Rc===this.Fj.eB,Pd;this.kj.$d(()=>{this.AMe.fAm(ja.id,Wb,null===Rc||void 0===Rc?void 0:Rc.objectId)},"OPHC:GOI");this.kj.$d(()=>{Pd=this.Wjh.qWh(tc,Rc,Wb,Id);Pd.FUi=this.DUi(yb)&&0===yb.action},"OPHC:BHI");this.kj.$d(()=>{this.Wjh.KRh(tc,
Pd,Id)},"OPHC:AH")}}Xjm(ja){let Ua=null;!this.DUi(ja)||0!==ja.action&&2!==ja.action||(Ua=this.vs.TIa.UB);return Ua||this.Fj.eB}qeo(ja){if(!ja)return[];ja=this.Dj.Eb(Ib.a.Cf(ja.objectId));return this.Etl.g7d(ja,null)}Vzj(){return!1}qH(ja,Ua,yb){this.wfa&&(ja=Object.assign(new fo.a,{action:ja,type:0,UB:Ua,VL:yb}),this.vs.qH(ja))}Qnf(){this.wfa&&(this.qH(3,this.Fj.Jlc,this.Fj.Jlc),this.Fj.Jlc=null)}Kpo(ja,Ua){this.eEc.add(1,ja);this.eEc.add(0,Ua)}njd(){this.f1.T3("OnBeforeTrackChangeMarkupViewChange",
(ja,Ua)=>{Ua&&Ua.Eag!==this.nk&&(this.nk=Ua.Eag)})}DUi(ja){return ja&&0===ja.type}}Object(f.a)(db,"CommentHighlightActor",ii.a,[645,516]);var Pb=d(1002),Rb=d(328),sc=d(513),Nc=d(1394);class wc{constructor(ja,Ua){this.lul=ja;this.gcg=Ua}}Object(f.a)(wc,"CommentEndParaIdBeforeChangeInfo",null,[]);var ub=d(1548);class ee{constructor(ja,Ua,yb,Wb,tc,Rc,Id,Pd){this.D2f=ja;this.Qg=Ua;this.xj=yb;this.TH=Wb;this.Vp=tc;this.Zk=Rc;this.Itl=Id;this.av=Pd;this.NBb=null;this.eeo=()=>{if(!this.xj.mBa()){var Rd=
Zd.l();[Eg.a.fpf].forEach(Ue=>{this.Spl(Rd,Ue)})}};this.$do=(Rd,Ue)=>{(Rd=Ue.XK)&&!Zd.t(Rd)&&(Ue=this.xj.QGf(Rd),Ib.a.xt(Ue.Dpd,Ue.BZc)||this.h5j(Ue,Rd)||this.d0h(Ue.sIa,Ue.YTa,Rd)||this.qLg(Rd))};this.ZRn=(Rd,Ue)=>{Ue.property===ib.a.nAa&&(Rd=Zd.h(Ue.node,Ib.a.nil),this.NBb=new wc(Ue.node.id,Rd))};this.lTn=(Rd,Ue)=>{Rd=Ue.node;if(Ue.property===ib.a.nAa&&Rd){var tf=Zd.k(Rd,Ib.a.nil);Ue=Zd.h(Rd,Ib.a.nil);var cg=this.NBb?this.td.Eb(this.NBb.gcg):null;!Zd.t(Rd)&&tf&&!tf.equals(Ue)&&this.NBb&&Rd.id.equals(this.NBb.lul)&&
!tf.equals(this.NBb.gcg)&&cg&&cg.isConnected&&this.Tdf(this.NBb.gcg,Rd.id);Ue&&this.Qg.hz.lb(Ue)&&(tf=this.Qg.hz.K(Ue),tf.R9a&&(a.ULS.shipAssertTag(572835481,327,!!tf.uP,"Paranode with HasSpanningComment true should have non null OpenCommentObjIds"),tf.uP&&tf.uP.contains(Rd.id)&&(tf.uP.remove(Rd.id),tf.uP.count||(tf.R9a=!1),this.Qg.JX.lb(Rd.id)?this.Qg.JX.K(Rd.id).remove(Ue):a.ULS.sendTraceTag(572835482,327,15,"[OnPropertyChanged] OpenComment -> ParaNodes entry missing!"))))}};this.Jed=(Rd,Ue)=>{Rd=
Ue.node.id;this.Qg.hz.lb(Rd)&&this.dwo(Rd)};this.JRn=(Rd,Ue)=>{Ue&&Ue.node&&this.n1a.lb(Ue.node)&&(Rd=this.n1a.K(Ue.node).Xne,this.n1a.lb(Rd)||(Rd=this.n1a.K(Ue.node),this.d0h(Rd.euf?Rd.currentNode:Rd.Xne,Rd.euf?Rd.Xne:Rd.currentNode,Rd.XK)||this.qLg(Rd.XK)),this.n1a.remove(Ue.node))};this.oTn=(Rd,Ue)=>{const tf=Rd.lk;if(!Ue&&this.ckb.lb(tf)){var cg;(cg=this.ckb).Z(tf,cg.K(tf)&(Rd.Vc?-2:-3));this.ckb.K(tf)||(this.qLg(this.td.Eb(tf)),this.ckb.remove(tf))}};this.n1a=new sc.a(new Pb.a);this.ckb=new Zh.a(Zd.c);
this.TH.T3("OnCommentNodeAdded",this.$do);this.TH.T3("OnCommentNodeDeleted",this.eeo);this.av.contentFilterApiEnabled?(this.TH.T3("OnCommentPaneOpen",this.m$m.bind(this)),this.TH.T3("OnCommentPaneClose",this.l$m.bind(this)),this.TH.T3("OnContentFilterUpdate",this.qed.bind(this))):["OnCommentPaneOpen","OnCommentPaneClose"].forEach(Rd=>{this.TH.T3(Rd,this.j$m.bind(this))});this.TH.T3("OnFloatingCommentsVisibilityChange",this.k$m.bind(this));ja=this.Vp.jf(12);ja.Yx(this.Jed);ja.wt(this.JRn);this.Vp.jf(40).SRc(this.ZRn);
this.Vp.jf(40).jo(this.lTn);Rb.a.yZa(this.oTn)}get ov(){return this.D2f.value}get td(){return this.ov.td}fAm(ja,Ua,yb){if(this.R5n(ja))for(const Wb of this.Qg.hz.K(ja).uP)!this.pQj(Wb,yb===Wb.toString())||Ua.add(Wb)}pQj(ja,Ua){const yb=this.td.Eb(ja),Wb=Zd.t(yb);if(!yb||Wb)return!1;ja=this.xj.I2(ja.toString());return!ja||this.av.contentFilterApiEnabled&&this.Qg.en&&!this.Itl.isContentInFilteredContent(ja.id)||!this.Qg.en&&!this.xj.eta(ja)&&!Ua?!1:!0}R5n(ja){return this.w5n(ja)}Spl(ja,Ua){ja=ja.querySelectorAll(`.${Ua}`);
if(0!==ja.length)for(let yb=0;yb<ja.length;yb++)ja[yb].classList.remove(Ua)}qLg(ja){if(ja){var Ua=Nc.a.g7d(ja,null),yb=new cc.a;for(let Wb=1;Wb<Ua.length-1;Wb++)this.Tdf(Ua[Wb].id,ja.id),yb.add(Ua[Wb]);Ag.b(yb)}}k$m(){const ja=new cc.a;for(const Ua of this.xj.qR())!Ua.Of&&Ua.Fr!==Oe.a.VD&&this.xj.eta(Ua)&&this.xj.jEe(Ua,ja);Ag.b(ja)}w5n(ja){if(!this.Qg.c0)return!1;let Ua=null;if(({value:Ua}=this.Qg.hz.Ac(ja,Ua)).returnValue)return Ua.R9a;let yb=!1;this.Zk.$d(()=>{const Wb=Zd.e();for(let tc=0;tc<Wb.length;tc++)yb=
this.rvp(Wb[tc],ja,yb);yb||(this.Qg.hz.add(ja,new ub.a),this.Qg.hz.K(ja).R9a=!1)},"CHORA:PHOC");return yb}rvp(ja,Ua,yb){ja=Zd.g(ja);if(!ja)return yb;for(let Wb=0;Wb<ja.length;Wb++){const tc=this.td.Eb(ja[Wb]);tc&&!Zd.t(tc)&&(yb=yb||this.Kll(tc,Ua))}return yb}Kll(ja,Ua){var yb=this.xj.QGf(ja);if(this.h5j(yb,ja))return!1;var Wb=yb.Dpd;const tc=yb.BZc;yb=yb.sIa;if(Wb!==Ib.a.nil&&(Wb.equals(tc)||Wb.equals(Ua)))return!1;for(Wb=Ya.ParagraphReader.xg(yb,!1);Wb&&!Wb.id.equals(tc);){if(Wb.id.equals(Ua))return this.Tdf(Ua,
ja.id),!0;Wb=Ya.ParagraphReader.xg(Wb,!1)}return!1}Tdf(ja,Ua){this.Qg.JX.lb(Ua)||this.Qg.JX.add(Ua,new xb.a(new ie.a));this.Qg.JX.K(Ua).add(ja);this.Qg.hz.lb(ja)?this.Qg.hz.K(ja).uP||(this.Qg.hz.K(ja).uP=new xb.a(new ie.a)):this.Qg.hz.add(ja,new ub.a(!0));this.Qg.hz.K(ja).R9a=!0;this.Qg.hz.K(ja).uP.add(Ua)}dwo(ja){if(this.Qg.hz.K(ja).uP)for(const Ua of this.Qg.hz.K(ja).uP)this.Qg.JX.lb(Ua)?this.Qg.JX.K(Ua).remove(ja):a.ULS.sendTraceTag(572835483,327,15,"[OnDisconnected] OpenComment -> ParaNodes entry missing!");
this.Qg.hz.remove(ja)}j$m(){const ja=new cc.a;for(const Ua of this.xj.qR())Ua.Of||Ua.Fr===Oe.a.VD||this.xj.eta(Ua)||this.xj.jEe(Ua,ja);Ag.b(ja)}m$m(){this.HVf("OnCommentPaneOpen")}qed(){this.HVf("OnContentFilterUpdate")}l$m(){this.HVf("OnCommentPaneClose")}HVf(ja){const Ua=new cc.a;for(const yb of this.xj.qR())yb.Of||yb.Fr===Oe.a.VD||this.xj.jL.RYh(ja,yb)||this.xj.jEe(yb,Ua);Ag.b(Ua)}h5j(ja,Ua){let yb=!1;if(!ja.Qze||!ja.g0d){yb=!0;if(!ja.sIa||!ja.YTa)return a.ULS.sendTraceTag(571025377,327,15,"Anchor para nodes missing, start={0}, end={1}",
!ja.sIa,!ja.YTa),!0;ja.Qze||this.n1a.lb(ja.sIa)||this.n1a.add(ja.sIa,{XK:Ua,currentNode:ja.sIa,Xne:ja.YTa,euf:!0});ja.g0d||this.n1a.lb(ja.YTa)||this.n1a.add(ja.YTa,{XK:Ua,currentNode:ja.YTa,Xne:ja.sIa,euf:!1})}return yb}d0h(ja,Ua,yb){ja=Nc.a.GAa(ja,yb.id,!0);Ua=Nc.a.GAa(Ua,yb.id,!1);let Wb;ja||({value:Wb}=this.ckb.Ac(yb.id,Wb),this.ckb.Z(yb.id,Wb&1));Ua||({value:Wb}=this.ckb.Ac(yb.id,Wb),this.ckb.Z(yb.id,Wb&2));return!ja||!Ua}}Object(f.a)(ee,"CommentHighlightOnRestActor",null,[643]);var We=d(543),
re=d(441),jf=d(534);class $e{constructor(ja,Ua){this.fJb=ja;this.Woa=Ua}getViewContainer(){return this.fJb}registerForViewContainerEvents(ja){this.Woa.xto(ja)}unregisterForViewContainerEvents(ja){this.Woa.aqp(ja)}}Object(f.a)($e,"ViewContainerProvider",null,[1735]);class Cg{constructor(ja,Ua,yb,Wb){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=ja;this.appLocale=Ua;this.uiCulture=yb;this.dataCulture=Wb}}Object(f.a)(Cg,"LocalizationDetails",null,[]);var Tg=
d(1094),Dd=d(1414),nh=d(485);class bj{constructor(ja,Ua,yb,Wb,tc,Rc,Id,Pd,Rd,Ue,tf,cg,fg,Mg,Fh,zj,om,ej,Kj,Tl,nj,Nn,ui,oq,rp,Am,Bh,ml,nl,um,jr){this.Er=ja;this.xj=Ua;this.CLb=yb;this.l2=Wb;this.av=tc;this.Qg=Rc;this.M2d=Id;this.zlc=Pd;this.Kp=Rd;this.Rb=Ue;this.dynamicScriptLoader=tf;this.CFo=cg;this.focusManager=fg;this.rpf=Mg;this.npf=Fh;this.NKh=zj;this.BBp=om;this.kY=ej;this.TH=Kj;this.nHo=Tl;this.B2l=nj;this.Vgj=Nn;this.CBp=ui;this.DLb=oq;this.BW=rp;this.Ih=Am;this.lS=Bh;this.Nqf=ml;this.fcb=
nl;this.XVd=um;this.Pxl=jr;this.aDd=this.M3a=null;this.slh=!1;this.o1e=[];this.uBh=this.tlh=!1;this.initialize=(oi,Qo)=>{this.w3m(Qo)};this.QKl=oi=>Oc.a.SWd(oi);this.pTn=()=>{this.qQi()};this.xqm=(oi,Qo,sp)=>{oi={...(new Tg.a),containerPanel:oi,paneOpenedCallback:Qo,paneClosedCallback:sp,ulsLogger:new We.a,canvasAndFcHostOffset:wacBoot.ShiftUtils.canvasAndFcOuterSurfaceOffset,isRtl:y.AFrameworkApplication.isRtl,viewportInfo:this.Ih.FHf(),destroyAllContainersCallback:()=>{this.Qg.en||a.ULS.sendTraceTag(571342851,
327,10,"The pane is not open but we are destroying the containers!")},featureGates:{deselectionEnabled:!0,floatingContainerVirtualizationEnabled:this.av.N2d,synchronousContainerPositioningEnabled:!1,trackChangeInSidetrackEnabled:this.av.trackChangeInSidetrackEnabled,improveJumpingFixEnabled:!1,shouldInitialize:!this.av.contentNavigationApiEnabled,scrollingPerfImprovementEnabled:!1,contentNavigationApiEnabled:this.av.contentNavigationApiEnabled,contentFilterApiEnabled:this.av.contentFilterApiEnabled,
returnToDraftFixEnabled:!0,ribbonCommentFilteringEnabled:this.av.ribbonCommentFilteringEnabled}};this.av.contentNavigationApiEnabled&&(oi.sidetrackContentNavigationApi=this.Nqf,oi.featureGateApiSettings=this.BW.Gxf,oi.telemetryDetails=this.Vgj,this.av.contentFilterApiEnabled&&(oi.contentFilterAPI=this.Pxl));return floatingContainerManager.FactoryGlobal.getFCManagerInstance(oi)};this.eVn=oi=>{2!==this.Er.mode&&3!==this.Er.mode&&this.xj.lu&&oi===this.xj.lu.id&&this.Er.clearSelection();jg.StaticActiveAppFrame.za().Fe(!0)};
this.rij=(oi,Qo)=>{this.Ly("onCSCStart",window.performance.now());this.Flb&&!oi&&(this.c2n(),this.Ly("openInFishbowl",!0));this.CLb.Jlb&&this.av.UMb&&this.Rb.Ob(li.a.hMa,2);Qo&&Qo();this.Ly("onCSCEnd",window.performance.now())};this.TH.T3("OnCommentInit",this.initialize);this.TH.T3("OnCommentRenderedOnce",this.pTn);this.BW.OQo(()=>{},this.eVn);nh.a.k5c&&(this.Qg.YNa=!1)}get xQa(){return this.Er}get Flb(){return this.Qg.Flb}Ly(ja,Ua){this.fcb.Ly(Tj.a.comments,ja,Ua,!0)}w3m(ja){if(this.Qg.c0)ja&&ja.nMa&&
ja.nMa();else if(this.slh)(null===ja||void 0===ja?0:ja.nMa)&&this.o1e.push(ja.nMa);else{var Ua=this.av.elc;this.Ly("hasCommentOnBoot",Ua);Ua?(this.DLb.logKpiUsage(Dd.a.ALb,0),y.AFrameworkApplication.cga("3f3e3317;d8ebf581")):re.a.CPn();this.slh=!0;this.Ly("initInProgress",!0);this.xj.initialize(this.Er);this.CLb.initialize(this.Er,null);this.CLb.yPj(this.Er);this.zlc.t4m(this.l2.yVo);this.Ly("InitAMSetup",window.performance.now());jf.a.Yp(this.B2l).continueWith(yb=>{(this.M3a=yb.result)||a.ULS.sendTraceTag(574734881,
327,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");this.rpf.initialize(this.M3a);this.xQa.dpf.initialize(this.xQa,this.xj,this.M3a,this.rpf);this.NKh.initialize(this.dynamicScriptLoader,this.xQa.dpf,this.Vgj,this.M3a,new $e(this.BBp,this.CBp),this.dAi(),"",this.rpf.CFi(),this.kY,Ra.a.Kxe);this.Ly("AMInitialized",window.performance.now());this.av.contentNavigationApiEnabled?(Ra.a.rOb?Ra.a.rOb:this.Ih.V5i()).then(()=>{this.Ly("FCMLoaded",window.performance.now());this.Wnd();this.lbe(ja)}):
this.lbe(ja)})}}Qao(){var ja;null===(ja=sharedComments.setDarkModeColorHandler)||void 0===ja?void 0:ja.call(sharedComments,this.QKl)}lbe(ja){this.aDd=this.NKh.lbe(void 0,this.Qao.bind(this));this.U6c(ja);this.Qg.c0=!0;this.av.mDg&&this.npf.initialize()}U6c(ja){if(!this.Qg.xRb){this.Ly("InitCSStart",window.performance.now());var Ua=this.Kp.Wf("Task","InitiateCommentingSession");this.DLb.logKpiUsage(Dd.a.I3h,0);try{const yb=this.Kp.Wf("Task","InitiateCommentingSession-UpdateModel");this.XVd.P3m();yb.stop();
this.Ly("initAtBoot",window.performance.now());this.av.Jr&&this.xj.mBa()&&a.ULS.sendTraceTag(574734882,327,50,String.format("Comments loaded into the model at {0}",la.a.Ge()));yk.a.get_instance().hK(12);a.ULS.sendTraceTag(574734883,327,50,"CommentRendered AppInitializationStatus was set");this.Qg.xRb=!0;this.aDd.then(()=>{this.Ly("SCLoaded",window.performance.now());this.Ih.j4m();this.Ly("FCMInitiated",window.performance.now());if(this.av.Jr){let tc=!1;if(this.Flb){var Wb=this.l2.H4d(this.Flb);Wb?
(y.AFrameworkApplication.vd("3ge3g205;cha3g788"),Wb=this.l2.I4d(Wb,0),Wb)?this.xj.eta(Wb)||(tc=!0,this.d2n(Wb)):(tc=!0,this.Ebb()):tc=!0}Wb=ja?ja.ijj:null;this.av.contentNavigationApiEnabled?this.rij(tc,Wb):this.vxn(tc,Wb)}ja&&ja.nMa&&ja.nMa();for(const tc of this.o1e)tc();this.tlh&&this.qQi();this.o1e=[]})}catch(yb){a.ULS.cA(539567713,327,10,yb,`Comments Initialization Failed: ${yb}`),this.DLb.logKpiFailure(Dd.a.I3h,"CommentsInitializationFailed",{isInternal:!0},{name:Dd.a.zLb,isInternal:!0})}finally{Ua.stop(),
this.Ly("InitCSEnd",window.performance.now())}this.Rb.Ob(li.a.l3h,2)}}d2n(ja){this.Rb.Ob(li.a.pY,2);this.BW.hSj();Pf.a.f6(y.AFrameworkApplication.oc,()=>{this.l2.selectComment(ja,{...(new Kl.a),g4:!0,kca:1});this.focusManager.Jg(zf.AFrame.zt);a.ULS.sendTraceTag(574734912,327,50,"opened resolved deeplinked comment using pane, time since boot = {0}",(new Date).getTime()-y.AFrameworkApplication.xT)},ff.a.oKo);this.DLb.Vw(li.a.hpf)}Ebb(){this.Rb.Ob(li.a.Ebb,2)}vxn(ja,Ua){(Ra.a.rOb?Ra.a.rOb:this.Ih.V5i()).then(()=>
{this.Ly("FCMLoaded",window.performance.now());this.Wnd();this.rij(ja,Ua)}).catch(yb=>{a.ULS.sendTraceTag(574734913,327,15,"Failed to load floatingContainerManager script: "+yb.toString())})}Wnd(){this.lS.trackChangeInSidetrackEnabled?(this.M2d.Wnd(),this.Ly("STSet",window.performance.now())):this.M2d.CPj(this.xqm)}qQi(){this.uBh||(this.Qg.c0&&this.aDd?(this.aDd.then(()=>{const ja=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();this.nHo.execute(Ua=>{ja.registerSafelinksNavigator(Ua.Szc.bind(Ua))});
this.CFo.execute(Ua=>{Ua.Npo(ja)})}),this.uBh=!0):(a.ULS.sendTraceTag(571618846,327,15,"[InitializeRichContentEditAPI] Shared comments runtime not yet loaded"),this.tlh=!0))}dAi(){return new Cg(y.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,y.AFrameworkApplication.uiCulture,y.AFrameworkApplication.dataCulture)}c2n(){this.l2.PIj(this.Flb,{...(new Kl.a),xBg:!1,h8c:!0});this.DLb.Vw(li.a.hpf)}}Object(f.a)(bj,"CommentInitActor",null,[]);class fe{constructor(ja,Ua,yb,Wb){this.Dg=ja;this.cG=
Ua;this.ga=yb;this.Vj=Wb;this.PEe=this.f2a=null}get zoom(){let ja=1;this.Vj&&this.Vj.instance&&(ja=this.Vj.instance.yj);return 0<ja?ja:1}b4l(ja,Ua){if(!this.PEe||!ja.TKa||Ua>=ja.TKa.length)return null;const yb=this.zoom,Wb=ja.H3,tc=ja.j6a(1,Gd.ETf,yb,Ua);return this.fDl(Wb,(this.PEe.y-ja.m7[Ua].y)/yb+Gd.bbk,tc)}fDl(ja,Ua,yb){if(this.f2a)return(ja=this.f2a.parentElement)&&ja.removeChild(this.f2a),this.uLj(this.f2a,Ua,yb),this.f2a;const Wb=ja.uh.ownerDocument,tc=Wb.createElement("div");tc.className=
fe.Ftl;this.uLj(tc,Ua,yb);Ua=Wb.createElement("span");this.dLg(Ua,tc);ze(fc[4],Ua);this.bro(Ua,ja);return this.f2a=tc}dLg(ja,Ua){ja.title=CommonUIStrings.l_CommentNewCommentButton;ja.setAttribute("role","button");Ua.appendChild(ja)}bro(ja,Ua){this.Dg.LI(af.a.click,ja,this.KUn.bind(this),Ua);this.Dg.nb(af.a.PC,ja,this.MUn.bind(this));this.cG.nb(ja,this.LUn.bind(this))}q$d(){if(this.f2a){const ja=this.f2a.parentElement;ja&&ja.removeChild(this.f2a)}}uLj(ja,Ua,yb){ja.style.left=yb+Gd.ETf+"px";ja.style.top=
Ua+"px";ja.style.right="auto";ja.style.display="block";ja.style.position="absolute";ja.style.overflow="hidden";ja.style.cursor="default";ja.style.zIndex="40"}MUn(){return!0}KUn(ja){this.ga.aE=30;this.ga.Ob(li.a.hMa,2);ja=ja.Ny;ze(fc[4],ja);ja=ja.parentElement;(null===ja||void 0===ja?0:ja.parentElement)&&ja.parentElement.removeChild(ja);return!0}LUn(){return!0}}fe.Ftl="clip16x16 EntryPointContainer";Object(f.a)(fe,"CommentMarginEntryPointActor",null,[]);var Ge=d(423),og=d(84),Hi=d(221),Nh=d(35),ji=
d(110);class qi{constructor(ja,Ua,yb,Wb,tc,Rc,Id){this.D2f=ja;this.evn=Ua;this.Ep=yb;this.Qg=Wb;this.av=tc;this.lpf=Rc;this.DLb=Id;this.Guj=new Set;this.tUb=new Set;this.ufd=new Hi.a;this.Eec=new Map;this.M3h=C.a.instance.rf(93);this.ELb=new Set;this.Sja=this.G4d()}get ov(){return this.D2f.value}get td(){return this.ov.td}get vIa(){return this.evn.value}G4d(){const ja=new ac.a;ja.set(this.ov);this.vIa.wbb(ja);return ja}P3m(){this.Qg.xRb&&a.ULS.sendTraceTag(523334300,327,15,"initializeCommentsAtBoot was called while the commenting session was already alive. [Call stack: {0}]",
Nh.Debug.y8a());this.av.contentNavigationApiEnabled||(this.av.elc&&this.N3m(),this.Ep.mkj())}qSn(){this.GFj();this.ELb.forEach(ja=>{this.uRg(ja)});this.ELb.clear();this.Ep.mkj()}uRg(ja){if(Ge.a.isEnabled){a.ULS.sendTraceTag(512235650,327,15,`Missing Start or End mapping info for Comment ${ja}`);var Ua=this.Eec.get(ja).Nxc,yb=this.Eec.get(ja).hhc;Ua===Ib.a.nil||yb===Ib.a.nil?a.ULS.sendTraceTag(512235652,327,15,`start ${Ua} or end ${yb} has invalid value`):(this.M3h.value.I6a.set(ja,Ua),this.M3h.value.G6a.set(ja,
yb),a.ULS.sendTraceTag(512235651,327,50,`Start ${Ua} and End ${yb} mapping info for Comment ${ja} added on Comment Model load`))}}T6m(ja){const Ua=[];for(const yb of ja)ja=yb.lk.toString(),this.P4j(ja,yb.paragraph.id,yb.Vc),yb.Vc&&(this.Guj.has(ja)?a.ULS.sendTraceTag(523334301,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",yb.lk):(this.Guj.add(ja),(ja=this.yTk(yb))&&Ua.push(ja)));return Ua}P4j(ja,Ua,yb){Ge.a.isEnabled&&(this.Eec.has(ja)||this.Eec.set(ja,{Nxc:Ib.a.nil,hhc:Ib.a.nil}),
yb?this.Eec.get(ja).Nxc=Ua:this.Eec.get(ja).hhc=Ua)}yTk(ja){var Ua=this.td.Eb(ja.lk);this.Sja.Yj(Ua);if(40!==this.Sja.mf||!Ua)return a.ULS.sendTraceTag(523334303,327,15,"[UpdateContent] Iterator is not at commentNode or CommentNode is null, commentnode is null: {0}, objId null: {1}",!Ua,!ja.lk),this.Sja=39===this.Sja.mf?this.Sja:this.G4d(),null;Ua=this.Ep.yXd(this.Sja);let yb;if(({index:yb}=this.Ep.UCe(Ua)).returnValue)if(this.Ep.ndf(Ua,yb),this.tUb.add(Ua.objectId),Zd.q(Ua)||this.ELb.add(Ua.objectId),
Ua.Of)this.$Cf(Ua);else return{contentId:Ua.id,containerContentType:0,Vba:{Gd:ja.Jb.cp,sP:ja.paragraph.Bk}};else this.ufd.add(Ua);return null}$Cf(ja){if(ja.Of){var Ua=this.Ep.yF(ja.Of);if(Ua&&Ua.Of){const yb=this.Ep.yF(Ua.Of);yb&&(yb.Of?a.ULS.sendTraceTag(523270216,327,10,"Multiple chain of replies parented to other replies"):(ja.Of=Ua.Of,a.ULS.sendTraceTag(523270217,327,15,`Comment reply id pointing to another reply. objectid: ${ja.objectId} parentObjectId: ${Ua.objectId}`)))}}}N3m(){const ja=new Ca.a(0),
Ua=og.a.gq(this.Ep.F0a),yb=new Set;this.av.G3n&&!Ge.a.isEnabled&&this.WVk(Ua,ja);const Wb=this.G4d(),tc=new Set,Rc=new Set,Id=new bh.GraphTransaction(2);try{if(Id.mu(Wb),Wb.kv(1)){for(;Ua.moveNext();){if(!Ya.ParagraphReader.Bh(Ua.iterator))continue;const Rd=Ua.iterator.currentNode,Ue=Ya.ParagraphReader.ZOb(Rd);Ge.a.isEnabled&&this.dGn(Rd,Ue,ja);yb.add(Rd.id.toString());this.Ztj(Ue,Rc,Wb,tc)}this.GFj();const Pd=this.Yjm(yb);0<Pd.length&&this.UEo(Pd,yb,Wb,Rc);this.ELb.forEach(Rd=>{this.uRg(Rd)});this.ELb.clear()}}finally{Id&&
Id.dispose()}0==this.tUb.size&&this.av.elc&&a.ULS.sendTraceTag(523334304,327,15,"Comments not loaded in model while graph has comments");nd.a.ABn(tc,Rc,this.td)}Ztj(ja,Ua,yb,Wb){for(const tc of ja){ja=this.av.Jr?!tc.Vc:tc.Vc;const Rc=tc.lk.toString();this.P4j(Rc,tc.paragraph.id,tc.Vc);ja?Ua.has(Rc)||Wb.add(Rc):Ua.has(Rc)?a.ULS.sendTraceTag(523334305,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",tc.lk):(Ua.add(Rc),this.zTk(tc,yb))}}UEo(ja,Ua,yb,Wb){const tc=this.wBm(ja);nd.a.Rml(tc);
const Rc=new Set,Id=new Set;tc.forEach(Rd=>{Ua.has(Rd.id.toString())||Id.has(Rd.id.toString())||(Id.add(Rd.id.toString()),Rd=Ya.ParagraphReader.ZOb(Rd),a.ULS.sendTraceTag(523334306,327,50,`Retrying loading ${Rd.length} CommentRangeObjects`),this.Ztj(Rd,Wb,yb,Rc))});const Pd=[];ja.forEach(Rd=>{this.tUb.has(Rd)||Pd.push(Rd)});0<Pd.length&&(a.ULS.sendTraceTag(523334307,327,15,`Load Comments: ${Pd.length} Failed To Load on Retry: ${Pd.join(",")}`),this.DLb.logKpiFailure(Dd.a.ALb,"CommentsFailedToLoadOnRetry",
{isInternal:!0},{name:Dd.a.zLb,isInternal:!0}))}wBm(ja){const Ua=[];ja.forEach(yb=>{if(yb=this.lpf.bui(yb))yb=Zd.k(yb),(yb=this.td.Eb(yb))&&yb.mk&&Ua.push(yb)});return Ua}zTk(ja,Ua){const yb=this.td.Eb(ja.lk);Ua.Yj(yb);40===Ua.mf&&yb?(ja=this.Ep.yXd(Ua),({index:Ua}=this.Ep.UCe(ja)).returnValue?(this.Ep.ndf(ja,Ua),this.tUb.add(ja.objectId),Zd.q(ja)||this.ELb.add(ja.objectId),ja.Of&&this.$Cf(ja)):this.ufd.add(ja)):(a.ULS.sendTraceTag(523334336,327,15,"[UpdateContent] Iterator is not at commentNode, commentnode is null: {0}, objId null: {1}",
!yb,!ja.lk),39===Ua.mf||this.G4d())}Yjm(ja){const Ua=[],yb=this.lpf.Sjm();if(this.tUb.size===yb.length)return Ua;yb.forEach(Wb=>{!this.tUb.has(Wb)&&nd.a.Vqn(Wb,ja,this.lpf,this.td)&&Ua.push(Wb)});return Ua}GFj(){for(let ja=0;ja<this.ufd.length;ja++){const Ua=this.ufd.K(ja);let yb;({index:yb}=this.Ep.UCe(Ua)).returnValue?(this.Ep.ndf(Ua,yb),Zd.q(Ua)||this.ELb.add(Ua.objectId),this.tUb.add(Ua.objectId),Ua.Of&&this.$Cf(Ua)):a.ULS.sendTraceTag(523334337,327,10,String.format("Orphaned Comment add on retry failed: CommentGuardID: {0}, DurableId: {1}, ObjectId: {2}, ParentId: {3}",
Ua.iBa,Ua.K7a,Ua.objectId,Ua.Of))}this.ufd.clear()}WVk(ja,Ua){ja.pp(yb=>{if(11===yb.mf){var Wb=yb.currentNode;const tc=Wb.ka(ji.a.upf,null),Rc=Wb.ka(ji.a.spf,null);yb=!!tc&&0<tc.length;const Id=!!Rc&&0<Rc.length;yb&&tc.forEach(Rd=>{const Ue=this.td.Eb(Rd);Ue&&!Zd.t(Ue)&&Ua.add(Rd,0)});Id&&Rc.forEach(Rd=>{Ua.lb(Rd)&&Ua.remove(Rd)});(Wb=Wb.ka(Jf.a.oF,null))&&Wb.forEach(Rd=>{const Ue=this.td.Eb(Rd);Ya.ParagraphReader.Vb(Ue)&&!this.Qg.hz.lb(Rd)&&this.Qg.hz.add(Rd,new ub.a)});const Pd=Ua.keys;for(let Rd=
0;Rd<Pd.length;Rd++){Wb&&0<Ua.K(Pd.K(Rd))&&(this.Qg.JX.lb(Pd.K(Rd))||this.Qg.JX.add(Pd.K(Rd),new xb.a(new ie.a)),Wb.forEach(tf=>{const cg=this.td.Eb(tf);Ya.ParagraphReader.Vb(cg)&&(this.Qg.hz.K(tf).uP||(this.Qg.hz.K(tf).uP=new xb.a(new ie.a)),this.Qg.JX.K(Pd.K(Rd)).add(tf),this.Qg.hz.K(tf).R9a=!0,this.Qg.hz.K(tf).uP.add(Pd.K(Rd)))}));let Ue;Ua.Z(Ue=Ua.keys.K(Rd),Ua.K(Ue)+1)}return yb||Id}return!0},null)}dGn(ja,Ua,yb){ja&&(this.lik(Ua,yb),this.Qg.hz.lb(ja.id)||this.Qg.hz.add(ja.id,new ub.a),yb.forEach((Wb,
tc)=>{0<tc&&(this.Qg.JX.lb(Wb)||this.Qg.JX.add(Wb,new xb.a(new ie.a)),this.Qg.hz.K(ja.id).uP||(this.Qg.hz.K(ja.id).uP=new xb.a(new ie.a)),this.Qg.JX.K(Wb).add(ja.id),this.Qg.hz.K(ja.id).R9a=!0,this.Qg.hz.K(ja.id).uP.add(Wb));yb.Z(Wb,tc+1);return!0}))}lik(ja,Ua){ja.forEach(yb=>{if(yb.Vc){const Wb=this.td.Eb(yb.lk);Wb&&!Zd.t(Wb)&&Ua.Z(yb.lk,0)}else Ua.lb(yb.lk)&&Ua.remove(yb.lk)})}}Object(f.a)(qi,"CommentModelBootLoader",null,[640]);var ai=d(1017);class Ll{constructor(ja){this.J3h=ja;this.QGc=null;
this.Gth=void 0;this.Hth=null;this.FLc=new Map;this.RPe=new Map}oto(){ai.a.yZa(this.Xrp.bind(this))}Xrp(ja,Ua){const yb=ja.id.toString();var Wb=ja.getValue(ib.a.MG).toString();Ua?(this.FLc.delete(yb),this.RPe.delete(Wb)):(this.FLc.set(yb,ja),this.RPe.set(Wb,ja));0===this.FLc.size&&this.QGc&&(ja=+new Date-+this.QGc,this.QGc=null,a.ULS.sendTraceTag(543506649,327,50,`All Nodes Disconnected. Duration between first Node connection and all nodes disconnections : ${ja}`));Ua||this.Gth!==Wb||(Ua=+new Date-
+this.Hth,a.ULS.sendTraceTag(541878464,327,15,`Deeplinked Comment added after deeplink navigation failed: ${Ua}`),Wb=new za.a,Wb.durationMs=Ua,this.J3h.logKpiFailure(Dd.a.PVd,"CommentFoundAfterDeeplinkAttempt",{isInternal:!0,additionalValues:Wb},{name:Dd.a.q3h,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:Wb}));this.QGc||(this.QGc=new Date)}set iKn(ja){this.Gth=ja;this.Hth=new Date;if(ja=this.Qjm(ja))a.ULS.sendTraceTag(538789919,327,15,`Deeplinked Comment ${ja.id} present but failed to load`),
ja=new za.a,this.J3h.logKpiFailure(Dd.a.PVd,"CommentPresentButFailedToLoad",{isInternal:!0},{name:Dd.a.q3h,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:ja})}Sjm(){return[...this.FLc.keys()]}Qjm(ja){return this.RPe.get(ja)}bui(ja){return this.FLc.get(ja)}}Object(f.a)(Ll,"CommentNodeTracker",null,[]);class cl{get contentType(){return 0}constructor(ja,Ua,yb,Wb,tc){this.Dug=ja;this.Ep=Ua;this.l2=yb;this.jL=Wb;this.Qg=tc;this.Dug.tzj(this)}TIj(ja,Ua,yb){0===Ua?(Ua=this.Ep.n8c(ja),
this.l2.selectComment(Ua?this.Ep.Vy:this.Ep.yF(ja),Object.assign(new Kl.a,{g4:yb||Ua,kca:1}))):this.jL.clearSelection()}VQj(ja){if(this.Qg.en||this.Ep.n8c(ja.contentId))return!0;const Ua=this.Ep.yF(ja.contentId);if(Ua)return this.Ep.eta(Ua);a.ULS.sendTraceTag(508878870,327,10,`Failed to find comment for contentId: ${ja.contentId}`);return!1}}Object(f.a)(cl,"CommentReviewSuggestionContentActor",null,[639]);class nk{get GXj(){return this.nFg}constructor(ja,Ua){this.XVd=ja;this.av=Ua;this.nFg=new Set([12])}initialize(){}c6i(ja){if(!Ya.ParagraphReader.Vb(ja.node))return[];
ja=Ya.ParagraphReader.ZOb(ja.node);return this.XVd.T6m(ja)}Vhj(){this.XVd.qSn()}FLi(){return this.av.V6o?this.av.elc:!0}}Object(f.a)(nk,"CommentReviewSuggestionContentProvider",null,[638]);var wg=d(450),pd=d(89),Ak=d(123),Ql=d(747),an=d(1496);class Jg{constructor(){this.commentId=null;this.Z9c=!1}}Object(f.a)(Jg,"CommentToSelectOnPaneLoadData",null,[]);class ln{constructor(ja,Ua,yb,Wb,tc,Rc,Id,Pd,Rd,Ue,tf,cg,fg,Mg,Fh,zj){this.Er=ja;this.Ep=Ua;this.uIa=yb;this.l2=Wb;this.TH=tc;this.Qg=Rc;this.M2d=
Id;this.av=Pd;this.CLb=Rd;this.bUb=Ue;this.Rb=tf;this.E2f=cg;this.focusManager=fg;this.Zk=Mg;this.iul=Fh;this.H6a=zj;this.jid=(om,ej,Kj,Tl,nj)=>{if(1===Kj||!nj)return 32;nj[wg.a.On]=nh.a.k5c?this.Qg.en:this.Qg.YNa;return 32};this.Rb.qa(li.a.l0b,pd.a.frame,this.Er.l0b.bind(this.Er));this.Rb.qa(li.a.r_d,pd.a.frame,this.r_d.bind(this));this.Rb.qa(li.a.epf,pd.a.frame,this.hTn.bind(this));this.Rb.qa(li.a.qtl,pd.a.frame,this.gTn.bind(this));this.Rb.qa(li.a.Xej,pd.a.frame,this.AXn.bind(this));this.Rb.qa(li.a.$ei,
pd.a.frame,this.qUn.bind(this));this.Rb.qa(li.a.x3h,pd.a.frame,this.PVn.bind(this));this.Rb.fb(li.a.ipf,pd.a.frame,this.r5k.bind(this),64);this.Rb.fb(li.a.WVd,pd.a.frame,this.Luo.bind(this),64);this.Rb.qa(Nb.a.selectComment,pd.a.frame,this.l2.lKo.bind(this.l2));this.av.Rvn&&this.Rb.qa(Nb.a.Jge,pd.a.frame,this.Jge.bind(this));this.HLh(Nb.a.XXc,!1);this.HLh(Nb.a.mvf,!0);this.Rb.fb(Nb.a.YVd,pd.a.frame,this.YVd.bind(this),64);this.Rb.qa(Nb.a.ZHg,pd.a.frame,this.L0n.bind(this));this.Rb.fb(Nb.a.jid,pd.a.frame,
this.jid.bind(this),96);this.Rb.qa(Nb.a.I8i,pd.a.frame,Ak.ActionManager.Zf);this.Rb.qa(Nb.a.zlf,pd.a.frame,this.$fl.bind(this));this.Rb.qa(Nb.a.Hci,pd.a.frame,(om,ej)=>Ql.a.Jla(ej.Ik)&&Ql.a.tnc()?8:32);this.av.ribbonCommentFilteringEnabled&&(this.Rb.qa(Nb.a.Z1d,pd.a.frame,this.Z1d.bind(this)),this.Rb.qa(Nb.a.$1d,pd.a.frame,this.$1d.bind(this)),this.Rb.qa(Nb.a.a2d,pd.a.frame,this.a2d.bind(this)),this.Rb.qa(Nb.a.Wte,pd.a.frame,this.Wte.bind(this)))}get xj(){return this.Ep}get mode(){return this.Er.mode}get eB(){return this.Er.eB}get fE(){return this.av.Jr}get Dj(){return this.bUb.value}get mb(){return this.E2f.value}get jL(){return this.Er}r_d(ja,
Ua,yb,Wb,tc){return tc?tc?(ja=this.l2.H4d(tc.NavigationId))&&this.l2.I4d(ja,1)?32:8:(a.ULS.sendTraceTag(540160449,327,10,"ActionData could not be cast to dict: DoesCommentExist"),8):(a.ULS.sendTraceTag(540160448,327,10,"No action data: DoesCommentExist"),8)}hTn(ja,Ua,yb,Wb,tc){tc&&this.TH.R3("OnCommentInit",{...(new an.a),nMa:()=>{var Rc=this.l2.H4d(tc.NavigationId);if(Rc){var Id=this.l2.I4d(Rc,1);Id?this.CLb.isVisible?(this.bmd(Id,1),this.focusManager.EE(zf.AFrame.zt)):this.xj.eta(Id)?(Rc=Zd.s(Id),
this.l2.selectComment(Id,{...(new Kl.a),g4:!Rc,kca:1}),this.focusManager.EE(zf.AFrame.lR)):(this.Qg.en||this.Rb.Ob(li.a.pY,2),Pf.a.f6(y.AFrameworkApplication.oc,()=>{this.bmd(Id,1)},ff.a.bmd)):this.Rb.Ob(li.a.Ebb,2)}}});return 32}gTn(ja,Ua,yb,Wb,tc){tc?(ja=this.xj.I1c(tc))?this.jL.Erc(ja.id):a.ULS.sendTraceTag(540160450,327,10,"We were not able to find the comment referenced in the Activity Pane!"):this.jL.Erc(null);return 32}AXn(ja,Ua,yb,Wb,tc){if(tc){if(this.Qg.xRb){for(ja=0;ja<tc.length;ja++)this.xj.pLj(tc[ja]);
this.Er.KYb()}else this.xj.UXk(tc);this.IBn(tc)}return 32}qUn(ja,Ua,yb,Wb,tc){if(tc)if(this.Qg.xRb){for(ja=0;ja<tc.length;ja++)this.xj.pLj(tc[ja],!0);this.Er.KYb()}else this.xj.Cpl();return 32}PVn(ja,Ua,yb,Wb,tc){this.fE||this.Qg.en||this.Rb.Ob(li.a.pY,2);if(tc){ja=null;if(!this.eB||2!==this.mode&&3!==this.mode){if(!tc)return 8;if(this.fE)ja=this.R5l(tc);else for(Ua=0;Ua<tc.length&&(ja=this.xj.I2(tc[Ua].toString()),this.M2d.bde&&(!ja||ja.done));Ua++);}else ja=this.eB;this.bmd(ja,1);ja&&this.Qg.c0&&
this.focusManager.Jg(this.fE&&!this.Qg.en?zf.AFrame.lR:zf.AFrame.zt)}else a.ULS.sendTraceTag(5017933,327,10,"We have hint but we couldn't find the paragraph that it belongs to!");return 32}r5k(ja,Ua,yb,Wb,tc){var Rc;if(!tc)return 32;if(tc&&0<tc.length){Ua=ja=yb=0;Wb=!1;for(let Id=0;Id<tc.length;Id++)tc[Id].toString()===(null===(Rc=this.eB)||void 0===Rc?void 0:Rc.objectId)?(Wb=!0,ja++):this.Ep.IZf(tc[Id])&&(Wb&&0===yb&&(yb=Id,Ua=ja),ja++);(Rc=this.Ep.I2(tc[yb].toString()))?(this.uIa.qzc.Yag=Ua+1,this.uIa.qzc.Ezb=
ja,this.jL.Erc(Rc.id)):(tc=tc[yb],this.Dj.Eb(tc)?a.ULS.sendTraceTag(540148256,327,10,`Comment Node with ObjectId ${tc} has no corresponding comment in Model`):a.ULS.sendTraceTag(540148257,327,10,"Comment ObjectId:{0} is NOT in the model, but we are trying to hightlight!",tc.toString()))}return 32}Luo(){this.jL.Erc(null);return 32}HLh(ja,Ua){this.Rb.qa(ja,pd.a.frame,(yb,Wb,tc)=>this.VTn(tc,Ua))}L0n(ja,Ua,yb){var Wb;if(1===yb)return this.Ep.Vy?8:32;if(2===yb){if(nh.a.k5c||this.Qg.en)return this.Rb.Ob(li.a.pY,
2),this.Qg.YNa=this.Qg.en,32;if(!this.Ep.c5c())return 32;this.Qg.YNa=!this.Qg.YNa;this.TH.R3("OnFloatingCommentsToggle");null===(Wb=jg.StaticActiveAppFrame.za())||void 0===Wb?void 0:Wb.Fe(!0)}return 32}Jge(ja,Ua,yb){2===yb&&(ja=this.xj.jp.Nc(7),ja.Bb(this.xj.F0a),Ua=new mk.a,Ua.Ala(`${String.fromCodePoint(128077)} \n`),this.Ep.lfc(ul.a.instance.gb.currentSelection,void 0,Ua),this.iul.q$d(),ja.dispose());return 32}VTn(ja,Ua=!1){if(2===ja)ja=this.xj.jp.Nc(15),ja.Bb(this.xj.F0a),this.Zk.$d(()=>{this.XXc(Ua)},
"ECM:DAC"),ja.dispose();else if(1===ja&&!this.xj.mBa())return 2;return 32}XXc(ja=!1){this.Er.mode=1;const Ua=this.xj.qR();for(const yb of Ua)yb.Fr===Oe.a.VD||ja&&!yb.done||yb.Of||this.Er.deleteComment(yb);this.focusManager.Jg(zf.AFrame.Ro);0<(ja?this.xj.qR().filter(yb=>yb.done):this.xj.qR()).length?a.ULS.sendTraceTag(540160454,327,10,"Not all comments were deleted. onlyDeleteResolved: {0}.",ja):a.ULS.sendTraceTag(540160455,327,50,"All comments were successfully deleted. onlyDeleteResolved: {0}.",
ja)}YVd(ja,Ua,yb){if(2===yb)if(ja=this.focusManager.currentScope.name,ja!==zf.AFrame.zt&&ja!==zf.AFrame.lR){!this.fE||this.Qg.en?(this.Qg.en||this.Rb.Ob(li.a.pY,2),this.focusManager.Jg(zf.AFrame.zt)):this.focusManager.Jg(zf.AFrame.lR);var Wb=this.mb.gb.currentSelection;if(!Wb||!Wb.Qa)return 2;ja=Wb.Qa.cpBegin;Ua=Wb.Qa.node;Wb=!!this.eB&&(Cl.a.Am(Wb)||Wb.kP)&&Zd.r(this.eB,Ua,this.Dj,ja);ja=!!this.eB&&(2===this.mode||3===this.mode);if(Wb||ja)return this.jL.VIj(this.eB.id,!0),32;Wb=this.fE&&!this.Qg.en?
this.xj.cui(!0,!0):null;this.jL.uKo(Wb)}else this.xj.lu&&(this.Er.zlc.OIj(this.xj.lu,!0),this.Er.zlc.Drb(null===(Wb=this.xj.lu)||void 0===Wb?void 0:Wb.objectId)),this.focusManager.Jg(zf.AFrame.Ro);return 32}$fl(){return 4}IBn(ja){const Ua=new Set;for(let yb=0;yb<ja.length;yb++){const Wb=this.xj.I1c(ja[yb]);Wb&&Ua.add(Wb.Of?Wb.Of:Wb.id)}a.ULS.sendTraceTag(540160456,327,50,"Threads with new comments: {0}",Ua.size.toString())}bmd(ja,Ua){ja?this.CLb&&!this.Qg.c0?this.Qg.nnb=Object.assign(new Jg,{commentId:ja.id,
Z9c:!1}):this.l2.selectComment(ja,Object.assign(new Kl.a,{g4:!!Ua,kca:Ua})):a.ULS.sendTraceTag(5017932,327,10,"We were not able to find the comment in the model!")}R5l(ja){let Ua=null,yb=!1;for(let Wb=0;Wb<ja.length;Wb++){const tc=ja[Wb].toString();if(this.xj.IZf(ja[Wb])){Ua||(Ua=tc);if(yb&&this.xj.lu.objectId!==tc)return this.xj.I2(tc);yb=yb||!!this.xj.lu&&this.xj.lu.objectId===tc}}return Ua?this.xj.I2(Ua):null}Mve(ja){this.Qg.filter=ja;this.H6a.onRibbonFilterChanged(ja);this.Rb.Ob(Nb.a.aGj,2);this.TH.R3("OnContentFilterUpdate")}Z1d(ja,
Ua,yb){if(2===yb)this.Mve({...this.Qg.filter,resolutionStatus:2===this.Qg.filter.resolutionStatus?0:2});else if(1===yb&&!this.xj.mBa())return 2;return 32}$1d(ja,Ua,yb){if(2===yb)this.Mve({...this.Qg.filter,mentionsToCurrentUser:!this.Qg.filter.mentionsToCurrentUser});else if(1===yb&&!this.xj.mBa())return 2;return 32}a2d(ja,Ua,yb){if(2===yb)this.Mve({...this.Qg.filter,resolutionStatus:1===this.Qg.filter.resolutionStatus?0:1});else if(!(1!==yb||this.CLb.isVisible&&this.xj.mBa()))return 2;return 32}Wte(ja,
Ua,yb){if(2===yb)this.Mve({mentionsToCurrentUser:!1,resolutionStatus:0});else if(1===yb&&!this.xj.mBa())return 2;return 32}}Object(f.a)(ln,"CommentsActionManager",null,[]);var Ck=d(166),Xl=d(39),mm=d(194),fd=d(1829),Mc=d(528),Pi=d(30),Uj;(function(ja){ja[ja.ISp=0]="commentDeeplink";ja[ja.ikl=1]="catchUpActivity"})(Uj||(Uj={}));Object(f.b)("DeeplinkSource",Uj);class tk{constructor(ja,Ua,yb,Wb,tc,Rc,Id,Pd,Rd,Ue,tf,cg,fg){this.ga=ja;this.xi=Ua;this.Ey=yb;this.BMe=Wb;this.WS=tc;this.lDh=Rc;this.Yb=Id;
this.Gj=Pd;this.sj=Rd;this.eFb=Ue;this.DMe=tf;this.nJ=cg;this.f8e=!1;this.yVo=Mg=>{if(this.sj.Jr&&!this.Gj.en){const Fh=new bb.a(0,1,0,()=>{this.aLj(Mg)},136,void 0,!0);y.AFrameworkApplication.oc.Zb(Fh)}else this.aLj(Mg)};fg.execute(Mg=>{this.pG=Mg})}get Ep(){return this.xi}get mb(){return this.eFb.value}Nhi(ja){let Ua=ja.Fr===Oe.a.VD?ja.FA.draftId:ja.id,yb=null;ja.Of&&(Ua=ja.Of,yb=()=>{this.lDh.selectComment(ja.id)});this.WS.setInitialActiveContainerId(Ua,0,yb)}lKo(ja,Ua,yb,Wb,tc){if(!tc.commentId)return 2;
ja=this.xi.yF(tc.commentId);if(!ja)return 2;this.Exb(ja,tc);return 32}SIj(ja,Ua){var yb,Wb;if(ja){var tc=(null===(Wb=null===(yb=this.xi.Vy)||void 0===yb?void 0:yb.FA)||void 0===Wb?void 0:Wb.draftId)===ja?this.xi.Vy:this.xi.yF(ja);this.selectComment(tc,Ua)}}selectComment(ja,Ua){ja&&this.Exb(ja,Ua)}PIj(ja,Ua){var yb=this.H4d(ja);yb&&((yb=this.I4d(yb,0))?Ua.xBg?(this.Gj.nnb=Object.assign(new Jg,{commentId:yb.id,Z9c:!0}),a.ULS.sendTraceTag(579608864,327,50,"Deep linking before comment pane fully loaded.")):
(this.Exb(yb,Object.assign(new Kl.a,{commentId:yb.id,kca:1,g4:!0,h8c:!0})),this.sj.Jr&&void 0!==ja&&null!==ja&&this.Nhi(yb),Pf.a.f6(y.AFrameworkApplication.oc,()=>{this.Yb.Jg(this.sj.Jr&&!this.Gj.en?zf.AFrame.lR:zf.AFrame.zt)},ff.a.QQo),Ck.a.instance.qf(Xl.a.wbi,(new Date).getTime()),ja=this.sj.Jr?"Deep linked discrete hosted comment":"Deep linked after comment pane fully loaded",ja+=", elapsed since boot: {0} ms",a.ULS.sendTraceTag(579608865,327,50,ja,(new Date).getTime()-y.AFrameworkApplication.xT)):
this.ga.Ob(li.a.Ebb,2))}H4d(ja){let Ua=null;var yb=null;if(ua.a.Xnc(ja))Ua=ja;else if(({ev:yb}=$a.d(ja)).returnValue&&(ja=yb))return Mc.a.comment in ja&&(Ua=ja[Mc.a.comment]),Ua;Ua||(yb=yb?Object.keys(yb):null,a.ULS.shipAssertTag(579608866,327,!1,"Unrecognized navigation id. {0}",yb?yb.join(","):"Not Json."));return Ua?Ua.toString():null}I4d(ja,Ua){const yb=this.xi.I1c(ja),Wb=0===Ua;Wb&&this.nJ.logKpiUsage(Dd.a.PVd,0);if(!yb){a.ULS.sendTraceTag(579608867,327,15,"Comment durableCommentId={0} not found for deep linking. Source: {1}",
ja,Ua);const tc=new Pi.a;tc.name="DeepLinkSource";tc.string=Uj[Ua];this.nJ.logActivity("CommentDeeplinkNotFound",{dataFields:[tc]});Wb&&(Ua=new za.a,Ua.extendedProperties=new Map([["ErrorLevel","warning"]]),this.nJ.logKpiFailure(Dd.a.PVd,"CommentNotFound",{isIntentional:!1,isInternal:!0,additionalValues:Ua}),this.DMe.iKn=ja)}return yb}aLj(ja){this.f8e=!0;this.mb.Kc(ja);this.f8e=!1}Exb(ja,Ua){if(ja){this.Gj.YNa||this.ga.Ob(Nb.a.ZHg,2);this.Gj.XVb&&(y.AFrameworkApplication.oc.uf(this.Gj.XVb),this.Gj.XVb=
null);var yb=this.xi.lu,Wb=this.Ep.zLf(ja),tc=2===Ua.kca,Rc={};tc&&(Rc.TriggeredByFindReplace=!0);if(this.Gj.en)tc&&(Rc.PaneAlreadyOpen=!0),mm.UISurfaces.Iv().then(Id=>{Id.setSelectedTaskPane(fd.a.ZVd);return null});else if(ja.Fr!==Oe.a.VD&&!this.Ep.eta(ja))this.Gj.c0?this.ga.Ob(Nb.a.pY,2):this.Gj.nnb=Object.assign(new Jg,{commentId:ja.id,Z9c:Ua.h8c}),tc&&(Rc.OpeningPaneToSelect=!0);else if(this.sj.Jr){const Id=Wb.Fr===Oe.a.VD;Id?this.WS.$Za(Wb.FA.draftId,0,Ua.g4):this.WS.$Za(Wb.id,0,Ua.g4);!Id&&
tc&&(Rc.SelectingDHC=!0)}Pf.a.f6(y.AFrameworkApplication.oc,()=>{this.Gj.c0&&(Ua.g4&&this.Yb.Jg(this.sj.Jr&&!this.Gj.en?zf.AFrame.lR:zf.AFrame.zt),Ua.h8c&&this.Ep.eta(ja)||!Ua.g4&&!Ua.kca||this.lDh.selectComment(ja.id))},ff.a.qyg);tc=this.Ep.zLf(yb);this.pG&&tc&&tc.id!==Wb.id&&this.pG.fireEvent(9,{comment:tc});this.xi.selectComment(ja);this.pG&&ja.Fr===Oe.a.normal&&!ja.Of&&this.pG.fireEvent(8,{comment:ja});this.BMe.highlightComment(ja,!0);this.Ey.qH(0,Wb,yb);jg.StaticActiveAppFrame.za().Fe(!0);0<
Object.keys(Rc).length&&this.nJ.Vw(Nb.a.selectComment,{Yl:Rc})}}}Object(f.a)(tk,"CommentSelectionActor",null,[637]);class tm extends wh.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new ng.a,{T_:tm.getTypeName(),B_:tm.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(f.a)(tm,"CommentSmartReplySignal",wh.a,[]);class Ml extends hb.a{constructor(){super();this.DomainName=
this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new ng.a,{T_:Ml.getTypeName(),B_:Ml.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(f.a)(Ml,"SmartReply",hb.a,[]);var Pp=d(862);class bi{constructor(ja){this.wwa=ja}nfc(ja,Ua){return Object.assign(new Pp.a,{parentPath:["Signal",tm.getTypeName()],items:[Object.assign(new Af.a,{body:Object.assign(new tm,{commentId:ja,
comment:Ua})})]})}rkg(ja){const Ua=new G.a;if(ja&&ja.CommentId&&ja.ResultSets&&0<ja.ResultSets.length&&ja.ResultSets[0].Documents&&0<ja.ResultSets[0].Documents.length){for(const yb of ja.ResultSets[0].Documents)Ua.add(yb.Caption);0<Ua.count&&this.wwa.rkg(ja.CommentId,Ua.toArray())}else a.ULS.sendTraceTag(574493152,327,10,"Invalid response from SmartReplies request")}getTypeName(){return Ml.getTypeName()}}Object(f.a)(bi,"BaseCommentSmartReplyProvider",null,[1871]);class Mq extends bi{constructor(ja,
Ua,yb,Wb){super(ja);this.Te=Ua;this.yC=yb;this.pmk=Wb}initialize(){this.yC.hm().then(()=>{this.Te.nb(this,bi.prototype.getTypeName.call(this))})}invoke(ja,Ua){this.yC.hm().then(()=>{this.pmk.getAugLoopRuntimeManager().submitOperation(Object.assign(new Qf.a,{operation:this.nfc(ja,Ua)}))})}ZG(ja,Ua){ja&&Ab.a.getTypeNameFor(ja.content)===this.getTypeName()&&Ua===pb.a.getTypeName()?this.rkg(ja.content):a.ULS.sendTraceTag(579170963,327,10,"Invalid annotation event for smart replies")}}Object(f.a)(Mq,"CommentSmartReplyProvider",
bi,[229]);var Ri=d(36),sh=d(136),Xi=d(615);class Ah{constructor(ja,Ua,yb,Wb,tc,Rc){this.Ga=ja;this.Bd=Ua;this.yz=yb;this.qZe=Wb;this.DMe=tc;this.lS=Rc;this.ZDb=!1;this.DMe.oto();this.Gah=this.Ezm();this.lpg&&(Ri.a.addHandler(window.self,af.a.JPh,()=>{this.ZDb=!0}),Ri.a.addHandler(window.self,af.a.KPh,()=>{this.ZDb=!1}));0<this.Gah&&y.AFrameworkApplication.vd("77dda873;fe8jd931")}get ov(){return this.yz?this.yz.value:null}get vIa(){return this.qZe.value}get Nnp(){return this.ZDb}get elc(){return 0<
this.Gah}get Jr(){return this.lS.Jr}get tSl(){return!0}get g1b(){return this.Bd.isFeatureEnabled(107)&&!Xi.a.q9c}get DLo(){return this.Bd.isFeatureEnabled(31)&&this.Ga.$("SendErrorReportOnCommentInboundCrashIsEnabled")}get stl(){return this.Ga.$("CommentAnchorHighlightOnIpSelectionIsEnabled")}get lpg(){return!1}get xfj(){return this.Ga.$("NoHighlightWhenCommentDraftInProgressIsEnabled")}get UMb(){return this.Jr&&!this.elc&&!this.Ga.ib("BootActivityNavigationId")&&F.a.eu}get S8k(){return this.Ga.$("AtMentionUserFloodGateCampaignIsEnabled")}get Jtl(){return this.Ga.$("CommentFriendlyTimestampsIsEnabled")}get kSl(){return this.Ga.ib("DisabledChangeGatesInSharedComments")}get N2d(){return this.lS.N2d}get v0b(){return F.a.LR?
this.oze:this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordTrackChangesSimpleMarkupView",!1)}get oze(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.SimpleMarkupModeInSafari",!1)}get mDg(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartRepliesIsEnabled",!1)}get y0(){return this.Ga.ib("PresenceUserId")}get Oga(){return Xi.a.QFe&&!!sh.PageReader.instance&&sh.PageReader.instance.PAa(jg.StaticActiveAppFrame.za().kb.$c).Oga}get Rob(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableDurableIdForIdentification",
!1)}get Jep(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",!1)}get Aul(){return this.Ga.$("CommentsTasksFpsIsEnabled")}get trackChangeInSidetrackEnabled(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.TCCardInSideTrack",!1)}get Rvn(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.LikeSelectedContentFlotie",!1)}get contentNavigationApiEnabled(){return this.lS.contentNavigationApiEnabled}get G3n(){return this.Bd.isFeatureEnabled(80)}get contentFilterApiEnabled(){return this.lS.contentFilterApiEnabled}get V6o(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.SkipParaTraversalIfNoComments",
!1)}get ribbonCommentFilteringEnabled(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCommentFilteringEnabled",!1)}get Bif(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.AtMentionBookmarkFixup",!1)}Ezm(){if(this.ov&&this.vIa){const ja=new ac.a;ja.set(this.ov);this.vIa.wbb(ja);let Ua=0;39===ja.mf&&(Ua=ja.zq());return Ua}return-1}}Object(f.a)(Ah,"CommentsSettings",null,[]);class He{constructor(){this.e7g=null;this.c0=!1;this.XVb=this.nnb=null;this.hz=new sc.a(new ie.a);
this.JX=new sc.a(new ie.a);this.Log=this.xRb=!1;this.YNa=!0;this.filter={mentionsToCurrentUser:!1,resolutionStatus:0}}get en(){return nh.a.en}set en(ja){nh.a.en=ja}get Flb(){return this.e7g}set Flb(ja){this.e7g=ja}}He.nk=1;Object(f.a)(He,"CommentsState",null,[]);var wb=d(1345);class ic{constructor(ja){this.Zca=ja}qWh(ja,Ua,yb){const Wb=new ld;Ua=this.Zca.yXa(Ua)?Ua.objectId:null;if(!Ua)return Wb;Ua=Ib.a.Cf(Ua);if(yb.contains(Ua))return Wb.E6c=0,Wb.D6c=ja.length,Wb;for(let Rc=0,Id=ja.length;Rc<Id;Rc++){var tc=
ja[Rc];yb=Zd.g(tc);tc=Zd.d(tc);yb&&wb.a.g5h(yb,Ua)&&(Wb.E6c=Rc);if(tc&&wb.a.g5h(tc,Ua)){Wb.D6c=Rc;break}}return Wb}KRh(ja,Ua,yb){const Wb=-1===Ua.E6c&&-1===Ua.D6c,tc=-1<Ua.E6c?Ua.E6c:-1;Ua=-1<Ua.D6c?Ua.D6c:ja.length;const Rc=!Wb&&tc===Ua;var Id=!1;for(let Pd=0;Pd<ja.length;Pd++){const Rd=ja[Pd],Ue=Ag.a(Rd);if(1!==Ue&&2!==Ue&&3!==Ue)continue;this.Zca.BZa(Rd);if(Wb||Pd<tc||Pd>Ua)continue;const tf=3===Ue||2===Ue&&-1!==Rd.className.indexOf(Eg.a.xWa),cg=yb?1:2;this.q6k(Pd,tc,Ua,cg,tf,Id,Rd,Rc);if(Pd!==
Ua||Rc)(Id=this.Zca.X9a.K(Ue).K(cg))&&Rd.classList.add(Id),Id=tf}}q6k(ja,Ua,yb,Wb,tc,Rc,Id,Pd){ja!==Ua&&ja!==yb||tc||Rc||((ja=this.Zca.ltc.K(Wb))&&Id.classList.add(ja),Pd&&Id.classList.add(Eg.a.Pjg))}}Object(f.a)(ic,"DefaultHighlightChangeHandler",null,[636]);var Zc;(function(ja){ja[ja.success=0]="success";ja[ja.ao=1]="noSelection";ja[ja.I1p=2]="invalidContent"})(Zc||(Zc={}));Object(f.b)("AnchorCreationResult",Zc);var dd=d(62),Bd=d(22),Bf=d(274),Zf=d(253),Of=d(1010);class Ff{}Object(f.a)(Ff,"EditorAnchorInfo",
null,[620]);class hg{constructor(ja,Ua,yb,Wb,tc,Rc,Id,Pd,Rd){this.lvn=ja;this.E2f=Ua;this.xj=yb;this.xBa=Wb;this.uIa=tc;this.iq=Rc;this.TH=Id;this.av=Pd;this.pIg=Rd;this.cDh=null;this.xBa.iNa(this.uIa);this.av.contentFilterApiEnabled&&(this.TH.T3("OnCommentPaneOpen",this.Ttp.bind(this)),this.TH.T3("OnCommentPaneClose",this.Stp.bind(this)),this.TH.T3("OnContentFilterUpdate",this.qed.bind(this)))}get mb(){return this.E2f.value}get Dj(){return this.lvn.value}initialize(){}t4m(ja){this.cDh=ja}dispose(){}Drb(ja){this.uIa.Drb(ja)}ylc(ja){this.uIa.ylc(ja)}highlightComment(ja){this.OIj(ja,
!1);this.uIa.Drb(ja.objectId)}fAc(ja){this.uIa.fAc(ja)}jKa(ja){return this.uIa.jKa(ja)}qed(){this.MHe("OnContentFilterUpdate")}Ttp(){this.MHe("OnCommentPaneOpen")}Stp(){this.MHe("OnCommentPaneClose")}MHe(ja){const Ua=[],yb=new Set;for(const tc of this.xj.qR())if(!tc.Of&&tc.Fr!==Oe.a.VD&&!this.xj.jL.RYh(ja,tc)){var Wb=this.IAm(tc);yb.has(Wb.id.toString())||(yb.add(Wb.id.toString()),(Wb=Wb.Be(Object(dd.a)().Ad.pc))&&Ua.push(Wb))}Ua.forEach(tc=>{this.xBa.gAc(tc)})}IAm(ja){var Ua,yb,Wb;const tc=null===
(Ua=this.Dj)||void 0===Ua?void 0:Ua.Eb(ja.objectId);if(!tc)return null;ja=Zd.k(tc);Ua=null===(yb=this.Dj)||void 0===yb?void 0:yb.Eb(ja);return null===(Wb=this.pIg.instance)||void 0===Wb?void 0:Wb.uQb(Ua)}OIj(ja,Ua){if(!ja.Fr){var yb=this.Dj.Eb(Ib.a.Cf(ja.objectId)),Wb=Nc.a.efa(yb,this.Dj,!0);yb=Nc.a.efa(yb,this.Dj,!1);if(Wb&&yb){const tc=Wb.Jb.paragraph;Wb=Wb.Jb.cp;if(this.$nn(tc,Wb))jg.StaticActiveAppFrame.za().Fe(!0);else{Wb=Bd.SelectionFactory.ue(tc,Wb);yb=gd.a.Tc(yb.Jb.paragraph,yb.Jb.cp);if(hg.rg.eba(Wb.Qa)||
hg.rg.eba(yb))ja.hXa=!0,ja.tbb();ja=Ua?Bd.SelectionFactory.Qy(Wb,yb):Wb;this.cDh(ja)}}}}ppl(){this.uIa.ylc(null);this.uIa.Drb(null)}YAl(){const ja=new Ff;return{returnValue:Zc.success,anchor:ja}}$nn(ja,Ua){if(ja&&Object(xk.a)(Of.a,this.iq.Ad)){var yb=ja.Be(this.iq.Ad.pc);ja=document.getElementById(Ik.a.E0a);if(yb&&ja){Ua=Bf.a.Ar(yb,Ua);if(!Ua)return!1;Ua=Ua.y;yb=Sys.UI.DomElement.getBounds(ja).y;ja=ja.offsetHeight;if(Ua>=yb&&Ua<=yb+ja)return!0}}return!1}static get rg(){return Zf.a.instance}static getInstance(){return hg.Pm()}static Pm(){return hg._instance||
(hg._instance=new hg(new Ta.a(()=>jg.StaticActiveAppFrame.za().kb.$c.td),new Ta.a(()=>ul.a.instance),C.a.instance.resolve(740),C.a.instance.resolve(362).instance,C.a.instance.resolve(741),Object(dd.a)(),C.a.instance.resolve(742),C.a.instance.resolve(743),C.a.instance.Ra(595)))}}hg._instance=null;Object(f.a)(hg,"EditorCommentHintManager",null,[599,600,10]);var Jk=d(64),Fg=d(2079),Un=d(353),$o=d(1100);class fh extends Tk.a{constructor(ja,Ua,yb,Wb,tc,Rc,Id,Pd,Rd,Ue,tf,cg,fg,Mg,Fh,zj,om,ej,Kj,Tl,nj,Nn,
ui,oq,rp,Am){super(Id);this.Di=Ua;this.eFb=Pd;this.dpf=Ue;this.xwa=tf;this.gEc=cg;this.WS=fg;this.sj=Mg;this.Mp=Fh;this.U4b=zj;this.Gj=om;this.f1=ej;this.Xd=Tl;this.nJ=nj;this.BW=ui;this.H6a=oq;this.pIg=Am;this.OMi=this.cFh=this.z2a=null;this.evb=()=>{this.gwa.qta()&&(this.lzj(this.gwa.Jc),this.gwa.Iuc(this.evb))};this.Ncd=Bh=>{Zd.x(void 0,Bh.mode)?1===Bh.mode&&(this.UE=0):this.UE=1;this.xi.Vy&&0===this.UE?a.ULS.sendTraceTag(542914062,327,50,"Switch to read only mode while drafting a comment with drafting session type [{0}].",
this.xi.Vy.FA.sessionType):this.Gj.c0&&(this.fE||this.e5.isVisible)&&this.KYb()};this.rRn=()=>{this.Gj.xRb?this.mode=0:this.UE=0};this.DMa=(Bh,ml)=>{var nl;Bh=ml.Rm.currentSelection;if((this.fE||this.yga&&this.yga.isVisible)&&!this.U4b.f8e&&Bh){ml=Cl.a.Am(Bh);var um=Bh.kP;null!==(nl=this.OMi)&&void 0!==nl&&nl.Nea||(this.Ep||a.ULS.sendTraceTag(509698397,327,15,"onSelectionChange: CommentModel Not Set."),nl=this.Ep&&this.Ep.Bsb(this.ga,!1),1!==this.mode||ml&&!um||!nl?this.gEc.q$d():this.iFl(Bh));2!==
this.mode&&3!==this.mode&&this.sj.stl&&this.Slp(Bh,ml,um)}};this.Mml=()=>{if(this.xj&&this.xj.Vy&&!Ra.a.$Vf){var Bh=this.xj.Vy;Bh.FA.sessionType!==Fg.a.metadata&&(a.ULS.sendTraceTag(545640771,327,15,`Draft Comment of type:${Bh.Fr} present on app shutdown`),(Bh=nd.a.Qnm(Bh))&&this.nJ.logKpiFailure(Bh,"CommentDraftLostOnAppShutdown",{isInternal:!0},{name:Dd.a.zLb,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}))}};this.BRn=()=>{if(this.Gj.c0){var Bh=()=>!0;this.fE&&!this.Gj.en&&(Bh=ml=>this.Ep.eta(ml));
Bh=this.Ep.sGf(Bh);this.KYb(Bh)}};this.ga=Id;this.UE=Zd.x(this.ga.mode,void 0)?0:1;this.e5=tc;this.xi=Wb;this.pda=Rc;this.Yb=Rd;this.pso();yb.Ucb(this.xwa);this.mb.tA(this.DMa);ja.CWR(()=>ja.result.iC.Oya(this.rRn));y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.D5a(this.Ncd);this.f1.T3("OnAfterTrackChangeMarkupViewChange",this.BRn);y.AFrameworkApplication.XI&&y.AFrameworkApplication.XI(this.Mml);rp.execute(Bh=>{this.pG=Bh});Nn.execute(Bh=>{Bh.tyl.execute(ml=>{this.OMi=ml})})}pso(){this.gwa&&
(this.gwa.qta()?this.lzj(this.gwa.Jc):this.gwa.jcc(this.evb))}lzj(ja){ja.g6(()=>{this.v$o()})}get gwa(){var ja;return null===(ja=Xi.a.Mm)||void 0===ja?void 0:ja.kb}get mb(){return this.eFb.value}get xj(){return this.xi}get Ep(){return this.xi}get fE(){return this.sj.Jr}get ifj(){return!0}get FJj(){return!0}get Jlc(){return this.z2a}set Jlc(ja){this.z2a=ja}get mode(){return super.mode}set mode(ja){ja!==this.UE&&(super.mode=ja,this.tbb())}get eB(){return this.model&&this.model.lu?this.model.lu.Of?this.model.yF(this.model.lu.Of):
this.model.lu:null}get Dj(){return this.Di.value}get iSj(){return!1}get Oga(){return this.sj.Oga}KYb(ja=null){var Ua=this.Ep;const yb=!this.UE,Wb=this.yga.Gtl,tc=Ua.S6d();Wb.pLg(tc?5:1,yb);ja=this.sj.v0b&&ja?ja:Ua.SGf(this.sj.v0b&&this.fE&&!this.Gj.en);Wb.vLo(ja,tc,Ua.q1a);this.TKg();Ua=0;nd.a.mxf&&(Ua=+new Date-+nd.a.mxf);clearTimeout(nd.a.Pzj);a.ULS.sendTraceTag(572281362,327,50,`Comment Context Reloaded, Time Taken: ${Ua}`)}sed(ja,Ua,yb=!1){this.Gj.en?this.WS.w7j():Ua?this.WS.dJa(ja.Fr===Oe.a.VD?
ja.FA.draftId:ja.id,0,yb):this.pko(ja)}pko(ja){const {Egp:Ua}=this.xi.Etm(ja),yb=this.pda.jKa(ja.objectId);yb&&this.WS.Rbc(ja.id,yb.parentElement,0,Ua)}YIj(ja){const Ua=this.eB;this.emd();this.xwa.qH(0,this.xi.lu,Ua);this.fE&&this.xi.lu&&!this.Gj.en&&this.WS.$Za(this.xi.lu.id,0,1===ja)}vKo(){const ja=this.eB;this.fmd();this.xwa.qH(0,this.xi.lu,ja);this.fE&&this.xi.lu&&!this.Gj.en&&this.WS.$Za(this.xi.lu.id,0,!1)}fAc(ja){this.pda.fAc(ja)}OXl(ja,Ua){this.WS.Rbc(ja,null,0,Ua)}K7n(ja){this.WS.Uqj(ja)}QXl(ja,
Ua){this.WS.kkd(ja,Ua,0)}btp(){this.WS.zif()}RIj(ja){if(ja&&(2!==this.mode||ja.Fr===Oe.a.VD)){var Ua=this.xi.lu;Ua!==ja&&(this.xi.selectComment(ja),this.e5.isVisible?this.Gj.c0?(this.e5.selectComment(ja,1),this.Woa.selectComment(ja.id)):this.Gj.nnb=Object.assign(new Jg,{commentId:ja.id,Z9c:!1}):this.fE&&!ja.done&&(this.VIj(ja.id,!1),this.Woa.selectComment(ja.id)),!this.e5.isVisible&&this.fE&&ja.done||(this.zlc.Drb(ja.objectId),this.xwa.qH(0,this.eB,Ua)))}}U6c(){}uzf(){this.Gj.xRb=!1}FJb(ja){this.sj.xfj&&
this.xi.lu&&this.clearSelection();super.FJb(ja);this.nJ.logKpiUsage(Dd.a.qpf,0);this.TKg();if(this.fE){const Ua=this.xi.PLm(ja.draftId);this.OXl(ja.draftId,Ua)}}Llb(ja,Ua){this.nJ.logKpiUsage(Dd.a.aWd,0);super.Llb(ja,Ua)}yza(ja){this.fE&&null!=ja.FA&&this.xi.qAj(ja.FA.draftId);super.yza(ja);this.pda.Drb(ja.objectId);a.ULS.sendTraceTag(50426376,327,50,"{0}:  added by user action.",Zd.a(ja));this.nJ.logKpiUsage(Dd.a.o3h,0);this.Sml(ja);nd.a.fBp(ja,this.Dj,this.nJ);this.nJ.Vw(Nb.a.n3h,{succeeded:!0,
Yl:{actionType:ja.Of?Fg.a.reply:Fg.a.create}})}pnb(ja){super.pnb(ja);this.nJ.Vw(Nb.a.n3h,{succeeded:!0,Yl:{actionType:Fg.a.Bob}})}Sml(ja){if(ja.Of){var Ua=this.xi.zLf(ja);if(Ua.iSc&&Ua.jSc){var yb=this.Dj.Eb(Ib.a.Cf(Ua.jSc));Ua=Ua.jSc===Ua.iSc?null:this.Dj.Eb(Ib.a.Cf(Ua.iSc));nd.a.hQg(yb,ja,!0);nd.a.hQg(Ua,ja,!1)}}}YXc(ja){super.YXc(ja);this.eB&&this.eB.id===ja.id&&(super.clearSelection(),this.fE&&this.WS.pec());if(this.fE)if(Zd.s(ja)){var Ua=[];let yb=null;for(const Wb of this.model.qR())Wb!==ja&&
(Wb.Of===ja.Of&&Ua.push(Wb),Wb.id===ja.Of&&(yb=Wb));yb&&yb.id&&yb.objectId&&!yb.done&&this.Ep.uI(yb.objectId)&&!this.Ep.Hrj(yb.objectId)&&!Ua.length&&this.sed(yb,!0)}else Ua=ja.Fr===Oe.a.VD,ja.done||this.sed(ja,!0),Ua&&this.xi.qAj(ja.FA.draftId)}Cob(ja,Ua){1===this.mode&&ja&&(this.xi.gZc(ja,Ua),Fg.a.Bob===Ua.sessionType&&this.nJ.logKpiUsage(Dd.a.t3h,0),this.sj.g1b&&3!==Fg.a.CJf(Ua.sessionType)&&this.U4b.selectComment(ja,Object.assign(new Kl.a,{g4:!1,kca:0})))}tve(ja){this.fE&&!this.Gj.en||super.tve(ja)}deleteComment(ja){ja.Fr!==
Oe.a.VD&&this.Ep.Wci(Ib.a.Cf(ja.objectId));this.z2a&&this.z2a.id===ja.id&&(this.xi.lu&&this.z2a.id===this.xi.lu.id?this.z2a=null:this.xwa.Qnf());!this.xi.lu||this.xi.lu.id!==ja.id&&this.xi.lu.Of!==ja.id?this.xi.lu&&this.xwa.qH(0,this.xi.lu,null):void 0===ja.Of||null===ja.Of?this.clearSelection():this.xi.selectComment(this.xi.yF(ja.Of));ja.hXa&&a.ULS.sendTraceTag(556360779,327,50,"The comment selected for deletion is currently locked: {0}.",Zd.a(ja));super.deleteComment(ja);a.ULS.sendTraceTag(50426377,
327,50,`${Zd.a(ja)} deleted by user action. DurableId: ${ja.K7a}`)}iLb(ja,Ua){super.iLb(ja,Ua);this.fE&&!this.Gj.en&&Ua&&(this.xi.lu&&this.xi.lu.id===ja.id&&this.clearSelection(),this.Jlc&&this.Jlc.id===ja.id&&this.xwa.Qnf())}uKo(ja=null){(ja=this.Ep.Ojm(ja))?this.U4b.selectComment(ja,Object.assign(new Kl.a,{g4:!0,kca:1})):this.YIj(1)}iFl(ja){var Ua,yb=this.gwa.Jc;if(yb){var Wb=ja.Qa.node,tc=null===(Ua=this.pIg.instance)||void 0===Ua?void 0:Ua.uQb(Wb);if(tc)for(const Rc of yb.Z6(tc))if(Rc&&Rc instanceof
Un.a&&(Ua=Rc,yb=$o.a.N9h(Ua),this.gEc.PEe=this.l4l(Wb,ja),tc=this.lhl(yb),null!==tc)){if(ja=this.gEc.b4l(yb,tc))yb.TKa[tc].appendChild(ja),Ua.UF(ja);break}}}l4l(ja,Ua){let yb;for(const Wb of ja.gJ)if(Wb&&Wb){yb=Wb;break}ja=Ua.Qa.Hj;Ua=!(null===yb||void 0===yb||!yb.lp)&&0<yb.lp.length;return 0>ja||!Ua||null===yb||void 0===yb||!yb.rAf?null:Bf.a.h2(ja,yb,!1,!1)}lhl(ja){var Ua;const yb=null===(Ua=this.gEc.PEe)||void 0===Ua?void 0:Ua.y;for(const [Wb,tc]of ja.m7.entries())if(ja=yb-tc.y,-2<=ja&&ja<tc.height+
2)return Wb;return null}tbb(){Ra.a.orb=2===this.mode||3===this.mode;1!==this.mode&&this.gEc.q$d()}Slp(ja,Ua,yb){const Wb=this.Yb.currentScope;let tc=null;if(Ua||yb){Ua=ja.Qa.cpBegin;ja=ja.Qa.node;if(this.eB&&Zd.r(this.eB,ja,this.Dj,Ua))return;tc=this.iym(ja,Ua)}tc?!this.fE||this.Gj.en?Pf.a.f6(y.AFrameworkApplication.oc,()=>{this.RIj(tc)},ff.a.nKo):this.RIj(tc):!this.xi.lu||Wb&&Wb.name===zf.AFrame.lR||this.clearSelection()}iym(ja,Ua){let yb=null;const Wb=this.model.qR();for(let tc=Wb.length-1;0<=tc;tc--){const Rc=
Wb[tc];if(Rc.objectId&&!(Rc.Of||this.fE&&!this.yga.isVisible&&Rc.done)&&Zd.r(Rc,ja,this.Dj,Ua)){yb=Rc;break}}return yb}selectComment(ja,Ua=1){this.U4b.SIj(ja,Object.assign(new Kl.a,{g4:1===Ua,kca:Ua}))}VIj(ja,Ua){const yb=this.xi.yF(ja);yb?this.fE&&!Zd.s(yb)&&yb.Fr!==Oe.a.VD&&this.WS.$Za(ja,0,Ua):a.ULS.sendTraceTag(42332933,327,10,"Selected Comment isn't in the model.")}clearSelection(){const ja=this.model.lu;this.pG&&ja&&this.pG.fireEvent(9,{comment:ja});super.clearSelection();this.xwa.qH(1,ja,ja);
this.fE&&ja&&this.WS.pec()}Bnn(){var ja;return 500>(null===(ja=this.cFh)||void 0===ja?void 0:ja.Ei)}Erc(ja,Ua=1){if(!this.sj.xfj||!this.xi.Vy){var yb=this.xi.yF(ja),Wb=null;yb||(Wb=this.z2a);var tc=this.Bnn(),Rc=!1;1===Ua&&this.Woa&&(tc?Rc=!0:this.Woa.highlightComment(ja));ja?yb?tc?Rc=!0:this.pda.ylc(yb.objectId):a.ULS.sendTraceTag(37323346,327,10,"Comment is NOT in the model, but we are trying to hightlight!"):this.pda.ylc(null);yb?tc?Rc=!0:(this.z2a=yb,this.xwa.qH(2,yb,Wb)):(this.z2a=null,this.xwa.qH(3,
null,Wb));Rc&&a.ULS.sendTraceTag(544532572,327,50,"Comment highlighting was skipped due to the user actively scrolling.")}}v$o(){this.Xd&&(this.cFh=this.Xd.Wf("UserAction","StartScrollDetectionStopwatch"))}notify(ja,Ua){this.Mp.sendNotification(ja,Ua)}TKg(){this.H6a.onContentChanged()}RYh(ja,Ua){var yb,Wb;switch(ja){case "OnCommentPaneOpen":case "OnCommentPaneClose":return this.P6o(Ua);case "OnContentFilterUpdate":return!(null===(Wb=(yb=this.H6a).isContentInFilterUpdateDiff)||void 0===Wb?0:Wb.call(yb,
Ua.id));default:return!0}}P6o(ja){return!ja.done&&this.Ep.eta(ja)===this.H6a.isContentInFilteredContent(ja.id)}static getInstance(){return fh.Pm()}static Pm(){fh.hh||(fh.hh=new fh(Jk.a.Isa(),new Ta.a(()=>jg.StaticActiveAppFrame.za().kb.$c.td),C.a.instance.resolve(368).instance,C.a.instance.resolve(744),C.a.instance.resolve(745),hg.getInstance(),y.AFrameworkApplication.va,new Ta.a(()=>ul.a.instance),zm.FocusManager.instance(),C.a.instance.resolve(746),C.a.instance.resolve(747),C.a.instance.resolve(748),
C.a.instance.resolve(749),C.a.instance.resolve(743),C.a.instance.resolve(26),C.a.instance.resolve(750),C.a.instance.resolve(751),C.a.instance.resolve(742),Xi.a.Mm.kb.Jc,jg.StaticActiveAppFrame.za().Vr,C.a.instance.resolve(752),C.a.instance.Ra(753),C.a.instance.resolve(754),C.a.instance.resolve(609),C.a.instance.Ra(755),C.a.instance.Ra(595)),fh.hh.S_b=!0);return fh.hh}}fh.hh=null;Object(f.a)(fh,"EditorCommentManager",Tk.a,[569,570,571,10]);var Mn=d(1761);class gj{constructor(ja,Ua,yb,Wb){this.cancelButton=
this.confirmButton=this.body=this.title=null;this.title=ja;this.body=Ua;this.confirmButton=yb;this.cancelButton=Wb}}Object(f.a)(gj,"ViewContainerModalDialogStrings",null,[]);d(1356);class cm{constructor(ja,Ua){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;this.canvasActionId=ja;this.canvasContextId=Ua}}Object(f.a)(cm,"CommentUIAction",null,[]);var Oo=d(1492);class ik{constructor(ja,
Ua,yb,Wb,tc,Rc,Id,Pd,Rd,Ue,tf,cg,fg,Mg,Fh,zj,om){this.ga=ja;this.Dg=Ua;this.oe=yb;this.Yb=Wb;this.Zp=tc;this.hi=Rc;this.V5=Id;this.wwa=Pd;this.aPd=Rd;this.xbf=Ue;this.Gb=tf;this.WS=cg;this.sj=fg;this.Gj=Mg;this.U4b=Fh;this.f1=zj;this.Toa=om;this.BMe=this.Fj=null;this.gDh=this.g7g=!1;this.mNc=null;this.h4o=(ej,Kj,Tl)=>2!==Tl||this.Gj.c0?1===Tl?32:2:(this.f1.R3("OnCommentInit",Object.assign(new an.a,{nMa:()=>{this.ga.Ob(li.a.pY,2)}})),32);this.KTf=(ej,Kj,Tl)=>1!==Tl||this.Gj.c0?2:8;this.tSk=(ej,Kj,
Tl)=>{if(1===Tl)return!this.Bsb()||this.Jlb?8:this.Gj.c0?2:32;if(!this.Gj.c0)return this.Jlb=!0,this.f1.R3("OnCommentInit",Object.assign(new an.a,{nMa:()=>{this.Jr||this.Gj.en||this.ga.Ob(li.a.pY,2)}})),32;this.Jr||this.Gj.en||this.ga.Ob(li.a.pY,2);(this.Jr||this.Gj.en)&&this.Yb.Jg(this.Gj.en?zf.AFrame.zt:zf.AFrame.lR);return 2};this.oNl=(ej,Kj,Tl)=>1===Tl&&lh.SessionStatusManager.instance.Hk?8:2;this.RRl=(ej,Kj,Tl,nj)=>1!==nj||(this.Jr||this.isVisible)&&this.Fj.model.lu?ej||this.Fj.model.lu?32:8:
8;this.Arb=(ej,Kj,Tl,nj,Nn)=>{if(1===Tl||!this.Gj.en)return 32;if(!this.Jr&&2===Tl&&(2===this.Fj.mode||3===this.Fj.mode))return Nn=new gj(CommentPaneStrings.DiscardDialogTitle,CommentPaneStrings.DiscardDialogBody,CommentPaneStrings.DiscardDialogAbandon,CommentPaneStrings.DiscardDialogResume),this.aPd.invokeModalConfirmationDialog(()=>{this.wTn(ej,Kj,Tl,nj)},()=>{this.ASn()},Nn),32;this.s$d();if(this.Jr)return 32;Nn&&this.Lhi();return 32};this.hYb=(ej,Kj,Tl,nj,Nn)=>{if(1===Tl)return 32;Nn[wg.a.On]=
this.isVisible;return 32};this.iCc=this.RAl()}get isVisible(){return this.Gj.en}get Jlb(){return this.g7g}set Jlb(ja){this.g7g=ja}get WYo(){return"SharedCommentsTaskPaneProps"}get Pfd(){return null}get Yej(){return null}get bN(){return this.Zp}get yga(){return null}get Gtl(){return this.wwa}get Jr(){try{return this.sj.Jr}catch(ja){return!1}}dAi(){return new Cg(y.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,y.AFrameworkApplication.uiCulture,y.AFrameworkApplication.dataCulture)}RAl(){const ja=
new he.a,Ua=new cm(li.a.hMa,pd.a.frame);Ua.preCallback=this.tSk;const yb=new cm(Nb.a.Rag,pd.a.frame),Wb=new cm(Nb.a.glg,pd.a.frame),tc=new cm(Nb.a.deleteComment,pd.a.frame);tc.preCallback=this.oNl;tc.postCallback=this.RRl;const Rc=new cm(Nb.a.aGj,pd.a.frame);this.Jr&&(yb.preCallback=this.KTf,Wb.preCallback=this.KTf,Rc.preCallback=this.KTf);const Id=new cm(li.a.pY,pd.a.frame);Id.preCallback=this.h4o;ja.Z(6,Id);ja.Z(0,Ua);ja.Z(1,yb);ja.Z(2,Wb);ja.Z(3,tc);ja.Z(7,Rc);return ja}yPj(ja){this.gDh||(this.CNk=
this.L7d(),this.V5.nUa(),this.fYo(),this.$Xo(ja),this.gDh=!0)}$Xo(ja){this.Fj=ja;this.BMe=ja.zlc;this.Fj.aki=this.wwa}initialize(ja){this.yPj(ja);this.Xb()}gUf(){this.mNc&&this.Yb.Jg(zf.AFrame.zt);this.Jlb&&!this.Jr?(this.ga.Ob(li.a.hMa,2),this.Jlb=!1):this.Gj.nnb&&Pf.a.f6(y.AFrameworkApplication.oc,()=>{const ja=this.Gj.nnb.commentId,Ua=this.Gj.nnb.Z9c;this.ga.Pb(Nb.a.selectComment,2,Object.assign(new Kl.a,{commentId:ja,kca:1,g4:!0,h8c:Ua}));Ua&&(Pf.a.f6(y.AFrameworkApplication.oc,()=>{this.Yb.Jg(zf.AFrame.zt)},
ff.a.qyg),Ck.a.instance.qf(Xl.a.wbi,(new Date).getTime()));a.ULS.sendTraceTag(35149083,327,50,"Comment selected in shared comment pane after boot: {0}",(new Date).getTime()-y.AFrameworkApplication.xT);this.Gj.nnb=null},ff.a.mKo)}dispose(){}A8(){}selectComment(){this.isVisible||this.Jr||this.RSj();this.hi.Fe(!0)}Xb(){this.ga.qa(li.a.Arb,pd.a.frame,this.Arb);this.ga.fb(li.a.hYb,pd.a.frame,this.hYb,96)}tbb(){-1!==this.Fj.mode&&(this.Fj.mode||this.Lhi())}Lhi(){const ja=this.Fj,Ua=ja.Ep,yb=Ua.S6d(),Wb=
Ua.SGf(this.sj.v0b&&this.sj.Jr&&!this.Gj.en);this.wwa.uLo(Wb.length,yb,!ja.mode,yb?5:1);this.wwa.ULo(Wb,Ua.q1a)}fYo(){const ja=this.Yb.ie(zf.AFrame.zt);ja.parent=zf.AFrame.Eq;ja.HL=!0;ja.iue=!0;ja.hAb=!0;ja.z5a((Ua,yb)=>{Bg.a.QYh(yb.name)&&(this.Gj.XVb=Pf.a.f6(this.Gb,()=>{yb.name!==zf.AFrame.lR&&2!==this.Fj.mode&&3!==this.Fj.mode&&(this.Fj.clearSelection(),this.hi.Fe(!0));this.Gj.XVb=null},ff.a.mTn))});this.Zp.rW(zf.AFrame.zt);for(const Ua of Zd.u)ja.bindAction(ye.KeyInputManager.nI(Ua),Nb.a.zlf)}DQo(){this.mNc&&
this.xbf.$9l()}O_h(){this.Wtk&&this.DQo()}wTn(ja,Ua,yb,Wb){const tc=this.Fj,Rc=tc.Ep.Vy;Rc&&Rc.FA?tc.dpf.endCommentSession(Rc.FA.draftId):a.ULS.sendTraceTag(40130755,327,10,"Attempting to discard when there is no active draft!");this.Arb(ja,Ua,yb,Wb,!0);Pf.a.f6(this.Gb,()=>{this.hi.Fe(!0)},ff.a.OFo)}ASn(){this.mNc&&this.Yb.Jg(zf.AFrame.zt);this.hi.Fe(!0)}fNa(ja){ja.nt(this.Yb.xZ);ja.nt(this.Yb.yZ)}l0b(ja,Ua,yb){if(1===yb)return 32;this.RSj();return 32}RSj(){this.isVisible||(this.Gj.YNa=!0,this.Gj.c0?
(this.QSl(),this.Gj.en=!0,this.f1.Zre(),this.Yb.iRc(zf.AFrame.zt),this.Jr&&this.sj.v0b&&this.Fj.KYb(this.Fj.model.sGf(()=>!0)),this.Wtk=!0,mm.UISurfaces.Iv().then(ja=>{ja.showTaskPane(fd.a.ZVd,this.CNk);return null}).catch(()=>{a.ULS.sendTraceTag(559273377,327,10,"Error showing comment task pane.")}),this.Fj.Erc(null),this.hi.Fe(!0),this.fNa(this.Yb.ie(zf.AFrame.zt)),this.f1.R3("OnCommentPaneOpen"),a.ULS.sendTraceTag(37007903,327,50,"New Comment Pane opened.")):this.f1.R3("OnCommentInit",Object.assign(new an.a,
{nMa:()=>{this.Gj.en||this.ga.Ob(li.a.pY,2)}})))}QSl(){this.ga.Pb(Nb.a.I6,2,null);this.ga.Pb(Nb.a.KW,2,null)}Bsb(){return this.Toa.Bsb(this.ga,!1)}FJb(){}show(){this.isVisible||this.ga.Ob(li.a.pY,2)}Cob(){return 2}s$d(){this.Fj.l5n();this.Gj.en=!1;if(this.Jr&&this.sj.v0b){const Ua=this.Fj.model;this.Fj.KYb(Ua.sGf(yb=>Ua.eta(yb)))}var ja=zm.FocusManager.instance();ja.currentScope&&ja.currentScope.name===zf.AFrame.zt&&ja.Jg(this.Jr&&(2===this.Fj.mode||3===this.Fj.mode||this.Fj.xj.lu)?zf.AFrame.lR:ja.IW);
this.Zp.ay(zf.AFrame.zt);this.Yb.IXc(zf.AFrame.zt);mm.UISurfaces.Iv().then(Ua=>{Ua.hideTaskPane(fd.a.ZVd,2);return null}).catch(()=>{a.ULS.sendTraceTag(559273378,327,10,"Error hiding Comment Pane.")});this.Jr&&(ja=this.Fj.model.lu)&&this.dsp(ja);this.f1.R3("OnCommentPaneClose");a.ULS.sendTraceTag(572281360,327,50,"New Comment Pane closed.")}dsp(ja){ja.done?this.Fj.clearSelection():this.U4b.Nhi(ja)}t0n(ja=null){this.xbf.TOj(3);this.gUf();if(ja){this.O_h();Ri.a.Wpg(ja,[af.a.contextMenu]);const Ua=this.Yb.ie(zf.AFrame.zt);
this.Dg.yRc(zf.AFrame.zt,ja,Ua.hAb)}}aZn(ja){this.Zp.MK(zf.AFrame.zt);1!==ja&&Pf.a.f6(y.AFrameworkApplication.oc,()=>{this.Yb.EE(zf.AFrame.zt)},ff.a.qyg)}onTaskPaneClose(){this.Gj.c0&&this.xbf.TOj(1)}L7d(){const ja={type:this.WYo,tYp:this.O_h};return Object.assign(new Oo.a,{title:WordEditorIntl.WordEditorStrings.L_Comments,contentProps:ja,hideHeader:!1,width:300,location:2,onOpen:Ua=>{this.mNc=Ua;this.t0n(Ua);this.WS.cIg(!0)},onClose:()=>{this.mNc=null;this.ga.Pb(li.a.Arb,2,!0);this.hi.Fe(!0);this.onTaskPaneClose();
const Ua=this.Fj.Ep;this.Gj.YNa&&Ua.c5c()&&this.WS.cIg(!1)},onShow:Ua=>{this.aZn(Ua)}})}pY(){return 32}}Object(f.a)(ik,"OfficeSharedCommentPane",null,[10,564,565]);var Hm=d(1646),Bk=d(173);class cj{constructor(ja,Ua){this.containerType="full-pane";this.identifier=null;this.ga=ja;this.identifier=Ua}openView(){this.ga.Ob(li.a.l0b,2)}closeView(){this.ga.Pb(li.a.Arb,2,!0)}invokeModalConfirmationDialog(ja,Ua,yb){const Wb=new Bk.StandardDialog;yb&&yb.title&&yb.body&&yb.confirmButton&&yb.cancelButton||(a.ULS.sendTraceTag(35678229,
327,10,"InvokeModalConfirmationDialog: No localized strings provided."),yb=new gj("","","",""));Wb.Fd=1;Wb.Qe(1,yb.confirmButton);Wb.Qe(0,yb.cancelButton);Wb.Ex(yb.title,yb.body,1,tc=>{1===tc?ja():Ua()})}}Object(f.a)(cj,"ViewContainerAPI",null,[559,560]);class po{constructor(ja,Ua,yb){this.ijp=ja;this.Qg=Ua;this.HOa=yb;this.ed=new Ka.a;this.ijp.execute(Wb=>{this.HOa.Kse("OnBeforeTrackChangeMarkupViewChange",(tc,Rc)=>{Rc&&Rc.Eag!==Wb.nk&&this.ed.raiseEvent("OnBeforeTrackChangeMarkupViewChange",Rc)});
this.HOa.Kse("OnAfterTrackChangeMarkupViewChangeEventKey",(tc,Rc)=>{Rc&&Rc.nk===Wb.nk&&(He.nk=Wb.nk,this.ed.raiseEvent("OnAfterTrackChangeMarkupViewChange",Rc))})})}T3(ja,Ua){this.ed.addHandler(ja,Ua)}R3(ja,Ua){this.ed.raiseEvent(ja,Ua)}Zre(){this.Qg.Log||(this.Qg.Log=!0,this.ed.raiseEvent("OnCommentRenderedOnce"))}}Object(f.a)(po,"WordCommentEventsActor",null,[]);var Zp=d(1826);class mq{constructor(){this.insertIndex=0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=
this.authorName=null}}Object(f.a)(mq,"InitCommentSessionResult",null,[]);class lc extends mq{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(f.a)(lc,"BeginDraftingHostResult",mq,[]);var bn=d(2137),Ec=d(2081),yl=d(1016);class np{constructor(ja,Ua,yb,Wb,tc,Rc,Id,Pd,Rd,Ue,tf,cg,fg,Mg,Fh){this.Xi=ja;this.wwa=Ua;this.nkk=yb;this.nkp=Wb;this.npf=tc;this.av=Rc;this.Zu=Id;this.focusManager=Pd;this.kY=Rd;this.Rb=Ue;this.Zk=tf;this.l2=cg;this.Qg=fg;this.jul=Mg;this.hul=Fh;this.x9b=
this.f$=this.ap=null;this.cpk="WordWebCommitNewCommentActivity";this.dpk="WordWebCommitTaskActivity";this.$ok="WordWebCommentReactionActivity";this.Lah=null}get Toa(){return this.f$}Fbo(ja){var Ua;const yb=this.Toa.Vy,Wb=this.f$.qR();if(Wb&&yb){const tc=yl.a.kpb(null!==(Ua=yb.authorId)&&void 0!==Ua?Ua:"");Ua=new Zp.a(yb.authorId,yb.fdc,yb.author,null!==tc&&void 0!==tc?tc:"",!0);ja.author=Ua;ja.insertIndex=Array.indexOf(Wb,yb);ja.authorName=yb.author;ja.authorIdentity="";return null}return Pf.a.rF(-2130915320)}initialize(ja,
Ua,yb,Wb){this.ap=ja;this.f$=Ua;this.x9b=yb;this.Lah=Wb}beginDraftingAsync(ja){if(!ja)return new Promise((Wb,tc)=>{tc(Pf.a.rF(-2130915327))});const Ua=new lc,yb=Fg.a.CJf(ja.sessionType);return void 0===yb||null===yb?new Promise((Wb,tc)=>{tc(Pf.a.rF(-2130915317))}):new Promise((Wb,tc)=>{Pf.a.f6(this.Xi,()=>{if(1!==this.ap.mode)a.ULS.sendTraceTag(40130753,327,10,"Create InitCommentSession Failed. CommentingMode={0}",this.ap.mode),tc(Pf.a.rF(-2130915325));else{this.n_h();try{switch(yb){case 0:if(!this.ap.yga.Bsb()){tc(Pf.a.rF(-2130915326));
return}this.jul.q$d();a.ULS.sendTraceTag(553710798,327,50,`Creating comment for ${ja.draftId}`);this.ap.FJb(ja);break;case 1:if(!ja.threadId||""===ja.threadId){tc(Pf.a.rF(-2130915324));return}if(this.av.mDg){const Pd=this.f$.yF(ja.threadId);if(Pd){const Rd=this.f$.Yti(Pd,!1),Ue=bn.a.$Ob(Pd,Rd,Pd.authorId===this.av.y0);Ue&&this.npf.invoke(ja.threadId,Ue)}else a.ULS.sendTraceTag(579170962,327,10,"Smart reply provider not invoked since comment is null",this.ap.mode)}this.ap.Llb(ja.threadId,ja);break;
case 3:if(!ja.threadId||""===ja.threadId){tc(Pf.a.rF(-2130915324));return}var Rc=this.f$.yF(ja.threadId);if(!Rc){tc(Pf.a.rF(-2130915323));return}this.ap.Cob(Rc,ja);break;case 2:if(!ja.commentId||""===ja.commentId){tc(Pf.a.rF(-2130915324));return}const Id=this.f$.yF(ja.commentId);if(!Id){tc(Pf.a.rF(-2130915323));return}this.ap.Cob(Id,ja)}}catch(Id){tc(Id);this.zEj();a.ULS.sendTraceTag(553677466,327,10,`Drafting Exception ${Id} on Session ${yb}`);return}(Rc=this.Fbo(Ua))?tc(Rc):Wb(Ua);this.zEj()}},
ff.a.beginDraftingAsync)})}commit(ja,Ua,yb){const Wb=this.Toa.Vy;if(!Wb)throw Pf.a.rF(-2130915320);var tc=Wb.FA;if(!tc)throw Pf.a.rF(-2130915320);const Rc=Fg.a.CJf(tc.sessionType);if(void 0===Rc||null===Rc)throw Pf.a.rF(-2130915317);if(ja!==tc.draftId)throw Pf.a.rF(-2130915327);let Id=!1,Pd=!1;tc=!1;switch(Rc){case 3:if(!yb)throw Pf.a.rF(-2130915327);break;case 0:this.Zk.$d(()=>{if(!this.ap.yga.Bsb())throw Pf.a.rF(-2130915326);Wb.text=[Ua];this.ap.fE&&!this.Qg.en?this.ap.K7n(()=>{this.ap.yza(Wb);
this.ap.QXl(ja,Wb.id)}):this.ap.yza(Wb);Pd=yb&&null!=yb.Task;Id=!0;Pf.a.f6(this.Xi,()=>{this.Exb(Wb.id)},ff.a.Exb)},"WESCA:C:C");break;case 1:this.Zk.$d(()=>{Wb.text=[Ua];this.ap.yza(Wb);Pd=yb&&null!=yb.Task;Id=!0},"WESCA:C:R");break;case 2:this.Zk.$d(()=>{Wb.text=[Ua];this.ap.pnb(Wb);this.cuj(Nb.a.yzn)},"WESCA:C:E");break;default:throw Pf.a.rF(-2130915322);}yb&&(yb.Resolve&&(this.rLj(Wb,yb.Resolve.isResolved),yb.Resolve.isResolved&&!this.Qg.en&&this.ap.notify(Box4Intl.Box4Strings.L_CommentResolved,
!0)),yb.Task&&this.ap.Jul(Wb,yb.Task),yb.Reaction&&(tc=!0,yb.Reaction.isActive?this.ap.fQd(Wb,yb.Reaction.reactionType):this.ap.Yse(Wb,yb.Reaction.reactionType)));this.av.Aul&&Pd&&this.kY.execute(Rd=>Rd.logActivity(this.dpk,"CommentsTasksFpsIsEnabled"));Id&&this.kY.execute(Rd=>{Rd.logActivity(this.cpk,"CommentsFpsIsEnabled")});tc&&this.kY.execute(Rd=>{Rd.logActivity(this.$ok,"CommentReactionsFpsIsEnabled")});return Wb.id}endCommentSession(ja){const Ua=this.Toa.Vy;if(Ua){if(Ua.FA&&Ua.FA.draftId!==
ja)throw Pf.a.rF(-2130915327);if(Ua.Fr===Oe.a.VD)this.ap.deleteComment(Ua),!this.ap.fE||Ua.Of||this.Qg.en||this.focusManager.Jg(zf.AFrame.Ro);else{if(3!==this.ap.mode){a.ULS.sendTraceTag(33621450,327,50,"CommentingMode != EditingComment at the time of ending a comment session");return}Ua.Fr=Oe.a.normal;Ua.YZa=Ec.a.succeeded;Ua.FA=null;this.ap.ymf()}}this.Zu&&this.Zu.Fe(!0);this.Toa.S6d()||this.wwa.pLg(1,!this.ap.mode)}deleteComment(ja){(ja=this.f$.yF(ja))?(this.ap.deleteComment(ja),this.ap.fE&&!this.Qg.en?
ja.Of||this.focusManager.Jg(zf.AFrame.Ro):this.focusManager.EE(zf.AFrame.zt),this.nkp.sBg(ja)&&this.cuj(Nb.a.I8i)):a.ULS.sendTraceTag(594600902,327,15,"Comment to delete is not in the model.")}selectComment(ja){this.Exb(ja,0)}highlightComment(ja){this.ap.Erc(ja,0)}setThreadResolvedState(ja,Ua){(ja=this.f$.yF(ja))&&this.rLj(ja,Ua)}rLj(ja,Ua){if(ja.Of&&""!==ja.Of)throw Pf.a.rF(-2130915321);this.ap.iLb(ja,Ua);Ua&&!this.Qg.en&&this.focusManager.Jg(zf.AFrame.Ro)}presentLinkToComment(ja){var Ua=this.f$.yF(ja);
Ua?(Ua=this.Toa.g5d(Ua))?(ja={["nav"]:btoa(`{"${Mc.a.comment}":${Ua}}`),["mode"]:"copy"},this.hul.Vw(Nb.a.presentLinkToComment),this.Rb.Pb(li.a.Aaa,2,ja,{["ControlId"]:"CopyLinkToComment"})):a.ULS.sendTraceTag(578058146,327,10,"[LinkToComment] Invalid durableCommentId for commentId: {0}",ja):a.ULS.sendTraceTag(578401558,327,10,"[LinkToComment] Comment not found for Id {0}",ja)}selectFirstThreadInNextCommentContext(){this.ap.YIj(0)}selectLastThreadInPreviousCommentContext(){this.ap.vKo()}registerForCommentEvents(ja){const Ua=
this.Toa.SGf(this.av.v0b&&this.av.Jr&&!this.Qg.en),yb=this.Toa.q1a,Wb=this.Toa.S6d(),tc=!this.ap.mode;this.wwa.SUo();this.Lah.xxm().then(Rc=>{this.wwa.Iro(ja,Ua,Wb,tc,yb,Rc);this.wwa.pLg(Wb?5:1,tc);this.Zu&&this.Zu.Fe(!0)})}unregisterForCommentEvents(ja){this.wwa.R1b(ja)}registerForAction(ja,Ua){this.nkk.xZa(ja,Ua)}unregisterForAction(){}checkAtMentionCapability(){return this.x9b?this.x9b.atMentionsEnabledAsync():(a.ULS.sendTraceTag(36475799,327,10,"AtMentionEnabled called before initialization."),
new Promise(ja=>{ja(!1)}))}resolveSupported(){return!0}loadThreads(){a.ULS.sendTraceTag(40130754,327,10,"LoadThreads incorrectly called on unsupported platform.")}n_h(){const ja=this.ap.fE&&!this.Qg.en?zf.AFrame.lR:zf.AFrame.zt;if(ja===zf.AFrame.zt){if(!this.Qg.en)return;mm.UISurfaces.Iv().then(Ua=>{Ua.setSelectedTaskPane(fd.a.ZVd);return null})}this.focusManager.EE(ja)}Exb(ja,Ua=1){this.n_h();this.l2.SIj(ja,Object.assign(new Kl.a,{kca:Ua,g4:1===Ua}))}zEj(){this.ap.yga.Jlb&&(this.ap.yga.Jlb=!1)}cuj(ja){this.Rb.Ob(ja,
2)}}Object(f.a)(np,"WordEditorSharedCommentAPI",null,[557,558]);class ap{constructor(ja,Ua,yb,Wb,tc,Rc,Id=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=ja;this.parentId=Ua;this.commentBody=yb;this.author=Wb;this.date=tc;this.commentFlags=Rc;this.usersByReactionType=Id}}Object(f.a)(ap,"OfficeSharedCommentModel",null,[]);d(1618);class Dn{constructor(ja,Ua){this.Ga=ja;this.bUb=Ua;this.dLh="AD";this.fEc=
new Ca.a;this.jbf=new Ca.a;this.u9k=RegExp("(.*?)\\s*(\\[\\d+\\])$");this.Iah=new Ni.a}get userPrincipalName(){return this.Ga.ib("UserPrincipalName")}get ycb(){return this.Ga.ib("PresenceProvider")}get y0(){return this.Ga.ib("PresenceUserId")}get Dj(){return this.bUb.value}Lfj(ja){const Ua=this.u9k.exec(ja);return Ua?Ua[1]:ja}BFi(ja,Ua=!1){let yb=0;ja.done&&(yb=ja.Of&&""!==ja.Of?yb|4:yb|8);ja.y5h&&(yb|=2);Ua&&(yb|=1);this.sBg(ja)&&(yb|=16);ja.jZf&&(yb|=32);this.XWm(ja)||(yb|=128);return yb}XWm(ja){return ja?
(ja=this.Dj.Eb(ja.objectId))?ja.hasProperty(ib.a.KT):!1:!1}sBg(ja){if(!ja)return!1;if(void 0===ja.authorId||null===ja.authorId||""===ja.authorId)return this.C5f(ja.id,ja.objectId,"Comment AuthorId null or empty"),!1;if(void 0===this.y0||null===this.y0||""===this.y0)return this.C5f(ja.id,ja.objectId,"PresenceUserId null or empty"),!1;if(this.y0==ja.authorId&&ja.fdc==this.ycb)return!1;const Ua=this.q1d(ja.authorId),yb=this.q1d(this.y0);if(this.ycb===this.dLh&&Ua&&yb&&Ua[0]!=this.userPrincipalName&&
Ua[1]!=yb[1])return!0;this.C5f(ja.id,ja.objectId,"Unknown");return!1}isCurrentUser(ja){if(!ja||void 0===ja.authorId||null===ja.authorId||""===ja.authorId||void 0===this.y0||null===this.y0||""===this.y0)return!1;if(this.y0==ja.authorId&&ja.fdc==this.ycb)return!0;ja=this.q1d(ja.authorId);const Ua=this.q1d(this.y0);return this.ycb===this.dLh&&ja&&Ua?ja[0]==this.userPrincipalName||ja[1]==Ua[1]:!1}q1d(ja){if(void 0===ja||null===ja)return null;ja=ja.split("::");return 3===ja.length?ja.slice(1,3):null}C5f(ja,
Ua,yb){ja&&!this.Iah.contains(ja)&&(a.ULS.sendTraceTag(42824129,327,50,`No edit restriction for commentObjectId: ${Ua}; reason: ${yb}`),this.Iah.add(ja))}Xpi(ja,Ua){var yb;if(!ja)return null;const Wb=ja.Lee;let tc=!1;Zd.x(Ua,void 0)&&(tc=!0);Ua=ja.author?this.Lfj(ja.author):"";const Rc=yl.a.kpb(null!==(yb=ja.authorId)&&void 0!==yb?yb:"");yb=new Zp.a(ja.authorId?ja.authorId:"",ja.fdc,Ua,null!==Rc&&void 0!==Rc?Rc:"",this.isCurrentUser(ja));return new ap(ja.id?ja.id:"",ja.Of?ja.Of:"",ja.text&&ja.text.length?
ja.text[0]:null,yb,ja.date||Wb?ja.date:new Date,this.BFi(ja,tc),this.DFi(ja.usersByReactionType))}qbm(ja,Ua,yb){const Wb=[],tc=new Ca.a;if(!ja)return Wb;for(const Rc of ja)Rc.Fr!==Oe.a.VD&&yb(Rc)&&(Rc.id&&this.fEc.lb(Rc.id)?(ja=this.fEc.K(Rc.id),ja=this.zFl(Rc,ja,Ua),Wb.push(ja),tc.Z(Rc.id,ja)):Rc.id?(ja=this.Xpi(Rc,Ua),Wb.push(ja),tc.Z(Rc.id,ja)):a.ULS.sendTraceTag(50667679,327,10,"CommentId should not be null"));this.fEc=tc;return Wb}Mhm(ja,Ua,yb){const Wb=[];for(const tc of ja)tc.Fr!==Oe.a.VD&&
yb(tc)&&(tc.id&&this.fEc.lb(tc.id)?Wb.push(this.fEc.K(tc.id)):tc.id&&Wb.push(this.Xpi(tc,Ua)));return Wb}zFl(ja,Ua,yb){var Wb=ja.Lee,tc=Zd.x(yb,void 0);yb=ja.Of?ja.Of:"";const Rc=ja.text&&ja.text.length?ja.text[0]:null,Id=ja.author?this.Lfj(ja.author):"",Pd=ja.authorId?ja.authorId:"",Rd=ja.fdc?ja.fdc:"",Ue=yl.a.kpb(Pd);Wb=ja.date||Wb?ja.date:new Date;tc=this.BFi(ja,tc);const tf=this.isCurrentUser(ja),cg=this.DFi(ja.usersByReactionType);return Ua.parentId===yb&&Ua.commentBody===Rc&&Ua.author.DisplayName===
Id&&Ua.author.UserId===Pd&&Ua.author.Provider===Rd&&Ua.author.IsCurrentUser===tf&&Ua.date===Wb&&Ua.commentFlags===tc&&this.U7k(Ua.usersByReactionType,cg)?Ua:(Ua=new Zp.a(Pd,Rd,Id,null!==Ue&&void 0!==Ue?Ue:"",tf),new ap(ja.id,yb,Rc,Ua,Wb,tc,cg))}U7k(ja,Ua){if(!ja&&!Ua)return!0;if(!Ua||!ja)return!1;var yb=Object.keys(ja);if(yb.length!==Object.keys(Ua).length)return!1;for(const Wb of yb){if(!(Wb in Ua))return!1;yb=ja[Wb];const tc=Ua[Wb];if(yb.length!==tc.length)return!1;for(let Rc=0;Rc<yb.length;Rc++)if(!this.K7k(yb[Rc],
tc[Rc]))return!1}return!0}K7k(ja,Ua){return ja||Ua?ja&&Ua&&ja.UserId===Ua.UserId&&ja.Provider===Ua.Provider&&ja.Email===Ua.Email&&ja.DisplayName===Ua.DisplayName&&ja.IsCurrentUser===Ua.IsCurrentUser?!0:!1:!0}DFi(ja){if(!ja)return null;const Ua={},yb=this.Ga.ib("PresenceUserId");for(const tc of Object.keys(ja)){const Rc=[];var Wb=ja[tc];for(const Id of Wb){Wb=Id.UserId===yb;let Pd;this.jbf.lb(Id.UserId)?(Pd=this.jbf.K(Id.UserId),Pd.IsCurrentUser=Wb):(Pd=new Zp.a(Id.UserId,Id.Provider,Id.DisplayName,
Id.Email,Wb),this.jbf.add(Id.UserId,Pd));Rc.push(Pd)}Ua[tc]=Rc}return Ua}}Object(f.a)(Dn,"WordEditorSharedCommentModelTranslator",null,[553]);class Co{constructor(){this.sq=null;this.lwd=this.Nyh=this.k8g=this.$Fh=this.XIh=this.vuh=this.RAh=!1}CFi(){this.sq||(a.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),this.aOj());return this.sq}xxm(){return new Promise((ja,Ua)=>{this.lwd?ja(this.JAi()):this.QKj().then(()=>{ja(this.JAi())}).catch(yb=>
{Ua(yb)})})}JAi(){this.lwd||a.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let ja;ja=33;this.k8g&&(ja|=2);this.RAh&&(ja|=8);this.XIh&&(ja|=16);this.vuh&&(ja|=4);this.$Fh&&(ja|=64);this.Nyh&&(ja|=128);return ja}}Object(f.a)(Co,"OfficeSharedCommentsAppCapabilities",null,[1791]);class zp extends Co{constructor(ja){super();this.M3a=null;this.sj=ja;this.dWo();this.aOj()}dWo(){this.$Fh=this.sj.g1b;
this.XIh=!1;this.Nyh=this.vuh=this.RAh=!0}initialize(ja){this.M3a=ja;this.QKj()}aOj(){this.sq={};this.sq.LivePersonaPicker="true";this.sq.PersonaColor="true";this.sq.DiscreteHostedComments=this.sj.tSl.toString();this.sq.NewCommentButton="true";this.sq.DisabledChangeGates=this.sj.kSl;this.sq.CommentsFluentUI="true";this.sq.CommentTasks=this.sj.g1b.toString();this.sq.CommentTasksFromReply=this.sq.CommentTasks;this.sq.CommentFriendlyTimestamps=this.sj.Jtl.toString();this.sq.AtMentionFloodgateSurvey=
this.sj.S8k.toString();this.sq.HyperlinksInComments="true";this.sq.LogDraftCommentIdPair="true";this.sq.RichTextFormattingInWeb="true";this.sq.RichContentEditIntegration="true";this.sq.HyperlinksWithDisplayText="true";this.sq.SmartReplies=this.sj.mDg.toString();this.sq.LinkToComment="true";this.sq.TaskPaneWithNewInfrastructure="true";this.sq.CommentReactions="true";this.sq.WebThemeIntegration="true";this.sq.NewSelectionInteractions="true";this.sq.HighlightsAndFontColorInWebComments="true";this.sq.TruncationUIWithReadMoreText=
"true";this.sq.CtrlEnterTip="true";this.sq.AtMentionHintMessage="true";this.sq.LivePersonaCardForWeb="true";this.sq.TaskHistoryRecordIDs=this.sj.Jep.toString();this.sq.ContentNavigation=this.sj.contentNavigationApiEnabled.toString()}QKj(){return new Promise((ja,Ua)=>{this.M3a?this.M3a.atMentionsEnabledAsync().then(yb=>{this.k8g=yb;this.lwd=!0;ja(this.lwd)}):(a.ULS.sendTraceTag(588292830,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),
Ua(Pf.a.rF(-2130915320)))})}}Object(f.a)(zp,"WordSharedCommentsAppCapabilities",Co,[552]);class Do{constructor(){this._initialized=!1;this.zul={crewAlias:"webasynccollabeng",featureName:"Comments",topLevelKpiName:Dd.a.HBf,vetoPillar:7};this.Rep={crewAlias:"webasynccollabeng",featureName:"Tasks",topLevelKpiName:Hm.a.HBf,vetoPillar:7}}get fcb(){return null!=this.Q0g?this.Q0g:this.Q0g=(()=>this.W.resolve(413))()}Z1(ja){this.fcb.Z1(Tj.a.comments,ja,!0)}get name(){return"WordEditor.Comments"}uc(ja){this.W=
ja;this.Z1("CPConfigStart");ja.ia(752,()=>new Ln.a(ca.Health.instance,new $h.a,this.zul)).as(752).ha();ja.ia(1189,()=>new Ln.a(ca.Health.instance,new $h.a,this.Rep)).as(1189).ha();ja.ia(756,()=>new Ll(this.W.resolve(752))).as(756).ha();ja.ia(743,()=>new Ah(y.AFrameworkApplication.J,this.W.resolve(12),new Ta.a(()=>jg.StaticActiveAppFrame.za().kb.$c),new Ta.a(()=>ll.a.instance),this.W.resolve(756),this.W.resolve(605))).as(743).ha();ja.ia(751,()=>new He).ha();ja.ia(742,()=>new po(ja.Ra(262),ja.resolve(751),
ja.resolve(627))).ha();ja.ia("WordEditor.Comments.WordEditorSharedCommentModelTranslator",()=>new Dn(y.AFrameworkApplication.J,new Ta.a(()=>jg.StaticActiveAppFrame.za().kb.$c.td))).as(769).ha();ja.ia("WordEditor.Comments.CommentDeltaFormatTranslator",()=>new Ob(ja.resolve(743),ja.resolve(8),this.W.resolve(752))).as(1187).ha();ja.ia("Common.Comments.OfficeSharedCommentsEventHost",()=>new Ij(y.AFrameworkApplication.oc)).as(764).ha();ja.ia("WordEditor.Comments.CommentActionInTypingRecorder",()=>new ch(this.W.resolve(743))).as(763).ha();
ja.ia(778,Mn.a.getInstance).as(744).as(1003).as(740).ha();ja.ia(776,()=>new qi(new Ta.a(()=>jg.StaticActiveAppFrame.za().kb.$c),new Ta.a(()=>ll.a.instance),ja.resolve(740),ja.resolve(751),ja.resolve(743),ja.resolve(756),this.W.resolve(752)));ja.ia(602,()=>new Od(ja.resolve(740),y.AFrameworkApplication.J,ja.resolve(742),ja.resolve(751),ja.Ra(2))).ha();ja.resolve(602);ja.ia("WordEditor.Comments.CommentHighlightOnRestActor",()=>new ee(new Ta.a(()=>jg.StaticActiveAppFrame.za().kb.$c),ja.resolve(751),
ja.resolve(740),ja.resolve(742),ja.resolve(59).Ll,va.a.instance,this.W.resolve(609),ja.resolve(743))).as(758).ha();ja.ia(757,()=>new Hc(ja.resolve(372))).ha();ja.ia(762,()=>new ic(ja.resolve(757))).ha();ja.ia(761,()=>new If(ja.resolve(758),ja.resolve(757),y.AFrameworkApplication.ua.S8,y.AFrameworkApplication.ua.AOa,y.AFrameworkApplication.va,y.AFrameworkApplication.oc,ja.resolve(751),ja.Ra(759))).ha();ja.ia("WordEditor.Comments.CommentHighlightActor",()=>new db(new Ta.a(()=>jg.StaticActiveAppFrame.za().kb.$c.td),
ja.resolve(760),ja.resolve(758),ja.Ra(759),va.a.instance,ja.resolve(761),ja.resolve(762),ja.resolve(757),ja.resolve(742))).as(747).ha();ja.ia(741,()=>new gg(ja.resolve(743),Wl.a.instance,lm.a.instance,il.a.instance,y.AFrameworkApplication.va,Tn.TableCellReader.Xin,pe.moveToLastRenderedCellOfTheRow,new Uk.a,ja.Ra(11),ja.resolve(740),ja.resolve(747),ja.resolve(763),ja.resolve(751),ja.resolve(609))).as(779).ha();ja.ia(748,()=>new fe(Wl.a.instance,il.a.instance,y.AFrameworkApplication.va,ja.Ra(6))).ha();
ja.ia("WordEditor.Comments.ViewContainerAPI",()=>new cj(y.AFrameworkApplication.va,"OfficeSharedCommentPaneSurface")).as(765).ha();ja.ia("Common.Comments.CommentActivationManager",()=>new kn).as(775).ha();ja.ia("Common.Comments.ViewContainerEventHost",()=>new Jl(y.AFrameworkApplication.oc,"OfficeSharedCommentPaneSurface")).as(766).ha();ja.ia("WordEditor.Comments.CommentSmartReplyProvider",()=>new Mq(this.W.resolve(764),this.W.resolve(451),this.W.resolve(657),this.W.resolve(658))).as(770).ha();ja.ia("WordEditor.Comments.WordSharedCommentsAppCapabilities",
()=>new zp(ja.resolve(743))).as(771).ha();this.Z1("CPConfigEnd")}init(){this.Z1("CPInitStart");this.W.resolve(12).us.continueWith(()=>{try{this.Fo(),this.Z1("CPInitEnd")}catch(ja){throw a.ULS.cA(524300632,327,10,ja,"Exception threw from Comments Package initialization in onAfterGraphFeaturesNodeLoaded: {0}",ja),this.fcb.Ly(Tj.a.comments,"CPInitException",ja,!0),ja;}})}Fo(){const ja=this.W.resolve(743);this.Z1("onAfterGFNLoadedStart");this.W.ia("WordEditor.Comments.OfficeSharedCommentPane",()=>new ik(y.AFrameworkApplication.va,
y.AFrameworkApplication.ua.KE,y.AFrameworkApplication.ua.LE,y.AFrameworkApplication.ua.oq,y.AFrameworkApplication.ua.Ay,jg.StaticActiveAppFrame.za(),zk.a.instance,this.W.resolve(764),this.W.resolve(765),this.W.resolve(766),y.AFrameworkApplication.oc,this.W.resolve(749),ja,this.W.resolve(751),this.W.resolve(750),this.W.resolve(742),this.W.resolve(740))).as(745).as(767).ha();this.W.ia("Common.Comments.OfficeSharedCommentsActionHost",()=>new $m(y.AFrameworkApplication.va,this.W.resolve(767).iCc)).as(768).ha();
this.W.ia("WordEditor.Comments.WordEditorSharedCommentAPI",()=>new np(y.AFrameworkApplication.oc,this.W.resolve(764),this.W.resolve(768),this.W.resolve(769),this.W.resolve(770),ja,jg.StaticActiveAppFrame.za(),y.AFrameworkApplication.ua.oq,this.W.Ra(2),y.AFrameworkApplication.va,va.a.instance,this.W.resolve(750),this.W.resolve(751),this.W.resolve(748),this.W.resolve(752))).as(746).ha();Tk.a.factory=fh.getInstance;this.W.ia(777,fh.getInstance).as(435).as(759).ha();this.W.ia("WordEditor.Comments.CommentFloatingContainerActor",
()=>new Rg(this.W.resolve(751),this.W.resolve(743),this.W.resolve(740),y.AFrameworkApplication.oc,this.W.resolve(763),this.W.resolve(742),this.W.resolve(606),()=>document.querySelector(`#${Ik.a.E0a} .${ig.a.Xfc}`),this.W.resolve(771),y.AFrameworkApplication.ua.oq,this.W.resolve(609))).as(754).ha();const Ua=this.W.resolve(605),yb=Ua.trackChangeInSidetrackEnabled;yb&&this.W.resolve(634).Zyj(this.W.resolve(754));this.W.ia(773,()=>new Zg(this.W.resolve(740),y.AFrameworkApplication.oc,va.a.instance,this.W.resolve(763),
this.W.resolve(751),this.W.resolve(742),this.W.resolve(606),this.W.resolve(754),Ua)).ha();this.W.ia(749,()=>yb?this.W.resolve(772):this.W.resolve(773)).as(361).ha();this.W.ia("WordEditor.Comments.CommentSelectionActor",()=>new tk(y.AFrameworkApplication.va,this.W.resolve(744),this.W.resolve(747),hg.getInstance(),this.W.resolve(749),this.W.resolve(764),y.AFrameworkApplication.ua.oq,this.W.resolve(751),ja,new Ta.a(()=>ul.a.instance),this.W.resolve(756),this.W.resolve(752),this.W.Ra(755))).as(750).ha();
this.W.ia(780,()=>new bj(this.W.resolve(759),this.W.resolve(740),this.W.resolve(767),this.W.resolve(750),ja,this.W.resolve(751),this.W.resolve(749),hg.getInstance(),jg.StaticActiveAppFrame.za().Vr,y.AFrameworkApplication.va,this.W.resolve(77).JD,this.W.Ra(774),y.AFrameworkApplication.ua.oq,this.W.resolve(771),this.W.resolve(770),this.W.resolve(775),this.W.resolve(765),this.W.Ra(2),this.W.resolve(742),this.W.Ra(65),this.W.Ra(143),this.W.resolve(607),this.W.resolve(766),this.W.resolve(752),this.W.resolve(754),
this.W.resolve(606),Ua,this.W.resolve(608),this.W.resolve(413),this.W.resolve(776),this.W.resolve(609))).ha();this.W.ia(782,()=>new ln(this.W.resolve(777),this.W.resolve(778),this.W.resolve(779),this.W.resolve(750),this.W.resolve(742),this.W.resolve(751),this.W.resolve(749),ja,this.W.resolve(745),new Ta.a(()=>jg.StaticActiveAppFrame.za().kb.$c.td),y.AFrameworkApplication.va,new Ta.a(()=>ul.a.instance),zm.FocusManager.instance(),va.a.instance,this.W.resolve(748),this.W.resolve(609))).as(782).ha();
this.W.resolve(780);ja.contentNavigationApiEnabled&&(this.W.ia(596,()=>new nk(this.W.resolve(776),this.W.resolve(743))).ha(),this.W.ia(781,()=>new cl(this.W.resolve(601),this.W.resolve(740),this.W.resolve(750),this.W.resolve(759),this.W.resolve(751))).ha(),this.W.resolve(596),this.W.resolve(781));const Wb=ja.Jr,tc=this.W.resolve(777);this.W.resolve(782);tc&&Wb&&(this.W.resolve(751).Flb=Do.Asi(),ja.UMb||this.W.resolve(742).R3("OnCommentInit"));nd.a.LBn();ja.elc&&jg.StaticActiveAppFrame.za().kb.Kii();
Tk.a.instance&&(ja.UMb||yk.a.get_instance().Tk(4,()=>{this.nTn(Wb)},11).continueWith(()=>{this.M3m()}),this._initialized=!0);this.Jpo(this.W.Ra(324),this.W.resolve(164),this.W.resolve(760))}M3m(){this.W.resolve(742).R3("OnCommentInit")}nTn(ja){ja||this.jQm()}jQm(){const ja=Do.Asi();ja&&(a.ULS.sendTraceTag(35149084,327,50,"Comment deep linking starts after boot: {0}",(new Date).getTime()-y.AFrameworkApplication.xT),this.W.resolve(742).R3("OnCommentInit",Object.assign(new an.a,{nMa:()=>{Tk.a.instance.yga.isVisible||
y.AFrameworkApplication.va.Ob(li.a.pY,2);this.W.resolve(750).PIj(ja,Object.assign(new Kl.a,{xBg:!0}))}})),this.W.resolve(752).Vw(li.a.hpf))}Jpo(ja,Ua,yb){ja&&ja.execute(Wb=>{Wb.XX(new Dc.a(Ua,yb))})}dispose(){this._initialized&&(Tk.a.instance&&Tk.a.instance.dispose(),this._initialized=!1)}static Asi(){return y.AFrameworkApplication.J.ib("BootActivityNavigationId")}}Object(f.a)(Do,"PackageManager",null,[0,1]);const vc=ja=>{const Ua=C.a.instance.Ra(413),yb=window.performance.now();Ua.execute(Wb=>{Wb.Ly(Tj.a.comments,
"CPMain",yb,!0)});Ba.a.instance.Lc(new Do,0,ja)};var go=d(973);class nm{isComment(ja){return Nc.a.isComment(ja)}uce(ja){return Nc.a.uce(ja)}EWf(ja){return Nc.a.EWf(ja)}qdg(ja,Ua){Nc.a.qdg(ja,Ua)}udg(ja,Ua){Nc.a.udg(ja,Ua)}Bsf(ja){return Nc.a.Bsf(ja)}wbb(ja){return ll.a.instance.wbb(ja)}deleteComment(ja,Ua){Nc.a.deleteComment(ja,Ua)}hZd(ja,Ua){Nc.a.hZd(ja,Ua)}Qwb(ja){Nc.a.Qwb(ja)}efa(ja,Ua,yb){return Nc.a.efa(ja,Ua,yb)}GAa(ja,Ua,yb){return Nc.a.GAa(ja,Ua,yb)}xkc(ja,Ua){return Nc.a.xkc(ja,Ua)}H1c(ja,
Ua,yb,Wb=null){return Nc.a.H1c(ja,Ua,yb,Wb)}Pbc(ja,Ua,yb,Wb){Nc.a.Pbc(ja,Ua,yb,Wb)}eQd(ja,Ua,yb,Wb){return Nc.a.eQd(ja,Ua,yb,Wb)}get pSb(){return Nc.a.pSb}set pSb(ja){Nc.a.pSb=ja}rWb(ja,Ua){Nc.a.rWb(ja,Ua)}Gjd(ja){Nc.a.Gjd(ja)}Rqg(ja){Nc.a.Rqg(ja)}g7d(ja,Ua){return Nc.a.g7d(ja,Ua)}rdg(ja,Ua){Nc.a.rdg(ja,Ua)}tdg(ja,Ua){Nc.a.tdg(ja,Ua)}qle(ja,Ua,yb,Wb,tc,Rc){Nc.a.qle(ja,Ua,yb,Wb,tc,Rc)}Ozf(ja,Ua){Nc.a.Ozf(ja,Ua)}hhd(ja,Ua,yb,Wb){return Nc.a.hhd(ja,Ua,yb,Wb)}lhd(ja,Ua,yb,Wb){return Nc.a.lhd(ja,Ua,yb,
Wb)}}Object(f.a)(nm,"CommentEditorProxy",null,[551]);class zl{constructor(){this.W=null}get Y0b(){return null!=this.M3g?this.M3g:this.M3g=(()=>this.W.Ra(783))()}get fcb(){return null!=this.R0g?this.R0g:this.R0g=(()=>this.W.resolve(413))()}Z1(ja){this.fcb.Z1(Tj.a.comments,ja,!0)}get name(){return"WordEditor.CommentsInteractive"}uc(ja){this.W=ja;this.Z1("CIPConfigStart");ja.ia("WordEditor.CommentsInteractive.CommentEditorProxy",()=>new nm).as(760).ha();this.Z1("CIPConfigEnd")}init(){this.Z1("CIPInitStart");
this.W.resolve(12).us.continueWith(()=>{this.Fo();this.Z1("CIPInitEnd")})}Fo(){this.uZm()}dispose(){}uZm(){Rb.a.yZa(Nc.a.udg);go.a.QQd(Nc.a.rdg);go.a.RQd(Nc.a.tdg);go.a.BZk(Nc.a.kTn);this.Y0b.execute(Ua=>{Ua.kff(Nc.a.rWb)});const ja=Ra.a.gf.Ll;ja.jf(39).jo(Nc.a.qdg);go.a.SYk(Nc.a.nSn);go.a.KYk(Nc.a.CRn);Ge.a.isEnabled&&ja.jf(12).Yx(Nc.a.fgk)}}Object(f.a)(zl,"PackageManager",null,[0,1]);const ck=ja=>{const Ua=C.a.instance.Ra(413),yb=window.performance.now();Ua.execute(Wb=>{Wb.Ly(Tj.a.comments,"CIPMain",
yb,!0)});Ba.a.instance.Lc(new zl,0,ja)};var vl=d(2136),Xk=d(105),Vg=d(1645);class $p{constructor(ja,Ua,yb,Wb,tc,Rc,Id){this.NSa=ja;this.Yda=Ua;this.w$=yb;this.Zc=Wb;this.hvk=tc;this.C0e=Rc;this.pFb=Id;Vg.a.AZk((Pd,Rd)=>{this.EXk(Rd.graphNode,Rd.ttl)});Vg.a.f_k((Pd,Rd)=>{this.gAl(Rd.graphNode,Rd.frl)})}k6d(){var ja=this.hvk();const Ua=this.Zc.Rl();Ua.set(ja);if(this.Yda.Anp(Ua))return Ua;Ua.set(ja);Object(Xk.a)().VR(Ua);ja=this.w$.sIl(Ua.currentNode);Ua.Yj(ja);return Ua}A8d(ja){const Ua=this.k6d();
let yb=null;this.Yda.p3d(Ua,Wb=>{this.w$.$Gi(Wb)===ja&&(yb=Wb);return!yb});return yb}WGi(ja){const Ua=this.k6d();let yb=null;this.Yda.p3d(Ua,Wb=>{this.w$.Dkc(Wb)===ja&&(yb=Wb);return!yb});return yb}o9i(ja,Ua,yb){a.ULS.sendTraceTag(594928199,3003,50,"History Record Generated. [RecordType: {0}], [TaskID: {1}], [TaskCompletion: {2}]",ja,Ua,yb)}aHi(){const ja=this.k6d(),Ua=[];this.Yda.p3d(ja,yb=>{Ua.push(this.w$.$Gi(yb));return!0});return Ua}Snb(ja,Ua){if(!Ua.length)return this.pFb&&a.ULS.sendTraceTag(42812043,
3003,10,"A task must always have at least one history record."),null;const yb=this.k6d(),Wb=ta.a.create().toString(),tc=new Hi.a;for(let Rc of Ua)tc.add(Rc),this.o9i(Rc.type,Wb,Rc.completion);Ua=this.NSa.pxg(tc);this.w$.Snb(yb.currentNode,Wb,ja,Ua);this.C0e();return Wb}uf(ja){(ja=this.A8d(ja))?(this.w$.uf(ja),this.C0e()):this.pFb&&a.ULS.sendTraceTag(51656714,3003,10,"DeleteTask : Unable to find task with given ID")}Dkc(ja){ja=this.A8d(ja);return ja?this.w$.Dkc(ja):(this.pFb&&a.ULS.sendTraceTag(42812044,
3003,10,"GetTaskCommentAnchorId : Unable to find task with given ID"),null)}XGi(ja){return this.w$.Dkc(ja)}ZGi(ja){ja=this.A8d(ja);if(!ja)return this.pFb&&a.ULS.sendTraceTag(42812045,3003,10,"GetTaskHistory : Unable to find task with given ID"),null;ja=this.w$.MMf(ja);return this.NSa.fgc(ja).toArray()}R4k(ja,Ua){if(!Ua.length)return this.pFb&&a.ULS.sendTraceTag(594928198,3003,10,"AppendTaskHistory : New records do not exist"),!1;const yb=this.A8d(ja);if(!yb)return this.pFb&&a.ULS.sendTraceTag(42812046,
3003,10,"AppendTaskHistory : Unable to find task with given ID"),!1;const Wb=this.w$.MMf(yb),tc=this.NSa.fgc(Wb);for(let Rc of Ua)tc.add(Rc),this.o9i(Rc.type,ja,Rc.completion);ja=this.NSa.pxg(tc);ja!==Wb&&(this.w$.CVo(yb,ja),this.C0e());return!0}EXk(ja,Ua){if(Ua=this.WGi(Ua)){const yb=this.Zc.Rl();yb.set(ja);this.w$.Zb(Ua.clone(),this.w$.H_l(Ua,yb))}}Gxj(ja,Ua,yb){if(Ua.lb(ja))return Ua.K(ja);const Wb=ta.a.create().toString();Ua.add(ja,Wb);yb&&this.pFb&&a.ULS.sendTraceTag(593281437,3003,10,"RecordIdFromMapOrGenerateNewIdAndAddToMap : Unexpectedly creating new id.");
return Wb}gAl(ja,Ua){const yb=new qd.a;var Wb=this.Zc.Rl();Wb.set(ja);Wb.Ub(38)&&this.Yda.p3d(Wb,tc=>{const Rc=this.w$.Dkc(tc);void 0!==Rc&&null!==Rc&&yb.add(Rc,tc);return!0});for(let tc of Ua)if(ja=null,({value:ja}=yb.Ac(tc.key,ja)).returnValue)if(tc.value===tc.key)ja=this.WGi(tc.key),this.w$.qWo(ja,parseInt(tc.key));else{ja=this.w$.MMf(ja);if(!ja||""===ja){a.ULS.sendTraceTag(595347466,3003,10,"CopyTaskNodesFromParentNode : History Records not found on taskNode on clipboard");break}ja=this.NSa.fgc(ja);
Wb=new Xb.a;for(let Rc=0;Rc<ja.length;Rc++){if(ja.K(Rc).commentId){const Id=Number.parseInvariant(ja.K(Rc).commentId);Ua.lb(Id)?ja.K(Rc).commentId=Ua.K(Id).toString():ja.K(Rc).commentId=null}ja.K(Rc).recordId=this.Gxj(ja.K(Rc).recordId,Wb,!1);-1===ja.K(Rc).type&&(ja.K(Rc).undoId=this.Gxj(ja.K(Rc).undoId,Wb,!0))}this.Snb(tc.value,ja.toArray())}}static Qs(){return new $p(C.a.instance.resolve(784),C.a.instance.resolve(785),C.a.instance.resolve(786),new Uk.a,()=>jg.StaticActiveAppFrame.za().kb.$c,()=>
{C.a.instance.Ra(72).execute(ja=>{ja.editHappened()})},!0)}}Object(f.a)($p,"TaskActor",null,[291]);var Rl=d(1083);class yf{create(){return new Rl.a}}Object(f.a)(yf,"TaskContentNodeFactory",null,[281]);var Pm=d(1042);class Og{create(){return new Pm.a}}Object(f.a)(Og,"TaskNodeFactory",null,[281]);class Dl{constructor(ja,Ua,yb,Wb,tc,Rc){this.Yda=ja;this.Qc=Ua;this.Zc=yb;this.xNk=Wb;this.ANk=tc;this.d4b=Rc}QGl(ja,Ua,yb){const Wb=this.ANk.create(Fd.a.Hyc);Wb.setValue(ib.a.taskId,ja);Wb.setValue(ib.a.d1b,
Ua);Wb.setValue(ib.a.mEa,yb);return Wb}Fkc(ja){const Ua=this.Qc.Nc(4);Ua.Bb(ja);this.d4b();return Ua}$Gi(ja){return this.Yda.tTb(ja)?ja.getValue(ib.a.taskId):(a.ULS.sendTraceTag(42812047,3003,10,"Unexpected node type"),null)}Dkc(ja){return this.Yda.tTb(ja)?ja.hasProperty(ib.a.d1b)?ja.getValue(ib.a.d1b):null:(a.ULS.sendTraceTag(42812048,3003,10,"Unexpected node type"),null)}MMf(ja){return this.Yda.tTb(ja)?ja.getValue(ib.a.mEa):(a.ULS.sendTraceTag(42812049,3003,10,"Unexpected node type"),null)}sIl(ja){if(7!==
ja.type)return a.ULS.sendTraceTag(42812050,3003,10,"Unexpected node type"),null;const Ua=this.Fkc(ja);try{const yb=this.xNk.create(Fd.a.wOa),Wb=this.Zc.Rl();Wb.set(ja);Wb.d6(yb,38,Dl.Fep);return yb}finally{Ua&&Ua.dispose()}}Snb(ja,Ua,yb,Wb){if(!this.Yda.n0f(ja))return a.ULS.sendTraceTag(42812051,3003,10,"Unexpected node type"),null;const tc=this.Fkc(ja);try{const Rc=this.QGl(Ua,yb,Wb),Id=this.Zc.Rl();Id.set(ja);Id.d6(Rc,1,new Ib.a(ta.a.Oza(yb.toString()),1));return Rc}finally{tc&&tc.dispose()}}uf(ja){if(this.Yda.tTb(ja))if(ja.anchor&&
ja.anchor.gr){var Ua=ja.anchor.gr.at.node;if(this.Yda.n0f(Ua)){var yb=this.Fkc(Ua);try{const Wb=this.Zc.Rl();Wb.set(Ua);Wb.Yj(ja.anchor.node);Wb.Rg()}finally{yb&&yb.dispose()}}else a.ULS.sendTraceTag(51656717,3003,10,"Task node unexpectedly parented to non-content node")}else a.ULS.sendTraceTag(51656716,3003,10,"Cannot delete an unlinked node");else a.ULS.sendTraceTag(51656715,3003,10,"Unexpected node type")}CVo(ja,Ua){if(this.Yda.tTb(ja)){var yb=this.Fkc(ja);try{ja.setValue(ib.a.mEa,Ua)}finally{yb&&
yb.dispose()}}else a.ULS.sendTraceTag(42812052,3003,10,"Unexpected node type")}qWo(ja,Ua){if(this.Yda.tTb(ja)){var yb=this.Fkc(ja);try{const Wb=ja.hasProperty(ib.a.d1b)?ja.getValue(ib.a.d1b):null;void 0===Wb||null===Wb||Wb===Ua?ja.Ag(ib.a.d1b,Ua):a.ULS.sendTraceTag(595347464,3003,10,"TaskAnchorId is changed.")}finally{yb&&yb.dispose()}}else a.ULS.sendTraceTag(595347465,3003,10,"Unexpected node type")}H_l(ja,Ua){if(!Ua.kv(38)){const yb=this.Zc.Rl();yb.set(ja);yb.vb(71);yb.ld(71);ja=Lb.b(yb.currentNode,
ja.Jj().Ic,!0);Ua.Vf(ja,38)}return Ua.Ub(38)}Zb(ja,Ua){if(this.Yda.n0f(Ua)){var yb=this.Fkc(Ua);try{const Wb=this.Zc.Rl();Wb.set(Ua);Wb.Vf(ja,1)}finally{yb&&yb.dispose()}}else a.ULS.sendTraceTag(595347463,3003,10,"Unexpected node type")}static Qs(){return new Dl(C.a.instance.resolve(785),new Fe.a,new Uk.a,new yf,new Og,()=>{Xi.a.Mm.kb.$c.YG.S$(10)})}}Dl.Fep=new Ib.a(ta.a.Cf("50f73b87-1d48-4f4a-94a3-4c20e2cf6387"),1);Object(f.a)(Dl,"TaskEditor",null,[290]);class Yl{constructor(ja,Ua){this.yz=ja;this.pGb=
Ua}tTb(ja){return!!ja&&72===ja.type}Ipn(ja){return!!ja&&71===ja.mf}n0f(ja){return!!ja&&71===ja.type}Anp(ja){ja.set(this.yz.value);this.pGb.VR(ja);return!!ja.Ub(38)}p3d(ja,Ua){if(ja&&Ua)if(this.Ipn(ja))for(var yb=!0,Wb=ja.Ub(1);yb&&Wb;)this.tTb(Wb)||a.ULS.sendTraceTag(42812055,3003,10,"Unexpected node type {0}",Wb.type),yb=Ua(Wb),Wb=ja.Mf(1);else a.ULS.sendTraceTag(42812054,3003,10,"Unexpected iterator type {0}",ja.mf);else a.ULS.sendTraceTag(42812053,3003,10,"ForEachTaskInTaskContent : Invalid Input")}static Qs(){return new Yl(new Ta.a(()=>
jg.StaticActiveAppFrame.za().kb.$c),Object(Xk.a)())}}Object(f.a)(Yl,"TaskNavigator",null,[289]);class Mk{constructor(){this.W=null}get name(){return"WordEditor.Tasks"}init(){this.W.resolve(12).us.continueWith(()=>{this.Fo()})}dispose(){}uc(ja){this.W=ja;ja.ia("WordEditor.Tasks.JsonTaskHistorySerialization",()=>new vl.a).as(784).ha();ja.ia("WordEditor.Tasks.TaskNavigator",()=>Yl.Qs()).as(785).ha();ja.ia("WordEditor.Tasks.TaskEditor",()=>Dl.Qs()).as(786).ha();ja.ia("WordEditor.Tasks.TaskActor",()=>
$p.Qs()).as(1188).ha()}Fo(){this.W.resolve(12).isFeatureEnabled(107)}}Object(f.a)(Mk,"TasksPackage",null,[0,1]);var Eo=d(93),qo=d(1641),ro=d(410),Fo=d(107);class pp{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(f.a)(pp,"TaskPaneGroupAppProps",null,[]);var aq=d(180);class wl{static Oul(ja,Ua){zm.FocusManager.nM()&&
(lm.a.instance.EHa(ja,Ua,!1),aq.a.instance.EHa(ja,Ua,!1),y.AFrameworkApplication.ua.Ay.rW(ja))}}Object(f.a)(wl,"ReactTaskPaneManagerUtils",null,[]);var Qp=d(171),dj=d(368);class jp{constructor(){this.type=null}}Object(f.a)(jp,"SampleTaskPaneProps",null,[]);var El=d(1643),Ap=d(108);class xh{constructor(){this.entry=null;this.show=!1}}Object(f.a)(xh,"AnimationBatchEntry",null,[]);var Xq=d(374),Mt=d(1642),qp=d(167);class Dk{constructor(){this.zxh=[];this.Axh=[];this.kqa={};this.aQa=this.$Pa=null;this.xNd=
!1;this.D1=null;this.DKd=this.AFd=0;this.ACc=[];this.ZWe=!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.jtb;this.Rx=!1}initialize(){this.xNd=!1;(this.Rx=!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.m3)&&this.otf()}qtf(ja,Ua,yb,Wb){Ua=this.C8d(Ua);a.ULS.sendTraceTag(4290588,320,50,"Create new task pane.");this.otf();const tc=document.createElement("div");tc.id=Ua;tc.className=Dk.pCp;tc.style.width="0";this.ZWe||(this.jUk(yb,Ua,tc),this.kqa[Ua]=ja.qtf(Ua,yb,Wb,tc));return tc}otf(){this.xNd||
this.uYo()}jUk(ja,Ua,yb){let Wb=null,tc=null;0===ja?(Wb=this.$Pa,tc=this.zxh):1===ja&&(Wb=this.aQa,tc=this.Axh);if(Wb){ja=!1;for(let Rc=0;Rc<tc.length;Rc++)if(!ja)tc[Rc]===Ua&&(ja=!0);else if(tc[Rc]in this.kqa){this.O8m(Wb,yb,this.kqa[tc[Rc]]);return}Wb.appendChild(yb)}}O8m(ja,Ua,yb){ja.insertBefore(Ua,yb.element)}CTl(ja){ja=this.C8d(ja);if(ja in this.kqa){const Ua=this.kqa[ja];Ua.element.parentNode.removeChild(Ua.element);delete this.kqa[ja]}}vTj(ja){ja=this.C8d(ja);ja in this.kqa&&(ja=this.kqa[ja])&&
!ja.isVisible&&(this.HSj(ja,!0),this.oPh(ja.position,!0,this.cYh(ja,!0)),1===ja.position&&1<ka.a.count(this.kqa)&&this.tDn())}NYm(ja){ja=this.C8d(ja);ja in this.kqa&&(ja=this.kqa[ja])&&ja.isVisible&&(this.HSj(ja,!1),this.oPh(ja.position,!1,this.cYh(ja,!1)))}wfc(ja){if(this.D1)return this.D1;const Ua=document.createElement("div");document.body.appendChild(Ua);Ua&&(this.D1=new qo.a(Ua,ja));return this.D1}HSj(ja,Ua){ja.element&&(ja.isVisible=Ua,this.ACc.push(Object.assign(new xh,{entry:ja,show:Ua})));
0===ja.position?this.AFd+=Ua?1:-1:this.DKd+=Ua?1:-1;1===this.ACc.length&&window.setTimeout(Object(Ap.a)(this,this.m$o,"startPaneAnimation"),0);this.Rx&&ja.element&&ja.element.parentNode&&(0===ja.position&&!this.AFd||1===ja.position&&!this.DKd?(ja.element.parentNode.style.minHeight="0px",ja.element.parentNode.style.height="0px",ja.element.parentNode.style.overflow="hidden"):(ja.element.parentNode.style.minHeight="",ja.element.parentNode.style.height="",ja.element.parentNode.style.overflow=""))}m$o(){this.Mkj();
var ja=ce.where(ce.asEnumerable(this.ACc),tc=>0===tc.entry.position),Ua=ce.where(ja,tc=>!tc.show);if(ce.any(Ua)&&ce.Ct(Ua)!==ce.Ct(ja)){for(var yb of Ua)yb.entry.element.style.width="0";ja=ce.where(ja,tc=>tc.show)}Ua=ce.where(ce.asEnumerable(this.ACc),tc=>1===tc.entry.position);yb=ce.where(Ua,tc=>!tc.show);if(ce.any(yb)&&ce.Ct(yb)!==ce.Ct(Ua)){for(var Wb of yb)Wb.entry.element.style.width="0";Ua=ce.where(Ua,tc=>tc.show)}for(const tc of ce.concat(ja,Ua))ja=tc.entry,qp.WacAirSpace.eY(ja.element,Xq.a.oCg),
Wb=new Mt.a(ja.element),tc.show?Wb.Jgf(0,ja.width):Wb.Jgf(ja.width,0),qp.WacAirSpace.animate(Wb,null,null);this.ACc.length=0}Mkj(){}cYh(ja,Ua){let yb=ja.width;ja=0===ja.position?this.AFd:this.DKd;if(Ua&&1===ja||!Ua&&!ja)yb+=1;return yb}uYo(){this.xNd||(this.$Pa||(this.$Pa=document.createElement("div"),this.$Pa.id=Dk.nCp,this.$Pa.className=Dk.l$j,Sys.UI.DomElement.addCssClass(this.$Pa,"alignLeft"),y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.jba&&Sys.UI.DomElement.addCssClass(this.$Pa,
"FlexBoxLayout"),this.ZWe&&Sys.UI.DomElement.addCssClass(this.$Pa,Dk.i$j),this.qNh(0,this.$Pa)),this.aQa||(this.aQa=document.createElement("div"),this.aQa.id=Dk.oCp,this.aQa.className=Dk.l$j,Sys.UI.DomElement.addCssClass(this.aQa,"alignRight"),y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.jba&&Sys.UI.DomElement.addCssClass(this.aQa,"FlexBoxLayout"),this.ZWe&&Sys.UI.DomElement.addCssClass(this.aQa,Dk.i$j),this.qNh(1,this.aQa)),this.cnj(this.$Pa,this.aQa),this.xNd=!0)}cnj(){}HHa(ja,Ua){Array.add(1===
ja?this.Axh:this.zxh,Ua)}C8d(ja){return ja+"-Entry"}tDn(){let ja=0;for(const Ua of ka.a.xR(this.kqa)){const yb=Object(T.a)(1864,this.kqa[Ua]);yb&&yb.isVisible&&1===yb.position&&ja++}2===ja?a.ULS.sendTraceTag(595179606,320,50,"2 simultaneous panes open"):2<ja&&a.ULS.sendTraceTag(595179605,320,50,ja+" simultaneous panes open")}}Dk.nCp="WACTaskPaneContainerLeft";Dk.oCp="WACTaskPaneContainerRight";Dk.l$j="WACTaskPaneContainer";Dk.pCp="WACTaskPaneEntry";Dk.i$j="WACReactTaskPaneContainer";Object(f.a)(Dk,
"BaseTaskPaneManager",null,[1865]);var un=d(631),jk=d(296);class Sl extends Dk{constructor(ja,Ua){super();this.kLc=this.jLc=this.Bbf=this.Abf=0;this.jpi=()=>{Object(dd.a)().forEach(yb=>{yb.t3d()})};this.ga=ja;this.kmh=Ua}qNh(ja,Ua){const yb=jg.StaticActiveAppFrame.za().XF;yb.parentNode&&(ja?1===ja&&(this.Rx?((ja=Object(jk.a)("FarPane"))&&ja.appendChild(Ua),Ua.classList.add("regionComposer"),jg.StaticActiveAppFrame.za().NK.registerBoundingWindowRectsChanged("farPane",(Wb,tc)=>{"DP"===tc||3===tc?Ua.classList.add("DL"):
Ua.classList.remove("DL")})):yb.parentNode.insertBefore(Ua,yb.nextSibling)):this.Rx?((ja=Object(jk.a)("NearPane"))&&ja.appendChild(Ua),Ua.classList.add("regionComposer")):yb.parentNode.insertBefore(Ua,yb))}oPh(ja,Ua,yb){this.Rx||(Ua=Ua?yb:-yb,ja?this.kLc+=Ua:this.jLc+=Ua)}Mkj(){if(!this.Rx){var ja=jg.StaticActiveAppFrame.za().XF;qp.WacAirSpace.eY(ja,Xq.a.oCg);if(this.Abf!==this.jLc){const Ua=new un.a(ja);Ua.g3k(this.Abf,this.jLc,this.kmh);qp.WacAirSpace.animate(Ua,null,this.jpi);this.Abf=this.jLc}this.Bbf!==
this.kLc&&(ja=new un.a(ja),ja.h3k(this.Bbf,this.kLc,this.kmh),qp.WacAirSpace.animate(ja,null,this.jpi),this.Bbf=this.kLc)}}}Object(f.a)(Sl,"TaskPaneManager",Dk,[]);var Ek=d(157);class Rp extends Sl{get xWi(){null==this.$He&&(this.$He=y.AFrameworkApplication.J?y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ExternalContentFloatiePositionIsEnabled",!1):!1);return this.$He}constructor(ja,Ua){super(ja,Ua);this.xZ=ye.KeyInputManager.mc(Eo.a.nz,0);this.yZ=ye.KeyInputManager.mc(Eo.a.nz,
4);this.D5e=this.UKc=null;this.Grh="AccCheckerTaskPane";this.sa=new Ka.a;this.isPaneOpen=!1;this.$He=this.SQe=null;this.HHa(0,"SampleTaskPane");this.HHa(0,Ek.a.upb);this.HHa(1,Ek.a.K8k);this.HHa(1,"CustomTaskPane");this.HHa(1,Ek.a.fVf);this.HHa(1,zf.AFrame.zt);this.HHa(1,zf.AFrame.aLh);this.HHa(1,zf.AFrame.WKh);this.HHa(1,Ek.a.z3d);this.HHa(1,Ek.a.hYc);this.HHa(1,Ek.a.XZc);this.Kzk=(this.S7g=!!y.AFrameworkApplication.ua&&!!y.AFrameworkApplication.ua.Ib)&&y.AFrameworkApplication.ua.Ib.d_f;this.Myk=
Xi.a.Yoc;this.Syk=this.S7g&&y.AFrameworkApplication.ua.Ib.P9c;this.initialize();ja.fb(Nb.a.HCg,rk.a.application,Rp.HCg,96)}get eue(){if(!jg.StaticActiveAppFrame.za()||!jg.StaticActiveAppFrame.za().XF)return null;this.D5e||(this.D5e=new qo.a(jg.StaticActiveAppFrame.za().XF,zm.FocusManager.instance()));return this.D5e}Xb(){}cnj(ja,Ua){const yb=ro.a.instance,Wb=zm.FocusManager.instance(),tc=Fo.EventHandlerManager.instance,Rc=this;mm.UISurfaces.Iv().then(Id=>{Rc.UKc=Rc.wfc(Wb);let Pd;Id.renderTaskPaneGroups(ja,
Ua,(Pd=new pp,Pd.middleContainer=jg.StaticActiveAppFrame.za().XF,Pd.onTabStripFocus=()=>{Wb.EE(Ek.a.pyc)},Pd.onOpen=(Rd,Ue)=>{Rc.e_f(Rd)&&wl.Oul(Rd,Ue);tc.xdf(Ue,"focus",Rc.TEi(Rd,Wb),!0);var tf=Rc.lYi(Rd),cg=Id.selectors.getTabbedTaskPaneCount(tf?1:2);tf=tf?Ek.a.SAe:Ek.a.pyc;1===cg&&(yb.fea(tf),this.isPaneOpen=!0,this.swj({isPaneOpen:this.isPaneOpen,f1b:Ue}));Ue=Rc.OIf(Rd);if(cg=Wb.ie(Ue))cg.NVc=tf,Rc.i2o(Rd)&&(cg.nt(Rc.xZ),cg.nt(Rc.yZ)),yb.SWi(Ue)&&yb.ay(Ue);this.xWi&&this.l1d&&this.l1d.dismissFloatie(!0)},
Pd.onClose=(Rd,Ue)=>{Rc.e_f(Rd);const tf=Rc.lYi(Rd),cg=tf?Ek.a.SAe:Ek.a.pyc;Id.selectors.getTabbedTaskPaneCount(tf?1:2)||(yb.ay(cg),this.isPaneOpen=!1,this.swj({isPaneOpen:this.isPaneOpen,f1b:Ue}));tc.Uqg(Ue,"focus",Rc.TEi(Rd,Wb),!0);this.xWi&&this.l1d&&this.l1d.dismissFloatie(!0)},Pd.setFocusCallback=(Rd,Ue)=>{Rc.e_f(Rd)&&Ue&&(Rd=Wb.ie(Rc.OIf(Rd)),Rd.Wpl(),Rd.sja(Ue))},Pd.onOverflowMenuOpen=()=>{if(Rc.UKc)Rc.UKc.onMenuOpen()},Pd.onOverflowMenuClose=()=>{if(Rc.UKc)Rc.UKc.onMenuClose()},Pd.onShow=
(Rd,Ue)=>{2===Ue&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{Wb.Jg(Rd)},0)})},Pd.onHide=(Rd,Ue,tf)=>{tf&&1!==Ue&&Wb.Jg(Wb.IW)},Pd.onResizeStart=()=>{if(jg.StaticActiveAppFrame.za()&&(jg.StaticActiveAppFrame.za().XF.className=Ik.a.jNg,Rc.eue))Rc.eue.onMenuOpen()},Pd.onResizeEnd=()=>{if(jg.StaticActiveAppFrame.za()&&(Qp.a.N_i()||(jg.StaticActiveAppFrame.za().XF.className+=" "+jg.StaticActiveAppFrame.za().yZh),Rc.eue))Rc.eue.onMenuClose()},Pd));this.tna(Ek.a.pyc,Wb,Ua,Rc);this.tna(Ek.a.SAe,
Wb,ja,Rc);return null})}tna(ja,Ua,yb,Wb){const tc=Ua.ie(ja);tc.parent=zf.AFrame.Eq;tc.HL=!0;lm.a.instance.EHa(ja,yb,!1);aq.a.instance.EHa(ja,yb,!1);ja=new dj.DOMFocusListing(()=>yb);ja.Yn(3);ja.Yn(2);ja.Yn(4);ja.Yn(1);Ua.Vqa(()=>yb,tc,ja).NR=!0;tc.nt(Wb.xZ);tc.nt(Wb.yZ)}OIf(ja){return ja===this.Grh?Ek.a.dKh:ja}TEi(ja,Ua){return()=>{Ua.EE(this.OIf(ja))}}i2o(ja){return ja===this.Grh?!1:!0}agn(ja){return ja===Ek.a.upb}e_f(ja){return this.agn(ja)||ja===Ek.a.dKh||0<=ja.indexOf("AppForOfficePanel")||ja===
Ek.a.z3d||ja===Ek.a.fVf&&this.Kzk||ja===Ek.a.hYc&&this.Myk||ja===Ek.a.XZc&&this.Syk||ja===El.a.zOb?!0:!1}lYi(ja){return ja===Ek.a.upb||"SampleTaskPane"===ja}static kLm(){return new Rp(y.AFrameworkApplication.va,y.AFrameworkApplication.isRtl)}static HCg(ja,Ua,yb,Wb,tc){if(1===yb)return 32;mm.UISurfaces.Iv().then(Rc=>{Rc.showTaskPane(tc,Object.assign(new Oo.a,{title:"Sample Task Pane",width:320,location:2,contentProps:Object.assign(new jp,{type:"SampleTaskPaneProps"})}));return null});return 32}F5a(ja){this.sa.addHandler("onPaneToggle",
ja)}bkd(ja){this.sa.removeHandler("onPaneToggle",ja)}swj(ja){this.sa.raiseEvent("onPaneToggle",ja)}get l1d(){this.SQe||(this.SQe=C.a.instance.Oa(787));return this.SQe}}Object(f.a)(Rp,"TaskPaneManager",Sl,[288]);class Go{constructor(){this.mW=null}get name(){return"WordEditor.TaskPaneManager"}uc(){}init(){this.mW=Rp.kLm();this.mW.Xb();jg.StaticActiveAppFrame.za().Ieb=this.mW}dispose(){}}Object(f.a)(Go,"PackageManager",null,[0,1]);d.d(L,"a",function(){return m})},1996:function(J,L,d){J=d(0);var m=d(2),
f=d(123),a=d(48),l=d(236),w=d(19),z=d(17),x=d(87),u=d(193),v=d(43),E=d(30),y=d(14),H=d(40),I=d(5),F=d(7),C=d(83),P=d(305),K=d(82),G=d(11),R=d(6),W=d(106),Z=d(12),T=d(31),N=d(227),U=d(33),ba=d(228),X=d(16),Y=d(77),ca=d(148),ia=d(875),la=d(3),ta=d(85),za=d(65),Ha=d(119),Na=d(102),ya=d(37),ma=d(482),Ea=d(448),Ba=d(38),$a=d(22),ea=d(51),ka=d(164),La=d(21),va=d(27),Ca=d(253),ua=d(8),Sa=d(1018),Ta=d(1474),zb=d(1504),Ra=d(297),qb=d(238),kb=d(80),Va=d(308),Za=d(518);class Ka extends Ra.a{constructor(pb,ob,
sb,Ab,nc,qc,Jc,ad){super();this.xCh=this.ox=null;this.init(pb);this.qm("FormattingViewOperation");this.bsb(m.AFrameworkApplication.va,ob,Ab,nc,qc);this._context=sb;this.bgb=0;this.Ks=!0;this.Htk=Jc;this.Sn=ad}get Wea(){return this.Sn.instance}run(){const pb=this._context.view;var ob=null;pb.te&&(ob=pb.mb);if(ob){var sb=ob.gb.currentSelection,Ab=!zb.a.anc(this.actionId);!sb||Ka.rg.C_f(sb,Ab)?(Ka.Dc.$b(ta.a.Re,{["Reason"]:za.a.IG}),this.Ks=!1):this.Wea&&this.Wea.qnc(sb)?(Ka.Dc.$b(ta.a.Re,{["Reason"]:za.a.b8a}),
this.Ks=!1):Object(ka.a)().NEa(ua.ParagraphReader.qX,ob.Mg)&&(Ka.Dc.$b(ta.a.Re,{["Reason"]:za.a.QQ}),this.Ks=!1)}else Ka.Dc.$b(ta.a.Re,{["Reason"]:za.a.kga}),this.Ks=!1;1!==this.behavior&&this.Ks||(this.Ks&&(sb=ob.gb.currentSelection,1===ob.gb.length&&1===sb.length&&Ba.a.Zl(sb.Qa)&&Y.b(sb.Qa)&&(Ka.Dc.$b(ta.a.Re,{["Reason"]:za.a.QVc}),this.Ks=!1)),(sb=this.Ks)&&this.actionId===la.a.v8&&((sb=Array.from(ob.gb.currentSelection).some(W.FormattingReader.tqf))||Ka.Dc.$b(ta.a.Re,{["Reason"]:za.a.Qxf})),this.es=
sb?32:8,this.bgb=3);this.bgb||(qb.a.mark(5730),this.xCh=Za.SelectionReferenceFactory.instance.nMb(),sb=ob.gb.currentSelection.Qa,this.ox=new ya.GraphTransaction(15),this.ox.Bb(sb.node),this.ox.Ii=this.actionId,this.bgb=1);if(1===this.bgb){this.HC||this.Jmd(this._context.Ik);if(1===this.Dcb())return;this.bgb=2}if(2===this.bgb){if(this.actionId===la.a.v8)if(ob=ob.Mg,ob.Qw)for(sb=0;sb<ob.length;sb++)Ab=ob.getContext(sb),this.L2j(Ab);else this.L2j(ob);Va.a.Jqf&&this.slp(this.actionId,this.rd);this.xCh.Wua(this.actionId===
la.a.hY||this.actionId===la.a.oza);(ob=Object(C.a)(240,this.rd))&&!ob.t_a||kb.FocusManager.instance().Jg(pb.nL);this.ox.dispose();this.ox=null;La.StaticActiveAppFrame.za().Fe();qb.a.mark(5731);this.bgb=3;this.es=32}3===this.bgb&&(this.Htk.process(this.actionId,this._context,this.behavior,this.response),this.ova())}slp(pb,ob){const sb={};sb.FormattingActionId=pb;sb.FormattingActionData=ob;8===this.ga.Pb(la.a.QRd,2,sb)&&F.ULS.sendTraceTag(509110153,368,10,"Command applyFormattingToContentControls failed! ActionId '{0}', ActionData '{1}'",
pb,ob)}L2j(pb){(Ba.a.nw(pb)||Ba.a.ll(pb))&&Ha.a.aQ.pha(pb.node)}static get rg(){return Ca.a.instance}static get Dc(){return u.a.instance}}Object(J.a)(Ka,"FormattingViewOperation",Ra.a,[]);var bb=d(1008),Ib=d(49),ib=d(42);d.d(L,"a",function(){return hb});const jb=new Set([la.a.T2,la.a.k4,la.a.$D,la.a.gIa,la.a.hIa,la.a.r6a,la.a.lza,la.a.s6a]);class hb{constructor(pb,ob,sb=null,Ab,nc,qc,Jc,ad,Kc,Jb,Zb,xb,$b){this.kpiName="ChangeCaseCommandUsage";this.yaa="wwaengidc";this.Ktb=new Map;this.Ash=new Set;
this.JOb=()=>new ia.a(2);this.kvj=(Xb,Lb,gc,qa,ra)=>{qa=!0;Lb.contextId!==G.a.view&&(qa=!1);if(1===gc&&!qa)return 8;if(Xb===la.a.Jhd)Xb=ra.formatting,ra=ra.oDg;else{if(!Lb.view||!Lb.view.te)return 2;Lb=Lb.view;if(!Lb.mb||!Lb.mb.gb.currentSelection)return 8;Xb=ra;ra=Lb.mb.gb}this.Cvl(ra,Xb);return 32};this.qhf=(Xb,Lb,gc,qa,ra,Ya)=>new Ka(Xb,Lb,gc,qa,ra,Ya,this.muk,hb.ly());this.ORd=(Xb,Lb,gc,qa,ra)=>{var Ya,ab,cb;let Eb=!0,mc=Lb;const tb=!zb.a.anc(Xb);Lb.contextId!==G.a.Cd&&Lb.contextId!==G.a.Xc?Eb=
!1:(hb.rg.eba(mc,!1,tb)&&(hb.Dc.$b(ta.a.Nn,{["Reason"]:za.a.IG}),Eb=!1),hb.ly()&&hb.ly().instance&&hb.ly().instance.sX(mc)&&(Eb=!1),Eb&&Ba.a.Zl(Lb)&&Y.b(mc)&&(hb.Dc.$b(ta.a.Nn,{["Reason"]:za.a.QVc}),Eb=!1),ua.ParagraphReader.qX(Lb)&&(hb.Dc.$b(ta.a.Re,{["Reason"]:za.a.QQ}),Eb=!1));if(1===gc||!Eb)return Eb?32:8;if(Lb.contextId===G.a.Xc)return 2;(Lb=null===(Ya=this.yp)||void 0===Ya?void 0:Ya.u7d(mc))&&(mc=Lb);this.g2o(Xb)&&(Ya=Ba.a.H1b(mc),Ba.a.pf(Ya)||(mc=Ya));Ya="boolean"===typeof ra&&ra;Lb=!1;(null===
(ab=this.lda)||void 0===ab?0:ab.annotateRange)&&(null===(cb=this.lda)||void 0===cb?0:cb.doc(mc.node))&&(Lb=this.QZ(mc,Xb,ra,Ya));Lb&&Xb!==la.a.v8||hb.Q8.QZ(mc,Xa=>{this.jwc(Xa,Xb,ra,mc.cpEnd)},Ya);mc.node.zs&&(ab=[Object.assign(new E.a,{name:"Source",string:"CharacterFormatting"})],v.a("TOCFormatting",!0,void 0,ab));this.mcn(Xb)&&this.nUd(mc,Xb);qa&&Ta.a.tzb&&(qa.Bt|=Ta.a.nqb(mc.node));return 32};this.ard=(Xb,Lb,gc)=>1!==gc&&2===gc?(this.Ktb.set("Source","Shortcut"),Xb=Lb.node.characterData.substr(Lb.cpBegin,
Lb.cpEnd-Lb.cpBegin),hb.X_f(Xb,0,Xb.length)?this.nUd(Lb,la.a.gIa):hb.Yon(Xb,Xb.length)?this.nUd(Lb,la.a.lza):this.nUd(Lb,la.a.hIa)):32;this.Zmb=(Xb,Lb,gc)=>{let qa=!0;Xb=!zb.a.anc(Xb);Lb.contextId!==G.a.Cd&&Lb.contextId!==G.a.Xc?qa=!1:(hb.rg.eba(Lb,!1,Xb)&&(hb.Dc.$b(ta.a.Nn,{["Reason"]:za.a.IG}),qa=!1),qa&&Ba.a.Zl(Lb)&&Y.b(Lb)&&(hb.Dc.$b(ta.a.Nn,{["Reason"]:za.a.QVc}),qa=!1),qa&&ua.ParagraphReader.qX(Lb)&&(hb.Dc.$b(ta.a.Re,{["Reason"]:za.a.QQ}),qa=!1));if(1===gc||!qa)return qa?32:8;Lb=Lb.node;this.wv.sLb(Lb,
!1);Lb.zs&&(Lb=[Object.assign(new E.a,{name:"Source",string:"ClearFormatting"})],v.a("TOCFormatting",!0,void 0,Lb));return 32};this.KUc=(Xb,Lb,gc,qa,ra)=>{Xb={};Xb[bb.a.oPa]=6168;Xb[bb.a.nPa]=6169;const Ya=Lb.view;var ab=null;Ya.gj&&(ab=Ya);var cb=!0;let Eb=32;ab&&(ab=ab.mb.gb.currentSelection)&&(hb.rg.C_f(ab)?(hb.Dc.$b(ta.a.Re,{["Reason"]:za.a.IG}),Eb=8,cb=!1):1===gc&&(Eb=32,cb=!1));cb&&(cb=new ya.GraphTransaction(1===gc?3:15),cb.Bb(Ya.root),Eb=bb.a.xua(la.a.Zmb,Lb,gc,qa,ra,Xb,12),cb.dispose());
return Eb};this.yhf=(Xb,Lb,gc,qa,ra)=>{var Ya,ab=!0,cb=32;const Eb=!zb.a.anc(Xb);Lb.contextId!==G.a.Xc?ab=!1:hb.rg.eba(Lb,!1,Eb)&&(hb.Dc.$b(ta.a.Nn,{["Reason"]:za.a.IG}),ab=!1);if(1===gc||!ab)return ab?32:8;gc=Lb.node;Xb===la.a.$D&&(hb.$l.LUc(gc),this.wv.O1h(gc),ab=this.Vx.AF(gc).lh(this.Vx.wordStyleIdNormal),this.$v.WP(ab,gc,!0));gc=hb.pk.IMf(Lb);!gc&&(ab=null===(Ya=this.yp)||void 0===Ya?void 0:Ya.u7d(Lb))&&(Lb=ab,gc=$a.SelectionFactory.Qo(Lb));if(gc)cb=ea.a.jMb(gc),cb=m.AFrameworkApplication.va.Nf(cb,
Xb,2,!1,qa,ra);else{qa=Object(C.a)(240,ra);Ya=W.FormattingReader.Rs(Lb);if(!Ya)return 16;Ya=Ya.cache;switch(Xb){case la.a.font:hb.eoi();if(qa&&qa.rd){const {fontName:mc,Gha:tb,bold:Xa,italic:Mb}=hb.RIf(qa.rd);hb.pk.wwe(mc);hb.pk.Kzg(tb);Object(ma.a)()&&(Xb=1==Xa,ra=1==Mb,Xb||ra)&&(hb.pk.JN(Xb),hb.pk.eA(ra))}break;case la.a.Zw:F.ULS.sendTraceTag(595153824,340,50,"Font color is selected from Standard/Theme colors.");hb.pk.Zw(ra);break;case la.a.nva:hb.pk.Zw(ra);this.HP.gTa(ra)||F.ULS.sendTraceTag(594899723,
340,50,"Color selected from Recent Colors section. Menu: Font");break;case la.a.Oja:hb.pk.Oja();break;case la.a.hY:F.ULS.sendTraceTag(594899722,340,50,"Font background color is selected from Standard colors.");hb.pk.RDa(ra);break;case la.a.mca:hb.pk.RDa(ra);this.HP.gTa(ra)||F.ULS.sendTraceTag(594899720,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case la.a.oza:hb.pk.XUd();break;case la.a.gC:hb.eoi();hb.pk.gC(qa.rd);break;case la.a.T2:Xb=hb.pk.lI(y.a.fontSize,Ya.fontSize);
hb.pk.gC(this.Ke.T2(Xb));break;case la.a.k4:Xb=hb.pk.lI(y.a.fontSize,Ya.fontSize);hb.pk.gC(this.Ke.k4(Xb));break;case la.a.bold:Xb=hb.pk.lI(y.a.bold,Ya.isBold);hb.pk.JN(!Xb);break;case la.a.eA:Xb=hb.pk.lI(y.a.italic,Ya.isItalic);hb.pk.eA(!Xb);break;case la.a.underline:Xb=hb.pk.lI(y.a.underline,Ya.isUnderline);hb.pk.z8(!Xb);break;case la.a.hha:hb.pk.hha(ra);break;case la.a.superscript:Xb=hb.pk.lI(y.a.superscript,Ya.isSuperscript);hb.pk.qva(!Xb);break;case la.a.subscript:Xb=hb.pk.lI(y.a.subscript,Ya.isSubscript);
hb.pk.TNa(!Xb);break;case la.a.strikethrough:Xb=hb.pk.lI(y.a.strikethrough,Ya.isStrikethrough);hb.pk.rna(!Xb);break;case la.a.zu:Xb=hb.pk.lI(H.a.zu,Ya.isDoubleStrikethrough);hb.pk.rwe(!Xb);break;case la.a.$D:hb.pk.dxb();break;case la.a.v8:ra.hasProperty(y.a.mP)&&hb.pk.v8(ra.getValue(y.a.mP));ra.hasProperty(I.a.noProof)&&(Xb=ra.getValue(I.a.noProof),hb.pk.lTo(Xb));break;default:this.Ash.has(Xb)||(this.Ash.add(Xb),(ra=f.ActionManager.dea(Xb))&&ra.length||(ra="UnknownAction"),F.ULS.sendTraceTag(523120736,
324,15,`TextFormattingActor.applyFormattingIp received unexpected command: ${ra} (${Xb})`))}}La.StaticActiveAppFrame.za().Fe();return cb};this.uW=(Xb,Lb,gc,qa,ra)=>{qa=hb.Dc.nq(la.a.dQo);var Ya=!0;Lb.contextId!==G.a.Uc&&(Ya=!1);if(1===gc||!Ya)return Ya?32:8;gc=Lb.node;ib.ListItemReader.Ce?Ya=ib.ListItemReader.isListItem(gc):(Ya=R.a.Za(gc),Ya.Kd(),Ya=Ya.lla(4),Ya=!!Ya&&hb.Md.lta(Ya));if(Ya&&!Ha.a.Spc)return 8;var ab=!ua.ParagraphReader.textLength(gc);qa.properties.Z("Action",Xb.toString());qa.properties.Z("ListContext",
Ya.toString());qa.properties.Z("IsEmptyParagraph",ab.toString());F.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",Xb,Ya,ab);Ya=gc.ra.last;this.zwo(gc,Xb);var cb=!!Ya.formatting;const Eb=gc.getValue(I.a.mAa);ab=this.Qd.V7a(gc);cb=!cb&&Eb&&Eb.equals(a.a.nil)?new ca.a(Ya,a.a.nil):ab.Bf(ab.Jb);this.jwc(ab,Xb,ra,Ya.cp);hb.Mj.k_b(gc,Ya,Lb.cpBegin,Lb.cpEnd,cb,ab,hb.Od.Lg);qa.end();return 32};this.Fqa=(Xb,Lb,gc)=>{Xb=!0;const qa=R.a.Za(Lb.node);qa.Kd();Lb.contextId===
G.a.Uc&&(ib.ListItemReader.Ce?ib.ListItemReader.isListItem(Lb.node):qa.lla(4))||(hb.Dc.$b(ta.a.Nn,{["Reason"]:za.a.k3f}),Xb=!1);return(ib.ListItemReader.Ce?ib.ListItemReader.isListItem(Lb.node):hb.Md.lta(qa.currentNode))?1!==gc&&Xb?32:Xb?32:8:8};this.Iua=(Xb,Lb,gc,qa,ra)=>{Xb=!0;Lb.contextId!==G.a.paragraph&&(Xb=!1);if(1===gc&&!Xb)return 8;gc=Lb.node;-1!==ra.si?ra.si!==ua.ParagraphReader.Sy(gc)&&(ra.si=0):ra.si=ua.ParagraphReader.Sy(gc);Xb=this.Pp.zqb(gc);ra.Du?(!ra.yWm&&this.BWm(ra.Du,Xb)&&2===ra.Du.specialIndentType&&
(ra.Du.specialIndentType=0),ra.Du.Yrb===Xb.Yrb&&l.a.LBa(ra.Du.RA,Xb.RA)||(ra.Du.RA=Number.MAX_VALUE),ra.Du.Zrb===Xb.Zrb&&l.a.LBa(ra.Du.Cfa,Xb.Cfa)||(ra.Du.Cfa=Number.MAX_VALUE)):ra.Du=Xb;Lb=Object(ka.a)().GTh(Lb.Ik);void 0!==Lb&&null!==Lb&&(Lb=Lb.node,void 0!==Lb&&null!==Lb&&(Lb=N.WordSectionNavigator.instance.WR(Lb),void 0!==Lb&&null!==Lb&&(Lb=hb.tg.Gv(Lb)-(hb.tg.kN(Lb)+hb.tg.lN(Lb)+Ha.a.SEa),Xb.C6c=Lb-Xb.RA,Xb.B6c=Lb-Xb.Cfa,ra.Du.B6c=Math.min(ra.Du.B6c,Xb.B6c),ra.Du.C6c=Math.min(ra.Du.C6c,Xb.C6c))));
Lb=this.cZ.QVa(gc);ra.ZP?(ra.ZP.beforeSpacing=hb.wPh(Lb.beforeSpacing,ra.ZP.beforeSpacing),ra.ZP.afterSpacing=hb.wPh(Lb.afterSpacing,ra.ZP.afterSpacing),ra.ZP.lineSpacing.unit===Lb.lineSpacing.unit&&l.a.LBa(ra.ZP.lineSpacing.value,Lb.lineSpacing.value)||(ra.ZP.lineSpacing.unit=0,ra.ZP.lineSpacing.value=0)):ra.ZP=Lb;Lb=new R.a;Lb.set(gc);Lb.vb(11);if(gc=Lb.ld(11))ra.isRtl=U.OutlineElementReader.Eo(gc);gc=hb.Md.Pw(Lb);Lb=16;void 0!==gc&&null!==gc&&(Lb=gc.listType);ra.listType=hb.Qlm(ra.listType,Lb);
ra.Zy=16===ra.listType?null:gc;return 32};this.gho=(Xb,Lb,gc,qa,ra)=>{ra.isRtl=U.OutlineElementReader.Eo(T.OutlineElementNavigator.jm(Lb.node));return 32};this.nSh=(Xb,Lb,gc)=>{if(Xb===la.a.L_b)Xb=!0;else if(Xb===la.a.K_b)Xb=!1;else return 2;Xb&&this.E9i(Lb);if(1===gc)return 32;this.Oh.B_b(T.OutlineElementNavigator.jm(Lb.node),Xb);return 32};this.Xgo=(Xb,Lb,gc,qa,ra)=>{Xb=Lb.node;ra.isRtl=U.OutlineElementReader.isRtl(T.OutlineElementNavigator.jm(Xb));ra.si=Z.ImageReader.Sy(Xb);return 32};this.hio=
(Xb,Lb,gc,qa,ra)=>{Xb=Lb.node;ra.isRtl=U.OutlineElementReader.isRtl(T.OutlineElementNavigator.jm(Xb));ra.si=va.TableReader.Sy(Xb);-1!==ra.si&&ra.si||(ra.si=ra.isRtl?3:1);return 32};this.Rcc=(Xb,Lb,gc,qa,ra)=>{let Ya;if(!({Iz:Ya}=zb.a.VAg(gc,Lb)).returnValue)return Ya;const ab=Lb.node;switch(Xb){case la.a.K_b:this.Oh.Fwc(ab,!1);break;case la.a.L_b:this.E9i(Lb);this.Oh.Fwc(ab,!0);break;case la.a.v8:Ya=m.AFrameworkApplication.va.Nf(Lb.Ik,Xb,gc,!0,qa,ra),32===Ya&&ua.ParagraphReader.fn(Lb)&&hb.shd&&hb.shd.pha(ab)}return 32};
this.mpl=(Xb,Lb,gc,qa,ra)=>{const Ya={};Ya[bb.a.oPa]=6168;Ya[bb.a.nPa]=6169;var ab=Lb.view;const cb=new ya.GraphTransaction(1===gc?3:15);cb.Bb(ab.root);let Eb=bb.a.xua(Xb,Lb,gc,qa,ra,Ya,0),mc=null;ab.gj&&(mc=ab);ab=!0;let tb=null;mc&&(tb=mc.mb.gb.currentSelection)&&(Xb=!zb.a.anc(Xb),hb.rg.C_f(tb,Xb)?(hb.Dc.$b(ta.a.Re,{["Reason"]:za.a.IG}),Eb=8,ab=!1):1===gc&&(Eb=32,ab=!1),Object(ka.a)().NEa(ua.ParagraphReader.qX,mc.mb.Mg)&&(hb.Dc.$b(ta.a.Re,{["Reason"]:za.a.QQ}),Eb=8,ab=!1));ab&&this.cpn(tb)&&(Eb=
bb.a.xua(la.a.Zmb,Lb,gc,qa,ra,Ya,12));cb.dispose();return Eb};this.lpl=(Xb,Lb,gc)=>{Xb=!0;Lb.contextId!==G.a.paragraph&&Lb.contextId!==G.a.Xc?Xb=!1:hb.rg.iab(Lb)&&(hb.Dc.$b(ta.a.Nn,{["Reason"]:za.a.IG}),Xb=!1);if(1===gc||!Xb)return Xb?32:8;Lb=Lb.node;gc=new ya.GraphTransaction(15);gc.Bb(Lb);hb.$l.LUc(Lb);this.wv.sLb(Lb,!0);this.$v.Ynf(Lb);gc.dispose();return 2};this.URm=(Xb,Lb,gc)=>{Xb=!0;Lb.contextId!==G.a.view&&(Xb=!1);if(1===gc&&!Xb)return 8;if(!Lb.view||!Lb.view.te)return 2;Lb=Lb.view;if(!Lb.mb||
!Lb.mb.gb.currentSelection)return 8;if(Object(ka.a)().NEa(ua.ParagraphReader.qX,Lb.mb.Mg))return hb.Dc.$b(ta.a.Re,{["Reason"]:za.a.QQ}),8;Lb=Lb.mb.gb;for(const qa of Lb)for(const ra of qa)if(ra&&ra.contextId!==G.a.Cd&&ra.contextId!==G.a.Xc&&ra.contextId!==G.a.paragraph&&ra.contextId!==G.a.Uc)return 2;return 32};this.Kcb=(Xb,Lb,gc,qa,ra)=>{Xb=!0;Lb.contextId!==G.a.paragraph&&(Xb=!1);if(1===gc&&!Xb)return 8;ra.Du||(Lb=Lb.node,gc=this.Pp.zqb(Lb),ra.Du=gc,Lb=T.OutlineElementNavigator.jm(Lb),ra.isRtl=
Lb?U.OutlineElementReader.Eo(Lb):!1);return 32};this.iio=(Xb,Lb,gc,qa,ra)=>{Lb=Lb.node;Xb=T.OutlineElementNavigator.jm(Lb);ra.Du||(Lb=this.SBm(Lb),Lb=this.Pp.zqb(Lb),ra.Du=Lb,ra.isRtl=U.OutlineElementReader.isRtl(Xb));return 32};this.muk=pb;this.lda=ob;this.L9=sb;this.yp=Ab;this.Ke=nc;this.Qd=qc;this.wv=Jc;this.cZ=ad;this.$v=Jb;this.Vx=Kc;this.Oh=Zb;this.Pp=$b}get HP(){return null!=this.T1g?this.T1g:this.T1g=w.a.instance.Oa(788)}get c3d(){return!!this.L9&&this.L9.enabled}Xb(){const pb=m.AFrameworkApplication.va,
ob=this.gho;(hb.sc?hb.sc.kE(35):m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("Box4EndOfParagraphFormattingIsEnabled"))?(pb.qa(la.a.font,G.a.Uc,this.uW),pb.qa(la.a.gC,G.a.Uc,this.uW),pb.qa(la.a.T2,G.a.Uc,this.uW),pb.qa(la.a.k4,G.a.Uc,this.uW),pb.qa(la.a.Zw,G.a.Uc,this.uW),pb.qa(la.a.nva,G.a.Uc,this.uW),pb.qa(la.a.Oja,G.a.Uc,this.uW),pb.qa(la.a.hY,G.a.Uc,this.uW),pb.qa(la.a.mca,G.a.Uc,this.uW),pb.qa(la.a.oza,G.a.Uc,this.uW),pb.qa(la.a.bold,G.a.Uc,this.uW),pb.qa(la.a.eA,G.a.Uc,this.uW),pb.qa(la.a.underline,
G.a.Uc,this.uW),pb.qa(la.a.hha,G.a.Uc,this.uW),pb.qa(la.a.superscript,G.a.Uc,this.uW),pb.qa(la.a.subscript,G.a.Uc,this.uW),pb.qa(la.a.strikethrough,G.a.Uc,this.uW),pb.qa(la.a.zu,G.a.Uc,this.uW),pb.qa(la.a.v8,G.a.Uc,this.uW),pb.qa(la.a.$D,G.a.Uc,this.uW)):Ha.a.Spc&&(pb.qa(la.a.font,G.a.Uc,this.Fqa),pb.qa(la.a.gC,G.a.Uc,this.Fqa),pb.qa(la.a.Zw,G.a.Uc,this.Fqa),pb.qa(la.a.nva,G.a.Uc,this.Fqa),pb.qa(la.a.Oja,G.a.Uc,this.Fqa),pb.qa(la.a.bold,G.a.Uc,this.Fqa),pb.qa(la.a.eA,G.a.Uc,this.Fqa),pb.qa(la.a.superscript,
G.a.Uc,this.Fqa),pb.qa(la.a.subscript,G.a.Uc,this.Fqa),pb.qa(la.a.strikethrough,G.a.Uc,this.Fqa),pb.qa(la.a.zu,G.a.Uc,this.Fqa),pb.qa(la.a.T2,G.a.Uc,this.Fqa),pb.qa(la.a.k4,G.a.Uc,this.Fqa));const sb=Ha.a.V_a.IWc(Ab=>Ea.OutlineElementGeneralizer.Mka(Ab.gb,!0));pb.fb(la.a.Xmf,G.a.view,this.URm,100);pb.fb(la.a.ard,G.a.Cd,this.ard,1028);pb.qa(la.a.lZa,G.a.view,this.kvj);pb.qa(la.a.Jhd,G.a.view,this.kvj);pb.qa(la.a.Iua,G.a.view,sb);pb.qa(la.a.Iua,G.a.paragraph,this.Iua);pb.qa(la.a.Iua,G.a.image,this.Xgo);
pb.qa(la.a.Iua,G.a.XOa,ob);pb.qa(la.a.Iua,G.a.table,this.hio);pb.qa(la.a.Kcb,G.a.view,sb);pb.qa(la.a.Kcb,G.a.paragraph,this.Kcb);pb.qa(la.a.Kcb,G.a.table,this.iio);pb.Pc(la.a.lZa,99);pb.Pc(la.a.Jhd,1127);pb.Pc(la.a.Iua,97);pb.Pc(la.a.Kcb,97);this.AO(pb,la.a.font);this.AO(pb,la.a.gC);this.AO(pb,la.a.T2);this.AO(pb,la.a.k4);pb.Hlb(la.a.Coi,G.a.view,this.qhf);pb.Pc(la.a.Coi,1092);this.AO(pb,la.a.Zw);this.AO(pb,la.a.nva);this.AO(pb,la.a.Oja);this.AO(pb,la.a.hY);this.AO(pb,la.a.mca);this.AO(pb,la.a.r6a);
this.AO(pb,la.a.gIa);this.AO(pb,la.a.hIa);this.AO(pb,la.a.lza);this.AO(pb,la.a.s6a);this.AO(pb,la.a.oza);this.AO(pb,la.a.bold);pb.b_b(la.a.bold,this.JOb);this.AO(pb,la.a.eA);pb.b_b(la.a.eA,this.JOb);this.AO(pb,la.a.underline);pb.b_b(la.a.underline,this.JOb);this.AO(pb,la.a.hha);this.AO(pb,la.a.superscript);pb.b_b(la.a.superscript,this.JOb);this.AO(pb,la.a.subscript);pb.b_b(la.a.subscript,this.JOb);this.AO(pb,la.a.strikethrough);pb.b_b(la.a.strikethrough,this.JOb);this.AO(pb,la.a.zu);pb.b_b(la.a.zu,
this.JOb);pb.fb(la.a.PWa,G.a.Cd,this.ORd,96);pb.Hlb(la.a.v8,G.a.view,this.qhf);pb.qa(la.a.v8,G.a.paragraph,this.Rcc);pb.qa(la.a.v8,G.a.Cd,this.ORd);pb.qa(la.a.v8,G.a.Xc,this.yhf);pb.qa(la.a.$D,G.a.view,this.mpl);pb.qa(la.a.$D,G.a.paragraph,this.lpl);pb.qa(la.a.$D,G.a.Cd,this.ORd);pb.qa(la.a.$D,G.a.Xc,this.yhf);pb.Pc(la.a.$D,1036);pb.qa(la.a.Zmb,G.a.Cd,this.Zmb);pb.qa(la.a.Zmb,G.a.Xc,this.Zmb);pb.qa(la.a.KUc,G.a.view,this.KUc);pb.qa(la.a.K_b,G.a.view,zb.a.qx);pb.qa(la.a.K_b,G.a.paragraph,this.Rcc);
pb.qa(la.a.K_b,G.a.XOa,this.nSh);pb.Pc(la.a.K_b,1028);pb.qa(la.a.L_b,G.a.view,zb.a.qx);pb.qa(la.a.L_b,G.a.paragraph,this.Rcc);pb.qa(la.a.L_b,G.a.XOa,this.nSh);pb.Pc(la.a.L_b,1028)}AO(pb,ob){pb.Hlb(ob,G.a.view,this.qhf);pb.qa(ob,G.a.Cd,this.ORd);pb.qa(ob,G.a.Xc,this.yhf);pb.Pc(ob,1036)}Cvl(pb,ob){for(const ad of pb)for(const Kc of ad){pb=null;if(Kc.contextId===G.a.Cd){if(Y.b(Kc))continue;pb=[];var sb=Kc.node.ra;if(sb){var Ab=sb.length-1;const Jb=Kc.cpBegin,Zb=Kc.cpEnd;let xb=!1;const $b=Kc.node.characterData;
if($b&&""!==$b){var nc=$b.substr(Jb,Zb-Jb);nc&&""!==nc&&z.a.Cqf(nc,0,nc.length)&&(xb=!0)}nc=!1;for(let Xb=0;Xb<Ab;Xb++){var qc=sb.K(Xb).cp,Jc=sb.K(Xb+1).cp;if(sb.K(Xb).formatting&&Math.max(qc,Jb)<Math.min(Jc,Zb)){if($b&&""!==$b&&(qc=qc<Jb?Jb:qc,Jc=$b.substr(qc,(Jc<Zb?Jc:Zb)-qc),!xb&&z.a.Cqf(Jc,0,Jc.length)))continue;nc=!0;pb.push(sb.K(Xb).formatting)}else if(nc)break}sb.K(Ab).formatting&&Kc.cpEnd>sb.K(Ab).cp&&pb.push(sb.K(Ab).formatting)}}else if(Kc.contextId===G.a.paragraph&&!ua.ParagraphReader.qX(Kc)){if(pb=
[],sb=Kc.node.ra)for(Ab=0;Ab<sb.length;Ab++)sb.K(Ab).formatting&&pb.push(sb.K(Ab).formatting)}else if(Kc.contextId===G.a.Uc)pb=[W.FormattingReader.Rs(Kc)];else if(Kc.contextId===G.a.Xc){this.Fgo(Kc,ob);return}if(pb&&0<pb.length)for(const Jb of pb)if(W.FormattingReader.EKg(ob,Jb.cache,Kc))return}}Fgo(pb,ob){if(pb=W.FormattingReader.Rs(pb)){pb=pb.cache;var sb=hb.pk.lI(y.a.bold,pb.isBold);ob.bold=sb?1:0;sb=hb.pk.lI(y.a.italic,pb.isItalic);ob.italic=sb?1:0;sb=hb.pk.lI(y.a.underline,pb.isUnderline);ob.underline=
sb?1:0;ob.underlineType=hb.pk.lI(y.a.underlineType,pb.underlineType);sb=hb.pk.lI(y.a.superscript,pb.isSuperscript);ob.superscript=sb?1:0;sb=hb.pk.lI(y.a.subscript,pb.isSubscript);ob.subscript=sb?1:0;sb=hb.pk.lI(y.a.strikethrough,pb.isStrikethrough);ob.strikethrough=sb?1:0;sb=hb.pk.lI(H.a.zu,pb.isDoubleStrikethrough);ob.zu=sb?1:0;sb=hb.pk.lI(y.a.font,pb.gI);ob.fontName=Na.a.U8a(sb);ob.Gha=pb.Se;ob.fontSize=hb.pk.lI(y.a.fontSize,pb.fontSize);ob.fontColor=hb.pk.lI(y.a.fontColor,pb.fontColor);ob.highlight=
hb.pk.lI(y.a.highlight,pb.highlight)}}g2o(pb){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.isUnderlineButtonSelectionBugFixEnabled",!1)?pb===la.a.hha||pb===la.a.strikethrough||pb===la.a.zu||pb===la.a.hY:pb===la.a.underline||pb===la.a.hha||pb===la.a.strikethrough||pb===la.a.zu||pb===la.a.hY}static RIf(pb){return"string"===typeof pb?{fontName:pb,Gha:-1,bold:2,italic:2}:pb}QZ(pb,ob,sb,Ab){var nc;const qc=pb.cpBegin,Jc=pb.cpEnd,ad=pb.node;var Kc=W.FormattingReader.Rs(pb);
let Jb=qc;const Zb=null===(nc=m.AFrameworkApplication.J)||void 0===nc?void 0:nc.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);nc=hb.Od.Lg;if(Zb&&(nc||ad.Jv))return!1;if(jb.has(ob))for(const xb of ad.ra)if(!(xb.cp<=qc)){if(xb.cp>=Jc)break;xb.formatting&&xb.formatting.cache.fontSize!=Kc.cache.fontSize&&(Kc=this.WIf(pb.node,Kc,ob,sb,Zb?null:Ab),this.lda.annotateRange(pb.node,Zb?ad.ra.H7a(Jb):Jb,Zb?ad.ra.H7a(xb.cp):xb.cp,Kc),Jb=xb.cp,Kc=xb.formatting)}ob=this.WIf(pb.node,
Kc,ob,sb,Zb?null:Ab);this.lda.annotateRange(pb.node,Zb?ad.ra.H7a(Jb):Jb,Zb?ad.ra.H7a(Jc):Jc,ob);return!0}WIf(pb,ob,sb,Ab,nc){const qc={},Jc=Object(C.a)(240,Ab),ad=ob.cache;switch(sb){case la.a.bold:2===Ab.value&&(Ab.value=ad.isBold?0:1);qc[y.a.bold.id]=1===Ab.value;break;case la.a.eA:2===Ab.value&&(Ab.value=ad.isItalic?0:1);qc[y.a.italic.id]=1===Ab.value;break;case la.a.underline:2===Ab.value&&(Ab.value=ad.isUnderline?0:1);Ab=1===Ab.value;qc[y.a.underline.id]=Ab;qc[y.a.underlineType.id]=Ab?Na.a.Tzb:
Na.a.tV;break;case la.a.hha:qc[y.a.underlineType.id]=Ab.number;qc[y.a.underline.id]=Ab.number!==Na.a.tV;break;case la.a.superscript:2===Ab.value&&(Ab.value=ad.isSuperscript?0:1);qc[y.a.superscript.id]=1===Ab.value;1===Ab.value&&(qc[y.a.subscript.id]=!1);break;case la.a.subscript:2===Ab.value&&(Ab.value=ad.isSubscript?0:1);qc[y.a.subscript.id]=1===Ab.value;1===Ab.value&&(qc[y.a.superscript.id]=!1);break;case la.a.strikethrough:6!==m.AFrameworkApplication.va.aE?F.ULS.sendTraceTag(529090079,340,50,"User used strikethrough from ribbon"):
F.ULS.sendTraceTag(529090080,340,50,"User used strikethrough from keyboard shortcut");2===Ab.value&&(Ab.value=ad.isStrikethrough?0:1);qc[y.a.strikethrough.id]=1===Ab.value;break;case la.a.zu:2===Ab.value&&(Ab.value=ad.isDoubleStrikethrough?0:1);qc[H.a.zu.id]=1===Ab.value;break;case la.a.font:if(Jc&&Jc.rd){const {fontName:Jb,Gha:Zb,bold:xb,italic:$b}=hb.RIf(Jc.rd);Ab=Jb.substr(0,hb.kbj);this.c3d&&(qc[I.a.f2.id]=Ab,qc[I.a.tF.id]=Ab,qc[I.a.y6.id]=Ab,qc[I.a.l7.id]=Ab,qc[I.a.Ye.id]=Zb,qc[I.a.vf.id]=Zb,
qc[I.a.Ue.id]=Zb,qc[I.a.$e.id]=Zb);qc[y.a.font.id]=Ab;qc[I.a.Se.id]=Zb;if(Object(ma.a)()){Ab=1==xb;var Kc=1==$b;if(Ab||Kc)qc[y.a.bold.id]=Ab,qc[y.a.italic.id]=Kc}}break;case la.a.Zw:Ab=Sa.a.instance.Qja(pb,Ab);qc[y.a.fontColor.id]=Ab;break;case la.a.nva:Kc=Sa.a.instance.Qja(pb,Ab);qc[y.a.fontColor.id]=Kc;this.HP.gTa(Ab)||F.ULS.sendTraceTag(529006977,340,50,"Color selected from Recent Colors section. Menu: Font");break;case la.a.Oja:qc[y.a.fontColor.id]=K.a.auto;break;case la.a.hY:qc[y.a.highlight.id]=
parseInt(Ab,16);break;case la.a.mca:qc[y.a.highlight.id]=parseInt(Ab,16);this.HP.gTa(Ab)||F.ULS.sendTraceTag(529006978,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case la.a.oza:qc[y.a.highlight.id]=K.a.auto;break;case la.a.gC:qc[y.a.fontSize.id]=this.Ke.Oec(Jc.rd);break;case la.a.T2:ad&&ad.fontSize&&(qc[y.a.fontSize.id]=this.Atm(ad.fontSize));break;case la.a.k4:ad&&ad.fontSize&&(qc[y.a.fontSize.id]=this.Cmm(ad.fontSize));break;case la.a.PWa:if(Ab=null===(Kc=hb.pB)||
void 0===Kc?void 0:Kc.PWa)for(const Jb of Ab.ek())qc[Jb.id]=Ab.wf(Jb);break;case la.a.$D:if(Ab=ob.lo)for(const Jb of Ab.ek())qc[Jb.id]=null;qc[I.a.rLb.id]=!0;break;case la.a.gIa:case la.a.hIa:case la.a.r6a:case la.a.lza:case la.a.s6a:ad.eWa&&2===ad.capitalization&&(qc[H.a.capitalization.id]=0)}null!=nc&&(qc[m.AFrameworkApplication.xEf]=nc);return qc}Atm(pb){pb=this.Ke.T2(pb);return this.Ke.Oec(pb)}Cmm(pb){pb=this.Ke.k4(pb);return this.Ke.Oec(pb)}jwc(pb,ob,sb,Ab){var nc=pb.cache;const qc=Object(C.a)(240,
sb);switch(ob){case la.a.bold:2===sb.value&&(sb.value=nc.isBold?0:1);this.Ke.JN(pb,1===sb.value);break;case la.a.eA:2===sb.value&&(sb.value=nc.isItalic?0:1);this.Ke.eA(pb,1===sb.value);break;case la.a.underline:2===sb.value&&(sb.value=nc.isUnderline?0:1);this.Ke.z8(pb,1===sb.value);break;case la.a.hha:this.Ke.hha(pb,sb);break;case la.a.superscript:2===sb.value&&(sb.value=nc.isSuperscript?0:1);this.Ke.qva(pb,1===sb.value);break;case la.a.subscript:2===sb.value&&(sb.value=nc.isSubscript?0:1);this.Ke.TNa(pb,
1===sb.value);break;case la.a.strikethrough:6!==m.AFrameworkApplication.va.aE?F.ULS.sendTraceTag(539305613,340,50,"User used strikethrough from ribbon"):F.ULS.sendTraceTag(539305614,340,50,"User used strikethrough from keyboard shortcut");2===sb.value&&(sb.value=nc.isStrikethrough?0:1);this.Ke.rna(pb,1===sb.value);break;case la.a.zu:2===sb.value&&(sb.value=nc.isDoubleStrikethrough?0:1);this.Ke.rwe(pb,1===sb.value);break;case la.a.font:if(qc&&qc.rd){const {fontName:Jc,Gha:ad,bold:Kc,italic:Jb}=hb.RIf(qc.rd);
this.Ke.cha(pb,Jc.substr(0,hb.kbj));this.Ke.Kzg(pb,ad);Object(ma.a)()&&(sb=1==Kc,Ab=1==Jb,sb||Ab)&&(this.Ke.JN(pb,sb),this.Ke.eA(pb,Ab))}break;case la.a.Zw:F.ULS.sendTraceTag(595153825,340,50,"Font color is selected from Standard/Theme colors.");this.Ke.Zw(pb,sb,null);break;case la.a.nva:this.Ke.Zw(pb,sb,null);this.HP.gTa(sb)||F.ULS.sendTraceTag(594899727,340,50,"Color selected from Recent Colors section. Menu: Font");break;case la.a.Oja:this.Ke.Oja(pb);break;case la.a.hY:F.ULS.sendTraceTag(594899726,
340,50,"Font background color is selected from Standard colors.");this.Ke.RDa(pb,sb);break;case la.a.mca:this.Ke.RDa(pb,sb);this.HP.gTa(sb)||F.ULS.sendTraceTag(594899724,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case la.a.oza:this.Ke.XUd(pb);break;case la.a.gC:this.Ke.gC(pb,qc.rd);break;case la.a.T2:this.Ke.qKi(pb);break;case la.a.k4:this.Ke.GTj(pb);break;case la.a.v8:nc=sb.ka(I.a.noProof,!1);this.Ke.Nwe(pb,sb.getValue(y.a.mP),Ab,nc);break;case la.a.PWa:this.Ke.ywe(pb);
break;case la.a.$D:this.Ke.$qa(pb);break;case la.a.gIa:case la.a.hIa:case la.a.r6a:case la.a.lza:case la.a.s6a:nc.eWa&&2===nc.capitalization&&this.Ke.Zol(pb)}}zwo(pb,ob){la.a.$D===ob&&T.OutlineElementNavigator.jm(pb).properties.removeProperty(y.a.G3)}BWm(pb,ob){return this.GSh(pb,ob)||this.GSh(ob,pb)}GSh(pb,ob){return(1===pb.specialIndentType||!pb.specialIndentType)&&2===ob.specialIndentType}SBm(pb){var ob;pb=R.a.Za(pb);pb.vb(11);X.moveToCell(pb,0,0);pb.Zd();if(null===(ob=Ib.a.getInstance())||void 0===
ob?0:ob.Ula)return U.OutlineElementReader.nN(pb);pb.y_();return pb.currentNode}cpn(pb){return!pb||Ba.a.Am(pb)||1===pb.length&&Ba.a.Zl(pb.Qa)&&!Ba.a.Jsb(pb.Qa)?!1:!0}E9i(pb){hb.LBh.lb(pb.contextId)||(F.ULS.sendTraceTag(42276747,340,50,"RTL Usage : {0}",pb.contextId),hb.LBh.Z(pb.contextId,!0))}mcn(pb){return pb===la.a.r6a||pb===la.a.gIa||pb===la.a.hIa||pb===la.a.lza||pb===la.a.s6a}nUd(pb,ob){const sb=pb.node,Ab=sb.characterData.substr(pb.cpBegin,pb.cpEnd-pb.cpBegin);this.Ktb.set("Command",ob.toString());
x.Health.instance.recordKpiUsage(this.kpiName,1,this.yaa,this.Ktb);ob=hb.Mfp(Ab,ob);sb.kva(sb.characterData.substr(0,pb.cpBegin)+ob+sb.characterData.substr(pb.cpEnd));return 32}static get pk(){return hb.pB||(hb.pB=w.a.instance.resolve(106))}static ly(){return hb.Sn||(hb.Sn=w.a.instance.Ra(51))}static get rg(){return Ca.a.instance}static get Dc(){return u.a.instance}static get sc(){return null!=hb.gVg?hb.gVg:hb.gVg=w.a.instance.Oa(12)}static get shd(){return Ha.a.aQ}static get Od(){return null!=hb.Z4g?
hb.Z4g:hb.Z4g=w.a.instance.resolve(46).instance}static get Mj(){return null!=hb.A4g?hb.A4g:hb.A4g=w.a.instance.resolve(39).instance}static get Q8(){return null!=hb.c4g?hb.c4g:hb.c4g=w.a.instance.resolve(376)}static get Md(){return null!=hb.W_g?hb.W_g:hb.W_g=w.a.instance.resolve(10)}static get $l(){return null!=hb.I_g?hb.I_g:hb.I_g=w.a.instance.resolve(32)}static get tg(){return ba.a.instance}static Qlm(pb,ob){return 42===pb?ob:pb!==ob||16===pb?16:pb}static wPh(pb,ob){pb.aVi||(ob.aVi?ob=pb:ob.unit===
pb.unit&&l.a.LBa(ob.value,pb.value)||(ob.value=-1));return ob}static Mfp(pb,ob){switch(ob){case la.a.gIa:return pb.toLowerCase();case la.a.hIa:return 6!==m.AFrameworkApplication.va.aE?F.ULS.sendTraceTag(539305615,340,50,"User changed the case via ribbon"):F.ULS.sendTraceTag(539305616,340,50,"User changed the case from keyboard shortcut"),pb.toUpperCase();case la.a.r6a:case la.a.lza:return hb.xll(pb,ob===la.a.lza);case la.a.s6a:return hb.iip(pb);default:return pb}}static iip(pb){let ob="";for(let sb=
0;sb<pb.length;sb++)ob=pb.charAt(sb)===pb.charAt(sb).toUpperCase()?ob+pb.charAt(sb).toLowerCase():ob+pb.charAt(sb).toUpperCase();return ob}static xll(pb,ob){let sb,Ab,nc=!0,qc=pb.length,Jc=0,ad=hb.X_f(pb,Jc,qc);for(;0<qc;){Ab=sb=!1;var Kc=qc;let Zb;var Jb=void 0;for(Jb=0;0<Kc&&hb.bol(pb.charAt(Jc+Jb));Jb++,Kc--)Ab=hb.Uee(pb.charAt(Jc+Jb));for(Zb=Jb;0<Kc&&!(sb=hb.Uee(pb.charAt(Jc+Jb)))&&" "!==pb.charAt(Jc+Jb)&&"/"!==pb.charAt(Jc+Jb);Jb++,Kc--);Kc=Jb-Zb;if(0>=Kc)break;Jc+=Zb;Jb=pb.substr(Jc,Kc);Jb=
Jb===Jb.toUpperCase();if(ad||!Jb)pb=nc||Ab||ob?pb.substr(0,Jc)+pb.charAt(Jc).toUpperCase()+pb.substr(Jc+1,Kc-1).toLowerCase()+pb.substr(Jc+Kc):pb.substr(0,Jc)+pb.substr(Jc,Kc).toLowerCase()+pb.substr(Jc+Kc);qc-=Kc+Zb;Jc+=Kc;if(nc=sb)Jc++,qc--,ad=hb.X_f(pb,Jc,qc)}return pb}static X_f(pb,ob,sb){for(;0<sb&&!hb.Uee(pb.charAt(ob));){if(pb.charAt(ob)!==pb.charAt(ob).toUpperCase())return!1;ob++;sb--}return!0}static Yon(pb,ob){for(var sb=0;0<ob&&!hb.Uee(pb.charAt(sb));){if(pb.charAt(sb)!==pb.charAt(sb).toLowerCase())return!1;
sb++;ob--}return!0}static Uee(pb){return"."===pb||"!"===pb||"?"===pb?!0:!1}static bol(pb){return-1==="0123456789".indexOf(pb)&&pb.toUpperCase()===pb.toLowerCase()}static eoi(){const pb=w.a.instance.Ra(2);pb&&pb.execute(ob=>{ob.logActivity("FontsSurveyActivity","FontsFloodgateSurvey")})}}hb.LBh=new P.a;hb.pB=null;hb.Sn=null;hb.kbj=31;Object(J.a)(hb,"TextFormattingActor",null,[])},2087:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);var m;(function(f){f[f.initial=0]="initial";f[f.eWj=1]="startSearch";
f[f.DIj=2]="searching";f[f.Axb=3]="searchComplete";f[f.Ouc=4]="replaceAllInProgress";f[f.Nuc=5]="replaceAllComplete";f[f.Jha=6]="tooManyResults";f[f.oYa=7]="noMatchesFound"})(m||(m={}));Object(J.b)("FindReplaceViewType",m)},2089:function(J,L,d){d.d(L,"a",function(){return m});var m;(function(f){f[f.initial=0]="initial";f[f.headings=1]="headings";f[f.find=2]="find";f[f.replace=3]="replace";f[f.intelligentPlaceholder=4]="intelligentPlaceholder";f[f.contracts=5]="contracts"})(m||(m={}))},2118:function(J,
L,d){function m(b,h){h=Object.assign(new ia.a,{name:"LinkType",string:h});f(ub.a.u7m,b,[h])}function f(b,h,r,A=!0){h&&h.UILocation&&Object(ac.d)(b,A,ac.e,0,h.UILocation,0,r)}function a(b,h){const r=Za.a.instance;return new KC(b,h,r.rf(927).value,r.rf(928).value,r.resolve(242),r.resolve(82),r.resolve(322),r.resolve(46).instance,r.resolve(39).instance,er.a.instance,r.Oa(66))}function l(b,h){var r;return b===zu.none?"none":null===(r=jx[b])||void 0===r?void 0:r[h]}function w(){const b=Za.a.instance.Oa(1099);
void 0===b&&v.ULS.sendTraceTag(509694672,322,10,"getEditHostFactory: Failed to resolve edit host factory from container.");return b}function z(){const b=Za.a.instance.Oa(1100);void 0===b&&v.ULS.sendTraceTag(509224267,322,10,"getGC2ClassFactory: Failed to resolve GC2 class factory from container.");return b}function x(b){b.Ra(657).execute(async h=>{var r,A,M,aa;await h.hm();h=Ux.a.hy();const oa=await h.getSession();null!==(aa=null===(M=null===(A=null===(r=null===oa||void 0===oa?void 0:oa.sessionManager)||
void 0===r?void 0:r.networkWorkerManager)||void 0===A?void 0:A.globalUrl)||void 0===M?void 0:M.startsWith)&&void 0!==aa&&aa.call(M,"ws://localhost")&&(r={message:new Yd.y({seq:0,ops:[new on.a({parentPath:["session"],items:[{id:"doc",body:new oe.d({isReadonly:!1})}]}),new on.a({parentPath:["session","doc"],items:[{id:"headerfooters",body:new Pe.HeaderFooterSubDocument},{id:"comments",body:new Pe.CommentSubDocument},{id:"main",body:new Pe.MainSubDocument}]})]})},h.submitCustomMessage(r))})}d.r(L);var u=
d(0),v=d(7),E=d(108),y=d(2),H=d(29),I=d(17),F=d(184),C=d(90);class P{constructor(b){this.JHg=0;this.kRb=this.Ktc=this.hEa=null;this.jV=y.AFrameworkApplication.ua.Vr;this.K_=b;this.K_.Xu(C.a.GLj);this.K_.sD(C.a.GLj,Object(E.a)(this,this.hZn,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.kRb)return v.ULS.sendTraceTag(589050652,344,100,"Returning existing promise"),this.kRb;this.hEa=this.jV.Wf("ComponentAttach","getCustomAuthConfig");return this.kRb=new Promise((b,h)=>{const r={};let A=
!1,M=!1,aa=0;this.JHg=window.setInterval(()=>{4>aa?(aa++,this.K_.sendMessage(C.a.getCustomAuthConfig,r)):(window.clearInterval(this.JHg),A=!0,v.ULS.sendTraceTag(588087303,344,10,H.c({["error"]:"Request timeout after 4 retries."})),h("Request timeout."))},1E3);this.Ktc=(oa,Ja)=>{window.clearInterval(this.JHg);A||M||(M=!0,oa?(v.ULS.sendTraceTag(589050653,344,50,"Resolving Promise with authConfig"),b(oa)):(v.ULS.sendTraceTag(589050654,369,10,H.c({["error"]:Ja.toString()})),h(Ja)))};this.K_.sendMessage(C.a.getCustomAuthConfig,
r)})}hZn(b){try{const h=H.a(b.Values[F.a.ogl]);let r=y.AFrameworkApplication.J.ib("Application")||"";r=I.a.vh(r);h.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1&prompt=select_account";h.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1";h.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1&prompt=select_account";h.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1";this.hEa&&(this.hEa.stop(),
this.hEa=null);this.Ktc(h,"")}catch(h){v.ULS.sendTraceTag(589050655,344,10,H.c({["error"]:h.message,["stack"]:h.stack})),this.Ktc(null,h.message)}}}Object(u.a)(P,"AccountSwitchingManager",null,[237]);var K=d(177);class G{get name(){return"Common.App.AccountSwitching"}uc(b){b.register(P,"Common.App.AccountSwitching.AccountSwitchingManager").as(1067).ha().Sd(()=>new P(b.resolve(7)))}init(){}dispose(){}static main(){K.a.instance.Lc(new G)}}Object(u.a)(G,"AccountSwitchingPackage",null,[0,1]);var R;(function(b){b[b.x8a=
0]="generalException";b[b.Bbe=1]="invalidArgument";b[b.kbg=2]="notAllowed";b[b.Rgf=3]="apiNotAvailable";b[b.gqp=4]="unresolvedPendingRequest";b[b.timeout=5]="timeout";b[b.cdf=6]="adalTimeout";b[b.U8j=7]="userNotSignedIn";b[b.ctd=8]="userAborted";b[b.PTj=9]="silentSignInFailed";b[b.z7c=10]="invalidResourceUrl";b[b.tVf=11]="invalidGrant";b[b.N4h=12]="connectionLost";b[b.jof=13]="clientError";b[b.vxg=14]="serverError"})(R||(R={}));Object(u.b)("ErrorCodes",R);d(1819);class W{constructor(b,h){this.requestCallback=
this.requestParameters=null;this.requestParameters=b;this.requestCallback=h}}Object(u.a)(W,"OutstandingRequest",null,[]);class Z{}Z.UNn="AADSTS50058";Z.z7c="AADSTS50001";Z.NNn="AADSTS65001";Z.EOn="AADSTS70011";Z.ctd="13002";Z.U$n="Popup Window is null";Z.T$n="Popup Window closed";Z.cdf="Token renewal operation failed due to timeout";Z.sip="tokenRevoked";Object(u.a)(Z,"WopiHostErrorType",null,[]);var T=d(620),N=d(48),U=d(1818);class ba{constructor(){this.authority=this.email=this.displayName=null;
this.authority=this.email=this.displayName=""}}Object(u.a)(ba,"WopiIdentityInfo",null,[813]);class X{constructor(b,h,r){this.expiration=this.authority=this.accessToken=null;this.accessToken=b;this.authority=h;this.expiration=r}}Object(u.a)(X,"WopiIdentityToken",null,[812]);var Y=d(18),ca=d(183),ia=d(30),la=d(235);class ta{constructor(b){this._initialized=!1;this.gZn=h=>{let r=null;try{const M=h.Values[F.a.UDg],aa=h.Values[F.a.s9o],oa=h.Values[F.a.zVj],Ja=h.Values[F.a.A9o];let fb=null,Cb=null;const Gb=
this.Dsc[M];if("undefined"!==typeof Gb&&Gb){var A=[];Array.add(A,Object.assign(new ia.a,{name:F.a.TDg,string:Gb.requestParameters.correlationId}));ca.a.sendTelemetryEvent(Object.assign(new la.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:A}));r=Gb.requestCallback;delete this.Dsc[M];"undefined"!==typeof aa&&aa&&aa.length?Cb=new X(aa,oa,Ja):fb=R[this.uFn(h)];A="getAccessToken_"+M;A in this.cAe&&(this.cAe[A].stop(),delete this.cAe[A]);r(Cb,fb)}else v.ULS.sendTraceTag(37856066,
344,10,H.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:M}))}catch(M){h=h.Values[F.a.UDg],h in this.Dsc&&delete this.Dsc[h],this.mhe(),v.ULS.sendTraceTag(37856067,344,10,H.c({["error"]:M.message,["stack"]:M.stack})),r&&r(null,"generalException")}};this.Dsc={};this.cAe={};this.jV=y.AFrameworkApplication.ua.Vr;this.rSf=b}MZc(b){this._initialized||(b.Xu(C.a.Btc),b.sD(C.a.Btc,this.gZn),this._initialized=!0)}getAccessToken(b,h,r=null){this.FX(b,h);return new Promise((A,M)=>
{if(this.fWf(h))if(h in this.Dsc)M("unresolvedPendingRequest");else{var aa=window.setTimeout(()=>{v.ULS.sendTraceTag(37856032,344,10,H.c({["error"]:"Request timeout.",["callerId"]:h}));M("timeout")},12E4);this.oFf(b,h,r,(oa,Ja)=>{window.clearTimeout(aa);oa?A(oa):(v.ULS.sendTraceTag(37856033,369,15,H.c({["error"]:R[Ja]})),M(Ja))})}else v.ULS.sendTraceTag(37856034,344,10,H.c({["error"]:"Caller is not allowed."})),M("notAllowed")})}getPrimaryIdentityInfo(b){return new Promise((h,r)=>{this.fWf(b)?this.cEm((A,
M)=>{A?h(A):(v.ULS.sendTraceTag(37856064,369,10,H.c({["error"]:M.toString()})),r(M))}):(v.ULS.sendTraceTag(37856065,344,10,H.c({["error"]:"Caller is not allowed."})),r("notAllowed"))})}getAuthContext(b){return new Promise((h,r)=>{const A=this.getAuthContextSync(b);A?h(A):r("notAllowed")})}getAuthContextSync(b){if(this.fWf(b)){const h=new U.a;h.upn=y.AFrameworkApplication.J.ib("UserPrincipalName");h.userId=y.AFrameworkApplication.J.ib("LoggableUserId");h.authority=y.AFrameworkApplication.J.ib("HostAuthAuthority");
h.tenantId=y.AFrameworkApplication.J.ib("TenantId");h.isAnonymous=y.AFrameworkApplication.J.$("IsAnonymousUser");h.supportsAuthToken=this.RZm(b);b=y.AFrameworkApplication.J.ib("HostAuthType");h.authorityType="aad"===b.toLowerCase()?2:"msa"===b.toLowerCase()?1:0;return h}v.ULS.sendTraceTag(40751647,344,10,H.c({["error"]:"Caller is not allowed."}));return null}RZm(b){const h=T.a.L5c;return Y.a.wXa?h&&T.a.dZj?Array.contains(T.a.dZj,b.toLowerCase()):!1:h}oFf(b,h,r,A){var M=[];Array.add(M,Object.assign(new ia.a,
{name:"CallerId",string:h}));Array.add(M,Object.assign(new ia.a,{name:F.a.TDg,string:b.correlationId}));ca.a.sendTelemetryEvent(Object.assign(new la.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:M}));M=N.a.create().toString();const aa="getAccessToken_"+M,oa=this.jV.Wf("ComponentAttach",aa);this.cAe[aa]=oa;const Ja={};Ja[F.a.UDg]=M;Ja[F.a.x9o]=b.resource;Ja[F.a.y9o]=b.scope;Ja[F.a.zVj]=y.AFrameworkApplication.J.ib("HostAuthType");Ja[F.a.B9o]=y.AFrameworkApplication.J.ib("UserPrincipalName");
Ja[F.a.z9o]=b.silentLogin;Ja[F.a.u9o]=b.options;Ja[F.a.TDg]=b.correlationId;Ja[F.a.v9o]=h;r&&(Ja[F.a.addinName]=r.AddinName,Ja[F.a.t9o]=r.AddinTrustId);this.rSf.execute(fb=>{this.MZc(fb);fb.sendMessage(C.a.getAuthToken,Ja)});this.Dsc[M]=new W(b,A)}cEm(b){const h=y.AFrameworkApplication.J.ib("UserName"),r=y.AFrameworkApplication.J.ib("UserPrincipalName"),A=y.AFrameworkApplication.J.ib("LoggableUserIdSpace"),M=new ba;M.email=r;M.displayName=h;switch(A){case "OrgIdPuid":M.authority="AzureActiveDirectoryAccount";
break;case "MsaCid":case "MsaPuid":M.authority="MicrosoftAccount";break;default:M.authority=A}b(M,null)}fWf(b){var h=y.AFrameworkApplication.ZPm();b=b.toLowerCase();for(const r of h)if(b===r.toLowerCase())return!0;h=T.a.Xgf;for(const r in h)if(b===h[r].toLowerCase())return!0;return!1}uFn(b){b=b.Values[F.a.w9o];this.mhe();v.ULS.sendTraceTag(39068821,344,15,H.c({["error"]:b}));return b?-1<b.indexOf(Z.UNn)?9:-1<b.indexOf(Z.U$n)||-1<b.indexOf(Z.T$n)?12:-1<b.indexOf(Z.z7c)?10:-1<b.indexOf(Z.ctd)?8:-1<
b.indexOf(Z.EOn)||-1<b.indexOf(Z.NNn)||b===Z.sip?11:-1<b.indexOf(Z.cdf)?6:0:13}FX(b,h){b=this.Joo(b.resource);v.ULS.sendTraceTag(39921882,344,50,H.c({["callerId"]:h,["resource"]:b}))}mhe(){v.ULS.sendTraceTag(39068822,344,50,H.c({["userAgent"]:window.navigator.userAgent}))}Joo(b){return(b?b:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(u.a)(ta,"WopiIdentityManager",null,[778]);class za{constructor(){this.W=null;this.fz=()=>{try{this.W.resolve(730)}catch(b){v.ULS.sendTraceTag(571074327,
383,10,"Failed to initialize WopiIdentityPackage with exception: "+b)}}}get name(){return"Common.App.WopiIdentity"}uc(b){this.W=b;b.register(ta,1326).as(730).ha().Sd(()=>new ta(b.Ra(7)))}init(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.Uo(this.fz)}dispose(){}static main(){K.a.instance.Lc(new za)}}Object(u.a)(za,"WopiIdentityPackage",null,[0,1]);var Ha=d(513),Na=d(276),ya=d(83),ma;(function(b){b[b.uQp=0]="applicationFeatureHelperHandler";b[b.zSp=1]="cloudPolicySettings";b[b.aQp=2]="alternateAuthToken"})(ma||
(ma={}));Object(u.b)("ApplicationFeatureHelperRequestType",ma);class Ea{constructor(){this.message=null;this.httpStatusCode=0}}Object(u.a)(Ea,"HttpRequstToPromiseRejectData",null,[]);var Ba=d(87),$a=d(46),ea=d(179),ka=d(538);class La{constructor(b,h){this.Ga=b;this.Gf=h}eMb(b,h,r,A=null,M=null,aa=null,oa=null,Ja=null){const fb=ma[r],Cb=fb+"RequestFailure";Ba.Health.instance.recordKpiUsage(Cb,0,"jpittsdirects",null);return new Promise((Gb,Sb)=>{v.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",
fb);const pc=null!=oa?oa:this.Ga.ic("ApplicationFeatureHelperRequestQueueTimeout",15E3),zc=null!=Ja?Ja:this.Ga.ic("ApplicationFeatureHelperRequestSentTimeout",3E4);this.Gf.A5a(b,1,null,this.F2c(r,A),aa,1,Yc=>{v.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",fb);try{if(void 0===Yc||null===Yc||void 0===Yc.data||null===Yc.data||void 0===Yc.data.De||null===Yc.data.De){Ba.Health.instance.recordKpiFailure(Cb,"Invalid RequestSucceededEventArgs",
!1,!0,null);const ke=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",fb);Sb(this.j7(ke,Yc))}else if(Yc.data.Ie!==ea.a.pz){Ba.Health.instance.recordKpiFailure(Cb,"HttpStatusCode_"+Yc.data.Ie.toString(),!1,!0,null);const ke=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",Yc.data.Ie,
fb);Sb(this.j7(ke,Yc))}else{void 0!==M&&null!==M&&void 0!==Yc.data.vi&&null!==Yc.data.vi&&M(Yc.data.vi);var Kd=h(Yc.data.De);if(Kd)v.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",fb),Gb(Kd);else{Ba.Health.instance.recordKpiFailure(Cb,"Parse Failure",!1,!0,null);const ke=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",fb);Sb(this.j7(ke,Yc))}}}catch(ke){Ba.Health.instance.recordKpiFailure(Cb,
"Unexpected Failure",!1,!0,null),Kd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",ke,fb),Sb(this.j7(Kd,Yc))}},Yc=>{if(Yc.data){Ba.Health.instance.recordKpiFailure(Cb,"HttpStatusCode_"+Yc.data.Ie.toString(),!1,!0,null);var Kd=ka.a.jQb(Yc.data.De||"No Data");Kd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",Yc.data.Ie,Kd,fb)}else Ba.Health.instance.recordKpiFailure(Cb,
"Invalid RequestFailedEventArgs",!1,!0,null),Kd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",fb);Sb(this.j7(Kd,Yc))},void 0,void 0,pc,zc)})}j7(b,h){const r=new Ea;r.message=b;r.httpStatusCode=h&&h.data?h.data.Ie:-1;return r}F2c(b,h){const r={};r["x-UserDataSignature"]=this.Ga.ib("UserDataSignature");r["x-LicensingIsEnabled"]=this.Ga.$("LicensingIsEnabled").toString();r["x-CacheIsEnabled"]=this.Ga.$("LicensingRedisIsEnabled").toString();
r["x-OcpsIsEnabled"]=this.Ga.$("OcpsIsEnabled").toString();r["x-LicensingAADIdIsEnabled"]=this.Ga.$("LicensingAadIdIsEnabled").toString();0===b&&(r["x-LicenseCheckOnTenantEnabled"]="true",r["x-SupportUserConsentDependentFeatures"]="true",r["x-AFHUserConsentGroupValue"]="0",r["x-UseShellServiceForUserConsentGroup"]="true",r["x-SMBUserLicensingEnabled"]="true",r["x-AFHPIPLComplianceEnabled"]=$a.a.wL(window.location.href,"wd_afhpipl")||"false",r["x-ConsumerLicensingSNICertIsEnabled"]=this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ConsumerLicensingSNICertIsEnabled",
!1).toString(),r["x-MSGraphInLicensingIsEnabled"]=this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MSGraphInLicensingIsEnabled",!1).toString());if(h)for(const A of h.keys)r[A]=h.K(A);return r}}Object(u.a)(La,"HttpRequestToPromiseUtility",null,[]);var va;(function(b){b[b.JDn=0]="loki";b[b.EQp=1]="augloopACLP"})(va||(va={}));Object(u.b)("AlternateAuthSupportApp",va);class Ca{constructor(){this.Token=null;this.ExpirationTime=0}}Object(u.a)(Ca,"WacAlternateAuthToken",null,[]);class ua{constructor(b,
h){this.qip=3E5;this.m6n=r=>{let A=null;({ev:A}=H.d(r));return A};if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ga=b;this.Rvd=new Ha.a(Na.a.th());this.THc=new La(b,h);void 0!==T.a.Y5f&&null!==T.a.Y5f&&void 0!==T.a.Phe&&null!==T.a.Phe&&0<T.a.Phe&&(b=new Ca,b.Token=T.a.Y5f,b.ExpirationTime=T.a.Phe,this.Rvd.Z("loki",b))}afm(){let b=null;this.Rvd.lb(va[0])&&(b=this.Rvd.K(va[0]));return void 0===b||null===b||this.wfe(b)?this.e4l():
Promise.resolve(b.Token)}wfe(b){return b.ExpirationTime-Date.now()<this.qip}e4l(){const b=new Ha.a(Na.a.th());b.Z("X-AlternateAuthApp",va[0]);return this.THc.eMb(this.BVa("/afhs/AlternateAuthHelperHandler.ashx"),this.m6n,2,b).then(h=>{v.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",va[0]);this.Rvd.Z(va[0],h);return h.Token},h=>{h=Object(ya.a)(Ea,h);v.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",
h.message,h.httpStatusCode);return null})}BVa(b){const h=this.Ga.$("SuiteOriginForAFHSIsEnabled")?this.Ga.ib("SuiteOrigin"):this.Ga.ib("WebServiceBase");return String.format("{0}{1}?{2}",h,b,y.AFrameworkApplication.um)}}Object(u.a)(ua,"AlternateAuthHelper",null,[750]);var Sa=d(603);class Ta{constructor(b,h,r){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=b;this.isEnabled=h;this.tierName=r}}Object(u.a)(Ta,"FeatureStateChangeArgs",null,[]);var zb=d(147),Ra=d(202),qb=d(86),
kb=d(124),Va;(function(b){b[b.Enabled=0]="Enabled";b[b.Disabled=1]="Disabled"})(Va||(Va={}));Object(u.b)("FeatureState",Va);var Za=d(19),Ka=d(13),bb=d(95);class Ib{constructor(b,h,r=null,A=null,M=null){this.opb=this.Rpa=this.IAh=this.ejb=this.GMd=null;this.r6n=aa=>{(aa=H.b(aa))?(v.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),v.ULS.sendTraceTag(50938594,3004,50,"{0}",aa)):v.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");
return aa.Features};this.wSm=()=>{v.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.opb.then(aa=>{this.uyj(aa)}).catch(()=>{this.uyj({})})};this.pdo=aa=>{try{aa&&"Date"in aa&&(this.Rpa=new Date(aa.Date),v.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.Rpa.toString()))}catch(oa){v.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",oa)}};this.THc=new La(b,h);this.Ga=
b;this.yBk=b.ic("LicensingMaxRetryAttempts",0);this.dEd=b.$("IsO365ConsumerHost");this.IWe=b.$("IsO365CommercialHost");this.cWe=b.$("PremiumUpsellIsEnabled");this.G7b=!1;this.hZe=0;this.nah=r;this.HIh=A;this.ga=M;this.djb=b.$("LicensingIsEnabled");this.TFb=b.$("OcpsIsEnabled")&&this.IWe;this.kbf=b.$("ShowPrivacyDialog")&&!!A;this.v7b=b.$("IsAnonymousUser");this.y1d=new Promise(aa=>{aa(!1)});this.Ozb=new Promise(aa=>{aa(!0)});this.npb=new Ha.a(Na.a.th());this.WOd=!0;this.Jrh=this.Avm();this.hab()&&
!this.v7b?(void 0!==y.AFrameworkApplication.ua&&null!==y.AFrameworkApplication.ua&&(this.GMd=y.AFrameworkApplication.ua.Vr,void 0!==this.GMd&&null!==this.GMd&&(this.ejb=this.GMd.bYa("WebServiceCall","ApplicationFeatureHelperService"))),this.opb=this.sJg()):this.opb=new Promise(aa=>{aa({})});this.opb.catch(aa=>{aa=Object(ya.a)(Ea,aa);v.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",aa?aa.httpStatusCode.toString():"Unknown")});this.WOd&&this.isFeatureEnabled("FreemiumUpsell",
!0).then(aa=>{this.G7b=aa;return null})}Avm(){const b=this.Ga.Zx("AllLicensedFeatures")?this.Ga.cD("AllLicensedFeatures"):[],h=new Sa.a;for(let r=0;r<b.length;r++)h.add(b[r]);return h}hab(){return this.IWe||this.dEd}sJg(b=0,h=!1){v.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",h);const r=zb.a.KG();r&&(r.set("retryAttempt",b.toString()),r.set("forceRefresh",h.toString()),r.set("isO365ConsumerHost",this.dEd.toString()),r.set("isO365CommercialHost",
this.IWe.toString()),r.set("isFreemiumUpsellSettingEnabled",this.cWe.toString()));Ba.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",r);Ba.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",r);void 0!==this.ejb&&null!==this.ejb&&this.ejb.start();let A=null;h&&(A=new Ha.a(Na.a.th()),A.Z("x-LicensingForceRefresh","true"));this.IAh=new Date;return(this.djb?this.THc.eMb(this.BVa("/afhs/ApplicationFeatureHelperHandler.ashx"),this.r6n,
0,A,this.pdo,["Date"]):Promise.resolve({})).then(M=>{const aa=Object.assign(new bb.a,{durationMs:this.wWj()});aa.extendedProperties=r;aa.extendedProperties&&M&&(aa.extendedProperties.set("featureCount",qb.a.count(M).toString()),aa.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in M).toString()),aa.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in M).toString()),"FreemiumUpsell"in M&&aa.extendedProperties.set("isFreemiumUpsellEnabled",M.FreemiumUpsell.toString()),
this.Rpa&&aa.extendedProperties.set("fromCache",(this.Rpa<this.IAh).toString()));Ba.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",aa);return M},M=>{const aa=Object.assign(new bb.a,{durationMs:this.wWj()}),oa=Object(ya.a)(Ea,M);if(!oa)return v.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),Ba.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",
!1,!0,aa),new Promise((Ja,fb)=>{fb(M)});aa.extendedProperties=r;aa.extendedProperties&&aa.extendedProperties.set("status",oa.httpStatusCode.toString());Ba.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,aa);return 408===oa.httpStatusCode&&++b<=this.yBk?this.sJg(b):new Promise((Ja,fb)=>{fb(oa)})})}BVa(b){var h=this.Ga.$("SuiteOriginForAFHSIsEnabled")?this.Ga.ib("SuiteOrigin"):this.Ga.ib("WebServiceBase");h=String.format("{0}{1}",h,b);this.Ga.Zx("ApplicationFeatureHelperHttpCachingEnabled")&&
this.Ga.$("ApplicationFeatureHelperHttpCachingEnabled")&&(b=Ib.F6d(this.Ga))&&0<b.length&&(this.WOd&&(b+="ucbf"),h=new Ra.QueryStringBuilder(h),h.ye("afhskey",b),h=h.toString());return h}isFeatureEnabled(b,h){if(!this.TFb&&!this.kbf&&!this.djb)return this.Ozb;v.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",b);if("ConnectedServices"===b){var r=this.TFb?this.nah.qL("ControllerConnectedServicesEnabled"):this.Ozb;const aa=
this.kbf?this.HIh.getSettings().then(oa=>2!==oa.ZK,()=>h):this.Ozb;return r.then(oa=>oa?aa:this.y1d)}if("FreemiumUpsell"===b&&(!this.cWe||!this.dEd||this.v7b))return this.y1d;r=null;r=this.TFb?this.nah.isFeatureEnabled(b):this.Ozb;let A=null;A=this.djb?this.Rfn(b,h):this.Ozb;let M=null;M=this.kbf?this.HIh.isFeatureEnabled(b):this.Ozb;return r.then(aa=>aa?M.then(oa=>oa?A:this.y1d):this.y1d).then(aa=>{this.R8i(b,aa,!0);return aa},()=>{this.R8i(b,h,!1);return h})}R8i(b,h,r){v.ULS.sendTraceTag(526713106,
3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",b,h,r)}getFeatureTier(b,h){if(!this.djb)return new Promise(r=>{r(2)});v.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",b);return this.opb.then(r=>this.I8d(b,r,h),()=>h)}isFreemiumUpsellEnabled(){if(this.cWe&&this.dEd&&!this.v7b){if(this.G7b&&2!==this.hZe||!this.G7b&&1!==this.hZe)v.ULS.sendTraceTag(509728161,3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",
this.G7b.toString()),this.hZe=this.G7b?2:1;return this.G7b}return!1}launchUpsellExperience(b,h=null){v.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",b));var r=zb.a.KG();r&&(r.set("experienceId",b),h&&r.set("campaignId",h));Ba.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",r);(r=Za.a.instance.Oa(789))?r.A4i(b,this.wSm,h):(v.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),
Ba.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.ga.Pb(Ka.a.G3d,2,{["experience"]:b}))}Nua(b,h){if(!this.djb)return null;if(!b||!h)return v.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;const r=kb.a.create().toString();this.npb.lb(b)||this.npb.Z(b,new Ha.a(Na.a.th()));this.npb.K(b).add(r,h);v.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",
r,b));return r}VYb(b,h){this.djb&&(b&&this.npb.lb(b)?h&&kb.a.isValid(h)?this.npb.K(b).lb(h)?(v.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",h,b)),this.npb.K(b).remove(h)):v.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",h,b)):v.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",
h,b)):v.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",b)))}I8d(b,h,r){return this.WOd?b in h?h[b].LicenseTier:r:b in h?this.d7n(h[b],r):r}d7n(b,h){switch(b.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return h}}uyj(b){v.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const h=this.sJg(0,!0);
h.then(r=>{this.opb=h;qb.a.count(r)>qb.a.count(b)?Ba.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):Ba.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(const A of this.npb.keys)if(A in r){const M=this.I8d(A,r,0);A in b?this.I8d(A,b,0)!==M&&this.Abg(A,!0,M):this.Abg(A,!0,M)}else A in b&&this.Abg(A,!1,this.I8d(A,b,0))}).catch(r=>{Ba.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);v.ULS.sendTraceTag(594051086,
3004,10,JSON.stringify(r))})}Abg(b,h,r){v.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",b,h,r);h=new Ta(b,h,r);r=this.npb.K(b);for(const A of r)try{A.value(h)}catch(M){v.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",b,A.key,M.message))}}Qfn(b,h){if(this.djb){const r=
this.Jrh.contains(b);let A=!0,M="",aa=!1;return this.opb.then(oa=>{b in oa?(oa=oa[b],M=Va[oa.FeatureState],A=1!==oa.FeatureState):A=!r;this.f9i(b,r,M,aa,h,A);return A},()=>{aa=!0;r&&(A=h);this.f9i(b,r,M,aa,h,A);return A})}return this.Ozb}f9i(b,h,r,A,M,aa){v.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",b,h,A,r,M,aa)}Rfn(b,h){if(this.WOd)return this.Qfn(b,h);if(this.djb){if(this.Jrh.contains(b))return this.opb.then(r=>
b in r,()=>h);v.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",b)}return this.Ozb}wWj(){if(void 0!==this.ejb&&null!==this.ejb){const b=this.ejb.Ei;this.ejb.stop();return b}return null}static F6d(b){try{if(Y.a.FAe){const h=b.ib("UserDataSignature").split(".");if(1<h.length){const r=window.self.atob(h[1]),A=JSON.parse(r).LocalStorageKey;if(void 0!==A&&null!==A&&0<A.length)return A}}}catch(h){v.ULS.sendTraceTag(578863816,
3004,10,"GetLocalStorageCacheKey exception {0}",h.toString())}return null}}Object(u.a)(Ib,"ApplicationFeatureHelper",null,[751]);var ib=d(75);class jb{constructor(b,h){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=b.PolicySettings;b=new Date;b.setMinutes(b.getMinutes()+h);this.ExpirationTime=b.getTime()}}Object(u.a)(jb,"CloudPolicySettingsCacheData",null,[]);var hb=d(1238),pb=d(593),ob=d(293);class sb{static MTj(){return y.AFrameworkApplication.J.$("SideCarIsEnabled")?sb.lve&&
sb.m8c?new Promise(b=>{b(!0)}):new Promise((b,h)=>{sb.lve=ob.a.create(y.AFrameworkApplication.J.ib("SideCarUrl"));pb.a.l_(sb.lve);sb.lve.a2((r,A)=>{(sb.m8c=A.succeeded)?b(A.succeeded):h(A.succeeded)})}):new Promise(b=>{b(!1)})}}sb.m8c=!1;sb.lve=null;Object(u.a)(sb,"SideCarLoader",null,[]);class Ab{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(u.a)(Ab,"CloudPolicySettingsData",null,[]);class nc{constructor(b,h){this.DLe=0;this.tVd=null;this.v6n=r=>{let A=
null;({ev:A}=H.d(r));r=!!A;v.ULS.sendTraceTag(50622687,3004,r?50:10,"ParseCloudPolicySettingsResponse: Success={0}",r);return A};this.Ddo=r=>{try{if(void 0!==r&&null!==r&&"CheckIn-Interval"in r){const A=parseInt(r["CheckIn-Interval"]);void 0!==A&&null!==A&&0<A&&(this.DLe=A)}}catch(A){v.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",A)}};this.THc=new La(b,h);this.Ga=b;h=b.ib("HostAuthType");this.TFb=b.$("OcpsIsEnabled")&&b.$("IsO365CommercialHost")&&!(void 0===
h||null===h)&&"aad"===h.toLowerCase();this.evh=H.b(b.ib("OcpsDefaultSettings")||"{}");this.fKc=this.F6d();h=this.Ga.Zx("ServicesControlsMicrosoftControllerServicesList")?this.Ga.cD("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.$xd=new Sa.a;for(let r=0;r<h.length;r++)this.$xd.add(h[r]);this.TFb&&!b.$("IsAnonymousUser")&&b.$("SideCarIsEnabled")?this.tVd=this.wmp():this.tVd=this.rJg(this.TFb,this.BVa("/afhs/CloudPolicySettings.ashx"),this.v6n);this.tVd.then(()=>null).catch(r=>{r=Object(ya.a)(Ea,
r);v.ULS.sendTraceTag(50622685,3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",r?r.httpStatusCode.toString():"Unknown")})}qL(b,h=!0,r=!0){if(!this.TFb){const oa=this;return new Promise(Ja=>{Ja(oa.l3c(b))})}const A=this,M=this,aa=this.tVd.then(oa=>{try{let Ja=null;oa.PolicySettings&&"unknown"in oa.PolicySettings&&(Ja=oa.PolicySettings.unknown);if(Ja){if(b in Ja&&void 0!==Ja[b]&&null!==Ja[b])return new Promise(Cb=>{Cb("0"!==Ja[b])});const fb=b.toLowerCase();if(fb in Ja&&void 0!==
Ja[fb]&&null!==Ja[fb])return new Promise(Cb=>{Cb("0"!==Ja[fb])});if(r)return v.ULS.sendTraceTag(51512667,3004,50,"Policy"+b+" not found, using default"),new Promise(Cb=>{Cb(A.l3c(b))});v.ULS.sendTraceTag(508395746,3004,50,"Policy"+b+" not found, returning PolicyNotConfigured error");return new Promise((Cb,Gb)=>{Gb("PolicyNotConfigured")})}return new Promise(fb=>{fb(A.l3c(b))})}catch(Ja){return v.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+b+" policy value. Error Message: {0}",Ja.message),A.handleError(Ja.toString(),
h,A.l3c(b))}},oa=>M.handleError(oa,h,M.l3c(b)));aa.then(oa=>{v.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",b,oa);return null});return aa}isFeatureEnabled(b,h=!0){if(this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.Tfn(b,h);let r=new Promise(M=>{M(!0)}),A="";this.$xd.contains(b)&&(A="ControllerConnectedServicesEnabled",r=this.qL(A,h));r.then(M=>{v.ULS.sendTraceTag(50651668,
3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",b,M,A);return null});return r}Tfn(b,h=!0){let r=new Promise(M=>{M(!0)}),A="";"mso_sendASmile"===b?A="Enabled":"Survey"===b||"FloodgateSurvey"===b?A="SurveyEnabled":this.$xd.contains(b)&&(A="ControllerConnectedServicesEnabled");""!==A&&(r=this.qL(A,h));r.then(M=>{v.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",
b,M,A);return null});return r}handleError(b,h,r){return h?new Promise(A=>{A(r)}):new Promise((A,M)=>{M(b)})}rJg(b,h,r){if(!b)return Promise.resolve(new Ab);let A=!1,M=null;Ba.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let aa=this.Hrf("GetCloudPolicySettings");return(new Promise((oa,Ja)=>{if(void 0!==this.fKc&&null!==this.fKc&&0<this.fKc.length){const fb=this.Xlp();if(void 0!==fb&&null!==fb){A=!0;oa(fb);return}}this.THc.eMb(h,r,1,null,this.Ddo,["CheckIn-Interval"],
this.Ga.ic("CloudPolicySettingsRequestQueueTimeout",15E3),this.Ga.ic("CloudPolicySettingsRequestSentTimeout",3E4)).then(fb=>{v.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.nnp(fb);oa(fb);return fb},fb=>{Ja(fb);return null})})).then(oa=>{({kz:aa,returnValue:M}=this.$ze(aa));var Ja=zb.a.KG();Ja&&Ja.set("FromCache",A.toString());Ja=Object.assign(new bb.a,{durationMs:M,extendedProperties:Ja});Ba.Health.instance.recordKpiSuccess("GetCloudPolicySettings",Ja);return oa})}wmp(){return sb.MTj().then(()=>
{v.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}BVa(b){const h=this.Ga.$("SuiteOriginForAFHSIsEnabled")?this.Ga.ib("SuiteOrigin"):this.Ga.ib("WebServiceBase");return String.format("{0}{1}",h,b)}l3c(b){return b in this.evh?"0"!==this.evh[b]:!0}Xlp(){try{const b=hb.a.instance.getItem(this.fKc);if(void 0===b||null===b)return v.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),
null;v.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",b);const h=JSON.parse(b);if(void 0===h||null===h)return v.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===h.ExpirationTime||null===h.ExpirationTime)return v.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;
if((new Date(h.ExpirationTime)).getTime()<Date.now())return v.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const r=new Ab;r.PolicySettings=h.PolicySettings;r.ControllerConnectedServicesFeatureNames=new ib.a;this.Ga.Zx("ServicesControlsMicrosoftControllerServicesList")&&this.Ga.cD("ServicesControlsMicrosoftControllerServicesList");for(const A of this.$xd)r.ControllerConnectedServicesFeatureNames.add(A);v.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");
return r}catch(b){return v.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",b.toString()),null}}nnp(b){try{if(void 0===b||null===b||void 0===b.PolicySettings||null===b.PolicySettings)v.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.DLe)v.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const h=new jb(b,this.DLe),r=JSON.stringify(h);
v.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",r);hb.a.instance.setItem(this.fKc,r);v.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(h){v.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",h.toString())}}F6d(){const b=Ib.F6d(this.Ga);return b&&0<b.length?"OCPS"+b:null}Hrf(b){const h=Za.a.instance.Oa(38);return void 0!==h&&null!==h?h.Wf("WebServiceCall",b):null}$ze(b){if(void 0!==
b&&null!==b){const h=b.Ei;b.stop();return{returnValue:h,kz:null}}return{returnValue:null,kz:b}}}Object(u.a)(nc,"CloudPolicySettingsHelper",null,[748]);class qc{constructor(){this.Jgi=this.O8j=this.ZK=0;this.Kgi=this.P8j=this.SLb="";this.y8e=this.w0a=2}clone(){const b=new qc;b.ZK=this.ZK;b.O8j=this.O8j;b.Jgi=this.Jgi;b.SLb=this.SLb;b.P8j=this.P8j;b.Kgi=this.Kgi;b.w0a=this.w0a;b.y8e=this.src;return b}get src(){return this.y8e}serialize(b=null){const h={};if(!b||b.contains(qc.NVb))h[qc.NVb]=this.ZK;
if(!b||b.contains(qc.Odd))h[qc.Odd]=this.SLb;if(!b||b.contains(qc.Pdd))h[qc.Pdd]=this.w0a;return JSON.stringify(h)}static create(b,h=null){const r=new qc;r.y8e=b;void 0!==h&&null!==h&&(qc.NVb in h&&(r.ZK=h[qc.NVb]),qc.Odd in h&&(r.SLb=h[qc.Odd]),qc.Pdd in h&&(r.w0a=h[qc.Pdd]));return r}static deserialize(b,h){try{const r=JSON.parse(b);if(void 0!==r&&null!==r)return qc.create(h,r);v.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",b);throw Error.argument("settingsData");
}catch(r){throw v.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",r.toString()),r;}}}qc.NVb="CCS";qc.Odd="CCSTime";qc.Pdd="OfficePrivacyRoamedNoticeShown";Object(u.a)(qc,"UserPrivacySettings",null,[]);var Jc=d(141);class ad{constructor(b,h){if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ga=b;this.Gf=h;this.s7e=this.Ne=null}BVa(b){var h=String.format("{0}RoamingServiceHandler.ashx?action=",this.Ga.appSettings.RoamingServiceHandlerWebServiceBase||
"");h=new Sys.StringBuilder(h);h.append(b);h.append("&");h.append(y.AFrameworkApplication.um);return h.toString()}executeRequest(b,h,r,A=null){return this.Gf.HJb(b,h,A,null,r,"33",!1,null,6E4)}saveSettings(b){return new Promise((h,r)=>{try{if(void 0===this.Ne||null===this.Ne||void 0===b||null===b)v.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),r("Can't determine setting changes to save");else{var A=this.Ne.ZK!==b.ZK;if(2===this.Ne.src&&A)this.fIo(b),
h(!0);else{var M=this.oNo(b);if(void 0===M||null===M||!M.length)v.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),r("No changes to save");else if(1===this.Ne.src)h(this.H2j(M));else if(0===this.Ne.src){v.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",M);const aa=this.executeRequest(this.BVa("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",M);aa.continueWith(()=>{if(aa.kp||aa.fj)v.ULS.sendTraceTag(50860929,
3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),h(!1);else{var oa=aa.result;void 0!==oa.args&&null!==oa.args&&void 0!==oa.args.data&&null!==oa.args.data&&oa.args.data.Ie===ea.a.pz?(v.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),h(!0)):(v.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),h(!1))}})}}}}catch(aa){v.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",aa.toString()),
h(!1)}})}oNo(b){if(void 0===this.Ne||null===this.Ne||void 0===b||null===b)throw Error.invalidOperation("User Privacy settings have not been initialized");const h=new ib.a;0===b.src?(this.Ne.ZK!==b.ZK&&(h.add(qc.NVb),h.add(qc.Odd)),this.Ne.w0a!==b.w0a&&h.add(qc.Pdd)):1===b.src&&this.Ne.ZK!==b.ZK&&h.add(qc.NVb);return h.count?b.serialize(h):(v.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)}getSettings(){if(!this.s7e){const b=this;this.s7e=new Promise(h=>
{try{b.Ne?h(b.Ne.clone()):b.omp().then(r=>{b.Ne=r;h(b.Ne.clone());return null},()=>{b.mmp().then(r=>{b.Ne=r;h(b.Ne.clone());return null},()=>{b.nmp().then(r=>{b.Ne=r;h(b.Ne.clone());return null},()=>{v.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");b.Ne=new qc;h(b.Ne.clone());return null});return null});return null})}catch(r){v.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",r.toString()),b.Ne=new qc,h(b.Ne.clone())}})}return this.s7e}omp(){return new Promise((b,
h)=>{try{const A=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Ga.$("PrivacyDialogShouldCheckRoaming")||A){var r=this.executeRequest(this.BVa("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");r.continueWith(()=>{try{if(r.kp||r.fj)v.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const M=r.result;if(M&&M.args&&M.args.data)if(M.args.data.Ie!==ea.a.pz)v.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",
M.args.data.Ie);else{if(M.args.data.De){b(ad.parse(M.args.data.De,0));v.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",M.args.data.De);return}v.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else v.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");h("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(M){v.ULS.sendTraceTag(50860938,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",M.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else v.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),h("Roaming should not be used")}catch(A){v.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",A.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}mmp(){return new Promise((b,
h)=>{try{const r=Jc.a.get("WacUPToggleState");let A=null;void 0!==r&&null!==r&&0<r.length&&(A=decodeURIComponent(r));if(void 0!==A&&null!==A&&0<A.length){const M=ad.parse(A,1);v.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",M.toString());b(M)}else{const M=qc.create(1),aa=new ib.a;aa.add(qc.NVb);const oa=M.serialize(aa);this.H2j(oa)?(v.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",
oa),b(M)):(v.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",oa),h("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(r){v.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",r.toString()),h("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}nmp(){return new Promise(b=>{try{var h=-1!==window.location.href.indexOf("&wdccsoff=1");const r=qc.create(2);h?(r.ZK=
2,y.AFrameworkApplication.Gei(),v.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",r.toString())):(r.ZK=1,v.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",r.toString()));b(r)}catch(r){v.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",r.toString()),h=qc.create(2),h.ZK=1,b(h)}})}fIo(b){v.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");
2===b.ZK?y.AFrameworkApplication.Gei():y.AFrameworkApplication.iYl();v.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",b)}H2j(b){try{v.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",b);const h=this.Ga.ib("PrivacyCookieDomain")||"";if(!h||!h.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");v.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",b);return Jc.a.WOj("WacUPToggleState",
b,Jc.a.XLa,h)}catch(h){return v.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",h.toString()),!1}}isFeatureEnabled(b){return this.getSettings().then(h=>{const r=this.Ga.Zx("ServicesControlsMicrosoftControllerServicesList")?this.Ga.cD("ServicesControlsMicrosoftControllerServicesList"):[],A=new Sa.a;for(let M=0;M<r.length;M++)A.add(r[M]);return A.contains(b)?2!==h.ZK:!0},()=>{v.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",b);
return!0})}static parse(b,h){try{return v.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",b,h),qc.deserialize(b,h)}catch(r){throw v.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",r.toString()),r;}}}Object(u.a)(ad,"UserPrivacySettingsHelper",null,[749]);class Kc{constructor(){this.W=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}uc(b){this.W=b;this.W.register(748,84).ha().Sd(()=>new nc(y.AFrameworkApplication.J,
y.AFrameworkApplication.Ee));this.W.register(749,83).ha().Sd(()=>new ad(y.AFrameworkApplication.J,y.AFrameworkApplication.Ee));this.W.register(750,153).ha().Sd(()=>new ua(y.AFrameworkApplication.J,y.AFrameworkApplication.Ee));this.W.register(751,4).ha().Sd(()=>new Ib(y.AFrameworkApplication.J,y.AFrameworkApplication.Ee,this.W.resolve(84),this.W.resolve(83),y.AFrameworkApplication.va))}init(){y.AFrameworkApplication.J.Uo(()=>{const b=this.W.resolve(4);y.AFrameworkApplication.J.$("LicensingIsEnabled")&&
(b.isFeatureEnabled("LicensingTestFeature",!1).then(h=>{v.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",h,y.AFrameworkApplication.J.ib("IsAnonymousUser"));return null}),b.getFeatureTier("LicensingTestFeature",0).then(h=>{v.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",h,y.AFrameworkApplication.J.ib("IsAnonymousUser"));
return null}));this.W.resolve(153);this.vfp()})}dispose(){}vfp(){try{y.AFrameworkApplication.J.$("SideCarIsEnabled")&&sb.MTj().then(b=>{v.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",b);return b})}catch(b){}}static main(){K.a.instance.Lc(new Kc)}}Object(u.a)(Kc,"ApplicationFeatureHelperPackage",null,[0,1]);var Jb=d(170);class Zb{K6d(b,h){let r;const A=[];for(;r=h.exec(b);){const M=r.index;A.push(new Jb.a(M,M+r[0].length))}return A}isEndPuncSpecialCase(b){const h=
this.K6d(b,Zb.l8o);for(const r of h)if(r.end===b.length)return!0;return!1}l_c(b){for(const h of Zb.O1l){const r=this.K6d(b,h);if(0<r.length&&!r[0].Ec)return r[0].end-1}return 0}findBeginBoundary(b,h,r){var A=b.substring(r,h);b=this.K6d(A,Zb.Aii);for(h=b.length-1;0<=h;h--){const M=A.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(M))return A=A.substring(b[h].Ec,A.length),r+b[h].end+this.l_c(A)}return r}findEndBoundary(b,h,r){var A=b.substring(h,r);b=this.K6d(A,Zb.Aii);for(r=0;r<b.length;r++){const M=
A.substring(0,b[r].end);if(!this.isEndPuncSpecialCase(M))return A=A.substring(b[r].Ec,A.length),h+b[r].end+this.l_c(A)}return-1}}Zb.bBf="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b]|[\u00bb\u2019\u201d\u203a\"']|[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])*[\u2028\u2029\n\r])";Zb.cBf=
"([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])+)";Zb.dBf="([\u3002\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*)";Zb.O1l=[new RegExp(Zb.bBf,
"ig"),new RegExp(Zb.cBf,"ig"),new RegExp(Zb.dBf,"ig")];Zb.uDg="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";Zb.xDg="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";Zb.wDg="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";
Zb.vDg=Zb.xDg+"|"+Zb.wDg;Zb.yDg="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";Zb.zDg="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";Zb.ADg="(([A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]|[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]|[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45])[.])+|(([\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d])[.\ufe52\uff0e])+";
Zb.BDg="([\uff21-\uff3a\uff41-\uff5a])[.\ufe52\uff0e]";Zb.nxg="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f])("+
Zb.vDg+"|"+Zb.yDg+"|"+Zb.zDg+")";Zb.mxg="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]|[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]|[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a])("+
Zb.ADg+")";Zb.abg=Zb.uDg+"|"+Zb.BDg;Zb.tDg=Zb.abg+"|"+Zb.nxg+"|"+Zb.mxg;Zb.Aii=RegExp("[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]|[\u3002\uff61]","ig");Zb.l8o=new RegExp(Zb.tDg,"g");Object(u.a)(Zb,"ProofingSentenceSeparatorScriptSharp",null,[745]);class xb{Dud(b,h){const r=[];let A;for(;null!=(A=h.exec(b));){const M=A.index;r.push({Ec:M,end:M+A[0].length})}return r}isEndPuncSpecialCase(b){return this.Dud(b,xb.ohk).some(h=>
h.end==b.length)}l_c(b){for(const h of xb.Rdk){const r=this.Dud(b,h);if(0<r.length&&0==r[0].Ec)return r[0].end-1}return 0}findBeginBoundary(b,h,r){var A=b.substring(r,h);b=this.Dud(A,xb.wPg);for(h=b.length-1;0<=h;h--){const M=A.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(M))return A=A.substring(b[h].Ec,A.length),r+b[h].end+this.l_c(A)}return r}findEndBoundary(b,h,r){var A=b.substring(h,r);b=this.Dud(A,xb.wPg);for(r=0;r<b.length;r++){const M=A.substring(0,b[r].end);if(!this.isEndPuncSpecialCase(M))return A=
A.substring(b[r].Ec,A.length),h+b[r].end+this.l_c(A)}return-1}}xb.xck="[)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]";xb.jhk="[\u2639\u263a\u263b]";xb.wQg="[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]";xb.zdk="[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]";
xb.ggk="[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a]";xb.BQg="[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]";
xb.Symbol="[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]";
xb.vQg="[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]";xb.ffk="[A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]";xb.efk="[\uff21-\uff3a\uff41-\uff5a]";xb.cfk="[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]";
xb.bfk="[\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d]";xb.dfk="[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45]";xb.CGe="[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]";xb.vPg="[\u3002\uff61]";xb.avd="[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]";xb.Zdk="[\u00bb\u2019\u201d\u203a\"']";xb.$Ge=xb.xck+"|"+xb.jhk;xb.gfk="[\u2028\u2029\n\r]";xb.afk="("+xb.avd+"|"+xb.wQg+"|"+xb.BQg+"|"+xb.vQg+
")";xb.$ek="("+xb.avd+"|"+xb.wQg+"|"+xb.BQg+"|"+xb.Symbol+"|"+xb.vQg+"|"+xb.zdk+"|"+xb.ggk+")";xb.bBf="("+xb.CGe+"("+xb.$Ge+"|"+xb.Zdk+"|"+xb.avd+")*"+xb.gfk+")";xb.cBf="("+xb.CGe+"("+xb.$Ge+")*("+xb.avd+")+)";xb.dBf="("+xb.vPg+"("+xb.$Ge+")*)";xb.Rdk=[new RegExp(xb.bBf,"ig"),new RegExp(xb.cBf,"ig"),new RegExp(xb.dBf,"ig")];xb.uDg="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";xb.xDg="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";
xb.wDg="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";xb.vDg=xb.xDg+"|"+xb.wDg;xb.yDg="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";xb.zDg="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";
xb.ADg="(("+xb.ffk+"|"+xb.cfk+"|"+xb.dfk+")[.])+|(("+xb.bfk+")[.\ufe52\uff0e])+";xb.BDg="("+xb.efk+")[.\ufe52\uff0e]";xb.nxg=xb.afk+"("+xb.vDg+"|"+xb.yDg+"|"+xb.zDg+")";xb.mxg=xb.$ek+"("+xb.ADg+")";xb.abg=xb.uDg+"|"+xb.BDg;xb.tDg=xb.abg+"|"+xb.nxg+"|"+xb.mxg;xb.wPg=new RegExp(xb.CGe+"|"+xb.vPg,"ig");xb.ohk=new RegExp(xb.tDg,"g");Object(u.a)(xb,"ProofingSentenceSeparator",null,[745]);class $b{constructor(){this.W=null}get name(){return"Box4.ProofingGrammarCheck"}uc(b){this.W=b;y.AFrameworkApplication.J.$("ProofingSentenceSeparatorTypeScriptIsEnabled")?
b.ia(216,()=>new xb).ha():b.ia(216,()=>new Zb).ha()}init(){this.W.resolve(216)}dispose(){}static main(){K.a.instance.Lc(new $b)}}Object(u.a)($b,"Box4GrammarCheckPackage",null,[0,1]);var Xb=d(138),Lb=d(62),gc=d(1833),qa=d(21);class ra{constructor(){this.W=null}get name(){return"Box4.AtMentions"}uc(b){this.W=b;this.W.ia(291,()=>new gc.a(this.W.resolve(215),this.W.resolve(212),this.W.resolve(790),Object(Lb.a)(),"@",["@","/"])).ha()}init(){y.AFrameworkApplication.J.Uo(()=>{this.W.resolve(291).kdc(qa.StaticActiveAppFrame.za().kb,
Xb.KeyInputManager.instance)})}dispose(){this.W.resolve(291).dispose()}static main(){K.a.instance.Lc(new ra)}}Object(u.a)(ra,"Box4AtMentionsPackage",null,[0,1]);class Ya{get name(){return"Box4.Workers"}uc(){}init(){}dispose(){}static main(){K.a.instance.Lc(new Ya)}}Object(u.a)(Ya,"Box4WorkersPackage",null,[0,1]);var ab=d(305),cb=d(94);class Eb{constructor(){this.BPa=new cb.a}r8(b,h){this.BPa.Z(b,h)}xFf(b){({value:b}=this.BPa.Ac(b));return b}}Object(u.a)(Eb,"AggregationMethodsForActivityName",null,
[]);var mc=d(255);class tb{constructor(){this.mJd=new ab.a;this.BPa=new ab.a}r8(b,h,r){this.BPa.lb(b)&&this.BPa.K(b)||this.BPa.Z(b,new Eb);this.BPa.K(b).r8(h,r)}xFf(b,h){return this.BPa.lb(b)&&this.BPa.K(b)?this.BPa.K(b).xFf(h):null}C3c(b){this.mJd.lb(b)&&this.mJd.K(b)||this.mJd.Z(b,new mc.a);return this.mJd.K(b)}mbi(b,h){this.C3c(b).add(h)}}Object(u.a)(tb,"ActivityAggregationInfo",null,[803]);var Xa=d(252),Mb=d(959),cc=d(975);class oc extends Mb.a{constructor(b,h){super(b);this.Gaf=(this.wkk=h)?
h.pqm():cc.a.fFf()}get CHa(){return this.wkk}get activityName(){return this.CHa.name}get startTime(){return this.CHa.startTime}get endTime(){return this.CHa.endTime}end(){}cancel(){}SDf(){}otp(){this.vic.Z("AM",this.CHa.mode.toString());this.vic.Z("C",this.CHa.count.toString());this.vic.Z("DA",this.CHa.Wgi.toFixed(2));this.vic.Z("DV",this.CHa.oWl.toFixed(2))}SLf(b){return this.CHa.SLf(b)}AMf(){return this.CHa.AMf()}hcc(){for(const b of this.CHa.DHa)b.hcc()}}Object(u.a)(oc,"AggregatedActivity",Mb.a,
[]);class Pc{constructor(b,h){this.cJe=0;this.ZEa=b;this.Y0a=h}Q1k(b,h){this.cJe=h;for(h=0;h<b.count;h++){const r=b.K(h);this.R1k(r)}}R1k(b){const h=Object(ya.a)(oc,b);if(h)if(1===this.cJe)this.P1k(h);else if(2===this.cJe){this.S1k(h);for(const r of this.Y0a.C3c(this.ZEa)){const A=h.CHa.DHa.K(0);A.properties.lb(r)&&b.properties.Z(r,A.properties.K(r))}}}P1k(b){for(const h of this.Y0a.C3c(this.ZEa))this.TGj(b,h)}S1k(b){for(const h of b.AMf())this.TGj(b,h)}TGj(b,h){const r=this.Y0a.xFf(this.ZEa,h);if(r){const A=
b.SLf(h);b.properties.Z(h,r(A))}}}Object(u.a)(Pc,"PropertyAggregationHelper",null,[]);var vb=d(1053);class jd{constructor(b,h,r,A,M){this.K3b=b;this.Y0a=h;this.Pah=M;this.LIe=A;this.UAk=r}get UKh(){return this.UAk.value}wVc(b){if(Object(Xa.a)(vb.a,b))b.wVc();else if(Object(Xa.a)(oc,b)&&this.LIe.ZYh(b.activityName.toString())){b=Object(ya.a)(oc,b);b.otp();b=b.xaj();var h=[];Array.add(h,b);b=H.c(h);v.ULS.sendTraceTag(6907266,213,50,b)}}MHa(b,h){const r=(new Date).getTime();var A=this.Pah.list.K(b);
const M=({U1k:A}=this.mem(A)).returnValue;this.Pah.list.Z(b,new ib.a);h&&(A=this.rAl(A,r,this.K3b.OJi));0<A.count&&(new Pc(b,this.Y0a)).Q1k(A,M)}rAl(b,h,r){const A=new ib.a;for(let M=0;M<b.count;M++){const aa=b.K(M);aa.startTime>h-r?aa.hcc():A.add(aa)}return A}mem(b){const h=this.UKh.i_j(b);b=this.UKh.Ygp(b);const r=this.V1k(h,b);return{returnValue:r,U1k:1===r?h:b}}V1k(b,h){return b.count*this.K3b.Xcj<h.count?1:2}get enabled(){return this.K3b.enabled}hcc(){}}Object(u.a)(jd,"ActivityAggregationManager",
null,[802]);class ud{constructor(b){this.enabled=!1;this.pbj=500;this.Bcj=2;this.Xcj=5;this.OJi=3E4;this.t_c(b.appSettings)}t_c(b){this.enabled=Boolean.parse(b[ud.ozf]||"false");this.pbj=parseInt(b[ud.fHn]||"500");this.Bcj=parseInt(b[ud.NJn]||"2");this.Xcj=parseInt(b[ud.mKn]||"5");this.OJi=parseInt(b[ud.rQm]||"30000")}}ud.ozf="ActivityAggregationEnabled";ud.fHn="ActivityAggregationMaxInterval";ud.NJn="ActivityAggregationMinChain";ud.mKn="ActivityAggregationModeFactor";ud.rQm="ActivityAggregationGraceWindow";
Object(u.a)(ud,"ActivityAggregationParams",null,[]);class qe{constructor(b,h){this.Y0a=b;this.d7g=h}i_j(b,h=1){if(!b||!b.count)return b;const r=new ib.a;var A=null;for(let M=0;M<b.count;M++){const aa=b.K(M);if(!aa)continue;const oa=aa.activityName;A?A.zrn(aa)?A.add(aa):(A=A.process(),r.addRange(A),A=this.d7g(oa,h),A.add(aa)):(A=this.d7g(oa,h),A.add(aa))}A&&(b=A.process(),r.addRange(b));return r}Ygp(b){if(!b||!b.count)return b;const h={};var r=null;for(let M=0;M<b.count;M++){const aa=b.K(M);if(aa){if(!r){r=
new ib.a;var A=this.Y0a.C3c(aa.activityName);for(const oa of A)r.add(oa)}A=this.CEm(aa,r);null!==A&&(A in h&&h[A]||(h[A]=new ib.a),h[A].add(aa))}}b=new ib.a;for(const M of qb.a.xR(h))r=this.i_j(h[M],2),b.addRange(r);return b}CEm(b,h){let r="";for(const A of h)r+=A,r=b.properties.lb(A)&&void 0!==b.properties.K(A)&&null!==b.properties.K(A)?r+b.properties.K(A):r+"null";return r}}Object(u.a)(qe,"ActivityAggregationSchemes",null,[800]);class Ae{constructor(b,h,r,A,M){this.rt=this.ji=0;this.K3b=r;this.pCc=
A;this.Y0a=M;this.name=b;this.vC=h;this.DHa=new ib.a}get mode(){return this.vC}get count(){return this.DHa.count}get startTime(){return this.ji}get endTime(){return this.rt}get Wgi(){if(!this.count)return 0;let b=0;for(const h of this.DHa)b+=h.endTime-h.startTime;return b/this.count}get oWl(){if(!this.count)return 0;let b=0;const h=this.Wgi;for(const r of this.DHa){const A=r.endTime-r.startTime;b+=(A-h)*(A-h)}return b/this.count}add(b){this.count?this.rt=b.endTime>this.endTime?b.endTime:this.endTime:
(this.ji=b.startTime,this.rt=b.endTime);this.DHa.add(b)}zrn(b){return 0>=this.count?!1:b.startTime-this.endTime<=this.K3b.pbj}process(){if(this.count>=this.K3b.Bcj){const b=new ib.a,h=this.pCc(this);b.add(h);return b}return this.DHa}SLf(b){const h=new ib.a;for(const r of this.DHa)if(r.properties.lb(b)){const A=r.properties.K(b);h.add(A)}else h.add(null);return h}AMf(){const b=this.Y0a.C3c(this.name),h=new mc.a;for(const r of this.Pem())b.contains(r)||h.add(r);return h}Pem(){const b=new mc.a;if(!this.DHa)return b;
for(const h of this.DHa)for(const r of h.properties.keys)b.add(r);return b}pqm(){return this.DHa.K(0).uniqueID}}Object(u.a)(Ae,"ActivityCollection",null,[801]);class hf{constructor(){this.QBb=new ab.a}get list(){return this.QBb}add(b){const h=b.activityName;if(this.QBb.lb(h)&&this.QBb.K(h)){const r=this.Btm(this.QBb.K(h),b);this.QBb.K(h).insert(r,b)}else this.QBb.Z(h,new ib.a),this.QBb.K(h).add(b)}Btm(b,h){for(let r=b.count-1;0<=r;r--)if(h.startTime>b.K(r).startTime)return r+1;return 0}}Object(u.a)(hf,
"CompletedActivitiesHelper",null,[779]);class Qe{constructor(){this.W=null}get name(){return"Common.App.ActivityAggregator"}init(){y.AFrameworkApplication.XI(()=>{this.W.resolve(791)})}dispose(){}uc(b){this.W=b;const h=A=>new oc(()=>b.Oa(132),A),r=(A,M)=>new Ae(A,M,b.resolve(792),h,b.resolve(181));b.register(jd,791).as(132).ha().Sd(()=>new jd(b.resolve(792),b.resolve(181),b.rf(793),b.resolve(133),b.resolve(794)));b.register(ud,792).ha().Sd(()=>new ud(y.AFrameworkApplication.J));b.register(tb,"Common.App.ActivityAggregator.ActivityAggregationInfo").as(181).ha().Sd(()=>
new tb);b.register(qe,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as(793).ha().Sd(()=>new qe(b.resolve(181),r));b.register(hf,794).ha().Sd(()=>new hf)}static main(){K.a.instance.Lc(new Qe)}}Object(u.a)(Qe,"ActivityAggregatorPackage",null,[0,1]);var vf=d(703),Jd=d(10),mh=d(1259);class gh{constructor(b){this.azh=0;this.yLe=null;this.uuc=()=>{v.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then(h=>{h.getChatsContainer(this.NSn)}).catch(h=>
{v.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",h)}),this.chat.getChatsCounter().then(h=>{h.onChatsCountChange(this.Ill)}).catch(h=>{v.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",h)}),this.chat.getKeyboard().then(h=>{h.onKeyDown(this.QSn)}).catch(h=>{v.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",h)}))}catch(h){v.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",h)}};this.Ill=
h=>{v.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",h);if(!h)this.yAg.MSn();else if(1===h&&!this.azh){const r=document.getElementById(this.yLe?this.yLe:mh.a.lLb);r?this.yAg.RSn(r,this.Sjp):v.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}this.azh=h};this.NSn=h=>{this.yLe=h};this.QSn=h=>{h.ctrlKey&&"f6"===h.key.toLowerCase()&&this.Rjp(h.shiftKey)};this.Sjp=()=>{v.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&this.chat.getFocuser().then(h=>{h.focusConversationInput()}).catch(h=>
{v.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",h)})}catch(h){v.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",h)}};this.VHk=b}get chat(){return window.swc}get isInitialized(){return!!this.chat}get yAg(){return this.VHk.value}Xb(){this.isInitialized?this.uuc():this.Vro(this.uuc)}Vro(b){vf.a.instance.nb(Jd.a.Icp,window.self,()=>{b();return!0})}Rjp(b){v.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");this.yAg.OSn(b)}}Object(u.a)(gh,
"ChatManager",null,[823]);var Td=d(88);class Vc{constructor(){this.sa=new Td.a;this.AOk=!1}E_k(b){this.sa.addHandler("OnTopRowControlsCreatedEvent",b)}n_k(b){this.sa.addHandler("OnRenameTextboxStatusChangedEventKey",b)}get Lip(){return this.AOk}vwj(b){this.sa.raiseEvent("OnRenameTextboxStatusChangedEventKey",b?"true":"false")}}Object(u.a)(Vc,"HeaderEventSource",null,[]);var id=d(178),Re=d(368),cf=d(93);class me{constructor(b,h,r,A,M){this.lOd=null;this.PSn=()=>{this.lOd&&this.lOd()};this.Yb=b;this.Zp=
h;this.gl=r;this.DOk=A;this.ga=M}Xyj(b,h,r,A=null){const M=this.Yb.ie(h);M.parent=r;M.HL=!0;A&&M.G$(A);this.gl.EHa(h,b,!1);this.DOk.EHa(h,b,!1);h=new Re.DOMFocusListing(()=>b);h.Yn(2);h.Yn(1);h.Yn(8);h.Yn(5);h.Yn(3);h.Yn(6);this.Yb.Vqa(()=>b,M,h).NR=!0;h=Xb.KeyInputManager.mc(cf.a.nz,0);r=Xb.KeyInputManager.mc(cf.a.nz,4);M.nt(h);M.nt(r)}onFlexPaneOpen(b){this.Xyj(b,mh.a.Lqc,mh.a.mWa);this.Yb.Jg(mh.a.Lqc);this.Zp.fea(mh.a.Lqc)}onFlexPaneClose(){this.Zp.ay(mh.a.Lqc);this.Yb.Jg(mh.a.mWa)}RSn(b,h){this.lOd||
(this.lOd=h,this.Xyj(b,mh.a.lLb,id.AFrame.EO,this.PSn));this.Yb.Jg(mh.a.lLb);this.Zp.fea(mh.a.lLb)}MSn(){this.Zp.ay(mh.a.lLb);this.Yb.u3d(id.AFrame.Ro)}OSn(b){this.ga.Ob(b?Ka.a.yBf:Ka.a.r1d,2)}}Object(u.a)(me,"ReactSharedHeaderFocusManager",null,[811]);var ce=d(123),Ie=d(1027),Le=d(41),we=d(89);class xf{constructor(b){this.Hej=(h,r,A,M,aa)=>{if(1===A)return 32;h=8;2===A&&(A=this.NGf(aa,"experience","gopremiumribbon"),aa=$a.a.Laa("2116536"),aa=$a.a.Bp(aa,"ocid",Ie.b(y.AFrameworkApplication.ua.Ib.Uk,
y.AFrameworkApplication.ua.Ib.rma,A)),Le.a.un(aa,"_blank",void 0,"NavigateToUpsellPage"),h=32,this.ga.Ob(Ka.a.FDj,2),v.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));return h};this.launchUpsellExperience=(h,r,A,M,aa)=>{if(1===A)return 32;var oa=8;2===A&&(v.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(oa=Za.a.instance.Oa(4))?(h=this.NGf(aa,"experience","gopremium"),aa=this.NGf(aa,"dimeCampaignId",null),oa.launchUpsellExperience(h,aa),oa=32):(v.ULS.sendTraceTag(594874952,
340,15,"ApplicationFeatureHelper not available"),oa=this.Hej(h,r,A,M,aa)));return oa};this.ga=b}Xb(){this.ga.qa(Ka.a.G3d,we.a.frame,this.Hej);this.ga.qa(Ka.a.Vpi,we.a.frame,this.launchUpsellExperience);this.ga.qa(Ka.a.kBo,we.a.frame,ce.ActionManager.Zf);this.ga.qa(Ka.a.FDj,we.a.frame,ce.ActionManager.Zf)}NGf(b,h,r){b&&b[h]&&(r=Object(ya.a)(String,b[h]));return r}}Object(u.a)(xf,"UpsellActor",null,[777]);class Ig{constructor(){this.W=null}get name(){return"Common.App.Header"}init(){Za.a.instance.resolve(795).Xb();
Za.a.instance.resolve(796).Xb()}dispose(){}uc(b){this.W=b;this.W.register(Vc,692).ha();this.W.register(xf,"Common.App.Header.UpsellActor").as(795).ha().Sd(()=>new xf(y.AFrameworkApplication.va));this.W.register(me,"Common.App.Header.ReactSharedHeaderFocusManager").as(797).ha().Sd(()=>new me(y.AFrameworkApplication.ua.oq,y.AFrameworkApplication.ua.Ay,y.AFrameworkApplication.ua.S8,y.AFrameworkApplication.ua.EBe,y.AFrameworkApplication.va));this.W.register(gh,"Common.App.Header.ChatManager").as(796).ha().Sd(()=>
new gh(this.W.rf(797)))}static main(){K.a.instance.Lc(new Ig)}}Object(u.a)(Ig,"CommonAppHeaderPackage",null,[0,1]);var jg=d(754);class kg{static $ri(b,h){switch(b){case 3:return kg.nPm(h);case 2:return kg.WAm(h);case 1:return kg.Vom(h)}return""}static nPm(b){switch(b){case 1:return y.AFrameworkApplication.J.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return y.AFrameworkApplication.J.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static WAm(b){switch(b){case 1:return y.AFrameworkApplication.J.appSettings.WildFireAdjustLinkPptWac.toString();
case 2:return y.AFrameworkApplication.J.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static Vom(b){switch(b){case 1:return y.AFrameworkApplication.J.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return y.AFrameworkApplication.J.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static KX(b,h,r){if(Y.a.Ci||Y.a.rI)window.setTimeout(()=>{kg.hyj(r,kg.W8d())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(kg.KQh(r),b,0,!1)}static yql(b,h,r,A){h&&A&&A();
kg.KX(b,h,r)}static W8d(){return Y.a.Ci?1:Y.a.rI?2:Y.a.Dab?3:Y.a.Qm?4:0}static UOm(b){switch(b){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static VOm(b){switch(b){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}}static get VYf(){return"zh-CN"===window.navigator.language}static hyj(b,h){1===h?(v.ULS.sendTraceTag(17151569,
306,50,"User Directed to App Store"),b=kg.$ri(b,h),8<Y.a.Z9a?Le.a.un(b,void 0,void 0,"RedirectToAppStore"):Le.a.Epb(b)):document.hidden||(kg.VYf?(b=y.AFrameworkApplication.J.appSettings.WildFireUrlChinaStoreAndroid.toString())?(v.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),Le.a.Epb(b)):v.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(v.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(kg.$ri(b,
h),null,null)))}static KQh(b){switch(b){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get sye(){return(Y.a.Dab||Y.a.Qm)&&Y.a.Pr}static get E1o(){return Y.a.Ci||Y.a.rI}static tsi(b){switch(b){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static vYi(b){return(b=kg.xum(b))&&""!==b?Boolean.parse(b):!1}static Szg(b){kg.aSo(b)}static xum(b){try{return localStorage.getItem(b)}catch(h){return v.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+h.message),null}}static aSo(b){try{localStorage.setItem(b,"true")}catch(h){v.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+h.message)}}}kg.K0h="ChromeExtensionBarDismiss";Object(u.a)(kg,"WildFireUtilities",null,[]);var eh=d(356);class zg{constructor(){this.tJe=new eh.a;this.rJe=new eh.a;this.qJe=new eh.a;this.bdl(this.tJe);this.adl(this.rJe);this.$cl(this.qJe);this.$Te=new eh.a;
this.ZTe=new eh.a;this.YTe=new eh.a;this.Efl(this.$Te);this.Dfl(this.ZTe);this.Cfl(this.YTe);this.SLe=new eh.a;this.mdl(this.SLe);this.BJb(this.SLe);this.BJb(this.qJe);this.BJb(this.rJe);this.BJb(this.tJe);this.BJb(this.ZTe);this.BJb(this.$Te);this.BJb(this.YTe)}l8d(b,h){switch(b){case 1:return this.dQm(h);case 2:return this.mfm(h)}return kg.sye?this.SLe:null}bdl(b){b.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}adl(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}$cl(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}Efl(b){b.add("Headline",
CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);b.add("OverlayBig","Get the Word app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1",
"Discover Word");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}mdl(b){b.add("Headline","Get the Office Online extension for Chrome");b.add("UseAppButton","Get the extension");b.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}Dfl(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);
b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);b.add("OverlayBig","Get the PowerPoint app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1","Discover PowerPoint");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}Cfl(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",
CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}BJb(b){b.add("Corporation","Microsoft Corporation")}dQm(b){switch(b){case 3:return this.$Te;case 2:return this.ZTe;case 1:return this.YTe}return null}mfm(b){switch(b){case 3:return this.tJe;case 2:return this.rJe;case 1:return this.qJe}return null}static get instance(){zg._instance||
(zg._instance=new zg);return zg._instance}}zg._instance=null;Object(u.a)(zg,"WildFireStringFactory",null,[]);class Gi{constructor(b,h,r,A,M=null,aa=null){this.I1e=null;this._id=b;this.m3e=h;this.xvk=M;this.JIc=A;this.jOc=aa;this.tgb=null;this.GQc=r;this.zPc=zg.instance.l8d(h,b)}JBl(){this.tgb=new jg.a(this.title,this.message,null);this.tgb.addButton(this.Tfl,Object(E.a)(this,this.tSn,"onButtonOneClick"),"");this.GQc&&this.tgb.gNh(this.Zfl,Object(E.a)(this,this.ySn,"onButtonTwoClick"));this.tgb.Pja=
Object(E.a)(this,this.vSl,"dismissBar");this.tgb.image=3;this.tgb.id=16;this.tgb.closeable=!0}get title(){return this.zPc.K("Headline")}get message(){return this.zPc.K("CallToAction")}get Tfl(){return this.GQc?this.zPc.K("InstallButton"):this.zPc.K("UseAppButton")}get Zfl(){return this.GQc?this.zPc.K("OpenAppButton"):""}tSn(){this.GQc?this.d9m():this.Xyp()}ySn(){this.GQc&&this.W1n()}get ZWh(){return this.tgb}get oua(){this.I1e||(this.I1e=this.xvk());return this.I1e}d9m(){v.ULS.sendTraceTag(17932829,
306,50,"Install App Button of BusinessBar Clicked");this.JIc&&this.jOc&&this.jOc();kg.hyj(this._id,this.m3e)}W1n(){this.oua&&(v.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.JIc&&this.jOc&&this.jOc(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(kg.KQh(this._id),this.oua,0,!1))}Xyp(){kg.sye?this.Pfl():(v.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),kg.Szg("BizBarClicked"),1!==this.m3e&&2!==this.m3e||kg.yql(this.oua,this.JIc,this._id,this.jOc))}Pfl(){this.JIc?
v.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):v.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");Le.a.Epb(y.AFrameworkApplication.J.appSettings.WildFireChromeExtensionUrl.toString())}wSl(){this.JIc?v.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):v.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");kg.Szg(kg.K0h)}vSl(){kg.sye?this.wSl():(kg.Szg(kg.tsi(this._id)),v.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static wtf(){const b=y.AFrameworkApplication.ua.Ib;
new Gi(b.Uk,kg.W8d(),8<Y.a.Z9a,1===b.rma,()=>b.zW,b.vvg());v.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}}Object(u.a)(Gi,"WildFireBusinessBar",null,[]);class jj{get name(){return"Common.App.WildFire"}kdf(b){const h=y.AFrameworkApplication.ua.Ib;let r=!1;b&&(b.JBl(),b.ZWh&&(r=h.Jya(b.ZWh,!0)));return r}PBl(){var b=y.AFrameworkApplication.ua.Ib;b=new Gi(b.Uk,kg.W8d(),!1,1===b.rma);this.kdf(b)&&v.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}wtf(b,h,r,A,M,aa){b=new Gi(b,
r,A,h,M,aa);this.kdf(b)&&v.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}fJl(){const b=y.AFrameworkApplication.ua.Ib;var h=y.AFrameworkApplication.J;const r=b.Uk,A=1===b.rma;if(h.$(kg.UOm(r))){var M=kg.W8d(),aa=8<Y.a.Z9a;if(2!==r||2!==M||!A){h=h.$(kg.VOm(r));var oa=b.vvg(),Ja=()=>b.zW;h&&!kg.vYi(kg.tsi(r))&&this.wtf(r,A,M,aa,Ja,oa)}}}init(){var b=y.AFrameworkApplication.J;const h=b.$("WildFireChromeExtensionEnabled");b=b.$("WildFireChromeExtensionBar")&&h;kg.sye&&b&&!kg.vYi(kg.K0h)?this.PBl():
(document.body&&kg.E1o&&this.fJl(),y.AFrameworkApplication.va.qa(Ka.a.o2f,we.a.frame,Object(E.a)(this,this.o2f,"launchWildFireBusinessBar")))}o2f(b,h,r,A,M){if(1===r)return 32;if(!M)return 8;this.wtf(M.app,M.mode,M.platform,M.useTwoButton,null,null);return 32}dispose(){}uc(){}static main(){K.a.instance.Lc(new jj)}}Object(u.a)(jj,"PackageManager",null,[0,1]);class Dg{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=
this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(u.a)(Dg,"BrowserInfo",null,[]);class Jf{constructor(){this.Version=
this.Name=null}}Object(u.a)(Jf,"PluginInfo",null,[]);class xg{static G7(){if(y.AFrameworkApplication.J.$("LogBrowserInfoIsEnabled")){var b=xg.Nbm();try{const h=JSON.stringify(b);v.ULS.sendTraceTag(6903563,102,50,h)}catch(h){v.ULS.sendTraceTag(6903564,102,15,h.message)}}else v.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static iDm(){const b=window.navigator.plugins;if(!b||!b.length)return null;const h=[];for(let r=0;r<b.length;r++){const A=b[r].name,M=b[r].version;
Array.add(h,Object.assign(new Jf,{Name:A,Version:M}))}return h}static Nbm(){const b=new Dg,h=new Sys.StringBuilder;xg.PJ(r=>{b.DocElemClientHeight=r},()=>document.documentElement.clientHeight,h);xg.PJ(r=>{b.DocElemClientWidth=r},()=>document.documentElement.clientWidth,h);xg.PJ(r=>{b.DocElemOffsetHeight=r},()=>document.documentElement.offsetHeight,h);xg.PJ(r=>{b.DocElemOffsetWidth=r},()=>document.documentElement.offsetWidth,h);xg.PJ(r=>{b.ScreenAvailHeight=r},()=>window.screen.availHeight,h);xg.PJ(r=>
{b.ScreenAvailWidth=r},()=>window.screen.availWidth,h);xg.PJ(r=>{b.ScreenWidth=r},()=>window.screen.width,h);xg.PJ(r=>{b.ScreenHeight=r},()=>window.screen.height,h);xg.PJ(r=>{b.ScreenLogicalXdpi=r},()=>window.screen.logicalXDPI,h);xg.PJ(r=>{b.ScreenLogicalYdpi=r},()=>window.screen.logicalYDPI,h);xg.PJ(r=>{b.ScreenDeviceXdpi=r},()=>window.screen.deviceXDPI,h);xg.PJ(r=>{b.ScreenDeviceYdpi=r},()=>window.screen.deviceYDPI,h);xg.PJ(r=>{b.WinInnerHeight=r},()=>window.self.innerHeight,h);xg.PJ(r=>{b.WinInnerWidth=
r},()=>window.self.innerWidth,h);xg.PJ(r=>{b.WinOuterHeight=r},()=>window.self.outerHeight,h);xg.PJ(r=>{b.WinOuterWidth=r},()=>window.self.outerWidth,h);xg.PJ(r=>{b.WinOrientation=r},()=>window.self.orientation,h);xg.PJ(r=>{b.WinDevicePixelRatio=r},()=>window.self.devicePixelRatio,h);xg.PJ(r=>{b.SupportsTouch=r},()=>Y.a.dqd,h);xg.PJ(r=>{b.NavAppName=r},()=>window.navigator.appName,h);xg.PJ(r=>{b.NavAppVersion=r},()=>window.navigator.appVersion,h);xg.PJ(r=>{b.NavLanguage=r},()=>window.navigator.browserLanguage||
window.navigator.language,h);xg.PJ(r=>{b.NavUserAgent=r},()=>window.navigator.userAgent,h);xg.PJ(r=>{b.NavPlatform=r},()=>window.navigator.platform,h);xg.PJ(r=>{b.NavPlugins=r},xg.iDm,h);xg.PJ(r=>{b.CalculatedDevicePixelRatio=r},()=>xg.devicePixelRatio,h);b.Error=h.toString();return b}static get devicePixelRatio(){const b=window.devicePixelRatio;return isNaN(b)?window.screen.deviceXDPI/window.screen.logicalXDPI:b}static PJ(b,h,r){try{const A=h();b(A)}catch(A){r.isEmpty()||r.append(" | "),r.append(A.message||
"null")}}}Object(u.a)(xg,"BrowserInfoLogger",null,[]);class Vi{get name(){return"Common.App.BrowserInfoLogger"}uc(){}init(){xg.G7()}dispose(){}static main(){K.a.instance.Lc(new Vi)}}Object(u.a)(Vi,"BrowserInfoLoggerPackage",null,[0,1]);class Lf{constructor(){this.sa=new Td.a}RJb(b){this.sa.addHandler("OnEditHappenedEvent",b)}lte(b){this.sa.removeHandler("OnEditHappenedEvent",b)}djo(){this.sa.raiseEvent("OnEditHappenedEvent")}}Object(u.a)(Lf,"EditNotificationEventSource",null,[]);var ac=d(43),xc=d(92);
class gd{constructor(b,h,r,A,M,aa,oa=0){this.WPe=!1;this.VPe=this.PFb=null;this.DIh=!1;this.tmd=()=>{this.WPe&&(this.wib.CWR(()=>this.wib.result.sendMessage(C.a.LWl,null)),v.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.WPe=!1)};this.eBo=()=>{try{this.HBd&&(ac.c(Ka.a.tyf),this.HBd=!1)}catch(Ja){this.HBd=!1,v.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+Ja)}};this.Gb=h;this.WGd=b;this.wib=
r;this.lia=A;this.BIh=M;this.ask=aa;this.Azd=0;this.HBd=!1;try{0<oa&&(this.Azd=oa,3E5>this.Azd&&(this.Azd=3E5),this.Gb&&!this.VPe&&(this.VPe=new xc.a(3,2,this.Azd,this.eBo),this.Gb.Zb(this.VPe)))}catch(Ja){v.ULS.sendTraceTag(51246176,383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+Ja)}}get OEe(){return this.DIh}editHappened(){this.OEe?this.HBd=!0:(this.DIh=!0,Ba.Health.instance.addQosPillar("Save"),Ba.Health.instance.addQosPillar("ContentCreation"),
ac.c(Ka.a.tyf));this.WPe=!0;this.BIh&&this.BIh.XKh();this.lia&&this.lia.djo();y.AFrameworkApplication.gh&&y.AFrameworkApplication.gh.IFn();this.ask&&!this.PFb&&(this.tmd(null),this.PFb=new xc.a(3,2,this.WGd,this.tmd,113),this.Gb.Zb(this.PFb))}}Object(u.a)(gd,"EditNotificationManager",null,[806]);class Hd{constructor(b,h,r,A,M){this.WSe=this.PFb=null;this.Y6b=this.HIe=!1;this.dzj=()=>{const aa=document.getElementById(y.AFrameworkApplication.wSc);!this.Y6b&&this.gl&&aa&&(this.gl.nb(Jd.a.y3,aa,this.v8f,
null),this.Y6b=!0);this.a1e(()=>{this.dispose()})};this.v8f=()=>{this.Y6b&&(this.gl.xc(Jd.a.y3,document.getElementById(y.AFrameworkApplication.wSc),this.v8f),this.Y6b=!1);this.XKh();return!1};this.tmd=()=>{this.HIe&&(this.wib.CWR(()=>this.wib.result.sendMessage(C.a.uzp,null)),v.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.HIe=!1)};this.Gb=h;this.WGd=b;this.wib=r;this.gl=A;this.a1e=M;this.dzj(null)}XKh(){this.HIe=!0;this.WSe||(this.WSe=
new xc.a(3,2,this.WGd,this.dzj,112),this.Gb.Zb(this.WSe));this.PFb||(this.tmd(null),this.PFb=new xc.a(3,2,this.WGd,this.tmd,111),this.Gb.Zb(this.PFb))}dispose(){this.Y6b&&(this.gl.xc(Jd.a.y3,document.getElementById(y.AFrameworkApplication.wSc),this.v8f),this.Y6b=!1)}}Object(u.a)(Hd,"UserActivityHostNotificationManager",null,[805,10]);var ie=d(203),Je=d(114),Xe=d(534);class Tf{constructor(){this.W=null;this.fz=()=>{Tf.MWl&&0<Tf.wyf&&(this.W.register(Lf,798).ha(),this.W.register(Hd,"Common.App.HostNotification.UserActivityHostNotificationManager").as(799).ha().Sd(()=>
new Hd(6E4,Je.a.instance,Xe.a.Yp(this.W.Ra(7)),ie.a.instance,y.AFrameworkApplication.XI)),this.W.register(gd,"Common.App.HostNotification.EditNotificationManager").as(72).ha().Sd(()=>new gd(Tf.wyf,Je.a.instance,Xe.a.Yp(this.W.Ra(7)),this.W.resolve(798),this.W.Oa(799),Tf.NWl,Tf.FWl)),this.W.resolve(72),v.ULS.shipAssertTag(38086291,209,0<Tf.wyf,"EditNotification Interval is less than or equal to 0."))}}get name(){return"Common.App.EditNotification"}init(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.Uo(this.fz)}uc(b){this.W=
b}dispose(){}static get wyf(){return y.AFrameworkApplication.J?parseInt(y.AFrameworkApplication.J.appSettings.EditNotificationTimeIntervalMs||"300000"):3E5}static get FWl(){return y.AFrameworkApplication.J?parseInt(y.AFrameworkApplication.J.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get MWl(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("EditNotificationIsEnabled")}static get NWl(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("EditNotificationPostMessageIsEnabled")}static main(){K.a.instance.Lc(new Tf)}}
Object(u.a)(Tf,"CommonHostNotificationPackage",null,[0,1]);class Zh{constructor(b,h,r){this.ZHb=null;this.Cye=()=>{this.ZHb=null;v.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.ahh.display()};this.T3o=(A,M,aa,oa,Ja)=>A!==Ka.a.Cye?2:1===aa?32:2===aa&&Ja?(v.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",Ja),Ja?this.Lwb():(this.ZHb?(v.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),
this.Gb.uf(this.ZHb)):(v.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.ahh.remove(null)),this.ZHb=null),32):8;this.Gb=b;this.ga=h;this.ahh=r.create()}Lwb(){this.ZHb?v.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(v.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.ZHb=new xc.a(2,1,3E4,this.Cye,67),this.Gb.Zb(this.ZHb))}xZa(){this.ga.qa(Ka.a.Cye,we.a.frame,this.T3o)}}Object(u.a)(Zh,"FloatPaneActor",null,
[809]);var se=d(98),Gg=d(97),mf=d(36),Ne=d(71);class Fb{constructor(b,h,r,A,M){this.EZe=this.JHc=this.VJd=this.f4a=this.Ria=this.m1a=this.KKe=this.Eda=this.uMc=this.aKc=this.bKc=this.FRe=null;this.XWn=()=>{const aa=this.Ga.ic("O365AdPaneShowingDuration",60);this.h8h();this.Eda.style.display="block";this.Eda.style.height=this.Ria.height+"px";this.JHc=new xc.a(2,1,1E3*aa,Object(E.a)(this,this.hide,"hide"),67);this.Gb.Zb(this.JHc);this.KAj()};this.WWn=()=>{v.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");
this.KAj();this.Ria=null};this.zlj=()=>{v.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1};this.onClose=()=>{this.JHc&&this.Gb.uf(this.JHc);this.hide();return!0};this.Gb=h;this.Ga=b;this.Dg=r;this.W=M;this.cFa=A}h8h(){this.Eda=document.createElement("div");this.Eda.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.Eda.style.width=this.Ria.width+"px";(this.EZe=this.Gzm(this.cFa))?(this.f4a=document.createElement("a"),
this.f4a.setAttribute(Ne.a.Ph,Ne.a.wA),this.Dg.nb(Jd.a.click,this.f4a,this.zlj),this.f4a.href=this.EZe,this.f4a.target="_blank",this.f4a.appendChild(this.Ria),this.Eda.appendChild(this.f4a)):this.Eda.appendChild(this.Ria);this.m1a=document.createElement("a");this.m1a.setAttribute(Ne.a.Ph,Ne.a.K$);this.m1a.className="StandardButton WACFloatPaneCloseButton";this.m1a.title=CommonUIStrings.l_Close;this.m1a.tabIndex=-1;this.KKe=Gg.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",
!0,null);this.KKe.setAttribute(Ne.a.Ph,Ne.a.wA);this.m1a.appendChild(this.KKe);this.Dg.nb(Jd.a.click,this.m1a,this.onClose);this.Eda.appendChild(this.m1a);this.uMc.appendChild(this.Eda)}otm(b){const h=this.Ga.$("O365PromotionHasStarted");switch(b){case 2:return se.a.yea(String.format("adppt{0}.png",h?"sale":""));case 1:return se.a.yea(String.format("adxls{0}.png",h?"sale":""));case 3:return se.a.yea(String.format("addoc{0}.png",h?"sale":""))}return null}Gzm(b){const h=this.Ga.ib("O365AdPaneRedirectedURL");
switch(b){case 1:return String.format(h,"Excel");case 2:return String.format(h,"PowerPoint");case 3:return String.format(h,"Word")}return null}hide(b=null){this.JHc=null;this.Eda&&!this.VJd&&(b?v.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):v.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.Eda.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.Eda.style.height="0px",this.VJd=new xc.a(2,1,1E3,Object(E.a)(this,
this.remove,"remove"),67),this.Gb.Zb(this.VJd))}remove(){this.Eda&&this.uMc&&(this.f4a&&this.Dg.xc(Jd.a.click,this.f4a,this.zlj),this.Dg.xc(Jd.a.click,this.m1a,this.onClose),this.uMc.removeChild(this.Eda),this.Eda=null);this.VJd=null}display(){if(this.FRe=this.W.Oa(800))if(this.uMc=this.FRe.container){var b=this.otm(this.cFa);b?(v.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",b),this.Ria=document.createElement("img"),this.Ria.className="WACFloatPaneImage",this.bKc=this.XWn,
mf.a.addHandler(this.Ria,Jd.a.load,this.bKc),this.aKc=this.WWn,mf.a.addHandler(this.Ria,Jd.a.error,this.aKc),this.Ria.src=b):v.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else v.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else v.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}KAj(){this.bKc&&this.Ria&&mf.a.removeHandler(this.Ria,Jd.a.load,
this.bKc);this.bKc=null;this.aKc&&this.Ria&&mf.a.removeHandler(this.Ria,Jd.a.error,this.aKc);this.aKc=null}dispose(){this.hide()}}Object(u.a)(Fb,"FloatPane",null,[824]);class Vb{constructor(b,h,r,A,M){this.Gb=h;this.Ga=b;this.Dg=r;this.W=M;this.cFa=A}create(){return new Fb(this.Ga,this.Gb,this.Dg,this.cFa,this.W)}}Object(u.a)(Vb,"FloatPaneFactory",null,[807]);var Qc=d(292);class yd{constructor(){this.W=null}get name(){return"Common.App.FloatPane"}get NWi(){return y.AFrameworkApplication.J.$("O365AdvertisementIsEnabled")&&
y.AFrameworkApplication.J.$("IsShowAdvertisementPaneEnabled")}init(){this.NWi&&(v.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.W.resolve(801).Lwb(),v.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.W.resolve(801).xZa())}uc(b){this.W=b;this.NWi&&(this.W.register(Vb,"Common.App.FloatPane.FloatPaneFactory").as(802).Sd(()=>new Vb(y.AFrameworkApplication.J,y.AFrameworkApplication.oc,Qc.a.instance,y.AFrameworkApplication.ua.Ib.Uk,this.W)).ha(),
this.W.register(Zh,"Common.App.FloatPane.FloatPaneActor").as(801).Sd(()=>new Zh(y.AFrameworkApplication.oc,y.AFrameworkApplication.va,this.W.resolve(802))).ha())}dispose(){}static main(){K.a.instance.Lc(new yd)}}Object(u.a)(yd,"FloatPanePackage",null,[0,1]);var Ce=d(1617);class sf{}Object(u.a)(sf,"LokiTokenResult",null,[]);class lh{constructor(b){this.cHd=b}qKf(){const b=this.Awm();return b?lh.hab?new Promise((h,r)=>{this.cHd.continueWith(()=>{this.cHd.kp||this.cHd.fj?r(Error.create("Error downloading auth library")):
this.cHd.result.pV("Loki",b).then(A=>{A=y.AFrameworkApplication.J.$("ForceLokiFallbackToACLPTokenIsEnabled")?this.Dwm():A.IsSuccess&&A.Token?Object.assign(new sf,{isSuccess:!0,token:A.Token,errorMessage:null}):Object.assign(new sf,{isSuccess:!1,token:null,errorMessage:JSON.stringify(A)});h(A);return A})})}):Promise.resolve(Object.assign(new sf,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new sf,{isSuccess:!1,
token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",Ce.a.isi())}))}Dwm(){const b=y.AFrameworkApplication.J.ib("LokiUserDataSignature")||"";return Object.assign(new sf,{isSuccess:!0,token:b,errorMessage:null})}Awm(){let b=null;const h=Ce.a.e4d();2===h?b=y.AFrameworkApplication.J.ib("LokiAADAppId"):1===h&&(b=y.AFrameworkApplication.J.ib("LokiMSAAppId"));return b}static get hab(){return y.AFrameworkApplication.J.$("IsO365CommercialHost")||y.AFrameworkApplication.J.$("IsO365ConsumerHost")}}
Object(u.a)(lh,"LokiTokenManager",null,[752]);class Ef{get name(){return"Common.App.LivePersonaUtils"}init(){Za.a.instance.resolve(152)}dispose(){}uc(b){b.register(lh,"Common.App.LivePersonaUtils.LokiTokenManager").as(152).ha().Sd(()=>new lh(Xe.a.Yp(b.Ra(722))))}static main(){K.a.instance.Lc(new Ef)}}Object(u.a)(Ef,"LivePersonaUtilsPackage",null,[0,1]);class ng{constructor(b){this.mJe=b}RVi(b){if(!this.mJe)return!0;b=$a.a.mJf(b);if(!b)return!1;b=b.toLowerCase();for(let h=0;h<this.mJe.length;h++)if(b.endsWith(this.mJe[h]))return!0;
return!1}}Object(u.a)(ng,"DomainAllowListManager",null,[]);class Dh{constructor(b,h){this.vuf=null;this.H$e=b;this.url=h}get hMg(){return $a.a.$ba(this.url)}get mt(){return this.H$e}THg(){const b={},h=this.mt;b.a=this.hMg;b.b=this.round(h.navigationStart);b.c=this.round(h.unloadEventStart);b.d=this.round(h.unloadEventEnd);b.e=this.round(h.redirectStart);b.f=this.round(h.redirectEnd);b.g=this.round(h.fetchStart);b.h=this.round(h.domainLookupStart);b.i=this.round(h.domainLookupEnd);b.j=this.round(h.connectStart);
b.k=this.round(h.connectEnd);b.l=void 0!==h.secureConnectionStart&&null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.m=this.round(h.requestStart);b.n=this.round(h.responseStart);b.o=this.round(h.responseEnd);b.q=this.round(h.domInteractive);b.r=this.round(h.domContentLoadedEventStart);b.s=this.round(h.domContentLoadedEventEnd);b.t=this.round(h.domComplete);b.u=this.round(h.loadEventStart);b.v=this.round(h.loadEventEnd);b.w=this.vuf;return b}round(b){return Math.round(1E3*b)/1E3}}
Object(u.a)(Dh,"PerformanceTimingEntry",null,[]);const Af=(b,h)=>{var r,A;const M={};let aa=null;switch(b){case 0:aa="ResourceTiming";b=h.a;null!=b&&(M.Url=b);b=h.b;null!=b&&(M.InitiatorType=b);b=null==h.c?null:h.c.toString();null!=b&&(M.RedirectStart=b);b=null==h.d?null:h.d.toString();null!=b&&(M.RedirectEnd=b);b=null==h.e?null:h.e.toString();null!=b&&(M.FetchStart=b);b=null==h.f?null:h.f.toString();null!=b&&(M.DomainLookupStart=b);b=null==h.g?null:h.g.toString();null!=b&&(M.DomainLookupEnd=b);b=
null==h.h?null:h.h.toString();null!=b&&(M.ConnectStart=b);b=null==h.i?null:h.i.toString();null!=b&&(M.ConnectEnd=b);b=null==h.j?null:h.j.toString();null!=b&&(M.SecureConnectionStart=b);b=null==h.k?null:h.k.toString();null!=b&&(M.RequestStart=b);b=null==h.l?null:h.l.toString();null!=b&&(M.ResponseStart=b);b=null==h.m?null:h.m.toString();null!=b&&(M.ResponseEnd=b);b=h.n;null!=b&&(M.CustomText=b);b=null==h.o?null:h.o.toString();null!=b&&(M.DecodedBodySize=b);b=null==h.p?null:h.p.toString();null!=b&&
(M.EncodedBodySize=b);b=null==h.q?null:h.q.toString();null!=b&&(M.TransferSize=b);h=null!==(A=null===(r=h.r)||void 0===r?void 0:r.toString())&&void 0!==A?A:null;null!=h&&(M.responseStatus=h);break;case 1:aa="PerformanceTiming",r=h.a,null!=r&&(M.Url=r),r=null==h.b?null:h.b.toString(),null!=r&&(M.NavigationStart=r),r=null==h.c?null:h.c.toString(),null!=r&&(M.UnloadEventStart=r),r=null==h.d?null:h.d.toString(),null!=r&&(M.UnloadEventEnd=r),r=null==h.e?null:h.e.toString(),null!=r&&(M.RedirectStart=r),
r=null==h.f?null:h.f.toString(),null!=r&&(M.RedirectEnd=r),r=null==h.g?null:h.g.toString(),null!=r&&(M.FetchStart=r),r=null==h.h?null:h.h.toString(),null!=r&&(M.DomainLookupStart=r),r=null==h.i?null:h.i.toString(),null!=r&&(M.DomainLookupEnd=r),r=null==h.j?null:h.j.toString(),null!=r&&(M.ConnectStart=r),r=null==h.k?null:h.k.toString(),null!=r&&(M.ConnectEnd=r),r=null==h.l?null:h.l.toString(),null!=r&&(M.SecureConnectionStart=r),r=null==h.m?null:h.m.toString(),null!=r&&(M.RequestStart=r),r=null==h.n?
null:h.n.toString(),null!=r&&(M.ResponseStart=r),r=null==h.o?null:h.o.toString(),null!=r&&(M.ResponseEnd=r),r=null==h.p?null:h.p.toString(),null!=r&&(M.DomLoading=r),r=null==h.q?null:h.q.toString(),null!=r&&(M.DomInteractive=r),r=null==h.r?null:h.r.toString(),null!=r&&(M.DomContentLoadedEventStart=r),r=null==h.s?null:h.s.toString(),null!=r&&(M.DomContentLoadedEventEnd=r),r=null==h.t?null:h.t.toString(),null!=r&&(M.DomComplete=r),r=null==h.u?null:h.u.toString(),null!=r&&(M.LoadEventStart=r),r=null==
h.v?null:h.v.toString(),null!=r&&(M.LoadEventEnd=r),h=h.w,null!=h&&(M.CustomText=h)}M.Table=aa;return Sys.Serialization.JavaScriptSerializer.serialize(M)};var Jh=d(39),vg=d(166),Hk=d(153);class tg{constructor(b,h=null,r=null){this.ng=b;this.gMg=this;this.Duk=h||(()=>window.location.href);this.CPe=new ng(r)}run(){if(tg.LKb(window.performance))try{const M=this.Duk();if(tg.MOk.exec(M)&&this.CPe.RVi(M)){var b=new Dh(window.performance.timing,M);Hk.a.instance.Plo(b.mt.fetchStart);Hk.a.instance.Qlo(b.mt.navigationStart);
Hk.a.instance.m0(Jh.a.Vam,"connectStart","requestStart");Hk.a.instance.m0(Jh.a.dbm,"requestStart","responseStart");Hk.a.instance.m0(Jh.a.gbm,"responseStart","responseEnd");this.gMg.Yab(1,b.THg());this.ng.qf(Jh.a.YJa,b.mt.fetchStart);this.ng.qf(Jh.a.abm,b.mt.domainLookupStart);this.ng.qf(Jh.a.$am,b.mt.domainLookupEnd);this.ng.qf(Jh.a.Xam,b.mt.connectStart);this.ng.qf(Jh.a.ibm,b.mt.secureConnectionStart);this.ng.qf(Jh.a.Wam,b.mt.connectEnd);this.ng.qf(Jh.a.ebm,b.mt.requestStart);this.ng.qf(Jh.a.uic,
b.mt.responseStart);this.ng.qf(Jh.a.bbm,b.mt.responseEnd-b.mt.responseStart);this.ng.qf(Jh.a.fbm,b.mt.responseStart-b.mt.requestStart);var h=0,r=0,A=0;({transferSize:h,qzf:r,Suf:A}=this.Rmp(M)).returnValue&&(this.ng.qf(Jh.a.kbm,h),this.ng.qf(Jh.a.Yam,A),this.ng.qf(Jh.a.cbm,r));this.ng.qf(Jh.a.H0c,b.mt.navigationStart)}}catch(M){v.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",M)}}Rmp(b){let h,r,A;A=r=h=-1;if(void 0===window.performance.getEntriesByName||null===
window.performance.getEntriesByName)return{returnValue:!1,transferSize:h,qzf:r,Suf:A};b=window.performance.getEntriesByName(b,"navigation");if(void 0===b||null===b||1!==b.length)return{returnValue:!1,transferSize:h,qzf:r,Suf:A};b=b[0];var M=b.transferSize;void 0!==h&&null!==h&&(h=M);M=b.decodedBodySize;void 0!==M&&null!==M&&(A=M);b=b.encodedBodySize;void 0!==b&&null!==b&&(r=b);return{returnValue:!0,transferSize:h,qzf:r,Suf:A}}Yab(b,h){v.ULS.sendTraceTag(4551815,306,50,Af(b,h))}static get instance(){return tg._instance||
(tg._instance=new tg(vg.a.instance,null,y.AFrameworkApplication.J.$("PerfTimingLoggerFilterDomainsIsEnabled")?y.AFrameworkApplication.J.cD("ResourceLoggerDomainAllowList"):null))}static LKb(b){return!(void 0===b||null===b)&&!(void 0===b.timing||null===b.timing)}}tg._instance=null;tg.MOk=RegExp("^https?://.*","i");Object(u.a)(tg,"PerformanceTimingLogger",null,[747]);class wh{constructor(b,h){this.vuf=null;this.H$e=b;this.behavior=h;this.url=this.mt.name}get hMg(){return 2===this.behavior?this.url:
$a.a.$ba(this.url)}get mt(){return this.H$e}THg(){const b={},h=this.mt;b.a=this.hMg;b.b=h.initiatorType;b.c=this.round(h.redirectStart);b.d=this.round(h.redirectEnd);b.e=this.round(h.fetchStart);b.f=this.round(h.domainLookupStart);b.g=this.round(h.domainLookupEnd);b.h=this.round(h.connectStart);b.i=this.round(h.connectEnd);b.j=void 0!==h.secureConnectionStart&&null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.k=this.round(h.requestStart);b.l=this.round(h.responseStart);b.m=this.round(h.responseEnd);
b.o=this.round(wh.t9a(h,"decodedBodySize"));b.p=this.round(wh.t9a(h,"encodedBodySize"));b.q=this.round(wh.t9a(h,"transferSize"));b.n=this.vuf;b.r=wh.t9a(h,"responseStatus")||0;return b}round(b){return Math.round(1E3*b)/1E3}static t9a(b,h){return b[h]}}Object(u.a)(wh,"ResourceTimingEntry",null,[804]);class Hg{constructor(b,h=null,r=100){this.V7g=b;this.DMd=h;this.ogb={};this.Jnk=r;this.q7g=y.AFrameworkApplication&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableAdvancedNetworkLogging",
!1)}plp(b){var h=b.name.toLowerCase();const r=$a.a.$Pb(h);this.eFj(r,h)&&(r in this.ogb?v.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",r):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.L1i(b),h.encodedsize=wh.t9a(b,"encodedBodySize"),h.decodedsize=wh.t9a(b,"decodedBodySize"),this.ogb[r]=h))}qlp(b){var h=b.name.toLowerCase();const r=$a.a.$Pb(h);this.UDo(r,h)&&(r in this.ogb?v.ULS.sendTraceTag(508925201,306,50,"AppStaticResourceManager: file downloaded multiple times for filename: {0}",
r):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.L1i(b),h.encodedsize=wh.t9a(b,"encodedBodySize"),h.decodedsize=wh.t9a(b,"decodedBodySize"),h.it=b.initiatorType,h.ress=b.responseStart,h.cs=b.connectStart,h.ce=b.connectEnd,h.dls=b.domainLookupStart,h.dle=b.domainLookupEnd,h.rs=b.redirectStart,h.re=b.redirectEnd,h.reqs=b.requestStart,h.scs=b.secureConnectionStart,this.ogb[r]=h))}eFj(b,h){if(this.V7g)return Array.contains(this.V7g,b);if(this.DMd)for(b=$a.a.kU(h),h=0;h<this.DMd.length;h++)if(this.DMd[h]&&
b.endsWith(this.DMd[h]))return!0;return!1}UDo(b,h){return this.eFj(b,h)?b.endsWith(".js")||b.endsWith(".css"):!1}L1i(b){try{const h=wh.t9a(b,"transferSize");if(void 0!==h&&null!==h)return!h;v.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return b.responseEnd-b.fetchStart<this.Jnk}catch(h){v.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",h.message)}return!1}moo(){if(qb.a.Tf(this.ogb))v.ULS.sendTraceTag(575931855,
306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var b=y.AFrameworkApplication.flightId?y.AFrameworkApplication.flightId.split(";"):[],h=Object.assign(new bb.a,{extendedProperties:zb.a.KG()});h.extendedProperties.set("Flights",H.c(b));this.k9i(h,this.ogb,Ba.Health.instance)}}wFf(b){let h=0,r=0,A=0,M=0,aa=0;const oa=this.ogb;for(const Cb in oa){var Ja=Cb,fb=oa[Cb];Ja.endsWith(".js")&&(fb=Object(ya.a)(Object,fb),fb.responseend<b&&(h+=1,r+=fb.decodedsize,M+=fb.encodedsize,
A+=fb.iscached?0:fb.encodedsize,Ja=Ja.toLowerCase(),this.q7g&&(Ja===y.AFrameworkApplication.J.ib("Slice1Name").toLowerCase()?aa|=1:Ja.endsWith(".common.js")||Ja.endsWith(".othercommon.js")?aa|=2:Ja.endsWith("common50.min.js")&&(aa|=4))))}b={};b.filesLoaded=h;b.decodedBytes=r;b.transferredBytes=A;b.encodedBytes=M;this.q7g&&(b.lazyChunksLoaded=aa);return b}k9i(b,h,r){if(h){var A=0,M=0,aa=0,oa=0,Ja=0,fb=0,Cb=0,Gb=0,Sb=0,pc=0,zc=0;for(const Kd in h){var Yc=h[Kd];try{const ke=Object(ya.a)(Object,Yc);if(!ke)continue;
const ge=ke.iscached?Boolean.parse(ke.iscached.toString()):!1,de=ke.fetchstart?this.parseFloat(ke.fetchstart.toString()):0,Sd=(ke.responseend?this.parseFloat(ke.responseend.toString()):0)-de,be=ke.encodedsize?this.parseFloat(ke.encodedsize.toString()):0,Rf=ke.decodedsize?this.parseFloat(ke.decodedsize.toString()):0;A+=Sd;oa+=be;Cb+=Rf;pc++;ge?(aa+=Sd,fb+=be,Sb+=Rf,zc++):(M+=Sd,Ja+=be,Gb+=Rf)}catch(ke){v.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",
ke.message)}}b.extendedProperties.set("StaticResources",H.c(h));b.extendedProperties.set("TotalResourceDownloadLatency",A.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",M.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",aa.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",oa.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Ja.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",
fb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Cb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Gb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",Sb.toString());b.extendedProperties.set("TotalNumberOfResourcesDownloaded",pc.toString());b.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",zc.toString());r.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",
null);r.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",b)}}parseFloat(b){if(!b)return 0;b=parseFloat(b);return isNaN(b)?0:b}}Object(u.a)(Hg,"AppStaticResourceManager",null,[]);class Sf extends Sys.EventArgs{constructor(b){super();this.entries=b}}Object(u.a)(Sf,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class ph{constructor(b,h,r=null,A=null,M=100,aa=!1){this.LXe=!1;this.fp=null;this.IEc=0;this.sa=new Td.a;this.kBb=null;this.A1=!1;this.MGh=0;this.Gb=b;this.Ich=0;this.gMg=this;this.CPe=
new ng(r);this.KM=h;A&&(this.kBb=new Hg(null,A,M));this.Ukk=aa}get dWh(){try{return!(void 0===this.KM||null===this.KM)&&!(void 0===this.KM.getEntriesByType||null===this.KM.getEntriesByType)}catch(b){return v.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",b),!1}}get yLl(){return this.Ich}get isActive(){return this.A1}get KHg(){return this.MGh}VNh(b){this.sa.addHandler(ph.pAf,b)}QBj(b){this.sa.removeHandler(ph.pAf,b)}uc(b,h){const r=
this.KHg!==b;this.MGh=b;this.isActive&&this.Gb&&r&&(this.uf(),this.Zb());this.Ich=h}activate(){!this.isActive&&this.dWh&&(this.Zb(),this.A1=!0)}deactivate(b){this.isActive&&(this.uf(),b&&this.flush(),this.A1=!1)}flush(){if(this.isActive&&this.dWh)try{var b=window.performance.getEntriesByType("resource");0<b.length-this.IEc&&v.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",b.length-this.IEc);const h=!(void 0===window.performance.clearResourceTimings||
null===window.performance.clearResourceTimings);h&&(window.performance.clearResourceTimings(),this.IEc=0);const r=[];for(let A=this.IEc;A<b.length;A++)this.CPe.RVi(b[A].name)&&(this.kBb&&(this.Ukk?this.kBb.qlp(b[A]):this.kBb.plp(b[A])),r.push(new wh(b[A],this.yLl)));h||(this.IEc=b.length);this.sa.raiseEvent(ph.pAf,new Sf(r));for(b=0;b<r.length;b++)0!==r[b].behavior&&2!==r[b].behavior||this.gMg.Yab(0,r[b].THg());0<r.length&&v.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",
r.length)}catch(h){v.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",h)}}Yab(b,h){v.ULS.sendTraceTag(4310804,306,50,Af(b,h))}Klo(){this.kBb.moo()}wFf(b){return this.kBb.wFf(b)}Zb(){this.Gb&&0<this.KHg&&(this.fp=new xc.a(3,2,1E3*this.KHg,()=>{this.flush()},5),this.Gb.Zb(this.fp),this.LXe=!0)}uf(){this.LXe&&(this.Gb.uf(this.fp),this.fp=null,this.LXe=!1)}}ph.pAf="EntriesAvailable";Object(u.a)(ph,"ResourceTimingLogger",null,[735,747]);class Mh{constructor(){this.W=
null}get name(){return"Common.ResourceTiming"}init(){this.W.resolve(74);tg.instance.run()}dispose(){}uc(b){this.W=b;let h=null;if(y.AFrameworkApplication.J.$("ResourceLoggerFilterDomainsIsEnabled"))try{h=y.AFrameworkApplication.J.cD("ResourceLoggerDomainAllowList")}catch(aa){v.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const r=[];r.push($a.a.kU(se.a.m4).toLowerCase());r.push($a.a.kU(se.a.aod).toLowerCase());const A=y.AFrameworkApplication.J.ic("AppStaticResourceMonitorCacheThresholdInMs",
100),M=y.AFrameworkApplication.J.$("PPTAggregateResourceTimingV2Enabled");b.register(735,74).ha().Sd(()=>new ph(y.AFrameworkApplication.oc,window.performance,h,r,A,M))}static main(){K.a.instance.Lc(new Mh)}}Object(u.a)(Mh,"ResourceTimingPackage",null,[0,1]);var Qf=d(267);class Qi{constructor(){this.DIe={}}YRk(b){this.DIe[b.id.toString()]=b}aPn(b){const h=this.DIe;for(const r in h)h[r].notify(b,!1);this.DIe={}}Qgo(b,h){h&&this.YRk(h);return this.Plj(b,h)}$yf(b){this.aPn(b)}Khi(b,h){b.notify(h,!0)}}
Object(u.a)(Qi,"AEventEmitter",null,[598]);var Cl;(function(b){b[b.mbg=0]="notStarted";b[b.waiting=1]="waiting";b[b.iye=2]="shouldRetry";b[b.complete=3]="complete"})(Cl||(Cl={}));Object(u.b)("EventResultState",Cl);class tl{constructor(){this._state=0}get state(){return this._state}set state(b){v.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:Cl[this._state],["NewState"]:Cl[b]},"ResultType",this.tEi());this._state=b}}Object(u.a)(tl,"AEventResult",null,[597]);class pf extends tl{constructor(){super();
this.b9e=this.OMc=null;this.state=0;this.mVe=this.Nlh=!1}get Dga(){return this.OMc}get xeb(){return this.b9e}get l9m(){return this.Nlh}tEi(){return"GetMoreInfo Result"}}Object(u.a)(pf,"GetMoreInfoResult",tl,[808,597]);var Wk=d(1244),Eh=d(1470),Li=d(1028);class Dj{constructor(b,h,r,A,M,aa,oa,Ja){this.usc=(fb,Cb,Gb,Sb,pc)=>{pc&&pc.MenuItemId&&(v.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:pc.SourceControlId,["AppType"]:Li.a[this.jga]}),Le.a.un(pc.MenuItemId.toString(),"_blank",void 0,
"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32};this.Pgg=(fb,Cb,Gb,Sb,pc)=>{if(pc&&pc.MenuItemId){const zc=y.AFrameworkApplication.J.$("WacInTabOpenMRUIsEnabledForUiHost"),Yc=y.AFrameworkApplication.J.$("UiHostSupportsDocRebootFeatures");v.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",zc,Yc);if(zc&&Yc){v.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:pc.SourceControlId,["AppType"]:Li.a[this.jga]});fb=pc.MenuItemId.toString();
const Kd={};Kd[F.a.quc]="1";Kd[F.a.documentUrl]=fb;Kd[F.a.reason]=Eh.a.open;v.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");y.AFrameworkApplication.qN().execute(ke=>{ke.sendMessage(C.a.kNb,Kd)})}else this.usc(fb,Cb,Gb,Sb,pc)}return 32};this.j_d=()=>{this.n9i();return 32};this.ga=b;this.Gf=h;this.hi=r;this.cFa=A;this.Gb=M;this.XE=aa;this.Wvk=oa;this.$Md=Ja}Lpo(){this.brc.qa(Ka.a.usc,we.a.frame,this.usc);this.brc.qa(Ka.a.Pgg,we.a.frame,this.Pgg);y.AFrameworkApplication.oka?
this.n9i():this.brc.fb(Ka.a.j_d,we.a.frame,this.j_d,96)}UXa(b,h,r=""){if(h&&h.bH){const A=Wk.a[h.status];h=h.bH.getTime();const M=this.Tp()-h;v.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:b,["RequestStatus"]:A,["ElapsedMs"]:M,["StartTime"]:h,["Notes"]:r})}else v.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:b})}n9i(){var b=y.AFrameworkApplication.J.$("QPGVCI"),h=$a.a.wL(document.URL,"wdNewAndOpenCt",
b);if(h){h=parseInt(h);var r=$a.a.wL(document.URL,"wdPreviousSession",b);b=$a.a.wL(document.URL,"wdPreviousCorrelation",b);var A=y.AFrameworkApplication.J.$("NAOPLP");if(y.AFrameworkApplication.oka){var M=y.AFrameworkApplication.oka.getTime();!h||h>M?v.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:h,["DocumentLoadedTime"]:M,["SessionId"]:r,["Correlation"]:b}):v.ULS.sendTraceTag(5849683,202,A?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",
{["ClickToLoadTime"]:M-h,["ClickTimestamp"]:h,["SessionId"]:r,["Correlation"]:b})}else v.ULS.sendTraceTag(5849681,202,A?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{["ClickTimestamp"]:h,["SessionId"]:r,["Correlation"]:b})}}get brc(){return this.ga.value}get ldd(){return this.Gf.value}get Uej(){return this.hi.value}get jga(){return this.cFa.value}get $je(){return this.Gb.value}get Tp(){return this.XE}get nYa(){return this.Wvk.value}get L_a(){return this.$Md.value}static get instance(){return Dj._instance||
(Dj._instance=Dj.Qs())}static Qs(){return new Dj(new Qf.a(()=>y.AFrameworkApplication.va),new Qf.a(()=>y.AFrameworkApplication.Ee),new Qf.a(()=>y.AFrameworkApplication.ua),new Qf.a(()=>y.AFrameworkApplication.ua.Ib.Uk),new Qf.a(()=>y.AFrameworkApplication.oc),()=>(new Date).getTime(),new Qf.a(()=>y.AFrameworkApplication.ua.Ib.nYa),new Qf.a(()=>y.AFrameworkApplication.L_a))}}Dj._instance=null;Object(u.a)(Dj,"NewAndOpenCommonHelpers",null,[595]);class xi{constructor(b,h,r){this.xLd=this.fp=null;this.O5e=
0;this.pKk=b;this.Gb=h;this.hdh=r}B1k(){this.O5e=this.dvc+1}Otg(b){this.fp&&(this.Gb.uf(this.fp),this.fp=null);b&&(this.O5e=0)}j$o(b){const h=this.ihp;0<=h?(this.B1k(),this.Otg(!1),this.fp=new xc.a(4,1,h,b,107),this.Gb.Zb(this.fp)):(this.Otg(!0),v.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.hdh}))}get dvc(){return this.O5e}get ihp(){return this.dvc>=this.uKj.length?-1:this.uKj[this.dvc]}get uKj(){if(!this.xLd){const b=(this.pKk.value||"0").split(",");this.xLd=[];for(let h=
0;h<b.length;h++){const r=parseInt(b[h]);isNaN(r)?v.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.hdh,["Entry"]:b[h]}):Array.add(this.xLd,r)}}return this.xLd}}Object(u.a)(xi,"RetryHelper",null,[]);class pg extends Qi{constructor(b,h){super();this.xGa=b;this.RNc=new xi(h,this.Pcd.$je,"GetMoreInfo");this.Rp=new pf}PEn(){this.P6f("Document opened")}gFl(b){return()=>{this.P6f(b,!0)}}Plj(b,h=null){v.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",
{["Trigger"]:b});3===this.Rp.state?(h&&this.Khi(h,this.Rp),v.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:b})):this.P6f(b);return this.Rp}P6f(b,h=!1){this.RNc.Otg(!h);1===this.Rp.state?v.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:b,["RetryIndex"]:this.RNc.dvc}):(v.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:b,["RetryIndex"]:this.RNc.dvc}),this.Rp.state=1,h=String.format("{0}GetMoreInfoHandler.ashx?{1}",
this.Pcd.nYa,y.AFrameworkApplication.um),this.Pcd.ldd.A5a(h,1,null,null,[pg.myh,pg.dFh],5,this.RDl(),this.QDl(b)))}RDl(){return b=>{var h=!1;let r=!1;var A=!1,M;y.AFrameworkApplication.J.$("GetMoreInfoDataFromResponseBody")&&(b.data.De?({ev:M}=H.d(b.data.De)).returnValue?M?(A=!0,this.Rp.b9e=M.StorageServiceDisplayName,this.Rp.OMc=pg.C2i(M.PersonalFileStorageUrl)?M.PersonalFileStorageUrl:"",""===this.Rp.Dga&&"SharePointOnlineConsumer"===y.AFrameworkApplication.J.ib("FileSource")&&(this.Rp.OMc=$a.a.$ba(y.AFrameworkApplication.breadcrumbFolderUrl)),
h=""===this.Rp.Dga&&""!==this.Rp.xeb):v.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):v.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):v.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));A||((M=b.data.vi)?(this.Rp.b9e=
(M[pg.dFh]||"").toString(),h=(M[pg.myh]||"").toString(),this.Rp.OMc=pg.C2i(h)?h:"",""===this.Rp.Dga&&"SharePointOnlineConsumer"===y.AFrameworkApplication.J.ib("FileSource")?(this.Rp.OMc=$a.a.$ba(y.AFrameworkApplication.breadcrumbFolderUrl),h=""===this.Rp.Dga&&""!==this.Rp.xeb):h=""===h&&""!==this.Rp.xeb):(v.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),r=!0));A=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",
this.RNc.dvc,r,h,A);this.Pcd.UXa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",b.data,A);this.KKj(3,h,r)}}QDl(b){return h=>{this.Pcd.UXa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",h.data,"Failure");this.KKj(2);this.RNc.j$o(this.gFl(b))}}KKj(b,h=!1,r=!1){this.Rp.state=b;this.Rp.Nlh=h;this.Rp.mVe=r;this.$yf(this.Rp)}get Pcd(){return this.xGa.value}static get instance(){return pg._instance||(pg._instance=pg.Qs())}static Qs(){return new pg(new Qf.a(()=>Dj.instance),
new Qf.a(()=>y.AFrameworkApplication.Nxm))}static C2i(b){if(!b)return v.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(I.a.vh(b).startsWith("https://"))return!0;v.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}pg.myh="PersonalFileStorageUrl";pg.dFh="StorageServiceDisplayName";pg._instance=null;Object(u.a)(pg,"GetMoreInfoActor",Qi,[]);class Mi{constructor(b,h,r,A,M){this.ixk=6E4;this.aPi="inactive";this.OKh="active";
this.A1=!0;this.Gb=b;this.bvk=h;this.XE=r;this.UNd=A;this.sa=new Td.a;M&&this.b$o();this.dqh=this.Bzi()}nLh(b){this.sa.addHandler(this.OKh,b)}QVk(b){this.sa.addHandler(this.aPi,b)}b$o(){const b=new xc.a(5,2,this.ixk,Object(E.a)(this,this.j1m,"inactiveLoop"),108);this.k1m.Zb(b)}j1m(){const b=this.Bzi(),h=this.Tp()-b;h>this.XBe&&this.A1&&(v.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:h}),this.A1=!1,this.sa.raiseEvent(this.aPi));b-this.dqh>this.XBe&&(this.A1=!0,
this.sa.raiseEvent(this.OKh));this.dqh=b}get k1m(){return this.Gb.value}get Bzi(){return this.bvk}get Tp(){return this.XE}get XBe(){return this.UNd.value}static get instance(){return Mi._instance||(Mi._instance=Mi.Qs())}static Qs(){return new Mi(new Qf.a(()=>Je.a.instance),()=>y.AFrameworkApplication.c2f.getTime(),()=>(new Date).getTime(),new Qf.a(()=>y.AFrameworkApplication.XBe),!0)}}Mi._instance=null;Object(u.a)(Mi,"InactivityManager",null,[]);var Vl=d(1672);class ki extends tl{constructor(){super();
this.WCk=this.cuh=this.buh=null;this.state=this.NGh=0;this.mVe=!1}get V8f(){return this.buh}get Pdj(){return this.cuh}get ohp(){return this.NGh}tEi(){return"MruActor Result"}}Object(u.a)(ki,"MruResult",tl,[596,597]);class Th{constructor(b,h,r){this.task=null;this.Hae=b;this.maxRetries=h;this.Xi=r;this.retryCount=this.x7c=0;this.V3e=this.aad=null}Kln(b,h){return b===ea.a.mic||20===h||18===h||3===h}fnn(b){return 3===b||5===b||6===b||7===b||9===b||10===b||11===b||12===b||13===b||14===b||15===b||16===
b||23===b||26===b||27===b||28===b}get Xpe(){return this.V3e}reset(){this.x7c=this.retryCount=0;this.V3e=this.aad=null;this.task&&(this.Xi.uf(this.task),this.task=null)}U5m(b,h,r,A){this.V3e=String.format("{0}_{1}",r,A);if(this.retryCount>=this.maxRetries)return v.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.Kln(r,A))return v.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.fnn(A)&&1<=this.x7c)return this.aad=r,!1;h=Math.max(h,this.Hae*
Math.pow(2,this.x7c));if(26===A)h=Math.max(h,3E4);else if(27===A||28===A)h=Math.max(h,6E4);9===A||412===r&&(null==this.aad||412!==this.aad)?h=500:this.x7c+=1;this.aad=r;this.retryCount+=1;this.task&&this.Xi.uf(this.task);v.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",h);this.task=new xc.a(2,1,h,b,107);this.Xi.Zb(this.task);return!0}}Object(u.a)(Th,"RetryManager",null,[]);var hh=d(151);class Fe{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=
this.documentUrl=null}}Object(u.a)(Fe,"WriteOptions",null,[]);var tj=d(750);class Ni extends Qi{constructor(b,h,r,A,M,aa,oa){super();this.mHp=Ja=>{this.TKi(Ja.data)};this.lJl=Ja=>{if(Ja.data.Ie===ea.a.zfc)this.TKi(Ja.data);else{var fb=Ja.data.Ie===ea.a.g8,Cb=zb.a.KG();this.cLi(this.zlb,Ja,this.UIl(),Cb);Cb&&(Cb.set("StatusCode",Ja.data.Ie.toString()),fb||this.vdf(Ja.data,Cb));Ba.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",Ja.data.Ie),fb,!1,Object.assign(new bb.a,
{extendedProperties:Cb}))}};this.Yxm=Ja=>{this.OAi(Ja)};this.Xxm=Ja=>{this.OAi(Ja,!0)};this.Uxm=Ja=>{this.NAi(Ja)};this.Sxm=Ja=>{this.NAi(Ja,!0)};this.xGa=b;this.MBk=h;this.hkb=new Th(y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.vP.$je);this.zlb=new Th(y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",
15E3),y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.vP.$je);this.YHk=r;this.NJh=A;this.OQk={};this.zpa=new ki;this.zuk=M;this.EGd="";this.dO=aa;this.hfh=oa;this.NJd="";this.cIk=y.AFrameworkApplication.J.ic("WordRecentLinksCount",25)}get bGe(){return this.OQk}Ato(){this.vP.brc.qa(Ka.a.yCj,we.a.frame,Object(E.a)(this,this.Dyo,"renameMruEntry"))}Dyo(){return this.xOg("Rename")}gFn(){this.zaj("File Opened")}hFn(){this.zaj("IntervalUpdate")}zaj(b){v.ULS.sendTraceTag(5849670,
202,50,"Starting update of MRU entry {0}",{["Trigger"]:b});this.xOg(b)}Uka(b){(b=I.a.Uka(b))&&b.startsWith(".")&&(b=b.substring(1,b.length));return b}a4d(){switch(this.vP.jga){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}XNm(b){var h=this.zuk();if(!h)return null;const r=new Fe;r.documentUrl=this.hfh.value?encodeURI(h):h;r.mruItemId=this.EGd;r.app=this.a4d();if(h=this.dO())r.folderName=h.breadcrumbFolderName,
h=h.yA,r.documentName=I.a.rL(h),r.documentExt=this.Uka(h);b&&(r.documentName?r.documentName.length?255<=r.documentName.length?b.set("DocumentNameLength","Long"):2084<=r.documentName.length&&b.set("DocumentNameLength","VeryLong"):b.set("DocumentNameLength","0"):b.set("DocumentNameLength","Null"));return JSON.stringify(r)}xOg(b,h=!1){if(4===this.vP.jga&&!y.AFrameworkApplication.g_d)return 2;var r=zb.a.KG();r&&(r.set("Trigger",b),r.set("IsRetry",h?"true":"false"),r.set("MruIdSent",this.EGd?"true":"false"),
r.set("URLEncoded",this.hfh.value?"true":"false"));Ba.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",r);b=this.XNm(r);if(!b)return h=!y.AFrameworkApplication.O2b,r&&(r.set("WebEditingIsEnabled",y.AFrameworkApplication.O2b?"true":"false"),r.set("ProtectedFile",y.AFrameworkApplication.z0?"true":"false")),Ba.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",h,!1,Object.assign(new bb.a,{extendedProperties:r})),2;this.zlb&&!h&&this.zlb.reset();r=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",
this.vP.nYa,this.M4f);this.NJh?this.bGe["X-FileId"]=y.AFrameworkApplication.um:r+=String.format("&{0}",y.AFrameworkApplication.um);y.AFrameworkApplication.sessionStartInfoSettings&&(this.bGe["X-Office-AudienceGroup"]=Object(ya.a)(String,y.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||"");this.bGe["X-Timeout"]=15E3;return this.vP.ldd.Wj(r,2,b,this.bGe,!0,5,this.mHp,this.lJl,null,void 0,void 0,void 0,void 0,"4")}TKi(b){const h=zb.a.KG();this.zlb&&(h&&this.zlb.Xpe&&(h.set("LastError",
this.zlb.Xpe),h.set("NumRetries",this.zlb.retryCount.toString())),this.zlb.reset());const r=Vl.c(b.De);r&&r.diagnostics_data&&(this.EGd=r.diagnostics_data.mru_id);b=+b.MO-+b.bH;h&&h.set("RequestDuration",b.toString());Ba.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new bb.a,{extendedProperties:h}))}UIl(){return()=>{this.xOg("Retry",!0)}}Wxm(){this.Rbd("Polling")}Vxm(){this.Rbd("Retry",!0)}SEn(){this.Rbd("Open")}REn(){this.Rbd("Activity")}QEn(){this.Rbd("ActivityRecentLinks",!1,!0)}Rbd(b,
h=!1,r=!1){v.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:b});const A=zb.a.KG();A&&(A.set("Trigger",b),A.set("IsRetry",h?"true":"false"),r&&A.set("RecentLinks","true"));Ba.Health.instance.recordKpiUsage("GetMru",0,"smartfio",A);this.hkb&&!h&&this.hkb.reset();r?this.P8h(this.Xxm,this.Sxm,!0):this.P8h(this.Yxm,this.Uxm)}vdf(b,h){b&&b.vi&&(b=b.vi["X-CorrelationId"])&&h.set("ServerCorrelationId",b)}BAn(b,h){b&&(h&&h.set("RequestDuration",(+b.MO-+b.bH).toString()),Ba.Health.instance.recordKpiSuccess("GetMru",
Object.assign(new bb.a,{extendedProperties:h})))}OAi(b,h=!1){var r="";let A=null,M=null,aa=null;const oa=Vl.c(b.data.De);oa&&(A=oa.places?oa.places.items:[],M=oa.documents?oa.documents.items:[],(aa=Vl.a(oa,h))&&(r=H.c(aa)));y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.qXa&&hh.c()&&(h?this.NJd=r:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(r,!0)));r=zb.a.KG();this.hkb&&(r&&this.hkb.Xpe&&(r.set("LastError",this.hkb.Xpe),r.set("NumRetries",this.hkb.retryCount.toString())),
this.hkb.reset());h&&r&&r.set("RecentLinks","true");aa||A||M?(h?this.vP.UXa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Success"):this.vP.UXa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Success"),this.hEe(3,aa,A,M),this.BAn(b.data,r)):(h?this.vP.UXa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Failure: Invalid JSON"):this.vP.UXa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Failure: Invalid JSON"),r&&this.vdf(b.data,r),Ba.Health.instance.recordKpiFailure("GetMru",
"JsonParseFailed",!1,!1,Object.assign(new bb.a,{extendedProperties:r})),this.hEe(3,null,null,null,!0));this.$yf(this.zpa)}cLi(b,h,r,A){let M=0,aa=0;const oa=Vl.c(h.data.De);oa&&(null!=oa.response_code&&(M=oa.response_code,A&&A.set("MruResponseCode",M.toString()),9===M&&(this.EGd="")),oa.error_data&&null!=oa.error_data.retry_after_ms&&(aa=oa.error_data.retry_after_ms,A&&A.set("ExpectedRetryAfter",aa.toString())));b&&(h=b.U5m(r,aa,h.data.Ie,M),A&&(A.set("CurrentRetryCount",b.retryCount.toString()),
A.set("RetryScheduled",h?"true":"false")))}NAi(b,h=!1){const r=b.data.Ie===ea.a.g8,A=zb.a.KG();A&&(A.set("StatusCode",b.data.Ie.toString()),h&&A.set("RecentLinks","true"),r||this.vdf(b.data,A));h?this.vP.UXa("MruActor.GetMruForRecentLinksFromServerFailureCallback",b.data,"Failure"):this.vP.UXa("MruActor.GetMruFromServerFailureCallback",b.data,"Failure");this.hEe(2);this.cLi(this.hkb,b,Object(E.a)(this,this.Vxm,"getMruFromServerRetryTask"),A);Ba.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",
b.data.Ie),r,!1,Object.assign(new bb.a,{extendedProperties:A}));this.$yf(this.zpa);y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.qXa&&hh.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),h?this.NJd=null:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}hEe(b,h=null,r=null,A=null,M=!1){if(3!==this.zpa.state||3===b)this.zpa.buh=h,this.zpa.cuh=r,this.zpa.WCk=A,this.zpa.state=b,this.zpa.mVe=M,this.zpa.NGh=this.vP.Tp()}Plj(b,h){v.ULS.sendTraceTag(6029918,
202,50,"MRU result requested {0}",{["Trigger"]:b,["ResultState"]:this.zpa.state});h&&3===this.zpa.state&&this.Khi(h,this.zpa);return this.zpa}P8h(b,h,r=!1){this.hEe(1);let A;const M={};A=r?String.format(this.vP.nYa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.cIk,"OfficeSuite",this.M4f,"ClassicMru"):String.format(this.vP.nYa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.a4d(),this.M4f);this.YHk.value||(A+="&entity=docs");y.AFrameworkApplication.sessionStartInfoSettings&&
(M["X-Office-AudienceGroup"]=Object(ya.a)(String,y.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||"");r&&(M["X-Office-Application"]="147");this.NJh?M["X-FileId"]=y.AFrameworkApplication.um:A+=String.format("&{0}",y.AFrameworkApplication.um);this.vP.ldd.Wj(A,1,null,M,!0,5,b,h,null)}get vP(){return this.xGa.value}get M4f(){return this.MBk.value}static get instance(){return Ni._instance||(Ni._instance=Ni.Qs())}static Qs(){return new Ni(new Qf.a(()=>Dj.instance),new Qf.a(()=>tj.a.Hg(y.AFrameworkApplication.lcid).name),
new Qf.a(()=>y.AFrameworkApplication.ua.Ib.cH),y.AFrameworkApplication.J.$("MruWriteFileIdInHeader"),()=>y.AFrameworkApplication.ua.Ib.zW,()=>y.AFrameworkApplication.Ft,new Qf.a(()=>y.AFrameworkApplication.J.$("OICEncodeUrlIsEnabled")))}}Ni._instance=null;Object(u.a)(Ni,"MruActor",Qi,[]);class bh{constructor(){this.zQc=this.Lzh=this.W=null;this.ii=!1;this.ZNl=()=>{Je.a.instance.uf(this.Rdj)};this.aMh=()=>{Je.a.instance.Zb(this.Rdj)}}get name(){return"Common.App.NewAndOpen.Core"}uc(b){this.W=b;b.register(595,
803).ha().Sd(()=>Dj.instance);b.register(598,804).ha().Sd(()=>pg.instance);b.register(598,805).ha().Sd(()=>Ni.instance)}init(){y.AFrameworkApplication.J.Uo(()=>{this.j$a()})}j$a(){this.W.resolve(803);this.W.resolve(804);this.W.resolve(805);var b=!1;Dj.instance.Lpo();y.AFrameworkApplication.iMa&&(b=!0);y.AFrameworkApplication.Uog&&(Ni.instance.SEn(),0<y.AFrameworkApplication.Qdj&&this.aMh(),this.nYo(),b=!0);y.AFrameworkApplication.L_a&&b&&pg.instance.PEn();y.AFrameworkApplication.gvp&&(b=Ni.instance,
b.Ato(),b.gFn(),Je.a.instance.Zb(this.hvp))}nYo(){Mi.instance.nLh(Object(E.a)(Ni.instance,Ni.instance.REn,"makeGetMruRequestActivityTrigger"));Mi.instance.nLh(this.aMh);Mi.instance.QVk(this.ZNl)}get Rdj(){return this.Lzh||(this.Lzh=new xc.a(5,2,y.AFrameworkApplication.Qdj,Object(E.a)(Ni.instance,Ni.instance.Wxm,"getMruFromServerTask"),109))}get hvp(){return this.zQc||(this.zQc=new xc.a(2,2,6E4*y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),
Object(E.a)(Ni.instance,Ni.instance.hFn,"makeUpdateMruTask"),197))}dispose(){this.ii||(this.ii=!0,this.zQc&&(Je.a.instance.uf(this.zQc),this.zQc=null))}}Object(u.a)(bh,"CorePackageManager",null,[0,1,10]);var rk=d(1462),Qd=d(150);class kf{static BYl(b){return kf.OWh("New",b)}static CYl(b){return kf.OWh("Open",b)}static tWh(b,h){return kf.g6a("LoadingMenuSection",kf.qyn,b,kf.DTc("lblLoading",h))}static ETc(b,h,r=null,A=null){return kf.g6a("MessageMenuSection",kf.Odj,h,kf.DTc("lblMessage",b,r,A))}static uel(b){return kf.tWh(b,
CommonUIStrings.l_VoicedLoadingText)}static vel(b,h){return kf.ETc(CommonUIStrings.l_NewCreationLocationMessage,b.labelText,h.Dga,h.xeb)}static sel(b,h){return kf.ETc(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,h.xeb,"\n\n"),b.labelText)}static xWh(b){return kf.ETc(CommonUIStrings.l_NewGenericErrorMessage,b.labelText)}static pel(b,h,r){return kf.g6a("menuNewBlank",kf.IXm,r?b.labelText:null,kf.zTc(b.GMi,b.HMi,b.IMi,null,b.$9a,b.c6c,h,"blank"))}static mfl(){return kf.DTc("lblTemplatesLoading",
CommonUIStrings.l_VoicedLoadingText)}static MWh(){return kf.DTc("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static nfl(b,h){return kf.g6a("menuNewTemplates",b,null,h)}static nel(b,h){return kf.g6a("menuNewMoreTemplates",kf.Poi,null,kf.zTc("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,b,h))}static fdl(b,h,r){let A="";r&&h&&(A=kf.g6a("BrowseMoreMenuSection",kf.Poi,null,kf.zTc("btnBrowseMore",h,h,null,null,null,b||
"1959943459",r)));return A}static DTc(b,h,r=null,A=null){let M=A;h&&0<h.length&&(M=kf.efj.iwb(h).trimEnd(),M=0<=M.indexOf("{0}")?String.format(M,A):String.format("{0} {1}",M,A));r=r&&A?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',I.a.Jf(r),I.a.Jf(A),I.a.Jf(M)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',I.a.Jf(b||""),kf.efj.iwb(I.a.Jf(h||"")),r)}static zTc(b,h,
r,A,M,aa,oa,Ja){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',I.a.Jf(b||""),I.a.Jf(h||""),I.a.Jf(r||""),A||"32by32",I.a.Jf(M||""),I.a.Jf(aa||""),oa,I.a.Jf(Ja||""))}static OWh(b,h){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',b,h)}static g6a(b,h,r,A){r=r?String.format('Title="{0}"',
I.a.Jf(r)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',I.a.Jf(b||""),I.a.Jf(h||""),r,A)}}kf.Odj="MenuMru";kf.qyn="MenuLoading";kf.IXm="MenuHeader";kf.Poi="MenuFooter";kf.efj=Qd.a.dE("\n","&#10;");Object(u.a)(kf,"NewAndOpenXmlUtilities",null,[]);class sk{constructor(){this.folderName=this.folderUrl=
this.hostName=this.hostUrl=null}}Object(u.a)(sk,"HostInformation",null,[]);class al{constructor(b,h,r,A,M,aa){this.TPc=this.hx=this.Jwd=null;this.dMd=this.W7e=!1;this.tth=0;this.cXe=!1;this.zpe=(oa,Ja,fb,Cb,Gb)=>{if(1===fb)return 32;2!==fb||this.cXe||(this.tth=(new Date).getTime(),v.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.oye,["CachedNewMenuXmlExists"]:!!this.Jwd,["ShouldCallGetMoreInfo"]:this.XR.L_a}));return this.F$n(Gb)};this.xGa=
b;this.GGc=h;this.s2a=new Qf.a(()=>new rk.a(r.value,Object(E.a)(this,this.NPb,"getMoreInfoEventReceived")));this.UCk=A;this.vjb=M;this.wLk=aa;this.UOc=this.oye;this.AEd=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("GateTemplateRenderingByGetMoreInfoResponse");this.kAk=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TemplatesForUserRetentionTreatment1",!1);this.rph=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TemplatesForUserRetentionTreatment2",
!1)}get j6(){switch(this.XR.jga){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}Xb(){const b=this.XR.brc;b.qa(Ka.a.bke,we.a.frame,Object(E.a)(this,this.bke,"newDocument"));b.qa(Ka.a.zpe,we.a.frame,this.zpe)}bke(b,h,r,A,M){if(1===r)return 32;if(2===r&&M){if(y.AFrameworkApplication.J.$("BackstagePremiumTemplateExperienceEnabled")&&M.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),y.AFrameworkApplication.va.Ob(Ka.a.ibo,
2);if(M.MenuItemId&&M.SourceControlId)return"NewDocumentHome"===M.SourceControlId&&ac.a("NewDocumentFromHomeTab"),this.bXc(M.MenuItemId,M.SourceControlId)}return 8}bXc(b,h){var r=this.fke.x9h;if(null===r)return 8;var A=y.AFrameworkApplication.J.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const M=y.AFrameworkApplication.Btb;"blank"===b&&this.bkn()&&(v.ULS.sendTraceTag(508687196,202,50,"Updating blank document id with new template id for appId={0}",this.j6),b="blankNew");if(M&&A){v.ULS.sendTraceTag(51455198,
202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const aa={};aa[F.a.template]=b;aa[F.a.j6]=this.j6;aa[F.a.lcid]=y.AFrameworkApplication.lcid.toString();aa[F.a.reason]=Eh.a.Msf;aa[F.a.uiCulture]=y.AFrameworkApplication.uiCulture;aa[F.a.dataCulture]=y.AFrameworkApplication.dataCulture;y.AFrameworkApplication.qN().execute(oa=>{oa.sendMessage(C.a.bXc,aa)})}else A=(new Date).getTime(),h=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",
r,I.a.Yi(this.iMa),I.a.Yi(b),I.a.Yi(this.j6),I.a.Yi(y.AFrameworkApplication.lcid.toString()),I.a.Yi(A.toString()),I.a.Yi(h),I.a.Yi(y.AFrameworkApplication.WM),y.AFrameworkApplication.um),(r=y.AFrameworkApplication.J.ib("ScenarioId"))&&""!==r&&(h+="&wdscenarioid="+I.a.Yi(r)),h+="&"+y.AFrameworkApplication.c8d(),y.AFrameworkApplication.iXa&&(h+="&"+y.AFrameworkApplication.H6d()),(r=this.hx?this.hx.Dga:null)?h+="&DestinationUrl="+I.a.Yi(r):3===this.XR.jga&&this.XR.L_a&&v.ULS.sendTraceTag(508928088,202,
10,"CreateNewDocument: getMorInfoResult is null or PersonalFileStorageUrl is empty"),Le.a.un(h,"_blank",void 0,"CreateNewDocument");2!==this.XR.jga&&3!==this.XR.jga||v.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:Li.a[this.XR.jga],["Template"]:b});y.AFrameworkApplication.J&&y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&1===this.XR.jga&&("blank"===b||"blankNew"===b?ac.b("ConsumerTemplateNewBlank"):
(b=[Object.assign(new ia.a,{name:"TemplateId",string:b})],ac.b("ConsumerTemplateNew",null,0,!0,0,b)));return 32}bkn(){let b=!1;switch(this.XR.jga){case 3:b=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefaultsUpdate",!1);break;case 2:b=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTODefaultThemeChange",!1);break;case 1:b=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",!1)}return b}UCn(b){let h=
Number.MAX_VALUE,r=Number.MIN_VALUE;const A=window.performance;if(A&&"undefined"!==typeof A.getEntriesByName){for(let aa=0;aa<b.length;aa++){var M=A.getEntriesByName(b[aa]);M&&0<M.length&&(M=M[0],h=Math.min(parseInt(String(M.fetchStart)),h),r=Math.max(parseInt(String(M.responseEnd)),r))}r>h&&v.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:r-h,["MinFetchStart"]:h,["MaxResponseEnd"]:r})}}F$n(b){b&&(this.Jwd?b.PopulationXML=this.Jwd:(this.XR.L_a&&
!this.hx&&this.nNn.zR("Opened New menu",!0),b.PopulationXML=this.ddm(this.gHi())));return 32}L_i(){return!this.XR.L_a||!!this.hx&&3===this.hx.state&&!!this.hx.xeb&&!!this.hx.Dga}f_f(){return y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.qXa&&!this.AEd?!0:this.L_i()}gHi(){if(!this.oye&&!this.AEd&&!this.f_f())return null;if(this.UOc&&!this.dMd){let h=!1;var b="9";const r=y.AFrameworkApplication.J.appSettings;"NumberOfTemplatesInBackstage"in r&&(b=r.NumberOfTemplatesInBackstage);let A=this.j6;
"TemplateCollectionId"in r&&(A=r.TemplateCollectionId);this.kAk&&(A="WordConsumerWAC",b="10");this.rph&&(A="WordConsumerWAC",b="10",h=!0);b=String.format(this.XR.nYa+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",I.a.Yi(y.AFrameworkApplication.lcid.toString()),I.a.Yi(A),b);Boolean.parse(r.AppendOriginQueryParam||"false")&&(b+="&org=backstage");Boolean.parse(r.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in r&&(b+="&templateTier="+r.TemplateTier);this.rph&&(b+="&col=officetemplateswordonlinestartexp2");
b=h?b+"&p=1":b+"&p=0";b+="&"+y.AFrameworkApplication.c8d();y.AFrameworkApplication.iXa&&(b+="&"+y.AFrameworkApplication.H6d());this.XR.ldd.Wj(b,1,null,null,!1,2,M=>{this.XR.UXa("CreateNewActor.GetTemplateListJson",M.data);this.ufp(M.data.De)},M=>{this.XR.UXa("CreateNewActor.GetTemplateListJson",M.data);this.tfp()},null,void 0,void 0,void 0,void 0,"5");this.UOc=!1}return this.TPc}ufp(b){this.TPc=b;this.UOc=!1;this.ejd();this.AEd?this.f_f()?this.axf():this.hx&&(v.ULS.sendTraceTag(508867410,202,10,"GetMoreInfo Received but info is missing"),
this.$wf()):this.axf()}axf(){if(y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.qXa&&hh.c()){const b=y.AFrameworkApplication.J.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC"),h=y.AFrameworkApplication.Btb;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.TPc,!0,b&&h));3===this.XR.jga&&v.ULS.sendTraceTag(508867409,202,15,"DispatchSuccessTemplateListJson")}}tfp(){this.dMd=this.UOc=!0;this.ejd();this.$wf();Ba.Health.instance.recordQosError("TemplateServiceReturnedFailure",
["TemplateServiceFailed"],!1,!0,!0,!1,null)}$wf(){y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.qXa&&hh.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1)),3===this.XR.jga&&v.ULS.sendTraceTag(508867408,202,15,"DispatchFailureTemplateListJson"))}UNf(b){var h=0;for(var r=0;r<b.length;r++)if("ST"===b[r].ImageType){h=r;break}const A=b.length?b[h]:null;b=A?A.Url||"":"";var M;let aa=r=h=!1;if(A&&(M=A.AspectRatio))M=parseFloat(M),1>M?h=!0:1.5<M?r=!0:1===M&&(aa=!0);
else switch(v.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:b}),this.XR.jga){case 3:h=!0;break;case 2:r=!0;break;case 5:aa=!0}return{returnValue:b,P0m:h?"95by123":r?"123by69":aa?"100by100":"123by95"}}ddm(b){b=({Txe:h}=this.qel(b,this.fke,this.fke.HTc||"1056925771")).returnValue;if(h){this.Jwd=b;var h=(new Date).getTime()-this.tth;v.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:h})}return b}NPb(b,
h){v.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.hx||3!==b.state?2===b.state&&(v.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.W7e=!0,this.ejd()):(this.hx=b,h||this.ejd(),y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.qXa&&hh.c()&&hh.d("setFileMenuHostInformation")&&(b=Object.assign(new sk,{hostUrl:this.hx.Dga,hostName:this.hx.xeb,folderUrl:y.AFrameworkApplication.breadcrumbFolderUrl,folderName:y.AFrameworkApplication.breadcrumbFolderName}),
v.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(b)),this.AEd&&this.TPc&&this.TPc.length&&(this.f_f()?this.axf():this.$wf(),v.ULS.sendTraceTag(508867407,202,15,"Dispatched on GetMoreInfoReceived"))))}qel(b,h,r){let A;A=!1;const M=this.L_i();let aa="";this.XR.L_a&&(this.W7e?(aa=kf.xWh(h),this.W7e=!1,v.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):
this.hx?M?aa=kf.vel(h,this.hx):this.hx.l9m?(A=!0,this.UOc=!1,aa=kf.sel(h,this.hx),v.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(A=!0,aa=kf.xWh(h),v.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.hx.Dga,["StorageServiceDisplayNameIsSet"]:!!this.hx.xeb})):(aa=kf.uel(h.labelText),v.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));
M&&(aa+=kf.pel(h,r,!aa)+({Txe:A}=this.lfl(b,r)).returnValue);return{returnValue:kf.BYl(aa),Txe:A}}lfl(b,h){let r;r=!1;if(!this.oye)return r=!0,v.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",Txe:r};let A="",M="",aa="MenuTemplate";if(this.dMd)A=kf.MWh(),this.dMd=!1,v.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(b){try{const oa=Sys.Serialization.JavaScriptSerializer.deserialize(b,!0);A=this.kfl(oa,
h);v.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");y.AFrameworkApplication.ffj&&"OneDrive"===this.iMa&&(M=kf.nel(this.oNn,y.AFrameworkApplication.ffj))}catch(oa){v.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:b}),A=kf.MWh()}r=!0}else aa="MenuLoading",A=kf.mfl(),v.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:kf.nfl(aa,A)+M,Txe:r}}kfl(b,h){let r="";
const A=[];for(let aa=0;aa<b.length;aa++){var M=b[aa];let oa="";if(M){const Ja=M.Title,fb=M.AssetId;M=M.Thumbnails;fb&&Ja&&M&&({P0m:M,returnValue:oa}=this.UNf(M),r+=kf.zTc("jbtnNewTemplate"+aa,Ja,null,M,null,oa,h,fb))}A[aa]=oa}b=new xc.a(4,1,5E3,()=>{this.UCn(A)},106);this.XR.$je.Zb(b);return r}ejd(){this.cXe=!0;this.XR.Uej.dPa(this.fke.t0c);this.cXe=!1}get XR(){return this.xGa.value}get fke(){return this.GGc.value}get nNn(){return this.s2a.value}get oNn(){return this.UCk.value}get iMa(){return this.vjb.value}get oye(){return this.wLk.value}}
Object(u.a)(al,"CreateNewActor",null,[]);class he{constructor(){this._initialized=!1;this.e9e={}}eD(b){this.xji();return this.get(b)}contains(b){this.xji();return b.toString()in this.e9e}xji(){this._initialized||(this.sXk(),this._initialized=!0)}Mlb(b,h){this.e9e[b.toString()]=h}get(b){return this.e9e[b.toString()]}}Object(u.a)(he,"AIntlHelper",null,[]);class qd extends he{constructor(){super()}sXk(){this.Mlb(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.Mlb(1,CommonUIStrings.l_OpenMenuServerErrorMessage);
this.Mlb(2,CommonUIStrings.l_Open);this.Mlb(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.Mlb(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.Mlb(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return qd._instance||(qd._instance=new qd)}static D2n(b){return qd.instance.eD(b)}}qd._instance=null;Object(u.a)(qd,"MruActorIntlHelper",he,[]);var hl;(function(b){b[b.success=0]="success";b[b.Zj=1]="failure";b[b.y0b=2]="spinner";b[b.none=3]="none"})(hl||(hl={}));Object(u.b)("DisplayState",hl);
class ug{constructor(b,h,r,A,M,aa,oa,Ja){this.VKe=null;this.Mbf=!0;this.Iwd="";this.vOk=0;this.s8b=null;this.HYe=3;this.okg=(fb,Cb,Gb,Sb,pc)=>1!==Gb&&pc?this.D$n(pc):32;this.Ga=Ja;this.xGa=b;this.kya=h;this.rtk=r;this.mnk=A;this.lnk=M;this.s2a=new Qf.a(()=>new rk.a(aa.value,null));this.evk=new Qf.a(()=>new rk.a(oa.value,Object(E.a)(this,this.HLn,"mruEventResultReceived")));this.Ga.$("WacInTabOpenMRUIsEnabledForUiHost");this.Ga.$("UiHostSupportsDocRebootFeatures")}HLn(b,h){this.s8b=b;h||this.zyj()}Dso(){this.vP.brc.fb(Ka.a.okg,
we.a.frame,this.okg,96)}D$n(b){this.mZl();this.lZl();b.PopulationXML=kf.CYl(this.Iwd+this.VKe);return 32}mZl(){var b=3;let h=!1;if(this.Iwd&&this.vOk===this.s8b.ohp)v.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),b=this.HYe;else{v.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var r=this.vP.Tp();this.s8b=this.GLn.zR("File Open opened",!0);this.Iwd&&2!==
this.HYe&&3!==this.s8b.state?h=!0:(b=this.QHm(this.s8b),y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.qXa&&hh.c()&&b&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(b,!0)),this.Iwd=({fNn:b}=this.fdm(this.s8b)).returnValue);r=this.vP.Tp()-r;v.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:r})}2!==b&&(r={["DisplayState"]:hl[b]},1!==b&&(r.IsStale=h),v.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",
r));this.HYe=b}QHm(b){let h;try{h=H.c(b.V8f)}catch(r){h=null,v.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",r)}return h}lZl(){this.Mbf?(v.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.VKe=({ACp:this.Mbf}=this.MEn()).returnValue):v.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");v.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.Mbf,
["NotDisplayingLink"]:!this.VKe})}fdm(b){let h;1===b.state||0===b.state?(v.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),b=2,h=kf.tWh(this.F9a(2),this.F9a(5))):3===b.state&&b.V8f?(h=this.oel(b.V8f),b=0):(v.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),h=kf.ETc(this.F9a(1),this.F9a(2)),b=1);return{returnValue:h,fNn:b}}oel(b){let h;const r=this.Acd.HTc||"2155708348";if(b.length){h=kf.DTc("lblRecentDocuments",this.F9a(3));
let A=0;for(let M=0;M<b.length;M++){const aa=b[M];"FileName"in aa&&"DocumentUrl"in aa&&"Path"in aa&&(h+=kf.zTc("MruButton"+M,aa.FileName.toString(),aa.Path.toString(),null,this.Acd.$9a,this.Acd.c6c,r,aa.DocumentUrl.toString()),aa.IsPinned&&A++)}h=kf.g6a("RecentDocumentsMenuSection",kf.Odj,this.F9a(2),h);v.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:b.length,["NumPinnedDocuments"]:A})}else h=kf.ETc(this.F9a(0),this.F9a(2)),v.ULS.sendTraceTag(5849664,
202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return h}MEn(){let b;b=!0;let h=this.ycl;var r=this.xcl;if(h&&r||!this.vP.L_a)b=!1;else{const A=this.L6d.zR("File Open",!1);3===A.state&&(h=A.Dga,r=A.xeb,b=!1)}r=r?String.format(this.F9a(4),r):null;return{returnValue:kf.fdl(this.Acd.HTc,r,h),ACp:b}}zyj(){this.vP.Uej.dPa(this.Acd.t0c)}get vP(){return this.xGa.value}get F9a(){return this.kya.value}get Acd(){return this.rtk.value}get ycl(){return this.mnk.value}get xcl(){return this.lnk.value}get L6d(){return this.s2a.value}get GLn(){return this.evk.value}}
Object(u.a)(ug,"MruRenderer",null,[]);var Tj=d(1471);class xk{constructor(b,h,r,A,M,aa,oa){this.hx=null;this.hCh=!1;this.Wwa=this.Z4=0;this.NPb=Ja=>{if(!this.hx&&3===Ja.state)this.hx=Ja;else if(2===Ja.state){this.hCh?v.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.L6d.zR("NewDocumentFromStream",!0),this.hCh=!0);return}this.Psf()};this.iNn=Ja=>{if(Ja&&Ja.data&&Ja.data.De)if(({ev:fb}=H.d(Ja.data.De)).returnValue)if(Ja=fb,Ja.StatusCode!==ea.a.pz&&Ja.StatusCode!==
ea.a.zfc)v.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.j6,this.Wwa,Ja.StatusCode),this.S8b(null);else if(Ja.NewDocumentUrl&&""!==Ja.NewDocumentUrl){var fb=(new Date).getTime()-this.Z4;v.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.j6,this.Wwa,fb);this.kDk(Ja.NewDocumentUrl)}else v.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",
this.j6,this.Wwa),this.S8b(null);else v.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.j6,this.Wwa,{["ResponseData"]:Tj.a.Erd(Ja.data.De)}),this.S8b(null);else v.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.j6,this.Wwa),this.S8b(null)};this.hNn=Ja=>{Ja&&Ja.data&&v.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",
this.j6,this.Wwa,Ja.data.status);this.S8b(null)};this.kDk=b;this.S8b=h;this.JGd=r;this.GGc=A;this.vjb=M;this.xGa=aa;this.s2a=new Qf.a(()=>new rk.a(oa.value,this.NPb))}bXc(){!this.hx&&this.wag.L_a?this.L6d.zR("NewDocumentFromStream",!0):this.Psf()}Psf(){this.Z4=(new Date).getTime();var b=this.L4l.x9h;if(null===b)this.S8b(null);else{var h=this.JGd.menuItemId,r=this.JGd.fOa,A=this.JGd.Rap,M=this.JGd.T4l;this.Wwa="streamBase64"===A?M.length/1024:0;v.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",
this.j6,this.Wwa);var aa=(new Date).getTime();b=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",b,I.a.Yi(this.iMa),I.a.Yi(h),I.a.Yi(this.j6),I.a.Yi(y.AFrameworkApplication.lcid.toString()),I.a.Yi(aa.toString()),I.a.Yi(r),I.a.Yi(y.AFrameworkApplication.WM),y.AFrameworkApplication.um,I.a.Yi(A));b+="&"+y.AFrameworkApplication.c8d();y.AFrameworkApplication.iXa&&(b+="&"+y.AFrameworkApplication.H6d());(h=this.hx?this.hx.Dga:null)&&(b+=
"&DestinationUrl="+I.a.Yi(h));this.wag.ldd.Wj(b,2,M,{"Content-Type":"application/json; charset=utf-8"},!0,2,this.iNn,this.hNn,null,void 0,void 0,void 0,void 0,"31")}}get j6(){switch(this.wag.jga){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get L4l(){return this.GGc.value}get iMa(){return this.vjb.value}get wag(){return this.xGa.value}get L6d(){return this.s2a.value}}Object(u.a)(xk,"NewDocumentFromStreamOperation",null,[]);class ff{constructor(b,
h,r,A){this.GGc=b;this.vjb=h;this.xGa=r;this.dvk=A}create(b,h,r){return new xk(b,h,r,this.GGc,this.vjb,this.xGa,this.dvk)}}Object(u.a)(ff,"NewDocumentFromStreamOperationFactory",null,[810]);var Oi=d(133);class Ph{get name(){return"Common.App.NewAndOpen.UX"}uc(b){b.register(ff,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as(1315).ha().Sd(()=>new ff(new Qf.a(()=>y.AFrameworkApplication.ua.Ib.AIf()),new Qf.a(()=>y.AFrameworkApplication.iMa),new Qf.a(()=>b.Oa(803)),new Qf.a(()=>b.Oa(804))))}init(){y.AFrameworkApplication.J.Uo(()=>
{this.j$a()})}j$a(){const b=Xe.a.Yp(Za.a.instance.Ra(803)),h=Xe.a.Yp(Za.a.instance.Ra(804));y.AFrameworkApplication.iMa&&Oi.Task.WAA.call(null,b,h).continueWith(()=>{const r=new al(new Qf.a(()=>b.result),new Qf.a(()=>y.AFrameworkApplication.ua.Ib.AIf()),new Qf.a(()=>h.result),new Qf.a(()=>y.AFrameworkApplication.ua.Ib.BIf().HTc||"1959943459"),new Qf.a(()=>y.AFrameworkApplication.iMa),new Qf.a(()=>y.AFrameworkApplication.ckn));r.Xb();r.ejd()});if(y.AFrameworkApplication.Uog){const r=Xe.a.Yp(Za.a.instance.Ra(805));
Oi.Task.WAA.call(null,b,h,r).continueWith(()=>{const A=new ug(new Qf.a(()=>b.result),new Qf.a(()=>qd.D2n),new Qf.a(()=>y.AFrameworkApplication.ua.Ib.BIf()),new Qf.a(()=>y.AFrameworkApplication.C2n),new Qf.a(()=>y.AFrameworkApplication.B2n),new Qf.a(()=>h.result),new Qf.a(()=>r.result),y.AFrameworkApplication.J);A.Dso();A.zyj()})}}dispose(){}}Object(u.a)(Ph,"UXPackageManager",null,[0,1,10]);var ni=d(173);class Pf extends ni.StandardDialog{constructor(){super();this.Fd=0;this.Qe(1,CommonUIStrings.l_DialogClose)}aR(b){this.zy(b,
CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}ixf(b){this.zy(b,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(u.a)(Pf,"ErrorDialog",ni.StandardDialog,[746]);var Yh=d(333);class Qh{Rri(){v.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const b=new Yh.a;b.hg("api.onedrive.com");return b.task}}Object(u.a)(Qh,"OneDriveConsumerEndpointHelper",null,[730]);var fk=d(44);class km{constructor(b,h,r,A){this.$Fb=
this.tMa=null;this.r7e=this.t7e=!1;this.e9b=null;this.Ga=b;this.S3b=h;this.gFb=r;this.qJ=A}get tQh(){return this.S3b}get J(){return this.Ga}Vjc(){this.e9b||(this.e9b=this.rsc?ob.a.create(this.rsc,null,null,null,!1):null);return this.e9b}setup(b){this.$Fb=b;this.t7e||this.r7e?this.t7e&&this.$Fb&&this.$Fb(!0):(b=this.Vjc())?(this.r7e=!0,b.Vab.continueWith(h=>{this.LXn(h)}),pb.a.l_(b)):(v.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.$Fb(!1))}Eeg(b){v.ULS.sendTraceTag(20509838,
352,15,"Failure during OneDrive API download: {0}",b.vk?b.vk.toString():"No error detail.")}LXn(b){this.r7e=!1;if(b.fj)this.Eeg(b),this.$Fb(!1);else try{this.t7e=!0,v.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.VTf(),v.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.$Fb(!0)}catch(h){v.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",h.toString()),this.$Fb(!1)}}Epd(b){this.tMa=b;this.gFb?v.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):
(v.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(E.a)(this,this.Bcg,"onApiReady")))}Bcg(b){b?this.tge():this.mq()}mq(){this.qJ().aR(fk.a.G1n)}sE(b){v.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.tMa&&this.tMa(!0,b)}dispose(){this.e9b&&this.e9b.dispose()}}Object(u.a)(km,"AOneDriveFilePickerApiManager",null,[776,10]);class gk extends km{constructor(b,h,r,A,M,aa){super(h,r,A,aa);this.zh=null;this.fya=
b;this.ELk=M}get rsc(){return this.J.ib("OneDriveApiUrl")}start(b,h){this.zh=b;this.Epd(h)}VTf(){WL.init(1===this.tQh||2===this.tQh?{["client_id"]:this.J.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.J.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}Epd(b){this.tMa=b;!this.gFb&&this.fya.K7c?(v.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(E.a)(this,this.Bcg,"onApiReady"))):(v.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),
this.ELk())}tge(){try{v.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.zh).then(Object(E.a)(this,this.sE,"onSuccess"),Object(E.a)(this,this.onFailure,"onFailure"))}catch(b){v.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",b,b.stack),this.mq()}}onFailure(b){if(b&&b.error){if("user_canceled"===b.error.code){v.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}v.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",
b.error.code,b.error.message)}else v.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.tMa&&this.tMa(!1,b);this.mq()}}Object(u.a)(gk,"OneDriveFilePickerApiManagerV5",km,[]);class Ij extends km{constructor(b,h,r,A,M){super(b,h,r,A);this.cCd=this.swh=null;this.hCe=()=>{this.cCd.style.visibility="hidden"===this.cCd.style.visibility?"":"hidden"};this.xsk=M;this.options={};this.options.clientId=this.J.ib("OneDriveApiV7ClientId");this.options.cancel=this.hCe}get rsc(){return this.J.ib("OneDriveApiV72Url")}start(b,
h){this.cCd=h;const r=this.xsk.Rri();r.continueWith(()=>{v.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.swh=r.result;this.Epd((A,M)=>{this.hCe();b(A,M)})},3);r.continueWith(()=>{v.ULS.sendTraceTag(24134242,352,15,r.vk.message);this.hCe()},5)}VTf(){this.options.success=b=>{const h={};h.data=b;this.sE(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=
this.swh;this.options.advanced.iframeParentDiv=this.cCd}tge(){try{v.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.hCe(),OneDrive.open(this.options)}catch(b){v.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",b.message),this.mq()}}onFailure(b){this.tMa&&this.tMa(!1,b);this.mq()}}Object(u.a)(Ij,"OneDriveFilePickerApiManagerV7",km,[]);class Wl extends km{constructor(b,h,r,A){super(b,h,r,A);this.Flk=b;this.options={};this.options.advanced=
{};this.options.action="query";this.options.clientId=this.J.ib("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get rsc(){return this.J.ib("OneDriveApiV72Url")}start(b,h,r,A){this.options.advanced.iframeParentDiv=r;this.options.advanced.endpointHint=A;this.options.cancel=h;this.Flk.$("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent=
{});this.Epd(b)}Epd(b){this.tMa=b;this.gFb?v.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(v.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(E.a)(this,this.Bcg,"onApiReady")))}VTf(){this.options.success=b=>{const h={};h.data=b;this.sE(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)}}tge(){try{v.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(b){v.ULS.sendTraceTag(23881880,
216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.mq()}}Eeg(b){v.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",b.vk?b.vk.toString():"No error detail.");pb.a.Awo(this.rsc);this.e9b=null}mq(){this.qJ().ixf(fk.a.AHo)}onFailure(b){this.tMa&&this.tMa(!1,b)}}Object(u.a)(Wl,"OneDriveFilePickerApiManagerV72",km,[]);class lm{constructor(b){this.olsSessionId=this.value=this.key=null;this.olsSessionId=b}}Object(u.a)(lm,"IExtraData",
null,[]);class il extends Wl{constructor(b,h,r,A){super(b,h,r,A);this.options.advanced.filter=b.ib("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=y.AFrameworkApplication.EQh;b.$("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=b.ib("OneDriveApiV72CommandMode")||"none");b.$("OneDriveApiV72QosExtraDataEnabled")&&(this.options.qosExtradata=new lm(y.AFrameworkApplication.userSessionId))}get rsc(){return this.J.ib("OneDriveApiV72Url")}tge(){try{v.ULS.sendTraceTag(26071182,
352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",y.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(b){v.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.mq()}}}Object(u.a)(il,"OneDriveFilePickerApiOpenManagerV72",
Wl,[]);class kn{constructor(b){this.Nq=null;this.Mxm=h=>{if(h.data.Ie===ea.a.g8&&"X-NewKey"in h.data.vi){v.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const r={};r["X-Key"]=h.data.vi["X-NewKey"];this.Mwg(r)}else 0<this.M5e?(v.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.M5e),this.M5e--,this.Mwg()):(v.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),
this.Nq.setException(Error.create("GetMoreInfo request failed and no more retries remain")))};this.Oxm=h=>{"PersonalFileStorageUrl"in h.data.vi&&""!==h.data.vi.PersonalFileStorageUrl?(v.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.Nq.hg(h.data.vi.PersonalFileStorageUrl)):(v.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.Nq.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))};
this.Gf=b;this.M5e=3}Rri(){this.Nq=new Yh.a;v.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.Mwg();return this.Nq.task}Mwg(b=null){const h=String.format("GetMoreInfoHandler.ashx?{0}",y.AFrameworkApplication.yMb);this.Gf.A5a(h,1,null,b,["PersonalFileStorageUrl","X-NewKey"],2,this.Oxm,this.Mxm,void 0,void 0,void 0,void 0,"21")}}Object(u.a)(kn,"OneDriveForBusinessEndpointHelper",null,[730]);var Jl=d(752);class Zm{constructor(){this.W=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}uc(b){this.W=
b;this.W.register(gk,1029).as(1207).ha().Sd(()=>new gk(Jl.a.instance,y.AFrameworkApplication.J,y.AFrameworkApplication.O6,y.AFrameworkApplication.Mta,y.AFrameworkApplication.KCg,()=>new Pf));y.AFrameworkApplication.rtb?this.W.register(730,806).ha().Sd(()=>new Qh):this.W.register(730,806).ha().Sd(()=>new kn(y.AFrameworkApplication.Ee));this.W.register(Ij,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").ha().Sd(()=>new Ij(y.AFrameworkApplication.J,y.AFrameworkApplication.O6,y.AFrameworkApplication.Mta,
()=>new Pf,this.W.resolve(806)));this.W.register(Wl,1220).ha().Sd(()=>new Wl(y.AFrameworkApplication.J,y.AFrameworkApplication.O6,y.AFrameworkApplication.Mta,()=>new Pf));this.W.register(il,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").ha().Sd(()=>new il(y.AFrameworkApplication.J,y.AFrameworkApplication.O6,y.AFrameworkApplication.Mta,()=>new Pf))}static main(){K.a.instance.Lc(new Zm)}}Object(u.a)(Zm,"PackageManager",null,[0,1]);class bl{constructor(b,h,r,A,M,aa){this.PolicyCookie=
this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=b;this.WebAffinitizedUrl=h;this.PolicyCookie=r;this.PolicyCookieTTL=A;this.WasServiceDown=M;this.AffinitizedUrl=aa}}Object(u.a)(bl,"SafeLinksData",null,[]);class $m{constructor(b,h){this.jBe=b;this.kz=h}}Object(u.a)($m,"SafeLinksGetUrlReputationRequestData",null,[]);class Tk{constructor(b,h,r,A){this.FVn=M=>{let aa="OnGetUrlReputationSuccessCallback: ",
oa=10;const Ja=M.data.state;try{const fb=H.b(M.data.De).reputationResults[0],Cb=fb.navigateUrl.length,Gb=Ja.jBe.length,Sb=fb.navigateUrl===Ja.jBe;fb.navigateUrl&&0<fb.navigateUrl.length&&(Ja.jBe=fb.navigateUrl);aa+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",M.data.Ie,fb.verdict,Gb.toString(),Cb.toString(),Sb.toString());oa=50}catch(fb){aa+=String.format("Exception {0}",fb.message)}this.LKi(Ja,aa,oa)};this.EVn=M=>{let aa=
"OnGetUrlReputationFailureCallback: ";const oa=M.data.state;try{aa+=String.format("HttpStatus {0}",M.data.Ie)}catch(Ja){aa+=String.format("Exception {0}",Ja.message)}this.LKi(oa,aa,10)};this.Ga=b;this.Gf=h;this.yvk=r;Tk.Xd=A}Szc(b,h,r){try{var A=null;Tk.Xd&&(A=Tk.Xd.Wf("WebServiceCall","SafeLinksGetUrlReputation"));const M=new $m(h,A);A={};A.AffinitizedUrl=b;A.TargetUrl=h;A.PolicyCookie=r;const aa=H.c(A);this.Gf.Wj(this.yvk,2,aa,null,!1,2,this.FVn,this.EVn,M,void 0,void 0,3E3,3E3,"36");return!0}catch(M){v.ULS.sendTraceTag(588788033,
378,10,M.message)}return!1}LKi(b,h,r){b.kz&&(b.kz.stop(),b.kz=null);v.ULS.sendTraceTag(588788034,378,r,h);Le.a.un(b.jBe,void 0,"noopener,noreferrer","SafeLinksNav")}}Tk.Xd=null;Object(u.a)(Tk,"SafeLinksNavigationHelper",null,[]);var zm;(function(b){b[b.dWp=0]="enabledByPolicy";b[b.gSl=1]="disabledByPolicy";b[b.VUp=2]="disabled_GetPolicyFailure";b[b.WUp=3]="disabled_PendingGetPolicyRequest"})(zm||(zm={}));Object(u.b)("SafeLinksNavigationState",zm);class yk{constructor(b,h,r,A=!1,M=null,aa=null){this.GDb=
this.FDb=0;this.D8c=this.xBd=!1;this.Rjb=null;this.$7b=!0;this.yLd=null;this.JGm=fb=>{let Cb=ea.a.COn,Gb="";try{this.xBd=this.D8c=!1;var Sb=fb.data.state;const be=({kz:Sb}=this.$ze(Sb)).returnValue,Rf=Object.assign(new bb.a,{durationMs:be});Ba.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",Rf);v.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",fb.data.Ie,fb.data.De.length,be);if(fb.data.Ie!==ea.a.pz)Gb=
"Unexpected httpStatus: "+fb.data.Ie.toString();else{Sb=null;try{Sb=H.b(fb.data.De)}catch(Mf){Gb="Exception:"+Mf.toString()+" deserializing response";return}if(Sb){var pc=Sb.IsSafeLinksEnabled;if(void 0===pc||null===pc||0>=pc.length)Gb="Invalid isSafeLinksEnabledString";else{v.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",pc);var zc=yk.Iig(pc);if(void 0===Sb.WebAffinitizedUrl||null===Sb.WebAffinitizedUrl||0>=Sb.WebAffinitizedUrl.length)Gb="Invalid WebAffinitizedUrl";else if(void 0===
Sb.PolicyCookie||null===Sb.PolicyCookie||0>=Sb.PolicyCookie.length)Gb="Invalid PolicyCookie";else if(void 0===Sb.PolicyCookieTTL||null===Sb.PolicyCookieTTL)Gb="Invalid PolicyCookieTTL";else{var Yc=Sb.WebAffinitizedUrl,Kd=Sb.PolicyCookie,ke=Sb.AffinitizedUrl,ge=new Date;ge.setMinutes(ge.getMinutes()+(5<Sb.PolicyCookieTTL?Sb.PolicyCookieTTL-5:0));var de=ge.getTime(),Sd=new bl(pc,Yc,Kd,de,!1,ke);this.$Kj(Sd);Cb=fb.data.Ie;this.Rjb&&(zc?(this.v2j(this.Rjb),this.GDb=this.FDb=0):(v.ULS.sendTraceTag(26019602,
378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),Ba.Health.instance.recordKpiFailure("SafeLinksNavigations","disabledByPolicy",!0,!0,null),Le.a.Epb(this.Rjb)),this.Rjb=null)}}}else Gb="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(be){Gb="GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+be.toString()}finally{Cb!==ea.a.pz&&this.KKi(Cb,Gb)}};this.IGm=fb=>{this.xBd=!1;let Cb=500,Gb="";try{let Sb=fb.data.state;const pc=({kz:Sb}=this.$ze(Sb)).returnValue,
zc=Object.assign(new bb.a,{durationMs:pc});Cb=fb.data.Ie;Ba.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest","HttpStatusCode_"+Cb.toString(),!1,!0,zc);Gb="Request Failed, Status="+Wk.a[fb.data.status]+" Duration: "+pc}catch(Sb){Gb="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+Sb.toString()}finally{this.KKi(Cb,Gb)}};v.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");this.Ga=b;this.Gf=h;this.CPa=r;yk.Xd=aa;this.uQk=A?this.Ga.ib("SafeLinksHandlerWebServiceBase"):
this.Ga.ib("WebServiceBase");this.RPk=this.Ga.ib("SafeLinksHashedUserId");this.$Gp=this.Ga.ib("SafeLinksWorkloadIdHeaderValue");this.XFd=this.Ga.ic("SafeLinksMaxGetPolicyBootRetries",2);this.YFd=this.Ga.ic("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.IDd=this.wnn();this.HDd=this.vnn();yk.GIh=this.Ga.ib("UserPrincipalName")||"";yk.UPc=this.Ga.ib("TenantId")||"";v.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.IDd,this.HDd);if(this.IDd&&
this.HDd){h=(b=this.hqb())?b.IsSafeLinksEnabled.toLowerCase():"";r=this.MZf();v.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",h,r);var oa=!b||"unknown"===h||b.WasServiceDown||r,Ja=zb.a.KG();Ja&&(Ja.set("shouldGetSafeLinksDataFromServer",oa.toString()),Ja.set("isSafeLinksEnabledCacheValue",h.toString()));M?(this.$7b=!1,M.execute(fb=>{fb.isFeatureEnabled("MsoUrlreputation",!0).then(Cb=>{this.$7b=Cb;Ja.set("isUserLicensedForSafeLinks",this.$7b.toString());
Ba.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Ja);this.$7b&&oa&&this.X7d(!0);return null})})):(Ba.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Ja),oa&&this.X7d(!0))}}get appName(){return this.CPa}get AFe(){return this.uQk}get userId(){return this.RPk}get nIi(){try{if(""===yk.ESe){const b={};b["X-AppName"]=this.appName;b["X-AppVersion"]=y.AFrameworkApplication.buildVersion;b.OS=this.Ga.ib("PlatformNameAndVersion")||"";const h=JSON.stringify(b);
yk.ESe=window.self.btoa(h)}}catch(b){v.ULS.sendTraceTag(508909765,378,10,"GetUrlReputationAdditionalProperties Error: {0}",b.message)}return yk.ESe}get kDm(){const b=this.AFe?this.AFe+"/":"",h=new Ra.QueryStringBuilder("SafeLinksHandler.ashx");h.ye("app",this.appName);this.Ga.$("SafeLinksUseDebugHeader")&&h.ye("action","debug");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&h.ye("s2satpop","1");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",
!1)&&h.ye("s2se03","1");return String.format("{0}{1}&{2}",b,h.toString(),y.AFrameworkApplication.um)}get zNm(){const b=this.AFe?this.AFe+"/":"",h=new Ra.QueryStringBuilder("SafeLinksHandler.ashx");h.ye("app",this.appName);this.Ga.$("SafeLinksUseDebugHeader")&&h.ye("action","debug");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&h.ye("s2satpop","1");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&h.ye("s2saat","1");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",
!1)&&h.ye("s2se03","1");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",!1)&&h.ye("sladpar",this.nIi);h.ye("slrt","GetUrlReputation");return String.format("{0}{1}&{2}",b,h.toString(),y.AFrameworkApplication.um)}get MMn(){yk.r6e||(yk.r6e=new Tk(this.Ga,this.Gf,this.zNm,yk.Xd));return yk.r6e}Szc(b){if(!b)return v.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),!1;var h=this.yhn(b);v.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",
h,this.IDd,this.HDd,this.$7b);if(!(h&&this.IDd&&this.HDd&&this.$7b))return!1;h=0;const r=({state:h}=this.h2o()).returnValue;v.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",zm[h]);const A=zb.a.KG();A&&A.set("SafeLinksNavigationState",zm[h]);Ba.Health.instance.recordKpiUsage("SafeLinksNavigations",0,"jpittsdirects",A);if(!r)return 2!==h&&3!==h||Ba.Health.instance.recordKpiFailure("SafeLinksNavigations",zm[h],!1,!0,null),!1;v.ULS.sendTraceTag(26019601,
378,50,"Using safelinks to navigate hyperlink");if(this.F2o())return this.MZf()?!1:this.MMn.Szc(this.lem(),b,this.eDi());if(!this.MZf())return this.v2j(b),!0;this.Rjb=b;v.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.D8c=!1;this.X7d();return!0}yhn(b){b=b.toLowerCase();const h=this.Ga.cD("SafeLinksUnsupportedProtocols");if(h)for(let r=0;r<h.length;r++)if(b.startsWith(h[r]))return!1;return!0}X7d(b=!1){var h=zb.a.KG();h&&h.set("isOnBootRequest",b.toString());
Ba.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",1,"jpittsdirects",h);Ba.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",h);h=this.Hrf("SafeLinksGetPolicy");this.Gf.Wj(this.kDm,1,null,null,!0,2,this.JGm,this.IGm,h,void 0,void 0,void 0,void 0,"23");this.D8c=b;this.xBd=!0;b?this.FDb++:this.GDb++}KKi(b,h=""){try{if(v.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",b,h),this.FDb<this.XFd&&this.GDb<this.YFd)this.X7d(this.D8c);
else{this.D8c=!1;v.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",this.FDb,this.GDb,b,h);h=null;const r=zb.a.KG();r&&(r.set("HttpStatus",b.toString()),h=Object.assign(new bb.a,{extendedProperties:r}));Ba.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,h);const A=new bl("false","","",0,!0,"");this.$Kj(A);this.Rjb&&(v.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}",
"disabled_GetPolicyFailure"),Ba.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",!1,!0,null),Le.a.Epb(this.Rjb),this.Rjb=null)}}catch(r){v.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",r.toString())}}v2j(b){const h=this.eDi(),r=this.NOm(),A={};A.Url=b;A.SafeLinksCookie=h;A.CorrelationId=kb.a.create().toString();A.WorkloadId=this.$Gp;A.UserAgentInfo=Y.a.XD+"|"+this.appName;this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",
!1)&&(A.User=yk.GIh,A.TenantId=yk.UPc,A.AdditionalProperties=this.nIi);v.ULS.sendTraceTag(23900187,378,50,"Validating hyperlink with request correlation: {0}",A.CorrelationId);Le.a.Ckg(Le.a.ewa(4),r,A)}wnn(){const b=this.Ga.ib("IsSafeLinksEnabledForUser");return b?yk.Iig(b):!1}vnn(){const b=this.Ga.cD("SafeLinksDisabledBrowsers");if(Y.a.r7){if(this.Ga.Zx("SafeLinksForTeamsIsEnabled")&&this.Ga.$("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(b,"Electron"))return!1}else if(Array.contains(b,
Y.a.XD))return!1;return"officecomhwa"===(this.Ga.ib(y.AFrameworkApplication.Uva)||"").toLowerCase()?!1:!0}F2o(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",!1)&&Y.a.h9c?!0:Y.a.r7}h2o(){let b;b=0;const h=this.hqb(),r=h?h.IsSafeLinksEnabled:"";if(""!==r)return h.WasServiceDown?(v.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===r.toLowerCase()?
(v.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):{returnValue:yk.Iig(r),state:b};if(this.xBd)return b=3,v.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:b};if(this.FDb>=this.XFd||this.GDb>=this.YFd)return b=2,v.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.FDb,this.XFd,this.GDb,this.YFd),{returnValue:!1,state:b};v.ULS.sendTraceTag(23900182,
378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",this.XFd+this.YFd-(this.FDb+this.GDb));return{returnValue:!0,state:b}}eDi(){const b=this.hqb();return b?b.PolicyCookie:""}NOm(){const b=this.hqb();return b?b.WebAffinitizedUrl:""}lem(){const b=this.hqb();return b?b.AffinitizedUrl:""}Xom(){const b=new Date;try{const h=this.hqb();b.setTime(h?h.PolicyCookieTTL:0)}catch(h){v.ULS.sendTraceTag(24462658,
378,10,"Exception occured while fetching expiration time from cache: {0}",h)}return b}MZf(){const b=this.Xom();return!!b&&b.getTime()<Date.now()}hqb(){if(!this.yLd){const b=hb.a.instance.getItem(this.userId);if(!b||""===b)return null;this.yLd=JSON.parse(b)}return this.yLd}$Kj(b){if(void 0===b||null===b)throw Error.argumentNull("safeLinksData");if(void 0===b.IsSafeLinksEnabled||null===b.IsSafeLinksEnabled||0>=b.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");
this.yLd=b;b.WasServiceDown||this.pHp(b)}pHp(b){b=JSON.stringify(b);hb.a.instance.setItem(this.userId,b)}Hrf(b){return void 0!==yk.Xd&&null!==yk.Xd?yk.Xd.Wf("WebServiceCall",b):null}$ze(b){if(void 0!==b&&null!==b){const h=b.Ei;b.stop();return{returnValue:h,kz:null}}return{returnValue:null,kz:b}}static Iig(b){return"false"!==b.toLowerCase()?!0:!1}}yk.Xd=null;yk.r6e=null;yk.UPc="";yk.GIh="";yk.ESe="";Object(u.a)(yk,"SafeLinksManager",null,[744]);const Kl=b=>{switch(b){case 3:return"Word";case 1:return"Excel";
case 2:return"PowerPoint";case 4:return"OneNote";case 5:return"Visio";default:return"Unknown"}},li=b=>{switch(b){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";default:return"Unknown"}};class Tn{constructor(){this.W=null;this.fz=()=>{y.AFrameworkApplication.J.$("WACSafeLinksIsEnabled")&&(this.W.register(yk,"Common.App.SafeLinks.SafeLinksManager").as(65).ha().Sd(()=>new yk(y.AFrameworkApplication.J,y.AFrameworkApplication.Ee,String.format("{0}-{1}",Kl(y.AFrameworkApplication.ua.Ib.Uk),
li(y.AFrameworkApplication.ua.Ib.rma)),!1,this.W.Ra(4),y.AFrameworkApplication.ua.Vr)),this.W.Oa(65))}}get name(){return"Common.App.SafeLinks"}uc(b){this.W=b}init(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.Uo(this.fz)}dispose(){}static main(){K.a.instance.Lc(new Tn)}}Object(u.a)(Tn,"SafeLinksPackage",null,[0,1]);var Uk=d(220);class zk{constructor(b){this.sa=new Td.a;this.hi=b}Plb(b){this.sa.addHandler(zk.PDa,b)}akd(b){this.sa.removeHandler(zk.PDa,b)}kTa(b){this.sa.addHandler(zk.b0a,b)}$Yb(b){this.sa.removeHandler(zk.b0a,
b)}nff(b){this.sa.addHandler(zk.ozc,b)}cCg(){this.sa.raiseEvent(zk.PDa)}wRf(){return Uk.a.instance.sXa(y.AFrameworkApplication.Hz)}}zk.PDa="SE";zk.Dmd="SEP";zk.b0a="SER";zk.ozc="TRP";Object(u.a)(zk,"NullSessionExpirationManager",null,[726,727]);class Ik{constructor(){this.MOc=this.Fkb=!1;this.hsc=()=>{Uk.a.instance.uCj(this.hsc);v.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.LQf()};this.Zed=()=>{Uk.a.instance.ryo(this.Zed);this.MOc||this.Fkb||(v.ULS.sendTraceTag(20492680,217,50,
"SessionExpiringDetected - Showing expiring dialog."),this.MOc=!0,this.MCg())};const b=y.AFrameworkApplication.Hz;0>=b||(this.Hz=b,v.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.Hz,["NowGetTime"]:(new Date).getTime(),["BootTime"]:y.AFrameworkApplication.xT}),Uk.a.instance.WOh(this.hsc),Uk.a.instance.VOh(this.Zed))}LQf(){this.Fkb||(y.AFrameworkApplication.iS(fk.a.Cmd),this.Fkb=!0,this.Wye())}}Object(u.a)(Ik,"ASessionExpirationManager",null,
[]);var ig=d(169),ul=d(536);class pe{constructor(b,h,r,A){this.sHg="";this.uvd=b;this.TCh=r;this.PCh=A;this.gnh=h;b=(new Date(this.uvd)).format(y.AFrameworkApplication.oQj);this.sHg=this.gnh?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,b)}awc(b){1===b?this.TCh&&this.TCh(this.gnh):0===b&&y.AFrameworkApplication.va.Pb(Ka.a.close,2,ul.g)}dispose(){this.PCh&&this.PCh()}}pe.id="SessionExpirationDialog";Object(u.a)(pe,"SessionExpirationDialogSharedProperties",
null,[]);class Ln{}Ln.kh="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";Object(u.a)(Ln,"SessionExpirationDialogHtml",null,[]);class $h extends ig.a{constructor(b,h,r,A){super(h);const M={};this.G4a=new pe(b,h,r,A);this.Ng=pe.id;y.AFrameworkApplication.VYh?(this.Fd=1,this.Qe(0,CommonUIStrings.l_DialogClose)):(this.Fd=0,this.Bu=!1);h||1===y.AFrameworkApplication.ua.mode?this.Qe(1,CommonUIStrings.l_SessionExpirationRefreshButton):
this.Qe(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.kh=Ln.kh;M.WACSessionExpirationText=this.G4a.sHg;this.mi(CommonUIStrings.l_DefaultDialogTitle,Object(E.a)(this,this.awc,"sessionExpirationDialogHandler"),M);this.t8(this.Bj("WACSessionExpirationText"))}awc(b){this.G4a.awc(b)}SRf(){this.hide()}dispose(){super.dispose();this.G4a&&this.G4a.dispose()}}Object(u.a)($h,"LegacySessionExpirationDialog",ig.a,[820]);class ll extends ni.StandardDialog{constructor(b,h,r,A){super(h);this.G4a=
new pe(b,h,r,A);this.Ng=pe.id;y.AFrameworkApplication.VYh?(this.Fd=1,this.Qe(0,CommonUIStrings.l_DialogClose)):(this.Fd=0,this.Bu=!1);h||1===y.AFrameworkApplication.ua.mode?this.Qe(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Qe(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Ex(CommonUIStrings.l_DefaultDialogTitle,this.G4a.sHg,0,Object(E.a)(this,this.awc,"sessionExpirationDialogHandler"))}awc(b){this.G4a.awc(b)}SRf(){this.hide()}dispose(){super.dispose();this.G4a&&this.G4a.dispose()}}
Object(u.a)(ll,"SessionExpirationDialog",ni.StandardDialog,[820]);const zf=(b,h,r,A)=>y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.cH&&y.AFrameworkApplication.J.$("ReactStandardSessionExpirationDialogIsEnabled")?new ll(b,h,r,A):new $h(b,h,r,A);var af=d(197);class Eg extends Ik{constructor(b){super();this.bMd=this.W$b=!0;this.K1=null;this.sa=new Td.a;this.sgc=()=>{this.K1=null};this.bwc=h=>{(h||this.hi.DSd())&&this.hi.j8(null)};this.hi=b}Plb(b){this.sa.addHandler(Eg.PDa,b)}akd(b){this.sa.removeHandler(Eg.PDa,
b)}kTa(b){this.sa.addHandler(Eg.b0a,b)}$Yb(b){this.sa.removeHandler(Eg.b0a,b)}nff(b){this.sa.addHandler(Eg.ozc,b)}wRf(){return Uk.a.instance.sXa(y.AFrameworkApplication.Hz)}cCg(b){this.W$b=b}MCg(){this.K1||af.a.UO||(this.bMd&&(this.K1=zf(this.Hz,!1,this.bwc,this.sgc)),this.sa.raiseEvent(Eg.Dmd))}Wye(){this.K1&&(this.K1.Wla&&this.K1.SRf(),this.K1=null);this.W$b&&(this.K1=zf(this.Hz,!0,this.bwc,this.sgc));this.sa.raiseEvent(Eg.PDa)}}Eg.PDa="SE";Eg.Dmd="SEP";Eg.b0a="SER";Eg.ozc="TRP";Object(u.a)(Eg,
"SessionExpirationManager",Ik,[726,727]);class Ag{}Ag.cRk="Aborting";Ag.XPd="ActivityDuration";Ag.error="Error";Ag.BAf="Errors";Ag.MB="Failed";Ag.mOb="FirstActivity";Ag.initialized="Initialized";Ag.x3i="KickedOut";Ag.Etn="LastActivity";Ag.HFj="RetryOverride";Ag.Ste="RequestGroups";Ag.cxb="Requests";Ag.fue="Responses";Ag.Sve="SessionDuration";Ag.status="Status";Ag.success="Success";Ag.Obp="Successful";Ag.tokens="Tokens";Ag.Zjg="PollingDuration";Object(u.a)(Ag,"SessionExpirationStrings",null,[]);class nb{constructor(b){this.GD=
{};this.poa={};this.N3a={};this.e9i=15;this.gph=!1;this.rKk=new Date;this.SEd=new Date;this.Xak=()=>{v.ULS.sendTraceTag(41964821,217,50,v.ULS.S$c({["Aggregate"]:this.poa,["Current"]:this.GD}))};this.Gb=b;this.CQ=new xc.a(2,2,6E4*this.e9i,this.Xak,135,"SL",!1);this.Gb.Zb(this.CQ);this.M4m()}M4m(){this.poa[Ag.Ste]=0;this.poa[Ag.cxb]=0;this.poa[Ag.fue]=0;this.poa[Ag.status]=Ag.initialized;this.poa[Ag.mOb]=new Date;this.poa[Ag.Sve]=0;this.poa[Ag.XPd]=0;this.poa[Ag.Sve]=0;this.GD[Ag.Sve]=0;this.poa[Ag.XPd]=
0;this.GD[Ag.XPd]=0}get S9n(){this.N3a[Ag.Zjg]=+new Date-+this.N3a[Ag.mOb];return this.N3a}yTf(b,h){var r=b[h];r=r?r:0;r++;b[h]=r;this.Lyg(b)}Lyg(b){const h=new Date;b[Ag.XPd]=+h-+this.SEd;this.SEd=h;b[Ag.Sve]=+this.SEd-+this.rKk;b[Ag.Etn]=this.SEd}oca(b,h){this.GD[b]=h;this.Lyg(this.GD)}cyg(b,h){this.GD[b]=h;this.Lyg(this.GD)}dmc(b){this.yTf(this.GD,b);this.yTf(this.poa,b);this.yTf(this.N3a,b)}flush(){this.gph||(this.poa[Ag.status]=this.GD[Ag.status],this.Xak(this.CQ),this.Gb.X3(this.CQ,6E4*this.e9i))}DCo(){const b=
this.GD[Ag.status];b&&(this.poa[Ag.status]=b);this.GD={}}SCo(){this.N3a={};this.N3a[Ag.Zjg]=0;this.N3a[Ag.mOb]=new Date}stop(){v.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.gph=!0;this.Gb.uf(this.CQ)}}Object(u.a)(nb,"SessionLogger",null,[722]);class Nb{constructor(b,h){this.ZNd=b;this.QFa=h}get tokens(){return this.ZNd}get errors(){return this.QFa}}Object(u.a)(Nb,"TokenRefreshArgs",null,[743]);var ec=d(467);class Hc extends Sys.EventArgs{constructor(b,
h,r,A,M,aa,oa){super();this.N3a=b;this.I9n=h;this.Ste=A;this.MB=M;this.cxb=aa;this.fue=oa}}Object(u.a)(Hc,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);var Tc=d(24);class xd{constructor(b,h=null,r=null){this.MOc=this.Fkb=!1;this.bMd=this.W$b=!0;this.sa=new Td.a;this.POc=this.yJc=this.QJd=!1;this.GGb=null;this.wyh=10;this.kEd=!1;this.Koo=()=>{this.W4c(!1);return!Uk.a.instance.sXa(y.AFrameworkApplication.Hz)};this.VQk=(A,M)=>{Uk.a.instance.$ee?this.hsc(A,M):this.MXe?(this.yJc=!1,this.W4c(!1)):
(this.Fkb||v.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),this.hsc(A,M))};this.WQk=(A,M)=>{Uk.a.instance.Zee?this.Zed(A,M):(Tc.b(512247769,306,50,"Refreshing tokens since the user has network and session is expiring."),this.yJc=!1,this.W4c(!0))};this.tcf=(A,M)=>{Uk.a.instance.Zee?this.Zed(A,M):this.W4c(!0)};this.hsc=()=>{this.MXe||Uk.a.instance.uCj(this.hsc);v.ULS.sendTraceTag(39408094,217,50,"SessionExpiredDetected");this.LQf(Uk.a.instance.$ee)};this.pip=
()=>{const A=this.Hc.S9n;v.ULS.sendTraceTag(555255521,217,50,"{0}",H.c(A));this.sa.raiseEvent(xd.ozc,new Hc(A,A[Ag.Zjg],A[Ag.mOb],A[Ag.Ste],A[Ag.MB],A[Ag.cxb],A[Ag.fue]))};this.Tao=()=>{3E5<+new Date-+this.Dqh?(v.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.W4c(!1)):v.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")};this.P$e=b;this.MXe=y.AFrameworkApplication.Brn;this.Gb=Je.a.instance;v.ULS.sendTraceTag(39408093,
217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:y.AFrameworkApplication.Hz,["NowGetTime"]:(new Date).getTime(),["BootTime"]:y.AFrameworkApplication.xT});this.Hc=h||new nb(Je.a.instance);this.eja=r;Uk.a.instance.WOh(this.VQk);Uk.a.instance.VOh(this.tcf);ec.SessionStatusManager.instance.mff(this.tcf);ec.SessionStatusManager.instance.U_k(this.Tao);this.Dqh=new Date;y.AFrameworkApplication.Arn&&(Uk.a.instance.Emf=this.Koo);b=!1;y.AFrameworkApplication.J&&(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",
!1),this.wyh=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),b=y.AFrameworkApplication.J.$("WopiTokenRefreshWhenNetworkResumed"));b?ec.SessionStatusManager.instance.mff(this.WQk):ec.SessionStatusManager.instance.mff(this.tcf)}Plb(b){this.sa.addHandler(xd.PDa,b)}akd(b){this.sa.removeHandler(xd.PDa,b)}kTa(b){this.sa.addHandler(xd.b0a,
b)}$Yb(b){this.sa.removeHandler(xd.b0a,b)}nff(b){this.sa.addHandler(xd.ozc,b)}wRf(){return Uk.a.instance.sXa(y.AFrameworkApplication.Hz)}W4c(b){if(!this.QJd&&!this.yJc)if(this.eja&&this.eja.Do)this.POc=!0,this.Hc.oca(Ag.status,Ag.x3i),this.Hc.flush(),this.Hc.stop();else if(v.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",b,this.POc),this.POc)this.Wye();else{this.Hc.flush();this.Hc.DCo();this.Hc.dmc(Ag.Ste);this.QJd=!0;this.kEd||(this.Hc.SCo(),this.kEd=!0,this.kBl());
const h=this.P$e.cpo(b);h.continueWith(()=>{if(this.P$e.gfo(h))this.Hc.dmc(Ag.Obp),this.Hc.oca(Ag.status,Ag.success),this.bMd=!1,this.MXe&&(this.W$b=!1),this.yJc=!1,this.Dqh=new Date,this.vap(),this.sa.raiseEvent(xd.b0a,new Nb(h.result.tokens,null));else{const r=h.result.errors;this.Hc.dmc(Ag.MB);this.Hc.oca(Ag.status,Ag.MB);b||(this.POc=this.P$e.B9c(r));this.POc&&(this.Hc.oca(Ag.cRk,JSON.stringify(r)),v.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.yJc=!0;this.sa.raiseEvent(xd.b0a,
new Nb(null,r))}this.Hc.flush();this.QJd=!1})}}Zed(){this.MOc||this.Fkb||(v.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.MOc=!0,this.MCg(Uk.a.instance.Zee))}LQf(b){if(!this.Fkb){var h=b?fk.a.BNo:fk.a.Cmd;const r=Object.assign(new bb.a,{extendedProperties:new Map});r.extendedProperties.set("ErrorCode",String.format("{0}",h));y.AFrameworkApplication.iS(h,void 0,["SessionExpired"],r);b||(b=new Date,h=new Date(y.AFrameworkApplication.xT),v.ULS.sendTraceTag(51642974,
217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",h,b,+b-+h),864E5>+b-+h&&Ba.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],!0,!0,!1,!0,r),2592E5>+b-+h&&Ba.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,r));this.Fkb=!0;this.Wye()}}vap(){this.kEd&&(this.Gb.uf(this.GGb),this.kEd=!1)}kBl(){this.GGb=new xc.a(2,2,1E3*this.wyh,this.pip,135);this.Gb.Zb(this.GGb)}}xd.PDa="SE";
xd.Dmd="SEP";xd.b0a="SER";xd.ozc="TRP";Object(u.a)(xd,"ASessionExpirationManagerWithRefresh",null,[]);class ld extends xd{constructor(b,h,r=null,A=null){super(h,r,A);this.K1=null;this.sgc=()=>{this.K1=null};this.bwc=M=>{(M||this.hi.DSd())&&this.hi.j8(null)};this.hi=b}cCg(b){this.W$b=b}MCg(b){if(!this.K1&&!af.a.UO){if(b)this.K1=zf(y.AFrameworkApplication.DNa,!1,this.bwc,this.sgc);else if(this.bMd){if(this.QJd)return;this.K1=zf(y.AFrameworkApplication.Hz,!1,this.bwc,this.sgc)}v.ULS.sendTraceTag(39408096,
217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",xd.Dmd,b);this.sa.raiseEvent(xd.Dmd)}}Wye(){this.K1&&(this.K1.Wla&&this.K1.SRf(),this.K1=null);if(this.W$b){this.Hc.stop();if(this.eja&&this.eja.Do)return;this.K1=zf(y.AFrameworkApplication.Hz,!0,this.bwc,this.sgc)}v.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",xd.PDa);this.sa.raiseEvent(xd.PDa)}}Object(u.a)(ld,"SessionExpirationManagerWithRefresh",xd,[726,727]);class Ed{constructor(b,h,r=null,A=null){this.oIh=!1;this._instance=null;
this._frame=b;this.ap=h;this.Hc=r||new nb(Je.a.instance);this.eja=A}create(){this.oIh=y.AFrameworkApplication.Eab;if(!this.oIh)return new Eg(this._frame);v.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");if(!this._instance)switch(y.AFrameworkApplication.yDp){case 1:v.ULS.sendTraceTag(39408090,217,50,"Creating new NullSessionExpirationManager");this._instance=new zk(this._frame);break;case 2:v.ULS.sendTraceTag(39408091,217,50,"Creating new SessionExpirationManagerWithRefresh");
this._instance=new ld(this._frame,this.ap,this.Hc,this.eja);break;default:v.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this._instance=new Eg(this._frame)}v.ULS.sendTraceTag(39408089,217,50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this._instance).getName());return this._instance}}Object(u.a)(Ed,"SessionExpirationManagerFactory",null,[725]);class Zd{}Object(u.a)(Zd,"Error",null,[]);class If{}Object(u.a)(If,"NamedResult",null,[]);class qg extends If{}
Object(u.a)(qg,"ErrorInfo",If,[]);var ch=d(1049);class mk{constructor(b,h,r,A=null,M=!1,aa=null,oa=!1,Ja=!1,fb=!1,Cb=!1,Gb=!1){this.RGa=0;this.gja=this.fp=null;this.ZNd=new ib.a;this.QFa=new ib.a;this.Nq=null;this.hJc=!1;this.cQc=this.dQc=null;this.XBo=()=>{this.pEj()};this.Gb=b;this.Byh=h;this.Byh.execute(Sb=>{Sb.sD(C.a.tSf,Object(E.a)(this,this.UVn,"onHostResponseReceived"))});this.I5=r;this.UGh=new ch.a("WebServiceCall","TokenRefresh");this.Hc=A||new nb(b);this.jKk=M;this.tf=aa?aa:ec.SessionStatusManager.instance;
this.efh=oa;this.Tzd=Ja;this.EKk=fb;this.FKk=Cb;this.pDh=Gb}UVn(b){if(b.MessageId!==C.a.tSf)Tc.b(39408099,306,15,"Unexpected message.");else{var h=new ib.a,r=new ib.a;this.Hc.dmc(Ag.fue);var A=b.Values[F.a.BKj];if(!A||0>=A.length)Tc.b(40122317,306,15,"Found no tokens in the dictionary"),A=b.Values;Tc.b(40122318,306,100,"The Tokens array contains {0} tokens",A.length);this.Hc.oca("Correlation",b.CorrelationId);var M="";for(let Ja=0;Ja<A.length;Ja++){this.Hc.cyg(Ag.tokens,A.length);var aa=A[Ja],oa=
aa;if(!oa||!oa.Name)continue;this.Hc.dmc(oa.Name);const fb=aa;if(fb&&fb.Value)Tc.b(39408128,306,100,"Received token with name: {0}",fb.Name),h.add(fb),this.ZNd.add(fb),this.Tzd||this.Hc.oca(Ag.status,Ag.success),this.efh&&this.tf&&this.tf.iDo();else if(aa=this.UGm(aa),Tc.b(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",oa.Name,JSON.stringify(aa),this.gja),r.add(aa),this.Tzd||(this.QFa.add(aa),M=JSON.stringify(aa),this.Hc.oca(Ag.error,JSON.stringify(aa)),
this.Hc.oca(Ag.status,Ag.MB)),this.efh)for(const Cb of aa.Errors)oa=this.Kom(Cb),this.tf&&this.tf.bYk(oa)}this.Tzd?(0<r.count?this.cQc?this.cQc(new Nb(h,r)):Tc.b(512267295,306,15,"Received errors but the promise has completed"):this.dQc?this.dQc(new Nb(h,r)):Tc.b(512267294,306,15,"Received valid tokens but the promise has completed"),Tc.b(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",h.count,r.count,b.CorrelationId,this.gja)):(0<r.count&&""!==
M?(A=Object.assign(new bb.a,{extendedProperties:new Map}),A.extendedProperties.set("Errors",M),A.extendedProperties.set("RetryCount",this.RGa.toString()),A.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),A.extendedProperties.set("IsTokenExpiring",this.hJc.toString()),this.n_f()&&A.extendedProperties.set("IsAppShuttingDown",y.AFrameworkApplication.Sl.toString()),Ba.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,A)):Ba.Health.instance.recordKpiSuccess("WACTokenRefresh",
null),Tc.b(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",h.count,r.count,b.CorrelationId,this.gja),0<r.count&&!this.B9c(r)?(b=this.I5.vEi(r),b!==this.I5.evc&&(this.Hc.cyg(Ag.HFj,b),this.Gb.X3(this.fp,b))):(this.Hc.flush(),this.fp&&(Tc.b(39408131,306,100,"Deleting task {0} from task manager",this.fp.name),this.Gb.uf(this.fp)),this.Nq&&!this.Nq.task.isCompleted?this.Nq.hg(new Nb(h,r)):Tc.b(512267293,306,15,"Received results but the task has completed")))}}UGm(b){if(!b)return null;
const h=Object.assign(new qg,{Name:b.Name,Errors:[],SPCorrelationId:b.SPCorrelationId});for(const r of b.Errors)b=new Zd,b.Id=r.Id,b.Details=ka.a.jQb(r.Details,500),h.Errors.push(b);return h}pEj(){y.AFrameworkApplication.vd("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.RGa>=this.I5.Gie?(Tc.b(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.gja),this.hDl(this.Nq)):(Ba.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.IJj())}IJj(){const b=
{};b[F.a.BKj]=this.I5.tokens;this.EKk&&(b[F.a.GNo]=this.FKk);const h=kb.a.create().toString();Tc.b(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.I5.tokens),this.RGa+1,h,this.gja);this.Byh.execute(r=>{r.sendMessage(C.a.bhf,b,h)});this.RGa++;this.Hc.dmc(Ag.cxb)}hDl(b){const h=new ib.a;for(let r=0;r<this.I5.tokens.length;r++){const A=Object.assign(new qg,{Name:this.I5.tokens[r],Errors:[Object.assign(new Zd,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});
h.add(A);this.QFa.add(A)}this.Gb.uf(this.fp);this.Hc.oca(Ag.BAf,JSON.stringify(this.QFa));this.Hc.oca(Ag.status,Ag.MB);b&&!b.task.isCompleted&&b.hg(new Nb(new ib.a,this.QFa))}n_f(){return y.AFrameworkApplication.J&&y.AFrameworkApplication.J.isChangeGateEnabled("SkipSessionExpiredVetoForShutdown")}cpo(b){y.AFrameworkApplication.vd("ej4if276;fheca743");y.AFrameworkApplication.vd("5d4fi128;abe10395");this.UGh.start();this.n_f()&&this.Gb.wrb&&(Tc.b(508351137,306,15,"Restarting taskmanager, is shutting down {0}",
y.AFrameworkApplication.Sl),this.Gb.restart());this.hJc=b;this.gja=kb.a.create().toString();Tc.b(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.gja,this.hJc);this.RGa=0;this.QFa.clear();this.ZNd.clear();this.Nq=new Yh.a;this.Tzd?this.qEj(this.I5.Gie).then(h=>{this.Nq&&!this.Nq.task.isCompleted&&this.Nq.hg(h);this.cQc=this.dQc=null;this.Hc.oca(Ag.BAf,JSON.stringify(this.QFa));this.Hc.oca(Ag.status,Ag.success);this.Hc.flush()}).catch(h=>{this.Nq&&!this.Nq.task.isCompleted&&
this.Nq.hg(Object(ya.a)(743,h));this.cQc=this.dQc=null;this.Hc.oca(Ag.BAf,JSON.stringify(this.QFa));this.Hc.oca(Ag.status,Ag.MB);this.Hc.flush()}):(this.fp=new xc.a(this.I5.priority,2,this.I5.evc,this.XBo,98,C.a.bhf,!0),this.jKk&&this.pEj(),this.Gb.Zb(this.fp));return this.Nq.task}qEj(b){const h=this,r=new Promise((Ja,fb)=>{h.dQc=Ja;h.cQc=fb;Ba.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);h.IJj()}),A=this,M=new Promise((Ja,fb)=>{window.setTimeout(()=>{fb(A.E8h("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},
A.I5.evc)});let aa=b;const oa=this;return new Promise((Ja,fb)=>{aa--;Promise.race([r,M]).then(Cb=>{Ba.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Ja(Cb)}).catch(Cb=>{var Gb=oa.I5.evc;if(Object(Xa.a)(743,Cb)&&(Cb=Object(ya.a)(743,Cb),0<Cb.errors.count)){oa.Yzn(Cb.errors);oa.NLh(Cb.errors);if(oa.B9c(Cb.errors)){fb(Cb);return}const Sb=oa.I5.vEi(Cb.errors);Sb!==oa.I5.evc?(oa.Hc.cyg(Ag.HFj,Sb),Gb=Sb):oa.Zpn(Cb.errors)&&(Gb=0)}aa?window.setTimeout(()=>{oa.qEj(aa).then(Ja).catch(fb)},Gb):(Gb=
oa.E8h("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),oa.NLh(Gb.errors),fb(Gb),Tc.b(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",oa.gja))})})}NLh(b){for(const h of b)this.QFa.add(h)}Zpn(b){if(!b.count)return!1;b=b.K(b.count-1);return b.Errors.length?"TIMEOUT"==b.Errors[0].Id:!1}E8h(b,h){const r=new ib.a;for(let A=0;A<this.I5.tokens.length;A++){const M=this.iDl(this.I5.tokens[A],b,h);r.add(M)}return new Nb(new ib.a,
r)}iDl(b,h,r){return Object.assign(new qg,{Name:b,Errors:[Object.assign(new Zd,{Id:h,Details:r})]})}Yzn(b){if(b.count){b=b.K(b.count-1);b=JSON.stringify(b);var h=Object.assign(new bb.a,{extendedProperties:new Map});h.extendedProperties.set("Errors",b);h.extendedProperties.set("RetryCount",this.RGa.toString());h.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());h.extendedProperties.set("IsTokenExpiring",this.hJc.toString());this.n_f()&&h.extendedProperties.set("IsAppShuttingDown",
y.AFrameworkApplication.Sl.toString());Ba.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,h);this.Hc.oca(Ag.error,b);this.Hc.oca(Ag.status,Ag.MB)}}gfo(b){this.UGh.stop();const h=this.aWm(b.result.errors);v.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!h,this.gja,this.hJc,this.RGa,this.QFa.count,0<b.result.errors.count?
b.result.errors.K(0).Name:"",0<b.result.errors.count&&0<b.result.errors.K(0).Errors.length?b.result.errors.K(0).Errors[0].Id:"",0<b.result.errors.count&&0<b.result.errors.K(0).Errors.length?b.result.errors.K(0).Errors[0].Details:"");return h?!1:this.ffo(b.result.tokens)}B9c(b){return this.I5.B9c(b)}ffo(b){for(let h=0;h<b.count;h++){const r=b.K(h);if(r.Name===F.a.accessToken){const A=(new Date).getTime();r.Expiry>y.AFrameworkApplication.Hz?(v.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",
{["AccessTokenTtl"]:r.Expiry,["NowGetTime"]:A,["BootTime"]:y.AFrameworkApplication.xT},"PreviousAccessTokenTtl",y.AFrameworkApplication.Hz),y.AFrameworkApplication.accessToken=r.Value,y.AFrameworkApplication.Hz=Math.floor(r.Expiry),y.AFrameworkApplication.SNg=A,y.AFrameworkApplication.bTa=Math.floor(r.Expiry)):v.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:r.Expiry,["NowGetTime"]:A,["BootTime"]:y.AFrameworkApplication.xT},
"PreviousAccessTokenTtl",y.AFrameworkApplication.Hz)}}return!0}aWm(b){let h=!1;for(let r=0;r<b.count;r++){h=!0;const A=b.K(r);v.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2}, SPCorrelationId: {3}",A.Name,JSON.stringify(A.Errors),this.gja,A.SPCorrelationId)}return h}P1i(b){return b.includes("aadInteractionRequired")||b.includes("sessionRevocation")||b.includes("blockAccessForTenantRestrictions")||b.includes("revoked")||b.includes("Due to organizational policies, you can't access these resources from this network location")?
!0:!1}Kom(b){let h=fk.a.Cmd;const r=parseInt(b.Id);b=b.Details.toString();if(isNaN(r))h=fk.a.X$j;else{switch(r){case 401:h=fk.a.EFe;this.pDh&&this.P1i(b)&&(h=fk.a.Gtd);break;case 403:h=fk.a.V$j;this.pDh&&this.P1i(b)&&(h=fk.a.Gtd);break;case 500:h=fk.a.W$j;break;case 503:h=fk.a.Z$j}h===fk.a.Cmd&&(h=500<r?fk.a.Y$j:fk.a.U$j)}return h}}Object(u.a)(mk,"TokenRefreshManager",null,[724]);class qj{constructor(){this.evc=y.AFrameworkApplication.BDp;this.Gie=y.AFrameworkApplication.zDp;this.tokens=y.AFrameworkApplication.aQm();
this.priority=y.AFrameworkApplication.CDp;this.aBh=this.OUo();this.$bf=y.AFrameworkApplication.$Pm()}B9c(b){b=JSON.stringify(b);if(this.$bf&&0<this.$bf.length)for(const h of this.$bf)if(0<h.length&&0<=b.indexOf(h))return!0;return!1}vEi(b){try{if(b)for(const h of b)if(h.Errors)for(const r of h.Errors)if(r.Id in this.aBh)return Number.parseInvariant(this.aBh[r.Id].toString())}catch(h){v.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",h.toString())}return this.evc}OUo(){const b=
{};try{if(!y.AFrameworkApplication.d9d()||0>=y.AFrameworkApplication.d9d().length||""===y.AFrameworkApplication.d9d()[0])return b;for(const h of y.AFrameworkApplication.d9d())0<h.length&&(b[h]=y.AFrameworkApplication.ADp)}catch(h){v.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",h.toString())}return b}}Object(u.a)(qj,"TokenRefreshPolicy",null,[723]);class ne{constructor(){this.W=null}get name(){return"Common.App.SessionExpiration"}init(){y.AFrameworkApplication.J.Uo(()=>
{this.j$a()})}j$a(){this.W.resolve(807);this.W.resolve(720);this.W.resolve(680)}dispose(){}uc(b){this.W=b;b.register(722,809).ha().Sd(()=>new nb(Je.a.instance));b.register(723,808).ha().Sd(()=>new qj);b.register(724,810).ha().Sd(()=>new mk(Je.a.instance,y.AFrameworkApplication.qN(),b.resolve(808),b.resolve(809),y.AFrameworkApplication.J.$("WopiTokenRefreshSendTokenRequestWithoutTasks"),b.Oa(117),y.AFrameworkApplication.J.$("WopiAllowTokenRefreshErrorTracking"),y.AFrameworkApplication.J.$("WopiTokenRefreshSyncMessageWithTimeout"),
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldAddAllowAADPopupInPostMessage",!1),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldAllowAADPopupForTokenRefresh",!1),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RevokedTokenExperiment",!1)&&y.AFrameworkApplication.J.$("ShowTokenRevocationErrorMessage")));b.register(725,807).ha().Sd(()=>new Ed(y.AFrameworkApplication.ua,b.resolve(810),b.resolve(809),
b.Oa(117)));b.register(726,680).ha().Sd(()=>b.resolve(807).create());b.register(727,720).ha().Sd(()=>b.resolve(680))}static main(){K.a.instance.Lc(new ne)}}Object(u.a)(ne,"SessionExpirationPackage",null,[0,1]);var Se=d(756),aj=d(411),te=d(339),hk=d(207);class ak extends hk.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(u.a)(ak,"PersonaButtonProps",hk.a,[]);class lj{rfc(b,h){if(b&&!(1>b.length)&&h){var r=Object.assign(new te.a,{ExternalId:"msPresenceOuter",
ControlList:[]});this.yDl(b,r.ControlList);h.push(r)}}yDl(b,h){const r=Object.assign(new Se.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new aj.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(h,r);h=Object.assign(new te.a,{Title:"",ControlList:[]});Array.add(r.Menu.MenuSectionList,h);this.yGl(b,h.ControlList)}yGl(b,h){for(let r=0;r<b.length;r++){const A=Object.assign(new ak,{ExternalId:String.format("CoauthorPersona_{0}",
r),Command:"336231556",DisplayName:b[r].userName,LabelText:b[r].userName,ImageBackColor:b[r].color,PersonaId:b[r].email,IsAnonymous:b[r].isAnonymous});Array.add(h,A)}}}Object(u.a)(lj,"PresenceContextMenuSectionBuilder",null,[826]);var bm=d(103);class Oa{constructor(b,h,r,A){this.swa=this.Qt=this.fp=this.zi=this.JPa=null;this.s9k=()=>{this.gMd.WTh()};this.Lra=M=>{1===M?(Jl.a.dpe(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),y.AFrameworkApplication.va.Ob(Ka.a.m2f,2)):
(this.U2o(),y.AFrameworkApplication.va.Ob(Ka.a.tZh,2))};this.Kfl=()=>{this.$Rl();y.AFrameworkApplication.va.Ob(Ka.a.sZh,2)};this.gMd=b;this.BLk=A;this.gMd.K7c&&(this.fp=new xc.a(3,2,5E3,this.s9k,2),y.AFrameworkApplication.oc.Zb(this.fp),this.Xb(h,r));this.gMd.NYk(()=>{this.TVb()});this.gMd.PNh(()=>{this.UVb()})}get NQ(){return this.Qt||(this.Qt=Za.a.instance.Oa(445))}get $Wh(){return this.swa||(this.swa=Za.a.instance.Oa(811))}Xb(b,h){const r=y.AFrameworkApplication.va;r.fb(Ka.a.XTh,we.a.frame,b,96);
r.fb(Ka.a.YTh,we.a.frame,h,96);r.qa(Ka.a.sZh,we.a.frame,ce.ActionManager.aU);r.qa(Ka.a.tZh,we.a.frame,ce.ActionManager.aU);r.qa(Ka.a.m2f,we.a.frame,ce.ActionManager.aU)}TVb(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);y.AFrameworkApplication.va.Ob(Ka.a.XTh,2)}UVb(){this.efp();y.AFrameworkApplication.va.Ob(Ka.a.YTh,2)}efp(){this.zi&&(this.zi.hide(),this.zi.dispose(),this.zi=null);this.JPa&&this.NQ&&(y.AFrameworkApplication.Sl||this.NQ.removeEntry(this.JPa),this.JPa.dispose(),this.JPa=
null)}showDialog(b){bm.a.vD(this.zi);this.zi=new ni.StandardDialog;this.BLk||(this.zi.Bu=!1,this.zi.Fd=0);this.zi.Qe(1,CommonUIStrings.l_SignIn);this.zi.jY(CommonUIStrings.l_DefaultDialogTitle,b,this.Lra)}U2o(){this.NQ&&this.$Wh&&(this.JPa=this.$Wh.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.JPa.closeable=!0,this.JPa.addButton(CommonUIStrings.l_SignIn,Oa.h6a,""),this.JPa.Pja=this.Kfl,this.NQ.Jz(this.JPa,!1))}$Rl(){this.fp&&(y.AFrameworkApplication.oc.uf(this.fp),
this.fp=null)}dispose(){this.fp=this.zi=this.JPa=null}static h6a(){Jl.a.dpe();y.AFrameworkApplication.va.Ob(Ka.a.m2f,2)}}Object(u.a)(Oa,"SignOutResponseUI",null,[10]);class kc{get name(){return"Common.App.UI"}uc(b){b.register(lj,"Common.App.UI.PresenceContextMenuSectionBuilder").as(1079).ha()}init(){}dispose(){bm.a.vD(kc.fya);kc.fya=null}static main(){K.a.instance.Lc(new kc)}static Y2m(b,h,r){kc.G2o()&&(kc.fya=new Oa(Jl.a.instance,b,h,r))}static G2o(){return y.AFrameworkApplication.Xje&&!y.AFrameworkApplication.Mfa}}
kc.fya=null;Object(u.a)(kc,"CommonAppUIPackage",null,[0,1]);class Oc{get name(){return"Common.App.DialogWithLinkToResource"}uc(){}init(){}dispose(){}static main(){K.a.instance.Lc(new Oc)}}Object(u.a)(Oc,"CommonAppDialogWithLinkToResourcePackage",null,[0,1]);var Cd=d(80);class Ve{constructor(b){this.Fz=b;this.vz=Array.indexOf(this.Fz,this.Jka)}dispose(){this.Fz=null}get zra(){return this.Fz[this.vz]}hA(b){this.Imd(b,!1);return!0}qic(b){this.Imd(b,!0)}Imd(b,h){b&&(this.zra!==b||h)&&(b.tabIndex=0,Cd.FocusManager.ON(b));
Array.contains(this.Fz,b)&&(this.vz=Array.indexOf(this.Fz,b))}get xtj(){let b=this.vz;do if(b)if(0<b&&b<this.Fz.length)b--;else break;else b=this.Fz.length-1;while(!Re.DOMFocusListing.N7a(this.Fz[b])&&b!==this.vz);return this.Fz[b]}get lfj(){let b=this.vz;do if(b===this.Fz.length-1)b=0;else if(0<=b&&b<this.Fz.length-1)b++;else break;while(!Re.DOMFocusListing.N7a(this.Fz[b])&&b!==this.vz);return this.Fz[b]}get Jka(){let b=0;for(;!Re.DOMFocusListing.N7a(this.Fz[b])&&b<this.Fz.length;)b++;return Re.DOMFocusListing.N7a(this.Fz[b])?
this.Fz[b]:null}get vpc(){let b=this.Fz.length-1;for(;!Re.DOMFocusListing.N7a(this.Fz[b])&&0<b;)b--;return Re.DOMFocusListing.N7a(this.Fz[b])?this.Fz[b]:null}}Object(u.a)(Ve,"DialogFocusListing",null,[92]);var Fd=d(79);class pa extends ni.StandardDialog{constructor(b,h,r,A=null){super();this.Tia=this.Sx=this.Whb=null;this.Fz=[];this.h0n=M=>{this.Sx&&(this.Sx.target="_blank",this.Sx.submit());M.preventDefault()};this.Ogi=()=>{v.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");
return!1};this.Mco=()=>{v.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Zm&&this.Zm.stop()};this.yId=h;this.gl=b;this.pwk=r;this.uLd=A;this.Zm=new ch.a("LoadResource","LoadPrintablePdf")}nJa(){this.Fd=5;this.width=40;const b=document.createElement("span");b.id=this.Bj("DirectPrintHeaderContent");const h=document.createElement("span");h.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(h,"DirectPrintHeader");this.Tia=document.createElement("iframe");
this.Tia.name="pdfObjectFrame";this.Tia.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.Tia.onload=this.Mco;if(this.uLd&&0<this.uLd.count){var r=$a.a.wLf(this.yId,this.uLd);const A=$a.a.krg(this.yId,this.uLd);this.Sx=document.createElement("form");this.Sx.id="printPreviewPostForm";this.Sx.method="POST";this.Sx.target=this.Tia.name;this.Sx.action=A;for(const M of r)r=document.createElement("input"),r.type="hidden",r.name=M.key,r.value=M.value,this.Sx.appendChild(r)}else this.Tia.setAttribute("src",
this.yId);Sys.UI.DomElement.addCssClass(this.Tia,af.a.cvh);this.pwk?(Sys.UI.DomElement.addCssClass(this.Tia,"DirectPrintPdfObjectHidden"),h.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,Ne.a.Gs(this.Tia,Ne.a.vA,Ne.a.fq)):(Sys.UI.DomElement.addCssClass(this.Tia,"DirectPrintPdfObject"),this.Fz.push(this.Tia));b.appendChild(h);b.appendChild(document.createElement("br"));b.appendChild(this.Tia);this.Sx&&b.appendChild(this.Sx);b.appendChild(document.createElement("br"));b.appendChild(this.ywl(this.Sx?
"#":this.yId));this.Zm.start();this.zub(CommonUIStrings.l_AppTitle,null,null,null,null,b);this.t8(this.Bj("DirectPrintHeaderContent"));this.Sx&&this.Sx.submit();this.ADl();v.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}ywl(b){const h=document.createElement("span");var r=document.createElement("span");r.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;h.appendChild(r);y.AFrameworkApplication.J&&(2===y.AFrameworkApplication.ua.Ib.Uk&&y.AFrameworkApplication.J.$("PPTDisableDirectPrintDialogDownloadPDFLink")||
1===y.AFrameworkApplication.ua.Ib.Uk&&y.AFrameworkApplication.J.$("XLODisableDirectPrintDialogOpenPDFLink"))?(b=document.createElement("span"),2===y.AFrameworkApplication.ua.Ib.Uk?b.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===y.AFrameworkApplication.ua.Ib.Uk&&(b.innerText=CommonUIStrings.l_InternalError_Directive,v.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.Whb=b,h.appendChild(document.createElement("br")),h.appendChild(b)):(r=
document.createElement("a"),r.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,r.href=b,r.target="_blank",r.id="PrintPDFLink",r.className="AllowBrowserClick",this.Whb=r,h.appendChild(document.createElement("br")),h.appendChild(r),this.Sx&&mf.a.addHandler(r,"click",this.h0n),this.gl.nb(Jd.a.click,this.Whb,this.Ogi,null));this.Fz.push(this.Whb);return h}ADl(){if(0<this.Fz.length){const b=new Ve(this.Fz),h=Cd.FocusManager.instance().au();h&&(this.Whb.focus(),h.Nk=b,h.NR=!0)}}obd(){v.ULS.sendTraceTag(21031114,
328,50,"Download PDF from Direct Print dialog button clicked")}dispose(){this.Whb&&(this.gl.xc(Jd.a.click,this.Whb,this.Ogi),this.Whb=null);Fd.a.wy(this.Tia);this.Tia=null;super.dispose()}}Object(u.a)(pa,"DirectPrintDialog",ni.StandardDialog,[798]);class Hb{constructor(b){this.gl=b}pnm(b,h,r=null){return new pa(this.gl,b,h,r)}}Object(u.a)(Hb,"DirectPrintDialogFactory",null,[775]);class Ob{constructor(b,h){this._url=b;this.rFk=h}Dfi(){this.rFk?Le.a.JVl(this._url):Le.a.un(this._url,"_blank",void 0,
"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(u.a)(Ob,"OpenUrlInTabDialogDownloadBehavior",null,[821,10]);class Dc extends ni.StandardDialog{constructor(b,h=!0,r=!1,A=null,M=null,aa=!1,oa=null){super();this.P6b=this.O6b=this.Sx=this.D5=null;this.YQn=Sb=>{this.qki(Sb);return!0};this.ZQn=Sb=>this.V$c(Sb,this.qki);this.qki=Sb=>{this.Sx&&this.Sx.submit();this.SNb(Sb.If)};this.Lra=Sb=>{1===Sb?(this.obd(),this.Sx?Dc.RN&&this.Twj():this.IPe.Dfi()):2===Sb&&(this.Ice?this.Z6h():this.Tce&&
this.FXl());this.dispose()};var Ja=this.OHg?this.OHg:CommonUIStrings.l_DefaultDialogTitle;Dc.ulc=aa;this.Onk=oa;this.IPe=A||new Ob(b,!0);const fb=[],Cb=[];Dc.RN&&(this.dRd&&this.dRd.forEach(Sb=>{Array.add(fb,Sb)}),this.mPh&&this.mPh.forEach(Sb=>{Array.add(Cb,Sb)}));h?r?this.Ice?(this.Fd=12,this.Qe(1,this.buttonText),this.Qe(2,CommonUIStrings.l_DownloadAsPdfDialog_CopyALinkButton),this.Qe(3,CommonUIStrings.l_DialogClose)):this.Tce?(this.Fd=12,this.Qe(1,this.buttonText),this.Qe(2,CommonUIStrings.l_DownloadACopyDialog_EmailALinkButton),
this.Qe(3,CommonUIStrings.l_DialogClose)):(this.Fd=4,this.Qe(1,this.buttonText),this.Qe(2,CommonUIStrings.l_DialogClose)):(this.Fd=6,this.Qe(0,CommonUIStrings.l_DialogClose)):this.Fd=5;aa=document.createElement("span");this.qXc&&(aa.className=this.qXc);A=document.createElement("a");A.innerText=this.Rpc;A.href=b;A.target="_blank";A.id=this.Rad;A.className=id.AFrame.zgf;if(oa=!Y.a.r7&&!!M&&0<M.count){const Sb=$a.a.wLf(b,M);M=$a.a.krg(b,M);A.href="#";A.target="_self";this.Sx=document.createElement("form");
this.Sx.id="printPreviewPostForm1";this.Sx.method="post";this.Sx.target="_blank";this.Sx.action=M;for(var Gb of Sb)M=document.createElement("input"),M.type="hidden",M.name=Gb.key,M.value=Gb.value,this.Sx.appendChild(M)}else this.Sx=null;this.Sx||Dc.ulc?Dc.ulc||Array.add(Cb,{["type"]:"AppLinkProps",["id"]:this.Rad,["text"]:this.Rpc,["onExecute"]:()=>{this.Twj()}}):Array.add(Cb,{["type"]:"AppLinkProps",["id"]:this.Rad,["text"]:this.Rpc,["handler"]:{["href"]:oa?"#":b,["target"]:oa?"_self":"_blank"}});
this.sbb&&Array.add(fb,this.sbb);r?(b=document.createElement("span"),b.innerText=this.sbb.replace("{0}",""),aa.appendChild(b)):this.tcj?(b=document.createElement("span"),b.id=this.Bj("message"),Gb=document.createElement("span"),M=document.createElement("span"),oa=this.sbb.split("{0}"),Gb.innerText=oa[0],M.innerText=oa[1],b.appendChild(Gb),b.appendChild(A),b.appendChild(M),aa.appendChild(b)):(b=document.createElement("span"),b.innerText=this.sbb,aa.appendChild(b),aa.appendChild(document.createElement("br")),
aa.appendChild(document.createElement("br")),aa.appendChild(A),Dc.ulc||Array.add(fb,"{0}"));this.Sx&&aa.appendChild(this.Sx);Dc.RN&&(this.Wtb&&(this.zad?this.QLh(this.Wtb,this.zad):(Array.add(fb,"{0}"),Array.add(Cb,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.Wtb,["onExecute"]:()=>{}}))),this.aQd(fb,Cb));this.zub(Ja,null,this.HSf,null,this.Lra,Dc.RN?null:aa);this.t8(this.Bj("message"));!Dc.RN&&this.zad&&this.Wtb&&(Ja=document.createElement("div"),Ja.className="WACDialogLearnMoreLinkContainer",
this.D5=document.createElement("a"),this.D5.innerText=this.Wtb,this.D5.href=this.zad,this.D5.target="_blank",this.D5.id=this.Bj("LearnMoreLinkId"),this.D5.className=id.AFrame.zgf,Ja.appendChild(this.D5),h?this.Oc.insertBefore(Ja,this.Oc.lastChild):this.Oc.appendChild(Ja),this.t8(String.format("{0} {1}",this.Bj("message"),this.Bj("LearnMoreLinkId"))));this.SFc=A;r?this.c4(this.jJ):this.c4(this.SFc);this.vhe();y.AFrameworkApplication.ua.S8.nb(Jd.a.click,this.SFc,Object(E.a)(this,this.Ngi,"downloadLinkClicked"),
null);this.D5&&y.AFrameworkApplication.ua.S8.nb(Jd.a.click,this.D5,Object(E.a)(this,this.$4i,"learnMoreLinkClicked"),null);this.RY=!1}get HSf(){return null}get OHg(){return null}get sbb(){return null}get GYh(){return this.Onk}get zad(){return null}get Wtb(){return null}get tcj(){return!1}get buttonText(){return CommonUIStrings.l_Open}get qXc(){return null}get dRd(){return null}get mPh(){return null}get Ice(){return!1}get Tce(){return!1}Z6h(){this.Aaa({SourceControlId:"CopyLink"},{ControlId:"CopyLink"})}FXl(){this.Aaa({SourceControlId:"Share"},
{ControlId:"Share"})}Aaa(b,h){const r=y.AFrameworkApplication.va;r.aE=8;r.Pb(Ka.a.Aaa,2,b,h)}Oqa(){this.Sx&&(this.O6b||(this.O6b=this.YQn,this.rr.nb(Jd.a.click,this.jJ,this.O6b)),this.P6b||(this.P6b=this.ZQn,this.oe.nb(Jd.a.pi,this.jJ,this.P6b)));super.Oqa()}obd(){}Ngi(){this.d5f();this.Sx?this.Sx.submit():this.IPe.Dfi();return!0}$4i(){return!1}dispose(){this.IPe.dispose();this.SFc&&(y.AFrameworkApplication.ua.S8.xc(Jd.a.click,this.SFc,Object(E.a)(this,this.Ngi,"downloadLinkClicked")),this.SFc=null);
this.D5&&(y.AFrameworkApplication.ua.S8.xc(Jd.a.click,this.D5,Object(E.a)(this,this.$4i,"learnMoreLinkClicked")),this.D5=null);this.rr&&this.O6b&&(this.rr.xc(Jd.a.click,this.jJ,this.O6b),this.O6b=null);this.oe&&this.P6b&&(this.oe.xc(Jd.a.pi,this.jJ,this.P6b),this.P6b=null);super.dispose()}Twj(){this.Sx&&(document.body.appendChild(this.Sx),this.Sx.submit(),document.body.removeChild(this.Sx))}static get RN(){return y.AFrameworkApplication.ua.Ib.cH&&y.AFrameworkApplication.ua.Ib.H_i}static get ulc(){return Dc.Njh}static set ulc(b){Dc.Njh=
b}}Dc.Njh=!1;Object(u.a)(Dc,"ADialogWithLinkToResource",ni.StandardDialog,[]);class nd extends Dc{constructor(b,h,r=null,A=!0,M=!1,aa=null){super(b,!0,!(nd.jAb&&A),new Ob(b,h),r,M,aa);nd.jAb=nd.jAb&&A;if(nd.jAb){h=document.createElement("iframe");A=null;M=this.$di;h.name="pdfObjectFrame";h.id="pdfObjectIFrame";if(r&&0<r.count){aa=$a.a.wLf(b,r);b=$a.a.krg(b,r);A=document.createElement("form");A.id="printPreviewPostForm";A.method="POST";A.target=h.name;A.action=b;for(const oa of aa)b=document.createElement("input"),
b.type="hidden",b.name=oa.key,b.value=oa.value,A.appendChild(b)}else h.src=b;M.appendChild(h);A&&(M.appendChild(A),A.submit());Sys.UI.DomElement.addCssClass(h,"DirectPrintPdfObjectHidden");Ne.a.Gs(h,Ne.a.vA,Ne.a.fq)}}get HSf(){return"Print_32x32x32"}get OHg(){return nd.jAb?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get sbb(){return nd.jAb?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get dRd(){const b=[];Array.add(b,CommonUIStrings.l_PrintDialogCanCloseDocument);if(Dc.ulc){let h=
CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==y.AFrameworkApplication.ua.Ib.Qai&&(h=y.AFrameworkApplication.ua.Ib.Qai);Array.add(b,h)}return nd.jAb?b:null}get Rpc(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get Rad(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get qXc(){return y.AFrameworkApplication.w7a?"UIFontDialogTextLarge":null}vhe(){v.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}d5f(){y.AFrameworkApplication.wn.f$a(9540);
v.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}obd(){v.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get jAb(){return!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.cH&&y.AFrameworkApplication.J.$("DirectPrintDialogAsStandardDialogIsEnabled")&&!(Y.a.r7||Y.a.Jt||Y.a.uj||Y.a.LR)&&!y.AFrameworkApplication.C$c&&y.AFrameworkApplication.J.$("ShouldHostDefaultToNativeBrowserPrintExperience")&&nd.sIh}static set jAb(b){nd.sIh=b}}nd.sIh=!1;Object(u.a)(nd,
"PrintDialogWithLinkToPdf",Dc,[]);class Od{constructor(b){this.isEnabled=Boolean.parse(b.DirectPrintIsEnabled||"false");this.imn=Boolean.parse(b.DirectPrintProbeIsEnabled||"false");this.zin=Boolean.parse(b.DirectPrintEnabledForInternetExplorer||"false");this.N0b=(b.DirectPrintSupportedMimeTypes||"").split(Od.Cwf);this.Yyb=(b.DirectPrintSupportedPlugins||"").split(Od.Cwf);this.Z0m=(b.DirectPrintImmersivePreviewPlugins||"").split(Od.Cwf);this.$Vi=Boolean.parse(b.DirectPrintEnabledForEdge||"false");
this.tcn=Boolean.parse(b.ChromePrintLayoutFixIsEnabled||"false");this.hol=parseInt(b.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.g8f=14;this.Dcj=14394;if(b=b.DirectPrintMinimalSupportedEdgeVersion){const h=b.split(".");2===h.length?(this.g8f=parseInt(h[0]),this.Dcj=parseInt(h[1])):v.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",b)}else v.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}
Od.Cwf=",";Object(u.a)(Od,"DirectPrintBrsSettings",null,[]);class ye{constructor(b,h){this.oFg=b;this.Yyb=h}}Object(u.a)(ye,"DirectPrintProbeResults",null,[]);var Oe=d(187);class Cf{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb){this.UOd=null;this.iEm=()=>{var Gb=this.VJm();const Sb=this.eio(),pc={},zc={};for(let Yc=0;Yc<this.$T.N0b.length;Yc++)pc[this.$T.N0b[Yc]]=Gb[Yc];for(Gb=0;Gb<this.$T.Yyb.length;Gb++)zc[this.$T.Yyb[Gb]]=Sb[Gb];return new ye(pc,zc)};this.srk=b;this.fLc=h;this.g0e=r;this.Ryk=A;this.aAk=
M;this.dNc=new Qf.a(this.iEm);this.wFc=aa;this.Hrh=fb;this.kW=oa;this.fJc=Ja;this.wAk=Cb}get $T(){return this.srk}start(){}jdo(){this.$T.imn&&this.cCn()}dio(){const b=Array(this.$T.N0b.length);if(void 0!==this.fLc&&null!==this.fLc)for(let h=0;h<this.$T.N0b.length;h++)b[h]=this.$T.N0b[h]in this.fLc&&this.Ryk(this.fLc[this.$T.N0b[h]]);return b}eio(){const b=Array(this.$T.Yyb.length),h=!(void 0===this.g0e||null===this.g0e);for(let r=0;r<this.$T.Yyb.length;r++){const A=this.$T.Yyb[r];b[r]=h&&A in this.g0e?
!0:this.aAk(A)}return b}VJm(){const b=this.dio(),h=Array(b.length);for(let r=0;r<b.length;r++)h[r]=b[r]?this.T2l(this.fLc[this.$T.N0b[r]]):null;return h}T2l(b){if(void 0===b||null===b)return null;b=b.enabledPlugin;return void 0===b||null===b?null:b.name}cCn(){v.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.dNc.value.oFg,this.dNc.value.Yyb)}y2o(){return this.wAk||!this.$T.isEnabled||y.AFrameworkApplication.C$c?!1:this.Ybp()}E2o(){if(null!=this.UOd)return this.UOd;const b=Cf.ZVi(this.$T);
return this.UOd=this.$T.$Vi&&b||this.rcn()}rcn(){return Y.a.Pr&&this.$T.tcn&&Y.a.gol>=this.$T.hol?!0:!1}Ybp(){if(!this.fJc(this.$T))return!1;var b=qb.a.H9a(this.dNc.value.oFg);for(const h of b)if(void 0!==h&&null!==h)return!0;b=qb.a.H9a(this.dNc.value.Yyb);for(const h of b)if(h)return!0;return!1}lWm(){const b=qb.a.H9a(this.dNc.value.oFg);for(const h of b)if(Oe.a.contains(this.$T.Z0m,h))return!0;return!1}b5o(b,h=null){y.AFrameworkApplication.ua&&y.AFrameworkApplication.J.$("DirectPrintDialogAsStandardDialogIsEnabled")?
this.Hrh(b,h):this.y2o()?this.fTl(b,this.lWm()&&!0,h):this.Hrh(b,h)}fTl(b,h,r=null){const A=this.kW.Wf("UserAction","OpenDirectPrintDialog");this.wFc.pnm(b,h,r).nJa();A.stop()}static dpn(b){try{return new ActiveXObject(b),!0}catch(h){v.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",b)}return!1}static ufn(b){return void 0===b||null===b?!1:!(void 0===b.enabledPlugin||null===b.enabledPlugin)}static create(b){const h=new Od(y.AFrameworkApplication.J.appSettings);let r=
null;try{r=window.navigator.mimeTypes}catch(Cb){v.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let A=null;try{A=window.navigator.plugins}catch(Cb){v.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const M=Cf.ufn,aa=Cf.dpn;b=b.resolve(812);const oa=y.AFrameworkApplication.ua.Vr,Ja=Cf.epn,fb=!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.cH&&!y.AFrameworkApplication.J.$("PrintDialogFallbackLinkEnabled");return new Cf(h,r,A,M,
aa,b,oa,Ja,(Cb,Gb)=>new nd(Cb,!1,Gb,!0,fb),y.AFrameworkApplication.Mfa)}static epn(b){return Y.a.Pr||Y.a.Jt&&b.zin||b.$Vi&&Cf.ZVi(b)?!0:!1}static ZVi(b){var h=Y.a.Ogc;if(h){var r=h.split(".");if(2===r.length)return h=parseInt(r[0]),r=parseInt(r[1]),h>b.g8f||h===b.g8f&&r>=b.Dcj}return!1}}Object(u.a)(Cf,"DirectPrintManager",null,[742]);class Bg{constructor(){this.FCb=this.W=null}get name(){return"Common.App.DirectPrint"}uc(b){this.W=b;b.register(Hb,812).ha().Sd(()=>new Hb(y.AFrameworkApplication.ua.S8));
b.register(742,813).ha().Sd(()=>Cf.create(this.W))}init(){this.FCb=this.W.resolve(813);this.FCb.start()}dispose(){}}Object(u.a)(Bg,"PackageManager",null,[0,1]);class Zg{constructor(b,h=3E4){this.fIg=9E5;this.hIg=1E4;this.D$i=this.yqc=null;this.p6f=0;this.dob=Date.now;this.aMm=b;this.Seb=h;this.Y3d()}GHi(b=!0){const h=this.dob();if(h<this.p6f+this.fIg)return h>this.p6f+this.hIg&&this.Y3d(),this.D$i;b&&this.Y3d();return null}getToken(b=!0){return(b=this.GHi(b))?Promise.resolve(b):this.Y3d()}Y3d(){return this.yqc=
this.yqc||new Promise(b=>{this.aMm().then(h=>{this.yqc=null;""!==h&&h&&(this.D$i=h,this.p6f=this.dob(),b(h));b(null)}).catch(()=>{this.yqc=null;b(null)});window.setTimeout(()=>{this.yqc=null;b(null)},this.Seb)})}}Object(u.a)(Zg,"OAuthCacheManager",null,[]);var Qg=d(120),Sg=d(291);class Qk{constructor(){this.wba=null;this.mfh={};this.a0a=new Ha.a(Na.a.th())}getToken(b,h){if(this.a0a.lb(h))return this.a0a.K(h).getToken();const r=new Zg(()=>this.HHi(b,h));this.a0a.Z(h,r);return r.getToken()}$Lm(b,h){if(this.a0a.lb(h))return this.a0a.K(h).GHi();
const r=new Zg(()=>this.HHi(b,h));this.a0a.Z(h,r);return null}HHi(b,h){if(!this.wba)try{this.wba=Za.a.instance.resolve(722)}catch(r){v.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+r)}return this.wba?new Promise(r=>{const A=Date.now();this.wba.pV(b,h).then(M=>{const aa=M.Token;!M.IsSuccess||this.bqn(aa)?(this.Qvc("GetTokenInternalImplicitJS",!1,Date.now()-A,b,M.ErrorCode,M.ErrorMessage,h),r(null)):(this.Qvc("GetTokenInternalImplicitJS",!0,Date.now()-A,b,M.ErrorCode,M.ErrorMessage,
h),r(aa))}).catch(M=>{M=M?H.c(M):"";this.Qvc("GetTokenInternalImplicitJS",!1,Date.now()-A,b,"Caught Exception",M,h);r(null)})}):new Promise(r=>{this.Qvc("GetTokenInternalImplicitJS",!1,0,b,"Null OAuthManager","OAuthManager not set");r(null)})}Qvc(b,h,r,A,M="",aa="",oa=""){var Ja="Search"===A;const fb=[];b=Qg.a.Iaa(Ja?"Event":"EventName",b,2);A=Qg.a.Iaa("AppName",A,2);Array.add(fb,b);Array.add(fb,A);Ja&&(A=Qg.a.Iaa("LatencyType","FetchToken",2),Array.add(fb,A));M&&""!==M&&(M=Qg.a.Iaa("ErrorCode",M,
2),Array.add(fb,M));aa&&""!==aa&&(aa=Qg.a.Iaa("ErrorMessage",aa,2),Array.add(fb,aa));oa&&""!==oa&&(aa=!(oa in this.mfh),this.mfh[oa]=aa,aa=Qg.a.Iaa("WarmUpCall",aa.toString(),1),Array.add(fb,aa),oa=Qg.a.Iaa("Service",this.UHm(oa),2),Array.add(fb,oa));Ja=Ja?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";h=Object.assign(new Sg.a,{name:Ja,samplingPolicy:2,dataFields:fb,succeeded:h,durationMs:r});ca.a.sendActivityEvent(h)}UHm(b){return b===y.AFrameworkApplication.Z5f?"Loki":
b===y.AFrameworkApplication.eFg?"Substrate":y.AFrameworkApplication.J&&b===y.AFrameworkApplication.J.ib("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}bqn(b){return!b||!b.length}}Object(u.a)(Qk,"SearchOAuthManager",null,[709]);class bk{constructor(){this.W=null}get name(){return"Common.App.SearchOAuthManager"}uc(b){this.W=b;this.W.register(709,1167).ha().Sd(()=>new Qk)}init(){}dispose(){}static main(){K.a.instance.Lc(new bk)}}Object(u.a)(bk,"SearchOAuthPackage",null,[0,1]);var df=d(119),
fc=d(221),vd=d(6),Uc=d(12),ze=d(38),Gd=d(8);class Ej{constructor(b,h,r){this.X0e=this.hHb=this.U0e=this.gHb=this.XYe=null;this.BSm=A=>{try{this.ASm(A)}catch(M){A=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",M.message,M.stack),v.ULS.sendTraceTag(5285580,334,10,A)}};this.Mp=b;this.esk=h;this.hb=r;this.init()}init(){this.esk.nb(this.BSm);this.gHb=new eh.a;this.U0e=new eh.a;this.hHb=new eh.a;this.X0e=new fc.a}XX(b){this.gHb.add(b.key,b)}NYb(b){this.hHb.add(b.key,
b)}ASm(b){let h;const r=this.hb.gb.currentSelection;({iuf:h}=Ej.rmp(r)).returnValue&&(b=Ej.Ukm(b,this.XYe,h),this.Edo(b,h,r),this.XYe=h)}Edo(b,h,r){b=this.pem(b,h,r);let A;({notification:A}=Ej.hmp(b)).returnValue&&this.Mp.sendNotification(A,!1)}pem(b,h,r){const A=new eh.a;A.Z(1,new fc.a);A.Z(0,new fc.a);b.forEach(M=>{3===M?(Ej.lBg(h.node)||this.lCo(h,r),this.PBm(A,h)):M||this.slm(A,h);return!0});return A}lCo(b,h){this.gHb.forEach((r,A)=>{A.reset(b,h);return!0})}slm(b,h){let r=new eh.a;Ej.lBg(h.node)||
(r=this.qlm(h.cpBegin));this.rlm(b,this.U0e,r,Ej.sJj(this.XYe,h));this.U0e=r}qlm(b){const h=new eh.a;this.gHb.forEach((r,A)=>{r=null;({yG:r}=A.wEa(b)).returnValue&&h.Z(A.key,r);return!0});return h}rlm(b,h,r,A){const M=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;h.forEach((aa,oa)=>{const Ja=this.gHb.K(aa).Cv||oa.title;let fb;({value:fb}=r.Ac(aa)).returnValue?A&&fb.contentObject!==oa.contentObject&&(Ja&&b.K(1).add(Ja),aa=this.gHb.K(aa).Cv,aa=String.format(M,fb.title,aa),fb.description&&(aa+=
", "+fb.description),b.K(0).add(aa)):Ja&&b.K(1).add(Ja);return!0});r.forEach((aa,oa)=>{h.lb(aa)||(aa=this.gHb.K(aa).Cv,aa=String.format(M,oa.title,aa),oa.description&&(aa+=", "+oa.description),b.K(0).add(aa));return!0})}PBm(b,h){h=this.pJm(h.node);h=this.$rl(h);this.qJm(b,this.X0e,h);this.X0e=h}pJm(b){const h=new vd.a;h.set(b);if(!h.vb(1))return null;const r=new fc.a;for(;1!==h.mf;)this.hHb.forEach((A,M)=>{let aa;({Eea:aa}=M.K1b(h)).returnValue&&r.add(aa);return!0}),h.rc();r.reverse();return r}$rl(b){b=
b.toArray();let h=0;for(;h<b.length-1;){var r=b[h];if(r.NF===b[h+1].NF&&(this.hHb.K(r.NF),({dsl:r}={returnValue:!1,dsl:null}).returnValue)){b.splice(h,2,r);continue}h++}return new fc.a(b)}qJm(b,h,r){var A;for(A=0;A<Math.min(r.length,h.length)&&r.K(A).contentId.equals(h.K(A).contentId);A++){var M=this.hHb.K(r.K(A).NF).oqb(r.K(A),h.K(A));M&&(r.K(A).description&&(M+=", "+r.K(A).description),b.K(0).add(M))}for(M=A;M<r.length;M++){let aa=this.hHb.K(r.K(M).NF).oqb(r.K(M),null);aa&&(r.K(M).description&&
(aa+=", "+r.K(M).description),b.K(0).add(aa))}for(r=A;r<h.length;r++)(A=this.hHb.K(h.K(r).NF).Cv)&&b.K(1).add(A)}static Ukm(b,h,r){const A=new fc.a;(b=b||Ej.$Ko(h,r))?(A.add(3),A.add(0)):Ej.sJj(h,r)&&A.add(0);return A}static $Ko(b,h){return!b||!b.node.id.equals(h.node.id)}static sJj(b,h){return!b||!b.equals(h)}static rmp(b){let h=null;if(!b||!(ze.a.Am(b)||(b=ze.a.uk(b,!0,!1),ze.a.Am(b)||b.Qa&&Ej.lBg(b.Qa.node))))return{returnValue:!1,iuf:h};h=b.Qa;return{returnValue:!!h,iuf:h}}static hmp(b){const h=
new fc.a;b.K(1).forEach(r=>{r=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,r);h.add(r);return!0});b.K(0).forEach(r=>{r=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,r);h.add(r);return!0});b=h.toArray().join(" ");return{returnValue:0<h.length,notification:b}}static lBg(b){return Uc.ImageReader.It(b)||Gd.ParagraphReader.Aza(b)}}Object(u.a)(Ej,"AccessibilityContextManager",null,[708]);class bd{constructor(b,h){this.Loh=!1;this.pOc=null;this.qLd=
this.KOd=!1;this.Ieh=null;this.kRd=(r,A)=>{(A.dQ||A.fva)&&this.jPn(A.dQ,A.fva)};this.Gb=b;this.mQ=h}get eXm(){return!!this.pOc}nb(b){this.Loh||(this.mQ.fOh(this.kRd),this.Loh=!0);this.Ieh=b}jPn(b,h){this.eXm&&this.Gb.uf(this.pOc);this.KOd=this.KOd||b;this.qLd=this.qLd||h;this.pOc=new xc.a(5,1,bd.G0l,()=>{this.Ieh(this.KOd,this.qLd);this.reset()},126);this.Gb.Zb(this.pOc)}reset(){this.pOc=null;this.qLd=this.KOd=!1}}bd.G0l=100;Object(u.a)(bd,"EditingViewOnAfterValidateEventsConsolidator",null,[707]);
var gg=d(51);class Wf{constructor(){this.W=null}get name(){return"Box4.Accessibility"}init(){df.a.$Sh&&this.W.resolve(324)}dispose(){}uc(b){this.W=b;b.ia("Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator",()=>new bd(y.AFrameworkApplication.oc,b.resolve(230))).as(814).ha();b.ia("Box4.Accessibility.AccessibilityContextManager",()=>new Ej(b.resolve(26),b.resolve(814),gg.a.instance)).as(324).ha()}static main(){K.a.instance.Lc(new Wf)}}Object(u.a)(Wf,"Box4AccessibilityPackage",null,[0,1]);
var Rg=d(193),ii=d(1038),fo=d(1607),na=d(889),db=d(238),Pb=d(1435),Rb=d(37),sc=d(22),Nc=d(101),wc=d(26),ub=d(3);class ee extends Pb.a{get EBa(){return null!=this.$Yg?this.$Yg:this.$Yg=Za.a.instance.Oa(66)}get wsj(){return null!=this.N1g?this.N1g:this.N1g=Za.a.instance.Oa(815)}get lE(){return!0}get commandId(){return ub.a.B9k}Pra(b){db.a.mark(7012);const h=new Rb.GraphTransaction(15);h.Bb(b);var r=this.EI,A=this.v3,M=Gd.ParagraphReader.text(b),aa=M.substring(r,A);const oa=({Nag:Ja}=I.a.NEg(aa)).returnValue;
aa!==oa&&(r+=Ja,A=r+oa.length);aa=wc.a.createTextRange(b,r,A);var Ja=M.substring(r,A);ee.tin(M,r,A)&&(this.Qd.Ve(wc.a.createTextRange(b,r-1,A+1),Ja,!0,!1),--r,--A,aa=wc.a.createTextRange(b,r,A),r=sc.SelectionFactory.ue(b,A),gg.a.instance.Kc(r));r=Nc.a.uKa(Ja);ee.Jp.qF(aa,r,!1);M=Ja="";A=!1;this.EBa&&({Cqg:Ja,GOb:M}=this.EBa.iJg(r)).returnValue&&(r=Ja,A=!0,Ja=Nc.a.KA(aa,!1),ee.Jp.cV(Ja[0].paragraph,Ja[0].hyperlink),""!==M&&(this.Qd.Ve(aa,M,!0,!1),aa=wc.a.createTextRange(b,this.EI,this.EI+M.length),
b=sc.SelectionFactory.ue(b,this.EI+this.EI+M.length),gg.a.instance.Kc(b)),ee.Jp.qF(aa,r,!1));h.dispose();!A&&this.wsj&&this.wsj.kao(aa,r);db.a.mark(7013)}set lE(b){super.lE=b}static get Jp(){return null!=ee.cXg?ee.cXg:ee.cXg=Za.a.instance.resolve(82)}static tin(b,h,r){r=r!==b.length&&('"'===b.charAt(r)||"\u201d"===b.charAt(r));return!!h&&('"'===b.charAt(h-1)||"\u201c"===b.charAt(h-1))&&r}}Object(u.a)(ee,"HyperlinkAction",Pb.a,[]);class We{constructor(b){this.Qd=b}eEl(b,h,r){return new ee(null,b,h,
r,this.Qd)}}Object(u.a)(We,"HyperlinkActionFactory",null,[704]);var re=d(253);class jf{constructor(){this.W=null}get name(){return"Box4.AutoCorrect"}uc(b){this.W=b;b.ia("Box4.AutoCorrect.AutoCorrectRules",()=>new fo.a(b.resolve(207),b.resolve(322),re.a.instance,y.AFrameworkApplication.va,y.AFrameworkApplication.J,b.resolve(816),b.resolve(180).instance)).as(105).ha();b.ia("Box4.AutoCorrect.AutoCorrectOptionsInfo",()=>new ii.a(b.resolve(217),y.AFrameworkApplication.J.$("ReplaceQuoteWithSmartQuoteIsEnabled"))).as(816).ha();
b.ia("Box4.AutoCorrect.AutoCorrectScheduler",()=>new na.a(b.resolve(105),gg.a.instance,Rg.a.instance,y.AFrameworkApplication.J,b.resolve(816),b.resolve(50),b.resolve(739))).as(70).ha();b.ia("Box4.AutoCorrect.HyperlinkAction.Factory",()=>new We(b.resolve(322))).as(207).ha()}init(){this.W.resolve(105).jxn();const b=y.AFrameworkApplication.J;b.$("AutoCorrectOptionSettingIsEnabledForWordOnline")&&b.$("IsRoamingServiceEnabled")&&this.W.resolve(816).Vfm()}dispose(){}static main(){K.a.instance.Lc(new jf)}}
Object(u.a)(jf,"Box4AutoCorrectPackage",null,[0,1]);class $e{get name(){return"Box4.Clipboard"}init(){}dispose(){}uc(){}static main(){K.a.instance.Lc(new $e)}}Object(u.a)($e,"Box4ClipboardPackage",null,[0,1]);class Cg{get name(){return"Box4.ImageEditors"}uc(){}init(){}dispose(){}static main(){K.a.instance.Lc(new Cg)}}Object(u.a)(Cg,"Box4ImageEditorsPackage",null,[0,1]);var Tg=d(611),Dd=d(871),nh=d(670),bj=d(642),fe=d(1098);class Ge{constructor(){this.ChangeStateList=this.Revision=null}static construct(b,
h,r,A,M){const aa=new Ge;aa.DocumentId=M;aa.UserId=r;aa.WACSessionId=A;aa.Revision=b;aa.ChangeStateList=fe.a.pKj(h);return aa}}Object(u.a)(Ge,"LocalUnsavedChange",null,[]);class og{constructor(){this.ghe=null}fEe(b){return new Promise((h,r)=>{this.j8h().then(A=>{const M=A.transaction(og.gbd,"readwrite");M.objectStore(og.gbd).put(b);M.oncomplete=()=>h();M.onerror=()=>r(M.error.message)}).catch(r)})}aVd(b,h,r){return new Promise((A,M)=>{this.j8h().then(aa=>{const oa=aa.transaction(og.gbd,"readwrite");
oa.objectStore(og.gbd).delete([b,h,r]);oa.oncomplete=()=>A();oa.onerror=()=>M(oa.error.message)}).catch(M)})}static isSupported(){return"indexedDB"in window}j8h(){return new Promise((b,h)=>{if(og.isSupported())if(this.ghe)b(this.ghe);else{var r=window.indexedDB.open(og.vyn,og.wyn);r.onsuccess=()=>{this.ghe=r.result;b(r.result)};r.onerror=()=>{h(r.error.message)};r.onupgradeneeded=()=>{const A=r.result,M=A.createObjectStore(og.gbd,{keyPath:["DocumentId","UserId","WACSessionId"]});M.createIndex("DocumentId, UserId",
["DocumentId","UserId"],{unique:!1});M.createIndex("UserId",["UserId"],{unique:!1});this.ghe=A;b(A)}}else h("This browser does not support IndexedDB.")})}}og.vyn="LocalUnsavedChangeDatabase";og.wyn=1;og.gbd="LocalUnsavedChange";Object(u.a)(og,"LocalUnsavedChangeStore",null,[]);class Hi{constructor(b,h,r,A,M,aa){this.k8i=b;this.ldb=h;this.Jzm=r;this.B2c=A;this.vll=M;this.DDa=aa}initialize(){const b=Dd.a.nMf(this.Jzm());this.sYd=this.tXc=b;this.DDa.r_k(this.Ulj.bind(this));this.DDa.s_k(this.Vlj.bind(this))}dispose(){this.DDa.Xxo(this.Ulj.bind(this));
this.DDa.Yxo(this.Vlj.bind(this))}Ulj(b,h){this.yup(h.cB)}Vlj(b,h){this.grp(h.cB)}grp(b){b.equals(this.tXc)||(this.tXc=b,b.equals(this.sYd)?this.aVd():this.fEe())}yup(b){b.equals(this.sYd)||(this.sYd=b,b.equals(this.tXc)?this.aVd():this.fEe())}ZEl(){const b=Object(bj.b)({cB:this.sYd,vm:this.tXc,fileId:this.B2c().yq,Mga:this.B2c().Mga,contextId:this.B2c().contextId,j1d:this.tXc.id,ldb:this.ldb,ede:nh.a.BSb(this.B2c()),sae:!1,cellId:this.B2c().td.id},!1);return Ge.construct(b,this.vll.X1c(),Hi.userId,
Hi.sessionId,Hi.documentId)}fEe(){const b=this.ZEl();this.k8i.fEe(b).then(()=>{v.ULS.sendTraceTag(509366736,306,50,"Successfully updated local unsaved change with LatestRevision: {0}",b.Revision.Id)}).catch(h=>{v.ULS.sendTraceTag(509366735,306,10,"Failed to update local unsaved change because {0}",h)})}aVd(){this.k8i.aVd(Hi.documentId,Hi.userId,Hi.sessionId).then(()=>{v.ULS.sendTraceTag(509366734,306,50,"Successfully clear local unsaved change.")}).catch(b=>{v.ULS.sendTraceTag(509366733,306,10,"Failed to clear local unsaved change because {0}",
b)})}static isSupported(){return og.isSupported()&&null!=this.documentId&&null!=this.userId&&null!=this.sessionId}static get documentId(){return null!=Hi.bUg?Hi.bUg:Hi.bUg=y.AFrameworkApplication.sessionStartInfoSettings.ServerDocId}static get userId(){return null!=Hi.x5g?Hi.x5g:Hi.x5g=y.AFrameworkApplication.J.ib("LoggableUserId")}static get sessionId(){return null!=Hi.y2g?Hi.y2g:Hi.y2g=y.AFrameworkApplication.J.ib("SessionId")}}Object(u.a)(Hi,"LocalUnsavedChangeManager",null,[561]);class Nh{get name(){return"Box4.LocalUnsavedChange"}init(){this.JVi()&&
Hi.isSupported()&&(this.L4f=this.container.resolve(817),this.L4f.initialize())}dispose(){this.L4f&&this.L4f.dispose()}uc(b){this.container=b;if(this.JVi()){b.ia(818,()=>new og).ha();var h=(r,A,M)=>new Tg.a(r,A,M);b.ia(817,()=>new Hi(b.resolve(818),h,()=>qa.StaticActiveAppFrame.za().kb.$c.td,()=>qa.StaticActiveAppFrame.za().kb.$c,b.resolve(502),b.resolve(819))).ha()}}static main(){K.a.instance.Lc(new Nh)}JVi(){return y.AFrameworkApplication.J.$("DisconnectedScenarioIsEnabled")}}Object(u.a)(Nh,"LocalUnsavedChangePackage",
null,[0,1]);class ji{get name(){return"Box4.NotebookLevelEditors"}uc(){}init(){}dispose(){}static main(){K.a.instance.Lc(new ji)}}Object(u.a)(ji,"Box4NotebookLevelEditorsPackage",null,[0,1]);var qi=d(1455);class ai{get name(){return"Box4.Search"}uc(b){b.ia("Box4.Search.FindManagerHelper",()=>qi.FindManagerHelper.instance).as(1177).ha()}init(){}dispose(){}}Object(u.a)(ai,"PackageManager",null,[0,1]);class Ll{get name(){return"Box4.TableEditors"}uc(){}init(){}dispose(){}static main(){K.a.instance.Lc(new Ll)}}
Object(u.a)(Ll,"Box4TableEditorsPackage",null,[0,1]);class cl{get name(){return"Box4.TextLevelEditors"}uc(){}init(){}dispose(){}static main(){K.a.instance.Lc(new cl)}}Object(u.a)(cl,"Box4TextLevelEditorsPackage",null,[0,1]);var nk=d(126),wg=d(335),pd=d(176),Ak=d(422),Ql=d(306);class an{constructor(b,h,r){this.lx=this.BQa=this.ISa=null;this.ZF=this.ZNe=this.RPa=0;this.spa=this.TDd=this.o2a=this.n2a=!1;this.FCd=this.Rkh=this.Ukh=0;this.fGa=b;this.ga=h;this.Xn=r}JR(b){return!qa.StaticActiveAppFrame.za().kb.isEditingAllowed||
ec.SessionStatusManager.instance.Hk?!1:""!==this.C2c(b.If)}EN(b){if(!this.JR(b))return!1;this.NRo(b);this.ZF=this.fGa.ijc();this.HUo(b);this.IUo();({Bnc:this.TDd,Voc:this.spa}=this.GNj(this.ZNe));this.JUo();this.ISa=b.gK;this.lx=new Sys.UI.Point(0,0);[this.Ukh,this.Rkh]=this.fGa.getDimensions();v.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");return!0}IX(b){this.BQa=b.gK;this.Egl();this.FCd=Ql.d(this.lx.x,this.lx.y,this.Ukh,this.Rkh,this.TDd,this.spa,this.FCd,y.AFrameworkApplication.J.$("SmoothImageHelperGetScaleIsEnabled"));
this.fGa.zLg(this.FCd,this.TDd,this.spa);return!0}IF(){this.setSize();v.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}q0(){this.fGa.Ntg();v.ULS.sendTraceTag(16802337,322,50,"Image resize drag canceled")}NRo(b){this.fGa=nk.a.Eb(b.If,Ak.a)}IUo(){this.ZNe=(Math.floor((this.ZF+22)/45)%8+this.RPa)%8}GNj(b){let h,r;if(this.ZF&&90!==this.ZF&&180!==this.ZF&&270!==this.ZF&&360!==this.ZF||this.win(b))return{Bnc:!0,Voc:!0};h=r=!1;switch(b){case 1:case 5:h=!0;break;case 3:case 7:r=!0}return{Bnc:r,
Voc:h}}JUo(){this.o2a=this.n2a=!1;switch(this.ZNe){case 0:this.o2a=this.n2a=!0;break;case 1:case 2:this.o2a=!0;break;case 7:case 6:this.n2a=!0}}win(b){return!(b%2)}C2c(b){var h=b.classList.toString();-1===h.indexOf("WACImageResizeHandle")&&b.parentNode&&(h=b.parentNode.classList.toString());b=h.split(" ");for(h=0;h<b.length;h++){const r=b[h].toString();if(r.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==r)return r}return""}HUo(b){switch(this.C2c(b.If)){case "WACImageResizeHandleNW":this.RPa=
0;break;case "WACImageResizeHandleN":this.RPa=1;break;case "WACImageResizeHandleNE":this.RPa=2;break;case "WACImageResizeHandleE":this.RPa=3;break;case "WACImageResizeHandleSE":this.RPa=4;break;case "WACImageResizeHandleS":this.RPa=5;break;case "WACImageResizeHandleSW":this.RPa=6;break;case "WACImageResizeHandleW":this.RPa=7}}Egl(){var b=1;this.Xn.instance&&(b=this.Xn.instance.yj);const h=(this.BQa.x-this.ISa.x)/b;b=(this.BQa.y-this.ISa.y)/b;this.lx.x=this.n2a?-h:h;this.lx.y=this.o2a?-b:b}setSize(){const b=
new wg.DictionaryPropertySet;b.setValue(pd.a.s6c,100*this.FCd);b.setValue(pd.a.KOi,!0);if(90===this.ZF||270===this.ZF){let h,r;({Bnc:h,Voc:r}=this.GNj(this.RPa));b.setValue(pd.a.cTf,h);b.setValue(pd.a.dTf,r)}else b.setValue(pd.a.cTf,this.TDd),b.setValue(pd.a.dTf,this.spa);this.ga.Pb(ub.a.Xlc,2,b)}}Object(u.a)(an,"ImageResizeDragAdapter",null,[93]);var Jg=d(132),ln=d(636);class Ck{constructor(b,h,r,A){this.DUe=this.BQa=this.ISa=this.LKd=null;this.NHd=this.qPd=0;this.Db=null;this.ga=b;this.hb=h;this.Xn=
r;this.Vrh=this.VGa=0;this.kd=A}JR(b){return qa.StaticActiveAppFrame.za().kb.isEditingAllowed&&!ec.SessionStatusManager.instance.Hk&&b&&this.onn(b.If)?(this.LKd=this.hb.Mg)?!0:!1:!1}L2d(){}oMf(){return null}EN(b){if(!this.JR(b))return!1;this.fGa=nk.a.Eb(b.If,Ak.a);if(!this.fGa)return!1;this.iLd=this.fGa.jca;if(!this.iLd)return!1;this.LKd=this.hb.Mg;this.Db=Uc.ImageReader.Kn(this.LKd);if(!this.Db)return!1;this.ISa=this.rVa(b);this.DUe=Sys.UI.DomElement.getBounds(this.iLd);this.qPd=0<Uc.ImageReader.Y5d(this.Db)?
Uc.ImageReader.Y5d(this.Db):0;this.NHd=Uc.ImageReader.vJf(this.Db);return!0}IX(b){this.BQa=this.rVa(b);this.Mgl();if(this.fGa)return this.fGa.qEe(this.VGa,this.Vrh),!0;v.ULS.sendTraceTag(538809933,322,50,"Image rotate drag move aborted because img presenter is null.");return!1}IF(){this.qPd=this.VGa=Ql.e(this.VGa);this.y8()}q0(){this.fGa.qEe(this.NHd,0)}onn(b){return b.classList.contains(ln.c)||b.classList.contains(ln.b)||b.classList.contains(ln.a)||!!b.parentElement&&b.parentElement.classList.contains(ln.a)}rVa(b){return this.kd.Ad.F8a(b)}Mgl(){var b=
1;this.Xn&&this.Xn.instance&&(b=this.Xn.instance.yj);var h=new Sys.UI.Point(this.DUe.x+this.iLd.clientWidth/2*b,this.DUe.y+this.iLd.clientHeight/2*b);b=Ql.a(this.ISa,h);h=Ql.a(this.BQa,h);this.VGa=Math.round(Jg.a.Jio(h-b));0<this.qPd&&(this.VGa+=this.qPd-this.NHd);this.Vrh=this.VGa;this.VGa+=this.NHd}y8(){const b=new wg.DictionaryPropertySet;b.setValue(pd.a.p6c,0);b.setValue(pd.a.lX,this.VGa);this.ga.Pb(ub.a.Vaa,2,b)}}Object(u.a)(Ck,"ImageRotateDragAdapterSimplified",null,[546,93]);class Xl{constructor(){this.W=
null}get name(){return"Box4.Images"}uc(b){this.W=b;this.W.ia("Box4.Images.ImageResizeDragAdapter",()=>new an(null,y.AFrameworkApplication.va,Za.a.instance.Ra(6))).as(358).ha();this.W.ia("Box4.Images.ImageRotateDragAdapterUpdated",()=>new Ck(y.AFrameworkApplication.va,gg.a.instance,Za.a.instance.Ra(6),Object(Lb.a)())).as(359).ha()}init(){this.W.resolve(358);this.W.resolve(359)}dispose(){}static main(){K.a.instance.Lc(new Xl)}}Object(u.a)(Xl,"Box4ImagesPackage",null,[0,1]);var mm=d(69),fd=d(110),Mc=
d(5),Pi=d(508),Uj=d(456),tk=d(575),tm=d(242),Ml=d(250),Pp=d(1775),bi=d(1673),Mq=d(1148);class Ri extends bi.a{constructor(b,h,r){super(b,h,r);this.MId=this.mlb=null}get jV(){return y.AFrameworkApplication.ua.Vr}r5d(b){switch(b){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}}ZEe(b){return Ri.coa(b,this.qIi())}qIi(){return Ri.obf}coa(b,h=null){b=this.ZEe(b);return 0!==b?(h&&h.lQd(),2===b&&(h=this.r5d(b),this.mq(this.fwi(b),
h)),!1):!0}vAa(b,h){v.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.ygg=h;db.a.mark(5576);this.MId=this.jV.Wf("LoadResource","PictureUploadTime");this.fbe()?this.pkd(b):this.osc()}mq(b,h){const r=new ni.StandardDialog;r.Fd=0;r.zy(b,CommonUIStrings.l_ImageUploadFailedTitle,h,null)}osc(){v.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");super.osc();this.MId&&(this.MId.stop(),this.MId=null)}heb(){this.mlb=(new Mq.a).create();this.mlb.message=CommonUIStrings.l_ImageUploadWait;
this.mlb.Fd=5;this.mlb.Bu=!1;this.mlb.dM(null,null,null)}wec(){this.mlb&&(this.mlb.close(),this.mlb=null)}static tXm(b,h){b=I.a.vh(b);for(let r=0;r<h.length;++r)if(b.endsWith(h[r]))return!0;return!1}static coa(b,h=null){h||(h=Ri.obf);return b?Ri.tXm(b,h)?0:2:1}}Ri.obf=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(u.a)(Ri,"PictureUploader",bi.a,[]);var sh=d(300),Xi;(function(b){b[b.WEe=0]="validPicture";b[b.rdd=1]="noPictureSpecified";b[b.DSi=2]="invalidExtension";b[b.hpe=3]="pictureTooLarge"})(Xi||
(Xi={}));Object(u.b)("PictureValidationResult",Xi);var Ah=d(55),He=d(14),wb=d(40),ic=d(980);class Zc{constructor(){this.iR=null}}Object(u.a)(Zc,"ImageData",null,[]);var dd=d(137),Bd=d(189),Bf=d(45),Zf=d(289),Of=d(64),Ff=d(851),hg=d(1560),Jk=d(1616);class Fg extends ig.a{constructor(b,h=!0){super(!1,!1,Fg.RN);this.S9b=null;this.wgh=!1;this.Fz=[];this.Yq=null;this.pVn=r=>{this.zKk&&(this.Yq=this.HOj(r,this.olb))};this.h1n=()=>{this.Yq&&this.Yq.iR&&(this.wgh||(this.Yq.Xro(this.Qdg),this.wgh=!0),this.Yq.dmi())};
this.Qdg=r=>{this.S9b.uploadStatusLabel=r;this.d9(this.titleText,Object(E.a)(this,this.Xae,"insertDialogHandler"),this.S9b)};this.zgg=()=>{this.guj()};this.onKeyDown=r=>{4!==Cd.FocusManager.instance().luj(r)&&r.preventDefault()};this.olb=b;this.zKk=h;this.nda=this.LFh=!1;this.k5a=null;this.oRe=!1;this.kh=this.QQl;this.Ng="InsertFileDialog";this.Qe(1,this.GPd);Fg.RN?(this.S9b={["id"]:this.Ng,["bodyControls"]:{["uploadButtonProps"]:{["label"]:CommonUIStrings.l_DialogChooseFile,["onExecute"]:this.h1n}},
["uploadStatusLabel"]:CommonUIStrings.l_DialogNoFileChosen,["onFrameReady"]:this.pVn},this.mi(this.titleText,Object(E.a)(this,this.Xae,"insertDialogHandler"),this.S9b),this.RY=!0):(this.showDialog(this.titleText,Object(E.a)(this,this.Xae,"insertDialogHandler")),h&&this.XWo(),(b=this.i4d(1))&&this.Fz.push(b),(b=this.i4d(0))&&this.Fz.push(b),this.q6j(),this.RY=!1)}get q8j(){return this.olb}validate(){this.Yq.iR||v.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.Yq.iR.value?
!0:(Fg.zy(CommonUIStrings.l_FileUploadNoFileSpecified),!1)}Xae(b){1===b&&this.isEnabled()?Fg.RN&&this.Yq.iR&&!this.Yq.iR.value?(this.S9b.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.d9(this.titleText,Object(E.a)(this,this.Xae,"insertDialogHandler"),this.S9b)):(this.u$d(),this.olb.vAa(this.Yq,Object(E.a)(this,this.dispose,"dispose"))):0===b&&this.hide()}XWo(){this.oRe=!1;this.Yq=this.HOj(document.getElementById("uploadFrameContainer"),this.olb);y.AFrameworkApplication.J.$("InsertPictureDialogFocusLoopFixIsEnabled")&&
(this.k5a=this.zgg,mf.a.addHandler(this.Yq.SJ,"load",this.k5a));this.Yq.iR||v.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.guj()}guj(){if(this.Yq&&!this.oRe){var b=this.Yq.iR;b&&(mf.a.addHandler(b,Jd.a.hj,this.onKeyDown),b=[b],this.Fz=b.concat.apply(b,this.Fz),this.q6j(),this.oRe=!0)}}dispose(){if(this.Yq&&!Fg.RN){const b=this.Yq.iR;b&&mf.a.removeHandler(b,Jd.a.hj,this.onKeyDown);this.k5a&&mf.a.removeHandler(this.Yq.SJ,"load",this.k5a)}this.Yq=null;super.dispose()}q6j(){if(0<
this.Fz.length){const b=new Ve(this.Fz),h=Cd.FocusManager.instance().au();h&&(this.Fz[0].focus(),h.Nk=b,h.NR=!0)}}static get RN(){return y.AFrameworkApplication.ua.Ib.cH&&y.AFrameworkApplication.ua.Ib.J_i}static zy(b){const h=document.getElementById("errorText");h.innerText=b;h.style.display="inline-block"}}Object(u.a)(Fg,"InsertFileDialog",ig.a,[]);class Un{static get kh(){return ig.a.Ry(Un.Hn,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}Un.Hn="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(u.a)(Un,"InsertImageDialogHtml",null,[]);class $o extends Fg{constructor(b,h=!0){super(b,h)}get GPd(){return CommonUIStrings.l_ImageUploadButtonText}get titleText(){return CommonUIStrings.l_ImageUploadingTitle}get QQl(){return Un.kh}validate(){this.Yq.iR||v.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var b=Object(ya.a)(Ri,this.q8j);const h=b.ZEe(this.Yq.iR.value);return 0!==h?(b=b.r5d(h),Fg.zy(b),!1):!0}}Object(u.a)($o,"InsertImageDialog",Fg,[]);class fh extends $o{constructor(b){super(b)}HOj(b,
h){const r=y.AFrameworkApplication.ua.Ib.cH&&y.AFrameworkApplication.ua.Ib.J_i;return new Jk.a(b,Object(E.a)(h,h.Hvb,"onUploadFrameInitialized"),Object(E.a)(h,h.aoa,"uploadResponseReceived"),y.AFrameworkApplication.J,!r)}isEnabled(){return fh.DR.Lja(this.q8j.context)}static get DR(){return null!=fh.nXg?fh.nXg:fh.nXg=Za.a.instance.resolve(820)}}Object(u.a)(fh,"Box4InsertImageDialog",$o,[]);class Mn{Gyl(b){return new Promise((h,r)=>{this.Hyl(b).then(A=>{h(A)},A=>{r(A)})})}m6h(b){return new Promise((h,
r)=>{const A=new FileReader;A.addEventListener("load",()=>{h(A.result)},!1);A.addEventListener("error",()=>{r("FileReader exception ("+A.error.name+")")});A.readAsDataURL(b)})}Hyl(b){return new Promise((h,r)=>{this.m6h(b).then(A=>{this.grf(A,"image/jpeg").then(M=>{h(M)},M=>{r(M)})},A=>{r(A)})})}grf(b,h){return new Promise((r,A)=>{const M=new Image;M.addEventListener("load",()=>{const aa=document.createElement("canvas"),oa=aa.getContext("2d");aa.width=M.width;aa.height=M.height;oa.drawImage(M,0,0);
r(aa.toDataURL(h))});M.addEventListener("error",()=>{A("Image failed to load")});M.src=b})}}Object(u.a)(Mn,"ImageFormatConverter",null,[]);var gj=d(232),cm=d(1034);const Oo=["ImageInsertFailed"];class ik extends Ri{constructor(b,h,r,A,M,aa,oa,Ja=!0){var fb;super(b,h,r);this.Ho=oa;this.cGa=this.Hm=this.iJ=this.Qf=null;this.E1d="wwpicturesfc";this.kpiName="ImageFileExtension";this.uJc="LocalDeviceUpload";this.D7=new Map;this.jmi=0;this.nlb=null;this.mRe="";this.Wwa=0;this.Mp=null;this.lIc="";this.Ush=
50;this.Xhh=this.vGc=this.iPc=this.zLc=!1;this.kCk=19922944;this.avh=0;this.qRe=[];this.vgh=[];this.bvh=0;this.vYn=()=>{Bd.a.iV&&this.Ho.XL([25],this.He)};this.ufg=Cb=>{v.ULS.sendTraceTag(36783363,322,50,"Box4PictureUploader.OnPlaceholderNodeSaved");if(Cb){var Gb={},Sb=this.iJ?this.iJ.properties.wc.toString():this.Qf.wc.toString();Gb[Uj.a.nodeId]=this.iJ?this.iJ.id.toString():this.Qf.id.toString();Gb[Uj.a.classId]=Sb;this.Rf.hasProperty(Mc.a.imageType)&&(Gb[Pi.a.imageType]=this.Rf.getValue(Mc.a.imageType));
this.Rf.hasProperty(Mc.a.kX)&&(Gb[Pi.a.kX]=this.Rf.getValue(Mc.a.kX));this.Rf.hasProperty(fd.a.rka)&&(Gb[Pi.a.rka]=this.Rf.getValue(fd.a.rka));this.Rf.hasProperty(Mc.a.kub)&&(Gb[Pi.a.kub]=this.Rf.getValue(Mc.a.kub));hg.d(Cb,this.Qf,this.Hm,Gb)&&(this.Wpd(Cb),ik.prc++)}else v.ULS.sendTraceTag(16869584,352,15,"InsertPicture:UploadFrame is null")};this.XUn=Cb=>{if(!this.HUf){var Gb=this.Dwi(this.Yq);Gb&&(this.mRe=Gb.name,this.Wwa=Gb.size);if(!this.coa(Cb,this.Yq)||!this.RMg(Gb,this.Yq)){Gb=Object.assign(new bb.a,
{extendedProperties:new Map});Gb.extendedProperties.set("type",this.coa(Cb,this.Yq)?"Image too large":"FileType invalid");this.Bhe(Gb);this.whe();return}}this.vAa(this.Yq,null)};this.Rf=A;this.An=M;this.ga=aa;this.He=Bd.a.lq||Bd.a.iV?sh.a.getInstance(dd.a):sh.a.getInstance(gj.a);this.Xrh=r.$("WACLocalRenderingForInsertLocalImageIsEnabled");this.lth=r.ic("ImageUploadMaxByteSize",Number.MAX_VALUE);Ja&&this.showDialog();null===(fb=Zf.a.B9a())||void 0===fb?void 0:fb.addHandler(this);cm.a.$pg(this.vYn)}get bYi(){return this.J.$("JfifImageInsertIsEnabled")}get MR(){return this.uJc}get fileExtension(){return this.mRe}get fileSize(){return this.Wwa}get p8j(){return this.nlb}get Cw(){return this.Mp||
(this.Mp=Za.a.instance.resolve(26))}get HUf(){return this.MR===this.uJc}showDialog(){hg.a(this.J)?(this.rob=!1,this.Yq=new Jk.a(document.body,Object(E.a)(this,this.Hvb,"onUploadFrameInitialized"),Object(E.a)(this,this.aoa,"uploadResponseReceived"),this.J,!1,void 0,!0)):hg.b()||this.Kub&&Y.a.EF?(this.rob=!1,this.Yq=new Jk.a(document.body,Object(E.a)(this,this.Hvb,"onUploadFrameInitialized"),Object(E.a)(this,this.aoa,"uploadResponseReceived"),this.J,!1)):(this.rob=!0,this.Yq=(new fh(this)).Yq)}fwi(b){switch(b){case Xi.rdd:return Bf.a.rdd;
case Xi.DSi:return Bf.a.q8m;case Xi.hpe:return Bf.a.C4f}return fk.a.unknown}pkd(b){this.HUf||(this.Qf.Jj()?(v.ULS.sendTraceTag(36783362,322,50,"Box4PictureUploader.ReplicatePlaceholder"),Ff.a.instance.dMg(this.Qf.Jj()),this.Qf.Jj().wg.xF(this.ufg,Object(E.a)(this,this.HXb,"processFailure"),b)):this.HXb(b,157))}Uln(){return hg.c(this.Qf)}Wpd(b){b.Wpd();this.nlb=b.nlb}aoa(b){this.jmi=+new Date-+this.p8j;this.whe();v.ULS.sendTraceTag(36783364,322,50,"Box4PictureUploader.UploadResponseReceived");hg.e(this,
b,this.Qf)}aMg(){v.ULS.sendTraceTag(36783365,322,50,"Box4PictureUploader.UploadComplete");this.osc();ik.prc--;this.ga.Ob(Ka.a.ufb,2);this.Qf?Ff.a.instance.rAc(this.Qf.Jj(),0):v.ULS.sendTraceTag(42468439,339,50,"Not able to notify upload notifier for completion");this.Cw.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)}HXb(b,h){var r;if(this.XEo(b))v.ULS.sendTraceTag(16798870,352,50,"InsertPicture:OutboundRetry:Retry={0}:Error={1}",this.retryCount,h.toLocaleString());else{b=Object.assign(new bb.a,
{extendedProperties:new Map});b.extendedProperties.set("result",h.toLocaleString());Bd.a.lq?this.He.logKpiFailure({kpiName:dd.d.yKa,errorName:"PictureFromLocalUploadRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:Object(Ql.c)(dd.d.Zkc,b,null,!1)}):(null===(r=y.AFrameworkApplication.J)||void 0===r?0:r.$("ShouldLogPicturesExtendedHealthKpis"))?this.He.logKpiFailure({kpiName:gj.c.OKa,errorName:"PictureFromLocalUploadRequestFailed",optionalProperties:{isIntentional:!1,
isInternal:!0,additionalValues:b},optionalVeto:{name:gj.c.Vlc,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b}}):Ba.Health.instance.recordQosError("PictureFromLocalUploadRequestFailed",Oo,!1,!0,!1,!1,b);r=this.AAf(h);v.ULS.sendTraceTag(16798871,352,10,"InsertPicture:Failure:Retries={0}:Error={1}",this.retryCount,h.toLocaleString());b=this.Qf.sL();var A=new Rb.GraphTransaction(15,ub.a.nX);A.Bb(this.Qf);ik.DR.h_a(this.Rf,r);ik.DR.fBj(this.Qf,
this.iJ);Uc.ImageReader.zMj(this.Rf,ic.a.MB);A.dispose();this.SSj(r);this.An.sec(b,!1);this.osc();ik.prc--;Ff.a.instance.rAc(this.Qf.Jj(),h)}}SSj(b){const h=new ni.StandardDialog;h.Fd=0;h.zy(Bf.a.FSi,CommonUIStrings.l_ImageUploadFailedTitle,b,null)}AAf(b){switch(b){case 23:return Box4Intl.Box4Strings.l_ImageUploadSizeError;default:return Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord}}zek(){if(this.lIc&&0<this.lIc.length){const b=new wg.DictionaryPropertySet;b.setValue(pd.a.QX,this.lIc);b.setValue(pd.a.Ofa,
!0);this.ga.Pb(ub.a.q6,2,b)}this.J3o()}J3o(){let b="";this.Xhh?b=Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord:this.zLc&&this.vGc&&this.iPc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatSizeAndMaxNumberExceededError:this.zLc&&this.vGc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatAndMaxNumberExceededError:this.zLc&&this.iPc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndMaxNumberExceededError:this.iPc&&this.vGc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndFormatError:this.iPc?
b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeError:this.vGc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatError:this.zLc&&(b=Box4Intl.Box4Strings.l_MultipleImageUploadMaxNumberExceededError);""!==b&&(this.SSj(b),this.qfk())}RXk(b){this.lIc+=String.format('<img src="{0}"></img>',b);this.bvh++}VAn(){this.iPc=!0;v.ULS.sendTraceTag(524873990,322,10,"Image too large");const b=Object.assign(new bb.a,{extendedProperties:new Map});b.extendedProperties.set("type","Image too large");this.Bhe(b)}UAn(){this.vGc=
!0;v.ULS.sendTraceTag(545093781,322,10,"Image filetype not supported");const b=Object.assign(new bb.a,{extendedProperties:new Map});b.extendedProperties.set("type","Filetype invalid");this.Bhe(b)}U8i(b){this.Xhh=!0;v.ULS.sendTraceTag(524873991,322,15,"Something went wrong during paste with format conversion: {0}",b)}N9o(b){const h=new Mn;if(this.ZEe(b.name)===Xi.WEe)return h.m6h(b);if(Ri.coa(b.name,Jk.a.pbf)===Xi.WEe)return h.Gyl(b)}Ryl(b){return new Promise(h=>{const r=this.N9o(b);void 0===r&&(this.U8i("Failed starting conversion work"),
h());r.then(A=>{A.length>this.kCk?this.VAn():this.RXk(A);h()},A=>{this.U8i(A);h()})})}Mqn(b){return this.ZEe(b.name)===Xi.WEe||Ri.coa(b.name,Jk.a.pbf)===Xi.WEe}z7m(){const b=[];if(this.Yq.iR.files){this.avh=this.Yq.iR.files.length;this.Yq.iR.files.length>this.Ush&&(this.zLc=!0);this.heb();for(let h=0;h<this.Yq.iR.files.length&&this.Ush;h++){const r=this.Yq.iR.files[h];this.qRe.push(r.name);this.vgh.push(r.size);r&&(this.Mqn(r)?b.push(this.Ryl(r)):this.UAn())}}Promise.all(b).then(()=>{this.wec();this.zek()});
return!0}s8m(){this.Hm=kb.a.create();this.Rf||(this.Rf=new wg.DictionaryPropertySet);this.Xrh&&this.cGa&&this.Rf.setValue(fd.a.g8i,this.cGa);var b=480;let h=320;const r=this.context.view.Kh.editingElement.clientWidth;0<r&&r<b&&(h=Math.floor(1*r/b*h),b=r,this.Rf.setValue(fd.a.rka,r));this.Rf.setValue(He.a.Kta,Ah.a.qn(b,0));this.Rf.setValue(He.a.Jta,Ah.a.qn(h,1));this.Rf.setValue(wb.a.Q_,ic.a.hPa);this.Rf.setValue(pd.a.Ofa,!0);this.Rf.setValue(Mc.a.kub,Box4Intl.Box4Strings.l_Picture);b=ik.DR.Gfi(this.context,
this.Rf,this.Hm);if(!b)return!1;this.Qf=b.node;this.Rf=(this.iJ=b.blob)?this.iJ.properties:this.Qf.properties;Of.a.ud().Co&&Of.a.ud().Ak.xG(this.Qf);return!0}fbe(){return this.HUf?this.z7m():this.s8m()}qfk(){this.D7.set("FileExtensions",this.gkm());this.D7.set("FileSizeInBytes",this.vgh.toString());this.D7.set("Source",this.MR);this.D7.set("NumberOfImagesAttemptedToInsert",this.avh.toString());this.D7.set("NumberOfImagesPasted",this.bvh.toString());if(Bd.a.lq){this.D7.set("ErrorLevel","warning");
var b=Object.assign(new bb.a,{extendedProperties:this.D7});this.He.logKpiFailure({kpiName:dd.d.yKa,errorName:"MultipleImageInsertFailed",optionalProperties:{additionalValues:b}})}else(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?(this.D7.set("ErrorLevel","warning"),b=Object.assign(new bb.a,{extendedProperties:this.D7}),this.He.logKpiFailure({kpiName:gj.c.OKa,errorName:"MultipleImageInsertFailed",optionalProperties:{additionalValues:b}})):Ba.Health.instance.recordKpiUsage("MultipleImageInsert",
0,this.E1d,this.D7)}gkm(){let b="";for(let h=0;h<this.qRe.length;++h)b=b+this.Cwi(this.qRe[h])+",";return b}vAa(b,h){Bd.a.iV&&this.Ho.WX([25]);this.Xrh&&(this.cGa=new Zc,this.cGa.iR=b.iR);super.vAa(b,h)}Hvb(b){this.Yq=b;if(!this.rob){if(this.Usd){if(hg.a(this.J)||this.Kub&&Y.a.EF){b.LYc(this.XUn);return}const h=b.LYc(null),r=this.Dwi(b);r&&(this.mRe=r.name,this.Wwa=r.size);if(!this.coa(h,b)||!this.RMg(r,b)){b=Object.assign(new bb.a,{extendedProperties:new Map});b.extendedProperties.set("type",this.coa(h,
this.Yq)?"Image too large":"FileType invalid");this.Bhe(b);this.whe();return}}this.vAa(b,null)}}i$d(){return!!ik.prc}whe(){var b;this.D7.set("FileExtension",this.Cwi(this.fileExtension));this.D7.set("Source",this.MR);this.D7.set("FileSizeInBytes",this.fileSize.toString());this.D7.set("RequestTimeInMs",this.jmi.toString());Bd.a.lq?this.He.logKpiUsage({kpiName:dd.d.yKa,kpiType:0,optionalProperties:{extendedProperties:this.D7}}):(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?
this.He.logKpiUsage({kpiName:gj.c.OKa,kpiType:0,optionalProperties:{extendedProperties:this.D7}}):Ba.Health.instance.recordKpiUsage(this.kpiName,0,this.E1d,this.D7)}Cwi(b){return b&&(b=b.split("."),1<b.length)?b[b.length-1].substring(0,4):""}qIi(){return this.bYi?Jk.a.KIh:Ri.obf}Dwi(b){return(b=b.iR)?b.files[0]:null}RMg(b,h){return b&&b.size>this.lth?(h&&h.lQd(),b=this.r5d(Xi.hpe),this.mq(this.fwi(Xi.hpe),b),!1):!0}r5d(b){switch(b){case Xi.rdd:return CommonUIStrings.l_ImageUploadNoFileSpecified;case Xi.DSi:return this.bYi?
CommonUIStrings.l_WordImageUploadUnsupportedFileType:CommonUIStrings.l_ImageUploadUnsupportedFileType;case Xi.hpe:return String.format(CommonUIStrings.l_ImageUploadSizeErrorWithLimit,Math.round(this.lth/1E6));default:return""}}Bhe(b){var h;Bd.a.lq?(b.extendedProperties.set("ErrorLevel","info"),this.He.logKpiFailure({kpiName:dd.d.yKa,errorName:"PictureFromLocalInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:Object(Ql.c)(dd.d.Zkc,b)})):(null===(h=y.AFrameworkApplication.J)||
void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:gj.c.Vlc,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","info"),this.He.logKpiFailure({kpiName:gj.c.OKa,errorName:"PictureFromLocalInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:h})):Ba.Health.instance.recordQosError("PictureFromLocalInvalid",Oo,!0,!0,!1,!1,b)}static get DR(){return null!=
ik.mXg?ik.mXg:ik.mXg=Za.a.instance.resolve(820)}}ik.prc=0;Object(u.a)(ik,"Box4PictureUploader",Ri,[621,478]);var Hm=d(833),Bk=d(146);class cj{constructor(){this.Tu=this.hs=this.NGb=this.BGh=this.X3b=this.vok=null;this.E5e=0;this.Nwa=this.J0e=this.aHb=null;this.fbh=0;this.PJe=this.Qxa=this.sYe=null;this.rmh=!1;this.ZIe=this.UIe=this.$Ie=null}get assetId(){return this.X3b}get thumbnailUrl(){return this.BGh}get Dco(){return this.NGb}get displayName(){return this.Nwa}get dimensions(){return String.format(Box4Intl.Box4Strings.l_ClipartDimensionsDisplay,
this.hs,this.Tu)}get P0k(){if(this.UIe&&this.ZIe&&this.$Ie){const b=document.createElement("a");b.setAttribute("href",this.$Ie);b.setAttribute("target","_blank");b.innerText=this.ZIe;return b}return null}get lPh(){return this.UIe}get fileSize(){return String.format(Box4Intl.Box4Strings.l_ClipartFileSizeDisplay,this.fbh)}get kko(){const b=document.createElement("span");var h=0;if(this.aHb&&0<this.aHb.length){var r=this.aHb.indexOf("."),A=0>r?this.aHb:this.aHb.substring(0,r);for(A=Number.parseInvariant(A);h<
A&&5>h;h++)b.appendChild(Gg.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Bk.a.ki("box42.png"),"","",!0,""));0<r&&(r=Number.parseInvariant(this.aHb.substr(r+1)),3>r?b.appendChild(Gg.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",Bk.a.ki("box42.png"),"","",!0,"")):8>r?b.appendChild(Gg.createClusteredImageFromCluster(13,13,"RsHalf_13x13x8","box42",Bk.a.ki("box42.png"),"","",!0,"")):b.appendChild(Gg.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Bk.a.ki("box42.png"),
"","",!0,"")),h++)}for(;5>h;h++)b.appendChild(Gg.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",Bk.a.ki("box42.png"),"","",!0,""));this.J0e&&(h=document.createElement("span"),h.innerText=String.format(Box4Intl.Box4Strings.l_ClipartRatingVotes,this.J0e),b.appendChild(h));return b}get xDo(){return 0<this.E5e?String.format(Box4Intl.Box4Strings.l_ClipartResolutionDisplay,this.E5e):""}get n9k(){if(this.rmh){var b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByCommunity;
return b}if(this.PJe&&this.Qxa)return cj.PEl(this.PJe,this.Qxa);b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByMicrosoft;return b}get keywords(){let b;if(this.sYe){const h=this.sYe.split(",");b=Array(h.length);for(let r=0;r<h.length;r++)b[r]=h[r].trim()}else b=[];return b}static xbm(b){const h=new cj;for(let r=0;r<b.childNodes.length;r++){const A=b.childNodes[r];if(1===A.nodeType)try{const M=A.firstChild.nodeValue;switch(A.nodeName){case "src":h.vok=M;break;case "assetid":h.X3b=
M;break;case "thumb":"64x64"===A.attributes.getNamedItem("size").nodeValue?h.BGh=cj.w1j(M):"192x192"===A.attributes.getNamedItem("size").nodeValue&&(h.NGb=cj.w1j(M));break;case "imagedim":if(M){const oa=M.indexOf("x");0<oa&&oa<M.length&&(h.hs=M.substr(0,oa),h.Tu=M.substr(oa+1))}break;case "resolution":h.E5e=Number.parseInvariant(M);break;case "rating":h.aHb=M;break;case "numofratings":h.J0e=M;break;case "displayname":h.Nwa=M;break;case "contentlength":h.fbh=Number.parseInvariant(M)/1024;break;case "subject":h.sYe=
M;break;case "provider":h.Qxa=M;break;case "attributionlink":h.PJe=M;break;case "iscsc":h.rmh=1===Number.parseInvariant(M);break;case "additional":const aa=A.firstChild;if(A.hasChildNodes()&&aa&&"id"===aa.nodeName&&1===Number.parseInvariant(aa.text))for(let oa=0;oa<A.childNodes.length;oa++){const Ja=A.childNodes[oa];switch(Ja.nodeName){case "caption":h.UIe=Ja.text;break;case "value":h.$Ie=Ja.text;break;case "string":h.ZIe=Ja.text}}}}catch(M){}}return h}static PEl(b,h){const r=document.createElement("a");
r.setAttribute("href",b);r.setAttribute("target","_blank");r.innerText=h;return r}static w1j(b){let h;return b&&0<(h=b.indexOf("://"))?b.substr(h+1):b}}Object(u.a)(cj,"ClipArtSearchResult",null,[]);class po{static get kh(){return ig.a.Ry(po.Hn,Box4Intl.Box4Strings.l_ClipartSearchButtonText,Box4Intl.Box4Strings.l_ClipartDefaultText)}}po.Hn="<div class='ClipartDialog' id='clipartdialog'> <div class='ClipartResultsPane' id='clipartresultspane'> <div class='ClipartSearchHeader' id='clipartsearchheader'> <input type='text' id='textInput' class='ClipartSearchInput' title='{0}' autocomplete=\"off\"/> <input type='image' id='btnSearch' class='WACButton ClipartSearchButton' title='{0}' alt='{0}'/> </div> <div class='ClipartSearchResults' id='clipartsearchresults'> {1} </div> </div> <div class='ClipartPreviewPane' id='clipartpreviewpane'> <div class='ClipartDisplayName UIFontBold' id='clipartattributedisplayname'> </div> <div class='ClipartSeeSimilar' id='clipartseesimilar'> </div> <div class='ClipartPreviewImage' id='clipartpreviewimage'> </div> <div class='ClipartPreviewDetails' id='clipartpreviewdetails'> <div class='ClipartAttributeContainer' id='clipartattribution'> <div class='ClipartAttributeName' id='clipartattributionname'> </div> <div class='ClipartAttributeValue' id='clipartattributionvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartadditional'> <div class='ClipartAttributeName' id='clipartadditionalname'> </div> <div class='ClipartAttributeValue' id='clipartadditionalvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartrating'> <div class='ClipartAttributeName' id='clipartratingname'> </div> <div class='ClipartAttributeValue' id='clipartratingvalue'> </div> </div> <div class='ClipartDimensions' id='clipartdimensions'> </div> <div class='ClipartAttributeContainer' id='clipartkeywords'> </div> </div> </div> </div>";
Object(u.a)(po,"InsertClipartDialogHtml",null,[]);class Zp extends ig.a{constructor(b){super();this.aGa=this.VDb=0;this.Ryh=null;this.O3e=!1;this.F9b=this.V3a=this.xQ=null;this.nmj=h=>{const r=this.AZ.value;r&&0<r.trim().length&&(this.search(this.AZ.value),this.iva(1,!1));h.preventDefault();h.stopPropagation()};this.v_n=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&(this.nmj(h),h.preventDefault(),h.stopPropagation())};this.omj=h=>{100<=this.AZ.value.length&&(h.preventDefault(),h.stopPropagation())};
this.RYn=h=>{h=Number.parseInvariant(h.target.parentNode.id.substr(4));this.ttj(h);this.pyg(h)};this.r0=()=>{if(this.Ls&&this.Ls.children&&!(2>this.Ls.children.length)){var h=this.Ls.children[0].children[0],r=this.Ls.clientHeight-(h.clientHeight-h.children[0].clientHeight+2)+this.Ls.scrollTop,A=h.clientHeight+2,M=parseInt(String(this.Ls.scrollTop/A));h=parseInt(String(r/A));var aa=parseInt(String(this.Ls.clientWidth/A));h<r/A&&h<parseInt(String(this.xQ.length/aa))&&h++;for(r=M;r<h;r++)for(A=0;A<aa;A++){var oa=
r*aa+A;M=this.xQ[oa];(oa=document.getElementById("clip"+oa))&&!oa.childNodes.length&&(M=this.Q$h(M),oa.appendChild(M))}}};this.A0n=h=>{h.target.setAttribute("src",Bk.a.ki("phthumb.64x64x32.png"))};this.SYn=h=>{h.target.setAttribute("src",Bk.a.ki("phpreview.96x96x32.png"))};this.zjj=h=>{Le.a.un(h.target.attributes.getNamedItem("href").value,h.target.attributes.getNamedItem("target").value,void 0,"InsertClipartDialog");h.stopPropagation();h.preventDefault()};this.XVn=h=>{(h?h.keyCode:window.event.keyCode)===
Sys.UI.Key.enter&&this.zjj(h)};this.Tjj=h=>{const r=h.target.innerText;this.AZ&&(this.AZ.value=r);this.search(r);h.stopPropagation();h.preventDefault();this.iva(1,!1)};this.FWn=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.Tjj(h)};this.qmj=h=>{this.xQ&&(this.NJo(this.xQ[this.VDb]),h.stopPropagation(),h.preventDefault(),this.AZ.value="",this.iva(1,!1))};this.w_n=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.qmj(h)};this.onKeyDown=h=>{if(h.keyCode>=Sys.UI.Key.left&&
h.keyCode<=Sys.UI.Key.down){let r=0;switch(h.keyCode){case Sys.UI.Key.up:r=-5;break;case Sys.UI.Key.down:r=5;break;case Sys.UI.Key.left:r=-1;break;case Sys.UI.Key.right:r=1}this.aGa=this.aGa+r<this.Ls.children.length-1?0>this.aGa+r?0:this.aGa+r:this.Ls.children.length-1;this.pyg(this.aGa);h.preventDefault();h.stopPropagation()}else h.keyCode===Sys.UI.Key.enter?(h=Number.parseInvariant(h.target.id.substr(4)),0<=h&&h<this.Ls.children.length&&this.aJj(h)):h.keyCode===Sys.UI.Key.tab&&(this.aGa=h.shiftKey?
Math.max(0,this.aGa-1):Math.min(this.aGa+1,this.Ls.children.length-1))};this.onError=()=>{this.Ls&&(this.Ls.innerText=Box4Intl.Box4Strings.l_ClipartCannotConnect)};this.Buj=h=>{if(this.Ls)if(h.data.cna){var r=h.data.cna.lastChild.childNodes;this.xQ||(this.xQ=[]);for(h=0;h<r.length&&100>this.xQ.length;h++){var A=r[h];1===A.nodeType&&"image"===A.nodeName&&(A=cj.xbm(A),this.xQ.push(A))}this.ofi();this.xQ.length||(this.Ls.innerText=Box4Intl.Box4Strings.l_ClipartNoResultsFound)}else if(h.data.De){h=I.a.cXj(h.data.De);
try{r=parseInt(h)}catch(M){r=14}this.Ls.innerText=26===r?Box4Intl.Box4Strings.l_ClipartCannotConnect:Box4Intl.Box4Strings.l_ClipartNoResultsFound}};this.ofi=()=>{if(this.xQ){Fd.a.DT(this.Ls);this.V3a&&(this.V3a.dispose(),this.V3a=null);this.Ls.focus();this.Ls.classList.remove("ClipartSearchInProgress");for(let r=0;r<this.xQ.length;r++){var h=document.createElement("a");h.setAttribute("href","#");h.id="itab"+r;const A=document.createElement("span");A.id="clip"+r;A.classList.add("ClipartImageContainer");
h.appendChild(A);this.Ls.appendChild(h);r<parseInt(String(this.Ls.clientHeight/A.clientHeight))*parseInt(String(this.Ls.clientWidth/A.clientWidth))&&(h=this.Q$h(this.xQ[r]),A.appendChild(h))}this.O3e&&(this.aJj(this.VDb),this.pyg(this.VDb))}};this.O6m=h=>{1===h&&this.xQ&&Zp.DR.Lja(this.dah.context)&&(h=this.xQ[this.VDb])&&this.dah.gEa(h)};this.dah=b;this.kh=po.kh;this.Ng="InsertClipartDialog";this.Qe(1,Box4Intl.Box4Strings.l_ClipartUploadButtonText);this.showDialog(Box4Intl.Box4Strings.l_ClipartUploadDialogTitle,
this.O6m);this.Ls=document.getElementById("clipartsearchresults");this.dLd=this.onKeyDown;mf.a.addHandler(this.Ls,"keydown",this.dLd);this.cLd=this.r0;mf.a.addHandler(this.Ls,"scroll",this.cLd);this.AZ=document.getElementById("textInput");this.ENd=this.v_n;mf.a.addHandler(this.AZ,"keydown",this.ENd);this.FNd=this.omj;mf.a.addHandler(this.AZ,"keypress",this.FNd);this.GNd=this.omj;mf.a.addHandler(this.AZ,"paste",this.GNd);this.fDc=document.getElementById("btnSearch");this.fDc.setAttribute("src",Bk.a.ki("search.16x16x32.png"));
this.bLd=this.nmj;mf.a.addHandler(this.fDc,"click",this.bLd);this.T5b=document.getElementById("clipartpreviewimage");this.lPe=document.getElementById("clipartattributedisplayname");this.Fhb=document.getElementById("clipartseesimilar");this.kPe=document.getElementById("clipartdimensions");this.JFc=document.getElementById("clipartadditionalvalue");this.mPe=document.getElementById("clipartratingvalue");this.T1a=document.getElementById("clipartattributionvalue");this.U1a=document.getElementById("clipartkeywords");
this.iPe=document.getElementById("clipartadditionalname");this.nPe=document.getElementById("clipartratingname");this.jPe=document.getElementById("clipartattributionname");this.Q3e=this.RYn;this.v$e=this.A0n;this.lCd=this.zjj;this.mCd=this.XVn;this.qYe=this.Tjj;this.rYe=this.FWn;this.fLd=this.qmj;this.gLd=this.w_n;this.AZ.focus();this.iva(1,!1)}dispose(){this.Ls&&this.d1h();this.Ls&&this.dLd&&(mf.a.removeHandler(this.Ls,"keydown",this.dLd),this.dLd=null);this.Ls&&this.cLd&&(mf.a.removeHandler(this.Ls,
"scroll",this.cLd),this.cLd=null);this.Ls=null;this.AZ&&this.ENd&&(mf.a.removeHandler(this.AZ,"keydown",this.ENd),this.ENd=null);this.AZ&&this.FNd&&(mf.a.removeHandler(this.AZ,"keypress",this.FNd),this.FNd=null);this.AZ&&this.GNd&&(mf.a.removeHandler(this.AZ,"paste",this.GNd),this.GNd=null);this.AZ=null;this.fDc&&this.bLd&&(mf.a.removeHandler(this.fDc,"click",this.bLd),this.fDc=this.bLd=null);this.jPe=this.nPe=this.iPe=this.U1a=this.T1a=this.mPe=this.JFc=this.kPe=this.Fhb=this.lPe=this.T5b=this.gLd=
this.fLd=this.rYe=this.qYe=this.mCd=this.lCd=this.F9b=this.v$e=this.Q3e=null;this.V3a&&(this.V3a.dispose(),this.V3a=null);super.dispose()}LN(){super.LN();document.getElementById(this.Bj("WACDialogPanel")).style.width=String.format("{0}px",656)}search(b){this.ZZb(b,!1,this.Buj)}ZZb(b,h,r){this.aGa=this.VDb=0;this.d1h();if(this.xQ&&b===this.Ryh&&this.O3e===h)window.setTimeout(this.ofi,500);else{this.xQ&&(Array.clear(this.xQ),this.xQ=null);this.Ryh=b;this.O3e=h;var A=new Sys.StringBuilder('<search xmlns="urn:schema-microsoft-com:office:office">');
A.append("<query>");A.append(I.a.Jf(b));A.append("</query>");A.append("<mediatype>Illustration</mediatype>");A.append("<mediatype>Photo</mediatype>");A.append("<filetype>jpg</filetype>");A.append("<filetype>jpeg</filetype>");A.append("<filetype>gif</filetype>");A.append("<filetype>bmp</filetype>");A.append("<filetype>tif</filetype>");A.append("<filetype>tiff</filetype>");A.append("<filetype>png</filetype>");A.append("</search>");b=y.AFrameworkApplication.lcid.toString(16).toUpperCase();for(let M=
b.length;4>M;M++)b="0"+b;y.AFrameworkApplication.Ee.Wj(String.format("{0}OfficeOnlineProxy.ashx?lidhelp={1}&liduser={1}&lidui={1}&{2}={3}",df.a.webServiceBase,b,Pi.a.r6o,h.toString()),2,A.toString(),{"Content-Type":"text/xml; charset=utf-8"},!0,2,r,this.onError,null)}}NJo(b){this.ZZb(b.assetId,!0,this.Buj);this.xQ||(this.xQ=[],this.xQ.push(b))}Q$h(b){const h=document.createElement("img");h.classList.add("ClipartThumbImage");h.setAttribute("src",b.thumbnailUrl);b=b.displayName?b.displayName:Box4Intl.Box4Strings.l_ClipartImageAltNoCaption;
h.setAttribute("title",b);h.setAttribute("alt",b);mf.a.addHandler(h,"click",this.Q3e);mf.a.addHandler(h,"error",this.v$e);return h}GOl(b){1===b.childNodes.length&&(b=b.childNodes[0],mf.a.removeHandler(b,"click",this.Q3e),mf.a.removeHandler(b,"error",this.v$e))}ttj(b){const h=this.xQ[b];var r=h.Dco;this.b1h();this.F9b=this.SYn;var A=document.createElement("img");A.setAttribute("src",r);if(h.displayName)r=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltWithCaption,h.displayName);else{r=new Sys.StringBuilder;
for(let M=0;M<h.keywords.length&&5>M;M++)M&&r.append(", "),r.append(h.keywords[M]);r=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltNoCaption,r.toString())}A.setAttribute("title",r);A.setAttribute("alt",r);mf.a.addHandler(A,"error",this.F9b);this.T5b.appendChild(A);A=document.getElementById("clip"+this.VDb);A.classList.remove("ClipartSelectedImage");A=document.getElementById("clip"+b);A.classList.add("ClipartSelectedImage");this.VDb=b;h.displayName&&(this.lPe.innerText=h.displayName);b=document.createElement("a");
b.innerText=Box4Intl.Box4Strings.l_ClipartSeeSimilarLink;b.setAttribute("href",'""');mf.a.addHandler(b,"click",this.fLd);mf.a.addHandler(b,"keydown",this.gLd);this.Fhb.appendChild(b);this.kPe.innerText=String.format("{0} | {1} | {2}",h.dimensions,h.xDo,h.fileSize);(b=h.P0k)&&h.lPh?(this.JFc.parentNode.style.display="block",this.iPe.innerText=h.lPh,this.JFc.appendChild(b)):this.JFc.parentNode.style.display="none";this.mPe.appendChild(h.kko);Fd.a.DT(this.T1a);if(b=h.n9k)this.T1a.appendChild(b),"a"===
b.nodeName.toLowerCase()&&(mf.a.addHandler(b,"click",this.lCd),mf.a.addHandler(b,"keydown",this.mCd));this.U1a.innerText=Box4Intl.Box4Strings.l_ClipartKeywords;for(b=0;b<h.keywords.length;b++)A=h.keywords[b],r=document.createElement("a"),r.innerText=A,r.setAttribute("href",'""'),mf.a.addHandler(r,"click",this.qYe),mf.a.addHandler(r,"keydown",this.rYe),this.U1a.appendChild(r),b<h.keywords.length-1&&(A=document.createElement("span"),A.innerText=", ",this.U1a.appendChild(A));this.nPe.innerText=Box4Intl.Box4Strings.l_ClipartRating;
this.jPe.innerText=Box4Intl.Box4Strings.l_ClipartProvidedBy;this.iva(1,!0)}b1h(){this.T5b&&1===this.T5b.childNodes.length&&(this.F9b&&(mf.a.removeHandler(this.T5b.childNodes[0],"error",this.F9b),this.F9b=null),Fd.a.DT(this.T5b));this.T1a&&0<this.T1a.childNodes.length&&"a"===this.T1a.childNodes[0].nodeName.toLowerCase()&&(this.lCd&&mf.a.removeHandler(this.T1a.childNodes[0],"click",this.lCd),this.mCd&&mf.a.removeHandler(this.T1a.childNodes[0],"keydown",this.mCd));this.Fhb&&0<this.Fhb.children.length&&
"a"===this.Fhb.children[0].nodeName.toLowerCase()&&(this.fLd&&mf.a.removeHandler(this.Fhb.children[0],"click",this.fLd),this.gLd&&mf.a.removeHandler(this.Fhb.children[0],"keydown",this.gLd),Fd.a.DT(this.Fhb));if(this.U1a){for(let b=0;b<this.U1a.childNodes.length;b++){const h=this.U1a.childNodes[b];"a"===h.nodeName.toLowerCase()&&(mf.a.removeHandler(h,"click",this.qYe),mf.a.removeHandler(h,"keydown",this.rYe))}Fd.a.DT(this.U1a)}this.lPe.innerText="";this.kPe.innerText="";Fd.a.DT(this.JFc);Fd.a.DT(this.mPe);
Fd.a.DT(this.T1a);this.U1a.innerText="";this.iPe.innerText="";this.nPe.innerText="";this.jPe.innerText=""}aJj(b){if(!(this.Ls.children.length<=b||0>b)){var h=this.Ls.children[b],r=this.Ls.children[0];r=r.clientHeight-r.children[0].clientHeight+2;this.Ls.scrollTop+this.Ls.clientHeight<h.offsetTop+h.clientHeight?this.Ls.scrollTop=h.offsetTop-3*h.clientHeight-r:this.Ls.scrollTop>h.offsetTop&&(this.Ls.scrollTop=h.offsetTop-r/2);this.ttj(b)}}validate(){return!0}d1h(){if(Cd.FocusManager.nM()){var b=Cd.FocusManager.instance().getRegion(this.dN);
b&&b.Nk.hA(this.AZ)}else this.AZ.focus();for(b=0;b<this.Ls.childNodes.length;b++){const h=this.Ls.childNodes[b];1===h.childNodes.length&&this.GOl(h.childNodes[0])}Fd.a.DT(this.Ls);this.b1h();this.iva(1,!1);this.V3a=new Hm.a(Box4Intl.Box4Strings.l_ClipartSearching);this.V3a.J0i=!1;this.Ls.appendChild(this.V3a.element);this.Ls.classList.add("ClipartSearchInProgress")}pyg(b){this.aGa=b;b=this.Ls.children[this.aGa];Cd.FocusManager.nM()?Cd.FocusManager.instance().getRegion(this.dN).Nk.hA(b):b.focus()}static get DR(){return Zp.Dk=
Zp.Dk||Za.a.instance.resolve(820)}}Zp.Dk=null;Object(u.a)(Zp,"InsertClipartDialog",ig.a,[]);class mq extends ik{constructor(b,h,r,A,M,aa,oa){super(b,h,r,A,M,aa,oa,!1);this.yYn=Ja=>{if(this.Uln()){var fb=this.Qf.Jj(),Cb=fb.wg.kr.toString(),Gb=new Sys.Net.WebRequest;Gb.set_url("ClipArtUpload.ashx");Gb=new Sys.StringBuilder(Gb.getResolvedUrl());this.LZ(Gb,Pi.a.assetId,Ja.assetId,!0);this.LZ(Gb,Uj.a.lcid,y.AFrameworkApplication.lcid.toString());this.LZ(Gb,Uj.a.nodeId,this.iJ?this.iJ.id.toString():this.Qf.id.toString());
this.LZ(Gb,Uj.a.cellId,fb.ml.toString());this.LZ(Gb,Uj.a.fileId,fb.yq);this.LZ(Gb,Uj.a.dza,Cb);this.LZ(Gb,Uj.a.f_,this.Hm.toString());Ja=this.Qf.ka(fd.a.YJ,Ml.a.Hu);this.LZ(Gb,Uj.a.YJ,Ja.toString());this.LZ(Gb,Uj.a.tAb,"1");fb.NG&&this.LZ(Gb,Uj.a.NG,fb.NG);this.LZ(Gb,Uj.a.classId,this.iJ?this.iJ.properties.wc.toString():this.Qf.wc.toString());this.Rf.hasProperty(Mc.a.imageType)&&this.LZ(Gb,Pi.a.imageType,this.Rf.getValue(Mc.a.imageType).toString());tm.a.instance.$Xk(Gb);y.AFrameworkApplication.Ee.Wj(Gb.toString(),
2,"",{},!1,2,this.eyp,this.m8j,null);ik.prc++}};this.eyp=Ja=>{if(({group:fb}=tk.a.z4(Ja.data.De)).returnValue){var fb=fb.Responses[0];fb.Zwb=Ja.data.bH;fb.dr=Ja.data.vi?Ja.data.vi[mm.a.s2]:"";this.aoa(fb)}else this.m8j(null)};this.m8j=()=>{const Ja=new Pp.a;Ja.StatusCode=14;this.aoa(Ja)};new Zp(this)}gEa(b){this.fbe()&&this.Qf.Jj().wg.xF(this.yYn,null,b)}LZ(b,h,r,A){b.append(A?"?":"&");b.append(I.a.Yi(h));b.append("=");b.append(I.a.Yi(r))}AAf(b){switch(b){case 26:return Box4Intl.Box4Strings.l_ClipartCannotConnect;
case 27:return Box4Intl.Box4Strings.l_ClipartCannotDownload;default:return super.AAf(b)}}aoa(b){super.aoa(b);ik.prc--}}Object(u.a)(mq,"ClipartUploader",ik,[]);var lc=d(11),bn=d(409);class Ec{constructor(b,h,r){this.P6m=(A,M,aa,oa,Ja)=>{if(!this.Dk||!this.Dk.value)return v.ULS.sendTraceTag(524109267,306,15,"ImageEditor not available"),8;A=this.Dk.value.Lja(M);return 2===aa&&A?(new mq(M,Je.a.instance,y.AFrameworkApplication.J,Ja,this.An,this.ga,new bn.b),32):1===aa?A&&df.a.X1h?32:8:2};this.Dk=b;this.An=
h;this.ga=r}Xb(){this.ga.fb(ub.a.VQi,lc.a.view,this.P6m,260)}}Object(u.a)(Ec,"ClipArtActor",null,[]);class yl{constructor(){this.W=null}get name(){return"Box4.ClipArt"}uc(b){this.W=b;b.ia(821,()=>new Ec(b.rf(820),b.resolve(50),y.AFrameworkApplication.va)).ha()}init(){this.W.resolve(821).Xb();const b=qa.StaticActiveAppFrame.za();b&&b.Fe()}dispose(){}}Object(u.a)(yl,"ClipartPackage",null,[0,1]);class np{constructor(b){this.s4a=this.c4a=this.z4a=this.y4a=null;this.pjh=this.Qdh=this.qjh=this.wqh=this.ui=
this.pxa=!1;this.s5e=this.crh=null;this.Mqh=0;this.Ga=this.Yqh=null;this.lia=b;this.iQ=3;this.z7b=!0}initialize(b,h,r){this.y4a=this.xMf(b,h);this.z4a=CommonUIStrings.l_SavingStatus;this.c4a=CommonUIStrings.l_ReadOnlyStatus;this.s4a=CommonUIStrings.l_ReviewModeStatus;this.lia&&this.lia.execute(A=>{A.RJb(Object(E.a)(this,this.Isd,"updateToSavingStatus"))});this.ui=!0;this.Ga=r;this.Qdh=this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",!1);return!0}fAb(b,h){this.pxa=
b;this.iQ=h;this.q0a(this.z7b)}q0a(b){!this.z7b&&b&&(this.Yqh=new Date);this.z7b=b;this.pjh=!1;b=null;3===this.iQ&&(b=this.z7b?this.y4a:this.z4a);this.XSl(b)}xMf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,h):CommonUIStrings.l_SavedStatus}Isd(){this.q0a(!1)}wxm(){switch(this.iQ){case 1:return this.c4a;case 2:return this.s4a;default:return null}}vxm(){if(3!==this.iQ)switch(this.iQ){case 1:return"ReadOnly";
case 2:return"ReviewOnly";default:return null}return this.pjh?"FailedToSave":this.z7b?"Saved":"Saving"}Den(b){return this.wqh===this.pxa&&this.Mqh===this.iQ&&this.crh===b}Wwf(b){appChrome.getHeaderApi().then(h=>{h.updateDocumentTitleStatus(this.pxa,b,this.wxm(),this.Yqh,this.z7b,this.Qdh?h.getHeaderSaveStatusIconProps(this.vxm()):null);this.qjh=!0;return null});this.s5e=null}XSl(b){this.ui&&hh.c()&&!this.Den(b)&&(!this.qjh&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",
!1)?this.Wwf(b):Le.a.Tte()?(this.s5e&&v.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.s5e=window.requestIdleCallback(()=>{this.Wwf(b)})):window.requestAnimationFrame(()=>{this.Wwf(b)}),this.wqh=this.pxa,this.crh=b,this.Mqh=this.iQ)}}Object(u.a)(np,"ReactSaveStatusUIHandler",null,[602]);class ap{constructor(b,h){this.K_=null;this.y4a=CommonUIStrings.l_SavedStatus;this.z4a=CommonUIStrings.l_SavingStatus;this.c4a=CommonUIStrings.l_ReadOnlyStatus;
this.s4a=CommonUIStrings.l_ReviewModeStatus;this.vib=h;this.lia=b;this.iQ=3;this.xkb=!0}zE(){this.lia&&this.lia.execute(b=>{b.RJb(Object(E.a)(this,this.Isd,"updateToSavingStatus"))});this.vib.execute(b=>{this.K_=b})}fAb(b,h){this.iQ=h;3===h?this.q0a(this.xkb):2===h?this.EJg(this.s4a):this.EJg(this.c4a)}Isd(){this.q0a(!1)}q0a(b){this.xkb=b;this.EJg(this.xkb?this.y4a:this.z4a)}EJg(b){this.K_&&this.K_.sendMessage(C.a.Snp,this.Jwl(b))}Jwl(b){const h={};h.StatusText=b;return h}}Object(u.a)(ap,"SaveStatusPostMessageHandler",
null,[602]);var Dn=d(1007),Co=d(171);class zp{constructor(b,h,r,A){this.s4a=this.c4a=this.z4a=this.y4a=null;this.vFb=0;this.J1=this.x6e=this.iBb=this.DJe=this.I$e=null;this.Eg=b;this.qib=h;this.lia=r;this.Xm=A;this.qnh=!0;this.pxa=!1;this.iQ=3;this.xkb=!0}initialize(b,h){if(!this.Eg)return!1;this.y4a=this.xMf(b,h);this.z4a=CommonUIStrings.l_SavingStatus;this.c4a=CommonUIStrings.l_ReadOnlyStatus;this.s4a=CommonUIStrings.l_ReviewModeStatus;this.zE();return!0}xMf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,
CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,h):CommonUIStrings.l_SavedStatus}zE(){this.qib&&this.qib.execute(b=>{b.E_k(Object(E.a)(this,this.w$h,"createStatusAndModeElements"));b.n_k(Object(E.a)(this,this.k4o,"showHideSaveStatusElement"));b.Lip&&this.w$h(null,null)});this.lia&&this.lia.execute(b=>{b.RJb(Object(E.a)(this,this.Isd,"updateToSavingStatus"))})}tY(){this.J1&&this.Eg&&this.Eg.AEa(this.J1)}k4o(b,h){this.fAb("true"===h,this.iQ)}fAb(b,h){this.pxa=
b;this.iQ=h;this.DJe&&(this.DJe.style.display=this.pxa||3===this.iQ||!this.I$e?"none":"");this.iBb&&(this.iBb.style.display=this.pxa||3===this.iQ?"none":"",this.iBb.innerText=1===this.iQ?this.c4a:this.s4a,this.iBb.title=1===this.iQ?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.x6e&&(this.x6e.style.display=this.pxa||1===this.iQ||!this.I$e&&!this.iBb?"none":"");this.J1&&(this.J1.style.display=this.pxa||1===this.iQ?"none":"",this.q0a(this.xkb),this.J1.title=
CommonUIStrings.l_SaveStatusTooltip)}w$h(b,h){b=document.getElementById(Dn.a.JXm);h&&h.sDp||!b||""===this.y4a||""===this.z4a||""===this.c4a||""===this.s4a||(this.I$e=document.getElementById(Dn.a.Rkf),this.DJe=Dn.a.wXd(b,"BreadcrumbAppModeDash","-"),this.iBb=Dn.a.wXd(b,"BreadcrumbAppModeStatus",1===this.iQ?this.c4a:this.s4a),this.q5j(this.iBb),this.x6e=Dn.a.wXd(b,"BreadcrumbSaveStatusDash","-"),this.J1=Dn.a.wXd(b,"BreadcrumbSaveStatus",this.y4a),this.q5j(this.J1),this.fAb(this.pxa,this.iQ))}Isd(){this.q0a(!1)}q0a(b){this.xkb=
b;this.vwp(this.xkb?this.y4a:this.z4a)}vwp(b){!this.J1||3!==this.iQ&&2!==this.iQ||(this.qnh&&!this.xkb?(this.vFb=this.J1.offsetWidth<this.vFb?this.vFb:this.J1.offsetWidth,this.Sqp(this.z4a),this.qnh=!1):this.J1.innerText=b)}q5j(b){b.style.direction=this.Xm?"rtl":"ltr";b.style.width="auto";b.style.textAlign=this.Xm?"right":"left";b.style.display=this.pxa?"none":"";b.setAttribute("Unselectable","on")}Sqp(b){this.J1&&(this.J1.style.width="",this.J1.innerText=b,this.vFb=this.J1.offsetWidth<this.vFb?this.vFb:
this.J1.offsetWidth,b=Co.a.QB(this.J1),this.J1.style.width=this.vFb-Fd.a.zP(b.paddingLeft)-Fd.a.zP(b.paddingRight)+1+"px")}}Object(u.a)(zp,"SaveStatusUIHandler",null,[602]);var Do=d(107);class vc{constructor(){this.y6e=this.C4e=this.ASa=this.W=null;this.fz=()=>{const b=y.AFrameworkApplication.J,h=!!y.AFrameworkApplication.ua.Ib&&4===y.AFrameworkApplication.ua.Ib.Uk;if(b.$("WordEditorAutoSaveImprovementIsEnabled")||b.$("PptEditorSaveStatusInHeaderEnabled")||h&&b.$("SimplifiedReactRibbonUxIsEnabled")||
b.$("ExcelSaveStatusInHeaderEnabled")||b.$("VisioSaveStatusInHeaderEnabled"))y.AFrameworkApplication.J.$("PostMessageEmbedded")&&y.AFrameworkApplication.I_?(this.y6e=this.W.resolve(822))&&this.y6e.zE():y.AFrameworkApplication.ua.Ib.c0f||y.AFrameworkApplication.hideHeader||(y.AFrameworkApplication.ua.Ib.vN?(this.C4e=this.W.resolve(823))&&this.C4e.initialize(b.$("IsSkyDrive"),b.ib("HostNameToIncludeInSavedStatus"),y.AFrameworkApplication.J):(this.ASa=this.W.resolve(824))&&this.ASa.initialize(b.$("IsSkyDrive"),
b.ib("HostNameToIncludeInSavedStatus")))}}get name(){return"Common.App.SaveStatus"}uc(b){this.W=b;y.AFrameworkApplication.J.$("PostMessageEmbedded")&&y.AFrameworkApplication.I_?this.W.register(ap,822).as(55).ha().Sd(()=>new ap(this.W.Ra(798),this.W.Ra(7))):y.AFrameworkApplication.ua.Ib.c0f||(y.AFrameworkApplication.ua.Ib.vN?this.W.register(np,823).as(55).ha().Sd(()=>new np(this.W.Ra(798))):this.W.register(zp,824).as(55).ha().Sd(()=>new zp(Do.EventHandlerManager.instance,this.W.Ra(692),this.W.Ra(798),
y.AFrameworkApplication.isRtl)))}init(){y.AFrameworkApplication.J.Uo(this.fz)}dispose(){this.ASa&&this.ASa.tY()}}Object(u.a)(vc,"PackageManager",null,[0,1]);var go=d(1613);class nm{get name(){return"Common.App.EventsCachePackage"}uc(){}init(){go.a.instance.init()}dispose(){}static main(){K.a.instance.Lc(new nm)}}Object(u.a)(nm,"EventsCachePackage",null,[0,1]);var zl=d(125),ck=d(260),vl=d(1370),Xk=d(1248),Vg=d(450),$p=d(1426),Rl=d(1392),yf=d(1359),Pm=d(277),Og=d(1362);class Dl{constructor(b){this.ymh=
!1;this.zvd=this.kn=null;this.CIe=!1;this.dG=b}get control(){return this.dG}get Ud(){return this.control.Ud}get root(){return this.control.root}get cK(){return this.control.cK}get s5a(){return this.control.s5a}get $k(){return this.control.$k}get JG(){return this.control.JG}SK(){}initialize(){}ey(b,h,r){this.control.RTl(b,h,r)}rn(){yf.c(this.control.$h.Command)||this.pv(this.control.$h.Command,null,null)}pv(b,h,r){let A=0;this.root&&(A=this.root.Cua(b,h,r));this.control.enabled=0<(A&1);return A}wfb(){let b=
this.control.visible;this.root.M_a&&(b=this.Ud[Pm.a.visible],b!==this.control.visible&&(this.control.visible=b,this.root.$qc=!0));return b}hLg(){const b=Og.a.$va(this.Ud[Pm.a.labelText],this.control.$h.LabelText);this.Lwe(b)}Lwe(b){this.control.labelText!==b&&(this.JG.forEach(h=>{h.Lwe(b)}),this.control.labelText=b,this.root.ybb=!0)}f2b(){const b=Og.a.$va(this.Ud[Pm.a.alt],this.control.$h.Alt);this.Gwc(b)}Gwc(b){this.control.tooltip!==b&&(this.JG.forEach(h=>{h.Gwc(b)}),this.control.tooltip=b)}Zna(){const b=
Og.a.$va(this.Ud[Xk.a.Image16by16Class],this.control.$h.Image16by16Class),h=Og.a.$va(this.Ud[Xk.a.Image32by32Class],this.control.$h.Image32by32Class);var r=Og.a.$va(this.Ud[Xk.a.Image48by48Class],this.control.$h.Image48by48Class);r=yf.b(r)?h:r;this.ASc(this.JG.small,b);this.ASc(this.JG.Ds,b);this.ASc(this.JG.CX,h);this.ASc(this.JG.w7o,b);this.ASc(this.JG.tpc,r)}ASc(b,h){!b||yf.c(b.bU)||yf.c(h)||b.bU.className===h||(b.bU.className=h)}Fsp(b){if(!yf.b(b)&&this.root.rFg){for(const h of this.control.Lpf){const r=
h.LW===b;r&&(this.control.Scf=h);this.control.visible&&(h.lC=r)}this.control.visible&&(this.root.ybb=!0)}}f1k(){if(this.JG.tpc&&this.JG.tpc.dR&&this.JG.tpc.Lob){const b=this.JG.tpc.dR,h=Og.a.$va(this.Ud[Vg.a.Description],this.control.$h.Description);yf.b(h)&&(b.style.position="relative",b.style.top=(b.parentNode.offsetHeight-b.offsetHeight)/2+"px",b.style.padding="0px")}}onFocus(){const b=this.$k;Object(Xa.a)($p.a,b)?this.cK.$zb(b):this.root.RLb=this.control;return!1}onBlur(){const b=this.$k;this.control.nTb()&&
Og.a.Hx(b.Rc,"cui-ctl-menu-hovered-without-focus");this.root.RLb=null;return!1}$R(b){if(this.control.nTb()){var h=this.cK.yva;const r=h===this.root.eVb-1;h=r?null:this.root.nE[h+1];this.yof(!1);r||this.control===h||Og.a.Hx(h.$Tb,Rl.MenuLauncher.ycd);this.control.enabled&&this.control.Ev?r?this.control.F0():(Og.a.qg(this.$k.Rc,"cui-ctl-menu-hovered-without-focus"),h.ska=this.control.Ev):r?this.cK.setFocus(b.zg):(h.ska=this.cK.Rc,this.cK.Vua())}return!1}OL(){this.control.nTb()&&Og.a.Hx(this.$k.Rc,"cui-ctl-menu-hovered-without-focus");
return!1}onKeyDown(b){let h=!1;if(!yf.c(b.Nb)&&!yf.c(b.Nb.rawEvent)){const r=b.Nb.keyCode;b=b.Nb.rawEvent.shiftKey;r===Sys.UI.Key.enter&&(h=!0);if(Object(Xa.a)($p.a,this.$k)){const A=this.cK;if(!yf.c(A)){const M=A.yva,aa=0===this.root.t4,oa=!yf.c(this.control.h6n);if(r!==Sys.UI.Key.tab&&r!==Sys.UI.Key.left&&r!==Sys.UI.Key.right&&r!==Sys.UI.Key.up&&r!==Sys.UI.Key.down&&r!==Sys.UI.Key.esc)return h;Le.a.Unf();r!==Sys.UI.Key.tab||b?r===Sys.UI.Key.tab&&b?(A.cN(1),h=!0):r===Sys.UI.Key.left&&aa||r===Sys.UI.Key.right&&
!aa?(oa?A.cN(2):0<M&&this.root.D6a(M,!0,!1),h=!0):r===Sys.UI.Key.right&&aa||r===Sys.UI.Key.left&&!aa?(oa&&A.cN(4),h=!0):r===Sys.UI.Key.up?(A.cN(5),h=!0):r===Sys.UI.Key.down?(A.cN(6),h=!0):r===Sys.UI.Key.esc&&(this.root.D6a(M,!0,!1),h=!0):(A.cN(0),h=!0)}}}return h}Zz(b){let h=!1;if(!yf.c(b.Nb)&&!yf.c(b.Nb.rawEvent)){const r=b.Nb.keyCode;Xb.KeyInputManager.YLi(b)||r!==Sys.UI.Key.enter&&r!==Sys.UI.Key.space||(h=this.wQf(b),h||(this.ey(b.If,1,b.Nb),h=!0))}return h}rE(b){this.xpf();if(this.s5a){let h=
!0;2===b.zg&&(h=b.gga===Sys.UI.MouseButton.leftButton);h&&this.$k&&this.SPd(this.$k.Rc)}(b.Nb.type.toLowerCase()!==Jd.a.wS||this.s5a)&&b.Nb.preventDefault();return!1}get FWf(){return this.ymh}gYl(){this.ymh=!0}xpf(){this.FWf&&this.control.root.onb()}OCa(b){Object(Xa.a)($p.a,this.$k)&&!this.s5a&&2===b.zg&&b.gga===Sys.UI.MouseButton.leftButton?(this.ey(b.If,b.zg,b.Nb),b=!0):b=this.control.Wza(b);return b}onClick(b){let h=!1;Object(Xa.a)($p.a,this.$k)&&!this.s5a&&3===b.zg&&(this.ey(b.If,b.zg,b.Nb),h=
!0);return Y.a.Ci?!1:h}Gvb(b){return this.Xke(b)}GMa(b){this.Wza(b);return!1}Xke(b){return yf.c(this.kn)?!1:(this.Dxg(Le.a.foc(this.RKh,b.clientPoint)),!0)}Qrc(b){let h=!1;this.Wza(b)&&(h=!0);3!==b.zg&&(b=!0,!this.root&&Dl.Ibg&&(v.ULS.sendTraceTag(588084884,207,50,"Root is null"),b=!1),b&&this.root.v6(),h=!0);return h}Urc(b){return this.Wza(b)}Rrc(b){return this.Xke(b)}Trc(b){return this.Wza(b)}Orc(b){return 3===b.zg?(this.root.v6(),!0):!1}Prc(){return!1}get RKh(){!yf.c(this.kn)&&yf.c(this.zvd)&&
(this.zvd=Le.a.getElementBounds(this.kn));return this.zvd}Dxg(b){this.CIe!==b&&(this.CIe=b,this.Tcf(this.CIe))}Tcf(b){yf.c(this.kn)||Og.a.X8(this.kn,vl.a.VPd,b)}SPd(b){this.control.enabled&&(this.kn=b,this.root.mRc=this.control,this.Dxg(!0),this.root.Fja(this.control,!1))}Wza(b){if(!yf.c(this.kn)){this.Dxg(!1);let h=!!this.root;if(Dl.Ibg){const r=ce.ActionManager.dea(parseInt(this.control.$h.Command))||"";v.ULS.sendTraceTag(588084885,207,50,"Root not null: {0}, Action: {1}",h,r)}h&&this.root.Sea(this.control,
!1);yf.c(b)||Le.a.foc(this.RKh,b.clientPoint)&&this.ey(this.kn,b.zg,b.Nb);h=!!this.root;Dl.Ibg&&v.ULS.sendTraceTag(588084886,207,50,"Root not null: {0}",h);h&&(this.root.mRc=null);this.zvd=this.kn=null;return!0}return!1}cN(b){return Object(Xa.a)($p.a,this.$k)&&2!==b&&4!==b&&!Le.a.Hmc(this.control.Ev)?this.F0():!1}F0(){try{if(this.control.visible){const b=this.control.Ev;if(!yf.c(b))return b.focus(),!0}}catch(b){}return!1}yof(b){const h=this.cK;yf.c(h)||this.root.D6a(h.yva+1,b)}lua(){}wQf(){return!1}AR(b){let h=
null;b&&b.rawEvent&&(h={},h[Dl.triggerTime]=b.rawEvent.timeStamp);return h}static get Ibg(){null==Dl.E0e&&(Dl.E0e=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("NullCheckRootInOnModalBodyPointerDownIsEnabled"));return Dl.E0e}}Dl.triggerTime="TriggerTime";Dl.E0e=null;Object(u.a)(Dl,"ControlBehavior",null,[612]);var Yl=d(180);class Mk extends Dl{constructor(b){super(b)}get button(){return this.control}get properties(){return this.control.$h}SK(b){const h=b.In;b=b.LW;yf.c(h)||(vf.a.instance.nb(Jd.a.focus,
h,Object(E.a)(this,this.onFocus,"onFocus")),vf.a.instance.nb(Jd.a.blur,h,Object(E.a)(this,this.onBlur,"onBlur")),ck.a.instance.nb(Jd.a.UL,h,Object(E.a)(this,this.$R,"onPointerOver")),ck.a.instance.nb(Jd.a.jH,h,Object(E.a)(this,this.OL,"onPointerOut")),Xb.KeyInputManager.instance.LI(Jd.a.hj,h,Object(E.a)(this,this.onKeyDown,"onKeyDown"),b),Xb.KeyInputManager.instance.LI(Jd.a.mv,h,Object(E.a)(this,this.HI,"onKeyPress"),b),Xb.KeyInputManager.instance.LI(Jd.a.pi,h,Object(E.a)(this,this.Zz,"onKeyUp"),
b),ck.a.instance.nb(Jd.a.gt,h,Object(E.a)(this,this.rE,"onPointerDown")),ck.a.instance.nb(Jd.a.BP,h,Object(E.a)(this,this.OCa,"onPointerUp")),Qc.a.instance.nb(Jd.a.click,h,Object(E.a)(this,this.onClick,"onClick")),Yl.a.instance.nb(Jd.a.vS,h,Object(E.a)(this,this.Gvb,"onTouchMove")),Yl.a.instance.nb(Jd.a.jM,h,Object(E.a)(this,this.GMa,"onTouchEnd")))}ey(b,h,r){this.control.enabled&&(b=null,this.$k&&this.$k.e9c()&&this.cK&&(b=this.root.nE[this.cK.yva])&&!this.FWf&&(b.a_a(this.button),b=null),this.executeCommand(this.control.$h.Command,
h,!0,r),b&&b.a_a(this.button))}executeCommand(b,h,r,A){if(!yf.c(b)){const M=this.Ud;M.CommandValueId=this.button.XOb();M.MenuItemId=this.button.$h.MenuItemId;M.SourceControlId=this.control.id;this.root.executeCommand(b,M,this.$k,h,r,null,this.AR(A))}}rn(){yf.c(this.control.$h.Command)||0<(this.pv(this.properties.Command,this.properties.QueryCommand,this.Ud)&2)&&this.wfb()&&this.o0a()}o0a(){this.hLg();this.f2b();this.Zna()}onFocus(b){super.onFocus(b);this.gEg();return!1}onBlur(b){super.onBlur(b);this.xzf();
return!1}onKeyDown(b){let h=super.onKeyDown(b);yf.c(b.Nb)||this.QAg(b.rq,b.Nb.keyCode)&&(h=!1);return h}HI(b){let h=!1;yf.c(b.Nb)||yf.c(b.Nb.rawEvent)||(this.QAg(b.rq,b.Nb.rawEvent.keyCode)?(this.ey(b.If,b.zg,b.Nb),h=!0):b.Nb.preventDefault());return h}QAg(b,h){if(Y.a.Jt&&h===Sys.UI.Key.enter)switch(b){case "MenuMru":case "MenuTemplate":case "MenuHeader":case "MenuFooter":return!0}return!1}Zz(b){let h=!1;yf.c(b.Nb)||this.QAg(b.rq,b.Nb.keyCode)||(h=super.Zz(b));return h}gEg(){this.control.enabled&&
this.executeCommand(this.properties.CommandPreview,0,!1,null)}xzf(){this.control.enabled&&this.executeCommand(this.properties.CommandRevert,0,!1,null)}}Object(u.a)(Mk,"ButtonBehavior",Dl,[]);var Eo=d(1553);class qo{}qo.Color="Color";qo.IndexColorSelected="ColorSelected";Object(u.a)(qo,"ColorPickerCommandProperties",null,[]);var ro=d(1557);class Fo extends Dl{constructor(b){super(b);this.xOc=this.Aw=-1}get vLb(){return this.control}get UTa(){return this.vLb.Esl.UTa}get properties(){return this.vLb.$h}ey(b,
h,r){if(this.control.enabled){const A=this.Ud;A.Color=Fo.O6d(b)[Eo.ColorPicker.FVd];b=null;Og.a.Ws(this.properties.Stateful)&&this.$k&&this.$k.e9c()&&this.cK&&(b=this.root.nE[this.cK.yva]);this.root.executeCommand(this.properties.Command,A,this.$k,h,!0,null,this.AR(r));b&&b.a_a(this.vLb)}}rn(){var b=this.Ud;b.SourceControlId=this.properties.Id;if(0<(this.pv(this.properties.Command,this.properties.QueryCommand,b)&2)&&(b=-1,qo.IndexColorSelected in this.Ud&&(b=this.Ud[qo.IndexColorSelected]),b!==this.xOc)){const h=
this.UTa;0<=b&&b<h.length&&this.G4j(h[b],!0);0<=this.xOc&&this.xOc<h.length&&this.G4j(h[this.xOc],!1);this.xOc=b}}G4j(b,h){h?Og.a.qg(b,"cui-colorpicker-selected"):Og.a.Hx(b,"cui-colorpicker-selected")}SK(b){for(let h=0;h<b.ucf.length;++h){const r=b.ucf[h];vf.a.instance.nb(Jd.a.focus,r,Object(E.a)(this,this.adg,"onCellFocus"));vf.a.instance.nb(Jd.a.blur,r,Object(E.a)(this,this.ISn,"onCellBlur"));Xb.KeyInputManager.instance.nb(Jd.a.hj,r,Object(E.a)(this,this.onKeyDown,"onKeyDown"));Xb.KeyInputManager.instance.nb(Jd.a.pi,
r,Object(E.a)(this,this.Zz,"onKeyUp"));Qc.a.instance.nb(Jd.a.click,r,Object(E.a)(this,this.JSn,"onCellClick"));ck.a.instance.nb(Jd.a.BP,r,Object(E.a)(this,this.cdg,"onCellPointerUp"));ck.a.instance.nb(Jd.a.UL,r,Object(E.a)(this,this.bdg,"onCellPointerOver"));ck.a.instance.nb(Jd.a.gt,r,Object(E.a)(this,this.KSn,"onCellPointerDown"))}}adg(b){b=Fo.O6d(b.If);this.cK.$zb(this.$k);this.ODe(b,!0);return!0}ISn(b){this.ODe(Fo.O6d(b.If),!1);return!0}ODe(b,h){h?(this.Aw=parseInt(b.getAttribute("arrayPosition")),
Og.a.qg(b,"cui-colorpicker-hoveredOver"),this.gEg(b)):(this.Aw=-1,this.xzf(b),Og.a.Hx(b,"cui-colorpicker-hoveredOver"))}JSn(b){3===b.zg&&this.ey(b.If,b.zg,b.Nb);return!0}cdg(b){3!==b.zg&&this.ey(b.If,b.zg,b.Nb);return!0}bdg(b){this.yof(!1);b=parseInt(Fo.O6d(b.If).getAttribute("arrayPosition"));this.Omd(b);return!0}KSn(){return!1}gEg(b){if(this.control.enabled){const h=this.properties.CommandPreview;if(!yf.b(h)){const r=this.Ud;r.Color=b[Eo.ColorPicker.FVd];this.root.executeCommand(h,r,this.$k,0,!1)}}}xzf(b){if(this.control.enabled){const h=
this.properties.CommandRevert;if(!yf.b(h)){const r=this.Ud;r.Color=b[Eo.ColorPicker.FVd];this.root.executeCommand(h,r,this.$k,0,!1)}}}cN(b){b=ro.a.yDf(this.Aw,this.vLb.width,this.UTa.length,b);if(b!==this.Aw&&this.Omd(b))return!0;this.ODe(this.UTa[this.Aw],!1);return!1}F0(){return this.Omd(0)}Omd(b){return this.UTa&&this.UTa.length>b&&(b=this.UTa[b],b.firstChild)?(b.firstChild.focus(),!0):!1}lua(){-1!==this.Aw&&this.ODe(this.UTa[this.Aw],!1)}static O6d(b){return Fo.gym(b)}static gym(b){var h=["td"];
const r=h.length;if(!b)return null;for(var A=0;A<r;A++)if(b.tagName.toLowerCase()===h[A].toLowerCase())return b;for(b=b.parentNode;b;){for(A=0;A<r;A++)if(b.tagName.toLowerCase()===h[A].toLowerCase())return b;b=b.parentNode}return null}}Object(u.a)(Fo,"ColorPickerBehavior",Dl,[]);var pp=d(341),aq=d(374),wl=d(1674),Qp=d(691),dj=d(1403),jp=d(1660);class El{constructor(b,h){this.TNk=b;this.imh=h}uwe(b,h,r,A){if(yf.c(b)||yf.c(h))return null;const M=new jp.a;const aa=A.x,oa=A.y,Ja=A.width;var fb=A.height;
let Cb;El.jgc(h,"flyoutWidth");A=El.jgc(h,"flyoutRealHeight");const Gb=El.jgc(h,"viewportWidth"),Sb=El.jgc(h,"viewportHeight"),pc=El.jgc(h,"viewableLeft"),zc=El.jgc(h,"viewableTop"),Yc=this.TNk;let Kd=!1,ke=!1;const ge=1===r,de=4===r,Sd=this.imh;b.style.maxHeight="none";b.style.top="0px";b.style.overflowY="visible";b.style.width="auto";Cb=this.Kbj(b);M.Y9j=Sb;M.kNg=Gb;if(ge)Yc?h=aa+Ja:(h=aa-Cb,M.Utb=!0),fb=oa;else{var be="";Ja>Cb&&(Cb=Ja,be=(Cb-2*dj.Menu.Mie).toString());Yc?h=aa:(h=aa+Ja-Cb,M.Utb=
!0);fb=oa+fb;""!==be&&(b.style.minWidth=be+"px")}Sd&&(fb+=zc,h+=pc);b.style.top=fb+"px";b.style.left=h+"px";let Rf=be=!1;Cb<=Gb?h+Cb>pc+Gb?(ge&&Yc&&aa-Cb>pc||de&&aa-Cb>pc?(h=aa-Cb,Sd&&(h+=pc),Rf=M.Utb=!0):(h=pc+Gb-Cb,Kd=!0),be=!0):h<pc&&(ge&&!Yc&&aa+Ja+Cb<pc+Gb?(h=aa+Ja,Sd&&(h+=pc),M.Utb=!1,Rf=!0):(h=pc,ke=!0,M.Utb=!0),be=!0):Yc?(h=pc,be=!0,M.Utb=!0):(h=pc+Gb-Cb,be=!0,M.Utb=!1);be&&(b.style.left=h+"px");M.eic=fb;if(!(fb+A<=zc+Sb)||3===r){M.q2f=!0;const {kNn:Mf,J9l:Yj,rgn:Ji,Enn:sm}=this.XCf(r,fb,
A,oa,zc,Sb);fb!==Mf&&(b.style.top=Mf+"px",M.eic=Mf);-1<Yj&&(b.style.maxHeight=Yj+"px");Ji&&(b.style.bottom="0px",b.style.height="auto");sm&&this.OEn(b,Yc,ge,Rf,ke,Kd,Gb,aa,Ja)}M.u0c=h;M.uDf=Cb;M.qDf=A;return M}XCf(b,h,r,A,M,aa){let oa,Ja,fb;oa=-1;fb=Ja=!1;const Cb=h,Gb=M+aa-h;h=A-r;const Sb=this.imh;let pc=!1;0>h&&(h=M);Sb||(A-=M);r<=A&&1!==b||(4===b||1===b?r<aa?(h=aa-r,Ja=!0):(h=M,pc=fb=Ja=!0):(A<Gb&&3!==b?(h=Cb,Ja=!0):oa=A,fb=!0));Sb&&(Ja=!1,pc?oa=aa:h+=M);return{kNn:h,J9l:oa,rgn:Ja,Enn:fb}}OEn(b,
h,r,A,M,aa,oa,Ja,fb){b.style.overflowY="scroll";b.style.width="auto";if(h){if(aa||A)b.style.left="",b.style.right=(aa?0:oa-Ja)+"px"}else M||A||(b.style.left="",b.style.right=(r?oa-Ja:oa-Ja-fb)+"px")}nnm(b){const h={};if(yf.c(b))return h;h.viewportWidth=Fd.a.$qb();h.viewportHeight=Fd.a.dX();yf.c(h.viewportWidth)&&(h.viewportWidth=document.documentElement.clientWidth,h.viewportHeight=document.documentElement.clientHeight);yf.c(h.viewportWidth)&&(h.viewportWidth=document.body.clientWidth,h.viewportHeight=
document.body.clientHeight);h.viewableTop=window.pageYOffset;h.viewableLeft=window.pageXOffset;yf.c(h.viewableTop)&&(h.viewableTop=document.documentElement.scrollTop,h.viewableLeft=document.documentElement.scrollLeft);yf.c(h.viewableTop)&&(h.viewableTop=document.body.scrollTop,h.viewableLeft=document.body.scrollLeft);h.flyoutRealHeight=b.scrollHeight!==b.offsetHeight?b.scrollHeight+2*dj.Menu.Mie:b.scrollHeight;const r=b.style.overflowY;b.style.overflowY="visible";h.flyoutWidth=this.Kbj(b);b.style.overflowY=
r;return h}Kbj(b){return b.offsetWidth}static jgc(b,h){return yf.c(b)?0:b[h]}}Object(u.a)(El,"MenuPositioner",null,[]);var Ap=d(1446),xh=d(1483),Xq=d(1663),Mt=d(1661),qp=d(1658),Dk=d(1659),un=d(1666),jk=d(1415),Sl=d(1549);class Ek extends Dl{constructor(b){super(b);this.B_e=0;this.rqh=null;this.V2e=-1;this.Dzd=null;this.Yjg=this.Yih=!1;this.zSk=()=>{this.Ig&&this.Ig.Rc&&(document.body.appendChild(this.kUh),this.W$n())};this.igf=h=>{h.element&&(h.element.style.filter="",h.element.style.opacity="",
this.Ig&&this.Ig.Rc===h.element&&Object(Xa.a)(qp.a,this.Ig)&&aq.a.b3k(this.vti()))};this.ECk=new El(0===this.root.t4,Og.a.Ws(this.root.properties.DivSyndicated))}get bcj(){return this.ECk}get Nv(){return this.control}get properties(){return this.control.$h}get Ig(){return this.Nv.Ig}set Ig(b){this.Nv.Ig=b}get xN(){return this.Nv.xN}set xN(b){this.Nv.xN=b}get kUh(){yf.c(this.Dzd)&&(this.Dzd=Ek.psf());return this.Dzd}get wRj(){let b=!this.root.nTf;Object(Xa.a)(440,this.root)&&1===this.root.eVb&&(b=
!0);return b}ey(b,h){Object(Xa.a)(440,this.root)&&this.root.Pzf();this.Nv.n3(h)}n3(b){if(this.Nv.enabled&&!this.xN){var h=Rg.a.instance.nq(Ka.a.n3);h.properties.add("Id",this.Nv.$h.Id);h.properties.add("InputMethod",pp.a[b]);h.end();db.a.mark(10326);Le.a.Kie(this.Nv.$h.Id,"MenuOpen");this.Nv.Ev&&(this.Nv.ska=Le.a.Upb(this.Nv.Ev.ownerDocument));this.B_e=b;this.bsj(b);this.Kve();this.Nv.nfb(this.Nv.Ev,!0)}}Kve(){yf.c(this.properties.PopulateAsyncTriggerCommand)||this.Yih||(this.bPn(),this.Yih=!0)}bPn(){const b=
{};b[wl.a.Callback]=Object(E.a)(this,this.xyj,"refreshMenuCallback");this.root.executeCommand(this.properties.PopulateAsyncTriggerCommand,b,this.$k,0,!1)}xyj(){this.Nv.wZa()}wZa(){this.xN&&this.bsj(this.B_e,!0)}bsj(b,h=!1){var r=!0;if(Og.a.Ws(this.properties.PopulateDynamically)){r=!1;const A=this.Bgd(b);A!==this.rqh&&(r=this.nkg(A,h));r=r||!this.xN}r&&(h=y.AFrameworkApplication.ua.Vr,r=null,h&&(r=h.Wf("LoadResource","Menu Initialization")),this.Ffa(b),r&&r.stop(),this.lme())}Ffa(b){if(!yf.c(this.Ig)){if(this.Nv.qcb){var h=
this.Nv.$k;if(h&&h.keytip){var r=h.keytip.key.toLocaleLowerCase();this.Ig.STo(String.format("{0} {1}",this.Nv.qcb,h.keytip.Qyf),this.Nv.XYa&&""!==this.Nv.XYa?String.format("{0}-{1}",this.Nv.XYa,r):r)}}this.Ig.$ra();Og.a.qg(this.Ig.Rc,this.Nv.Yff);Og.a.X8(this.Ig.Rc,"cui-touch",3===b||this.root.xCe);if(this.Ig.hasItems()){this.Ig.SK();h=this.$k;h.Wii();h.Z5c=!0;h.Vf(this.Ig);h.Z5c=!1;this.Ig.Vrj();r=Object(Xa.a)(Sl.a,this.root);var A=null,M=!1;r&&(A=this.root,M=A.$db,A.$db=!1);var aa=this.Ig.Rc;aa.style.visibility=
"hidden";aa.style.position="absolute";aa.style.top="0px";aa.style.left="0px";Y.a.Jt&&!Y.a.Usb&&(aa.style.maxHeight="100px",aa.style.overflowY="scroll");document.body.appendChild(aa);this.i1k();this.aao(aa);Sys.Browser.agent===Sys.Browser.InternetExplorer&&this.ySk();Og.a.qg(this.Nv.$Tb,Rl.MenuLauncher.ycd);var oa=this.root.eVb;this.H_o&&this.root.Fja(this.control,!0);aa.style.zIndex=String(y.AFrameworkApplication.ua.Fya);this.root.vVk(this.Nv);this.Ig.yva=oa;aa.style.visibility="visible";oa=this.vti();
if(Object(Xa.a)(Dk.a,this.Ig)){aa.style.position="fixed";const Ja=this.root.nE[0];Ja&&Ja.Ig&&Ja.Ig.Rc?100!==Le.a.m3c(this.root.nE[0].Ig.Rc)&&aq.a.vCg(aa,oa,this.igf):aq.a.vCg(aa,oa,this.igf)}else aq.a.vCg(aa,oa,this.igf);this.xN=!0;this.Ig.p2f=!0;!Y.a.Ci&&this.Nv.ILo&&this.Ig.setFocus(b);r&&(A.$db=M);r=this.properties.CommandMenuOpen;yf.b(r)||this.root.executeCommand(r,null,h,b,!1)}}db.a.mark(10327)}lme(){}ySk(){this.V2e=Og.a.eLb(this.V2e);this.V2e=window.setTimeout(this.zSk,50)}W$n(){const b=this.kUh;
var h=this.Ig.Rc;b.style.position="absolute";b.style.visibility="hidden";b.style.left=h.style.left;b.style.right=h.style.right;b.style.top=h.style.top;b.style.bottom=h.style.bottom;let r=h.offsetWidth;h=h.offsetHeight;Y.a.Usb&&(r-=4,h-=4);b.style.width=r.toString()+"px";b.style.height=h.toString()+"px";b.style.visibility="visible"}get H_o(){return this.root.eVb?!1:!0}vti(){const b=this.Ig.children,h=[];if(Object(Xa.a)(qp.a,this.Ig))for(let r=0;r<b.count;r++){const A=b.K(r);Array.add(h,A.separator);
for(let M=0;M<A.children.count;M++){const aa=A.children.K(M);Array.add(h,aa.Rc)}}return h}i1k(){var b=this.Ig.children;for(let r=0;r<b.count;r++){const A=b.K(r).children;for(let M=0;M<A.count;M++){var h=A.K(M);if(Object(Xa.a)($p.a,h)){const aa=h;if("Menu32"===aa.LW||"Menu48"===aa.LW)h=h.control,h.behavior&&(Object(Xa.a)(xh.a,h)||Object(Xa.a)(Mt.a,h))&&h.behavior.f1k()}}}0<b.count&&(b=b.K(0),yf.c(b.separator)||(b.separator.style.display="none"),yf.c(b.$Be)||Og.a.qg(b.$Be,"cui-menusection-titleAtTop"))}aao(b){if(!yf.c(b)){b.style.top=
"0px";b.style.left="0px";b.style.bottom="";b.style.right="";b.style.width="";b.style.minWidth="";var h=Qp.a.create();try{const r=this.bcj.nnm(b),A=this.S2c();let M=this.root.uwe(b,r,this.Nv.Nie,A);M||(M=this.bcj.uwe(b,r,this.Nv.Nie,A));this.root.ccj=M}finally{h&&h.dispose()}}}S2c(){const b=Le.a.getElementBounds(this.Nv.$Tb);var h=this.cK;yf.c(h)||yf.c(h.Rc)||(h=Le.a.getElementBounds(h.Rc),b.x=h.x+dj.Menu.Mie,b.width=h.width-2*dj.Menu.Mie);Object(Xa.a)(jk.a,this.Nv.xge)&&(b.height=0);return b}uza(){if(this.Nv.xN){v.ULS.sendTraceTag(6688860,
207,50,"Menu closing {0}",{["Id"]:this.Nv.$h.Id});this.Ig.lua();this.XAj();this.xN=!1;this.Ig.p2f=!1;this.root.Sea(this.control,!0);this.wRj?y.AFrameworkApplication.ua.Vkd(this.Nv.ska,this.B_e):this.gEo();this.Nv.ska=null;var b=this.Nv.$Tb;Og.a.Hx(b,Rl.MenuLauncher.ycd);this.Nv.nfb(this.Nv.Ev,!1);Og.a.Hx(b,"cui-ctl-menu-hovered-without-focus");this.Ig.Vua();yf.b(this.properties.CommandMenuClose)||this.root.executeCommand(this.properties.CommandMenuClose,null,this.$k,0,!1);this.WAj()}}gEo(){const b=
this.Nv.ska;if(b)try{b.focus()}catch(h){}}WAj(){Fd.a.wy(this.Ig.Rc);Fd.a.wy(this.Dzd);Og.a.AEa(this.Ig.Rc)}Bgd(b){if(this.Yjg&&Og.a.Ws(this.properties.PopulateOnlyOnce)||yf.c(this.properties.PopulateQueryCommand))return null;if(void 0===b||null===b)b=0;const h=this.Nv.OGf();return 0<(this.root.Cua(this.properties.PopulateQueryCommand,this.properties.PopulateQueryCommand,h,b)&1)?h.PopulationXML:null}nkg(b,h=!1){if(this.Yjg&&Og.a.Ws(this.properties.PopulateOnlyOnce))return!0;let r=null;this.rqh=b;yf.c(b)||
(r=this.kFl(b));yf.c(r)||(this.Yjg=!0);if(h){this.root.Apl(this.Nv);if(yf.c(r)||!r.hasItems())return this.uza(),!1;this.XAj();this.WAj()}this.USo(r);return!0}Wij(){}kFl(b){b=Ap.Builder.K6h(b);if(!yf.c(b)){const h=new un.a;h.e2h=!0;h.parentId=this.control.id;let r;r=Object(Xa.a)(Xq.a,this.control);return this.root.MQ.f6a(b,h,r)}return null}USo(b){yf.c(b)||(yf.c(this.Ig)||this.Ig.dispose(),this.Ig=b,this.Wij())}XAj(){const b=this.Ig.parent;b?(b.Z5c=!0,b.removeChild(this.Ig.id),b.Z5c=!1):v.ULS.sendTraceTag(572330335,
207,10,"Parent not found for the Menu component {0}",this.Ig.id)}onKeyDown(b){let h=!1;yf.c(b.Nb)||yf.c(b.Nb.rawEvent)||Object(Xa.a)($p.a,this.$k)||!b.Nb.rawEvent.altKey||b.Nb.keyCode!==Sys.UI.Key.down||(this.ey(b.If,1,b.Nb),h=!0);h||(h=super.onKeyDown(b));return h}rE(b){this.xpf();2===b.zg&&b.gga!==Sys.UI.MouseButton.leftButton||this.ey(b.If,b.zg,b.Nb);b.Nb.preventDefault();return!1}wQf(b){if(!this.cK||!this.cK.inKeytipMode||!this.Nv.ckj)return!1;this.Nv.ckj(this.$k,b);return!0}static psf(){const b=
Og.a.createElement("iframe");b.style.position="absolute";b.style.visibility="hidden";b.style.borderWidth="0px";return b}}Object(u.a)(Ek,"MenuLauncherBehavior",Dl,[624,612]);var Rp=d(1664);class Go extends Ek{constructor(b){super(b)}get ju(){return this.cZc.properties}get cZc(){return this.control}get KUa(){return this.cZc.KUa}SK(){ck.a.instance.nb(Jd.a.gt,this.KUa.In,Object(E.a)(this,this.rE,"onPointerDown"));Xb.KeyInputManager.instance.nb(Jd.a.hj,this.KUa.In,Object(E.a)(this,this.onKeyDown,"onKeyDown"));
Xb.KeyInputManager.instance.nb(Jd.a.pi,this.KUa.In,Object(E.a)(this,this.Zz,"onKeyUp"))}rn(){const b=this.Ud[Rp.a.SelectedItemId];if(0<(this.pv(this.ju.Command,this.ju.QueryCommand,this.Ud)&2)){const h=this.Ud[Rp.a.SelectedItemId];yf.c(h)||b===h||this.cZc.dmd(h)||(this.Ud[Rp.a.SelectedItemId]=null)}}}Object(u.a)(Go,"DropDownBehavior",Ek,[]);var ja=d(610),Ua=d(1447);class yb extends Go{constructor(b){super(b);this.c2a=null;this.h0e=this.jEb=this.vGa=!1;this.GMc=null;this.EMc=-1;this.Peg=h=>{let r=
!1;if(2!==h.zg||h.gga===Sys.UI.MouseButton.leftButton)this.ey(h.If,h.zg,h.Nb),this.Zve(),r=!0;r&&h.Nb.preventDefault();return!1};this.mWn=h=>{let r=!1;if(!yf.c(h.Nb)&&!yf.c(h.Nb.rawEvent)){const A=h.Nb.keyCode;h=h.Nb.rawEvent.shiftKey;Og.a.Ws(this.EJ.AutoComplete);if(A===Sys.UI.Key.enter)this.DW(),this.bug(),Object(Xa.a)(Ua.Ribbon,this.root)&&this.root.z2(),r=!0;else if(A===Sys.UI.Key.tab){if(this.DW(),this.bug(),Object(Xa.a)(Ua.Ribbon,this.root)&&(r=this.root.VFe(this.$k.Rc,!h)),Object(Xa.a)(440,
this.root))return!0}else A===Sys.UI.Key.backspace||A===Sys.UI.Key.del?this.control.enabled?(this.Bmf(),this.GMc=null):r=!0:A===Sys.UI.Key.esc?(this.fug(),this.bug(),Object(Xa.a)(Ua.Ribbon,this.root)&&this.root.z2(),r=!0):A===Sys.UI.Key.down&&(this.n3(1),this.Zve(),r=!0)}return r};this.nWn=h=>{if(!this.control.enabled)return!0;!yf.c(h.Nb)&&h.Nb.charCode&&this.TMl();return!1};this.qeg=()=>this.vGa?!1:this.vGa=!0}get w6(){return this.control}get JT(){return this.w6.JT}get EJ(){return this.w6.EJ}get ide(){return this.Ud[ja.a.IsFreeForm]}set ide(b){this.Ud[ja.a.IsFreeForm]=
b}SK(b){ck.a.instance.nb(Jd.a.gt,b.In,Object(E.a)(this,this.rE,"onPointerDown"));const h=b.ps;vf.a.instance.nb(Jd.a.focus,h,Object(E.a)(this,this.tvb,"onInputFocus"));vf.a.instance.nb(Jd.a.blur,h,Object(E.a)(this,this.KCa,"onInputBlur"));Xb.KeyInputManager.instance.nb(Jd.a.hj,h,this.mWn);Xb.KeyInputManager.instance.nb(Jd.a.mv,h,this.nWn);ie.a.instance.nb(Jd.a.hga,h,this.qeg);ck.a.instance.nb(Jd.a.gt,h,Object(E.a)(this,this.pWn,"onInputPointerDown"));ck.a.instance.nb(Jd.a.gt,b.vhi,this.Peg)}rn(){0<
(this.pv(this.EJ.Command,this.EJ.QueryCommand,this.Ud)&2)&&(this.jEb||this.$7j(),this.htp())}Wij(){this.w6.menuItems=null;var b;var h=b=null;if(!yf.c(this.Ig)){this.Zve();for(const A of this.Ig.children)for(const M of A.children)if(Object(Xa.a)($p.a,M)){var r=M;r=r.control;Object(Xa.a)(619,r)&&(b=r,b=b.$h.MenuItemId);Object(Xa.a)(609,r)&&(h=r,h=h.A9a());yf.c(b)||yf.c(h)||(this.w6.menuItems[h]=b,b=h=null)}}}pWn(b){Object(Xa.a)(440,this.root)&&2===b.zg&&(this.c2a=Le.a.Upb(this.control.Ev.ownerDocument),
this.control.Ev.focus());return!1}rE(b){this.xpf();let h=!1;3===b.zg&&(h=super.rE(b),this.Zve());h&&b.Nb.preventDefault();return!1}S0l(){this.EMc=-1;const b=this.JT.ps,h=b.value,r=this.$pm(h);if(r){b.value=r.key;if(b.setSelectionRange)b.setSelectionRange(h.length,b.value.length);else if(b.createTextRange){const A=b.createTextRange();A.moveStart("character",h.length);A.moveEnd("character",b.value.length);A.select()}this.GMc=r.value}else this.GMc=null}$pm(b){const h=this.w6.menuItems;for(const r in h){const A=
{key:r,value:h[r]};if(A.key.toLowerCase().startsWith(b.toLowerCase()))return A}return null}TMl(){Og.a.Ws(this.EJ.AutoComplete)&&-1===this.EMc&&(this.h0e&&(this.Bgd(0),this.h0e=!1),this.EMc=window.setTimeout(Object(E.a)(this,this.S0l,"executeAutoComplete"),this.w6.w9k))}Bmf(){Og.a.Ws(this.EJ.AutoComplete)&&(this.EMc=Og.a.eLb(this.EMc))}tvb(b){if(this.xN)return this.Ig.setFocus(0),!0;Object(Xa.a)(440,this.root)&&(Cd.FocusManager.instance().EE("ribbon"),this.root.p5c=!1);this.onFocus(b);this.jEb=!0;
Og.a.qg(this.JT.In,"cui-cb-focus");Og.a.Ws(this.EJ.PopulateDynamically)&&(this.h0e=!0);Le.a.Zld(this.JT.ps);yf.c(this.Ig)||this.Ig.sn();return this.vGa=!1}KCa(){this.jEb=!1;this.DW();Og.a.Hx(this.JT.In,"cui-cb-focus");return!1}bug(){Object(Xa.a)(440,this.root)&&(void 0!==this.c2a&&null!==this.c2a&&y.AFrameworkApplication.ua.Vkd(this.c2a,2),this.c2a=null)}DW(){if(this.control.enabled){this.Bmf();var b=this.JT.ps;if(void 0===this.Ud[ja.a.Value]||null===this.Ud[ja.a.Value]||b.value!==this.Ud[ja.a.Value].toString())if(this.w6.dmd(this.GMc))this.ide=
!1,this.Ud[ja.a.Value]=b.value,b={["IsFreeForm"]:!1,["CommandValueId"]:this.w6.jmd.XOb(),["MenuItemId"]:this.w6.jmd.$h.MenuItemId},this.root.executeCommand(this.EJ.Command,b,this.$k,0,!1);else{if(!Og.a.Ws(this.EJ.AutoComplete)){var h=this.w6.menuItems[b.value];if(!yf.b(h)&&this.w6.dmd(h)){this.ide=!1;this.Ud[ja.a.Value]=b.value;b={["IsFreeForm"]:!1,["CommandValueId"]:this.w6.jmd.XOb(),["MenuItemId"]:h};this.root.executeCommand(this.EJ.Command,b,this.$k,0,!1);return}}h=!yf.b(b.value)&&""!==I.a.uDa(b.value);
this.w6.UPh&&h?(this.ide=!0,this.Ud[ja.a.Value]=b.value,this.root.executeCommand(this.EJ.Command,{["IsFreeForm"]:!0,["Value"]:b.value},this.$k,0,!1)):this.fug()}}else this.fug()}fug(){this.Bmf();this.GMc=null;this.$7j()}$7j(){const b=this.Ud[ja.a.Value]||"";b!==this.JT.ps.value&&(this.JT.ps.value=b);this.w6.dmd(this.w6.menuItems[b])}htp(){const b=this.Ud[ja.a.FontStyle]||"normal";b!==this.JT.ps.style.fontStyle&&(this.JT.ps.style.fontStyle=b)}Zve(){this.control.Ev&&this.Ig&&this.control.Ev.setAttribute(Ne.a.bTh,
this.Ig.id)}}Object(u.a)(yb,"ComboBoxBehavior",Go,[]);class Wb extends Ek{constructor(b){super(b)}get LWd(){return this.control}S2c(){let b=0;this.Ig&&this.Ig.Rc&&2===this.Ig.horizontalAlignment&&(b=this.Ig.Rc.clientWidth);return new Sys.UI.Bounds(this.LWd.x-b,this.LWd.y,this.LWd.s2f,this.LWd.r2f)}}Object(u.a)(Wb,"ContextMenuLauncherBehavior",Ek,[]);class tc extends Ek{constructor(b){super(b)}get DZd(){return this.control}S2c(){return new Sys.UI.Bounds(this.DZd.x,this.DZd.y,this.DZd.s2f,this.DZd.r2f)}}
Object(u.a)(tc,"DialogMenuLauncherBehavior",Ek,[]);var Rc=d(1240);class Id extends Ek{constructor(b){super(b);this.k0e=!1;this.sLk=!Og.a.Gla(this.ju.ShouldRefreshWhenDropped)}get PJa(){return this.control}get ju(){return this.control.$h}SK(b){b=b.In;yf.c(b)||(vf.a.instance.nb(Jd.a.focus,b,Object(E.a)(this,this.onFocus,"onFocus")),vf.a.instance.nb(Jd.a.blur,b,Object(E.a)(this,this.onBlur,"onBlur")),ck.a.instance.nb(Jd.a.UL,b,Object(E.a)(this,this.$R,"onPointerOver")),Xb.KeyInputManager.instance.nb(Jd.a.hj,
b,Object(E.a)(this,this.onKeyDown,"onKeyDown")),Xb.KeyInputManager.instance.nb(Jd.a.pi,b,Object(E.a)(this,this.Zz,"onKeyUp")),ck.a.instance.nb(Jd.a.gt,b,Object(E.a)(this,this.rE,"onPointerDown")))}rn(){yf.c(this.control.$h.Command)||(this.PJa.xN&&!this.sLk?this.k0e=!0:(0<(this.pv(this.ju.Command,this.ju.QueryCommand,this.Ud)&2)&&this.wfb()&&this.o0a(),Og.a.Ws(this.ju.RefreshableMenu)&&this.xN&&this.Ig.M9n()))}o0a(){this.etp();this.Zna();this.Utp();this.PJa.YSf=this.Ud[Rc.a.ImageIsVisible]}etp(){const b=
Og.a.$va(this.Ud[Rc.a.LabelText],this.ju.LabelText),h=this.Ud[Rc.a.LabelTextUserGeneratedPlaceholderReplacements];if(this.control.labelText!==b||this.ju.LabelTextUserGeneratedPlaceholderReplacements!==h)this.JG.Ds&&this.ftp(this.JG.Ds.dR,b,h),this.root.ybb=!0,this.control.labelText=b,this.ju.LabelTextUserGeneratedPlaceholderReplacements=h}ftp(b,h,r){const A=b.lastChild;Og.a.ALj(b,h+" ",r);h=yf.c(A);v.ULS.sendTraceTag(38535884,207,50,"FlyoutAnchorBehaviorUpdate.FlyoutLabelTextDom: arrow type: {0}",
h?"":A.nodeType.toString());h||b.appendChild(A)}Utp(){const b=this.Ud[Rc.a.ImageBackColor];this.JG.forEach(h=>{Id.p5k(h.bU,b)})}n3(b){"faPrint"===this.control.id&&"jewelWordEditor"===this.control.root.id&&y.AFrameworkApplication.va.Ob(Ka.a.GZd,2);"faRemix"!==this.control.id&&"faTransform"!==this.control.id&&"faPublish"!==this.control.id||"jewelWordEditor"!==this.control.root.id||y.AFrameworkApplication.va.Ob(Ka.a.GZd,2);Object(Xa.a)($p.a,this.$k)&&(this.xN||this.yof(!0),this.control.enabled&&this.F0());
super.n3(b)}uza(){super.uza();this.k0e&&(this.k0e=!1,this.rn())}$R(b){return this.control.nTb()?(this.PJa.xN?(this.root.nZh(),Og.a.qg(this.PJa.$Tb,Rl.MenuLauncher.ycd),this.PJa.ska=this.control.Ev):(super.$R(b),this.ey(b.If,b.zg,b.Nb)),!1):super.$R(b)}onKeyDown(b){let h=!1;if(!yf.c(b.Nb)&&!yf.c(b.Nb.rawEvent)){if(Object(Xa.a)($p.a,this.$k)){const r=b.Nb.rawEvent,A=b.Nb.keyCode,M=0===this.root.t4;r.shiftKey||r.ctrlKey||!(A===Sys.UI.Key.right&&M||A===Sys.UI.Key.left&&!M)||(h=this.wQf(b),h||(this.ey(b.If,
1,b.Nb),h=!0))}h||(h=super.onKeyDown(b))}return h}static p5k(b,h){yf.c(b)||yf.c(h)||b.style.backgroundColor===h||(b.style.backgroundColor=h)}}Object(u.a)(Id,"FlyoutAnchorBehavior",Ek,[]);var Pd=d(1243);class Rd extends Dl{constructor(b){super(b)}get Bic(){return this.control}get properties(){return this.Bic.properties}get Uja(){return this.Bic.Uja}SK(b){b=b.yNb;vf.a.instance.nb(Jd.a.focus,b,Object(E.a)(this,this.onFocus,"onFocus"));vf.a.instance.nb(Jd.a.blur,b,Object(E.a)(this,this.onBlur,"onBlur"));
ck.a.instance.nb(Jd.a.UL,b,Object(E.a)(this,this.$R,"onPointerOver"));ck.a.instance.nb(Jd.a.jH,b,Object(E.a)(this,this.OL,"onPointerOut"));Xb.KeyInputManager.instance.nb(Jd.a.hj,b,Object(E.a)(this,this.onKeyDown,"onKeyDown"));Xb.KeyInputManager.instance.nb(Jd.a.pi,b,Object(E.a)(this,this.Zz,"onKeyUp"));ck.a.instance.nb(Jd.a.gt,b,Object(E.a)(this,this.rE,"onPointerDown"));ck.a.instance.nb(Jd.a.BP,b,Object(E.a)(this,this.OCa,"onPointerUp"));Yl.a.instance.nb(Jd.a.vS,b,Object(E.a)(this,this.Gvb,"onTouchMove"));
Yl.a.instance.nb(Jd.a.jM,b,Object(E.a)(this,this.GMa,"onTouchEnd"))}rn(){const b=this.Ud[Pd.a.On],h=this.Ud[Pd.a.IsRtl];this.D7j();if(0<(this.pv(this.properties.Command,this.properties.QueryCommand,this.Ud)&2)){var r=!yf.c(this.Ud[Pd.a.InnerHTML])||!yf.c(this.properties.InnerHTML),A=!yf.c(this.properties.Image);r||A||(this.control.enabled=!1);A=this.Uja.yNb;if(!yf.c(A)){if(r){r=Og.a.$va(this.Ud[Pd.a.InnerHTML],this.properties.InnerHTML);if(null===A.innerHTML||null===r||I.a.vh(A.innerHTML)!==I.a.vh(r))A.innerHTML=
r;""===r&&(this.control.enabled=!1)}r=A.title;const M=Og.a.$va(this.Ud[Pd.a.Alt],this.properties.Alt);M===r||this.control.$Ag||(A.title=M)}A=this.Ud[Pd.a.IsRtl];b===this.Ud[Pd.a.On]&&h===A||this.control.xWb()}}D7j(){const b=this.Ud;b[Pd.a.CommandValueId]=this.control.XOb();b.MenuItemId=this.control.$h.MenuItemId;b.SourceControlId=this.properties.Id}ey(b,h,r){if((b=this.$k)&&this.control.enabled){const A=this.root;if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("ExcelBorderMenuCompactionEnabled")&&
b.e9c()&&this.cK){const M=A.nE[this.cK.yva];M?M.a_a(this.Bic):v.ULS.sendTraceTag(41034837,207,15,"GalleryButtonBehavior.DoDefaultAction: Did not get Menulauncher for the menu item.")}this.D7j();this.Ud[Pd.a.On]||(this.Ud[Pd.a.On]=!0,this.control.xWb());"Menu"===b.LW&&Og.a.Hx(this.Uja.In,"cui-gallerybutton-focused");A.executeCommand(this.properties.Command,this.Ud,b,h,!0,null,this.AR(r))}}onFocus(b){super.onFocus(b);Og.a.qg(this.Uja.In,"cui-gallerybutton-focused");return!1}onBlur(b){super.onBlur(b);
Og.a.Hx(this.Uja.In,"cui-gallerybutton-focused");return!1}}Object(u.a)(Rd,"GalleryButtonBehavior",Dl,[]);var Ue=d(1667),tf=d(1256),cg=d(1453);class fg extends Dl{constructor(b){super(b);this.v3a=-1}get rmc(){return this.control}get properties(){return this.rmc.$h}get oVc(){return this.rmc.oVc}get pSf(){var b=null;if(this.$k&&(b=this.$k.parent,!Object(Xa.a)(cg.a,b)))throw Error.create("InsertTable must live inside of a MenuSection.");return b}get FRb(){return this.rmc.ibe.FRb}get xfd(){return this.rmc.ibe.xfd}ey(b,
h,r){if(this.control.enabled){b=this.zJf(this.Tic(b));const A=this.x4d(b);this.oVc[tf.a.Rows]=this.U7d(b)+1;this.oVc[tf.a.Columns]=A+1;this.root.executeCommand(this.properties.Command,this.oVc,this.$k,h,!0,null,this.AR(r))}}SK(b){var h=b.In;const r=b.b_h;b=b.cells;ck.a.instance.nb(Jd.a.jH,h,Object(E.a)(this,this.JTn,"onControlPointerOut"));Yl.a.instance.nb(Jd.a.vS,h,Object(E.a)(this,this.LTn,"onControlTouchMove"));Yl.a.instance.nb(Jd.a.jM,h,Object(E.a)(this,this.KTn,"onControlTouchEnd"));for(h=0;h<
b.length;++h)this.U8k(r[h],b[h])}U8k(b,h){vf.a.instance.nb(Jd.a.focus,b,Object(E.a)(this,this.adg,"onCellFocus"));ck.a.instance.nb(Jd.a.UL,h,Object(E.a)(this,this.bdg,"onCellPointerOver"));ck.a.instance.nb(Jd.a.BP,h,Object(E.a)(this,this.cdg,"onCellPointerUp"));Xb.KeyInputManager.instance.nb(Jd.a.hj,h,Object(E.a)(this,this.onKeyDown,"onKeyDown"));Xb.KeyInputManager.instance.nb(Jd.a.pi,h,Object(E.a)(this,this.Zz,"onKeyUp"));Yl.a.instance.nb(Jd.a.wS,h,Object(E.a)(this,this.LSn,"onCellTouchStart"))}zJf(b){return parseInt(b.id.substr(this.rmc.id.length+
1))}NKi(b){this.MKi(this.zJf(b))}U7d(b){return Math.floor(b/Ue.a.Ddd)}x4d(b){return b%Ue.a.Ddd}MKi(b){if(b!==this.v3a){var h=this.x4d(b),r=this.U7d(b),A=-1;let M=-1;-1!==this.v3a&&(A=this.U7d(this.v3a),M=this.x4d(this.v3a));for(;A!==r||M!==h;)A<r?this.LNj(++A,M,!0):A>r?(this.LNj(A,M,!1),A--):M<h?this.mLj(++M,A,!0):M>h&&(this.mLj(M,A,!1),M--);this.pSf?this.pSf.zOj(this.dti(r+1,h+1)):(r=(h=this.control.Lpf)&&0<h.length?h[0]:null,A=this.$k,v.ULS.sendTraceTag(19748692,207,15,"Insert table menu is NULL. {0}",
{["CtrlComps"]:!!h,["FirstComp"]:!!r,["FirstCompPar"]:!!r&&!!r.parent,["DispComp"]:!!A,["DispCompPar"]:!!A&&!!A.parent}));this.v3a=b}}LNj(b,h,r){for(let A=0;A<=h;A++)this.dLj(b,A,r)}mLj(b,h,r){for(let A=0;A<=h;A++)this.dLj(A,b,r)}dLj(b,h,r){h=b*Ue.a.Ddd+h;b=this.FRb[h];h=this.xfd[h];r?(b.className="cui-it-activeCell",h.className="cui-it-activeCellOuter"):(b.className="cui-it-inactiveCell",h.className="cui-it-inactiveCellOuter")}cdg(b){this.ey(b.If,b.zg,b.Nb);return!0}Tic(b){for(;b.hasChildNodes();)b=
b.childNodes[0];return yf.c(b.tagName)||"a"!==b.tagName.toLowerCase()?null:b.parentNode.parentNode}AOj(b){const h=this.zJf(b);b.childNodes[0].childNodes[0].title=this.dti(this.U7d(h)+1,this.x4d(h)+1)}dti(b,h){let r=this.properties.Alt;yf.c(r)&&(r=this.properties.MenuSectionTitle);return r=String.format(r,h.toString(),b.toString())}Tuc(){if(this.$k){for(var b=0;b<Ue.a.mrc;b++)this.FRb[b].className="cui-it-inactiveCell",this.xfd[b].className="cui-it-inactiveCellOuter";this.v3a=-1;b=this.properties.MenuSectionInitialTitle;
yf.c(b)&&(b="");this.pSf.zOj(b)}}bdg(b){this.control.enabled&&(b=this.Tic(b.If),this.Omd(b),this.rxf(b));return!1}rxf(b){this.AOj(b);this.NKi(b)}adg(b){if(!this.control.enabled)return!1;b=this.Tic(b.If);this.AOj(b);this.NKi(b);return!1}JTn(b){Le.a.LZf(this.rmc.ibe.In,b.clientPoint)||this.Tuc();return!1}LSn(b){if(!this.control.enabled)return!1;b=this.Tic(b.If);this.rxf(b);return!0}LTn(b){if(!this.control.enabled)return!1;b=Le.a.l5d(b.clientPoint);if(!b||"table"===b.tagName.toLowerCase())return!1;(b=
this.Tic(b))?this.rxf(b):this.Tuc();return!0}KTn(b){if(!this.control.enabled)return!1;var h=Le.a.l5d(b.clientPoint);if(!h||"table"===h.tagName.toLowerCase())return this.Tuc(),!0;(h=this.Tic(h))?this.ey(h,3,b.Nb):this.Tuc();return!0}cN(b){b=ro.a.yDf(this.v3a,Ue.a.Ddd,Ue.a.mrc,b);if(b!==this.v3a)return this.FRb[b].firstChild.focus(),this.MKi(b),!0;this.Tuc();this.v3a=-1;return!1}F0(){const b=this.FRb[0];if(yf.c(b))return!1;b.firstChild.focus();return!0}Omd(b){if(yf.c(b))return!1;b.firstChild.firstChild.focus();
return!0}lua(){this.Tuc()}}Object(u.a)(fg,"InsertTableBehavior",Dl,[]);class Mg extends Ek{constructor(b){super(b)}rn(){this.control.enabled=!!this.Ig}ey(b,h,r){y.AFrameworkApplication.va.Pb(Ka.a.NXa,2,h,this.AR(r))}}Object(u.a)(Mg,"JewelMenuLauncherBehavior",Ek,[]);var Fh=d(1249);class zj extends Dl{constructor(b){super(b)}get properties(){return this.control.$h}rn(){0<(this.pv(this.properties.Command,this.properties.QueryCommand,this.Ud)&2)&&this.wfb()&&this.o0a()}o0a(){this.rxp();this.Zna();this.f2b()}rxp(){const b=
this.control.labelText;let h=this.Ud[Fh.a.Value];yf.c(h)&&(h=this.properties.LabelText,yf.c(h)&&(h=""));h!==b&&this.Lwe(h)}SK(b){b=b.In;yf.c(b)||(ck.a.instance.nb(Jd.a.gt,b,Object(E.a)(this,this.rE,"onPointerDown")),ck.a.instance.nb(Jd.a.UL,b,Object(E.a)(this,this.$R,"onPointerOver")),ck.a.instance.nb(Jd.a.jH,b,Object(E.a)(this,this.OL,"onPointerOut")))}}Object(u.a)(zj,"LabelBehavior",Dl,[]);var om=d(1502),ej=d(1387),Kj=d(1662);class Tl extends Ek{constructor(b){super(b);this.EUe=this.hMe=!1;this.k7b=
this.C3b=null;if(this.N7b=y.AFrameworkApplication.J.$("TellMeRedesignIsEnabled"))this.C3b=this.rv.gna.LightImage16by16Class,this.k7b=this.rv.gna.DarkImage16by16Class}get rv(){return this.control}xke(b,h,r,A){h&&(this.rv.ska=r,y.AFrameworkApplication.ua.Txb());if(Object(Xa.a)(ej.a,b)&&A){r=new om.a;r.CommandLocation=this.root.fca;r.InvocationMethod=0;const M={};(b=b.control)&&b.$h&&(M.CommandId=b.$h.Command,M.ControlId=b.$h.Id,M.CloseAllMenus=h,b.cK&&b.cK.parent&&b.cK.parent.id&&(M.ParentControlId=
b.cK.parent.id.split("-")[0]),this.root.oH&&this.root.oH.XUa(A,M,r))}}uza(){this.rv.ska||(this.rv.ska=this.rv.Tz);!this.rv.LKn&&this.N7b&&(Og.a.Hx(this.rv.Tz,"cui-sb-focus"),Og.a.Hx(this.rv.y4,"cui-sb-focus"),Og.a.Hx(this.rv.JDa,this.C3b),Og.a.qg(this.rv.JDa,this.k7b));this.hMe=!0;super.uza();this.hMe=!1;this.vog()}get wRj(){return!this.rv.fZa}lme(){this.rv.lme()}ase(){this.EUe||this.hMe||(this.EUe=!0,this.rv.raiseEvent(Kj.a.x$a,null))}vog(){this.xN||this.rv.tUf||(this.EUe=!1,this.rv.raiseEvent(Kj.a.bSb,
null))}oeg(b){Og.a.Hx(this.rv.Tz,"cui-sb-focus");Og.a.Hx(this.rv.y4,"cui-sb-focus");this.N7b&&!this.rv.xN&&(Og.a.Hx(this.rv.JDa,this.C3b),Og.a.qg(this.rv.JDa,this.k7b));this.rv.raiseEvent(Kj.a.blur,b);this.vog();this.rv.ska=this.rv.Tz;return!1}peg(b){Og.a.qg(this.rv.Tz,"cui-sb-focus");Og.a.qg(this.rv.y4,"cui-sb-focus");this.N7b&&(Og.a.Hx(this.rv.JDa,this.k7b),Og.a.qg(this.rv.JDa,this.C3b));this.rv.raiseEvent(Kj.a.focus,b);this.ase();return!1}Rfg(){this.N7b&&(Og.a.qg(this.rv.y4,"cui-sb-hover"),Og.a.qg(this.rv.Tz,
"cui-sb-hover"),Og.a.Hx(this.rv.JDa,this.k7b),Og.a.qg(this.rv.JDa,this.C3b));return!1}Qfg(){this.N7b&&(Og.a.Hx(this.rv.y4,"cui-sb-hover"),Og.a.Hx(this.rv.Tz,"cui-sb-hover"),this.rv.xN||this.rv.tUf||(Og.a.Hx(this.rv.JDa,this.C3b),Og.a.qg(this.rv.JDa,this.k7b)));return!1}}Object(u.a)(Tl,"SearchBoxBehavior",Ek,[614,612]);class nj{}nj.Value="value";nj.MinValue="MinValue";nj.MaxValue="MaxValue";nj.Text="Text";Object(u.a)(nj,"SliderCommandProperties",null,[]);class Nn extends Dl{constructor(b){super(b);
this.nga=()=>{this.Lul(this.C8.ps.value);return!0}}get lDg(){return this.control}get C8(){return this.lDg.C8}get properties(){return this.control.$h}initialize(){}ey(){}SK(b){b=b.ps;vf.a.instance.nb(Jd.a.focus,b,Object(E.a)(this,this.onFocus,"onFocus"));vf.a.instance.nb(Jd.a.blur,b,Object(E.a)(this,this.onBlur,"onBlur"));vf.a.instance.nb(Jd.a.lUc,b,this.nga);vf.a.instance.nb(Jd.a.input,b,this.nga)}onFocus(b){this.C8.In&&Sys.UI.DomElement.addCssClass(this.C8.In,"cui-sldr-onfocus");return super.onFocus(b)}onBlur(b){this.C8.In&&
Sys.UI.DomElement.removeCssClass(this.C8.In,"cui-sldr-onfocus");return super.onBlur(b)}Lul(b){this.Ud[nj.Value]=parseFloat(b);this.root.executeCommand(this.properties.Command,this.Ud,this.$k,0,!1)}rn(){const b=this.Ud[nj.Value],h=this.Ud[nj.MaxValue],r=this.Ud[nj.Text];var A=this.pv(this.properties.Command,this.properties.QueryCommand,this.Ud);this.C8&&this.C8.ps&&(this.C8.ps.disabled=!this.control.enabled);if(0<(A&2)){A=this.Ud[nj.Value];const M=this.Ud[nj.MaxValue],aa=this.Ud[nj.Text];(M!==h||A!==
b||r!==aa)&&this.C8&&this.C8.ps&&(this.C8.ps.setAttribute(Ne.a.gSd,String.format("{0}",M)),this.C8.ps.setAttribute("max",String.format("{0}",M)),this.C8.ps.value=A,this.C8.dR.innerText=this.Ud[nj.Text])}}}Object(u.a)(Nn,"SliderBehavior",Dl,[]);var ui=d(1247);class oq extends Dl{constructor(b){super(b);this.bHd=0;this.klb=null;this.xEd=!1;this.MIh=null;this.w8e=!1;this.dKd=this.AId=-1;this.vGa=!1;this.HI=()=>!this.control.enabled;this.nga=()=>{this.DW();return!1};this.qeg=()=>this.vGa?!1:this.vGa=
!0;this.Fhj=h=>{var r=!1;let A=!0;2===h.zg&&(A=h.gga===Sys.UI.MouseButton.leftButton);A&&(r=h.If,this.gWj(r===this.QI.$gc||r===this.QI.Ghi||r===this.QI.Fhi,h.zg),r=!0);return r};this.Ghj=h=>this.Wza(h);this.cAo=()=>{this.oZh();-1===this.dKd&&(this.Fze(),this.dKd=window.setInterval(Object(E.a)(this,this.Fze,"spin"),50))}}get y0b(){return this.control}get QI(){return this.y0b.QI}get properties(){return this.control.$h}initialize(){const b=this.y0b.LMg;this.MIh=this.Xop(b);this.bHd=b[0].min;this.klb=
b[0];this.xEd=!1}ey(){}SK(b){const h=b.ps,r=b.$gc;b=b.oZc;vf.a.instance.nb(Jd.a.focus,h,Object(E.a)(this,this.onFocus,"onFocus"));vf.a.instance.nb(Jd.a.blur,h,Object(E.a)(this,this.onBlur,"onBlur"));Xb.KeyInputManager.instance.nb(Jd.a.hj,h,Object(E.a)(this,this.onKeyDown,"onKeyDown"));Xb.KeyInputManager.instance.nb(Jd.a.mv,h,this.HI);Xb.KeyInputManager.instance.nb(Jd.a.pi,h,Object(E.a)(this,this.Zz,"onKeyUp"));vf.a.instance.nb(Jd.a.lUc,h,this.nga);ie.a.instance.nb(Jd.a.hga,h,this.qeg);ck.a.instance.nb(Jd.a.gt,
r,this.Fhj);ck.a.instance.nb(Jd.a.gt,b,this.Fhj);ck.a.instance.nb(Jd.a.BP,r,this.Ghj);ck.a.instance.nb(Jd.a.BP,b,this.Ghj);Yl.a.instance.nb(Jd.a.vS,r,Object(E.a)(this,this.Ihj,"onArrowTouchMove"));Yl.a.instance.nb(Jd.a.vS,b,Object(E.a)(this,this.Ihj,"onArrowTouchMove"));Yl.a.instance.nb(Jd.a.jM,r,Object(E.a)(this,this.Hhj,"onArrowTouchEnd"));Yl.a.instance.nb(Jd.a.jM,b,Object(E.a)(this,this.Hhj,"onArrowTouchEnd"))}onFocus(b){super.onFocus(b);Og.a.qg(this.QI.In,"cui-spn-focus");this.control.enabled&&
Le.a.Zld(this.QI.ps);return this.vGa=!1}onBlur(b){super.onBlur(b);Og.a.Hx(this.QI.In,"cui-spn-focus");return!1}onKeyDown(b){let h=!1;if(!yf.c(b.Nb)&&!yf.c(b.Nb.rawEvent)){const r=b.Nb.keyCode,A=b.Nb.rawEvent.shiftKey;if(r===Sys.UI.Key.up||r===Sys.UI.Key.down)this.root.aXf(this.control)||this.gWj(r===Sys.UI.Key.up,b.zg),h=!0;else if(r===Sys.UI.Key.enter)this.DW(),Object(Xa.a)(Ua.Ribbon,this.root)&&this.root.z2(),h=!0;else if(r===Sys.UI.Key.tab)this.DW(),Object(Xa.a)(Ua.Ribbon,this.root)&&(h=this.root.VFe(this.$k.Rc,
!A));else if(r===Sys.UI.Key.esc)this.Vuc(),Object(Xa.a)(Ua.Ribbon,this.root)&&this.root.z2(),h=!0;else if(r===Sys.UI.Key.backspace||r===Sys.UI.Key.del)h=!this.control.enabled}return h}Zz(){this.dLl();return!1}Ihj(b){return this.Xke(b)}Hhj(b){return this.Wza(b)}o1m(b){if(this.control.enabled){var h=!1;if(!this.xEd){var r=this.ztm(b);r=b?r+this.klb.step:r-this.klb.step;r=Math.min(r,this.klb.max);r=Math.max(r,this.klb.min);r!==this.bHd&&(this.wpf(r,this.klb),this.root.executeCommand(this.properties.Command,
this.Ud,this.$k,0,!1),h=!0)}h||(h=this.properties.SpinCommand,r=this.Ud,r.Increment=b,yf.c(h)||this.root.executeCommand(h,r,this.$k,0,!1))}}ztm(b){const h=Math.pow(10,y.AFrameworkApplication.numberFormat.Gke),r=Math.round(this.klb.step*h);let A=Math.round(this.bHd*h)/r;A=b?Math.floor(A):Math.ceil(A);return A*r/h}gWj(b,h){if(this.control.enabled){this.DW();const r=b?this.QI.$gc:this.QI.oZc;switch(h){case 2:case 3:this.w8e=b;this.SPd(r);break;case 1:this.w8e=b,this.XRk(r)}}}MWj(){this.oZh();this.Njl()}wci(){-1===
this.AId&&(this.AId=window.setTimeout(this.cAo,500))}oZh(){this.AId=Og.a.eLb(this.AId)}Njl(){this.dKd=Og.a.Jjl(this.dKd)}Fze(){this.o1m(this.w8e)}XRk(b){this.root.Fja(this.control,!1);Og.a.qg(b,vl.a.VPd);this.Fze();this.wci()}dLl(){this.root.Sea(this.control,!1);this.MWj();Og.a.Hx(this.QI.$gc,vl.a.VPd);Og.a.Hx(this.QI.oZc,vl.a.VPd)}rwc(b){this.QI.ps.value!==b&&(this.QI.ps.value=b)}Vuc(){this.rwc(this.Ud[ui.a.Text])}DLj(b){this.rwc(b);this.Ud[ui.a.Text]=b;this.xEd=!0}vPo(b,h,r){this.rwc(r);this.Ud[ui.a.Text]=
r;this.Ud[ui.a.Number]=b;this.Ud[ui.a.UnitType]=h.type;this.bHd=b;this.klb=h;this.QI.ps.setAttribute(Ne.a.tif,r);this.QI.ps.setAttribute(Ne.a.iTh,String.format("{0}",h.min));this.QI.ps.setAttribute(Ne.a.gSd,String.format("{0}",h.max));this.xEd=!1}T3h(b){var h;if(({BOn:h}=this.Hon(b)).returnValue)this.DLj(h);else{({number:b,jfb:h}=I.a.mqj(b,this.MIh,y.AFrameworkApplication.numberFormat));let r=this.zDe(h);0===h&&yf.c(r)&&(r=this.zDe(this.Ud[ui.a.UnitType]));this.wpf(b,r)}}wpf(b,h){b=this.ibg(b,h);
if(isNaN(b)||yf.c(h))this.Vuc();else{const r=y.AFrameworkApplication.numberFormat;let A;A=I.a.XJa(b,h.type,r);A=A.replace(6===h.type?r.Hke:r.ljg,"");this.vPo(b,h,A)}}Hon(b){let h,r=!1;h="";b=b.trim();const A=this.y0b.j9j;if(!yf.c(A))for(let M=0;M<A.length;M++)if(A[M].toLowerCase()===b.toLowerCase()){h=A[M];r=!0;break}return{returnValue:r,BOn:h}}ibg(b,h){return isNaN(b)||yf.c(h)?Number.NaN:h.ibg(b)}zDe(b){let h=null;const r=this.y0b.LMg;for(let A=0;A<r.length;A++)if(r[A].type===b){h=r[A];break}return h}Xop(b){const h=
b.length,r=Array(h);for(let A=0;A<h;A++)r[A]=b[A].type;return r}DW(){if(this.control.enabled){const b=this.Ud[ui.a.Text],h=this.QI.ps.value;h!==b&&(this.T3h(h),this.Ud[ui.a.Text]!==b&&this.root.executeCommand(this.properties.Command,this.Ud,this.$k,0,!1))}else this.Vuc()}rn(){var b=this.Ud[ui.a.Text],h=this.Ud[ui.a.Number];const r=this.Ud[ui.a.UnitType],A=this.Ud[ui.a.MaxValue];if(0<(this.pv(this.properties.Command,this.properties.QueryCommand,this.Ud)&2)){const M=this.Ud[ui.a.Text],aa=this.Ud[ui.a.Number],
oa=this.Ud[ui.a.UnitType],Ja=this.Ud[ui.a.MaxValue];Ja!==A&&(this.zDe(oa).max=Ja,this.QI.ps.setAttribute(Ne.a.gSd,String.format("{0}",Ja)));M!==b?""===M?this.DLj(M):this.T3h(M):isNaN(aa)||aa===h&&oa===r||this.wpf(aa,this.zDe(oa));b=this.QI.In.title;h=Og.a.$va(this.Ud[ui.a.Alt],this.properties.Alt);h!==b&&(this.QI.ps.title=h,this.QI.$gc.title=h,this.QI.oZc.title=h)}}Tcf(b){super.Tcf(b);b?(this.Fze(),this.wci()):this.MWj()}}Object(u.a)(oq,"SpinnerBehavior",Dl,[613,612]);var rp=d(415),Am=d(1153);class Bh extends Ek{constructor(b){super(b);
this.L8b=!0;this.BBb=!1}get F8(){return this.control}get ju(){return this.F8.properties}SK(b){const h=b.In,r=b.Kob;b=b.qZc;vf.a.instance.nb(Jd.a.focus,h,Object(E.a)(this,this.onFocus,"onFocus"));vf.a.instance.nb(Jd.a.blur,h,Object(E.a)(this,this.onBlur,"onBlur"));Xb.KeyInputManager.instance.nb(Jd.a.hj,h,Object(E.a)(this,this.onKeyDown,"onKeyDown"));Xb.KeyInputManager.instance.nb(Jd.a.pi,h,Object(E.a)(this,this.Zz,"onKeyUp"));Y.a.eu&&16>this.$nm()&&(ck.a.instance.nb(Jd.a.gt,h,Object(E.a)(this,this.Lmj,
"onSplitbuttonPointerDownPointerUp")),ck.a.instance.nb(Jd.a.BP,h,Object(E.a)(this,this.Lmj,"onSplitbuttonPointerDownPointerUp")));ck.a.instance.nb(Jd.a.UL,r,Object(E.a)(this,this.vSn,"onButtonPointerOver"));ck.a.instance.nb(Jd.a.jH,r,Object(E.a)(this,this.uSn,"onButtonPointerOut"));ck.a.instance.nb(Jd.a.gt,r,Object(E.a)(this,this.Xhj,"onButtonPointerDown"));ck.a.instance.nb(Jd.a.BP,r,Object(E.a)(this,this.Yhj,"onButtonPointerUp"));Yl.a.instance.nb(Jd.a.vS,r,Object(E.a)(this,this.xSn,"onButtonTouchMove"));
Yl.a.instance.nb(Jd.a.jM,r,Object(E.a)(this,this.wSn,"onButtonTouchEnd"));ck.a.instance.nb(Jd.a.gt,b,Object(E.a)(this,this.Peg,"onMenuButtonPointerDown"));ck.a.instance.nb(Jd.a.UL,b,Object(E.a)(this,this.jXn,"onMenuButtonPointerOver"));ck.a.instance.nb(Jd.a.jH,b,Object(E.a)(this,this.iXn,"onMenuButtonPointerOut"))}ey(b,h,r){Sys.UI.DomElement.containsCssClass(b,"cui-ctl-a1")?this.BBb&&(this.F8.on=!this.F8.on,b=this.Ud,b.CommandValueId=this.control.XOb(),this.root.executeCommand(this.ju.Command,b,this.$k,
h,!0,null,this.AR(r))):this.L8b&&super.ey(b,h,r)}Zz(b){const h=b.Nb.keyCode;return h===Sys.UI.Key.enter||h===Sys.UI.Key.space?(b=this.Ud,b.CommandValueId=this.control.XOb(),this.root.executeCommand(this.ju.Command,b,this.$k,1,!0),!0):super.Zz(b)}rn(){const b=this.root.Cua(this.ju.Command,this.ju.QueryCommand,this.Ud),h=0<(b&1);let r=!0;r=yf.c(this.ju.CommandMenuOpen)?h:0<(this.root.Cua(this.ju.CommandMenuOpen,null,null)&1);if(r!==this.L8b||h!==this.BBb||(r||h)!==this.control.enabled)this.control.enabled=
r||h,h!==this.BBb&&this.GUn(h),r!==this.L8b&&this.HUn(r),this.L8b=r,this.BBb=h;if(0<(b&2)){this.Zna();const A=Og.a.$va(this.Ud[Am.a.LabelText],this.ju.LabelText);this.Ud[Am.a.ApplyLabelTextToControlOnly]?this.F8.lic(M=>{M.In.title=A;M.Kob.removeAttribute("title");M.qZc.removeAttribute("title")}):this.F8.lic(M=>{M.Kob.title=A});this.Ud[Am.a.EnsureControlRoleIsButton]&&this.F8.lic(M=>{Ne.a.Gs(M.In,Ne.a.Ph,Ne.a.K$)});yf.c(this.Ud[Am.a.Visible])||this.wfb()&&this.o0a()}this.F8.setState(this.F8.on&&h)}o0a(){this.hLg();
this.f2b();this.Zna()}HUn(b){this.F8.lic(h=>{Og.a.Sxb(h.qZc,b)});this.Jjd();this.L8b=b}GUn(b){this.F8.lic(h=>{Og.a.Sxb(h.Kob,b)});this.Jjd();this.BBb=b}Jjd(){const b=this.F8.sqb();yf.c(b)||(Og.a.Hx(b.childNodes[0],"cui-ctl-split-hovered-primary"),Og.a.Hx(b.childNodes[0],"cui-ctl-split-hovered-secondary"),Og.a.Hx(b.childNodes[1],"cui-ctl-split-hovered-primary"),Og.a.Hx(b.childNodes[1],"cui-ctl-split-hovered-secondary"))}Lmj(b){if(0!==rp.a(b.Nb))return!1;let h=!1;b.eventName===Jd.a.gt?h=this.Xhj(b):
b.eventName===Jd.a.BP&&(h=this.Yhj(b));return h}Xhj(b){let h=!1;const r=b.zg;switch(r){case 3:this.B2o()?this.ey(this.$k.Rc,r,b.Nb):this.SPd(this.F8.qfi);h=!0;break;case 2:b.gga===Sys.UI.MouseButton.leftButton&&(this.SPd(this.F8.qfi),h=!0)}h&&b.Nb.preventDefault();return!1}B2o(){const b=this.$k.LW;return"Small"===b||"Medium"===b||"Menu16"===b||"MenuTellMe"===b}Yhj(b){return this.Wza(b)}xSn(b){return this.Xke(b)}wSn(b){return this.Wza(b)}onFocus(b){super.onFocus(b);this.dSf(!0,!0);return!1}onBlur(b){super.onFocus(b);
this.Jjd();return!1}vSn(){this.control.enabled&&this.BBb&&this.dSf(!0,this.F8.on);return!1}uSn(){this.control.enabled&&this.BBb&&this.Jjd();return!1}Peg(b){let h=!1;if(2!==b.zg||b.gga===Sys.UI.MouseButton.leftButton)this.ey(b.If,b.zg,b.Nb),h=!0;h&&b.Nb.preventDefault();return!1}jXn(){this.control.enabled&&this.L8b&&this.dSf(this.F8.on,!0);return!1}iXn(){this.Jjd();return!1}dSf(b,h){const r=this.control.sqb();yf.c(r)||(Og.a.qg(r.childNodes[0],b?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"),
Og.a.qg(r.childNodes[1],h?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"))}$nm(){var b=Y.a.Ogc;return b&&(b=b.split("."),2===b.length)?parseInt(b[0]):0}}Object(u.a)(Bh,"SplitButtonBehavior",Ek,[]);var ml=d(1255);class nl extends Dl{constructor(b){super(b);this.jEb=this.vGa=!1;this.Lsk=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("ExcelTableRenameEnabled");this.HI=()=>!this.control.enabled;this.nga=()=>{this.DW();return!1};this.BYa=()=>this.Eha.isEditable?this.vGa?!1:
this.vGa=!0:(Le.a.Zld(this.Eha.ps),!0)}get Cqd(){return this.control}get Eha(){return this.Cqd.Eha}get FGg(){return this.Cqd.$h}SK(b){b=b.ps;vf.a.instance.nb(Jd.a.focus,b,Object(E.a)(this,this.onFocus,"onFocus"));vf.a.instance.nb(Jd.a.blur,b,Object(E.a)(this,this.onBlur,"onBlur"));Xb.KeyInputManager.instance.nb(Jd.a.hj,b,Object(E.a)(this,this.onKeyDown,"onKeyDown"));Xb.KeyInputManager.instance.nb(Jd.a.mv,b,this.HI);Xb.KeyInputManager.instance.nb(Jd.a.pi,b,Object(E.a)(this,this.Zz,"onKeyUp"));vf.a.instance.nb(Jd.a.lUc,
b,this.nga);ie.a.instance.nb(Jd.a.hga,b,this.BYa)}onFocus(b){super.onFocus(b);this.jEb=!0;Og.a.qg(this.Eha.In,"cui-tb-focus");this.control.enabled&&Le.a.Zld(this.Eha.ps);return this.vGa=!1}onBlur(b){this.jEb=!1;super.onBlur(b);Og.a.Hx(this.Eha.In,"cui-tb-focus");return!1}onKeyDown(b){let h=super.onKeyDown(b);if(!yf.c(b.Nb)&&!yf.c(b.Nb.rawEvent)){const r=b.Nb.keyCode,A=b.Nb.rawEvent.shiftKey;r===Sys.UI.Key.tab?(this.DW(),Object(Xa.a)(Ua.Ribbon,this.root)&&(h=this.root.VFe(this.$k.Rc,!A))):r===Sys.UI.Key.enter?
this.Lsk&&(this.DW(),Object(Xa.a)(Ua.Ribbon,this.root)&&this.root.z2(),h=!0):r===Sys.UI.Key.esc?(this.Vuc(),Object(Xa.a)(Ua.Ribbon,this.root)&&this.root.z2(),h=!0):r===Sys.UI.Key.backspace||r===Sys.UI.Key.del?h=!this.control.enabled:b.vza&&(mf.a.lZh(b.Nb),h=!1)}return h}Zz(){return!1}rwc(b){this.Eha.ps.value!==b&&(this.Eha.ps.value=b)}Vuc(){this.rwc(this.Ud[ml.a.Text])}DW(){if(this.control.enabled&&this.Eha.isEditable){const b=this.Eha.ps.value;b!==this.Ud[ml.a.Text]&&(this.Ud[ml.a.Text]=b,this.root.executeCommand(this.FGg.Command,
this.Ud,this.$k,0,!1))}else this.Vuc()}rn(){const b=this.Ud[ml.a.Text];if(0<(this.pv(this.FGg.Command,this.FGg.QueryCommand,this.Ud)&2)&&!this.jEb){const h=this.Ud[ml.a.Text];h!==b&&this.rwc(h)}}}Object(u.a)(nl,"TextBoxBehavior",Dl,[611,612]);var um=d(1425);class jr extends Dl{constructor(b){super(b)}get toggleButton(){return this.control}get properties(){return this.control.$h}ey(b,h,r){this.control.enabled&&(Og.a.Gla(this.properties.TogglesWhenExecuted)||this.toggle(),this.Ud.CommandValueId=this.toggleButton.XOb(),
this.Ud.MenuItemId=this.toggleButton.$h.MenuItemId,this.Ud.SourceControlId=this.control.id,this.root.executeCommand(this.properties.Command,this.Ud,this.$k,h,!Og.a.Gla(this.properties.CloseMenuWhenExecuted),A=>{Og.a.Ws(this.properties.UpdateHtmlPostToggle)&&(32===A?this.Q_j():this.O_j())},this.AR(r)))}O_j(){this.Ud[Vg.a.On]=!this.Ud[Vg.a.On]}Q_j(){this.toggleButton.setState(this.Ud[Vg.a.On]);(this.toggleButton.IEa&&this.toggleButton.JEe||Og.a.Ws(this.properties.UpdateHtmlPostToggle))&&this.o0a()}toggle(){this.O_j();
Og.a.Ws(this.properties.UpdateHtmlPostToggle)||this.Q_j()}onKeyDown(b){const h=super.onKeyDown(b);if(!h&&!yf.c(b.Nb)&&this.cK){const r=b.Nb.keyCode;r!==Sys.UI.Key.enter&&r!==Sys.UI.Key.space||b.Nb.preventDefault()}return h}rn(){yf.c(this.properties.MenuItemId)||(this.Ud.MenuItemId=this.properties.MenuItemId);0<(this.pv(this.properties.Command,this.properties.QueryCommand,this.Ud)&2)&&this.wfb()&&this.o0a()}o0a(){this.toggleButton.setState(this.Ud[Vg.a.On]);this.Fsp(Og.a.$va(this.Ud[Vg.a.DisplayMode],
""));this.hLg();this.Zna();this.rup();Vg.a.Alt in this.Ud&&this.f2b()}rup(){const b=this.JG.tpc;if(b&&b.Lob){var h=Og.a.$va(this.Ud[Vg.a.Description],this.properties.Description);h!==b.Lob.innerText&&(b.Lob.innerText=h,b.dR&&!Object(Xa.a)(um.Jewel,this.root)&&(h=!yf.b(h),Og.a.X8(b.dR,"UIFontBold",h),Og.a.X8(b.dR,"cui-ctl-mediumlabel-nodescription",!h)))}}SK(b){b=b.In;vf.a.instance.nb(Jd.a.focus,b,Object(E.a)(this,this.onFocus,"onFocus"));vf.a.instance.nb(Jd.a.blur,b,Object(E.a)(this,this.onBlur,"onBlur"));
ck.a.instance.nb(Jd.a.UL,b,Object(E.a)(this,this.$R,"onPointerOver"));ck.a.instance.nb(Jd.a.jH,b,Object(E.a)(this,this.OL,"onPointerOut"));Xb.KeyInputManager.instance.nb(Jd.a.hj,b,Object(E.a)(this,this.onKeyDown,"onKeyDown"));Xb.KeyInputManager.instance.nb(Jd.a.pi,b,Object(E.a)(this,this.Zz,"onKeyUp"));ck.a.instance.nb(Jd.a.gt,b,Object(E.a)(this,this.rE,"onPointerDown"));ck.a.instance.nb(Jd.a.BP,b,Object(E.a)(this,this.OCa,"onPointerUp"));Qc.a.instance.nb(Jd.a.click,b,Object(E.a)(this,this.onClick,
"onClick"));Yl.a.instance.nb(Jd.a.vS,b,Object(E.a)(this,this.Gvb,"onTouchMove"));Yl.a.instance.nb(Jd.a.jM,b,Object(E.a)(this,this.GMa,"onTouchEnd"))}}Object(u.a)(jr,"ToggleButtonBehavior",Dl,[]);class oi{constructor(b){this.bpk=b;this.ZQe={["Button"]:h=>new Mk(h),["FileMenuButton"]:h=>new Mk(h),["ColorPicker"]:h=>new Fo(h),["ComboBox"]:h=>new yb(h),["ContextMenuControl"]:h=>new Wb(h),["ContextMenuLauncher"]:h=>new Wb(h),["DialogMenuLauncher"]:h=>new tc(h),["DropDown"]:h=>new Go(h),["FlyoutAnchor"]:h=>
new Id(h),["GalleryButton"]:h=>new Rd(h),["StatefulColorFlyoutAnchor"]:h=>new Id(h),["JewelMenuLauncher"]:h=>new Mg(h),["Label"]:h=>new zj(h),["Placeholder"]:h=>new Dl(h),["SearchBox"]:h=>new Tl(h),["Separator"]:h=>new Dl(h),["SplitButton"]:h=>new Bh(h),["StatefulColorSplitButton"]:h=>new Bh(h),["StatefulImageSplitButton"]:h=>new Bh(h),["TextBox"]:h=>new nl(h),["ToggleButton"]:h=>new jr(h)}}bii(){this.ZQe[vl.a.CRi]=b=>new fg(b)}mzf(){this.ZQe[vl.a.ZUj]=b=>new oq(b)}lgm(b){const h=this.ZQe[b.controlType];
(b=h?h(b):null)&&this.bpk&&b.gYl();return b}static get instance(){return oi._instance||(oi._instance=new oi(!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("CUICommitChangeFixIsEnabled")))}}oi._instance=null;Object(u.a)(oi,"ControlBehaviorFactory",null,[587]);var Qo=d(1551),sp=d(1376);class bq extends Rl.MenuLauncher{constructor(b,h,r,A){super(b,h,r,A);this.wrh=null;this.aTa=this.XQc=0;this.oH=null;this.SJc=this.RJc=0;this.Ah("Menu");this.enabled=!0}get x(){return this.XQc}get y(){return this.aTa}get r2f(){return this.RJc}get s2f(){return this.SJc}get controlType(){return"DialogMenuLauncher"}Kdb(){}nfb(){}OGf(){const b=
{};b.MenuId=this.id;b.DialogMoveCommand=this.ju.DialogMoveCommand;b.DialogCloseCommand=this.ju.DialogCloseCommand;return b}oun(b,h){this.XQc=b.x;this.aTa=b.y;this.RJc=b.height;this.SJc=b.width;this.n3(h)}RT(b){this.wrh=Og.a.createElement("span");return new sp.a(b,this.wrh)}get ju(){return this.$h}zza(b,h,r){return new bq(b,this.id,h,r)}}Object(u.a)(bq,"DialogMenuLauncher",Rl.MenuLauncher,[]);var rs=d(1552);class yi extends Qo.a{constructor(b,h){super(b,h);this.kgb=null}get Wcf(){return this.kgb}get Zdi(){return this.properties}get fca(){return 20}sn(){super.sn();
yf.c(this.Rc)&&this.hE();this.Rc=Og.a.EZa(this.Rc);this.PZ(this.Rc);this.dirty=!1}fR(b){if(!Object(Xa.a)(rs.a,b))throw Error.create("Only children of type StandaloneDock can be added to a DialogMenuRoot");}$rf(b,h,r,A){r=new dj.Menu(this,h,r,A,null);b||(b={});b.CommandMenuOpen=this.Zdi.CommandMenuOpen;b.CommandMenuClose=this.Zdi.CommandMenuClose;b=new bq(this,h,b,r);this.yfc[h]=b;h=new rs.a(this,"dock"+h);h.Vf(b.GW("Menu"));this.Vf(h);this.refresh()}bCg(b,h,r,A){const M=this.yfc[b];if(yf.c(M))throw Error.create('The dialog menu "'+
b+'" does not exist');M.oun(new Sys.UI.Bounds(h,r,0,0),A);this.kgb=M.Ig}Aof(b){b=this.yfc[b];yf.c(b)||(b.uza(),this.kgb=null)}mme(){this.kgb=null}dispose(){const b=this.yfc;for(const h in b)b[h].dispose();super.dispose()}}Object(u.a)(yi,"DialogMenuRoot",Qo.a,[]);class cq{constructor(){this.LabelText=this.TextDirection=this.ImageSpinner=this.ImageExpandedArrowClass=this.ImageExpandedArrow=this.ImageCollapsedArrowClass=this.ImageCollapsedArrow=this.ImageUncheckMarkClass=this.ImageUncheckMark=this.ImageCheckMarkClass=
this.ImageCheckMark=this.ImageUpArrow8by8Class=this.ImageUpArrow8by8=this.ImageUpArrowClass=this.ImageUpArrow=this.ImageSideArrowClass=this.ImageSideArrow=this.ImageDownArrow8by8Class=this.ImageDownArrow8by8=this.ImageDownArrowClass=this.ImageDownArrow=this.DivSyndicated=null}}Object(u.a)(cq,"RootProperties",null,[]);class Ho extends cq{constructor(){super()}}Object(u.a)(Ho,"StandaloneRootProperties",cq,[]);class fj extends Ho{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}
Object(u.a)(fj,"DialogMenuRootProperties",Ho,[]);class Qj{constructor(){this.fkg=(h,r,A,M,aa)=>{if(1===A)return 32;h=new Sys.StringBuilder;h.append('<Menu Id="dialogMenu">');h.append('<MenuSection Id="dialogMenuSection" DisplayMode="Menu"><Controls>');h.append(String.format('<Button Id="DialogMenuMoveControl" Command="{0}" LabelText="{1}"/>',aa.DialogMoveCommand,CommonUIStrings.l_DialogMove));h.append(String.format('<Button Id="DialogMenuCloseControl" Command="{0}" LabelText="{1}"/>',aa.DialogCloseCommand,
CommonUIStrings.l_DialogClose));h.append("</Controls></MenuSection>");h.append("</Menu>");aa.PopulationXML=h.toString();return 32};const b=new fj;b.ImageSideArrow=y.AFrameworkApplication.Ss;b.ImageSideArrowClass=Gg.getImageClass("SubmenuFlyoutArrow_13x13x32");b.TextDirection=y.AFrameworkApplication.isRtl?"rtl":"ltr";this.zd=new yi("DialogMenuRootId",b);this.zd.oH=this;this.zd.refresh();y.AFrameworkApplication.va.fb(Ka.a.fkg,we.a.frame,this.fkg,96)}get T8(){return this.zd}XUa(b,h,r,A,M=null){b=parseInt(b);
A=y.AFrameworkApplication.va;r&&(A.aE=r.CommandLocation,A.b3=r.InvocationMethod);h=A.Pb(b,2,h,M);this.zd.refresh();return 32===h}BLa(b){return b?32===y.AFrameworkApplication.va.Ob(parseInt(b),1):!0}pv(){this.T8.root.rn()}$rf(b,h,r){const A={PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"3675896289",Command:"798637440"};A.DialogMoveCommand=h;A.DialogCloseCommand=r;this.T8.$rf(A,b,"","")}bCg(b,h,r,A){this.T8.bCg(b,h,r,A)}Aof(b){this.T8.Aof(b)}dispose(){this.zd&&(this.zd.dispose(),
this.zd=null)}}Object(u.a)(Qj,"DialogMenuRootUser",null,[218,10,548]);class Yq{constructor(b,h,r){this.kCb=this.yMd=this.$Kc=this.il=null;this.JUe=this.NLd=!1;this.otc=A=>{if(!this.oTf)return!1;A.Nb.preventDefault();this.ZAf();return!0};this.eHc=b;this.oe=h;this.mx=r;this.M7b=y.AFrameworkApplication.isRtl}get oTf(){return this.JUe}X_l(b){b?(this.il=b,this.JUe=!0,this.NLd=!1,this.oe.capture(Object(E.a)(this,this.Psn,"keyEventHandler"),null),this.mx.nb(Jd.a.gt,this.eHc,this.otc),this.$Kc||this.uFl(),
this.il.appendChild(this.$Kc),this.W3m()):v.ULS.sendTraceTag(21516492,201,10,"Cannot move null element")}ZAf(){this.JUe=!1;this.yMd=this.kCb=null;this.Yvo();this.Eqg();this.il=null}Eqg(){this.oe.releaseCapture();this.mx.xc(Jd.a.gt,this.eHc,this.otc)}W3m(){if(this.il.style.left.endsWith("px")&&this.il.style.right.endsWith("px"))this.kCb=new Sys.UI.Point(Co.a.v0(this.M7b?this.il.style.right:this.il.style.left),Co.a.v0(this.il.style.top));else{const b=this.M7b?this.eHc.offsetWidth-(this.il.offsetLeft+
this.il.offsetWidth+Co.a.v0(this.il.style.marginRight)):this.il.offsetLeft-Co.a.v0(this.il.style.marginLeft),h=this.il.offsetTop-Co.a.v0(this.il.style.marginTop);this.hOj(b,h);this.kCb=new Sys.UI.Point(b,h)}this.yMd=this.kCb}uFl(){this.$Kc=Gg.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}Yvo(){this.$Kc.parentNode===this.il&&this.il.removeChild(this.$Kc)}Psn(b){if(!this.oTf)return!1;b.Nb.preventDefault();if(b.eventName===Jd.a.hj){const h=b.Nb.ctrlKey?1:10;let r;switch(b.Nb.keyCode){case cf.a.h9:this.Uqc(0,
-1*h);break;case cf.a.Pha:this.Uqc(0,1*h);break;case cf.a.AAc:r=this.M7b?1:-1;this.Uqc(r*h,0);break;case cf.a.DAc:r=this.M7b?-1:1;this.Uqc(r*h,0);break;case cf.a.Bfb:this.odj(this.yMd.x,this.yMd.y);this.NLd=!0;break;case cf.a.Nu:this.NLd=!0}}b.eventName===Jd.a.pi&&this.NLd&&this.ZAf();return!0}Uqc(b,h){this.odj(this.kCb.x+b,this.kCb.y+h)}odj(b,h){b=this.k1k(b,h);this.hOj(b.x,b.y);this.kCb=b}hOj(b,h){this.M7b?this.il.style.right=b+"px":this.il.style.left=b+"px";this.il.style.top=h+"px"}k1k(b,h){const r=
this.M7b?Co.a.v0(this.il.style.marginRight):Co.a.v0(this.il.style.marginLeft),A=Co.a.v0(this.il.style.marginTop);return new Sys.UI.Point(Math.min(Math.max(-r,b),this.eHc.offsetWidth-this.il.offsetWidth-r),Math.min(Math.max(-A,h),this.eHc.offsetHeight-this.il.offsetHeight-A))}}Object(u.a)(Yq,"KeyMoveAdapter",null,[549]);var uk=d(1649),Zq=d(1467);class Wr{get name(){return"CUI.Behavior"}uc(b){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("AccessibleMovingDialogsEnabled")&&(b.register(548,79).ha().Sd(()=>
new Qj),b.register(549,80).ha().Sd(()=>new Yq(y.AFrameworkApplication.ua.psa(),Xb.KeyInputManager.instance,ck.a.instance)));b.register(Zq.a,"CommandUI.RootManager").as(705).ha().Sd(()=>Zq.a.instance)}init(){uk.a.arf=oi.instance;const b=Zq.a.instance.Gue;for(let h=0;h<b.length;++h){const r=Object(ya.a)(550,b[h]);r&&r.RUa()}zl.a.get_instance().hK(6)}dispose(){}static main(){K.a.instance.Lc(new Wr,5)}}Object(u.a)(Wr,"CuiBehaviorPackage",null,[0,1]);class Io{constructor(b){const h=new Ho;h.ImageUpArrow=
h.ImageDownArrow=h.ImageSideArrow=h.ImageCheckMark=h.ImageUncheckMark=h.ImageDownArrow8by8=h.ImageUpArrow8by8=b;h.ImageUpArrowClass=Gg.getImageClass("RibbonUpArrow_5x3x32");h.ImageDownArrowClass=Gg.getImageClass("SplitButtonArrow_5x3x32");h.ImageUpArrow8by8Class=Gg.getImageClass("RibbonUpArrow_8x8x32");h.ImageDownArrow8by8Class=Gg.getImageClass("SplitButtonArrow_8x8x32");h.ImageSideArrowClass=Gg.getImageClass("SubmenuFlyoutArrow_13x13x32");h.ImageCheckMarkClass=Gg.getImageClass("CheckboxChecked_16x16x32");
h.ImageUncheckMarkClass=Gg.getImageClass("CheckboxUnchecked_16x16x32");h.TextDirection=y.AFrameworkApplication.isRtl?"rtl":"ltr";this.Tkb=Qo.a.YHl(h);this.Tkb.refresh()}get kha(){return this.Tkb}dispose(){this.Tkb.dispose()}}Object(u.a)(Io,"StandaloneRootController",null,[1778,10]);var ho=d(1762),Aj=d(226);class Ls{constructor(b){this.HNc=b}create(b,h){const r=new Sys.StringBuilder;this.jXc(r,b,h);this.wsf(r,b);return r.toString()}iMb(b,h){const r=[];this.jtf(r,b,h);this.xsf(r,b);return r}jXc(b,h,
r){switch(h.errorType){case 0:b.append(this.HNc.build());break;case 1:case 2:b.append(this.glf(h,r))}}jtf(b,h,r){switch(h.errorType){case 0:b.push(this.HNc.EWh());break;case 1:case 2:b.push(this.wdl(h,r))}}wsf(b,h){b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>');b.append(Aj.a("btnIgrnoreSpellingError",(2===h.errorType?ub.a.WOa:ub.a.sBa).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null));b.append("</Controls></MenuSection>")}xsf(b,h){const r=Object.assign(new te.a,
{ControlList:[]});h=2===h.errorType?"UnknownSpellingError":"IgnoreSpellingError";r.ControlList.push(Object.assign(new hk.a,{ExternalId:h}));b.push(r)}glf(b,h){b=this.Pcm(b.suggestions,h);return 0<b.length?Aj.g("msUnknownWord",Aj.d(null,b),"Menu16"):Aj.g("msUnknownWord",Aj.d(null,[Aj.a("btnNoSuggestions",ub.a.WOa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")}Pcm(b,h){const r=[];if(b){const A=Math.min(h.length,b.length);for(let M=0;M<A;++M)b[M]&&r.push(Aj.a("btnCorrectWord"+M,h[M].toString(),
b[M]))}return r}wdl(b,h){const r=Object.assign(new te.a,{Id:"Suggestions",ControlList:[]});this.Ocm(b.suggestions,h,r.ControlList);0>=r.ControlList.length&&(b=Object.assign(new hk.a,{ExternalId:"NoSuggestions"}),r.ControlList.push(b));return r}Ocm(b,h,r){if(b){const A=Math.min(h.length,b.length);for(let M=0;M<A;++M){if(!b[M])continue;const aa=Object.assign(new hk.a,{ExternalId:"btnCorrectWord"+M,Command:h[M].toString(),LabelText:b[M]});r.push(aa)}}}}Object(u.a)(Ls,"DefaultProofingContextMenuCreator",
null,[]);var pq=d(708);class Ms{constructor(b,h){this.Jch=b;this.Leh=h;this.eqa=[ub.a.qzb,ub.a.rzb,ub.a.szb,ub.a.$0b,ub.a.a1b]}create(b,h){return h?Object(Xa.a)(pq.a,h)?this.Leh.create(b,h,this.eqa):this.Jch.create(h,this.eqa):""}rfc(b,h){return h?Object(Xa.a)(pq.a,h)?this.Leh.iMb(b,h,this.eqa):this.Jch.iMb(h,this.eqa):null}}Object(u.a)(Ms,"ProofingContextMenuSectionFactory",null,[653]);class vn{build(){const b=[Aj.a("btnDeleteRepeatedWord",ub.a.eJa.toString(),Box4Intl.Box4Strings.l_DeleteRepeatedWord,
null)];return Aj.g("msRepeatedWord",Aj.d(null,b),"Menu16")}EWh(){const b=Object.assign(new te.a,{ControlList:[]}),h=Object.assign(new hk.a,{ExternalId:"DeleteRepeatedWord"});b.ControlList.push(h);return b}}Object(u.a)(vn,"ProofingRepeatedWordSectionBuilder",null,[651]);class Jo{static get kh(){return ig.a.Ry(Jo.Hn,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,
Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}Jo.Hn="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> </table> </div>";
Object(u.a)(Jo,"AutoCorrectOptionsDialogHTML",null,[]);class On{static get kh(){return ig.a.Ry(On.Hn,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}On.Hn="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='ReplaceQuoteWithSmartQuoteLabel' class='\"WACDialogInlineLabel\"' for='ReplaceQuoteWithSmartQuote'>{8}</label> </td> </tr> </table> </div>";
Object(u.a)(On,"AutoCorrectOptionsDialogHTML2",null,[]);class tp extends ig.a{constructor(b,h){super();this.nOo=(r,A)=>{1!==r?v.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):A.ReplaceTextAsYouType!==this.FY.JZa||A.CapitalizeFirstLetterOfSentences!==this.FY.TTd||A.ReplaceOrdianalsWithSuperscript!==this.FY.Gte||A.ReplaceHyphensWithDash!==this.FY.lkd||A.ReplaceFractionsWithFractionCharacter!==this.FY.Fte||this.Xia&&A.ReplaceQuoteWithSmartQuote!==
this.FY.Osg?(r={},r.ReplaceTextAsYouType=A.ReplaceTextAsYouType,r.CapitalizeFirstLetterOfSentences=A.CapitalizeFirstLetterOfSentences,r.ReplaceOrdianalsWithSuperscript=A.ReplaceOrdianalsWithSuperscript,r.ReplaceHyphensWithDash=A.ReplaceHyphensWithDash,r.ReplaceFractionsWithFractionCharacter=A.ReplaceFractionsWithFractionCharacter,this.Xia&&(r.ReplaceQuoteWithSmartQuote=A.ReplaceQuoteWithSmartQuote),this.FY.FHo(r),v.ULS.sendTraceTag(24523524,324,50,"User close the option dialog and trigger to save the setting: {0}"+
{["ReplaceTextAsYouType"]:A.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:A.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:A.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:A.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:A.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.Xia,["ReplaceQuoteWithSmartQuote"]:this.Xia&&A.ReplaceQuoteWithSmartQuote}),qa.StaticActiveAppFrame.za().Fe(!0)):v.ULS.sendTraceTag(24523523,
324,50,"User close the option dialog or cancle it without do any changes.")};this.FY=b;this.Xia=h;this.Ng="AutoCorrectOptionsDialog"}uCg(){v.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.kh=this.Xia?On.kh:Jo.kh;const b={};b.ReplaceTextAsYouType=this.FY.JZa;b.CapitalizeFirstLetterOfSentences=this.FY.TTd;b.ReplaceOrdianalsWithSuperscript=this.FY.Gte;b.ReplaceHyphensWithDash=this.FY.lkd;b.ReplaceFractionsWithFractionCharacter=this.FY.Fte;this.Xia&&(b.ReplaceQuoteWithSmartQuote=
this.FY.Osg);this.mi(Box4Intl.Box4Strings.l_AutoCorrectOptions,this.nOo,b)}}Object(u.a)(tp,"AutoCorrectOptionsDialog",ig.a,[652]);class ss{static get kh(){return ig.a.Ry(ss.Hn,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}ss.Hn="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(u.a)(ss,"AltTextDialogWithDescriptionHtml",null,[]);class Ih{static get kh(){return ig.a.Ry(Ih.Hn,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}Ih.Hn="<div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(u.a)(Ih,"AltTextDialogWithDescriptionNoTitleHtml",null,[]);class Xf extends ig.a{constructor(b=!1,h=!1){super(!1,!1,b);this.pNi=!1;h?(this.pNi=!0,this.kh=Ih.kh):this.kh=ss.kh;this.Ng=b?"AltTextDialog":"BaseAltTextDialogWithDescription"}Grf(b){this.mi(CommonUIStrings.l_AlternativeTextDialogTitle,Object(E.a)(this,this.O2k,"altTextDialogHandler"),this.VHf(b));b=document.getElementById(Xf.Dgf)||document.getElementById(Xf.vRd);b.focus();b.select()}VHf(b){const h={};this.pNi?h[Xf.PYm]=!0:h[Xf.Dgf]=
this.HFf(b);h[Xf.vRd]=this.Xmm(b)||"";return h}$za(b){return b.If.id===Xf.vRd?!1:super.$za(b)}}Xf.Dgf="titleText";Xf.vRd="descriptionText";Xf.PYm="hideTitleField";Object(u.a)(Xf,"BaseAltTextDialogWithDescription",ig.a,[]);var Ii=d(27);class dm extends Xf{constructor(b,h,r,A,M){super();this.gk=h;this.Dn=r;this.jp=A;this.Od=M;this.ozb=this.n2=null;this.Grf(b)}Xmm(b){this.n2=b.node;this.ozb=Ii.TableReader.KGi(b);return Ii.TableReader.rNf(this.ozb)}HFf(b){this.n2=b.node;this.ozb=Ii.TableReader.KGi(b);
return Ii.TableReader.sNf(this.ozb)}O2k(b,h){if(1===b){b=Ii.TableReader.sNf(this.ozb);const r=Ii.TableReader.rNf(this.ozb),A=h[Xf.Dgf];h=h[Xf.vRd];this.hide();const M=this.jp.Nc(15);try{M.Bb(this.n2),this.gk.Dzg(this.ozb,A),this.gk.mOj(this.ozb,h)}finally{M&&M.dispose()}A===b&&h===r||this.Od.Yu(16)}this.Dn.Co&&this.Dn.Ak.xG(this.n2)}}Object(u.a)(dm,"TableAltTextDialog",Xf,[]);class wn{constructor(b,h,r){this.uG=b;this.Qc=h;this.Yd=r}create(b){return new dm(b,this.uG,Of.a.ud(),this.Qc,this.Yd)}}Object(u.a)(wn,
"TableAltTextDialogFactory",null,[]);const yg=()=>{df.a.WPh=!0;return 32},Ro=(b,h,r,A,M)=>{if(1===r)return 32;if(!({xE:b,Wy:h}=kr(M)).returnValue)return 16;qa.StaticActiveAppFrame.za().fxc(b,h);return 32},ri=(b,h,r,A,M)=>{if(1===r)return 32;if(!({xE:b,Wy:h}=kr(M)).returnValue)return 16;qa.StaticActiveAppFrame.za().xna(b,h);return 32},kr=b=>{let h=null,r=0;if(!b)return{returnValue:!1,xE:h,Wy:r};b=b.split(",");if(3>b.length)return{returnValue:!1,xE:h,Wy:r};h=new Sys.UI.Point(parseInt(b[0]),parseInt(b[1]));
r=parseInt(b[2]);return{returnValue:!0,xE:h,Wy:r}};var Fk=d(1840);class Wj extends Sys.EventArgs{constructor(b,h,r,A,M,aa=0,oa=0,Ja=null){super();this.controlId=b;this.Wsc=r;this.commandId=A;this.time=M;this.commandSurface=aa;this.Wy=oa;this.contentType=Ja}}Object(u.a)(Wj,"CommandClickEventArgs",Sys.EventArgs,[]);class En{constructor(b,h){this.gxa=b.AHf();this.DEc=b;this.egb=h}XUa(b,h,r,A=null,M=null){r&&(this.egb.aE=r.CommandLocation,this.egb.b3=r.InvocationMethod,this.egb.XTa=r.CommandTabName);
b=parseInt(b);let aa=this.DEc.kwi(b,h,r);aa.cag&&(aa=this.DEc.kwi(aa.xO,h,r));if(void 0!==aa.L7a&&null!==aa.L7a)return aa.L7a;if(aa.VQb)M=32;else{var oa=null;this.gxa&&this.gxa.Dkg&&(oa=this.gxa.Dkg(aa,M));aa.Sla||aa.L9c?aa.EJa?M=16:(M=this.egb.Pb(aa.xO,aa.ioc?2:1,aa.rd,M),2===M&&(M=32)):aa.EJa?M=this.egb.Gua(null,aa.xO,aa.rd,Ja=>{A&&A(Ja.response)},M):(M=this.egb.Pb(aa.xO,2,aa.rd,M),A&&A(M));this.gxa&&this.gxa.xkg&&this.gxa.xkg(aa,M,oa);if(h&&r&&-1!==r.InvocationMethod&&r.InvocationMethod){r=h.LegacyId;
if(void 0===r||null===r)r="";oa=h.ParentMenuId;void 0!==oa&&null!==oa||!h.MenuId||(oa=h.MenuId);let Ja=h.SqmControlId;void 0!==Ja&&null!==Ja||!h.SourceControlId||(Ja=h.SourceControlId);(void 0!==Ja&&null!==Ja||void 0!==oa&&null!==oa)&&Fk.a.Xio(new Wj(Ja,r,oa,ce.ActionManager.dea(b),Date.now()))}}aa.Sla&&32===M&&this.gxa&&this.gxa.SHa&&this.gxa.SHa(aa,h);aa.L9c&&32===M&&this.gxa&&this.gxa.M5a&&this.gxa.M5a(aa,h);return 32===M||1===M}BLa(b,h=null){if(y.AFrameworkApplication.Sl||Je.a.instance.Yy)return!1;
null!=h&&null!=h.UILocation&&(this.egb.aE=h.UILocation);const r=parseInt(b);if(!b||r===ce.ActionManager.bzf)return!0;b=this.DEc.$vi(r,h);b.cag&&(b=this.DEc.$vi(b.xO,h));if(void 0!==b.L7a&&null!==b.L7a)return b.L7a;r===Ka.a.Vbc&&h&&(b.rd=h);return 32===this.egb.Pb(b.xO,1,b.rd)}clearCache(){this.DEc.clearCache()}}Object(u.a)(En,"GeneralCuiUser",null,[217,218]);var qq=d(195),si=d(60),Zl=d(53),Rk=d(709);class Fn{get pM(){return null!=this.H5g?this.H5g:this.H5g=Za.a.instance.resolve(392)}constructor(b,
h,r,A){this.$dh="DocumentProofingFailed";this.n$e=b;this.fGh=h;this.pwd=r;this.GK=A}eHm(){const b=this.GK.oEm(this.n$e);return{returnValue:this.GK.pKa(this.n$e),Cfo:b}}qup(b,h){const r=si.a.Ip();if(r){var A=new qq.ScriptSharpLegacyMap;A.add(He.a.mP,b);A.add(Mc.a.noProof,h);b=new Rb.GraphTransaction(15);b.Bb(r);this.pM.vbb(Zl.StyleReader.wordStyleIdNormal,A,r)?Rk.a.d1j():(v.ULS.sendTraceTag(555775183,375,10,"Style could not be modified"),Rk.a.recordQosError(this.$dh,[Rk.a.iNc],"Style could not be modified"));
b.dispose()}else v.ULS.sendTraceTag(555775182,375,10,"PageContentNode not found"),Rk.a.recordQosError(this.$dh,[Rk.a.iNc],"PageContentNode not found")}RPo(b,h){this.qup(b,h)}kVo(b,h){if(this.fGh){var r=new wg.DictionaryPropertySet;this.pwd.execute(A=>{A.IZc(b)});r.setValue(He.a.mP,b);r.setValue(Mc.a.noProof,h);h=new Rb.GraphTransaction(15);h.set(df.a.gf.Ll);this.fGh.v8(r);h.dispose()}}pf(){return ze.a.pf(this.n$e)}}Object(u.a)(Fn,"LanguageEditor",null,[547]);var bp=d(602),cp=d(254),vm=d(109);class st{constructor(b=
!1,h=0){this.languages=st.KFi(tj.a.Plm());this.vFd=new cp.a;this.qZa=[];this.V9b=new bp.a;this.nxj=b;this.Szh=0>=h?7:h;this.Rzh=this.L4e=0;this.ijh=!1;b&&(this.h5m(),y.AFrameworkApplication.XI(()=>{this.jCn()}))}h5m(){for(var b of this.languages)this.vFd.Z(b.LCID,b);b=[];try{const A=Jc.a.get("RecentlyUsedLcids");if(A&&""!==A){const M=decodeURIComponent(A).split(",").slice(0,this.Szh);for(const aa of M){let oa;({value:oa}=this.vFd.Ac(parseInt(aa),oa)).returnValue&&b.push(oa)}}}catch(A){v.ULS.sendTraceTag(38385057,
324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",A.message),Array.clear(b)}if(b.length)for(var h of b){var r=h.LCID;this.V9b.contains(r)||(this.qZa.push(h),this.V9b.add(r))}else h=y.AFrameworkApplication.lcid,({value:r}=this.vFd.Ac(h,r)).returnValue&&(this.qZa.push(r),this.V9b.add(h));this.CHj()}CHj(){const b=vm.toArray(vm.select(vm.asEnumerable(this.qZa),h=>h.LCID)).join(",");Jc.a.UNa("RecentlyUsedLcids",b,180)}Qum(b){let h,r=-1,A=null;var M=st.KFi(this.qZa);
this.nxj&&0<M.length&&(A=vm.toArray(vm.Si(vm.asEnumerable(M),(Ja,fb)=>{b===Ja.LCID&&-1===r&&(r=fb);return{["key"]:fb,["text"]:Ja.displayName,["value"]:Ja.LCID.toString()}})));let aa=0;A&&(aa=A.length);M=aa;const oa=vm.toArray(vm.Si(vm.asEnumerable(this.languages),(Ja,fb)=>{b===Ja.LCID&&-1===r&&(r=aa+fb);return{["key"]:aa+fb,["text"]:Ja.displayName,["value"]:Ja.LCID.toString()}}));h=r;return 0<aa?{returnValue:A.concat.apply(A,oa),selectedIndex:h,Gxc:M}:{returnValue:oa,selectedIndex:h,Gxc:M}}dSo(b,
h){if(this.nxj&&({value:r}=this.vFd.Ac(b,r)).returnValue){h=b!==h;if(this.V9b.contains(b))b=Array.indexOf(this.qZa,r),0<=b&&(Array.removeAt(this.qZa,b),this.qZa.push(r)),h&&this.L4e++;else{this.V9b.add(b);this.qZa.push(r);if(this.qZa.length>this.Szh){var r=this.qZa.shift();this.V9b.remove(r.LCID)}h&&this.Rzh++}this.CHj()}}jCn(){const b=this.L4e+this.Rzh;!this.ijh&&0<b&&(v.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",100*this.L4e/b),this.ijh=!0)}static KFi(b){b=Array.clone(b);
b.sort((h,r)=>h.displayName.localeCompare(r.displayName));return b}}Object(u.a)(st,"LanguageListHelper",null,[545]);var Ko=d(188);class Lm extends Ko.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(u.a)(Lm,"NumberButtonProps",Ko.a,[]);var Al=d(164);class dl{static get D8(){return null!=dl.S2g?dl.S2g:dl.S2g=Za.a.instance.Oa(825)}static get Qab(){return null!=dl.v_g?dl.v_g:dl.v_g=Za.a.instance.Oa(384)}static get kRj(){return!!dl.D8}static Xb(){const b=y.AFrameworkApplication.va;
b.qa(ub.a.vtc,lc.a.view,dl.vtc);b.Pc(ub.a.vtc,1124);b.qa(ub.a.vtc,lc.a.paragraph,dl.zup)}static vtc(b,h,r,A,M){if(1===r||!dl.kRj)return dl.kRj?32:8;if(!dl.LYi){var aa=[];aa.push(Object.assign(new Lm,{ExternalId:"LineSpacing1_00",Number:1,Type:0}));aa.push(Object.assign(new Lm,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0}));aa.push(Object.assign(new Lm,{ExternalId:"LineSpacing1_50",Number:1.5,Type:0}));aa.push(Object.assign(new Lm,{ExternalId:"LineSpacing2_00",Number:2,Type:0}));aa.push(Object.assign(new Lm,
{ExternalId:"LineSpacing2_50",Number:2.5,Type:0}));aa.push(Object.assign(new Lm,{ExternalId:"LineSpacing3_00",Number:3,Type:0}));M.MenuItems=Aj.e(aa);dl.LYi=!0}v.ULS.sendTraceTag(588394560,340,50,"Line Spacing Menu is opened");h=h.view.mb;aa=null;h&&h.gb.currentSelection&&(aa=h.gb.currentSelection);h=Object(Al.a)().pqi(aa.Qa);y.AFrameworkApplication.va.Nf(h,b,r,!0,A,M);return 32}static zup(b,h){let r=b=!0;h=dl.Qab.QVa(h.node);var A=h.beforeSpacing;let M=!1;1===A.unit&&(M=!0);if(M||0<A.value)b=!1;
h=h.afterSpacing;A=!1;1===h.unit&&(A=!0);if(A||0<h.value)r=!1;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(dl.oXk,!b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(dl.Nwo,b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(dl.nXk,!r));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(dl.Mwo,r));return 32}}dl.oXk="AddSpaceBeforeParagraph";dl.nXk="AddSpaceAfterParagraph";dl.Nwo="RemoveSpaceBeforeParagraph";dl.Mwo="RemoveSpaceAfterParagraph";
dl.LYi=!1;Object(u.a)(dl,"LineSpacingRibbonMenu",null,[]);var em=d(194),tt=d(1679),io=d(1494),vi=d(68);const Bp=(b,h,r)=>{if(1===r)return 32;b=qa.StaticActiveAppFrame.za().$J.cka("Automation test",!1);b.image=3;qa.StaticActiveAppFrame.za().$J.Jz(b);return 32},Dr=(b,h,r,A,M)=>{let aa;if(!({H8j:aa}=Mm(M)).returnValue)return 16;em.UISurfaces.aP().then(oa=>{let Ja=null;var fb=Object.assign(new tt.a,{label:"OK",onExecute:()=>{Ja&&oa.removeNotification(Ja)}});fb=Object.assign(new io.a,{target:"#"+vi.a.Rug,
content:"Here's the text for the callout",title:"Your title",primaryButtonProps:fb,useTeachingStyles:aa});fb=oa.callout(fb);Ja=oa.addNotification(fb);return null},oa=>{v.ULS.sendTraceTag(593352341,383,15,"Failed to GetNotificationsAPIAsync: {0}",oa);return null});return 32},Mm=b=>{let h=!1;if(!b)return{returnValue:!1,H8j:h};h=Boolean.parse(b);return{returnValue:!0,H8j:h}};class Qm{constructor(){this.Alt=this.DisplayColor=this.Color=null;this.Disabled=!1}}Object(u.a)(Qm,"ColorCellProps",null,[]);let So,
xn,pm,mn,yn,Im;class Bm{constructor(){this.p$=new ib.a;this.Koh=!1}gTa(b){const h=this.p$.indexOf(b);let r=!0;if(-1!==h){r=!1;if(!h)return r;this.p$.removeAt(h)}this.p$.insert(0,b);v.ULS.sendTraceTag(594899716,340,50,"{0} is added at the start of recent color list.",b);11===this.p$.count&&(v.ULS.sendTraceTag(594899715,340,50,"Removing {0} from the recent color list.",this.p$.K(10)),this.p$.removeAt(10));this.bwp();return r}kAc(b){let h="#";for(let A=0;A<this.p$.count;A++){var r="#"+this.p$.K(A).substring(4,
6)+this.p$.K(A).substring(2,4)+this.p$.K(A).substring(0,2);r=Object.assign(new Qm,{Color:this.p$.K(A),Alt:r,DisplayColor:r});if(r.DisplayColor.toLowerCase()===b.toLowerCase()){h=r.Color;break}}for(const A of Bm.Ozh)appChrome.api.dispatch(appChrome.actions.updateColorPickerSelectedColor(A,h))}bwp(){v.ULS.sendTraceTag(594899714,340,50,"Sending a redux action to populate the recent colors menu section");const b=[];for(let r=0;r<this.p$.count;r++){var h="#"+this.p$.K(r).substring(4,6)+this.p$.K(r).substring(2,
4)+this.p$.K(r).substring(0,2);h=Object.assign(new Qm,{Color:this.p$.K(r),Alt:h,DisplayColor:h});b.push(appChrome.api.colorPickerCell(h.Color,h.DisplayColor,h.Alt))}for(const r of Bm.Ozh)appChrome.api.dispatch(appChrome.actions.populateColorPickerCells(r,b));this.Koh||this.Yup();this.Koh=!0}Yup(){for(const b of Object.keys(Bm.uth)){v.ULS.sendTraceTag(594899713,340,50,"Sending a redux action to update the {0} menu",b);const h=Bm.uth[b],r=[];for(const A of h)r.push(appChrome.api.menuSection(A,A[0]in
Bm.D_e?Bm.D_e[A[0]].toString():null));appChrome.api.dispatch(appChrome.actions.updateMenu(b,r,Bm.D_e[b].toString()))}}}Bm.uth={["FontColor"]:(Im=new ib.a,Im.add(["AutomaticFontColor"]),Im.add(["ThemeFontColorPickerMCU"]),Im.add(["ThemeFontColorPicker"]),Im.add(["StandardFontColorPicker"]),Im.add(["RecentFontColorPicker"]),Im.add(["MoreFontColors"]),Im),["CellShading"]:(yn=new ib.a,yn.add(["ThemeShadingColorPickerMCU"]),yn.add(["ThemeShadingColorPicker"]),yn.add(["StandardShadingColorPicker"]),yn.add(["RecentCellShadingColorPicker"]),
yn.add(["ClearShadingColor"]),yn.add(["MoreCellShadingColors"]),yn),["PictureBorders"]:(mn=new ib.a,mn.add(["ThemePictureBorderColorPickerMCU"]),mn.add(["ThemePictureBorderColorPicker"]),mn.add(["StandardPictureBorderColorPicker"]),mn.add(["RecentPictureBorderColorPicker"]),mn.add(["MorePictureBorderColors"]),mn.add(["NoPictureBorder"]),mn.add(["PictureBorderWeightOptions"]),mn.add(["PictureBorderStyleOptions"]),mn),["PageColor"]:(pm=new ib.a,pm.add(["ThemePageColorPickerMCU"]),pm.add(["ThemePageColorPicker"]),
pm.add(["StandardPageColorPicker"]),pm.add(["RecentPageColorPicker"]),pm.add(["NoPageColor"]),pm.add(["MorePageColors"]),pm),["ParagraphShading"]:(xn=new ib.a,xn.add(["AutomaticParagraphShadingColor"]),xn.add(["ThemeParagraphShadingColorPickerMCU"]),xn.add(["ThemeParagraphShadingColorPicker"]),xn.add(["StandardParagraphShadingColorPicker"]),xn.add(["RecentParagraphShadingColorPicker"]),xn.add(["NoParagraphShadingColor","MoreParagraphShadingColors"]),xn)};Bm.D_e={["StandardFontColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,
["StandardShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardPageColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardParagraphShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["RecentFontColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentHighlighterColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentCellShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentPictureBorderColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,
["RecentPageColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentParagraphShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["FontColor"]:Box4Intl.Box4Strings.L_FontColor,["Highlighter"]:Box4Intl.Box4Strings.L_HighlightColor,["CellShading"]:Box4Intl.Box4Strings.L_CellShadingColor,["PictureBorders"]:Box4Intl.Box4Strings.L_PictureBorderColor,["ParagraphShading"]:"Paragraph Shading",["PageColor"]:Box4Intl.Box4Strings.L_PageColor};Bm.Ozh=(So=new ib.a,So.add("RecentFontColorPicker"),
So.add("RecentCellShadingColorPicker"),So.add("RecentPictureBorderColorPicker"),So.add("RecentPageColorPicker"),So.add("RecentParagraphShadingColorPicker"),So);Object(u.a)(Bm,"RecentColorsSectionHandler",null,[]);var dp=d(1857),Pn=d(1492);class rq{constructor(b){this.fGk=b}T7(){}R7(b){this.fGk.YOn(b)}}Object(u.a)(rq,"DataBuddyActionListener",null,[148]);class pl{constructor(){this.type="DataBuddyTaskPaneProps";this.onClearClick=this.clearButtonLabel=this.actions=null}}Object(u.a)(pl,"DataBuddyTaskPaneProps",
null,[]);class el{constructor(b){this.isVisible=!1;this.U0=new ib.a;this.xIe=null;this.V5=b;this.wC=new dp.a;this.Yb=Cd.FocusManager.instance()}initialize(){this.xIe=new rq(this);this.V5.nUa();this.wC.IN(this.xWk());this.wC.IN(this.hTk())}toggle(){this.isVisible?this.hide():this.show()}YOn(b){if(2===b.behavior){const h=ce.ActionManager.dea(b.actionId)||b.actionId.toString();h.startsWith("Query")||(this.U0.add(h+": "+el.Edm(b.response)),this.jn())}}hide(){em.UISurfaces.Iv().then(b=>{b.hideTaskPane(el.yD,
2);return null})}show(){em.UISurfaces.Iv().then(b=>{b.showTaskPane(el.yD,this.EB());return null});this.isVisible&&em.UISurfaces.Iv().then(b=>{b.setSelectedTaskPane(el.yD);return null})}xWk(){return b=>{b.actions=this.U0.toArray();b.clearButtonLabel=CommonUIStrings.l_WAC_DataBuddyClearButtonLabel}}hTk(){return b=>{b.onClearClick=()=>{this.U0.clear();this.jn()}}}Xb(){y.AFrameworkApplication.va.A0(this.xIe)}kfb(){y.AFrameworkApplication.va.R1b(this.xIe)}EB(){const b=new pl;this.wC.dyb(b);return Object.assign(new Pn.a,
{title:"Data Buddy",hideHeader:!1,width:el.width,location:2,contentProps:b,onOpen:()=>{this.lca();this.Xb();this.isVisible=!0;y.AFrameworkApplication.ua.Fe()},onClose:()=>{this.bha();this.kfb();this.isVisible=!1;this.jn();y.AFrameworkApplication.ua.Fe()},isModernPane:!0})}jn(){em.UISurfaces.Iv().then(b=>{b.updateTaskPane(el.yD,this.EB());return null})}lca(){this.Yb.Jg(el.yD)}bha(){this.zab()&&this.Yb.Jg(this.Yb.IW)}zab(){return!!this.Yb.currentScope&&this.Yb.currentScope.name===el.yD}static Edm(b){switch(b){case 0:return"Unattempted";
case 1:return"In Progress";case 2:return"Not Handled";case 4:return"Handle Externally";case 8:return"Failed";case 16:return"Error";case 32:return"Succeeded";case 64:return"Delayed";default:return b.toString()}}}el.yD="DataBuddyTaskPane";el.width=300;Object(u.a)(el,"Box4DataBuddyTaskPane",null,[544]);class Fl{constructor(b){this.hi=b}$Oa(b){this.hi&&this.hi.eJ(b)}nsd(){this.hi&&this.hi.Dsd(void 0)}}Object(u.a)(Fl,"RibbonButtonUpdater",null,[543]);var Qn=d(337);class To{constructor(){this.B8e=this.W=
null}get name(){return"Box4.UI"}uc(b){this.W=b;b.ia(708,()=>new En(b.resolve(826),y.AFrameworkApplication.va)).ha();b.ia(686,()=>new wn(b.resolve(33),new Qn.a,b.resolve(46).instance)).ha();b.ia(1089,()=>new Fn(gg.a.instance.Mg,b.Oa(35),b.Ra(105),b.resolve(331)));b.ia("CommandUI.StandaloneRootController",()=>new Io(y.AFrameworkApplication.Ss)).as(48).ha();b.ia(924,()=>new tp(b.resolve(816),y.AFrameworkApplication.J.$("ReplaceQuoteWithSmartQuoteIsEnabled")));b.ia("Box4.UI.LanguageListHelper",()=>new st(y.AFrameworkApplication.J.$("RecentlyUsedLanguagesListIsEnabled"))).as(1090).ha();
b.register(vn,"Box4.UI.ProofingRepeatedWordSectionBuilder").as(827).ha();b.ia(828,()=>new Ls(b.resolve(827))).ha();b.ia("Box4.UI.ProofingContextMenuSectionFactory",()=>new Ms(b.resolve(828),b.resolve(829))).as(1077).ha();b.ia("Box4.RibbonButtonUpdater",()=>new Fl(this.W.resolve(349))).as(1570).ha();b.ia(788,()=>new Bm).ha();b.ia("Common.IDataBuddyTaskPane",()=>new el(ho.a.instance)).ha()}init(){var b=qa.StaticActiveAppFrame.za();const h=b.Ib;kc.Y2m(Object(E.a)(h,h.TVb,"onAuthenticationLost"),Object(E.a)(h,
h.UVb,"onAuthenticationRestored"),b.yjl);b=y.AFrameworkApplication.va;b.qa(ub.a.rco,lc.a.application,yg);b.fb(ub.a.l3o,lc.a.application,Ro,96);b.fb(ub.a.U3o,lc.a.application,ri,96);b=y.AFrameworkApplication.va;b.fb(ub.a.K5o,lc.a.application,Bp,96);b.fb(ub.a.b3o,lc.a.application,Dr,96);dl.Xb();this.p5m();this.B8e=this.W.resolve(48)}p5m(){this.W.Ra(708).execute(b=>{this.W.Ra(48).execute(h=>{h.kha.oH=b})})}dispose(){this.B8e.dispose();this.B8e=null}static main(){K.a.instance.Lc(new To,6)}}Object(u.a)(To,
"Box4UIPackage",null,[0,1]);var yh=window.InsightsTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InsightsTaskPane",Title:"STR@L_SmartLookupPaneTitle",Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"InsightsIFrameContainer",IsStretched:"true"}}]}]}]},Xr=d(1858);class ut{get name(){return"Box4.Insights"}init(){}dispose(){}uc(b){b.ia("Box4.Insights.Box4InsightsSelection",()=>new Xr.a).as(1178).as(1059).ha()}}
Object(u.a)(ut,"Box4InsightsPackage",null,[0,1]);const Nq=b=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+b)};var Cp=d(410),so=d(543),Sp=d(701),ts=d(1821);class Tp{Mub(){return!1}reset(){}update(){}}Object(u.a)(Tp,"NullTaskYieldStrategy",null,[671]);var Ns=d(1260);class us{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=
this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(u.a)(us,"CatchUpConfiguration",null,[]);class ct{constructor(){this.recentChangesManager=this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}}
Object(u.a)(ct,"SharedControllerFactoryParameters",null,[]);var $l=d(615),Fc=d(20);class nn{constructor(b,h,r,A){this.J0n=(M,aa)=>{(this.nDd=!this.nDd)&&aa.Ik&&aa.Ik.contextId===lc.a.Xc&&this.h0h(aa.Ik.node,aa.Ik.Hj);return 32};this.uz=b;this.Mp=h;this.ga=r;this.Yb=A;this.TEd=this.UEd=null;this.nDd=!1;this.ga.qa(Fc.a.y_j,lc.a.view,this.J0n);this.Yb.ie(id.AFrame.Eq).bindAction(Xb.KeyInputManager.mc(cf.a.XBc,6),Fc.a.y_j)}tP(b,h){this.nDd&&this.Mp&&h&&h.Rm&&h.Rm.currentSelection&&h.Rm.currentSelection.Qa&&
h.Rm.currentSelection.Qa.node&&h.Rm.currentSelection.Qa.contextId===lc.a.Xc&&this.h0h(h.Rm.currentSelection.Qa.node,h.Rm.currentSelection.Qa.Hj)}h0h(b,h){b&&(this.Dfj(b)?(this.UEd&&this.UEd.id.equals(b.id)||(this.Mp.sendNotification(WordEditorIntl.WordEditorStrings.L_CatchUpActivityParagraphAnnouncementTemplate,!1),this.UEd=b),this.LEn(b,h)):this.TEd=this.UEd=null)}Dfj(b){return 0<this.uz.OPb(b).count}LEn(b,h){if(b){var r=-1,A=null,M=null;for(let aa=0;aa<b.ra.length;aa++){const oa=b.ra.K(aa);if(!(null==
M||oa.changeStart&&oa.changeStart.equals(A))&&h>=r&&h<=oa.cp&&!A.equals(this.TEd))if(this.uz.PSb(A)){(b=this.uz.$0c(A,b.id))&&0<b.actors.length&&b.displayTimestamp&&(b=String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityChangeAnnouncementTemplate,b.actors[0].displayName,b.displayTimestamp.toLocaleString()),this.Mp.sendNotification(b,!1),this.TEd=A);break}else this.TEd=null;oa.changeStart&&!oa.changeStart.equals(A)&&(r=oa.cp,A=oa.changeStart);M=oa.changeStart}}}}Object(u.a)(nn,"ActivityAnnouncementManager",
null,[]);var $q=d(1495),Lj=d(535),Cm=d(765),vk=d(589);class Rm{constructor(){this.activityId=null;this.type=0;this.priorityId=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(u.a)(Rm,"Activity",null,[]);var qm=d(400);class sq extends Rm{constructor(){super();this.Ew=this.objectId=null}static uS(b){const h=new vk.a(new qm.a);if(b.Ew)for(const r of b.Ew)h.add(r);return h}}Object(u.a)(sq,"RevisionSetActivity",Rm,[]);class hj{constructor(b,h,r,A=!1){this.VMe=
null;this.dismiss=()=>{this.bgj.then(M=>{M.removeNotification(this.VMe);return this.VMe=null})};this.VZ=b;this.Rb=h;this.bgj=r;this.Unc=A}Smp(b){if(b)switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:case 11:this.Rb.Pb(Ka.a.Ebb,2,null);break;default:this.cPn()}else v.ULS.sendTraceTag(593049027,3012,10,"Null activity: TryNotifyContentDoesNotExist. Unable to notify.")}cPn(){this.bgj.then(b=>{var h=Object.assign(new io.a,{target:'[data-unique-id~="CatchUpWithChanges"]',showCloseIcon:!0,
content:CommonUIStrings.l_ChangeDoesNotExistNotification,calloutProps:Object.assign(new $q.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});h=b.callout(h);const r=Object.assign(new Lj.a,{expirationOptions:Object.assign(new Cm.a,{displayTimeoutSeconds:10,onExpire:this.dismiss})});this.VMe=b.addNotification(h,r)})}doesContentExist(b){if(!b)return v.ULS.sendTraceTag(593049026,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:case 11:if(!b.navigationId)return v.ULS.sendTraceTag(593049025,
3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;const h={};h.NavigationId=atob(b.navigationId);if(8===this.Rb.Pb(Ka.a.r_d,2,h))return!1;break;case 1:return this.pUl(b)}return!0}pUl(b){b=sq.uS(b);return b?0<this.VZ.Q5d(b).count:(v.ULS.sendTraceTag(593049024,3012,10,"Null changeIds: DoRevisionsExist. Default to false."),!1)}}Object(u.a)(hj,"ActivityContentManager",null,[632]);var Oq=d(1350),Pq=d(2082),ql=d(399),lr=d(704);class Qq{constructor(){this.Ew=this.J_=null}compare(b){if(!b)return!1;
if(this.J_&&b.J_){if(this.J_.count!==b.J_.count)return!1;for(const h of this.J_)if(!b.J_.contains(h))return!1}else if(!b.J_&&this.J_||!this.J_&&b.J_)return!1;if(b.Ew&&this.Ew){if(b.Ew.count!==this.Ew.count)return!1;for(const h of this.Ew)if(!b.Ew.contains(h))return!1}else if(!this.Ew&&b.Ew||!b.Ew&&this.Ew)return!1;return!0}}Object(u.a)(Qq,"ActivityHighlightableObject",null,[]);class Os extends Oq.a{constructor(b,h){super();this.T3e=this.I9b=null;this.Evd=b;this.uz=h;this.w5=[new Pq.a(ql.a.NZh,ql.a.MZh),
new Pq.a(ql.a.KZh,ql.a.JZh),new Pq.a(ql.a.ZTd,ql.a.$Td),new Pq.a(ql.a.aUd,ql.a.Mmf)]}get Erb(){return 1}get Y9a(){return this.w5}get wfa(){return!0}q9a(b,h){if(b=Object(ya.a)(Qq,b))if(b.J_)for(const r of b.J_)h.add(r);else v.ULS.sendTraceTag(594900750,377,15,"Activity Highlight: no highlightable paragraphs")}zMa(b,h){if(this.vs.TIa){var r=this.Evd.Adb,A=this.Evd.Grb,M=!!r&&r.compare(A),aa=this.vs.TIa,oa=aa.action,Ja=this.L_o(aa,b),fb=!1;2!==oa&&oa&&(fb=(fb=this.vs.iad)?1===fb.type:!!r||!!A);h=h.ZMa("*");
for(let Cb=0,Gb=h.length;Cb<Gb;Cb++){const Sb=h[Cb],pc=this.oom(Sb,ql.a.dUc);if(pc&&pc.$u)if(this.yvo(Sb),1===aa.type)switch(oa){case 0:Ja&&r.Ew.contains(pc.$u)&&this.RRd(Sb,2,pc,!1);break;case 2:Ja&&A.Ew.contains(pc.$u)&&this.RRd(Sb,M?2:1,pc,!1);break;default:this.xlc(b,Sb,pc,!1)}else fb?this.xlc(b,Sb,pc,!1):this.xlc(b,Sb,pc,!0)}this.I9b&&(this.I9b.classList.add(ql.a.aUd),this.T3e=this.I9b=null)}}oom(b,h){return nk.a.Eb(b,h)}L_o(b,h){if(b&&b.UB){const r=b.UB,A=b.action;if(1===b.type&&(2===A||!A)&&
r.J_)return r.J_.contains(h);if(r.Ew)for(const M of r.Ew){b=this.uz.z2c(M);for(const aa of b)if(aa===h)return!0}}return!1}xlc(b,h,r,A){const M=this.Evd.Adb,aa=this.Evd.Grb;M&&M.Ew.contains(r.$u)&&(!M.J_||M.J_.contains(b))?this.RRd(h,2,r,A):aa&&aa.Ew.contains(r.$u)&&(!aa.J_||aa.J_.contains(b))&&this.RRd(h,1,r,A)}RRd(b,h,r,A){b&&lr.a(b)&&(b.classList.add(this.zsm(2===h,A)),this.qRo(b,r,A))}qRo(b,h,r){this.I9b?-1!==h.cpEnd&&this.T3e.cpEnd!==h.cpBegin&&(this.I9b.classList.add(r?ql.a.Mmf:ql.a.aUd),b.classList.add(r?
ql.a.$Td:ql.a.ZTd)):b.classList.add(r?ql.a.$Td:ql.a.ZTd);b.classList.add(ql.a.LZh);this.I9b=b;this.T3e=h}yvo(b){this.vs.BZa(b);this.ruo(b)}ruo(b){b.classList.remove(ql.a.ZTd,ql.a.$Td,ql.a.LZh,ql.a.aUd,ql.a.Mmf)}zsm(b,h){return h?b?ql.a.JZh:ql.a.MZh:b?ql.a.KZh:ql.a.NZh}}Object(u.a)(Os,"ActivityHighlightActor",Oq.a,[]);var Sm=d(2083),Er=d(163);class Di{constructor(b,h,r,A,M,aa,oa,Ja){this.ZY=b;this.BQ=h;this.uz=r;this.cGk=M;this.hb=aa;this.Mp=Ja;this.Yb=oa;this.BQ.zee=!1}smj(b,h,r){b?this.ZYm(b,h,r):
this.BQ.Adb&&(b=Object.assign(new Sm.a,{action:1,type:1,UB:null,VL:this.BQ.Adb}),this.BQ.Adb=null,this.ZY.qH(b))}ZYm(b,h,r){if(h){b=new vk.a(new qm.a);for(M of h){var A=this.uz.A1c(M);for(let aa=0;aa<A.length;aa++){const oa=A[aa];this.uz.PSb(oa)&&b.add(oa)}}var M=this.uz.Q5d(b);M=this.E7h(M,b);A=this.BQ.Adb;this.BQ.Adb=M;M=Object.assign(new Sm.a,{action:0,type:1,UB:this.BQ.Adb,VL:A});this.ZY.qH(M);r&&!this.uJo(h.K(0),b)||this.nLo(h.K(0),b)}else v.ULS.sendTraceTag(589345503,377,10,"HighlightActivity: no target nodes for activityId {0}",
b.activityId)}uJo(b,h){if(!b)return v.ULS.sendTraceTag(587239560,377,10,"ScrollToHighlightParagraph: No target node from activity"),!1;if(12!==b.type)return v.ULS.sendTraceTag(587239561,377,10,"ScrollToHighlightParagraph: target node is not a paragraph"),!1;h=this.ulm(b,h);return this.cGk.QZb(b.id,h)?this.Kc(b,h)?!0:!1:(v.ULS.sendTraceTag(587239563,377,10,"ScrollToHighlightParagraph: call to ScrollToParagraphMatchingNodeId failed"),!1)}nLo(b,h){b=this.Asm(b,h);h=new Sys.StringBuilder;for(let r=0;r<
b.count;r++)h.append(String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityHighlightReadoutTemplate,r+1,b.count,b.K(r)));this.Mp.sendNotification(h.toString(),!0)}Kc(b,h){if(!b||!Gd.ParagraphReader.Vb(b))return v.ULS.sendTraceTag(579396806,377,10,"SetSelection: Invalid node provided"),!1;if(0>h)return v.ULS.sendTraceTag(579396807,377,10,"SetSelection: Invalid cp provided"),!1;this.BQ.zee=!0;b=wc.a.Tc(b,h);b=new Er.Selection([b],!0);this.hb.Kc(b);Cd.FocusManager.nM()&&this.Yb.Jg(id.AFrame.Ro);
return!0}ulm(b,h){if(h&&0<h.count)for(let r=0;r<b.ra.length;r++){const A=b.ra.K(r);if(A.changeStart&&h.contains(A.changeStart))return A.cp}v.ULS.sendTraceTag(36824330,377,15,"Could not find the matching change in the paragraph, return default cp 0");return 0}Asm(b,h){const r=new ib.a;if(h&&0<h.count&&b){let A=-1;for(let M=0;M<b.ra.length;M++){const aa=b.ra.K(M);if(-1!==A&&aa.ys)if(aa.changeStart&&h.contains(aa.changeStart))continue;else r.add(b.characterData.substring(A,aa.cp)),A=-1;aa.changeStart&&
h.contains(aa.changeStart)&&(A=aa.cp)}}return r}mlj(b,h){if(b)switch(b.type){case 1:if(h){b=new vk.a(new qm.a);for(var r of h){h=this.uz.A1c(r);for(let A=0;A<h.length;A++){const M=h[A];this.uz.PSb(M)&&b.add(M)}}}else b=sq.uS(b);h=this.uz.Q5d(b);this.BQ.Grb=this.E7h(h,b);r=Object.assign(new Sm.a,{action:2,type:1,UB:this.BQ.Grb,VL:null});this.ZY.qH(r)}else this.BQ.Grb&&(r=Object.assign(new Sm.a,{action:3,type:1,UB:null,VL:this.BQ.Grb}),this.BQ.Grb=null,this.ZY.qH(r))}E7h(b,h){var r=null;if(b){r=new Sa.a;
for(const A of b)12===A.type&&r.add(A)}b=new Qq;b.J_=r;b.Ew=h?h:this.nym(r);return b}nym(b){const h=new vk.a(new qm.a);if(!b)return h;for(const r of b)for(const A of this.uz.OPb(r))h.add(A);return h}}Object(u.a)(Di,"ActivityHighlightManager",null,[]);var fm=d(853),Lo=d(699),jl=d(1348),wm=d(59),Vn=d(91),tq=d(56);class lq{constructor(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}}Object(u.a)(lq,"CreateIndicatorTooltipParameters",null,[]);class vt{constructor(){this.clearSticky=
!1}}Object(u.a)(vt,"DismissIndicatorTooltipParameters",null,[]);class Dp{constructor(){this.target=null;this.isSticky=!1}}Object(u.a)(Dp,"UpdateIndicatorTooltipParameters",null,[]);class Wn extends Sys.EventArgs{constructor(b,h,r){super();this.mOb=b;this.yPi=h;this.T0o=r}}Object(u.a)(Wn,"ActivityIndicatorEventArg",Sys.EventArgs,[]);class Fr{constructor(){this.zPi=new Map;this.APi=new Set}Ejp(b,h){this.APi.add(b);this.zPi.set(b,h)}cin(b){return Le.a.gWi(b.htmlElement)}COm(){const b=new Set;for(const h of this.APi){const r=
this.zPi.get(h);r&&this.bin(r)&&b.add(h)}return b}bin(b){return b.parentElement&&Le.a.gWi(b.parentElement)}}Object(u.a)(Fr,"IndicatorVisibilityTracker",null,[]);class Ia extends jl.a{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb){super();this.sa=new Td.a;this.gEb=this.tda=null;this.BUm=(Gb,Sb,pc,zc,Yc)=>{if(!Yc)return v.ULS.sendTraceTag(592540299,377,50,"Null actionData: HandleShowIndicatorFlyoutForActivity"),8;Sb=sq.uS(Yc.Activity);Gb=null;if(Yc.NodeId&&(Yc=Vn.b(Yc.NodeId),!N.a.xt(Yc,N.a.nil)&&(Yc=this.uz.Axi(Yc),
this.xJg(Yc,!1))))return 32;for(const Kd of Sb)if(this.uz.PSb(Kd)){Yc=this.uz.rjc(Kd);if(this.xJg(Yc,!0))return 32;Yc&&!Gb&&(Gb=Yc)}if(this.xJg(Gb,!1))return 32;v.ULS.sendTraceTag(589866521,377,15,"Unable to find indicator from ShowIndicatorFlyoutForActivity");return 8};this.zUm=(Gb,Sb,pc,zc,Yc)=>{v.ULS.sendTraceTag(595126290,377,50,"User requested to Show Catch-Up Activities for a Paragraph from the Context Menu.");Yc&&Sb&&Sb.Al&&(Gb=Sb.node)&&((Gb=this.qCc.b6d(Gb))?this.RPd(Gb,!1,!1):v.ULS.sendTraceTag(595126289,
377,50,"Unable to obtain indicator container for node after context menu action."));return 32};this.M5o=Gb=>{(Gb=this.qCc.b6d(Gb.Yl))&&this.RPd(Gb,!1,!1)};this.uma=Gb=>this.pkj(Gb.Ny,!0);this.vma=Gb=>{Gb=Gb.Ny;if(Gb===this.tda)return!0;this.tAj(Gb);return!0};this.kua=Gb=>{this.gEb=null;return this.pkj(Gb.Ny,!1)};this.C3=()=>{this.ZCg();this.ZUd(!0);return!1};this.nv=()=>{this.ppj()};this.poe=()=>{this.tda&&this.X5j(this.tda);this.gEb&&this.tAj(this.gEb);this.iWn()};this.ppj=()=>{this.tda?this.X5j(this.tda):
this.Nnf()};this.uz=b;this.IIe=h;this.mlh=r;this.txk=A;this.ZRa=M;this.K9=null;this.Gb=oa;this.qCc=Ja;this.NUe=new Fr;this.Fy=fb;this.IM=Cb;this.tl&&(this.tl.g6(this.poe),this.tl.DOh(this.ppj));aa&&aa.execute(Gb=>{Gb.YX(this.nv)})}get tl(){return this.ZRa&&this.ZRa.gj?this.ZRa:(v.ULS.sendTraceTag(579396804,377,15,"Could not obtain valid PageView."),null)}Iea(b,h,r){if(this.tda){var A=tq.a(this.tda);if(b===A)return this.tda}const M=b.uh.ownerDocument;A=fm.a.createElement(M,Lo.a.div);A.className=ql.a.bUd;
A.style.left=h+"px";A.style.top=r+"px";h=fm.a.createElement(M,Lo.a.div);h.className=this.Fy?ql.a.TZh:ql.a.OZh;A.style.cursor="pointer";h.style.cursor="pointer";h.style.backgroundColor=this.IM.Zhm();h.style.outlineWidth="1px";h.style.outlineStyle="solid";h.style.outlineColor=this.IM.$hm();A.appendChild(h);ie.a.instance.nb(Jd.a.UR,A,this.uma);ie.a.instance.nb(Jd.a.ML,A,this.vma);Qc.a.instance.nb(Jd.a.click,A,this.kua);ie.a.instance.nb(Jd.a.contextMenu,A,this.C3);v.ULS.sendTraceTag(41457152,377,50,"An activity indicator has been created!");
this.YAn(b);h=this.jzm(b);this.NUe.Ejp(h,A);this.NUe.cin(b)&&this.Fjj(h);return A}u_a(b){return this.FZo(b)}kUa(b){const h=this.mhl(b),r=[];r.push(this.Iea(b.H3,h,b.MAc[0].y-b.m7[0].y));return r}mhl(b){let h=ql.a.d2m+(0>b.Aad?-b.Aad:0);const r=Ah.a.qj(b.qba,0)/2;1>=r&&v.ULS.sendTraceTag(578082778,377,50,"Margin is too small to show indicators");h=h>r?r:h;h=h<ql.a.PZh?ql.a.PZh:h;return y.AFrameworkApplication.isRtl?b.m7[0].width/this.zoom+h:-h}xQj(b){if(b&&b.wc===wm.a.paragraphNode||b.wc===wm.a.Ina){const h=
this.uz.OPb(b);if(h)for(const r of h)if(b===this.uz.rjc(r))return!0}return!1}FZo(b){for(const h of Gd.ParagraphReader.Hv(b.Cb,!0,!1))if(this.xQj(h))return!0;return!1}Xb(b){b.qa(Fc.a.eSj,lc.a.Xc,this.zUm);b.qa(Fc.a.qCg,lc.a.Xc,this.BUm)}xJg(b,h){if(!b)return!1;const r=this.qCc.b6d(b);if(r)return this.RPd(r,!1,!0),!0;if(!h){let A;this.yid((A=new ib.a,A.add(b),A),!1,!0,!0);h=new xc.a(3,1,0,this.M5o,181);h.Yl=b;this.Gb.Zb(h);return!0}return!1}nEl(b,h=!1){h&&this.ZUd(!0);if(b&&b.parentNode){var r=this.CNf(b);
r=this.Qdm(r);this.K9||(this.K9=document.createElement("Div"),document.getElementById(y.AFrameworkApplication.wSc).appendChild(this.K9));this.IIe.createActivityIndicatorTooltip(Object.assign(new lq,{target:b,container:this.K9,activityIds:r,isSticky:h,dirHint:9}));h&&(this.tda=b)}else v.ULS.sendTraceTag(36794392,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}aZl(b){b&&b.classList.add(ql.a.cUd)}pkj(b,h){return this.RPd(b,
h,!1)}RPd(b,h,r){if(h&&b===this.tda)return!0;const A=this.CNf(b);h||this.ZCg();this.nEl(b,!h);this.aZl(b.getElementsByClassName(this.Fy?ql.a.TZh:ql.a.OZh)[0]);this.yid(A,h,!0,r);this.$8i(A,h?1:2);this.txk.Lhe();h&&(this.gEb=b);return!0}ZUd(b=!1){this.IIe.dismissActivityIndicatorTooltips(Object.assign(new vt,{clearSticky:b}));this.gEb=null;b&&(this.tda=null)}HTj(b){b&&b.classList.remove(ql.a.cUd)}ZCg(){this.tda&&this.HTj(this.tda.getElementsByClassName(ql.a.cUd)[0])}tAj(b){const h=this.CNf(b);this.yid(h,
!0,!1,!1);this.HTj(b.getElementsByClassName(ql.a.cUd)[0]);this.ZUd(!1);this.gEb=null}CNf(b){let h=null;(b=(b=tq.a(b))?b.Cb:null)&&11===b.type&&(h=Gd.ParagraphReader.Hv(b,!0,!1));return h}Nnf(){const b=!!this.gEb;if(this.tda||b)this.ZCg(),this.ZUd(!0),this.yid(null,!1,!1,!1),this.yid(null,!0,!1,!1)}BYk(b){this.sa.addHandler(Ia.ZKh,b)}CYk(b){this.sa.addHandler(Ia.$Kh,b)}yid(b,h,r,A){let M=null;if(r&&b){for(const aa of b)if(r=this.uz.A1c(aa))for(let oa=0;oa<r.length;oa++){const Ja=r[oa];if(this.uz.PSb(Ja)){M=
this.uz.$0c(Ja,aa.id);break}}if(!M){v.ULS.sendTraceTag(36717344,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in this GraphNode.");return}}h?this.sa.raiseEvent(Ia.ZKh,new Wn(M,b,!1)):this.sa.raiseEvent(Ia.$Kh,new Wn(M,b,A))}Qdm(b){const h=[];if(b)for(const A of b){var r=this.uz.OPb(A);for(const M of r)(r=this.uz.$0c(M,A.id))&&h.push(r.activityId)}!h.length&&b&&b.count&&v.ULS.sendTraceTag(36844643,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in these Nodes.");
return h}X5j(b){b&&b.parentNode?(this.IIe.updateActivityIndicatorTooltip(Object.assign(new Dp,{target:b,isSticky:!0})),this.tda=b):v.ULS.sendTraceTag(40935511,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}iWn(){const b=this.NUe.COm();for(const h of b)this.Fjj(h)}Fjj(b){this.mlh.Z8i(b,3)}jzm(b){return(b=Gd.ParagraphReader.Hv(b.Cb,!0,!1))&&b.count?b.K(0).id:null}YAn(b){b=Gd.ParagraphReader.Hv(b.Cb,!0,!1);this.$8i(b,0)}$8i(b,
h){b&&b.count&&this.XAn(b.K(0).id,h)}XAn(b,h){this.mlh.Z8i(b,h)}}Ia.ZKh="ActivityIndicatorPreviewed";Ia.$Kh="ActivityIndicatorSelected";Object(u.a)(Ia,"ActivityIndicatorActor",jl.a,[]);var Bb=d(31);class jc{constructor(b,h,r){this.uz=b;this.WNd=h;this.ZRa=r}get tl(){return this.ZRa&&this.ZRa.gj?this.ZRa:(v.ULS.sendTraceTag(555356833,377,15,"Could not obtain valid PageView."),null)}b6d(b){v.ULS.sendTraceTag(555356834,377,50,"Attempting to find the indicator container related to changes in a given node.");
const h=this.Dyi(b);if(!h){v.ULS.sendTraceTag(555356835,377,50,"Looking in different nodes to find the indicator container related to grouped changes on the desired node.");b=this.uz.OPb(b);for(const r of b)if(b=this.uz.rjc(r),b=this.Dyi(b))return b}return h}Dyi(b){if(!b||12!==b.type)return v.ULS.sendTraceTag(539779146,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid node provided."),null;if(!b)return v.ULS.sendTraceTag(539779147,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid paragraph node."),
null;var h=this.WNd.uQb(b);if(!h||11!==h.type)return v.ULS.sendTraceTag(539779148,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find top level outline element."),null;h=h.Be(this.tl.pc);if(!h||!h.htmlElement)return v.ULS.sendTraceTag(539779149,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid view element."),null;var r=Fd.a.B1c(h.htmlElement,jc.YKh);if(r)return r;h=h.n2d();if(!h)return v.ULS.sendTraceTag(539779150,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid list container wrapper."),
null;h=Fd.a.Rim(h,jc.YKh);if(!h)return v.ULS.sendTraceTag(539779151,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid indicators array."),null;for(r=0;r<h.length;r++){const A=tq.a(h[r]),M=Bb.OutlineElementNavigator.jm(b);if(A&&A.Cb&&M&&A.Cb.id.equals(M.id))return h[r]}v.ULS.sendTraceTag(539779152,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find indicator.");return null}Ktm(b){b=this.uz.Axi(b);if(!b||12!==b.type)return v.ULS.sendTraceTag(555356864,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get paragraph node from node Id."),
N.a.nil;b=this.b6d(b);if(!b)return v.ULS.sendTraceTag(541888733,377,15,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get indicator from paragraph node."),N.a.nil;b=tq.a(b);return b?b.Cb.id:(v.ULS.sendTraceTag(555356865,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get view element from paragraph node."),N.a.nil)}}jc.YKh="CatchUpActivityIndicatorContainer";Object(u.a)(jc,"ActivityIndicatorHelper",null,[]);var Ic=d(1680);class zd{constructor(b,h,r,A,M,aa,oa){this.xBa=
b;this.Uh=h;this.adf=r;this.Rb=A;this.VZ=M;this.nf=aa;this.nce=oa;this.I2i=!1;this.JFn=(Ja,fb,Cb)=>{if(1===Cb)return this.rRf?32:8;2===Cb&&(this.rRf&&(this.adf.Nnf(),this.Mol()),v.ULS.sendTraceTag(38138719,377,50,H.c({["MarkAsRead invoked"]:!0})));qa.StaticActiveAppFrame.za().Fe();return 8};this.xBa.iNa(this.adf)}initialize(){this.Rb.qa(Fc.a.Jaj,we.a.frame,this.JFn)}get rRf(){return!!this.VZ.OU&&0<this.VZ.OU.count||!!this.VZ.crc&&0<this.VZ.crc.count}get Jrn(){return this.I2i}Ggg(b){const h=b&&b.wywaActivities?
b.wywaActivities.length:0;if(!this.nce||0<h||!b){const r=new Map;r.set("activityCount",h.toString());this.nf.logKpiUsage("CatchUpActivitiesReady",0,{extendedProperties:r})}b?(this.bRn(b.wywaActivities),this.I2i=!0):(v.ULS.shipAssertTag(36538305,377,!1),this.nce||Object(Ic.a)(),this.nf.logKpiFailure("CatchUpActivitiesReady","CatchUpActivitiesPayloadIsInvalid",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}))}bRn(b){b?(v.ULS.sendTraceTag(36509256,377,50,"Catch-Up Activities are Ready and Indicators should be created."),
this.WXo(b),b=this.VZ.TXk(b),this.XXo(b)):v.ULS.sendTraceTag(50959501,377,10,"activities passed in is null!")}WXo(b){if(b){var h=new ib.a;for(const r of b)switch(r.type){case 2:case 3:case 4:case 10:b=4===r.type?r.dqj:r.contentId,h.add(b),this.VZ.crc.add(b)}0<h.count&&(v.ULS.sendTraceTag(51196435,377,50,"{0}",h.count),this.Rb.Pb(Ka.a.Xej,2,h.toArray()))}}XXo(b){const h=new vk.a(new qm.a),r=new Rb.GraphTransaction(3);try{r.Bb(this.Uh);for(const A of b){const M=this.VZ.rjc(A);M&&this.adf.xQj(M)&&(h.add(M.id),
this.xBa.dSb(M,!0))}}finally{r&&r.dispose()}0<b.count&&qa.StaticActiveAppFrame.za().Fe();b={};b.highlightedNodeCount=h.count;v.ULS.sendTraceTag(36509257,377,50,"{0}",H.c(b))}Mol(){v.ULS.sendTraceTag(36509258,377,50,"Catch-Up Activity Indicators requested to be cleared.");0<this.VZ.crc.count&&(this.Rb.Pb(Ka.a.$ei,2,this.VZ.crc.toArray()),this.VZ.crc.clear());const b=this.Nql(this.VZ.OU);this.juo(b)}juo(b){v.ULS.sendTraceTag(36509259,377,50,"Catch-Up Activities some Indicators requested to be removed.");
const h=new Rb.GraphTransaction(3);try{h.Bb(this.Uh);for(const r of b){this.VZ.OU.remove(r);for(const A of this.VZ.z2c(r))this.xBa.dSb(A,!0)}this.VZ.V0h()}finally{h&&h.dispose()}}Nql(b){const h=new vk.a(new qm.a);for(const r of b)h.add(r);return h}}Object(u.a)(zd,"ActivityIndicatorManager",null,[]);class ue{constructor(){this.Grb=this.Adb=null;this.isFirstDocumentOpen=this.zee=!1}}Object(u.a)(ue,"ActivityStateManager",null,[630]);class gf{constructor(b,h){this.Ywd={};this.w4b=b;this.JM=h;this.crc=
new ib.a}get OU(){return this.w4b.OU}OPb(b){const h=new vk.a(new qm.a);if(!b)return h;b=this.w4b.n4d(b);for(let r=0;r<b.length;r++){const A=b[r];this.PSb(A)&&h.add(A)}return h}z2c(b){return this.w4b.z2c(b)}Q5d(b){const h=new ib.a;if(b)for(const r of b)h.addRange(this.z2c(r));return h}TXk(b){const h=new vk.a(new qm.a);if(b)for(const r of b)if(1===r.type&&(b=r))for(const A of b.Ew){h.add(A);this.OU.add(A);const M=A.toString();this.Ywd[M]||(this.Ywd[M]=new ib.a);this.Ywd[M].add(b)}this.V0h();return h}PSb(b){return this.OU&&
b?this.OU.contains(b):!1}$0c(b,h){if(b&&(b=this.Ywd[b.toString()])&&0<b.count){for(const r of b)if(r.objectId.equals(h))return r;return b.K(0)}return null}rjc(b){return this.w4b.rjc(b)}V0h(){this.w4b.xol()}A1c(b){return this.w4b.A1c(b)}Axi(b){if(!this.JM)return null;const h=this.JM.Ic;return h?h.Eb(b):null}}Object(u.a)(gf,"ChangeIdCache",null,[]);var Be=d(515),S=d(234);class fa extends Be.a{constructor(){super();this.activityClassifications=this.inferences=this.correspondingRequest=null;this.H_=Object.assign(new S.a,
{T_:fa.getTypeName(),B_:fa.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(u.a)(fa,"ChangeSummariesResponse",Be.a,[]);var gb=d(1400);class Qb extends gb.a{constructor(){super();this.activityChanges=this.documentContent=this.requestId=null;this.H_=Object.assign(new S.a,{T_:Qb.getTypeName(),B_:Qb.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesRequest"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(u.a)(Qb,"ChangeSummariesRequest",gb.a,[]);var hc=d(1368),Gc=d(858),wa=d(358),Ma=d(857);class rb{constructor(){this.yuc=this.Okd=null}}Object(u.a)(rb,"ActionPair",null,[]);class dc{constructor(b,h,r,A){this.TYl=M=>{M=M.Yl;const aa=this.Tzj(M);aa&&(v.ULS.sendTraceTag(579745163,377,15,"ChangeSummariesAugloopProvider.EndRequestWithTimeout: augloop request timed out, time since request = {0}",this.EKf(M)),aa.yuc("Request timeout"))};this.yC=b;this.CY=h;this.Te=r;this.Gb=A;this.PUe=null;this.c4e=
new cb.a;this.JAh=new cb.a}Hbp(b){const h=Object.assign(new hc.a,{parentPath:["Signal",Qb.getTypeName()],items:[Object.assign(new Gc.a,{body:b})]});return this.initialize().then(()=>{const r=new Promise((A,M)=>{this.c4e.Z(b.requestId,Object.assign(new rb,{Okd:A,yuc:M}))});this.JAh.Z(b.requestId,new Date);v.ULS.sendTraceTag(561111456,377,50,"ChangeSummariesAugloopProvider.SubmitRequest: submitting request to aug-loop, timeout duration = {0}",dc.requestTimeoutMs);this.CY.getAugLoopRuntimeManager().submitOperation(Object.assign(new Ma.a,
{operation:h}));this.FUo(b.requestId);return r})}initialize(){this.PUe||(this.PUe=this.yC.hm().then(()=>{this.Te.nb(this,fa.getTypeName())}));return this.PUe}ZG(b,h){if(b&&wa.a.getTypeNameFor(b.content)===fa.getTypeName())if(b=b.content){var r=this.Tzj(b.correspondingRequest);r?h!==hc.a.getTypeName()?r.yuc("Invalid operation type"):(v.ULS.sendTraceTag(579745162,377,50,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: resolving augloop request, time since request = {0}",this.EKf(b.correspondingRequest)),
r.Okd(b)):v.ULS.sendTraceTag(589083081,377,15,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: cannot find action pair to resolve promise, time since request = {0}",this.EKf(b.correspondingRequest))}else v.ULS.sendTraceTag(589083080,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: null response from ChangeSummariesRequest");else v.ULS.sendTraceTag(589600964,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: invalid annotation event")}FUo(b){const h=new xc.a(3,1,dc.requestTimeoutMs,
this.TYl,176);h.EPd=0;h.Yl=b;this.Gb.Zb(h)}Tzj(b){if(!b)return null;let h;if(!({value:h}=this.c4e.Ac(b,h)).returnValue)return null;this.c4e.remove(b);return h}EKf(b){if(!b)return-1;let h;return({value:h}=this.JAh.Ac(b,h)).returnValue?(new Date).getTime()-h.getTime():-1}static get requestTimeoutMs(){return y.AFrameworkApplication.J.ic("ChangeSummariesRequestTimeoutMs",5E3)}}Object(u.a)(dc,"ChangeSummariesAugloopProvider",null,[229]);class yc{constructor(){this.activityGroups=null}}Object(u.a)(yc,"FeaturedActivityGroupPayload",
null,[]);class Wc{constructor(b,h,r,A,M){this.QIk=b;this.tmk=h;this.gok=r;this.Rrk=A;this.WAb=M}getFeaturedActivityGroups(b){return b&&b.wywaActivities&&b.wywaActivities.length?this.Rrk.SGb.then(()=>this.ppm(b)):Wc.czf}VRm(b,h,r){if(!h)return v.ULS.sendTraceTag(574103583,377,15,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: response is null"),null;Nq("TranslateFeaturedActivityGroups");r=this.gok.mkp(b,h,r.wywaActivities);v.ULS.sendTraceTag(542942800,377,50,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: sent changes to aug-loop = {0}, received inferences from aug-loop = {1}, provided items to the flyout = {2}",
0<b.activityChanges.length,0<h.inferences.length,0<r.length);this.WAb.set(h.correspondingRequest,r);return Object.assign(new yc,{activityGroups:r})}ppm(b){Nq("BuildFeaturedActivityGroupRequest");const h=this.QIk.ldl();if(!h||!h.documentContent||!h.activityChanges)return v.ULS.sendTraceTag(588379905,377,15,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummariesRequest is null"),Wc.czf;if(!h.documentContent.length||!h.activityChanges.length)return Wc.czf;v.ULS.sendTraceTag(578954499,
377,50,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummaries Request Id: "+h.requestId);Nq("SubmitFeaturedActivityGroupRequest");return this.tmk.Hbp(h).then(r=>this.VRm(h,r,b))}}Wc.czf=Promise.resolve(Object.assign(new yc,{activityGroups:[]}));Object(u.a)(Wc,"ChangeSummariesDataProvider",null,[629]);class kd{constructor(b,h){this.uz=b;this.FNk=h}ldl(){const b=new ib.a,h=new ib.a,r=new vk.a(new qm.a);var A=this.uz.OU;if(!A||!A.count)return kd.fzf;A=this.uz.Q5d(A);if(!A||!A.count)return v.ULS.sendTraceTag(592056450,
377,15,"ChangeSummariesRequestBuilder.BuildChangeSummariesRequest: no GraphNodes exist for the new changeIds"),kd.fzf;for(const M of A)r.contains(M.id)||(r.add(M.id),this.reo(M,b,h));return h.count&&b.count?Object.assign(new Qb,{activityChanges:h.toArray(),documentContent:b.toArray(),requestId:Vn.a(N.a.create())}):kd.fzf}reo(b,h,r){if(Gd.ParagraphReader.Vb(b)){var A=Gd.ParagraphReader.f8(b);if(A&&A.length){h.add(A);A=this.uz.OPb(b);A=this.cRm(A);for(const M of A){A=new ib.a;const aa=this.getTextRanges(b,
M);for(const oa of aa)A.add({changeEnd:oa.endIndex,changeSpanId:oa.qNo,changeStart:oa.startIndex,contentIndex:h.count-1,locationId:Vn.a(b.id)});(A=this.SAl(M,A.toArray()))&&r.add(A)}}else v.ULS.sendTraceTag(591975071,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: no content available")}else v.ULS.sendTraceTag(592056452,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: node did not cast to AParagraphNode")}cRm(b){const h=new cb.a;for(const r of b)(b=this.QCi(r))?(h.lb(b)||h.Z(b,new vk.a(new qm.a)),
h.K(b).add(r)):v.ULS.sendTraceTag(579712270,377,15,"ChangeSummariesRequestBuilder.GroupChangeIdsByUser: unable to get person id from change id");return h.values}SAl(b,h){const r=[];let A=null;for(const M of b)if(b=this.uz.$0c(M,N.a.nil)){if(!A){const aa=this.QCi(M);if(!aa||!aa.length){v.ULS.sendTraceTag(579712272,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get person id from change id");continue}A=aa}r.push(b)}else v.ULS.sendTraceTag(579712271,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get activity from change id");
return r.length?A?h.length?{activityId:r[0].activityId,changes:h,personId:A,timestamp:r[0].displayTimestamp.toISOString()}:(v.ULS.sendTraceTag(579712273,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no changes provided for ActivityChange"),null):(v.ULS.sendTraceTag(579605389,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: could not get personId for ActivityChange"),null):(v.ULS.sendTraceTag(579605388,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no activities exist for ActivityChange"),
null)}QCi(b){b=this.uz.$0c(b,N.a.nil);if(!b)return v.ULS.sendTraceTag(579712274,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: unable to get activity from change id"),null;b=b.actors;if(!b||!b.length||!b[0])return v.ULS.sendTraceTag(592056451,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: no people are associated with this Activity in ChangeSummariesRequest"),null;let h=b[0].id;h&&h.length||(h=b[0].email);return h}getTextRanges(b,h){const r=new ib.a;
if(!h||!h.count||!b)return r;let A=-1,M=new vk.a(new qm.a);for(let aa=0;aa<b.ra.length;aa++){const oa=b.ra.K(aa);if(-1!==A&&oa.ys){if(oa.changeStart&&h.contains(oa.changeStart)){M.add(oa.changeStart);continue}r.add({startIndex:A,endIndex:oa.cp,qNo:this.FNk.oKj(M)});A=-1;M=new vk.a(new qm.a)}oa.changeStart&&h.contains(oa.changeStart)&&(A=oa.cp,M.add(oa.changeStart))}return r}}kd.fzf=Object.assign(new Qb,{activityChanges:[],documentContent:[],requestId:Vn.a(N.a.nil)});Object(u.a)(kd,"ChangeSummariesRequestBuilder",
null,[]);class Ld{constructor(){this.changes=this.content=null}}Object(u.a)(Ld,"ContentChange",null,[]);class le{constructor(){this.ranking=0;this.reasons=this.contentChanges=this.locationId=this.activities=null}}Object(u.a)(le,"FeaturedActivityGroup",null,[]);class je{constructor(){this.end=this.start=0}}Object(u.a)(je,"TextRange",null,[]);class wf{constructor(b){this.qCc=b}mkp(b,h,r){if(!h)return v.ULS.sendTraceTag(588379906,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is null"),
wf.X_d;if(!h.inferences)return v.ULS.sendTraceTag(588379907,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.Inferences is null"),wf.X_d;if(!h.activityClassifications)return v.ULS.sendTraceTag(588379908,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.ActivityClassifications is null"),wf.X_d;if(!h.inferences.length||!h.activityClassifications.length)return v.ULS.sendTraceTag(561111455,377,50,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is empty"),
wf.X_d;const A=[],M=new Ha.a(new qm.a);for(const aa of h.inferences){const oa=this.lkp(aa,b,h,r);if(!oa)continue;const Ja=this.qCc.Ktm(Vn.b(oa.locationId));Ja.equals(N.a.nil)?A.push(oa):M.lb(Ja)?M.K(Ja).ranking>oa.ranking&&M.Z(Ja,oa):M.add(Ja,oa)}b=[...Array.from(M.values),...A];b.sort((aa,oa)=>aa.ranking-oa.ranking);return b.slice(0,wf.bHn)}lkp(b,h,r,A){if(!b||Oe.a.Tf(b.activitiesInGroup))return v.ULS.sendTraceTag(588379909,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: inference is empty"),
null;const M=new ib.a,aa=new cb.a;let oa=null;for(const fb of b.activitiesInGroup){if(!fb){v.ULS.sendTraceTag(588379910,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity is null");continue}if(0>fb.activityIndex||fb.activityIndex>=r.activityClassifications.length){v.ULS.sendTraceTag(588379911,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity.ActivityIndex is invalid");continue}const Cb=r.activityClassifications[fb.activityIndex];if(!Cb||
Oe.a.Tf(Cb.contents))v.ULS.sendTraceTag(588379912,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activityClassification is empty");else{var Ja=this.F5l(A,Cb.activityId);if(Ja){M.add(Ja);for(const Gb of fb.changes){if(!Gb){v.ULS.sendTraceTag(576251591,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef is null");continue}Ja=Gb.value;if(0>Ja||Ja>=Cb.contents.length){v.ULS.sendTraceTag(576251592,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef index is invalid");
continue}Ja=Cb.contents[Ja];if(!Ja){v.ULS.sendTraceTag(576251593,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContent is null");continue}const Sb=h.documentContent[Ja.contentIndex],pc=Object.assign(new je,{start:Ja.changeStart,end:Ja.changeEnd});if(aa.lb(Sb))aa.K(Sb).add(pc);else{let zc;aa.Z(Sb,(zc=new ib.a,zc.add(pc),zc))}oa||(oa=Ja.locationId)}}else v.ULS.sendTraceTag(588379913,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activity is null")}}if(!M.count)return v.ULS.sendTraceTag(588379914,
377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no activities for ActivityGroup"),null;h=this.PMm(aa);return h.count?Object.assign(new le,{ranking:b.ranking.value,reasons:[1],activities:M.toArray(),contentChanges:h.toArray(),locationId:oa}):(v.ULS.sendTraceTag(588379915,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no content change for ActivityGroup"),null)}F5l(b,h){for(const r of b)if(r&&r.activityId&&r.activityId===h)return r;return null}PMm(b){const h=
new ib.a;for(const A of b){b=A.key;const M=A.value;M.Sc((aa,oa)=>aa.start-oa.start);var r=M.K(0).start;if(r>wf.qbj){r-=wf.qbj;b=b.substring(r,b.length);for(const aa of M)aa.start-=r,aa.end-=r}h.add(Object.assign(new Ld,{content:b,changes:M.toArray()}))}return h}}wf.X_d=[];wf.qbj=10;wf.bHn=4;Object(u.a)(wf,"ChangeSummariesResponseTranslator",null,[]);class Kg{constructor(){this.WAb=new cb.a;this.r5e=new cb.a}set(b,h){if(h.length&&b){this.WAb.Z(b,h);for(const r of h)if(r.activities)for(const A of r.activities)A&&
A.activityId?this.r5e.Z(A.activityId,b):v.ULS.sendTraceTag(573920657,377,15,"FeaturedActivityGroupCache.Set: null activity in group");else v.ULS.sendTraceTag(573920656,377,15,"FeaturedActivityGroupCache.Set: null activities for group")}}get(b){return b&&this.WAb.lb(b)?this.WAb.K(b):null}NDn(b){return b&&this.r5e.lb(b)?this.r5e.K(b):null}}Object(u.a)(Kg,"FeaturedActivityGroupCache",null,[]);class Uf{constructor(b){this.ihe=(h,r,A,M,aa)=>{if(!aa)return v.ULS.sendTraceTag(574103576,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null actionData"),
8;h=aa.Activity;if(!h)return v.ULS.sendTraceTag(574103577,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null activity"),8;r=this.WAb.NDn(h.activityId);if(!r)return v.ULS.sendTraceTag(574103578,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: No matching request Id found"),8;A=sq.uS(h);v.ULS.sendTraceTag(574103579,377,50,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: [RequestId={0};ActivityId={1};ChangeIds={2}]",r,h.activityId,
this.oKj(A));return 32};this.WAb=b;this.s$g=new Map}Xb(b){b.qa(Fc.a.ihe,we.a.frame,this.ihe)}oKj(b){let h=0;const r=Array(b.count);for(const A of b)b=this.nAm(A),r[h]=Vn.a(b),h++;return r.join(",")}nAm(b){let h=this.s$g.get(b);if(h&&h!=N.a.nil)return h;h=N.a.create();this.s$g.set(b,h);return h}}Object(u.a)(Uf,"FeaturedActivityGroupTelemetryActor",null,[]);var uf=d(84);class Si extends Sys.EventArgs{constructor(b){super();this.node=b}}Object(u.a)(Si,"OnParagraphVisitedArgs",Sys.EventArgs,[]);class Ei{constructor(b,
h,r){this.jT=null;this.pkp=A=>{this.o5a.reset();A=this.GMm(A.Yl);let M=null;for(;A.moveNext();){const aa=A.currentNode;if(aa&&(Gd.ParagraphReader.Vb(aa)&&this.sa.raiseEvent("OPV",new Si(aa)),this.o5a.update(),this.o5a.Mub())){M=aa;break}}M?this.ENh(M):this.jT(!0)};this.Gb=b;this.o5a=h;this.JM=r;this.sa=new Td.a;this.SGb=new Promise(A=>{this.jT=A})}e_k(b){this.sa.addHandler("OPV",b)}aal(){this.ENh(null)}ENh(b){const h=new xc.a(3,1,0,this.pkp,182);h.Yl=b;this.Gb.Zb(h)}GMm(b){if(!b)return uf.a.gq(this.JM);
b=vd.a.Za(b);b.vb(7);return uf.a.At(b,this.JM)}}Object(u.a)(Ei,"DocumentTraverser",null,[]);class Gf{constructor(b){this.Rb=b}shouldShowEmptyExperienceButton(){return y.AFrameworkApplication.Lfe()}getExplanationText(){return""}getCommandName(){return WordEditorIntl.WordEditorStrings.L_FileHistory}onButtonClick(){this.Rb.Pb(Ka.a.bze,2,null)}onInviteOthersButtonClick(){this.Rb.Pb(Ka.a.Aaa,2,null)}}Object(u.a)(Gf,"EmptyCatchUpBehaviorManager",null,[601]);class Ze{constructor(b,h){this.V9l=()=>{const r=
document.getElementById("flyoutItem0");r&&(v.ULS.sendTraceTag(588129371,3012,50,"Focused on the catch-up flyout via ctrl+F6"),r.focus())};this.Zp=b;this.Yb=h}initialize(){const b=this.Yb.ie(id.AFrame.$dc);b.HL=!0;b.parent=id.AFrame.Eq;b.sja(this.V9l);this.Zp.rW(id.AFrame.$dc)}enableF6Focus(){this.Zp.MK(id.AFrame.$dc)}disableF6Focus(){this.Zp.ay(id.AFrame.$dc)}}Object(u.a)(Ze,"FlyoutFocus",null,[594]);class rf{constructor(b,h,r){this.u9g=this.$ih=this.PIc=this.ODd=!1;this.IRe=this.Fwd=null;this.XYn=
(A,M,aa,oa,Ja)=>{Ja[Vg.a.Visible]=!0;Ja[Vg.a.On]=this.PIc&&this.ODd;return 32};this.K0n=(A,M,aa)=>{if(1===aa)return this.ODd?(this.$ih||(this.$ih=!0,v.ULS.sendTraceTag(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.Fwd)return v.ULS.sendTraceTag(588129369,3012,10,"OnToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."),8;this.u9g=!0;this.Fwd();return 32};this.ga=b;this.chh=h;this.Yb=r}get sDf(){return this.IRe?this.IRe:(v.ULS.sendTraceTag(578401728,
3012,15,"Attempted to get _flyoutShowTimestamp before the value was set."),new Date)}set sDf(b){this.IRe=b}initialize(){this.Xb()}registerButtonClickedEvent(b){this.Fwd&&v.ULS.sendTraceTag(588129366,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.Fwd=b.buttonClickedCallback}onFlyoutInitialized(){this.ODd&&v.ULS.sendTraceTag(588129367,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const b=(new Date).getTime()-this.sDf.getTime();
v.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",b);this.ODd=!0;ac.c(Ka.a.nkl,!0,void 0,void 0,void 0,b)}onFlyoutVisibilityChanged(b){this.PIc!==b.flyoutIsVisible&&(this.PIc=b.flyoutIsVisible,qa.StaticActiveAppFrame.za()&&qa.StaticActiveAppFrame.za().Fe(!0),this.PIc&&this.u9g&&this.Yb.Jg(id.AFrame.$dc),this.PIc||this.chh&&this.chh.nzn())}logFlightTriggers(b){b.hasFlyoutData&&y.AFrameworkApplication.vd("WoCha187;WoCha187cf")}Xb(){this.ga.qa(Ka.a.C_j,we.a.frame,
this.K0n);this.ga.fb(Ka.a.Lvj,we.a.frame,this.XYn,96)}}Object(u.a)(rf,"FlyoutRibbonButton",null,[588]);var Ng=d(152);class Yg{constructor(b,h){this.OU=null;this.Xbe=this.YZi=!1;this.VZ=b;this.nf=h;this.osb=new Ng.a;this.ybe=new Map;this.osb.Z(1,new vk.a(new qm.a));this.osb.Z(0,new vk.a(new qm.a));this.osb.Z(2,new vk.a(new qm.a));this.osb.Z(3,new vk.a(new qm.a));this.ybe.set(3,"CatchUpIndicatorVisible");this.ybe.set(1,"CatchUpIndicatorPreviewed");this.ybe.set(2,"CatchUpIndicatorSelected");this.zte=
0}Z8i(b,h){if(this.osb.K(h).add(b)){this.ZAn(h);switch(h){case 0:v.ULS.sendTraceTag(592545740,377,50,"LogIndicatorTelemetry: indicator rendered");break;case 1:v.ULS.sendTraceTag(592545739,377,50,"LogIndicatorTelemetry: indicator hovered");break;case 2:v.ULS.sendTraceTag(592545738,377,50,"LogIndicatorTelemetry: indicator clicked");break;case 3:v.ULS.sendTraceTag(528593420,377,50,"LogIndicatorTelemetry: indicator visible")}this.c0h()}}lYn(b){this.f_l();b=this.VZ.OPb(b);for(const h of b)if(this.OU.remove(h)){this.zte++;
break}}f_l(){if(!this.OU){this.OU=new vk.a(new qm.a);for(const b of this.VZ.OU)this.OU.add(b)}}s2k(){v.ULS.sendTraceTag(590890074,377,50,"Total number of renderable indicators: {0}",this.zte);this.c0h()}c0h(){this.zte&&(this.Cml(),this.jml())}Cml(){!this.YZi&&.5<=this.osb.K(0).count/this.zte&&(this.YZi=!0,ac.c(Ka.a.pkl),v.ULS.sendTraceTag(590926531,377,50,"User started Catch Up Passive Session"))}jml(){if(!this.Xbe){var b="";1<=this.osb.K(1).count&&(this.Xbe=!0,b="previews");1<=this.osb.K(2).count&&
(this.Xbe=!0,b="selections");this.Xbe&&(ac.c(Ka.a.gkl),v.ULS.sendTraceTag(590926532,377,50,"User started Catch Up Active Session due to {0}",b))}}ZAn(b){(b=this.ybe.get(b))&&this.nf.logKpiUsage(b,0)}}Object(u.a)(Yg,"IndicatorTelemetryActor",null,[]);var Gk=d(706);d(1047);class ij{constructor(b,h){this.$nd=b;this.eUc=h}FOm(){return this.eUc.promise.then(b=>b.getWywaActivitiesResponse)}tFf(b,h){return Gk.b(this.$nd.requestActivities(b,h))}eMf(b,h){return this.eUc.promise.then(r=>r.getWywaActivitiesResponse.WywaWaterline===
b?Promise.resolve(r.getRelevantActivitiesResponse):Gk.b(this.$nd.requestRelevantActivities(b,h)))}updateActivityState(b){return Gk.b(this.$nd.updateActivityState(b))}uFf(){return this.eUc.promise.then(b=>void 0!==b.activityFeed?Promise.resolve(b.activityFeed):Gk.b(this.$nd.requestActivityFeed()))}Lsd(){return Gk.b(this.$nd.$Bo())}}Object(u.a)(ij,"ActivityRepository",null,[]);var Nk=d(1048);class di{constructor(b){this.Pj=b}get tl(){return this.Pj&&this.Pj.gj?this.Pj:null}QZb(b,h){return this.tl?this.tl.pmf(b,
!0)?this.tl.QZb(b,h,!0,!0,!1,!1):(v.ULS.sendTraceTag(579396803,377,15,"ScrollToHighlightParagraph: unable to scroll to desired paragraph"),null):null}}Object(u.a)(di,"PageViewWrapper",null,[]);class Gl{constructor(b,h,r,A,M,aa=!1){this.activityContentManager=b;this.Rb=h;this.gVl=r;this.nf=A;this.e2m=M;this.Unc=aa}S5f(b){const h=new Map;h.set("activityType",b.type.toString());this.nf.logKpiUsage("CatchUpNavigateToActivity",0,{extendedProperties:h})}f5f(b){this.nf.logKpiFailure("CatchUpNavigateToActivity",
b,{},{name:"CatchUpExperienceDegraded",errorNameOverride:"NavigateToActivityFailed"})}BMn(b){try{const h=b.activity;this.S5f(b.activity);1==h.type&&this.e2m.Lhe();if(!this.activityContentManager.doesContentExist(h))return this.activityContentManager.Smp(h),this.f5f("Content does not exist"),Promise.resolve(2);const r={};let A=0;switch(h.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:case 11:r.ActivityId=h.activityId;r.NavigationId=atob(h.navigationId);A=this.Rb.Pb(Ka.a.epf,2,r);break;
case 1:r.Activity=h,r.NodeId=b.locationId,A=this.Rb.Pb(Fc.a.qCg,2,r),r.NodeId&&this.Rb.Pb(Fc.a.ihe,2,r)}8==A&&this.f5f("Action failed")}catch(h){return v.ULS.sendTraceTag(592237846,3012,10,"Exception thrown trying to navigate to an activity. {0}",h),this.f5f("Exception was thrown"),Promise.resolve(3)}return Promise.resolve(1)}navigateToActivity(b){return this.gVl.SGb.then(()=>this.BMn(b))}}Object(u.a)(Gl,"WordActivityNavigationManager",null,[586]);var uq;(function(b){b[b.default=0]="default";b[b.uJp=
1]="D48X48";b[b.xJp=2]="D64X64";b[b.yJp=3]="D96X96";b[b.qJp=4]="D120X120";b[b.rJp=5]="D240X240";b[b.sJp=6]="D360X360";b[b.tJp=7]="D432X432";b[b.vJp=8]="D504X504";b[b.wJp=9]="D648X648"})(uq||(uq={}));Object(u.b)("ProfilePhotoDimension",uq);var Av=d(778),vs=d(1349);class Yr{constructor(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(u.a)(Yr,"ActivityFeedEntry",null,[]);const up=(b,h)=>h.I$c?vm.toArray(vm.select(vm.asEnumerable(b),
r=>{if(!r||!r.activityFeedItemPayload)return r;const A=JSON.parse(r.activityFeedItemPayload);var M=A.actor;if(!M||M.pictureUrl)return r;const aa=M.userPrincipalName||M.email;if(!aa)return r;M=h.sMb(aa,M.provider,y.AFrameworkApplication.um,0);if(!M)return r;A.actor.pictureUrl=M;return Object.assign(new Yr,{id:r.id,type:r.type,collectionId:r.collectionId,activityState:r.activityState,activityFeedItemPayload:JSON.stringify(A),timestamp:r.timestamp})})):b,Vw=(b,h)=>{const r=new Map,A=new Map;for(const M of b){if(!M||
!M.activityFeedItemPayload)continue;b=JSON.parse(M.activityFeedItemPayload).actor;if(!b)continue;const aa=b.email||b.userPrincipalName;aa&&!A.has(aa)&&A.set(aa,new Av.a(aa,null,b.name))}A.forEach(M=>{const aa=h.Nkc(M,6);r.set(M.UserId,aa)});return r};var Gr=d(449);class vq{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(u.a)(vq,"ActivityRequestPayload",null,[]);class Uo{constructor(){this.color=
this.imageUrl=this.email=this.displayName=this.provider=this.id=null}}Object(u.a)(Uo,"Person",null,[]);class Dm extends Rm{constructor(){super();this.relationship=0}}Object(u.a)(Dm,"TaskActivity",Rm,[]);class ep extends Rm{constructor(){super();this.contentId=null}}Object(u.a)(ep,"CommentActivity",Rm,[]);class ws extends ep{constructor(){super()}}Object(u.a)(ws,"CommentReplyActivity",ep,[]);class Ps extends ep{constructor(){super();this.dqj=null}}Object(u.a)(Ps,"MentionActivity",ep,[]);class Qs{constructor(b,
h,r,A){this.XAb=b;this.dSa=h;this.fNc=r;this.BQ=A;this.BQ.isFirstDocumentOpen=!1}requestWYWAActivities(){return this.XAb.FOm().then(b=>{if(!b||b.StatusCode&&155!==b.StatusCode)throw this.Lsf("GetWYWAActivities",b);155===b.StatusCode&&(v.ULS.sendTraceTag(40433563,377,50,"No waterline is found on GetWywaActivities request."),this.BQ.isFirstDocumentOpen=!0);const h=this.TIg(b.People);return Object.assign(new vq,{activities:this.CCe(b.Activities,h),actors:h,hasMore:!b.AllWYWA,highWaterline:b.HighWaterline,
lowWaterline:b.LowWaterline,wywaWaterline:b.WywaWaterline,isFirstDocumentOpen:155===b.StatusCode})})}requestActivities(b,h){return this.XAb.tFf(b,h).then(r=>{if(!r||r.StatusCode)throw this.Lsf("GetActivities",r);const A=this.TIg(r.People);return Object.assign(new vq,{activities:this.CCe(r.Activities,A),actors:A,hasMore:!r.RequestedRetrieved,highWaterline:r.HighWaterline,lowWaterline:r.LowWaterline})})}requestRelevantActivities(b){return this.XAb.eMf(b,this.BQ.isFirstDocumentOpen).then(h=>{if(!h||
h.StatusCode)throw this.Lsf("GetRelevantActivities",h);const r=this.TIg(h.People),A=this.CCe(h.NewActivities,r,2);h=this.CCe(h.OutstandingActivities,r,3);for(const M of h)A.push(M);return Object.assign(new vq,{activities:A,actors:r})})}updateActivityState(b){return this.XAb.updateActivityState(b)}requestActivityFeed(){return this.XAb.uFf().then(b=>({activityFeedItems:this.W5m(b),personaColorMap:this.Fel(b)}))}CCe(b,h,r=1){const A=[];if(!b)return A;for(const oa of b){var M=null;b=[];b.push(h[oa.CreatorIndex]);
switch(oa.ActivityType){case 1:M=oa;var aa=new sq;aa.Ew=new ib.a;for(const Ja of M.ChangeIds)aa.Ew.add(Vn.b(Ja));aa.objectId=Vn.b(M.ObjectId);M=aa;break;case 2:M=oa;aa=new ep;aa.contentId=M.ContentId;aa.navigationId=M.NavigationId;M=aa;break;case 4:M=oa;aa=new Ps;b.push(h[M.MentioneeIndex]);aa.dqj=M.ParentContentId;aa.navigationId=M.NavigationId;M=aa;break;case 3:case 10:M=oa;aa=new ws;b.push(h[M.RepliedIndex]);aa.contentId=M.ContentId;aa.navigationId=M.NavigationId;M=aa;break;case 6:case 7:case 8:case 9:M=
oa,aa=new Dm,b.push(h[M.MentioneeIndex]),aa.navigationId=M.NavigationId,aa.relationship=M.Relationship,M=aa}M&&(M.actors=b,M.displayTimestamp=new Date(oa.DisplayTimestamp),M.activityId=Vn.b(oa.ActivityId).toString(),M.type=oa.ActivityType,1!==r&&(M.relevancy=r),A.push(M))}return A}GEo(b,h,r){return this.fNc&&this.fNc.I$c?this.fNc.sMb(h,r,y.AFrameworkApplication.um,uq.default):b}TIg(b){if(!b)return null;const h=Array(b.length);for(let r=0;r<b.length;r++){if(!b[r])continue;const A=new Uo;A.id=b[r].Id;
A.provider=b[r].Provider;A.displayName=b[r].DisplayName;A.email=b[r].Email;A.imageUrl=this.GEo(b[r].PictureUrl,b[r].Email,b[r].Provider);this.dSa&&(A.color=this.dSa.Nkc(new Av.a(A.email,void 0,A.displayName),vs.a.mkl));h[r]=A}return h}Lsf(b,h){let r="null";h&&(r=Gr.a[h.StatusCode]);return Error.create(String.format("{0} failed with status code: {1}.",b,r))}W5m(b){return this.fNc?up(b,this.fNc):b}Fel(b){return this.dSa?Vw(b,this.dSa):new Map}}Object(u.a)(Qs,"WordActivityRequestManager",null,[585]);
class Rs{constructor(b,h,r){this.IGd=0;this.pNc=!1;this.xqh=null;this.Lsd=()=>{if(df.a.JU)v.ULS.sendTraceTag(51217553,391,100,"The session is lost. Stop fetching new activities.");else if(this.pNc||3>=this.IGd){this.pNc?this.pNc=!1:this.IGd++;const A=Math.max(this.Ga.ic("WordEditorActivityManagementMaturityMiliSeconds",30001)+5E3-(+new Date-+this.xqh),0);v.ULS.sendTraceTag(39396256,391,100,"Requesting new activities in {0}ms",A);Oi.Task.delay(A).continueWith(()=>{this.XAb.Lsd().then(()=>{this.fve();
return null}).catch(()=>{this.fve();this.pNc=!0;this.IGd=0})})}else this.fve()};this.Ga=b;this.XAb=r;h.SQd(()=>{this.pNc=!0;this.xqh=new Date;this.IGd=0})}start(){this.fve()}fve(){window.setTimeout(this.Lsd,6E4)}}Object(u.a)(Rs,"WordEditorActivityScheduler",null,[]);class gw{constructor(){this.resolve=null;this.promise=new Promise(b=>{this.resolve=b})}IOo(b){this.resolve(b)}}Object(u.a)(gw,"CatchUpNetworkRequestWorkerCache",null,[]);class Nt{constructor(b,h,r){this.lKl=b;this.J=h;this.nf=r}Ggg(b){b&&
b.authors&&this.TAn(b.authors)}TAn(b){for(const h of b)h&&h.displayName===this.lKl&&(this.nf.logKpiFailure("CatchUpActivitiesReady","CatchUpShowsChangesFromCurrentAuthor",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}),v.ULS.sendTraceTag(571745507,377,15,"LogIfWywaAuthorMatchesCurrentUser: WYWA author has same name as current user [same id={0},same email={1}]",h.id===this.J.ib("PresenceUserId"),h.email===this.J.ib("UserPrincipalName")))}}Object(u.a)(Nt,"WywaAuthorComparator",null,[]);class Nm{constructor(b){this.kY=
b}Lhe(){this.kY&&this.kY.execute(b=>b.logActivity("CatchUpIndicatorSurveyNomination",null))}}Object(u.a)(Nm,"IndicatorSurveyActor",null,[]);var Ey=d(1020),Nl=d(1012);class Zr{constructor(){}shouldShowDisplayChangesCheckbox(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayRecentChangesEnabled",!1)}shouldDisplayChangesBeInitiallyChecked(){return Promise.resolve(!0)}toggleShowingChanges(){return Promise.resolve(!0)}}Object(u.a)(Zr,"WordRecentChangesManager",
null,[582]);class Ww{constructor(){this.qkl={crewAlias:"webasynccollabeng",featureName:"CatchUp",topLevelKpiName:"CatchUpFeatureUsage",vetoPillar:7}}get name(){return"WordEditor.CatchUpActivity"}get jkl(){return y.AFrameworkApplication.J.$("CatchUpActivityIsEnabled")}get VVi(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpDynamicEntryPointEnabled",!1)}get mVi(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpCustomDynamicEntryPointEnabled",
!1)}get Ybe(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)}get nce(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCatchUpActivitiesReadyTelemetryFixV2Enabled",!1)}get Bqn(){return y.AFrameworkApplication.J.$("IsUserFromDifferentTenant")}get Unc(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpMockDataEnabled",!1)}uc(b){Nq("Configure");this.container=
b;b.ia(833,()=>new gw).ha()}init(){Nq("Init");this.jkl&&(K.a.instance.registerOnPackageInit("WordEditor.Workers",()=>{this.container.resolve(219).sendMessage(2,4,y.AFrameworkApplication.rootQuerySignature,df.a.webServiceBase+"OneNote.ashx",Sp.a.word,this.Ybe)}),Nq("HotStore"),df.a.Fca.k$a.execute(()=>{Nq("ChromeReady");zl.a.get_instance().Tk(7,()=>{Nq("ScriptDownload");(y.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("catchUpActivity"):this.container.resolve(77).JD.loadScript("catchUpActivity")).catch(b=>
{v.ULS.sendTraceTag(592233361,377,10,"Failed to load the resources for the CatchUpActivity feature: {0}",b)}).then(()=>this.HSn()).catch(b=>{v.ULS.sendTraceTag(36548867,377,10,"Failed to initialize the CatchUpActivity feature: {0}",b)})})}))}HSn(){Nq("CreateObjectsAndInitializeState");this.hAn();this.gBl();return this.g4m()}hAn(){v.ULS.sendTraceTag(592217358,377,50,"CatchUpActivity feature enabled successfully");v.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");
v.ULS.sendTraceTag(594401288,3012,50,"Tasks and outstanding data is enabled");this.VVi&&v.ULS.sendTraceTag(553911650,3012,50,"DynamicEntryPoint is enabled");this.mVi&&v.ULS.sendTraceTag(553769042,3012,50,"CustomDynamicEntryPoint is enabled");v.ULS.sendTraceTag(545036493,3012,50,"IsUserFromDifferentTenant: {0}",this.Bqn);this.Ybe&&v.ULS.sendTraceTag(526718752,3012,50,"ActivityFeedData is enabled")}g4m(){this.O4m();this.container.resolve(830).sDf=new Date;Nq("InitializeCatchUpApp");return this.Zdc.initialize(Object.assign(new us,
{featuredActivityGroupsEnabled:!1,summaryStringEnabled:!0,dynamicEntryPointEnabled:this.VVi,customDynamicEntryPointEnabled:this.mVi,activityFeedDataEnabled:this.Ybe})).then(()=>{this.container.resolve(831).start()})}gBl(){this.container.ia(832,()=>new gf(this.container.resolve(501),$l.a.Mm.kb.Jc.od)).ha();this.container.ia(838,()=>new Ey.a(Ba.Health.instance,new Nl.a,this.qkl)).ha();this.container.ia(835,()=>new ue).ha();this.container.ia(836,()=>new hj(this.container.resolve(832),y.AFrameworkApplication.va,
em.UISurfaces.aP(),this.Unc)).as(844).ha();this.container.ia(834,()=>new ij(new Nk.a(Xe.a.x_j(this.container.Ra(124)),()=>y.AFrameworkApplication.rootQuerySignature,df.a.webServiceBase+"OneNote.ashx",Sp.a.word,Xe.a.x_j(this.container.Ra(125))),this.container.resolve(833))).ha();this.container.ia(846,()=>new Qs(this.container.resolve(834),this.container.resolve(151),this.container.resolve(150),this.container.resolve(835),this.Unc)).ha();this.container.ia(855,()=>new Di(this.container.resolve(372),
this.container.resolve(835),this.container.resolve(832),$l.a.Mm.kb.Jc,new di($l.a.Mm.kb.Jc),gg.a.instance,Cd.FocusManager.instance(),this.container.resolve(26))).ha();this.container.ia(837,()=>{let b;b=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfYieldableDocumentTraversalIsEnabled",!1)?new ts.a(50,Le.a.Ge):new Tp;return new Ei(y.AFrameworkApplication.oc,b,$l.a.Mm.kb.Jc.od)}).ha();this.container.ia(839,()=>new Nm(this.container.Ra(2))).ha();this.container.ia(845,
()=>new Gl(this.container.resolve(836),y.AFrameworkApplication.va,this.container.resolve(837),this.container.resolve(838),this.container.resolve(839),this.Unc)).ha();this.container.ia(830,()=>new rf(y.AFrameworkApplication.va,this.container.resolve(840),Cd.FocusManager.instance())).as(849).ha();this.container.ia(858,()=>new Ze(Cp.a.instance,Cd.FocusManager.instance())).as(850).ha();this.container.ia(841,()=>new Kg).ha();this.container.ia(843,()=>new jc(this.container.resolve(832),this.container.resolve(595),
$l.a.Mm.kb.Jc)).ha();this.container.ia(842,()=>new Uf(this.container.resolve(841))).ha();this.container.ia(847,()=>new Wc(new kd(this.container.resolve(832),this.container.resolve(842)),new dc(this.container.resolve(657),this.container.resolve(658),this.container.resolve(451),y.AFrameworkApplication.oc),new wf(this.container.resolve(843)),this.container.resolve(837),this.container.resolve(841),this.Unc)).ha();this.container.ia("WordEditor.CatchUpActivity.EmptyCatchUpBehaviorManager",()=>new Gf(y.AFrameworkApplication.va)).as(848).ha();
this.container.ia("WordEditor.CatchUpActivity.RecentChangesManager",()=>new Zr).as(851).ha();this.Zdc=catchUpActivity.FactoryGlobal.getWordCatchUpAppInstance(Object.assign(new ct,{activityContentManager:this.container.resolve(844),activityNavigationManager:this.container.resolve(845),activityRequestManager:this.container.resolve(846),appColorUpdateIsEnabled:y.AFrameworkApplication.J.$("AppColorUpdateIsEnabled"),changeSummariesDataProvider:this.container.resolve(847),dataCulture:y.AFrameworkApplication.dataCulture,
emptyCatchUpBehaviorManager:this.Ybe?this.container.resolve(848):null,flyoutRibbonButton:this.container.resolve(849),flyoutFocus:this.container.resolve(850),uiCulture:y.AFrameworkApplication.uiCulture,ulsLogger:new so.a,recentChangesManager:this.container.resolve(851)}));this.Zdc.setWebpackPublicPath(y.AFrameworkApplication.I8);this.container.ia(854,()=>new Os(this.container.resolve(835),this.container.resolve(832))).ha();this.container.ia(831,()=>new Rs(y.AFrameworkApplication.J,Ns.a.instance,this.container.resolve(834))).ha();
this.container.ia(852,()=>new Yg(this.container.resolve(832),this.container.resolve(838))).ha();this.container.ia(853,()=>new Ia(this.container.resolve(832),this.Zdc.getActivityIndicatorTooltipManager(),this.container.resolve(852),this.container.resolve(839),$l.a.Mm.kb.Jc,this.container.Ra(6),y.AFrameworkApplication.oc,this.container.resolve(843),!!df.a.instance&&df.a.instance.sta,this.container.resolve(318))).ha();this.container.ia(112,()=>new zd(this.container.resolve(362).instance,$l.a.Mm.kb.Jc.od,
this.container.resolve(853),y.AFrameworkApplication.va,this.container.resolve(832),this.container.resolve(838),this.nce)).ha();this.container.ia(856,()=>new nn(this.container.resolve(832),this.container.resolve(26),y.AFrameworkApplication.va,Cd.FocusManager.instance())).ha();this.container.ia(857,()=>new Nt(y.AFrameworkApplication.userName,y.AFrameworkApplication.J,this.container.resolve(838))).ha()}O4m(){var b=this.container.resolve(372),h=this.container.resolve(854);b.Ucb(h);const r=this.container.resolve(855);
b=this.container.resolve(112);const A=this.container.resolve(853);h=this.container.resolve(856);const M=this.container.resolve(835),aa=gg.a.instance,oa=this.container.resolve(837);aa.tA(()=>{M.zee?M.zee=!1:(M.Adb&&r.smj(null,null,!1),M.Grb&&r.mlj(null,null),A.Nnf())});aa.tA(Object(E.a)(h,h.tP,"onSelectionChanged"));this.Zdc.getWywaEvent().addListener(Object(E.a)(b,b.Ggg,"onWywaActivityReady"));b=this.container.resolve(857);this.Zdc.getWywaEvent().addListener(Object(E.a)(b,b.Ggg,"onWywaActivityReady"));
const Ja=this.container.resolve(852);oa.e_k((fb,Cb)=>{Cb&&Ja.lYn(Cb.node)});oa.SGb.then(()=>{Ja.s2k()});this.Zdc.getWywaEvent().addListener(()=>{oa.aal()});A.BYk((fb,Cb)=>{Cb&&r.mlj(Cb.mOb,Cb.yPi)});A.CYk((fb,Cb)=>{Cb&&r.smj(Cb.mOb,Cb.yPi,Cb.T0o)});A.Xb(y.AFrameworkApplication.va);this.container.resolve(830).initialize();this.container.resolve(858).initialize();this.container.resolve(112).initialize();this.l5o()}l5o(){hh.c()&&(v.ULS.sendTraceTag(591673372,3012,50,"WordEditorCatchUpActivityPackageManager.ShowRibbonControls"),
appChrome.api.dispatch([appChrome.actions.updateControlHiddenState("MarkCatchUpChangeAsRead",!1)]))}dispose(){}}Object(u.a)(Ww,"WordEditorCatchUpActivityPackageManager",null,[0,1]);var su=d(181),xs=d(859),to=d(1388),Qu=d(1472),mr=d(1561),Hr=d(1399),Fy=d(1675),gi=d(1676),MA=d(627),Sk=d(1677),Bv=d(862),Ir=d(139),Em=d(1406);class dq{constructor(){this.operationType=this.annotation=null}}Object(u.a)(dq,"AnnotationChangedData",null,[]);class tu{constructor(b,h,r,A,M,aa,oa,Ja=!1,fb){this.annotationType=
b;this.Kz=h;this.Kp=r;this.J0b=A;this.ftd=M;this.Kzp=aa;this.kb=oa;this.uQj=Ja;this.J=fb;this.kz=null;this.b_i=!1;this.ed=new Td.a;this.Hdd=0}HH(b){this.ed.addHandler("AnnotationChangedEvent",b)}eK(b){this.ed.removeHandler("AnnotationChangedEvent",b)}register(){return this.ftd().then(()=>{0===this.Hdd&&(this.uQj&&(this.kz=this.Kp.Wf("WebServiceCall",this.annotationType)),this.Kz.nb(this,this.annotationType));this.Hdd++})}unregister(){return this.ftd().then(()=>(new Promise(b=>setTimeout(b,this.J.ic(Ir.a.NPl,
3E3)))).then(()=>{0<this.Hdd&&(this.Hdd--,0===this.Hdd&&this.Kz.xc(this,this.annotationType))}))}Kic(){return this.ftd().then(()=>this.Kz.getAnnotationsByType(this.annotationType))}Ori(b){b=xs.a.kI(b);return(b=this.Kz.NFf(b))&&0<b.count?b.toArray().filter(h=>wa.a.matchesTypesFor(h.content,[this.annotationType])):[]}getParent(b){return b?b.parent?b.parent:b.parentPath?this.Kzp(this.kb.$c.td,b.parentPath):null:(v.ULS.shipAssertTag(575930380,3016,!1),null)}iAa(b){b.timestamp||(b.timestamp=Date.now());
b=Object.assign(new Bv.a,{parentPath:["Signal",wa.a.getTypeNameFor(b)],items:[Object.assign(new Gc.a,{body:b})]});this.J0b.submitOperation(b)}RXl(b,h){b=Object.assign(new hc.a,{parentPath:["Signal",h],items:b});this.J0b.submitOperation(b)}ZG(b,h){b?h?(this.uQj&&!this.b_i&&(this.kz.stop(),this.b_i=!0),this.ed.tfa&&(b=new Em.a(Object.assign(new dq,{annotation:b,operationType:h})),this.ed.raiseEvent("AnnotationChangedEvent",b))):v.ULS.shipAssertTag(575930382,3016,!1):v.ULS.shipAssertTag(575930381,3016,
!1)}}Object(u.a)(tu,"AnnotationManager",null,[580,229]);class wt{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb){this.hL=b;this.Fue=h;this.EOb=r;this.v8a=A;this.uaa=M;this.MZj=aa;this.w4=oa;this.k1b=Ja;this.Bgc=fb;this.NXb=Cb;this.qep=Gb}}Object(u.a)(wt,"AnnotationManagerHolder",null,[579]);class eq{constructor(b,h){this.H5a=b;this.ftd=h}submitOperation(b){return this.ftd().then(()=>{this.H5a.getAugLoopRuntimeManager().submitOperation(Object.assign(new Ma.a,{operation:b}))})}}Object(u.a)(eq,"SubmitOperationHelper",
null,[]);var Ti=d(1044),nr=d(1678),Ru=d(1562),of=d(42),Gn=d(104),cn=d(77),on=d(1066);class Cv{constructor(b,h,r){this.uaa=b;this.an=h;this.NWb=r;this.pJa={};this.Xfi=!1;this.kvb=(A,M)=>{var aa;M.data.operationType!==hc.a.getTypeName()&&M.data.operationType!==on.n.getTypeName()||!M.data.annotation||M.data.annotation.annotationType!==nr.a.getTypeName()||(A=M.data.annotation.content)&&null!==(aa=A.documentTypeConfidences)&&void 0!==aa&&aa.length&&(this.Wfi=A.documentTypeConfidences[0].documentTypeLabel,
v.ULS.sendTraceTag(541078657,3016,50,"Document type obtained: {0}",this.Wfi))};this.uaa.HH(this.kvb);this.uaa.register();this.pJa={["docType"]:null,["characterCount"]:null,["paragraphCount"]:null,["imageCount"]:null,["tableCount"]:null,["listElementsCount"]:null,["blobsCount"]:null,["pageCount"]:null,["currentPage"]:null}}c6d(){this.Xfi||(this.uaa.iAa(new Ru.a),v.ULS.sendTraceTag(541078658,3016,50,"Document type classifier signal sent"),this.Xfi=!0);this.wxf();this.pJa.docType=this.Wfi;this.pJa.characterCount=
this.characterCount;this.pJa.paragraphCount=this.XU;this.pJa.imageCount=this.AL;this.pJa.tableCount=this.Cca;this.pJa.listElementsCount=this.v5i;this.pJa.blobsCount=this.eTc;this.pJa.pageCount=this.NWb.getTotalPageCount();this.pJa.currentPage=this.NWb.dCi();return this.pJa}wxf(){this.XU=this.eTc=this.v5i=this.Cca=this.AL=this.characterCount=0;var b=this.an.tsa($l.a.Mm.kb.Jc.od,7,7).currentNode,h=vd.a.Za(b);for(b=uf.a.At(h,b);b.moveNext();)if(h=b.currentNode)if(Uc.ImageReader.It(h))this.AL++;else if(Ii.TableReader.zU(h))this.Cca++;
else if(of.ListItemReader.Cg(h))this.v5i++;else if(Gd.ParagraphReader.Vb(h)){var r=cn.e(h);for(let A=0;A<r.length;A++)5===r[A].Qh?this.AL++:this.eTc++;r=Gn.AParagraphNode.dV(h.characterData);r=r.trim();this.characterCount+=r.length;0<r.length&&!Gd.ParagraphReader.wX(h)&&!Gd.ParagraphReader.vX(h)&&this.XU++}}}Object(u.a)(Cv,"LoggingDocumentInfo",null,[577]);class Q{constructor(){this.sa=new Td.a}A_k(b){this.sa.addHandler("OnTaskPaneReviewStateChanged",b)}cyo(b){this.sa.removeHandler("OnTaskPaneReviewStateChanged",
b)}wZk(b){this.sa.addHandler("BlueDotClickedEvent",b)}Ixo(b){this.sa.removeHandler("BlueDotClickedEvent",b)}KZk(b){this.sa.addHandler("OnFormattingMarkedForReview",b)}MZk(b){this.sa.addHandler("OnFormattingReviewCompleted",b)}JZk(b){this.sa.addHandler("OnFormattingAccept",b)}LZk(b){this.sa.addHandler("OnFormattingReject",b)}q_k(b){this.sa.addHandler("OnReviewInvalidated",b)}NOh(b){this.sa.addHandler("OnTraigeAction",b)}lff(b){this.sa.addHandler("OnReviewVisibilityChanged",b)}Wxo(b){this.sa.removeHandler("OnReviewVisibilityChanged",
b)}tZk(b){this.sa.addHandler("OnBeforeReviewNavigation",b)}m_k(b){this.sa.addHandler("OnRegisterEnhancement",b)}D_k(b){this.sa.addHandler("onTooltipVisibilityChanged",b)}dyo(b){this.sa.removeHandler("onTooltipVisibilityChanged",b)}Bid(b){b?this.sa.raiseEvent("OnTaskPaneReviewStateChanged",new Em.a(b)):v.ULS.shipAssertTag(575930374,3016,!1)}vjo(b){b?this.sa.raiseEvent("BlueDotClickedEvent",new Em.a(b)):v.ULS.shipAssertTag(575930375,3016,!1)}yjo(b){b?this.sa.raiseEvent("OnFormattingMarkedForReview",
new Em.a(b)):v.ULS.shipAssertTag(575930376,3016,!1)}mwj(b){b?this.sa.raiseEvent("OnFormattingReviewCompleted",new Em.a(b)):v.ULS.shipAssertTag(573850377,3016,!1)}xjo(b){b?this.sa.raiseEvent("OnFormattingAccept",new Em.a(b)):v.ULS.shipAssertTag(575930377,3016,!1)}zjo(b){b?this.sa.raiseEvent("OnFormattingReject",new Em.a(b)):v.ULS.shipAssertTag(575930378,3016,!1)}Ajo(b){b?this.sa.raiseEvent("OnReviewInvalidated",new Em.a(b)):v.ULS.shipAssertTag(575930379,3016,!1)}zog(b){b?this.sa.raiseEvent("OnTraigeAction",
new Em.a(b)):v.ULS.shipAssertTag(573850378,3016,!1)}nwj(b){b?this.sa.raiseEvent("OnReviewVisibilityChanged",new Em.a(b)):v.ULS.shipAssertTag(573850379,3016,!1)}ujo(b){b?this.sa.raiseEvent("OnBeforeReviewNavigation",new Em.a(b)):v.ULS.shipAssertTag(573687395,3016,!1)}kuc(b){b?this.sa.raiseEvent("OnRegisterEnhancement",new Em.a(b)):v.ULS.shipAssertTag(555055117,3016,!1)}Cwj(b){b?this.sa.raiseEvent("onTooltipVisibilityChanged",new Em.a(b)):v.ULS.shipAssertTag(540587343,3016,!1)}}Object(u.a)(Q,"ReviewEvents",
null,[576]);class Da{constructor(b){this.Ky=b;if(!b)throw su.a.argument("Workspace is null");}get name(){return"WordEditor.Designer.Common"}init(){}uc(b){this.W=b;b.ia(860,()=>new eq(this.W.resolve(658),xs.a.hm)).ha();b.ia(864,()=>new Ti.a(b.resolve(12),b.resolve(71),y.AFrameworkApplication.uiCulture)).ha();b.ia(861,()=>new Q).ha();b.ia(859,()=>new wt(this.JIa(Hr.DocumentRoleDetectionAnnotation.getTypeName()),this.JIa(Hr.RoleDetectionAnnotation.getTypeName()),this.JIa(to.FormattingSuggestionsSummaryAnnotation.getTypeName(),
!0),this.JIa(to.FormattingSuggestionsAnnotation.getTypeName()),this.JIa(Qu.DocumentTypeClassifierAnnotation.getTypeName()),this.JIa(gi.ThemeExtractorAnnotation.getTypeName()),this.JIa(MA.ThemeGeneratorAnnotation.getTypeName()),this.JIa(Fy.TextToImageAnnotation.getTypeName()),this.JIa(mr.DocumentPullQuoteAnnotation.getTypeName()),this.JIa(mr.PullQuoteAnnotation.getTypeName()),this.JIa(Sk.TableTypeAnnotation.getTypeName()))).ha();b.ia(1427,()=>new Cv(b.resolve(859).uaa,b.resolve(292),b.resolve(484))).ha()}dispose(){}JIa(b,
h=!1){return new tu(b,this.W.resolve(451),this.W.resolve(38),this.W.resolve(860),xs.a.hm,xs.a.Dqb,this.Ky,h,this.W.resolve(71))}}Object(u.a)(Da,"PackageManager",null,[0,1]);var eb=d(1413),Tb=d(1384),Ac=d(1681);class hd extends Sys.EventArgs{constructor(b,h){super();this.node=b;this.Lag=h}}Object(u.a)(hd,"RoleChangeArgs",Sys.EventArgs,[]);class Ud{constructor(b){this.ii=!1;this.r$=b;this.r$.lDd++}dispose(){this.ii||(this.ii=!0,this.r$.lDd--)}}Object(u.a)(Ud,"InvalidationSuspension",null,[10]);class Ee{constructor(){this.hqd=
null;this.role=this.hje=0;this.gKb=this.Hee=this.Lla=this.Poc=!1;this.nie=this.Vbd=this.iVa=null;this.Vwb=this.placeholder=!1;this.NRd=this.Atf=null;this.MRd=0}get P$a(){return!this.role||!this.iVa||!this.iVa.length}f$m(){this.gKb=this.Hee=!0}Pqn(){return!!this.role||!!this.iVa||!!this.hqd}}Object(u.a)(Ee,"RoleState",null,[650]);class Me{constructor(b,h,r,A,M){this.ui=!1;this.Ibe=null;this.T6f=new eh.a;this.Sjh=0;this.aGo=(aa,oa)=>{oa.data.operationType===hc.a.getTypeName()&&(oa=oa.data.annotation,
(aa=oa.content)?(oa=this.n$b.getParent(oa))&&this.fnd(oa,Tb.f(aa.roleType),!1,void 0,null!=aa.listID?aa.listID:0,aa.listItemlevel,aa.listItemPrefix):v.ULS.shipAssertTag(575813856,3016,!1))};this.TUl=(aa,oa)=>{if(oa.data.operationType===hc.a.getTypeName())if(aa=oa.data.annotation.content)for(v.ULS.sendTraceTag(556074199,3016,50,aa.confidence.toString()),this.T6f=new eh.a,oa=0;aa.listInfos&&oa<aa.listInfos.length;oa++){const Ja=aa.listInfos[oa];this.T6f.Z(Ja.listID,Ja)}else v.ULS.shipAssertTag(556323522,
3016,!1)};this.HYi=(aa,oa)=>{aa=aa.eQ;if(!aa||aa.ka(Mc.a.LC,!1))return!1;aa=aa.getValue(Mc.a.ma);if(!aa)return!1;aa=Tb.g(aa);return 1!=aa&&aa!=oa.role};this.Nam=(aa,oa)=>{aa=oa.data.annotation;const Ja=this.dBd.getParent(aa);if(Ja)if(oa.data.operationType===hc.a.getTypeName()){const fb=oa.data.annotation.content;fb?this.dha(Ja,Cb=>{this.Ibe&&Cb.Atf&&this.Ibe>Cb.Atf&&!Cb.gKb||Cb.role!==Cb.hje||this.HYi(Ja,Cb)?(v.ULS.sendTraceTag(572301727,3016,50,"InvalidationTimestamp: {0} | InvalidatedFlag: {1} | RlmRole==ModelRole: {2}",
this.Ibe,Cb.gKb,Cb.role===Cb.hje),Cb.hqd=fb.suggestions):(Cb.iVa=fb.suggestions,Cb.gKb=!1)}):v.ULS.shipAssertTag(575813859,3016,!1)}else oa.data.operationType===eb.a.getTypeName()&&this.dha(Ja,fb=>{fb.iVa=null;fb.hqd=null});else v.ULS.shipAssertTag(575813858,3016,!1,`Parent not found for annotation id: ${aa.id} parentPath: ${aa.parentPath}`)};this.lVn=(aa,oa)=>{(aa=oa.data.paragraphNode)?this.dha(aa,Ja=>{oa.data.W8j?(Ja.NRd=Ja.iVa,Ja.MRd=Ja.role):(Ja.NRd=null,Ja.MRd=0);Ja.Lla=!0}):v.ULS.shipAssertTag(575930368,
3016,!1)};this.nVn=(aa,oa)=>{(aa=oa.data.paragraphNode)?this.dha(aa,Ja=>{Ja.Lla=!1;Ja.NRd=null;Ja.MRd=0;5!==oa.data.state&&(Ja.iVa=null)}):v.ULS.shipAssertTag(573850380,3016,!1)};this.jVn=(aa,oa)=>{(aa=oa.data.paragraphNode)?this.dha(aa,Ja=>{Ja.Lla=!0}):v.ULS.shipAssertTag(575930369,3016,!1)};this.mVn=(aa,oa)=>{(aa=oa.data.paragraphNode)?this.fnd(aa,1,!0,!0):v.ULS.shipAssertTag(575930370,3016,!1)};this.qgg=(aa,oa)=>{(aa=oa.data.paragraphNode)?this.fnd(aa,oa.data.Lag,!0,!0):v.ULS.shipAssertTag(575484484,
3016,!1)};this.CQm=(aa,oa)=>{if(oa.node){var Ja=oa.node;aa=this.TB(Ja);27==aa.role&&v.ULS.sendTraceTag(541435078,3016,50,"Pull Quote node deleted.");aa.Lla&&27!==aa.role&&28!==aa.role&&this.qPj(this.AZb-1);aa.P$a||27===aa.role||28===aa.role||this.jPj(this.inconsistenciesCount-1);this.dha(Ja,fb=>{fb.Vwb=!0});setTimeout(()=>this.removeNode(Ja),1E4)}else v.ULS.shipAssertTag(575930371,3016,!1)};this.removeNode=aa=>{let oa;({value:oa}=this.Wv.Ac(aa.id));(null===oa||void 0===oa?0:oa.Vwb)&&this.Wv.remove(aa.id)};
this.BQm=(aa,oa)=>{oa.node?(aa=oa.node,this.FZf(aa)?this.dha(aa,Ja=>{Ja.Vwb=!1}):this.dha(aa,Ja=>{Ja.gKb=!1})):v.ULS.shipAssertTag(540672206,3016,!1)};this.DQm=(aa,oa)=>{oa.node?this.vyb(oa.property,oa.node)&&(aa=oa.node,this.lDd||aa.Qpe?this.dha(aa,Ja=>{Ja.gKb=!1}):this.dha(aa,Ja=>{Ja.f$m();Ja.hqd&&(Ja.iVa=Ja.hqd,Ja.role=Ja.hje)}).Lla&&this.r4a.Ajo(new Ac.a(oa.node))):v.ULS.shipAssertTag(575930372,3016,!1)};this.oZn=(aa,oa)=>{switch(oa.data.role){case 27:const Ja=oa.data;this.dha(oa.data.paragraphNode,
Cb=>{Cb.role=27;Cb.Poc=!0;Cb.placeholder=Ja.placeholder});break;case 28:const fb=oa.data;this.dha(oa.data.paragraphNode,Cb=>{Cb.role=28;Cb.Poc=!0;Cb.placeholder=fb.placeholder;Cb.d6c=fb.d6c});break;case 2:this.dha(oa.data.paragraphNode,Cb=>{Cb.role=2})}};this.dBd=b;this.n$b=h;this.vPe=r;this.Jq=A;this.r4a=M;this.Wv=new eh.a;this.sa=new Td.a;this.lDd=this.EKd=this.PCd=0}get B$m(){return this.lDd}OZk(b){this.sa.addHandler(Me.Ejj,b)}u_k(b){this.sa.addHandler(Me.Zlj,b)}t_k(b){this.sa.addHandler(Me.Ylj,
b)}get inconsistenciesCount(){return this.PCd}jPj(b){this.PCd!==b&&(this.PCd=b,this.sa.raiseEvent(Me.Ejj,new Em.a(this.PCd)))}get AZb(){return this.EKd}qPj(b){this.EKd!==b&&(this.EKd=b,this.sa.raiseEvent(Me.Zlj,new Em.a(this.EKd)))}get bSf(){return this.Sjh}FZf(b){return this.Wv.lb(b.id)}Mwm(b){var h,r;return null===(r=null===(h=this.T6f)||void 0===h?void 0:h.Ac(b))||void 0===r?void 0:r.value}yCi(b,h){var r,A,M;const aa=new Map;for(const oa of h)if(h=oa){const Ja=null!==(M=null===(A=null===(r=this.Wv.Ac(h.id))||
void 0===r?void 0:r.value)||void 0===A?void 0:A.role)&&void 0!==M?M:1;b.has(Ja)&&(aa.has(Ja)?aa.get(Ja).add(h):aa.set(Ja,new ib.a([h])))}return aa}TB(b){if(!b)return v.ULS.shipAssertTag(575813855,3016,!1),null;let h;return({value:h}=this.Wv.Ac(b.id)).returnValue?h:Object.assign(new Ee,{role:1,Poc:!1})}JBo(){this.Ibe=new Date;return new Ud(this)}register(){this.dBd.register();this.n$b.register();this.vPe.register()}unregister(){this.dBd.unregister();this.n$b.unregister();this.vPe.unregister()}initialize(){if(!this.ui){const b=
this.Jq.jf(12);b.Yx(this.CQm);b.wt(this.BQm);b.jo(this.DQm);this.dBd.HH(this.Nam);this.n$b.HH(this.aGo);this.vPe.HH(this.TUl);this.r4a.LZk(this.mVn);this.r4a.JZk(this.jVn);this.r4a.KZk(this.lVn);this.r4a.MZk(this.nVn);this.r4a.NOh(this.qgg);this.r4a.m_k(this.oZn);this.ui=!0}}Vd(){}fnd(b,h,r,A=!1,M=0,aa=0,oa){let Ja=0,fb=!1;this.dha(b,Cb=>{const Gb=Cb.Hee||!Cb.role||1==Cb.role;r||(Cb.hje=h);if(A||Gb)fb=Cb.role!==h,Ja=Cb.role,Cb.role=h,Cb.Poc=r,Cb.Hee=!1,Cb.Vbd=M,Cb.nie=aa,Cb.listItemPrefix=oa,Cb.Atf=
new Date});if(fb){const Cb=h-4;Cb>this.bSf&&8>Cb&&(this.Sjh=Cb);1===h&&this.dha(b,Gb=>{Gb.iVa=null});this.sa.raiseEvent(Me.Ylj,new Em.a(new hd(b,h,Ja)))}}dha(b,h){let r;if(({value:r}=this.Wv.Ac(b.id)).returnValue){b=r.P$a;const A=r.Lla;h(r);if(27!==r.role&&28!==r.role){if(r.Vwb)return r;b!==r.P$a&&this.jPj(this.inconsistenciesCount+(b?1:-1));A!==r.Lla&&this.qPj(this.AZb+(A?-1:1))}}else h(r=new Ee),r.Pqn()&&this.Wv.add(b.id,r);return r}vyb(b,h){({value:h}=this.Wv.Ac(h.id));return 28===(null===h||void 0===
h?void 0:h.role)?!(null===h||void 0===h?0:h.placeholder)&&b===He.a.Pn:!(null===h||void 0===h?0:h.placeholder)&&(b===He.a.Pn||b===He.a.Qn||Array.contains(Gn.AParagraphNode.rfa(),b))}}Me.Ejj="OnInconsistenciesChanged";Me.Zlj="OnRoleReviewCount";Me.Ylj="OnRoleChanged";Object(u.a)(Me,"RoleLifecycleManager",null,[633,634,635]);class Kf{constructor(b,h,r,A,M){this.r4a=b;this.n$b=h;this.Te=r;this.Jq=A;this.r$=M;this.ui=!1;this.qgg=(aa,oa)=>{(aa=oa.data.paragraphNode)?this.f5j(aa,()=>!0,Ja=>Ja.userSetRole=
Tb.e(oa.data.Lag)):v.ULS.shipAssertTag(557057378,3016,!1)};this.gYn=(aa,oa)=>{0<this.r$.B$m||this.vyb(oa.property)&&this.f5j(oa.node,Ja=>!(Ja&&Ja.isInvalidated),Ja=>Ja.isInvalidated=!0)}}initialize(){this.ui||(this.r4a.NOh(this.qgg),this.Jq.jf(12).jo(this.gYn),this.ui=!0)}Vd(){}f5j(b,h,r){if(b=(b=this.n$b.Ori(b))&&1===b.length&&b[0]){var A=b.content;A=A&&A.M_&&A.M_.customMetadata;h(A)&&(h=new Hr.RoleDetectionCustomMetadata,h.isInvalidated=A&&A.isInvalidated,h.userSetRole=A&&A.userSetRole,r(h),this.Te.Vqp(b,
h))}}vyb(b){return b===He.a.Pn||b===He.a.Qn||Array.contains(Gn.AParagraphNode.rfa(),b)}}Object(u.a)(Kf,"RoleDetectionMetadataUpdater",null,[581]);class th{constructor(b,h){this.J0b=b;this.lNb=h;this.hed=(r,A)=>{r=A.data;if(r.operationType==on.a.getTypeName()||r.operationType==on.n.getTypeName())if(r=r.annotation&&r.annotation.content)this.runId=r.runId};this.revisionId=0}initialize(){this.lNb.HH(this.hed)}Vd(){this.lNb.eK(this.hed)}SRn(){if(void 0===this.runId)Promise.resolve();else{var b=new Hr.RoleDetectionSettings({acceptedRunId:this.runId});
b=new on.a({parentPath:["session","doc","main"],items:[{id:"RoleDetectionSettings",body:b,revId:(this.revisionId++).toString()}]});this.J0b.submitOperation(b)}}}Object(u.a)(th,"RoleDetectionSettingsUpdater",null,[]);class Fj{constructor(b,h,r){this.i9m=b;this.Kz=h;this.fe=r;this.NRi=this.initialized=!1;this.Chj=()=>{this.WQj()&&(this.mQi(),this.Kz.Axo(this.Chj))}}initialize(){this.initialized||(this.gUf(),this.initialized=!0)}Vd(){}gUf(){this.WQj()?this.mQi():this.Kz.hZk(this.Chj)}WQj(){return!this.NRi&&
(this.fe.CVi()||this.Kz.Lmc(Hr.DocumentRoleDetectionAnnotation.getTypeName())||this.Kz.Lmc(Hr.RoleDetectionAnnotation.getTypeName()))}mQi(){for(const b of this.i9m)b.initialize();this.NRi=!0}}Object(u.a)(Fj,"RLMInitializer",null,[]);class uh{constructor(b,h,r){this.V0=b;this.Ky=h;this.ewd=r;this.W=null;this.G8=()=>{this.v7c();this.Ky.$cb(this.G8)};if(!b)throw su.a.argument("AppLifecycleManager is null");if(!h)throw su.a.argument("Workspace is null");if(!r)throw su.a.argument("ApplicationInstance is null");
}get name(){return"WordEditor.DocumentUnderstanding.RLM"}init(){this.W.resolve(12).us.continueWith(()=>this.Fo())}uc(b){this.W=b;b.ia(865,()=>new th(this.W.resolve(860),b.resolve(859).hL)).ha();b.ia(863,()=>new Kf(b.resolve(861),b.resolve(859).Fue,b.resolve(451),b.resolve(456),b.resolve(862))).ha();b.ia(862,()=>new Me(b.resolve(859).v8a,b.resolve(859).Fue,b.resolve(859).hL,b.resolve(456),b.resolve(861))).ha();b.ia(1082,()=>b.resolve(862)).ha();b.ia(866,()=>new Fj([this.W.resolve(862),this.W.resolve(863)],
b.resolve(451),b.resolve(864))).ha()}dispose(){}Fo(){this.ewd.vN?this.V0.Tk(16,()=>this.N6c()):this.N6c()}N6c(){this.Ky.HBa?this.v7c():this.Ky.vja(this.G8)}v7c(){this.W.resolve(865).initialize();this.W.resolve(866).initialize()}}Object(u.a)(uh,"PackageManager",null,[0,1]);class hi{constructor(){this.ContractVersion=0;this.FileName=this.Paragraphs=null}static construct(b,h){const r=new hi;r.ContractVersion=b;r.FileName=h;r.Paragraphs=[];return r}}Object(u.a)(hi,"DocumentSwayPreviewContent",null,[]);
class kk{constructor(){this.TextRuns=this.ParagraphFormatting=this.RawText=null;this.ParagraphIndex=0;this.IsRTL=!1}static Cyl(b,h,r,A){const M=new kk;M.RawText=b;M.ParagraphFormatting=h;M.TextRuns=r;M.IsRTL=A;M.ParagraphIndex=0;return M}}Object(u.a)(kk,"ParagraphContent",null,[]);var kl=d(102),Aa=d(1125);class Qa{constructor(){this.Name=null;this.Size=0}static construct(b,h){const r=new Qa;r.Name=b;r.Size=h;return r}}Object(u.a)(Qa,"FontData",null,[]);class Fa{constructor(){this.IsUppercase=this.IsUnderline=
this.IsBold=!1;this.Font=null;this.LeftIndent=this.Alignment=0}static construct(b,h,r,A,M,aa){const oa=new Fa;oa.IsBold=b;oa.IsUnderline=h;oa.IsUppercase=r;oa.Font=A;oa.Alignment=M;oa.LeftIndent=aa;return oa}}Object(u.a)(Fa,"TextFormatting",null,[]);class xa{constructor(){this.RunFormatting=this.RawText=null}static construct(b,h){const r=new xa;r.RawText=b;r.RunFormatting=h;return r}}Object(u.a)(xa,"TextRunContent",null,[]);var Wa=d(106),Db=d(33);class Yb{constructor(b,h){this.jhb=null;this.iBk=b;
this.tQ=h||""}get T4n(){return this.iBk.value}K2l(){var b=Date.now();const h=hi.construct(2,this.tQ);h.Paragraphs=this.Kem();b=Date.now()-b;const r={};r.ExtractionDurationInMs=b.toString();v.ULS.sendTraceTag(25268374,382,50,"{0}",r);return h}Kem(){const b=new ib.a;var h=0;let r=0,A=!1;var M=new vd.a;M.set(this.T4n);M=uf.a.gq(M.currentNode);const aa=new eh.a(0);for(;M.moveNext()&&2100>r&&25>h;){var oa=M.currentNode;if(Gd.ParagraphReader.Vb(oa)&&!Gd.ParagraphReader.wX(oa)){!A&&Gd.ParagraphReader.vX(oa)&&
(A=!0);let Ja=Gn.AParagraphNode.dV(oa.characterData);Ja=Ja.trim();if(0<Ja.length){const fb=this.nN(oa);fb.ParagraphIndex=h;h++;r+=Ja.length;b.add(fb);this.pup(aa,Gd.ParagraphReader.language(oa))}}}this.jhb=this.Olm(aa);h={};h.documentHasList=A;v.ULS.sendTraceTag(25776736,382,50,"{0}",h);return b.toArray()}Olm(b){let h=-1,r=1033;for(const A of b.keys.toArray())A&&b.K(A)>h&&(h=b.K(A),r=A);return tj.a.Hg(r)}pup(b,h){b.lb(h)?b.Z(h,b.K(h)+1):b.Z(h,1)}nN(b){const h=Gn.AParagraphNode.dV(b.characterData),
r=this.KBm(b),A=this.DLm(b);b=this.sln(b);return kk.Cyl(h,r,A,b)}KBm(b){const h=Gd.ParagraphReader.nj(b,He.a.bold,!1),r=Gd.ParagraphReader.nj(b,He.a.underline,!1);var A=Gd.ParagraphReader.nj(b,He.a.fontSize,kl.a.YQ);const M=Gd.ParagraphReader.nj(b,He.a.font,kl.a.eL);var aa=Gd.ParagraphReader.Sy(b);aa=this.yFf(aa);const oa=!!Gd.ParagraphReader.nj(b,wb.a.capitalization,0);b=(new Aa.a).$W(b).value/20;A=Qa.construct(M,A);return Fa.construct(h,r,oa,A,aa,b)}DLm(b){const h=new ib.a;for(let M=0;M<b.ra.length-
1;M++){var r=b.ra.K(M),A=b.ra.K(M+1);r.formatting&&(A=Gn.AParagraphNode.dV(b.characterData.substr(r.cp,A.cp-r.cp)),r=this.ELm(r.formatting),r=xa.construct(A,r),h.add(r))}return h.toArray()}ELm(b){const h=Wa.FormattingReader.S3c(b,He.a.bold,!1),r=Wa.FormattingReader.S3c(b,He.a.underline,!1);var A=Wa.FormattingReader.S3c(b,He.a.fontSize,kl.a.YQ);const M=Wa.FormattingReader.S3c(b,He.a.font,kl.a.eL);A=Qa.construct(M,A);b=!!Wa.FormattingReader.S3c(b,wb.a.capitalization,0);return Fa.construct(h,r,b,A,5,
0)}yFf(b){switch(b){case 1:return 0;case 3:return 1;case 2:return 2;case 6:return 3;case 0:return 5;default:return 4}}sln(b){const h=new vd.a;h.set(b);h.vb(11);return(b=h.ld(11))?Db.OutlineElementReader.Eo(b):!1}}Object(u.a)(Yb,"DocumentContentExtractor",null,[541]);class rc{get name(){return"WordEditor.DocumentContentExtractor"}init(){}dispose(){}uc(b){b.ia("WordEditor.DocumentContentExtractor.DocumentContentExtractor",()=>new Yb(new Qf.a(()=>$l.a.Mm.kb.Jc.od),y.AFrameworkApplication.Ft.yA)).as(1097).ha()}static main(){K.a.instance.Lc(new rc)}}
Object(u.a)(rc,"DocumentContentExtractorPackage",null,[0,1]);class Lc{}Lc.kh="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";Object(u.a)(Lc,"EmbedDialogHtml",null,[]);class Sc{constructor(b,h,r,A){this.wsc=b;this.b$a=h;this.Rne=r;this.value=A}}Object(u.a)(Sc,"OptionInfo",null,[]);class sd{constructor(b,h,r){this.fwg=b;this.Ulc=h;this.b$a=r}}Object(u.a)(sd,"SectionInfo",null,[]);
var ed=d(294);class $c extends ig.a{constructor(b,h=!1){super(!1,!1,h);this.Pzd=476;this.j6b=288;this.NOe=798;this.fHk=476;this.eHk=288;this.Wfd={};this.Cxb=[];this.UY=this.Q3a=this.fGb=this.ECb=this.LHd=this.G9b=null;this.y8k=r=>{this.l_h(r);return!0};this.z8k=r=>this.V$c(r,this.l_h);this.l_h=r=>{r=r.rq;"visible"===r.fwg.style.visibility?(r.fwg.style.visibility="hidden",r.b$a.className=Gg.getImageClass($c.ieh),r.b$a.title=CommonUIStrings.l_Expand,r.Ulc.title=CommonUIStrings.l_Expand):(r.fwg.style.visibility=
"visible",r.b$a.className=Gg.getImageClass($c.lPk),r.b$a.title=CommonUIStrings.l_Collapse,r.Ulc.title=CommonUIStrings.l_Collapse)};this.Y2n=r=>{this.noj(r);return!0};this.Z2n=r=>this.V$c(r,this.noj);this.noj=r=>{const A=this.Wfd[r.rq.toString()];A.value?(A.value=0,A.b$a.className=Gg.getImageClass($c.Aaf),A.Rne.setAttribute(Ne.a.UHa,Ne.a.FO)):(A.value=1,A.b$a.className=Gg.getImageClass($c.HLe),A.Rne.setAttribute(Ne.a.UHa,Ne.a.fq));this.XDe(r.rq.toString(),A.value.toString())};this.Jfp=()=>{this.UY.select()};
this.cGc=y.AFrameworkApplication.K5c;this.NGb=b;this.N1e=this.Y2n;this.cMc=this.Z2n;this.LJe=this.y8k;this.W3b=this.z8k;this.DNd=this.Jfp;this.Izk=h;this.kh=Lc.kh;this.Fd=0;this.Ng="EmbedDialog"}get Tu(){return this.j6b}set Tu(b){this.j6b=b}kTj(b){const h={["id"]:this.Ng,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,["interactionSectionTitle"]:CommonUIStrings.l_Interaction,
["initialPreviewUrl"]:$a.a.Ap(this.NGb,"wdPreview","1"),["initialEmbedUrl"]:this.cGc,["getEmbedCode"]:$c.Yvi,["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const r of Object.keys(b))h[r]=b[r];this.Fd=1;this.Qe(1,CommonUIStrings.l_CopyAction);this.Qe(0,CommonUIStrings.l_Close);this.mi(CommonUIStrings.l_Embed,null,h)}ixc(){if(this.Izk)this.kTj({});else{this.showDialog(CommonUIStrings.l_Embed,null);this.G9b=document.getElementById("embedpreviewpane");this.LHd=document.getElementById("embedoptionpane");
this.G9b.style.width=String.format("{0}px",this.fHk);this.Q3a=document.createElement("iframe");this.Q3a.className=$c.dHk;this.Q3a.frameBorder="0";this.Q3a.style.height=String.format("{0}px",this.eHk);this.Q3a.tabIndex=-1;this.G9b.appendChild(this.YXd(CommonUIStrings.l_Preview,this.Q3a,$c.Uyh,$c.Tyh,$c.Uyh,!0));this.UY=document.createElement("textarea");this.UY.className=$c.ksk;Sys.UI.DomElement.addCssClass(this.UY,ed.a.Agf);this.UY.id=$c.Veh;Y.a.Ci||(this.UY.readOnly=!0);this.UY.rows=4;this.UY.style.fontFamily=
CommonUIStrings.l_UserInterfaceFontName;this.UY.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;this.UY.setAttribute(Ne.a.Bja,String.format("{0} {1}",$c.Ueh,$c.Teh));this.G9b.appendChild(this.YXd(CommonUIStrings.l_EmbedCode,this.UY,$c.Ueh));mf.a.addHandler(this.UY,"focus",this.DNd);var b=document.createElement("span");b.className=$c.cuk;b.innerText=CommonUIStrings.l_CopyText;b.id=$c.Teh;this.G9b.appendChild(b);this.ECb=document.createElement("div");this.ECb.className=$c.rrk;this.LHd.appendChild(this.YXd(CommonUIStrings.l_Dimensions,
this.ECb));this.fGb=document.createElement("div");this.LHd.appendChild(this.YBl($c.Dwh,this.fGb));this.Fd=0;this.Qe(1,CommonUIStrings.l_Close);this.MKg();this.b7j();Y.a.Ci||this.UY.focus()}}dispose(){if(this.Wfd){var b=this.Wfd;for(const h in b){const r=b[h];this.rr.xc(Jd.a.click,r.wsc,this.N1e);this.oe.xc(Jd.a.hj,r.wsc,this.cMc);this.oe.xc(Jd.a.pi,r.wsc,this.cMc)}this.cMc=this.N1e=this.Wfd=null}if(this.Cxb){for(b=0;b<this.Cxb.length;++b)this.rr.xc(Jd.a.click,this.Cxb[b].Ulc,this.LJe),this.oe.xc(Jd.a.hj,
this.Cxb[b].Ulc,this.W3b),this.oe.xc(Jd.a.mv,this.Cxb[b].Ulc,this.W3b),this.oe.xc(Jd.a.pi,this.Cxb[b].Ulc,this.W3b);this.oe=this.LJe=this.Cxb=null}this.DNd&&this.UY&&(mf.a.removeHandler(this.UY,"focus",this.DNd),this.DNd=null);this.UY=this.Q3a=this.fGb=this.ECb=this.LHd=this.G9b=null;super.dispose()}Iga(){super.Iga();this.Oc.style.width=String.format("{0}px",this.NOe);this.fIa()}Osp(b,h){const r=$a.a.Ap(this.cGc,b,h);return this.cGc!==r?(this.cGc=r,this.NGb=$a.a.Ap(this.NGb,b,h),!0):!1}MKg(){this.UY&&
(this.UY.innerText=$c.Yvi(this.cGc,this.Pzd,this.j6b))}b7j(){this.Q3a&&this.Q3a.contentWindow.location.replace($a.a.Ap(this.NGb,"wdPreview","1"))}XDe(b,h){this.Osp(b,h)&&(this.MKg(),this.b7j())}YXd(b,h,r=null,A=null,M=null,aa=!1){const oa=document.createElement("div");oa.className=$c.TJk;A&&(oa.id=A);M&&oa.setAttribute(Ne.a.Bja,M);aa&&(oa.tabIndex=0);A=document.createElement("span");A.className=$c.UJk;A.innerText=b;r&&(A.id=r);oa.appendChild(A);oa.appendChild(h);return oa}YBl(b,h){const r=this.YXd(CommonUIStrings.l_Interaction,
h),A=this.Nj.createElement("div");A.className=$c.Xlk;A.id=$c.f8g+b;A.setAttribute(Ne.a.Ph,Ne.a.K$);A.tabIndex=0;r.insertBefore(A,h);b=Gg.createClusteredImage(16,16,$c.Ylk,$c.Zlk,!0,"");A.appendChild(b);b=b.childNodes[0];b.className=Gg.getImageClass($c.ieh);b.title=CommonUIStrings.l_Expand;A.title=CommonUIStrings.l_Expand;h.style.visibility="hidden";h=new sd(h,A,b);Array.add(this.Cxb,h);this.rr.LI(Jd.a.click,A,this.LJe,h);this.oe.LI(Jd.a.hj,A,this.W3b,h);this.oe.LI(Jd.a.mv,A,this.W3b,h);this.oe.LI(Jd.a.pi,
A,this.W3b,h);return r}Z7h(b,h){const r=document.createElement("div");r.className=$c.Awh;r.id=b+$c.Bwh;var A=this.Nj.createElement("div");A.tabIndex=0;A.className=$c.x$g;A.id=b+$c.IDc;A.setAttribute(Ne.a.Ph,Ne.a.jif);A.setAttribute(Ne.a.UHa,Ne.a.fq);A.setAttribute(Ne.a.Bja,b+$c.I5b);r.appendChild(A);r.setAttribute(Ne.a.Ph,Ne.a.wA);var M=Gg.createClusteredImage(16,16,$c.F$g,$c.E$g,!0,"");A.appendChild(M);M=M.childNodes[0];M.id=b+$c.Cwh;M.className=Gg.getImageClass($c.HLe);A=new Sc(r,M,A,1);this.Wfd[b]=
A;this.rr.LI(Jd.a.click,r,this.N1e,b);A=document.createElement("span");A.className=$c.I5b;A.innerText=h;A.id=b+$c.I5b;r.appendChild(A);this.oe.LI(Jd.a.hj,r,this.cMc,b);this.oe.LI(Jd.a.pi,r,this.cMc,b);return r}static Yvi(b,h,r){if(!$c.u0e){const A=String.format('<a target="_blank" href="{0}">{1}</a>',I.a.Klc("https://office.com"),CommonUIStrings.l_Office),M=String.format('<a target="_blank" href="{0}">{1}</a>',I.a.Klc("https://office.com/webapps"),CommonUIStrings.l_WebAppName);$c.u0e=String.format(CommonUIStrings.l_NoFrames,
A,M)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',I.a.Klc(b),h,r,$c.u0e)}}$c.u0e=null;$c.HLe="CheckboxChecked_16x16x32";$c.Aaf="CheckboxUnchecked_16x16x32";$c.lPk="OutlookSearchChevronUp_16x16x32";$c.ieh="OutlookSearchChevronDown_16x16x32";$c.F$g="CommentChecked";$c.Ylk="UpArrowServer";$c.I5b="EmbedDescription";$c.TJk="EmbedSectionHeader";$c.UJk="EmbedSectionName UIFontBold";$c.cuk="EmbedCodeFooter";$c.E$g="EmbedOptionImage";$c.dHk="EmbedPreviewFrame";
$c.ksk="EmbedCodeTextArea";$c.Awh="EmbedOption";$c.rrk="EmbedDimensionSection";$c.Zlk="EmbedArrowIcon";$c.Xlk="WACGlyph EmbedArrowHolder";$c.x$g="EmbedCheckBoxHolder";$c.Bwh="Option";$c.Cwh="OptionImage";$c.Veh="EmbedCode";$c.Ueh="EmbedCodeHeader";$c.Uyh="Preview";$c.Tyh="PreviewHeader";$c.Dwh="Options";$c.f8g="Arrow";$c.IDc="Check";$c.Teh="EmbedCodeFooter";Object(u.a)($c,"EmbedDialog",ig.a,[]);class Md extends Sc{constructor(b,h,r,A,M){super(b,h,r,A);this.l$a=M}}Object(u.a)(Md,"OptionInputInfo",
Sc,[]);class xe extends $c{constructor(b,h){super(b,xe.RN);this.Vda=null;this.BFc=[];this.xMd=Object(E.a)(this,this.k$o,"startOnOptionClickHandler");this.gac=Object(E.a)(this,this.l$o,"startOnOptionKeyHandler");this.dId=Object(E.a)(this,this.XXn,"onPageNumberChanged");this.ZOe=Object(E.a)(this,this.nUn,"onDimensionChanged");this.oJ=h}ixc(){if(xe.RN){var b=xe.Rko,h=[];h.push({["id"]:"wdPrint",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.oJ.Btj,["urlTransformFunctionOnChange"]:b},{["id"]:"wdEmbedCode",
["checkboxInitialValue"]:!0,["checkboxLabel"]:this.oJ.jyj,["urlTransformFunctionOnChange"]:b},{["id"]:"wdStartOn",["checkboxInitialValue"]:!1,["checkboxLabel"]:this.oJ.VVj,["urlTransformFunctionOnChange"]:b,["textInputProps"]:{["title"]:this.oJ.XVj}});this.kTj({["dimensionsOptions"]:{["isMultipleChoice"]:!1,["defaultWidth"]:this.Pzd,["defaultHeight"]:this.j6b,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:this.oJ.M$j,["heightLabel"]:this.oJ.ZMi},["interactionOptions"]:h})}else super.ixc(),this.ILh(this.oJ.M$j,
"EmbedWidthInput",this.Pzd),this.ILh(this.oJ.ZMi,"EmbedHeightInput",this.j6b),this.fGb.appendChild(this.Z7h("wdPrint",this.oJ.Btj)),this.fGb.appendChild(this.Z7h("wdEmbedCode",this.oJ.jyj)),this.cTk(this.oJ.VVj),this.fIa(),Cd.FocusManager.nM()&&(b=Cd.FocusManager.instance(),h=[document.getElementById($c.Veh),document.getElementById("EmbedWidthInput"),document.getElementById("EmbedHeightInput"),document.getElementById($c.f8g+$c.Dwh),document.getElementById("wdPrint"+$c.IDc),document.getElementById("wdEmbedCode"+
$c.IDc),document.getElementById("wdStartOn"+$c.IDc),document.getElementById("wdStartOnText"),document.getElementById(af.a.xvd),document.getElementById($c.Tyh)],h=new Ve(h),b.au().Nk=h,Y.a.Ci?this.c4(document.getElementById(af.a.xvd)):this.UY.select())}dispose(){if(!xe.RN){if(this.BFc){for(let b=0;b<this.BFc.length;++b)mf.a.removeHandler(this.BFc[b],"change",this.ZOe);this.BFc=this.ZOe=null}this.dId&&(mf.a.removeHandler(this.Vda.l$a,"change",this.dId),this.dId=null);this.xMd&&(this.rr.xc(Jd.a.click,
this.Vda.wsc,this.xMd),this.xMd=null);this.gac&&(this.oe.xc(Jd.a.hj,this.Vda.wsc,this.gac),this.oe.xc(Jd.a.pi,this.Vda.wsc,this.gac),this.gac=null);this.Vda=null}super.dispose()}ILh(b,h,r){const A=document.createElement("label");A.className="EmbedInputPrefix";A.innerText=b;this.ECb.appendChild(A);b=document.createElement("input");b.className=h;b.id=h;b.value=r.toString();b.type="text";b.setAttribute("data-lpignore","true");A.setAttribute("for",h);this.ECb.appendChild(b);this.BFc.push(b);mf.a.addHandler(b,
"change",this.ZOe);this.ECb.appendChild(document.createElement("br"))}nUn(b){"EmbedWidthInput"===b.target.id?this.Pzd=this.y0d(b.target,375):this.j6b=this.y0d(b.target,250);this.MKg()}y0d(b,h){let r=parseInt(b.value);if(isNaN(r)||r<h)r=h;b.value=r.toString();return r}XXn(b){b=this.y0d(b.target,1);1===this.Vda.value&&this.XDe("wdStartOn",b.toString())}cTk(b){const h=document.createElement("div");h.className=$c.Awh+" EmbedInlineOption";h.id="wdStartOn"+$c.Bwh;const r=this.Nj.createElement("div");r.tabIndex=
0;r.className=$c.x$g;r.id="wdStartOn"+$c.IDc;r.setAttribute(Ne.a.Ph,Ne.a.jif);r.setAttribute(Ne.a.UHa,Ne.a.FO);r.setAttribute(Ne.a.Bja,"wdStartOn"+$c.I5b);h.appendChild(r);h.setAttribute(Ne.a.Ph,Ne.a.wA);var A=Gg.createClusteredImage(16,16,$c.F$g,$c.E$g,!0,"");r.appendChild(A);A=A.childNodes[0];A.id="wdStartOn"+$c.Cwh;A.className=Gg.getImageClass($c.Aaf);const M=document.createElement("span");M.className=$c.I5b;M.innerText=b;M.id="wdStartOn"+$c.I5b;h.appendChild(M);this.fGb.appendChild(h);b=document.createElement("input");
b.className="EmbedPageNumberInput";b.id="wdStartOnText";b.type="text";b.title=this.oJ.XVj;b.setAttribute("data-lpignore","true");this.fGb.appendChild(b);mf.a.addHandler(b,"change",this.dId);this.Vda=new Md(h,A,r,0,b);this.XDe("wdStartOn","1");this.rr.nb(Jd.a.click,h,this.xMd);this.oe.nb(Jd.a.hj,h,this.gac);this.oe.nb(Jd.a.pi,h,this.gac)}k$o(b){this.TVj(b);return!0}l$o(b){return this.V$c(b,Object(E.a)(this,this.TVj,"startOnOptionHandler"))}TVj(){let b=1;this.Vda.value?(this.Vda.value=0,this.Vda.b$a.className=
Gg.getImageClass($c.Aaf),this.Vda.Rne.setAttribute(Ne.a.UHa,Ne.a.FO)):(this.Vda.value=1,this.Vda.b$a.className=Gg.getImageClass($c.HLe),b=this.y0d(this.Vda.l$a,1),this.Vda.Rne.setAttribute(Ne.a.UHa,Ne.a.fq));this.XDe("wdStartOn",b.toString())}static get RN(){return y.AFrameworkApplication.ua.Ib.cH}static Rko(b,h,r,A=null){if("wdPrint"===h||"wdEmbedCode"===h)return $a.a.Ap(b,h,r?"1":"0");if("wdStartOn"===h){let M="1";r&&A&&(A=parseInt(A),!isNaN(A)&&1<=A&&(M=A.toString()));return $a.a.Ap(b,h,r?M:"1")}return b}}
Object(u.a)(xe,"WordEmbedDialog",$c,[]);class Nd{constructor(b,h,r,A,M){this.yia=null;this.ga=b;this.vib=h;this.GS=r;this.oJ=A;this.Vha=M}Xb(){this.ga.qa(this.GS,we.a.frame,Object(E.a)(this,this.D3o,"showEmbedCode"));this.vib.execute(Object(E.a)(this,this.ieg,"onHostPostmessengerCreated"))}ieg(b){v.ULS.shipAssertTag(4994850,332,!!b);this.yia=b;y.AFrameworkApplication.Mfa||(this.yia.Xu(C.a.UYh),this.yia.sD(C.a.UYh,Object(E.a)(this,this.ixc,"showEmbedDialog")))}ixc(b){b=b.Values.HostEmbeddedViewUrl.toString();
y.AFrameworkApplication.K5c=b;this.Vha.Yyf=b;(new xe(b,this.oJ)).ixc()}D3o(b,h,r){if(2===r)if(y.AFrameworkApplication.K5c)(new xe(this.Vha.Yyf,this.oJ)).ixc();else return y.AFrameworkApplication.wn.f$a(Nd.odk),y.AFrameworkApplication.lMg&&this.yia.sendMessage(C.a.H4l,null)?32:y.AFrameworkApplication.ua.HX(!0,y.AFrameworkApplication.VBf);return 32}}Nd.odk=10381;Object(u.a)(Nd,"EmbedActor",null,[]);class ve{}Object(u.a)(ve,"WordEmbedDialogStrings",null,[]);var Te=d(230);class qf extends Nd{constructor(b,
h){super(b,h,Fc.a.hCg,Object.assign(new ve,{M$j:WordEditorIntl.WordEditorStrings.l_Width,ZMi:WordEditorIntl.WordEditorStrings.l_Height,Btj:WordEditorIntl.WordEditorStrings.l_PrintOption,jyj:WordEditorIntl.WordEditorStrings.l_ReembedOption,VVj:WordEditorIntl.WordEditorStrings.l_StartOnOption,XVj:WordEditorIntl.WordEditorStrings.l_StartPage}),Te.WoncaApp.instance)}}Object(u.a)(qf,"EmbedActor",Nd,[]);class lf{constructor(){this.W=null}get name(){return"WordEditor.Embed"}uc(b){this.W=b;b.ia(867,()=>new qf(y.AFrameworkApplication.va,
b.Ra(7))).ha()}init(){this.W.resolve(867).Xb()}dispose(){}}Object(u.a)(lf,"EmbedPackage",null,[0,1]);class rg{constructor(b,h,r){this.lx=this.BQa=this.ISa=null;this.rQa=0;this.Q7b=this.J7b=this.w7b=this.Y7b=this.o2a=this.n2a=!1;this.Dk=b;this.Xn=r}JR(b){return qa.StaticActiveAppFrame.za().kb.isEditingAllowed?""!==this.C2c(b.If):!1}EN(b){if(!this.JR(b))return!1;this.pPo(b);this.qPo();this.rPo();this.ISa=b.gK;this.lx=new Sys.UI.Point(0,0);v.ULS.sendTraceTag(22381023,322,50,"Image Crop drag started");
return!0}IX(b){this.BQa=b.gK;this.Ugl();this.Dk.U5j(this.lx.x,this.lx.y,this.Y7b,this.w7b,this.J7b,this.Q7b,!1);return!0}IF(){this.Dk.U5j(this.lx.x,this.lx.y,this.Y7b,this.w7b,this.J7b,this.Q7b,!0);v.ULS.sendTraceTag(22381024,322,50,"Image Crop drag succeeded")}q0(){this.Dk.Ojl();v.ULS.sendTraceTag(22381025,322,50,"Image Crop drag canceled")}qPo(){this.Q7b=this.J7b=this.w7b=this.Y7b=!1;switch(this.rQa){case 1:this.Y7b=!0;break;case 5:this.w7b=!0;break;case 3:this.Q7b=!0;break;case 7:this.J7b=!0;break;
case 0:this.J7b=this.Y7b=!0;break;case 2:this.Q7b=this.Y7b=!0;break;case 6:this.J7b=this.w7b=!0;break;case 4:this.Q7b=this.w7b=!0}}rPo(){this.o2a=this.n2a=!1;switch(this.rQa){case 0:this.o2a=this.n2a=!0;break;case 1:case 2:this.o2a=!0;break;case 7:case 6:this.n2a=!0}}C2c(b){var h=b.className;-1===h.indexOf("WACImageCropHandle")&&b.parentNode&&(h=b.parentNode.className);b=h.split(" ");for(h=0;h<b.length;h++){const r=b[h].toString();if(r.startsWith("WACImageCropHandle")&&"WACImageCropHandles"!==r)return r}return""}pPo(b){switch(this.C2c(b.If)){case "WACImageCropHandleNW":this.rQa=
0;break;case "WACImageCropHandleN":this.rQa=1;break;case "WACImageCropHandleNE":this.rQa=2;break;case "WACImageCropHandleE":this.rQa=3;break;case "WACImageCropHandleSE":this.rQa=4;break;case "WACImageCropHandleS":this.rQa=5;break;case "WACImageCropHandleSW":this.rQa=6;break;case "WACImageCropHandleW":this.rQa=7}}Ugl(){var b=1;this.Xn.instance&&(b=this.Xn.instance.yj);const h=(this.BQa.x-this.ISa.x)/b;b=(this.BQa.y-this.ISa.y)/b;this.lx.x=this.n2a?-h:h;this.lx.y=this.o2a?-b:b}}Object(u.a)(rg,"ImageCropDragAdapter",
null,[93]);class ih{constructor(b,h){this.ga=b;this.Xn=h}ftm(b){return new rg(b,this.ga,this.Xn)}}Object(u.a)(ih,"ImageCropDragAdapterFactory",null,[537]);var ah=d(299),$f=d(236),De=d(34),bg=d(406),Mj=d(700),Nf=d(85),nf=d(65),Ui=d(182),dn=d(475),rl=d(880),dk=d(523),Tm=d(899),Um=d(136),Kh=d(361),Xn=d(747),zn=d(641),Yn=d(201),gm=d(81),Oh=d(16),wq=d(256),dt=d(775),ar=d(375),xm=d(118);class ei{constructor(b,h,r,A,M,aa,oa,Ja){this.o7c=null;this.hT=b;this.Oh=h;this.Qc=r;this.wv=A;this.Qd=M;this.hb=aa;this.Sn=
oa;this.sG=Ja}get WZ(){return null!=this.ESg?this.ESg:this.ESg=Za.a.instance.resolve(393)}get Wb(){return null!=this.c6g?this.c6g:this.c6g=Za.a.instance.resolve(8)}get pj(){return Um.PageReader.instance}FRo(b,h,r){const A=this.Qc.Nc(15);A.Bb(h.node);this.h_a(b,r);A.dispose()}ERo(b,h,r){const A=this.Qc.Nc(15);A.Bb(h.node);this.l_b(b,r);A.dispose()}h_a(b,h){b.setValue(He.a.imageAltText,h)}l_b(b,h){b.setValue(Mc.a.O_,h)}MRo(b,h){b.setValue(He.a.Jrb,h)}yMj(b,h){if(Object(Ui.d)(b)){const r=b.ka(De.a.Oke,
null);h=dt.a.bGl(h,r);b.setValue(De.a.Oke,h)}else b.setValue(Mc.a.P_,h)}IRo(b,h,r,A,M){let aa=0;var oa=0;({width:aa,height:oa}=Uc.ImageReader.a9a(b));oa-=(h+r)/1E5*oa;this.PNa(b,aa-(A+M)/1E5*aa);this.ONa(b,oa);this.OMj(b);b.setValue(Mc.a.$$d,h);b.setValue(Mc.a.X$d,r);b.setValue(Mc.a.Y$d,A);b.setValue(Mc.a.Z$d,M)}IVo(b,h,r,A){const M=this.Qc.Nc(15);M.Bb(h.node);this.owe(b,r,A);M.dispose()}owe(b,h,r){this.PNa(b,h);this.ONa(b,r);this.OMj(b);b.removeProperty(pd.a.npe);b.removeProperty(pd.a.mpe)}PNa(b,
h){b.setValue(He.a.Kta,h);b.setValue(pd.a.NKa,-1)}ONa(b,h){b.setValue(He.a.Jta,h);b.setValue(pd.a.MKa,-1)}rH(b,h){b.setValue(Mc.a.Blc,h);b.setValue(He.a.si,h);b.setValue(He.a.Bs,h)}wWo(b,h){b.setValue(Mc.a.xzb,h)}rOo(b,h){b.setValue(Mc.a.HSd,h)}BWo(b){if(!Uc.ImageReader.t7(b)&&b.Al){var h=b.node;if(Uc.ImageReader.Zaa(h)){const M=this.Qc.Nc(15);M.Bb(b.node);b=vd.a.Za(h);b.vb(12);b=b.parentNode;var r=b.properties.wf(Mc.a.Gq),A=h.properties.getValue(Mc.a.runId);h.ka(Mc.a.Yc,Ml.a.wV);const aa=b.ra;if(!y.AFrameworkApplication.J||
!y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveAnchoredProperties",!1)){const oa=[Mc.a.Blc,He.a.si,He.a.Bs,Mc.a.HSd,Mc.a.xzb,Mc.a.qTa];Object(Ui.d)(h)&&oa.push(De.a.s9d,De.a.r9d);h.Uf.apply(h,oa)}r=this.sHf(A,r,aa);A=wc.a.Tc(b,r);this.wv.k6h(h,A);(h=this.sG.cL(b,r,r+1))&&this.hb.Kc(h);this.WZ.jva(b,r,r+1);M.dispose()}}}Ixg(b,h){if(b.properties.hasProperty(Mc.a.i6)){const r=b.properties.wf(Mc.a.i6);r.push(h);b.properties.setValue(Mc.a.i6,Array.clone(r))}else b.properties.setValue(Mc.a.i6,
[h])}zxe(b,h,r=0,A=!1){if(b.Al){var M=this.Qc.Nc(15),aa=b.node;M.Bb(aa);if(Uc.ImageReader.t7(b)){const Cb=Object(Ui.c)()?new Tm.a:new dk.a;Cb.Yt(Uc.ImageReader.Kn(b));var oa=aa.ra,Ja=this.y6l(b.cpBegin,oa);this.L7k(b.cpEnd,oa,Ja)&&v.ULS.sendTraceTag(594392136,322,50,"[ImageEditor][SetToAnchor]Comment will be lost");oa=oa.K(Ja).blob;Ja=oa.pe;var fb=aa.properties.wf(Mc.a.Gq);fb=this.qko(fb);Ja=fb[Ja];fb=aa.ka(Mc.a.Yc,Ml.a.wV);if(oa=Object(ya.a)(rl.a,oa))oa.U_b=!1;this.Qd.Ve(b,"");oa&&(oa.U_b=!0);Cb.properties.setValue(Mc.a.runId,
Ja);Cb.properties.setValue(Mc.a.Yc,fb);b=vd.a.Za(aa);b.vb(12);b.Vf(Cb,6);this.Ixg(b.currentNode,Cb.anchor.node.id);aa=Cb}r&&this.rH(aa.properties,r);this.rOo(aa.properties,A);this.wWo(aa.properties,h);this.WZ.iwc(aa);(h=this.sG.Gr(aa))&&this.hb.Kc(h);M.dispose()}}Jvg(b,h){if(!(0>=h)){var r=Ah.a.qn(h,0),A=Uc.ImageReader.RB(b),M=Uc.ImageReader.$C(b);A>r&&(M*=r/A,this.PNa(b,r),this.ONa(b,M),v.ULS.sendTraceTag(37843205,322,50,"Scale image width and height to fit constraining width {0} : ",h))}}L7k(b,
h,r){const A=h.length;if(r>=A||!h.K(r).lf)return!1;const M=new bp.a;for(;r<A;r++){const aa=h.K(r);if(aa.cp>b||!aa.lf)break;for(let oa=0;oa<aa.lf.length;oa++){if(M.contains(aa.lf.K(oa).lk))return!0;M.add(aa.lf.K(oa).lk)}}return!1}qko(b){for(var h=0;h<b.length&&!b[h];)h++;if(h===b.length)for(var r=0;r<b.length;)b[r]=r+1,r++;else{var A=b[h];r=h-1;for(var M=A-1;0<=r;)b[r]=M,r--,M--;M=0;for(r=h+1;r<b.length;)(h=b[r])?h<A?(A=h+M,b[r]=A):A=h:(M+=2,A++,b[r]=A),r++}return b}FCf(b,h){let r=0;for(;r<h.length&&
!(b<h[r]);)r++;return r}sHf(b,h,r){let A=0;const M=this.FCf(b,h);let aa=0;if(M===h.length)aa=r.length-1;else for(;aa<r.length;){h=r.K(aa);if(h.formatting&&h.formatting.pe===M)break;aa++}aa<r.length?A=r.K(aa).cp:v.ULS.sendTraceTag(21248159,322,15,"GetCpForRunId index out of bound. {0}",{["Index"]:aa,["RunId"]:b,["CharacterPropertiesArrayLength"]:r.length});return A}y6l(b,h){let r=0;for(;r<h.length&&h.K(r).cp!==b;)r++;r===h.length&&v.ULS.sendTraceTag(21248160,322,15,"FindImageBlobIndexInCharacterPropertiesArray index out of bound. {0}",
{["Index"]:r,["CharacterPropertiesArrayLength"]:h.length});return r}OMj(b){b.setValue(He.a.TBa,!0)}Npe(b,h,r,A=!1){h&&r?(h=Math.max(h,Mj.a.Gcj),r=Math.max(r,Mj.a.Gcj)):r=h=Mj.a.Nbi;b.setValue(He.a.Kta,Ah.a.qn(h,0));b.setValue(He.a.Jta,Ah.a.qn(r,1));b.setValue(He.a.imageAltText,Box4Intl.Box4Strings.l_PastedImageLoading);b.setValue(wb.a.Q_,ic.a.hPa);b.setValue(Mc.a.Kla,A)}ebe(){return null}Gfi(b,h,r){let A=null;h=({CVb:A}=this.Hfi(b,h,r)).returnValue;A&&b.view.mb.Kc(A);return h}Hfi(b,h,r){var A=null;
if(!this.Lja(b))return{returnValue:null,CVb:A};var M=b.view;const aa=this.Qc.Nc(15,ub.a.RRb);aa.Bb(M.od);h||(h=new wg.DictionaryPropertySet);h.setValue(pd.a.DVl,!0);let oa=M.mb.Mg;var Ja=new zn.a;if(!ze.a.pf(oa)){if(2===y.AFrameworkApplication.va.Ob(ub.a.Ira,2))return aa.dispose(),{returnValue:null,CVb:A};oa=M.mb.Mg}else if(oa.Al&&Gd.ParagraphReader.Vb(oa.node)){Of.a.ud().Co&&Of.a.ud().Ak.xG(oa.node);M=Wa.FormattingReader.Rs(oa);if(!M)return aa.dispose(),{returnValue:null,CVb:A};M.cache.mE&&(M=M.Bf(null),
ei.im.l8(M));Ja.formatting=M.Ek;Ja.languageId=Wa.FormattingReader.language(M);Ja.goa=this.Wb.Aq(oa.node)}if(!oa.Al)return aa.dispose(),{returnValue:null,CVb:A};if(!this.SUf(b.Ik,h))return aa.dispose(),this.o7c=null,{returnValue:null,CVb:A};b=this.o7c;this.o7c=null;1===b.location?(A=b.node,h=ar.a.instance.kOf(A),Bb.OutlineElementNavigator.Zs(h,!1,!1)||(Yn.OutlineNavigator.uue(h),this.hT.yja(h,!0,Ja)),Bb.OutlineElementNavigator.Me(h),Ii.TableReader.isTable(h)&&(Object(Xa.a)(xm.a,h)||Object(Xa.a)(Kh.a,
h)?(Ja=new vd.a,Ja.set(h.currentNode),Oh.moveToCellContent(Ja,0,0),h.set(Ja.currentNode)):Oh.moveToCellContent(h,0,0),Db.OutlineElementReader.Nh(h)?Bb.OutlineElementNavigator.Me(h):h=ar.a.instance.kOf(A)),A=Gd.ParagraphReader.xu(h.currentNode)?this.sG.ue(h.currentNode,0):this.sG.Gr(h.currentNode)):b.location||(Ja=b.blob.Jb.cp+1,A=this.sG.cL(b.node,Ja-1,Ja));aa.TLa(r,1);aa.Ii=ub.a.RRb;aa.dispose();return{returnValue:b,CVb:A}}SUf(){return!1}Lja(b){b.contextId===lc.a.view&&b.view.te&&b.view.mb&&(b=b.view.mb.Mg);
if(!b)return ei.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.ao}),!1;if(ei.rg.q2(b))return ei.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.IG}),!1;if(ei.rg.Nla(b))return ei.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.iRi}),!1;if(this.Sn&&this.Sn.instance&&this.Sn.instance.sX(b))return ei.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.b8a}),!1;if(this.pj.p7)return ei.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.compatMode}),!1;if(b.Al)return gm.OutlineReader.fee(b)?(ei.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.zqf}),!1):Uc.ImageReader.cde(b)?(ei.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.rqf}),
!1):wq.c(b)?(ei.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.sqf}),!1):Xn.a.SXf(b)?(ei.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.qqf}),!1):Gd.ParagraphReader.qX(b)||Uc.ImageReader.Zan(b)?(ei.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.QQ}),!1):!0;if(dn.a.fZf(b)){let h=!0;for(let r=0;r<b.length;++r){const A=b.getContext(r);if(!A.Al)return!1;h&&!Gd.ParagraphReader.qX(A)&&(h=!1)}return h?(ei.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.QQ}),!1):!0}return!1}fBj(b,h){const r=this.Qc.Nc(7);r.Bb(b);if(12===b.type){h=h.Jb.cp;var A=Gd.ParagraphReader.textLength(b);
A=wc.a.UT(h,h+1,h+1===A?!0:!1,b);this.Qd.Ve(A,"");b=wc.a.Tc(b,h);this.hb.Kc(sc.SelectionFactory.Qo(b))}else this.Oh.mNa(b);r.dispose()}static get im(){return null!=ei.pWg?ei.pWg:ei.pWg=Za.a.instance.resolve(101)}static get rg(){return re.a.instance}static get Dc(){return Rg.a.instance}}Object(u.a)(ei,"ImageEditor",null,[539]);class Ot{constructor(b,h,r,A=0){this.node=b;this.blob=h;this.location=r;this.kX=A}}Object(u.a)(Ot,"InsertPictureResult",null,[]);var uo=d(824),$r=d(280),or=d(559),Zi=d(111),
xt=d(514),wk;(function(b){b[b.other=0]="other";b[b.Drj=1]="picture"})(wk||(wk={}));Object(u.b)("ImageType",wk);var pr=d(1122);class Pt extends ei{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc){var zc,Yc;super(b,h,r,A,M,aa,oa,Ja);this.sqk="WACImageCropHandleNW WACImageCropHandleN WACImageCropHandleNE WACImageCropHandleW WACImageCropHandleE WACImageCropHandleSW WACImageCropHandleS WACImageCropHandleSE".split(" ");this.ihb="WACImageCropInnerHandleTop WACImageCropInnerHandleTopBorder WACImageCropInnerHandleBottom WACImageCropInnerHandleBottomBorder WACImageCropInnerHandleLeft WACImageCropInnerHandleLeftBorder WACImageCropInnerHandleRight WACImageCropInnerHandleRightBorder".split(" ");
this.xM=this.gRa=this.HFa=null;this.Goa=Array(8);this.CCd=this.eGa=null;this.hRa=!1;this.BCd=this.wUe=null;this.jyd=this.uzd=!1;this.$V=this.ZV=this.YV=this.aW=this.PY=this.OY=this.NY=this.QY=this.kZ=this.lZ=0;this.tP=()=>{this.hRa&&this.vzf()};this.GCa=Kd=>{this.hRa&&Kd.Nb.keyCode!==cf.a.Nu&&this.vzf(!0);return!1};this.Okh=pc;aa.tA(this.tP);this.oe=Sb;this.n5=ah.a.instance;this.ga=y.AFrameworkApplication.va;this.Yd=Cb;this.Oq=fb;this.bWf=null!==(Yc=null===(zc=y.AFrameworkApplication.J)||void 0===
zc?void 0:zc.getBooleanFeatureGate("Microsoft.Office.WordOnline.AppendSpacersToDataUrlForSafari",!1))&&void 0!==Yc?Yc:!1}Fwe(b,h,r,A,M){b.hasProperty(pd.a.SXa)&&b.removeProperty(pd.a.SXa);const aa=Array(4);aa[Zi.a.left]=h;aa[Zi.a.right]=r;aa[Zi.a.top]=A;aa[Zi.a.bottom]=M;b.setValue(Mc.a.Ega,aa)}gvo(b){b.setValue(Mc.a.PKa,xt.a.lbg);b.setValue(Mc.a.hXb,"");this.Fwe(b,0,0,0,0)}Cyg(b,h,r,A,M){b.setValue(Mc.a.$$d,h);b.setValue(Mc.a.X$d,r);b.setValue(Mc.a.Y$d,A);b.setValue(Mc.a.Z$d,M)}Hwe(b,h,r,A){b.setValue(Mc.a.lX,
h);b.setValue(Mc.a.iRf,r);b.setValue(Mc.a.FRf,A);b.setValue(pd.a.lX,-1)}cbe(b,h){b=b.node;const r=vd.a.Za(b);if(Gd.ParagraphReader.Vb(b)&&Gd.ParagraphReader.isEmpty(r)){var A=b.properties.wf(Mc.a.Yc);h.setValue(Mc.a.Yc,A);h.setValue(Mc.a.runId,1);A=new pr.a;h&&A.Yt(h);r.Vf(A,6);this.Ixg(b,A.anchor.node.id);this.WZ.iwc(A);return new Ot(A,null,3)}return null}ebe(b,h){var r=uo.a.instance.Iud;h&&r.Yt(h);r.setValue(Mc.a.imageType,wk.Drj);let A=0;A=$f.a.OF();r.setValue(Mc.a.kX,A);const M=b.node.Ic.ku(r,
r.id);r=this.Qd.yla(b,aa=>new rl.a(aa,M));$r.a.instance.Rdg(b.node);if(this.Yd.Lg){const aa=new Rb.GraphTransaction(15);aa.Bb(b.node);this.Oq.sna(b.node,b.cpBegin,b.cpBegin+1,1,null);aa.dispose()}this.WZ.ITa&&!h.ka(Mc.a.Kla,!1)&&this.WZ.jva(b.node,b.cpBegin,b.cpBegin+1);return new Ot(b.node,r,0,A)}SUf(b,h){if(!this.Lja(b))return!1;const r=this.Qc.Nc(7);r.Bb(b.node);y.AFrameworkApplication.J.$("ContentAppIsEnabled")&&h.ka(Mc.a.wTi,!1)?this.o7c=this.cbe(b,h):this.o7c=this.ebe(b,h);r.dispose();return!0}Cuc(b,
h,r,A){if(!r.Vb(b))return!1;r=this.Qc.Nc(7,ub.a.TQm);r.Bb(b);var M=b.properties.ka(He.a.vn,[]);M.push(0);for(const aa of M)if((M=A.bGf(b,aa))&&5===M.Qh&&M.id.equals(h))return this.Qd.Ve(wc.a.createTextRange(b,aa,aa+1),""),r.dispose(),!0;r.dispose();v.ULS.sendTraceTag(588817112,3001,10,"RemoveInlineImageFromParagraph: Failed to remove image.");return!1}uuo(b,h,r,A){if(!Uc.ImageReader.Zaa(b))return!1;h.set(b);h.vb(12);const M=h.rp(12);if(!M)return v.ULS.sendTraceTag(588817114,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image because unable to acquire containing graph node."),
!1;if(r.w9c(M))return v.ULS.sendTraceTag(588817115,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image."),!1;A(b);r=this.Qc.Nc(7);r.Bb(b);h.Rg();r.dispose();return!0}uAo(b,h,r,A){return Uc.ImageReader.A$a(b)?this.hAo(b,r):Uc.ImageReader.t7(b)?this.yAo(b,h,r,A):null}yAo(b,h,r,A){const M=uo.a.instance.Iud;r&&M.Yt(r);r=0;r=$f.a.OF();M.setValue(Mc.a.kX,r);r=b.node.Ic;b=b.node;A=A.p1c(b,5);for(const aa of A)if(aa.id.equals(h)){this.Qd.Ve(wc.a.createTextRange(b,aa.Jb.cp,aa.Jb.cp+
1),"");const oa=r.ku(M,M.id);h=wc.a.Tc(b,aa.Jb.cp);this.Qd.yla(h,Ja=>new rl.a(Ja,oa));return M}return null}hAo(b,h){if(!Uc.ImageReader.A$a(b))return null;h.setValue(Mc.a.kX,$f.a.OF());b=b.node;var r=b.anchor.node.id;b=vd.a.Za(b);b.vb(12);const A=b.parentNode;let M;A.properties.hasProperty(Mc.a.i6)?(M=A.properties.wf(Mc.a.i6),r=N.a.indexOf(M,r),-1!==r&&Array.removeAt(M,r)):M=[];A.properties.setValue(Mc.a.i6,Array.clone(M));b.Rg();r=Object(Ui.c)()?new Tm.a:new dk.a;r.Yt(h);b.Vf(r,6);this.Ixg(A,r.anchor.node.id);
return r}brd(b,h){this.hRa?this.vzf():this.Q9o(b,h)}ORo(b,h){b.setValue(pd.a.lX,h)}jtm(b){let h=null,r=null;if(!b)return v.ULS.sendTraceTag(22381026,322,15,"Unable to obtain Image Element Container for Crop due to null Context."),{returnValue:null,view:h,Dj:r};if(!Object(Lb.a)().Ad)return v.ULS.sendTraceTag(22381027,322,15,"Unable to obtain Image Element Container for Crop due to null SelectionView."),{returnValue:null,view:h,Dj:r};const A=b.node;if(!A)return v.ULS.sendTraceTag(22381056,322,15,"Unable to obtain Image Element Container for Crop due to null Context Node."),
{returnValue:null,view:h,Dj:r};r=A.Ic;var M=Object(Lb.a)().Ad.pc;M=A.Be(M);if(!M)return v.ULS.sendTraceTag(23961792,322,15,"Unable to obtain Image Element Container for Crop due to null Html View Element."),{returnValue:null,view:h,Dj:r};h=M.uh;if(b.Al&&Uc.ImageReader.t7(b)){b=Uc.ImageReader.lKa(b);if(!b)return v.ULS.sendTraceTag(22381057,322,15,"Unable to obtain Image Element Container for Crop due to null Blob from Context."),{returnValue:null,view:h,Dj:r};b=b.TAa(h,M);if(!b)return v.ULS.sendTraceTag(22381058,
322,15,"Unable to obtain Image Element Container for Crop due to null Presenter from Blob."),{returnValue:null,view:h,Dj:r};b=b.element}else if(Uc.ImageReader.It(A))b=M.htmlElement;else return v.ULS.sendTraceTag(22381059,322,15,"Unable to obtain Image Element Container for Crop due to context not being Image blob nor Image node."),{returnValue:null,view:h,Dj:r};return{returnValue:b,view:h,Dj:r}}aYo(b){for(let A=0;A<this.Goa.length;A++){this.Goa[A]=b.rl(Lo.a.span);this.Goa[A].className="WACImageCropHandles "+
this.sqk[A];if(2>=A){var h=b.rl(Lo.a.span);h.className=this.ihb[0];var r=b.rl(Lo.a.span);r.className=this.ihb[1];this.Goa[A].appendChild(h);this.Goa[A].appendChild(r)}else 4<A&&(h=b.rl(Lo.a.span),h.className=this.ihb[2],r=b.rl(Lo.a.span),r.className=this.ihb[3],this.Goa[A].appendChild(h),this.Goa[A].appendChild(r));if(!A||3===A||5===A)h=b.rl(Lo.a.span),h.className=this.ihb[4],r=b.rl(Lo.a.span),r.className=this.ihb[5],this.Goa[A].appendChild(h),this.Goa[A].appendChild(r);else if(2===A||4===A||7===
A)h=b.rl(Lo.a.span),h.className=this.ihb[6],r=b.rl(Lo.a.span),r.className=this.ihb[7],this.Goa[A].appendChild(h),this.Goa[A].appendChild(r)}}Q9o(b,h){v.ULS.sendTraceTag(22381060,322,50,"Starting Image Cropping Mode.");if(this.hRa)v.ULS.sendTraceTag(22381061,322,100,"Attempted to start Crop Mode when it was already On.");else{var r=null,A=null;if((this.eGa=({view:r,Dj:A}=this.jtm(h)).returnValue)&&r){this.eGa.classList.add("ImageCropMode");this.HFa=r.rl(Lo.a.div);this.HFa.className="WACImageCropMode";
this.gRa=r.rl(Lo.a.Trb);this.gRa.className="WACImageCropBase";this.xM=r.rl(Lo.a.span);this.xM.className="WACImageCropSrcRect";this.aYo(r);this.HFa.appendChild(this.xM);for(r=0;r<this.Goa.length;r++)this.xM.appendChild(this.Goa[r]);this.HFa.appendChild(this.gRa);this.gRa.style.visibility="";this.gRa.style.display="";this.eGa.appendChild(this.HFa);this.$$n(b);A=Uc.ImageReader.SAa(b,A);r=Uc.ImageReader.a9(b,pd.a.Y7,null);this.gRa.src=r?this.bWf&&Y.a.wta?Object(or.a)(r):r:Uc.ImageReader.c9a(A);this.Okh&&
this.Okh.execute(M=>{this.CCd||(this.CCd=M.ftm(this))});this.uzd||(this.n5.gS(this.eGa,this.CCd),this.uzd=!0);this.oe&&this.oe.nb(Jd.a.TK,Object(Lb.a)().Le.editingElement,this.GCa);this.hRa=!0;this.wUe=b;this.BCd=h;this.jyd=!1;b=new Rb.GraphTransaction(4);b.Bb(this.BCd.node);this.wUe.setValue(pd.a.NBa,this.hRa);b.dispose()}else v.ULS.sendTraceTag(22381062,322,15,"Unable to start Crop Mode because unable to obtain Image Element Container from given Context.")}}$$n(b){const h=Ah.a.xf(Uc.ImageReader.RB(b),
0),r=Ah.a.xf(Uc.ImageReader.$C(b),1);var A=Uc.ImageReader.ifa(b);const M=Math.max(A.top,0),aa=Math.max(A.bottom,0),oa=Math.max(A.left,0);A=Math.max(A.right,0);this.lZ=1E5*h/(1E5-(oa+A));this.kZ=1E5*r/(1E5-(M+aa));this.QY=Math.floor(M*this.kZ/1E5);this.NY=Math.floor(aa*this.kZ/1E5);this.OY=Math.floor(oa*this.lZ/1E5);this.PY=Math.floor(A*this.lZ/1E5);this.xM.style.top=this.QY+"px";this.xM.style.bottom=this.NY+"px";this.xM.style.left=this.OY+"px";this.xM.style.right=this.PY+"px";this.gRa.style.width=
this.lZ+"px";this.gRa.style.height=this.kZ+"px";Uc.ImageReader.Vz(b)&&(this.HFa.style.width=this.lZ+"px",this.HFa.style.height=this.kZ+"px");this.aW=this.QY;this.YV=this.NY;this.ZV=this.OY;this.$V=this.PY}vzf(b=!1){v.ULS.sendTraceTag(22381063,322,50,"Ending Image Cropping Mode.");this.hRa?(b||this.Gul(),this.gRa?Fd.a.lF(this.gRa):v.ULS.sendTraceTag(23961793,322,15,"Unable to clear imageCropBase dom element because it was already null."),this.eGa?(this.HFa?this.HFa.parentNode===this.eGa?this.eGa.removeChild(this.HFa):
v.ULS.sendTraceTag(24174606,322,15,"Unable to Remove child divImageCropMode from imageElementContainer, because it was no longer a child of it."):v.ULS.sendTraceTag(23961794,322,15,"Unable to clear Crop mode div because it was already null."),this.eGa.classList.remove("ImageCropMode"),this.hRa=!1,b=new Rb.GraphTransaction(4),b.Bb(this.BCd.node),this.wUe.setValue(pd.a.NBa,this.hRa),b.dispose(),this.uzd&&(this.n5.zS(this.eGa,this.CCd),this.uzd=!1),this.oe&&this.oe.xc(Jd.a.TK,Object(Lb.a)().Le.editingElement,
this.GCa),this.eGa=this.HFa=null):v.ULS.sendTraceTag(22381065,322,15,"Unable to finish Image Crop clean-up because unable to obtain Image Element Container from Context.")):v.ULS.sendTraceTag(22381064,322,100,"Attempted to End Image Crop Mode when it was already off.")}U5j(b,h,r,A,M,aa,oa){if(r){r=Math.max(this.QY-h,0);const Ja=Math.floor(this.kZ)-this.NY-r;5<=Ja?(this.aW=r,this.YV=this.NY):5>Ja&&0<=Ja||0>Ja&&!this.NY?(this.aW=r-(5-Ja),this.YV=this.NY):0>Ja&&5>=Math.abs(Ja)?(this.aW=Math.floor(this.kZ)-
this.NY,this.YV=Math.max(this.NY-(r-(this.kZ-this.NY))-(5-Math.abs(Ja)),0)):(this.aW=Math.floor(this.kZ)-this.NY,this.YV=Math.max(this.NY-(r-(this.kZ-this.NY)),0));this.xM.style.top=this.aW+"px";this.xM.style.bottom=this.YV+"px";oa&&(this.QY=this.aW,this.NY=this.YV)}A&&(h=Math.max(this.NY-h,0),A=Math.floor(this.kZ)-this.QY-h,5<=A?(this.YV=h,this.aW=this.QY):5>A&&0<=A||0>A&&!this.QY?(this.YV=h-(5-A),this.aW=this.QY):0>A&&5>=Math.abs(A)?(this.YV=Math.floor(this.kZ)-this.QY,this.aW=Math.max(this.QY-
(h-(this.kZ-this.QY))-(5-Math.abs(A)),0)):(this.YV=Math.floor(this.kZ)-this.QY,this.aW=Math.max(this.QY-(h-(this.kZ-this.QY)),0)),this.xM.style.top=this.aW+"px",this.xM.style.bottom=this.YV+"px",oa&&(this.QY=this.aW,this.NY=this.YV));M&&(M=Math.max(this.OY-b,0),h=Math.floor(this.lZ)-this.PY-M,5<=h?(this.ZV=M,this.$V=this.PY):5>h&&0<=h||0>h&&!this.PY?(this.ZV=M-(5-h),this.$V=this.PY):0>h&&5>=Math.abs(h)?(this.ZV=Math.floor(this.lZ)-this.PY,this.$V=Math.max(this.PY-(M-(this.lZ-this.PY))-(5-Math.abs(h)),
0)):(this.ZV=Math.floor(this.lZ)-this.PY,this.$V=Math.max(this.PY-(M-(this.lZ-this.PY)),0)),this.xM.style.left=this.ZV+"px",this.xM.style.right=this.$V+"px",oa&&(this.OY=this.ZV,this.PY=this.$V));aa&&(b=Math.max(this.PY-b,0),aa=Math.floor(this.lZ)-this.OY-b,5<=aa?(this.$V=b,this.ZV=this.OY):5>aa&&0<=aa||0>aa&&!this.OY?(this.$V=b-(5-aa),this.ZV=this.OY):0>aa&&5>=Math.abs(aa)?(this.$V=Math.floor(this.lZ)-this.OY,this.ZV=Math.max(this.OY-(b-(this.lZ-this.OY))-(5-Math.abs(aa)),0)):(this.$V=Math.floor(this.lZ)-
this.OY,this.ZV=Math.max(this.OY-(b-(this.lZ-this.OY)),0)),this.xM.style.left=this.ZV+"px",this.xM.style.right=this.$V+"px",oa&&(this.OY=this.ZV,this.PY=this.$V));oa&&(this.jyd=!0,qa.StaticActiveAppFrame.za().Fe())}Ojl(){this.aW=this.QY;this.YV=this.NY;this.ZV=this.OY;this.$V=this.PY;this.xM.style.top=this.aW+"px";this.xM.style.bottom=this.YV+"px";this.xM.style.left=this.ZV+"px";this.xM.style.right=this.$V+"px"}Gul(){if(this.jyd){v.ULS.sendTraceTag(22381066,322,50,"Commiting new Image Cropping Properties.");
var b=Math.floor(1E5*this.QY/this.kZ),h=Math.floor(1E5*this.NY/this.kZ),r=Math.floor(1E5*this.OY/this.lZ),A=Math.floor(1E5*this.PY/this.lZ),M=new wg.DictionaryPropertySet;M.setValue(pd.a.Srb,b);M.setValue(pd.a.Prb,h);M.setValue(pd.a.Qrb,r);M.setValue(pd.a.Rrb,A);this.ga.Nf(this.BCd,Fc.a.DOi,2,!1,null,M)}else v.ULS.sendTraceTag(23070481,322,50,"No New Cropping Properties To Commit.")}NBa(){return this.hRa}Ulm(){return{top:this.aW,bottom:this.YV,left:this.ZV,right:this.$V}}Wtp(b,h){if(0>b)v.ULS.sendTraceTag(22552777,
322,15,"Unexpected negative value for new Crop properties.");else{switch(h){case 0:this.QY=this.aW=Math.min(Math.floor(this.kZ)-this.YV-5,b);this.xM.style.top=this.aW+"px";break;case 1:this.NY=this.YV=Math.min(Math.floor(this.kZ)-this.aW-5,b);this.xM.style.bottom=this.YV+"px";break;case 2:this.OY=this.ZV=Math.min(Math.floor(this.lZ)-this.$V-5,b);this.xM.style.left=this.ZV+"px";break;case 3:this.PY=this.$V=Math.min(Math.floor(this.lZ)-this.ZV-5,b),this.xM.style.right=this.$V+"px"}this.jyd=!0}}}Object(u.a)(Pt,
"ImageEditor",ei,[538,539]);class as{constructor(){this.W=null}get name(){return"WordEditor.ImageEditors"}uc(b){this.W=b;this.W.ia("WordEditor.ImageEditors.ImageCropDragAdapterFactory",()=>new ih(y.AFrameworkApplication.va,Za.a.instance.Ra(6))).as(869).ha();this.W.ia("WordEditor.ImageEditors.ImageEditor",()=>new Pt(b.resolve(110),b.resolve(18),b.resolve(42),b.resolve(348),b.resolve(322),b.resolve(326),b.Ra(51),b.resolve(868),b.resolve(39).instance,b.resolve(46).instance,b.resolve(393),Xb.KeyInputManager.instance,
b.Ra(869))).as(1020).as(820).ha()}init(){this.W.resolve(869)}dispose(){}static main(){K.a.instance.Lc(new as)}}Object(u.a)(as,"WordEditorImageEditorsPackage",null,[0,1]);class Vo{}Object(u.a)(Vo,"FolderContentEditor",null,[1452]);class Ss{}Object(u.a)(Ss,"PageEditor",null,[1584]);class Qt extends Ss{constructor(){super()}}Object(u.a)(Qt,"PageEditor",Ss,[]);class Rq{get name(){return"WordEditor.NotebookLevelEditors"}uc(b){b.ia("Box4.NotebookLevelEditors.FolderContentEditor",()=>new Vo).as("Box4.Folder.IFolderContentEditor").ha();
b.ia("WordEditor.NotebookLevelEditors.PageEditor",()=>new Qt).as(394).ha()}init(){}dispose(){}static main(){K.a.instance.Lc(new Rq)}}Object(u.a)(Rq,"WordEditorNotebookLevelEditorsPackage",null,[0,1]);class Su{get EXb(){return y.AFrameworkApplication.privacyUrl}pza(){v.ULS.sendTraceTag(37034014,342,50,"User clicked on the Privacy statement.");Le.a.un(this.EXb,"_blank",void 0,"SendUsYourFileDialog.PrivacyLink");return!0}}Object(u.a)(Su,"PrivacyLinkHandler",null,[104]);class ys{constructor(b,h){this.g1e=
null;this.lKk=b;this.kKk=h}showDialog(b){this.g1e=b;this.kKk.create().mi(Object(E.a)(this,this.vSm,"handleDialog"))}vSm(b){1===b&&this.lKk.bKj();this.g1e();this.g1e.prototype}}Object(u.a)(ys,"SendUsYourFileController",null,[72]);class dg extends ni.StandardDialog{constructor(b,h,r){super();this.L9b=null;this.Dg=b;this.cNc=h;this.oJ=r}mi(b){this.Fd=1;this.Qe(1,this.oJ.send);this.Qe(0,this.oJ.TNn);v.ULS.shipAssertTag(37034013,342,!this.L9b,"privacy anchor should be null before initializing it.");const h=
this.dialogContent();this.zub(this.oJ.m4k,null,"CancelRequest_32x32x32",null,b,h);this.t8(this.Bj(dg.jKj))}dialogContent(){const b=document.createElement("span");b.innerText=this.oJ.kdo;const h=document.createElement("span");h.innerText=this.oJ.rfp;h.style.fontWeight=this.oJ.Czp;const r=document.createElement("span");r.innerText=this.oJ.WMo;const A=this.Kwl(),M=document.createElement("span");M.id=this.Bj(dg.jKj);M.appendChild(b);M.appendChild(document.createElement("br"));M.appendChild(document.createElement("br"));
M.appendChild(h);M.appendChild(document.createElement("br"));M.appendChild(r);M.appendChild(document.createElement("br"));M.appendChild(document.createElement("br"));M.appendChild(document.createElement("br"));M.appendChild(A);return M}Kwl(){const b=document.createElement("span"),h=document.createElement("a");h.innerText=this.oJ.Sco;h.href=this.cNc.EXb||"";b.appendChild(h);this.L9b=h;this.Dg.nb(Jd.a.click,this.L9b,Object(E.a)(this.cNc,this.cNc.pza,"clickHandler"));return b}dispose(){this.L9b&&(this.Dg.xc(Jd.a.click,
this.L9b,Object(E.a)(this.cNc,this.cNc.pza,"clickHandler")),this.L9b=null);super.dispose()}}dg.jKj="sendUsYourFileId";Object(u.a)(dg,"SendUsYourFileDialog",ni.StandardDialog,[103]);class yt{create(){return Za.a.instance.resolve(870)}}Object(u.a)(yt,"Factory",null,[102]);var sl=d(510);class pn extends sl.a{constructor(){super();this.FileId=null}$m(){return 38}static construct(b){const h=new pn;h.FileId=b;return h}}Object(u.a)(pn,"CreateSendUsYourFileRequest",sl.a,[]);var Om=d(834);class xq{constructor(b,
h,r){this.Y0=b;this.ZS=h;this.UBk=r}bKj(b=!1){if(this.ZS){const h=pn.construct(this.ZS()),r=new Om.a;r.Wq=h;r.status=1;r.vE="BootErrorReport";b=b?this.Y0(null):this.Y0(A=>{this.Skd(r,A)});b.CG(r);b.g_();this.UBk()}}Skd(b){5===b.statusCode&&this.bKj(!0)}}Object(u.a)(xq,"SendUsYourFileManager",null,[71]);class Jr{constructor(b,h){this.W=null;this.oJ=b;this.ZS=h}uc(b){this.W=b;this.W.ia(871,()=>this.oJ).ha();this.W.ia(870,()=>new dg(Qc.a.instance,new Su,this.W.resolve(871)));this.W.ia(872,()=>new xq(h=>
this.Eaa(0,h),this.ZS,()=>{v.ULS.sendTraceTag(42022664,342,50,"send us your file request is now sent.")}));this.W.ia(442,()=>{const h=new yt;return new ys(this.W.resolve(872),h)}).ha()}init(){this.W.resolve(442)}dispose(){}}Object(u.a)(Jr,"SendUsYourFilePackageManager",null,[]);var qr=d(521),Tu=d(1004);class Wi{get m4k(){return CommonUIStrings.l_AppTitle}get send(){return CommonUIStrings.l_Send}get TNn(){return CommonUIStrings.l_NoThanks}get kdo(){return WordEditorIntl.WordEditorStrings.L_ProblemOpeningDocument}get rfp(){return WoncaIntl.WoncaStrings.l_SaveErrorReportTitle}get Czp(){return CommonUIStrings.l_UserInterfaceFontWeightBold}get WMo(){return WordEditorIntl.WordEditorStrings.L_SendUsYourFileDialogText}get Sco(){return CommonUIStrings.l_PrivacyStatement}}
Object(u.a)(Wi,"WordEditorSendUsYourFileDialogStrings",null,["__INTERFACE__@1js/wac-common:ISendUsYourFileDialogStrings"]);class hm extends Jr{constructor(){super(new Wi,()=>y.AFrameworkApplication.rootQuerySignature)}Eaa(b,h){return new Tu.a(b,h,"SendUsYourFile.ashx",Sp.a.word,df.a.webServiceBase,qr.a.wq,qr.a.Ukd,qr.a.Ekd)}get name(){return"WordEditor.SendUsYourFile"}static main(){K.a.instance.Lc(new hm)}}Object(u.a)(hm,"PackageManager",Jr,["__INTERFACE__@1js/msoserviceplatform:IPackage","__INTERFACE__@1js/msoserviceplatform:IContainerConfiguration"]);
var Ul=d(545),Mo=d(632),yq=d(1859),Gj=d(121),$g=d(23),ok=d(158),Ol=d(82),Ep=d(1018),pi=d(168);class en{constructor(){this.color=0;this.weight=pi.a.akf;this.style=pi.a.FKb}}Object(u.a)(en,"BorderPropertyValue",null,[]);class Fp{constructor(b,h,r,A,M,aa){this.H3d=b;this.gallerySectionId=h;this.uBf=r;this.vgf=A;this.commandId=M;this.queryCommandId=aa}}Object(u.a)(Fp,"BorderStyleMenuPropsArguments",null,[]);class kp{constructor(b,h,r,A,M,aa,oa){this.Z5a=b;this.Npd=h;this.width=r;this.Gdd=A;this.height=
M;this.Nad=aa;this.altText=oa}}Object(u.a)(kp,"TableBorderStyleProperties",null,[]);class Wg{constructor(){this.TSd=[new kp(Wg.w0b,"","2",1,8,0,"Solid Line"),new kp(Wg.OMb,"5,3","1",1,8,0,"Dashed Line"),new kp(Wg.oNb,"1,1","1",1,8,0,"Dotted Line"),new kp(Wg.qNb,"","1",2,8,3,"Double Line")];this.USd=[new kp(Wg.yKb,"","1",1,8,0,"0.25pt"),new kp(Wg.wKb,"","1",1,8,0,"0.5pt"),new kp(Wg.BKb,"","2",1,8,0,"0.75pt"),new kp(Wg.xKb,"","2",1,8,0,"1pt"),new kp(Wg.vKb,"","3",1,8,0,"1.5pt"),new kp(Wg.CKb,"","4",
1,8,0,"2.25pt"),new kp(Wg.AKb,"","4",1,8,0,"3pt"),new kp(Wg.uKb,"","5",1,8,0,"4.5pt"),new kp(Wg.zKb,"","6",1,8,0,"6pt")]}initialize(){this.ljd()}WEf(){const b=new Fp("Line Style gallery","DefaultLineStyleOptions","LineStyleOptionsGallery",this.TSd,ub.a.Vdb,ub.a.aog);return this.Eic(b)}XEf(){const b=new Fp("Line Weight gallery","DefaultLineWeightOptions","LineWeightOptionsGallery",this.USd,ub.a.Wdb,ub.a.bog);return this.Eic(b)}Csi(b){switch(b){case Wg.w0b:return pi.a.FKb;case Wg.OMb:return pi.a.zmb;
case Wg.oNb:return pi.a.qTc;case Wg.qNb:return pi.a.o6;default:return pi.a.gza}}Dsi(b){switch(b){case Wg.yKb:return pi.a.oTc;case Wg.wKb:return pi.a.akf;case Wg.BKb:return pi.a.X5a;case Wg.xKb:return pi.a.Qqa;case Wg.vKb:return pi.a.T$;case Wg.CKb:return pi.a.Hja;case Wg.AKb:return pi.a.n6;case Wg.uKb:return pi.a.fza;case Wg.zKb:return pi.a.Gja;default:return pi.a.NH}}Eic(b){const h=new aj.a,r=new te.a,A=Object.assign(new Mo.a,{Id:b.H3d,ExternalId:b.gallerySectionId,ExternalGalleryId:b.uBf,Type:4,
Width:1,GalleryItems:[]});for(const aa of b.vgf){var M={};const oa={};oa.width=Wg.cwn;oa.height=Wg.bwn;M.root=oa;M=Object.assign(new yq.a,{Id:aa.Z5a,ExternalId:String.format("{0}_GalleryButton",aa.Z5a),Icon:aa.Z5a,Command:b.commandId.toString(),QueryCommand:b.queryCommandId.toString(),MenuItemId:aa.Z5a,FullIconStyle:M,ShouldSetTitle:"true",Alt:aa.altText});A.GalleryItems.push(M)}r.ControlList=[];h.MenuSectionList=[];r.ControlList.push(A);h.MenuSectionList.push(r);h.UpdateDynamically=!0;return h}ljd(){const b=
{};for(const h of this.TSd)b[h.Z5a]=appChrome.buildBorderStyleIcon(h.Npd,h.width,h.Gdd,h.height,h.Nad);for(const h of this.USd)b[h.Z5a]=appChrome.buildBorderStyleIcon(h.Npd,h.width,h.Gdd,h.height,h.Nad);appChrome.api.registerIconProvider(()=>b)}COo(b,h,r){if(!b)return v.ULS.sendTraceTag(578073118,306,15,"table border context should not be null."),!1;if(b.contextId!==lc.a.p4)return v.ULS.sendTraceTag(577910617,306,15,"Context should be of type table border. Getting context of type: {0}",b.contextId),
!1;switch(b.border){case 2:this.f4(Gj.a.ZW(b),b.node,5,r,h);break;case 0:this.f4(Gj.a.ZW(b),b.node,3,r,h);break;case 1:this.f4(Gj.a.ZW(b),b.node,4,r,h);break;case 3:this.f4(Gj.a.ZW(b),b.node,0,r,h);break;case 7:this.f4(Gj.a.ZW(b),b.node,1,r,h);break;case 8:this.f4(Gj.a.ZW(b),b.node,2,r,h);break;case 6:this.f4(Gj.a.ZW(b),b.node,1,r,h);this.f4(Gj.a.ZW(b),b.node,2,r,h);break;case 5:this.f4(Gj.a.ZW(b),b.node,3,r,h);this.f4(Gj.a.ZW(b),b.node,5,r,h);this.f4(Gj.a.ZW(b),b.node,4,r,h);this.f4(Gj.a.ZW(b),b.node,
0,r,h);break;case 4:this.f4(Gj.a.ZW(b),b.node,3,r,h),this.f4(Gj.a.ZW(b),b.node,5,r,h),this.f4(Gj.a.ZW(b),b.node,4,r,h),this.f4(Gj.a.ZW(b),b.node,0,r,h),this.f4(Gj.a.ZW(b),b.node,1,r,h),this.f4(Gj.a.ZW(b),b.node,2,r,h)}return!0}Rxg(b,h,r,A){if(!h)return v.ULS.sendTraceTag(578073119,306,15,"cell border context should not be null."),!1;if(h.contextId!==lc.a.J0)return v.ULS.sendTraceTag(577910656,306,15,"Context should be of type cell border. Getting context of type: {0}",h.contextId),!1;var M=h.node;
const aa=new vd.a;aa.set(M);aa.vb(14);M=$g.TableCellReader.qVa(aa);switch(h.border){case 2:this.d_a(b,h.node,5,A,r,M);this.Xwe(h.node,5,r);this.Yve(b,h.A8a(),3,r,A,M);break;case 0:this.d_a(b,h.node,3,A,r,M);this.Xwe(h.node,3,r);this.Yve(b,h.A8a(),1,r,A,M);break;case 1:this.d_a(b,h.node,4,A,r,M);this.Xwe(h.node,4,r);this.Yve(b,h.A8a(),0,r,A,M);break;case 3:this.d_a(b,h.node,0,A,r,M),this.Xwe(h.node,0,r),this.Yve(b,h.A8a(),2,r,A,M)}return!0}fio(b,h){if(ze.a.q$c(b)&&h)switch(b=Object(ya.a)(ok.TableNodeBorderContext,
b),b.border){case 2:this.yR(b.node,Wg.Dp.bP(5),h);break;case 0:this.yR(b.node,Wg.Dp.bP(3),h);break;case 3:this.yR(b.node,Wg.Dp.bP(0),h);break;case 1:this.yR(b.node,Wg.Dp.bP(4),h);break;case 7:this.yR(b.node,Wg.Dp.bP(1),h);break;case 8:this.yR(b.node,Wg.Dp.bP(2),h);break;case 5:h=this.yR(b.node,Wg.Dp.bP(5),h);h=this.yR(b.node,Wg.Dp.bP(3),h);h=this.yR(b.node,Wg.Dp.bP(0),h);this.yR(b.node,Wg.Dp.bP(4),h);break;case 6:h=this.yR(b.node,Wg.Dp.bP(1),h);this.yR(b.node,Wg.Dp.bP(2),h);break;case 4:h=this.yR(b.node,
Wg.Dp.bP(5),h),h=this.yR(b.node,Wg.Dp.bP(3),h),h=this.yR(b.node,Wg.Dp.bP(0),h),h=this.yR(b.node,Wg.Dp.bP(4),h),h=this.yR(b.node,Wg.Dp.bP(1),h),this.yR(b.node,Wg.Dp.bP(2),h)}}Dgo(b,h){if(ze.a.r$c(b)&&h)switch(b=Object(ya.a)(ok.TableNodeBorderContext,b),b.border){case 2:this.yR(b.node,Wg.Dp.sR(5),h);break;case 0:this.yR(b.node,Wg.Dp.sR(3),h);break;case 3:this.yR(b.node,Wg.Dp.sR(0),h);break;case 1:this.yR(b.node,Wg.Dp.sR(4),h)}}iGf(b,h,r){r=null;if(!b)return v.ULS.sendTraceTag(575980876,306,15,"Node should not be null"),
r;b.properties.hasProperty(h.size)&&(r=new en,r.weight=b.properties.ka(h.size,pi.a.NH),r.style=b.properties.ka(h.style,pi.a.gza),r.color=b.properties.ka(h.color,0));return r}Qxg(b,h,r){b?r?(b.properties.setValue(h.size,r.weight),b.properties.setValue(h.style,r.style),b.properties.setValue(h.color,r.color)):v.ULS.sendTraceTag(575980878,306,15,"Property Value object should not be null"):v.ULS.sendTraceTag(575980877,306,15,"Node should not be null")}TYb(b,h){b?(b.properties.removeProperty(h.size),b.properties.removeProperty(h.style),
b.properties.removeProperty(h.color)):v.ULS.sendTraceTag(575980879,306,15,"Node should not be null")}f4(b,h,r,A,M){M=this.gxp(b,h,r,A,M);this.dwc(h,Wg.Dp.bP(r),M);switch(r){case 5:this.Pwb(h,2,A,M);break;case 4:this.Pwb(h,1,A,M);break;case 0:this.Pwb(h,3,A,M);break;case 3:this.Pwb(h,0,A,M);break;case 1:this.Pwb(h,7,A,M);break;case 2:this.Pwb(h,8,A,M)}}gxp(b,h,r,A,M){if(3!==A){var aa=Wg.Zg.j5d(b,h,r,3);void 0!==aa&&null!==aa&&aa!==pi.a.g2&&(aa=Ol.a.nvc(aa),M.color=Wg.Nva.Qja(h,aa))}1!==A&&(aa=Wg.Zg.j5d(b,
h,r,1),void 0!==aa&&null!==aa&&aa!==pi.a.MH&&(M.weight=parseFloat(aa)*pi.a.pTc));2!==A&&(b=Wg.Zg.j5d(b,h,r,2),void 0!==b&&null!==b&&b!==pi.a.MH&&(M.style=b));return M}d_a(b,h,r,A,M,aa){A&&(M=this.Drp(b,h,aa,r,A,M));this.dwc(h,Wg.Dp.sR(r),M)}Drp(b,h,r,A,M,aa){if(3!==M){var oa="",Ja=Wg.Zg.kPb(b,h,A,!1,!0,r,3);Ja&&(oa=Ja.EKb);void 0!==oa&&null!==oa&&oa!==pi.a.g2&&(oa=Ol.a.nvc(oa),aa.color=Wg.Nva.Qja(h,oa))}if(1!==M){oa="";if(Ja=Wg.Zg.kPb(b,h,A,!1,!0,r,1))oa=Ja.EKb;void 0!==oa&&null!==oa&&oa!==pi.a.MH&&
(aa.weight=parseFloat(oa)*pi.a.pTc)}if(2!==M){M="";if(b=Wg.Zg.kPb(b,h,A,!1,!0,r,2))M=b.EKb;void 0!==M&&null!==M&&M!==pi.a.MH&&(aa.style=M)}return aa}DKn(b){let h=0,r=0;({bKn:h,BHn:r}=this.rxm(b.style,h,r));b.weight<h&&(b.weight=h);b.weight>r&&(b.weight=r);return b}rxm(b,h,r){switch(b){case pi.a.FKb:case pi.a.zmb:case pi.a.qTc:h=2;r=48;break;case pi.a.o6:h=2;r=24;break;default:h=2,r=48}return{bKn:h,BHn:r}}Yve(b,h,r,A,M,aa){if(h)if(A)for(let oa=0;oa<h.length;oa++)switch(r){case 2:this.d_a(b,h[oa],5,
M,A,aa);break;case 0:this.d_a(b,h[oa],3,M,A,aa);break;case 1:this.d_a(b,h[oa],4,M,A,aa);break;case 3:this.d_a(b,h[oa],0,M,A,aa)}else v.ULS.sendTraceTag(578073121,306,15,"tableBorderPropertyValue should not be null");else v.ULS.sendTraceTag(578073120,306,15,"Adjacent cell array should not be null")}Xwe(b,h,r){const A=new vd.a;A.set(b);A.vb(14);const M=$g.TableCellReader.Dsa(b);b=$g.TableCellReader.tR(b);Oh.forEachCell(A,M,b,(aa,oa,Ja)=>{aa=aa.currentNode;$g.TableCellReader.Us(aa)&&0==Ja&&0<oa&&this.dwc(aa,
Wg.Dp.sR(h),r)})}dwc(b,h,r){b?(r=this.DKn(r),b.properties.setValue(h.color,r.color),b.properties.setValue(h.size,r.weight),b.properties.setValue(h.style,r.style)):v.ULS.sendTraceTag(578073122,306,15,"Graph node should not be null")}Pwb(b,h,r,A){if(b){var M=Ii.TableReader.yg(b),aa=Ii.TableReader.Fh(b),oa=new vd.a,Ja=[];for(let fb=0;fb<M;fb++)for(let Cb=0;Cb<aa;Cb++)if(oa.set(b),Oh.moveToCell(oa,fb,Cb),oa&&oa.currentNode&&!$g.TableCellReader.Tg(oa))switch(h){case 2:$g.TableCellReader.Hla(oa)&&Ja.push(ok.TableNodeBorderContext.laa(oa.currentNode,
2));break;case 0:$g.TableCellReader.Ila(oa)&&Ja.push(ok.TableNodeBorderContext.laa(oa.currentNode,0));break;case 3:$g.TableCellReader.IYf(b,oa.currentNode)&&Ja.push(ok.TableNodeBorderContext.laa(oa.currentNode,3));break;case 1:$g.TableCellReader.JYf(b,oa.currentNode)&&Ja.push(ok.TableNodeBorderContext.laa(oa.currentNode,1));break;case 7:$g.TableCellReader.JYf(b,oa.currentNode)||Ja.push(ok.TableNodeBorderContext.laa(oa.currentNode,1));break;case 8:$g.TableCellReader.IYf(b,oa.currentNode)||Ja.push(ok.TableNodeBorderContext.laa(oa.currentNode,
3))}for(b=0;b<Ja.length;b++)switch(h=Ja[b],h.border){case 2:this.Fjd(h.node,Wg.Dp.sR(5),r,A);this.Sse(h.A8a(),Wg.Dp.sR(0),r,A);break;case 0:this.Fjd(h.node,Wg.Dp.sR(3),r,A);this.Sse(h.A8a(),Wg.Dp.sR(4),r,A);break;case 1:this.Fjd(h.node,Wg.Dp.sR(4),r,A);this.Sse(h.A8a(),Wg.Dp.sR(3),r,A);break;case 3:this.Fjd(h.node,Wg.Dp.sR(0),r,A),this.Sse(h.A8a(),Wg.Dp.sR(5),r,A)}}else v.ULS.sendTraceTag(578073123,306,15,"Table node should not be null")}Sse(b,h,r,A){if(b)for(let M=0;M<b.length;M++)this.Fjd(b[M],
h,r,A);else v.ULS.sendTraceTag(578062292,306,15,"Adjacent cell array should not be null")}Fjd(b,h,r,A){if(b){var M=b.ka(h.color,Wg.OXc),aa=b.ka(h.size,Wg.Tfc),oa=b.ka(h.style,Wg.Sfc),Ja=new en;Ja.weight=A.weight;Ja.style=A.style;Ja.color=A.color;2!==r||M===Wg.OXc&&aa===Wg.Tfc?3!==r||oa===Wg.Sfc&&aa===Wg.Tfc?1!==r||M===Wg.OXc&&oa===Wg.Sfc?(b.properties.removeProperty(h.color),b.properties.removeProperty(h.size),b.properties.removeProperty(h.style)):(Ja.color=M,Ja.style=oa,this.dwc(b,h,Ja)):(Ja.style=
oa,Ja.weight=aa,this.dwc(b,h,Ja)):(Ja.color=M,Ja.weight=aa,this.dwc(b,h,Ja))}else v.ULS.sendTraceTag(578073152,306,15,"Graph node should not be null")}yR(b,h,r){var A=b.properties.ka(h.style,pi.a.MH);A!==pi.a.MH&&(r.lineStyle!==pi.a.MH?r.lineStyle!==A&&(r.lineStyle=pi.a.Zbl):r.lineStyle=A);A=b.properties.ka(h.size,pi.a.NH);A!==pi.a.NH&&(r.Ppc!==pi.a.NH?r.Ppc!==A&&(r.Ppc=pi.a.Nbl):r.Ppc=A);b=b.properties.ka(h.color,0);b=Ol.a.BB(b);b!==pi.a.g2&&(r.borderColor!==pi.a.g2?r.borderColor!==b&&(r.borderColor=
pi.a.Fbl):r.borderColor=b);return r}static get Dp(){return null!=Wg.xSg?Wg.xSg:Wg.xSg=pi.a.instance}static get Zg(){return null!=Wg.w6g?Wg.w6g:Wg.w6g=Za.a.instance.Oa(458)}static get Nva(){return null!=Wg.l4g?Wg.l4g:Wg.l4g=Ep.a.instance}}Wg.cwn="110px";Wg.bwn="20px";Wg.w0b="SolidLineStyle";Wg.OMb="DashedLineStyle";Wg.oNb="DottedLineStyle";Wg.qNb="DoubleLineStyle";Wg.yKb="BorderPointSizeOneQuarter";Wg.wKb="BorderPointSizeOneHalf";Wg.BKb="BorderPointSizeThreeQuarters";Wg.xKb="BorderPointSizeOne";Wg.vKb=
"BorderPointSizeOneAndHalf";Wg.CKb="BorderPointSizeTwoAndQuarter";Wg.AKb="BorderPointSizeThree";Wg.uKb="BorderPointSizeFourAndHalf";Wg.zKb="BorderPointSizeSix";Wg.Sfc="single";Wg.Tfc=4;Wg.OXc=0;Object(u.a)(Wg,"TableBorderManager",null,[542]);var rm=d(1003),zq=d(54),hw=d(208);class Gy{constructor(b,h){this.Yzh=this.Muh=null;this.JTa=b;this.$wh=h}get Doj(){return this.$wh}get hua(){return this.Muh}get Dpg(){return this.Yzh}DNj(b,h){this.Yzh=b;this.Muh=h}ETo(b){this.$wh=b}}Object(u.a)(Gy,"CellNodeAndOutlineElementInfoForInsertion",
null,[]);var vj=d(58),ef=d(191),et=d(363),vp=d(143),br=d(228),Rt=d(469),cr=d(76),bs=d(484),Uu=d(1031);class fn extends rm.a{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb=null,Sb=null){super(b,h,r,Sb,Gb);this.Wgb=Uu.a.instance;this.sa=new Td.a;this.c_h=[Mc.a.uyc,Mc.a.mzb,Mc.a.X0b,Mc.a.syc,Mc.a.kzb,Mc.a.V0b,Mc.a.ryc,Mc.a.jzb,Mc.a.U0b,Mc.a.tyc,Mc.a.lzb,Mc.a.W0b];this.eok=[Mc.a.ya,Mc.a.xa,He.a.si,He.a.Bs];this.Di=A;this.sIb=M;this.Zc=aa;this.hb=oa;this.J9=Ja;this.Vm=fb;this.jHc=Cb;this.gHh=Gb;this.EOk=Sb;this.tfo=
this.zmg.bind(this)}get Dj(){return this.Di.value}get $t(){return this.J9?this.J9.instance:null}kff(b){this.sa.addHandler("OnParagraphDelete",b)}get Mh(){return!!this.jHc.instance&&this.jHc.instance.Mh}k7c(b,h,r,A,M){h.setValue(Mc.a.Yc,$f.a.OF());h.setValue(Mc.a.Vcn,M);Rt.c(A,h,[Mc.a.q4]);super.k7c(b,h,r,A,M)}Tae(b,h,r,A,M){const aa=this.O4c(h,r,A,M);this.$Wd(aa,h,!1);return super.Tae(b,h,r,A,M)}cQd(b,h,r,A,M){const aa=this.O4c(h,r,A,M);this.$Wd(aa,h,!0);super.cQd(b,h,r,A,M);return aa}orf(b,h,r,A){h=
this.O4c(b,h,r,A);this.$Wd(h,b,!0);return h}insertRows(b,h,r,A){const M=zq.a.Gt(b),aa=new vd.a;aa.hd(b);const oa=aa.currentNode;aa.Ub(1);let Ja;Ja=h?b.dP(1):b.currentNode;const fb=b.rc();if(!fb)throw Error.create("table row insertion cannot be performed on a null tableNode");const Cb=Ii.TableReader.yg(fb),Gb=fb.m2.Zg;let Sb=!1;try{fb.CDa=1;const pc=this.Wgb.jqb(fb,Gb.VG(fb));this.p_a(b.currentNode);this.Xva(b);this.IVk(r,b,Ja,aa,oa,h,A);const zc=this.Wgb.jqb(fb,Gb.VG(fb));this.Udb(fb,Ii.TableReader.yg(fb)+
r);Sb=!0;this.Gbe(fb,pc,zc)}finally{fb.CDa=0,Sb||this.Udb(fb,Ii.TableReader.yg(fb)+r)}M+1!==Cb||h?!M&&h&&fn.yVf(fb,r):fn.yVf(fb,M);h=M+r+(h?0:1);h<Cb+r&&this.SSi(fb,h);return b.currentNode}IVk(b,h,r,A,M,aa,oa){let Ja=null,fb=null;for(var Cb=0;Cb<b;++Cb){var Gb=hw.a.instance.createInstance(wm.a.Ina);fb||(fb=Gb);Ja=Gb;this.k7c(h,Gb,r,M,aa)}b=Ii.TableReader.Fh(h.currentNode);r=!0;do{r?(h.Yj(Ja),r=!1):h.Mf(1);M=Array(b);for(Cb=0;Cb<b;++Cb){Gb=this.qUa();const Sb=this.orf(Gb,A.currentNode,aa,!0);let pc=
null;Sb.Tg||(pc=oa(Sb));M[Cb]=new Gy(Gb,pc);M[Cb].DNj(Sb,null);A.Mf(1)}for(Cb=0;Cb<b;++Cb)Gb=M[Cb].JTa,h.d6(Gb,1,rm.a.WQa?rm.a.WQa():null),$g.TableCellReader.Us(Gb)||(this.ZJb(h,Gb,M[Cb].Doj),this.U6h(M[Cb].Dpg,Gb,!0));A.lla(1)}while(h.currentNode!==fb)}insertColumns(b,h,r,A,M){let aa=b.currentNode,oa=!1,Ja=Ii.TableReader.Fh(b.currentNode);const fb=Ja;try{this.p_a(b.currentNode);this.Xva(b);const Cb=aa.m2.Zg;aa.CDa=1;const Gb=this.Wgb.jqb(aa,Cb.VG(aa));Ja=Ii.TableReader.Fh(b.currentNode);-1===h&&
(h=Ja);this.GVk(b,A,r,h,M);aa=b.currentNode;Ja+=A;this.hpg(b,Ja,A,h);oa=!0;const Sb=this.Wgb.jqb(aa,Cb.VG(aa));this.Gbe(aa,Gb,Sb)}finally{aa.CDa=0,oa||this.hpg(b,Ja,A,h)}h!==fb||r?!h&&r&&fn.xVf(aa,A):fn.xVf(aa,h-1)}GVk(b,h,r,A,M){var aa=b.currentNode;A=r?A:A-1;b.Ub(1);var oa=new ib.a;do{var Ja=b.XG(A,1);b.rc();var fb=Array(h);for(let Gb=0;Gb<h;++Gb){var Cb=this.qUa();const Sb=this.lzm(b,Ja,r),pc=this.orf(Cb,Ja,r,!1);Cb=new Gy(Cb,null);Cb.DNj(pc,Sb);fb[Gb]=Cb}oa.add(fb)}while(b.zj(1));r=oa.toArray();
for(A=0;A<r.length;A++)for(oa=0;oa<h;oa++)Ja=r[A][oa],fb=Ja.Dpg,fb.Tg||Ja.ETo(M(fb));b.set(aa);b.Ub(1);M=0;do{for(aa=0;aa<h;++aa)A=r[M][aa],oa=A.JTa,b.LRb(oa,A.hua,1,rm.a.WQa?rm.a.WQa():null),$g.TableCellReader.Us(oa)||(this.ZJb(b,oa,A.Doj),this.U6h(A.Dpg,oa,!1));M++}while(b.zj(1))}Gbe(b,h,r){if(h){var A=2===b.CDa,M=[],aa=new vd.a;aa.set(b);for(var oa=aa.Ub(1);oa;){for(oa=aa.Ub(1);oa;){const Ja=oa.id.toString();Ja in h&&h[Ja]===r[Ja]&&(!A||!$g.TableCellReader.Ila(aa)&&!$g.TableCellReader.Hla(aa))||
M.push(oa);oa=aa.zj(1)}oa=aa.zj(1)}if(0<M.length){h=new Rb.GraphTransaction(3);try{h.set(b.mk);for(const Ja of M)Ja.AVf()}finally{h&&h.dispose()}}}}deleteRows(b,h){const r=zq.a.Gt(b),A=r+h;let M=b.rc();const aa=M.m2.Zg;let oa=!1;v.ULS.sendTraceTag(579479247,341,50,"Performing DeleteRows. Table node Id: {0}, Table Node Type: {1},  Row index: {2}, Row count to delete: {3}",M.id.toString(),M.type,r,h);const Ja=Ii.TableReader.yg(M);try{M.CDa=2;const fb=this.Wgb.jqb(M,aa.VG(M));this.p_a(b.currentNode);
this.Xva(b);for(let Gb=A-1;Gb>=r;--Gb){b.XG(Gb,1);let Sb=b.Ub(1);for(;Sb;)this.ded(Sb,!0),Sb=b.zj(1);this.cWa(b);v.ULS.sendTraceTag(579479248,341,50,"Deleting table row node: ID:{0}, Type:{1}",b.currentNode.id.toString(),b.mf);b.Rg()}M=b.currentNode;const Cb=this.Wgb.jqb(M,aa.VG(M));this.Udb(M,Ii.TableReader.yg(M)-h);this.xle(b);oa=!0;this.Gbe(M,fb,Cb)}finally{M.CDa=0,oa||(this.Udb(b.currentNode,Ii.TableReader.yg(b.currentNode)-h),this.xle(b))}Ja===A&&0<=r-1&&fn.yVf(M,r-1);r<Ja-h&&this.SSi(M,r)}deleteColumns(b,
h,r){b=Object(ya.a)(vd.a,b);let A=Object(ya.a)(bs.a,b.currentNode),M=Ii.TableReader.Fh(b.currentNode);const aa=A.m2.Zg;let oa=!1;v.ULS.sendTraceTag(579479249,341,50,"Performing DeleteColumns. Table Node Id:{0}, Table Node type:{1}, Column Index: {2}, Column count to delete: {3}",A.id.toString(),A.type,h,r);const Ja=M;try{A.CDa=2;const fb=this.Wgb.jqb(A,aa.VG(A));this.p_a(b.currentNode);this.Xva(b);-1===h&&(h=M-r);b.Ub(1);do for(let Gb=h+r-1;Gb>=h;--Gb)b.XG(Gb,1),this.ded(b.currentNode,!1),this.cWa(b),
b.Rg();while(b.zj(1));M-=r;this.gpg(b,M,h,r);oa=!0;A=Object(ya.a)(bs.a,b.currentNode);const Cb=this.Wgb.jqb(A,aa.VG(A));this.Gbe(A,fb,Cb);this.wle(b)}finally{A&&(A.CDa=0),oa||(this.gpg(b,M,h,r),this.wle(b))}Ja===h+r&&0<=h-1&&fn.xVf(A,h-1)}mergeCells(b,h,r){if(b&&(1!==h||1!==r)){var A=new vd.a;A.hd(b);A.vb(14);this.Ksf(A,h,r);this.krp(A,h,r);A.rc();A.rc();this.dkj(A)}}lVj(b,h,r){if(b&&(1!==h||1!==r)){var A=new vd.a;A.hd(b);A.vb(14);this.WHl(A,h,r);A.rc();A.rc();this.Kmj(A)}}ded(b,h){v.ULS.sendTraceTag(579479250,
341,50,"Table cell getting deleted. ID:{0}, Type:{1}",b.id.toString(),b.type);this.nSm(b,h,this.tfo)}zmg(b,h){const r=b.currentNode;r.Tg=!1;this.$Wd(h.currentNode,b.currentNode,!0);r.removeProperty(Mc.a.skippedCell);r.removeProperty(Mc.a.renderCell);1===r.colSpan&&1===r.rowSpan&&r.JUc();rm.a.hT.yja(b,!0,rm.a.QBi(h.currentNode));Oh.returnToCell(b);this.Yzl(h,b)}yQf(b,h,r){super.yQf(b,h,r);1===h.NO.colSpan&&1===h.NO.rowSpan?h.NO.JUc():!r&&h.Jue&&(b.fWa?1<b.colSpan&&(h=new vd.a,h.set(b),h.vb(15),Oh.moveToNextColumn(h),
h.currentNode.colSpan=b.colSpan-1):(r=new vd.a,r.set(h.NO),r.vb(15),h=cr.a(r),r=new vd.a,r.set(b),r.vb(15),Oh.moveToColumnByIndex(r,h),--r.currentNode.colSpan))}O4c(b,h,r,A){const M=super.O4c(b,h,r,A);if(b.Tg&&!A){var aa=h.vCa;aa.Jue&&(A=rm.a.Uic(aa.NO,A),!aa.yVd&&r||aa.yVd===A-1&&!r?b.colSpan=1:(r=new vd.a,r.set(aa.NO),r.vb(15),aa=cr.a(r),r=new vd.a,r.set(h),r.vb(15),Oh.moveToColumnByIndex(r,aa),r.currentNode.colSpan+=1))}M.ka(Mc.a.skippedCell,!1)&&(b.Tg=!0,b.z7=!0,b.xyb=!0);return M}xle(b){this.Z1b(b,
Mc.a.complexTable)}wle(b){this.Z1b(b,Mc.a.complexTable)}dkj(b){this.Z1b(b,Mc.a.complexTable)}Kmj(b){this.Z1b(b,Mc.a.complexTable)}Yzl(b,h){if(b&&h){let r;b=vd.a.Za(b.currentNode);Yn.OutlineNavigator.zba(b)&&(b.Ub(2),b=b.currentNode,12==b.type&&(r=b.wf(He.a.si)));r&&(b=new vd.a,b.hd(h),Yn.OutlineNavigator.zba(b)&&b.Ub(2)&&(h=b.currentNode,12==h.type&&h.Ag(He.a.si,r)))}}$Wd(b,h,r){b&&(Rt.c(b,h,this.c_h),Rt.c(b,h,[He.a.VK]),r&&Rt.c(b,h,[Mc.a.oS,Mc.a.lV,Mc.a.rOa,Mc.a.pOa,Mc.a.sOa,Mc.a.skippedCell,Mc.a.renderCell]))}U6h(b,
h,r){b&&(b=vd.a.Za(b),b.Kd(),b.Zd(),h=vd.a.Za(h),h.Kd(),h.Zd(),Db.OutlineElementReader.Nh(b)&&Bb.OutlineElementNavigator.Me(b)&&Db.OutlineElementReader.Nh(h)&&Bb.OutlineElementNavigator.Me(h)&&Rt.c(b.currentNode,h.currentNode,this.eok),r&&(Bb.OutlineElementNavigator.je(b),Bb.OutlineElementNavigator.je(h),of.ListItemReader.Cg(b)&&(r=fn.Pwn.Pw(b),r.tD=vj.a.Jk,{wla:r}=fn.$l.Dqa(r.ff,h,r))))}cWa(b){this.Mh&&this.Vm.Uto(b.currentNode);for(b=ef.a.xq(b);b.moveNext();)if(Gd.ParagraphReader.Vb(b.currentNode)){const h=
cn.e(b.currentNode);for(const r of h)r.pga();this.sa.raiseEvent("OnParagraphDelete",b.currentNode)}else of.ListItemReader.Cg(b.iterator)&&this.$t&&this.$t.Nga(b.iterator)}rH(b,h){let r=null;if(this.gHh.Lg){const A=Object(ya.a)(bs.a,b);A&&(r=A.UX())}Ii.TableReader.Eo(b)&&(1===h?h=3:3===h&&(h=1));super.rH(b,h);this.gHh.Lg&&this.EOk.q_a(b,r);Object(Xa.a)(bs.a,b)&&rm.a.Oh.qOj(Object(ya.a)(bs.a,b),(new et.a(1,0)).Ou)}Xyg(b,h){const r=Array(h),A=this.QGi(b)/h;for(let M=0;M<h;M++)r[M]=Math.max(Ah.a.qn(vp.a.yha,
0),A);b.setValue(He.a.hB,r)}fNj(b){b.setValue(Mc.a.tableLayout,0)}uPh(b,h,r,A,M){const aa=Array(r);for(var oa=0,Ja=0;oa<A;++oa)aa[oa]=h[oa],Ja+=aa[oa];for(;oa<r;++oa)aa[oa]=0>oa-M?h[0]:h[oa-M],Ja+=aa[oa];oa=this.QGi(b.currentNode);if(Ja>oa)for(Ja=oa/Ja,oa=0;oa<r;++oa)aa[oa]=Math.max(Ah.a.qn(vp.a.yha,0),aa[oa]*Ja);return aa}QGi(b){var h=vd.a.Za(b);b=Ah.a.qn(Ah.a.qj(Ii.TableReader.EGi(h),0),0);if(h.vb(16))return Oh.returnToCell(h),h=vp.a.tzc(h.currentNode),Ah.a.qn(Ah.a.qj(h,0),0)-b;h=br.a.jrd(h);return Ah.a.qn(Ah.a.qj(h,
0),0)-b}tR(b,h,r){const A=new vd.a;A.set(b);Oh.moveToCell(A,h,r);return A.currentNode.ka(Mc.a.colSpan,1)}kwc(b){var h=qa.StaticActiveAppFrame.za().kb.Bw;if(h.te&&(h=b.Be(h.pc))){var r=!1,A=Ii.TableReader.Fh(b),M=b.ka(He.a.hB,Array(A));for(var aa of M)if(!aa){r=!0;break}if(r){M=Oe.a.clone(M);aa=b.ka(Mc.a.complexTable,!1);v.ULS.sendTraceTag(36726403,341,50,"Performing set column widths: columnCount {0} | columnWidths: {1} | isComplexTable: {2}",A,M,aa);r=1;var oa=0;for(let fb=0;fb<A;)if(aa&&(r=this.tR(b,
0,fb)),1<r){for(var Ja=0;Ja<r;Ja++)M[fb]||(M[fb]=this.tAi(0)),fb++;oa+=r-1}else(Ja=h.Tlm(fb-oa))||v.ULS.sendTraceTag(36726404,341,50,"Got no width for graph column {0} (ghost cells {1})",fb,oa),M[fb]||(M[fb]=this.tAi(Ja)),fb++;b.setValue(He.a.hB,M)}}}tAi(b){return Ah.a.qn(Math.max(b,vp.a.yha),0)}p_a(b){b=vd.a.Za(b);this.kwc(b.currentNode);b.vb(14)&&(Oh.returnToContainingTable(b),this.kwc(b.currentNode))}mOj(b,h){h&&b.setValue(Mc.a.Dca,h)}Dzg(b,h){h&&b.setValue(Mc.a.qyc,h)}q1h(b,h){const r=Ii.TableReader.Fh(b);
rm.a.cpl(b,h,r)}CPo(b,h,r){let A;if(!({qp:A}=this.Hoc(b)).returnValue)return!1;if(h&&r&&h.length===r.length){if(!this.LTl(A,h))return!1;for(let M=0;M<h.length;++M){const aa=this.sIb.Lmd(b,h[M],r[M]);if(aa)return v.ULS.sendTraceTag(17584922,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",aa),!1}this.sje(A);return!0}return!1}M4k(b,h){let r;if(!({qp:r}=this.Hoc(b)).returnValue||Ii.TableReader.kD(r))return!1;var A=Object(ya.a)(vd.a,this.Zc.kg(r));Oh.moveToLastRow(A);
var M=Ii.TableReader.yg(r);if(h&&0<h.length){this.insertRows(A,!1,h.length,()=>null);A=Ii.TableReader.yg(r);var aa=this.Zc.kg(r);M=this.AGi(aa,M,A-1);for(A=0;A<M.length;++A){aa=M[A];const oa=h[A];for(let Ja=0;Ja<aa.length;++Ja){let fb;if(fb=oa&&oa[Ja]?this.sIb.Lmd(b,aa[Ja],oa[Ja].toString()):this.sIb.Lmd(b,aa[Ja],""))return v.ULS.sendTraceTag(17584923,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",fb),!1}}}this.sje(r);return!0}u4k(b,h){let r;if(!({qp:r}=
this.Hoc(b)).returnValue||Ii.TableReader.kD(r))return!1;var A=this.Zc.kg(r),M=Ii.TableReader.Fh(r);if(h&&0<h.length){this.insertColumns(Object(ya.a)(vd.a,A),M,!1,h[1].length,()=>null);var aa=Ii.TableReader.Fh(r);A=this.qKm(A,M,aa-1);for(M=0;M<A.length;++M){aa=h[M];const oa=A[M];for(let Ja=0;Ja<oa.length;++Ja){let fb;if(fb=aa&&aa[Ja]?this.sIb.Lmd(b,oa[Ja],aa[Ja].toString()):this.sIb.Lmd(b,oa[Ja],""))return v.ULS.sendTraceTag(17584924,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",
fb),!1}}}this.sje(r);return!0}pNl(b){let h;if(!({qp:h}=this.Hoc(b)).returnValue)return!1;let r=this.Z8a(h);const A=Ii.TableReader.yg(h);var M=this.Zc.kg(h);M=this.AGi(M,r,A-1);for(let aa=0;aa<M.length;++aa){const oa=M[aa];for(let Ja=0;Ja<oa.length;++Ja){const fb=this.sIb.Hzj(b,oa[Ja]);if(fb)return v.ULS.sendTraceTag(17584925,341,10,"Unexpected failure to release content control in table cell. error code is {0}",fb),!1}}r=r?r:1;b=this.Zc.kg(h);b.WG(r)&&15===b.mf&&this.deleteRows(Object(ya.a)(vd.a,
b),A-r);this.sje(h);return!0}Z8a(b){let h=0;const r=this.Zc.kg(b);let A=r.Zd();for(;A&&A.ka(Mc.a.xtb,!1);)h++,A=r.Au();return!h&&rm.a.Jy.P2(b)&32?1:h}krp(b,h,r){var A,M;const aa=b.currentNode,oa=new vd.a;oa.hd(b);let Ja=null,fb=null,Cb=null;const Gb=pi.a.instance.sR(3),Sb=pi.a.instance.sR(4),pc=pi.a.instance.sR(5),zc=pi.a.instance.sR(0);Oh.forEachCell(oa,h,r,(Yc,Kd,ke)=>{Yc=Yc.currentNode;Kd||ke||(Ja=fn.gB.iGf(Yc,Gb,Ja));Kd||ke!==r-1||(fb=fn.gB.iGf(Yc,Sb,fb));0<Kd&&!ke&&(Ja?fn.gB.Qxg(Yc,Gb,Ja):fn.gB.TYb(Yc,
Gb),fb?fn.gB.Qxg(Yc,Sb,fb):fn.gB.TYb(Yc,Sb),fn.gB.TYb(Yc,pc),Kd!==h-1&&fn.gB.TYb(Yc,zc));ke||Kd!==h-1||(Cb=fn.gB.iGf(Yc,zc,Cb))});b=null===(M=null===(A=qa.StaticActiveAppFrame.za())||void 0===A?void 0:A.kb)||void 0===M?void 0:M.Bw;fb?(A=ok.TableNodeBorderContext.laa(aa,1),fn.gB.Rxg(Gj.a.Qq(b),A,fb,0)):fn.gB.TYb(aa,Sb);A=ok.TableNodeBorderContext.laa(aa,0);if(Ja)fn.gB.Rxg(Gj.a.Qq(b),A,Ja,0);else for(A=Object(ya.a)(ok.TableNodeBorderContext,A).A8a(),M=0;M<A.length;M++)fn.gB.TYb(A[M],Sb);Cb?fn.gB.Qxg(aa,
zc,Cb):fn.gB.TYb(aa,zc)}LTl(b,h){for(let A=0;A<h.length;++A){var r=this.Zc.kg(h[A]);if(r.vb(14)&&(r=r.ld(14),b.id===r.id))continue;return!1}return!0}Hoc(b){let h=null;if(b&&b.sv.toString()!==b.HA.toString())return{returnValue:!1,qp:h};h=this.Dj.Eb(b.sv);return 14===h.type&&this.sIb.Hoc(b)?{returnValue:!0,qp:h}:{returnValue:!1,qp:h}}AGi(b,h,r){const A=[];Oh.forEachCellInTable(Object(ya.a)(vd.a,b),(M,aa,oa)=>{if(aa>=h&&aa<=r)oa||A.push([]),$g.TableCellReader.Tg(M)||Array.add(A[aa-h],M.currentNode);
else if(aa>r)return!1;return!0});return A}qKm(b,h,r){const A=[];Oh.forEachCellInTable(Object(ya.a)(vd.a,b),(M,aa,oa)=>{oa>=h&&oa<=r&&(oa===h&&A.push([]),$g.TableCellReader.Tg(M)||Array.add(A[aa],M.currentNode));return!0});return A}sje(b){if(b&&14===b.type){b=Object(ya.a)(vd.a,this.Zc.kg(b));const h=new ib.a;Gd.ParagraphReader.bQb(b,!0,!1,h);b=sc.SelectionFactory.ue(h.K(h.count-1),0);this.hb.Kc(b)}}static get gB(){fn.oya||(fn.oya=Za.a.instance.Oa(873));return fn.oya}static get Pwn(){return null!=fn.J_g?
fn.J_g:fn.J_g=Za.a.instance.resolve(10)}static get $l(){return null!=fn.C_g?fn.C_g:fn.C_g=Za.a.instance.resolve(32)}SSi(b,h){const r=new vd.a;r.set(b);Oh.moveToFirstRow(r);Oh.moveToRowByIndex(r,h);do r.currentNode.km(4,!0);while(Oh.moveToNextRow(r))}static yVf(b,h){if(b){var r=Ii.TableReader.yg(b),A=Ii.TableReader.Fh(b);if(!(!qa.StaticActiveAppFrame.za().kb.Bw.te||0>h||h>=r))for(r=new vd.a,r.set(b),b=0;b<A;b++){b?Oh.moveToNextColumn(r):Oh.moveToCell(r,h,b);if(!r||!r.currentNode||16!==r.currentNode.type)continue;
let M=r.currentNode;$g.TableCellReader.Us(M)&&(M=$g.TableCellReader.Hka(M));M&&M.km(4,!0)}}else v.ULS.sendTraceTag(577868247,306,15,"Can not invalidate row when there is no table node")}static xVf(b,h){if(b){var r=Ii.TableReader.yg(b),A=Ii.TableReader.Fh(b),M=new vd.a;if(!(!qa.StaticActiveAppFrame.za().kb.Bw.te||0>h||h>=A))for(A=0;A<r;A++){M.set(b);Oh.moveToCell(M,A,h);if(!M||!M.currentNode)continue;let aa=M.currentNode;$g.TableCellReader.Us(aa)&&(aa=$g.TableCellReader.Hka(aa));aa&&aa.km(4,!0)}}else v.ULS.sendTraceTag(577868248,
306,15,"Can not invalidate column when there is no table node")}}fn.oya=null;Object(u.a)(fn,"TableEditor",rm.a,[540,324]);class Hy{get name(){return"WordEditor.TableEditors"}uc(b){y.AFrameworkApplication.J.$("TableEditorsDelayInitializationEnabled")&&(b.ia("WordEditor.TableEditors.TableEditor",()=>new fn(b.resolve(110),b.resolve(18),b.resolve(458),new Qf.a(()=>qa.StaticActiveAppFrame.za().kb.$c.td),b.resolve(874),new Ul.a,gg.a.instance,b.Ra(618),b.resolve(21),b.Ra(11),b.resolve(46).instance,b.resolve(39).instance)).as(783).as(33).ha(),
b.ia("WordEditor.TableEditors.TableBorderManager",()=>new Wg).as(873).ha())}init(){}dispose(){}static main(){K.a.instance.Lc(new Hy)}}Object(u.a)(Hy,"WordEditorTableEditorsPackage",null,[0,1]);class yz{get name(){return"WordEditor.TextLevelEditors"}uc(){}init(){}dispose(){}static main(){K.a.instance.Lc(new yz)}}Object(u.a)(yz,"WordEditorTextLevelEditorsPackage",null,[0,1]);var dr=d(1985),Qx=d(377),Iy=d(763),Jy=d(213),Rx=d(227);class Ts{constructor(b){this.IFk=b}hGl(){const b=hw.a.instance.createInstance(wm.a.LF);
b.setValue(He.a.QL,Jy.a.first);b.setValue(He.a.XUh,0);b.setValue(He.a.Kta,gm.OutlineReader.lMl);(new Iy.OutlineIndentInfo(!0)).LHj(b);return b}yja(b,h,r=null){const A=b.currentNode;if(!b.yL(1))return this.QRb(b,null,h,r);Db.OutlineElementReader.uN(b)&&Bb.OutlineElementNavigator.T8f(b,!0);return Db.OutlineElementReader.Nh(b)?Ts.gg.SA(b,!1,h,r):(b.Ykd(A),null)}Yil(b){return gm.OutlineReader.BZf(b.currentNode)||Db.OutlineElementReader.Nh(b)||Db.OutlineElementReader.uN(b)||$g.TableCellReader.isTableCell(b)}QRb(b,
h=null,r=!1,A=null){if(!this.Yil(b))return null;const M=Ts.gg.Rnb();this.bVo(M,b);b.LRb(M,h,1,null);b.Yj(M);r&&(Ts.gg.bL(b,A),Bb.OutlineElementNavigator.je(b));return M}bVo(b,h){if(h=this.vGm(h))switch(h.type){case 11:Ts.gg.myf(h,b,!0);break;case 8:h=Ts.pj.isRtl(h),Ts.gg.C_b(b,h)}}vGm(b){return this.IFk.wGm(b)}B_b(b,h){b.setValue(He.a.Bs,h?11:9)}KPo(b,h){const r=Rx.WordSectionNavigator.instance.WR(b);return r?gm.OutlineReader.q_(b)!==h?(r.setValue(Mc.a.Zuf,h),!0):!1:null}static get pj(){return Um.PageReader.instance}static get gg(){return Ts.Oh||
(Ts.Oh=Za.a.instance.resolve(18))}static set gg(b){Ts.Oh=b}}Ts.Oh=null;Ts.Ke=null;Object(u.a)(Ts,"OutlineEditor",null,[568]);const Vu=b=>{b.ia("Box4.OutlineLevelEditors.OutlineEditor",()=>new Ts(b.resolve(875))).as(110).ha();b.ia("Box4.OutlineLevelEditors.OutlineElementEditor",()=>new dr.a(b.rf(110),b.rf(32),b.rf(10),b.resolve(876),b.resolve(877),b.resolve(86),b.resolve(490),b.resolve(392),b.resolve(8))).as(18).ha()};class rr{eRj(){return{dRj:!0,O$j:!1}}}Object(u.a)(rr,"CursorMovementValidator",null,
[536]);class qn{get name(){return"Box4.OutlineLevelEditors"}uc(b){b.ia("Box4.ListEditors.CursorMovementValidator",()=>new rr).as(1091).ha();Vu(b)}init(){}dispose(){}static main(){K.a.instance.Lc(new qn)}}Object(u.a)(qn,"Box4OutlineLevelEditorsPackage",null,[0,1]);class uu{constructor(b){this.AYd=null;this.Ugj=b.ib("OfficeOnlineChromeExtensionId");this.ehj=b.ib("ChromeClipboardAccessExtensionId");this.Ybn=b.$("OfficeOnlineChromeExtensionIsEnabled");this.rDh=!this.Ekn();this.AYd=this.W_b?this.ehj:this.Ugj}zCo(){this.AYd===
this.Ugj&&this.uYi&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));this.AYd=this.ehj;this.rDh=!0}get W_b(){return this.rDh}Ekn(){if(this.Ybn&&this.uYi){var b=localStorage.getItem("IsOfficeOnlineExtensionInstalled");if(b&&"true"===b)return b=localStorage.getItem("IsCopyPasteSupported"),!!b&&"true"===b}return!1}get uYi(){let b=!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),b="LocalStorageAccessiblityTest"===
localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(h){v.ULS.sendTraceTag(19452045,307,50,h.toString())}return b}}Object(u.a)(uu,"ChromeExtensionHelper",null,[1873]);var Sx=d(1309),Ky=d(674),NA=d(1262);class oC{create(b){return new NA.a(b)}}Object(u.a)(oC,"Factory",null,[703]);var Fm=d(1239),Rj=d(1009),Wu=d(395),am=d(359),Aq=d(916);class Zn extends Aq.a{constructor(b,h,r,A,M,aa,oa=null,Ja=null){super(b,aa,oa,Ja);this._formatting=null;
this.cxa=!1;this.rDb=y.AFrameworkApplication.J.$("FollowDestinationFormattingPasteIsEnabled");this.KFb=0;this.MPc=new ib.a;Tc.a(8128527,307,Db.OutlineElementReader.Nh(b));this.uO=h;this.uO.ndc(this);this.ir=r;this.$l=A;this.Md=M;this.Kkf=Ja;this.S2e=of.ListItemReader.Cg(this.Bc)}get nl(){return null!=this.p1g?this.p1g:this.p1g=Za.a.instance.resolve(348)}get qYd(){return null}get bfc(){return this.S2e&&!this.uO.ZIa}get HMb(){return 0<this.KFb}tga(b,h){if(!this.Z0.qJg(this.Bc,h,!0)){Tc.a(8701077,307,
Gd.ParagraphReader.Bh(this.Bc));var r=this.Bc.currentNode,A=wc.a.vx(r);this.rDb&&this._formatting.oR&&(r=r.ra.last,this.cxa&&(r.formatting=this._formatting.oR.Bf(r),this.cxa=!1),b=this.Z0.HQf(b,h),this.Z0.pca(this.Bc.currentNode,this._formatting.Aga,h));this.Fg.Ve(A,b)}}Dba(){Tc.a(8701078,307,Gd.ParagraphReader.Bh(this.Bc));const b=wc.a.vx(this.Bc.currentNode);this.Fg.yla(b,h=>new am.a(h))}Dvb(){this.Z0.NQf(this.Bc)}uMa(){this.rDb&&(this.cxa=!0)}wYa(){Tc.a(8701079,307,Gd.ParagraphReader.Bh(this.Bc))}vYa(){Tc.a(8701080,
307,Gd.ParagraphReader.Bh(this.Bc))}JF(b){this.uO.ZIa||(this.rDb?(this.hhf(b),this._formatting.Grd(this.Bc.currentNode),b&&"P"===b.Mba.G$d&&this.Kkf.eha(this.Bc.currentNode,this._formatting.yP),this.Z0.pca(this.Bc.currentNode,this._formatting.Aga,b)):this.cal(b))}eH(){this.uO.ZIa||this.zJa()}AYa(){}Tbb(){}NCa(){Tc.a(8701081,307,Db.OutlineElementReader.Nh(this.Bc)||gm.OutlineReader.oy(this.Bc)||Gd.ParagraphReader.Bh(this.Bc)&&this.uO.ZIa);let b=!1;this.HMb||(b=this.bfc||!0);b||(this.RX+=1);this.KFb++}LCa(){this.KFb--;
let b=!1;this.HMb||(b=this.bfc||!0,this.$l.UAj(this.MPc));b||--this.RX}xMa(b){Tc.a(8701082,307,Db.OutlineElementReader.Nh(this.Bc)||gm.OutlineReader.oy(this.Bc)||Gd.ParagraphReader.Bh(this.Bc)&&this.uO.ZIa);Tc.a(8701083,307,!!b.listStyleType)}MCa(){Tc.a(8701084,307,Db.OutlineElementReader.Nh(this.Bc)||Gd.ParagraphReader.Bh(this.Bc)&&this.uO.ZIa);this.uO.ZIa||Tc.a(8701085,307,this.Bc.kv(2))}Jba(b){this.uO.Jba(b)}Hba(){this.uO.Hba()}trd(b){this.MPc.add(b)}X7(b){this.uO.X7(b)}Iba(){this.uO.Iba()}Gba(b){this.uO.Gba(b)}Fba(){this.uO.Fba()}cal(b){this.Xqc(!1);
(new vd.a).hd(this.Bc);b=Aq.a.gg.bL(this.Bc,this.c3c(b));Tc.a(8128534,307,b===this.Bc.currentNode);Tc.a(8128535,307,Gd.ParagraphReader.Vb(b))}zJa(){Tc.a(8128536,307,Gd.ParagraphReader.Bh(this.Bc));Bb.OutlineElementNavigator.je(this.Bc)}reset(){this.rDb&&(super.reset(),this._formatting=this.NHf(!0))}hhf(b){this.Xqc(!1);(new vd.a).hd(this.Bc);b=Aq.a.gg.bL(this.Bc,this.c3c(b));Tc.a(36577367,307,b===this.Bc.currentNode);Tc.a(36577368,307,Gd.ParagraphReader.Vb(b));-1!==this._formatting.Ax&&this.nl.rH(b,
this._formatting.Ax);this._formatting.lineSpacing&&this.Kkf.GE(b,this._formatting.lineSpacing);this._formatting.E8&&this.Kkf.qxe(b,this._formatting.E8);this.cxa=!0;this._formatting.paragraph=b}static lrf(b,h){let r=0;switch(h){case 3:r=Jg.a.gD(b);break;case 7:r=Ah.a.$z(b,0);break;case 1:r=Jg.a.Vmf(b);break;case 5:r=Jg.a.gD(Jg.a.Rjg(b));break;default:v.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",b,h)}return r}}Object(u.a)(Zn,
"TextOnlyBox4PasteSteward",Aq.a,[]);class Us extends Zn{constructor(b,h,r,A,M,aa,oa,Ja=null,fb=null){super(h,r,A,M,aa,oa,Ja,fb);this.UIc=!1;this.nEb=[];this.jGh=b;h={};h.textOnlyPasteFlags=b;v.ULS.sendTraceTag(509088282,307,50,H.c(h))}reset(){super.reset();this.UIc=!1;this.nEb.length=0;this.oDd=!1}JF(b){this.UIc||(super.JF(b),this.UIc=!0)}eH(){this.oDd?this.oDd=!1:this.Dba(null)}Dba(b){this.jGh&2||super.Dba(b)}NCa(){}LCa(){}xMa(){}MCa(){}Jba(){}Hba(){}X7(b){this.UIc||(super.X7(b),this.UIc=!0);this.nEb.push(!1)}Iba(){this.jGh&
1&&this.Dba(null);0<this.nEb.length?this.nEb.pop():Tc.a(509088281,307,!1)}Gba(){var b=this.nEb.length-1;0<=b?this.nEb[b]?(b=wc.a.vx(this.Bc.currentNode),this.Fg.Ve(b,", ")):this.nEb[b]=!0:Tc.a(509088280,307,!1);this.oDd=!0}Fba(){this.oDd=!1}trd(){}}Object(u.a)(Us,"StrictTextOnlyBox4PasteSteward",Zn,[]);class vu{constructor(b,h,r,A){this.$1e=b;this.GM=h;this.jg=r;this.Z0=A}create(b,h,r,A,M=null,aa=null,oa=null,Ja=null){return 1===b?null!==Ja&&0!==Ja?new Us(Ja,h,A,this.$1e,this.GM,this.jg,M,aa,this.Z0):
new Zn(h,A,this.$1e,this.GM,this.jg,M,aa,this.Z0):new Wu.Box4PasteSteward(h,r,A,this.$1e,this.GM,this.jg,M,new bn.b,aa,this.Z0,oa)}}Object(u.a)(vu,"Box4PasteStewardFactory",null,[702]);var Dv=d(174),ft=d(371),No=d(1035);class $D{constructor(b,h,r){this.jA=null;this.LFb=0;this.Bc=b;this.gk=r}ndc(b){this.jA=b}get ZIa(){return 0<this.LFb}Jba(b){Tc.a(7869459,307,!!this.jA);Tc.a(7869460,307,Db.OutlineElementReader.Nh(this.Bc)||gm.OutlineReader.oy(this.Bc));Tc.b(38563978,307,50,"Table pasting started");
this.jA.Xqc(!0);const h=new vd.a;h.hd(this.Bc);var r=No.a.c_m[b.styleId];r||(y.AFrameworkApplication.vd("gdea6103;0df65435"),b.rWf?(v.ULS.sendTraceTag(509125329,3022,50,"onTableStart: Fixed default table style"),r=No.a.mOn):r=No.a.ici);r=this.gk.Boo(this.Bc,b.rowCount,b.inb,r,b.tableLook,this.jA.c3c(b),b.rWf);b.VFg&&(Tc.b(573691298,3022,100,"Applying table border properties"),No.a.vRh(b.VFg,this.Bc,!1,!0));b.zae&&(Tc.b(573691299,3022,100,"Applying indentation properties"),No.a.H5k(this.Bc,b.zae.spaceBefore,
b.zae.spaceAfter));b.zVd&&(Tc.b(573691328,3022,100,"Applying column widths"),No.a.q5k(b.zVd,this.Bc,Object(ya.a)(ft.TableNode,r),b.mab));this.jA.TRd(h,!1);this.LFb++;of.ListItemReader.Cg(h)&&this.jA.trd(h.currentNode);Tc.a(7869461,307,Ii.TableReader.isTable(this.Bc))}Hba(){Tc.a(7869462,307,!!this.jA);Tc.a(7869463,307,zq.a.isTableRow(this.Bc));Tc.b(38563979,307,50,"Table pasting finished");this.Bc.jt(14)&&No.a.QHj(this.Bc.ko);Bb.OutlineElementNavigator.je(this.Bc);this.LFb--}X7(b){Tc.a(7869464,307,
!!this.jA);Tc.b(573691329,3022,100,"Table row pasting started");Ii.TableReader.isTable(this.Bc)?Oh.moveToFirstRow(this.Bc):zq.a.isTableRow(this.Bc)&&Oh.moveToNextRow(this.Bc);b.height&&(Tc.b(573691330,3022,100,"Applying table row height"),No.a.B6k(this.Bc,b.height));Tc.a(7869465,307,zq.a.isTableRow(this.Bc))}Iba(){Tc.a(7869466,307,!!this.jA);Tc.a(7869467,307,$g.TableCellReader.isTableCell(this.Bc));Oh.returnToContainingRow(this.Bc)}Gba(b){Tc.a(7869468,307,!!this.jA);Tc.a(7869469,307,!this.jA.RX);
zq.a.isTableRow(this.Bc)?Oh.moveToFirstColumn(this.Bc):$g.TableCellReader.isTableCell(this.Bc)?Oh.moveToNextColumn(this.Bc):Tc.a(7869471,307,!1);if(this.Bc.currentNode){Tc.b(573691331,3022,100,"Table cell pasting started");var h=Object(ya.a)(Dv.TableCellNode,this.Bc.currentNode);Tc.a(50689760,307,!h&&16!==this.Bc.currentNode.type||!!h&&16===this.Bc.currentNode.type);if(h){var r=new vd.a;r.hd(this.Bc);if(b.Boc)Tc.b(573691332,3022,100,"Processing skipped cell"),No.a.Teo(r,b);else{if(1<b.colSpan||1<
b.rowSpan){const A=Oh.returnToContainingTable(r);if(!A)return;A.setValue(Mc.a.complexTable,!0);r.hd(this.Bc);Tc.b(573691333,3022,100,"Processing merged cell");No.a.heo(r,b);h.rowSpan=b.rowSpan;h.colSpan=b.colSpan}No.a.G6k(this.Bc,b.shadingColor);No.a.x7k(this.Bc,b.verticalAlignment);No.a.e5k(this.Bc,b.VAe);No.a.vRh(b.Fna,this.Bc,!b.colSpan&&!b.rowSpan,!1);(new vd.a).hd(this.Bc);Oh.forEachCell(r,b.rowSpan,b.colSpan,(A,M,aa)=>{Tc.b(573691334,3022,100,"Setting ghost cell borders");No.a.mMj(A,b.Fna,M,
aa,b.rowSpan,b.colSpan)});No.a.z7k(this.Bc,b.width,b.mab);Tc.a(7869472,307,gm.OutlineReader.oy(this.Bc))}}}}Fba(){Tc.a(7869473,307,!!this.jA);Tc.a(7869474,307,Db.OutlineElementReader.Nh(this.Bc)||$g.TableCellReader.isTableCell(this.Bc));Oh.returnToCell(this.Bc);Tc.a(7869475,307,0>=this.jA.RX);this.jA.Snf()}}Object(u.a)($D,"Box4TableSteward",null,[720,505]);class Jm{constructor(b,h,r){this.jA=null;this.LFb=0;this.Bc=b;this.gk=r}ndc(b){this.jA=b}get ZIa(){return 0<this.LFb}Jba(){this.ZIa&&(Tc.a(8787101,
307,Gd.ParagraphReader.Bh(this.Bc)),Bb.OutlineElementNavigator.je(this.Bc));Tc.a(8701086,307,!!this.jA);Tc.a(8701087,307,Db.OutlineElementReader.Nh(this.Bc)||gm.OutlineReader.oy(this.Bc));this.LFb++}Hba(){Tc.a(8701088,307,!!this.jA);Bb.OutlineElementNavigator.je(this.Bc);this.LFb--;if(this.ZIa){this.jA.Xqc(!0);const b=Jm.gg.bL(this.Bc);Tc.a(8787102,307,b===this.Bc.currentNode);Tc.a(8787103,307,Gd.ParagraphReader.Bh(this.Bc))}}X7(b){Tc.a(8701089,307,!!this.jA);this.jA.Xqc(!0);const h=new vd.a;h.hd(this.Bc);
this.jA.TRd(h,!1);of.ListItemReader.Cg(h)&&this.jA.trd(h.currentNode);b=Jm.gg.bL(this.Bc,this.jA.c3c(b));Tc.a(8701090,307,b===this.Bc.currentNode);Tc.a(8701091,307,Gd.ParagraphReader.Bh(this.Bc))}Iba(){Tc.a(8701120,307,!!this.jA);Tc.a(8701121,307,Gd.ParagraphReader.Bh(this.Bc));Bb.OutlineElementNavigator.je(this.Bc)}Gba(){Tc.a(8701122,307,!!this.jA);Tc.a(8701123,307,Gd.ParagraphReader.Bh(this.Bc));Tc.a(8701124,307,!this.jA.RX);var b=this.Bc.currentNode;Gd.ParagraphReader.textLength(b)&&(b=wc.a.vx(b),
this.jA.Fg.Ve(b,", "))}Fba(){Tc.a(8701125,307,!!this.jA);Tc.a(8701126,307,Gd.ParagraphReader.Bh(this.Bc));Tc.a(8701127,307,0>=this.jA.RX);this.jA.Snf()}static get gg(){return null!=Jm.E0g?Jm.E0g:Jm.E0g=Za.a.instance.resolve(18)}}Object(u.a)(Jm,"TextOnlyBox4TableSteward",null,[720,505]);class XI{constructor(b,h,r=!1,A=!1){this.GM=b;this.uG=h;this.nGk=r;this.uGk=A}create(b,h){return 1===b?new Jm(h,this.GM,this.uG):new $D(h,this.GM,this.uG,this.nGk,this.uGk)}}Object(u.a)(XI,"Box4TableStewardFactory",
null,[701]);class jh{create(){return new xm.a}}Object(u.a)(jh,"Factory",null,[700]);class zv{constructor(){this.Qjh=!1}get y$d(){return this.Qjh}set y$d(b){this.Qjh=b}}Object(u.a)(zv,"HighContrastColorPickerState",null,[699]);class Kx{constructor(b){this.ga=b}get Rb(){return this.ga}bullets(b,h,r=null){const A=new wg.DictionaryPropertySet;A.setValue(pd.a.XB,b);A.setValue(pd.a.PXa,h);r&&A.Yt(r);A.CommandSource="autobulleting";return 32===this.Rb.Pb(ub.a.ME,2,A)}iQn(b,h,r,A,M){const aa=new wg.DictionaryPropertySet;
aa.setValue(pd.a.XB,b);aa.setValue(pd.a.PXa,h);aa.setValue(pd.a.MLa,r);M&&aa.setValue(fd.a.wT,M);A&&aa.setValue(Mc.a.Tw,A);aa.setValue(fd.a.Nta,"autocorrect");M&&aa.setValue(fd.a.cma,M);aa.CommandSource="autonumbering";return 32===this.Rb.Pb(ub.a.MN,2,aa)}}Object(u.a)(Kx,"ListCommands",null,[698]);var Hn=d(115);class aE{constructor(b,h,r,A,M){this.$l=b;this.vQn=h;this.Mj=r;this.Od=A;this.Fg=M}get Lgj(){return this.vQn.value}execute(b,h,r,A){const M=Rg.a.instance.nq(ub.a.BSo);Db.OutlineElementReader.isEmpty(b,
!1)?this.w1l(b):this.x1l(b,h,r,A);M.end()}w1l(b){this.Lgj.mmf(b,-1)?this.Lgj.gZa(b,-1,0):this.$l.bca(b,{LAj:!0})}x1l(b,h,r,A){h=A(b,h,r);b=Gd.ParagraphReader.Om(b.currentNode);!this.$l.Gyb&&this.iqn(b)&&this.cYk(h);this.$l.N0();(null===b||void 0===b?0:b.ra)&&!b.ra.last.formatting&&this.Fg.V7a(b)}iqn(b){return b.jj&&!b.Fx.hasProperty(Mc.a.listID)}cYk(b){Bb.OutlineElementNavigator.Me(b);b=b.currentNode;const h=new Hn.a;b.Ic.ku(h);this.Mj.fV(b,h,this.Od.Lg)}}Object(u.a)(aE,"ListNewLineStrategy",null,
[]);var iw=d(519);class pC{constructor(b){this.ga=b}VKn(b){if(4===b)b=ub.a.JLa;else if(2===b)b=ub.a.ena;else if(1===b)b=ub.a.T1b;else if(3===b)b=ub.a.I7a;else return;this.ga.Ob(b,2)}a8a(){this.ga.Ob(ub.a.a8a,2)}}Object(u.a)(pC,"SelectionCommands",null,[697]);var sr=d(229),gL=d(1069),zz=d(140),Xw=d(486);class Ev{constructor(){this.N$c=!1;this.WBp=y.AFrameworkApplication.J.ib("WordEditorVisiFontFileUri");this.YBp=y.AFrameworkApplication.J.ib("WordEditorVisiRtlFontFileUri");this.XBp=y.AFrameworkApplication.J.ib("WordEditorVisiPilcrowFontFileUri");
this.TBp=y.AFrameworkApplication.J.ib("WordEditorVisiCarriageReturnFontFileUri");this.VBp=y.AFrameworkApplication.J.ib("WordEditorVisiCarriageReturnRtlFontFileUri")}lip(){this.N$c=!this.N$c}kip(b){this.lip();let h=b.getElementsByClassName("VisiFontStyle")[0],r=b.getElementsByClassName("VisiFontRtlStyle")[0],A=b.getElementsByClassName("VisiFontPilcrowStyle")[0],M=b.getElementsByClassName("VisiFontCarriageReturnStyle")[0],aa=b.getElementsByClassName("VisiFontCarriageReturnRtlStyle")[0];h||(h=document.createElement("Style"),
h.className="VisiFontStyle",Fd.a.Jx(h,""),b.appendChild(h));r||(r=document.createElement("Style"),r.className="VisiFontRtlStyle",Fd.a.Jx(r,""),b.appendChild(r));A||(A=document.createElement("Style"),A.className="VisiFontPilcrowStyle",Fd.a.Jx(A,""),b.appendChild(A));M||(M=document.createElement("Style"),M.className="VisiFontCarriageReturnStyle",Fd.a.Jx(M,""),b.appendChild(M));aa||(aa=document.createElement("Style"),aa.className="VisiFontCarriageReturnRtlStyle",Fd.a.Jx(aa,""),b.appendChild(aa));if(this.N$c)return v.ULS.sendTraceTag(593294047,
324,50,"Formatting markers are inserted"),this.ESc(h)&&this.ESc(r)&&this.ESc(A)&&this.ESc(M)&&this.ESc(aa);v.ULS.sendTraceTag(593294046,324,50,"Formatting markers are removed");return this.Xjd(h)&&this.Xjd(r)&&this.Xjd(A)&&this.Xjd(M)&&this.Xjd(aa)}ESc(b){return""===Fd.a.Pz(b)?("VisiFontStyle"===b.className?Fd.a.Jx(b,this.p2c("WordVisi_MSFontService",this.WBp)):"VisiFontRtlStyle"===b.className?Fd.a.Jx(b,this.p2c("WordVisiRtl_MSFontService",this.YBp)):"VisiFontPilcrowStyle"===b.className?Fd.a.Jx(b,
this.p2c("WordVisiPilcrow_MSFontService",this.XBp)):"VisiFontCarriageReturnStyle"===b.className?Fd.a.Jx(b,this.p2c("WordVisiCarriageReturn_MSFontService",this.TBp)):"VisiFontCarriageReturnRtlStyle"===b.className&&Fd.a.Jx(b,this.p2c("WordVisiCarriageReturnRtl_MSFontService",this.VBp)),!0):!1}Xjd(b){return""!==Fd.a.Pz(b)?(Fd.a.Jx(b,""),!0):!1}p2c(b,h){return"@font-face { font-family: "+b+"; src: url('"+h+"'); unicode-range: U+0020, U+00A0, U+200B, U+2003; font-display: swap; }"}}Object(u.a)(Ev,"VisiMarkersOperation",
null,[695]);var bE=d(1452),St=d(928);class Ly extends bE.a{constructor(b,h){super(b,h);this.SUe=-1;this.pDb=0;this.GRe=null;this.blh=!1;this.QSe=[];this.eEd=!1;this.nuh=!0;this.l1e=this.YBd=null;this.preventDismissOnScroll=this.Spe=this.Gtc=!1;this.iaa=null;this.iOd=!1;this.p5c=!0;this.Ut=!1;this.tnh=y.AFrameworkApplication.J.$("FloatieLightDismissIsEnabled");Ly.dAh||(y.AFrameworkApplication.va.qa(Ka.a.showFloatie,we.a.frame,ce.ActionManager.Zf),Ly.dAh=!0)}get Xni(){return this.MQ}set Xni(b){this.MQ=
b}get l0j(){return this.iOd}get u6c(){return this.blh}set u6c(b){this.blh=b;this.pDb=0}get lC(){return!0}get cssClass(){return y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.kba?"cui-floatie MLRVisualRefresh":"cui-floatie"}get isVisible(){return this.Ut}f_a(){for(const b of this.children)if(b.f_a())return!0;return!1}get fca(){return 9}Vf(b){this.QSe[this.QSe.length]=b;super.Vf(b)}sn(){super.sn();yf.c(this.Rc)&&this.hE();this.Rc=Og.a.EZa(this.Rc);this.PZ(this.Rc);this.dirty=!1}Qrc(b){3===
b.zg||this.Spe||this.dismissFloatie(b);return!1}Urc(){return!1}Rrc(b){3!==b.zg&&this.p5c&&!this.Gtc&&this.qvp(b);return!1}Trc(){return!1}Orc(b){3===b.zg&&this.dismissFloatie(b);return!1}Prc(b){void 0!==this.iaa&&null!==this.iaa||this.preventDismissOnScroll||this.dismissFloatie(b);return!1}rE(){this.Pzf();return!1}mme(){this.u6c=!0}qvp(b){if(b=$f.a.ugc(b.clientPoint,this.GRe)){if(this.u6c){if(!this.pDb||b<this.pDb)this.pDb=b;b-=this.pDb}b-=this.SUe;0>b&&(b=0);const h=255-4*b;0>=h&&63.75<=b?this.dismissFloatie():
Y.a.setOpacity(this.Rc,Math.max(h/255,0))}else this.u6c=!1,this.pDb=0,Y.a.setOpacity(this.Rc,1)}Ftp(b){let h=null;void 0!==this.YBd&&null!==this.YBd&&(h=this.YBd(b));b=null;for(const r of this.QSe){let A=!this.l0j&&r.S1i;if(!A&&void 0!==h&&null!==h)for(let M=0;M<h.length;M++)if(r.id===h[M]){A=!0;break}r.Rc.style.display=A?"none":"";r.rgc=!A;A||(b=r)}b&&(b.rgc=!1)}$wi(){const b=this.Rc.style.top,h=this.Rc.style.left;this.Rc.style.top="0px";this.Rc.style.left="0px";const r=this.pPb();this.Rc.style.top=
b;this.Rc.style.left=h;return r}pPb(){const b=this.Rc.style.visibility,h=this.Rc.style.display;this.Rc.style.visibility="hidden";this.Rc.style.display="";const r=Le.a.getElementBounds(this.Rc);this.Rc.style.display=h;this.Rc.style.visibility=b;return r}syj(b){3===b||this.xCe?(Sys.UI.DomElement.addCssClass(this.Rc,St.a.z1b),this.iOd=!0):(Sys.UI.DomElement.removeCssClass(this.Rc,St.a.z1b),this.iOd=!1);this.Ftp(b)}eeb(b,h,r,A=!1){this.isVisible||(this.iaa||!this.nuh&&this.preventDismissOnScroll||(this.nuh=
!1,Le.a.Kie("ShowLegacyFloatie",""),y.AFrameworkApplication.va.Ob(Ka.a.showFloatie,2)),this.syj(r),this.p5c=!0,this.pDb=0,this.u6c=!1,!this.tnh||void 0!==this.iaa&&null!==this.iaa?(this.eEd=!1,this.Fja(this,!1)):(this.eEd=!0,this.bal(this)),h=A?b:this.X$n(b,h),this.Rc.style.top=h.y.toString()+"px",this.Rc.style.left=h.x.toString()+"px",this.pv(),this.GRe=this.pPb(),this.SUe=$f.a.ugc(b,this.GRe),Y.a.setOpacity(this.Rc,1),this.Rc.style.zIndex=String(y.AFrameworkApplication.ua.Fya),this.Rc.style.display=
"",this.Ut=!0)}X$n(b,h){const r=this.l0j?30:17,A=this.$wi(),M=Fd.a.$qb(),aa=Fd.a.dX();b=new Sys.UI.Point(b.x,b.y);1===h?b.y-=A.height:3===h?(b.y-=A.height,b.x-=A.width):2===h&&(b.x-=A.width);b.x+A.width>M&&(b.x=Math.floor(M-A.width));0>b.x&&(b.x=0);b.y=3===h||1===h?b.y-r:b.y+r;0>b.y&&(b.y=0);b.y+A.height>aa&&(b.y=aa-A.height);return b}Y$n(b,h){const r=b.ccj;if(r){this.syj(h);var A=this.$wi();this.iaa=b;b=r.kNg-r.u0c>A.width;var M=r.u0c+r.uDf>A.width,aa=r.eic>A.height+17,oa=r.Y9j-(r.eic+r.qDf)>A.height+
17;A=new Sys.UI.Point(r.u0c,r.eic);M||b||(M=!0,A.x=r.kNg);b=r.Utb?r.q2f?oa?M?2:0:M?3:1:aa?M?3:1:M?2:0:r.q2f?oa?b?0:2:b?1:3:aa?b?1:3:b?0:2;if(3===b||2===b)A.x=r.u0c+r.uDf;if(2===b||0===b)A.y=r.eic+r.qDf;this.eeb(A,b,h);this.p5c=!1;h=this.iaa.Wcf.Rc;void 0!==h&&null!==h&&(h.style.zIndex=String(y.AFrameworkApplication.ua.Fya))}}H6(){let b=super.H6();this.dismissFloatie()&&(b=!0);return b}dismissFloatie(b=null){if(!this.isVisible)return!1;void 0!==this.mRc&&null!==this.mRc&&this.mRc.Wza(null);void 0!==
this.iaa&&null!==this.iaa&&this.iaa.v6();this.v6();this.tnh&&this.eEd?this.MYl(this):this.Sea(this,!1);this.eEd=!1;this.SUe=-1;this.iaa=null;this.Rc.style.display="none";this.Ut=!1;this.l1e&&this.l1e(b);return!0}Pzf(){void 0!==this.iaa&&null!==this.iaa&&(this.iaa.t5a=null,this.iaa.v6(),this.iaa=null,this.fje.style.zIndex=String(y.AFrameworkApplication.ua.AHa),this.Rc.style.zIndex=String(y.AFrameworkApplication.ua.Fya))}hro(b){this.YBd=b}Zro(b){this.l1e=b}set lC(b){super.lC=b}}Ly.dAh=!1;Object(u.a)(Ly,
"Floatie",bE.a,[606,440,441]);class Tx{constructor(b,h){this.zw=this.OQa=null;this.n$i=b;this.PGj=h}get Zni(){return this.OQa}BXo(b){this.OQa=b}pPb(){return this.zw.pPb()}f3(){return this.zw?this.zw.isVisible:!1}GUh(b){this.BXo(b)}showFloatie(b,h){this.eeb(h.location,h.Wy,h.isRtl)}eeb(b,h,r){r=r?this.PGj:this.n$i;this.x0d();this.zw&&this.zw.eeb(b,r,h)}dismissFloatie(){this.zw&&this.zw.dismissFloatie()}x0d(){this.OQa&&!this.zw&&(this.zw=Object(ya.a)(Ly,this.OQa()))}i1d(){}}Object(u.a)(Tx,"AFloatieManager",
null,[718]);class My extends Tx{constructor(){super(1,3);this.sZj=!1;this.Fdi=""}eeb(b,h,r){r=r?this.PGj:this.n$i;this.x0d();this.zw&&(this.zw.isVisible&&this.zw.dismissFloatie(),this.sZj||this.zw.rn(),this.zw.eeb(b,r,h,!0))}x0d(){this.Zni&&!this.zw&&(this.zw=this.OQa())}i1d(){if(this.zw&&this.zw.isVisible){const b=Object(ya.a)(vl.a,this.zw.controls["PasteFloatie.FlyoutAnchor"]);b.behavior.ey(b.sqb(),1,null)}}wzg(b){this.Fdi=b}Oyo(b){b=b.JHf("Menu16",null);hh.a("renderIcon")&&b&&appChrome.api.renderIcon(My.grk,
b.firstElementChild)}mAc(b,h,r){if(this.zw){const A=this.zw.controls[this.Fdi];A&&(My.Rmh||(this.Oyo(A),My.Rmh=!0),A.Ud[Pm.a.labelText]=b,A.Ud[Pm.a.alt]=h,r&&A.behavior.rn())}}}My.Rmh=!1;My.grk="Designer_20";Object(u.a)(My,"PasteFloatieManager",Tx,[]);var Tt=d(1021);class Yw{constructor(){this.Nd=null}get Cv(){return null}getTitle(){return null}zvi(){return null}reset(b){this.Nd=b.node}wEa(b){b=cn.d(this.Nd,b);let h=null;if(!b||b.Qh!==this.Qh)return{returnValue:!1,yG:h};h=Object.assign(new Tt.a,{NF:this.key,
contentObject:b,title:this.getTitle(b),description:this.zvi(b)});return{returnValue:!0,yG:h}}}Object(u.a)(Yw,"BlobDetailsProvider",null,[256,257]);class $F extends Yw{constructor(){super()}get key(){return"EQUATION"}get Qh(){return 11}get Cv(){return Box4Intl.Box4Strings.l_EquationContentTitle}}Object(u.a)($F,"EquationDetailsProvider",Yw,[]);class OA{constructor(){this.Ckh=null}get key(){return"LINK"}get Cv(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(b){this.Ckh=Nc.a.Ajc(b.node)}wEa(b){let h=
null;for(const r of this.Ckh)if(r.cpBegin<=b&&b<r.cpEnd)return h=Object.assign(new Tt.a,{NF:this.key,contentObject:r.hyperlink}),{returnValue:!0,yG:h};return{returnValue:!1,yG:h}}}Object(u.a)(OA,"HyperlinkDetailsProvider",null,[256,257]);var qC=d(1241),aG=d(901);class gt{constructor(){this.Hph=!1}get key(){return"IFRAMENODE"}get Cv(){return this.Hph?Box4Intl.Box4Strings.l_IFrameVideoTitle:Box4Intl.Box4Strings.l_IFrameWebContentTitle}K1b(b){let h=null;b=b?Gd.ParagraphReader.kKa(b.currentNode):null;
if(!b)return{returnValue:!1,Eea:h};h=Object.assign(new qC.a,{NF:this.key,contentId:b.id,contentObject:b});return{returnValue:!0,Eea:h}}oqb(b,h){b=b?Object(ya.a)(aG.a,b.contentObject):null;h=h?Object(ya.a)(aG.a,h.contentObject):null;let r="";h&&b.id===h.id||(this.Hph=b.Bab,r=String.format(Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat,b.Cv,this.Cv));return r}}Object(u.a)(gt,"IFrameDetailsProvider",null,[719,257]);class bG extends Yw{constructor(){super()}get key(){return"IMAGE"}get Qh(){return 5}reset(b,
h){super.reset(b,h);this.Hzk=!ze.a.Am(h)}get Cv(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(b){return Uc.ImageReader.t_(b.properties)}zvi(b){b=Uc.ImageReader.IVa(b.properties);return this.Hzk&&(y.AFrameworkApplication.vd("51a6c128;f7eb8687"),y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ImageSelectionAnnouncement",!1))?String.format(Box4Intl.Box4Strings.l_ContentSelectedNotificationFormat,b):b}}Object(u.a)(bG,"ImageDetailsProvider",
Yw,[]);class Az{get key(){return"IMAGENODE"}get Cv(){return Box4Intl.Box4Strings.l_ImageContentTitle}K1b(b){let h=null;if(!b||!Uc.ImageReader.It(b.currentNode))return{returnValue:!1,Eea:h};h=Object.assign(new qC.a,{NF:this.key,contentId:b.currentNode.id,contentObject:b.currentNode});return{returnValue:!0,Eea:h}}oqb(b,h){b=b.contentObject;const r=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;let A="";h&&b.id===h.contentObject.id||(A=String.format(r,Uc.ImageReader.t_(b.properties),Box4Intl.Box4Strings.l_ImageContentTitle));
return A}}Object(u.a)(Az,"ImageNodeDetailsProvider",null,[719,257]);var Ux=d(753);let PA,wu;class Zw{constructor(b,h){this.vfh=null;this.io=h;this.i4e=b;this.key=Zw.keys.K(b);this.Cv=Zw.Rqf.K(b)}reset(b){this.vfh=this.io.d7(b.node);Ux.a.v0e++}wEa(b){var h=Zw.TCf(this.vfh||[],r=>this.Cdn(b,r));h=this.pCl(h);return{returnValue:!!h,yG:h}}Cdn(b,h){return h.Ec<=b&&b<h.end&&(!h.errorDetails||this.i4e===h.errorDetails.proofingType)}pCl(b){return b?Object.assign(new Tt.a,{NF:this.key,contentObject:b.errorDetails,
description:this.uVa()}):null}uVa(){return Rk.a.vLa?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static TCf(b,h){for(const r of b)if(h(r))return r;return null}}Zw.keys=(wu=new Ng.a,wu.add(1,"SPELLINGERROR"),wu.add(2,"GRAMMATICALERROR"),wu.add(3,"ADVANCEDERROR"),wu);Zw.Rqf=(PA=new Ng.a,PA.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),PA.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),PA.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),PA);
Object(u.a)(Zw,"ProofingDetailsProvider",null,[256,257]);class Bz{constructor(){this.qp=null;this.xVd=this.Hue=this.columns=this.rows=0}}Object(u.a)(Bz,"TableInfo",null,[]);class YI{get key(){return"TABLE"}get Cv(){return Box4Intl.Box4Strings.l_TableContentTitle}K1b(b){var h=null;if(!$g.TableCellReader.isTableCell(b))return{returnValue:!1,Eea:h};h=new vd.a;h.hd(b);b=new Bz;b.Hue=zq.a.Gt(h)+1;b.xVd=cr.a(h)+1;Oh.returnToContainingTable(h);b.qp=h.currentNode;b.columns=Ii.TableReader.Fh(b.qp);b.rows=
Ii.TableReader.yg(b.qp);h=Object.assign(new qC.a,{NF:this.key,contentId:b.qp.id,contentObject:b});return{returnValue:!0,Eea:h}}oqb(b,h){b=b.contentObject;const r=new fc.a;h||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,b.columns,b.rows));h&&h.contentObject.xVd===b.xVd||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,b.xVd));h&&h.contentObject.Hue===b.Hue||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,b.Hue));return r.toArray().join(" ")}}
Object(u.a)(YI,"TableDetailsProvider",null,[719,257]);class rC{constructor(b,h){this.SQa=b;this.io=h}get j2b(){return null!=this.s5g?this.s5g:this.s5g=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AriaInvalidForSpellingGrammar",!1)}Tpg(){this.SQa.execute(b=>{b.XX(new OA);Rk.a.eWf()||(this.j2b||(b.XX(new Zw(1,this.io)),b.XX(new Zw(2,this.io))),b.XX(new Zw(3,this.io)));b.XX(new $F);b.XX(new bG);b.NYb(new YI);b.NYb(new Az);b.NYb(new gt)})}}Object(u.a)(rC,"AccessibilityActor",
null,[]);class cE{constructor(b,h,r){this.X1n=(A,M,aa)=>{if(1===aa)return 32;this.Cmk().uCg();return 32};this.Y4a=b;this.Cmk=r}Xb(){this.Y4a.fb(ub.a.Onj,lc.a.view,this.X1n,1028)}}Object(u.a)(cE,"AutoCorrectActor",null,[]);class ZI{constructor(){this.Fie=!0}JCa(){}Xbb(){}ndc(){}nfg(){}Gwe(){}get jtc(){return!1}get avb(){return 0}get tbj(){return!1}get f_(){return kb.a.nil}}Object(u.a)(ZI,"TextOnlyBox4ImageSteward",null,[496]);class sC{constructor(b,h,r,A,M,aa,oa=!1){this.DR=b;this.Xi=h;this.Yg=r;this.R0m=
A;this.$J=M;this.sc=aa;this.Pyn=oa}create(b,h,r,A){return 1===b?new ZI:new cm.a(h,this.DR,this.Xi,this.Yg,this.sc,this.R0m,this.$J,this.Pyn,r,A)}}Object(u.a)(sC,"Box4ImageStewardFactory",null,[694]);var $n=d(32);class QA{constructor(b){this.ree=b}dln(b){if(!b||!b.fD||1>b.fD.count)return!1;const h=[$n.a.mai,$n.a.lai];return!!this.w4d(b.fD,1,r=>this.vWd(r,h))}WVi(b){return!b||!b.fD||1>b.fD.count?!1:!!this.w4d(b.fD,1,h=>this.vWd(h,[$n.a.dI]))}Vhn(b){return!b||!b.fD||1>b.fD.count?!1:!!this.w4d(b.fD,2,
h=>this.vWd(h,[$n.a.Kad]))}Bh(b){return!b||!b.fD||1>b.fD.count?!1:!!this.w4d(b.fD,1,h=>this.vWd(h,[$n.a.Gma]))}hde(b){if(!b||!b.fD)return!1;b=b.fD;for(let h=0;h<b.count;++h)if(!b.K(h)||0<b.K(h).m9k)return!1;return!0}t0l(b,h){return this.WVi(h)||this.Vhn(h)?"":b}w4d(b,h,r){if(b&&0<b.count)for(let A=b.count-1;0<=A;--A){if(r(b.K(A)))return b.K(A);if(b.count-A>=h)break}return null}vWd(b,h){b=b&&b.XNi?b.XNi.split(" "):null;if(!b)return!1;for(const r of h)if(0<=Array.indexOf(b,r))return!0;return!1}}Object(u.a)(QA,
"Box4PasteStewardUtils",null,[692]);var Fv=d(729);class tC{constructor(){this.$zc=0;this.Wpc=Array(9)}}Object(u.a)(tC,"FullListMetadata",null,[]);class Gv{constructor(b,h,r){this.$zc=this.level=0;this.tli=null;this.Zsc=!1;this.level=b;this.PFe=h;this.e3n=r}}Object(u.a)(Gv,"ListItemMetadata",null,[]);var ht=d(1242);class uC{constructor(){this.level=0;this.tagName="UL";this.Cub=null;this.QSf=!1;this.XPn=0;this.listStyle="BulletListStyle1";this.fub=new ht.a;this.font=this.levelText=""}}Object(u.a)(uC,
"ListLevelMetadata",null,[]);class Cz{constructor(){}}Object(u.a)(Cz,"LevelLists",null,[]);class RA{constructor(b){this.nodes=b;this.rUa=0;this.lists={};this.fub=[];this.Y3i=null;this.cKl=[];this.cKl[0]=new Cz}}Object(u.a)(RA,"WordConverterArguments",null,[]);var er=d(373),$w=d(698);class im{}im.WKl="data-ccp-timestamp";im.KYd="data-clipservice-ccpid";im.ZKl="data-shapeids";im.pQm="docs-internal-guid-";im.I1n="SCXO";im.xao="SCXP";im.qEp="SCXW";im.RLn="MsoListParagraphCxSpFirst";im.SLn="MsoListParagraphCxSpLast";
im.Iuf="data-pkey";im.Juf="data-clipservice-type";im.Guf="data-clipservice-count";im.Huf="data-clipservice-dc";im.FXc="data-clipservice-client";im.Kuf="data-clipservice-version";Object(u.a)(im,"HtmlContentMetadataConstants",null,[]);class $I{constructor(){this.y=this.x=0;this.top=this.left=null}}Object(u.a)($I,"AbsolutePosition",null,[]);var cs=d(861);class Hv{constructor(b,h,r="",A=0){this.Gy=!1;this.pkh=this.qkh=null;let M=!1;Hv.dhn(b)&&(M=!0,this.qkh=b);Hv.whn(h)&&(this.pkh=h);this.Dwk=r;this.jmk=
A;this.Gy=M&&this.G$d?!0:!1}get isValid(){return this.Gy}get $Ni(){return this.qkh}get G$d(){return this.pkh}get XNi(){return this.Dwk}get m9k(){return this.jmk}static dhn(b){return b?-1===b.indexOf(" ")&&0<b.length:!0}static whn(b){return b?-1===b.indexOf(" ")&&0<b.length:!1}}Object(u.a)(Hv,"HtmlElementInfo",null,[]);class aJ{constructor(b){this.next=null;this.data=b}}Object(u.a)(aJ,"StackNode",null,[]);class SA{constructor(){this.yr=null;this.Kk=0}get count(){return this.Kk}get isEmpty(){return!this.count||
!this.yr}push(b){b=new aJ(b);b.next=this.yr;this.yr=b;this.Kk=this.count+1}ZU(){return this.count&&this.yr?this.yr.data:null}pop(){if(!this.count||!this.yr)return null;const b=this.yr;this.yr=b.next;this.Kk=this.count-1;return b.data}clear(){this.yr=null;this.Kk=0}toArray(){const b=Array(this.count);let h=this.yr;for(let r=this.count-1;0<=r&&h;r--)b[r]=h.data,h=h.next;return b}}Object(u.a)(SA,"Stack",null,[]);class oj{constructor(b){this.Cj=b;this.cHc=this.kHd=null;this.Czd=!1}get qYd(){return this.cHc.ZU()}reset(){this.Cj.reset();
this.kHd=new SA;this.cHc=new SA;this.cHc.push(this.Cj.SXc);this.Czd=!1}cle(){this.Czd=!1}$L(b){this.Czd||(this.kHd.push(null),this.Czd=!0);this.kHd.push(b)}onClose(){for(;;){const b=this.kHd.pop();if(!b)break;b()}}kMj(){return!1}qPn(){this.kw(()=>!0)}kw(b){const h=this.qYd.clone();return b(h)?(this.cHc.push(h),this.Cj.uMa(h),this.$L(Object(E.a)(this,this.kVn,"onFormattingEnd")),!0):!1}uQf(b){if(Fm.a.etb){let h=2;er.a.instance.$d(()=>{h=this.xKi(b)},"AHT:HCA");return h}return this.xKi(b)}xKi(b){return b.style?
this.kw(h=>this.kMj(h,b))?1:2:2}kVn(){this.cHc.pop();this.Cj.uMa(this.qYd)}tga(){}Vke(){return 2}jcg(){return 2}kcg(){return 2}ocg(){return 2}Ccg(){return 3}Ecg(){}ble(){return 2}Fcg(){}Gcg(){}Hcg(){return 2}fle(){return 2}gle(){return 2}Wcg(){return 2}hle(){}Zcg(){return 2}ile(){return 2}jle(){return 2}mle(){return 2}nle(){return 2}kdg(){}ldg(){return 2}ule(){return 2}vle(){return 2}yle(){return 2}zle(){return 2}Ble(){return 2}Cle(){return 2}Dle(){return 2}Gle(){return 2}Pdg(){return 2}Ole(){return 2}Wdg(){return 2}Ydg(){}Zdg(){return 2}Rle(){return 2}Sle(){return 2}Tle(){return 2}Ule(){return 2}Vle(){return 2}Wle(){return 2}eeg(){return 3}Xle(){}keg(){return 2}Yle(){return 2}meg(){return 3}ame(){}reg(){}bme(){return 2}yeg(){return 3}dme(){return 2}fme(){return 2}hme(){return 2}ime(){return 2}Jeg(){}Neg(){return 3}kme(){return 2}onMenuOpen(){return 2}Teg(){}afg(){return 2}bfg(){return 2}dfg(){return 3}vme(){return 2}ffg(){return 2}wme(){return 2}Ame(){return 2}mfg(){}Ime(){return 2}yfg(){return 2}Pme(){return 2}Qme(){return 2}Ofg(){return 3}Ufg(){return 2}ane(){return 2}bne(){return 2}ene(){return 2}fne(){return 2}Yfg(){return 3}gne(){return 2}ine(){return 2}kne(){return 2}cgg(){return 2}afd(){return 2}ggg(){return 2}hgg(){return 2}nne(){return 2}igg(){return 2}lgg(){return 3}sne(){return 2}tne(){return 2}une(){return 2}vne(){return 2}Ane(){return 2}xne(){return 2}static cla(b){return b&&
-1!==b.indexOf("px")&&(b=parseInt(I.a.substring(b,0,b.indexOf("px"))),!isNaN(b))?b:0}static QLf(b){if(!b||""===b)return-1;const h=I.a.vh(b);if(-1!==h.indexOf("pt")){if(b=parseFloat(I.a.substring(b,0,h.indexOf("pt"))),!isNaN(b))return b}else if(-1!==h.indexOf("px")&&(b=parseFloat(I.a.substring(b,0,h.indexOf("px"))),!isNaN(b)))return 3*b/4;return-1}static rAi(b){const h=oj.QLf(b);return-1===h?(v.ULS.sendTraceTag(508678240,307,50,`Unhandled unit or blank string , is blankstring => ${!b}`),-1):0>h?(v.ULS.sendTraceTag(508925786,
307,50,"Negative margin in px or pt"),-1):h}static sAi(b){b=oj.QLf(b);return Jg.a.dK(b)}static zIm(b){return oj.QLf(b)}static iDi(b){return b&&""!==b?oj.cla(b):null}static MF(b){let h=null,r=null,A=null,M=null;b&&b.Df&&(h=oj.jU(b.Df,"id"),r=oj.jU(b.Df,"lang"),A=b.Df.tagName,b.b5k&&(M=Object.assign(new $I,{x:oj.cla(b.Df.style.left),y:oj.cla(b.Df.style.top),left:oj.iDi(b.Df.style.left),top:oj.iDi(b.Df.style.top)})),void 0===h&&(h=""),void 0===r&&(r=""));return new cs.a(new Hv(h,A),b.fD,null,r,M)}static jU(b,
h){return b[h]}}Object(u.a)(oj,"AHtmlTranslator",null,[511]);class ax extends cs.a{constructor(b,h,r,A=0,M=0,aa=null){super(aa?aa.Mba:null,aa?aa.fD:null,aa?aa.WCa:null,aa?aa.cultureName:null,aa?aa.yHa:null);this.width=A;this.height=M}}Object(u.a)(ax,"AugmentationSemanticArgs",cs.a,[]);var cG=d(1253);class jw{constructor(){this.stop=this.color=null}}Object(u.a)(jw,"ColorStopPair",null,[]);var Gp=d(1993);class dG{constructor(){this.direction=null;this.jVc=new ht.a}NLi(){return!!this.direction&&0<this.direction.length}}
Object(u.a)(dG,"LinearGradient",null,[]);class eG{constructor(){this.fnc=!1}}Object(u.a)(eG,"HtmlTranslatorContext",null,[]);var jo=d(1862);class TA{constructor(b,h){this.spaceBefore=b;this.spaceAfter=h}}Object(u.a)(TA,"IndentationProperties",null,[]);var fp=d(1250);class xu extends cs.a{constructor(b,h,r,A,M=null,aa=0,oa=null,Ja=null,fb=!1,Cb=!1,Gb=69905,Sb=null){super(Sb?Sb.Mba:null,Sb?Sb.fD:null,Sb?Sb.WCa:null,Sb?Sb.cultureName:null,Sb?Sb.yHa:null);this.colSpan=b;this.rowSpan=h;this.width=r;this.Boc=
Cb;this.height=A;this.mab=fb;this.shadingColor=M;this.verticalAlignment=aa;this.Fna=oa;this.VAe=Ja;this.V$=Gb}}Object(u.a)(xu,"TableCellSemanticArgs",cs.a,[]);class bx extends cs.a{constructor(b,h=null){super(h?h.Mba:null,h?h.fD:null,h?h.WCa:null,h?h.cultureName:null,h?h.yHa:null);this.height=b}}Object(u.a)(bx,"TableRowSemanticArgs",cs.a,[]);class Ny extends cs.a{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb=null,Gb=-1,Sb=null){super(Sb?Sb.Mba:null,Sb?Sb.fD:null,Sb?Sb.WCa:null,Sb?Sb.cultureName:null,Sb?Sb.yHa:
null);this.zVd=null;this.rowCount=b;this.inb=h;this.width=r;if(M)for(this.zVd=Array(M.length),b=0;b<M.length;++b)this.zVd[b]=M[b];this.rWf=aa;this.VFg=Ja;this.Rbn=oa;this.mab=A;this.zae=fb;this.styleId=Cb;this.tableLook=Gb}}Object(u.a)(Ny,"TableSemanticArgs",cs.a,[]);var zt=d(1263);let lp;class Rn extends oj{constructor(b,h,r=new eG,A=null,M=null){super(b);this.settings=h;this.context=r;this.Zad=A;this.cRb=M;this.kFb=null;this.GBk=qb.a.V8("none",1,"disc",3,"circle",4,"square",5,"1",7,"A",10,"a",8,
"I",11,"i",9,"armenian",7,"decimal",7,"decimal-leading-zero",7,"georgian",7,"lower-alpha",8,"lower-greek",8,"lower-latin",8,"lower-roman",9,"upper-alpha",10,"upper-latin",10,"upper-roman",11);this.gNj=new Set(["DIV","P"]);this.qTo=new Set("DIV P H1 H2 H3 H4 H5 H6".split(" "))}get L5i(){return this.GBk}Zzi(b,h){var r;if((r=b.style?b.style.listStyleType:"")&&""!==r&&(r=this.L5i[I.a.vh(r)])||(r=oj.jU(b,"type"))&&""!==r&&(r=this.L5i[r]))return r;if((r=b.tagName.toLowerCase())&&("ol"===r||"ul"===r)&&(b=
b.className))if("ul"===r)switch(b=Rn.P8d(b,"BulletListStyle"),b){case "BulletListStyle1":return 3;case "BulletListStyle2":return 4;case "BulletListStyle3":return 5}else if("ol"===r)switch(b=Rn.P8d(b,"NumberListStyle"),b){case "NumberListStyle1":return 7;case "NumberListStyle2":return 8;case "NumberListStyle3":return 9;case "NumberListStyle4":return 10;case "NumberListStyle5":return 11}return h}Qzi(b){let h=-1,r=b.tagName.toLowerCase();if("ol"===r||"ul"===r){b=Fd.a.Iwi(b,"li");if(!b)return h;r="li"}if("li"===
r){h=(h=this.d4d(b,"data-aria-level",0))?h:-1;if(0<h)return h-1;if(b=Fd.a.Iwi(b,"p"))return Rn.Rvm(b)-1}return h}d4d(b,h,r){b=b.getAttribute(h);b=parseInt(b);return isNaN(b)||0>b?r:b}TWn(){this.kFb.pop();this.Cj.LCa()}R4c(b,h){this.kw(M=>M.eha(0,0));const r=this.Zzi(b.Df,h?6:2);let A=1;h&&(A=this.d4d(b.Df,"start",1));h=!1;h=b.Df.getAttribute("data-pasteFromRc");(h=!!h&&"true"===h)&&b.Df.removeAttribute("data-pasteFromRc");(Y.a.u7||Y.a.uj)&&Rn.bVd(b.Df);b=new fp.a(r,A,oj.MF(b),0,-1,h);this.kFb.push(b);
this.Cj.NCa(b);this.$L(Object(E.a)(this,this.TWn,"onListElementClose"));return 1}cIl(b,h,r){return(h=h.getAttribute(r))?b.ltf(h):!1}reset(){super.reset();this.kFb=new SA}kMj(b,h){if(Fm.a.etb){let r=!1;er.a.instance.$d(()=>{r=this.lMj(b,h)},"DHT:SFFA");return r}return this.lMj(b,h)}lMj(b,h){var r,A,M,aa,oa,Ja,fb,Cb;let Gb=!1;try{var Sb=h.getAttribute("xml:lang")||oj.jU(h,"lang")}catch(Yc){Sb=null}Sb&&""!==Sb&&(Gb=b.Kyg(Sb)||Gb);(Sb=oj.jU(h,"dir"))&&(Gb=b.Fwc(Sb)||Gb);if(this.settings.A_o(this.context)&&
h.getAttribute)for(Sb=0;Sb<Rn.eXj.length;Sb++)Gb=this.cIl(b,h,Rn.eXj[Sb])||Gb;Sb=h.style;const pc=window.performance.now();var zc;Fm.a.ita?zc=null===(r=this.cRb)||void 0===r?void 0:r.Z3l(h):Fm.a.eoc&&(zc=getComputedStyle(h));zt.a.uCe+=window.performance.now()-pc;zt.a.nke+=1;Fm.a.Gek&&(Sb=getComputedStyle(h));if(Sb){if(Sb.fontWeight||h instanceof HTMLHeadingElement&&Fm.a.ude&&Fm.a.ita)r=I.a.kC(null!==(A=null===zc||void 0===zc?void 0:zc.fontWeight)&&void 0!==A?A:Sb.fontWeight),A=parseInt(r),isNaN(A)?
"BOLD"===r?Gb=b.JN(!0)||Gb:"NORMAL"===r&&(Gb=b.JN(!1)||Gb):Gb=600<=A?b.JN(!0)||Gb:b.JN(!1)||Gb;if(this.settings.KQj&&Sb.fontSize||h instanceof HTMLHeadingElement&&Fm.a.ude&&Fm.a.ita)A=null!==(M=null===zc||void 0===zc?void 0:zc.fontSize)&&void 0!==M?M:Sb.fontSize,M=oj.zIm(A),0<M&&(Gb=b.xwe(Math.floor(2*M))||Gb);if((null===(aa=y.AFrameworkApplication.J)||void 0===aa?0:aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&this.gNj.has(h.tagName)||h instanceof
HTMLHeadingElement&&Fm.a.ude&&Fm.a.ita)if(aa=oj.rAi(null!==(oa=null===zc||void 0===zc?void 0:zc.marginTop)&&void 0!==oa?oa:Sb.marginTop),oa=oj.rAi(null!==(Ja=null===zc||void 0===zc?void 0:zc.marginBottom)&&void 0!==Ja?Ja:Sb.marginBottom),-1!==aa||-1!==oa)Gb=b.eha(aa,oa)||Gb;Fm.a.PZi&&this.qTo.has(h.tagName)&&(Ja=oj.sAi(null!==(fb=null===zc||void 0===zc?void 0:zc.marginLeft)&&void 0!==fb?fb:Sb.marginLeft),fb=oj.sAi(null!==(Cb=null===zc||void 0===zc?void 0:zc.marginRight)&&void 0!==Cb?Cb:Sb.marginRight),
Ja||fb)&&(Gb=b.ezg(Ja,fb)||Gb);this.settings.E_o(this.context)&&(this.settings.OQj&&h.getAttribute?(Cb=h.getAttribute("data-indent"))&&0<Cb.length&&(Cb=Ah.a.qj(parseInt(Cb),0)+"px",Gb=b.xxe(Cb)||Gb):Sb.textIndent&&(Gb=b.xxe(Sb.textIndent)||Gb));this.settings.z_o(this.context)&&Sb.marginLeft&&(this.settings.OQj&&h.getAttribute?(Cb=h.getAttribute("data-margin"))&&0<Cb.length&&(Gb=b.pna(Sb.marginLeft)||Gb):"TABLE"!==h.tagName&&(Gb=b.pna(Sb.marginLeft)||Gb));if(this.settings.C_o(this.context)&&(Cb=h.getAttribute("style"))&&
""!==Cb)for(Cb=Cb.split(";"),fb=0;fb<Cb.length;fb++)zc=Cb[fb].trim(),zc.startsWith("tab-stops")&&(Gb=b.Czg(zc.replace("tab-stops:",""))||Gb);this.settings.y_o(this.context)&&Sb.lineHeight&&(Gb=b.GE(Sb.lineHeight)||Gb);this.settings.v_o&&(Cb=Sb.textTransform?I.a.vh(Sb.textTransform):null,fb=Sb,fb=fb.fontVariantCaps?I.a.vh(fb.fontVariantCaps):null,zc=Sb.fontVariant?I.a.vh(Sb.fontVariant):null,"uppercase"===Cb?Gb=b.Jnd("uppercase")||Gb:"small-caps"===fb||zc&&0<=zc.indexOf("small-caps")?Gb=b.Jnd("small-caps")||
Gb:this.settings.Xjl&&"none"===Cb&&(Gb=b.Jnd("none")||Gb));this.settings.D_o(this.context)&&Sb.textAlign&&(Gb=b.J_b(I.a.vh(Sb.textAlign))||Gb);Sb.fontStyle&&(Cb=I.a.kC(Sb.fontStyle),"ITALIC"===Cb||"OBLIQUE"===Cb?Gb=b.Yxb(!0)||Gb:"NORMAL"===Cb&&(Gb=b.Yxb(!1)||Gb));Cb=Rn.xLm(h);if(Sb.textDecoration||Cb)fb=I.a.vh(Sb.textDecoration||""),Cb=I.a.vh(Cb||""),h.parentNode&&h.parentNode.tagName&&"a"===I.a.vh(h.parentNode.tagName)?(zc=(h.querySelector(".TextRun")||h).className)&&-1<zc.indexOf("Underlined")&&
(Gb=b.z8(!0)||Gb):Sb.jkq||Rn.isUnderline(fb)||Rn.isUnderline(Cb)?Gb=b.z8(!0)||Gb:this.settings.URj&&(Gb=b.z8(!1)||Gb),Sb.ikq||Rn.mYi(fb)||Rn.mYi(Cb)?Gb=b.rna(!0)||Gb:this.settings.URj&&(Gb=b.rna(!1)||Gb);if(Sb.verticalAlign){Cb=I.a.kC(Sb.verticalAlign);fb=this.glo(Cb);if("SUB"===Cb||this.settings.NQj(this.context)&&h.className&&-1<h.className.indexOf("Subscript")||0>fb&&this.settings.tRj)Gb=b.TNa(!0)||Gb;else if("SUPER"===Cb||this.settings.NQj(this.context)&&h.className&&-1<h.className.indexOf("Superscript")||
0<fb&&this.settings.tRj)Gb=b.qva(!0)||Gb;this.settings.KQj&&("SUB"===Cb||"SUPER"===Cb)&&h.getAttribute&&(Cb=parseFloat(h.getAttribute("data-fontsize")),isNaN(Cb)||(Gb=b.xwe(Math.floor(2*Cb))||Gb))}Cb=!1;y.AFrameworkApplication.J&&(Cb=y.AFrameworkApplication.J.$("CopyAndPasteFontTelemetryIsEnabled"));this.settings.x_o&&Sb.fontFamily&&(this.settings.G_o&&h.getAttribute?(fb=h.getAttribute("data-usefontface"))&&"true"===fb&&(Cb&&v.ULS.sendTraceTag(524038490,307,50,"Customized fontface"),Gb=this.iMj(b,
Sb.fontFamily,Gb)):Gb=this.iMj(b,Sb.fontFamily,Gb));fb=null;this.settings.w_o&&Sb.color&&(fb=Gp.a.rra(Sb.color));zc=!!fb;this.settings.F_o(this.context)&&h.getAttribute&&(fb=h.getAttribute("data-scheme-color"),fb=null!==fb?fb:"",zc=""!==fb||!this.context.fnc||Rn.Tpn(h));zc&&(Gb=b.Zw(fb)||Gb);!this.settings.t_o||!Sb.backgroundColor||h.tagName&&Rn.pep.contains(I.a.kC(h.tagName))||(fb=Sb.backgroundColor,Gb=Fm.a.ccn&&this.gNj.has(h.tagName)?b.w8(Gp.a.rra(fb))||Gb:b.RDa(Gp.a.rra(fb))||Gb);if(this.settings.u_o&&
Sb.backgroundImage&&h.className&&-1<h.className.indexOf("Highlight")&&(Sb=Rn.gOm(Sb.backgroundImage))&&0<Sb.jVc.count){fb=Sb.jVc.K(0).color;zc=!0;for(Ja=0;Ja<Sb.jVc.count&&(zc=zc&&fb===Sb.jVc.K(Ja).color,zc);Ja++);zc&&(Cb&&v.ULS.sendTraceTag(524038491,307,50,"Paste text with highlight"),Gb=b.RDa(Gp.a.rra(fb))||Gb)}}this.settings.MQj(this.context)&&h.getAttribute&&(Sb=h.getAttribute("data-ccp-props"))&&(Gb=b.pca(Sb)||Gb);h.getAttribute&&((Sb=h.getAttribute("data-ccp-charstyle"))&&this.settings.uyb&&
(Gb=b.ewe(Sb)||Gb),(h=h.getAttribute("data-ccp-parastyle"))&&this.settings.uyb&&(Gb=b.fxe(h)||Gb));return Gb}G1o(b){if(this.settings.H1o)for(b=b.parentNode;b&&b.tagName;){if(b.className&&Object.getType(b.className)===String&&-1<I.a.kC(b.className).indexOf("MSOCOM"))return!0;if("DIV"===I.a.kC(b.tagName))break;b=b.parentNode}return!1}iMj(b,h,r){h=Rn.Aem(h);let A=!1,M=0;if(!h)return r;for(const aa of h){if(A=b.Jdb(aa,this.settings.Xbp))break;M++}1<h.length&&(A?v.ULS.sendTraceTag(508889217,307,50,"Secondary font matched from font-family at : {0} out of {1}",
M+1,h.length):v.ULS.sendTraceTag(508889216,307,50,"Secondary fonts {0} available in font-family but no match found",h.length));return A||r}glo(b){let h=0;b&&b.length&&(b=parseInt(b),isNaN(b)||(h=b));return h}tga(b,h){"\u200b"===b&&(b="\u00a0");h&&h.Df&&this.G1o(h.Df)&&(b="");this.Cj.tga(b,oj.MF(h))}Vke(b){const h=oj.jU(b.Df,"href");return h&&""!==h?(this.Cj.wYa(h,oj.MF(b)),this.$L(Object(E.a)(this.Cj,this.Cj.vYa,"onAnchorEnd")),1):2}ble(){return this.kw(b=>b.JN(!0))?1:2}fle(){return this.kw(b=>b.oQf())?
1:2}gle(b){this.Cj.JF(oj.MF(b));this.$L(Object(E.a)(this.Cj,this.Cj.eH,"onParagraphEnd"));return 1}hle(b){this.Cj.Dba(oj.MF(b))}ile(b){this.Cj.JF(oj.MF(b));this.$L(Object(E.a)(this.Cj,this.Cj.eH,"onParagraphEnd"));return 1}mle(){return this.kw(b=>b.Yxb(!0))?1:2}jle(b){this.kw(h=>h.J_b("center"));this.Cj.JF(oj.MF(b));this.$L(Object(E.a)(this.Cj,this.Cj.eH,"onParagraphEnd"));return 1}nle(){return this.kw(b=>b.Jdb("consolas"))?1:2}vle(){return this.kw(b=>b.rna(!0))?1:2}ule(b){return this.R4c(b,!1)}yle(){return this.kw(b=>
b.Yxb(!0))?1:2}zle(b){return this.R4c(b,!1)}Ble(b){var h=b.Df.getAttribute("data-render-src");const r=b.Df.getAttribute("data-render-method");if(h&&""!==h&&r&&""!==r){const oa=b.Df.getAttribute("data-render-fallback");let Ja=0,fb=0;if(b.Df.currentStyle){var A=b.Df.currentStyle.width,M=b.Df.currentStyle.height;A&&-1!==A.indexOf("px")&&(A=parseInt(I.a.substring(A,0,A.indexOf("px"))),isNaN(A)||(Ja=A));M&&-1!==M.indexOf("px")&&(M=parseInt(I.a.substring(M,0,M.indexOf("px"))),isNaN(M)||(fb=M))}b=new ax(h,
r,oa,Ja,fb,oj.MF(b));this.Cj.Xbb(b);return 2}(Y.a.u7||Y.a.uj)&&(h=b.Df.className.match(RegExp("^SCX[0-9a-zA-Z]+$")))&&h.length&&Rn.bVd(b.Df);const aa=b.Df.getAttribute("align");this.kw(oa=>oa.J_b(aa));this.Cj.JF(oj.MF(b));this.$L(Object(E.a)(this.Cj,this.Cj.eH,"onParagraphEnd"));return 1}Cle(b){this.Cj.JF(oj.MF(b));this.$L(Object(E.a)(this.Cj,this.Cj.eH,"onParagraphEnd"));return 1}Dle(b){this.Cj.JF(oj.MF(b));this.$L(Object(E.a)(this.Cj,this.Cj.eH,"onParagraphEnd"));return 1}Gle(){return this.kw(b=>
b.Yxb(!0))?1:2}Ole(b){return this.kw(h=>{var r=Rn.Jqm(b.Df.getAttribute("face"));r=h.Jdb(r);h=h.Zw(Gp.a.rra(b.Df.getAttribute("color")));return r||h})?1:2}Rle(b){this.kw(h=>this.settings.uyb?h.$xb(1):h.byb(1));this.Cj.JF(oj.MF(b));this.$L(Object(E.a)(this.Cj,this.Cj.eH,"onParagraphEnd"));return 1}Sle(b){this.kw(h=>this.settings.uyb?h.$xb(2):h.byb(2));this.Cj.JF(oj.MF(b));this.$L(Object(E.a)(this.Cj,this.Cj.eH,"onParagraphEnd"));return 1}Tle(b){this.kw(h=>this.settings.uyb?h.$xb(3):h.byb(3));this.Cj.JF(oj.MF(b));
this.$L(Object(E.a)(this.Cj,this.Cj.eH,"onParagraphEnd"));return 1}Ule(b){this.kw(h=>this.settings.uyb?h.$xb(4):h.byb(4));this.Cj.JF(oj.MF(b));this.$L(Object(E.a)(this.Cj,this.Cj.eH,"onParagraphEnd"));return 1}Vle(b){this.kw(h=>this.settings.uyb?h.$xb(5):h.byb(5));this.Cj.JF(oj.MF(b));this.$L(Object(E.a)(this.Cj,this.Cj.eH,"onParagraphEnd"));return 1}Wle(b){this.kw(h=>this.settings.uyb?h.$xb(6):h.byb(6));this.Cj.JF(oj.MF(b));this.$L(Object(E.a)(this.Cj,this.Cj.eH,"onParagraphEnd"));return 1}Xle(b){this.Cj.Dba(oj.MF(b))}ame(b){var h=
b.Df;const r=h.src,A=h.alt,M=h.Q3p,aa=h.getAttribute("data-external-content-url");let oa=0,Ja=0;h.style&&(oa=oj.cla(h.style.width),Ja=oj.cla(h.style.height));oa&&Ja||(oa=h.width,Ja=h.height);let fb=0,Cb=0;b.Df.currentStyle&&(oa||Ja||(oa=oj.cla(b.Df.currentStyle.width),Ja=oj.cla(b.Df.currentStyle.height)),fb=oj.cla(b.Df.currentStyle.maxWidth),Cb=oj.cla(b.Df.currentStyle.maxHeight));!Fm.a.Fhn||oa&&Ja||(Ja=oa=0);let Gb=null;const Sb=h.getAttribute(im.KYd);if(Sb&&(v.ULS.sendTraceTag(524038492,307,50,
"Chart paste from xlo"),y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("ChartsPasteFromXLOIsEnabled"))){const pc=h.getAttribute(im.Iuf),zc=h.getAttribute(im.Juf),Yc=h.getAttribute(im.Guf),Kd=h.getAttribute(im.Huf),ke=h.getAttribute(im.FXc);h=h.getAttribute(im.Kuf);pc&&Kd&&(Gb=new cG.a(Sb,pc,zc,Yc,Kd,ke,h))}b=new jo.a(r,A,oa,Ja,oj.MF(b),fb,Cb,M,null,aa,Gb);this.Cj.JCa(b)}Yle(){return this.kw(b=>b.Yxb(!0))?1:2}bme(){return this.kw(b=>b.z8(!0))?1:2}dme(){return this.kw(b=>b.Jdb("consolas"))?
1:2}fme(b){this.Cj.JF(oj.MF(b));this.$L(Object(E.a)(this.Cj,this.Cj.eH,"onParagraphEnd"));return 1}hme(b){this.Cj.JF(oj.MF(b));this.$L(Object(E.a)(this.Cj,this.Cj.eH,"onParagraphEnd"));return 1}ime(b){let h;const r=this.Zzi(b.Df,0);let A=this.d4d(b.Df,"value",0);0<this.kFb.count?h=this.kFb.ZU():(h=new fp.a(2,1,oj.MF(b)),A||(A=1));var M=Rn.awm(b.Df,fp.a.b3j);3!==M&&(h.Ys=M);M=h.listLevel;let aa=h.listId;this.settings.LQj?(M=this.Qzi(b.Df),M=0>M&&0>h.listLevel&&0<this.kFb.count?h.listLevel=this.kFb.count-
1:h.listLevel=0<=M?M:h.listLevel,this.Zad&&this.Zad.b<M&&(this.Zad.b=M)):0>M&&(M=h.listLevel=this.Qzi(b.Df));1>aa&&(aa=h.listId=this.d4d(b.Df,fp.a.Tad,0));b.Df.getAttribute(fp.a.Sge)&&(h.levelText=b.Df.getAttribute(fp.a.Sge));var oa=b.Df.getAttribute(fp.a.g3f);oa&&(h.font=oa);oa=!1;y.AFrameworkApplication.J&&(oa=y.AFrameworkApplication.J.$("FollowDestinationThemePasteIsEnabled"));if(oa){var Ja=b.Df.getAttribute("data-charcodes");oa=[];if(Ja&&""!==Ja)if(-1<Ja.indexOf(",")){Ja=Ja.split(",");for(var fb=
0;fb<Ja.length;fb++)oa.push(parseInt(Ja[fb]))}else oa.push(parseInt(Ja));if(oa&&0<oa.length){Ja=Array(oa.length);for(fb=0;fb<oa.length;fb++)Ja[fb]=oa[fb];h.hnf=Ja}(oa=b.Df.getAttribute("data-buAutoNum"))&&0<oa.length&&(h.buAutoNum=parseInt(oa))}(M=0<=M&&0<aa)&&Rn.bVd(b.Df);h.b6k(r,A,M);h.e3f=this.Gvm(b.Df);this.Cj.xMa(h.clone());this.$L(Object(E.a)(this.Cj,this.Cj.MCa,"onListItemEnd"));return 1}Gvm(b){var h=b.getAttribute(fp.a.w5i);if(!h)return null;b=void 0;try{b=JSON.parse(h)}catch{v.ULS.sendTraceTag(524038493,
307,15,"getListDefnPropsFromElement for CCP - Cannot parse list definition properties from element attribute.")}if(!b)return null;h=new wg.DictionaryPropertySet;for(const r in b)h.Xzg(+r,b[r]);return h}onMenuOpen(b){return this.R4c(b,!1)}kme(b){if(this.kw(h=>h.vwc(!0))){const h=b.Df.getAttribute("OuterHtml");this.Cj.AYa(h,oj.MF(b));this.$L(Object(E.a)(this.Cj,this.Cj.Tbb,"onMathEnd"))}return 1}vme(b){return this.R4c(b,!0)}wme(b){this.Cj.JF(oj.MF(b));this.$L(Object(E.a)(this.Cj,this.Cj.eH,"onParagraphEnd"));
return 1}Ame(b){const h=b.Df.getAttribute("align");this.kw(A=>A.J_b(h));const r=b.Df.parentNode;r&&r.tagName.toLowerCase().startsWith("li")&&Rn.bVd(b.Df,Y.a.u7||Y.a.uj);this.Cj.JF(oj.MF(b));this.$L(Object(E.a)(this.Cj,this.Cj.eH,"onParagraphEnd"));return 1}Ime(){this.kw(b=>b.Jdb("consolas"));this.Cj.zvb();this.$L(Object(E.a)(this.Cj,this.Cj.yvb,"onPreFormattedTextEnd"));return 1}Pme(){return this.kw(b=>b.rna(!0))?1:2}Qme(){return this.kw(b=>b.Jdb("consolas"))?1:2}ane(){return this.kw(b=>b.XCg())?
1:2}bne(b){var h=b.Df.attributes.getNamedItem("style"),r="";h&&h.value&&(r=h.value);h=Gp.a.P6n(r);if(0<h&&this.settings.p6m){for(r=0;r<h;r++)this.Cj.Dvb(oj.MF(b));return 3}return 2}ene(){return this.kw(b=>b.rna(!0))?1:2}fne(){return this.kw(b=>b.JN(!0))?1:2}gne(){return this.kw(b=>b.TNa(!0))?1:2}ine(){return this.kw(b=>b.qva(!0))?1:2}kne(b){this.kw(Gb=>Gb.$D()&&Gb.Jtg());Gp.a.z9d(b.Df,this);const h=Gp.a.HIi(b.Df),r=Gp.a.$si(b.Df),A=Gp.a.kN(b.Df),M=Gp.a.lN(b.Df),aa=!parseInt(oj.jU(b.Df,"border")),
oa=Gp.a.tpn(b.Df);let Ja=-1,fb="";var Cb=-1;b.Df.attributes.hasOwnProperty("style")&&-1!==(Cb=b.Df.attributes.getNamedItem("style").value.indexOf("mso-yfti-tbllook:"))?Ja=parseInt(b.Df.attributes.getNamedItem("style").value.substr(Cb+17)):b.Df.attributes.hasOwnProperty($w.a.LYd.toString())&&(Ja=parseInt(b.Df.attributes.getNamedItem($w.a.LYd.toString()).value));Cb=-1;b.Df.attributes.hasOwnProperty("class")&&-1!==(Cb=b.Df.attributes.getNamedItem("class").value.indexOf("Mso"))?fb=b.Df.attributes.getNamedItem("class").value.substr(Cb).split(" ")[0]:
b.Df.attributes.hasOwnProperty($w.a.GXc.toString())&&(fb=b.Df.attributes.getNamedItem($w.a.GXc.toString()).value);this.Cj.Jba(new Ny(0,0,h.value,h.P_i,null,aa,oa,r,new TA(A.value,M.value),fb,Ja,oj.MF(b)));this.$L(Object(E.a)(this.Cj,this.Cj.Hba,"onTableEnd"));return 1}afd(b){const h=Gp.a.Txi(b.Df),r=Gp.a.HIi(b.Df);if(!r.value&&r.kde&&this.settings.wqj)return 3;let A=parseInt(oj.jU(b.Df,"colSpan"));if(void 0===A||null===A||""===A+"")A=r.value?1:0;let M=parseInt(oj.jU(b.Df,"rowSpan"));if(void 0===M||
null===M||""===M+"")M=h.value?1:0;let aa=!1;b.Df.attributes.hasOwnProperty("style")&&(aa=-1!==b.Df.attributes.getNamedItem("style").value.indexOf("mso-cell-special:placeholder")||-1!==b.Df.attributes.getNamedItem("style").value.indexOf("mso-cell-special: placeholder"));!aa&&b.Df.attributes.hasOwnProperty("class")&&(aa=-1!==b.Df.attributes.getNamedItem("class").value.indexOf("SkippedGhostCell"));let oa=69905;if(b.Df.attributes.hasOwnProperty($w.a.Fuf.toString())){var Ja=parseInt(b.Df.attributes.getNamedItem($w.a.Fuf.toString()).value);
isNaN(Ja)||(oa=Ja)}Ja=Gp.a.rra(b.Df.style.backgroundColor);const fb=Gp.a.lOm(b.Df);this.kw(Sb=>Sb.eha(0,0));Gp.a.z9d(b.Df,this);const Cb=Gp.a.$si(b.Df),Gb=this.settings.y7n?Gp.a.eim(b.Df):null;b=new xu(A,M,r.value,h.value,Ja,fb,Cb,Gb,r.P_i,aa,oa,oj.MF(b));this.Cj.Gba(b);this.$L(Object(E.a)(this.Cj,this.Cj.Fba,"onTableCellEnd"));this.qPn();return 1}nne(b){const h=this.afd(b);if(3===h)return h;this.kw(r=>{const A=r.JN(!0);r=r.J_b("center");return A||r});Gp.a.z9d(b.Df,this);return 1}sne(b){Gp.a.z9d(b.Df,
this);const h=Gp.a.Txi(b.Df);if(h.kde&&!h.value&&this.settings.wqj)return 3;this.Cj.X7(new bx(h.value,oj.MF(b)));this.$L(Object(E.a)(this.Cj,this.Cj.Iba,"onTableRowEnd"));return 1}tne(){return this.kw(b=>b.Jdb("consolas"))?1:2}une(){return this.kw(b=>b.z8(!0))?1:2}vne(b){return this.R4c(b,!1)}xne(){return 2}Ane(){return this.kw(b=>b.z8(!0))?1:2}static fom(b){if(!b)return null;b=b.split(",");1<b.length&&v.ULS.sendTraceTag(508889187,307,50,"Secondary fonts available in font-family");return b[0]}static yem(b){return b?
b.split(","):null}static t1j(b){if(!b)return null;b=I.a.zrg(b.trim(),'"');return b=I.a.zrg(b,"'")}static Jqm(b){if(!b)return null;b=Rn.fom(b);return b=Rn.t1j(b)}static Aem(b){var h;if(!b)return null;b=null===(h=Rn.yem(b))||void 0===h?void 0:h.map(r=>Rn.t1j(r));h=null===b||void 0===b?void 0:b.filter(r=>!!r);return null!==h&&void 0!==h?h:null}static nNh(b,h){h=h.trim();var r=h.match(RegExp("^-?[0-9]+deg$"));if(r&&0<r.length){if(b.NLi())return!1;b.direction=h;return!0}if((r=h.match(RegExp("^to +(left|right|top|bottom|lefttop|leftbottom|righttop|rightbottom)$")))&&
0<r.length){if(b.NLi())return!1;b.direction=h;return!0}var A=(r=h.match(RegExp("^rgb\\(.*\\)")))&&0<r.length?h.indexOf(")")+1:h.indexOf(" ");r=-1===A?h:Gp.a.rra(h.substr(0,A).trim());if(!r||""===r)return!1;h=-1===A?"":h.substr(A).trim();A=new jw;A.color=r;A.stop=h;b.jVc.add(A);return!0}static gOm(b){try{if(!b)return null;b=b.trim();if(!b.startsWith("linear-gradient(")||!b.endsWith(")"))return null;let h=b.substr(16);h=h.substr(0,h.lastIndexOf(")"));const r=new dG;for(;0<h.trim().length;){let A=h.indexOf(",");
const M=h.indexOf("(");if(0<M&&M<A){const aa=h.indexOf(")");if(aa<M)return null;A=h.indexOf(",",aa)}if(-1===A){if(!Rn.nNh(r,h))return null;h=""}else{const aa=h.substr(0,A);h=h.substr(A+1);if(!Rn.nNh(r,aa))return null}}return r}catch(h){return null}}static P8d(b,h){b=b.split(" ");if(0<b.length)for(let r=0;r<b.length;r++)if(0<=b[r].indexOf(h))return b[r];return""}static bVd(b,h=!1){b&&3!==b.nodeType&&(b.style.margin="",h&&Rn.p1h(b,h))}static p1h(b,h){if(b)for(b=b.firstChild;b;)3!==b.nodeType&&(b.style&&
(b.style.margin=""),h&&Rn.p1h(b,h)),b=b.nextSibling}static Rvm(b){if("p"!==b.tagName.toLowerCase())return-1;if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf("mso-list")){b=b.split(";");for(let r=0;r<b.length;r++){var h=b[r].split(":");if(2===h.length&&"mso-list"===h[0].trim()&&(h=h[1].trim().split(" "),3===h.length))return Number.parseInvariant(h[1].substr(5))}}return-1}static awm(b,h){if(!b)return 3;switch(b.getAttribute(h)){case "default":return 0;case "numbered":return 1;case "bullet":return 2;
default:return 3}}static Tpn(b){return!(void 0===b.className||null===b.className)&&b.className.startsWith("TextRun")}static xLm(b){b=b.style.textDecorationLine;return void 0===b||null===b?null:b}static mYi(b){return 0<=b.indexOf("line-through")}static isUnderline(b){return 0<=b.indexOf("underline")}}Rn.pep=(lp=new ib.a,lp.add("TABLE"),lp.add("THEAD"),lp.add("TBODY"),lp.add("TFOOT"),lp.add("TR"),lp.add("TH"),lp.add("TD"),lp);Rn.eXj=["data-ccp-charstyle-defn","data-ccp-parastyle-defn","data-ccp-charstyle-linked-defn",
"data-ccp-parastyle-linked-defn"];Object(u.a)(Rn,"DefaultHtmlTranslator",oj,[]);var tr=d(1013);class An{constructor(b=null){this.Y5=b||tr.a.LIi("");this.Duh=Number.parseInvariant((new Date).format("HHmmss"))}get Mc(){return this.Y5}process(b,h){if(b&&b.querySelectorAll){const aa=b.querySelectorAll("p");if(aa&&0<aa.length){for(var r=0,A=!1,M=aa[0].parentNode;5>r&&M&&M!==b;){r++;const oa=M.id.toLowerCase();if(oa&&oa.length&&-1!==oa.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(M,"WACEditing")&&
Sys.UI.DomElement.containsCssClass(M,"EditingSurfaceBody")){A=!0;break}M=M.parentNode}if(A&&M!==b){r=b.firstChild;for(A=!1;0<M.children.length&&M.children[0]!==r;)b.insertBefore(M.children[0],r),A=!0;if(A)for(;r;)M=r.nextSibling,b.removeChild(r),r=M}b=new Fv.a(h,Object(E.a)(this,this.keo,"processNodesDiscovery"),new RA(aa));b.qm("Word Converter Operation");b.oi=!h||h.oi;b.run()}}}keo(b,h){const r=h.nodes[h.rUa];var A=An.Mvm(r);if(A){let aa=A.PFe.replace(RegExp("level[0-9]"),"").trim();aa=aa&&aa.length?
aa:A.PFe;let oa=h.lists[aa];oa||(oa=new tC,oa.$zc=this.Duh++);let Ja=oa.Wpc[A.level-1];Ja||(Ja=new uC,Ja.level=A.level);var M=r.parentNode;if(M&&"li"===M.tagName.toLowerCase()){if(M=M.parentNode)!(M=M.tagName.toUpperCase())||"OL"!==M&&"UL"!==M||(Ja.tagName=M)}else Ja.Cub=An.twi(r,5),Ja.Cub&&Ja.Cub.length||(Ja.Cub=An.mNf(r,5)),Ja.QSf=!Ja.Cub||!Ja.Cub.length,Ja.tagName=An.swi(Ja.Cub),"UL"===Ja.tagName&&(Ja.font=this.fxi(r,5));A.$zc=oa.$zc;Ja.XPn++;Ja.QSf||"li"===r.parentNode.tagName.toLowerCase()||
(M=(M=An.mNf(r,5))?M:Ja.Cub)&&M.length&&(A.tli=M,(M=An.KSo(r,M,Ja.listStyle,A.level-1))&&M.length&&(Ja.listStyle=M));h.fub[h.fub.length]=A;Ja.fub.contains(A)||Ja.fub.add(A);if(void 0===oa.Wpc[A.level-1]||null===oa.Wpc[A.level-1]||oa.Wpc[A.level-1]!==Ja)oa.Wpc[A.level-1]=Ja;h.lists[aa]&&h.lists[aa]===oa||(h.lists[aa]=oa);h.Y3i=r}else if((A=h.Y3i)&&An.bFm(r)===A&&r.tagName===A.tagName&&r.className===A.className){A.appendChild(A.ownerDocument.createElement("BR"));for(A.appendChild(A.ownerDocument.createElement("BR"));r.firstChild;)A.appendChild(r.firstChild);
r.parentNode.removeChild(r)}h.rUa++;if(h.nodes.length<=h.rUa){if(!h.fub.length)return!1;h.rUa=0;b.Oi(Object(E.a)(this,this.jeo,"processNodeConvert"))}return!0}jeo(b,h){b=h.fub[h.rUa];var r=b.e3n,A=b.PFe.replace(RegExp("level[0-9]"),"").trim();A=A&&A.length?A:b.PFe;A=h.lists[A];var M=A.Wpc[b.level-1],aa=r.parentNode.tagName.toLowerCase();if(!M.QSf&&r.parentNode&&"li"!==aa){if(aa=An.SEl(r,M)){An.a1h(r,5);const oa=r.ownerDocument.createElement("LI");oa.setAttribute("data-aria-level",String.format("{0}",
b.level));oa.setAttribute(fp.a.Tad,String.format("{0}",A.$zc));"UL"===M.tagName&&(oa.setAttribute(fp.a.Sge,String.format("{0}",b.tli)),oa.setAttribute(fp.a.g3f,String.format("{0}",M.font)));for(;r.firstChild;)oa.appendChild(r.firstChild);aa.appendChild(oa);r.parentNode.removeChild(r);"UL"===M.tagName?this.Mc.b++:this.Mc.c++}}else"li"===aa&&(M=M.tagName,r=r.parentNode,b.Zsc&&(b=r.parentNode)&&b.tagName.toUpperCase()===M&&b.setAttribute("data-pasteFromRc","true"),r.setAttribute(fp.a.Tad,String.format("{0}",
A.$zc)),"UL"===M?this.Mc.b++:this.Mc.c++);h.rUa++;return h.rUa<h.fub.length}fxi(b,h){let r=null;for(let A=0;!r&&A<b.childNodes.length;A++){const M=b.childNodes[A];r=An.Kqm(M);!r&&1===M.nodeType&&1<h&&(r=this.fxi(M,h-1))}return r}static SEl(b,h){b=An.REl(b,h.tagName);return An.gzl(b,h)}static gzl(b,h){if(h.tagName!==b.tagName){for(h=b.ownerDocument.createElement(h.tagName);b.firstChild;)h.appendChild(b.firstChild);b.parentNode.insertBefore(h,b);b.parentNode.removeChild(b);b=h}return b}static REl(b,
h){h=b.ownerDocument.createElement(h?h:"UL");var r=b.getAttribute("start");r&&0<r.length&&(h.setAttribute("start",r),b.removeAttribute("start"));Fm.a.bcn&&(r=b.getAttribute("align")||b.style.textAlign)&&(h.style.textAlign=r);(r=b.className)&&0<r.length&&(r="OL"===h.tagName?Rn.P8d(r,"NumberListStyle"):Rn.P8d(r,"BulletListStyle"),0<r.length&&(Sys.UI.DomElement.addCssClass(h,r),Sys.UI.DomElement.removeCssClass(b,r)));b.parentNode.insertBefore(h,b);return h}static a1h(b,h){for(let r=0;r<b.childNodes.length;r++){const A=
b.childNodes[r];1===A.nodeType&&1<h&&An.a1h(A,h-1);if(An.mfn(A)||An.xXi(A))b.removeChild(A),r--}}static Mvm(b){if(1===b.nodeType){var h=An.gNf(b,"mso-list");if(h&&0<h.length)try{var r=h.split(" ");if(3===r.length){const A=Number.parseInvariant(r[1].substr(5)),M=new Gv(A,h,b);M.Zsc=!0;return M}}catch(A){}else if((r=b.parentNode)&&"li"===r.tagName.toLocaleLowerCase()&&(h=r.getAttribute("data-"+Ne.a.oif),r=r.getAttribute(fp.a.Tad),h&&r&&0<h.length&&0<r.length))return b=new Gv(Number.parseInvariant(h),
r+" level"+h,b),b.Zsc=!1,b}return null}static KSo(b,h,r,A){if("p"===b.tagName.toLowerCase()&&h&&h.length){if("UL"===An.swi(h))return r=An.vhm(h),Sys.UI.DomElement.addCssClass(b,r),r;var M=h.match(RegExp("^[0-9]+"));return M&&M.length?(r="NumberListStyle1",Sys.UI.DomElement.addCssClass(b,r),b.setAttribute("start",M[0]),r):(M=h.match(RegExp("^[a-zA-Z]+")))&&M.length&&(M=M[0],A=(h=M.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&h.length?An.fGm(r,A):1,1!==A&&((r=An.RWd(b,M,RegExp("^[ivxlcdm]+"),I.a.t6h,"NumberListStyle3"))||
(r=An.RWd(b,M,RegExp("^[IVXLCDM]+"),I.a.t6h,"NumberListStyle5")))||A&&((r=An.RWd(b,M,RegExp("^[a-z]+"),I.a.r6h,"NumberListStyle2"))||(r=An.RWd(b,M,RegExp("^[A-Z]+"),I.a.r6h,"NumberListStyle4"))))?r:"NumberListStyle1"}return null}static vhm(b){switch(b){case "o":return"BulletListStyle2";case "\u00a7":return"BulletListStyle3";default:return"BulletListStyle1"}}static fGm(b,h){b&&b.length||(b="");switch(b){case "NumberListStyle2":case "NumberListStyle4":b=1;break;case "NumberListStyle3":case "NumberListStyle5":b=
0;break;default:b=-1}if(0>b)switch(h%3){case 0:b=0;break;case 1:b=1;break;case 2:b=0;break;default:b=0}return b}static RWd(b,h,r,A,M){return(h=h.match(r))&&h.length?(A=A(h[0]),A=1>A?1:A,Sys.UI.DomElement.addCssClass(b,M),b.setAttribute("start",A+""),M):null}static swi(b){return An.Zbn(b)?"UL":"OL"}static Zbn(b){return!b||"\u00a7"===b||"\u00b7"===b||"o"===b||"-"===b||"\u00d8"===b||"v"===b||"\u00fc"===b||"\u2666"===b||"\u00a8"===b}static mNf(b,h){let r=null;var A;let M,aa;for(let oa=-1;!r&&oa<b.childNodes.length;oa++){const Ja=
-1===oa?b:b.childNodes[oa];if(Ja)if((A=Ja.innerHTML)&&0<A.length){if(M=A.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=M&&(aa=A.indexOf("\x3c!--[endif]--\x3e"),0<=aa)){A=A.substring(M,aa+14);Ja.innerHTML=Ja.innerHTML.replace(A,"");if(A.length){b=b.ownerDocument.createElement("span");b.innerHTML=A;r=b.innerText.trim();break}r&&r.length||(r="o")}}else 0<=oa&&1===Ja.nodeType&&1<h&&(r=An.mNf(Ja,h-1))}return r}static Kqm(b){let h=null;1===b.nodeType&&((h=An.exi(b,"font-family"))||(h=An.exi(b,"mso-ascii-font-family")));
return h}static exi(b,h){return(b=An.gNf(b,h))&&0<b.length?b.trim():null}static twi(b,h){let r=null;for(let A=0;!r&&A<b.childNodes.length;A++){const M=b.childNodes[A];An.xXi(M)?(r="string"===typeof M.innerText?M.innerText.trim():M.textContent.trim(),r.length||(r="o"),M.parentNode.removeChild(M)):1===M.nodeType&&1<h&&(r=An.twi(M,h-1))}return r}static xXi(b){return 1===b.nodeType&&(b=An.gNf(b,"mso-list"))&&0<b.length&&"ignore"===b.trim().toLowerCase()?!0:!1}static mfn(b){return 1===b.nodeType&&!b.firstChild&&
"SPAN"===b.tagName.toUpperCase()}static gNf(b,h){if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf(h)){b=b.split(";");for(let r=0;r<b.length;r++){const A=b[r].split(":");if(2===A.length&&A[0].trim()===h)return A[1].trim()}}return null}static bFm(b){do b=b.previousSibling;while(b&&An.kWi(b));return b}static kWi(b){return b?3===b.nodeType?(b=b.nodeValue,b=b.replace(An.zBk,""),!b.trim().length):1!==b.nodeType||b.firstChild!==b.lastChild||"SPAN"!==b.tagName&&"FONT"!==b.tagName?!1:An.kWi(b.firstChild):
!0}}An.zBk=RegExp("[\n|\r]","gi");Object(u.a)(An,"WacAndRichClientWordConverter",null,[506]);class Xu{constructor(){}create(b=null){return new An(b)}}Object(u.a)(Xu,"Box4WordConverterFactory",null,[693]);var ur=d(1860),Yu=d(47),cx=d(265),Uh=d(1251),kw=d(532),Oy=d(297),bJ=d(1307),At=d(1062);class Bt{constructor(b,h,r,A,M,aa=null,oa="",Ja=!0,fb=!1){this.IJa=this.Rze=this.pxb=this.Ruj=this.Jte=null;this.O8c=!1;this.zTf=null;this.Qbg=0;this.ABe=null;this.context=b;this.ne=b.view;this.px=h;this.rd=M;this.VU=
r;this.cca=A;this.KDa=this.MB=!1;this.Tne=null;this.M$a=this.Znc=!1;this.S6o=Bt.Vqf(b);this.browserName=oa;this.G8j=Ja;this.x$c=fb;this.u0a=!1;this.efc=0;if(b=Object(Xa.a)(89,M)?M:null){this.Ruj=new wg.DictionaryPropertySet;this.Ruj.Yt(b);r=b.ka(pd.a.egd,N.a.nil);this.ZUc=r!=N.a.nil?r.toString():N.a.create().toString();if(b.ka(pd.a.Rqj,!1)){this.Znc=!0;this.M$a=b.ka(pd.a.M$a,!1);this.Tne=aa;for(aa=this.ne.mb.Mg;aa.Qw;)aa=aa.getContext(0);if(M=Object(ya.a)(Gn.AParagraphNode,aa.node)){r=0;A=Gd.ParagraphReader.textLength(M);
switch(aa.contextId){case lc.a.Cd:r=aa.cpBegin;A=aa.cpEnd;break;case lc.a.Uc:r=A}this.Jte=Wa.FormattingReader.E5d(aa.node,r,aa.Fb);v.ULS.shipAssertTag(6305503,307,!!this.Jte);M=Nc.a.Ajc(M);for(const Cb of M)Cb.cpEnd<=r||Cb.cpBegin>=A||Bt.Jp.cV(aa.node,Cb.hyperlink)}}this.KDa=b.ka(pd.a.KDa,!1);this.u0a=b.ka(pd.a.u0a,!1);this.pxb=b.ka(pd.a.pxb,null)}else this.ZUc=N.a.create().toString();h&64&&(this.KDa=!0)}static get Jp(){return null!=Bt.XWg?Bt.XWg:Bt.XWg=Za.a.instance.resolve(82)}static Vqf(b){if(b){if(b.Qw){for(let h=
0;h<b.length;h++)if(Bt.Vqf(b.getContext(h)))return!0;return!1}if(Object(Xa.a)(kw.a,b))return Bt.Vqf(b.Ik);if(Gd.ParagraphReader.Vb(b.node)&&b.node.RQ)return!0}return!1}}Object(u.a)(Bt,"ClipboardActionArguments",null,[]);var Py;(function(b){b[b.paste=1]="paste";b[b.mkq=2]="textOnly";b[b.Noj=4]="overtype";b[b.cE=16]="copy";b[b.zUp=32]="deleteSelection";b[b.move=64]="move";b[b.jmq=256]="useSystemClipboard";b[b.JYp=512]="forceInternalClipboard";b[b.uZa=4096]="reformatPastedContent";b[b.Dcq=8192]="pasteAsPlainText";
b[b.Pod=65536]="showPlaceholderGlossary";b[b.eeq=131072]="reformatPastedContentWithDesignerPaste";b[b.S$p=262144]="noSpacesAdjustment";b[b.z4p=524288]="mergeAfterPasteForInsertHtmlAPI"})(Py||(Py={}));Object(u.b)("ClipboardActionFlags",Py);var ko=d(376);class Zu extends Oy.a{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc,zc,Yc,Kd,ke,ge,de,Sd,be,Rf,Mf,Yj,Ji,sm,jn,js=!0){super();this.yoa=this.ox=null;this.tM=this.nA=0;this.dlb=this.X6e=this.zda=this.yh=null;this.X9=!1;this.gW=!0;this.mjh=!1;this.init(b);
this.qm("ClipboardOperation");this.bsb(fb,h,M,aa,oa);this.xd=Cb;this.Oe=Gb;this.ef=Sb;this.Qc=pc;this.gah=zc;this.iah=Yc;this.hah=Kd;this.cMe=ke;this.J4b=ge;this.dMe=de;this.KDc=Ja;this.yDc=Sd;this.GSa=be;this.LPk=js;this.LK=Rf;this.Yd=Mf;this.An=Yj;this.G1=Ji;this._context=A;this.ija=sm;this.Mkb=jn;this.He=sh.a.getInstance(ko.a.o6a);oa&&Object(Xa.a)(89,oa)&&(this.zda=Object(ya.a)(728,oa.ka(pd.a.sza,null)));this.zda||(this.zda=this.ija.Bpd());this.UAb=void 0===r||null===r?"NotAvailable":Object(bJ.a)(Py,
r);this.zda.G4k(this.UAb.split(", "));b=this._context;if(this.Mkb){if(!Zu.TYh(b,this.cMe,this.xd,this.zda,js)){this.es=8;this.finish();return}this.yh=b.view;this.X9=3===this.yh.OTb;this.nA=0;this.tM=r;this.dlb=ke.YYa}else{if(!b.view.te){this.xd.$b(Nf.a.Re,{["Reason"]:nf.a.HVb});this.zda.fail("Not in interactive view",!0);this.es=8;this.finish();return}this.yh=b.view;if(!this.yh.mb){this.xd.$b(Nf.a.Re,{["Reason"]:nf.a.ao});this.zda.fail("No selection manager",!0);this.es=8;this.finish();return}this.X9=
3===this.yh.OTb;this.nA=0;this.tM=r;this.dlb=ke.YYa;if(js&&!(this.dlb&&this.dlb.currentSelection&&this.dlb.length)){this.xd.$b(Nf.a.Re,{["Reason"]:nf.a.ao});this.zda.fail("No selection when one required",!0);this.es=8;this.finish();return}}ke=ze.a.Am(this.dlb.currentSelection);ke=!(this.tM&16&&ke);ke=de.zcn(r,this.Mg)&&ke;1!==this.behavior&&ke||(ke||this.zda.fail("Clipboard operation disabled for selection",!0),this.es=ke?32:8,this.ova());!this.mjh&&this.ef.Ci&&(ac.b("IPadCCP"),this.mjh=!0)}get Mg(){this.X6e||
(this.X6e=gg.a.Fdc(this.dlb));return this.X6e}Lga(){super.Lga();this.dlb=null}run(){this.nA||this.setup();1===this.nA&&this.process();2===this.nA&&this.dfp();3===this.nA&&this.afp();4===this.nA&&this.finish()}setup(){if(this.tM&256&&this.KDc){this.HC||this.J4b.Inl(this,this.tM,this.UAb);this.HC.run();if(this.HC.zfa)return;this.gW=this.HC.pua;this.TUd();if(!this.gW){this.zda.fail("No access to system clipboard",!0);this.es=8;this.nA=4;this.the();return}}else v.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}; {3}",
this.tM,this.UAb,this.ef.XD,this.actionId);this.tM&32&&!this.Oe.Nce(this.yh.mb.Mg)?(v.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.xd.$b(Nf.a.Re,{["Reason"]:nf.a.zuf}),this.zda.fail("Cut not allowed",!0),this.yDc.show(),this.es=8,this.nA=4):(this.tM&16||this.tM&32)&&this.LK.Qee(this.yh.mb.gb.currentSelection)?(this.zda.fail("Selected content deleted in coauthoring",!0),this.Yd.n0b(),this.es=8,this.nA=4):(this.tM&4096&&(this.G1.luc(Object.assign(new At.a,{v8c:!0,w0:this.UAb})),this.An.undo()),
this.dMe.Abo(this.tM),this.yh.od?(this.ox=this.Qc.Nc(15),this.ox.Ii=this.actionId,this.ox.Bb(this.yh.od),this.nA=1):(this.zda.fail("Interactive view has null target node",!0),this.es=8,this.nA=4))}process(){if(!this.HC){v.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.tM,this.UAb,this.ef.XD);v.ULS.shipAssertTag(6305507,307,!this.yoa);this.yoa=new Bt(this._context,this.tM,this.zda,this.cca,this.ZN,void 0,this.ef.XD,this.LPk,this.X9);let b;this.tM&65536?b=
Object(E.a)(this.gah,this.gah.process,"process"):this.tM&64?b=Object(E.a)(this.iah,this.iah.process,"process"):this.tM&1?(this.He.logKpiUsage({kpiName:ko.a.kza}),b=Object(E.a)(this.cMe,this.cMe.process,"process")):b=Object(E.a)(this.hah,this.hah.process,"process");this.tM&16&&this.yh.mb.pEa.mpi();this.GSa.create(this,b,this.yoa).qm("ClipboardAction")}v.ULS.shipAssertTag(6305536,307,!!this.HC);this.HC.run();this.HC.zfa||(this.TUd(),this.nA=this.oi?2:3)}dfp(){this.yoa.Znc&&(this.ox.Ii=ub.a.M0);this.yoa.O8c&&
this.ox.TLa(this.yoa.zTf,this.yoa.Qbg);this.ox.dispose();this.es=this.yoa.MB?8:32;this.nA=4}afp(){if(this.HC){if(this.HC.run(),this.HC.zfa)return}else if(this.yoa.Znc&&(this.ox.Ii=ub.a.M0),this.ox.LNa(this),this.yoa.O8c&&this.ox.TLa(this.yoa.zTf,this.yoa.Qbg),this.ox.dispose(),this.Rcf)return;this.es=this.yoa.MB?8:32;this.nA=4}finish(){this.G1.luc(Object.assign(new At.a,{v8c:!1}));this.ova();32===this.response?(v.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",
+this.endTime-+this.startTime,this.tM,this.UAb,this.ef.XD),this.tM&1&&this.He.logKpiSuccess({kpiName:ko.a.kza})):v.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",+this.endTime-+this.startTime,this.tM,this.UAb,this.ef.XD);this.ija.yka(this.zda);Zu.Slo&&this.Fzn()}the(){const b=!!(this.tM&1),h=this._context.view;h&&ko.a.the(b,h.mb,this.ef.XD)}Fzn(){if(!(this.tM&4||this.tM&64)){var b=new Map;b.set("isCopy",String.format("{0}",!!(this.tM&16)));b.set("isIPad",
String.format("{0}",this.ef.Ci));b.set("SkipAria","false");b.set("ErrorLevel","info");this.He.logKpiUsage({kpiName:ko.a.$Zh,kpiType:0,optionalProperties:{extendedProperties:b},blockFutureEmissionDurationInMs:0});this.gW||(b.set("SkipAria","false"),b.set("ErrorLevel","info"),this.He.logKpiFailure({kpiName:ko.a.$Zh,errorName:ko.a.xkl,optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:{extendedProperties:b}},blockFutureEmissionDurationInMs:0}))}}static get Slo(){null==Zu.O4e&&(Zu.O4e=
!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("RecordCcpErrorDialogKpiIsEnabled"));return Zu.O4e}static kpg(b,h,r,A){b&&b.$b(Nf.a.Re,{["Reason"]:r});h&&h.fail(A,!0)}static TYh(b,h,r=null,A=null,M=!0){return b.view.te?b.view.mb?!M||h.YYa&&h.YYa.currentSelection&&h.YYa.length?!0:(Zu.kpg(r,A,nf.a.ao,"Paste target is invalid"),!1):(Zu.kpg(r,A,nf.a.ao,"No selection manager"),!1):(Zu.kpg(r,A,nf.a.HVb,"Not in interactive view"),!1)}}Zu.O4e=null;Object(u.a)(Zu,"ClipboardOperation",Oy.a,[]);class Vx{constructor(b,
h,r,A,M,aa){this.M2e=null;this.Iyh=0;this.xd=A;this.ef=h;this.c1=M;this.TTe=r;this.KDc=y.AFrameworkApplication.LBg();this.RLe=b.appSettings.ChromeClipboardAccessOperationTimeout;this.wK=0;this.xok=aa;this.Ysk=b.$("EnableExternalPasteSupportOnMobileIsEnabled");this.He=sh.a.getInstance(ko.a.o6a)}get YYa(){return this.c1.YYa}process(b,h){if(!this.wK)return this.u7n(h);if(1===this.wK)return this.yXb(b,h);if(2===this.wK)return this.wK=3,this.M2e(b,h);3===this.wK&&this.c1.szg(b,h);return!1}u7n(b){let h=
!0;this.Ysk&&(h=!(b.px&1));this.ef.w7&&h||b.px&512?(this.M2e=b.px&2?Object(E.a)(this.c1,this.c1.paste,"paste"):Object(E.a)(this.c1,this.c1.Cqj,"pasteInternal"),this.wK=2):(this.KDc?(this.wK=1,this.Iyh=Date.now()):this.wK=2,this.M2e=Object(E.a)(this.c1,this.c1.paste,"paste"));ko.a.QBn(b);return!0}yXb(b,h){b=!0;if(this.TTe.value.Tsj())this.wK=2;else{const r=Date.now()-this.Iyh;r>this.RLe&&(v.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",r),this.xd.$b(Nf.a.esa,{["Reason"]:nf.a.joj}),h.VU&&(h.VU.fail("Prepare for paste timed out",
!1),this.He.logKpiFailure({kpiName:ko.a.kza,errorName:"PreparePasteTimedOut",optionalVeto:{name:ko.a.Woe,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}})),h.MB=!0,b=!1,this.xok.fDo())}return b}}Object(u.a)(Vx,"ClipboardOperationPasteProcessor",null,[713]);class fG extends Oy.a{constructor(b,h,r,A,M,aa){super();this.init(b);this.qm("DummyClipboardOperation");this.bsb(y.AFrameworkApplication.va,h,A,M,aa);this._context=r;this.es=8;this.ova()}run(){this.Mib=!0;this.Jmd(this._context);
this.Dcb();this.es=32}}Object(u.a)(fG,"DummyClipboardOperation",Oy.a,[]);var vC=d(1503);class dE extends vC.a{constructor(b,h,r,A,M){super(b,h,M);this.Qk=r;this.D7e=A}Tzc(b){let h;if(this.pT&&!b)return v.ULS.sendTraceTag(594408836,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,qka:null};h=null;if(this.D7e&&!this.pT){const r=this.properties.ka(pd.a.Jqj,"");r&&(h=this.Qk.cwb(r))}h||(h=this.Qk.cwb(b));return{returnValue:!0,qka:h}}}Object(u.a)(dE,"HtmlStringImportStrategy",vC.a,
[]);var Wx=d(1861);class Xx extends Wx.a{constructor(b,h,r,A,M){super(b,h,r,A,M)}LCi(){return this.properties.ka(pd.a.aXb,"")}Tzc(b){if(this.RDh){if(this.Qk)return b=this.Qk.Fig(b,!0),{returnValue:!0,qka:b};v.ULS.sendTraceTag(592269660,307,10,"_clipboardDataHelper should not be null")}return super.Tzc(b)}Oad(b){b=super.Oad(b);return b.length&&" "!==b?b:"\u00a0"}}Object(u.a)(Xx,"MultiLinePlainTextImportStrategy",Wx.a,[]);class Ut extends vC.a{constructor(b,h,r){super(b,h,r)}Tzc(b){if(!y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RefactorPlainTextImportStrategy",
!1))return this.Xmp(b);let h;if(this.pT&&!b)return v.ULS.sendTraceTag(594408834,307,10,"No htmlDomContent"),{returnValue:!1,qka:null};h=cx.a.L3c("Box4PasteScratchPad");h.innerText=b;return{returnValue:!0,qka:h}}Xmp(b){let h;if(this.pT&&!b)return v.ULS.sendTraceTag(508379359,307,10,"No htmlDomContent"),{returnValue:!1,qka:null};h=Qy.v7n;h.innerText=b;return{returnValue:!0,qka:h}}}Object(u.a)(Ut,"PlainTextImportStrategy",vC.a,[]);class lw{constructor(b){this.isReady=this.QZf=!1;this.fja=b}Tsj(){this.QZf||
(this.QZf=!0,this.isReady=!1,this.fja.yXb(()=>{this.isReady=!0}));return this.isReady}Y1j(){this.QZf=!1;const b=this.fja.paste();return b?b.hasChildNodes()?{returnValue:!0,FWd:b}:(v.ULS.sendTraceTag(7891019,307,50,"DOM innerText empty."),lw.Dc.$b(Nf.a.C4,{["Reason"]:nf.a.fBf}),{returnValue:!1,FWd:b}):(v.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),lw.Dc.$b(Nf.a.YNb,{["Reason"]:nf.a.RFg}),{returnValue:!1,FWd:b})}static get Dc(){return Rg.a.instance}}Object(u.a)(lw,"SystemClipboardImportStrategy",
null,[717]);class Qy{get W3i(){return this.xRa}set W3i(b){this.xRa=b}constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc,zc,Yc,Kd,ke,ge,de=null){this.o1d=de;this.Hwd=null;this.xRa=0;this.GBd=this.BQc=!1;this.zBb=Vg.a.On;this.Ood=()=>{const Sd=Array(1);Sd.push("PasteRecoveryFloatie");var be=this.pGk.FVa();be=Object.assign(new ur.a,{x:be.x,y:be.y});this.bO.showFloatie(be,Sd,1);return 32};this.eRb=()=>{this.bO.f3&&this.bO.dismissFloatie();return 32};this.Gvj=(Sd,be,Rf,Mf,Yj)=>{if(1===Rf)return 32;Yj[Pd.a.On]=
!1;return 32};this.cWl=(Sd,be,Rf,Mf,Yj,Ji)=>{v.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var sm=Ji.DataTransfer;Ji=sm.getData("text/html");sm=sm.getData("text/plain");let jn=!1;const js=new wg.DictionaryPropertySet;0<Ji.length?(v.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),js.setValue(pd.a.QX,Ji),jn=!0):0<sm.length&&(v.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),js.setValue(pd.a.aXb,sm),jn=!0);if(jn){const uy=
this.xz.K(be);return this.mVd.create(Sd,be,uy,new Qf.a(()=>this.jYc(uy,js)),Rf,Mf,Yj,js)}return null};this.Rng=(Sd,be,Rf,Mf,Yj)=>{if(be="object"===typeof Yj?Yj:null)this.Nkb?this.GOo(Sd,this.xRa,be):Sd===ub.a.ire?(Sd=this.xRa!==ub.a.uZa&&this.xRa!==ub.a.vZa&&this.xRa!==ub.a.oDa,be[this.zBb]=this.xRa===ub.a.uZa||Sd):Sd===ub.a.jre?be[this.zBb]=this.xRa===ub.a.vZa:Sd===ub.a.Mng&&(be[this.zBb]=this.xRa===ub.a.oDa);return 32};this.ZZ=(Sd,be,Rf,Mf,Yj,Ji)=>{if((y.AFrameworkApplication.z0||y.AFrameworkApplication.lH)&&
!y.AFrameworkApplication.ENb||Xn.a.Jla(Rf)&&Xn.a.tnc())return new fG(Sd,be,Rf,Mf,Yj,Ji);let sm=this.xz.K(be);1!==Mf&&sm&1&&(this.xRa=be);if(1!==Mf){var jn=Object(Xa.a)(89,Ji)?Ji:null;Ji?(sm&1&&(this.Hwd=jn),jn=jn?jn.ka(pd.a.w0,0):0,be===ub.a.paste&&jn===ub.a.bIa?sm=this.xz.K(ub.a.q6):be===ub.a.O3&&jn===ub.a.k6a&&(sm=this.xz.K(ub.a.Xoe))):!Ji&&sm&4096&&(Ji=this.Hwd,jn=Object(Xa.a)(89,Ji)?Ji:null)&&(jn=jn.ka(pd.a.egd,N.a.nil),v.ULS.sendTraceTag(575255109,307,50,"Reformatting operation occurred. CorrelationId: {0}",
jn))}return this.mVd.create(Sd,be,sm,new Qf.a(()=>this.jYc(sm,Ji)),Rf,Mf,Yj,Ji)};this.ydo=(Sd,be,Rf,Mf,Yj)=>this.bmf(Sd,be,Rf,Yj);this.xdo=(Sd,be,Rf,Mf,Yj)=>this.bmf(Sd,be,Rf,Yj);this.wdo=(Sd,be,Rf,Mf,Yj)=>this.bmf(Sd,be,Rf,Yj);this.yje=(Sd,be,Rf,Mf,Yj,Ji)=>{Ji=wc.a.Tc(gg.a.instance.gb.currentSelection.Qa.node,Ji);return this.ZZ(Sd,be,Rf,Mf,Yj,Ji)};this.Bok=b;this.fja=h;this.xd=r;this.Qk=A;this.ga=aa;this.hxd=Cb;this.J4b=Gb;this.Je=Sb;this.ug=pc;this.Yb=fb;this.Mkb=zc;this.Nkb=Yc;this.pGk=Kd;this.bO=
ke;this.YWe=ge;this.He=sh.a.getInstance(ko.a.o6a);Ja&&(this.BQc=Ja.$("UseClipboardDataHelperInMultiLineImportIsEnabled"),this.GBd=this.Nkb&&Ja.$("HandleCtrlShiftVAsPasteTextOnlyIsEnabled"));this.xz=new ab.a;this.xz.Z(ub.a.paste,257);this.xz.Z(ub.a.O3,8449);this.xz.Z(ub.a.q6,1);this.xz.Z(ub.a.n$a,1);this.xz.Z(ub.a.$Jb,1);this.xz.Z(ub.a.PHa,1);this.xz.Z(ub.a.Abe,513);this.xz.Z(ub.a.uZa,4097);this.xz.Z(ub.a.vZa,12289);this.xz.Z(ub.a.oDa,131073);this.xz.Z(ub.a.Oig,7);this.xz.Z(ub.a.Nig,1);this.xz.Z(ub.a.Xoe,
8193);this.xz.Z(ub.a.cE,272);this.xz.Z(ub.a.vTc,16);this.xz.Z(ub.a.cut,304);this.xz.Z(ub.a.Ukf,48);this.xz.Z(ub.a.xje,64);this.xz.Z(ub.a.yje,64);this.xz.Z(ub.a.Pod,327680);this.xz.Z(ub.a.cyf,1);this.GBd&&this.xz.Z(ub.a.fwb,this.xz.K(ub.a.Xoe))}get P_a(){return null!=this.E3g?this.E3g:this.E3g=Za.a.instance.Oa(878)}get KGg(){return null!=this.X3g?this.X3g:this.X3g=Za.a.instance.Oa(259)}get mVd(){return this.Bok.value}get fdp(){return this.fja}Xb(){if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisablePasteQueryAtBoot",
!1)){this.o1d.addCommandToMaps(new Yu.a(Uh.a.fgd,this.Mkb?ub.a.bIa.toString():ub.a.paste.toString()));let b;this.o1d.addCommandToMaps((b=new Yu.a(Uh.a.Lig,this.Nkb?ub.a.k6a.toString():ub.a.O3.toString()),b.legacyControlId="fseaNewPaste",b));this.o1d.addCommandToMaps(new Yu.a(Uh.a.dgd,this.Nkb?ub.a.k6a.toString():ub.a.O3.toString()));let h;this.o1d.addCommandToMaps((h=new Yu.a("PasteStandalone",this.Mkb?ub.a.bIa.toString():ub.a.paste.toString()),h.legacyControlId="fseaPaste",h))}this.ga.fb(ub.a.jho,
lc.a.application,this.Gvj,97);this.ga.fb(ub.a.kho,lc.a.application,this.Gvj,97);this.ga.fb(ub.a.ire,lc.a.application,this.Rng,97);this.ga.fb(ub.a.jre,lc.a.application,this.Rng,97);this.ga.fb(ub.a.Mng,lc.a.application,this.Rng,97);this.ga.qW(ub.a.Ukf,lc.a.view,this.ZZ,1028);this.ga.Hlb(ub.a.vTc,lc.a.view,this.ZZ);this.ga.qW(ub.a.cyf,lc.a.view,this.cWl,1028);this.ga.qW(ub.a.q6,lc.a.view,this.ZZ,1028);this.ga.qW(ub.a.n$a,lc.a.view,this.ZZ,1028);this.ga.qW(ub.a.$Jb,lc.a.view,this.ZZ,1028);this.ga.qW(ub.a.PHa,
lc.a.view,this.ZZ,1028);this.Mkb&&this.ga.fb(ub.a.bIa,lc.a.view,this.wdo,1028);this.Nkb&&this.ga.fb(ub.a.k6a,lc.a.view,this.xdo,1028);this.ga.qW(ub.a.paste,lc.a.view,this.ZZ,1028);this.ga.qW(ub.a.O3,lc.a.view,this.ZZ,1028);this.ga.qW(ub.a.Xoe,lc.a.view,this.ZZ,1028);this.ga.qW(ub.a.Nig,lc.a.view,this.ZZ,1028);this.ga.qW(ub.a.Oig,lc.a.view,this.ZZ,1028);this.ga.qW(ub.a.uZa,lc.a.view,this.ZZ,1028);this.ga.qW(ub.a.vZa,lc.a.view,this.ZZ,1028);this.ga.qa(ub.a.iZb,lc.a.view,ce.ActionManager.Zf);this.ga.qa(ub.a.Qqj,
lc.a.view,ce.ActionManager.Zf);this.ga.qa(ub.a.Nqj,lc.a.view,ce.ActionManager.Zf);this.ga.qa(ub.a.Oqj,lc.a.view,ce.ActionManager.Zf);this.ga.qa(ub.a.Pqj,lc.a.view,ce.ActionManager.Zf);this.ga.qa(ub.a.Mqj,lc.a.view,ce.ActionManager.Zf);this.ga.Hlb(ub.a.xje,lc.a.view,this.ZZ);this.ga.Hlb(ub.a.yje,lc.a.view,this.yje);this.ga.Hlb(ub.a.Abe,lc.a.view,this.ZZ);this.ga.Hlb(ub.a.Pod,lc.a.view,this.ZZ);this.GBd&&(this.ga.fb(ub.a.TTc,lc.a.view,this.ydo,1028),this.ga.qW(ub.a.fwb,lc.a.view,this.ZZ,1028));this.ga.qa(ub.a.uai,
lc.a.view,ce.ActionManager.Zf);this.ga.qa(ub.a.Xai,lc.a.view,ce.ActionManager.Zf);this.YWe&&(this.ga.fb(ub.a.Ood,lc.a.view,this.Ood,96),this.ga.fb(ub.a.eRb,lc.a.view,this.eRb,96))}k8(){if(this.Yb){const b=this.Yb.ie(vi.a.uF);this.GBd&&b.bindAction(Xb.KeyInputManager.mc(cf.a.PAb,Xb.KeyInputManager.li|4),ub.a.TTc)}else v.ULS.sendTraceTag(592196489,307,10,"Null focus manager and fail to register clipboard shortcuts.")}GOo(b,h,r){switch(h){case ub.a.vZa:case ub.a.O3:case ub.a.fwb:h=ub.a.jre;break;case ub.a.oDa:h=
ub.a.Mng;break;default:h=ub.a.ire}r[this.zBb]=b===h}ECm(){const b=Object(Xa.a)(89,this.Hwd)?this.Hwd:null;return b?b.ka(pd.a.egd,N.a.nil):N.a.nil}bmf(b,h,r,A){if(1===r){if(!Object(Xa.a)(kw.a,h)||!this.hxd||Xn.a.Jla(h)&&Xn.a.tnc())return 8;r=new Qf.a(()=>this.jYc(this.xz.K(ub.a.q6),A));const M=this.hxd.create(r,Object(ya.a)(89,A));r=new Vx(y.AFrameworkApplication.J,Sx.a.instance,r,Rg.a.instance,M,this.J4b);return Zu.TYh(h,r)?32:8}if(2===r){if(this.h_o(df.a.r5a))return this.bIa(b);df.a.vuc(()=>{this.bIa(b)});
return 32}return 2}bIa(b){if(!this.Je)return v.ULS.sendTraceTag(592454657,307,10,"No _editingDomManager"),8;var h=this.Je.tqb();if(!h)return v.ULS.sendTraceTag(592454658,307,10,"No ownerDocument"),8;h=h.Bo;if(!h)return v.ULS.sendTraceTag(592454659,307,10,"No document"),8;v.ULS.sendTraceTag(592454660,307,50,"Calling execCommand. Command: {0}",b);this.He.logKpiUsage({kpiName:ko.a.kza});this.ug.eYl(b);b=Le.a.TNb(h,"paste");h=this.ug.HRl();v.ULS.sendTraceTag(573388233,307,50,"PasteEventHandled: {0}",
h);if(b)return v.ULS.sendTraceTag(592454661,307,50,"execCommand succeeded"),this.He.logKpiSuccess({kpiName:ko.a.kza}),32;this.KSm();v.ULS.sendTraceTag(592454662,307,10,"execCommand failed");this.He.logKpiFailure({kpiName:ko.a.kza,errorName:"ExecCommandFailed"});return 8}KSm(){this.P_a&&(this.P_a.o0b(),ko.a.the(!0,gg.a.instance,Y.a.XD));if(this.KGg){const b=this.KGg.Bpd();b.Occ("CallExecCommandPasteOperation");b.fail("call to execCommand('paste') failed",!0);this.KGg.yka(b)}}h_o(b){let h=!1;this.Yb?
this.Yb.currentScope?h=!this.Yb.sXf(this.Yb.currentScope.name):v.ULS.sendTraceTag(573388235,307,10,"No CurrentScope"):v.ULS.sendTraceTag(573388234,307,10,"No _focusManager");if(h){v.ULS.sendTraceTag(573388236,307,50,"CurrentScope: {0}",this.Yb.currentScope.name);if(1>b)return v.ULS.sendTraceTag(573388237,307,10,"Action callbacks will not execute"),!0;this.Yb.wDf();return!1}return!0}jYc(b,h){return b&256?new lw(this.fdp):b&2?b&4096?new dE(h,this.xd,this.Qk,df.a.instance.K8c,df.a.instance.v_a):new Ut(h,
this.xd,df.a.instance.v_a):h.hasProperty(pd.a.aXb)?new Xx(h,this.xd,this.Qk,this.BQc,df.a.instance.v_a):new dE(h,this.xd,this.Qk,df.a.instance.K8c,df.a.instance.v_a)}static get v7n(){return cx.a.L3c("Box4PasteScratchPad")}SYh(b,h,r,A){return!y.AFrameworkApplication.z0&&!y.AFrameworkApplication.lH||y.AFrameworkApplication.ENb?(b=this.ZZ(null,b?ub.a.cut:ub.a.cE,h,1,r,A))?b.response:8:8}}Object(u.a)(Qy,"ClipboardActor",null,[]);class gG{constructor(b,h,r,A,M){this.ofh=0;this.zCp=aa=>{let oa=!0;const Ja=
this.fja.j_l;null!=Ja?(aa.pua=Ja,oa=!1):Date.now()-this.ofh>this.RLe&&(v.ULS.sendTraceTag(18354843,307,50,null),this.xd.$b(Nf.a.esa,{["Reason"]:nf.a.joj}),oa=aa.pua=!1);return oa};this.xd=b;this.ef=h;this.RLe=M;this.fja=r;this.GSa=A}Inl(b,h,r){v.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",h,r,this.ef.XD);b.oi&&this.ef.Pr&&window.chrome&&v.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",
h);this.fja.RZc(!!(h&16));this.GSa.create(b,this.zCp,null).qm("ClipboardPreProcess");this.ofh=Date.now()}fDo(){this.fja.reset()}}Object(u.a)(gG,"ClipboardOperationClipboardAccessHelper",null,[691]);class cJ{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc,zc,Yc,Kd){this.K2a=null;this.ga=b;this.xd=h;this.rB=r;this.Oh=A;this.hb=M;this.fja=aa;this.jb=oa;this.Oe=Ja;this.wo=fb;this.Zc=Cb;this.Ijb=Gb;this.b5e=Sb;this.sG=pc;this.Qk=Yc;this.j7b=zc?zc.$("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.jEd=
zc?zc.$("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.Bd=Kd;this.He=sh.a.getInstance(ko.a.o6a)}get gg(){return this.Oh}get Dc(){return this.xd}get f8c(){if(null==this.K2a)if(this.Bd)if(this.Bd.us.isCompleted)this.K2a=this.Bd.isFeatureEnabled(2);else return!1;else this.K2a=!1;return this.K2a}sCp(b){b.hJ();return!0}X6h(b,h){b=h.px;v.ULS.shipAssertTag(18130960,307,!!(b&16));if(b&256){let A=!1,M;this.f8c&&h.ne&&h.ne.Kh&&(A=this.Qk.kMh(h.ne.Kh.editingElement));M=this.Qk.QQf(h.ne.Kh.editingElement,!1);
var r=h.ne.Kh.editingElement;this.Qk.NVf(r,!1,1);this.j7b&&Y.a.wta?(r=h.ne.Kh.editingElement,this.Qk.Lsg(r,"data-src","data-srcurl"),b=this.fja.cE(),this.Qk.Lsg(r,"data-srcurl","data-src")):this.jEd&&h.ne&&h.ne.Kh?(r=this.Qk.Zmf(h.ne.Kh.editingElement,h.ne.NC,!0),b=this.fja.cE(),r&&this.Qk.Zmf(h.ne.Kh.editingElement,h.ne.NC,!1)):(this.Qk.MBj(h.ne.Kh.editingElement),b=this.fja.cE());this.f8c&&A&&this.Qk.Pwo(h.ne.Kh.editingElement);M&&this.Qk.QQf(h.ne.Kh.editingElement,!0);r=h.ne.Kh.editingElement;
this.Qk.NVf(r,!1,0);if(!b)return v.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),b=new Map,b.set("ErrorLevel","info"),this.He.logKpiFailure({kpiName:ko.a.hUd,errorName:"SystemClipboardCopyFailed",optionalProperties:{additionalValues:{extendedProperties:b}}}),this.Dc.$b(Nf.a.YNb,{["Reason"]:nf.a.RFg}),h.VU&&h.VU.fail("SystemClipboard did not copy",!1),h.MB=!0,!1}return!0}prf(b,h){const r=h.ne;v.ULS.shipAssertTag(18130961,307,!!(h.px&16));h.S6o?this.rB.w1h():this.rB.hXd(r,b);return!0}Sci(b,
h){var r=h.context,A=h.rd;const M=h.cca;var aa=!1;b=this.hb.gb.currentSelection.Wc;if(this.jb.fn(b)||this.Oe.ll(b)){const oa=this.Zc.kg(b.node),Ja=oa.Kd();v.ULS.shipAssertTag(18130962,307,Ja);this.wo.je(oa);this.Ijb.Vsb(oa)&&(aa=!0)}A=h.px&64?new wg.DictionaryPropertySet:A||new wg.DictionaryPropertySet;A.setValue(pd.a.OYc,!1);this.He.logKpiUsage({kpiName:ko.a.iUd});r=this.ga.Nf(r,ub.a.JJ,2,!0,M,A);8===r&&(v.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Dc.$b(Nf.a.esa,{["Reason"]:nf.a.Rci}),
h.VU&&h.VU.fail("DeleteKey failed",!1),this.He.logKpiFailure({kpiName:ko.a.iUd,errorName:"DeleteForCutFailed"}),h.MB=!0);32===r&&this.He.logKpiSuccess({kpiName:ko.a.iUd});32===r&&aa&&(h=this.hb.gb.currentSelection,this.Oe.Am(h)&&h.Qa.node===b.node&&!this.jb.textLength(h.Qa.node)&&(h=this.Zc.kg(h.Qa.node),b=this.Oe.tv(h),v.ULS.shipAssertTag(18130964,307,b),this.wo.je(h),this.Ijb.Zce(h)||(b=this.b5e.create(),b.hd(h),this.wo.z3(b,!1,!1),aa=this.wo.Me(b),this.jb.Vb(aa)&&(this.wo.je(b),this.gg.merge(b,
h,!1,!1),this.hb.Kc(this.sG.ue(aa,this.jb.textLength(aa)))))));return!0}}Object(u.a)(cJ,"ClipboardOperationCutCopy",null,[714]);class hG{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc,zc,Yc,Kd){this.ga=b;this.xd=h;this.rB=r;this.fja=aa;this.hb=M;this.Oh=A;this.jb=oa;this.Oe=Ja;this.wo=fb;this.Zc=Cb;this.Ijb=Gb;this.b5e=Sb;this.sG=pc;this.Ga=zc;this.Qk=Yc;this.Bd=Kd}create(){return new cJ(this.ga,this.xd,this.rB,this.Oh,this.hb,this.fja,this.jb,this.Oe,this.wo,this.Zc,this.Ijb,this.b5e,this.sG,this.Ga,
this.Qk,this.Bd)}}Object(u.a)(hG,"Factory",null,[690]);var gp=d(308);class dx{constructor(b,h){this.rEc=null;this.Szl=(r,A)=>{let M;if(gp.a.Ufa){if(!A.rd)return!1;M=A.rd.r4c;if(!M)return!1}else{if(!Object(Xa.a)(89,A.rd))return!1;const Ja=Object(ya.a)(89,A.rd);if(!Ja.hasProperty(pd.a.r4c))return!1;M=Ja.getValue(pd.a.r4c)}const aa=A.ne,oa=aa.mb;this.rB.J8j();oa.HZb(()=>{oa.Kc(M,void 0,!0);this.rB.hXd(aa,r)},!0);return!0};this.rB=b;this.c1=h;this.wK=0}process(b,h){this.wK||(this.rEc=[this.Szl,Object(E.a)(this.c1,
this.c1.s7n,"pasteGlossaryPlaceholder")],gp.a.Ufa&&this.rEc.push(Object(E.a)(this.c1,this.c1.szg,"setSelectionAfterPaste")));let r=!0;this.wK<this.rEc.length&&(r=this.rEc[this.wK++](b,h));return r?this.wK<this.rEc.length:!1}}Object(u.a)(dx,"ClipboardOperationContentControlShowPlaceholderProcessor",null,[729]);class eE{constructor(b){this.qCb=null;this.b5=b;this.wK=-1}process(b,h){-1===this.wK&&(this.GKl(b,h),this.wK=0);let r=!1;this.wK<this.qCb.length&&(r=this.qCb[this.wK++](b,h));return r?this.wK<
this.qCb.length:!1}GKl(b,h){Y.a.w7||h.px&512?(this.qCb=[Object(E.a)(this.b5,this.b5.prf,"copyInternal")],v.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):!b.oi&&h.px&256?(this.qCb=[Object(E.a)(this.b5,this.b5.sCp,"waitBeforeCopy"),Object(E.a)(this.b5,this.b5.X6h,"copyExternal"),Object(E.a)(this.b5,this.b5.prf,"copyInternal")],v.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):
(this.qCb=[Object(E.a)(this.b5,this.b5.X6h,"copyExternal"),Object(E.a)(this.b5,this.b5.prf,"copyInternal")],v.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));h.px&32&&(b=Object(E.a)(this.b5,this.b5.Sci,"deleteForCut"),this.qCb.push(b),v.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));ko.a.Ezn(h)}}Object(u.a)(eE,"ClipboardOperationCutCopyProcessor",null,[716]);class UA{constructor(b,
h,r,A){this.BGd=null;this.Vzl=(M,aa)=>{aa=aa.ne;this.rB.Zyp();this.rB.hXd(aa,M);return!0};this.Qcd=(M,aa)=>{aa=new Er.Selection([aa.rd],!0);this.hb.Kc(aa,M);return!0};this.rB=b;this.hb=h;this.b5=r;this.c1=A;this.wK=0}process(b,h){this.wK||(this.BGd=[this.Vzl,Object(E.a)(this.b5,this.b5.Sci,"deleteForCut"),this.Qcd,Object(E.a)(this.c1,this.c1.Cqj,"pasteInternal"),Object(E.a)(this.c1,this.c1.szg,"setSelectionAfterPaste")]);let r=!0;this.wK<this.BGd.length&&(r=this.BGd[this.wK++](b,h));return r?this.wK<
this.BGd.length:!1}}Object(u.a)(UA,"ClipboardOperationMoveProcessor",null,[715]);class fE{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc,zc,Yc,Kd,ke,ge){this.rB=b;this.ga=h;this.KDc=r;this.xd=A;this.Oe=M;this.ef=aa;this.Qc=oa;this.hxd=Ja;this.Aok=fb;this.J4b=Cb;this.dMe=Gb;this.yDc=Sb;this.GSa=pc;this.LK=zc;this.Yd=Yc;this.An=Kd;this.G1=ke;this.ija=ge}create(b,h,r,A,M,aa,oa,Ja,fb=!0){const Cb=this.hxd.create(A,Object(ya.a)(89,Ja));var Gb=this.Aok.create();const Sb=new dx(this.rB,Cb),pc=new UA(this.rB,
gg.a.instance,Gb,Cb);Gb=new eE(Gb);A=new Vx(y.AFrameworkApplication.J,Sx.a.instance,A,Rg.a.instance,Cb,this.J4b);return new Zu(b,h,r,M,aa,oa,Ja,this.KDc,this.ga,this.xd,this.Oe,this.ef,this.Qc,Sb,pc,Gb,A,this.J4b,this.dMe,this.yDc,this.GSa,this.LK,this.Yd,this.An,this.G1,this.ija,y.AFrameworkApplication.PBg(),fb)}}Object(u.a)(fE,"Factory",null,[689]);var $u=d(243);class gE{constructor(b,h){this.EQb=b.cJf(h);this.Arf=b.wlm(h);this.oLb=b.FGf(h);this.smb=b.cGf(h)}static TG(b){return gE.Qs(b)}static Qs(b){return new gE(Xw.a.instance,
b)}}Object(u.a)(gE,"CpUsageHelper",null,[]);class lo{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb){this.xd=b;this.rB=h;this.CMc=r;this.xya=A;this.hb=M;this.ga=aa;this.TTe=oa;this.Baf=fb;this.P2e=Ja;this.yPe=Cb;this.bMe=Gb;this.Yd=Sb;this.He=sh.a.getInstance(ko.a.o6a)}get Yg(){return this.Baf.value}get Yva(){return this.xya}get Dc(){return this.xd}get YYa(){return this.P2e.YYa}paste(b,h){let r=!1;return Fm.a.etb?(er.a.instance.$d(()=>{r=this.zqj(b,h)},"COP:P"),r):this.zqj(b,h)}zqj(b,h){const r=this.Yd.W5a();
try{const A=h.ne,M=h.px;this.hb&&this.hb.gb&&this.hb.gb.currentSelection&&$u.TableBorderSelectionCache.EXo(this.hb.gb.currentSelection.Rw||this.hb.gb.currentSelection.yab);No.a.vVo(this.hb);v.ULS.shipAssertTag(18131010,307,!!(M&1));Object(Xa.a)(89,h.rd)&&h.rd.setValue(fd.a.rka,A.Kh.editingElement.clientWidth);this.bMe.qnp(b,h);let aa;if(!({FWd:aa}=this.TTe.value.Y1j()).returnValue)return this.sbd(h,"HTML import strategy failed",!1),this.He.logKpiFailure({kpiName:ko.a.kza,errorName:"HtmlImportStrategyFailed",
optionalVeto:{name:ko.a.Woe,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}),!1;this.Yg.pI();let oa=!0,Ja=null;const fb=this.yPe.create(aa),Cb=h.G8j;if(!A||!A.mb)return this.sbd(h,"Fail to set selection.",!1),this.He.logKpiFailure({kpiName:ko.a.kza,errorName:"SetSelectionFailed",optionalVeto:{name:ko.a.Woe,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}),!1;A.mb.HZb(()=>{Cb&&2===this.ga.Ob(ub.a.Ira,2)?oa=!1:(Ja=Cb?this.hb&&this.hb.gb&&this.hb.gb.currentSelection?
this.hb.gb.currentSelection.Qa:null:h.rd)?(v.ULS.shipAssertTag(18158338,307,ze.a.pf(Ja)),this.l9i(Ja,"paste")):v.ULS.sendTraceTag(591958036,307,15,"ipContext is null. useSelection: {0}; ",Cb)},this.P2e.$Zi);if(!oa)return this.sbd(h,"fail to deleteForReplace.",!0),!1;if(!Ja)return this.sbd(h,"null ipContext after RunAgainstSelectionCollection.",!0),!1;if(!Ja.node||!Ja.node.isConnected)return this.sbd(h,"node is null or not connected in ip context.",!0),!1;A.Le.disable(!0,25);fb.restore();this.CMc.n7n(aa,
Ja,b);return!0}finally{r&&r.dispose()}}sbd(b,h,r){b.MB=!0;b.VU&&b.VU.fail(h,r)}s7n(b,h){var r,A;let M;if(gp.a.Ufa){M=h.rd;var aa=M.e9d}else aa=Object(ya.a)(89,h.rd).getValue(pd.a.e9d);v.ULS.shipAssertTag(20492440,307,ze.a.pf(aa));if(!this.z0h(aa,h))return!1;this.Yg.pI();const oa=(new Qn.a).Nc(15);oa.Bb(this.rB.Nna);const Ja=gp.a.Ufa?this.hb.gb.currentSelection:null;this.CMc.tSi(aa,b);gp.a.Ufa&&(b=null!==(A=null===(r=M.placeholderText)||void 0===r?void 0:r.length)&&void 0!==A?A:0,r=h.IJa,aa=Ja&&ze.a.pf(Ja.Qa)&&
r&&ze.a.pf(r.Qa)&&Ja.Qa.node===r.Qa.node&&Ja.Qa.cpBegin>aa.cpBegin?sc.SelectionFactory.ue(Ja.Qa.node,Ja.Qa.cpBegin+b):Ja,h.IJa=aa);this.rB.w1h();oa.dispose();return!0}Cqj(b,h){const r=this.hb.gb.currentSelection.Qa;if(!this.z0h(r,h))return!1;this.Yg.pI();this.ga.Ob(ub.a.Ira,2);this.l9i(r,"intPaste");this.CMc.tSi(r,b);return!0}z0h(b,h){if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("AbortClipboardOperationForInvalidIpContext")){if(!b||!b.isValid)return v.ULS.sendTraceTag(595142426,307,15,
"Invalid ip context. IsTouch: {0}",!!h&&h.x$c),h.VU&&(h.VU.fail("Invalid ipContext before InternalPasteAtIp",!0),h.MB=!0),h=new Map,h.set("ErrorLevel","warning"),this.He.logKpiFailure({kpiName:ko.a.kza,errorName:"InvalidIpContextBeforeInternalPasteAtIp",optionalProperties:{additionalValues:{extendedProperties:h}}}),!1;if(!ze.a.pf(b))return v.ULS.sendTraceTag(587843167,307,15,"Ip context is not insertion point. IsTouch: {0}; contextId: {1}; ipContext.Node: {2}; ipContext.Node.Anchor: {3};",!!h&&h.x$c,
b.contextId,!!b.node,!!b.node&&!!b.node.anchor),b=new Map,b.set("ErrorLevel","warning"),this.He.logKpiFailure({kpiName:ko.a.kza,errorName:"InternalPasteIPContextIsNotInsertionPoint",optionalProperties:{additionalValues:{extendedProperties:b}}}),h.VU&&(h.VU.fail("ipContext is not insertion point in InternalPasteAtIp",!0),h.MB=!0),!1}return!0}l9i(b,h){h=gE.TG(h);this.Yva.hmo(h,b.node,b.cpBegin);this.Yva.Gzn(h.Arf);this.Yva.m5f(h.EQb);this.Yva.$4f(h.oLb);this.Yva.X4f(h.smb)}szg(b,h){if(!h.G8j)return!1;
h.px&64&&this.rB.I8j();if(!h.IJa)return v.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Dc.$b(Nf.a.C4,{["Reason"]:nf.a.qsb}),h.VU&&h.VU.fail("No selection after paste",!1),h.MB=!0,!1;this.P2e.ayp(h);this.Yg.pI();return!1}}Object(u.a)(lo,"ClipboardOperationPaste",null,[712]);class av{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb){this.xd=b;this.rB=h;this.CMc=r;this.xya=A;this.hb=M;this.ga=aa;this.Baf=Ja;this.sGk=oa;this.yPe=fb;this.bMe=Cb;this.Yd=Gb}create(b,h){h=this.sGk.create(this.hb,
h);return new lo(this.xd,this.rB,this.CMc,this.xya,this.hb,this.ga,b,h,this.Baf,this.yPe,this.bMe,this.Yd)}}Object(u.a)(av,"Factory",null,[688]);class mw{constructor(b,h){this.mbp=b;this.k6n=h}}Object(u.a)(mw,"ParagraphFormatStore",null,[]);class iG{constructor(b,h,r){this.hb=b;this.jb=h;this.we=r}qnp(b,h){if(h.Znc){h=b.pua;var r=this.hb.gb.currentSelection.Qa.node,A=null;this.jb.Vb(r)&&(A=this.we.Aq(r),r=this.jb.p9a(r),A=new mw(A,r));h=new Bt(h.context,h.px,h.VU,h.cca,h.rd,A);b.pua=h}}}Object(u.a)(iG,
"ClipboardOperationPasteOvertypeStrategy",null,[687]);class VA{constructor(b){this.JZe=null;this.hb=b;b.HZb(h=>{this.JZe=h},!1)}get $Zi(){return!1}ayp(b){b=this.fgf(b);this.Kc(this.hb,b)}fgf(b){let h=b.IJa;(b.u0a||b.KDa)&&b.Rze&&(h=sc.SelectionFactory.Qy(b.Rze,h.Qa));return h}Kc(b,h){b.Kc(h)}}Object(u.a)(VA,"AClipboardOperationPasteStrategy",null,[737]);class mi extends VA{constructor(b){super(b)}get YYa(){return this.JZe}}Object(u.a)(mi,"ClipboardOperationPasteToLiveSelectionStrategy",VA,[]);class hE extends VA{constructor(b,
h){super(b);this.Fbf=null;this.ICk=h;b.HZb(r=>{this.Fbf=r},!0)}get $Zi(){return!0}get YYa(){return this.Fbf}fgf(b){let h=super.fgf(b);b.rd.setValue(pd.a.Hqj,h);return h=this.ICk.FAi(this.JZe.currentSelection,this.Fbf.currentSelection,h)}}Object(u.a)(hE,"ClipboardOperationPasteToVirtualSelectionStrategy",VA,[]);class kh{constructor(b){this.Ebf=b.$("EnableVirtualSelectionInSelectionManager")}create(b,h){return h&&h.ka(pd.a.u0a,!1)&&this.Ebf?new hE(b,this.QBp):new mi(b)}get QBp(){return null!=this.G5g?
this.G5g:this.G5g=Za.a.instance.Oa(879)}}Object(u.a)(kh,"ClipboardOperationPasteStrategyFactory",null,[686]);class wC{constructor(b,h,r,A){this.Dc=b;this.mb=h;this.Dn=r;this.rg=A}Abo(b){(b&1||b&32)&&this.Dn.Co&&this.mb.Bbc()}zcn(b,h){return b&1&&this.rg.q2(h,!0)?(this.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.IG}),!1):!0}}Object(u.a)(wC,"ClipboardOperationWordStrategy",null,[]);class iE{constructor(){}pzl(b,h){if(h)if(h=h.sheet)if(h=h.cssRules){var r=Array.clone(h);r.reverse();var A=h=0,M=0,aa=0;for(const Ja of r){r=
Ja.style;var oa=Ja.selectorText;r=r?r.cssText:null;oa=oa?oa.split(","):null;if(r&&oa&&Ja.type===Ja.STYLE_RULE){aa+=oa.length;for(const fb of oa){0<=fb.indexOf("#")&&h++;0<=fb.indexOf(".")&&A++;0>fb.indexOf("#")&&0>fb.indexOf(".")&&M++;oa=null;try{oa=b.querySelectorAll(fb)}catch(Cb){v.ULS.sendTraceTag(41427107,307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",fb,Cb.message)}if(oa)for(let Cb=0;Cb<oa.length;Cb++)oa[Cb].setAttribute("style",r+(oa[Cb].getAttribute("style")||
""))}}}v.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",aa,h,A,M)}else this.J9i();else this.J9i()}J9i(){v.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",Y.a.XD)}}Object(u.a)(iE,"ExternalPasteCssConverter",null,[685]);class dJ{constructor(b){this.rUa=0;this.W1h=null;this.node=b}}Object(u.a)(dJ,"ChartConverterArguments",null,
[]);class jG{constructor(b=null){this._imgNodesConverted=0;this.Y5=b||tr.a.pti("")}get Mc(){return this.Y5}process(b,h){b&&(this._imgNodesConverted=0,b.querySelectorAll&&(b=b.querySelectorAll("div"),1===b.length&&(b=new Fv.a(h,this.G2l.bind(this),new dJ(b[0])),b.qm("Chart Converter Operation"),b.oi=!h||h.oi,b.run())))}G2l(b,h){var r=h.node;if(1<h.rUa)return!1;if(1===r.nodeType&&"DIV"===r.tagName){const A=r.getAttribute(im.KYd);if(A){const M=r.getAttribute(im.Iuf),aa=r.getAttribute(im.Juf),oa=r.getAttribute(im.Guf),
Ja=r.getAttribute(im.Huf),fb=r.getAttribute(im.FXc);r=r.getAttribute(im.Kuf);M&&Ja&&aa&&"chart"===aa&&fb&&"XLO"===fb&&(h.W1h=new cG.a(A,M,aa,oa,Ja,fb,r))}}b.Oi(this.wKn.bind(this));return!0}wKn(b,h){var r=h.node;if(b=h.W1h)1===r.childElementCount&&1===r.firstChild.nodeType&&"IMG"===r.firstChild.tagName?(r=r.firstChild,r.setAttribute(im.KYd,b.ccpId),r.setAttribute(im.Iuf,b.pKey),r.setAttribute(im.Juf,b.type),r.setAttribute(im.Huf,b.dc),r.setAttribute(im.FXc,b.client),b.version&&r.setAttribute(im.Kuf,
b.version),b.count&&r.setAttribute(im.Guf,b.count),this._imgNodesConverted++):v.ULS.sendTraceTag(541361690,307,15,"Invalid html received"),this.Y5._imgNodesConverted=this._imgNodesConverted;h.rUa++;return!1}}Object(u.a)(jG,"ChartConverter",null,[]);class jE{constructor(b,h=null,r=null){this.Af=b;this.Y5=h||tr.a.lFi("");this.rNk=r||tr.a.mFi("")}get Mc(){return this.Y5}get rGg(){return this.rNk}Jba(b){this.rGg.b++;this.Af.Jba(b)}Hba(){this.Af.Hba()}X7(b){this.rGg.c++;this.Af.X7(b)}Iba(){this.Af.Iba()}Gba(b){this.rGg.d++;
this.Af.Gba(b)}Fba(){this.Af.Fba()}reset(){this.Af.reset()}get SXc(){return this.Af.SXc}tga(b,h){this.Mc.b++;this.Af.tga(b,h)}Dba(b){this.Mc.c++;this.Af.Dba(b)}Dvb(b){this.Mc.b++;this.Af.Dvb(b)}JCa(b){this.Mc.d++;this.Af.JCa(b)}uMa(b){this.Mc.f++;this.Af.uMa(b)}wYa(b,h){this.Mc.g++;this.Af.wYa(b,h)}vYa(){this.Af.vYa()}JF(b){this.Mc.h++;this.Af.JF(b)}eH(){this.Af.eH()}zvb(){this.Af.zvb()}yvb(){this.Af.yvb()}AYa(b,h){this.Mc.i++;this.Af.AYa(b,h)}Tbb(){this.Af.Tbb()}NCa(b){this.Mc.j++;this.Af.NCa(b)}LCa(){this.Af.LCa()}xMa(b){this.Mc.k++;
this.Af.xMa(b)}MCa(){this.Af.MCa()}Xbb(b){this.Mc.l++;this.Af.Xbb(b)}}Object(u.a)(jE,"SemanticEventUsageCollector",null,[504,505]);class kG{constructor(b=null){this.wm=b}tsl(b,h){var r;if(this.wm&&(h=h.match(/[0-9]+[a-zA-Z%]+/g)))for(const A of h){h=A.replace(/[0-9]+/,"");this.wm.nAe.has(b)||this.wm.nAe.set(b,new Map);const M=this.wm.nAe.get(b);null===M||void 0===M?void 0:M.set(h,(null!==(r=M.get(h))&&void 0!==r?r:0)+1)}}Hi(b){const h=b.Df;if(h&&this.wm&&("font"===h.tagName.toLowerCase()&&this.b7n(b),
b=h.style)){0===b.length&&this.wm.A6c(h.tagName,"no style present");for(let r=0;r<b.length;r++){const A=b[r];A&&0<A.length&&(this.wm.A6c(h.tagName,A),this.tsl(A,b.getPropertyValue(A)))}}}b7n(b){if((b=b.Df)&&"font"===b.tagName.toLowerCase()&&this.wm){var h=b.getAttribute("face");h&&0<h.length&&this.wm.A6c(b.tagName,"font-attr-face");(h=b.getAttribute("color"))&&0<h.length&&this.wm.A6c(b.tagName,"font-attr-color");(h=b.getAttribute("size"))&&0<h.length&&this.wm.A6c(b.tagName,"font-attr-size")}}}Object(u.a)(kG,
"HtmlEventUsageCollectorHelper",null,[]);class Ry{constructor(b,h,r=null,A=null){this.Fi=h;this.gpk="span p div br a img label b font i strong u em h1 h2 h3 h4 h5 h6 table tbody td tr li ol ul".split(" ");this.Af=b;this.Y5=r||tr.a.dyi(Y.a.HKb,"");this.yw=A;this.hpk=new vk.a(Na.a.th());for(const M of this.gpk)this.hpk.add(M)}get Mc(){return this.Y5}get wm(){return this.yw}Rh(b){return b?b+1:1}reset(){this.Af.reset()}cle(){this.Af.cle()}uQf(b){if(b&&this.wm&&(b.getAttribute&&(b.getAttribute(im.WKl)&&
(this.wm.Lpi=!0),b.getAttribute(im.KYd)&&(this.wm.Pam=!0),b.getAttribute(im.FXc)&&(this.wm.oof=b.getAttribute(im.FXc)),b.getAttribute(im.ZKl)&&(this.wm.Mpi=!0)),b.id&&b.id.startsWith&&b.id.startsWith(im.pQm)&&(this.wm.Npi=!0),b.className&&b.className.split))for(const h of b.className.split(" ")){h.startsWith(im.I1n)&&(this.wm.Rpi=!0);h.startsWith(im.xao)&&(this.wm.Spi=!0);h.startsWith(im.qEp)&&(this.wm.Tpi=!0);if(h.startsWith(Y.a.Tkf)&&h.length===Y.a.Tkf.length+1){const r=parseInt(I.a.substring(h,
h.length-1,h.length));isNaN(r)||(this.wm.qWc=r)}if(h===im.RLn||h===im.SLn)this.wm.E0c=!0}return this.Af.uQf(b)}onClose(){this.Af.onClose()}skn(b){for(const h of b)if("\n"!==h)return!0;return!1}tga(b,h){this.wm&&(this.wm.Ram=!0);this.wm&&!this.wm.qEf&&b&&(this.wm.qEf=this.skn(b));this.Mc.d=this.Rh(this.Mc.d);this.Af.tga(b,h)}Vke(b){this.wm&&(this.wm.Ppi=!0);this.Mc.e=this.Rh(this.Mc.e);this.Fi.Hi(b);return this.Af.Vke(b)}jcg(b){this.Mc.f=this.Rh(this.Mc.f);this.Fi.Hi(b);return this.Af.jcg(b)}kcg(b){this.Mc.g=
this.Rh(this.Mc.g);this.Fi.Hi(b);return this.Af.kcg(b)}ocg(b){this.Mc.h=this.Rh(this.Mc.h);this.Fi.Hi(b);return this.Af.ocg(b)}Ccg(b){this.Mc.i=this.Rh(this.Mc.i);this.Fi.Hi(b);return this.Af.Ccg(b)}Ecg(b){this.Mc.j=this.Rh(this.Mc.j);this.Fi.Hi(b);this.Af.Ecg(b)}ble(b){this.Mc.k=this.Rh(this.Mc.k);this.Fi.Hi(b);return this.Af.ble(b)}Fcg(b){this.Mc.l=this.Rh(this.Mc.l);this.Fi.Hi(b);this.Af.Fcg(b)}Gcg(b){this.Mc.m=this.Rh(this.Mc.m);this.Fi.Hi(b);this.Af.Gcg(b)}Hcg(b){this.Mc.n=this.Rh(this.Mc.n);
this.Fi.Hi(b);return this.Af.Hcg(b)}fle(b){this.Mc.o=this.Rh(this.Mc.o);this.Fi.Hi(b);return this.Af.fle(b)}gle(b){this.Mc.p=this.Rh(this.Mc.p);this.Fi.Hi(b);return this.Af.gle(b)}Wcg(b){this.Mc.q=this.Rh(this.Mc.q);this.Fi.Hi(b);return this.Af.Wcg(b)}hle(b){this.Mc.r=this.Rh(this.Mc.r);this.Fi.Hi(b);this.Af.hle(b)}Zcg(b){this.Mc.s=this.Rh(this.Mc.s);this.Fi.Hi(b);return this.Af.Zcg(b)}ile(b){this.Mc.t=this.Rh(this.Mc.t);this.Fi.Hi(b);return this.Af.ile(b)}jle(b){this.Mc.u=this.Rh(this.Mc.u);this.Fi.Hi(b);
return this.Af.jle(b)}mle(b){this.Mc.v=this.Rh(this.Mc.v);this.Fi.Hi(b);return this.Af.mle(b)}nle(b){this.Mc.w=this.Rh(this.Mc.w);this.Fi.Hi(b);return this.Af.nle(b)}kdg(b){this.Mc.x=this.Rh(this.Mc.x);this.Fi.Hi(b);this.Af.kdg(b)}ldg(b){this.Mc.y=this.Rh(this.Mc.y);this.Fi.Hi(b);return this.Af.ldg(b)}ule(b){this.Mc.z=this.Rh(this.Mc.z);this.Fi.Hi(b);return this.Af.ule(b)}vle(b){this.Mc.ba=this.Rh(this.Mc.ba);this.Fi.Hi(b);return this.Af.vle(b)}yle(b){this.Mc.bb=this.Rh(this.Mc.bb);this.Fi.Hi(b);
return this.Af.yle(b)}zle(b){this.Mc.bc=this.Rh(this.Mc.bc);this.Fi.Hi(b);return this.Af.zle(b)}Ble(b){this.Mc.bd=this.Rh(this.Mc.bd);this.Fi.Hi(b);return this.Af.Ble(b)}Cle(b){this.Mc.be=this.Rh(this.Mc.be);this.Fi.Hi(b);return this.Af.Cle(b)}Dle(b){this.Mc.bf=this.Rh(this.Mc.bf);this.Fi.Hi(b);return this.Af.Dle(b)}Gle(b){this.Mc.bg=this.Rh(this.Mc.bg);this.Fi.Hi(b);return this.Af.Gle(b)}Pdg(b){this.Mc.bh=this.Rh(this.Mc.bh);this.Fi.Hi(b);return this.Af.Pdg(b)}Ole(b){this.Mc.bi=this.Rh(this.Mc.bi);
this.Fi.Hi(b);return this.Af.Ole(b)}Wdg(b){this.Mc.bj=this.Rh(this.Mc.bj);this.Fi.Hi(b);return this.Af.Wdg(b)}Ydg(b){this.Mc.bk=this.Rh(this.Mc.bk);this.Fi.Hi(b);this.Af.Ydg(b)}Zdg(b){this.Mc.bl=this.Rh(this.Mc.bl);this.Fi.Hi(b);return this.Af.Zdg(b)}Rle(b){this.Mc.bm=this.Rh(this.Mc.bm);this.Fi.Hi(b);return this.Af.Rle(b)}Sle(b){this.Mc.bm=this.Rh(this.Mc.bm);this.Fi.Hi(b);return this.Af.Sle(b)}Tle(b){this.Mc.bm=this.Rh(this.Mc.bm);this.Fi.Hi(b);return this.Af.Tle(b)}Ule(b){this.Mc.bm=this.Rh(this.Mc.bm);
this.Fi.Hi(b);return this.Af.Ule(b)}Vle(b){this.Mc.bm=this.Rh(this.Mc.bm);this.Fi.Hi(b);return this.Af.Vle(b)}Wle(b){this.Mc.bm=this.Rh(this.Mc.bm);this.Fi.Hi(b);return this.Af.Wle(b)}eeg(b){this.Mc.bn=this.Rh(this.Mc.bn);return this.Af.eeg(b)}Xle(b){this.Mc.bo=this.Rh(this.Mc.bo);this.Fi.Hi(b);this.Af.Xle(b)}keg(b){this.Mc.bp=this.Rh(this.Mc.bp);return this.Af.keg(b)}Yle(b){this.Mc.bq=this.Rh(this.Mc.bq);this.Fi.Hi(b);return this.Af.Yle(b)}meg(b){this.Mc.br=this.Rh(this.Mc.br);this.Fi.Hi(b);return this.Af.meg(b)}ame(b){this.wm&&
(this.wm.Opi=!0);this.Fi.Hi(b);this.Mc.bs=this.Rh(this.Mc.bs);this.Af.ame(b)}reg(b){this.Mc.bt=this.Rh(this.Mc.bt);this.Fi.Hi(b);this.Af.reg(b)}bme(b){this.Mc.bu=this.Rh(this.Mc.bu);this.Fi.Hi(b);return this.Af.bme(b)}yeg(b){this.Mc.bv=this.Rh(this.Mc.bv);this.Fi.Hi(b);return this.Af.yeg(b)}dme(b){this.Mc.bw=this.Rh(this.Mc.bw);this.Fi.Hi(b);return this.Af.dme(b)}fme(b){this.Mc.bx=this.Rh(this.Mc.bx);this.Fi.Hi(b);return this.Af.fme(b)}hme(b){this.Mc.by=this.Rh(this.Mc.by);this.Fi.Hi(b);return this.Af.hme(b)}ime(b){this.wm&&
(this.wm.E0c=!0);this.Mc.bz=this.Rh(this.Mc.bz);this.Fi.Hi(b);return this.Af.ime(b)}Jeg(b){this.Mc.ca=this.Rh(this.Mc.ca);this.Fi.Hi(b);this.Af.Jeg(b)}Neg(b){this.Mc.cb=this.Rh(this.Mc.cb);this.Fi.Hi(b);return this.Af.Neg(b)}kme(b){this.wm&&(this.wm.Qam=!0);this.Mc.cc=this.Rh(this.Mc.cc);this.Fi.Hi(b);return this.Af.kme(b)}onMenuOpen(b){this.Mc.cd=this.Rh(this.Mc.cd);this.Fi.Hi(b);return this.Af.onMenuOpen(b)}Teg(b){this.Mc.ce=this.Rh(this.Mc.ce);this.Af.Teg(b)}afg(b){this.Mc.cf=this.Rh(this.Mc.cf);
this.Fi.Hi(b);return this.Af.afg(b)}bfg(b){this.Mc.cg=this.Rh(this.Mc.cg);this.Fi.Hi(b);return this.Af.bfg(b)}dfg(b){this.Mc.ch=this.Rh(this.Mc.ch);this.Fi.Hi(b);return this.Af.dfg(b)}vme(b){this.wm&&(this.wm.E0c=!0);this.Mc.ci=this.Rh(this.Mc.ci);this.Fi.Hi(b);return this.Af.vme(b)}ffg(b){this.Mc.cj=this.Rh(this.Mc.cj);this.Fi.Hi(b);return this.Af.ffg(b)}wme(b){this.Mc.ck=this.Rh(this.Mc.ck);this.Fi.Hi(b);return this.Af.wme(b)}Ame(b){this.Mc.cl=this.Rh(this.Mc.cl);this.Fi.Hi(b);return this.Af.Ame(b)}mfg(b){this.Mc.cm=
this.Rh(this.Mc.cm);this.Fi.Hi(b);this.Af.mfg(b)}Ime(b){this.Mc.cn=this.Rh(this.Mc.cn);this.Fi.Hi(b);return this.Af.Ime(b)}yfg(b){this.Mc.co=this.Rh(this.Mc.co);this.Fi.Hi(b);return this.Af.yfg(b)}Pme(b){this.Mc.cp=this.Rh(this.Mc.cp);this.Fi.Hi(b);return this.Af.Pme(b)}Qme(b){this.Mc.cq=this.Rh(this.Mc.cq);this.Fi.Hi(b);return this.Af.Qme(b)}Ofg(b){this.Mc.cr=this.Rh(this.Mc.cr);return this.Af.Ofg(b)}Ufg(b){this.Mc.cs=this.Rh(this.Mc.cs);this.Fi.Hi(b);return this.Af.Ufg(b)}ane(b){this.Mc.ct=this.Rh(this.Mc.ct);
this.Fi.Hi(b);return this.Af.ane(b)}bne(b){this.Mc.cu=this.Rh(this.Mc.cu);this.Fi.Hi(b);return this.Af.bne(b)}ene(b){this.Mc.cv=this.Rh(this.Mc.cv);this.Fi.Hi(b);return this.Af.ene(b)}fne(b){this.Mc.cw=this.Rh(this.Mc.cw);this.Fi.Hi(b);return this.Af.fne(b)}Yfg(b){this.Mc.cx=this.Rh(this.Mc.cx);return this.Af.Yfg(b)}gne(b){this.Mc.cy=this.Rh(this.Mc.cy);this.Fi.Hi(b);return this.Af.gne(b)}ine(b){this.Mc.cz=this.Rh(this.Mc.cz);this.Fi.Hi(b);return this.Af.ine(b)}kne(b){this.wm&&(this.wm.lsa=!0);this.Mc.da=
this.Rh(this.Mc.da);this.Fi.Hi(b);return this.Af.kne(b)}cgg(b){this.wm&&(this.wm.lsa=!0);this.Mc.db=this.Rh(this.Mc.db);this.Fi.Hi(b);return this.Af.cgg(b)}afd(b){this.wm&&(this.wm.lsa=!0);this.Mc.dc=this.Rh(this.Mc.dc);this.Fi.Hi(b);return this.Af.afd(b)}ggg(b){this.Mc.dd=this.Rh(this.Mc.dd);this.Fi.Hi(b);return this.Af.ggg(b)}hgg(b){this.Mc.de=this.Rh(this.Mc.de);this.Fi.Hi(b);return this.Af.hgg(b)}nne(b){this.wm&&(this.wm.lsa=!0);this.Mc.df=this.Rh(this.Mc.df);this.Fi.Hi(b);return this.Af.nne(b)}igg(b){this.wm&&
(this.wm.lsa=!0);this.Mc.dg=this.Rh(this.Mc.dg);this.Fi.Hi(b);return this.Af.igg(b)}lgg(b){this.Mc.dh=this.Rh(this.Mc.dh);this.Fi.Hi(b);return this.Af.lgg(b)}sne(b){this.wm&&(this.wm.lsa=!0);this.Mc.di=this.Rh(this.Mc.di);this.Fi.Hi(b);return this.Af.sne(b)}tne(b){this.Mc.dj=this.Rh(this.Mc.dj);this.Fi.Hi(b);return this.Af.tne(b)}une(b){this.Mc.dk=this.Rh(this.Mc.dk);this.Fi.Hi(b);return this.Af.une(b)}vne(b){this.wm&&(this.wm.E0c=!0);this.Mc.dl=this.Rh(this.Mc.dl);this.Fi.Hi(b);return this.Af.vne(b)}Ane(b){this.Mc.dm=
this.Rh(this.Mc.dm);this.Fi.Hi(b);return this.Af.Ane(b)}xne(b){this.Mc.dn=this.Rh(this.Mc.dn);this.Fi.Hi(b);return this.Af.xne(b)}}Object(u.a)(Ry,"HtmlEventUsageCollector",null,[511]);class WA{constructor(b,h,r=!1){this.Df=b;this.fD=h;this.b5k=r}}Object(u.a)(WA,"TagEventParam",null,[]);class Dz{constructor(b,h=null){this.pzd=this._prunedElements=this.paf=this._voidElements=null;this.yd=b;this.Y5=h||tr.a.eyi("");this.WWo()}get Mc(){return this.Y5}EPn(b,h,r){this.paf[h]?this.ogj():(this.Mc.e++,(h=this.pzd[h])&&
h(new WA(b,r,!1)),this.Mc.b++)}ogj(){this.Mc.d++}yPn(){this.Mc.c++}kPn(b,h,r){if(this.paf[h])this.ogj();else{if(h=this.pzd[h])return this.Mc.b++,h(new WA(b,r,!1));this.Mc.f++;return this.yd.xne(new WA(b,null))}return 2}WWo(){this._voidElements=qb.a.V8("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0);this.paf=qb.a.V8("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",
!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this._prunedElements=qb.a.V8("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);const b=this.yd,h=this.yd,r=this.yd,A=this.yd,M=this.yd,aa=this.yd,oa=this.yd,Ja=this.yd,fb=this.yd,Cb=this.yd,Gb=this.yd,Sb=this.yd,pc=this.yd,zc=this.yd,Yc=this.yd,Kd=this.yd,ke=this.yd,ge=this.yd,de=this.yd,
Sd=this.yd;this.pzd=qb.a.V8("A",Object(E.a)(this.yd,this.yd.Vke,"onAOpen"),"ABBR",Object(E.a)(this.yd,this.yd.jcg,"onAbbrOpen"),"ACRONYM",Object(E.a)(this.yd,this.yd.kcg,"onAcronymOpen"),"ADDRESS",Object(E.a)(this.yd,this.yd.ocg,"onAddressOpen"),"APPLET",Object(E.a)(this.yd,this.yd.Ccg,"onAppletOpen"),"AREA",Object(E.a)(this.yd,this.yd.Ecg,"onAreaTag"),"B",Object(E.a)(this.yd,this.yd.ble,"onBOpen"),"BASE",Object(E.a)(this.yd,this.yd.Fcg,"onBaseTag"),"BASEFONT",Object(E.a)(this.yd,this.yd.Gcg,"onBasefontTag"),
"BDO",Object(E.a)(this.yd,this.yd.Hcg,"onBdoOpen"),"BIG",Object(E.a)(this.yd,this.yd.fle,"onBigOpen"),"BLOCKQUOTE",Object(E.a)(this.yd,this.yd.gle,"onBlockquoteOpen"),"BODY",Object(E.a)(this.yd,this.yd.Wcg,"onBodyOpen"),"BR",Object(E.a)(this.yd,this.yd.hle,"onBrTag"),"BUTTON",Object(E.a)(this.yd,this.yd.Zcg,"onButtonOpen"),"CAPTION",Object(E.a)(this.yd,this.yd.ile,"onCaptionOpen"),"CENTER",Object(E.a)(this.yd,this.yd.jle,"onCenterOpen"),"CITE",Object(E.a)(this.yd,this.yd.mle,"onCiteOpen"),"CODE",
Object(E.a)(this.yd,this.yd.nle,"onCodeOpen"),"COL",Object(E.a)(this.yd,this.yd.kdg,"onColTag"),"COLGROUP",Object(E.a)(this.yd,this.yd.ldg,"onColgroupOpen"),"DD",Object(E.a)(this.yd,this.yd.ule,"onDdOpen"),"DEL",Object(E.a)(this.yd,this.yd.vle,"onDelOpen"),"DFN",Object(E.a)(this.yd,this.yd.yle,"onDfnOpen"),"DIR",Object(E.a)(this.yd,this.yd.zle,"onDirOpen"),"DIV",Object(E.a)(this.yd,this.yd.Ble,"onDivOpen"),"DL",Object(E.a)(this.yd,this.yd.Cle,"onDlOpen"),"DT",Object(E.a)(this.yd,this.yd.Dle,"onDtOpen"),
"EM",Object(E.a)(this.yd,this.yd.Gle,"onEmOpen"),"FIELDSET",Object(E.a)(this.yd,this.yd.Pdg,"onFieldsetOpen"),"FONT",Object(E.a)(this.yd,this.yd.Ole,"onFontOpen"),"FORM",Object(E.a)(this.yd,this.yd.Wdg,"onFormOpen"),"FRAME",Object(E.a)(this.yd,this.yd.Ydg,"onFrameTag"),"FRAMESET",Object(E.a)(this.yd,this.yd.Zdg,"onFramesetOpen"),"H1",Object(E.a)(this.yd,this.yd.Rle,"onH1Open"),"H2",Object(E.a)(this.yd,this.yd.Sle,"onH2Open"),"H3",Object(E.a)(this.yd,this.yd.Tle,"onH3Open"),"H4",Object(E.a)(this.yd,
this.yd.Ule,"onH4Open"),"H5",Object(E.a)(this.yd,this.yd.Vle,"onH5Open"),"H6",Object(E.a)(this.yd,this.yd.Wle,"onH6Open"),"HEAD",Object(E.a)(this.yd,this.yd.eeg,"onHeadOpen"),"HR",Object(E.a)(this.yd,this.yd.Xle,"onHrTag"),"HTML",Object(E.a)(this.yd,this.yd.keg,"onHtmlOpen"),"I",Object(E.a)(this.yd,this.yd.Yle,"onIOpen"),"IFRAME",Object(E.a)(this.yd,this.yd.meg,"onIframeOpen"),"IMG",Object(E.a)(this.yd,this.yd.ame,"onImgTag"),"INPUT",Object(E.a)(this.yd,this.yd.reg,"onInputTag"),"INS",Object(E.a)(this.yd,
this.yd.bme,"onInsOpen"),"ISINDEX",Object(E.a)(this.yd,this.yd.yeg,"onIsindexOpen"),"KBD",Object(E.a)(this.yd,this.yd.dme,"onKbdOpen"),"LABEL",Object(E.a)(this.yd,this.yd.fme,"onLabelOpen"),"LEGEND",Object(E.a)(this.yd,this.yd.hme,"onLegendOpen"),"LI",Object(E.a)(this.yd,this.yd.ime,"onLiOpen"),"LINK",Object(E.a)(this.yd,this.yd.Jeg,"onLinkTag"),"MAP",Object(E.a)(this.yd,this.yd.Neg,"onMapOpen"),"MATH",Object(E.a)(this.yd,this.yd.kme,"onMathOpen"),"MENU",Object(E.a)(this.yd,this.yd.onMenuOpen,"onMenuOpen"),
"META",Object(E.a)(this.yd,this.yd.Teg,"onMetaTag"),"NOFRAMES",Object(E.a)(this.yd,this.yd.afg,"onNoframesOpen"),"NOSCRIPT",Object(E.a)(this.yd,this.yd.bfg,"onNoscriptOpen"),"OBJECT",Object(E.a)(this.yd,this.yd.dfg,"onObjectOpen"),"OL",Object(E.a)(this.yd,this.yd.vme,"onOlOpen"),"OPTGROUP",Object(E.a)(this.yd,this.yd.ffg,"onOptgroupOpen"),"OPTION",Object(E.a)(this.yd,this.yd.wme,"onOptionOpen"),"P",Object(E.a)(this.yd,this.yd.Ame,"onPOpen"),"PARAM",Object(E.a)(this.yd,this.yd.mfg,"onParamTag"),"PRE",
Object(E.a)(this.yd,this.yd.Ime,"onPreOpen"),"Q",Object(E.a)(this.yd,this.yd.yfg,"onQOpen"),"S",Object(E.a)(this.yd,this.yd.Pme,"onSOpen"),"SAMP",Object(E.a)(this.yd,this.yd.Qme,"onSampOpen"),"SCRIPT",Object(E.a)(this.yd,this.yd.Ofg,"onScriptOpen"),"SELECT",Object(E.a)(this.yd,this.yd.Ufg,"onSelectOpen"),"SMALL",Object(E.a)(b,b.ane,"onSmallOpen"),"SPAN",Object(E.a)(h,h.bne,"onSpanOpen"),"STRIKE",Object(E.a)(r,r.ene,"onStrikeOpen"),"STRONG",Object(E.a)(A,A.fne,"onStrongOpen"),"STYLE",Object(E.a)(M,
M.Yfg,"onStyleOpen"),"SUB",Object(E.a)(aa,aa.gne,"onSubOpen"),"SUP",Object(E.a)(oa,oa.ine,"onSupOpen"),"TABLE",Object(E.a)(Ja,Ja.kne,"onTableOpen"),"TBODY",Object(E.a)(fb,fb.cgg,"onTbodyOpen"),"TD",Object(E.a)(Cb,Cb.afd,"onTdOpen"),"TEXTAREA",Object(E.a)(Gb,Gb.ggg,"onTextareaOpen"),"TFOOT",Object(E.a)(Sb,Sb.hgg,"onTfootOpen"),"TH",Object(E.a)(pc,pc.nne,"onThOpen"),"THEAD",Object(E.a)(zc,zc.igg,"onTheadOpen"),"TITLE",Object(E.a)(Yc,Yc.lgg,"onTitleOpen"),"TR",Object(E.a)(Kd,Kd.sne,"onTrOpen"),"TT",
Object(E.a)(ke,ke.tne,"onTtOpen"),"U",Object(E.a)(ge,ge.une,"onUOpen"),"UL",Object(E.a)(de,de.vne,"onUlOpen"),"VAR",Object(E.a)(Sd,Sd.Ane,"onVarOpen"))}}Object(u.a)(Dz,"AHtmlProcessor",null,[]);class Vt{constructor(b,h){this.childNodes=b.childNodes;this.fD=h;this.Vtf=0;this.Kce=!1}}Object(u.a)(Vt,"HtmlProcessorArguments",null,[]);class zs extends Dz{constructor(b,h=null){super(b,h);this.QWe=null}get Eln(){null==this.QWe&&(this.QWe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("CopyAndPasteTextFromWordWin32FixIsEnabled"):
!1);return this.QWe}process(b,h=null){b&&(this.yd.reset(),this.Wtj(new Vt(b,new ht.a),h))}Wtj(b,h){b.childNodes.length&&(b=new Fv.a(h,Object(E.a)(this,this.Cdo,"processChild"),b),b.qm("HTML Processing Operation"),h||(b.oi=!0),b.run())}Cdo(b,h){const r=h.childNodes[h.Vtf];if(3===r.nodeType)return this.yd.cle(),this.yd.tga(r.nodeValue,new WA(r,h.fD.Mui())),zs.Vzc(h);if(1!==r.nodeType)return zs.Vzc(h);if(!h.Kce){const M=I.a.kC(r.tagName);if(!zs.HVm(r))if(this._prunedElements[M])this.yPn();else{zs.GFn(r);
this.yd.cle();var A=r.id;const aa=r.tagName,oa=h.fD.Mui(),Ja=r.getAttribute?r.getAttribute("class"):null;A=new Hv(A,aa,Ja?Ja:"",r.attributes?r.attributes.length:0);A.isValid&&oa.add(A);if(this._voidElements[M])return this.EPn(r,M,oa),zs.Vzc(h);A=!1;switch(this.kPn(r,M,oa)){case 1:A=!0;break;case 3:return zs.Vzc(h)}switch(this.yd.uQf(r)){case 1:A=!0}h.Kce=A;this.Wtj(new Vt(r,oa),b);if(!b.oi)return!0}}if(h.Kce){if(this.Eln&&!this.pzd[I.a.kC(r.tagName)])return zs.Vzc(h);this.yd.onClose()}return zs.Vzc(h)}static GFn(b){3!==
b.nodeType&&nk.a.Dm(b,"alreadyPasted",!0)}static HVm(b){return 3!==b.nodeType&&nk.a.Eb(b,"alreadyPasted")}static Vzc(b){b.Vtf++;b.Kce=!1;return b.Vtf<b.childNodes.length}}Object(u.a)(zs,"HtmlProcessor",Dz,[]);var Yx=d(541);const ex={["font-size"]:0,["box-sizing"]:1,["font-family"]:2,["color"]:3,["padding"]:4,["margin"]:5,["border-bottom-width"]:6,["border-left-width"]:7,["border-top-width"]:8,["border-right-width"]:9,["border-bottom-style"]:10,["border-left-style"]:11,["border-top-style"]:12,["border-right-style"]:13,
["line-height"]:14,["border-bottom-color"]:15,["border-left-color"]:16,["border-top-color"]:17,["border-right-color"]:18,["border-image-repeat"]:19,["border-image-source"]:20,["border-image-width"]:21,["border-image-outset"]:22,["border-image-slice"]:23,["margin-bottom"]:24,["font-weight"]:25,["background-color"]:26,["font-style"]:27,["margin-top"]:28,["padding-top"]:29,["padding-right"]:30,["padding-left"]:31,["padding-bottom"]:32,["vertical-align"]:33,["margin-left"]:34,["margin-right"]:35,["white-space"]:36,
["width"]:37,["position"]:38,["text-align"]:39,["display"]:40,["font-variant-ligatures"]:41,["font-variant-caps"]:42,["outline-style"]:43,["outline-width"]:44,["outline-color"]:45,["font-variant-numeric"]:46,["font-stretch"]:47,["font-variant-east-asian"]:48,["height"]:49,["background-clip"]:50,["background-repeat-x"]:51,["background-repeat-y"]:52,["background-position-y"]:53,["background-position-x"]:54,["background-image"]:55,["background-size"]:56,["background-origin"]:57,["background-attachment"]:58,
["text-indent"]:59,["overflow-x"]:60,["overflow-y"]:61,["text-decoration-color"]:62,["text-decoration-style"]:63,["letter-spacing"]:64,["text-transform"]:65,["overflow-wrap"]:66,["float"]:67,["-webkit-text-stroke-width"]:68,["word-spacing"]:69,["orphans"]:70,["widows"]:71,["top"]:72,["border-top-right-radius"]:73,["border-top-left-radius"]:74,["border-bottom-right-radius"]:75,["border-bottom-left-radius"]:76,["text-decoration-line"]:77,["left"]:78,["unicode-bidi"]:79,["clear"]:80,["max-width"]:81,
["list-style-type"]:82,["min-height"]:83,["text-shadow"]:84,["bottom"]:85,["list-style-position"]:86,["list-style-image"]:87,["right"]:88,["-webkit-font-smoothing"]:89,["visibility"]:90,["cursor"]:91,["resize"]:92,["max-height"]:93,["word-break"]:94,["font-attr-size"]:95,["font-attr-face"]:96,["user-select"]:97,["min-width"]:98,["transition-duration"]:99,["transition-property"]:100,["transition-timing-function"]:101,["transition-delay"]:102,["clip"]:103,["transform"]:104,["opacity"]:105,["-webkit-tap-highlight-color"]:106,
["align-items"]:107,["flex-direction"]:108,["font-attr-color"]:109,["direction"]:110,["flex-shrink"]:111,["box-shadow"]:112,["text-rendering"]:113,["z-index"]:114,["flex-grow"]:115,["text-size-adjust"]:116,["flex-basis"]:117,["transform-origin"]:118,["quotes"]:119,["caption-side"]:120,["border-collapse"]:121,["counter-reset"]:122,["font-kerning"]:123,["text-overflow"]:124,["-webkit-text-stroke-color"]:125,["-webkit-user-drag"]:126,["-webkit-box-flex"]:127,["font-variant"]:128,["font-feature-settings"]:129,
["-webkit-border-horizontal-spacing"]:130,["-webkit-border-vertical-spacing"]:131,["justify-content"]:132,["margin-inline-start"]:133,["speak"]:134,["caret-color"]:135,["flex-wrap"]:136,["animation-duration"]:137,["animation-name"]:138,["animation-timing-function"]:139,["animation-fill-mode"]:140,["animation-delay"]:141,["animation-iteration-count"]:142,["animation-direction"]:143,["animation-play-state"]:144,["pointer-events"]:145,["grid-column-end"]:146,["grid-column-start"]:147,["break-inside"]:148,
["counter-increment"]:149,["touch-action"]:150,["word-wrap"]:151,["hyphens"]:152,["zoom"]:153,["break-after"]:154,["content"]:155,["break-before"]:156,["margin-block-start"]:157,["margin-block-end"]:158,["padding-inline-start"]:159,["-webkit-box-align"]:160,["tab-size"]:161,["-webkit-appearance"]:162,["table-layout"]:163,["transform-style"]:164,["-webkit-box-orient"]:165,["writing-mode"]:166,["-webkit-box-pack"]:167,["-webkit-box-direction"]:168,["order"]:169,["text-decoration"]:170,["--darkreader-inline-color"]:171,
["empty-cells"]:172,["backface-visibility"]:173,["object-fit"]:174,["--transition-duration"]:175,["clip-path"]:176,["margin-inline-end"]:177,["grid-template-columns"]:178,["--darkreader-inline-bgcolor"]:179,["-webkit-print-color-adjust"]:180,["-webkit-box-decoration-break"]:181,["filter"]:182,["perspective-origin"]:183,["fill"]:184,["align-content"]:185,["align-self"]:186,["column-count"]:187,["outline-offset"]:188,["--czi-counter-name"]:189,["--czi-counter-reset"]:190,["--czi-list-style-type"]:191,
["-webkit-line-clamp"]:192,["--darkreader-inline-border-bottom"]:193,["--darkreader-inline-border-left"]:194,["--darkreader-inline-border-right"]:195,["--darkreader-inline-border-top"]:196,["--saf-0"]:197,["will-change"]:198,["grid-row-start"]:199,["padding-inline-end"]:200,["padding-block-end"]:201,["padding-block-start"]:202,["grid-row-end"]:203,["-webkit-box-ordinal-group"]:204,["column-gap"]:205,["object-position"]:206,["image-rendering"]:207,["-webkit-user-modify"]:208,["column-width"]:209,["text-decoration-skip-ink"]:210,
["line-break"]:211,["grid-template-rows"]:212,["perspective"]:213,["justify-self"]:214,["page"]:215,["--language-font-face"]:216,["mix-blend-mode"]:217,["-webkit-text-fill-color"]:218,["grid-template-areas"]:219,["--darkreader-inline-bgimage"]:220,["--darkreader-inline-outline"]:221,["-webkit-hyphenate-character"]:222,["row-gap"]:223,["scroll-behavior"]:224,["text-align-last"]:225,["stroke"]:226,["column-fill"]:227,["--chat-message-background-color"]:228,["--message-border-radius-bottom-left"]:229,
["--message-border-radius-bottom-right"]:230,["--message-border-radius-top-left"]:231,["--message-border-radius-top-right"]:232,["-webkit-mask-image"]:233,["--ehixd-mediumheight"]:234,["--ehixd-mediumpadding"]:235,["--czi-content-line-height"]:236,["--chat-default-message-background-color"]:237,["overscroll-behavior-x"]:238,["overscroll-behavior-y"]:239,["contain"]:240,["-webkit-user-select"]:241,["border"]:242,["justify-items"]:243,["-webkit-border-image"]:244,["column-rule-color"]:245,["column-rule-style"]:246,
["column-rule-width"]:247,["--avatar-size"]:248,["--chat-message-align"]:249,["--chat-message-link-color"]:250,["--chat-message-max-width"]:251,["--black"]:252,["--blacktranslucent40"]:253,["--flaggedmessage"]:254,["--headerbackground"]:255,["--headerbackgroundsearch"]:256,["--headerbadgebackground"]:257,["--headerbadgetext"]:258,["--headerbrandtext"]:259,["--headerbuttonsbackground"]:260,["--headerbuttonsbackgroundhover"]:261,["--headerbuttonsbackgroundsearch"]:262,["--headerbuttonsbackgroundsearchhover"]:263,
["--headersearchboxbackground"]:264,["--headersearchboxicon"]:265,["--headersearchbuttonbackground"]:266,["--headersearchbuttonbackgroundhover"]:267,["--headersearchbuttonicon"]:268,["--headersearchfilters"]:269,["--headersearchfiltershover"]:270,["--headersearchicon"]:271,["--headersearchplaceholdertext"]:272,["--headertexticons"]:273,["--neutraldark"]:274,["--neutrallight"]:275,["--neutrallighter"]:276,["--neutrallighteralt"]:277,["--neutralprimary"]:278,["--neutralprimaryalt"]:279,["--neutralquaternary"]:280,
["--neutralquaternaryalt"]:281,["--neutralsecondary"]:282,["--neutraltertiary"]:283,["--neutraltertiaryalt"]:284,["--reddark"]:285,["--richusercontentbackground"]:286,["--searchboxbackground"]:287,["--themedark"]:288,["--themedarkalt"]:289,["--themedarker"]:290,["--themelight"]:291,["--themelighter"]:292,["--themelighteralt"]:293,["--themeprimary"]:294,["--themesecondary"]:295,["--themetertiary"]:296,["--white"]:297,["--whitetranslucent40"]:298,["--whitetranslucent90"]:299,["--button-width"]:300,
["fill-opacity"]:301,["--mousedown-x"]:302,["--mousedown-y"]:303,["--height"]:304,["--purple"]:305,["-webkit-line-break"]:306,["grid-auto-flow"]:307,["overflow-anchor"]:308,["backdrop-filter"]:309,["--spritesheet-position"]:310,["-webkit-mask-position-x"]:311,["-webkit-mask-position-y"]:312,["no style present"]:313,["OTHERS"]:314,["animation"]:315,["background"]:316,["background-blur"]:317,["background-position"]:318,["background-repeat"]:319,["border-bottom"]:320,["border-color"]:321,["border-image"]:322,
["border-left"]:323,["border-radius"]:324,["border-right"]:325,["border-spacing"]:326,["border-style"]:327,["border-top"]:328,["border-width"]:329,["column-rule"]:330,["column-span"]:331,["columns"]:332,["flex"]:333,["flex-flow"]:334,["font"]:335,["font-size-adjust"]:336,["gap"]:337,["grid"]:338,["grid-area"]:339,["grid-auto-columns"]:340,["grid-auto-rows"]:341,["grid-column"]:342,["grid-column-gap"]:343,["grid-gap"]:344,["grid-row"]:345,["grid-row-gap"]:346,["grid-template"]:347,["isolation"]:348,
["list-style"]:349,["outline"]:350,["overflow"]:351,["page-break-after"]:352,["page-break-before"]:353,["page-break-inside"]:354,["place-content"]:355,["place-items"]:356,["place-self"]:357,["scroll-snap-align"]:358,["scroll-snap-stop"]:359,["scroll-snap-type"]:360,["shape-image-threshold"]:361,["shape-margin"]:362,["shape-outside"]:363,["text-combine-upright"]:364,["text-justify"]:365,["text-orientation"]:366,["text-underline-position"]:367,["transition"]:368,["perspective-origin-x"]:369,["perspective-origin-y"]:370,
["scrollbar-width"]:371,["scroll-snap-coordinate"]:372,["scroll-snap-destination"]:373,["scroll-snap-points-x"]:374,["scroll-snap-points-y"]:375,["scroll-snap-type-x"]:376,["scroll-snap-type-y"]:377,["text-emphasis"]:378,["text-underline-offset"]:379,["transform-box"]:380},xC={["a"]:1,["b"]:2,["big"]:3,["blockquote"]:4,["br"]:5,["caption"]:6,["center"]:7,["cite"]:8,["code"]:9,["col"]:10,["colgroup"]:11,["dd"]:12,["del"]:13,["dfn"]:14,["area"]:15,["base"]:16,["basefont"]:17,["frame"]:18,["hr"]:19,
["img"]:20,["input"]:21,["link"]:22,["meta"]:23,["param"]:24,["abbr"]:25,["acronym"]:26,["address"]:27,["bdo"]:28,["body"]:29,["button"]:30,["fieldset"]:31,["form"]:32,["frameset"]:33,["html"]:34,["noframes"]:35,["noscript"]:36,["optgroup"]:37,["q"]:38,["select"]:39,["textarea"]:40,["applet"]:41,["head"]:42,["iframe"]:43,["isindex"]:44,["map"]:45,["object"]:46,["script"]:47,["style"]:48,["title"]:49,["dir"]:50,["div"]:51,["dl"]:52,["dt"]:53,["em"]:54,["font"]:55,["h"]:56,["i"]:57,["ins"]:58,["kbd"]:59,
["label"]:60,["legend"]:61,["li"]:62,["math"]:63,["menu"]:64,["ol"]:65,["option"]:66,["p"]:67,["pre"]:68,["s"]:69,["samp"]:70,["small"]:71,["span"]:72,["strike"]:73,["strong"]:74,["sub"]:75,["sup"]:76,["tables"]:77,["tbody"]:78,["td"]:79,["text"]:80,["tfoot"]:81,["th"]:82,["thead"]:83,["tr"]:84,["tt"]:85,["u"]:86,["ul"]:87,["var"]:88,["OTHERS"]:89,["article"]:90,["aside"]:91,["audio"]:92,["bb"]:93,["canvas"]:94,["command"]:95,["datagrid"]:96,["datalist"]:97,["details"]:98,["dialog"]:99,["embed"]:100,
["eventsource"]:101,["figcaption"]:102,["figure"]:103,["footer"]:104,["h1"]:105,["h2"]:106,["h3"]:107,["h4"]:108,["h5"]:109,["h6"]:110,["header"]:111,["hgroup"]:112,["keygen"]:113,["mark"]:114,["meter"]:115,["nav"]:116,["output"]:117,["progress"]:118,["rp"]:119,["rt"]:120,["ruby"]:121,["section"]:122,["source"]:123,["table"]:124,["time"]:125,["track"]:126,["video"]:127,["wbr"]:128};class kE{constructor(){this.px=0;this.qWc=6;this.Pam=this.Lpi=!1;this.oof=null;this.Tpi=this.Spi=this.Rpi=this.Npi=this.Mpi=
!1;this.progId=null;this.qEf=this.Ppi=this.Opi=this.lsa=this.E0c=this.Qam=this.Ram=!1;this.Kqj=this.Ysc=0;this.hoj=this.platform=null;this.$Ti=this.Ffe=!1;this.nAe=new Map;this.iMk={["Excel Online"]:1,["Word Online"]:2,["PowerPoint Online"]:3,["OneNote Online"]:4,["Google Docs"]:5,["Excel"]:6,["Word"]:7,["PowerPoint"]:8,["OneNote"]:9,["Other"]:10};this.pxf=[1,3,4,2,5];this.TDb={}}get nDg(){if(null!==this.oof)switch(this.oof){case "XLO":return"Excel Online"}if(this.Tpi)return"Word Online";if(this.Spi||
this.Mpi)return"PowerPoint Online";if(this.Lpi)return"Excel Online";if(this.Npi)return"Google Docs";if(this.Rpi)return"OneNote Online";switch(this.progId){case "Word.Document":return"Word";case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}TO(b,h){const r=new ia.a;r.name=b;"number"===typeof h?r.int64=h:"boolean"===typeof h?r.bool=h:"string"===typeof h&&(r.string=h);return r}pmd(b,h,r){const A=new Yx.a;A.name=b;A.dataFields=
h;A.dnmInterval=r;A.dnmAllowedPartA=this.pxf;ca.a.sendDirectNumericEvent(A)}ICn(){for(const [b,h]of this.nAe)for(const [r,A]of h){const M=[this.TO("style",b),this.TO("unit",r),this.TO("frequency",A)];Object(ac.a)("StylesAndUnitsFrequency",!0,0,M)}}LAn(){const b=this.Zdl(),h=[],r=[this.TO("isUserConsumer",this.Ffe),this.TO("isDocumentBlank",this.$Ti),this.TO("FoundText",this.qEf),this.TO("FoundTable",this.lsa),this.TO("FoundImage",this.Opi),this.TO("FoundList",this.E0c),this.TO("FoundLink",this.Ppi),
this.TO("Browser",this.Ysc),this.TO("SourceApp",this.iMk[this.nDg])];for(const A of r)h.push(A);this.pmd("Office.DNM.Word.Online.ExternalPasteEvent2",h,2);v.ULS.sendTraceTag(51406241,307,50,JSON.stringify(b))}vCl(b,h){var r,A;const M=[];b=this.TO("tag",null!==(r=xC[b])&&void 0!==r?r:xC.OTHERS);h=this.TO("style",null!==(A=ex[h])&&void 0!==A?A:ex.OTHERS);A=this.TO("IsUserConsumer",this.Ffe);M.push(b);M.push(h);M.push(A);this.pmd("Office.DNM.Word.Online.ExternalPasteEvent1",M,2)}wCl(b){var h;const r=
[];b=this.TO("tag",null!==(h=xC[b])&&void 0!==h?h:xC.OTHERS);h=this.TO("IsUserConsumer",this.Ffe);r.push(b);r.push(h);this.pmd("Office.DNM.Word.Online.ExternalPasteEvent3",r,2)}MAn(){const b=this.TDb;for(const A in b){var h=A,r=b[A];this.wCl(h);for(const M of Object.keys(r))this.vCl(h,M)}}A6c(b,h){b&&b.length&&h&&h.length&&(b=b.toLowerCase(),h=h.toLowerCase(),b in this.TDb||(this.TDb[b]={}),this.TDb[b][h]=this.uJm(b,h)+1)}uJm(b,h){if(!(b&&b.length&&h&&h.length&&this.TDb&&b in this.TDb))return 0;b=
b.toLowerCase();h=h.toLowerCase();return(b=this.TDb[b])&&h in b?b[h]:0}Zdl(){const b={};b.ActionIdFlags=this.px;b.SourceApp=this.nDg;b.CopySourceBrowser=this.qWc;b.PasteBrowser=this.Ysc;b.IsSameBrowserPaste=this.xnn(this.qWc,this.Ysc);b.IsCrossBrowserPaste=this.Jdn(this.qWc,this.Ysc);b.IsUncategorizedBrowserPaste=this.oqn(this.qWc,this.Ysc);b.Platform=this.platform;b.OperationId=this.hoj;return b}xnn(b,h){return 5===b||6===b?!1:b===h}Jdn(b,h){return 6===b?!1:b!==h}oqn(b,h){return 5===b&&5===h}}Object(u.a)(kE,
"HtmlContentMetadata",null,[]);var yC=d(231),rn=d(1039),fq=d(343),zi=d(49),fx=d(74),ds;(function(b){b[b.Jdk=0]="EmptyPara";b[b.rhk=1]="StartingOfPara";b[b.Mfk=2]="MiddleOfPara";b[b.Ldk=3]="EndOfPara"})(ds||(ds={}));Object(u.b)("PasteContext",ds);class Bn{constructor(b,h,r,A,M,aa,oa){this.Phc=oa;this.CXe=!1;this.Z_j=this.YVe=null;this.q7n=Ja=>{let fb=!1;return Fm.a.etb?(er.a.instance.$d(()=>{fb=this.xqj(Ja)},"APEM:PE"),fb):this.xqj(Ja)};this.xqj=Ja=>{db.a.mark(5568);this.wki(Ja);let fb=this.cIn;if(this.MYi){const Cb=
this.KRj();Cb&&(fb=this.ewb);v.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",Cb)}Ja.Oi(fb);return!0};this.cIn=Ja=>{db.a.mark(5569);var fb=new vd.a;this.xcb.restore(fb);var Cb=new vd.a;this.EDf.restore(Cb);this.EDf=null;v.ULS.shipAssertTag(6305489,307,Db.OutlineElementReader.Nh(fb));v.ULS.shipAssertTag(6305490,307,Db.OutlineElementReader.Nh(Cb));Bb.OutlineElementNavigator.Me(fb);const Gb=Gd.ParagraphReader.Bh(fb)?Gd.ParagraphReader.textLength(fb.currentNode):0;Bb.OutlineElementNavigator.je(fb);
Bb.OutlineElementNavigator.Me(Cb);v.ULS.shipAssertTag(6305491,307,Gd.ParagraphReader.Bh(Cb));const Sb=Gd.ParagraphReader.textLength(Cb.currentNode);Bb.OutlineElementNavigator.je(Cb);var pc=y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.WordOnline.ChangeGate.OfficeVSO_8111697_MergeParagraphsAfterCCPlaceholderPaste")&&this.fXi();let zc=this.pod||pc;var Yc=new xm.a;Yc.hd(fb);Bb.OutlineElementNavigator.Zs(Yc,!1,!1);var Kd=Yc.currentNode===Cb.currentNode,ke=!!this.Ri&&!!(this.Ri.px&8192);
let ge=!1;!ke&&this.Ri.rd&&Object(Xa.a)(wg.DictionaryPropertySet,this.Ri.rd)&&(ke=(pc=this.Ri.rd.wf(pd.a.aXb))&&""!==pc?!0:!1);pc=!1;this.Ri.rd instanceof yC.APropertySet&&(pc=this.Ri.rd.ka(pd.a.Ofa,!1));if(Kd){Yc=vd.a.Za(fb.currentNode);Gd.ParagraphReader.xu(Bb.OutlineElementNavigator.Me(Yc))||(fb=Cb);fb.currentNode.id!==Cb.currentNode.id&&(v.ULS.sendTraceTag(40691869,307,50,"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",of.ListItemReader.Cg(fb),of.ListItemReader.Cg(Cb)),
ke=Bn.gg.merge(fb,Cb,!0,ke),v.ULS.shipAssertTag(6305492,307,ke));Cb=fb;var de=!0}else{Kd=!!(this.Ri.px&4);de=this.Od.Lg&&Kd&&this.Ri.M$a;var Sd=!!(this.Ri.px&262144);this.Vig&&this.Ri&&!Kd&&!Sd&&(this.Vig.hLi(fb,!1),this.Vig.hLi(Cb,!0));Bb.OutlineElementNavigator.Me(Yc);Kd=Gd.ParagraphReader.Bh(Yc)?Gd.ParagraphReader.textLength(Yc.currentNode):0;Bb.OutlineElementNavigator.je(Yc);this.fXi()||this.r7k(Yc,fb,Cb);Sd=new xm.a;Sd.hd(Yc);Bb.OutlineElementNavigator.Zs(Sd,!1,!1);Sd.currentNode.id===Cb.currentNode.id&&
(this.CXe=!0);if(this.WZ.ITa||this.B_o)if(Sd.ko.id!==Cb.ko.id){for(;Yc.currentNode.id!==Cb.currentNode.id;)Bb.OutlineElementNavigator.Me(Yc,!1),this.WZ.MNa(wc.a.create(Yc.currentNode)),Yc.rc(),Bb.OutlineElementNavigator.Zs(Yc,!1,!1);Yc.hd(fb);Bb.OutlineElementNavigator.Zs(Yc,!1,!1)}else ge=!0;this.dda&&({pod:zc,xAa:Yc}=this.dda.amg(fb,Cb,zc,Yc));fx.a.eI&&this.Phc&&(Yc=this.Phc.amg(fb,Cb,Yc));if(this.Ri.Jte&&(v.ULS.shipAssertTag(6305493,307,this.Ri.Znc),Sd=new vd.a,Sd.hd(Yc),Sd=Bb.OutlineElementNavigator.Me(Sd))){var be=
this.Ri.Jte.Bf(Sd.ra.K(0));Sd.ra.K(0).formatting=be}Sd=0;ke&&this.Q2e&&(Sd=1);be=this.e0o(fb,Yc,Sd);this.Ri.Rze=null;if(this.Ri.KDa||this.Ri.u0a)this.Ri.Rze=this.aJm(be?fb.currentNode:Yc.currentNode,be);var Rf=!1;be&&(Rf=of.ListItemReader.Cg(fb),v.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",Rf,of.ListItemReader.Cg(Cb)),this.YVe=Rf=Bn.gg.merge(fb,Yc,!0,ke,Cb,void 0,ge,de,this.Q2e),this.f0o(fb,Sd)&&this.AIn(fb,Cb,Sd,ke));Sd=Bn.E7n.Y4m(fb,
Yc,Cb,Gb,Rf,this.ySb);var Mf=!1;if(zc){const Yj=new xm.a;Yj.hd(Cb);Bb.OutlineElementNavigator.z3(Yj,!1,!1);Mf=of.ListItemReader.Cg(Yj);const Ji=of.ListItemReader.Cg(Cb),sm=pc;v.ULS.sendTraceTag(509661707,307,50,"preserve EOP formatting : {0}",sm);const jn=!!(this.Ri.px&524288);de=Bn.gg.merge(Yj,Cb,!0,ke,void 0,!0,void 0,de,this.Q2e,sm,!jn,!jn);v.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",Mf,Ji,de?
"True":"False, will cause IP to reset to zero.");Cb=(Mf=de)?Yj:Cb}else de=!1,v.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero.");this.WZ.ITa&&ge&&(be&&!this.ogn(Sd,Rf)?(Yc=new vd.a,Yc.hd(fb),fb=Bb.OutlineElementNavigator.Me(Yc),this.WZ.jva(fb,Gb,Gb+Kd)):zc&&!this.Win(Sd,Mf)?(fb=new vd.a,fb.hd(Yc),fb=Bb.OutlineElementNavigator.Me(fb),this.WZ.jva(fb,0,Kd)):(fb=new vd.a,fb.hd(Yc),fb=Bb.OutlineElementNavigator.Me(fb),this.WZ.MNa(wc.a.create(fb))));this.nao(Sd);ke||this.VC.zeo(Sd)}v.ULS.shipAssertTag(6305494,
307,Cb.isValid);ke=Bb.OutlineElementNavigator.Me(Cb);fb=de?Gd.ParagraphReader.textLength(ke)-Sb:0;this.Ri.IJa=pc?sc.SelectionFactory.cL(ke,fb-1,fb):sc.SelectionFactory.ue(ke,fb);this.Ri&&this.Ri.Znc&&Gd.ParagraphReader.Vb(ke)&&this.Ri.Tne&&((pc=this.Ri.Tne.mbp)&&this.pM.WP(pc,ke,!0),(pc=this.Ri.Tne.k6n)&&this.nl.$Rh(ke,pc));Fm.a.Fek&&this.GTk(this.DCm(Gb,Sb));Ja.Oi(this.ewb);return!0};this.tVo=Ja=>{const fb=vd.a.Za(this.Z_j);fb.yL(1);this.Ri.IJa=sc.SelectionFactory.hp(fb.currentNode,!1);Ja.Oi(this.ewb);
return!0};this.ewb=()=>{var Ja=void 0===this.Ri.px||null===this.Ri.px?"not available":Object(bJ.a)(Py,this.Ri.px);v.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.Ri.px,Ja);v.ULS.shipAssertTag(6305497,307,!!this.Ri.IJa);this.ySb?Object(ac.a)("ExternalPasteAction",!0):Object(ac.a)("InternalPasteAction",!0);this.xcb&&(Ja=new vd.a,this.xcb.restore(Ja),this.xcb=null,this.TUm(Ja));this.transaction.dispose();this.ySb&&zt.a.RBn();Ja=this.Ky.Bw;if(!Ja.te||!Ja.Le.qk)return!1;Ja.Le.$ep();
return!1};this.iLa=b;this.EDf=this.xcb=null;this.Ri=h;this.transaction=r;this.dda=A;this.Ky=M;this.N9=aa}get J(){return y.AFrameworkApplication.J}get Q2e(){return!!this.J&&this.J.$("PasteTextOnlyKeepDestinationStyleIsEnabled")}get VC(){return null!=this.VVg?this.VVg:this.VVg=Za.a.instance.resolve(30)}get pM(){return null!=this.K5g?this.K5g:this.K5g=Za.a.instance.resolve(392)}get Wb(){return null!=this.i6g?this.i6g:this.i6g=Za.a.instance.resolve(8)}get nl(){return null!=this.w1g?this.w1g:this.w1g=
Za.a.instance.resolve(348)}get Md(){return null!=this.V_g?this.V_g:this.V_g=Za.a.instance.resolve(10)}get $l(){return null!=this.H_g?this.H_g:this.H_g=Za.a.instance.resolve(32)}get CF(){return null!=this.OWg?this.OWg:this.OWg=Za.a.instance.resolve(86)}get bpd(){return null!=this.N2g?this.N2g:this.N2g=Za.a.instance.Oa(880)}get Mj(){return null!=this.D4g?this.D4g:this.D4g=Za.a.instance.resolve(39).instance}get ti(){return null!=this.h5g?this.h5g:this.h5g=Za.a.instance.resolve(180).instance}get Od(){return null!=
this.N4g?this.N4g:this.N4g=Za.a.instance.resolve(46).instance}get WZ(){return null!=this.FSg?this.FSg:this.FSg=Za.a.instance.resolve(393)}get Vig(){return null!=this.I1g?this.I1g:this.I1g=Za.a.instance.Oa(881)}get Sqj(){return!1}yki(){}get ySb(){return!1}Fqj(b){let h=!1;return Fm.a.etb?(er.a.instance.$d(()=>{h=this.Gqj(b)},"APEM:PS"),h):this.Gqj(b)}Gqj(b){var h=void 0===this.Ri.px||null===this.Ri.px?"not available":Object(bJ.a)(Py,this.Ri.px);v.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",
this.Ri.px,h);v.ULS.shipAssertTag(6305487,307,ze.a.pf(this.iLa));if(this.wke)return v.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.Ri.IJa=sc.SelectionFactory.Qo(this.iLa),b.Oi(this.ewb),!0;if(!this.iLa.node)return v.ULS.sendTraceTag(572330334,307,10,"Something's wrong! The IP is pointing to a null node. Aborting paste"),!1;h=new vd.a;h.set(this.iLa.node);ze.a.tv(h);Bb.OutlineElementNavigator.je(h);this.Z_j=h.origin;if(this.Sqj)return h.jt(10),this.yki(h,b),b.Oi(this.tVo),!0;this.dda&&this.dda.jSn(this.iLa);
if(!this.j9o(this.iLa))return this.Ri.VU&&(this.Ri.VU.fail("SplitLine Failed",!0),this.Ri.MB=!0),this.Ri.IJa=sc.SelectionFactory.Qo(this.iLa),b.Oi(this.ewb),!0;const r=new xm.a;r.hd(h);Bb.OutlineElementNavigator.Zs(r,!1,!1);this.xcb=new rn.a(h);this.EDf=new rn.a(r);b.Oi(this.q7n);return!0}KRj(){return!1}get MYi(){return this.J.$("PptCcpFix2IsEnabled")}get B_o(){return this.J.$("CopyAndPasteOneParagraphIndentationFixIsEnabled")}DCm(b,h){if(0==b&&0==h)return ds.Jdk;if(0==b&&0!=h)return ds.rhk;if(0!=
b&&0!=h)return ds.Mfk;if(0==h&&0!=b)return ds.Ldk}GTk(b){b=[Object.assign(new ia.a,{name:"isExternalPaste",bool:this.ySb}),Object.assign(new ia.a,{name:"Single OE",bool:this.CXe}),Object.assign(new ia.a,{name:"Context",string:b})];Object(ac.a)("ContextualTelemetryForPaste",!0,void 0,b)}ogn(b,h){return!h&&!!b&&Db.OutlineElementReader.Nh(b.xAa)&&Db.OutlineElementReader.unb(b.xAa)}Win(b,h){return!h&&!!b&&Db.OutlineElementReader.Nh(b.Otb)&&Db.OutlineElementReader.unb(b.Otb)}nao(b){Bn.Esj&&b&&Bn.Esj.veo(b)}e0o(b,
h,r){var A;of.ListItemReader.Cg(b)?(null===(A=this.bpd)||void 0===A?void 0:A.FTf(b),h=of.ListItemReader.Cg(h)?this.cRj:!0):Db.OutlineElementReader.isEmpty(b,!0)&&!r?(Bn.gg.C7a(b),h=!1):h=!0;this.dda&&(h=this.dda.znl(b,h));return h}f0o(b,h){return of.ListItemReader.Cg(b)||1===h?!0:!1}AIn(b,h,r,A){const M=of.ListItemReader.Cg(b);if(M){if(A=new xm.a,A.hd(b),Bb.OutlineElementNavigator.Zs(A,!1,!1),A.ko.id!==h.ko.id){r=this.Md.Pw(b);if(of.ListItemReader.Ce)({listId:aa}=of.ListItemReader.Yka(b,{Gra:0}));
else{this.Md.o0(b);var aa=b.currentNode.ka(Mc.a.listID,0);b.rc()}var oa=this.Md.lUj,Ja=!0;for(r.tD=vj.a.Jk;A.currentNode.id!==h.currentNode.id;){if(!oa||!Db.OutlineElementReader.N1o(A))if(!of.ListItemReader.Cg(A))zi.a.getInstance().Fu?(Db.OutlineElementReader.olc(A)||({wla:r}=this.$l.Dqa(r.ff,A,r)),this.$l.N0()):{wla:r}=this.$l.Dqa(r.ff,A,r),Ja=!1;else if(M){Ja=of.ListItemReader.Ce?of.ListItemReader.Yka(A,{wUa:-1}).listLevel:this.Md.fKf(A);var fb=this.Md.Ty(b.currentNode,aa,Ja);fb=fb?fq.a.maa(fb,
null):r;Ja=fq.a.c_(fb.listType,r.listStyle,null,0,Ja,"","");Ja.dvb=b.currentNode;this.$l.XTo(Ja);this.$l.Qwe(A,!0);Ja=!1}Bb.OutlineElementNavigator.Zs(A,!1,!1)}oa&&Ja&&this.$l.D9k()}}else if(1===r)for(r=new xm.a,r.hd(b),Bb.OutlineElementNavigator.Me(r),b=Gd.ParagraphReader.Bh(r)?r.currentNode:null,aa=this.Wb.cNf(r),Bb.OutlineElementNavigator.je(r),Bb.OutlineElementNavigator.Zs(r,!1,!1);r.currentNode.id!==h.currentNode.id;)Bb.OutlineElementNavigator.Me(r),oa=Gd.ParagraphReader.Bh(r)?r.currentNode:
null,Bb.OutlineElementNavigator.je(r),oa&&b&&A&&(aa&&this.pM.WP(aa,oa,!0),this.N9.ocj(b,oa,M),this.N9.bua(b,oa,1,!0)),Bb.OutlineElementNavigator.Zs(r,!1,!1)}r7k(b,h,r){if(this.Od.Lg){for(;b.currentNode!==r.currentNode;){Bb.OutlineElementNavigator.Me(b,!1);const A=this.ti.opd(wc.a.create(b.currentNode));let M;({type:M}=A.R8d()).returnValue&&this.Od.Yu(M);for(let aa=0;aa<A.length;aa++){let oa;const Ja=({zfe:oa}=A.getContext(aa)).returnValue;oa&&(Bn.Jp.Wub(Ja,1),this.Mj.kyb(Ja,1,null,!0))}b.rc();Bb.OutlineElementNavigator.Zs(b,
!1,!1)}b.hd(h);Bb.OutlineElementNavigator.Zs(b,!1,!1)}}aJm(b,h){b=vd.a.Za(b);Bb.OutlineElementNavigator.Me(b);return Gd.ParagraphReader.Vb(b.currentNode)?(h=h?Gd.ParagraphReader.textLength(b.currentNode):0,sc.SelectionFactory.ue(b.currentNode,h)):Ii.TableReader.zU(b.currentNode)?sc.SelectionFactory.Gr(b.currentNode):null}TUm(b){if(b){if(this.ySb&&Ii.TableReader.ny(b)&&this.CXe){if(null!=this.YVe&&0==this.YVe){var h=new xm.a;h.hd(b);Bb.OutlineElementNavigator.Zs(h,!1,!1);b.hd(h)}h=No.a.FAo(b);const r=
Gd.ParagraphReader.Om(h);h&&r&&(this.Ri.IJa=sc.SelectionFactory.ue(r,0),b=vd.a.Za(h))}else Bn.Dln&&No.a.x7n(b);b&&Ii.TableReader.ny(b)&&Oh.returnToContainingCell(b)&&No.a.$0k(b.currentNode)}else v.ULS.sendTraceTag(525361991,3022,50,"Preceding iterator should not be null.")}AZo(b,h){const r=new vd.a;r.hd(b);b=Bb.OutlineElementNavigator.Me(r);h=Gd.ParagraphReader.Vb(b)&&h===Gd.ParagraphReader.textLength(b);v.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",h);return h}j9o(b){var h;v.ULS.shipAssertTag(6305498,
307,ze.a.pf(b));if(null===(h=this.CF)||void 0===h?0:h.cEa)return!!this.CF.cEa(b.node,b.cpBegin,{vbm:!0,Fb:b.Fb,Tb:b.Tb});h=vd.a.Za(b.node);var r=h.Kd();Bb.OutlineElementNavigator.je(h);r&&b.isValid||v.ULS.sendTraceTag(40425481,307,15,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:r,["ipContextNodeType"]:b.node.type,["isValidIpContext"]:b.isValid});if(!Db.OutlineElementReader.Nh(h)&&(v.ULS.sendTraceTag(594072134,307,10,"sourceOE is not an OutlineElement"),this.J.$("AbortClipboardOperationWhenFailToRootAtOEIsEnabled")))return!1;
r=Bn.gg.Vsa(h,!0);const A=this.AZo(h,b.cpBegin);Bn.gg.xca(h,r,b,!1,!1,!0,A);return!0}fXi(){return!!(this.Ri.px&65536)}static get Jp(){return null!=Bn.YWg?Bn.YWg:Bn.YWg=Za.a.instance.resolve(82)}static get pj(){return Um.PageReader.instance}static get gg(){return null!=Bn.I0g?Bn.I0g:Bn.I0g=Za.a.instance.resolve(18)}static get Cs(){return zi.a.getInstance()}static get sc(){return null!=Bn.dVg?Bn.dVg:Bn.dVg=Za.a.instance.Oa(12)}static get Esj(){return null!=Bn.O1g?Bn.O1g:Bn.O1g=Za.a.instance.resolve(883)}static get E7n(){return null!=
Bn.H1g?Bn.H1g:Bn.H1g=Za.a.instance.resolve(884)}static get Dln(){null==this.PWe&&(y.AFrameworkApplication.vd("PasteTableBelowTableNewExperience;PasteTableBelowTableNewExperienceCf"),this.PWe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBelowTableNewExperienceIsEnabled",!1):!1);return this.PWe}}Bn.PWe=null;Object(u.a)(Bn,"APasteExecutionManager",null,[]);class lE{constructor(b){this.rk=b}reset(){this.rk.reset()}get SXc(){return this.rk.SXc}tga(b,
h){this.rk.tga(b,h)}Dba(b){this.rk.Dba(b)}Dvb(b){this.rk.Dvb(b)}JCa(b){this.rk.JCa(b)}uMa(b){this.rk.uMa(b)}wYa(b,h){this.rk.wYa(b,h)}vYa(){this.rk.vYa()}JF(b){this.rk.JF(b)}eH(){this.rk.eH()}zvb(){this.rk.zvb()}yvb(){this.rk.yvb()}NCa(b){this.rk.NCa(b)}LCa(){this.rk.LCa()}xMa(b){this.rk.xMa(b)}MCa(){this.rk.MCa()}Xbb(b){this.rk.Xbb(b)}Jba(b){this.rk.Jba(b)}Hba(){this.rk.Hba()}X7(b){this.rk.X7(b)}Iba(){this.rk.Iba()}Gba(b){this.rk.Gba(b)}Fba(){this.rk.Fba()}AYa(b,h){this.rk.AYa(b,h)}Tbb(){this.rk.Tbb()}}
Object(u.a)(lE,"AHtmlNormalizer",null,[504,505]);class mE extends lE{constructor(b){super(b);this.WL=!1}tga(b,h){this.WL?this.GP.$O(()=>{this.omg(b,h)}):this.omg(b,h)}omg(b,h){this.rk.tga(b,h)}Dba(b){this.WL?this.GP.$O(()=>{this.Rlg(b)}):this.Rlg(b)}Rlg(b){this.rk.Dba(b)}JCa(b){this.WL?this.GP.$O(()=>{this.jhd(b)}):this.jhd(b)}jhd(b){this.rk.JCa(b)}uMa(b){this.WL?this.GP.$O(()=>{this.Plg(b)}):this.Plg(b)}Plg(b){this.rk.uMa(b)}wYa(b,h){this.WL?this.GP.$O(()=>{this.Ilg(b,h)}):this.Ilg(b,h)}Ilg(b,h){this.rk.wYa(b,
h)}vYa(){this.WL?this.GP.$O(Object(E.a)(this,this.Hlg,"processAnchorEnd")):this.Hlg()}Hlg(){this.rk.vYa()}JF(b){this.WL?this.GP.$O(()=>{this.$lg(b)}):this.$lg(b)}$lg(b){this.rk.JF(b)}eH(){this.WL?this.GP.$O(Object(E.a)(this,this.Zlg,"processParagraphEnd")):this.Zlg()}Zlg(){this.rk.eH()}zvb(){this.WL?this.GP.$O(Object(E.a)(this,this.cmg,"processPreFormattedTextStart")):this.cmg()}cmg(){this.rk.zvb()}yvb(){this.WL?this.GP.$O(Object(E.a)(this,this.bmg,"processPreFormattedTextEnd")):this.bmg()}bmg(){this.rk.yvb()}NCa(b){this.WL?
this.GP.$O(()=>{this.Vlg(b)}):this.Vlg(b)}Vlg(b){this.rk.NCa(b)}LCa(){this.WL?this.GP.$O(Object(E.a)(this,this.Slg,"processListEnd")):this.Slg()}Slg(){this.rk.LCa()}xMa(b){this.WL?this.GP.$O(()=>{this.Ulg(b)}):this.Ulg(b)}Ulg(b){this.rk.xMa(b)}MCa(){this.WL?this.GP.$O(Object(E.a)(this,this.Tlg,"processListItemEnd")):this.Tlg()}Tlg(){this.rk.MCa()}Jba(b){this.WL?this.GP.$O(()=>{this.nmg(b)}):this.nmg(b)}nmg(b){this.rk.Jba(b)}Hba(){this.WL?this.GP.$O(Object(E.a)(this,this.kmg,"processTableEnd")):this.kmg()}kmg(){this.rk.Hba()}X7(b){this.WL?
this.GP.$O(()=>{this.mmg(b)}):this.mmg(b)}mmg(b){this.rk.X7(b)}Iba(){this.WL?this.GP.$O(Object(E.a)(this,this.lmg,"processTableRowEnd")):this.lmg()}lmg(){this.rk.Iba()}Gba(b){this.WL?this.GP.$O(()=>{this.jmg(b)}):this.jmg(b)}jmg(b){this.rk.Gba(b)}Fba(){this.WL?this.GP.$O(Object(E.a)(this,this.hmg,"processTableCellEnd")):this.hmg()}hmg(){this.rk.Fba()}AYa(b,h){this.WL?this.GP.$O(()=>{this.Xlg(b,h)}):this.Xlg(b,h)}Xlg(b,h){this.rk.AYa(b,h)}Tbb(){this.WL?this.GP.$O(Object(E.a)(this,this.quj,"processMathEnd")):
this.quj()}quj(){this.rk.Tbb()}}Object(u.a)(mE,"AQueuingHtmlNormalizer",lE,[]);var hL=d(2E3);class XA{constructor(){this.u4e=new hL.a}$O(b){this.u4e.enqueue(b)}flush(b=!1){for(b&&this.kwe();!this.u4e.isEmpty;)this.u4e.dequeue()();b&&this.Yte()}kwe(){}Yte(){}}Object(u.a)(XA,"QueuedEventManager",null,[]);class Sy extends XA{constructor(b){super();this.id=void 0;this.guf=null;this.Q8c=!1;this.Pba="";this.Bde=this.xee=!1;this.Ytf=this.Efc=null;this.jdd=0;this.a9c=this.A$c=this.B0f=!1;this.table=null;
this.sag=0;this.E1=b}get hSc(){return!!this.table}kwe(){this.E1.Bsc.push(this.E1.currentState);this.E1.currentState=this}Yte(){this.E1.currentState=this.E1.Bsc.pop()}}Sy.nextId=void 0;Object(u.a)(Sy,"ContentState",XA,[]);class zC{constructor(b,h,r){this.colSpan=b.colSpan;this.rowSpan=b.rowSpan;this.width=b.width;this.height=b.height;this.mab=b.mab;this.shadingColor=b.shadingColor;this.verticalAlignment=b.verticalAlignment;this.Fna=b.Fna;this.VAe=b.VAe;this.Boc=b.Boc;this.V$=b.V$;this.contents=r;this.fQm=
h}}Object(u.a)(zC,"TableCell",null,[]);var Ty=d(1682),Rh=d(1683);class fr extends XA{constructor(b,h){super();this.E1=b;this.TFh=new ht.a;this.Coa=new ht.a;this.E_e=[];this.MKd=[];this.kQa=-1;this.B1a=0;this.vyk=h.rWf;this.uyk=h.Rbn;this.hNk=h.VFg;this.hs=h.width;this.Moh=h.mab;this.Evk=new cs.a(new Hv(h.Mba.$Ni,h.Mba.G$d),h.fD,h.WCa,h.cultureName,h.yHa);this.pxk=h.zae;this.qNd=h.styleId;this.mNk=h.tableLook}get rk(){return this.E1.rk}Qbo(b){this.kQa++;this.TFh.add(b);this.MKd[this.kQa]=b.height;
this.B1a=0}get UJl(){for(;this.B1a>=this.Coa.count;)this.Coa.add(Array(this.kQa+1));return this.Coa.K(this.B1a)}ZSk(b,h,r,A,M,aa,oa){if(0>this.kQa)return!1;for(;this.E_e[this.B1a]>=this.kQa;)this.B1a++;b=new zC(b,new cs.a(h,r,A,M,aa),oa);this.UJl[this.kQa]=b;if(1<b.rowSpan)for(h=this.kQa+b.rowSpan-1,A=this.B1a,r=this.B1a+b.colSpan-1;A<=r;A++)this.E_e[A]>=h||(this.E_e[A]=h);this.B1a+=b.colSpan;this.MKd[this.kQa]<b.height&&(this.MKd[this.kQa]=b.height);return!0}kwe(){this.E1.currentState.table=this}Yte(){this.E1.currentState.table=
null}joi(){y.AFrameworkApplication.vd("fd8b6402;j6e17681");this.flush(!0);const b=this.kQa+1;var h=Array(b);for(var r=0;r<b;r++)h[r]=Array(this.Coa.count);r=!0;var A=0;for(var M=0;M<this.Coa.count;M++){var aa=this.Coa.K(M),oa=!0;for(var Ja=0;Ja<b;Ja++){var fb=aa[Ja];fb&&(oa=!1,h[Ja][M+A]=new xu(fb.colSpan,fb.rowSpan,fb.width,fb.height,void 0,void 0,void 0,void 0,fb.mab,fb.Boc))}oa?(this.Coa.removeAt(M),M--,++A):r=!1}if(!r){(h=this.Moh?this.E1.yYh(h,this.hs/100):this.E1.yYh(h,1,this.hs))&&h.length!==
this.Coa.count&&(h=null);this.E1.Wob(!0);this.E1.rVd();this.rk.Jba(new Ny(b,this.Coa.count,this.hs,this.Moh,h,this.vyk,this.uyk,this.hNk,this.pxk,this.qNd,this.mNk,this.Evk));for(h=0;h<b;h++){r=this.TFh.K(h);this.rk.X7(new bx(this.MKd[h],new cs.a(r.Mba,r.fD,r.WCa,r.cultureName,r.yHa)));for(r=0;r<this.Coa.count;r++){A=this.Coa.K(r)[h];var Cb=!!this.qNd&&""!==this.qNd&&"Custom"!==this.qNd;M=A?A.colSpan:0;aa=A?A.rowSpan:0;A&&(M=Math.min(A.colSpan,this.Coa.count-r),aa=Math.min(A.rowSpan,b-h));oa=A?A.width:
0;Ja=A?A.height:0;fb=A?A.V$:0;const Gb=A?A.mab:!1,Sb=A&&(65536&fb||!Cb)?A.shadingColor:"",pc=A?A.verticalAlignment:0,zc=A?A.Boc:!1;Cb=A?this.E1.uzm(A.Fna,r,h,this.Coa,Cb,A.V$):new Ty.a;const Yc=A?A.VAe:new Rh.a,Kd=A?A.fQm:null;this.rk.Gba(new xu(M,aa,oa,Ja,Sb,pc,Cb,Yc,Gb,zc,fb,new cs.a(Kd?Kd.Mba:null,Kd?Kd.fD:null,Kd?Kd.WCa:null,Kd?Kd.cultureName:null,Kd?Kd.yHa:null)));A&&!A.Boc&&(A.contents.kwe(),A.contents.flush(),this.E1.Wob(!1),this.E1.rVd(),A.contents.Yte());this.rk.Fba()}this.rk.Iba()}this.rk.Hba();
this.E1.currentState.a9c=!1;this.E1.oji(!1)}}}Object(u.a)(fr,"NormalizedTable",XA,[]);class Lh{constructor(b=!1,h=!1){this.izk=b;this.$pa=h}get gin(){return this.izk}get reb(){return this.$pa}}Object(u.a)(Lh,"HtmlNormalizerSettings",null,[512]);class it extends mE{constructor(b,h=null){super(b);this.Bsc=new SA;this.h7b=h||new Lh}reset(){super.reset();this.currentState=new Sy(this);this.Bsc.clear();this.WL=!1}get GP(){return this.currentState&&this.currentState.hSc?this.currentState.table:this.currentState}QZc(b=
!1){this.currentState.Q8c||(this.rVd(),this.rk.JF(this.currentState.guf),this.currentState.Q8c=!0,this.currentState.a9c=!1);b||!this.currentState.Efc||this.currentState.Bde||(this.rk.wYa(this.currentState.Efc,this.currentState.Ytf),this.currentState.Bde=!0)}PZc(){this.currentState.Bde&&(this.rk.vYa(),this.currentState.Bde=!1)}pji(){this.currentState.Q8c&&(this.rk.eH(),this.currentState.Q8c=!1,this.currentState.Pba="")}oji(b){this.currentState.A$c&&(this.currentState.a9c?b||(this.rk.JF(null),this.rk.eH(),
this.rk.MCa(),this.currentState.A$c=!1):(this.rk.MCa(),this.currentState.A$c=!1,this.currentState.a9c=!0))}Wob(b){this.PZc();this.pji();this.oji(b)}E2n(b){this.rk.NCa(new fp.a(2,1,b));this.currentState.jdd++;this.currentState.B0f=!0}rVd(){!this.currentState.A$c&&this.currentState.B0f&&(this.rk.LCa(),this.currentState.jdd--,this.currentState.B0f=!1)}omg(b,h){b=this.zOn(b);if(""!==b)if(this.QZc(),this.currentState.xee)this.pmg(b,h);else{b=b.split(it.kgl);for(let r=0;r<b.length-1;r++)this.pmg(b[r],h),
this.rk.Dvb(h);this.pmg(b[b.length-1],h)}}Xlg(b,h){""!==b&&(this.QZc(),this.rk.AYa(b,h))}Rlg(b){this.h7b.reb||this.PZc();if(Fm.a.gkn){const h=this.currentState.Q8c;this.QZc(!0);h?this.rk.Dba(b):this.pji()}else this.QZc(!0),this.rk.Dba(b)}Plg(b){this.currentState.hSc||this.rk.uMa(b)}jhd(b){this.currentState.Efc&&(b.href=this.currentState.Efc);super.jhd(b)}Ilg(b,h){this.PZc();this.currentState.Efc=b;this.currentState.Ytf=h}Hlg(){this.PZc();this.currentState.Efc=null;this.currentState.Ytf=null}$lg(b){this.currentState.guf=
b;this.Wob(!0)}Zlg(){this.currentState.guf=null;this.Wob(!0)}cmg(){this.currentState.xee=!0}bmg(){this.currentState.xee=!1}Vlg(b){this.Wob(!1);this.rVd();this.rk.NCa(b);this.currentState.jdd++}Slg(){this.Wob(!1);this.rk.LCa();this.currentState.jdd--}Ulg(b){this.Wob(!1);this.currentState.jdd||this.E2n(b);this.rk.xMa(b);this.currentState.A$c=!0;this.currentState.a9c=!0}Tlg(){this.Wob(!1)}Jba(b){this.currentState.hSc||(this.WL=!0,this.currentState.table=new fr(this,b))}nmg(){}Hba(){if(this.currentState.table){var b=
this.currentState.table;this.currentState.table=null;this.Bsc.isEmpty?(this.WL=!1,b.joi()):this.GP.$O(Object(E.a)(b,b.joi,"flushTable"))}}kmg(){}X7(b){this.currentState.hSc&&this.currentState.table.Qbo(b)}mmg(){}Iba(){}lmg(){}Gba(b){let h=!1;if(this.currentState.hSc){const r=new Sy(this);this.currentState.table.ZSk(b,new Hv(b.Mba.$Ni,b.Mba.G$d),b.fD,b.WCa,b.cultureName,b.yHa,r)?(this.Bsc.push(this.currentState),this.currentState=r):h=!0}else h=!0;h&&this.currentState.sag++}jmg(){}Fba(){0<this.currentState.sag?
this.currentState.sag--:this.currentState=this.Bsc.pop()}hmg(){}yYh(b,h=1,r=0){if(!b)return null;const A=b.length;if(!A)return null;const M=b[0].length;for(var aa=1;aa<A;aa++)if(b[aa].length!==M)return null;aa=Array(M+1);aa[0]=0;const oa=Array(M+1);for(var Ja=0;Ja<oa.length;Ja++)oa[Ja]=!1;Ja=new ib.a;for(let Cb=0;Cb<M;Cb++){for(var fb=0;fb<A;fb++){const Gb=b[fb][Cb];if(Gb&&0<Gb.width){const Sb=Math.min(Cb+Gb.colSpan,M);aa[Sb]=aa[Cb]+Gb.width*(Gb.mab?h:1);oa[Sb]=!0}}if(oa[Cb+1]){fb=aa[Cb+1]-aa[Cb];
if(0>=fb)return null;Ja.add(fb)}else aa[Cb+1]=aa[Cb]}return Fm.a.h0f&&aa[M]<r?null:Ja.toArray()}pGn(b,h){1&h||(b.borderTopStyle=12);16&h||(b.borderRightStyle=12);256&h||(b.borderBottomStyle=12);4096&h||(b.borderLeftStyle=12);return b}uzm(b,h,r,A,M,aa){if(!b)return null;M&&(b=this.pGn(b,aa));if(0>r||0>h||h>A.count-1)return b;0<=h-1&&r<=A.K(h-1).length-1&&1===b.borderLeftStyle&&(M=A.K(h-1)[r])&&1!==M.Fna.borderRightStyle&&(b.borderLeftStyle=M.Fna.borderRightStyle,b.borderLeftColor=M.Fna.borderRightColor,
b.borderLeftWidth=M.Fna.borderRightWidth);0<=r-1&&r<=A.K(h).length-1&&1===b.borderTopStyle&&(h=A.K(h)[r-1])&&1!==h.Fna.borderBottomStyle&&(b.borderTopStyle=h.Fna.borderBottomStyle,b.borderTopColor=h.Fna.borderBottomColor,b.borderTopWidth=h.Fna.borderBottomWidth);return b}zOn(b){this.currentState.xee||(b=this.h7b.gin?b.replace(it.o_m," "):b.replace(it.n_m," "));b.startsWith(" ")&&(this.currentState.Pba.endsWith(" ")||""===this.currentState.Pba)&&(b=I.a.substring(b,1,b.length));return b}pmg(b,h){""!==
b&&(this.rk.tga(b,h),this.currentState.Pba+=b)}}it.n_m=RegExp("[ \t\f\u200b\r\n]+","g");it.o_m=RegExp("[ \f\u200b\r\n]+","g");it.kgl="\t";Object(u.a)(it,"DefaultHtmlNormalizer",mE,[]);class es extends it{constructor(b,h,r){super(b,r);this.Bjh=!1;this.YDb=h}static nen(b){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerImageUrl",!1)&&b?(b=es.tPl.exec(b))&&0<b.length:!1}jhd(b){this.YDb.jtc&&(y.AFrameworkApplication.Mta?this.Bjh||(b=new ni.StandardDialog,b.Fd=
0,b.Qe(1,CommonUIStrings.l_DialogClose),b.Ex(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,1,null),this.Bjh=!0):this.YDb.tbj?this.YDb.Fie=!0:b.src&&""!==b.src?$a.a.getOrigin(b.src)!==$a.a.getOrigin(window.location.href)||es.nen(b.src)?b.src.startsWith("data:")&&19922944<b.src.length?y.AFrameworkApplication.va.Ob(ub.a.Nqj,2):b.src.startsWith("webkit-fake-url")?y.AFrameworkApplication.va.Ob(ub.a.Mqj,2):(this.PZc(),this.QZc(!0),this.rk.JCa(b)):y.AFrameworkApplication.va.Ob(ub.a.Pqj,
2):y.AFrameworkApplication.va.Ob(ub.a.Oqj,2))}}es.tPl=RegExp(".\\/we\\/s\\/\\d+_resources\\/\\d+\\/\\D.+(.png|.jpg)");Object(u.a)(es,"Box4HtmlNormalizer",it,[]);class YA{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb){this.aOi=b;this.eTf=h;this.Gll=r;this.dak=A;this.Mam=M;this.fLo=aa;this.gLo=oa;this.O5c=Ja;this.f_m=fb;this.i_m=Cb;this.Zad=Gb}}Object(u.a)(YA,"ExecutePasteArguments",null,[]);class As extends Bn{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc,zc,Yc,Kd,ke,ge=null){super(h,r,A,Cb,Sb,Yc,ke);this.cRb=
ge;this.A5=null;this.sOn=de=>{this.tLk&&this.UTe.flp(this.k$);de.Oi(this.Ubo);return!0};this.Ubo=de=>{if(this.IKk){const Sd=this.k$.getElementsByTagName("style");if(Sd&&0<Sd.length){v.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let be=0;be<Sd.length;be++)this.TQe.pzl(this.k$,Sd[be]),Sd[be]&&(Sd[be].parentNode.removeChild(Sd[be]),be--)}}de.Oi(this.Czl);return!0};this.Czl=(de,Sd)=>{this.acf.value.create(Sd.dak).process(this.k$,
de);(Sd=Za.a.instance.Oa(12))&&Sd.isFeatureEnabled(8)?de.Oi(this.Jyl):de.Oi(this.juj);return!0};this.Jyl=(de,Sd)=>{(new jG(Sd.Gll)).process(this.k$,de);de.Oi(this.juj);return!0};this.juj=(de,Sd)=>{var be;y.AFrameworkApplication.vd("j6cj2207;gfehe251");if(Fm.a.ita){var Rf=window.performance.now();this.k$=this.cRb.I4k(this.k$);zt.a.Dte=window.performance.now()-Rf}else if(Fm.a.eoc&&!document.getElementById("FrameContainingPastedDOM")){Rf=window.performance.now();var Mf=document.createElement("iframe");
Mf.style.visibility="hidden";Mf.style.zIndex="-100";Mf.style.position="absolute";Mf.style.width=window.screen.width+"px";Mf.style.height=window.screen.height+"px";Mf.style.contain="strict";Mf.setAttribute("sandbox","allow-same-origin");Mf.id="FrameContainingPastedDOM";document.body.appendChild(Mf);(Mf=Mf.contentDocument)&&Fm.a.non&&(Mf.documentElement.style.fontSize="62.5%",Mf.body.style.fontSize="1.6rem");zt.a.dYd=window.performance.now()-Rf}Mf=null;!Fm.a.ita&&Fm.a.eoc&&(Mf=document.getElementById("FrameContainingPastedDOM"));
!Fm.a.ita&&Fm.a.eoc&&Mf instanceof HTMLIFrameElement?(Rf=window.performance.now(),Mf=null===(be=Mf.contentDocument)||void 0===be?void 0:be.querySelector("body"),null===Mf||void 0===Mf?void 0:Mf.appendChild(this.k$),zt.a.Dte=window.performance.now()-Rf,be=null===Mf||void 0===Mf?void 0:Mf.children,1!==(null===be||void 0===be?void 0:be.length)&&v.ULS.sendTraceTag(508913473,307,15,"Found Multiple Pasted Container in iframe element"),Sd.aOi.process(1===(null===be||void 0===be?void 0:be.length)?be[0]:this.k$,
de)):Sd.aOi.process(this.k$,de);de.Oi(Sd.eTf&&Sd.eTf.jtc?this.iZb:this.yii);return!0};this.iZb=(de,Sd)=>{if(Sd=Sd.eTf){let Rf=!1,Mf=!1,Yj=!1,Ji=!1;var be=-1;const sm=new wg.DictionaryPropertySet,jn=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');Object(Xa.a)(89,this.Ri.rd)?(Rf=this.Ri.rd.ka(Mc.a.Kla,!1),be=this.Ri.rd.ka(pd.a.QX,""),Yj=this.Ri.rd.ka(pd.a.Ofa,!1),Ji=this.Ri.rd.ka(He.a.TBa,!1),jn.test(be)&&(Mf=!0),be=this.Ri.rd.ka(fd.a.rka,-1)):this.Ri.px&256&&this.k$&&(Rf=!0,jn.test(this.k$.innerHTML)&&
(Mf=!0));sm.setValue(Mc.a.Kla,Rf);sm.setValue(pd.a.F$c,Mf);sm.setValue(pd.a.Ofa,Yj);sm.setValue(fd.a.rka,be);sm.setValue(He.a.TBa,Ji);Sd.Gwe(sm);Sd.nfg();Sd.avb&&(this.Ri.O8c=!0,this.Ri.zTf=Sd.f_,this.Ri.Qbg=Sd.avb,Rf&&!Yj&&ac.c(ub.a.A2l),y.AFrameworkApplication.va.Ob(ub.a.iZb,2))}de.Oi(this.yii);return!0};this.yii=(de,Sd)=>{var be;de=window.performance.now();if(Fm.a.ita)this.cRb.qwo();else if(Fm.a.eoc){var Rf=document.getElementById("FrameContainingPastedDOM");Rf instanceof HTMLIFrameElement&&(Rf=
null===(be=Rf.contentDocument)||void 0===be?void 0:be.querySelector("body"),(null===Rf||void 0===Rf?0:Rf.firstElementChild)?(v.ULS.sendTraceTag(508858444,307,50,"iframe body first element child was not null"),null===Rf||void 0===Rf?void 0:Rf.removeChild(null===Rf||void 0===Rf?void 0:Rf.firstElementChild)):v.ULS.sendTraceTag(508858443,307,15,"iframe body first element child was null"))}zt.a.hsg=window.performance.now()-de;tr.a.xDn(Sd.dak);tr.a.OAn(Sd.i_m);tr.a.uCn(Sd.fLo);tr.a.vCn(Sd.gLo);tr.a.lBn(Sd.Zad);
be="Others";Sd.O5c&&(Sd.O5c.LAn(),Sd.O5c.MAn(),Sd.O5c.ICn(),be=Sd.O5c.nDg);tr.a.NAn(Sd.f_m,be);tr.a.wAn(Sd.Mam,be);return!1};this.k$=b;this.EKe=M;this.BUe=aa;this.P9e=oa;this.acf=Ja;this.SHc=fb;this.h7b=zc;this.Ga=Gb;this.tkh=Object.assign(new eG,{fnc:2===this.Ri.efc||3===this.Ri.efc});this.TQe=pc;this.UTe=Kd;this.T$b=Gb.$("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.IKk=Gb.$("ParseStyleFromRawHtmlHeadIsEnabled");this.tLk=Gb.$("RemoveSpacesAfterEndFragmentIsEnabled")}get wke(){return!1}get ySb(){return!0}wki(b){Fm.a.etb?
er.a.instance.$d(()=>{this.xki(b)},"EPEM:EP"):this.xki(b)}xki(b){this.A5=new vd.a;this.xcb.restore(this.A5);v.ULS.shipAssertTag(6305550,307,Db.OutlineElementReader.Nh(this.A5));this.Ri.VU&&this.Ri.VU.Occ("external");var h=this.Ri.px&8192?1:0,r=this.BUe.value.create(h,this.A5,this.Ri.ZUc,this.Ri.pxb),A=this.P9e.value.create(h,this.A5);const M=tr.a.pti(y.AFrameworkApplication.userSessionId),aa=tr.a.LIi(y.AFrameworkApplication.userSessionId),oa=tr.a.XIf(Y.a.HKb,this.Ri.ZUc),Ja=tr.a.lFi(y.AFrameworkApplication.userSessionId),
fb=tr.a.mFi(y.AFrameworkApplication.userSessionId),Cb=this.T$b?this.C4m():null,Gb=tr.a.dyi(Y.a.HKb,this.Ri.ZUc),Sb=tr.a.eyi(y.AFrameworkApplication.userSessionId),pc=this.SHc.LQj?tr.a.lwm(y.AFrameworkApplication.userSessionId):null;h=this.EKe.value.create(h,this.A5,r,A,null,oa,this.Z2k,this.Ri.ABe);h=new jE(h,Ja,fb);h=new es(h,r,this.h7b);h=new Rn(h,this.SHc,this.tkh,pc,Fm.a.ita?this.cRb:null);A=new kG(Cb);h=new Ry(h,A,Gb,Cb,this.Ga);h=new zs(h,Sb);r=new YA(h,r,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc);r=new Fv.a(b,
this.sOn,r);r.qm("paste and request pictures");r.oi=!b||b.oi;r.run()}get Z2k(){return this.k$.getElementsByTagName("a").length}C4m(){const b=new kE;b.Ysc=Y.a.HKb;this.Ri&&(b.px=this.Ri.px,b.hoj=this.Ri.ZUc,this.Ri.rd&&(b.progId=this.Ri.rd.ka(pd.a.Lqj,"")));this.k$&&this.k$.innerHTML&&(b.Kqj=this.k$.innerHTML.length,zt.a.Sig=b.Kqj);y.AFrameworkApplication.sessionStartInfoSettings&&(b.platform=y.AFrameworkApplication.sessionStartInfoSettings.Platform,b.Ffe=y.AFrameworkApplication.J.$("IsO365ConsumerHost"),
b.$Ti=Gd.ParagraphReader.Jqa(qa.StaticActiveAppFrame.za().kb.Jc.od));return b}get cRj(){return!0}get pod(){v.ULS.shipAssertTag(6305551,307,!!this.A5);if(this.SHc.MQj(this.tkh)){var b=!1;Db.OutlineElementReader.Nh(this.A5)&&(this.A5.y_(),b=!0);var h=Gd.ParagraphReader.Bh(this.A5)&&!this.A5.currentNode.ka(pd.a.oWi,!1);b&&this.A5.rc();return h}return this.Ri.px&524288?(b=!1,Db.OutlineElementReader.Nh(this.A5)&&(this.A5.y_(),b=!0),h=Gd.ParagraphReader.Bh(this.A5),b&&this.A5.rc(),h):Gd.ParagraphReader.Bh(this.A5)}}
Object(u.a)(As,"ExternalPasteExecutionManager",Bn,[]);class lG{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc=null){this.Phc=Sb;this.cRb=pc;this.EKe=b;this.BUe=h;this.P9e=r;this.acf=A;this.SHc=M;this.dda=aa;this.Ga=oa;this.TQe=Ja;this.h7b=fb;this.N9=Cb;this.UTe=Gb}create(b,h,r,A){return new As(b,h,r,A,this.EKe,this.BUe,this.P9e,this.acf,this.SHc.value,this.dda,this.Ga,qa.StaticActiveAppFrame.za().kb,this.TQe,this.h7b,this.N9,this.UTe,this.Phc,Fm.a.ita?this.cRb.value:null)}}Object(u.a)(lG,"Factory",
null,[684]);class eJ{constructor(b=null){var h;this.RF=b;b=window.performance.now();Fm.a.jUi&&(null===(h=this.RF)||void 0===h?void 0:h.execute(r=>{r.logActivity("CCPUsage","CCPFloodgateSurvey")}));this.psf();zt.a.dYd=window.performance.now()-b}I4k(b){if(this.vfa.contentDocument){const h=this.vfa.contentDocument.body;b=h.appendChild(b);1!==h.children.length&&v.ULS.sendTraceTag(508624975,307,15,`Found Non-One Pasted Containers ${h.children.length}`);return b}v.ULS.sendTraceTag(508624974,307,15,"iframe not loaded when append method was called");
return b}qwo(){if(this.vfa.contentDocument){var b=this.vfa.contentDocument.body;b.lastElementChild?(v.ULS.sendTraceTag(508624930,307,50,"iframe body first element child was not null"),b.removeChild(b.lastElementChild)):v.ULS.sendTraceTag(508624929,307,15,"iframe body first element child was null")}}Z3l(b){var h;const r=null===(h=this.vfa.contentDocument)||void 0===h?void 0:h.body;return(null===r||void 0===r?0:r.contains(b))?getComputedStyle(b):b.style}psf(){var b=document.getElementById(vi.a.OAc);
this.vfa=document.createElement("iframe");this.vfa.style.visibility="hidden";this.vfa.style.zIndex="-100";this.vfa.style.position="absolute";this.vfa.style.contain="strict";Fm.a.mon&&(this.vfa.style.width=window.screen.width+"px",this.vfa.style.height=window.screen.height+"px");this.vfa.setAttribute("sandbox","allow-same-origin");this.vfa.id="FrameContainingPastedDOM";b?(b.appendChild(this.vfa),b=this.vfa.contentDocument,Fm.a.B0i&&b?(b.documentElement.style.fontSize="62.5%",b.body.style.fontSize=
"1.6rem"):Fm.a.B0i&&v.ULS.sendTraceTag(508441186,307,15,"Iframe not loaded when setting root fontSize")):v.ULS.sendTraceTag(508624973,307,15,"View Panel not found")}}Object(u.a)(eJ,"HiddenExternalPasteView",null,[683]);class Qw{Ftn(b){if(!b||!b.childNodes)return!1;const h=b.childNodes.length;return 2>h?!1:this.wfn(b.childNodes[h-2])&&this.vrn(b.childNodes[h-1])}flp(b){this.Ftn(b)&&(b.removeChild(b.lastChild),v.ULS.sendTraceTag(579371169,307,50,"Remove spaces after end fragment"))}Qcn(b){return!!b&&
8===b.nodeType}Ppn(b){return!!b&&3===b.nodeType}wfn(b){return this.Qcn(b)&&"EndFragment"===b.nodeValue}vrn(b){if(!this.Ppn(b))return!1;b=b.nodeValue;return!!b&&!b.trim().length}}Object(u.a)(Qw,"HtmlNormalizerHelper",null,[682]);var Iv=d(973),ZA=d(626);class nE extends Bn{constructor(b,h,r,A,M,aa,oa,Ja,fb){super(b,h,r,M,aa,Ja,fb);this.rB=A;this.IK=oa}get Gl(){return this.IK.value}get wke(){return this.rB.wke()}get Sqj(){const b=this.rB;return b.Aqf&&!b.mSi()}yki(b,h){v.ULS.shipAssertTag(6305616,307,
gm.OutlineReader.oy(b));const r=ZA.a(b.currentNode);if(gm.OutlineReader.isEmpty(b)){var A=wc.a.create(b.currentNode);b.jt(8);y.AFrameworkApplication.va.Nf(A,ub.a.JJ,2,!0,null,null)}else b.jt(8);(A=b.yL(1))&&b.rc();this.rB.Aqj(this.Ri.ne,b.currentNode,A,-1,r,h)}wki(b){const h=new vd.a;this.xcb.restore(h);v.ULS.shipAssertTag(6305618,307,Db.OutlineElementReader.Nh(h));this.Ri.VU&&this.Ri.VU.Occ("internal");let r=-1;if(Object(Xa.a)(89,this.Ri.rd))r=this.Ri.rd.ka(fd.a.rka,-1);else{const A=this.rmm(h.currentNode);
r=A?A.clientWidth:r}this.rB.Aqj(this.Ri.ne,h.parentNode,h.currentNode,r,null,b);this.MYi&&(this.xcb.restore(h),Db.OutlineElementReader.Nh(h)&&this.rB.k1i(h)&&(b=Bb.OutlineElementNavigator.Me(h)))&&(this.Ri.IJa=sc.SelectionFactory.ue(b,0))}rmm(b){return b?(b=b?b.Be(this.Gl.pc):null)?b.htmlElement:null:null}KRj(){const b=new vd.a;this.xcb.restore(b);return this.rB.k1i(b)}get cRj(){return!0}get pod(){return!this.rB.oAa&&!this.rB.Aqf}}Object(u.a)(nE,"InternalPasteExecutionManager",Bn,[]);class mG{constructor(b,
h,r,A,M){this.Phc=M;this.rB=b;this.dda=h;this.IK=r;this.N9=A}create(b,h,r){return new nE(b,h,r,this.rB,this.dda,qa.StaticActiveAppFrame.za().kb,this.IK,this.N9,this.Phc)}}Object(u.a)(mG,"Factory",null,[681]);var Uy;(function(b){b[b.unknown=0]="unknown";b[b.PUp=1]="differentBox4App";b[b.Ufq=2]="sameBox4AppDifferentSession";b[b.Vfq=3]="sameBox4AppSameSession"})(Uy||(Uy={}));Object(u.b)("CopySource",Uy);class Zx{constructor(b,h,r,A){this.rB=b;this.Rlh=h;this.Xsk=r;this.xl=A}n7n(b,h,r){v.ULS.shipAssertTag(6305620,
307,!!b);v.ULS.shipAssertTag(6305621,307,ze.a.pf(h));v.ULS.shipAssertTag(6305622,307,!!r);v.ULS.shipAssertTag(6305623,307,Object(Xa.a)(Bt,r.pua));const A=r.pua;A.efc=this.rB.Oui(b);this.$An(b,A);let M=!1;this.xl.Nla(h,Ja=>M=Ja)&&(A.px|=8192,A.ABe=1,M||(A.ABe|=2));const aa=this.yin(A);var oa=new Rb.GraphTransaction(7,ub.a.paste);oa.Bb(h.node);h.node.sL().YG.S$(8);aa?(v.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",A.px,A.browserName),b=this.Rlh.create(h,A,oa)):(v.ULS.sendTraceTag(40706501,
307,50,"External paste operation starts. {0}; {1}; {2}",A.px,A.efc,A.browserName),Zx.RAn(b),b=this.Xsk.create(b,h,A,oa));r=new Fv.a(r,Object(E.a)(b,b.Fqj,"pasteSetup"),null);r.qm("Paste");r.run()}yin(b){return!this.Fln(b)&&3===b.efc}Fln(b){return 1===(b.px&8192?1:0)}tSi(b,h){v.ULS.shipAssertTag(6305624,307,ze.a.pf(b));v.ULS.shipAssertTag(6305625,307,!!h);v.ULS.shipAssertTag(6305626,307,Object(Xa.a)(Bt,h.pua));const r=new Rb.GraphTransaction(7,ub.a.Abe);r.Bb(b.node);b=this.Rlh.create(b,h.pua,r);h=
new Fv.a(h,Object(E.a)(b,b.Fqj,"pasteSetup"),null);h.qm("InternalPasteAtIp");h.run()}$An(b,h){if(b){let r=!1,A=!1;b.innerHTML&&0<=b.innerHTML.indexOf("mso-tab-count")?A=!0:b.innerText&&0<=b.innerText.indexOf("\t")&&(r=!0);(r||A)&&v.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",Uy[h.efc],r,A)}}static RAn(b){b&&Zx.vQk.test(b.innerText)&&v.ULS.sendTraceTag(6350173,307,50,"External paste operation starts on WebUrl")}}
Zx.vQk=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");Object(u.a)(Zx,"PasteCoordinator",null,[]);var fJ=d(791),gx=d(1060),Wt=d(1059);class nw{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc=null){this.uua=b;this.Qba=h;this.iq=r;this.ntj=A;this.ua=M;this.rcb=aa;this.J=oa;this.r7n=Ja;this.zga=fb;this.L9a=Cb;this.Cza=Gb;this.mb=Sb;this.Tla=pc;this.kbi=100;this.Noc=!1;this.JNe=null;this.yWe=!1;this.vId=null;this.HEd=this.rRa=!1;this.i9l=
(zc,Yc)=>{this.dismissFloatie(Yc.B5l)};this.V3o=(zc,Yc)=>{this.vDl(zc,Yc)};this.FN=(zc,Yc)=>{Yc.property===He.a.lastModifiedTime?(v.ULS.sendTraceTag(520734533,307,50,"Last Modified Time was used "),this.L9a.duf.contains(ub.a.yLg)||this.rog(Yc)):v.ULS.sendTraceTag(520734532,307,50,"Last Modified Time was NOT used but theoretically would be if we remove Last Modified was removed.")};this.CYa=(zc,Yc)=>{this.rog(Yc)};this.xma=(zc,Yc)=>{Yc.Oce||this.rog(Yc)};this.zkj=()=>{fJ.a.instance.keyCode===cf.a.MEa&&
this.Qba.hwj()};this.X9o()}X9o(){this.Qba.JOh(this.V3o);this.Qba.qOh(this.i9l)}vDl(b,h){var r,A,M;(null===(A=null===(r=this.mb.gb)||void 0===r?void 0:r.currentSelection)||void 0===A?0:A.w8c)?v.ULS.sendTraceTag(512313220,307,50,"Box4 Paste floatie not created because Loop component was pasted."):(this.rcb.vVf(),1===this.r7n.MDl(h.ggd)?v.ULS.sendTraceTag(575255107,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",h.correlationId):this.showFloatie(b,h)?(this.rRa?this.rRa=!1:this.wto(),this.ijd(),
b="Box4 Paste floatie created."+String.format(" PasteCommand: {0}, CorrelationId: {1}",ub.a.aX(h.w0)||"Unknown",h.correlationId),v.ULS.sendTraceTag(40379588,307,50,b),ac.a("Box4PasteFloatieCreated",!0,void 0,[Object.assign(new ia.a,{name:"PasteCommand",int64:ub.a.aX(h.w0)||"Unknown"}),Object.assign(new ia.a,{name:"CorrelationId",string:null===(M=h.correlationId)||void 0===M?void 0:M.toString()})]),this.W1b()):v.ULS.sendTraceTag(575255108,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",
h.correlationId))}dismissFloatie(b){var h;!this.yWe&&(this.rRa||(this.Tla?null===(h=this.Cza)||void 0===h?0:h.f3:this.uua.f3()))&&(b&&(this.rcb.vVf(),this.K3j(),v.ULS.sendTraceTag(50685514,307,50,"Last paste command before dimiss or hiding the floatie. Command: {0}",this.vId)),this.rRa=!b,this.DDe(),this.Tla?y.AFrameworkApplication.va.Ob(ub.a.eRb,2):this.uua.dismissFloatie())}wto(){this.HEd||(this.JNe=this.iq.Ad,mf.a.addHandler(this.JNe.container,"scroll",Object(E.a)(this,this.PZb,"scrollHandler")),
this.ua.b2(Object(E.a)(this,this.bna,"resizeHandler")),this.HEd=!0)}K3j(){this.HEd&&(mf.a.removeHandler(this.JNe.container,"scroll",Object(E.a)(this,this.PZb,"scrollHandler")),this.ua.Qga(Object(E.a)(this,this.bna,"resizeHandler")),this.HEd=!1)}W1b(){if(this.Tla)this.Cza.f3&&y.AFrameworkApplication.va.Ob(ub.a.eRb,2),y.AFrameworkApplication.va.Ob(ub.a.Ood,2),this.Noc=!1;else{const b=new Wt.a(0,y.AFrameworkApplication.isRtl);b.location=this.rcb.FVa();this.rcb.sgn(b.location)?this.showFloatie(null,b):
this.Qba.cNa(new gx.a(!1))}}bna(){this.Tla?(y.AFrameworkApplication.va.Ob(ub.a.eRb,2),this.JXc()):this.W1b()}PZb(){this.Tla?(y.AFrameworkApplication.va.Ob(ub.a.eRb,2),this.JXc()):this.W1b()}ijd(){this.ntj.QZk(this.zkj);this.Qba.wOh(Object(E.a)(this.uua,this.uua.i1d,"expandFloatie"));this.Qba.FOh(Object(E.a)(this,this.Iqj,"pastedFloatieStatusChange"));this.zga.wt(this.xma);this.zga.Yx(this.CYa);this.zga.jo(this.FN)}DDe(){this.ntj.Qxo(this.zkj);this.Qba.hCj(Object(E.a)(this.uua,this.uua.i1d,"expandFloatie"));
this.Qba.pCj(Object(E.a)(this,this.Iqj,"pastedFloatieStatusChange"));this.zga.hS(this.xma);this.zga.Rua(this.CYa);this.zga.JP(this.FN)}Iqj(b,h){this.yWe=h.v8c;h.w0&&(this.vId=h.w0);h.IBg&&this.uua.f3()&&this.W1b()}rog(b){b.node.oP||this.Qba.cNa(new gx.a(!0))}showFloatie(b,h){h||(h=new Wt.a(0,y.AFrameworkApplication.isRtl));h.location||(h.location=this.rcb.FVa());if(!h.location)return!1;this.rRa&&(this.rRa=!1,this.ijd());this.Tla?y.AFrameworkApplication.va.Ob(ub.a.Ood,2):this.uua.showFloatie(b,h);
return!0}JXc(){if(!this.Noc){const b=new xc.a(3,1,this.kbi,()=>{this.W1b()},215);Je.a.instance.Zb(b);this.Noc=!0}}}Object(u.a)(nw,"PasteFloatieEventManager",null,[]);class AC{constructor(b,h){this.Qk=b;this.rK=h}MDl(b){return vm.any(vm.where(vm.asEnumerable(AC.Zbp),h=>this.rK.W9c(h)))?(b=this.Qk.cwb(b))&&(b=b.innerText)&&0<b.trim().length?0:1:1}}AC.Zbp=[ub.a.uZa.toString(),ub.a.vZa.toString(),ub.a.oDa.toString()];Object(u.a)(AC,"PasteFloatieFeatureSetBuilder",null,[]);class nG{constructor(){this.aDa=
null;this.btc=0}}Object(u.a)(nG,"PasteFloatieAnchorData",null,[]);class Jv{constructor(b,h,r,A,M,aa=!1){this.xGb=null;this.hb=b;this.rya=h;this.kd=r;this.Iuk=A;this.N2e=M;this.YWe=aa}vVf(){this.xGb=null}FVa(){const b=this.MIf(this.xGb)||this.iYh();if(!b){let h="null",r="null";if(this.xGb&&this.xGb.aDa){if(!this.kd.Ad)return v.ULS.sendTraceTag(51143187,307,15,"SelectoinView is null when we try to get floatie position"),null;h=Object.getType(this.xGb.aDa).getName();const A=this.kd.Ad.sl(this.xGb.aDa);
A&&(r=Object.getType(A).getName())}v.ULS.shipAssertTag(40641054,307,!1,"Failed to calculate position for pasted node type {0}, view element type {1}",h,r)}return b}sgn(b){if(!b)return!1;const h=this.N2e.pPb(),r=this.Iuk(this.kd.Ad.container);b=new Sys.UI.Bounds(b.x,b.y,h.width,h.height);return b.y>=r.y&&b.y+b.height<=r.y+r.height}iYh(){if(!this.hb||!this.hb.gb||!this.hb.gb.currentSelection)return v.ULS.sendTraceTag(51431265,307,15,"Selection is null when we try to calculate floatie position"),null;
var b=this.hb.gb.currentSelection.Qa,h=!b.cpBegin&&!b.cpEnd;let r=b.node;if(r&&h){do r=this.sDi(r);while(r&&Object(Xa.a)(Gn.AParagraphNode,r)&&!r.characterData.trim().length)}let A="";const M=Object(ya.a)(Gn.AParagraphNode,r);M&&(A=M.characterData.length===b.cpBegin||h?M.characterData.trimEnd():M.characterData.substring(0,b.cpBegin).trimEnd());h=M?A.length:b.cpBegin;b=Object.assign(new nG,{aDa:Object(ya.a)(112,(M?Object(ya.a)(112,M):Object(ya.a)(112,r))||b.node),btc:h});return this.MIf(b)}sDi(b){const h=
new vd.a;if(!b.anchor)return null;h.set(b);if(!h.Kd())return null;h.ld(11);return h.RJ()?h.Ub(2):null}MIf(b){if(!b||!b.aDa)return null;this.xGb=b;const h=this.kd.Ad;if(!h)return v.ULS.sendTraceTag(51143188,307,15,"SelectoinView is null when we try to get floatie position"),null;b=this.fyi(b,h);if(!b)return null;y.AFrameworkApplication.isRtl&&this.N2e.f3()&&(b.x-=this.N2e.pPb().width);return new Sys.UI.Point(b.x+b.width,b.y+b.height)}fyi(b,h){h=h.Be(b.aDa);if(!h)return null;let r=null;if(Object(Xa.a)(Gn.AParagraphNode,
b.aDa)){const A=Object(ya.a)(105,h);if(!A)return null;try{r=this.rya.h2(b.btc,A,0<b.btc,!1,!1,!1),r.height+=this.YWe?Jv.Cko:Jv.l9l}catch(M){v.ULS.sendTraceTag(40953486,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",M),r=null}}else Object(Xa.a)(ft.TableNode,b.aDa)&&(r=Object(ya.a)(171,h).xNf());r||(r=h.getBounds());return r}}Jv.l9l=2;Jv.Cko=60;Object(u.a)(Jv,"PasteFloatiePositionProvider",null,[]);class gJ{constructor(b,h,r,A,M){this.xAa=b;this.Otb=h;this.D7n=r;this.C7n=
A;this.ySb=M}}Object(u.a)(gJ,"PastedContentsPostProcessorParams",null,[]);class BC{Y4m(b,h,r,A,M,aa){b=this.lqm(b,h,M);r=this.dvm(r);if(!b||!r)return null;A=this.JCm(b,A,M);M=this.ICm(r);return new gJ(b,r,A,M,aa)}lqm(b,h,r){b=r?b:h;if(!Db.OutlineElementReader.Nh(b))return null;h=new xm.a;h.hd(b);return h}dvm(b){if(!Db.OutlineElementReader.Nh(b))return null;const h=new xm.a;h.hd(b);Bb.OutlineElementNavigator.z3(h,!1,!1);return h}JCm(b,h,r){Bb.OutlineElementNavigator.Me(b);let A=-1;Gd.ParagraphReader.Bh(b)&&
(A=r?h:0);Bb.OutlineElementNavigator.je(b);return A}ICm(b){Bb.OutlineElementNavigator.Me(b);const h=Gd.ParagraphReader.Bh(b)?Gd.ParagraphReader.textLength(b.currentNode):-1;Bb.OutlineElementNavigator.je(b);return h}}Object(u.a)(BC,"PastedContentsPostProcessorHelper",null,[]);class Bs{constructor(b,h){this.xFc=b;this.wok=h}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get Ipi(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get Auf(){return CommonUIStrings.l_ClipboardCut}get M6f(){return CommonUIStrings.l_ClipboardCut_Mac}get rrf(){return CommonUIStrings.l_ClipboardCopy}get L6f(){return CommonUIStrings.l_ClipboardCopy_Mac}get atc(){return CommonUIStrings.l_ClipboardPaste}get N6f(){return CommonUIStrings.l_ClipboardPaste_Mac}get O3(){return CommonUIStrings.l_ClipboardPasteText}get O6f(){return CommonUIStrings.l_ClipboardPasteText_Mac}get pof(){return this.wok}get Y1h(){return CommonUIStrings.l_ClipboardExtensionLink}get enb(){return CommonUIStrings.l_ClipboardExtensionSuggestion}Ski(){v.ULS.sendTraceTag(8716421,
307,50,null);Le.a.un(this.pof,"_blank",void 0,"ClipboardAccessExtensionLink")}Tga(b,h){let r=Y.a.Qm;y.AFrameworkApplication.J.$("CcpFixIPadShortcutStringsIsEnabled")&&(r=Y.a.Ci||r);return r?String.format(h,"\u2318"):b}dispose(){this.xFc=null}Pog(b){this.d7h(b)}Cvn(b){this.d7h(b)}d7h(b){this.xFc&&this.xFc(b)}}Bs.id="CopyPasteShortcutDialog";Bs.vZj="CopyPasteText";Object(u.a)(Bs,"ACopyPasteShortcutDialog",null,[10]);class hJ extends Bs{constructor(b,h,r){super(b,h);b=document.createElement("span");
b.className="WACCopyPasteShortcutDialogTextPanel";h=document.createElement("span");h.id=Bs.vZj;var A=document.createElement("span");A.innerText=this.Ipi;var M=document.createElement("span");M.className="UIFontBold";M.innerText=this.Tga(this.Auf,this.M6f);const aa=document.createElement("span");aa.className="UIFontBold";aa.innerText=this.Tga(this.rrf,this.L6f);const oa=document.createElement("span");oa.className="UIFontBold";oa.innerText=this.Tga(this.atc,this.N6f);h.appendChild(A);h.appendChild(document.createElement("br"));
h.appendChild(M);h.appendChild(aa);h.appendChild(oa);r.$("PasteTextOnlyShortcutDialogIsEnabled")&&(Y.a.Pr||Y.a.uj)&&(r=document.createElement("span"),r.className="UIFontBold",r.innerText=this.Tga(this.O3,this.O6f),h.appendChild(r));b.appendChild(h);this.pof?(v.ULS.sendTraceTag(8716420,307,50,null),r=document.createElement("span"),h=document.createElement("a"),h.href="#",h.innerText=this.Y1h,mf.a.addHandler(h,"click",Object(E.a)(this,this.Ski,"extensionLinkHandler")),r.appendChild(h),M=this.enb.indexOf("{0}"),
-1!==M&&(A=this.enb.substring(0,M),M=this.enb.substring(M+3,this.enb.length),A=document.createTextNode(A),M=document.createTextNode(M),r.insertBefore(A,h),r.appendChild(M)),b.appendChild(document.createElement("br")),b.appendChild(r)):v.ULS.sendTraceTag(8716422,307,50,null);r=new ni.StandardDialog;r.Fd=0;r.Ng=Bs.id;r.Ex(this.titleText,null,0,Object(E.a)(this,this.Cvn,"legacyCopyPasteShortcutDialogHandler"),b);r.t8(Bs.vZj)}}Object(u.a)(hJ,"CopyPasteShortcutDialog",Bs,[]);class $x extends Bs{constructor(b,
h){super(b,h);h={};b=this.g9m;h.extensionStartText=this.n2l;h.extensionLink=null;h.extensionEndText=null;h.shortcutsMessageText=this.iZo;h.cutText=this.Tga(this.Auf,this.M6f);h.copyText=this.Tga(this.rrf,this.L6f);h.pasteText=this.Tga(this.atc,this.N6f);4!==y.AFrameworkApplication.ua.Ib.Uk&&(h.pasteTextOnly=this.Tga(this.O3,this.O6f));h={["id"]:"CopyPasteInstallDialog",["bodyControls"]:h};const r=new ig.a(!1,!1,!0);r.Ng="CopyPasteInstallDialog";r.Fd=0;r.Qe(1,this.f9m);r.gY(1);r.mi(b,Object(E.a)(this,
this.Pog,"reactCopyPasteShortcutDialogHandler"),h)}get iZo(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get f9m(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get g9m(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get n2l(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}static C2o(){var b=window.location.origin;return b?RegExp("^https:\\/\\/((.*?(word-edit|powerpoint|onenote|excel|visio)\\.(officeapps\\.live\\.com|partner\\.officewebapps\\.cn|gov\\.online\\.office365\\.us|dod\\.online\\.office365\\.us))|(project\\.microsoft\\.com))$",
"g").test(b):!1}}Object(u.a)($x,"ReactCopyPasteInstallDialog",Bs,[]);class CC extends Bs{constructor(b){super(b,null);this.Z4i="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";var h={};b=this.INn;var r="";let A="";this.messageText&&(r=this.messageText.split(" {")[0],A=this.messageText.split("} ")[1]);h.startText=r;h.endText=A;h.cutText=this.HKl;h.copyText=this.Uzl;h.pasteText=this.t7n;
h.cutShortcutText=this.Tga(this.IKl,this.AEn);h.copyShortcutText=this.Tga(this.dAl,this.zEn);h.pasteShortcutText=this.Tga(this.w7n,this.CEn);h.imageSrc=se.a.yea("NoClipboardAccessDialogImage.svg");h.imageAltText=this.imageAltText;h.primaryButtonLabel=this.Ico;this.Z4i&&(v.ULS.sendTraceTag(527986756,307,50,"Learn more link is available"),h.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.Wtb,["onExecute"]:()=>{this.svn()}});h={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:h};
r=new ig.a(!1,!1,!0);r.Fd=0;r.Ng="CopyPasteNoClipboardAccessDialog";r.mi(b,Object(E.a)(this,this.Pog,"reactCopyPasteShortcutDialogHandler"),h)}get INn(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get Wtb(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get imageAltText(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get Ico(){return CommonUIStrings.l_DialogOk}get HKl(){return CommonUIStrings.l_CutString}get IKl(){return CommonUIStrings.l_CutShortcut}get AEn(){return CommonUIStrings.l_CutShortcut_Mac}get Uzl(){return CommonUIStrings.l_CopyString}get dAl(){return CommonUIStrings.l_CopyShortcut}get zEn(){return CommonUIStrings.l_CopyShortcut_Mac}get t7n(){return CommonUIStrings.l_PasteString}get w7n(){return CommonUIStrings.l_PasteShortcut}get CEn(){return CommonUIStrings.l_PasteShortcut_Mac}svn(){v.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");Le.a.un(this.Z4i,"_blank",void 0,"learnMoreLink")}}Object(u.a)(CC,"ReactCopyPasteNoClipboardAccessDialog",Bs,[]);class $A extends Bs{constructor(b,h,r){super(b,h);b={};b.forwardElementText=this.Ipi;b.cutText=this.Tga(this.Auf,this.M6f);b.copyText=this.Tga(this.rrf,this.L6f);b.pasteText=this.Tga(this.atc,this.N6f);r.$("PasteTextOnlyShortcutDialogIsEnabled")&&(Y.a.Pr||Y.a.uj)&&(b.pasteTextOnly=this.Tga(this.O3,this.O6f));this.pof?(v.ULS.sendTraceTag(40726914,307,
50,null),b.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.Y1h,["onExecute"]:A=>{this.Ski(A)}},r=this.enb.indexOf("{0}"),-1!==r&&(b.suggestionPrefixElement=this.enb.substring(0,r),b.suggestionSuffixElement=this.enb.substring(r+3,this.enb.length))):v.ULS.sendTraceTag(40726915,307,50,null);r={["id"]:Bs.id,["bodyControls"]:b};b=new ig.a(!1,!1,!0);b.Fd=0;b.Ng=Bs.id;b.mi(this.titleText,Object(E.a)(this,this.Pog,"reactCopyPasteShortcutDialogHandler"),r)}}Object(u.a)($A,"ReactCopyPasteShortcutDialog",
Bs,[]);class bv{constructor(){this.sRa=!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.cH}Wrf(b,h,r=!1){v.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.sRa,r));this.sRa?r?new $x(b,h):new $A(b,h,y.AFrameworkApplication.J):new hJ(b,h,y.AFrameworkApplication.J)}static get instance(){return bv._instance||(bv._instance=new bv)}}bv._instance=null;Object(u.a)(bv,"CopyPasteShortcutDialogFactory",null,[35]);class aB{constructor(b,h,r,A,M,
aa,oa,Ja){this.ADh=this.Mnh=this.V8e=!1;this.aNk=b;this.kd=h;this.Ky=r;this.Yb=A;this.Je=M;this.ug=aa;this.ef=oa;Ja&&(this.ADh=Ja.$("ShouldLogExecCommandCopySuccess"))}get P_a(){return this.aNk}get bab(){return this.Mnh}set bab(b){this.Mnh=b;this.ug.RSf=b}RZc(b){this.P_a.RZc(b);b||this.Aqd(!0)}get j_l(){return this.P_a.hug}yXb(b){this.bab=!0;this.P_a.yXb(b,this.wGg)}reset(){this.bab=!1}paste(){var b=null;let h=null;if(!this.P_a.Q2b){(b=this.kd.Ad)&&this.Yb.Jg(b.nL);var r=this.Ky.Bw;if(!r.te||!r.Le.qk)return null;
h=r.Le;b=this.Je.xx();this.bab=!0;r.Dfb()}r=null;try{h&&h.xbo(),r=b=this.P_a.h_c(this.wGg,b)}catch(A){v.ULS.shipAssertTag(6305672,307,!1),this.vKi()}this.bab=!1;return r}cE(){var b=this.kd.Ad;b&&this.Yb.Jg(b.nL);b=this.Ky.Bw;if(!b.te||1!==b.Le.mode)return!1;this.bab=!0;let h;try{const r=new Map;r.set("View","ContentEditableView");Ba.Health.instance.recordKpiUsage(ko.a.gUd,0,ko.a.a_h,r);const A=this.P_a.RAf(this.wGg);h=!0;this.ADh&&v.ULS.sendTraceTag(558384097,307,50,"execCommandCopySuccess, {0}, browser: {1}",
A,this.ef.XD);if(!A){const M=Object.assign(new bb.a,{extendedProperties:r});Ba.Health.instance.recordKpiFailure(ko.a.gUd,ko.a.ZZh,!0,!0,M)}}catch(r){v.ULS.shipAssertTag(6305673,307,Y.a.uj),v.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",Y.a.XD),h=!1}this.bab=!1;return h?!0:!1}Aqd(){if(this.V8e)return!0;var b=this.Ky.Bw;if(!b.te||!b.Le.qk)return!1;const h=b.Le;b=this.Je.xx();this.bab=!0;const r=new NA.a(b);let A=!1;try{A=this.P_a.Aqd(b,()=>{h.dVd()},
()=>{h.FNa()})}catch(M){}r.restore();this.bab=!1;A?this.V8e=!0:(v.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",Y.a.XD),this.vKi());return A}vKi(){this.V8e=!1;if(y.AFrameworkApplication.hCp)bv.instance.Wrf(null,null);else{const b=new ni.StandardDialog;b.Fd=0;b.jY(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,null)}}get wGg(){const b=this.Je.tqb();return b?b.Bo:null}}Object(u.a)(aB,"SystemClipboard",null,
[680]);class cv{constructor(b,h,r){this.TOd=!1;this.rPd=this.gW=this.Lqh=this.aMe=this.gxd=null;this.R$n=A=>{1===A?(v.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this.QLe)),this.jbc&&(v.ULS.sendTraceTag(594882642,307,50,String.format("_useInstallDialog={0}",this.jbc)),Le.a.un(this.JSe+this.S0e,"_blank",void 0,"ChromeCCPInstallDialog"))):A||v.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",this.QLe))};this.QLe=b.$("ChromeClipboardAccessExtensionSuggestionIsEnabled");
this.JSe=b.ib("ChromeClipboardAccessExtensionLink");this.Thb=h;this.Qk=r;this.S0e=b.ib("ChromeClipboardAccessExtensionId");this.GPk=b.$("UseGetClipboardDataIsEnabled");this.Vzh=b.$("RecordExtensionInstallStatusKpiIsEnabled");this.jbc=!1;b.$("CcpInstallDialogIsEnabled")&&y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.cH&&(this.jbc=$x.C2o()||b.$("IgnoreDomainCheckCcpInstallDialog"),v.ULS.sendTraceTag(587314304,307,50,"_useInstallDialog: {0}",this.jbc));this.uGc=null}RZc(b){b?this.gW=!0:(this.gW=
null,chrome.runtime&&chrome.runtime.sendMessage?(this.uGc=this.Thb.AYd,this.Thb.W_b?(this.TOd=this.GPk,this.$_h()):(this.TOd=!0,this.$_h(),v.ULS.sendTraceTag(19256732,307,50,N.a.create().toString()))):(this.o0b(),this.gW=!1))}get hug(){return this.gW}get Q2b(){return this.rPd}Aqd(){return!0}RAf(b){v.ULS.sendTraceTag(24402115,307,50,"Execute chrome copy");(b=Le.a.TNb(b,"copy"))||v.ULS.sendTraceTag(24402116,307,10,String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,
2)));return b}HGf(b){if(!b)return null;var h=b.img;const r=b.text;b=b.html;const A=this.Qk.UIj(!!h,!!r,b);let M=null;if(3===A){if(!b)return null;h=this.Qk.bli(b);(h=this.Qk.ili(h))&&(b+=h);M=this.Qk.cwb(b)}else 2===A?M=this.Qk.Fig(r,!0):1===A&&(M=this.Qk.cwb(h));return M}h_c(b,h){if(this.Q2b)h=this.HGf(this.aMe),this.aMe=null;else{if(!this.gxd)return h;b=document.implementation.createHTMLDocument("doc");b.body.innerHTML=this.gxd;h=b.body;this.gxd=null}return h}yXb(b){const h=N.a.create();this.Lqh=
h;this.Thb.W_b?v.ULS.sendTraceTag(7377737,307,50,h.toString()):v.ULS.sendTraceTag(19256735,307,50,h.toString());const r={};r.command=this.Q2b?"getClipboardData":"paste";chrome.runtime.sendMessage(this.uGc,r,A=>{h.equals(this.Lqh)?this.Q2b?this.aMe=A:this.gxd=A:v.ULS.sendTraceTag(7385868,307,50,null);v.ULS.sendTraceTag(7377738,307,50,h.toString());chrome.runtime.lastError&&(this.eWl(),this.Thb.W_b?v.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):v.ULS.sendTraceTag(19256737,307,10,
chrome.runtime.lastError.message));b()})}o0b(){v.ULS.sendTraceTag(8716423,307,50,null);let b=null;this.jbc?b=this.JSe+this.S0e:this.QLe&&(b=this.JSe+this.uGc);bv.instance.Wrf(this.R$n,b,this.jbc)}eWl(){this.Thb.zCo();this.o0b()}hKj(b,h){chrome.runtime.sendMessage(b,{command:"test",object:"ping"},h)}Tll(){const b=N.a.create();this.Thb.W_b?v.ULS.sendTraceTag(592491466,307,50,b.toString()):v.ULS.sendTraceTag(591984031,307,50,b.toString());chrome.runtime.sendMessage(this.uGc,{command:"getAvailableCommands"},
h=>{v.ULS.sendTraceTag(592491467,307,50,b.toString());h?Object(Xa.a)(Array,h)?(v.ULS.sendTraceTag(592491470,307,50,"Extension responded: {0}",h),this.rPd=-1!==Array.indexOf(h,"getClipboardData")):(v.ULS.sendTraceTag(592491469,307,15,"ChromeApi has non-string[] response. o: {0}",h),this.rPd=!1):(v.ULS.sendTraceTag(592491468,307,15,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.rPd=!1)})}$_h(){const b=N.a.create();this.Thb.W_b?v.ULS.sendTraceTag(7726105,
307,50,b.toString()):v.ULS.sendTraceTag(591984032,307,50,b.toString());this.TOd&&this.Tll();this.hKj(this.uGc,h=>{v.ULS.sendTraceTag(7726106,307,50,b.toString());h&&"ping"===h?this.gW=!0:(h?"ping"!==h&&v.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",h,chrome.runtime.lastError?chrome.runtime.lastError.message:null):v.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),
this.o0b(),this.gW=!1);this.TOd&&!this.Q2b&&v.ULS.sendTraceTag(592491471,307,50,"No response for CheckGetClipboardDataExistenceAsync")})}d9i(b,h){const r={};r.OfficeOnlineExtensionInstallationStatus=b;r.OfficeClipboardExtensionInstallationStatus=h;v.ULS.sendTraceTag(51144839,307,50,JSON.stringify(r));this.Vzh&&(b&&Ba.Health.instance.recordKpiSuccess(cv.kvh,null),h&&Ba.Health.instance.recordKpiSuccess(cv.hvh,null))}cAn(){this.Vzh&&(Ba.Health.instance.recordKpiUsage(cv.kvh,1,cv.Lfh,null),Ba.Health.instance.recordKpiUsage(cv.hvh,
1,cv.Lfh,null));if(chrome.runtime&&chrome.runtime.sendMessage){var b=!this.Thb.W_b;this.hKj(this.S0e,h=>{this.d9i(b,!!h)})}else this.d9i(!1,!1)}}cv.kvh="OfficeOnlineExtensionInstallationStatus";cv.hvh="OfficeClipboardExtensionInstallationStatus";cv.Lfh="wwccp";Object(u.a)(cv,"ChromeSystemClipboardAccessManager",null,[711]);class mo{constructor(b,h){this.gW=null;this.ef=b;this.Ga=h;this.Umk=!this.Ga.$("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&this.Ga.$("BlockCopyCutOnFirefoxIsEnabled");this.yKk=
h.$("SetResultForEnsureAccessOperationForElectronIsEnabled")}RZc(b){this.Umk&&b&&this.ef.uj?(this.o0b(),this.gW=!1):this.gW=!0}get hug(){return this.gW}get Q2b(){return!1}RAf(b){return Le.a.TNb(b,"copy")}h_c(b,h){Le.a.TNb(b,"paste");return h}yXb(b){b()}Aqd(b,h,r){if(this.ef.r7)return this.yKk&&(this.gW=!1),!1;h();r();b=this.h_c(b.ownerDocument,b);h=b.innerHTML;b.innerHTML=kb.a.create().toString();r();b=this.h_c(b.ownerDocument,b);return this.gW=b=h===b.innerHTML}o0b(){bv.instance.Wrf(null,null)}}
Object(u.a)(mo,"DefaultSystemClipboardAccessManager",null,[711]);class bB{constructor(b,h,r){this.gW=this.rda=this.w9b=this.Hpa=this.K3a=this.cxd=null;this.Qk=h;this.U3a=r;this.oCk=b.ic("ClipboardDataImageBlobLimitaton",10);b.$("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.eLk=b.$("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}RZc(b){this.eLk&&b&&(this.gW=!0)}get hug(){return this.gW}get Q2b(){return!1}RAf(b){return b?Le.a.TNb(b,Jd.a.cE):!1}h_c(b,h){this.K3a&&(h=this.K3a,this.K3a=
null);return h}yXb(b,h=null){if(b&&h){this.cxd=b;this.w9b=h;$addHandler(this.w9b,Jd.a.paste,Object(E.a)(this,this.Vkj,"onPasteEvent"));this.rda=this.Hpa=null;if(this.C2j(this.w9b)){if(this.rda&&0<this.rda.length&&(!this.Hpa||this.Qk.HEe(this.Hpa))){this.U3a.u6h(this.rda,Object(E.a)(this,this.ZVn,"onImageConverted"));this.K3a&&!this.K3a.hasChildNodes()&&v.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes.");return}this.Hpa&&this.Hpa.innerHTML&&((this.K3a=this.bOi(this.Hpa.innerHTML))&&
!this.K3a.hasChildNodes()&&v.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),Fd.a.lF(this.Hpa))}this.tni()}else b&&b()}Aqd(b){return this.gW=b=this.C2j(b.ownerDocument)}Vkj(b){try{b&&b.rawEvent&&((this.Hpa=b.rawEvent.target)&&this.Hpa.id&&-1<this.Hpa.id.indexOf("Paste")?(v.ULS.sendTraceTag(40690080,307,15,"The pasted target element of paste event: "+this.Hpa.id),this.Hpa=null):this.rda=this.ctm(b.rawEvent))}catch(h){v.ULS.sendTraceTag(22073952,307,15,"Exception while processing context menu paste event: "+
h.toString())}}ZVn(b){b&&(this.U3a.jRj&&(b=String.format('<img src="{0}">',b)),this.K3a=this.bOi(b));this.tni()}tni(){this.w9b&&($removeHandler(this.w9b,Jd.a.paste,Object(E.a)(this,this.Vkj,"onPasteEvent")),this.w9b=null);this.cxd&&(this.cxd(),this.cxd=null)}ctm(b){let h=null;(b=this.Qk.Hti(b))&&({VSf:h}=this.Qk.e2j(b,this.oCk,this.U3a.mbj));return h}C2j(b){return Le.a.TNb(b,Jd.a.paste)}bOi(b){const h=document.implementation.createHTMLDocument("doc");h.body.innerHTML=b;return h.body}o0b(){}}Object(u.a)(bB,
"EdgeSystemClipboardAccessManager",null,[711]);class zh{constructor(b,h,r,A){this.Ga=b;this.kok=h;this.Qk=r;this.ef=A}create(){let b=null;y.AFrameworkApplication.LBg()&&this.ef.Pr&&window.chrome?(v.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),b=new cv(this.Ga,this.kok,this.Qk),this.Ga.$("LogChromeExtensionInstallationStatusIsEnabled")&&b.cAn()):this.Ga.$("EdgeContextMenuPasteFixIsEnabled")&&this.ef.eu?(v.ULS.sendTraceTag(22073953,307,50,"EdgeSystemClipboardAccessManager"),
b=new bB(this.Ga,Za.a.instance.resolve(173),Za.a.instance.resolve(257),Za.a.instance.resolve(885))):(v.ULS.sendTraceTag(7377744,307,50,"DefaultSystemClipboardAccessManager"),b=new mo(this.ef,this.Ga));return b}}Object(u.a)(zh,"SystemClipboardAccessManagerFactory",null,[679]);var wz=d(770),cB;(function(b){b[b.automatic=1]="automatic";b[b.clear=2]="clear";b[b.Leb=3]="themeColors";b[b.kjq=4]="standardColors";b[b.HP=5]="recentColors";b[b.T4p=6]="moreColors";b[b.oWa=7]="highContrastColors"})(cB||(cB={}));
Object(u.b)("ColorMenuControls",cB);var dv=d(1019);class os{constructor(b){this.IKc=null;this.qxd={};this.fSb=()=>{this.IKc=null};this.mO=b;this.T6e=""}get gca(){return this.T6e}set gca(b){b=b||"";this.T6e!==b&&(this.T6e=b,this.fSb())}Opb(b,h){if(this.IKc)return this.IKc;if(!b)return null;const r=Object.assign(new aj.a,{Id:String.format("menu{0}Color",this.mO),ExternalId:String.format("{0}Color",this.mO)});r.MenuSectionList=[];Object(dv.a)()&&r.MenuSectionList.push(this.MUk());r.MenuSectionList.push(this.GSk());
r.MenuSectionList.push(this.gTk());r.MenuSectionList.push(this.KXk(b,h));r.MenuSectionList.push(this.qXk());return this.IKc=r}BG(b,h){cB[b]in this.qxd||(this.qxd[cB[b]]=h)}C5a(b,h){b.ldf(this.fSb,h)}MUk(){if(!({actionId:h}=this.Krd(7)).returnValue)return null;const b=Object.assign(new te.a,{Id:String.format("{0}Color",this.mO),ControlsId:String.format("{0}.Color.Menu.Controls",this.mO),DisplayMode:"Menu16",ControlList:[]});var h=Object.assign(new hk.a,{Command:h.toString(),LabelText:I.a.Jf(Box4Intl.Box4Strings.L_HighContrastColorPicker),
Image16by16:y.AFrameworkApplication.Ss,Image16by16Class:Gg.getImageClass("Automatic_16x16x32"),Id:String.format("HighContrast{0}ColorPicker",this.mO),ExternalId:String.format("HighContrast{0}ColorPicker",this.mO),KeyTip:CommonUIStrings.l_HighContrastColorPickerKeytip,QueryCommand:ub.a.Lhd.toString()});b.ControlList.push(h);return b}GSk(){if(!({actionId:h}=this.Krd(1)).returnValue)return null;const b=Object.assign(new te.a,{Id:String.format("{0}Color",this.mO),ControlsId:String.format("{0}.Color.Menu.Controls",
this.mO),DisplayMode:"Menu16",ControlList:[]});var h=Object.assign(new hk.a,{Command:h.toString(),LabelText:I.a.Jf(Box4Intl.Box4Strings.L_Automatic),Image16by16:y.AFrameworkApplication.Ss,Image16by16Class:Gg.getImageClass("Automatic_16x16x32"),Id:"automatic",KeyTip:CommonUIStrings.l_AutomaticKeytip});b.ControlList.push(h);return b}gTk(){if(!({actionId:h}=this.Krd(2)).returnValue)return null;const b=Object.assign(new te.a,{Id:String.format("{0}Color",this.mO),ControlsId:String.format("{0}.Color.Menu.Controls",
this.mO),DisplayMode:"Menu16",ControlList:[]});var h=Object.assign(new hk.a,{Command:h.toString(),LabelText:I.a.Jf(Box4Intl.Box4Strings.L_BtnClearShading),Image16by16:y.AFrameworkApplication.Ss,Image16by16Class:Gg.getImageClass("NoHighlight_16x16x32"),Id:"clear",KeyTip:CommonUIStrings.l_NoHighlightKeytip});b.ControlList.push(h);return b}KXk(b,h){if(!({actionId:A}=this.Krd(3)).returnValue)return null;const r=Object.assign(new te.a,{Id:"Colors",ControlsId:String.format("{0}.Color.Menu.Controls",this.mO),
ControlList:[]});var A=Object.assign(new wz.a,{Id:String.format("Theme{0}ColorPicker",this.mO),ExternalId:String.format("Theme{0}ColorPicker",this.mO),McuExternalId:String.format("Theme{0}ColorPickerMCU",this.mO),McuLayout:!0,Command:A.toString(),Width:10});const {ysl:M,qgp:aa}=os.JLm(b,h);A.Colors=M;this.UNj(A,aa);r.ControlList.push(A);return r}qXk(){if(!({actionId:h}=this.Krd(4)).returnValue)return null;const b=Object.assign(new te.a,{Id:String.format("{0}Colors",this.mO),ControlsId:String.format("{0}.Color.Menu.Controls",
this.mO),Title:I.a.Jf(Box4Intl.Box4Strings.L_MenuStandardColors),ControlList:[]});var h=Object.assign(new wz.a,{Id:String.format("Standard{0}ColorPicker",this.mO),ExternalId:String.format("Standard{0}ColorPicker",this.mO),Command:h.toString(),Width:10,Colors:[]});h.Colors=os.XIm();this.UNj(h);b.ControlList.push(h);return b}UNj(b,h){if(b){var r="";"object"===typeof this.gca?void 0!==h&&(r=this.uHm(h,this.gca)):r=this.dHm(b.Colors,this.gca);b.Stateful=!0;b.SelectedColorId=""!==r?r:"NoColor"}}uHm(b,
h){var r,A;let M="";for(const aa of b)if(aa.JBe===h.Etc&&aa.Kwc===(null===(r=h.rIa)||void 0===r?void 0:r.Kwc)&&aa.Peb===(null===(A=h.rIa)||void 0===A?void 0:A.Peb)){M=aa.zsl;break}return M}dHm(b,h){let r="";if(!b)return r;for(let A=0;A<b.length;A++)if(b[A].DisplayColor.toLowerCase()===h.toLowerCase()){r=b[A].Color;break}return r}Krd(b){b=cB[b];return b in this.qxd?{returnValue:!0,actionId:this.qxd[b]}:{returnValue:!1,actionId:0}}static XIm(){const b=[];b.push(Object.assign(new Qm,{Color:"0000C0",
Alt:I.a.Jf(Box4Intl.Box4Strings.L_FontColorDarkRed),DisplayColor:"#C00000"}));b.push(Object.assign(new Qm,{Color:"0000FF",Alt:I.a.Jf(Box4Intl.Box4Strings.L_FontColorRed),DisplayColor:"#FF0000"}));b.push(Object.assign(new Qm,{Color:"00C0FF",Alt:I.a.Jf(Box4Intl.Box4Strings.L_FontColorOrange),DisplayColor:"#FFC000"}));b.push(Object.assign(new Qm,{Color:"00FFFF",Alt:I.a.Jf(Box4Intl.Box4Strings.L_FontColorYellow),DisplayColor:"#FFFF00"}));b.push(Object.assign(new Qm,{Color:"50D092",Alt:I.a.Jf(Box4Intl.Box4Strings.L_FontColorLightGreen),
DisplayColor:"#92D050"}));b.push(Object.assign(new Qm,{Color:"50B000",Alt:I.a.Jf(Box4Intl.Box4Strings.L_FontColorDarkGreen),DisplayColor:"#00B050"}));b.push(Object.assign(new Qm,{Color:"F0B000",Alt:I.a.Jf(Box4Intl.Box4Strings.L_FontColorLightBlue),DisplayColor:"#00B0F0"}));b.push(Object.assign(new Qm,{Color:"C07000",Alt:I.a.Jf(Box4Intl.Box4Strings.L_FontColorBlue),DisplayColor:"#0070C0"}));b.push(Object.assign(new Qm,{Color:"602000",Alt:I.a.Jf(Box4Intl.Box4Strings.L_FontColorDarkBlue),DisplayColor:"#002060"}));
b.push(Object.assign(new Qm,{Color:"A03070",Alt:I.a.Jf(Box4Intl.Box4Strings.L_FontColorPurple),DisplayColor:"#7030A0"}));return b}static JLm(b,h){const r=b.properties.ka(Mc.a.Leb,null);b=b.properties.getValue(Mc.a.MBe).split(" ");const A=[],M=[];for(let fb=0;6>fb;fb++)for(let Cb=0;10>Cb;Cb++){var aa=10*fb+Cb,oa=r[aa];oa=oa&4278190080|(oa&255)<<16|oa&65280|(oa&16711680)>>>16;aa=I.a.IJ(aa+1<<24,8);var Ja=h[b[Cb]];const Gb=this.Sqi(fb,Cb,r[Cb]);Gb.zsl=aa;M.push(Gb);Ja=os.wip(Ja,Gb);A.push(Object.assign(new Qm,
{Color:aa,DisplayColor:"#"+I.a.IJ(oa,6),Alt:I.a.Jf(Ja)}))}return{ysl:A,qgp:M}}static wip(b,h){if(void 0===h.Kwc&&void 0===h.Peb)return String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,b,h.wHg);const r=void 0!==h.Peb;return String.format(r?Box4Intl.Box4Strings.l_ColorPickerTooltipTint:Box4Intl.Box4Strings.l_ColorPickerTooltipShade,b,h.wHg,r?h.Peb:h.Kwc)}static Sqi(b,h,r){if(b){var A=r&255,M=(r&65280)>>>8;r=(r&16711680)>>>16;M=Math.floor((Math.min(Math.min(A,M),r)+Math.max(Math.max(A,M),
r))/2);A=b-1;M?255===M?(b=!1,A=[242,217,191,166,128][A]):204<M?(b=!1,A=[230,191,128,64,26][A]):51>M?(b=!0,A=[26,64,128,191,230][A]):(M=[51,102,153],r=[191,128],A=(b=A<M.length)?M[A]:r[A-M.length]):(b=!0,A=[128,166,191,217,242][A]);A=255-A;h={JBe:os.IBe[h].name,wHg:os.IBe[h].label};b?h.Peb=Math.round(100*A/255):h.Kwc=Math.round(100*A/255);return h}return{JBe:os.IBe[h].name,wHg:os.IBe[h].label}}static pmp(b,h){if((h=h.properties.ka(Mc.a.Leb,null))&&0<=b&&b<h.length){const r=b%10;return os.Sqi(Math.floor(b/
10),r,h[r])}}}os.IBe={0:{name:"background1",label:Box4Intl.Box4Strings.l_ThemeLabel1},1:{name:"text1",label:Box4Intl.Box4Strings.l_ThemeLabel2},2:{name:"background2",label:Box4Intl.Box4Strings.l_ThemeLabel3},3:{name:"text2",label:Box4Intl.Box4Strings.l_ThemeLabel4},4:{name:"accent1",label:Box4Intl.Box4Strings.l_ThemeLabel5},5:{name:"accent2",label:Box4Intl.Box4Strings.l_ThemeLabel6},6:{name:"accent3",label:Box4Intl.Box4Strings.l_ThemeLabel7},7:{name:"accent4",label:Box4Intl.Box4Strings.l_ThemeLabel8},
8:{name:"accent5",label:Box4Intl.Box4Strings.l_ThemeLabel9},9:{name:"accent6",label:Box4Intl.Box4Strings.l_ThemeLabel10}};Object(u.a)(os,"ColorMenu",null,[306]);class Lx{P0l(b){return b}}Object(u.a)(Lx,"DeleteTableSegmentStrategy",null,[678]);var Kv=d(448),Sq=d(1008);class DC{get ir(){return Rj.a.UPb}get nl(){return null!=this.o1g?this.o1g:this.o1g=Za.a.instance.resolve(348)}get M3(){return this.nl.ir}get Dc(){return Rg.a.instance}get cC(){return null!=this.z1g?this.z1g:this.z1g=Za.a.instance.resolve(17)}CSc(b,
h,r,A,M,aa,oa){let Ja=2;if(!b.te)return 2;const fb=b.mb;if(!fb)return this.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.kga}),8;if(y.AFrameworkApplication.J.$("Box4PartialPromoteDemoteIsEnabled")){b=this.aZh(h===ub.a.KI,r,!0);if(1===A)return b?32:8;b&&(Ja=Sq.a.gtc(h,r,A,M,aa,oa))}else Ja=Sq.a.gtc(h,r,1,M,aa,oa),1!==A&&32===Ja?(b.mb.Ume(),b=new Rb.GraphTransaction(15),b.Bb(r.view.od),Ja=this.aZh(h===ub.a.KI,r,!1)?Sq.a.gtc(h,r,A,M,aa,oa):8,b.dispose()):1!==A&&8===Ja&&(b.mb.Ume(),this.mvl(h,r,fb));return Ja}aZh(b,
h,r){h=h.view.mb;if(!h||!h.gb.currentSelection)return this.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.HVb}),!1;if(h.gb.FL)return this.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.zqf}),!1;h=Kv.OutlineElementGeneralizer.Mka(h.gb,!1);if(!h)return this.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.v1d}),!1;let A=!1;for(let M=0;M<h.length;M++){const aa=h.getContext(M),oa=new vd.a;oa.set(aa.node);ze.a.tv(oa);if(!Db.OutlineElementReader.Nh(oa))if(r)continue;else return this.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.mNb}),!1;if(b?!this.ir.bLb(oa):!this.ir.Qdc(oa))if(r)continue;
else return this.Dc.$b(Nf.a.wgc,{["Reason"]:nf.a.Fmf}),!1;A=!0}return r?A:!0}mvl(b,h,r){const A=new Rb.GraphTransaction(15);try{A.Bb(h.view.od);h=!0;const M=Kv.OutlineElementGeneralizer.Mka(r.gb,!1);for(let aa=0;aa<M.length;aa++){const oa=M.getContext(aa),Ja=new vd.a;Ja.set(oa.node);ze.a.tv(Ja);if(!Db.OutlineElementReader.Nh(Ja))h=!1;else if(b===ub.a.KI?this.ir.bLb(Ja):this.ir.Qdc(Ja))switch(h=!1,b){case ub.a.KI:this.ir.gZa(Ja,-1,0);break;case ub.a.ZQ:this.ir.eYc(Ja,1)}}if(h){const aa=r.gb.currentSelection;
for(r=0;r<aa.length;r++){const oa=aa.K(r);if(oa.Al){const Ja=this.cC.zqb(oa.node),fb=Ja.oha;if(b===ub.a.KI?Ja.RA>fb:Ja.RA<18*fb){const Cb=new vd.a;Cb.set(oa.node);this.M3.TDa(Cb,1,b===ub.a.KI?Ja.RA>=2.5*fb?Ja.RA-2*fb:fb:Ja.RA<16*fb?Ja.RA+2*fb:18*fb)}}}}}finally{A&&A.dispose()}}}Object(u.a)(DC,"IndentationActorExtension",null,[677]);var iJ=d(746),Ou=d(1159);class hx{constructor(b,h){this.Lo=new wg.DictionaryPropertySet;this.jJd=new wg.DictionaryPropertySet;this.tEb=!1;this.KGa=this.Xgb=null;this.L9=
b;this.mhh=h}get vzb(){return null!=this.$3g?this.$3g:this.$3g=Za.a.instance.Oa(35)}get im(){return null!=this.mWg?this.mWg:this.mWg=Za.a.instance.resolve(101)}get Wb(){return null!=this.f6g?this.f6g:this.f6g=Za.a.instance.resolve(8)}dxb(){this.tEb||(0<this.PWa.$K()&&(this.jJd=this.Lo.clone()),this.Lo.Vse(),this.Xgb=null,this.Kvo())}cAl(b){var h;const r=null!==(h=Wa.FormattingReader.Rs(b))&&void 0!==h?h:Wa.FormattingReader.E5d(b.node,b.cpBegin,-1);!r.cache.mE&&(b=r.lo)&&(h=new wg.DictionaryPropertySet,
h.Yt(b),h.Yt(this.Lo),h.hasProperty(wb.a.Fw)&&(this.Xgb=r.paragraph.Ic),this.Lo=h)}hasProperty(b){return this.Lo.hasProperty(b)}m5c(){return 0<this.Lo.$K()}get PWa(){return this.Lo}freeze(){this.tEb=!0}yOa(){this.tEb=!1}lI(b,h){return this.PWa.ka(b,h)}gC(b){this.Lo.setValue(He.a.fontSize,this.im.Oec(b));this.d4();kl.a.ppg(this.jJd,this.Lo)}fontSize(){return this.Lo.ka(He.a.fontSize,kl.a.YQ)}wwe(b){this.Lo.setValue(He.a.font,b);this.mhh&&this.mhh.execute(h=>{null==h?v.ULS.sendTraceTag(527029267,324,
10,"IFontNameFormattingStrategy is null after future execution"):h.wwe(this.Lo)});this.L9&&this.L9.enabled&&(Tc.b(40506690,306,50,"InsertionPointFomatting: Set font slot values"),this.L9.XQo(this.Lo,b));this.d4();kl.a.ppg(this.jJd,this.Lo)}Kzg(b){this.Lo.setValue(Mc.a.Se,b);this.L9&&this.L9.enabled&&(Tc.b(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.L9.yWo(this.Lo,b));this.d4()}Zw(b){b=Ep.a.instance.Qja(gg.a.instance.gb.currentSelection.Qa.node,b);this.Lo.setValue(He.a.fontColor,
b);this.d4();kl.a.ppg(this.jJd,this.Lo)}Oja(){this.Lo.setValue(He.a.fontColor,Ol.a.auto);this.d4()}fontColor(){return this.Lo.ka(He.a.fontColor,Ol.a.nil)}RDa(b){this.Lo.setValue(He.a.highlight,parseInt(b,16));this.d4()}XUd(){this.Lo.setValue(He.a.highlight,Ol.a.auto);this.d4()}isBold(){return this.Lo.ka(He.a.bold,!1)}JN(b){this.Lo.setValue(He.a.bold,b);this.d4()}isItalic(){return this.Lo.ka(He.a.italic,!1)}eA(b){this.Lo.setValue(He.a.italic,b);this.d4()}isUnderline(){return this.Lo.ka(He.a.underline,
!1)}z8(b){this.Lo.setValue(He.a.underline,b);this.Lo.setValue(He.a.underlineType,b?kl.a.Tzb:kl.a.tV);this.d4()}underlineType(){return this.Lo.ka(He.a.underlineType,kl.a.tV)}hha(b){b<kl.a.Tzb||b>kl.a.tV||(this.Lo.setValue(He.a.underline,b!==kl.a.tV),this.Lo.setValue(He.a.underlineType,b),this.d4())}isSuperscript(){return this.Lo.ka(He.a.superscript,!1)}qva(b){this.Lo.setValue(He.a.superscript,b);b&&this.isSuperscript()&&this.Lo.setValue(He.a.subscript,!1);this.d4()}isSubscript(){return this.Lo.ka(He.a.subscript,
!1)}TNa(b){this.Lo.setValue(He.a.subscript,b);b&&this.isSubscript()&&this.Lo.setValue(He.a.superscript,!1);this.d4()}isStrikethrough(){return this.Lo.ka(He.a.strikethrough,!1)}rna(b){this.Lo.setValue(He.a.strikethrough,b);this.d4()}isDoubleStrikethrough(){return this.Lo.ka(wb.a.zu,!1)}rwe(b){this.Lo.setValue(wb.a.zu,b);this.d4()}oti(){return this.Lo.ka(wb.a.Fw,null)}Ydb(b,h){this.Lo.Vse();this.Lo.setValue(wb.a.Fw,b.id);this.Xgb=h.Ic;this.d4()}v8(b){let h=He.a.mP;const r=iJ.a.Gge(b);switch(r){case 1:h=
Mc.a.ppc;break;case 2:h=Mc.a.qpc}this.Lo.setValue(Mc.a.Iab,r);this.Lo.setValue(h,b);this.d4()}language(){let b=He.a.mP;switch(this.Lo.ka(Mc.a.Iab,0)){case 1:b=Mc.a.ppc;break;case 2:b=Mc.a.qpc}return this.Lo.ka(b,0)}lTo(b){this.Lo.setValue(Mc.a.noProof,b);this.d4()}RSb(){return this.Lo.ka(Mc.a.noProof,!1)}nkn(){return this.Lo.hasProperty(Mc.a.noProof)}Sin(){return this.Lo.hasProperty(He.a.mP)||this.Lo.hasProperty(Mc.a.ppc)||this.Lo.hasProperty(Mc.a.qpc)}d4(){if(Y.a.iyc){Object(Lb.a)();var b=gg.a.instance.gb.currentSelection.Qa,
h=b.node;if(h===this.KGa)this.KGa.km(16,!0);else{this.KGa=h;h=this.KGa.I0();try{this.KGa.n_(b.cpBegin).PBa=!0}finally{h&&h.dispose()}}}}Kvo(){if(Y.a.iyc&&this.KGa){var b=0,h=this.KGa.I0();try{for(let r=this.KGa.ra.length-1;0<=r;r--){const A=this.KGa.ra.K(r);A.PBa&&(A.PBa=!1,b++,A.isEmpty&&this.KGa.ra.removeAt(r))}}finally{h&&h.dispose()}this.KGa=null}}ayl(b){if(b.cpBegin!==b.cpEnd)return!1;b=b.node.ra.sh(b.cpBegin);return!!b&&b.PBa}Ahf(b){if(this.vzb){this.freeze();var h=new Rb.GraphTransaction(7);
h.Bb(b.node);this.vzb.ywe(b);this.yOa();this.dxb();h.dispose()}}IMf(b){const h=Gd.ParagraphReader.text(b.node);return b.cpBegin&&b.cpBegin!==h.length&&!I.a.Sw(h.charCodeAt(b.cpBegin))&&Ou.a.instance.W8a(h,b.cpBegin-1)!==b.cpBegin&&ze.a.ptb(b)?(b=ze.a.Q6(b,!1))?1<b.length||ze.a.Zl(b.Qa)?b:null:null:null}}Object(u.a)(hx,"InsertionPointFormatting",null,[676]);class Xt extends ig.a{constructor(b,h){super(!1,!1,!0);this.Fsl=(r,A)=>{1===r?(r=A.selectedColorText,6!==r.length?v.ULS.sendTraceTag(595345436,
340,10,"Color picker dialog did not return the color in expected format RRGGBB. Color returned: {0}, Menu: {1}",r,this.mO):(r=r.substring(4,6)+r.substring(2,4)+r.substring(0,2),y.AFrameworkApplication.va.Pb(this.rMe,2,r),v.ULS.sendTraceTag(595345435,340,50,"Color selected from color picker dialog. Menu: {0}",this.mO))):v.ULS.sendTraceTag(595345434,340,50,"Color picker dialog closed without selecting any color. Menu: {0}",this.mO)};this.mO=b;this.rMe=h}zyb(b=0){const h={};h.initColor=Ol.a.BB(b);h.redLabel=
Box4Intl.Box4Strings.L_FontColorRed;h.blueLabel=Box4Intl.Box4Strings.L_FontColorBlue;h.greenLabel=Box4Intl.Box4Strings.L_FontColorGreen;h.hexLabel=Box4Intl.Box4Strings.L_FontColorHex;this.mi(Box4Intl.Box4Strings.L_MenuCustomColors,this.Fsl,{["id"]:"ColorPickerDialog",["bodyControls"]:h});v.ULS.sendTraceTag(595345437,340,50,"Color picker dialog is opened. Menu: {0}",this.mO)}}Object(u.a)(Xt,"ColorPickerDialog",ig.a,[]);class dB{constructor(b,h,r,A,M,aa){this.QHn=b;this.rua=h;this.Nva=r;this.jp=A;this.HP=
M;this.xhg=aa;this.FZi=!1;this.ofd=(oa,Ja,fb)=>{if(1===fb)return 32;oa=this.Uh.ka(He.a.cS,Ol.a.jB);(new Xt(dB.jnb,ub.a.zwc)).zyb(oa);return 32};this.ztc=(oa,Ja,fb,Cb,Gb)=>{if(1===fb)return 32;oa=this.Uh.ka(He.a.cS,Ol.a.jB);oa=Ol.a.BB(oa);this.Ffa(this.xhg);this.xhg.gca=oa;this.HP.kAc(oa);oa=this.xhg.Opb(this.Uh,df.a.VTa);if(!oa)return 8;Gb.MenuItems=oa;v.ULS.sendTraceTag(509109712,340,50,"Page color dropdown menu is opened.");return 32};this.Hhf=(oa,Ja,fb,Cb,Gb)=>{if(1===fb)return 32;Ja=this.jp.Nc(15);
Ja.Bb(this.Uh);switch(oa){case ub.a.cVd:this.Uh.hasProperty(He.a.cS)&&this.Uh.setValue(He.a.cS,Ol.a.jB);break;case ub.a.i_a:Gb=this.Nva.Qja(this.Uh,Gb);this.Uh.setValue(He.a.cS,Gb);break;case ub.a.zwc:oa=this.Nva.Qja(this.Uh,Gb),this.Uh.setValue(He.a.cS,oa),this.HP.gTa(Gb)}Ja.dispose();return 32}}Ffa(b){this.FZi||(b.BG(2,ub.a.cVd),b.BG(3,ub.a.i_a),b.BG(4,ub.a.i_a),b.BG(5,ub.a.zwc),b.BG(6,ub.a.ofd),b.C5a(this.QHn,1),this.FZi=!0)}Xb(){const b=y.AFrameworkApplication.va;b.qa(ub.a.ofd,lc.a.view,this.ofd);
b.qa(ub.a.ztc,lc.a.view,this.ztc);b.qa(ub.a.i_a,lc.a.view,this.Hhf);b.qa(ub.a.cVd,lc.a.view,this.Hhf);b.qa(ub.a.zwc,lc.a.view,this.Hhf);b.Pc(ub.a.ztc,1127)}get Uh(){return this.rua.value}}dB.jnb="Page";Object(u.a)(dB,"PageColorActor",null,[]);var oG=d(540),Up=d(466);class oE extends Oy.a{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb){super();this.P9b=this.Wn=this.iQa=null;this.Ido=(Sb,pc)=>{pc=this.Pxa.dqe(this.iQa,pc);Sb.Oi(this.sbm);return pc};this.sbm=(Sb,pc)=>{if(this.Wn.moveNext())return Sb=this.Wn.currentNode,
12!==Sb.type||Sb===this.iQa.node?!0:this.Pxa.khd(Sb,pc);this.bfl();Sb.Oi(this.wbm);return!0};this.wbm=(Sb,pc)=>{if(this.Wn.moveNext()){const zc=this.Wn.currentNode;return 12!==zc.type?!0:zc===this.iQa.node?(Sb.Oi(this.Jdo),!0):this.Pxa.khd(zc,pc)}return!1};this.Jdo=(Sb,pc)=>{this.Pxa.eqe(this.iQa,pc);return!1};this.init(b);this.qm(Gb);this.bsb(Ja,h,A,M,aa);this.ZN=aa;this._context=r;this.hb=fb;this.Oe=Cb;this.Pxa=oa;this.nA=0}run(){this.qnf();this.nA||this.rYo();1===this.nA&&this.Ueo();2===this.nA&&
this.cfp();3===this.nA&&this.P7l()}qnf(){this.hb.gb&&this.hb.gb.currentSelection?1===this.behavior&&(this.Pxa.qnf(this._context)?this.es=32:this.es=2,this.nA=3):(v.ULS.sendTraceTag(20321351,324,15,"No selection for ignore all"),this.es=2,this.nA=3)}rYo(){this.Hel();this.Pxa.mAg(this.iQa)?(this.Xdl(),this.nA=1):(this.es=8,this.nA=3)}Ueo(){this.HC||new Fv.a(this,this.Ido,this.ZN);do if(this.HC.run(),this.HC.zfa&&!this.oi)return;while(this.HC.zfa);this.TUd();this.nA=2}cfp(){this.Pxa.IGg(this)?this.es=
32:this.es=8;this.nA=3}P7l(){this.ova()}Hel(){let b=this.hb.gb.currentSelection;if(b=this.Oe.uk(b,!0,!1))this.iQa=b.Qa;this.iQa&&this.iQa.node&&(this.P9b=this.Pxa.IDi(this.iQa.node))}Xdl(){if(!this.P9b)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new xm.a;b.set(this.iQa.node);b.vb(this.P9b.type);this.Wn=ef.a.At(b,this.P9b);this.Wn.pp(Object(E.a)(this.Pxa,this.Pxa.Exc,"spellErrorFilter"),null)}bfl(){if(!this.P9b)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=
new xm.a;b.set(this.P9b);this.Wn=ef.a.xq(b);this.Wn.pp(Object(E.a)(this.Pxa,this.Pxa.Exc,"spellErrorFilter"),null)}}Object(u.a)(oE,"ProofingWholeDocumentOperation",Oy.a,[]);var eB=d(274);class pE extends Ho{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}Object(u.a)(pE,"ContextMenuRootProperties",Ho,[]);var jJ=d(1992);class kJ{constructor(b){const h=new pE;h.ImageSideArrow=y.AFrameworkApplication.Ss;h.ImageSideArrowClass=Gg.getImageClass("SubmenuFlyoutArrow_13x13x32");h.TextDirection=
Box4Intl.Box4Strings.L_RibbonOptionTextDirection;h.CommandMenuOpen=ub.a.Bpe.toString();this.rGh=new jJ.ContextMenuRoot("ContextMenuRootName",h);b.execute(r=>{this.T8.oH=r});this.T8.refresh();y.AFrameworkApplication.va.qa(Ka.a.showContextMenu,we.a.frame,ce.ActionManager.Zf);y.AFrameworkApplication.va.qa(Ka.a.gxc,we.a.frame,ce.ActionManager.Zf)}get T8(){return this.rGh}dispose(){this.T8&&(this.T8.dispose(),this.rGh=null)}showContextMenu(b,h){this.m0b(b,h.clientPoint,h.zg)}ceb(b,h,r){Le.a.Kie(this.T8.t5a?
"ShowLegacyContextMenuAndFloatie":"ShowLegacyContextMenu","");qa.StaticActiveAppFrame.za().mam();this.pv();this.T8.ceb(b,h,r);this.T8.t5a?y.AFrameworkApplication.va.Ob(Ka.a.gxc,2):y.AFrameworkApplication.va.Ob(Ka.a.showContextMenu,2)}m0b(b,h,r){this.ceb(b,new Sys.UI.Bounds(h.x,h.y,0,0),r)}pv(){this.T8.root.rn()}H6(){return this.T8.H6()}gxc(b,h,r,A){const M=this.T8;let aa=!1;r=Object(ya.a)(Ly,r);M.t5a=r;A.ZDa(b,h);M.Wcf?r&&(r.Y$n(M,h),aa=!0):(v.ULS.sendTraceTag(4801985,324,15,"Failed to launch the context menu!  Menu type:  {0}.",
A.hKl()),M.t5a=null);return aa}}Object(u.a)(kJ,"AContextMenuController",null,[710,10]);class EC{constructor(){this.Priority=0;this.Context=null;this.Length=this.StartInContext=this.Start=0;this.Metadata=EC.ZXl;this.Suggestions=this.TypeId=this.TraceId=null;this.CritiqueActions=this.SupportedActions=0;this.RevisionId=this.TileId=this.Explanation=this.ExplanationLabel=this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0}}EC.ZXl=[];Object(u.a)(EC,"Critique",null,[]);class lJ{constructor(){this.Text=
null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}Object(u.a)(lJ,"Suggestion",null,[]);var iL=d(601);class mJ extends Sys.EventArgs{constructor(b,h,r,A,M,aa){super();this.Kvk=b;this.Mxk=h;this.Nxk=r;this.wIe=A;this.kB=M;this.fgb=aa}}Object(u.a)(mJ,"AugloopProofingContextMenuArgs",Sys.EventArgs,[]);var jL=d(370);class ev{constructor(b,h,r){this.AQe=b;this.Tn=h;this.sa=r}v6h(b){const [h,r,A]=this.rIi(b);return this.gwi(h,r,A)}Fdn(b){return wa.a.getTypeNameFor(b.content)===
jL.a.getTypeName()}gwi(b,h,r){if(r&&this.Fdn(r)){if(this.Ccc(r.content))return null;const M=r.content;var A=new EC;A.ExplanationTitle=M.explanationTitle;A.Suggestions=this.QJm(r);A.CategoryTitle=M.categoryName;A.TypeId=M.typeId;A.CritiqueActions=M.critiqueActions;A.Priority=M.priority;r=this.AQe.create(A);A=M.context;r.token=A.substring(M.range.start,M.range.start+M.range.length);r.lcid=tj.a.Hg(M.language).LCID;r.originalText=A;return new iL.a(b,h,r)}return null}QJm(b){var h=b.content.suggestions;
b=[];for(const r of h)h=new lJ,h.Action=r.suggestionActions,h.Text=r.text,h.Description=r.description,b.push(h);return b}Ccc(b){if(!b)return!0;if(!b.M_||!b.M_.state)return!1;b=b.M_.state;return 60===b||70===b}rIi(b){const h=this.Tn.O2c(b,0),r=b.cpBegin,A=b.cpEnd,M=ze.a.pf(b);b=Gd.ParagraphReader.text(b.node,0);for(const aa of h)if(M){if(aa.Ec<=r&&aa.end>=A)return[aa.Ec,aa.end,aa.intent]}else if(aa.Ec<=r&&aa.end>=r&&I.a.s5h(b,aa.end,A))return[aa.Ec,aa.end,aa.intent];return[null,null,null]}static jD(){return!!y.AFrameworkApplication.J&&
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}vQf(b,h,r){const [A,M,aa]=this.rIi(b);aa&&this.sa.raiseEvent(ev.STh,new mJ(b,A,M,h,aa,r))}lZk(b){this.sa.addHandler(ev.STh,b)}f4l(b,h,r){b=this.Tn.Fjc(b,0,0,b.characterData.length);for(let A=0;A<b.count;A++){const M=b.K(A);if(M.intent){const aa=M.intent;if(aa.content&&(0==aa.content.priority||1==aa.content.priority)&&M.Ec>=h&&(!r||r(M.intent)))return this.gwi(M.Ec,M.end,M.intent)}}return null}}
ev.STh="augloopProofingContextMenuActionEventKey";Object(u.a)(ev,"AugLoopProofingErrorDetailHelper",null,[]);class Lv{}Lv.Ltc="faProofing";Lv.ihi="EditorMenuSection";Object(u.a)(Lv,"ContextMenuControlId",null,[]);class Ez{constructor(b){this.Oe=b}qnf(b){b=Object(ya.a)(kw.a,b);return!!b&&!!b.view&&b.view.te}mAg(){return!0}dqe(){return!0}khd(){return!0}eqe(){}IGg(){return!0}Exc(b){if(b.xs)return!0;b=b.role;return 1===b||2===b||3===b||4===b||5===b}IDi(b){if(!b||!this.Oe)return b;const h=new xm.a;h.set(b);
if(this.Oe.tv(h)){for(;!h.xs;)h.rc();return h.currentNode}return b}}Object(u.a)(Ez,"SimpleProofingWholeDocumentCallBacks",null,[589]);class FC{constructor(b){this.value=b}}Object(u.a)(FC,"RefBool",null,[]);class Fz{constructor(){this.$Zc=this.EVb=null;this.o3j=new FC(!1)}}Object(u.a)(Fz,"FindNextErrorOperationParam",null,[]);class pG extends Ez{constructor(b,h,r,A){super(h);this.io=b;this.SOc=r;this.rmk=A}dqe(b,h){return!this.N4f(b.node,b.cpBegin,h)}khd(b,h){return!this.N4f(b,0,h)}eqe(b,h){this.N4f(b.node,
0,h);Object(ya.a)(Fz,h)}N4f(b,h,r){r=Object(ya.a)(Fz,r);if(Gd.ParagraphReader.Vb(b)&&!b.CL)if(Wa.FormattingReader.Rs(wc.a.Tc(b,h)).cache.RSb)r.o3j.value=!0;else{if(ev.jD())return h=this.rmk.f4l(b,h,this.SOc),null!=h?(r.EVb=h,r.$Zc=b,!0):!1;const A=this.io.d7(b);for(let M=0;M<A.length;M++){const aa=A[M];if(aa.Ec>=h&&!aa.errorDetails.X$a()&&(!this.SOc||this.SOc(aa.errorDetails)))return r.EVb=aa,r.$Zc=b,!0}return!1}}}Object(u.a)(pG,"FindNextErrorCallbackSteps",Ez,[]);class kL{constructor(b,h,r,A,M,aa,
oa,Ja,fb,Cb,Gb,Sb,pc,zc,Yc,Kd){this.Zrl=(ke,ge,de,Sd,be)=>{ge=this.hb.gb.currentSelection;if(!ge)return this.xd.$b(Nf.a.Re,{["Reason"]:nf.a.ao}),2;ge=this.Oe.uk(ge,!0,!1);return this.ga.Nf(ge.Qa,ke,de,!1,Sd,be)};this.y2n=(ke,ge,de)=>{if(1===de)return this.ga.Ob(ub.a.v8,1);this.MAk().uCg();return 32};this.eJa=(ke,ge,de)=>{if(1===de)return 32;db.a.mark(4670);de=this.io.rsa(ge);if(this.WCe(de))return 8;ge=ge.node;const Sd=this.Qc.Nc(15);let be=de.Ec;" "===Gd.ParagraphReader.text(ge).charAt(be-1)&&be--;
Sd.Bb(ge);const Rf=this.Qd.Ve(wc.a.createTextRange(ge,0<de.Ec?de.Ec-1:0,de.end),"",!0,!1);this.hb.Kc(sc.SelectionFactory.ue(ge,Rf+be));Sd.dispose();de.errorDetails.Izb(ke);db.a.mark(4671);return 32};this.sBa=(ke,ge,de)=>{if(1===de)return 32;v.ULS.sendTraceTag(7660830,324,50,"Ignore spelling error triggerred");if(ev.jD())return this.xgb.vQf(ge,null,Up.b.IgnoreOnce),32;db.a.mark(4670);de=this.io.rsa(ge);if(this.WCe(de))return 8;ge=ge.node;const Sd=this.Qc.Nc(15);Sd.Bb(ge);this.io.Rwb(ge,[de],!0);ge.setValue(He.a.wqf,
!0);Sd.dispose();de.errorDetails.Izb(ke);db.a.mark(4671);v.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.lCn(de);this.Z3a.yOi(de,ge,!0);return 32};this.qAl=(ke,ge,de)=>{var Sd,be=!this.xl.eba(ge);this.Sn&&this.Sn.instance&&this.Sn.instance.sX(ge)&&(be=!1);if(1===de||!be)return be?32:8;this.ga.Ob(ub.a.Jva,2);db.a.mark(4670);be=this.mlm(ke);if(0>be)return 8;if(ev.jD())return this.xgb.vQf(ge,be,Up.b.Apply),32;de=this.io.rsa(ge);if(this.WCe(de))return 8;ge=ge.node;var Rf=
de.errorDetails.suggestions;if(!Rf)return this.xd.$b(Nf.a.YNb,{["Reason"]:"NoSuggestionsFound"}),db.a.mark(4671),8;be=be<Rf.length?Rf[be]:null;if(!be)return this.xd.$b(Nf.a.YNb,{["Reason"]:"RequestedSuggestionIsNull"}),db.a.mark(4671),8;(null===(Sd=Of.a.ud())||void 0===Sd?0:Sd.Co)&&Of.a.ud().Ak.xG(ge);be=be.replace("  "," \u00a0");Sd=this.Qc.Nc(15);Sd.Bb(ge);Rf=this.Qd.Ve(wc.a.createTextRange(ge,de.Ec,de.end),be,!0,!1,ub.a.Jva);this.hb.Kc(sc.SelectionFactory.ue(ge,de.Ec+be.length+Rf));Sd.dispose();
de.errorDetails.Izb(ke);db.a.mark(4671);this.Myn(de);return 32};this.qLo=(ke,ge)=>{ge=this.io.rsa(ge);if(this.WCe(ge))return 8;ge.errorDetails.Izb(ke);return 32};this.T6l=(ke,ge,de,Sd,be)=>{if(!ge.view.te)return 2;const Rf=ge.view;if(!this.hb.gb.currentSelection)return this.xd.$b(Nf.a.Re,{["Reason"]:nf.a.ao}),2;if(1===de)return 32;const Mf=new Fz,Yj=new pG(this.io,this.Oe,this.SOc,this.xgb);ge=new oE(null,ke,ge,de,Sd,Mf,Yj,this.ga,this.hb,this.Oe,null);ge.oi=!0;ge.run();if(ge.isCompleted&&Mf.EVb){if(ge=
sc.SelectionFactory.ue(Mf.$Zc,Mf.EVb.Ec),ge=sc.SelectionFactory.Qy(ge,wc.a.Tc(Mf.$Zc,Mf.EVb.end)),!this.ozh.instance||!this.ozh.instance.cco(Mf.EVb,ge,Rf)){this.hb.Kc(ge);let Ji=0;be&&(Ji=be.Wy);Rf.jye=!1;Je.a.instance.Zb(new xc.a(1,1,1,()=>{this.qJo(Rf,Ji,Mf.$Zc,Mf.EVb)}))}}else{const Ji=new ni.StandardDialog;Ji.Fd=0;df.a.aQ.h$c?Ji.yna(CommonUIStrings.l_DefaultDialogTitle,Mf.o3j.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,
null):(Ji.yna(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ProofingInProgress,null),df.a.aQ.yQd(()=>{Ji.Wla&&(Ji.hide(),this.ga.Ob(ke,2))}))}return 32};this.Bpe=(ke,ge,de)=>{if(1===de)return 32;this.gia&&this.gia.T8&&(ke=this.gia.T8.xOf(Lv.Ltc))&&!ke.xN&&(ke.n3(0),ke.Ig.cN(0));return 32};this.ga=h;this.io=b;this.MAk=r;this.Qd=A;this.Qc=M;this.hb=aa;this.Sn=oa;this.Oe=Ja;this.cKk=fb;this.xl=Cb;this.xd=Gb;this.xgb=Kd;this.gia=Object(ya.a)(kJ,Sb);this.L7b=pc.J9c;this.ozh=zc;this.Z3a=Yc;
this.bCc=new Map;this.bCc.set(1,ub.a.IDg);this.bCc.set(2,ub.a.bPf);this.bCc.set(3,ub.a.OEg);this.BNc=new Map;this.BNc.set(1,ub.a.JDg);this.BNc.set(2,ub.a.cPf);this.BNc.set(3,ub.a.PEg)}Xb(){const b=this.ga,h=this.qAl,r=this.Zrl;b.fb(ub.a.Ine,lc.a.view,this.y2n,1028);b.qa(ub.a.eJa,lc.a.Xc,this.eJa);b.qa(ub.a.sBa,lc.a.Xc,this.sBa);b.qa(ub.a.qzb,lc.a.Xc,h);b.qa(ub.a.rzb,lc.a.Xc,h);b.qa(ub.a.szb,lc.a.Xc,h);b.qa(ub.a.$0b,lc.a.Xc,h);b.qa(ub.a.a1b,lc.a.Xc,h);b.qa(ub.a.eJa,lc.a.view,r);b.qa(ub.a.sBa,lc.a.view,
r);b.qa(ub.a.qzb,lc.a.view,r);b.qa(ub.a.rzb,lc.a.view,r);b.qa(ub.a.szb,lc.a.view,r);b.qa(ub.a.$0b,lc.a.view,r);b.qa(ub.a.a1b,lc.a.view,r);b.Pc(ub.a.eJa,1028);b.Pc(ub.a.sBa,1028);b.Pc(ub.a.qzb,1028);b.Pc(ub.a.rzb,1028);b.Pc(ub.a.szb,1028);b.Pc(ub.a.$0b,1028);b.Pc(ub.a.a1b,1028);b.qa(ub.a.Jva,we.a.frame,ce.ActionManager.Zf);this.L7b&&b.fb(ub.a.Bpe,lc.a.view,this.Bpe,1124);b.fb(ub.a.ndd,lc.a.view,this.T6l,1028);b.fb(ub.a.Bmg,lc.a.Cd,this.qLo,1124);this.Jro([ub.a.Eze,ub.a.IDg,ub.a.JDg,ub.a.k9d,ub.a.bPf,
ub.a.cPf,ub.a.jAe,ub.a.OEg,ub.a.PEg,ub.a.Muj,ub.a.qMn,ub.a.XUj])}Jro(b){for(let h=0;h<b.length;h++)this.ga.fb(b[h],lc.a.view,ce.ActionManager.aU,1028)}Zso(b){this.SOc=b}WCe(b){return b?b.errorDetails?!1:(v.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.xd.$b(Nf.a.YNb,{["Reason"]:"ErrorRangeMissingErrorDetails"}),db.a.mark(4671),!0):(v.ULS.sendTraceTag(7660828,324,10,"Ignore Spelling Error: No flagged word"),this.xd.$b(Nf.a.YNb,{["Reason"]:"RequestedErrorRangeNotFound"}),
db.a.mark(4671),!0)}lCn(b){b=b.errorDetails.proofingType;if(this.BNc.has(b)){const h=this.BNc.get(b);this.ga.Ob(h,2);v.ULS.sendTraceTag(527799886,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",h,b)}}mlm(b){switch(b){case ub.a.qzb:return 0;case ub.a.rzb:return 1;case ub.a.szb:return 2;case ub.a.$0b:return 3;case ub.a.a1b:return 4;default:return-1}}Myn(b){b=b.errorDetails.proofingType;if(this.bCc.has(b)){const h=this.bCc.get(b);this.ga.Ob(h,2);v.ULS.sendTraceTag(527799887,375,50,
"ProofingActor: Logging {0} command for {1} proofingType.",h,b)}}qJo(b,h,r,A){b.Z3();(b=r.Be(b.pc))?(A=eB.a.Ar(b,y.AFrameworkApplication.isRtl?A.Ec:A.end),this.cKk.ZDa(new Sys.UI.Point(A.x,A.y+A.height),h)):v.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}}Object(u.a)(kL,"ProofingActor",null,[]);var Vh=d(314),jt=d(1474),Cs=d(1863);class GC{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb){this.$xc=null;this.s9l="StyleUsageActivity";this.t9l="StylesFloodgateSurveyIsEnabled";this.vTa=
(Sb,pc,zc,Yc)=>{Sb=this.tJm(Sb);return 0>Sb||Sb>this.$xc.length?2:(Sb=this.$xc[Sb])?y.AFrameworkApplication.va.Nf(pc,ub.a.vT,zc,!0,Yc,Sb):2};this.qXb=(Sb,pc,zc,Yc,Kd)=>{Sb=!0;pc.contextId!==lc.a.paragraph&&pc.contextId!==lc.a.Cd&&pc.contextId!==lc.a.Xc&&(Sb=!1);if(1===zc||!Sb)return Sb?32:8;if(2===zc&&!Kd)return 8;pc=this.Wb.AF(pc.node);Kd.MenuItems=Vh.a.Qxm(pc);return 32};this.aio=(Sb,pc,zc,Yc,Kd)=>{Sb=!0;pc.contextId!==lc.a.paragraph&&(Sb=!1);if(1===zc&&!Sb)return 8;pc=pc.node;zc=this.Wb.Aq(pc);
if(!zc||!Kd)return v.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",Kd,pc,zc),8;si.a.Xg.Ln?Kd.Dva.Wi().Yt(zc.Wi()):Kd.Dva.Yt(zc.Wi());return 32};this.R6k=(Sb,pc,zc,Yc,Kd)=>{if(pc.contextId!==lc.a.paragraph)return 8;if(this.rg.iab(pc,!1))return this.Dc.$b(Nf.a.Nn,{["Reason"]:nf.a.IG}),8;if(1===zc)return 32;const ke=pc.node;if(Gd.ParagraphReader.Aza(ke)||!Kd)return 8;const ge=this.fNf(Kd,ke);if(!ge)return this.Dc.$b(Nf.a.C4,{["Reason"]:nf.a.ZNb}),8;if(2!==this.Wb.BF(ge))return 2;
zc=new Rb.GraphTransaction(15);this.VC.qxc(Kd);zc.Bb(ke);this.pk.dxb();const de=[];Sb!=ub.a.$D&&de.push(De.a.Efb);this.tha.WP(ge,ke,!1,void 0,void 0,void 0,new Cs.a(de,!1,!0));(Sb=this.Wb.AF(ke))&&this.Wb.me(ge,Sb)&&Tc.b(593078098,3017,50,"Custom linked style applied by user");ke.zs&&(Sb=[Object.assign(new ia.a,{name:"Source",string:"ApplyStyle"})],ac.a("TOCFormatting",!0,void 0,Sb));zc.dispose();Kd=I.a.zT(Kd);Yc.Bt=Kd>>>16^Kd&65535;Yc&&jt.a.tzb&&(Yc.eE|=jt.a.nqb(pc.node));return 32};this.bio=(Sb,
pc,zc,Yc,Kd)=>{Sb=!0;pc.contextId!==lc.a.Cd&&(Sb=!1);if(1===zc&&!Sb)return 2;pc=Wa.FormattingReader.Rs(pc);pc=Wa.FormattingReader.bBa(pc);if(!pc)return 2;if(!Kd)return 8;si.a.Xg.Ln?Kd.Dva.Wi().Yt(pc.Wi()):Kd.Dva.Yt(pc.Wi());return 32};this.S6k=(Sb,pc,zc,Yc,Kd)=>{if(pc.contextId!==lc.a.Cd)return 8;this.rg.iab(pc);if(1===zc)return 32;Sb=pc;(pc=this.yp.u7d(Sb))&&(Sb=pc);pc=Sb.node;if(!Kd)return 8;const ke=this.fNf(Kd,Sb.node);if(!ke)return this.Dc.$b(Nf.a.C4,{["Reason"]:nf.a.ZNb}),8;if(1!==this.Wb.BF(ke))return 2;
zc=this.Wb.AF(pc);if(!zc)return this.Dc.$b(Nf.a.C4,{["Reason"]:nf.a.pli}),8;if(!zc.lh(this.Wb.ze(ke)))return this.Dc.$b(Nf.a.C4,{["Reason"]:nf.a.ZNb}),8;const ge=new Rb.GraphTransaction(7);try{if(this.VC.qxc(Kd),ge.Bb(pc),this.tha.NLg(pc,zc),this.Q8.QZ(Sb,de=>{this.im.$qa(de);this.im.Ydb(de,ke)}),pc.zs){const de=[Object.assign(new ia.a,{name:"Source",string:"ApplyStyle"})];ac.a("TOCFormatting",!0,void 0,de)}}finally{ge&&ge.dispose()}zc&&this.Wb.me(ke,zc)&&Tc.b(593078097,3017,50,"Custom linked style applied by user");
Kd=I.a.zT(Kd);Yc.Bt=Kd>>>16^Kd&65535;Yc&&jt.a.tzb&&(Yc.eE|=jt.a.nqb(Sb.node));return 32};this.$ho=(Sb,pc,zc,Yc,Kd)=>{Sb=!0;pc.contextId!==lc.a.Xc&&(Sb=!1);if(1===zc&&!Sb)return 2;pc=this.tha.zJm(pc);if(!pc)return 2;if(!Kd)return 8;si.a.Xg.Ln?Kd.Dva.Wi().Yt(pc.Wi()):Kd.Dva.Yt(pc.Wi());return 32};this.Q6k=(Sb,pc,zc,Yc,Kd)=>{if(pc.contextId!==lc.a.Xc)return 8;if(this.rg.iab(pc,!1))return this.Dc.$b(Nf.a.Nn,{["Reason"]:nf.a.IG}),8;if(1===zc)return 32;var ke=pc.node;if(!Kd)return 8;zc=this.fNf(Kd,pc.node);
if(!zc)return this.Dc.$b(Nf.a.C4,{["Reason"]:nf.a.ZNb}),8;const ge=this.Wb.BF(zc);if(1!==ge&&2!==ge)return 2;(pc=this.pk.IMf(pc))?(pc=gg.a.jMb(pc),Sb=y.AFrameworkApplication.va.Nf(pc,Sb,2,!1,Yc,Kd)):(Sb=new Rb.GraphTransaction(7),this.VC.qxc(Kd),Sb.Bb(ke),this.tha.YVo(zc,ke),Sb.dispose(),Sb=32);ke.zs&&(pc=[Object.assign(new ia.a,{name:"Source",string:"ApplyStyle"})],ac.a("TOCFormatting",!0,void 0,pc));(ke=this.Wb.AF(ke))&&this.Wb.me(zc,ke)&&Tc.b(593078096,3017,50,"Custom linked style applied by user");
Kd=I.a.zT(Kd);Yc.Bt=Kd>>>16^Kd&65535;return Sb};this.cio=(Sb,pc,zc,Yc,Kd)=>{const ke=this.rtd.xua(Sb,pc,zc,Yc,Kd,null,0);return 2!==ke?ke:this.rtd.xua(Sb,pc,zc,Yc,Kd,null,12)};this.T6k=(Sb,pc,zc,Yc,Kd)=>{const ke={};ke[this.rtd.oPa]=6168;ke[this.rtd.nPa]=6169;let ge=12;if(!pc.view.te)return 2;var de=pc.view.mb,Sd=de?de.Mg:null;if(!Sd)return this.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.ao}),8;if(this.Iw.FIa(Uc.ImageReader.A$a,Sd))return this.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.OVc}),8;if(this.Iw.NEa(Gd.ParagraphReader.qX,
Sd))return this.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.QQ}),8;if(this.rg.enc(Sd,!1))return this.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.IG}),8;Sd=this.Wb.qo();if(Kd&&Sd){const be=Sd.lh(Kd);if(be){const Rf=this.Wb.Aqb(be,Sd);let Mf=this.Wb.BF(be);Rf&&(de=de.gb.K(0),de.fw&&de.Qa.contextId===lc.a.Cd||2===de.length&&de.Qa.contextId===lc.a.Cd&&de.Wc.contextId===lc.a.Uc)&&(Mf=1,Kd=Rf.getValue(wb.a.la));1===Mf?ge=0:3===Mf&&(ge=14);!this.Wb.me(be,Sd)&&this.Wb.Hd(be)&&(de=this.Wb.ze(be),Tc.b(562317522,3017,50,String.format("{0}: style applied by user",
de)));this.Kha(this.s9l,this.t9l)}}return this.rtd.xua(Sb,pc,zc,Yc,Kd,ke,ge)};this.$v=h;this.Ke=r;this.nQ=A;this.pB=M;this.xl=aa;this.xd=oa;this.zZ=Ja;this.jQk=fb;this.we=Cb;this.yp=Gb}get tha(){return this.$v}get Iw(){return this.nQ}get pk(){return this.pB}get im(){return this.Ke}get rg(){return this.xl}get Dc(){return this.xd}get Q8(){return this.zZ}get rtd(){return this.jQk}get Wb(){return this.we}Xb(){const b=y.AFrameworkApplication.va,h=df.a.V_a.m8h(12);b.qa(ub.a.vT,lc.a.Cd,this.S6k);b.qa(ub.a.$Ma,
lc.a.Cd,this.bio);b.qa(ub.a.vT,lc.a.Xc,this.Q6k);b.qa(ub.a.$Ma,lc.a.Xc,this.$ho);b.qa(ub.a.vT,lc.a.paragraph,this.R6k);b.qa(ub.a.vT,lc.a.view,this.T6k);b.Pc(ub.a.vT,1036);b.qa(ub.a.$Ma,lc.a.view,this.cio);b.qa(ub.a.$Ma,lc.a.paragraph,this.aio);b.Pc(ub.a.$Ma,99);b.qa(ub.a.qXb,lc.a.view,h);b.qa(ub.a.qXb,lc.a.paragraph,this.qXb);b.Pc(ub.a.qXb,1127);b.fb(ub.a.Lhf,lc.a.view,this.vTa,4);b.fb(ub.a.Mhf,lc.a.view,this.vTa,4);b.fb(ub.a.Nhf,lc.a.view,this.vTa,4);b.fb(ub.a.Ohf,lc.a.view,this.vTa,4);b.fb(ub.a.Phf,
lc.a.view,this.vTa,4);b.fb(ub.a.Qhf,lc.a.view,this.vTa,4);b.fb(ub.a.Rhf,lc.a.view,this.vTa,4);b.fb(ub.a.jSh,lc.a.view,this.vTa,4);b.fb(ub.a.kSh,lc.a.view,this.vTa,4);b.fb(ub.a.lSh,lc.a.view,this.vTa,4);this.$xc=Array(10);this.Wb.WVo(this.$xc)}tJm(b){switch(b){case ub.a.Lhf:return 0;case ub.a.Mhf:return 1;case ub.a.Nhf:return 2;case ub.a.Ohf:return 3;case ub.a.Phf:return 4;case ub.a.Qhf:return 5;case ub.a.Rhf:return 6;case ub.a.jSh:return 7;case ub.a.kSh:return 8;case ub.a.lSh:return 9;default:return-1}}Kha(b,
h){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$(h)&&window.setTimeout(()=>{const r=Za.a.instance.Ra(2);r&&r.execute(A=>{A.logActivity(b,h)})},GC.Xza)}fNf(b,h){if(b&&h&&Gd.ParagraphReader.Vb(h))h=this.Wb.AF(h);else return null;return h.lh(b)}get VC(){return null!=this.XVg?this.XVg:this.XVg=Za.a.instance.resolve(30)}}GC.Xza=5E3;Object(u.a)(GC,"StyleActor",null,[]);var Kr=d(131);class fB{constructor(b,h,r){this.wPk=b;this.we=h;this.Y4a=r}Xb(){this.Y4a.fb(ub.a.Dpe,lc.a.application,this.Dpe.bind(this),
96);this.Y4a.qa(ub.a.nAc,lc.a.view,this.Xwp.bind(this));this.Y4a.fb(ub.a.Pvj,lc.a.view,this.Zwp.bind(this),96)}Dpe(b,h,r,A,M){if(1===r)return 32;b=Object.assign(new aj.a,{ExternalId:"StylesGalleryContextMenu",UpdateDynamically:!0,MenuSectionList:[]});h=[];r=Object.assign(new te.a,{ControlList:[]});r.ControlList.push(Object.assign(new hk.a,{ExternalId:"UpdateStyle",QueryCommand:"QueryUpdateStyle"}));h.push(r);Array.addRange(b.MenuSectionList,h);M.MenuItems=b;return 32}Zwp(b,h,r,A,M){if(1===r)return 32;
b=si.a.iXj();null==b&&8;b=this.we.xL(b);M[Xk.a.LabelText]=String.format(I.a.Jf(Box4Intl.Box4Strings.l_UpdateStyleCommand),b);return 32}Xwp(b,h,r){b=si.a.oTb(h);if(1===r||b)return b?8:32;r=new Map;r.set("Source","StyleContextMenuActor");r.set("Action","UpdateStyle");Ba.Health.instance.recordKpiUsage(Kr.a.TEa,0,Kr.a.NB,r);this.wPk.OLg(h)?Tc.b(539842578,3018,50,"User Successfully Updated styles from UI"):(h=new Map,h.set("Source","StyleContextMenuActor"),h.set("Action","UpdateStyle"),h=Object.assign(new bb.a,
{extendedProperties:h}),Ba.Health.instance.recordKpiFailure(Kr.a.TEa,"UpdateStyleFailed",!1,!0,h),Tc.b(539842780,3018,50,"User tried to update a style via UI, but we were unable to update it."));return 32}}Object(u.a)(fB,"StyleContextMenuActor",null,[]);var Gz=d(1996);class qE{constructor(b){this.ga=b}get Rb(){return this.ga}ywe(b,h=!1){this.Rb.Nf(b,ub.a.PWa,2,!0,null,h)}v8(b){this.Rb.Pb(ub.a.v8,2,b)}}Object(u.a)(qE,"TextFormattingCommands",null,[674]);class In{constructor(b,h,r,A){this.daf=this.cHh=
!1;this.Yip=(M,aa,oa)=>{if(2!==oa)return 2;this.cHh||(this.cHh=!0);return 32};this.Ydo=(M,aa,oa,Ja,fb)=>{if(2!==oa)return 2;this.kuj(fb,!0);return 32};this.Xdo=(M,aa,oa,Ja,fb)=>{if(2!==oa)return 2;this.kuj(fb,!1);return 32};this.Veo=(M,aa,oa)=>{if(2!==oa)return 2;if(!this.oib)return 8;this.oib.AYm();return 32};this.Qdo=(M,aa,oa)=>{if(2!==oa)return 2;if(!this.oib)return 8;this.oib.hEo();return 32};this.mua=(M,aa)=>{3===aa.Wy&&ze.a.Am(aa.Rm.currentSelection)&&(ac.c(ub.a.Tip),this.daf=!0)};this.ga=b;
this.Ga=h;this.oib=r;this.hb=A}get Xip(){return this.daf}Xb(){var b;this.ga.fb(Ka.a.wS,lc.a.view,this.Yip,4);this.ga&&this.Ga&&(this.Ga.$("TouchImageGrippiesResizedIsEnabled")&&(this.ga.fb(ub.a.zIg,lc.a.view,this.Ydo,4),this.ga.fb(ub.a.BIg,lc.a.view,this.Xdo,4)),this.ga.fb(Ka.a.aWj,lc.a.application,this.Veo,4),this.ga.fb(Ka.a.Azf,lc.a.application,this.Qdo,4),Do.EventHandlerManager.instance.eso(()=>{this.Q0n()}));(null===(b=qa.StaticActiveAppFrame.za().kb.Jc)||void 0===b?0:b.te)&&qa.StaticActiveAppFrame.za().kb.Jc.g6(()=>
{this.yJo()});this.hb&&this.hb.tA(this.mua)}hko(){ac.c(ub.a.Wip);this.daf=!0}yJo(){const b=window.performance.now();In.eZe&&250>b-In.eZe&&1E3<b-In.Zqh&&(ac.c(ub.a.Vip),In.Zqh=b);this.oib&&In.sc&&In.sc.kE(108)&&this.oib.showFloatie()}gan(b,h){if(h){var r=null;Y.a.fM&&b&&(r=b.getSelection());b=null;r&&"Caret"===r.type&&(b=r.getRangeAt(0))&&this.oib&&this.oib.Dtp(b.getBoundingClientRect(),h)}}Q0n(){In.eZe=window.performance.now()}kuj(b,h){if(b)for(b=b.firstChild;b;){if("SPAN"===b.tagName&&b.classList.contains(In.N0m)){for(b=
b.firstChild;b;)this.e1k(b,h),b=b.nextSibling;break}b=b.nextSibling}}e1k(b,h){if(b.classList.contains(In.IOi)){const r="WACImageResizeHandleTouch"+this.Rrm(b);h?b.classList.add(In.JOi,r):b.classList.remove(In.JOi,r)}}Rrm(b){for(const h of b.className.split(" "))if(h.startsWith("WACImageResizeHandle")&&h!==In.IOi)return I.a.substring(h,20,h.length);return""}static get sc(){return null!=In.SUg?In.SUg:In.SUg=Za.a.instance.Oa(12)}}In.IOi="WACImageResizeHandles";In.JOi="WACImageResizeHandlesTouch";In.N0m=
"WACImgSelection";In.eZe=0;In.Zqh=0;Object(u.a)(In,"TouchInputActor",null,[672]);class Vy{get oPa(){return Sq.a.oPa}get nPa(){return Sq.a.nPa}get LAc(){return Sq.a.LAc}xua(b,h,r,A,M,aa,oa){return Sq.a.xua(b,h,r,A,M,aa,oa)}gtc(b,h,r,A,M,aa){return Sq.a.gtc(b,h,r,A,M,aa)}static get instance(){Vy._instance||(Vy._instance=new Vy);return Vy._instance}}Vy._instance=null;Object(u.a)(Vy,"ViewActionHandlerProxy",null,[673]);class qG{constructor(b,h,r){this.s9n=r;this.kpiName="VisiMarkersUsage";this.yaa="wwaengidc";
this.Ktb=new Map;this.b6o=(A,M,aa,oa,Ja)=>{var fb;if(1===aa)return 32;if(!Ja)return 2;this.Ktb.set("Source",pp.a[this.ga.b3]);this.Gbf.N$c?this.Ktb.set("Action","Removed"):this.Ktb.set("Action","Applied");Ba.Health.instance.recordKpiUsage(this.kpiName,1,this.yaa,this.Ktb);A=document.getElementsByTagName("head")[0];if(!this.Gbf.kip(A))return v.ULS.sendTraceTag(593294045,324,15,"Toggling Formatting markers failed"),8;y.AFrameworkApplication.vd("PlaceholderTextBugFix;PlaceholderTextBugFixCf");(null===
(fb=y.AFrameworkApplication.J)||void 0===fb?0:fb.getBooleanFeatureGate("Microsoft.Office.WordOnline.PlaceholderTextBugFixIsEnabled",!1))&&this.s9n.wwo();qa.StaticActiveAppFrame.za().eJ({ShowVisiMarkers:"ToggleButtonModel"});return 32};this.sho=(A,M,aa,oa,Ja)=>{if(1===aa)return 32;Ja[Vg.a.On]=this.Gbf.N$c;return 32};this.ga=b;this.Gbf=h}Xb(){this.ga.fb(ub.a.cze,lc.a.application,this.b6o,1);this.ga.fb(ub.a.Hvj,lc.a.application,this.sho,96)}}Object(u.a)(qG,"VisiMarkersActor",null,[]);class HC{uc(b){b.ia("Box4.Actors.Box4PasteStewardFactory",
()=>new vu(Rj.a.UPb,b.resolve(32),b.resolve(10),b.resolve(886))).as(903).ha();b.ia("Box4.Actors.Box4PasteStewardUtils",()=>new QA(y.AFrameworkApplication.J.$("WacPasteBrAsNewParagraphIsEnabled"))).as(1142).ha();b.ia(189,()=>new Qy(b.rf(887),b.resolve(888),Rg.a.instance,b.resolve(173),gg.a.instance,y.AFrameworkApplication.va,b.resolve(50),y.AFrameworkApplication.J,Cd.FocusManager.instance(),b.resolve(889),b.resolve(890),b.resolve(215),b.resolve(235),y.AFrameworkApplication.PBg(),y.AFrameworkApplication.YRj(),
b.resolve(891),Za.a.instance.resolve(728),!!df.a.instance&&df.a.instance.Tla,b.resolve(663))).ha();b.ia(892,()=>new uu(y.AFrameworkApplication.J)).ha();b.ia(893,()=>new zh(y.AFrameworkApplication.J,b.resolve(892),b.resolve(173),Sx.a.instance)).ha();b.ia(878,()=>b.resolve(893).create()).ha();b.ia(888,()=>new aB(b.resolve(878),Object(Lb.a)(),qa.StaticActiveAppFrame.za().kb,Cd.FocusManager.instance(),b.resolve(215),b.resolve(235),Sx.a.instance,y.AFrameworkApplication.J)).ha();b.ia(687,()=>new Lx).ha();
b.ia(868,()=>new gL.a).ha();b.ia(882,()=>new jh).ha();b.ia(899,()=>new oC).ha();b.ia(900,()=>new iG(gg.a.instance,b.resolve(164),b.resolve(8))).ha();b.ia(884,()=>new BC).ha();b.ia(891,()=>new Jv(gg.a.instance,b.resolve(20),Object(Lb.a)(),Le.a.getElementBounds,b.resolve(894),!!df.a.instance&&df.a.instance.Tla)).ha();b.ia(895,()=>new AC(b.resolve(173),df.a.GC.WK)).ha();b.ia(938,()=>new nw(b.resolve(894),b.resolve(258),Object(Lb.a)(),Ky.a.instance(),y.AFrameworkApplication.ua,b.resolve(891),b.resolve(71),
b.resolve(895),df.a.gf.Ll.jf(12),b.resolve(201),b.resolve(728),b.resolve(27),!!df.a.instance&&df.a.instance.Tla)).ha();b.ia(889,()=>new av(Rg.a.instance,b.resolve(896),b.resolve(897),Xw.a.instance,gg.a.instance,y.AFrameworkApplication.va,b.resolve(898),b.rf(50),b.resolve(899),b.resolve(900),b.resolve(46).instance)).ha();b.ia(901,()=>new hG(y.AFrameworkApplication.va,Rg.a.instance,b.resolve(896),b.resolve(18),gg.a.instance,b.resolve(888),b.resolve(164),sr.a.instance,b.resolve(197),b.resolve(292),b.resolve(202),
b.resolve(882),b.resolve(868),b.resolve(71),b.resolve(173),b.Oa(12))).ha();b.ia(890,()=>new gG(Rg.a.instance,Sx.a.instance,b.resolve(888),b.resolve(256),y.AFrameworkApplication.J.appSettings.ChromeClipboardAccessOperationTimeout)).ha();b.ia(898,()=>new kh(y.AFrameworkApplication.J)).ha();b.ia(887,()=>new fE(b.resolve(896),y.AFrameworkApplication.va,y.AFrameworkApplication.LBg(),Rg.a.instance,sr.a.instance,Sx.a.instance,b.resolve(42),b.resolve(889),b.resolve(901),b.resolve(890),b.resolve(902),b.resolve(172),
b.resolve(256),b.resolve(180).instance,b.resolve(46).instance,b.resolve(50),b.resolve(258),b.resolve(259))).ha();Fm.a.ita&&b.ia(913,()=>new eJ(Fm.a.jUi?b.Ra(2):null)).ha();b.ia(915,()=>new lG(b.rf(903),b.rf(904),b.rf(905),b.rf(906),b.rf(907),b.Oa(908),b.resolve(71),b.resolve(909),b.resolve(910),b.resolve(490),b.resolve(911),b.resolve(912),Fm.a.ita?b.rf(913):null)).ha();b.ia(896,()=>new Iv.a(b.resolve(820),b.rf(33),b.resolve(110),b.resolve(18),b.resolve(32),df.a.gf,b.resolve(17),y.AFrameworkApplication.J,
b.resolve(446),b.resolve(42),b.Oa(908),b.resolve(621),b.resolve(46).instance,b.resolve(237).mKj,b.resolve(490))).ha();b.ia(914,()=>new mG(b.resolve(896),b.Oa(908),new Qf.a(()=>qa.StaticActiveAppFrame.za().kb.Jc),b.resolve(490),b.resolve(912))).ha();b.ia(1184,()=>new Kx(y.AFrameworkApplication.va)).ha();b.ia(1092,()=>new aE(b.resolve(32),b.rf(659),b.resolve(39).instance,b.resolve(46).instance,b.resolve(322))).ha();b.ia(897,()=>new Zx(b.resolve(896),b.resolve(914),b.resolve(915),re.a.instance)).ha();
b.ia("Box4.Actors.Box4ImageStewardFactory",()=>new sC(b.resolve(820),y.AFrameworkApplication.oc,b.resolve(50),b.Oa(916),qa.StaticActiveAppFrame.za().$J,b.Oa(12),b.resolve(71).$("LogActionForFailedLocalImagePasteIsEnabled"))).as(904).ha();b.ia("Box4.Actors.Box4TableStewardFactory",()=>new XI(Za.a.instance.resolve(32),Za.a.instance.resolve(33),b.resolve(71).$("PasteComplexTablesIsEnabled"),b.resolve(71).$("PasteTableCellMarginImprovementsIsEnabled"))).as(905).ha();b.ia(902,()=>new wC(Rg.a.instance,
gg.a.instance,Of.a.ud(),re.a.instance)).ha();b.ia("Box4.Actors.Box4WordConverterFactory",()=>new Xu(y.AFrameworkApplication.J)).as(906).ha();b.ia(909,()=>new iE(y.AFrameworkApplication.J)).ha();b.ia(911,()=>new Qw).ha();b.ia(210,()=>new pC(y.AFrameworkApplication.va)).ha();b.ia(35,()=>new qE(y.AFrameworkApplication.va)).ha();b.ia(937,()=>new rC(b.Ra(324),b.resolve(43))).ha();b.ia("Box4.Actors.InsertionPointFormatting",()=>new hx(b.Oa(118),b.Ra(917))).as(106).ha();b.ia(894,()=>new My).as("Box4.UI.IFloatieManager").ha();
b.ia(935,()=>new kL(Za.a.instance.resolve(43),y.AFrameworkApplication.va,()=>Za.a.instance.resolve(918),Za.a.instance.resolve(322),Za.a.instance.resolve(42),gg.a.instance,Za.a.instance.Ra(51),sr.a.instance,Za.a.instance.resolve(123),re.a.instance,Rg.a.instance,Za.a.instance.resolve(31),Za.a.instance.resolve(41),Za.a.instance.Ra(919),Za.a.instance.resolve(343),Za.a.instance.resolve(920))).ha();b.ia(940,()=>new GC(Za.a.instance.resolve(322),Za.a.instance.resolve(392),Za.a.instance.resolve(101),Object(Al.a)(),
Za.a.instance.resolve(106),re.a.instance,Rg.a.instance,Za.a.instance.resolve(376),Vy.instance,Za.a.instance.resolve(8),Za.a.instance.resolve(22))).ha();b.ia(939,()=>new fB(Za.a.instance.resolve(921),Za.a.instance.resolve(8),y.AFrameworkApplication.va)).ha();b.ia(936,()=>new Gz.a(b.resolve(922),b.resolve(86),b.Oa(118),b.Oa(22),Za.a.instance.resolve(101),Za.a.instance.resolve(322),Za.a.instance.resolve(348),Za.a.instance.resolve(384),Za.a.instance.resolve(8),Za.a.instance.resolve(392),Za.a.instance.resolve(18),
Za.a.instance.resolve(923),Za.a.instance.resolve(17))).ha();b.ia(1133,()=>new cE(y.AFrameworkApplication.va,Rg.a.instance,()=>Za.a.instance.resolve(924))).ha();b.ia(933,()=>new In(y.AFrameworkApplication.va,y.AFrameworkApplication.J,zz.GrippersManager.instance,gg.a.instance)).as(73).ha();b.register(Ev,"Box4.VisiMarkersOperation").as(925).ha();b.ia(1136,()=>new qG(y.AFrameworkApplication.va,b.resolve(925),b.resolve(926))).ha();b.ia("Box4.Actors.IndentationActorExtension",()=>new DC).as(930).ha();Object(dv.a)()&&
b.register(zv,932).as("Box4.IHighContrastColorPickerState").ha();Object(oG.a)()&&b.ia(931,()=>new dB(iw.a.instance,new Qf.a(()=>qa.StaticActiveAppFrame.za().kb.Jc.od),Ep.a.instance,Qn.a.instance,Za.a.instance.Oa(788),new os(dB.jnb))).ha()}}Object(u.a)(HC,"Box4ActorsComponentConfiguration",null,[1]);var gB=d(209),Hz=d(1061);const IC=()=>{const b=ix;y.AFrameworkApplication.va.qa(ub.a.Zxf,lc.a.Pob,b);y.AFrameworkApplication.va.qa(ub.a.Zxf,lc.a.dic,b);y.AFrameworkApplication.va.qa(ub.a.Yxf,lc.a.Pob,hB);
y.AFrameworkApplication.va.qa(ub.a.Yxf,lc.a.dic,hB)},ix=(b,h,r)=>df.a.KZd?8:2===r?(b=new ni.StandardDialog,b.Fd=4,b.gY(1),b.Qe(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),b.Qe(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),b.GCg(Box4Intl.Box4Strings.l_DownloadEmbeddedFileTitle,Box4Intl.Box4Strings.l_DownloadEmbeddedFileMessage,rG),32):2,rG=b=>{1===b&&y.AFrameworkApplication.va.Ob(ub.a.Yxf,2)},hB=(b,h,r)=>{if(df.a.KZd)return 8;if(1===r)return h.node.hasProperty(He.a.CNb)?32:2;if(2===
r&&(h.contextId===lc.a.view&&h.view.mb&&(h=h.view.mb.Mg),gB.isEmbeddedFileOrFloatingEmbeddedFileContext(h))){b=Hz.a.Dpm(h.node);Jc.a.pXo();try{JC(b)}catch(A){v.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",A)}}return 32},JC=b=>{Le.a.un(b,void 0,void 0,"EmbeddedFileActor.SaveFile")};var Iz=d(782);class Tq{constructor(b){this.mJ=null;this.zSc=(h,r,A,M,aa)=>{if(1===A)return 32;if(2===A&&!aa)return 8;this.FTe.y$d=!this.FTe.y$d;h=Tq.pj.ZPb(r);r=new Iz.a;A=null;32===y.AFrameworkApplication.va.Pb(ub.a.lZa,
2,r)&&r&&(A=r.fontColor);M="";A&&!r.yOb&&(M=Ol.a.BB(A)||"");this.Z2d.gca=M;this.HP.kAc(M);h=this.Z2d.Opb(h,df.a.VTa);if(!h)return 8;aa.MenuItems=h;v.ULS.sendTraceTag(595153826,340,50,"Font color dropdown menu is opened.");return 32};this.Lhd=(h,r,A,M,aa)=>{if(1===A)return 32;if(!aa)return 8;aa[Vg.a.On]=this.FTe.y$d;return 32};this.E3=(h,r,A,M,aa)=>{if(1===A)return 32;y.AFrameworkApplication.va.Pb(ub.a.lZa,2,aa);h=aa&&0<=aa.fontColor&&16777215>=aa.fontColor?aa.fontColor:0;qa.StaticActiveAppFrame.za().dismissFloatie();
(new Xt(Tq.jnb,ub.a.nva)).zyb(h);return 32};this.pXb=(h,r,A,M,aa)=>{if(1===A)return 32;if(2===A&&!aa)return 8;h=Tq.pj.ZPb(r);r=new Iz.a;A=null;32===y.AFrameworkApplication.va.Pb(ub.a.lZa,2,r)&&r&&(A=r.fontColor);M="";A&&!r.yOb&&(M=Ol.a.BB(A)||"");this.Z2d.gca=M;this.HP.kAc(M);h=this.Z2d.Opb(h,df.a.VTa);if(!h)return 8;aa.MenuItems=h;v.ULS.sendTraceTag(508421139,340,50,"Font color dropdown menu is opened.");return 32};this.z_e=b}get Z2d(){this.mJ||(this.mJ=new os(Tq.jnb),this.Ffa(this.mJ));return this.mJ}Ffa(b){Object(dv.a)()&&
b.BG(7,ub.a.zSc);b.BG(1,ub.a.Oja);b.BG(3,ub.a.Zw);b.BG(4,ub.a.Zw);b.BG(5,ub.a.nva);b.BG(6,ub.a.E3);b.C5a(this.z_e,1)}Xb(b){const h=y.AFrameworkApplication.va;Object(dv.a)()&&(this.FTe=b,h.qa(ub.a.zSc,lc.a.view,this.zSc),h.fb(ub.a.Lhd,lc.a.view,this.Lhd,96));h.qa(ub.a.E3,lc.a.view,this.E3);h.qa(ub.a.pXb,lc.a.view,this.pXb);h.Pc(ub.a.pXb,1127)}static Gqm(){return new Tq(iw.a.instance)}static get instance(){return null!=Tq.bYg?Tq.bYg:Tq.bYg=Tq.Gqm()}get HP(){return null!=this.W1g?this.W1g:this.W1g=Za.a.instance.Oa(788)}static get pj(){return Um.PageReader.instance}}
Tq.jnb="Font";Object(u.a)(Tq,"FontColorActor",null,[]);class ay{constructor(b){this.E3=(h,r,A,M,aa)=>{if(1===A)return 32;y.AFrameworkApplication.va.Pb(ub.a.lZa,2,aa);h=aa&&0<=aa.highlight&&16777215>=aa.highlight?aa.highlight:0;qa.StaticActiveAppFrame.za().dismissFloatie();(new Xt("Highlighter",ub.a.mca)).zyb(h);return 32};this.ga=b}Xb(){this.ga.qa(ub.a.doj,lc.a.view,this.E3)}static Bsm(){return new ay(y.AFrameworkApplication.va)}static get instance(){return null!=ay.NYg?ay.NYg:ay.NYg=ay.Bsm()}}Object(u.a)(ay,
"HighlighterColorActor",null,[]);var Jz;(function(b){b.BKp="Heading";b.Bookmark="Bookmark";b.Url="Url";b.CMp="RecentLinks"})(Jz||(Jz={}));Object(u.b)("InsertLinkUserActivitySource",Jz);class sG{constructor(b,h,r,A,M){this.linkurl=b;this.isHeading=h;this.startCp=r;this.endCp=A;this.paragraphNode=M}}Object(u.a)(sG,"HeadingDataForLinkDialog",null,[]);class fv{constructor(b,h){this.linkurl=b;this.isHeading=h}}Object(u.a)(fv,"BookmarkDataForLinkDialog",null,[]);class Kz{constructor(b,h,r,A,M,aa){this.key=
b;this.name=h;this.startIndex=r;this.count=A;this.level=M;this.isCollapsed=aa}}Object(u.a)(Kz,"GroupHeaderDataForLinkDialog",null,[]);class yu{constructor(b,h){this.selectedIndex=b;this.selectedGroupId=h}}Object(u.a)(yu,"SelectedItemFromLinkDialogGroupedList",null,[]);class KC{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb){this.Ur=b;this.rd=h;this.IUl=r;this.bookmarkManager=A;this.X2=M;this.Jp=aa;this.Fg=oa;this.Od=Ja;this.Mj=fb;this.Zk=Cb;this.EBa=Gb;this.GOb=null;this.KVi=!1;this.IUf=(zc,Yc)=>{var Kd;
if(this.ne.mw){var ke=Nc.a.N3c(this.Ur),ge=this.ne.mb.gb.currentSelection;if(ge){ge=ge.Qa;Gd.ParagraphReader.fn(ge)&&(ge=wc.a.createTextRange(ge.node,0,Gd.ParagraphReader.textLength(ge.node)));var de=ze.a.H1b(ge);ze.a.Zl(de)&&(ge=de);if(0!==zc&&32===y.AFrameworkApplication.va.Nf(ge,ub.a.GR,1,!0,null,null)&&this.Ur.equals(ge)){db.a.mark(5562);(null===(Kd=Of.a.ud())||void 0===Kd?0:Kd.Co)&&this.ne.mb.Bbc();zc=new Rb.GraphTransaction(15);zc.Bb(this.Ur.node);this.Ur.node.sL().YG.S$(4);Kd=Yc.txtDisplay;
ge=!1;if(null!=Yc.linkurl)if(ge=!0,Yc.isHeading){m(this.rd,"Heading");de=Yc.paragraphNode;const Sd=Yc.startCp,be=Yc.endCp;Yc=this.bookmarkManager.Ggm(de);this.bookmarkManager.sRc(Yc,Sd,be,de,de,!1)}else m(this.rd,"Bookmark"),Yc=Yc.linkurl;else m(this.rd,"Url"),Yc=Yc.txtLink.trim();this.PRb(Kd,Yc,ke,ge);zc.Ii=ub.a.GR;zc.dispose();db.a.mark(5563);this.Ur.node.Zob()}else this.ne.L8()}else v.ULS.sendTraceTag(509372371,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}};this.ne=
Object(Lb.a)().Ad;this.Ur=b;r=ze.a.H1b(this.Ur);ze.a.Zl(r)&&(this.Ur=r);const Sb=new ig.a(!1,!1,!0);r=this.Krm();A={["displayTextLabel"]:Box4Intl.Box4Strings.l_InsertLinkDisplayText,["addressLabel"]:Box4Intl.Box4Strings.l_InsertLinkAddress,["insertInternalLinkEnabled"]:!0,["enterLinkTabLabel"]:Box4Intl.Box4Strings.l_EnterLinkText,["thisDocumentTabLabel"]:Box4Intl.Box4Strings.l_ThisDocumentText,["groupedList"]:r};M=this.GOb="";M=Gd.ParagraphReader.text(this.Ur.node);oa=this.Ur.cpBegin;Ja=this.Ur.cpEnd;
({rwg:M,$Af:oa,aBf:Ja,FSf:aa}=this.anm(M));if((h="object"===typeof h?h:null)&&(h.Source&&"CommandingInterface"===h.Source||h.Url&&h.DisplayText))this.PRb(h.DisplayText,h.Url,aa);else{aa[0]&&this.S1l(oa,Ja,aa[0].paragraph);h=""===M.trim()?Box4Intl.Box4Strings.l_InsertLinkButtonText:CommonUIStrings.l_DialogOk;Sb.Qe(1,h);(null===M||void 0===M?0:M.startsWith(I.a.umb))?(h=this.kHm(M,r))?r.selectedItem=h:A.txtLink=M:A.txtLink=M;A.txtDisplay=this.GOb;1>=aa.length&&this.X2.bxl(b,aa[0],1===aa.length)&&(this.KVi=
!0,A.textDisplayDisabled=!0);var pc={["id"]:"InsertLinkDialog",["bodyControls"]:A};this.Zk.$d(()=>{Sb.mi(Box4Intl.Box4Strings.l_InsertLinkTitle,this.IUf,pc)},"RILD:IAS")}}anm(b){const h=Nc.a.N3c(this.Ur);let r=this.Ur.cpBegin,A=this.Ur.cpEnd,M="";if(!h.length)return this.GOb=b.substring(this.Ur.cpBegin,this.Ur.cpEnd),{returnValue:!0,rwg:M,$Af:r,aBf:A,FSf:h};if(h[0].hyperlink){let aa,oa=0,Ja=Math.max(0,b.length-1),fb=0;for(let Cb=0;Cb<h.length;Cb++)h[Cb].cpBegin>=oa&&({cpBegin:aa,cpEnd:oa}=this.X2.Xka(this.Ur,
h[Cb]),Ja=Math.min(aa,Ja),fb=Math.max(oa,fb));r=Math.min(Ja,r);A=Math.max(fb,A);this.GOb=b.substring(r,A);r===Ja&&(M=h[0].hyperlink.url);return{returnValue:!0,rwg:M,$Af:r,aBf:A,FSf:h}}return{returnValue:!1,rwg:M,$Af:r,aBf:A,FSf:h}}S1l(b,h,r){if(h!==this.Ur.cpEnd||b!==this.Ur.cpBegin)b=sc.SelectionFactory.cL(r,b,h),this.ne.mb.Kc(b),this.Ur=ze.a.H1b(b.Qa.clone())}Ajp(b,h,r,A,M,aa=!1){A?(A=wc.a.createTextRange(this.Ur.node,this.Ur.cpBegin,this.Ur.cpBegin+b.length),this.Jp.GWl(A,r,h),b=sc.SelectionFactory.ue(this.Ur.node,
this.Ur.cpBegin+b.length)):(this.Jp.Wub(this.Ur,2),this.Mj.kyb(this.Ur,2),r=wc.a.Tc(this.Ur.node,this.Ur.cpEnd),this.Fg.Ve(r,b,!0),A=wc.a.createTextRange(this.Ur.node,this.Ur.cpEnd,this.Ur.cpEnd+b.length),this.Jp.qF(A,h,M,!1,!0,aa),b=sc.SelectionFactory.ue(this.Ur.node,this.Ur.cpEnd+b.length));b&&this.ne.mb.Kc(b)}PRb(b,h,r,A=!1){var M=null;b||(b=h,y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveLinkUrlLineBreak",!0)&&(b=b.replace(/[\r\n\v]/g,"")));if(h&&(!r.length||
h!==r[0].hyperlink.url)&&!A){h=Nc.a.uKa(h);var aa="";this.EBa&&({Cqg:aa}=this.EBa.iJg(h)).returnValue&&(h=aa)}this.KVi||(b=this.Jp.KAo(b));aa=!1;if(h){M=0<r.length;const oa=Gd.ParagraphReader.text(this.Ur.node).substring(this.Ur.cpBegin,this.Ur.cpEnd)!==b,Ja=this.Od.Lg;if(Ja&&1===r.length&&!r[0].hyperlink.sI&&!(r[0].cpBegin>this.Ur.cpBegin&&r[0].cpEnd<=this.Ur.cpEnd)){this.Ajp(b,h,r[0].hyperlink,!oa,M,A);return}if(M)for(let fb=0;fb<r.length;fb++)r[fb].hyperlink.sI&&(aa=!0),this.Jp.cV(this.Ur.node,
r[fb].hyperlink,!1);oa?this.Fg.Ve(this.Ur,b,!aa):Ja&&!aa&&this.Mj.kyb(this.Ur,1);r=wc.a.createTextRange(this.Ur.node,this.Ur.cpBegin,this.Ur.cpBegin+b.length);this.Jp.qF(r,h,M,aa,!0,A);M=sc.SelectionFactory.ue(this.Ur.node,this.Ur.cpBegin+b.length)}else 0<r.length&&(b=r[0],b.hyperlink.sI&&(aa=!0),this.Jp.cV(b.paragraph,b.hyperlink));aa&&this.Od.Yu(aa?2:7);M&&this.ne.mb.Kc(M);df.a.Wkp()}kHm(b,h){h=h.items;const r=b.substring(I.a.umb.length),A=this.bookmarkManager.jCi(r);b=-1;let M=0;for(let aa=0;aa<
h.length;aa++)if(h[aa].isHeading&&0!=A.count&&h[aa].paragraphNode.id==A.K(0).id){b=aa;break}else if(!h[aa].isHeading&&h[aa].linkurl==r){b=aa;M=1;break}h=new yu(b,M);return-1!=b?h:null}Krm(){const b={};let h=[],r=0,A=0;var M=this.IUl.nsm();M&&(r=M.count,h=h.concat(this.ssm(M)));if(M=this.bookmarkManager.U3d(!1))A=M.count,h=h.concat(this.Kgm(M));b.groups=this.hsm(r,A);b.items=h;return b}hsm(b,h){const r=[],A=new Kz("ThisDocumentTabHeadings",Box4Intl.Box4Strings.l_InsertLinkHeadings,0,b,0,!0);r.push(A);
b=new Kz("ThisDocumentTabBookmarks",Box4Intl.Box4Strings.l_InsertLinkBookmarks,b,h,0,!0);r.push(b);return r}ssm(b){const h=[],r=/\uFFFC/;for(const A of b)b=A.characterData.replace(r," "),b=new sG(b,!0,A.Ec,A.end,A.paragraphNode),h.push(b);return h}Kgm(b){const h=[];for(const r of b)b=r.wf(Mc.a.wu).toString(),b=new fv(b,!1),h.push(b);return h}}Object(u.a)(KC,"ReactInsertLinkDialog",null,[]);class Lz{static get kh(){return ig.a.Ry(Lz.Hn,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)}}
Lz.Hn="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(u.a)(Lz,"InsertLinkDialogHtml",null,[]);class gn extends ig.a{constructor(b){super();this.jme=
()=>{const h=document.getElementById("txtLink");this.iva(1,!h||!h.value.length||Nc.a.AXa(h.value))};this.IUf=(h,r)=>{if(this.yh.mw){var A=this.yh.mb.gb.currentSelection;if(A)if(A.equals(this.Iy)&&0!==h){h=new Rb.GraphTransaction(15);h.Bb(this.jW[0].node);for(A=0;A<this.jW.length;A++)this.jW[A].node.sL().YG.S$(4);A=r.txtLink.trim();r=this.qNl();A=this.w7m(A);(r||A)&&gn.Od.Yu(7);this.hide();h.dispose()}else this.yh.L8()}};this.jW=b;this.yh=Object(Lb.a)().Ad;this.Iy=this.yh.mb.gb.currentSelection;this.OCf=
b[0].cpBegin;this.M1f=b[b.length-1].cpEnd;this.Ng="InsertMultiParagraphLinkDialog";b=this.Xsp();this.showDialog("",b)}showDialog(b,h){v.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");this.kh=Lz.kh;""===h.trim()&&this.Qe(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);this.mi(Box4Intl.Box4Strings.l_InsertLinkTitle,this.IUf,{["txtLink"]:h,["txtDisplay"]:b});document.getElementById("txtLink").focus();document.getElementById("txtDisplay").disabled=!0;gn.oYf&&(b=document.getElementById("txtLink"),
mf.a.addHandler(b,Jd.a.input,this.jme),mf.a.addHandler(b,Jd.a.lUc,this.jme))}hide(){if(gn.oYf){const b=document.getElementById("txtLink");b&&(mf.a.removeHandler(b,Jd.a.lUc,this.jme),mf.a.removeHandler(b,Jd.a.input,this.jme))}super.hide()}$za(b){return gn.oYf?this.yhm(this.bFc)?super.$za(b):!1:super.$za(b)}Xsp(){let b;var h="";const r=this.jW.length,A=Nc.a.KA(this.jW[0],!1);0<A.length&&({cpBegin:M,cpEnd:b}=gn.X2.Xka(this.jW[0],A[0]),M<=this.jW[0].cpBegin&&(h=A[0].hyperlink.url),this.OCf=Math.min(this.OCf,
M));var M=Nc.a.KA(this.jW[r-1],!1);0<M.length&&({cpBegin:M,cpEnd:b}=gn.X2.Xka(this.jW[r-1],M[M.length-1]),this.M1f=Math.max(this.M1f,b));this.Ilp(this.OCf,this.M1f);return h}Ilp(b,h){const r=this.jW.length;if(b!==this.jW[0].cpBegin||h!==this.jW[r-1].cpEnd){b=wc.a.Tc(this.jW[0].node,b);b=sc.SelectionFactory.Qo(b);h=wc.a.Tc(this.jW[r-1].node,h);h=sc.SelectionFactory.Qy(b,h);b=this.oHi(h.Qa.clone());const A=this.oHi(h.Wc.clone());b&&A&&(this.jW[0]=b,this.jW[r-1]=A,this.yh.mb.Kc(h),this.Iy=h)}}w7m(b){if(!b)return!1;
b=Nc.a.uKa(b);for(let r=0;r<this.jW.length;r++){var h=this.jW[r];if(gn.Lya&&ze.a.Zl(h)&&(h=ze.a.dJg(h),!ze.a.Zl(h)))continue;h=wc.a.createTextRange(this.jW[r].node,h.cpBegin,h.cpEnd);this.ilp(h);gn.Jp.qF(h,b,!1)}return!0}ilp(b){gn.Od.z1j(b)}oHi(b){return Gd.ParagraphReader.fn(b)&&!ze.a.bba(b)&&Gd.ParagraphReader.textLength(b.node)?wc.a.createTextRange(b.node,0,Gd.ParagraphReader.textLength(b.node)):ze.a.Zl(b)?b:null}qNl(){let b=!1;for(const h of this.jW){const r=Nc.a.KA(h,!1);r&&(b=gn.X2.IAj(h,r)||
b)}return b}static get X2(){return null!=gn.jXg?gn.jXg:gn.jXg=Za.a.instance.resolve(242)}static get Od(){return null!=gn.P4g?gn.P4g:gn.P4g=Za.a.instance.resolve(46).instance}static get Jp(){return null!=gn.aXg?gn.aXg:gn.aXg=Za.a.instance.resolve(82)}static get Lya(){null==gn.Pca&&(gn.Pca=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return gn.Pca}static get oYf(){null==gn.kWe&&(gn.kWe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("HyperlinkUrlValidationIsEnabled"):
!1);return gn.kWe}}gn.Pca=null;gn.kWe=null;Object(u.a)(gn,"InsertMultiParagraphLinkDialog",ig.a,[]);class Hf{static get rg(){return re.a.instance}static get A6(){return null!=Hf.fTg?Hf.fTg:Hf.fTg=Za.a.instance.Oa(22)}static get X2(){return null!=Hf.kXg?Hf.kXg:Hf.kXg=Za.a.instance.resolve(242)}static ly(){return Hf.Sn||(Hf.Sn=Za.a.instance.Ra(51))}static get Od(){return null!=Hf.$4g?Hf.$4g:Hf.$4g=Za.a.instance.resolve(46).instance}static get ti(){return null!=Hf.f5g?Hf.f5g:Hf.f5g=Za.a.instance.resolve(180).instance}static get Dc(){return Rg.a.instance}static get Ycd(){null==
Hf.QAb&&(Hf.QAb=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("MultiParagraphHyperlinkEditEnabled"):!1);return Hf.QAb}static get Lya(){null==Hf.Pca&&(Hf.Pca=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Hf.Pca}static get Jp(){return null!=Hf.gXg?Hf.gXg:Hf.gXg=Za.a.instance.resolve(82)}static get Fg(){return null!=Hf.USg?Hf.USg:Hf.USg=Za.a.instance.resolve(322)}static get hab(){Hf.JWe||(Hf.JWe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("IsO365CommercialHost")||
y.AFrameworkApplication.J.$("IsO365ConsumerHost"):!1);return Hf.JWe}static get Sgp(){Hf.EGh||(Hf.EGh=y.AFrameworkApplication.J?y.AFrameworkApplication.J.ic("WordRecentLinksTimeInMsBetweenTwoMruCalls",6E4):6E4);return Hf.EGh}static Xb(){const b=y.AFrameworkApplication.va;b.qa(ub.a.GR,lc.a.view,Hf.nRb);b.qa(ub.a.GR,lc.a.Xc,Hf.PRb);b.qa(ub.a.GR,lc.a.Cd,Hf.PRb);b.Pc(ub.a.GR,1028);b.qa(ub.a.Rgc,lc.a.view,Hf.nRb);b.qa(ub.a.Rgc,lc.a.Xc,Hf.PRb);b.qa(ub.a.Rgc,lc.a.Cd,Hf.PRb);b.Pc(ub.a.Rgc,1028);b.qa(ub.a.cV,
lc.a.view,Hf.nRb);b.qa(ub.a.cV,lc.a.Xc,Hf.SAj);b.qa(ub.a.cV,lc.a.Cd,Hf.SAj);b.Pc(ub.a.cV,1028);b.qa(ub.a.uve,lc.a.view,Hf.nRb);b.qa(ub.a.uve,lc.a.Xc,Hf.XIj);b.qa(ub.a.uve,lc.a.Cd,Hf.XIj);b.qa(ub.a.$bb,lc.a.view,Hf.nRb);b.qa(ub.a.$bb,lc.a.Xc,Hf.foj);b.qa(ub.a.$bb,lc.a.Cd,Hf.foj);b.qa(ub.a.$bb,lc.a.image,Hf.Qgg);b.qa(ub.a.$bb,lc.a.sOb,Hf.Qgg);b.qa(ub.a.$bb,lc.a.I$,Hf.Qgg);b.qa(ub.a.RUc,lc.a.application,Hf.RUc);b.qa(ub.a.fXd,lc.a.view,Hf.nRb);Hf.hab&&(b.fb(Ka.a.Pcb,lc.a.view,this.nRb.bind(this),1028),
b.qa(Ka.a.Pcb,lc.a.Xc,this.Pcb.bind(this)),b.qa(Ka.a.Pcb,lc.a.Cd,this.Pcb.bind(this)),b.Pc(Ka.a.Pcb,1028),b.qa(Ka.a.JUf,lc.a.Xc,this.Pcb.bind(this)),b.qa(Ka.a.JUf,lc.a.Cd,this.Pcb.bind(this)),b.Pc(Ka.a.JUf,1028),b.qa(Ka.a.qkg,lc.a.view,this.qkg.bind(this)),b.qa(Ka.a.jkg,lc.a.view,this.jkg.bind(this)),b.fb(Ka.a.gsb,lc.a.Xc,this.gsb.bind(this),1028),b.fb(Ka.a.gsb,lc.a.Cd,this.gsb.bind(this),1028))}static RUc(){return 32}static Pcb(b,h,r){if(!Hf.hab)return 2;b=Hf.r9j(h);if(32!=b)return b;if(!Hf.zXa(h,
!0).returnValue||Hf.Rec(h))return 8;1!==r||Hf.Eni||(Hf.nEe(!0),Hf.Eni=!0);return 32}static qkg(b,h,r,A,M){if(!Hf.hab)return 2;if(1===r)return 32;Hf.wse(Hf.RGk,Hf.SGk,Hf.Qzh);er.a.instance.$d(()=>{Hf.nEe();M.MenuItems=Object.assign(new aj.a,{Id:"RecentLinksList",MenuSectionList:[],UpdateDynamically:!0});const aa=this.c$h();aa?(v.ULS.sendTraceTag(526242130,324,50,"Recent Links data load success in ribbon"),M.MenuItems.MenuSectionList.push(aa)):Hf.gsj(M,Hf.Qzh)},"HA:PRLF");return 32}static jkg(b,h,r,
A,M){if(!Hf.hab)return 2;if(1===r)return 32;Hf.wse(Hf.PGk,Hf.QGk,Hf.Pzh);er.a.instance.$d(()=>{Hf.nEe();M.MenuItems=Object.assign(new aj.a,{Id:"InsertLinkFlyoutList",MenuSectionList:[],UpdateDynamically:!0});M.MenuItems.MenuSectionList.push(this.sEl());const aa=this.c$h(!0);aa?(v.ULS.sendTraceTag(526242132,324,50,"Recent Links data load success in context menu"),M.MenuItems.MenuSectionList.push(aa)):Hf.gsj(M,Hf.Pzh)},"HA:PILF");return 32}static gsj(b,h){v.ULS.sendTraceTag(524911777,324,50,"Recent Links could not load in "+
h);Hf.wse(Hf.wDk,Hf.xDk,h);b.MenuItems.MenuSectionList.push(this.VGl());Hf.nEe(!0)}static VGl(){const b=this.atf("RecentLinksNoDataSection",!1);b.ControlList.push(Object.assign(new hk.a,{ExternalId:"RecentLinksNoDataSection",LabelText:Box4Intl.Box4Strings.l_RecentLinksErrorString}));return b}static sEl(){const b=this.atf("InsertLinkSection");b.ControlList.push(Object.assign(new hk.a,{ExternalId:"InsertLink"}));return b}static c$h(b=!1){if(Ni.instance.NJd){var h=this.atf("RecentLinksSection",b);b=
JSON.parse(Ni.instance.NJd);this.MJd.clear();b.forEach((r,A)=>{this.MJd.set(A,[r.FileName,r.DocumentUrl]);const M=Hf.cFm(r.FileName);var aa=Hf.grm(r.TimeStamp),oa=h.ControlList,Ja=oa.push,fb=Object,Cb=fb.assign,Gb=new hk.a,Sb=Ka.a.gsb,pc=Ka.a.gsb;aa=M!==r.FileName?r.FileName+"\n"+aa:aa;var zc=r.FileName;let Yc="SaveAsWordDocx_32";switch(r.App){case "Word":Yc="SaveAsWordDocx_32";break;case "PowerPoint":Yc="SaveAsPowerPointPptx_32";break;case "Excel":Yc="SaveAsExcelXlsx_32"}Ja.call(oa,Cb.call(fb,Gb,
{ExternalId:A,Command:Sb,CommandValueId:pc,LabelText:M,Alt:aa,AriaDescription:zc,ExternalImageId:Yc,KeyTip:r.FileName}))});return h}}static atf(b,h=!1){return Object.assign(new te.a,{Title:h?Box4Intl.Box4Strings.l_RecentLinks:"",Id:b,DisplayMode:"Menu",ShowMenuSectionSeparator:!1,ControlsId:"Ctrl_"+b,ControlList:[]})}static gsb(b,h,r,A,M){if(!Hf.hab)return 2;if(!M||M.CommandValueId!=Ka.a.gsb)return 32;Hf.wse(Hf.Fxk,Hf.Gxk,Hf.dIk);r=h;h=new Rb.GraphTransaction(15);h.Ii=b;h.Bb(r.node);A=Hf.zXa(r,!0).hyperlink;
r=ze.a.H1b(r);if(A)Hf.urg(r),b=sc.SelectionFactory.cL(r.node,Math.min(r.cpBegin,A.cpBegin),Math.max(r.cpEnd,A.cpEnd)),gg.a.instance.Kc(b),r=b.Qa;else if(ze.a.pf(r)){var aa;ze.a.ptb(r)&&(aa=ze.a.Q6(r,!1));aa||(aa=this.MJd.get(M.SourceControlId)[0],Hf.Fg.Ve(r,aa,!0,void 0,b),aa=sc.SelectionFactory.cL(r.node,r.cpBegin,r.cpBegin+aa.length));if(aa&&(gg.a.instance.Kc(aa),r=aa.Qa,Hf.Rec(r)))return Hf.Od.n0b(!1),8}try{Hf.Jp.qF(r,this.MJd.get(M.SourceControlId)[1],0<Nc.a.N3c(r).length);const oa=sc.SelectionFactory.ue(r.node,
r.cpEnd);oa&&gg.a.instance.Kc(oa);m(M,"RecentLinks")}finally{h&&h.dispose()}v.ULS.sendTraceTag(526242134,324,50,"Recent Links inserted");return 32}static nRb(b,h,r,A,M){if(Hf.Ycd)return Hf.y_m(b,h,r,A,M);if(!h.view.te)return 2;var aa=h.view.mb;if(!aa||!aa.gb||!aa.gb.length)return 8;var oa=aa.gb.currentSelection;let Ja=oa.Qa.clone();if(2===oa.length){if(oa=oa.K(1),!ze.a.Zl(Ja)||!ze.a.ll(oa)||Ja.node!==oa.node)return 8}else if(2<oa.length)return 8;if(aa.gb.FL)return 8;if(Object(Al.a)().NEa(Gd.ParagraphReader.qX,
aa.Mg))return Hf.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.QQ}),8;Gd.ParagraphReader.fn(Ja)&&!ze.a.bba(Ja)&&(aa=Ja.node,Ja=wc.a.createTextRange(aa,0,Gd.ParagraphReader.textLength(aa)));return b===ub.a.fXd?Hf.c7h(h,Ja,r,A):y.AFrameworkApplication.va.Nf(Ja,b,r,!0,A,M)}static y_m(b,h,r,A,M){if(!h.view.te)return 2;var aa=h.view.mb;if(!aa||!aa.gb||!aa.gb.length||aa.gb.FL)return 8;var oa=aa.gb.currentSelection;if(aa=Hf.L_f(oa))oa=Hf.JNf(oa.Qa.clone(),!0);else{let Ja=oa.K(0).clone(),fb=1;for(;fb<oa.length&&(!Gd.ParagraphReader.textLength(Ja.node)||
ze.a.ll(Ja)||Hf.Lya&&cn.l(Ja));)Ja=oa.K(fb).clone(),fb++;oa=Hf.JNf(Ja,!1)}return Hf.Lya&&ze.a.Zl(oa)&&cn.l(oa)||!ze.a.Zl(oa)&&!aa?8:b===ub.a.fXd?Hf.c7h(h,oa,r,A):y.AFrameworkApplication.va.Nf(oa,b,r,!0,A,M)}static L_f(b){if(1===b.length)return!0;if(2===b.length){const h=b.Qa.clone();b=b.K(1);return ze.a.Zl(h)&&ze.a.ll(b)&&h.node===b.node?!0:!1}return!1}static l4h(b){let h=null;const r=[];for(let A=0;A<b.length;A++){const M=Hf.JNf(b.K(A).clone(),!1);if(ze.a.Zl(M))Hf.Lya&&cn.l(M)||r.push(M);else if(!ze.a.ll(M)&&
!Gd.ParagraphReader.fn(M))return{returnValue:!1,Cnb:h}}h=r;return{returnValue:!Hf.Lya||0<h.length?!0:!1,Cnb:h}}static PRb(b,h,r,A,M){if(Hf.Ycd)return Hf.G7m(h,r,M);A=Hf.r9j(h);if(32!==A)return A;let aa;if(!({hyperlink:aa}=Hf.zXa(h,!0)).returnValue||Hf.Rec(h)||!aa&&b==ub.a.Rgc)return 8;if(1===r)return 32;if(!aa&&ze.a.pf(h)&&ze.a.ptb(h)&&(b=ze.a.Q6(h,!1))&&(gg.a.instance.Kc(b),h=b.Qa,Hf.Rec(h)))return Hf.Od.n0b(!1),8;aa&&v.ULS.sendTraceTag(593875799,324,50,"Edit link");a(h,M);return 32}static r9j(b){return!Hf.KTd(b)||
b.node.zs||gg.a.instance.gb.FL?8:ze.a.t7(b)||Xn.a.UXf(b)?2:32}static G7m(b,h,r){var A=gg.a.instance.gb.currentSelection;const M=Hf.L_f(A);if(M)b=[b];else if(!({Cnb:b}=Hf.l4h(A)).returnValue)return 8;for(A=0;A<b.length;A++)if(!Hf.KTd(b[A]))return 8;if(gg.a.instance.gb.FL)return 8;A=Array(b.length);let aa=null;for(let oa=0;oa<b.length;oa++)if(A[oa]=b[oa],!({hyperlink:aa}=Hf.zXa(A[oa],!0)).returnValue||Hf.Rec(A[oa]))return 8;if(1===h)return 32;if(!aa&&1===A.length&&M&&ze.a.pf(A[0])&&ze.a.ptb(A[0])&&
(h=ze.a.Q6(A[0],!1))&&(gg.a.instance.Kc(h),A[0]=h.Qa,Hf.Rec(A[0])))return Hf.Od.n0b(!1),8;M?a(A[0],r):new gn(A,r);return 32}static SAj(b,h,r){if(Hf.Ycd)return Hf.Lvo(b,h,r);if(!Hf.KTd(h)||ze.a.t7(h))return 2;let A;if(!({hyperlink:A}=Hf.zXa(h,!1)).returnValue)return 2;if(2===r){r=new Rb.GraphTransaction(15);try{r.Ii=b,r.Bb(A.paragraph),Hf.urg(h)}finally{r&&r.dispose()}A.hyperlink.sI&&Hf.Od.Yu(2)}return 32}static Lvo(b,h,r){var A=gg.a.instance.gb.currentSelection;if(Hf.L_f(A))h=[h];else if(!({Cnb:h}=
Hf.l4h(A)).returnValue)return 8;for(A=0;A<h.length;A++)if(!Hf.KTd(h[A]))return 8;if(1===r&&!Hf.zXa(h[0],!1).returnValue)return 2;if(2===r){for(r=0;r<h.length;r++)if(!Hf.zXa(h[r],!0).returnValue)return 2;r=new Rb.GraphTransaction(15);try{const M=h[0];r.Ii=b;r.Bb(M.node);for(b=0;b<h.length;b++)Hf.urg(h[b])}finally{r&&r.dispose()}Hf.Od.Yu(7)}return 32}static urg(b){const h=Nc.a.N3c(b);let r=0;for(let A=0;A<h.length;A++)if(h[A].cpBegin>=r){const M=({cpEnd:r}=Hf.X2.Xka(b,h[A])).returnValue;Hf.X2.IAj(b,
M)}}static XIj(b,h,r){if(Uc.ImageReader.B$a(h)||!({hyperlink:b}=Hf.zXa(h,!1)).returnValue)return 2;if(2===r){const {cpBegin:A,cpEnd:M}=Hf.X2.Xka(h,b);gg.a.instance.Kc(sc.SelectionFactory.cL(b.paragraph,A,M))}return 32}static foj(b,h,r){if(({hyperlink:b}=Hf.Sqn(h)).returnValue)v.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");else if(!({hyperlink:b}=Hf.zXa(h,!1)).returnValue)return 2;2===r&&df.a.gic(b.hyperlink.url);return 32}static Qgg(b,h,r){b=Uc.ImageReader.Xka(h.node);
if(!b)return 2;2===r&&df.a.gic(b);return 32}static c7h(b,h,r,A){if(Uc.ImageReader.B$a(h)||!Object(Lb.a)().Le.qk)return 2;let M;if(!({hyperlink:M}=Hf.zXa(h,!1)).returnValue)return 2;if(1===r)return 32;const {cpBegin:aa,cpEnd:oa}=Hf.X2.Xka(h,M);gg.a.instance.Kc(sc.SelectionFactory.cL(M.paragraph,aa,oa));h=Object(Lb.a)().qIa.ownerDocument.createElement("span");h.innerText=M.hyperlink.url;h.style.backgroundColor="rgb(255, 255, 255)";return y.AFrameworkApplication.va.Nf(b,ub.a.eXd,2,!0,A,h)}static zXa(b,
h){if(ze.a.Zl(b)){const r=cn.g(b),A=Oe.a.all(r,M=>6===M.Qh);if(0<r.length&&(!Hf.Lya||!A)||Hf.rg.Mh&&Hf.A6&&0<Hf.A6.M4d(b).count)return{returnValue:!1,hyperlink:null}}return Hf.Hqn(b,h)}static Sqn(b){let h=null;return Uc.ImageReader.B$a(b)&&(h=Nc.a.Bjc(b))?{returnValue:!0,hyperlink:h}:{returnValue:!1,hyperlink:h}}static Hqn(b,h){let r=null;const A=Nc.a.N3c(b);return A.length?A[0].hyperlink?(r=A[0],b.cpBegin<A[0].cpBegin?{returnValue:h,hyperlink:r}:{returnValue:!0,hyperlink:r}):{returnValue:!1,hyperlink:r}:
{returnValue:h,hyperlink:r}}static Rec(b){b=Hf.ti.E9a(b.node,b.cpBegin,b.cpEnd);for(let h=0;h<b.count;++h)if(2===b.K(h).Pd.changeType)return!0;return!1}static KTd(b){return Hf.rg.q2(b)||Hf.rg.Nla(b)||Hf.ly()&&Hf.ly().instance&&Hf.ly().instance.sX(b)?!1:!0}static JNf(b,h){return Gd.ParagraphReader.fn(b)&&!ze.a.bba(b)&&(Gd.ParagraphReader.textLength(b.node)||h)?wc.a.createTextRange(b.node,0,Gd.ParagraphReader.textLength(b.node)):b}static cFm(b){return b&&b.length<=Hf.mxj?b:b.substring(0,Hf.mxj)+"..."}static grm(b){try{const h=
new Date(b);return String.format(Box4Intl.Box4Strings.l_RecentLinksTimeSeparator,h.toLocaleString(void 0,{weekday:"long"}),h.toLocaleString(void 0,{hour:"numeric",minute:"numeric"}))}catch(h){return""}}static nEe(b=!1){const h=Date.now();if(b||h-Hf.U3i>Hf.Sgp)Ni.instance.QEn(),Hf.U3i=h}static wse(b,h,r){const A=new Map;A.set("Source",r);A.set("Action",h);Ba.Health.instance.recordKpiUsage(b,0,this.k2a,A)}}Hf.Sn=null;Hf.QAb=null;Hf.Pca=null;Hf.MJd=new Map;Hf.JWe=null;Hf.mxj=35;Hf.U3i=Date.now();Hf.Eni=
!1;Hf.k2a="wwaengidc";Hf.dIk="RecentLinks";Hf.Qzh="RecentLinksRibbonOptions";Hf.Pzh="RecentLinksContextMenuOptions";Hf.RGk="PopulateRecentLinksRibbon";Hf.SGk="PopulateRecentLinksRibbonAction";Hf.PGk="PopulateRecentLinksContextMenu";Hf.QGk="PopulateRecentLinksContextMenuAction";Hf.wDk="PopulateRecentLinksContextMenu";Hf.xDk="PopulateRecentLinksContextMenuAction";Hf.Fxk="InsertRecentLinks";Hf.Gxk="InsertRecentLinksAction";Object(u.a)(Hf,"HyperlinkActor",null,[]);class by{}by.Gab=Object.freeze({P1m:"WordIndentationShortcutUsage"});
by.NB="wwaengidc";Object(u.a)(by,"IndentationConstants",null,[]);class kt{static get Ztn(){return kt.pFd}static nBl(b,h,r){try{kt.pFd=kt.wFl(b,h,r)}catch(A){kt.pFd=null,v.ULS.cA(539787540,393,10,A,"Error in creating autoTriggerTextContext: {0}",A instanceof Error?A.message:"Unknown Error")}}static HEj(){kt.pFd=null}static wFl(b,h,r){if(!of.ListItemReader.Cg(h))throw v.ULS.sendTraceTag(539787541,393,10,"Given iterator should be at a ListOutlineElement"),Error("Given iterator should be at a ListOutlineElement");
const A=of.ListItemReader.g7(h);if(null===A||void 0===A||!A.id)throw v.ULS.sendTraceTag(539787542,393,10,"No list item node with id found under outline element"),Error("No list item node with id found under outline element");h=r.Pw(h);if(!h)throw v.ULS.sendTraceTag(539787543,393,10,"No listInfo found for given iterator"),Error("No listInfo found for given iterator");return new kt(b,A.id,h)}constructor(b,h,r){this.o1j=b;this.Lwn=h;this.Hqg={listType:r.listType,listStyle:r.listStyle,Wge:r.Bx}}Lmn(b,
h){return h&&b&&this.Lwn===b.id&&h.listType===this.Hqg.listType&&h.listStyle===this.Hqg.listStyle&&h.Bx===this.Hqg.Wge}}kt.pFd=null;Object(u.a)(kt,"AutoTriggerTextContext",null,[]);var zu;(function(b){b[b.none=0]="none";b[b.hbp=1]="style1";b[b.ibp=2]="style2";b[b.jbp=3]="style3";b[b.kbp=4]="style4";b[b.lbp=5]="style5";b[b.Hdc=6]="bullet";b[b.invalid=42]="invalid"})(zu||(zu={}));Object(u.b)("ListStyle",zu);const jx={[zu.hbp]:{[1]:"disc",[0]:"decimal"},[zu.ibp]:{[1]:"circle",[0]:"lower-alpha"},[zu.jbp]:{[1]:"square",
[0]:"lower-roman"},[zu.kbp]:{[0]:"upper-alpha"},[zu.lbp]:{[0]:"upper-roman"},[zu.Hdc]:{[1]:"bullet"}};var lt;(function(b){b[b.number=0]="number";b[b.Hdc=1]="bullet";b[b.lim=13]="lim";b[b.nil=14]="nil";b[b.any=15]="any";b[b.M$p=16]="noList";b[b.invalid=42]="invalid"})(lt||(lt={}));Object(u.b)("ListType",lt);class Yk{constructor(b,h){this.YA=this.Had=null;this.levelText=b;this.font=h}get Tpe(){return this.levelText}get listStyle(){return 6}get Ax(){return"left"}}Object(u.a)(Yk,"ListMarkerBullet",null,
[282]);class Bi{static get $l(){return null!=Bi.z_g?Bi.z_g:Bi.z_g=Za.a.instance.resolve(32)}static get Md(){return Bi.jg||(Bi.jg=Za.a.instance.resolve(10))}static set Md(b){Bi.jg=b}static get pk(){return null!=Bi.wXg?Bi.wXg:Bi.wXg=Za.a.instance.resolve(106)}static ly(){return Bi.Sn||(Bi.Sn=Za.a.instance.Ra(51))}static get rg(){return re.a.instance}static get Dc(){return Rg.a.instance}static get Cs(){return zi.a.getInstance()}static get bpd(){return null!=Bi.M2g?Bi.M2g:Bi.M2g=Za.a.instance.Oa(880)}static Xb(){const b=
y.AFrameworkApplication.va;b.qa(ub.a.ME,lc.a.view,Bi.xSc);b.qa(ub.a.ME,lc.a.bS,Bi.Dqa);b.Pc(ub.a.ME,1036);b.qa(ub.a.MN,lc.a.view,Bi.xSc);b.qa(ub.a.MN,lc.a.bS,Bi.Dqa);b.Pc(ub.a.MN,1036);b.qa(ub.a.iga,lc.a.view,Bi.xSc);b.qa(ub.a.iga,lc.a.bS,Bi.Dqa);b.Pc(ub.a.iga,1036);b.qa(ub.a.Ehf,lc.a.view,ce.ActionManager.Zf);b.qa(ub.a.y1h,lc.a.view,ce.ActionManager.Zf);b.qa(ub.a.f1f,lc.a.view,Bi.pCo);b.qa(ub.a.ohf,lc.a.view,ce.ActionManager.Zf);b.qa(ub.a.Ghf,lc.a.view,ce.ActionManager.Zf);b.qa(ub.a.LFg,lc.a.view,
ce.ActionManager.Zf);b.qa(ub.a.ZXj,lc.a.view,ce.ActionManager.Zf);b.qa(ub.a.oDe,lc.a.view,ce.ActionManager.Zf)}static pCo(){kt.HEj();return 32}static xSc(b,h,r,A,M){var aa,oa,Ja;if(!h.view.te)return 2;const fb=Bi.Dc.nq(ub.a.xSc);A.Bt=42;A.eE=42;const Cb={[Sq.a.oPa]:5796,[Sq.a.nPa]:5797};var Gb=h.view;if(Object(Al.a)().FIa(Bi.n0m,Gb.mb.Mg))return Bi.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.xqf}),fb.end(),8;if(Object(Al.a)().FIa(Bi.Igf,Gb.mb.Mg))return Bi.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.OVc}),fb.end(),8;if(Object(Al.a)().NEa(Gd.ParagraphReader.qX,
Gb.mb.Mg))return Bi.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.QQ}),fb.end(),8;if(Bi.rg.enc(Gb.mb.Mg))return Bi.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.IG}),fb.end(),8;if(null===(oa=null===(aa=Bi.ly())||void 0===aa?void 0:aa.instance)||void 0===oa?0:oa.sX(h))return Bi.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.b8a}),fb.end(),8;if(1===r)return fb.end(),32;M||(M=new wg.DictionaryPropertySet);if(zi.a.Cbn&&2===r){h=new Rb.GraphTransaction(15);h.Bb(Gb.od);const {wla:Sb,Hpb:pc}=Bi.Usj(b,M);Bi.$l.fip(Gb.mb.gb.currentSelection,Sb,pc);h.dispose();
fb.end();return 32}aa=null;if(2===r){aa=new Rb.GraphTransaction(15);aa.Bb(h.view.od);Bi.n$c=!1;oa=Kv.OutlineElementGeneralizer.Mka(Gb.mb.gb,!1);if(!oa)return aa.dispose(),Bi.Dc.$b(Nf.a.esa,{["Reason"]:nf.a.v1d}),fb.end(),8;1<oa.length&&M.setValue(pd.a.Aej,null);const Sb=M.ka(pd.a.IL,-1),pc=M.ka(pd.a.XB,-1);null===(Ja=Bi.bpd)||void 0===Ja?void 0:Ja.Knl(oa);if(Ja=Bi.wZo(Sb,pc,oa))M.setValue(pd.a.XB,16),M.setValue(pd.a.PXa,0);if(!ze.a.pf(Gb.mb.Mg)&&!Ja&&0<oa.length&&Sb){Gb=new vd.a;Ja=Array(oa.length);
for(let zc=0;zc<oa.length;zc++)Gb.set(oa.getContext(zc).node),Ja[zc]=Bi.Md.Pw(Gb);Bi.vZo(Ja,M)&&(Gb=new wg.DictionaryPropertySet,Gb.setValue(pd.a.XB,16),Gb.setValue(pd.a.PXa,0),Gb.setValue(fd.a.Nta,"clean-list-before-apply-new-list-style"),Gb.setValue(fd.a.cma,M.ka(fd.a.Nta,"unknown")+"@"+M.ka(fd.a.cma,"undefined")),Sq.a.xua(b,h,r,A,Gb,Cb,11),y.AFrameworkApplication.va.Ob(ub.a.ZXj,2),v.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),Bi.n$c=!0)}Gb=new vd.a;Gb.set(oa.getContext(0).node);
Gb=Bi.Md.Pw(Gb);Bi.kBn(Sb,pc,Gb,oa.length)}b=Sq.a.xua(b,h,r,A,M,Cb,11);32===b&&M.ka(pd.a.cUh,!1)&&(b=Sq.a.xua(ub.a.ZQ,h,r,A,M,Cb,11));aa&&aa.dispose();fb.end();return b}static vZo(b,h){let r=null;var A=!1;for(let M=b.length-1;0<=M&&(r?(A=b[M],A=-1!==h.ka(pd.a.IL,-3)?A?r.listType!==A.listType||r.listStyle!==A.listStyle:!0:A?r.listType!==A.listType:!0):r=b[M],!A);M--);return r&&(b=!1,A||(b=h.ka(pd.a.XB,42),h=h.ka(pd.a.IL,-3),b=b!==r.listType||0<h),A||b)?!0:!1}static kBn(b,h,r,A){0>=A||Bi.n$c||(b?r?
(r=r.listType,-1===b&&h===r?(y.AFrameworkApplication.va.Ob(ub.a.oDe,2),v.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):0<b&&(!h||1===h)&&(y.AFrameworkApplication.va.Ob(h?ub.a.ohf:ub.a.Ghf,2),v.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering"))):(y.AFrameworkApplication.va.Ob(h?ub.a.ohf:ub.a.Ghf,2),Bi.Xkp(),v.ULS.sendTraceTag(39715534,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering")):(y.AFrameworkApplication.va.Ob(ub.a.oDe,
2),v.ULS.sendTraceTag(39715533,393,50,"List Actions: Clean List Style - None list style")))}static wZo(b,h,r){if(-1!==b&&b||!r.length)return!1;b=new vd.a;let A=null;for(let M=r.length-1;0<=M&&!(b.set(r.getContext(M).node),A=Bi.Md.Pw(b));M--);return A&&h===A.listType?!0:!1}static Dqa(b,h,r,A,M){var aa;if(h.contextId!==lc.a.bS)return 2;var oa=h.clone().EDg();if(Bi.rg.iab(oa))return Bi.Dc.$b(Nf.a.Nn,{["Reason"]:nf.a.IG}),2;oa=new vd.a;oa.set(h.node);ze.a.tv(oa);Bi.n4f&&$g.TableCellReader.Vfa(oa)&&(h=
new Map,h.set(vj.a.b9c,(!0).toString()),Bi.Ixj(h));if(!Db.OutlineElementReader.Nh(oa))return 2;if(1===r)switch(b){case ub.a.ME:return 32;case ub.a.MN:return 32;case ub.a.iga:return 32;default:return 2}if(Db.OutlineElementReader.PT(oa))return Bi.Dc.$b(Nf.a.Nn,{["Reason"]:nf.a.QQ}),2;h=Bi.Md.Pw(oa);const Ja=Object.freeze(null===h||void 0===h?void 0:h.clone());if(!M)return 8;const {ff:fb,wla:Cb,Hpb:Gb}=Bi.Usj(b,M);Bi.vUo(fb,oa);var Sb=Bi.$l.Dqa(fb,oa,Cb,Gb);if(!Sb.returnValue)return Bi.Dc.$b(Nf.a.Nn,
{["Reason"]:nf.a.k3f}),2;Sb=Sb.wla;Bi.fno(oa,M,Ja,Sb);2===r&&(r=M.ka(pd.a.XB,-1),Sb&&-1!==r&&((oa=M.ka(Mc.a.Ys,"Invalid MultiLevel Type"),b===ub.a.MN&&v.ULS.sendTraceTag(540313232,393,50,"toggleNumberedList Info - {0}",JSON.stringify({["commandSource"]:(null===M||void 0===M?void 0:M.CommandSource)||"ribbon/keyboard",["autonumberedListsEnabled"]:!0,["listStyle"]:zu[null==(null===h||void 0===h?void 0:h.listStyle)?null===Sb||void 0===Sb?void 0:Sb.listStyle:null===h||void 0===h?void 0:h.listStyle],["listType"]:lt[null==
(null===h||void 0===h?void 0:h.listType)?null===Sb||void 0===Sb?void 0:Sb.listType:null===h||void 0===h?void 0:h.listType],["cleared"]:16===(null===Sb||void 0===Sb?void 0:Sb.listType)})),h)?Sb.listType&&1!==Sb.listType||Bi.n$c||(y.AFrameworkApplication.va.Ob(ub.a.LFg,2),v.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",r?"Bullet":"Numbering",oa)):16===Sb.listType?(y.AFrameworkApplication.va.Ob(ub.a.y1h,2),v.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",
r?"Bullet":"Numbering",oa)):Sb.listType&&1!==Sb.listType||Bi.n$c||(y.AFrameworkApplication.va.Ob(ub.a.Ehf,2),v.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",r?"Bullet":"Numbering",oa))),b=Cd.FocusManager.instance(),(null===(aa=null===b||void 0===b?void 0:b.currentScope)||void 0===aa?void 0:aa.name)===vi.a.$ua&&b.EE(id.AFrame.Ro));A.Bt=Sb.listType;A.eE=Sb.listStyle;return 32}static get n4f(){if(null!=Bi.a0g)var b=Bi.a0g;else{var h;y.AFrameworkApplication.vd("534af766;70gef585");
b=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.listWithinTablesLoggingEnabled",!1);b=Bi.a0g=b}return b}static Ixj(b){const h=b.has(vj.a.b9c)?b.get(vj.a.b9c):"false";b=b.has(vj.a.yae)?b.get(vj.a.yae):"unknown";const r=new Map;r.set(vj.a.b9c,h);r.set(vj.a.yae,b);Ba.Health.instance.recordKpiUsage(vj.a.Gab.Twn,0,vj.a.NB,r)}static Usj(b,h){let r;b===ub.a.MN||b===ub.a.ME||b===ub.a.iga?(h=Bi.$l.SZc(b,h),r=fq.a.c_(h.getValue(pd.a.XB),h.getValue(pd.a.PXa))):
r=null;Bi.q3(b,h);let A=!1;if(!r)return v.ULS.sendTraceTag(508155328,393,50,"Returning null list info from prepareArgsForApplyBulletsNumbering"),{ff:h,wla:r,Hpb:A};Bi.HSo(r,h);b===ub.a.ME&&h&&(h.hasProperty(Mc.a.Tw)&&(r.levelText=h.getValue(Mc.a.Tw)),h.hasProperty(He.a.font)&&(r.font=h.getValue(He.a.font)),h.hasProperty(pd.a.WDf)&&(A=h.getValue(pd.a.WDf)));return{ff:h,wla:r,Hpb:A}}static fno(b,h,r,A){var M,aa,oa,Ja,fb,Cb,Gb,Sb;const pc=new Map;pc.set("actionCallSource",h.ka(fd.a.Nta,"unknown"));pc.set("actionCallSourceTrigger",
h.ka(fd.a.cma,"undefined"));pc.set("fromListType",lt[null!==(M=null===r||void 0===r?void 0:r.listType)&&void 0!==M?M:16]);pc.set("fromListStyle",zu[null!==(aa=null===r||void 0===r?void 0:r.listStyle)&&void 0!==aa?aa:0]);pc.set("fromListMarkerType",null!==(fb=l(null!==(oa=null===r||void 0===r?void 0:r.listStyle)&&void 0!==oa?oa:0,null!==(Ja=null===r||void 0===r?void 0:r.listType)&&void 0!==Ja?Ja:16))&&void 0!==fb?fb:"undefined");pc.set("fromLevelText",(null===r||void 0===r?0:r.oBa)?r.levelText:"undefined");
pc.set("toListType",null!==(Cb=lt[null===A||void 0===A?void 0:A.listType])&&void 0!==Cb?Cb:"undefined");pc.set("toListStyle",null!==(Gb=zu[null===A||void 0===A?void 0:A.listStyle])&&void 0!==Gb?Gb:"undefined");pc.set("toListMarkerType",null!==(Sb=l(null===A||void 0===A?void 0:A.listStyle,null===A||void 0===A?void 0:A.listType))&&void 0!==Sb?Sb:"undefined");pc.set("toLevelText",(null===A||void 0===A?0:A.oBa)?A.levelText:"undefined");zi.a.Jmn&&pc.set("underHeaderFooterKind",this.Md.Nxi(b.currentNode));
Ba.Health.instance.recordKpiUsage(vj.a.Gab.Wwn,0,vj.a.NB,pc)}static vUo(b,h){var r=new vd.a;r.hd(h);(h=r.Ub(2))&&Gd.ParagraphReader.Vb(h)&&(r=gg.a.instance.gb.currentSelection)&&r.Qa&&r.Qa.node===h&&ze.a.Tee(r)&&(Bi.WQo(b),Bi.UQo(b))}static HSo(b,h){h.hasProperty(Mc.a.Ys)&&b.Swe(h.getValue(Mc.a.Ys));h.hasProperty(fd.a.wT)&&(b.wT=h.getValue(fd.a.wT));h.hasProperty(Mc.a.Tw)&&(b.levelText=h.getValue(Mc.a.Tw));b.IL=h.ka(pd.a.IL,-1);let r=null;b.zta&&(r=Bi.Tvm(b,h));b.zta&&r?Bi.pUo(b,r):(b.zta?v.ULS.sendTraceTag(589091597,
393,15,"List marker is null, falling back to default list info.List Style {0}, List multi level type {1}, List Ordered : {2}",b.IL,b.Ys,b.Uz):v.ULS.sendTraceTag(589091596,393,50,"User has not selected a style choosing default properties"),Bi.IPo(b))}static IPo(b){if(b.Uz)b.Y9d&&-1===b.IL||(b.levelText="%1.",b.ff.hasProperty(He.a.O7)||b.nca(0,1));else if(1===b.listType)b.Y9d&&-1===b.IL||(b.font=vj.a.PXc,b.levelText=vj.a.QYd,b.ff.hasProperty(He.a.O7)||b.nca(1,6));else return;b.Ax="left"}static pUo(b,
h){1===b.Ys?Bi.cTo(b,h):Bi.wRo(b,h)}static cTo(b,h){(b.YA=h.YA)?b.b9=h.YA.b9:h.YA||v.ULS.sendTraceTag(588022422,393,15,"Multi level def info is null for list markerList Style {0}, List multi level type {1}, List Ordered : {2}",b.IL,b.Ys,b.Uz)}static wRo(b,h){b.levelText=h.levelText;b.Uz?b.nca(0,h.listStyle):(b.font=h.font,b.nca(1,1));b.Ax=h.Ax}static Tvm(b,h){let r=null;2===b.Ys?r=b.Uz?Za.a.instance.Oa(715):Za.a.instance.Oa(714):1===b.Ys&&(r=Za.a.instance.Oa(929));let A=r.oUb.value;const M=b.IL+"";
M in A||(A=r.rba,v.ULS.sendTraceTag(588391454,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in default list marker dictionary",M,b.Ys,b.Uz));if(!(M in A)){v.ULS.sendTraceTag(588391455,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in document list marker dictionary",M,b.Ys,b.Uz);if(h.hasProperty(He.a.font))return v.ULS.sendTraceTag(588391456,393,50,"User creating new list marker for List styleId {0} List Multi level type {1} and List Ordered : {2}",
M,b.Ys,b.Uz),b=h.getValue(He.a.font),new Yk(I.a.fromCharCode(parseInt(M)),b);v.ULS.sendTraceTag(588391457,393,15,"List styleId {0} List Multi level type {1} and List Ordered : {2} not found in any dictionary",M,b.Ys,b.Uz)}return A[M]}static UQo(b){Bi.pk.hasProperty(He.a.fontColor)&&b.setValue(He.a.fontColor,Bi.pk.fontColor())}static WQo(b){Bi.pk.hasProperty(He.a.fontSize)&&b.setValue(He.a.fontSize,Bi.pk.fontSize())}static q3(b,h){b=b===ub.a.ME?0:b===ub.a.MN?1:b===ub.a.iga?2:-1;h=h.ka(pd.a.IL,-1);
v.ULS.sendTraceTag(22923024,324,50,"ListType: {0}, ListStyleId: {1}",b,h)}static Xkp(){const b=Za.a.instance.Ra(2);if(b){var h=y.AFrameworkApplication.J.ic("WordDefaultToEditFloodgateDelayInMilliseconds",6E4);b.execute(r=>{window.setTimeout(()=>{r.logActivity("WordListsExperience","WordListsExperienceFloodgateIsEnabled")},h)})}else v.ULS.sendTraceTag(554796489,301,15,"Word lists floodgate instance SystemInitiatedFeedback was null")}}Bi.n0m=Uc.ImageReader.N8c;Bi.Igf=Uc.ImageReader.A$a;Bi.jg=null;Bi.Sn=
null;Bi.n$c=!1;Object(u.a)(Bi,"ListActor",null,[]);class hn{static get ir(){return Rj.a.UPb}static get rg(){return re.a.instance}static get Dc(){return Rg.a.instance}static get iq(){return Object(Lb.a)()}static ly(){return hn.Sn||(hn.Sn=Za.a.instance.Ra(51))}static get O1m(){return null!=hn.qXg?hn.qXg:hn.qXg=Za.a.instance.resolve(930)}static Xb(){const b=y.AFrameworkApplication.va;b.qa(ub.a.KI,lc.a.view,hn.CSc);b.qa(ub.a.KI,lc.a.bS,hn.fSh);b.Pc(ub.a.KI,1036);b.qa(ub.a.ZQ,lc.a.view,hn.CSc);b.qa(ub.a.ZQ,
lc.a.bS,hn.fSh);b.Pc(ub.a.ZQ,1036)}static $mo(b){const h=new Map;b=b?b.ka(fd.a.Aae,"Unknown"):"tab";h.set("actionCallSource",b);Ba.Health.instance.recordKpiUsage(by.Gab.P1m,1,by.NB,h)}static CSc(b,h,r,A,M){const aa=h.view;if(!aa.te)return 2;var oa=aa.mb;if(!oa)return hn.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.kga}),8;oa=oa.Mg;if(!oa)return hn.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.ao}),8;if(Xn.a.Jla(h))return 8;if(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&hn.rg.enc(oa))return hn.Dc.$b(Nf.a.Re,
{["Reason"]:nf.a.IG}),8;if(1===r)return 32;if(Object(Al.a)().FIa(hn.Igf,oa))return hn.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.OVc}),8;if(Object(Al.a)().NEa(Gd.ParagraphReader.qX,oa))return hn.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.QQ}),8;if(!y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&hn.rg.enc(oa))return hn.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.IG}),8;if(hn.ly()&&hn.ly().instance&&hn.ly().instance.sX(oa))return hn.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.b8a}),8;oa={};oa[Sq.a.oPa]=
5794;oa[Sq.a.nPa]=5795;return hn.O1m.CSc(aa,b,h,r,A,M,oa)}static fSh(b,h,r,A,M){var aa,oa;if(h.contextId!==lc.a.bS)return 2;var Ja=h.clone().EDg();if(Ii.TableReader.n1i(Ja)){if(hn.rg.o1i(Ja))return hn.Dc.$b(Nf.a.Nn,{["Reason"]:nf.a.IG}),8}else if(hn.rg.iab(Ja))return hn.Dc.$b(Nf.a.Nn,{["Reason"]:nf.a.IG}),2;Ja=new vd.a;Ja.set(h.node);ze.a.tv(Ja);if(!Db.OutlineElementReader.Nh(Ja))return 2;Bi.n4f&&hn.soo(M,Ja);let fb;switch(b){case ub.a.KI:fb=hn.ir.bLb(Ja);break;case ub.a.ZQ:fb=hn.ir.Qdc(Ja);break;
default:return 2}if(1===r||!fb)return fb?32:8;r=0;b===ub.a.ZQ&&M&&M.ka(pd.a.cUh,!1)&&(r|=2);if(Db.OutlineElementReader.PT(Ja))return hn.Dc.$b(Nf.a.Nn,{["Reason"]:nf.a.QQ}),2;(null===(oa=null===(aa=hn.iq)||void 0===aa?void 0:aa.Ad)||void 0===oa?0:oa.tX)&&hn.iq.Le&&(hn.iq.Le.iK=!0);switch(b){case ub.a.KI:hn.ir.gZa(Ja,-1,r);break;case ub.a.ZQ:hn.ir.eYc(Ja,1)}A&&jt.a.tzb&&(A.Bt|=jt.a.nqb(h.node,!0));hn.$mo(M);return 32}static soo(b,h){$g.TableCellReader.Vfa(h)&&of.ListItemReader.Cg(h)&&(b=b?b.ka(fd.a.Aae,
"Unknown"):"Ribbon",h=new Map,h.set(vj.a.yae,b),h.set(vj.a.b9c,"true"),Bi.Ixj(h))}}hn.Sn=null;hn.Igf=Uc.ImageReader.A$a;Object(u.a)(hn,"IndentationActor",null,[]);var Jn=d(1504);class Hl{static get nl(){return null!=Hl.m1g?Hl.m1g:Hl.m1g=Za.a.instance.resolve(348)}static get gk(){return null!=Hl.S3g?Hl.S3g:Hl.S3g=Za.a.instance.resolve(33)}static get rg(){return re.a.instance}static get Dc(){return Rg.a.instance}static ly(){return Hl.Sn||(Hl.Sn=Za.a.instance.Ra(51))}static Xb(){const b=y.AFrameworkApplication.va;
b.qa(ub.a.dHg,lc.a.view,(h,r)=>Xn.a.Jla(r)?8:32);b.qa(ub.a.F7,lc.a.view,Jn.a.qx);b.qa(ub.a.F7,lc.a.paragraph,Hl.RHa);b.qa(ub.a.F7,lc.a.table,Hl.Shf);b.Pc(ub.a.F7,1036);b.qa(ub.a.W$,lc.a.view,Jn.a.qx);b.qa(ub.a.W$,lc.a.paragraph,Hl.RHa);b.qa(ub.a.W$,lc.a.table,Hl.Shf);b.Pc(ub.a.W$,1036);b.qa(ub.a.p8,lc.a.view,Jn.a.qx);b.qa(ub.a.p8,lc.a.paragraph,Hl.RHa);b.qa(ub.a.p8,lc.a.table,Hl.Shf);b.Pc(ub.a.p8,1036);b.qa(ub.a.ZJa,lc.a.view,Jn.a.qx);b.qa(ub.a.ZJa,lc.a.paragraph,Hl.RHa);b.Pc(ub.a.ZJa,1036);b.qa(ub.a.IYc,
lc.a.view,Jn.a.qx);b.qa(ub.a.IYc,lc.a.paragraph,Hl.RHa);b.Pc(ub.a.IYc,1036);b.qa(ub.a.HTb,lc.a.view,Jn.a.qx);b.qa(ub.a.HTb,lc.a.paragraph,Hl.RHa);b.Pc(ub.a.HTb,1036);b.qa(ub.a.Knd,lc.a.view,Jn.a.qx);b.qa(ub.a.Knd,lc.a.paragraph,Hl.RHa);b.Pc(ub.a.Knd,1036);b.qa(ub.a.Npc,lc.a.view,Jn.a.qx);b.qa(ub.a.Npc,lc.a.paragraph,Hl.RHa);b.Pc(ub.a.Npc,1036);b.qa(ub.a.gec,lc.a.view,Jn.a.qx);b.qa(ub.a.gec,lc.a.paragraph,Hl.RHa);b.Pc(ub.a.gec,1036);b.qa(ub.a.pvc,lc.a.view,Jn.a.qx);b.qa(ub.a.pvc,lc.a.paragraph,Hl.RHa);
b.Pc(ub.a.pvc,1036);b.qa(ub.a.Aic,lc.a.view,Jn.a.qx);b.qa(ub.a.Aic,lc.a.paragraph,Hl.RHa);b.Pc(ub.a.Aic,1036)}static Shf(b,h,r,A){let M=!0;if(!h)return 8;Ii.TableReader.n1i(h)?Hl.rg.o1i(h)?(Hl.Dc.$b(Nf.a.Nn,{["Reason"]:nf.a.IG}),M=!1):Hl.ly()&&Hl.ly().instance&&Hl.ly().instance.sX(h)&&(Hl.Dc.$b(Nf.a.Nn,{["Reason"]:nf.a.b8a}),M=!1):(Hl.Dc.$b(Nf.a.Nn,{["Reason"]:nf.a.Rxf}),M=!1);if(1===r||!M)return M?32:8;h=h.node;switch(b){case ub.a.F7:Hl.gk.rH(h,1);break;case ub.a.W$:Hl.gk.rH(h,2);break;case ub.a.p8:Hl.gk.rH(h,
3)}A&&jt.a.tzb&&(A.Bt|=2);return 32}static RHa(b,h,r,A,M){let aa=!0;h.contextId!==lc.a.paragraph?aa=!1:Hl.rg.iab(h)?(Hl.Dc.$b(Nf.a.Nn,{["Reason"]:nf.a.IG}),aa=!1):Hl.ly()&&Hl.ly().instance&&Hl.ly().instance.sX(h)&&(Hl.Dc.$b(Nf.a.Nn,{["Reason"]:nf.a.b8a}),aa=!1);if(1===r||!aa)return aa?32:8;h=h.node;r=Gd.ParagraphReader.Sy(h);switch(b){case ub.a.F7:case ub.a.Npc:Hl.nl.rH(h,1===r&&Hl.vfe(M)?6:1);break;case ub.a.W$:case ub.a.gec:Hl.nl.rH(h,2===r&&Hl.vfe(M)?1:2);break;case ub.a.p8:case ub.a.pvc:Hl.nl.rH(h,
3===r&&Hl.vfe(M)?1:3);break;case ub.a.ZJa:case ub.a.Aic:Hl.nl.rH(h,6===r&&Hl.vfe(M)?1:6);break;case ub.a.HTb:Hl.nl.rH(h,11);break;case ub.a.IYc:Hl.nl.rH(h,7);break;case ub.a.Knd:Hl.nl.rH(h,13)}A&&jt.a.tzb&&(A.Bt|=jt.a.nqb(h));return 32}static vfe(b){let h=!1;null!==b&&Object.getType(b)===Object&&b.hasOwnProperty("InContextSet")&&(h=b.InContextSet);return!h}}Hl.Sn=null;Object(u.a)(Hl,"JustificationActor",null,[]);const rE=()=>{const b=y.AFrameworkApplication.va;b.qa(ub.a.save,we.a.frame,Wy);b.qa(ub.a.sync,
we.a.frame,tG)},tG=(b,h,r)=>{if(1===r)return 32;y.AFrameworkApplication.va.Ob(ub.a.Wdc,2);df.a.gf.OAe();return 32},Wy=(b,h,r)=>{if(1===r)return 2===qa.StaticActiveAppFrame.za().mode?32:8;y.AFrameworkApplication.va.Ob(ub.a.Wdc,2);if(2!==qa.StaticActiveAppFrame.za().mode)return 32;df.a.gf.zHj(null,null);return 32};class Xy{constructor(){this.activateRibbonTab=(b,h,r,A,M)=>{df.a.GC.WK.zue(M.toString());return 32};this.Gun=(b,h,r,A,M)=>{df.a.GC.WK.i3i(1,M.toString());return 32};this.O0n=(b,h)=>{if(h.contextId!==
we.a.frame)return 2;appChrome.onRibbonModeToggle();return 32}}Xb(){const b=y.AFrameworkApplication.va;b.qa(ub.a.activateRibbonTab,lc.a.view,this.activateRibbonTab);b.Pc(ub.a.activateRibbonTab,5);b.qa(ub.a.j3i,lc.a.view,this.Gun);b.qa(ub.a.bIg,we.a.frame,this.O0n)}static get instance(){return null!=Xy.TXg?Xy.TXg:Xy.TXg=Xy.Pm()}static Pm(){return new Xy}}Object(u.a)(Xy,"RibbonActor",null,[]);var Lr=d(868);class ow{constructor(b,h){this.An=null;this.Cop=(r,A,M,aa,oa)=>{let Ja;aa=A.view;if(!aa.te)return ow.Dc.$b(Nf.a.Re,
{["Reason"]:nf.a.HVb}),8;Ja=r===ub.a.undo?this.Yg.V2:this.Yg.hWa;if(1===M)return Xn.a.Jla(A)&&Xn.a.tnc()?8:Ja?32:8;if(!Ja)return v.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",r===ub.a.undo?"undo":"redo"),this.VPa.value.r3j(),ow.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.wop}),2;A=new Rb.GraphTransaction(3);A.Bb(aa.od);A.$ve();r=r===ub.a.undo?this.Yg.undo():this.Yg.Uma();A.dispose();oa&&zz.GrippersManager.instance.g2b(oa.Wy);if(r)return 32;ow.Dc.$b(Nf.a.wgc,{["Reason"]:nf.a.wfj});
return 8};this.qqa=b;this.VPa=h}get Yg(){return this.An||(this.An=this.qqa())}Xb(){const b=y.AFrameworkApplication.va,h=this.Cop;b.fb(ub.a.undo,lc.a.view,h,1028);b.fb(ub.a.Uma,lc.a.view,h,1028)}static get instance(){return null!=ow.BXg?ow.BXg:ow.BXg=ow.Pm()}static Pm(){const b=Za.a.instance;return new ow(()=>b.resolve(50),b.rf(425))}static get Dc(){return Rg.a.instance}}Object(u.a)(ow,"UndoActor",null,[]);const Mv={track:!0,Kmb:!1,UTd:!1},lL={["ApplyBulletsList"]:{Kmb:!0},["ApplyNumberingList"]:{Kmb:!0},
["ToggleBulletsList"]:{Kmb:!0},["ToggleNumberedList"]:{Kmb:!0},["UnList"]:{Kmb:!0},["SetFontColor"]:{Kmb:!0},["SetFontSize"]:{Kmb:!0},["InsertTable"]:{UTd:!0},["InsertColumnAfter"]:{UTd:!0},["InsertRowBelow"]:{UTd:!0}};var Nv=d(311);class iB{constructor(){this.W=null}get name(){return"Box4.Actors"}uc(b){this.W=b;(new HC).uc(b)}init(){var b=this.W.resolve(189);Object(oG.a)()&&this.W.resolve(931).Xb();b.Xb();b.k8();IC();Tq.instance.Xb(Object(dv.a)()?this.W.resolve(932):null);Hf.Xb();hn.Xb();Hl.Xb();
this.W.resolve(933).Xb();ay.instance.Xb();this.W.resolve(934).Xb();rE();this.W.resolve(935).Xb();Xy.instance.Xb();(b=this.W.Oa(12))?b.us.continueWith(()=>{this.rzj()}):this.rzj();Lr.a.Xb(df.a.V_a);this.W.resolve(936).Xb();ow.instance.Xb();this.W.resolve(937).Tpg();this.W.resolve(171);this.W.resolve(938);qa.StaticActiveAppFrame.za().Fe()}rzj(){this.W.resolve(939).Xb();this.W.resolve(940).Xb()}dispose(){}static main(){y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.OtelActionsInteractivityTrackerIsEnabled",
!1)&&(ca.a.kSi=b=>{if(b&&window.event){var h={...Mv,...(lL[b]||{})};if(h.track){b=Object(Nv.b)(window.event,`OtelUserAction - ${b}`);var r=Za.a.instance.Oa(941),A=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.OtelActionsInteractivityTrackerWithContextIsEnabled",!1);A&&h.Kmb&&r&&r.iNh(b);A&&h.UTd&&r&&r.zXk(b)}}});K.a.instance.Lc(new iB)}}Object(u.a)(iB,"Box4ActorsPackage",null,[0,1]);class uG extends Ez{constructor(b,h,r,A){super(b);this.bsa=r;this.odb=A;this.nOg=0;this.kz=
h.bYa("UserAction","WordOnlineAddToDictionary")}mAg(b){this.M0d=this.bsa.rsa(b);if(!this.fml())return!1;const h=this.M0d.errorDetails.token;this.odb.KNh(h);if(!this.odb.Bqd(h))return v.ULS.sendTraceTag(541618644,375,10,"[Add to Dictionary]: Unable to save word to roaming dictionary."),!1;v.ULS.sendTraceTag(541618645,375,50,"[Add to Dictionary]: Starting ProofingWholeDocument operation.");this.kz.start();this.transaction=new Rb.GraphTransaction(15);this.transaction.Bb(b.node);return!0}dqe(b){this.IXb(b.node);
return!0}khd(b){this.IXb(b);return!0}eqe(b){this.IXb(b.node)}IGg(b){this.transaction.dispose();this.M0d.errorDetails.Izb(b.actionId);this.odb.Hvg("unused corelation id.");this.kz.stop();v.ULS.sendTraceTag(541618646,375,50,String.format("[Add to Dictionary]: Actual errors removed: {0}. Duration in milliseconds: {1}. Type: {2}",this.nOg,this.kz.Ei,this.M0d.errorDetails.proofingType));return!0}Exc(b,h){const r=b.role;return super.Exc(b,h)||9===r||10===r||13===r||7===r||8===r}IXb(b){if(b){var h=this.bsa.d7(b,
r=>this.odb.Bqd(r.errorDetails.token));this.bsa.Rwb(b,h,!0);this.nOg+=h.length}}fml(){var b,h;return null!==(h=null===(b=this.M0d)||void 0===b?void 0:b.errorDetails)&&void 0!==h&&h.token?!0:(v.ULS.sendTraceTag(541618647,375,10,"[Add to Dictionary]: Was not able to get the token from the error range."),!1)}}Object(u.a)(uG,"AddToDictionaryCallbackSteps",Ez,[]);class Mz{constructor(b,h,r,A,M,aa,oa){this.Rb=b;this.mb=h;this.lna=r;this.bsa=A;this.Kp=M;this.odb=aa;this.xfo=oa;this.yRm=(Ja,fb,Cb,Gb,Sb,pc)=>
{const zc=new uG(this.lna,this.Kp,this.bsa,this.odb);return new oE(Ja,fb,Cb,Gb,Sb,pc,zc,this.Rb,this.mb,this.lna,"AddToDictionaryThroughProofingWholeDocumentOperation")}}Xb(){this.Rb.qW(ub.a.tNh,lc.a.view,this.yRm,1124);this.xfo.Rso(this.odb)}}Object(u.a)(Mz,"PersonalDictionaryOrchestrator",null,[]);class Ov{get name(){return"Box4.PersonalDictionary"}uc(b){this.container=b;b.register(Mz,943).ha().Sd(()=>new Mz(y.AFrameworkApplication.va,gg.a.instance,sr.a.instance,b.resolve(43),b.resolve(38),b.resolve(723),
b.resolve(942)))}init(){this.container.resolve(943).Xb()}dispose(){}static main(){zl.a.get_instance().Tk(7,()=>{K.a.instance.Lc(new Ov)})}}Object(u.a)(Ov,"PersonalDictionaryPackage",null,[0,1]);var vo=d(105);class Yy{constructor(b,h,r,A,M,aa){this.rFa=this.mJ=null;this.iUc=(oa,Ja,fb,Cb,Gb)=>this.C0i(Ja,fb,Gb,!1)?32:8;this.VK=(oa,Ja,fb,Cb,Gb)=>{if(!({Iz:oa}=this.FQj(Ja,fb,Gb,!0)).returnValue)return oa;v.ULS.sendTraceTag(594899719,340,50,"Cell shading color is selected from Standard/Theme colors.");
Gb=this.dOk.Qja(Ja.node,Gb);this.l8n(Ja.node,Gb);this.rM();return 32};this.x6a=(oa,Ja,fb,Cb,Gb)=>{if(!({Iz:oa}=this.FQj(Ja,fb,Gb,!1)).returnValue)return oa;this.h8n(Ja.node);return 32};this.Ego=(oa,Ja,fb,Cb,Gb)=>{if(1===fb)return 32;if(!Ja||!Ja.view.te)return 2;oa=Ja.view.mb;if(!oa)return 2;oa=oa.Mg;if(!oa)return 2;oa=Object(Al.a)().hU(oa,16);if(!oa||!oa.length)return 2;Ja=null;for(fb=0;fb<oa.length;fb++){Cb=oa.getContext(fb);if(!Cb||Cb.contextId!==lc.a.ax)return 2;const Sb={};this.bLi(Cb,Sb);if(Sb.CellShading)if(Ja&&
Ja!==Sb.CellShading){Ja=null;break}else Ja=Sb.CellShading;else{Ja=null;break}}Gb.CellShading=Ja;return 32};this.zwb=(oa,Ja,fb,Cb,Gb)=>1===fb?32:this.bLi(Ja,Gb);this.nXb=(oa,Ja,fb,Cb,Gb)=>{if(1===fb)return 32;oa=Ja.contextId===lc.a.view?this.Mjb.ZPb(Ja):this.mLf(Ja);fb={};Ja=null;32===y.AFrameworkApplication.va.Pb(ub.a.zwb,2,fb)&&fb&&(Ja=fb.CellShading);fb="";Ja&&(fb=Ol.a.BB(Ja)||"");this.DPj.gca=fb;this.HP.kAc(fb);oa=this.DPj.Opb(oa,df.a.VTa);if(!oa)return 8;Gb.MenuItems=oa;v.ULS.sendTraceTag(592996034,
340,50,"Cell Shading dropdown menu is opened.");return 32};this.E3=(oa,Ja,fb,Cb,Gb)=>{if(1===fb)return 32;qa.StaticActiveAppFrame.za().dismissFloatie();y.AFrameworkApplication.va.Pb(ub.a.zwb,2,Gb);this.rFa=new Xt("Shading",ub.a.hwc);this.rFa.zyb(Gb&&Gb.CellShading?Gb.CellShading:0);return 32};this.Ikl=(oa,Ja,fb,Cb,Gb)=>{if(1===fb)return 32;y.AFrameworkApplication.va.Pb(ub.a.s8,2,Gb);this.HP.gTa(Gb)||v.ULS.sendTraceTag(594899717,340,50,"Color selected from Recent Colors section. Menu: {0}","Shading");
return 32};this.ga=b;this.dOk=h;this.z_e=r;this.Mjb=A;this.Yd=M;this.Oq=aa}get HP(){return null!=this.V1g?this.V1g:this.V1g=Za.a.instance.Oa(788)}get DPj(){this.mJ||(this.mJ=new os("Shading"),this.Ffa(this.mJ));return this.mJ}Ffa(b){b.BG(2,ub.a.x6a);b.BG(3,ub.a.s8);b.BG(4,ub.a.s8);b.C5a(this.z_e,1)}Xb(){this.ga.qa(ub.a.nXb,lc.a.view,this.nXb);this.ga.qa(ub.a.nXb,lc.a.ax,this.nXb);this.ga.Pc(ub.a.nXb,1126);this.ga.qa(ub.a.iUc,lc.a.view,Lr.a.V0c);this.ga.qa(ub.a.iUc,lc.a.ax,this.iUc);this.ga.Pc(ub.a.iUc,
1028);this.ga.qa(ub.a.s8,lc.a.view,Lr.a.V0c);this.ga.qa(ub.a.s8,lc.a.ax,this.VK);this.ga.Pc(ub.a.s8,1028);this.ga.qa(ub.a.x6a,lc.a.view,Lr.a.V0c);this.ga.qa(ub.a.x6a,lc.a.ax,this.x6a);this.ga.Pc(ub.a.x6a,1028);this.ga.qa(ub.a.zwb,lc.a.view,this.Ego);this.ga.qa(ub.a.zwb,lc.a.ax,this.zwb);this.ga.Pc(ub.a.zwb,1124);this.ga.qa(ub.a.hwc,lc.a.view,Lr.a.V0c);this.ga.qa(ub.a.hwc,lc.a.ax,this.Ikl);this.ga.Pc(ub.a.hwc,1028);this.ga.qa(ub.a.Sgg,lc.a.view,this.E3);this.ga.Pc(ub.a.Sgg,1028)}rM(){y.AFrameworkApplication.J&&
y.AFrameworkApplication.J.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Za.a.instance.Ra(2);b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}FQj(b,h,r,A){return this.C0i(b,h,r,A)?{returnValue:2===h,Iz:32}:(2==h&&Lr.a.recordQosError("CellShadingButtonClickNoResponse",["TableInteractionFailed"],nf.a.k3l),{returnValue:!1,Iz:8})}C0i(b,h,r,A){return b.contextId!==lc.a.ax||2===h&&(A&&!r||!b.node)?!1:!0}l8n(b,
h){const r=new Rb.GraphTransaction(15);r.Bb(b);this.oOj(b);b.properties.setValue(He.a.VK,h);r.dispose()}h8n(b){const h=new Rb.GraphTransaction(15);h.Bb(b);this.oOj(b);b.properties.removeProperty(He.a.VK);h.dispose()}mLf(b){return b.contextId!==lc.a.ax?null:(b=Object(vo.a)().Iu(b.node))?b:null}oOj(b){if(this.Yd&&this.Yd.Lg&&(b=Object(ya.a)(Dv.TableCellNode,b))){const h=b.UX();this.Oq.Gnd(b,h)}}bLi(b,h){if(b.contextId!==lc.a.ax)return 8;(b=b.node)&&b.hasProperty(He.a.VK)&&(h.CellShading=b.getValue(He.a.VK));
return 32}static kim(){return new Yy(y.AFrameworkApplication.va,Ep.a.instance,iw.a.instance,Um.PageReader.instance,Za.a.instance.resolve(46).instance,Za.a.instance.resolve(39).instance)}static get instance(){return null!=Yy.VYg?Yy.VYg:Yy.VYg=Yy.kim()}}Object(u.a)(Yy,"CellShadingActor",null,[]);class nJ{constructor(){this.W=null}get name(){return"Box4.CellShading"}uc(b){this.W=b}init(){const b=this.W.Oa(12);b?b.us.continueWith(()=>{this.Fo()}):this.Fo()}Fo(){Yy.instance.Xb();qa.StaticActiveAppFrame.za().Fe()}dispose(){}}
Object(u.a)(nJ,"CellShadingPackage",null,[0,1]);class cy{constructor(){this.oUb=new Qf.a(()=>this.Esf());this.rba={}}Tqi(b){return b}}Object(u.a)(cy,"AListMarkerGalleryLoader",null,[283]);var Nz=d(1245),Oz=d(338);class Bq extends cy{constructor(){super();this.lFb=new vk.a(Na.a.th())}Tqi(b){Bq.yT||this.FOo();b in Bq.yT&&(b=Bq.yT[b]);return b}Esf(){const b={};b["0"]=new Yk(Box4Intl.Box4Strings.L_ListStyleNone,Nz.a.ESi);b["1"]=new Yk(String.fromCharCode(61623),"Symbol");b["2"]=new Yk(String.fromCharCode(111),
"Courier New");b["3"]=new Yk(String.fromCharCode(61607),"Wingdings");b["4"]=new Yk(String.fromCharCode(9643),"Courier New");b["5"]=new Yk(String.fromCharCode(61611),"Wingdings");b["6"]=new Yk(String.fromCharCode(61614),"Symbol");b["7"]=new Yk(String.fromCharCode(61483),"Symbol");b["8"]=new Yk(String.fromCharCode(61485),"Symbol");b["9"]=new Yk(String.fromCharCode(9830),"Courier New");b["10"]=new Yk(String.fromCharCode(61664),"Symbol");b["11"]=new Yk(String.fromCharCode(61558),"Wingdings");b["12"]=
new Yk(String.fromCharCode(61656),"Wingdings");b["13"]=new Yk(String.fromCharCode(61514),"Wingdings");b["14"]=new Yk(String.fromCharCode(61516),"Wingdings");b["15"]=new Yk(String.fromCharCode(61692),"Wingdings");b["16"]=new Yk(String.fromCharCode(61691),"Wingdings");b["17"]=new Yk(String.fromCharCode(61553),"Wingdings");return b}eEe(b){b&&b.length&&this.klf(b)}Skg(){if(this.rba){var b=Oz.a(this.rba),h=b.length;for(let r=0;r<h;r++){const A=this.rba[b[r]];this.lFb.add(A.levelText+"_"+A.font)}}}klf(b){this.Skg();
for(const h of b)if(h&&!h.Uz&&h.oBa&&h.f5c&&(b=h.levelText+"_"+h.font,!this.lFb.contains(b))){const r=Oz.a(this.rba).length+Oz.a(this.oUb.value).length+"";this.rba[r]=new Yk(h.levelText,h.font);this.lFb.add(b)}}FOo(){Bq.yT={};Bq.yT["Symbol 0x00b7"]=Box4Intl.Box4Strings.L_SolidBullet;Bq.yT["Courier New 0x006f"]=Box4Intl.Box4Strings.L_HollowBullet;Bq.yT["Wingdings 0x00a7"]=Box4Intl.Box4Strings.L_SmallBlackSquare;Bq.yT["Courier New 0x25ab"]=Box4Intl.Box4Strings.L_SmallWhiteSquare;Bq.yT["Wingdings 0x00ab"]=
Box4Intl.Box4Strings.L_Star;Bq.yT["Symbol 0x00ae"]=Box4Intl.Box4Strings.L_RightArrow;Bq.yT["Symbol 0x002b"]=Box4Intl.Box4Strings.L_PlusSign;Bq.yT["Symbol 0x002d"]=Box4Intl.Box4Strings.L_Hyphen;Bq.yT["Courier New 0x2666"]=Box4Intl.Box4Strings.L_BlackDiamond;Bq.yT["Symbol 0x00e0"]=Box4Intl.Box4Strings.L_WhiteDiamond;Bq.yT["Wingdings 0x0076"]=Box4Intl.Box4Strings.L_BlackDiamondWithMinusX;Bq.yT["Wingdings 0x00d8"]=Box4Intl.Box4Strings.L_3DRightwards;Bq.yT["Wingdings 0x004a"]=Box4Intl.Box4Strings.L_SmilingFace;
Bq.yT["Wingdings 0x004c"]=Box4Intl.Box4Strings.L_frowningFace;Bq.yT["Wingdings 0x00fc"]=Box4Intl.Box4Strings.L_CheckMark;Bq.yT["Wingdings 0x00fb"]=Box4Intl.Box4Strings.L_BallotScriptX;Bq.yT["Wingdings 0x0071"]=Box4Intl.Box4Strings.L_ShadowedWhiteSquare}}Bq.yT=null;Object(u.a)(Bq,"ListMarkerBulletLoader",cy,[]);class Mr{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(u.a)(Mr,"InfoAtLevel",null,[]);class Yt{constructor(b){this.YA=b}get font(){return"Calibri"}get listStyle(){return 42}get Ax(){return"left"}get Tpe(){return this.YA?
this.xco():this.zco()}get Had(){return this.YA?this.yco():null}get levelText(){return""}cqm(b){switch(b){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}xco(){let b="";for(let h=0;3>h;h++)b+=this.B3c(h);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',Yt.xHf(),b)}yco(){const b=[];for(let h=0;3>h;h++)b.push(Object.assign(new Mr,{textAtLevel:this.rDi(h),styleAtLevel:this.wJm(h)}));return b}zco(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',
Yt.yHf(),Box4Intl.Box4Strings.L_ListStyleNone)}rDi(b){b=this.YA.Iad[b];for(let h=0;9>h;h++)b=I.a.replaceAll(b,"%"+(h+1),this.cqm(this.YA.rUb[h]));return b}wJm(b){const h={};h.fontFamily=6===this.YA.rUb[b]?this.YA.SJa[b]:this.font;return h}B3c(b){const h=this.rDi(b),r=new Sys.StringBuilder;6===this.YA.rUb[b]&&r.append(String.format("font-family:{0};",this.YA.SJa[b]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',
b,r.toString(),h)}static xHf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static yHf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(u.a)(Yt,"ListMarkerMultilevel",null,[282]);var Cq=d(1261);class sE extends cy{constructor(){super()}Esf(){const b=new Cq.a,h={};h["0"]=new Yt(null);h["1"]=new Yt(b.Yrf());h["2"]=new Yt(b.Ssf("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),
[1,2,3,1,2,3,1,2,3]));h["3"]=new Yt(b.S7h([61558,61656,61607,61623,9830,61656,61607,61623,9830],"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";")));return h}eEe(){}}Object(u.a)(sE,"ListMarkerMultilevelLoader",cy,[]);var gq=d(154);class Nr{constructor(b,h){this.YA=null;this.levelText=b;this.BFd=h}get font(){return"Calibri"}get listStyle(){return this.BFd}get Ax(){switch(this.BFd){case 3:case 5:return"right";default:return"left"}}get Tpe(){switch(this.BFd){case 1:return this.Htc("1",
"2","3");case 2:return this.Htc("a","b","c");case 3:return this.Htc("i","ii","iii");case 4:return this.Htc("A","B","C");case 5:return this.Htc("I","II","III");case 0:return this.Aco();default:return this.Htc("1","2","3")}}get Had(){const b=[],h={};h.fontFamily=gq.FontUtils.Dza(this.font);switch(this.BFd){case 1:return b.push(Object.assign(new Mr,{textAtLevel:this.x_("1"),styleAtLevel:h})),b.push(Object.assign(new Mr,{textAtLevel:this.x_("2"),styleAtLevel:h})),b.push(Object.assign(new Mr,{textAtLevel:this.x_("3"),
styleAtLevel:h})),b;case 2:return b.push(Object.assign(new Mr,{textAtLevel:this.x_("a"),styleAtLevel:h})),b.push(Object.assign(new Mr,{textAtLevel:this.x_("b"),styleAtLevel:h})),b.push(Object.assign(new Mr,{textAtLevel:this.x_("c"),styleAtLevel:h})),b;case 3:return b.push(Object.assign(new Mr,{textAtLevel:this.x_("i"),styleAtLevel:h})),b.push(Object.assign(new Mr,{textAtLevel:this.x_("ii"),styleAtLevel:h})),b.push(Object.assign(new Mr,{textAtLevel:this.x_("iii"),styleAtLevel:h})),b;case 4:return b.push(Object.assign(new Mr,
{textAtLevel:this.x_("A"),styleAtLevel:h})),b.push(Object.assign(new Mr,{textAtLevel:this.x_("B"),styleAtLevel:h})),b.push(Object.assign(new Mr,{textAtLevel:this.x_("C"),styleAtLevel:h})),b;case 5:return b.push(Object.assign(new Mr,{textAtLevel:this.x_("I"),styleAtLevel:h})),b.push(Object.assign(new Mr,{textAtLevel:this.x_("II"),styleAtLevel:h})),b.push(Object.assign(new Mr,{textAtLevel:this.x_("III"),styleAtLevel:h})),b;case 0:return null;default:return b.push(Object.assign(new Mr,{textAtLevel:this.x_("1"),
styleAtLevel:h})),b.push(Object.assign(new Mr,{textAtLevel:this.x_("2"),styleAtLevel:h})),b.push(Object.assign(new Mr,{textAtLevel:this.x_("3"),styleAtLevel:h})),b}}Htc(b,h,r){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',Nr.xHf(),this.B3c(b),this.B3c(h),this.B3c(r))}Aco(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',Nr.yHf(),Box4Intl.Box4Strings.L_ListStyleNone)}B3c(b){b=this.x_(b);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',
b)}x_(b){return I.a.replaceAll(this.levelText,"%1",b)}static xHf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static yHf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(u.a)(Nr,"ListMarkerNumbering",null,[282]);class tE extends cy{constructor(){super();this.lFb=new vk.a(Na.a.th())}yon(b){b=b.match(RegExp("%[1-9]","g"));return!!b&&1===b.length}Esf(){const b=
{};b["0"]=new Nr(Box4Intl.Box4Strings.L_ListStyleNone,0);b["1"]=new Nr("%1.",5);b["2"]=new Nr("%1.",4);b["3"]=new Nr("%1.",1);b["4"]=new Nr("%1.",2);b["5"]=new Nr("%1.",3);b["6"]=new Nr("%1)",5);b["7"]=new Nr("%1)",4);b["8"]=new Nr("%1)",1);b["9"]=new Nr("%1)",2);b["10"]=new Nr("%1)",3);b["11"]=new Nr("(%1)",5);b["12"]=new Nr("(%1)",4);b["13"]=new Nr("(%1)",1);b["14"]=new Nr("(%1)",2);b["15"]=new Nr("(%1)",3);return b}eEe(b){b&&b.length&&this.klf(b)}Skg(){if(this.rba){var b=Oz.a(this.rba),h=b.length;
for(let r=0;r<h;r++){const A=this.rba[b[r]];this.lFb.add(A.levelText+"_"+A.listStyle)}}}klf(b){this.Skg();for(const h of b)if(h&&h.Uz&&h.oBa&&this.yon(h.levelText)&&h.listStyle&&(b=Nz.a.LEf(h.levelText))){const r=b+"_"+h.listStyle;if(!this.lFb.contains(r)){const A=Oz.a(this.rba).length+Oz.a(this.oUb.value).length+"";this.rba[A]=new Nr(b,h.listStyle)}this.lFb.add(r)}}}Object(u.a)(tE,"ListMarkerNumberingLoader",cy,[]);class LC{constructor(){this.W=null}get name(){return"Box4.ListMarker"}init(){Bi.Xb()}dispose(){}uc(b){this.W=
b;this.W.ia(714,()=>new Bq).ha();this.W.ia(715,()=>new tE).ha();this.W.ia(929,()=>new sE).ha()}static main(){K.a.instance.Lc(new LC)}}Object(u.a)(LC,"Box4ListMarkerPackage",null,[0,1]);class Au{static get kh(){return ig.a.Ry(Au.Hn,Box4Intl.Box4Strings.L_DefineNewBulletFont,Box4Intl.Box4Strings.L_DefineNewBulletCharacterCode,"")}}Au.Hn="<div class='DefineNewBulletDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='DefineNewBulletFontPlaceholder'></div> </div> <div class='normal' id='ListMarkerTable'> <div id='DefineNewBulletTableContainer' class='DefineNewBulletTableContainer' style='height: 195px; overflow-x: hidden; overflow-y: scroll;'></div> </div> <div class='WACDialogRow' id='CharacterCode'> <label id='CharacterCodeLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogRow' id='CharacterCodeValue'> <label id='CharacterCodeValueLabel' class='WACDialogLabel' >{2}</label> </div>";
Object(u.a)(Au,"DefineNewBulletDialogHtml",null,[]);class Zt extends ig.a{constructor(b,h,r,A){super();this.YJc=this.HZe=this.q8b=this.i8b=null;this.VFb=0;this.RSc=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];this.VPi=!0;this.NMl=M=>{if(this.i8b&&M.target!==this.i8b){const aa=this.focusManager.au();aa&&aa.Nk&&(aa.Nk.hA(M.target),this.i8b=M.target)}this.z_n(M.target.id)};this.Hwn=M=>{M=M.If;if(!this.u2i(M))return!1;this.focusManager.au().Nk.hA(M);M.focus();return!0};this.Iwn=M=>{var aa=
M.If;if(!this.u2i(aa))return!1;var oa=aa.id;oa=parseInt(oa.substr(oa.lastIndexOf("_")+1))-this.VFb;if(M.Nb.ctrlKey||M.Nb.altKey||M.Nb.keyCode>=cf.a.p3b&&M.Nb.keyCode<=cf.a.q3b)return!1;const Ja=M.Nb.keyCode;if(M.eventName===Jd.a.hj){M=-1;if(Ja===Sys.UI.Key.enter)return this.focusManager.au().Nk.hA(aa),aa.focus(),this.Jjj(aa.id),this.hide(),!0;Ja===Sys.UI.Key.up?M=oa-17:Ja===Sys.UI.Key.down?M=oa+17:Ja===Sys.UI.Key.left?M=y.AFrameworkApplication.isRtl?oa+1:oa-1:Ja===Sys.UI.Key.right&&(M=y.AFrameworkApplication.isRtl?
oa-1:oa+1);0<=M&&(aa=this.Tzi(Zt.Zfc+"_"+(M+this.VFb)))&&aa.focus()}return!0};this.MMl=M=>{1===M&&this.Jjj(this.q8b);this.hide()};this.yv=b;this.focusManager=h;this.ga=r;this.OV=!1;A&&(b=A.indexOf(","),-1!==b&&(A=A.substring(0,b)));this.fontName=A;this.Ng="DefineNewBulletDialog";this.kh=Au.kh;this.Qe(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Qe(0,CommonUIStrings.l_DialogClose);this.mi(Box4Intl.Box4Strings.L_SymbolSingle,this.MMl,null);this.nda=!1;this.fNa();document.getElementById(Zt.d3d).focus()}fNa(){this.focusManager.au().scope.nt(Cd.FocusManager.instance().xZ);
this.focusManager.au().scope.nt(Cd.FocusManager.instance().yZ);this.focusManager.au().scope.bindAction(Cd.FocusManager.instance().xZ,ub.a.bZd);this.focusManager.au().scope.bindAction(Cd.FocusManager.instance().yZ,ub.a.aZd)}Cba(){this.gTd(Zt.d3d,"DefineNewBulletFontPlaceholder",ub.a.$Yd.toString(),ub.a.VXb.toString(),ub.a.Fgd.toString(),Box4Intl.Box4Strings.L_FontName,"100px");this.ydl()}LN(){super.LN();document.getElementById(this.Bj("WACDialogPanel")).style.width="auto"}gTd(b,h,r,A,M,aa,oa){r=Aj.c(b,
r,!0,!0,A,M,I.a.Jf(aa),!0,oa);this.BXd(b,h,r,"Medium")}ydl(){const b=document.getElementById(Zt.Zfc);b&&(b.innerHTML=this.vvi(),this.bzj(b))}bzj(b){if(b=b.getElementsByClassName("DefineNewBulletTableCell"))for(let h=0;h<b.length;h++)mf.a.addHandler(b[h],Jd.a.focus,this.NMl)}gtp(){var b=document.getElementById(Zt.Zfc);if(b){let h=this.fontName;const r=Nz.a.kWf(this.fontName);r&&61472!==this.VFb||!r&&32!==this.VFb?(b.innerHTML=this.vvi(),this.bzj(b)):(b=b.getElementsByTagName("table"))&&1===b.length&&
h&&(h=this.OMh(h),b[0].style.fontFamily=h)}}z_n(b){this.YMj(this.q8b,!1);this.q8b=b;this.YMj(b,!0);if((b=document.getElementById("CharacterCodeValueLabel"))&&this.q8b){let h=parseInt(this.q8b.substr(this.q8b.lastIndexOf("_")+1));-1!==h&&(h-=61472===this.VFb?61440:0,b.innerText=I.a.IJ(h,4))}}YMj(b,h){(b=this.Tzi(b))&&(h?b.setAttribute("selected","true"):b.removeAttribute("selected"))}Tzi(b){const h=document.getElementById(Zt.Zfc);return h?h.querySelector("#"+b):null}Oqa(){const b=document.getElementById(Zt.Zfc);
b&&(this.HZe||(this.HZe=this.Hwn,this.rr.nb(Jd.a.click,b,this.HZe)),this.YJc||(this.YJc=this.Iwn,this.oe.nb(Jd.a.hj,b,this.YJc),this.oe.nb(Jd.a.mv,b,this.YJc),this.oe.nb(Jd.a.pi,b,this.YJc)));super.Oqa()}u2i(b){return b.classList.contains("DefineNewBulletTableCell")}Jjj(b){if(b){b=b.split("_");const h=new wg.DictionaryPropertySet;h.setValue(pd.a.IL,parseInt(b[1]));h.setValue(He.a.font,this.fontName);h.setValue(pd.a.XB,1);h.setValue(fd.a.Nta,"command-ui");h.setValue(fd.a.cma,"define-new-bullet-dialog");
this.ga.Pb(ub.a.ME,2,h)}this.focusManager.HN(this.dN,!0)}vvi(){const b=new Sys.StringBuilder,h=Nz.a.kWf(this.fontName);let r=this.fontName;r=this.OMh(r);b.append(String.format('<table class="DefineNewBulletTable" style="font-family: {0};">',r));h?(this.VFb=61472,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61472" title="0x0020" tabindex="0">\uf020</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61473" title="0x0021" tabindex="0">\uf021</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61474" title="0x0022" tabindex="0">\uf022</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61475" title="0x0023" tabindex="0">\uf023</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61476" title="0x0024" tabindex="0">\uf024</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61477" title="0x0025" tabindex="0">\uf025</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61478" title="0x0026" tabindex="0">\uf026</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61479" title="0x0027" tabindex="0">\uf027</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61480" title="0x0028" tabindex="0">\uf028</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61481" title="0x0029" tabindex="0">\uf029</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61482" title="0x002a" tabindex="0">\uf02a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61483" title="0x002b" tabindex="0">\uf02b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61484" title="0x002c" tabindex="0">\uf02c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61485" title="0x002d" tabindex="0">\uf02d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61486" title="0x002e" tabindex="0">\uf02e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61487" title="0x002f" tabindex="0">\uf02f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61488" title="0x0030" tabindex="0">\uf030</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61489" title="0x0031" tabindex="0">\uf031</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61490" title="0x0032" tabindex="0">\uf032</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61491" title="0x0033" tabindex="0">\uf033</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61492" title="0x0034" tabindex="0">\uf034</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61493" title="0x0035" tabindex="0">\uf035</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61494" title="0x0036" tabindex="0">\uf036</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61495" title="0x0037" tabindex="0">\uf037</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61496" title="0x0038" tabindex="0">\uf038</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61497" title="0x0039" tabindex="0">\uf039</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61498" title="0x003a" tabindex="0">\uf03a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61499" title="0x003b" tabindex="0">\uf03b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61500" title="0x003c" tabindex="0">\uf03c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61501" title="0x003d" tabindex="0">\uf03d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61502" title="0x003e" tabindex="0">\uf03e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61503" title="0x003f" tabindex="0">\uf03f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61504" title="0x0040" tabindex="0">\uf040</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61505" title="0x0041" tabindex="0">\uf041</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61506" title="0x0042" tabindex="0">\uf042</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61507" title="0x0043" tabindex="0">\uf043</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61508" title="0x0044" tabindex="0">\uf044</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61509" title="0x0045" tabindex="0">\uf045</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61510" title="0x0046" tabindex="0">\uf046</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61511" title="0x0047" tabindex="0">\uf047</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61512" title="0x0048" tabindex="0">\uf048</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61513" title="0x0049" tabindex="0">\uf049</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61514" title="0x004a" tabindex="0">\uf04a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61515" title="0x004b" tabindex="0">\uf04b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61516" title="0x004c" tabindex="0">\uf04c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61517" title="0x004d" tabindex="0">\uf04d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61518" title="0x004e" tabindex="0">\uf04e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61519" title="0x004f" tabindex="0">\uf04f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61520" title="0x0050" tabindex="0">\uf050</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61521" title="0x0051" tabindex="0">\uf051</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61522" title="0x0052" tabindex="0">\uf052</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61523" title="0x0053" tabindex="0">\uf053</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61524" title="0x0054" tabindex="0">\uf054</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61525" title="0x0055" tabindex="0">\uf055</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61526" title="0x0056" tabindex="0">\uf056</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61527" title="0x0057" tabindex="0">\uf057</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61528" title="0x0058" tabindex="0">\uf058</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61529" title="0x0059" tabindex="0">\uf059</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61530" title="0x005a" tabindex="0">\uf05a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61531" title="0x005b" tabindex="0">\uf05b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61532" title="0x005c" tabindex="0">\uf05c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61533" title="0x005d" tabindex="0">\uf05d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61534" title="0x005e" tabindex="0">\uf05e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61535" title="0x005f" tabindex="0">\uf05f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61536" title="0x0060" tabindex="0">\uf060</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61537" title="0x0061" tabindex="0">\uf061</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61538" title="0x0062" tabindex="0">\uf062</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61539" title="0x0063" tabindex="0">\uf063</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61540" title="0x0064" tabindex="0">\uf064</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61541" title="0x0065" tabindex="0">\uf065</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61542" title="0x0066" tabindex="0">\uf066</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61543" title="0x0067" tabindex="0">\uf067</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61544" title="0x0068" tabindex="0">\uf068</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61545" title="0x0069" tabindex="0">\uf069</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61546" title="0x006a" tabindex="0">\uf06a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61547" title="0x006b" tabindex="0">\uf06b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61548" title="0x006c" tabindex="0">\uf06c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61549" title="0x006d" tabindex="0">\uf06d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61550" title="0x006e" tabindex="0">\uf06e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61551" title="0x006f" tabindex="0">\uf06f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61552" title="0x0070" tabindex="0">\uf070</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61553" title="0x0071" tabindex="0">\uf071</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61554" title="0x0072" tabindex="0">\uf072</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61555" title="0x0073" tabindex="0">\uf073</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61556" title="0x0074" tabindex="0">\uf074</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61557" title="0x0075" tabindex="0">\uf075</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61558" title="0x0076" tabindex="0">\uf076</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61559" title="0x0077" tabindex="0">\uf077</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61560" title="0x0078" tabindex="0">\uf078</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61561" title="0x0079" tabindex="0">\uf079</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61562" title="0x007a" tabindex="0">\uf07a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61563" title="0x007b" tabindex="0">\uf07b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61564" title="0x007c" tabindex="0">\uf07c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61565" title="0x007d" tabindex="0">\uf07d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61566" title="0x007e" tabindex="0">\uf07e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61567" title="0x007f" tabindex="0">\uf07f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61568" title="0x0080" tabindex="0">\uf080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61569" title="0x0081" tabindex="0">\uf081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61570" title="0x0082" tabindex="0">\uf082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61571" title="0x0083" tabindex="0">\uf083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61572" title="0x0084" tabindex="0">\uf084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61573" title="0x0085" tabindex="0">\uf085</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61574" title="0x0086" tabindex="0">\uf086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61575" title="0x0087" tabindex="0">\uf087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61576" title="0x0088" tabindex="0">\uf088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61577" title="0x0089" tabindex="0">\uf089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61578" title="0x008a" tabindex="0">\uf08a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61579" title="0x008b" tabindex="0">\uf08b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61580" title="0x008c" tabindex="0">\uf08c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61581" title="0x008d" tabindex="0">\uf08d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61582" title="0x008e" tabindex="0">\uf08e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61583" title="0x008f" tabindex="0">\uf08f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61584" title="0x0090" tabindex="0">\uf090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61585" title="0x0091" tabindex="0">\uf091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61586" title="0x0092" tabindex="0">\uf092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61587" title="0x0093" tabindex="0">\uf093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61588" title="0x0094" tabindex="0">\uf094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61589" title="0x0095" tabindex="0">\uf095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61590" title="0x0096" tabindex="0">\uf096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61591" title="0x0097" tabindex="0">\uf097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61592" title="0x0098" tabindex="0">\uf098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61593" title="0x0099" tabindex="0">\uf099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61594" title="0x009a" tabindex="0">\uf09a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61595" title="0x009b" tabindex="0">\uf09b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61596" title="0x009c" tabindex="0">\uf09c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61597" title="0x009d" tabindex="0">\uf09d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61598" title="0x009e" tabindex="0">\uf09e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61599" title="0x009f" tabindex="0">\uf09f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61600" title="0x00a0" tabindex="0">\uf0a0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61601" title="0x00a1" tabindex="0">\uf0a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61602" title="0x00a2" tabindex="0">\uf0a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61603" title="0x00a3" tabindex="0">\uf0a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61604" title="0x00a4" tabindex="0">\uf0a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61605" title="0x00a5" tabindex="0">\uf0a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61606" title="0x00a6" tabindex="0">\uf0a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61607" title="0x00a7" tabindex="0">\uf0a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61608" title="0x00a8" tabindex="0">\uf0a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61609" title="0x00a9" tabindex="0">\uf0a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61610" title="0x00aa" tabindex="0">\uf0aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61611" title="0x00ab" tabindex="0">\uf0ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61612" title="0x00ac" tabindex="0">\uf0ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61613" title="0x00ad" tabindex="0">\uf0ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61614" title="0x00ae" tabindex="0">\uf0ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61615" title="0x00af" tabindex="0">\uf0af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61616" title="0x00b0" tabindex="0">\uf0b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61617" title="0x00b1" tabindex="0">\uf0b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61618" title="0x00b2" tabindex="0">\uf0b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61619" title="0x00b3" tabindex="0">\uf0b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61620" title="0x00b4" tabindex="0">\uf0b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61621" title="0x00b5" tabindex="0">\uf0b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61622" title="0x00b6" tabindex="0">\uf0b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61623" title="0x00b7" tabindex="0">\uf0b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61624" title="0x00b8" tabindex="0">\uf0b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61625" title="0x00b9" tabindex="0">\uf0b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61626" title="0x00ba" tabindex="0">\uf0ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61627" title="0x00bb" tabindex="0">\uf0bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61628" title="0x00bc" tabindex="0">\uf0bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61629" title="0x00bd" tabindex="0">\uf0bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61630" title="0x00be" tabindex="0">\uf0be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61631" title="0x00bf" tabindex="0">\uf0bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61632" title="0x00c0" tabindex="0">\uf0c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61633" title="0x00c1" tabindex="0">\uf0c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61634" title="0x00c2" tabindex="0">\uf0c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61635" title="0x00c3" tabindex="0">\uf0c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61636" title="0x00c4" tabindex="0">\uf0c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61637" title="0x00c5" tabindex="0">\uf0c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61638" title="0x00c6" tabindex="0">\uf0c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61639" title="0x00c7" tabindex="0">\uf0c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61640" title="0x00c8" tabindex="0">\uf0c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61641" title="0x00c9" tabindex="0">\uf0c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61642" title="0x00ca" tabindex="0">\uf0ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61643" title="0x00cb" tabindex="0">\uf0cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61644" title="0x00cc" tabindex="0">\uf0cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61645" title="0x00cd" tabindex="0">\uf0cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61646" title="0x00ce" tabindex="0">\uf0ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61647" title="0x00cf" tabindex="0">\uf0cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61648" title="0x00d0" tabindex="0">\uf0d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61649" title="0x00d1" tabindex="0">\uf0d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61650" title="0x00d2" tabindex="0">\uf0d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61651" title="0x00d3" tabindex="0">\uf0d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61652" title="0x00d4" tabindex="0">\uf0d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61653" title="0x00d5" tabindex="0">\uf0d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61654" title="0x00d6" tabindex="0">\uf0d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61655" title="0x00d7" tabindex="0">\uf0d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61656" title="0x00d8" tabindex="0">\uf0d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61657" title="0x00d9" tabindex="0">\uf0d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61658" title="0x00da" tabindex="0">\uf0da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61659" title="0x00db" tabindex="0">\uf0db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61660" title="0x00dc" tabindex="0">\uf0dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61661" title="0x00dd" tabindex="0">\uf0dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61662" title="0x00de" tabindex="0">\uf0de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61663" title="0x00df" tabindex="0">\uf0df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61664" title="0x00e0" tabindex="0">\uf0e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61665" title="0x00e1" tabindex="0">\uf0e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61666" title="0x00e2" tabindex="0">\uf0e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61667" title="0x00e3" tabindex="0">\uf0e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61668" title="0x00e4" tabindex="0">\uf0e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61669" title="0x00e5" tabindex="0">\uf0e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61670" title="0x00e6" tabindex="0">\uf0e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61671" title="0x00e7" tabindex="0">\uf0e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61672" title="0x00e8" tabindex="0">\uf0e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61673" title="0x00e9" tabindex="0">\uf0e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61674" title="0x00ea" tabindex="0">\uf0ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61675" title="0x00eb" tabindex="0">\uf0eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61676" title="0x00ec" tabindex="0">\uf0ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61677" title="0x00ed" tabindex="0">\uf0ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61678" title="0x00ee" tabindex="0">\uf0ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61679" title="0x00ef" tabindex="0">\uf0ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61680" title="0x00f0" tabindex="0">\uf0f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61681" title="0x00f1" tabindex="0">\uf0f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61682" title="0x00f2" tabindex="0">\uf0f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61683" title="0x00f3" tabindex="0">\uf0f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61684" title="0x00f4" tabindex="0">\uf0f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61685" title="0x00f5" tabindex="0">\uf0f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61686" title="0x00f6" tabindex="0">\uf0f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61687" title="0x00f7" tabindex="0">\uf0f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61688" title="0x00f8" tabindex="0">\uf0f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61689" title="0x00f9" tabindex="0">\uf0f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61690" title="0x00fa" tabindex="0">\uf0fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61691" title="0x00fb" tabindex="0">\uf0fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61692" title="0x00fc" tabindex="0">\uf0fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61693" title="0x00fd" tabindex="0">\uf0fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61694" title="0x00fe" tabindex="0">\uf0fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61695" title="0x00ff" tabindex="0">\uf0ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>')):
(this.VFb=32,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_32" title="0x0020" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_33" title="0x0021" tabindex="0">!</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_34" title="0x0022" tabindex="0">"</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_35" title="0x0023" tabindex="0">#</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_36" title="0x0024" tabindex="0">$</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_37" title="0x0025" tabindex="0">%</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_38" title="0x0026" tabindex="0">&amp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_39" title="0x0027" tabindex="0">\'</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_40" title="0x0028" tabindex="0">(</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_41" title="0x0029" tabindex="0">)</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_42" title="0x002a" tabindex="0">*</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_43" title="0x002b" tabindex="0">+</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_44" title="0x002c" tabindex="0">,</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_45" title="0x002d" tabindex="0">-</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_46" title="0x002e" tabindex="0">.</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_47" title="0x002f" tabindex="0">/</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_48" title="0x0030" tabindex="0">0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_49" title="0x0031" tabindex="0">1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_50" title="0x0032" tabindex="0">2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_51" title="0x0033" tabindex="0">3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_52" title="0x0034" tabindex="0">4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_53" title="0x0035" tabindex="0">5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_54" title="0x0036" tabindex="0">6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_55" title="0x0037" tabindex="0">7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_56" title="0x0038" tabindex="0">8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_57" title="0x0039" tabindex="0">9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_58" title="0x003a" tabindex="0">:</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_59" title="0x003b" tabindex="0">;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_60" title="0x003c" tabindex="0">&lt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61" title="0x003d" tabindex="0">=</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_62" title="0x003e" tabindex="0">&gt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_63" title="0x003f" tabindex="0">?</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_64" title="0x0040" tabindex="0">@</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_65" title="0x0041" tabindex="0">A</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_66" title="0x0042" tabindex="0">B</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_67" title="0x0043" tabindex="0">C</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_68" title="0x0044" tabindex="0">D</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_69" title="0x0045" tabindex="0">E</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_70" title="0x0046" tabindex="0">F</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_71" title="0x0047" tabindex="0">G</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_72" title="0x0048" tabindex="0">H</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_73" title="0x0049" tabindex="0">I</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_74" title="0x004a" tabindex="0">J</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_75" title="0x004b" tabindex="0">K</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_76" title="0x004c" tabindex="0">L</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_77" title="0x004d" tabindex="0">M</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_78" title="0x004e" tabindex="0">N</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_79" title="0x004f" tabindex="0">O</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_80" title="0x0050" tabindex="0">P</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_81" title="0x0051" tabindex="0">Q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_82" title="0x0052" tabindex="0">R</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_83" title="0x0053" tabindex="0">S</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_84" title="0x0054" tabindex="0">T</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_85" title="0x0055" tabindex="0">U</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_86" title="0x0056" tabindex="0">V</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_87" title="0x0057" tabindex="0">W</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_88" title="0x0058" tabindex="0">X</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_89" title="0x0059" tabindex="0">Y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_90" title="0x005a" tabindex="0">Z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_91" title="0x005b" tabindex="0">[</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_92" title="0x005c" tabindex="0">\\</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_93" title="0x005d" tabindex="0">]</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_94" title="0x005e" tabindex="0">^</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_95" title="0x005f" tabindex="0">_</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_96" title="0x0060" tabindex="0">`</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_97" title="0x0061" tabindex="0">a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_98" title="0x0062" tabindex="0">b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_99" title="0x0063" tabindex="0">c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_100" title="0x0064" tabindex="0">d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_101" title="0x0065" tabindex="0">e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_102" title="0x0066" tabindex="0">f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_103" title="0x0067" tabindex="0">g</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_104" title="0x0068" tabindex="0">h</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_105" title="0x0069" tabindex="0">i</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_106" title="0x006a" tabindex="0">j</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_107" title="0x006b" tabindex="0">k</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_108" title="0x006c" tabindex="0">l</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_109" title="0x006d" tabindex="0">m</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_110" title="0x006e" tabindex="0">n</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_111" title="0x006f" tabindex="0">o</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_112" title="0x0070" tabindex="0">p</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_113" title="0x0071" tabindex="0">q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_114" title="0x0072" tabindex="0">r</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_115" title="0x0073" tabindex="0">s</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_116" title="0x0074" tabindex="0">t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_117" title="0x0075" tabindex="0">u</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_118" title="0x0076" tabindex="0">v</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_119" title="0x0077" tabindex="0">w</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_120" title="0x0078" tabindex="0">x</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_121" title="0x0079" tabindex="0">y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_122" title="0x007a" tabindex="0">z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_123" title="0x007b" tabindex="0">{</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_124" title="0x007c" tabindex="0">|</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_125" title="0x007d" tabindex="0">}</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_126" title="0x007e" tabindex="0">~</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_127" title="0x007f" tabindex="0">\u007f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_128" title="0x0080" tabindex="0">\u0080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_129" title="0x0081" tabindex="0">\u0081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_130" title="0x0082" tabindex="0">\u0082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_131" title="0x0083" tabindex="0">\u0083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_132" title="0x0084" tabindex="0">\u0084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_133" title="0x0085" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_134" title="0x0086" tabindex="0">\u0086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_135" title="0x0087" tabindex="0">\u0087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_136" title="0x0088" tabindex="0">\u0088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_137" title="0x0089" tabindex="0">\u0089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_138" title="0x008a" tabindex="0">\u008a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_139" title="0x008b" tabindex="0">\u008b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_140" title="0x008c" tabindex="0">\u008c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_141" title="0x008d" tabindex="0">\u008d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_142" title="0x008e" tabindex="0">\u008e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_143" title="0x008f" tabindex="0">\u008f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_144" title="0x0090" tabindex="0">\u0090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_145" title="0x0091" tabindex="0">\u0091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_146" title="0x0092" tabindex="0">\u0092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_147" title="0x0093" tabindex="0">\u0093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_148" title="0x0094" tabindex="0">\u0094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_149" title="0x0095" tabindex="0">\u0095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_150" title="0x0096" tabindex="0">\u0096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_151" title="0x0097" tabindex="0">\u0097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_152" title="0x0098" tabindex="0">\u0098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_153" title="0x0099" tabindex="0">\u0099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_154" title="0x009a" tabindex="0">\u009a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_155" title="0x009b" tabindex="0">\u009b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_156" title="0x009c" tabindex="0">\u009c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_157" title="0x009d" tabindex="0">\u009d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_158" title="0x009e" tabindex="0">\u009e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_159" title="0x009f" tabindex="0">\u009f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_160" title="0x00a0" tabindex="0">&nbsp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_161" title="0x00a1" tabindex="0">\u00a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_162" title="0x00a2" tabindex="0">\u00a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_163" title="0x00a3" tabindex="0">\u00a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_164" title="0x00a4" tabindex="0">\u00a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_165" title="0x00a5" tabindex="0">\u00a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_166" title="0x00a6" tabindex="0">\u00a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_167" title="0x00a7" tabindex="0">\u00a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_168" title="0x00a8" tabindex="0">\u00a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_169" title="0x00a9" tabindex="0">\u00a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_170" title="0x00aa" tabindex="0">\u00aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_171" title="0x00ab" tabindex="0">\u00ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_172" title="0x00ac" tabindex="0">\u00ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_173" title="0x00ad" tabindex="0">\u00ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_174" title="0x00ae" tabindex="0">\u00ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_175" title="0x00af" tabindex="0">\u00af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_176" title="0x00b0" tabindex="0">\u00b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_177" title="0x00b1" tabindex="0">\u00b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_178" title="0x00b2" tabindex="0">\u00b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_179" title="0x00b3" tabindex="0">\u00b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_180" title="0x00b4" tabindex="0">\u00b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_181" title="0x00b5" tabindex="0">\u00b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_182" title="0x00b6" tabindex="0">\u00b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_183" title="0x00b7" tabindex="0">\u00b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_184" title="0x00b8" tabindex="0">\u00b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_185" title="0x00b9" tabindex="0">\u00b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_186" title="0x00ba" tabindex="0">\u00ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_187" title="0x00bb" tabindex="0">\u00bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_188" title="0x00bc" tabindex="0">\u00bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_189" title="0x00bd" tabindex="0">\u00bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_190" title="0x00be" tabindex="0">\u00be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_191" title="0x00bf" tabindex="0">\u00bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_192" title="0x00c0" tabindex="0">\u00c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_193" title="0x00c1" tabindex="0">\u00c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_194" title="0x00c2" tabindex="0">\u00c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_195" title="0x00c3" tabindex="0">\u00c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_196" title="0x00c4" tabindex="0">\u00c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_197" title="0x00c5" tabindex="0">\u00c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_198" title="0x00c6" tabindex="0">\u00c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_199" title="0x00c7" tabindex="0">\u00c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_200" title="0x00c8" tabindex="0">\u00c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_201" title="0x00c9" tabindex="0">\u00c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_202" title="0x00ca" tabindex="0">\u00ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_203" title="0x00cb" tabindex="0">\u00cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_204" title="0x00cc" tabindex="0">\u00cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_205" title="0x00cd" tabindex="0">\u00cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_206" title="0x00ce" tabindex="0">\u00ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_207" title="0x00cf" tabindex="0">\u00cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_208" title="0x00d0" tabindex="0">\u00d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_209" title="0x00d1" tabindex="0">\u00d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_210" title="0x00d2" tabindex="0">\u00d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_211" title="0x00d3" tabindex="0">\u00d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_212" title="0x00d4" tabindex="0">\u00d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_213" title="0x00d5" tabindex="0">\u00d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_214" title="0x00d6" tabindex="0">\u00d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_215" title="0x00d7" tabindex="0">\u00d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_216" title="0x00d8" tabindex="0">\u00d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_217" title="0x00d9" tabindex="0">\u00d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_218" title="0x00da" tabindex="0">\u00da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_219" title="0x00db" tabindex="0">\u00db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_220" title="0x00dc" tabindex="0">\u00dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_221" title="0x00dd" tabindex="0">\u00dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_222" title="0x00de" tabindex="0">\u00de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_223" title="0x00df" tabindex="0">\u00df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_224" title="0x00e0" tabindex="0">\u00e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_225" title="0x00e1" tabindex="0">\u00e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_226" title="0x00e2" tabindex="0">\u00e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_227" title="0x00e3" tabindex="0">\u00e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_228" title="0x00e4" tabindex="0">\u00e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_229" title="0x00e5" tabindex="0">\u00e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_230" title="0x00e6" tabindex="0">\u00e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_231" title="0x00e7" tabindex="0">\u00e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_232" title="0x00e8" tabindex="0">\u00e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_233" title="0x00e9" tabindex="0">\u00e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_234" title="0x00ea" tabindex="0">\u00ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_235" title="0x00eb" tabindex="0">\u00eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_236" title="0x00ec" tabindex="0">\u00ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_237" title="0x00ed" tabindex="0">\u00ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_238" title="0x00ee" tabindex="0">\u00ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_239" title="0x00ef" tabindex="0">\u00ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_240" title="0x00f0" tabindex="0">\u00f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_241" title="0x00f1" tabindex="0">\u00f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_242" title="0x00f2" tabindex="0">\u00f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_243" title="0x00f3" tabindex="0">\u00f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_244" title="0x00f4" tabindex="0">\u00f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_245" title="0x00f5" tabindex="0">\u00f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_246" title="0x00f6" tabindex="0">\u00f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_247" title="0x00f7" tabindex="0">\u00f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_248" title="0x00f8" tabindex="0">\u00f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_249" title="0x00f9" tabindex="0">\u00f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_250" title="0x00fa" tabindex="0">\u00fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_251" title="0x00fb" tabindex="0">\u00fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_252" title="0x00fc" tabindex="0">\u00fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_253" title="0x00fd" tabindex="0">\u00fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_254" title="0x00fe" tabindex="0">\u00fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_255" title="0x00ff" tabindex="0">\u00ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>'));
b.append("</table>");return b.toString()}OMh(b){b&&-1!==b.indexOf(" ")&&(b="'"+b+"'");return b}BXd(b,h,r,A){h=document.getElementById(h);this.yv.w5a(b,r);r=this.yv.hPb(b,A);h.appendChild(r);this.yv.Dua(b)}dispose(){this.OV||(this.yv.B0(Zt.d3d),this.OV=!0);super.dispose()}}Zt.d3d="DefineNewBulletFontStyleComboBox";Zt.Zfc="DefineNewBulletTableContainer";Object(u.a)(Zt,"DefineNewBulletDialog",ig.a,[]);class uE{W2c(){return ub.a.Cwn}A3c(){return ub.a.kkg}}Object(u.a)(uE,"ListMarkerGalleryBulletCommands",
null,[287]);class dh{W2c(){return ub.a.Ewn}A3c(){return ub.a.x$n}}Object(u.a)(dh,"ListMarkerGalleryMultilevelCommands",null,[287]);class hq{W2c(){return ub.a.Fwn}A3c(){return ub.a.lkg}}Object(u.a)(hq,"ListMarkerGalleryNumberingCommands",null,[287]);class dy{constructor(b,h,r,A,M){this.FFa=this.ARa=null;this.pci=aa=>{if(!this.FFa)return 2;if(this.FFa.focusManager.au().Nk.zra.id.startsWith(Zt.Zfc)){let oa=null;aa===ub.a.bZd?oa=this.FFa.d6a:aa===ub.a.aZd&&(oa=document.getElementById(Zt.d3d));if(!oa)return 2;
this.FFa.focusManager.au().Nk.hA(oa);oa.focus()}else if(aa===ub.a.bZd)this.FFa.focusManager.au().Vqc();else if(aa===ub.a.aZd)this.FFa.focusManager.au().Tqc();else return 2;return 32};this.G5i=(aa,oa)=>{aa=null;oa.view.te&&(aa=oa.view);return aa&&aa.mb?32:(Tc.b(17887427,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",oa.toString()),8)};this.mun=(aa,oa,Ja)=>1===Ja?32:2===Ja?(aa=this.skc(oa),aa=Wa.FormattingReader.Rs(aa).cache.gI,
this.FFa=new Zt(this.pMk,Cd.FocusManager.instance(),y.AFrameworkApplication.va,aa),32):8;this.Fgd=(aa,oa,Ja,fb,Cb)=>{if(1===Ja)return 32;if(2===Ja&&!Cb)return 8;if(this.FFa.VPi){for(aa=0;aa<Nz.a.RSc.length;aa++)gq.FontUtils.M2j(Nz.a.RSc[aa]);this.FFa.VPi=!1}kl.a.Lae(oa);Cb.PopulationXML=gq.FontUtils.Aqi(kl.a.pye,kl.a.jEf,ub.a.$Yd);return 32};this.w$n=(aa,oa,Ja,fb,Cb)=>{aa=oa.contextId===lc.a.bS;if(1===Ja||!aa)return aa?32:8;if(2===Ja&&!Cb)return 8;Cb.MenuItems=this.DBk.Xvm();return 32};this.LMl=(aa,
oa,Ja,fb,Cb)=>{if(1===Ja)return 32;if(2===Ja){aa=Object(ya.a)(240,Cb);if(!aa||!aa.rd)return 8;this.FFa.fontName=aa.rd.fontName;this.FFa.gtp();return 32}return 8};this.ga=b;this.jg=A.resolve(10);this.Z9=h;this.pMk=r;switch(this.Z9){case 0:b=A.resolve(714);this.ARa=new uE;break;case 1:b=A.resolve(715);this.ARa=new hq;break;case 2:b=A.resolve(929);this.ARa=new dh;break;default:b=A.resolve(714),this.ARa=new uE}M=this.jg?this.jg.Kvm(M):null;b.eEe(M);this.DBk=new Nz.a(h,b,M,!!y.AFrameworkApplication.ua&&
y.AFrameworkApplication.ua.Ib.lTb)}Xb(){this.ga.qa(this.ARa.A3c(),lc.a.view,df.a.V_a.m8h(11));this.ga.qa(this.ARa.A3c(),lc.a.bS,this.w$n);this.ga.Pc(this.ARa.A3c(),1124);this.Z9||(this.ga.fb(ub.a.h2f,lc.a.view,this.mun,1028),this.ga.fb(ub.a.Fgd,lc.a.view,this.Fgd,1124),this.ga.fb(ub.a.$Yd,lc.a.view,this.LMl,1028),this.ga.fb(ub.a.bZd,we.a.frame,this.pci,64),this.ga.fb(ub.a.aZd,we.a.frame,this.pci,64));this.ga.qa(this.ARa.W2c(),lc.a.view,this.G5i);this.ga.qa(this.ARa.W2c(),lc.a.bS,this.G5i);this.ga.Pc(this.ARa.W2c(),
1124)}skc(b){return this.y4d(b).Qa}y4d(b){let h=null;b=b.view;return b?h=ze.a.uk(b.mb.gb.K(0),!1,!1):h}}Object(u.a)(dy,"ListMarkerGalleryActor",null,[241]);class vE{constructor(){this.Qf=this.W=null}get name(){return"Box4.ListMarkerGallery"}init(){if(Object(Lb.a)()){var b=Object(Lb.a)();b.Le&&(this.Qf=b.Le.od,this.Hro())}}dispose(){}uc(b){this.W=b}Hro(){(new dy(y.AFrameworkApplication.va,1,this.W.resolve(48).kha,this.W,this.Qf)).Xb();(new dy(y.AFrameworkApplication.va,0,this.W.resolve(48).kha,this.W,
this.Qf)).Xb();(new dy(y.AFrameworkApplication.va,2,this.W.resolve(48).kha,this.W,this.Qf)).Xb()}static main(){K.a.instance.Lc(new vE)}}Object(u.a)(vE,"Box4ListMarkerGalleryPackage",null,[0,1]);var jB=d(496),Pz=d(631),vG=d(554),Vs=d(167);const pw=b=>{b.element.style.top=""};var Hp=d(710);class $t{constructor(b,h,r){this.AJ=!1;this.ohb=0;this.hia=this.Owh=null;this.xRn=A=>{A.element.style.top="";y.AFrameworkApplication.ua.Cdd()};this.pRn=A=>{A.element.parentNode.removeChild(A.element);this.htmlElement.hasChildNodes()||
this.set_visible(!1);y.AFrameworkApplication.ua.Cdd()};this.Pv=()=>{const A=this.Qt.entries.length,M=Sys.UI.DomElement.getBounds(this.htmlElement).height;let aa;for(let oa=0;oa<A;++oa)aa=this.Qt.entries[oa],aa.htmlElement&&aa.VEj();this.ohb=Sys.UI.DomElement.getBounds(this.htmlElement).height;M!==this.ohb&&this.d2b()};this.HIa=()=>!0;this.il=b;this.uNk=h;this.Qt=r;this.R9=b.ownerDocument.createElement("div");this.htmlElement.className="WACBusinessBar";(this.Rx=!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.m3)&&
!this.Qt.fxf&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";Y.a.uj&&Sys.UI.DomElement.addCssClass(this.htmlElement,"FireFox")}get htmlElement(){return this.R9}get visible(){return this.AJ}set_visible(b){if(this.AJ!==b)return(this.AJ=b)?this.Gif():this.iYc(),b}dispose(){this.visible&&this.iYc();Fd.a.DT(this.htmlElement);this.il=this.R9=null}pSj(b,h){const r=b.htmlElement||b.createElement();h===this.htmlElement.childNodes.length?this.htmlElement.appendChild(r):
this.htmlElement.insertBefore(r,this.htmlElement.childNodes[h]);b.VEj();this.ohb+=b.htmlElement.clientHeight;var A=this.htmlElement.childNodes,M=b.eQh,aa=this.xRn;Vs.WacAirSpace.eY(r,"Shared_BasicClass");var oa=new vG.a(r);oa.Uya(0,1);const Ja=new Pz.a(r);Ja.NHa(r.clientTop-30,r.clientTop);M?(Vs.WacAirSpace.Eub(oa,null,null),Vs.WacAirSpace.Eub(Ja,null,aa)):(Vs.WacAirSpace.animate(oa,null,null),Vs.WacAirSpace.animate(Ja,null,aa));for(h+=1;h<A.length;h++)aa=A[h],Vs.WacAirSpace.eY(aa,"Shared_BasicClass"),
oa=new Pz.a(aa),oa.NHa(aa.clientTop-r.clientHeight,aa.clientTop),M?Vs.WacAirSpace.Eub(oa,null,null):Vs.WacAirSpace.animate(oa,null,null);b.G3o();this.set_visible(!0)}jNi(b){const h=b.htmlElement;if(Fd.a.Inc(h)){this.ohb-=b.htmlElement.clientHeight;var r=h.parentNode.children;b=b.eQh;var A=this.pRn;Vs.WacAirSpace.eY(h,"Shared_BasicClass");var M=new jB.a(h);M.Uya(1,0);b?Vs.WacAirSpace.Eub(M,null,A):Vs.WacAirSpace.animate(M,null,A);A=!1;for(M=0;M<r.length;M++){if(A){const aa=r[M];Vs.WacAirSpace.eY(aa,
"Shared_BasicClass");const oa=new Pz.a(aa);oa.NHa(aa.clientTop,-h.clientHeight);b?Vs.WacAirSpace.Eub(oa,null,pw):Vs.WacAirSpace.animate(oa,null,pw)}A||r[M]!==h||(A=!0)}}}Gif(){""===this.il.style.top.trim()&&(this.il.style.top=this.il.offsetTop+"px");this.htmlElement.style.left=this.il.style.left;this.htmlElement.style.top=this.il.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility="visible";var b=Sys.UI.DomElement.getBounds(this.htmlElement);this.Owh=this.il.style.top;
this.ohb=b.height;this.d2b();y.AFrameworkApplication.ua.b2(this.Pv);mf.a.addHandler(this.htmlElement,Jd.a.xve,mf.a.Vdc);this.hia=this.HIa;y.AFrameworkApplication.ua.oEa.nb(this.htmlElement,this.hia,null);if(Cd.FocusManager.nM()){var h=Cd.FocusManager.instance();b=h.ie(Hp.a.FTa);b.parent=id.AFrame.Eq;const r=new Re.DOMFocusListing(()=>this.htmlElement);r.Yn(1);r.Yn(2);r.Yn(8);h.Vqa(()=>this.htmlElement,b,r);h=h.getRegion(Hp.a.FTa);h.AZa();h.NR=!0;h.K6a=!0;const A=y.AFrameworkApplication.ua.Ay;b.DJb(()=>
{A.ay(Hp.a.FTa)});A.rW(Hp.a.FTa);(r.Jka||y.AFrameworkApplication.J.$("ReactBusinessBarIsEnabled"))&&A.MK(Hp.a.FTa)}}iYc(){this.WRj()&&(this.il.style.top=this.Owh);this.htmlElement.style.visibility="hidden";y.AFrameworkApplication.ua&&(Cd.FocusManager.nM()&&Cd.FocusManager.instance().Swb(Hp.a.FTa),this.hia&&(y.AFrameworkApplication.ua.oEa.xc(this.htmlElement,this.hia),this.hia=null));mf.a.removeHandler(this.htmlElement,Jd.a.xve,mf.a.Vdc)}d2b(){if(this.WRj()&&this.visible){var b=this.il,h=this.ohb+
this.uNk;const r=Fd.a.zP(b.style.top);Vs.WacAirSpace.eY(b,"Shared_BasicClass");b=new Pz.a(b);b.NHa(r,h);Vs.WacAirSpace.animate(b,null,null)}}WRj(){return!this.Rx&&!this.Qt.fxf}}Object(u.a)($t,"BusinessBarDom",null,[1908,10]);var Or;(function(b){b[b.none=0]="none";b[b.CTp=1]="corruptPage";b[b.RTp=2]="currentPageStatus";b[b.dVp=3]="documentMarkedAsFinal";b[b.kVp=4]="documentSigned";b[b.JXp=5]="fileAccess";b[b.C2p=6]="kickoutWithDataLoss";b[b.JU=7]="lostSession";b[b.Z3p=8]="malformedHyperlinkUris";b[b.Jgj=
9]="odt";b[b.Rdq=10]="readonlyRecommended";b[b.agq=11]="saveReplaySuccess";b[b.$fq=12]="saveReplayFailed";b[b.zqp=13]="unsupportedObjects";b[b.Tmq=14]="word11Compat";b[b.Plq=15]="unsupportedBrowser";b[b.vQp=16]="applicationNotification";b[b.siq=17]="skypeDocChatFailed";b[b.Ohq=18]="showDialogInNewWindowInfo";b[b.ANo=19]="sessionExpired";b[b.ian=20]="irmPolicyDescription";b[b.Vcq=21]="policyWarningMessage";b[b.Akq=22]="thirdPartyAddinDisabled";b[b.TYp=23]="gdprPrivacyNotice";b[b.hUp=24]="datacenterDecommissionWarning";
b[b.XZp=25]="graphMergePrompt";b[b.Ndq=26]="readOnlyDocument";b[b.MUp=27]="dictationSilence";b[b.KQp=28]="autoSensitivityLabel";b[b.Zdq=29]="recommendedSensitivityLabel";b[b.LUp=30]="dictationDebugInfo";b[b.Fbq=31]="oneNoteCovid19Message";b[b.lSp=32]="citationStylePrompt";b[b.Lbq=33]="oneNoteViewModeMessage";b[b.Kbq=34]="oneNotePrintImagesDownloading";b[b.Jbq=35]="oneNotePagePrintReady";b[b.e2p=36]="irmPolicyCausedFeatureDisabled";b[b.a4p=37]="mandatoryLabel";b[b.policyTip=38]="policyTip";b[b.J4p=
39]="minorVersionLimit";b[b.Yjq=40]="testEntry1";b[b.Zjq=41]="testEntry2";b[b.$jq=42]="testEntry3";b[b.akq=43]="testEntry4";b[b.bkq=44]="testEntry5";b[b.ckq=45]="testEntry6";b[b.dkq=46]="testEntry7"})(Or||(Or={}));Object(u.b)("BusinessBarId",Or);class qw{constructor(b,h=0,r=null,A=null){this.Ioh=this.Pdh=!1;this.J9b=null;this.pC=[];this.c1a=A||new $t(b,h,this);this.$4m(r)}$4m(b){if(b){this.J9b={};b=b.ranking;for(let h=0;h<b.length;h++)this.J9b[Or[b[h]]]=h}}dispose(){this.c1a.dispose();bm.a.rvg(this.pC);
this.pC=null}get htmlElement(){return this.c1a.htmlElement}get visible(){return this.c1a.visible}get fxf(){return this.Pdh}set fxf(b){this.Pdh=b}get b_f(){return this.Ioh}set b_f(b){this.Ioh=b}get entries(){return this.pC}set entries(b){this.pC=b}s7(b){for(let h=0;h<this.pC.length;h++)if(this.pC[h].id===b)return!0;return!1}Jz(b,h=!1,r=null,A=null,M=null){b.NQ=this;let aa=this.Ctm(b.id);h&&!this.J9b&&(aa=0);aa<qw.$Ub&&(this.c1a.pSj(b,aa),this.pC.length>=qw.$Ub&&this.c1a.jNi(this.pC[qw.$Ub-1]),this.c1a.d2b());
Array.insert(this.pC,aa,b);v.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",Or[b.id],void 0===b.L6a||null===b.L6a?"":b.L6a);b.errorCode&&y.AFrameworkApplication.iS(b.errorCode,r,A,M)}removeEntry(b){const h=Array.indexOf(this.pC,b);-1!==h&&h<qw.$Ub&&(this.pC.length>qw.$Ub&&this.c1a.pSj(this.pC[qw.$Ub],qw.$Ub),this.c1a.jNi(b),this.c1a.d2b());Array.remove(this.pC,b);b.NQ=null;b.dispose()}Ctm(b){if(!this.J9b||0===b)return this.pC.length;b=this.J9b[Or[b]];if(void 0===
b||null===b)return this.pC.length;for(let h=0;h<this.pC.length;h++)if(b<this.J9b[Or[this.pC[h].id]])return h;return this.pC.length}}qw.$Ub=2;Object(u.a)(qw,"BusinessBar",null,[1885,10,1886]);class oJ{create(b,h,r){return new jg.a(b,h,r)}}Object(u.a)(oJ,"Factory",null,[1906]);class MC{static Wvl(b,h){b.register(qw,1185).as(445).ha().Sd(()=>new qw(h.value,0,b.Oa(944)));b.register(oJ,"CommonUI.BusinessBarEntry.Factory").as(811).ha()}}Object(u.a)(MC,"CommonUIComponentConfiguration",null,[]);var wG=d(1647);
class rw extends wG.a{constructor(){super()}static get instance(){return rw._instance||rw.jUf()}static jUf(){rw._instance=new rw;return rw._instance}}rw._instance=null;Object(u.a)(rw,"ReactRootManager",wG.a,[264,265]);class wE extends hk.a{constructor(){super()}get ControlType(){return 3}}Object(u.a)(wE,"CompoundButtonProps",hk.a,[]);class xG{constructor(b,h,r,A,M,aa,oa){this.qZ=h;this.HNc=b;this.Tmh=h.Een;this.L7b=h.J9c;this.nWe=aa;this.zCd=A;this.ACd=M;this.uCd=r;this.CM=oa;this.Bib=new Ng.a;this.Bib.Z(1,
"SpellingIssue_16x16x32");this.Bib.Z(2,"GrammarIssue_16x16x32");this.Bib.Z(3,"WritingIssue_16x16x32");this.Bib.Z(4,null);this.Bib.Z(0,null)}create(b,h,r){h=Object(ya.a)(pq.a,h);if(!h)return v.ULS.sendTraceTag(25007833,375,15,"Expect EditorServiceErrorDetails."),"";const A=new Sys.StringBuilder;b=this.qzi(b);this.jXc(A,h,r,b);this.wsf(A,h);this.LGl(A,h,b);return A.toString()}iMb(b,h,r){const A=Object(ya.a)(pq.a,h);if(!A)return v.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),
[];h=[];b=this.qzi(b);this.jtf(h,A,r,b);this.xsf(h,A);this.MGl(h,A,b);for(r=0;r<h.length;r++)h[r].Id=`${Lv.ihi}_${r}`;return h}jXc(b,h,r,A=null){h.errorType?1===h.errorType&&(this.rhc(h)||b.append(this.glf(h,r,A))):b.append(this.HNc.build())}jtf(b,h,r,A=null){h.errorType?1===h.errorType&&(this.rhc(h)||b.push(this.vdl(h,r,A))):b.push(this.HNc.EWh())}wsf(b,h){const r=new Sys.StringBuilder;this.jTj(h)?r.append(Aj.a("btnIgnoreAllSpellingError",(2===h.errorType?ub.a.WOa:ub.a.Nsa).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,
null)):this.rhc(h)||r.append(Aj.a("btnIgrnoreSpellingError",this.kyi(h.errorType).toString(),Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,null));this.pTj(h)&&(this.qZ.LVi&&r.append(Aj.a("btnDoNotCheckForThisIssue",ub.a.hNb.toString(),Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),r.append(Aj.a("btnGrammarOptions",ub.a.Ivb.toString(),I.a.Jf(Box4Intl.Box4Strings.l_GrammarOptions),null)));r.isEmpty()||(b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),b.append(r.toString()),
b.append("</Controls></MenuSection>"))}xsf(b,h){const r=Object.assign(new te.a,{ControlList:[]});if(this.jTj(h)){var A=ev.jD()?Object.assign(new hk.a,{ExternalId:"btnIgnoreAllSpellingErrorForAL",Command:ub.a.Nsa,LabelText:Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors}):Object.assign(new hk.a,{ExternalId:2===h.errorType?"UnknownAllSpellingError":"IgnoreAllSpellingError"});r.ControlList.push(A)}else this.rhc(h)||(A=Object.assign(new hk.a,{ExternalId:"btnIgrnoreSpellingError",Command:this.kyi(h.errorType).toString(),
LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),r.ControlList.push(A));this.pTj(h)&&(this.qZ.LVi&&(h=Object.assign(new hk.a,{ExternalId:"DoNotCheckForThisIssue"}),r.ControlList.push(h)),h=Object.assign(new hk.a,{ExternalId:"GrammerSettingsContext"}),r.ControlList.push(h));b.push(r)}qzi(b){if(!this.CM)return null;b=this.CM.language(this.CM.Rs(b.Qa));return tj.a.Hg(b)?tj.a.Hg(b).name:null}kyi(b){return 2===b?ub.a.WOa:this.qZ.Ihn?ub.a.X_m:ub.a.sBa}LGl(b,h,r=null){if(this.OAg(h)){var A=I.a.Jf(h.yu.CategoryTitle);
A=Aj.m(Lv.Ltc,Ka.a.Sya,this.Bib.K(h.proofingType),""!==A?A:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,[b.toString()],this.zCd,this.ACd);A=Aj.d("cgProofingOuter",[A]);b.clear();b.append(Aj.g("msProofingOuter",A,"Menu16",void 0,void 0,r,"ariaLabelledById"));v.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",h.proofingType,h.typeId)}}MGl(b,h,r=null){if(this.OAg(h)){var A=I.a.Jf(h.yu.CategoryTitle);r=Object.assign(new Se.a,{ExternalId:String.format("{0}_{1}",
Lv.Ltc,h.proofingType),Command:Ka.a.Sya.toString(),Image16by16Class:this.Bib.K(h.proofingType),LabelText:""!==A?A:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:r,Menu:Object.assign(new aj.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.Nfm(h),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});r.Menu.MenuSectionList.push(...b);Array.clear(b);A=Object.assign(new te.a,{ControlList:[]});A.ControlList.push(r);
b.push(A);v.ULS.sendTraceTag(39188234,375,50,"Show 2-level context menu of type {0}, critique id {1}",h.proofingType,h.typeId)}}glf(b,h,r=null){const A=this.xom(b);var M=[];let aa=!1;var oa=b.yu.Suggestions;if(oa)if(oa=oa.slice(0,Math.min(3,oa.length)),this.Tmh&&(aa=!Oe.a.any(oa,Ja=>!Ja||!Ja.Description)),1!==oa.length||oa[0].Action){let Ja=0,fb=null;aa&&(fb="font-weight: bold;");for(const Cb of oa){if(!Cb)continue;oa=null;let Gb="";const Sb=I.a.Jf(Cb.Text);aa&&(oa=this.Nsi(Cb.Description),Gb=this.Msi(Cb.Description));
M.push(Aj.a("btnCorrectWord"+Ja,h[Ja].toString(),Sb,null,null,null,null,null,fb,null,oa,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,A,Sb),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.D6h(b.token)),"ariaDescribedById",Gb));Ja++}}else h=I.a.Jf(oa[0].Text),M.push(Aj.a("btnCorrectWord0",ub.a.WOa.toString(),h,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,
A,h)));h="Menu16";0<M.length?aa&&(h="Menu16DescriptionEnabled"):M=[Aj.a("btnNoSuggestions",ub.a.WOa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)];return Aj.g("msUnknownWord",Aj.d(null,M),h,A,this.Zwm(b),r,"ariaLabelledById")}vdl(b,h,r=null){var A=1!==b.proofingType&&0!==b.proofingType?b.yu.ExplanationTitle:"";A=Object.assign(new te.a,{Title:A,Lang:r,ControlList:[]});let M=!1;var aa=b.yu.Suggestions;if(aa)if(aa=aa.slice(0,Math.min(3,aa.length)),this.Tmh&&(M=!Oe.a.any(aa,oa=>!oa||!oa.Description)),
1!==aa.length||aa[0].Action){let oa=0;for(const Ja of aa){if(!Ja)continue;aa=null;let fb="";M&&(aa=this.Nsi(Ja.Description),fb=this.Msi(Ja.Description));if(oa>=h.length)break;aa?(aa=Object.assign(new wE,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",oa,b.proofingType),Command:h[oa].toString(),LabelText:Ja.Text,Description:aa,Lang:r,AriaDescription:fb}),A.ControlList.push(aa)):(aa=Object.assign(new hk.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",oa,b.proofingType),
Command:h[oa].toString(),LabelText:Ja.Text,Lang:r,RoleInMenu:"menuitem"}),A.ControlList.push(aa));oa++}}else b=aa[0],b=Object.assign(new hk.a,{ExternalId:"NoSuggestion",Command:ub.a.WOa.toString(),LabelText:b.Text}),A.ControlList.push(b);0>=A.ControlList.length&&A.ControlList.push(Object.assign(new hk.a,{ExternalId:"btnNoSuggestions",Command:ub.a.WOa.toString(),LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));return A}xom(b){return I.a.Jf(0!==b.proofingType?b.yu.ExplanationTitle:"")}Zwm(b){return this.OAg(b)?
null:this.Bib.K(b.proofingType)}OAg(b){return this.L7b&&2!==b.errorType&&(1!==b.errorType||!this.rhc(b))}jTj(b){return this.nWe&&!!b.errorType&&1===b.proofingType&&!this.rhc(b)}Nfm(b){return 1===b.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.D6h(b.token)):""}pTj(b){return this.qZ.Aee&&this.L7b&&1===b.errorType&&(2===b.proofingType||3===b.proofingType)}rhc(b){return!!b.errorType&&!!this.uCd&&this.uCd.contains(b.token,b.lcid)}Nsi(b){return""===
b?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):b}Msi(b){return""!==b?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,b):""}D6h(b){let h="";if(b){let r;for(r=0;r<b.length-1;r++)h=h+b.charAt(r)+",";h+=b.charAt(r)}return h}}Object(u.a)(xG,"EditorServiceProofingContextMenuCreator",null,[]);class yG{get ranking(){return[24,23,7,6,19,1,5,9,22,2,4,3,10,8,14,13,11,12,15,16,17,18,20,21,36,25,26,27,28,29,30,31,32,33,34,35,37,40,41,42,43,44,45,46]}}Object(u.a)(yG,
"BusinessBarRankProvider",null,[263]);class xE{constructor(){this.W=null}get name(){return"Wonca.UI"}uc(b){this.W=b;b.ia(944,()=>new yG).ha();MC.Wvl(b,new Qf.a(()=>qa.StaticActiveAppFrame.za().pka));b.ia(829,()=>new xG(b.resolve(827),b.resolve(41),b.resolve(650),y.AFrameworkApplication.xfa,y.AFrameworkApplication.Ss,y.AFrameworkApplication.J.$("WordEditorProofingIgnoreAll"),b.resolve(386))).ha();b.ia("CommandUI.ReactRootManager",()=>rw.instance).as(706).ha()}init(){this.W.resolve(450);this.W.resolve(445)}dispose(){}static main(){K.a.instance.Lc(new xE)}}
Object(u.a)(xE,"WoncaUIPackage",null,[0,1]);class kx{constructor(b){this.oQ=this.KLc=null;this.vp=b}get key(){return"BOOKMARK"}get Cv(){return WordEditorIntl.WordEditorStrings.L_Bookmark}get WO(){return this.oQ}reset(b){this.oQ=b.node}wEa(b){let h=null;if(this.KLc&&this.vp.gVi(b,this.WO,this.KLc))return h=Object.assign(new Tt.a,{NF:this.key,contentObject:this.KLc}),{returnValue:!0,yG:h};this.KLc=null;if(!this.WO.hasBookmark)return{returnValue:!1,yG:h};const r=new vd.a;r.set(this.WO.Jj());this.vp.Tcd(r);
if(this.vp.Mbn(r)){let A=r.Zd();for(;A;){if(this.vp.gVi(b,this.WO,A))return this.KLc=A,h=Object.assign(new Tt.a,{NF:this.key,contentObject:A,description:this.uVa()}),{returnValue:!0,yG:h};A=r.Gk()}}return{returnValue:!1,yG:h}}uVa(){return null}}Object(u.a)(kx,"BookmarkDetailsProvider",null,[256,257]);class NC{constructor(b,h,r,A,M=null){this.qmh=this.ui=!1;this.GGd=this.iId=null;this.Uhj=(aa,oa)=>{aa=oa.node;aa.wc!==wm.a.eza?v.ULS.sendTraceTag(24155018,324,10,"node.RuntimeClassId = {0}",aa.wc):(v.ULS.sendTraceTag(24155019,
324,50,"OnBookmarkContainerNodeLoaded: Refreshing out of date bookmarks"),this.Rii(!0))};this.oG=r;this.kj=A;this.yz=h;this.$8g=b;this.AV=M}get ov(){return this.yz.value}initialize(){this.Ypg();this.ui=!0}Rii(b=!1){if(!this.ui)return v.ULS.sendTraceTag(24262273,324,10,"BookmarkGraphManager not initialized"),!1;if(!b&&this.qmh)return!0;let h=!1;this.kj.$d(()=>{this.iId={};this.GGd={};if(this.ov){const r=new vd.a;r.set(this.ov);if(this.qLn(r)){if(r.Ub(1)){do this.KVk(r.currentNode);while(r.Mf(1))}h=
this.qmh=!0}}},"BGM:EBGL");return h}DAa(b){return this.Rii()?b in this.GGd?this.GGd[b]:null:null}dispose(){this.ui?this.ypp():v.ULS.sendTraceTag(24262275,324,50,"BookmarkGraphManager not initialized")}qLn(b){if(this.oG.VR(b))return(b=b.Ub(30))||v.ULS.sendTraceTag(24691921,324,10,"Graph does not contain BookmarkContainer"),b;v.ULS.sendTraceTag(24691922,324,15,"Unable to move to Page Manifest");return null}Ypg(){v.ULS.sendTraceTag(24691923,324,50,"Registering OnBookmarkContainerNodeLoaded");this.$8g.EOh(this.Uhj)}ypp(){v.ULS.sendTraceTag(24691924,
324,50,"Unregistering OnBookmarkContainerNodeLoaded");this.$8g.lCj(this.Uhj)}KVk(b){var h,r,A,M;b?(this.xMh(null!==(r=this.AV.ymb.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==r?r:N.a.nil,b),this.xMh(null!==(M=this.AV.sdc.get(null===(A=b.id)||void 0===A?void 0:A.toString()))&&void 0!==M?M:N.a.nil,b),(h=b.properties.ka(Mc.a.wu,null))&&(this.GGd[h]=b)):v.ULS.sendTraceTag(24155022,324,50,"Node is null")}xMh(b,h){b===N.a.nil?v.ULS.sendTraceTag(24155023,324,50,"paraNodeId is null"):(b=
b.toString(),b in this.iId||(this.iId[b]=new ib.a),b=this.iId[b],b.contains(h)||b.add(h))}}Object(u.a)(NC,"BookmarkGraphManager",null,[255]);var pJ=d(799),qJ=d(1081);class zG{create(){return new qJ.a}}Object(u.a)(zG,"BookmarkContainerNodeFactory",null,[281]);class AG{constructor(b,h,r,A=null){this.hYn=(M,aa)=>{this.vp.Pkj(aa)};this.Ied=(M,aa)=>{var oa=this.xmi(aa.clone);M=aa.original.Ic;const Ja=new cb.a;for(const fb of oa)oa=fb.Io.toString(),Ja.lb(oa)||(Ja.add(oa,!0),(oa=M.Eb(fb.Io))&&!oa.anchor&&
(oa=this.vp.QOb(fb.Io)),oa?oa.anchor?this.Wzl(oa,aa.clone):v.ULS.sendTraceTag(573673488,324,15,String.format("BookmarkNode ObjId:{0} Id:{1} as no anchor",oa.id,oa.ka(Mc.a.sKb,-1))):v.ULS.sendTraceTag(573673487,324,15,"BookmarkNode null"))};this.lfg=(M,aa)=>{M=aa.clone;aa=this.xmi(M);this.vp.Djd(M,aa)};this.uG=h;this.vp=r;this.Ymk=A||new zG}init(){pJ.a.vpo(Object(E.a)(this.vp,this.vp.qcg,"onAfterFullBookmarkRangeDeleted"));this.uG.kff(this.hYn);Iv.a.QQd(this.Ied);Iv.a.RQd(this.lfg)}xmi(b){const h=
new ib.a;for(let r=0;r<b.ra.length;r++){const A=b.ra.K(r);if(A.Zh)for(let M=0;M<A.Zh.length;M++)h.add(A.Zh.K(M))}return h}Wzl(b,h){var r=h.Jj().td;r=Rt.b(b,r,!0);h=vd.a.Za(h);this.jZl(h);h.Ub(30);h.d6(r,1,b.id);h.Yj(r)}jZl(b){if(b.vb(25)&&b.ld(25)&&!b.kv(30)){const h=this.Ymk.create(wm.a.eza);b.Vf(h,30)}}}Object(u.a)(AG,"BookmarksEventHandler",null,[]);var mt=d(268),gv=d(211),BG=d(402),mL=d(1127),CG=d(129),rJ=d(1041);class DG{create(){return new rJ.a}}Object(u.a)(DG,"BookmarkNodeFactory",null,[281]);
class kB{constructor(b,h){this.lea=b;this.dnk=h}get mYb(){return this.dnk}}Object(u.a)(kB,"FoundBookmarkRangeObject",null,[280]);class yE{constructor(b,h,r,A,M,aa,oa,Ja=null,fb,Cb=null){this.via="_";this.w2a="OLE_LINK";this.c9g=40;this.kMk=" ";this.yz=b;this.oG=h;this.Qd=r;this.uZe=A;this.Qc=M;this.jb=aa;this.hb=oa;this.cnk=Ja||new DG;this.AV=Cb}s3c(b,h){return b?this.AV.ymb.get(null===h||void 0===h?void 0:h.toString()):this.AV.sdc.get(null===h||void 0===h?void 0:h.toString())}get ov(){return this.yz.value}get F0a(){return this.uZe.value}idf(b,
h){if(!h||!h.Qa||!h.Wc)return v.ULS.sendTraceTag(36471765,3029,15,"There is no selection"),!1;const r=h.Qa.node,A=h.Wc.node,M=mt.a.pqb(h,!0);h=mt.a.pqb(h,!1);return this.sRc(b,M,h,r,A)}sRc(b,h,r,A,M,aa=!1){v.ULS.sendTraceTag(545642374,3029,50,String.format("removeExisting value is: {0}",aa));const oa=this.DAa(b);if(oa)if(aa)this.bAj(oa);else return v.ULS.sendTraceTag(36471764,3029,50,"Unable to add bookmark because name already exists"),!1;if(!A||!M)return v.ULS.sendTraceTag(591730833,3029,50,"Missing Paragraph info while adding bookmark"),
!1;aa=this.Qc.Nc(15);aa.Bb(this.F0a);b=this.PSk(b);if(!b)return!1;this.MSk(A,h,b,M,r);aa.dispose();return!0}DAa(b){v.ULS.shipAssertTag(34936482,3029,!!b);return this.Ami(h=>b===h.properties.ka(Mc.a.wu,null))}QOb(b){return b&&b!==N.a.nil?this.Ami(h=>b.equals(h.id)):(v.ULS.sendTraceTag(543424735,3029,10,"Unable to find BookmarkNode when node id is null"),null)}qcg(b){const h=this.QOb(b);h?(v.ULS.sendTraceTag(36844636,3029,50,String.format("Removing bookmark {0}",b.toString())),this.aAj(h),this.Cjd(h)):
v.ULS.sendTraceTag(36569436,3029,15,"Unable to find BookmarkNode for full bookmark range deletion")}EAa(b,h){var r;const A=null!==(r=this.s3c(h,b.id))&&void 0!==r?r:N.a.nil;if(A===N.a.nil)return v.ULS.sendTraceTag(36218377,3029,10,"ParaId not on Bookmark"),new kB(null,2);r=this.ov.td.Eb(A);return r?r.isConnected?this.getBookmarkRange(r,b,h):(v.ULS.sendTraceTag(36766421,3029,50,"Paragraph not loaded"),new kB(null,3)):(v.ULS.sendTraceTag(36766420,3029,10,"Unable to get paragraph from object space"),
new kB(null,2))}Pkj(b){const h=this.r7l(b);h[Symbol.iterator]().next().done||this.lLn(b,h)}Djd(b,h){const r=new ib.a;let A=0,M=!1;for(const aa of h)aa&&aa.Jb.Zh?(A++,aa.Jb.Zh.remove(aa),0<=aa.pe&&aa.pe<b.se.length&&(aa.Jb.cp||(M=!0),r.add(aa.pe))):v.ULS.sendTraceTag(36569441,3029,15,"BookmarkRangeObject to remove is null");b.ana(r);v.ULS.sendTraceTag(36844637,3029,50,String.format("Removed {0} bookmark anchors | idsToRemove: {1}",A,r.count));M&&!b.se.length&&b.se.append(gv.CharacterPropertiesEditor.yN,
1024)}U3d(b=!1){var h;v.ULS.sendTraceTag(559228943,3029,50,"Fetching bookmarks with includeHidden: {0}",b);const r=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.$("HideBookMarkStartingWithOleLink");h=new ib.a;const A=vd.a.Za(this.ov);if(null!==this.Tcd(A)){var M=A.zq();v.ULS.sendTraceTag(559228944,3029,50,"Bookmarks count: {0}",M);if(0<M)for(M=A.Zd();null!==M;){const aa=M.ka(Mc.a.wu,"");I.a.Tf(aa)||(b?h.add(M):aa.startsWith(this.via)||r&&aa.startsWith(this.w2a)||h.add(M));M=A.Gk()}}!b&&
0<h.count&&v.ULS.sendTraceTag(556889755,3029,50,"User Bookmarks count: {0}",h.count);return h}JVm(){return this.ov?this.cxl():!1}cxl(){var b;v.ULS.sendTraceTag(524321506,3029,50,"Finding bookmarks with includeHidden: {0}",!1);const h=null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.$("HideBookMarkStartingWithOleLink");b=vd.a.Za(this.ov);if(null!==this.Tcd(b)&&0<b.zq())for(var r=b.Zd();null!==r;){r=r.ka(Mc.a.wu,"");if(!(I.a.Tf(r)||r.startsWith(this.via)||h&&r.startsWith(this.w2a)))return!0;
r=b.Gk()}return!1}jCi(b){var h=this.DAa(b);const r=new ib.a;if(h){b=this.s3c(!0,h.id);h=this.s3c(!1,h.id);var A=this.ov.td.Eb(b);A&&r.add(A);if(b.equals(h))return r;b=A;do(b=A=this.jb.xg(b,!1,!1,!0))&&r.add(A);while(A&&!A.id.equals(h))}else v.ULS.sendTraceTag(553927448,3029,10,"bookmark not exist with the {0}",b);return r}$zj(b){if(null===b)return v.ULS.sendTraceTag(559228951,3029,50,"Cannot remove bookmark as id is null"),!1;b=this.QOb(b);return this.bAj(b)}Ggm(b){let h="";const r=b.id;b=b.characterData.split(this.kMk);
for(let A=0;3>A&&A<b.length;A++)h+=this.via+b[A];h.length>this.c9g&&(h=h.substring(0,this.c9g));return this.rck(h,r)}rck(b,h){const r=this.U3d(!0),A=[];let M;for(let oa=0;oa<r.count;oa++){var aa=r.K(oa);M=aa.ka(Mc.a.wu,"");aa=this.s3c(!0,aa.id);M.startsWith(b)&&!h.equals(aa)&&A.push(M)}return 0<A.length?(A.sort((oa,Ja)=>oa.localeCompare(Ja,void 0,{numeric:!0})),(h=A[A.length-1].substring(b.length+1))?b+this.via+(parseInt(h)+1):b+this.via+1):b}hQm(b){I.a.Tf(b)?v.ULS.sendTraceTag(544777296,3029,10,
"Cannot navigate to bookmark as name is null"):(b=this.DAa(b),null===b?v.ULS.sendTraceTag(544777297,3029,10,"No bookmark with given name exists"):(b=this.EAa(b,!0))?(b=sc.SelectionFactory.ue(b.lea.paragraph,b.lea.Jb.cp))&&this.hb.Kc(b):v.ULS.sendTraceTag(544777298,3029,10,"No start found for bookmark. Document is corrupted"))}bAj(b){if(!b)return v.ULS.sendTraceTag(559228888,3029,15,"Could not find bookmark node with given id"),!1;v.ULS.sendTraceTag(559228889,3029,50,String.format("Removing bookmark {0}",
b.id));const h=this.Qc.Nc(15);h.Bb(this.F0a);this.aAj(b);this.Cjd(b);h.dispose();return!0}p5d(b,h){var r;if(!b||0>h)return v.ULS.sendTraceTag(545118153,3029,10,String.format("Got null paragraph or negative cp value")),null;const A=null===(r=y.AFrameworkApplication.J)||void 0===r?void 0:r.$("HideBookMarkStartingWithOleLink");r=null;const M=new ib.a,aa=new ib.a;var oa=b.ra;for(var Ja=0;Ja<oa.length;Ja++){var fb=oa.K(Ja);if(fb.cp>h||fb.cp===h&&0<M.count)break;if(fb.Zh){var Cb=fb.Zh;if(2===Cb.length&&
Cb.K(0).Io.equals(Cb.K(1).Io)&&fb.cp===h){M.add(Cb.K(0).Io.toString());break}for(let Gb=0,Sb=Cb.length;Gb<Sb;Gb++){fb=Cb.K(Gb);const pc=b.Ic.Eb(fb.Io).ka(Mc.a.wu,"");I.a.Tf(pc)||pc.startsWith(this.via)||A&&pc.startsWith(this.w2a)||(fb.Vc?M.add(fb.Io.toString()):M.contains(fb.Io.toString())?M.remove(fb.Io.toString()):aa.add(fb.Io.toString()))}}}0<M.count&&(r=b.Ic.Eb(N.a.Cf(M.K(M.count-1))));if(!r)for(h=Gd.ParagraphReader.xg(b,!0);h&&!r;){for(oa=0;oa<h.ra.length;oa++)if(Ja=h.ra.K(oa),Ja.Zh){Ja=Ja.Zh;
for(let Gb=0,Sb=Ja.length;Gb<Sb;Gb++)Cb=Ja.K(Gb),fb=b.Ic.Eb(Cb.Io).ka(Mc.a.wu,""),I.a.Tf(fb)||fb.startsWith(this.via)||A&&fb.startsWith(this.w2a)||(Cb.Vc?aa.contains(Cb.Io.toString())?aa.remove(Cb.Io.toString()):M.add(Cb.Io.toString()):M.contains(Cb.Io.toString())?M.remove(Cb.Io.toString()):aa.add(Cb.Io.toString()))}0<M.count?r=h.Ic.Eb(N.a.Cf(M.K(M.count-1))):h=Gd.ParagraphReader.xg(h,!0)}return r}irp(b,h){if(null===b)return v.ULS.sendTraceTag(525111647,3029,10,"Bookmark node is null"),!1;if(this.Nbn(h)||
this.oVl(h))return!1;const r=this.Qc.Nc(15);r.Bb(this.F0a);this.hrp(b,h);r.dispose();return!0}Ami(b){if(!this.ov)return v.ULS.sendTraceTag(34936483,3029,10,"PageNode is null"),null;const h=new vd.a;h.set(this.ov);if(!this.Tcd(h))return v.ULS.sendTraceTag(34936512,3029,10,"Unable to move to BookmarkContainer"),null;if(!h.Ub(1))return null;do{const r=h.currentNode;if(b(r))return r}while(h.Mf(1));return null}getBookmarkRange(b,h,r){for(let A=0;A<b.ra.length;A++){const M=b.ra.K(A);if(M.Zh)for(let aa=
0;aa<M.Zh.length;aa++){const oa=M.Zh.K(aa);if(oa.Io.equals(h.id)&&r===oa.Vc)return new kB(oa,0)}}v.ULS.sendTraceTag(36729310,3029,15,"paragraph {0} did not contain bookmarkNode id:{1}, isStart: {2} ({3}), had {4} chps | Path: {5}",b.id,h.ka(Mc.a.sKb,-1),r,h.id,b.ra.length,this.kI(b));return new kB(null,1)}Tcd(b){if(this.oG.VR(b))return b=b.Ub(30),v.ULS.shipAssertTag(34936513,3029,!!b,"Graph does not contain BookmarkContainer"),b;v.ULS.sendTraceTag(34936514,3029,15,"Unable to move to Page Manifest");
return null}r7l(b){const h=new cb.a;for(let r=0;r<b.ra.length;r++){const A=b.ra.K(r);if(A.Zh)for(let M=0;M<A.Zh.length;M++){const aa=A.Zh.K(M),oa=aa.Io.toString();h.lb(oa)?(v.ULS.shipAssertTag(36218379,3029,aa.Vc!==h.K(oa).Vc),h.remove(oa)):h.add(oa,aa)}}return h.values}lLn(b,h){this.Djd(b,h);this.PKn(b,h)}PKn(b,h){let r=Gd.ParagraphReader.xg(b,!1,!0);b=Gd.ParagraphReader.xg(b,!0,!0);r||b?(r||this.bVh(h,!0)&&v.ULS.sendTraceTag(36320843,3029,15,"No next paragraph but have start bookmarks to move, falling back to prev paragraph."),
b||this.bVh(h,!1)&&v.ULS.sendTraceTag(36320844,3029,15,"No prev paragraph but have end bookmarks to move, falling back to next paragraph."),r=r||b,b=b||r,this.hdj(r,h,0,!0),this.hdj(b,h,b.ra.last.cp,!1)):v.ULS.sendTraceTag(36218381,3029,15,"Both paragraphs are null.")}bVh(b,h){for(const r of b)if(h===r.Vc)return!0;return!1}hdj(b,h,r,A){const M=new ib.a;r=this.EGf(b,r);for(const aa of h)aa.Vc===A&&(r?(h=this.RSk(b,A,r,aa.Io))&&M.add(h):v.ULS.shipAssertTag(36218382,3029,!0,"Null chp. isStart={0}",A));
M.count&&(b.Ml(),this.ZLg(b,M),v.ULS.sendTraceTag(36844638,3029,50,String.format("Added {0} bookmark anchors | isStart: {1}",M.count,A)))}RSk(b,h,r,A){const M=this.QOb(A);return M?this.jdf(b,h,r,M):(v.ULS.sendTraceTag(40445218,3029,15,String.format("BookmarkNode {0} null while trying to add range",A)),null)}jdf(b,h,r,A){var M;if(!A)return v.ULS.sendTraceTag(591730834,3029,10,String.format("BookmarkNode null while trying to add range")),null;if(!r)return v.ULS.sendTraceTag(543424736,3029,10,String.format("Chp null while trying to add range")),
null;r.Zh||(r.Zh=new BG.a(r));const aa=new mL.a(r,null,A.id,h);r.Zh.add(aa);(h?this.AV.ymb:this.AV.sdc).set(null===(M=A.id)||void 0===M?void 0:M.toString(),b.id);return aa}ZLg(b,h){if(h){v.ULS.sendTraceTag(36218384,3029,50,"BookmarksToUpdate.Count:{0}",h.count);h.Sc((r,A)=>r.pe-A.pe);for(let r=0;r<h.count;r++){const A=h.K(r);A.pe?b.se.mX(A.pe-1,1024):b.se.Tsa(A.pe,1024);b.se.Gq.Z(A.pe,gv.CharacterPropertiesEditor.yN);b.se.Lt.Z(A.pe,gv.CharacterPropertiesEditor.YR)}}else v.ULS.shipAssertTag(36218383,
3029,!1,"Null BookmarksToUpdate.")}EGf(b,h){if(!b||!b.ra||!b.ra.last)return null;v.ULS.shipAssertTag(36471766,3029,h<=b.ra.last.cp,"Cp to split at greater than last Chp.Cp in paragraph");if(b.ra.last.cp===h){var r=b.ra.length-1;if(!b.ra.K(r).formatting)for(var A=r-1;0<=A;A--){var M=b.ra.K(A);if(M.formatting){this.Qd.H0(b,r,h,M.formatting);break}}return b.ra.last}r=null;for(A=0;A<b.ra.length;A++){M=b.ra.K(A);if(M.cp>=h){if(M.cp>h||!M.formatting)this.Qd.H0(b,A,h,r),M=b.ra.K(A);M.Zh||(M.Zh=new BG.a(M));
v.ULS.shipAssertTag(36471768,3029,M!==b.ra.last);return M}M.formatting&&(r=M.formatting)}return null}PSk(b){const h=new vd.a;h.set(this.ov);if(!this.Tcd(h))return v.ULS.sendTraceTag(36471769,3029,10,"Unable to move to BookmarkContainer"),null;b=this.EBl(b);h.d6(b,1,null);h.Yj(b);return b}EBl(b){const h=this.cnk.create(wm.a.wmb);h.setValue(Mc.a.wu,b);h.setValue(Mc.a.sKb,$f.a.OF());return h}Cjd(b){if(b&&b.anchor){v.ULS.sendTraceTag(36729311,3029,100,"Removed bookmark with id:{0}, ({1})",b.ka(Mc.a.sKb,
-1),b.id);var h=new vd.a;h.set(b);h.vb(64);h.Rg()}}kI(b){const h=[];let r=0;for(;b.anchor.gr&&7!==b.type;)h[r]=CG.a[b.type],b=b.anchor.gr.at.node,r++;h[r]=CG.a[b.type];return h.join(" ")}hrp(b,h){b.setValue(Mc.a.wu,h)}aAj(b){const h=this.EAa(b,!0).lea;b=this.EAa(b,!1).lea;if(h&&b&&h.paragraph===b.paragraph){let r;this.Djd(h.paragraph,(r=new ib.a,r.add(h),r.add(b),r))}else{if(h){let r;this.Djd(h.paragraph,(r=new ib.a,r.add(h),r))}if(b){let r;this.Djd(b.paragraph,(r=new ib.a,r.add(b),r))}}}MSk(b,h,
r,A,M){if(h=this.jdf(b,!0,this.EGf(b,h),r)){b.Ml();var aa;this.ZLg(b,(aa=new ib.a,aa.add(h),aa));(r=this.jdf(A,!1,this.EGf(A,M),r))?(A.Ml(),this.ZLg(b,(aa=new ib.a,aa.add(r),aa))):v.ULS.sendTraceTag(520646733,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark end range is null")}else v.ULS.sendTraceTag(520646734,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark start range is null")}kCi(b,h){var r;if(!b)return null;h=null!==(r=this.s3c(h,b.id))&&void 0!==r?r:N.a.nil;
return b.Ic.Eb(h)?b.Ic.Eb(h):null}Mbn(b){return!!b&&64===b.mf}gig(b){var h,r;if(0===b.Bna)return!1;const A=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.$("HideBookMarkStartingWithOleLink");for(h=0;h<(null===(r=b.ra)||void 0===r?void 0:r.length);h++){const M=b.ra.K(h);if(null!=M.Zh)for(let aa=0;aa<M.Zh.length;aa++){const oa=M.Zh.K(aa),Ja=b.Ic.Eb(oa.Io).dqb();if(!(I.a.Tf(Ja)||Ja.startsWith(this.via)||A&&Ja.startsWith(this.w2a))&&oa.Vc)return!0}}return!1}zsi(b){var h,r;const A=[];if(0===
b.Bna)return A;const M=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.$("HideBookMarkStartingWithOleLink");for(h=0;h<(null===(r=b.ra)||void 0===r?void 0:r.length);h++){const aa=b.ra.K(h);if(null!=aa.Zh)for(let oa=0;oa<aa.Zh.length;oa++){const Ja=aa.Zh.K(oa),fb=b.Ic.Eb(Ja.Io),Cb=fb.dqb();I.a.Tf(Cb)||Cb.startsWith(this.via)||M&&Cb.startsWith(this.w2a)||!Ja.Vc||A.push(fb)}}return A}I1o(b){return b.ka(Mc.a.uI,!1)}Nbn(b){return I.a.Tf(b)?(v.ULS.sendTraceTag(559228948,3029,50,"bookmark name is null or empty"),
!0):!1}oVl(b){return null!==this.DAa(b)?(v.ULS.sendTraceTag(559228949,3029,50,"Not updating bookmark name as a bookmark node with same name exists."),!0):!1}ysi(b,h,r){return this.getBookmarkRange(b,h,r).lea}gVi(b,h,r){if(this.I1o(r)||this.phn(r))return!1;const A=this.kCi(r,!0),M=this.kCi(r,!1);if(A&&M&&this.jb.x9c(h,A,M)){if(h!==A&&h!==M)return!0;const aa=this.ysi(A,r,!0);if(aa&&(A!==h||aa.Jb.cp<=b)&&(r=this.ysi(M,r,!1))&&(M!==h||r.Jb.cp>=b))return!0}return!1}phn(b){var h;b=null===b||void 0===b?
void 0:b.ka(Mc.a.wu,"");const r=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.$("HideBookMarkStartingWithOleLink");return!I.a.Tf(b)&&(b.startsWith(this.via)||r&&b.startsWith(this.w2a))?!0:!1}}Object(u.a)(yE,"FullBookmarkManager",null,[235]);class EG{constructor(){this.yKe=this.Jq=this.W=null}get name(){return"WordEditor.Bookmark"}uc(b){this.W=b;this.Jq=this.W.resolve(59).Ll;const h=new yE(new Qf.a(()=>qa.StaticActiveAppFrame.za().kb.$c),Object(vo.a)(),this.W.resolve(322),new Qf.a(()=>
qa.StaticActiveAppFrame.za().kb.Jc.od),Qn.a.instance,this.W.resolve(164),this.W.resolve(27),null,null,this.W.resolve(380));this.W.ia(928,()=>h).as(454).ha();this.W.ia(945,()=>new AG(this.Jq.jf(12),this.W.resolve(783),this.W.resolve(454))).ha();$l.a.rak&&(this.yKe=new NC(this.Jq.jf(64),new Qf.a(()=>qa.StaticActiveAppFrame.za().kb.$c),Object(vo.a)(),er.a.instance,this.W.resolve(380)),this.W.ia("WordEditor.Bookmark.BookmarkGraphManager",()=>this.yKe).as(946).ha())}init(){this.W.resolve(12).us.continueWith(()=>
{this.Fo()})}dispose(){this.yKe.dispose()}Fo(){v.ULS.sendTraceTag(36209186,324,50,"Registering paragraph events");this.W.resolve(945).init();v.ULS.sendTraceTag(24691930,324,50,"Finish registering paragraph events");this.Cpo(this.W.Ra(324),this.W.resolve(928))}Cpo(b,h){b&&b.execute(r=>{r.XX(new kx(h))})}static main(){K.a.instance.Lc(new EG)}}Object(u.a)(EG,"BookmarkPackage",null,[0,1]);var sJ=d(872),FG=d(1030),zE=d(1457),Ct=d(1271);class OC extends Ct.a{constructor(b){super();this.mPk=b}get index(){return 3}run(){this.mPk()}NI(){this.p0()}}
Object(u.a)(OC,"FootnoteEndnoteGraphUpdateTracker",Ct.a,[]);class lx{constructor(){this.EBd=null}get name(){return"WordEditor.FootnoteEndnoteInteractive"}uc(){}init(){lx.sc.us.continueWith(()=>{this.Fo()})}Fo(){sJ.a.Fpb=zE.a.instance;this.gSf()}dispose(){}gSf(){this.EBd=new OC(()=>{zE.a.instance.Vv()});FG.a.Hse(Object(E.a)(this.EBd,this.EBd.NI,"setUpdateNeeded"));$r.a.instance.hva(this.EBd,3)}static get sc(){return Za.a.instance.resolve(12)}}Object(u.a)(lx,"PackageManager",null,[0,1]);var Vm=d(766),
AE=d(204),Qz=d(533),lB=d(478),BE=d(1611);class sw extends Yw{constructor(){super()}get Cv(){return null}getTitle(b){b=b.usa();if(!b||!Qz.a.instance.gta(b))return"";const h=new Sys.StringBuilder,r=Qz.a.instance.e7(b);h.append(1===r?WordEditorIntl.WordEditorStrings.l_FootnoteContentTitle:WordEditorIntl.WordEditorStrings.l_EndnoteContentTitle);h.append(" ");h.append(Qz.a.instance.ujc(b));return h.toString()}}Object(u.a)(sw,"FootnoteEndnoteBaseDetailsProvider",Yw,[]);class Rz extends sw{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE"}get Qh(){return 7}}
Object(u.a)(Rz,"FootnoteEndnoteDetailsProvider",sw,[]);var Sz=d(1532),tJ=d(1564),tw=d(1686);class mB extends sw{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE_REFMARK"}get Qh(){return 10}}Object(u.a)(mB,"FootnoteEndnoteRefMarkDetailsProvider",sw,[]);class nB{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc,zc,Yc,Kd,ke,ge){this.cRi=(de,Sd,be,Rf,Mf)=>{Rf=Sd.view;if(!Rf.features.zAe||this.WE.bVi)return 8;const Yj=Rf.mb.Mg;if(!Yj)return 2;if(this.xl.q2(Yj))return 8;Rf=de===Fc.a.insertFootnote?1:
0;var Ji=this.y4d(Sd);if(!Ji)return v.ULS.sendTraceTag(3683158,308,10,"We expected a selection here."),8;Sd=!0;Ji=Ji.Qa;Mf&&Mf.ooc&&Mf.iLa&&(Ji=Mf.iLa,Sd=!Mf.keepCurrentFocus);if(1===be&&Xn.a.Jla(Yj)||!Ji||!ze.a.pf(Ji)||this.bbh.instance&&this.bbh.instance.Gin(Ji)||Nc.a.QBa(Ji,!0))return 8;if(1===be)return 32;2===be&&(be=this.kW.Wf("UserAction","InsertFootnoteEndnote"),de=this.duk.O7m(Ji,Rf,de),Mf&&Mf.ooc&&(Mf.Ufj=de),Sd&&this.Hne(de,!0,!0),be.stop(),this.Yd.Yu(6));return 32};this.grc=(de,Sd,be)=>
{const Rf=Sd.view;if(de===Fc.a.feb||de===Fc.a.Ayb){if(!Rf.features.zAe)return 8}else if(!Rf.features.tFg)return 8;if(!Rf.mb.Mg)return 2;Sd=this.skc(Sd);return Sd?de!==Fc.a.feb&&de!==Fc.a.Ayb||this.QQa.gWm(Sd.node,de===Fc.a.feb?1:0)?1===be?32:2===be&&32===this.ga.Pb(Fc.a.I6,2,!0)?(this.ga.Pb(Fc.a.fag,2,de),32):8:8:2};this.H$l=(de,Sd,be,Rf,Mf)=>{if(1===be)return 32;if(2===be){de=this.EHm(Sd);if(!de)return 8;be=Sd=null;switch(Mf){case Fc.a.Sje:be=de.Wc;Sd=this.M6b.j9d(be,1);break;case Fc.a.Rje:be=de.Wc;
Sd=this.M6b.j9d(be,0);break;case Fc.a.Uje:be=de.Qa;Sd=this.M6b.MJi(be,1);break;case Fc.a.Tje:be=de.Qa;Sd=this.M6b.MJi(be,0);break;case Fc.a.feb:be=de.Qa;(Sd=this.M6b.j9d(be,1,!0))||(Sd=this.QQa.Kwi(be.node,1));break;case Fc.a.Ayb:be=de.Qa,(Sd=this.M6b.j9d(be,0,!0))||(Sd=this.QQa.Kwi(be.node,0))}if(Sd)this.Hne(Sd);else{if(!this.Ky.Jc)return 8;(Mf=cn.d(be.node,be.cpBegin))&&7===Mf.Qh&&this.QQa.WIj(Mf)}}return 32};this.$3o=(de,Sd,be,Rf,Mf)=>1===be?32:2===be?(v.ULS.shipAssertTag(4520066,308,!!Mf),v.ULS.shipAssertTag(4520067,
308,!!Mf.Q6a),de=Mf.Q6a,v.ULS.shipAssertTag(4520068,308,this.hG.gta(de)),this.Hne(de,Mf.Vxe)?32:8):32;this.a4o=(de,Sd,be,Rf,Mf)=>{if(1===be)return 32;2===be&&(de=Mf.Caa,Mf=Mf.K$l)&&(this.axa.nhc(),Sd=this.hG.Lsb(de),Mf.title=this.hG.erm(de)+(Sd?WordEditorIntl.WordEditorStrings.l_FootnoteTooltipInstruction:WordEditorIntl.WordEditorStrings.l_EndnoteTooltipInstruction));return 32};this.Zbb=(de,Sd,be,Rf,Mf)=>2===be?(v.ULS.shipAssertTag(4520069,308,!!Mf),v.ULS.shipAssertTag(4520070,308,!!Mf.Q6a),v.ULS.shipAssertTag(4520071,
308,Gd.ParagraphReader.Vb(Mf.Q6a)),de=this.hG.V8a(Mf.Q6a),this.Hne(de,Mf.Vxe)?32:8):32;this.GQo=(de,Sd,be)=>{2===be&&this.WE.F0();return 32};this.CSl=(de,Sd,be,Rf,Mf)=>{if(1===be)return 32;if(2===be)return void 0!==Mf&&null!==Mf?this.WE.Qwf(Mf,Mf):this.WE.Qwf(),32;v.ULS.sendTraceTag(4520072,308,10,"{0}",{["Error"]:"FootnoteEndnoteControl not dismissed"});return 8};this.Bun=(de,Sd,be)=>{de=this.skc(Sd);return de&&ze.a.pf(de)?1===be?32:2===be?(be=0<this.Pp.K2(de.node).Ou,this.WE.fsf(),this.WE.dialog.rrb=
be,32):8:(v.ULS.sendTraceTag(4743179,308,10,"Expected an IP context here."),8)};this.F$l=(de,Sd,be)=>1===be?32:2===be?(this.WE.dialog.rrb=!1,32):8;this.Pgo=(de,Sd,be,Rf,Mf)=>this.Yoi(de,be,Mf);this.Ngo=(de,Sd,be,Rf,Mf)=>1===be?32:this.WE.dialog&&this.WE.dialog.fontName?(Mf[ja.a.Value]=this.WE.dialog.fontName,32):this.tqk.XUa(ub.a.VXb.toString(),Mf,null)?32:8;this.E$l=(de,Sd,be)=>1===be?32:2===be?(this.WE.dialog.rrb=!0,32):8;this.Ogo=(de,Sd,be,Rf,Mf)=>this.Yoi(de,be,Mf);this.C$l=(de,Sd,be)=>{if(1===
be)return 32;if(2===be){de=this.skc(Sd);if(!de)return v.ULS.sendTraceTag(51512524,308,10,"Selected graph node context is null"),8;Sd=this.hG.V8a(de.node);this.hG.gta(Sd)&&(be=this.Qc.Nc(15),be.Bb(Sd),this.y5j(de),this.QQa.GRh(Sd,this.WE.dialog),be.dispose());this.WE.Kkd();return 32}return 8};this.B$l=(de,Sd,be)=>{if(1===be)return 32;if(2===be){de=this.skc(Sd);if(!de)return v.ULS.sendTraceTag(51512525,308,10,"Selected graph node context is null"),8;Sd=this.hG.V8a(de.node);this.hG.gta(Sd)&&(be=this.Qc.Nc(15),
be.Bb(Sd),this.y5j(de),this.QQa.D5k(Sd,this.WE.dialog),be.dispose());this.WE.Kkd();return 32}return 8};this.D$l=(de,Sd,be)=>1===be?32:2===be?(this.WE.Kkd(),32):8;this.z$l=(de,Sd,be,Rf,Mf)=>{if(1===be)return 32;if(2===be){de=Object(ya.a)(240,Mf);if(!de||!de.rd)return 8;this.WE.dialog.fontName=de.rd.fontName;return 32}return 8};this.A$l=(de,Sd,be,Rf,Mf)=>{if(1===be)return 32;if(2===be){de=Object(ya.a)(240,Mf);if(!de||!de.rd)return 8;this.WE.dialog.L6b=de.rd;return 32}return 8};this.ga=b;this.Ky=h;this.tqk=
r;this.kd=A;this.hG=M;this.duk=aa;this.QQa=oa;this.axa=Ja;this.WE=fb;this.Pp=Cb;this.M6b=Gb;this.Qc=Sb;this.xl=pc;this.Gb=zc;this.kW=Yc;this.Yd=Kd;this.fkk=ke;this.bbh=ge}y5j(b){(b=Wa.FormattingReader.Rs(b))?(this.WE.dialog.fontName||(this.WE.dialog.fontName=b.cache.gI),-1===this.WE.dialog.fontSize&&(this.WE.dialog.L6b=b.cache.fontSize)):v.ULS.sendTraceTag(587790277,308,10,"UpdateFontAndFontSize: Received null formatting object.")}Yoi(b,h,r){return 1===h&&this.WE.dialog?32:2===h&&this.WE.dialog?(r[Pd.a.On]=
b===Fc.a.ong?this.WE.dialog.rrb:!this.WE.dialog.rrb,32):8}Xb(){df.a.instance.vOi([Fc.a.Sje,Fc.a.Rje,Fc.a.Uje,Fc.a.Tje,Fc.a.fag,Fc.a.feb,Fc.a.Ayb,Fc.a.I6]);this.ga.fb(Fc.a.insertFootnote,lc.a.view,this.cRi,4);this.ga.fb(Fc.a.insertEndnote,lc.a.view,this.cRi,4);this.ga.qa(Fc.a.Sje,lc.a.view,this.grc);this.ga.qa(Fc.a.fag,lc.a.view,this.H$l);this.ga.qa(Fc.a.Rje,lc.a.view,this.grc);this.ga.qa(Fc.a.Uje,lc.a.view,this.grc);this.ga.qa(Fc.a.Tje,lc.a.view,this.grc);this.ga.qa(Fc.a.feb,lc.a.view,this.grc);this.ga.qa(Fc.a.Ayb,
lc.a.view,this.grc);this.ga.qa(Fc.a.zSj,lc.a.view,this.$3o);this.ga.fb(Fc.a.Woi,lc.a.view,this.E$l,4);this.ga.fb(Fc.a.ong,lc.a.view,this.Ogo,100);this.ga.fb(Fc.a.Xoi,lc.a.view,this.F$l,4);this.ga.fb(Fc.a.rvj,lc.a.view,this.Pgo,100);this.ga.qa(Fc.a.ASj,lc.a.view,this.a4o);this.ga.fb(Fc.a.Zbb,lc.a.view,this.Zbb,96);this.ga.fb(Fc.a.i3d,lc.a.view,this.GQo,96);this.ga.qa(Fc.a.I6,lc.a.view,this.CSl);this.ga.fb(Fc.a.G4i,lc.a.view,this.Bun,4);this.ga.fb(Fc.a.Toi,lc.a.view,this.C$l,4);this.ga.fb(Fc.a.Uoi,
lc.a.view,this.B$l,4);this.ga.fb(Fc.a.Voi,lc.a.view,this.D$l,4);this.ga.fb(Fc.a.g3d,lc.a.view,this.z$l,4);this.ga.fb(Fc.a.qvj,lc.a.view,this.Ngo,100);this.ga.fb(Fc.a.h3d,lc.a.view,this.A$l,4);this.ga.fb(Fc.a.Igd,lc.a.view,nB.Igd,100);this.ga.fb(Fc.a.Jgd,lc.a.view,nB.Jgd,100)}Spg(){this.fkk.execute(b=>{b.XX(new Rz);b.XX(new mB)})}skc(b){b=this.y4d(b);return b?b.Qa:(v.ULS.sendTraceTag(51512526,308,10,"GetCollapsedSelectionFromContext is null"),null)}y4d(b){let h=null;b=b.view;if(!b)return v.ULS.sendTraceTag(3486740,
308,10,"We expected a view here."),h;b=b.mb;if(!b)return v.ULS.sendTraceTag(51512527,308,10,"We expected that we have a selection manager here."),h;b=b.gb;if(!b||!b.length)return v.ULS.sendTraceTag(51512528,308,10,"We expected that we have a selection collection here."),h;b=b.K(0);if(!b)return v.ULS.sendTraceTag(51512529,308,10,"We expected that we have a current selection here."),h;(h=ze.a.uk(b,!1,!1))||v.ULS.sendTraceTag(3486741,308,10,"We expected a selection here.");return h}EHm(b){return(b=b.view)?
b.mb.gb.K(0):null}Hne(b,h=!0,r=!1){if(b){this.axa.nhc();var A=b.isa;if(A){var M=A.Jb,aa=sc.SelectionFactory.cL(M.paragraph,M.cp,M.cp+1);M=this.Ky.Jc;if(!M)return!1;this.kd.iha(M,aa);M.xxb=150;M.Z3();b=new lB.a(b,h);aa=AE.a.zjc(A,M);A=A.TAa(M,aa);if(!A)return v.ULS.sendTraceTag(570529814,308,15,"FootnoteEndnote presenter is null"),!1;r||A.element?this.WE.ZBg(b):(this.WE.ZBg(new lB.a(b.Q6a,!1)),h&&(h=new xc.a(2,1,10,()=>{this.WE.F0()}),this.Gb.Zb(h)));return!0}}return!1}static Wqm(){return new nB(y.AFrameworkApplication.va,
qa.StaticActiveAppFrame.za().kb,Za.a.instance.resolve(708),Object(Lb.a)(),Qz.a.instance,tJ.a.instance,Sz.a.instance,zE.a.instance,BE.FootnoteEndnoteControlManager.instance,Za.a.instance.resolve(17),tw.a.instance,new Qn.a,re.a.instance,Je.a.instance,y.AFrameworkApplication.ua.Vr,Za.a.instance.resolve(46).instance,Za.a.instance.Ra(324),Za.a.instance.Ra(14))}static Vqm(){return nB.Wqm()}static Igd(b,h,r,A,M){if(1===r)return 32;if(2===r&&!M)return 8;kl.a.Lae(h);M.PopulationXML=gq.FontUtils.Aqi(kl.a.pye,
kl.a.jEf,Fc.a.g3d);return 32}static Jgd(b,h,r,A,M){if(1===r)return 32;if(2===r&&!M)return 8;M.PopulationXML=gq.FontUtils.Bqi(Fc.a.h3d);return 32}}Object(u.a)(nB,"FootnoteEndnoteActor",null,[299]);class GG extends Ct.a{constructor(b){super();this.Uaf=b}get index(){return 1}run(){this.Uaf()}NI(){this.p0()}}Object(u.a)(GG,"FootnoteEndnoteControlUpdateTracker",Ct.a,[]);var oB=d(353);class CE extends oB.a{constructor(b,h,r,A,M,aa,oa){super(b,h,r,A);this.nv=()=>{this.msd(this.Cb)};this.sK=b.container;this.ix=
document.createElement("div");b.container.appendChild(this.ix);this.VP(this.ix);this.PIk=M;this.$n.execute(Ja=>{Ja.YX(this.nv)});this.TQa=aa;this.IM=oa;this.TQa.execute(Ja=>{Ja.lAg(this.jc,this.sK)});this.sK.style.backgroundColor=this.IM.$jc()}dispose(){super.dispose();this.$n.instance&&this.$n.instance.nNa(this.nv)}get $n(){return null!=this.DWg?this.DWg:this.DWg=Za.a.instance.Ra(6)}JB(b){this.sK.classList.add("FootnoteEndnoteViewElement");this.msd(b.currentNode)}msd(b){this.$n.instance&&(this.$n.instance.$td(this.ix),
this.ix.style.width=Math.round(100/this.$n.instance.yj)+"%");this.PIk(b)}}Object(u.a)(CE,"FootnoteEndnoteViewElement",oB.a,[]);class uJ{constructor(){this._initialized=!1;this.Yxd=this.MRe=this.W=null;this.M$l=(b,h,r,A)=>b.U$a?new CE(b,h,r,A,M=>{BE.FootnoteEndnoteControlManager.instance.xBo(M)},this.W.Ra(194),this.W.resolve(318)):null}get name(){return"WordEditor.FootnoteEndnote"}uc(b){this.W=b}init(){this.W.resolve(12).us.continueWith(()=>{this.Fo()})}Fo(){Rx.WordSectionNavigator.instance.iag=Object(E.a)(Sz.a.instance,
Sz.a.instance.KMn,"navigateToWordSectionNodeWithFootnoteEndnote");Vm.a.aAg(this.M$l);BE.FootnoteEndnoteControlManager.instance.bind(qa.StaticActiveAppFrame.za().XF);this.MRe=nB.Vqm();this.MRe.Xb();this.MRe.Spg();qa.StaticActiveAppFrame.za().Fe();this.gSf();this._initialized=!0}dispose(){this._initialized&&(this._initialized=!1,BE.FootnoteEndnoteControlManager.instance.dispose())}gSf(){this.Yxd=new GG(()=>{BE.FootnoteEndnoteControlManager.instance.nsd()});FG.a.Hse(Object(E.a)(this.Yxd,this.Yxd.NI,
"setUpdateNeeded"));$r.a.instance.hva(this.Yxd,3)}}Object(u.a)(uJ,"PackageManager",null,[0,1]);class pB{constructor(b,h,r,A){this.hb=h;this.Fia=A}get bookmarkManager(){return this.Fia.value}xin(b){return $l.a.rak?b.startsWith(I.a.umb):!1}lTm(b){try{this.mTm(b)}catch(h){v.ULS.sendTraceTag(24691935,324,10,String.format("Error parsing bookmark url. Error: {0}",h.message))}}iJg(b){return{returnValue:!1,Cqg:b,GOb:""}}mTm(b){if(this.bookmarkManager){b=b.split("/");var h=this.bookmarkManager.DAa(b[b.length-
1]);h&&h.anchor?(b=this.bookmarkManager.EAa(h,!0).lea,h=this.bookmarkManager.EAa(h,!1).lea,b||h?b?this.YNj(b):(v.ULS.sendTraceTag(35992277,324,50,"Start Anchor is missing for Bookmark"),this.YNj(h)):(v.ULS.sendTraceTag(35992276,324,50,"Bookmark has no anchors, jumping to end"),this.m3i(!1))):(v.ULS.sendTraceTag(35992275,324,15,"Cannot find bookmark node"),this.m3i(!0))}}m3i(b){b=sc.SelectionFactory.hp(qa.StaticActiveAppFrame.za().kb.$c.Eui(),b);this.hb.Kc(b)}YNj(b){b.paragraph&&b.Jb?(b=sc.SelectionFactory.ue(b.paragraph,
b.Jb.cp),b.eUi=!0,this.hb.Kc(b)):v.ULS.shipAssertTag(35992279,324,!0,"bookmark's Paragraph or Containing Properties are missing")}}Object(u.a)(pB,"InternalLinkManager",null,[236]);class TD{get name(){return"WordEditor.InternalLinks"}init(){}dispose(){}uc(b){b.ia("WordEditor.InternalLinks.InternalLinkManager",()=>new pB(new Qf.a(()=>b.Oa(946)),b.resolve(326),b.resolve(12),new Qf.a(()=>b.Oa(454)),b.resolve(380))).as(66).ha()}static main(){K.a.instance.Lc(new TD)}}Object(u.a)(TD,"WordEditorInternalLinksPackage",
null,[0,1]);class Zy{constructor(b){this.wRa=null;this.Mll=h=>{h=h.Yl;if(h.anchor){db.a.mark(4763);var r=vd.a.Za(h);if(r.vb(8)&&r.ld(8)&&r.pJg(h)===h){if(gm.OutlineReader.isEmpty(r)){let A=!1;for(let M=0;M<gg.a.instance.gb.length;M++){const aa=gg.a.instance.gb.K(M);for(let oa=0;oa<aa.length;oa++)if(aa.K(oa).node===h){A=!0;break}}A||this.Xci(r)}db.a.mark(4764)}}};Zy.hT=b}OXd(b){if(!Zy.pj.kee(b))return null;b.Ub(1)&&(b.currentNode.km(8,!0),b.rc());const h=Zy.hT.hGl();Zy.pj.isRtl(b.currentNode)?h.setValue(He.a.Bs,
11):h.setValue(He.a.Bs,9);b.Vf(h,1);b.Yj(h);return h}gSo(b){if(this.wRa&&b!==this.wRa){const h=new xc.a(2,1,0,this.Mll,120);h.Yl=this.wRa;y.AFrameworkApplication.oc.Zb(h)}this.wRa=b}Xci(b){this.wRa===b.currentNode&&(this.wRa=null);const h=new Rb.GraphTransaction(7);h.mu(b);b.Rg();h.dispose()}T0h(){if(this.wRa&&this.wRa.anchor){const b=vd.a.Za(this.wRa);b.pq()&&gm.OutlineReader.q8c(b)&&this.Xci(b);this.wRa=null}}static get pj(){return Um.PageReader.instance}}Zy.hT=null;Object(u.a)(Zy,"PageContentEditor",
null,[1450]);var vJ=d(1124),Bu=d(599);class wJ extends rr{constructor(){super()}eRj(b,h,r,A,M){let aa=!1,oa=!0;ze.a.pf(M)&&(h=of.ListItemReader.Cg(b)&&h,M=Db.OutlineElementReader.UA(b,M,!1)&&!Db.OutlineElementReader.UA(b,M,!0),h&&r.mmf(b,A)&&(aa=!0),Of.a.ud().Co&&(M||h&&!aa)&&(oa=!1));return{dRj:oa,O$j:aa}}}Object(u.a)(wJ,"CursorMoveValidator",rr,[]);var xJ=d(217);class Wo{constructor(b,h,r,A,M){this.zI=M;this.A2e=b;this.J9=A;this.Zwa=h;this.Oh=r}get Od(){return null!=this.M4g?this.M4g:this.M4g=Za.a.instance.resolve(46).instance}get Mj(){return null!=
this.x4g?this.x4g:this.x4g=Za.a.instance.resolve(39).instance}get Wb(){return null!=this.l6g?this.l6g:this.l6g=Za.a.instance.resolve(8)}get Xg(){return null!=this.B3g?this.B3g:this.B3g=Za.a.instance.Oa(29)}get $t(){return this.J9.value}get gg(){return this.Oh.value}get Ps(){return this.Zwa}eRm(b){const h=window.performance.now(),r=new qq.ScriptSharpLegacyMap,A=new bp.a,M=new qq.ScriptSharpLegacyMap;if(b&&b.Qw){var aa=null;for(let oa=0;oa<b.length;oa++){const Ja=b.getContext(oa);aa=aa||Object(vo.a)().Iu(Ja.node);
let fb;if(!({groupId:fb}=this.bmp(Ja.node,aa)).returnValue)continue;let Cb;r.lb(fb)||(Cb=[],r.add(fb,Cb));Cb=r.K(fb);Cb.push(Ja)}for(const oa of vm.toArray(r.keys))b=r.K(oa),aa=new vd.a,aa.set(b[0].node),({rFj:b,Xs:aa}=this.Zwa.Alp(aa)).returnValue?(r.Z(oa,b),M.add(oa,aa)):A.add(oa)}v.ULS.sendTraceTag(589592455,338,50,String.format("GroupGraphNodeContextForIndenationDuration: {0} ms;",window.performance.now()-h));return{returnValue:r,hRm:A,gRm:M}}bLb(b){return this.ljl(b)}Qdc(b){return this.Kil(b)}MTd(b,
h,r=!0){return vd.a.Uea(()=>{var A=!1;if(of.ListItemReader.Cg(b))return this.mmf(b,h,r);A||(Bb.OutlineElementNavigator.Me(b),A=Gd.ParagraphReader.Bh(b)||Ii.TableReader.isTable(b),Bb.OutlineElementNavigator.je(b),A=A&&this.kjl(b,h));return A})}mmf(b,h,r=!0){return vd.a.Uea(()=>{const A=Db.OutlineElementReader.nKa(b),M=gm.OutlineReader.q_(b.currentNode);if(r?!this.dkn(b,h):!this.ekn(b,h))return!1;var aa=vd.a.Za(b.currentNode);if(0<h&&aa.vb(14)){aa.ld(16);var oa=aa.currentNode;const Ja=$g.TableCellReader.uNf(aa);
aa.ld(14);const fb=aa.currentNode;aa=vp.a.cP(oa,fb,Mc.a.oS,Mc.a.Aa,0);oa=vp.a.cP(oa,fb,Mc.a.lV,Mc.a.Ba,0);aa=Ah.a.$z(aa,0);oa=Ah.a.$z(oa,0);return A+M<Ja-aa-oa}return!0})}kjl(b,h){const r=Db.OutlineElementReader.nKa(b);var A=Db.OutlineElementReader.jI(b);if(0<h){h=gm.OutlineReader.q_(b.currentNode);A=0;const {np:Ja,marginLeft:fb,marginRight:Cb}=Wo.$6d(b.currentNode);var M=vd.a.Za(b.currentNode);Bb.OutlineElementNavigator.Me(b);if(Ii.TableReader.isTable(b)){A=Ii.TableReader.Gaa(b);var aa=0;for(var oa of A)aa+=
oa;A=Ah.a.$z(Ah.a.xf(aa,0),0)}Bb.OutlineElementNavigator.je(b);return M.vb(14)?(M.ld(16),oa=M.currentNode,b=$g.TableCellReader.uNf(M),M.ld(14),aa=M.currentNode,M=vp.a.cP(oa,aa,Mc.a.oS,Mc.a.Aa,0),oa=vp.a.cP(oa,aa,Mc.a.lV,Mc.a.Ba,0),M=Ah.a.$z(M,0),oa=Ah.a.$z(oa,0),r+h<b-M-oa-A):r+h<Ja-fb-Cb-A}return 0<r-A}gZa(b,h){this.Eoj(b,-1*Math.abs(h))}eYc(b,h){this.Eoj(b,Math.abs(h))}rQl(b,h,r,A,M){let aa=Wo.Acj;if(h>=Wo.Acj){aa=h-=r;const oa=A*M,Ja=Math.abs(oa),fb=Math.abs(h)%Ja;fb&&(aa=0>aa?0>A?aa+fb:aa-(Ja-
fb):0<A?aa-fb:aa+(Ja-fb));aa+=oa;aa+=r;Wo.Boe&&(r=Db.OutlineElementReader.K2(b),aa=Wo.Boe.Iti(b.currentNode,h+r,aa+r,M,aa<h)-r)}return aa}ijl(b,h,r){if(!b||!b.length)return!1;h=r?h?-1:1:this.yvi(b[0].node,h);return this.jjl(b,h,r)}J3n(b,h,r){if(!b)return v.ULS.shipAssertTag(589345600,338,!1,"The group of listOEs are null which are sent for indentation."),8;if(!b.length)return v.ULS.shipAssertTag(589345601,338,!!b.length,"The group of listOEs are empty which are sent for indentation."),8;if(!r)return v.ULS.shipAssertTag(589592458,
338,!1,"The listIds are null which are sent for indentation."),8;if(!r.length)return v.ULS.shipAssertTag(589592459,338,!1,"The listIds are empty which are sent for indentation."),8;const A=b[0].node;h=this.yvi(A,h);if(!this.xKn(A,r[0],h)||!this.uKn(b,h))return 8;this.$t.N0();return 32}uKn(b,h){for(let r=0;r<b.length;r++){const A=new vd.a;A.set(b[r].node);let M=null;Bb.OutlineElementNavigator.Me(A);if(Gd.ParagraphReader.Bh(A)){if(M=A.currentNode,!M)return v.ULS.shipAssertTag(589592461,338,!M,"The paraNode is null for the list OE node"),
!1}else if(!Gd.ParagraphReader.Bh(A)&&!Ii.TableReader.isTable(A))return v.ULS.shipAssertTag(589592460,338,!1,"The content of the listOE is neither a paragraph nor a table node"),!1;A.rc();if(M){if(this.mWm(M)){const aa=M.XC(),oa=Db.OutlineElementReader.nKa(A);this.gg.TDa(A,1,oa+h);aa&&this.Mj.fV(M,aa,this.Od.Lg)}zi.a.getInstance().Fu||M.setValue(He.a.DU,new Date)}}return!0}xKn(b,h,r){for(let A=0;A<vj.a.FI;A++){const M=this.Zwa.Ty(b,h,A);if(!M)return v.ULS.shipAssertTag(589345602,338,!1,"The list defs returned is null for listId : {0}",
h),!1;const aa=M.getValue(Mc.a.he);aa&&M.setValue(Mc.a.he,aa+r)}return!0}mWm(b){return b.hasProperty(Mc.a.he)||b.hasProperty(Mc.a.Mt)||b.hasProperty(Mc.a.qD)}Kil(b){return this.MTd(b,1,!0)}ljl(b){return this.MTd(b,-1,!0)}yvi(b,h){var r=new vd.a;r.set(b);const A=Db.OutlineElementReader.nKa(r),M=Db.OutlineElementReader.jI(r),aa=Db.OutlineElementReader.K2(r);r=gm.OutlineReader.q_(b);Wo.$6d(b);b=(M?A-M:aa)%r;return h?-1*(b?b:r):r-b>Wo.Obi?Wo.Obi:r-b}bmp(b,h){if(of.ListItemReader.Ce)return h=of.ListItemReader.Yka(b),
h=xJ.a.Ujc(null===h||void 0===h?void 0:h.listId),{groupId:h,returnValue:null!=h};let r;const A=new vd.a;A.set(b);b=A.Ub(4).getValue(Mc.a.listID);return({id:r}=this.Zwa.Pzc(b,h)).returnValue?{returnValue:!0,groupId:r}:{returnValue:!1,groupId:r}}jjl(b,h,r){var A=!1;for(let M=0;M<b.length;M++){A=b[M];const aa=new vd.a;aa.set(A.node);ze.a.tv(aa);if(!Db.OutlineElementReader.Nh(aa))return Wo.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.mNb}),!1;if(this.MTd(aa,h,r))A=!0;else return Wo.Dc.$b(Nf.a.wgc,{["Reason"]:nf.a.Fmf}),
!1}return A}Eoj(b,h){if(this.MTd(b,h,!0)){var r=!1;if(of.ListItemReader.Cg(b)){var A=new vd.a;A.hd(b);this.Ps.o0(A);var M=A.currentNode;A.rc();r=!0;const {listId:oa,listLevel:Ja}=of.ListItemReader.Yka(b);var aa=this.rJm(oa,Ja+h);if(aa)Bb.OutlineElementNavigator.Me(A),Gd.ParagraphReader.Bh(A)&&Wo.pM.WP(aa,A.currentNode,!1),A.rc();else{aa=null;let fb;Bb.OutlineElementNavigator.Me(A);Gd.ParagraphReader.Bh(A)&&(aa=A.currentNode);A.rc();fb=aa?aa.XC():null;aa||(Bb.OutlineElementNavigator.Me(A),Gd.ParagraphReader.Bh(A)&&
(aa=A.currentNode),A.rc());aa&&(aa.hasProperty(Mc.a.he)&&aa.removeProperty(Mc.a.he),aa.hasProperty(Mc.a.Mt)&&aa.removeProperty(Mc.a.Mt));zi.a.getInstance().Kt||M.setValue(Mc.a.listLevel,Ja+h);zi.a.getInstance().Fu&&this.zI.n_b(aa,oa,Ja+h);zi.a.getInstance().Kt||M.removeProperty(Mc.a.h0);aa&&fb&&(this.Mj.fV(aa,fb,this.Od.Lg),this.$t.N0());this.Wcp(b,of.ListItemReader.Ce?aa:M)}}r||(r=Db.OutlineElementReader.nKa(b),A=Db.OutlineElementReader.jI(b),M=gm.OutlineReader.q_(b.currentNode),h=this.rQl(b,r,A,
h,M),this.gg.TDa(b,1,h))}}ekn(b,h){const r=Db.OutlineElementReader.nKa(b),A=Db.OutlineElementReader.jI(b),M=Db.OutlineElementReader.K2(b),{np:aa,marginLeft:oa,marginRight:Ja}=Wo.$6d(b.currentNode);if(0<h){if(b=aa-oa-Ja,M&&M+h+df.a.SEa>b||r+h+df.a.SEa>b)return!1}else if(M&&0>r+h||0>r-A+h)return!1;return!0}dkn(b,h){var r=this.$t.jE(b);const A=r.level+h;if(Jy.a.aun<A||A<Jy.a.p8l)return!1;r=this.Ps.Ty(b.currentNode,r.listID,A);if(!r)return v.ULS.shipAssertTag(590700875,338,!!r),!1;if(0<h&&r.hasProperty(Mc.a.he)){h=
r.getValue(Mc.a.he);const {np:M,marginLeft:aa,marginRight:oa}=Wo.$6d(b.currentNode);if(h+df.a.SEa>M-aa-oa)return!1}return!0}rJm(b,h){const r=this.Wb.qo();let A,M;this.Xg.Ln?(A=r.gv(),M=A.Jw):M=r.Jw;for(let oa=0;oa<M;oa++){var aa=void 0;this.Xg.Ln?(aa=A.gla(oa),aa=r.lh(this.Wb.ze(aa))):aa=r.XAa(oa);if(this.Ps.wob(aa)&&aa.ka(Mc.a.listID,this.$t.pba+1)===b&&aa.ka(Mc.a.listLevel,-1)===h)return aa}return null}Wcp(b,h){Bb.OutlineElementNavigator.Me(b);if(Gd.ParagraphReader.Bh(b)&&b.currentNode.hasProperty(Mc.a.he)&&
(h=this.Ps.Jjc(h))){if(h.hasProperty(Mc.a.Mt)){var r=h.getValue(Mc.a.Mt);this.A2e.Uxb(b.currentNode,r)}h.hasProperty(Mc.a.he)&&(r=h.getValue(Mc.a.he),this.A2e.TDa(b,1,r));h.hasProperty(Mc.a.qD)&&(h=h.getValue(Mc.a.qD),this.A2e.aha(b.currentNode,h))}Bb.OutlineElementNavigator.je(b)}static get pM(){return null!=Wo.L5g?Wo.L5g:Wo.L5g=Za.a.instance.resolve(392)}static get Boe(){return null!=Wo.D1g?Wo.D1g:Wo.D1g=Za.a.instance.Oa(656)}static get nl(){return Wo.wv||(Wo.wv=Za.a.instance.resolve(348))}static set nl(b){Wo.wv=
b}static get Dc(){return Rg.a.instance}static get tg(){return br.a.instance}static $6d(b){var h=Rx.WordSectionNavigator.instance.WR(b);b=Wo.tg.Gv(h);const r=Wo.tg.kN(h);h=Wo.tg.lN(h);return{np:b,marginLeft:r,marginRight:h}}}Wo.Obi=Jg.a.gD(.25);Wo.wv=null;Wo.Acj=Jg.a.gD(-11);Object(u.a)(Wo,"OutlineElementIndentationEditor",null,[261,262]);var PC=d(249),qB;(function(b){b[b.none=0]="none";b[b.character=1]="character";b[b.paragraph=2]="paragraph";b[b.table=3]="table"})(qB||(qB={}));Object(u.b)("StyleTargetType",
qB);class DE{constructor(b,h){this.sT=null;this.GM=h;this.jg=b}get nl(){return null!=this.l1g?this.l1g:this.l1g=Za.a.instance.resolve(348)}get VC(){return null!=this.YVg?this.YVg:this.YVg=Za.a.instance.resolve(30)}get im(){return null!=this.oWg?this.oWg:this.oWg=Za.a.instance.resolve(101)}get Wb(){return null!=this.m6g?this.m6g:this.m6g=Za.a.instance.resolve(8)}get R0(){return this.sT||(this.sT=new Bu.WACStyleSet)}set R0(b){this.sT=b}get sc(){return null!=this.uVg?this.uVg:this.uVg=Za.a.instance.Oa(12)}get $l(){return this.GM.value}get pk(){return null!=
this.yXg?this.yXg:this.yXg=Za.a.instance.Oa(106)}get Yad(){return this.jg||(this.jg=Za.a.instance.resolve(10))}get Fg(){return null!=this.VSg?this.VSg:this.VSg=Za.a.instance.resolve(322)}get Od(){return null!=this.c5g?this.c5g:this.c5g=Za.a.instance.resolve(46).instance}get Mj(){return null!=this.C4g?this.C4g:this.C4g=Za.a.instance.resolve(39).instance}get CF(){return null!=this.PWg?this.PWg:this.PWg=Za.a.instance.resolve(86)}zJm(b){const h=b.node;var r=this.pk?this.pk.oti():null;if(r&&!r.equals(N.a.nil)){if(b=
h.Ic,!b||(r=this.R0.hla(r,b))&&1!==this.Wb.BF(r))return null}else r=Wa.FormattingReader.Rs(b),r=Wa.FormattingReader.bBa(r);return r}YVo(b,h){const r=this.Wb.AF(h);r&&r.lh(this.Wb.ze(b))&&(this.NLg(h,r),this.pk&&(this.pk.dxb(),this.pk.Ydb(b,h)))}f5k(b,h){if(h)if(h.FOb&&0<h.FOb.length){let M=new Sa.a;for(var r of h.FOb)M.add(r);if(h.r3i){r=Wa.FormattingReader.rri(b);const aa=[];for(var A of r)A.formatting&&A.formatting.lo&&aa.push(A.formatting.lo);if(0<aa.length){A=yC.APropertySet.$yi(aa);r=new Sa.a;
for(const oa of M)(!A.hasProperty(oa)||h.Hsn&&oa===De.a.Efb)&&r.add(oa);M=r}}this.nl.sLb(b,!0,M)}else this.nl.sLb(b,!0);else Tc.b(576582787,3018,15,"Cannot apply alternate formatting strategy as ClearSpecificFormattingProperties is null")}WP(b,h,r,A=!1,M=!1,aa=!1,oa=null,Ja=!1){var fb,Cb,Gb;if(Gd.ParagraphReader.Vb(h))if(b)if(this.Wb.f0(b.Wi()))if(2!==this.Wb.BF(b))v.ULS.shipAssertTag(593506381,324,!1);else{var Sb=this.Wb.AF(h);if(Sb){var pc=this.Wb.ze(b);if(!pc)v.ULS.shipAssertTag(593506377,324,
!1);else if(Sb.lh(pc)){var zc=null,Yc=A?null:h.XC();r||((null===oa||void 0===oa?0:oa.Bil)&&(null===(fb=this.sc)||void 0===fb?0:fb.isFeatureEnabled(95))?(this.f5k(h,oa),zi.a.getInstance().Kt||1!=oa.FOb.length||oa.FOb[0]!=De.a.Efb?this.Isp(h,b,oa):zc=this.$l.jxj(zc,h)):(zi.a.getInstance().Kt||(zc=this.$l.jxj(zc,h)),this.nl.sLb(h,!0)));this.NLg(h,Sb);M&&(null===Yc||void 0===Yc?0:Yc.hasProperty(wb.a.Yw))&&Yc.removeProperty(wb.a.Yw);of.ListItemReader.Ce&&!zi.a.getInstance().Kt&&this.RRh(b,h,zc,Ja);(null===
(Cb=this.CF)||void 0===Cb?0:Cb.pca)?this.CF.pca(h,wb.a.Yw,b.id):h.properties.setValue(wb.a.Yw,b.id);(Ja||(of.ListItemReader.Ce?of.ListItemReader.isListItem(h):this.Yad.jfa(h)))&&(null===(Gb=this.sc)||void 0===Gb?0:Gb.isFeatureEnabled(95))&&this.m5j(h,b,oa);h.eQ=b;h.kOa=null;for(r=0;r<h.ra.length;r++)h.ra.K(r).formatting&&h.ra.K(r).formatting.cSb();of.ListItemReader.Ce||this.RRh(b,h,zc,Ja);null!=this.VC&&this.VC.qxc(pc);A||!Yc||aa||this.Mj.fV(h,Yc,this.Od.Lg);of.ListItemReader.Ce&&this.Yad.wob(b)&&
this.$l.N0()}}else v.ULS.shipAssertTag(593506379,324,!1)}else v.ULS.shipAssertTag(593506382,324,!1);else v.ULS.shipAssertTag(593506383,324,!1);else v.ULS.shipAssertTag(593506384,324,!1)}RRh(b,h,r,A){this.Yad.wob(b)&&(r||(r=new vd.a,r.set(h),r.Kd(),Bb.OutlineElementNavigator.je(r)),A||of.ListItemReader.Cg(r)||(h.Uf(Mc.a.he,Mc.a.WU,Mc.a.qD,Mc.a.d8,Mc.a.QYa,Mc.a.ry),this.SRd(r,b)))}Isp(b,h,r){let A;zi.a.getInstance().Kt||(A=this.Yad.jfa(b));const M=this.Yad.wob(h);if(!zi.a.getInstance().Kt&&A||of.ListItemReader.Ce&&
of.ListItemReader.isListItem(b))this.m5j(b,h,r),zi.a.getInstance().Kt||!A||M||A.removeProperty(Mc.a.h0)}m5j(b,h,r){const A=b.Ic;if(b=this.Fg.V7a(b)){var M=null==b.lo?new PC.a:b.lo.clone();si.a.Yvp(M,h,r&&!r.r3i&&r.FOb?r.FOb:null);M.ELa?h=A.IP(M,!0):(A.ku(M,null),h=M);b.Ek=h.id}else v.ULS.sendTraceTag(574660761,3018,15,"EOP formatting is null, skipping application on EOP.")}SRd(){}Fnd(b,h){if(h){v.ULS.shipAssertTag(593506371,324,h.isConnected,"paragraphNode not connected");var r=this.Wb.AF(h);r?(si.a.Xg.Ln?
(b=r.gv().YAa(b),r=r.lh(this.Wb.ze(b))):r=r.wKa(b),r?this.Wb.f0(r.Wi())?this.WP(r,h,!1,void 0,void 0,void 0,null):v.ULS.shipAssertTag(593506368,324,this.Wb.f0(r.Wi())):v.ULS.shipAssertTag(593506369,324,!!r)):v.ULS.shipAssertTag(593506370,324,!1,"StyleReader.GetStyleSetFromParagraphNode==null")}else v.ULS.shipAssertTag(593506372,324,!1)}Ynf(b,h=!1,r=!1){const A=this.Wb.AF(b).lh(Zl.StyleReader.wordStyleIdNormal);this.WP(A,b,h,void 0,r)}NLg(b,h){(b=Object(vo.a)().Iu(b))&&h.Bzg(b)}Nci(b){var h=null;if(!b||
!b.count)return v.ULS.sendTraceTag(592221652,3018,10,"No style IDs provided for delete."),!1;if(!h&&(h=si.a.Ip(),!h))return v.ULS.sendTraceTag(592221653,3018,15,"Couldn't retreive PageContentNode."),!1;var r=this.R0.Rka(h);if(!r)return v.ULS.sendTraceTag(592221654,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;var A=new Map;A.set("NumberOfStyles",b.count.toString());A.set("Source","DeleteStyleAPI");Ba.Health.instance.recordKpiUsage(Kr.a.GFe,0,Kr.a.NB,A);A=0;const M=(new Date).getTime();
var aa=null;let oa=null,Ja=null,fb=null;const Cb=this.sc.isFeatureEnabled(30)&&!0;Cb&&(aa=new ib.a,oa=new ib.a,Ja=new ib.a,fb=new ib.a);for(var Gb of b){if(!Gb)return v.ULS.sendTraceTag(592221655,3018,50,"Style ID is null."),!1;const Sb=r.SVa(Gb);if(!Sb||!this.Wb.me(Sb,r))return v.ULS.sendTraceTag(592221656,3018,50,"Provided style is null[{0}] or not a custom style [{1}].",!Sb,!!Sb&&this.Wb.me(Sb,r)),!1;const pc=this.Wb.BF(Sb);if(2!==pc&&1!==pc)return v.ULS.sendTraceTag(592221657,3018,50,"Provided style has style type: {0}.",
pc),!1;const zc=this.Wb.Hjc(Sb,r);let Yc=0;if(zc){if(!this.Wb.me(zc,r))return v.ULS.sendTraceTag(571074068,3018,15,"Provided custom style's linked style is not a custom style."),!1;Yc=this.Wb.BF(zc);if(2!==Yc&&1!==Yc)return v.ULS.sendTraceTag(592221659,3018,15,"Provided style's target type: {0}, linked style's target type: {1}. ",pc,Yc),!1}else v.ULS.sendTraceTag(592221658,3018,50,"Provided style's linked style is null.");let Kd=this.WMb(Sb,r);if(!Kd)return!1;A++;Cb&&(1===pc?(oa.add(Gb),fb.add(Sb.id)):
(aa.add(Gb),Ja.add(Sb.id)));if(zc){Kd=this.WMb(zc,r);if(!Kd)return!1;A++;Cb&&(1===Yc?(oa.add(this.Wb.ze(zc)),fb.add(zc.id)):(aa.add(this.Wb.ze(zc)),Ja.add(zc.id)))}}Vh.a.Cmc();r=si.a.eNf(r);Gb=new Rb.GraphTransaction(15);Gb.Bb(h);Cb&&this.Swo(aa,oa,Ja,fb,h);h.setValue(wb.a.uha,r);Tc.b(572302817,3018,50,String.format("Style Object Ids - {0}",r));Gb.pwe();Gb.dispose();h=(new Date).getTime();aa=new Map;aa.set("Source","DeleteStyleAPI");aa.set("NumberOfStyles",b.count.toString());aa.set("TrueStyleCount",
A.toString());aa.set("ShouldRemoveReferences",(!0).toString());b=Object.assign(new bb.a,{extendedProperties:aa,durationMs:h-M});Ba.Health.instance.recordKpiSuccess(Kr.a.GFe,b);return!0}Swo(b,h,r,A,M){if(b&&b.count||h&&h.count)if(M){var aa=(new Date).getTime();if(M=this.Knm(M)){for(;M.moveNext();){if(!Gd.ParagraphReader.Bh(M.iterator))continue;const oa=M.currentNode;this.Bwo(oa,b,r);this.Cwo(oa,h,A)}r=(new Date).getTime();v.ULS.sendTraceTag(591148963,3018,50,String.format("RemoveStyleReferences Duration: {0} ms;",
r-aa));A=new Map;A.set("Source","DeleteStyleRemoveStylesReferences");A.set("NumberOfStyles",(b.count+h.count).toString());b=Object.assign(new bb.a,{extendedProperties:A,durationMs:r-aa});Ba.Health.instance.recordKpiSuccess(Kr.a.GFe,b)}}else Tc.b(577520338,3018,50,"PageContentNode not provided.");else Tc.b(577520337,3018,50,"No style IDs provided")}Bwo(b,h,r){if(h&&h.count&&b){var A=b.Fx;A&&A.hasProperty(wb.a.Yw)&&r.contains(A.getValue(wb.a.Yw))&&(A.removeProperty(wb.a.Yw),b.Fx=A,b.XC()&&this.Mj.fV(b,
b.XC(),this.Od.Lg));(r=this.Wb.Aq(b))&&(r=this.Wb.ze(r))&&h.contains(r)&&this.Ynf(b,!0,!0)}}Cwo(b,h,r){if(b&&b.ra&&b.ra.length&&h&&h.count)for(let oa=0;oa<b.ra.length;oa++){var A=b.ra.K(oa);if(A&&A.formatting&&(A=A.formatting)&&A.Jb){var M=Wa.FormattingReader.bBa(A);M&&(M=this.Wb.ze(M))&&h.contains(M)&&this.im.Pnf(A);if(M=A.Jb.Go){var aa=M.lo;aa&&(aa=aa.clone(),aa.hasProperty(wb.a.Fw)&&r.contains(aa.getValue(wb.a.Fw))&&this.Iuo(b,aa,M,A));aa=oa===b.ra.length-1?b.characterData.length:b.ra.K(oa+1).cp;
this.Mj.k_b(b,A.Jb,A.Jb.cp,aa,M,A,this.Od.Lg)}}}}Iuo(b,h,r,A){b&&h&&r&&A&&(b=b.Ic)&&(h.removeProperty(wb.a.Fw),h.ELa?h=b.IP(h,!0):b.ku(h,null),r.Ek=h.id,A.Jb.Go=r)}Knm(b){if(!b)return null;b=vd.a.Za(b);return b.pq()?uf.a.At(b,b.origin):null}WMb(b,h){if(!b)return v.ULS.sendTraceTag(592221660,3018,10,"WACStyle for given style ID is null."),!1;var r=b.Wi();return this.Wb.f0(r)?h.yrg(b)?!0:(r=new Map,r.set("Source","DeleteStyle"),r.set("StyleType",qB[this.Wb.BF(b)]),r.set("IsCustomStyle",this.Wb.me(b,
h).toString()),r.set("IsLinkedStyle",(!!this.Wb.Hjc(b,h)).toString()),b=Object.assign(new bb.a,{extendedProperties:r}),Ba.Health.instance.recordKpiFailure(Kr.a.GFe,"UnableToDeleteStyle",!1,!0,b),v.ULS.sendTraceTag(592221662,3018,50,"Couldn't remove style from style set."),!1):(v.ULS.sendTraceTag(592221661,3018,50,"Invalid property set inside WACStyle."),!1)}vbb(b,h,r,A){if(this.sc&&this.sc.isFeatureEnabled(74)){if(!b)return v.ULS.sendTraceTag(591138959,3018,15,"No style IDs provided for delete."),
!1;if(!r&&(r=si.a.Ip(),!r))return v.ULS.sendTraceTag(591138960,3018,15,"Couldn't retreive PageContentNode."),!1;const aa=this.R0.Rka(r);if(!aa)return v.ULS.sendTraceTag(591138961,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;b=aa.SVa(b);if(!b)return v.ULS.sendTraceTag(591138962,3018,50,"Provided style is null[{0}].",!b),!1;var M=this.Wb.BF(b);if(2!==M&&1!==M)return v.ULS.sendTraceTag(591138963,3018,50,"Provided style has style type: {0}.",M),!1;Ba.Health.instance.recordKpiUsage(Kr.a.fOg,
0,Kr.a.NB,new Map([["Source","ModifyStyleAPI"]]));M=Date.now();const oa=new Rb.GraphTransaction(15);let Ja,fb;try{oa.Bb(r);if(!(A&&0!=A.length||h&&0!=h.count))return!1;if(A&&0!=A.length&&(Ja=si.a.V2c(b),!aa.Bvf(b,A)))return this.QLa("ModifyStyleAPI",b,aa,M,"UnableToDeleteStyleProperties"),!1;if(h&&0!=h.count){const zc=aa.MLg(b,h);fb=si.a.V2c(b);if(!zc)return this.QLa("ModifyStyleAPI",b,aa,M,"UnableToModifyStyle"),!1}this.zKn(b,r,fb,Ja);Vh.a.Cmc();const Cb=si.a.eNf(aa);r.setValue(wb.a.uha,Cb);Tc.b(572302818,
3018,50,String.format("Style Object Ids - {0}",Cb));const Gb=Date.now(),Sb=new Map([["Source","ModifyStyleAPI"]]),pc=Object.assign(new bb.a,{extendedProperties:Sb,durationMs:Gb-M});Ba.Health.instance.recordKpiSuccess(Kr.a.fOg,pc);return!0}finally{oa&&oa.dispose()}}return!1}zKn(b,h,r,A){var M,aa;if(null!==b){var oa;A&&((oa=null===(M=this.$l)||void 0===M?void 0:M.xsd(h,A,b,!0))||Tc.b(522856385,3018,50,"Cannot able to remove the pstyle property in list def during modify style."));r&&((oa=null===(aa=
this.$l)||void 0===aa?void 0:aa.xsd(h,r,b,!1))||Tc.b(522856386,3018,50,"Cannot able to modify the pstyle property in list def during modify style."))}}QLa(b,h,r,A,M){const aa=Date.now(),oa=!!this.Wb.Hjc(h,r);b=new Map([["Source",b],["StyleType",qB[this.Wb.BF(h)]],["IsCustomStyle",this.Wb.me(h,r).toString()],["IsLinkedStyle",oa.toString()]]);A=Object.assign(new bb.a,{extendedProperties:b,durationMs:aa-A});Ba.Health.instance.recordKpiFailure(Kr.a.fOg,M,!1,!0,A)}}Object(u.a)(DE,"WACStyleEditor",null,
[1476]);class EE extends DE{constructor(b,h,r){super(b,r);this.J9=h}get $t(){return this.J9.value}SRd(b,h){this.$t.SRd(b,h)}}Object(u.a)(EE,"WACStyleEditor",DE,[]);class HG{Pdb(b,h){b.properties.setValue(Mc.a.marginTop,h)}Ndb(b,h){b.properties.setValue(Mc.a.marginBottom,h)}pna(b,h){b.properties.setValue(Mc.a.marginLeft,h)}Odb(b,h){b.properties.setValue(Mc.a.marginRight,h)}azg(b,h){b.properties.setValue(Mc.a.np,h)}$yg(b,h){b.properties.setValue(Mc.a.rw,h)}KMj(b,h){b.properties.setValue(Mc.a.H3i,h)}f_b(b,
h){b.properties.setValue(De.a.HG,h)}ZOo(b,h){b.properties.setValue(De.a.hra,h)}kwc(b,h){b.properties.setValue(De.a.RH,h)}AVo(b,h){b.properties.setValue(De.a.separator,h)}}Object(u.a)(HG,"WordSectionEditor",null,[234]);class FE{get name(){return"WordEditor.OutlineLevelEditors"}uc(b){b.ia("WordEditor.OutlineLevelEditors.WordSectionEditor",()=>new HG).as(1150).ha();y.AFrameworkApplication.J.$("OutlineLevelEditorsDelayInitializationEnabled")&&(b.ia("Box4.OutlineLevelEditors.PageContentEditor",()=>new Zy(b.resolve(110))).as(102).ha(),
b.ia("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new Wo(Rj.a.o9a,b.resolve(452),b.rf(18),b.rf(618),b.resolve(947))).as(659),b.ia("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new Wo(Rj.a.o9a,b.resolve(452),b.rf(18),b.rf(618),b.resolve(947))).as(948),b.ia("WordEditor.OutlineLevelEditors.CursorMoveValidator",()=>new wJ).as(1091).ha(),b.ia("Box4.Styles.WACStyleReader",()=>new vJ.a(new Bu.WACStyleSet)).as(8).ha(),b.ia("WordEditor.OutlineLevelEditors.WACStyleEditor",
()=>new EE(b.resolve(10),b.rf(618),b.rf(32))).as(392).ha())}init(){}dispose(){}static main(){K.a.instance.Lc(new FE)}}Object(u.a)(FE,"WordEditorOutlineLevelEditorsPackage",null,[0,1]);var IG=d(590),GE=d(210);class ao{constructor(b,h){this.Md=b;this.Oh=h;this.cSa=null}ISo(b,h,r){Fm.a.mjn||({listId:h,listLevel:r}=of.ListItemReader.bKf(b,{Gra:0,wUa:-1}));if(0<h&&0<=r)this.cSa=b;else{let A=1;const M=b.listStyle;42!==M&&0<M&&(A=M);this.cSa=fq.a.c_(b.listType,A,null,h,r,void 0,"")}h=new Cq.a;switch(b.b9){case 0:this.cSa.YA=
h.Yrf();break;case 2:this.cSa.YA=h.S7h(h.SWh,h.RWh);break;case 1:this.cSa.YA=h.Ssf(h.Ubg,h.Vbg)}}XTo(b){b&&(this.cSa=b)}l9h(b){var h=Rg.a.instance.nq(ub.a.QEl);Db.OutlineElementReader.Nh(b)||(v.ULS.sendTraceTag(508904658,393,15,"PossiblyIncorrectListCreation - createList called with a non OE iterator"),Rg.a.instance.$b("PossiblyIncorrectListCreation",{["Reason"]:nf.a.mNb}));of.ListItemReader.Cg(b)&&(v.ULS.sendTraceTag(508904657,393,15,"PossiblyIncorrectListCreation - createList called when OE already has list"),
Rg.a.instance.$b("PossiblyIncorrectListCreation",{["Reason"]:nf.a.hxl}));const r=Db.OutlineElementReader.nN(b);r&&!r.hasProperty(Mc.a.mAa)&&v.ULS.sendTraceTag(560563602,393,50,"Paragraph has null EOP formatting during creation of list node.");if(of.ListItemReader.Ce&&b.Ub(4))return v.ULS.sendTraceTag(508412242,393,15,"PossiblyIncorrectListCreation - createList called when OE already has numberListNode"),h=b.currentNode,b.rc(),h;of.ListItemReader.Ce&&b.Ub(31)&&b.Rg();const A=this.UEl();b.Vf(A,4);r&&
(r.bE=A);h.end();return A}UEl(){return hw.a.instance.createInstance(wm.a.Nbb)}Nga(b){const h=Rg.a.instance.nq(ub.a.Nga);Db.OutlineElementReader.Nh(b)||Rg.a.instance.$b("PossiblyIncorrectListRemoval",{["Reason"]:nf.a.mNb});of.ListItemReader.Cg(b)&&(zi.a.getInstance().Fu?this.bca(b):this.ZAj(b));h.end()}ZAj(b){this.Md.o0(b);b.Rg()}jZi(b){let h=!1;1===b.Ys&&b.zta&&!b.IL&&(h=!0);const r=b.ff.ka(Mc.a.Tw,null);r&&r===Box4Intl.Box4Strings.L_ListStyleNone&&(1===b.listType?h=b.zta&&!b.IL:b.listType||(h=!b.listStyle));
return h}Dqa(b,h,r,A=!1){const M=Rg.a.instance.nq(ub.a.m5k);this.INj(b,r,A);const aa=b.hasProperty(pd.a.Aej);var oa=b.ka(pd.a.oce,!1);const Ja=this.jZi(r);if(oa)Ja&&(r.nca(16,0),b.setValue(pd.a.XB,16),b.setValue(pd.a.PXa,0));else{oa=this.Md.Pw(h);this.CBg(r,oa,aa,Ja)&&(M.properties.Z("ToggledOff","true"),r.nca(16,0),this.LSo(b));if(!this.ape(b,h,r,A))return M.end(),v.ULS.sendTraceTag(578331472,393,15,"Failed in performing auto correct numbering."),{returnValue:!1,wla:r};!r.listType&&b.hasProperty(pd.a.MLa)&&
(r.tD=b.getValue(pd.a.MLa),b.removeProperty(pd.a.MLa))}if(aa&&(M.properties.Z("MultipleOESelection","true"),this.JRj(h,r)))return M.end(),v.ULS.sendTraceTag(578331473,393,15,"Multiple OE selected and OE is empty as well."),{returnValue:!1,wla:r};this.W0k(h,r,b,A);kt.HEj();b.hasProperty(fd.a.wT)&&kt.nBl(b.getValue(fd.a.wT),h,this.Md);b.setValue(pd.a.oce,!0);M.end();return{returnValue:!0,wla:r}}CBg(b,h,r,A){if(A)return!0;if(h){A=b.listType===h.listType;const M=!b.listStyle&&b.tD===vj.a.Jk;let aa=b.listStyle===
h.listStyle&&b.tD===h.tD;b=(!b.zta||this.uvg(h,b))&&!r;aa=aa&&b;return A&&(M||aa)}return!1}LSo(b){b.setValue(pd.a.XB,16);b.setValue(pd.a.PXa,0)}uvg(){return!0}INj(){}ape(){return!0}JRj(b,h){return h&&16!==h.listType&&Db.OutlineElementReader.isEmpty(b,!0)}LUc(b){const h=Rg.a.instance.nq(ub.a.LUc);Gd.ParagraphReader.Vb(b)||Rg.a.instance.$b("ClearingListFromNonParagraph",{["Reason"]:nf.a.Qxf});const r=new vd.a;r.set(b);r.Kd();r.jt(12);Bb.OutlineElementNavigator.je(r);this.bca(r);h.end()}merge(b,h,r){const A=
Rg.a.instance.nq(ub.a.Jwn);Db.OutlineElementReader.Nh(h)||Rg.a.instance.$b("PossibleIncorrectMergeOfOEs",{["Reason"]:"SrcIsNotOE"});Db.OutlineElementReader.Nh(b)||Rg.a.instance.$b("PossibleIncorrectMergeOfOEs",{["Reason"]:"DestIsNotOE"});of.ListItemReader.Cg(h)&&(A.properties.Z("UseSourceListWithNonlistDestination",r.toString()),r&&of.ListItemReader.Cg(b)&&this.Nga(b),of.ListItemReader.Cg(b)&&!r?this.ruj(h,b):r&&(r=this.Ozi(h),1===r.Ys&&r.Anf(!0),this.Pcc(b,r),A.properties.Z("MoveListInfoFromSrcToDestOE",
"true")),this.Nga(h),A.properties.Z("RemoveListFromSrcOE","true"));A.end();return!0}ruj(){}Ozi(b){return this.Md.Pw(b)}SZc(b,h){h.hasProperty(pd.a.XB)||(b===ub.a.ME?h.setValue(pd.a.XB,1):(b===ub.a.MN||b===ub.a.iga)&&h.setValue(pd.a.XB,0));h.hasProperty(pd.a.PXa)||h.setValue(pd.a.PXa,0);return h}gdc(b,h,r,A,M,aa,oa,Ja){const fb=Rg.a.instance.nq(ub.a.gdc),Cb=this.Md.Pw(h);r=fq.a.c_(0,r,void 0,void 0,void 0,oa);r.tD=A;r.wT=aa;Cb&&r.nRf(Cb)&&r.tD===Cb.Bx||(A=new Rb.GraphTransaction(15),A.mu(h),Ja.iQn(r.listType,
r.listStyle,r.tD,r.levelText,r.wT)&&(ao.Fg.Ve(M,""),!of.ListItemReader.Ce&&Gd.ParagraphReader.Vb(b)&&GE.a.Pla(b)&&(h=this.Md.jfa(b))&&ao.Fg.DZl(b,h)),A.dispose());fb.end()}xsd(b,h,r,A=!1){if(null===r||null===b||null===h)return!1;b=this.Md.Ty(b,h.listId,h.listLevel);if(!b)return v.ULS.sendTraceTag(523069061,393,15,"List def not exist when trying to update pStyle Property."),!1;if(A){if(b.hasProperty(wb.a.Yw)){b.getValue(wb.a.Yw)instanceof N.a||v.ULS.sendTraceTag(512267811,393,15,"StyleObject ID already in list def is not ExtendedGuid.");
if(!N.a.xt(b.getValue(wb.a.Yw),r.id))return v.ULS.sendTraceTag(523069062,393,15,"List def has different pStyle than what we are expecting to remove, thus not removing it."),!1;b.removeProperty(wb.a.Yw);return!0}}else{r=r.id;r instanceof N.a||v.ULS.sendTraceTag(512267810,393,15,"StyleObject ID to be set on list def is not extendedGuid");if(b.hasProperty(wb.a.Yw))return v.ULS.sendTraceTag(523069063,393,15,"List def has different pStyle than what we are expecting to set, thus not setting it."),!1;b.setValue(wb.a.Yw,
r);return!0}return!1}static get hic(){return null!=ao.SVg?ao.SVg:ao.SVg=Za.a.instance.Oa(118)}static get Fg(){return null!=ao.NSg?ao.NSg:ao.NSg=Za.a.instance.resolve(322)}static get Cs(){return zi.a.getInstance()}}Object(u.a)(ao,"ListEditor",null,[286]);var ey=d(797),uw=d(320);class au{constructor(b,h,r,A,M,aa){this.jg=M;this._pageContent=r;this.NFb=Array(au.FI);this.fac=Array(au.FI);this.GEh=Array(au.FI);this.H5e=Array(au.FI);this.VAh=Array(au.FI);this.K5=A;this.EQc=aa;for(A=0;A<au.FI;A++){var oa=
this.U2c(b,A,r,M);oa?(aa=oa.ka(He.a.GU,vj.a.Jk),oa=oa.ka(Mc.a.mZb,vj.a.Jk)):oa=aa=vj.a.Jk;this.fac[A]=aa!==vj.a.Jk?aa:vj.a.p7a;this.H5e[A]=oa===vj.a.Jk?A-1:oa-1;au.sba(h)&&(this.GEh[A]=vj.a.Jk,this.VAh[A]=vj.a.Jk);this.NFb[A]=this.fac[A]}}U2c(b,h,r,A){A.M6(r);return zi.a.getInstance().W7c&&this.EQc?this.jg.mKf(b,h,this.K5,r):this.jg.X2c(b,h,r.Ic,r)}restart(b){this.NFb[b]=this.fac[b]}lke(b){for(var h=0;h<b;h++)this.NFb[h]===this.fac[h]&&this.NFb[h]++;for(h=b+1;h<au.FI;h++)this.H5e[h]>=b&&this.restart(h);
return this.NFb[b]++}static sba(b){return!!b&&b.isFeatureEnabled(64)}}au.FI=9;Object(u.a)(au,"AWordList",null,[1614]);class HE{constructor(b,h,r,A){this.fjb=new qq.ScriptSharpLegacyMap;this.jg=b;this.JM=h;this.K5=r;this.EQc=A}Pw(b,h){this.fjb.lb(b)||this.fjb.Z(b,new au(b,h,this.JM,this.K5,this.jg,this.EQc));return this.fjb.K(b)}frc(b,h,r){return this.Pw(b,r).lke(h)}}Object(u.a)(HE,"AListNumberingMap",null,[1615]);class fy extends au{constructor(b,h,r,A,M,aa){super(b,h,r,A,M,aa)}kLf(b,h,r,A){A.M6(r);
return zi.a.getInstance().W7c&&this.EQc?this.jg.ewm(b,h,this.K5):this.jg.dwm(b,h,this._pageContent.Ic)}psd(b,h,r){var A=this.kLf(b,h,this._pageContent,this.jg);A?(b=A.ka(He.a.GU,vj.a.p7a),A=A.ka(Mc.a.mZb,vj.a.Jk),this.NFb[h]=this.GEh[h]=this.fac[h]=b,A!==vj.a.Jk&&(this.VAh[h]=this.H5e[h]=A-1)):r&&(A=this.U2c(b,h,this._pageContent,this.jg),b=vj.a.p7a,A&&(b=A.ka(He.a.GU,vj.a.p7a)),this.NFb[h]=this.fac[h]=b)}}Object(u.a)(fy,"WordList",au,[]);class QC extends HE{constructor(b){super(b.Md,b.Uh,b.cB,b.E8j);
this.lzh=new ib.a}cKf(b,h,r){let A;zi.a.getInstance().e0?{value:A}=this.jg.FF.Ac(b,A):{value:A}=this.jg.p3.Ac(b,A);this.fjb.lb(A)||this.fjb.Z(A,new fy(b,r,this.JM,this.K5,this.jg,this.EQc));if(!this.lzh.contains(b))for(this.lzh.add(b);h<vj.a.FI;h++)this.fjb.K(A).psd(b,h,!1);else if(!h)for(h+=1;h<vj.a.FI;h++)this.fjb.K(A).psd(b,h,!0);return this.fjb.K(A)}frc(b,h,r){return au.sba(r)?this.cKf(b,h,r).lke(h):super.frc(b,h,r)}}Object(u.a)(QC,"ListNumberingMap",HE,[]);class rB{constructor(){this.Zub=0;this.r$j=
!1}}Object(u.a)(rB,"LastNumber",null,[]);var JG=d(381);class Vp{constructor(b,h,r,A){this.ske=!1;this.$t=b;this.cYi=r;this.Jmc=A;this.qv=this.$t.jE(h);this.bS=new vd.a;this.bS.hd(h)}static get Md(){return Vp.jg||(Vp.jg=Za.a.instance.resolve(10))}static set Md(b){Vp.jg=b}static get Cs(){return zi.a.getInstance()}static E6l(b,h,r,A=!1,M=!1){var aa=h.currentNode;let oa=null,Ja=!1,fb=!1;h=h.s2b();const Cb=uf.a.gq(h);Cb.moveNext();for(h=Cb.iterator;h.currentNode!==aa;){let Sb=fb=Ja=!1;var Gb=Vp.tVl(h);
if(Db.OutlineElementReader.Nh(h)&&!Gb){Gb=!1;if(h.kv(4))if(Vp.Mgj(h,r,!0,A,M)){if(Sb=!0,oa=new Vp(b,h,!1,!1),Cb.moveNext(),Cb.iterator===aa&&(Ja=!0),A)break}else Db.OutlineElementReader.isEmpty(h,!1)||(Gb=!0),fb=!0;else!Db.OutlineElementReader.isEmpty(h,!1)&&h.P9a(12)&&(Db.OutlineElementReader.PT(h)||(Gb=!0));!A&&Gb&&oa&&(r.ff.hasProperty(Mc.a.listLevel)?oa.qv.level=0:oa=null)}Sb||Cb.moveNext();h=Cb.iterator}oa&&(oa.Jmc=Ja);if(!oa&&h.Mf(1))for(aa=!0;h.currentNode;){if(Db.OutlineElementReader.Nh(h)){if(h.kv(4)&&
Vp.Mgj(h,r,!1,A,M)){oa=new Vp(b,h,!0,aa);break}if(!Db.OutlineElementReader.isEmpty(h,!1))break}if(!h.Mf(1))break;aa=!1}oa&&(oa.ske=fb);return oa}static tVl(b){var h=b.Ub(2);if(!h)return!1;h=Gd.ParagraphReader.Bh(b)&&Vp.rln(h);b.rc();return h}static rln(b){return cn.a(b,8)}static Mgj(b,h,r,A=!1,M=!1){if(!of.ListItemReader.Cg(b)&&(v.ULS.sendTraceTag(508913603,393,15,"Trying to call oeMatchesInfo for non list item"),of.ListItemReader.Ce))return!1;if(of.ListItemReader.Ce)var aa=of.ListItemReader.g7(b);
else Vp.Md.o0(b),aa=b.currentNode,b.rc();const oa=Vp.Md.N2(aa);(b=h.Uz===oa.Uz)&&h.listStyle&&1!==h.Ys&&(b=h.listStyle===oa.listStyle);b&&(h.zta&&1!==h.Ys||h.xic||M)&&(b=Vp.ejn(h,oa),h.Uz||(b=b&&h.font===oa.font));if(1===h.Ys)if(1===oa.Ys&&oa.ff.hasProperty(fd.a.jub))b=h.b9===oa.b9;else return!1;b&&h.Uz&&h.tD!==vj.a.Jk&&(b=oa.Bx,r&&(A&&1===h.tD&&1===b||b++),b=h.tD===b);b&&(A||h.xic)&&(h=of.ListItemReader.bKf(h,{Gra:0}).listId,aa=of.ListItemReader.Lr(aa,{Gra:0}).listId,0<h&&0<aa&&(b=h===aa));return b}static ejn(b,
h){h=h.k5i;b.zta&&(h=h.replace(RegExp("%\\d"),"%1"));return h.toLocaleLowerCase()===b.k5i.toLocaleLowerCase()}static F6l(b,h,r){var A=h.currentNode;let M=null;const aa=new vd.a,oa=b.VAa(A,r);var Ja=!1;let fb=!1;aa.hd(h);aa.rc();for(aa.Ub(1);aa.currentNode!==A;)fb=Ja=!1,Db.OutlineElementReader.Nh(aa)&&aa.kv(4)&&(h=b.jE(aa),Vp.Ngj(h,r,!0)?(M=new Vp(b,aa,!1,!1),Ja=!0):(fb=!0,h.listID===r.listID&&h.level<=oa.hdb&&(M=null))),aa.Mf(1);M&&(M.Jmc=Ja);if(!M&&aa.Mf(1))for(A=!0;aa.currentNode;){if(Db.OutlineElementReader.Nh(aa)&&
aa.kv(4)){Ja=b.jE(aa);if(Ja.listID===r.listID&&Ja.level<=oa.hdb)break;if(Vp.Ngj(Ja,r,!1)){M=new Vp(b,aa,!0,A);break}}if(!aa.Mf(1))break;A=!1}M&&(M.ske=fb);return M}static Ngj(b,h,r){let A=b.listID===h.listID&&b.level===h.level;A&&h.Bx!==vj.a.Jk&&(b=b.Bx,r&&b++,A=h.Bx===b);return A}}Vp.jg=null;Object(u.a)(Vp,"JoinTargetInfo",null,[]);class gr{constructor(b,h){this.qv=null;this.action=b;h&&(this.qv=h)}static Bbb(){return new gr(0)}static o3f(){return new gr(1)}static kwn(b){return new gr(3,b)}static Bwn(b){return new gr(2,
b)}static nwn(b){return new gr(4,b)}}Object(u.a)(gr,"ApplyListInfoResult",null,[]);class KG{constructor(){this.startAt=this.hdb=0}}Object(u.a)(KG,"WordListRestartInfo",null,[]);var LG=d(885);class RC{constructor(b,h,r){this.Cpd=r;this.tfd=h.listID}}Object(u.a)(RC,"ListTransferInfo",null,[]);class Cu extends ao{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc){super(b,r,fb);this.zI=pc;this.iEh=!1;this.dFc=this.Ryd=this.E5b=null;this.gze=(zc,Yc)=>Yc.listID===zc.listID&&Yc.level===zc.level;this.j6o=(zc,
Yc,Kd)=>Yc.listID!==zc.listID&&Yc.listID!==Kd.tfd||Yc.level!==zc.level?!1:!0;this.EGn=(zc,Yc,Kd)=>Yc.listID===zc.listID||Kd&&Yc.listID===Kd.tfd?!0:!1;this.LTj=(zc,Yc,Kd,ke)=>{zi.a.Vs||this.KTj(zc,Yc,Kd,ke)};this.KTj=(zc,Yc,Kd,ke)=>{if(!zi.a.Vs){if(of.ListItemReader.Ce){const {listId:ge}=of.ListItemReader.Lr(Yc);ge!==Kd&&v.ULS.sendTraceTag(508347426,393,15,`siblingRenumberAndUpdateSublists: existingListId:${ge} newListId:${Kd}`)}zi.a.getInstance().Kt||this.zI.eAb(zc,Kd);Yc=of.ListItemReader.Ce?Yc:
zc;zc=this.Kjc(Yc);Yc=vd.a.Za(Yc);Yc.Kd();Yc.rc();this.R$l(Yc,zc,this.EGn,this.Gbp,ke)}};this.l6o=(zc,Yc,Kd,ke)=>{if(!zi.a.Vs){var {qv:ge,iterator:de}=this.xgc(Yc,()=>{if(of.ListItemReader.Ce){var {listId:Sd}=of.ListItemReader.Lr(Yc);Sd!==Kd&&v.ULS.sendTraceTag(508347424,393,15,`siblingRenumberAndUpdateListID: existingListId:${Sd} newListId:${Kd}`)}zi.a.getInstance().Kt||this.zI.eAb(zc,Kd);zi.a.getInstance().Fu&&this.zI.eAb(Yc,Kd);var be=of.ListItemReader.Ce?Yc:zc;Sd=this.Kjc(be);be=vd.a.Za(be);be.Kd();
be.rc();return{qv:Sd,iterator:be}});this.o3d(de,ge,this.nXj,this.pAe,ke)}};this.Ebp=(zc,Yc,Kd,ke)=>{zi.a.Vs||this.Owj(zc,Yc,Kd,ke)};this.pAe=(zc,Yc,Kd,ke)=>{Kd.listID=Yc.listID;ke.Ub(4);const ge=this.Ps.KVa(ke.currentNode);this.xgc(ge,()=>{this.BSc(ke.currentNode,Kd,ge);ke.rc()})};this.Gbp=(zc,Yc,Kd,ke)=>{!zi.a.Vs&&of.ListItemReader.Cg(ke)&&(zc=new vd.a,zc.hd(ke),zc.Kd(),this.Md.o0(zc),this.e$m(ke.currentNode,zc.currentNode))};this.Fbp=(zc,Yc,Kd,ke)=>{Kd.listID=Yc.listID;this.Owj(zc,Yc,Kd,ke);this.pAe(zc,
Yc,Kd,ke)};this.mXj=(zc,Yc)=>Yc.listID===zc.listID;this.Dbp=(zc,Yc)=>Yc.level<=zc.level;this.nXj=(zc,Yc,Kd)=>Yc.listID===Kd.tfd;this.Pp=M;this.Zwa=b;this.QCd=h;this.Qc=A;this.Tig={};this.ABk=aa;this.Yd=oa;this.Oq=Ja;this.Bd=Cb;this.Vx=Gb;this.$v=Sb}get sba(){return this.Zwa.Ola}get Gyb(){return this.iEh}set Gyb(b){this.iEh=b}get Ps(){return this.Zwa}get tha(){return this.$v}get Wb(){return this.Vx}get Xs(){return this.Ps.Xs}get Sq(){return this.Ps.Sq}get Eya(){return this.Ps.Eya}get pba(){return this.Ps.pba}set pba(b){this.Ps.pba=
b}get JXa(){return this.Ps.JXa}set JXa(b){this.Ps.JXa=b}get bpd(){return null!=this.L2g?this.L2g:this.L2g=Za.a.instance.Oa(880)}W0k(b,h,r,A){v.ULS.sendTraceTag(17622210,324,50,"AdjustAndSetLevel is called in WordEditor.");const M=r.ka(pd.a.oce,!1);let aa=!1,oa=-1;!M||h.listStyle&&1!==h.Ys||(aa=!r.ka(pd.a.g1f,!1),oa=r.ka(pd.a.V2f,-1));b=this.Pcc(b,h,{CPi:aa,Nvn:oa,Hpb:A,ff:r});M||r.setValue(pd.a.g1f,2===b.action);3===b.action&&!r.hasProperty(pd.a.V2f)&&b.qv&&r.setValue(pd.a.V2f,b.qv.level)}merge(b,
h,r,A=null){const M=of.ListItemReader.Cg(b)||of.ListItemReader.Cg(h);b=super.merge(b,h,r,A);M&&this.N0();return b}ruj(b,h){this.ckl(b,h)}ckl(b,h){b=of.ListItemReader.Ce?of.ListItemReader.Yka(b,{wUa:-1}).listLevel:this.Md.fKf(b);const r=of.ListItemReader.Ce?of.ListItemReader.Yka(h,{wUa:-1}).listLevel:this.Md.fKf(h);-1!==b&&-1!==r&&(b-=r,0<b?this.QCd.value.eYc(h,b):0>b&&this.QCd.value.gZa(h,b,0))}ZAj(b){this.Md.o0(b);b.Rg();this.N0()}PIg(b,h,r,A){var M=vd.a.Za(r);M=this.jE(M);const aa=this.o_b(b,M,
!zi.a.getInstance().Fu);if(!zi.a.Vs){b=this.Ps.h9a(b.currentNode,M);b.listType||(aa.setValue(ao.Cs.moa,M.Bx),aa.setValue(ao.Cs.WEa,M.WYc),this.cDj(aa,M,h?r:A));switch(b.listType){case 0:h="Numbering";break;case 1:h="Bullet";break;default:h="Invalid List Type"}y.AFrameworkApplication.va.Ob(ub.a.f1f,2);v.ULS.sendTraceTag(38544079,393,50,"List Actions : Join List - {0}",h);zi.a.getInstance().Kt||this.zI.n_b(aa,M.listID,M.level)}}jE(b){if(!of.ListItemReader.Cg(b)&&(v.ULS.sendTraceTag(508924048,393,15,
"Trying to fetch list Ref info for non list item"),of.ListItemReader.Ce))return null;let h;of.ListItemReader.Ce?h=of.ListItemReader.g7(b):(this.Md.o0(b),h=b.currentNode,b.rc());return this.Kjc(h)}hTo(b,h){this.Md.o0(b);const r=b.currentNode;b.rc();zi.a.getInstance().Kt||this.zI.eAb(r,h);b=Db.OutlineElementReader.nN(b);zi.a.getInstance().Fu&&this.zI.eAb(b,h);this.Kjc(of.ListItemReader.Ce?b:r)}Kjc(b){var h;const r=new ey.a;of.ListItemReader.Ce&&(b&&Gd.ParagraphReader.Vb(b)||v.ULS.sendTraceTag(509141474,
393,15,`Paragraph node not sent in getListRefInfoNode. Node sent: ${null===(h=null===b||void 0===b?void 0:b.constructor)||void 0===h?void 0:h.name}`));h=of.ListItemReader.Ce?of.ListItemReader.Lr(b)||of.ListItemReader.dla(b):this.Md.v_(b,!1,!0);r.listID=h.listId;r.level=h.listLevel;r.h0=of.ListItemReader.X9d(b);h=this.B6d(b);r.TQo(h);r.Bx=of.ListItemReader.$8d(b);r.WYc=of.ListItemReader.NOf(b);return r}o_b(b,h,r=!1){const A=Db.OutlineElementReader.nN(b);b=zi.a.getInstance().Kt?null:this.l9h(b);this.BSc(b,
h,A,r);return b}BSc(b,h,r=null,A=!1){zi.a.getInstance().Kt||b||Rg.a.instance.$b("CrashWhenApplyingList",{["Reason"]:"ListNodeIsNull"});!zi.a.getInstance().Fu||A||r||Tc.b(509364259,393,15,"Apply list ref info called without para node");h||Rg.a.instance.$b("CrashWhenApplyingList",{["Reason"]:"RefInfoIsNull"});zi.a.getInstance();zi.a.getInstance().Fu&&r&&(zi.a.fu?!h.h0:!A)&&this.zI.n_b(r,h.listID,h.level);zi.a.getInstance().Ula&&(r=r||this.Md.KVa(b),this.zI.exo(r));zi.a.getInstance().Kt||(this.zI.n_b(b,
h.listID,h.level),h.h0&&b.setValue(Mc.a.h0,!0),zi.a.getInstance().Fu||null==h.levelText||b.setValue(Mc.a.Tw,h.levelText))}p6j(b){this.Ps.M6(b);b=Object(vo.a)().Iu(b);let h=b.ka(Mc.a.Sq,null);h=h?Array.clone(h):[];b.setValue(Mc.a.Sq,h);this.Ps.Bmc()}pbp(b){switch(b){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}Qvm(b){b=b.view;if(!b.mb||!b.mb.gb)return null;b=Kv.OutlineElementGeneralizer.Mka(b.mb.gb,!1);if(1!==b.length)return null;
b=vd.a.Za(b.getContext(0).node);if(!of.ListItemReader.Cg(b))if(14===b.Zd().type){const h=of.ListItemReader.Nwi(b.currentNode);h&&b.set(h)}else Tc.b(589177753,393,15,"Encountered an OE of non list type."),b.rc();b.Kd();return b}AFl(b,h,r,A){const M=b.sL(),aa=new ey.a;aa.listID=this.D9h(b);this.sba?(aa.Oge=ao.Cs.e0?this.E9h(b):this.v9h(b),this.Jxj(b,aa.listID,aa.Oge)):this.Lxj(b,aa.listID);aa.RMj(h.ff,this.Gad(r));this.r0d(b);r=this.Lzi(b,h);for(let Ja=0;9>Ja;Ja++){const fb=new Hn.a;M.td.ku(fb);this.Kxj(b,
this.sba?N.a.nil:fb.id,this.sba?fb.id:N.a.nil);this.TTk(fb,h.Uz,Ja);this.HMh(fb,r,Ja);var oa=A.rUb[Ja];oa=6===oa?fq.a.c_(1,1):fq.a.c_(0,oa);oa.dma&&fb.setValue(He.a.O7,oa.dma);h.tD!==vj.a.Jk&&Ja===aa.level&&fb.setValue(He.a.GU,h.tD);A.SJa&&A.SJa[Ja]&&fb.setValue(He.a.font,A.SJa[Ja]);oa=A.Iad[Ja];v.ULS.shipAssertTag(22127636,338,!!oa);fb.setValue(Mc.a.Tw,oa);fb.setValue(Mc.a.aga,A.Wfe[Ja]);uw.a.Fxe(A.b9,fb)}return aa}yFl(b,h,r){const A=b.sL(),M=new ey.a;M.listID=this.D9h(b);this.sba?(M.Oge=ao.Cs.e0?
this.E9h(b):this.v9h(b),this.Jxj(b,M.listID,M.Oge)):this.Lxj(b,M.listID);M.RMj(h.ff,this.Gad(r));if(!h.listStyle)switch(M.level%3){case 0:h.nca(h.listType,1);break;case 1:h.nca(h.listType,2);break;case 2:h.nca(h.listType,3)}this.r0d(b);r=this.Lzi(b,h);for(let aa=0;9>aa;aa++){const oa=new Hn.a;A.td.ku(oa);this.Kxj(b,this.sba?N.a.nil:oa.id,this.sba?oa.id:N.a.nil);this.STk(oa,h.Uz,aa);this.HMh(oa,r,aa);2===aa%3&&h.Uz?oa.setValue(Mc.a.aga,"right"):oa.setValue(Mc.a.aga,"left");aa===M.level&&(h.dma&&oa.setValue(He.a.O7,
h.dma),h.tD!==vj.a.Jk&&oa.setValue(He.a.GU,h.tD),h.Uz?this.VMj(h,oa,aa):(Cu.SMj(h,oa),Cu.UMj(h,oa)),Cu.TMj(h,oa),h.xic&&oa.Fza(h.ff,Mc.a.listID,Mc.a.listLevel))}return M}VMj(b,h,r){b.zta?(b=b.levelText,b=I.a.replaceAll(b,"%1","%"+(r+1))):b=b.H7c||b.oBa?b.levelText:"%"+(r+1)+".";v.ULS.shipAssertTag(22127638,338,!!b);h.setValue(Mc.a.Tw,b)}CBg(b,h,r,A){if(b.H7c)return!1;if(1===b.Ys)return A;if(A)return!0;if(h){A=b.listType===h.listType;const M=!b.listStyle&&b.tD===vj.a.Jk;let aa=b.listStyle===h.listStyle&&
b.tD===h.tD;b=(!b.zta||this.uvg(h,b))&&!r;aa=aa&&b;return A&&(M||aa)}return!1}r0d(b){this.E5b||(this.E5b=b.ka(Mc.a.ZLl,null));this.Ryd||(this.Ryd=b.ka(Mc.a.YLl,null));this.dFc||(this.dFc=b.ka(Mc.a.$Ll,null))}Gad(b){720>b&&(b=0);return Math.max(0,Math.min(Math.floor(b/720),8))}vyi(b){return b?this.Pp.$W(b).Ou-this.Pp.jI(b).Ou:-1}Lxj(b,h){const r=b.ka(Mc.a.Xs,null),A=r?r.length:0,M=Array(A+1);let aa=0;for(;aa<A;aa++)M[aa]=r[aa];M[aa]=h;b.setValue(Mc.a.Xs,M);this.Ps.Bmc()}Jxj(b,h,r){this.Odf(Mc.a.Xs,
b,h);if(ao.Cs.e0){this.Odf(De.a.tYa,b,r);var A=this.Ps.z6d(b);A.add(h,r);b.setValue(De.a.FF,JG.d(IG.a.mzc(A)))}else this.Odf(Mc.a.Eya,b,r),A=this.Ps.y6d(b),A.add(h,r),b.setValue(Mc.a.p3,JG.d(IG.a.mzc(A)))}Kxj(b,h,r){this.sba?(this.vMh(Mc.a.Sq,b,r),this.vMh(Mc.a.a8,b,h)):(r=(r=b.ka(Mc.a.Sq,null))?Array.clone(r):[],r.push(h),b.setValue(Mc.a.Sq,r),this.Ps.Bmc())}Odf(b,h,r){const A=h.ka(b,null),M=A?A.length:0,aa=Array(M+1);let oa=0;for(;oa<M;oa++)aa[oa]=A[oa];aa[oa]=r;h.setValue(b,aa)}vMh(b,h,r){let A=
h.ka(b,null);A=A?Array.clone(A):[];A.push(r);h.setValue(b,A)}STk(b,h,r){var A=r%3+1;const M=h?this.dFc:this.Ryd;M&&r<M.length?b.setValue(Mc.a.Mt,M[r]):b.setValue(Mc.a.Mt,360);A=fq.a.c_(h?0:1,this.pbp(A),null,0,r);b.Yt(A.ff);b.setValue(Mc.a.ljf,h?-1:-2);h?b.setValue(Mc.a.Tw,"%"+(r+1)+"."):(b.setValue(He.a.font,this.Qmm(r)),b.setValue(Mc.a.Tw,String.fromCharCode(this.Hmm(r))));uw.a.uwc(2,b)}TTk(b,h,r){const A=h?this.dFc:this.Ryd;A&&r<A.length?b.setValue(Mc.a.Mt,A[r]):b.setValue(Mc.a.Mt,360);b.setValue(Mc.a.ljf,
h?-1:-2);uw.a.uwc(1,b)}Hmm(b){switch(b%3){case 0:return 61623;case 1:return 111;case 2:return 61607;default:return 61623}}Qmm(b){switch(b%3){case 0:return"Symbol";case 1:return"Courier New";case 2:return"Wingdings";default:return"Symbol"}}D9h(b){if(this.sba)this.pba<vj.a.Uad&&this.Ps.M6(b),this.pba=this.TAi(this.Xs,this.pba,vj.a.Uad);else{if(this.pba<vj.a.Uad&&(this.Ps.M6(b),this.Xs&&this.Sq)){b=this.Xs.length;for(let h=0;h<b;h++)this.Xs[h]>=this.pba&&(this.pba=this.Xs[h])}this.pba+=1}return this.pba}v9h(b){this.JXa<
vj.a.BPd&&this.Ps.M6(b);return this.JXa=this.TAi(this.Eya,this.JXa,vj.a.BPd)}E9h(b){var h;this.Ps.M6(b);do b=Math.floor(Math.random()*(Cu.kHn-Cu.Hcj))+Cu.Hcj;while(null===(h=this.Ps.KVb)||void 0===h?0:h.includes(b));return b}TAi(b,h,r){if(h<r&&b){r=b.length;for(let A=0;A<r;A++)b[A]>h&&(h=b[A])}h++;return h}aAo(b,h){zi.a.Vs||this.epi(b,h,this.gze,this.LTj,null,!1)}$zo(b,h){zi.a.Vs||this.S$l(b,h,this.gze,this.KTj)}D9k(){zi.a.Vs||this.N0()}N0(b=null){var h,r;if(!zi.a.Vs){var A=new vd.a;if(b)if(8===b.type)A.set(b);
else{v.ULS.sendTraceTag(592535635,393,15,"Unable to update lists number as cannot navigate to page content node.");return}else A.set(qa.StaticActiveAppFrame.za().kb.$c),Object(vo.a)().wJg(A),b=Object(vo.a)().Iu(A.currentNode);if(A.vb(7)||A.ld(7)){A=uf.a.At(A,A.origin);var M=new QC({Md:this.Ps,Uh:b,cB:null,E8j:!1});for(b=new QC({Md:this.Ps,Uh:b,cB:null,E8j:!1});A.moveNext();){var aa=A.iterator;let Ja;if(!zi.a.getInstance().Kt){if(!aa.kv(4)&&!aa.kv(31))continue;this.Md.tVb(aa);Ja=aa.currentNode;aa.rc();
if(!Ja){v.ULS.sendTraceTag(575813713,393,15,"List Node comes out to be null while updating numbering. Iterator Valid {0}",aa.isValid);continue}}const fb=of.ListItemReader.Ce?of.ListItemReader.Q6d(aa):Ja;if(!this.sba&&!of.ListItemReader.RYf(fb)&&this.Md.N2(fb).listType)continue;var oa=void 0;if(of.ListItemReader.Ce){if(!fb){v.ULS.sendTraceTag(509141473,393,50,"Skipping updating list numbers because paraNode not found");continue}oa=of.ListItemReader.Lr(fb)}else oa=this.Md.v_(Ja,!1,!1);if(this.sba&&
oa&&this.Md.Dde(oa.listId)){v.ULS.sendTraceTag(592535636,393,50,"Skipping updating list numbers for this list id {0}",oa.listId);continue}const Cb=of.ListItemReader.Ce?fb:Db.OutlineElementReader.nN(aa);Cb&&(Cb.ra?(null==Cb.ra.last&&v.ULS.sendTraceTag(540374985,393,15,"Unexpected : Encountered last of para character properties null."),this.sba&&this.Ps.M6(aa.currentNode),12===Cb.type&&(Cb.jj&&Cb.Fx.hasProperty(Mc.a.listID)||null===(h=Cb.ra.last)||void 0===h||!h.Ui)&&((aa=of.ListItemReader.Ce?Cb.jj?
of.ListItemReader.dla(fb):of.ListItemReader.Lr(fb):this.Md.v_(Ja,!0,!0))?this.XMj(Ja,fb,b,ao.Cs.Qud,aa):v.ULS.shipAssertTag(24475424,376,!0,"The previous number list ID is not found! List Node Type={0}",Ja.type)),!oa||null!==(r=Cb.ra.last)&&void 0!==r&&r.Vh||!this.XMj(Ja,fb,M,ao.Cs.moa,oa)||(oa=Ja.getValue(ao.Cs.moa),this.sba&&this.Md.N2(fb).listType||Ja.setValue(ao.Cs.WEa,oa))):v.ULS.shipAssertTag(24975004,376,!0,"The paragraph node has null CharacterProperties! Skipping."))}}else v.ULS.shipAssertTag(593234060,
376,7===A.mf,"Couldnt reach to page manifest node")}}XMj(b,h,r,A,M){if(!zi.a.Vs)return A||v.ULS.shipAssertTag(571757918,393,!!A,"Prop definition is null"),r=r.frc(M.listId,M.listLevel,this.Bd),M=-1,b.hasProperty(A)&&(M=b.getValue(A)),r===M||this.sba&&!of.ListItemReader.RYf(h)&&this.Md.N2(h).listType&&(A!==ao.Cs.Qud||1!==this.Md.N2(h).listType)?!1:(b.setValue(A,r),!0)}Ohn(b,h){if(!zi.a.Vs){var r=!1,A=!0,M=0,aa=this.jE(b),oa=b.currentNode;b=b.s2b();b=uf.a.gq(b);for(b.pp(LG.a.Xge,null);b.moveNext();){var Ja=
b.iterator.currentNode;if(Ja===oa)break;of.ListItemReader.Cg(Ja)&&(Ja=this.jE(b.iterator),Ja.listID===aa.listID&&(Ja.level>aa.level?(r=!0,M++):Ja.level===aa.level?(A=!1,M=0):Ja.level<=h.hdb&&(A=!0,M=0)))}return r&&A&&!0}}mll(b){if(!zi.a.Vs){this.Md.o0(b);var h=b.currentNode;b.rc();var r=this.jE(b);r&&this.Ps.Rge(h,r.listID,r.level)&&this.$zo(b.currentNode,r)}}Ozi(b){var h;const r=this.Md.Pw(b);r.xic=!0;of.ListItemReader.Ce?(b=of.ListItemReader.Yka(b),r.ff.setValue(Mc.a.listID,null!==(h=null===b||
void 0===b?void 0:b.listId)&&void 0!==h?h:0)):(this.Md.o0(b),h=b.currentNode.ka(Mc.a.listID,0),r.ff.setValue(Mc.a.listID,h),b.ld(11));return r}S1f(b,h,r){if(!zi.a.Vs){var A=new vd.a,M=h.currentNode,aa=vj.a.Jk,oa=!1,Ja=!1,fb=!1,Cb=null,Gb=h.s2b();Gb=uf.a.gq(Gb);for(Gb.pp(LG.a.Xge,null);Gb.moveNext();){A.hd(Gb.iterator);if(A.currentNode===M)break;oa=!1;if(of.ListItemReader.Cg(A)){var Sb=this.jE(A);Sb.listID===b.listID&&(Sb.level===b.level?(this.Md.o0(A),aa=A.currentNode,A.rc(),aa=aa.ka(ao.Cs.moa,vj.a.Jk),
oa=!0,Cb=A.tAc(1),Ja=!0):Sb.level>b.level?fb=!0:Sb.level<=r.hdb&&(aa=vj.a.Jk,fb=Ja=!1))}}!Ja&&fb&&(aa=r.startAt);oa&&(oa=h.tAc(1)===Cb);b=new rB;b.Zub=aa;b.r$j=oa;return b}}Fup(b,h){var r=of.ListItemReader.g7(b);b=this.Kjc(r);const A=new vd.a;A.set(r);if(A.Kd()&&(r=A.UZa())){r=uf.a.gq(r);for(r.pp(LG.a.Xge,b);r.moveNext();)of.ListItemReader.Cg(r.iterator.currentNode)&&this.jE(r.iterator).listID===h&&this.hTo(r.iterator,b.listID);v.ULS.sendTraceTag(509200585,393,50,"Single level List is inflated successfully.")}}e$m(b,
h){zi.a.Vs||(v.ULS.shipAssertTag(22819227,338,!!b&&!!h),h.setValue(bg.a.i3f,N.a.create().toString()))}VAa(b,h){const r=Rg.a.instance.nq(ub.a.VAa),A=new KG;(b=this.Ps.Ty(b,h.listID,h.level))?(A.hdb=b.ka(Mc.a.mZb,h.level-1),A.startAt=b.ka(He.a.GU,1)):Rg.a.instance.$b("PossiblyIncorrectListRestartValue",{["Reason"]:"listPropsIsNull"});r.end();return A}GHl(b){const h=hw.a.instance.createInstance(wm.a.Ynd);b.Vf(h,31)}Iwo(b){b.Ub(31)&&b.Rg()}TAj(b){var h=this.Wb.Aq(b);h?this.Wb.ze(h)===Zl.StyleReader.wordStyleIdListParagraph&&
(h=this.Wb.AF(b),this.tha.WP(h.lh(Zl.StyleReader.wordStyleIdNormal),b,!0,!1,!1,this.Gyb)):v.ULS.shipAssertTag(8271188,315,!1)}ZMj(b){if(this.Wb.ze(this.Wb.Aq(b))===Zl.StyleReader.wordStyleIdNormal){const h=this.Wb.AF(b);this.tha.WP(h.lh(Zl.StyleReader.wordStyleIdListParagraph),b,!0,!0,void 0,void 0,void 0,!0)}b.Uf(Mc.a.he,Mc.a.WU,Mc.a.qD,Mc.a.d8,Mc.a.Mt,Mc.a.sua);b.setValue(Mc.a.QYa,0)}oll(b,h){var r=of.ListItemReader.Lr(b);if(!r)return null;const A=r.listId;r=r.listLevel;for(let aa=0;9>aa;aa++){const oa=
this.Ps.Ty(b,A,aa);if(!oa)return Rg.a.instance.$b("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),null;var M=h.rUb[aa];M=6===M?fq.a.c_(1,1):fq.a.c_(0,M);M.dma&&oa.setValue(He.a.O7,M.dma);oa.hasProperty(He.a.font)&&oa.removeProperty(He.a.font);h.SJa&&h.SJa[aa]&&oa.setValue(He.a.font,h.SJa[aa]);M=h.Iad[aa];v.ULS.shipAssertTag(22127641,338,!!M);oa.setValue(Mc.a.Tw,M);oa.setValue(Mc.a.Ys,uw.a.Zqc);uw.a.Fxe(h.b9,oa);oa.setValue(Mc.a.aga,h.Wfe[aa]);oa.Uf(Mc.a.mZb,He.a.GU);this.p6j(b)}b=new ey.a;
b.listID=A;b.level=r;return b}lll(b,h,r,A){if(A)return this.oll(b,A);var M=of.ListItemReader.Lr(b);if(!M)return null;A=M.listId;M=M.listLevel;const aa=this.Ps.Ty(b,A,M);if(!aa)return Rg.a.instance.$b("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),h&&v.ULS.sendTraceTag(588022420,393,15,"List def is null for List Style {0}, List type {1}, ListId {2} and level {3}",h.listStyle,h.listType,A,M),null;h.xic&&(aa instanceof yC.APropertySet?aa.Fza(h.ff,Mc.a.listID,Mc.a.listLevel):v.ULS.sendTraceTag(527991759,
393,15,"ListDefintion was not an instance of APropertySet, it is an instance of {0}",null===aa||void 0===aa?void 0:aa.constructor.name));var oa=aa.ka(Mc.a.Ys,null);oa&&oa===uw.a.Zqc&&this.kll(b,A);if(!h.listStyle){oa=0;if(-1!==r){for(oa+=M-r;0>oa;)oa+=3;oa%=3}switch(oa){default:r=1;break;case 1:r=2;break;case 2:r=3}h.nca(h.listType,r)}h.dma&&aa.setValue(He.a.O7,h.dma);h.Uz?(this.VMj(h,aa,M),aa.hasProperty(He.a.font)&&aa.removeProperty(He.a.font)):(Cu.SMj(h,aa),Cu.UMj(h,aa));Cu.TMj(h,aa);aa.Uf(Mc.a.mZb,
He.a.GU,Mc.a.E9c);this.p6j(b);b=new ey.a;b.listID=A;b.level=M;return b}kll(b,h){let r;for(let A=0;9>A;A++){r=this.Ps.Ty(b,h,A);if(!r){v.ULS.sendTraceTag(588022421,393,15,"List def is null for List id {0}, List level {1}",h,A);break}r.setValue(Mc.a.Ys,uw.a.J$d);r.removeProperty(fd.a.jub)}}Qwe(b,h){const r=Rg.a.instance.nq(ub.a.Qwe);this.QCd.value||Rg.a.instance.$b("PossibleIncorrectListIndentation",{["Reason"]:"IOutlineElementIndentationEditorIsNull"});this.cSa?(r.properties.Z("PendingListInfo","true"),
of.ListItemReader.Cg(b)&&(r.properties.Z("RemoveCurrentListInfo","true"),this.Gyb=!0,this.bca(b),this.QCd.value.gZa(b,-1,0),this.Gyb=!1),16!==this.cSa.listType&&this.Pcc(b,this.cSa,{CPi:!0,Gbm:!0}),this.cSa=null):h||(r.properties.Z("CurrentlyUnderPastedList","true"),this.bca(b,{LAj:!0}));r.end()}Rxe(b,h){var r;if(of.ListItemReader.Cg(b))return!1;b.Ub(2);var A=fo.a.g$k;const M=[!0,!1].map(aa=>Gd.ParagraphReader.xg(b.currentNode,aa,void 0,!1));b.rc();for(let aa=0;aa<M.length;aa++){const oa=M[aa];if(oa&&
!GE.a.Pla(oa))for(const Ja of A)if(Ja.test(oa.characterData))return A=null===(r=Ja.exec(oa.characterData))||void 0===r?void 0:r[0],this.xno(h,aa?"nextPara":"prevPara",A),!1}return!0}xno(b,h,r){const A=new Map;A.set("CurrentAutoListPreventedAutoListText",b);A.set("UndoAutoListPreferenceFoundIn",h);A.set("UndoAutoListPreferenceAutoListText",r);Ba.Health.instance.recordKpiUsage(vj.a.Gab.euo,0,vj.a.NB,A)}b2o(b,h){return b&&h}UAj(b){for(let h=0;h<b.count;h++){const r=vd.a.Za(b.K(h));r.pq();this.Nga(r)}b.clear()}Zzo(b){zi.a.Vs||
of.ListItemReader.Cg(b)&&this.N0()}jxj(b,h){b=new vd.a;b.set(h);b.Kd();Bb.OutlineElementNavigator.je(b);b.prb(h)||Rg.a.instance.$b("PossibleLossOfDirectFormatting",{["Reason"]:"OeDoesNotContainParagraph"});this.bca(b);return b}nSo(b,h,r){this.Oh.TDa(b,h,r,!0)}wSo(b){b.nca(1,1)}SRd(b,h){const r=Rg.a.instance.nq(ub.a.Y5k);if(this.Wb.f0(h.Wi())){if(of.ListItemReader.Cg(b)&&this.bca(b),h=this.Ps.Xzi(h)){if(zi.a.Vs)var A=this.o_b(b,h,!0);else if(this.Ps.h9a(b.currentNode,h),A=Vp.F6l(this,b,h))A=this.WMj(b,
A,!0);else{A=this.l9h(b);var M=this.o3d(b,h,this.mXj,this.Ebp);if(M){const aa=this.jE(M);if(aa.listID===h.listID&&aa.level<h.level&&this.Md.Pw(M).Uz){const oa=this.VAa(M.currentNode,aa);aa.Bx===(oa.startAt===vj.a.Jk?1:oa.startAt)&&(aa.WYc=aa.Bx,this.cDj(A,aa,M.currentNode))}}M=this.VAa(A,h);b=this.S1f(h,b,M);b=b.Zub!==vj.a.Jk?b.Zub+1:M.startAt===vj.a.Jk?1:M.startAt;zi.a.getInstance().Kt||this.BSc(A,h,null,!0);A.setValue(ao.Cs.moa,b);A.setValue(ao.Cs.WEa,b)}zi.a.getInstance().Kt||A.setValue(Mc.a.h0,
!0);r.end()}}else Rg.a.instance.$b("PossiblyIncorrectListStyle",{["Reason"]:"StyleContainerNotValid"})}cDj(b,h,r){zi.a.Vs||this.Ps.Rge(b,h.listID,h.level)&&this.aAo(r,h)}j6k(b,h,r){if(!of.ListItemReader.Cg(h)&&(v.ULS.sendTraceTag(508952674,393,15,"Iterator sent is not pointing to a List OE: applyNewListDefinition"),of.ListItemReader.Ce))return;let A=null;zi.a.getInstance().Kt||(A=h.Ub(4),h.rc());(h=Db.OutlineElementReader.nN(h))||Tc.b(509386772,393,15,"Encountered a list node but paragraph node is not present");
b=this.Qsf(b,r,0,null);this.BSc(A,b,h);return b}Qsf(b,h,r,A=null){b=A?this.AFl(b,h,r,A):this.yFl(b,h,r);ao.Cs.Fu||(h.oBa?(h=h.levelText,A||(h=h.replace("%1","%"+(b.level+1))),b.levelText=h):(v.ULS.sendTraceTag(22127642,338,15,"desiredInfo does not have a levelText. Replacing with an emtpy string."),b.levelText=""));return b}jLg(b,h,r,A=null){if(of.ListItemReader.Cg(b)){var M=b.Ub(4);b.rc();var aa=Db.OutlineElementReader.nN(b);this.xgc(aa,()=>{this.BSc(M,h.qv,aa,r);zi.a.Vs||this.Efi(M,h,r,A)})}else v.ULS.sendTraceTag(587747659,
393,15,"List node received is null : skipping join list action.")}WMj(b,h,r,A=null){const M=Db.OutlineElementReader.nN(b);return this.xgc(M,()=>{const aa=this.o_b(b,h.qv,r);if(!zi.a.Vs)return this.Efi(aa,h,r,A),aa})}Efi(b,h,r,A=null){if(!zi.a.Vs&&this.Ps.h9a(b,h.qv).Uz){const M=new vd.a;M.set(b);M.Kd();M.rc();const aa=this.X8l(M,h,A);b=this.P8l(M,b,h,r,A,aa);this.U8l(h,r,A,aa,b)}}X8l(b,h,r){if(!zi.a.Vs){if(h.cYi)h=h.bS;else{let A,M;r?(A=this.nXj,M=this.pAe):h.Jmc?(A=this.mXj,M=this.pAe):(A=this.Dbp,
M=this.Fbp);h=this.o3d(b,h.qv,A,M,r)}!h&&r&&(r=new vd.a,r.hd(b),r.i9d()&&of.ListItemReader.Cg(r)&&(h=r));return h}}P8l(b,h,r,A,M,aa){if(!zi.a.Vs)return A?(M?b=M.Cpd:(aa=this.VAa(h,r.qv),r=this.S1f(r.qv,b,aa),b=r.Zub!==vj.a.Jk?r.Zub+1:aa.startAt===vj.a.Jk?1:aa.startAt),h.setValue(ao.Cs.moa,b),h.setValue(ao.Cs.WEa,b)):(b=vj.a.Jk,this.nTo(h,aa,r)),b}U8l(b,h,r,A,M){if(!zi.a.Vs&&A){var aa=!1;const fb=this.jE(A);var oa=fb.level===b.qv.level,Ja=!!r&&fb.listID===r.tfd;(fb.listID===b.qv.listID||Ja)&&oa&&(oa=
this.VAa(A.currentNode,fb),Ja=oa.startAt===vj.a.Jk?1:oa.startAt,fb.Bx===Ja+1&&(aa=h?M===Ja:this.Ohn(A,oa)));if(!aa||r)r?(h=this.j6o,M=this.l6o):(h=this.gze,M=this.LTj),aa=new vd.a,aa.set(A.currentNode),aa.Kd(),this.Md.o0(aa),aa.rc(),this.epi(A.currentNode,b.qv,h,M,r)}}nTo(b,h,r){if(!zi.a.Vs){var A=null;h&&(A=this.jE(h));if(A&&A.listID===r.qv.listID&&A.level===r.qv.level){const M=this.Md.Pw(h),aa=M.Bx;b.setValue(ao.Cs.moa,aa);b.setValue(ao.Cs.WEa,aa);M.ff.setValue(Mc.a.listID,A.listID);M.ff.setValue(Mc.a.listLevel,
A.level);if(!r.Jmc||r.ske)r.cYi&&!r.ske&&(this.Md.o0(h),b=h.currentNode,Bb.OutlineElementNavigator.je(h)),b.setValue(ao.Cs.WEa,b.getValue(ao.Cs.moa))}else h=r.qv.Bx+1,b.setValue(ao.Cs.moa,h),b.setValue(ao.Cs.WEa,h)}}fip(b,h,r=!1){let A,M=!1;const aa=[];for(const fb of b){if(!Gd.ParagraphReader.Vb(fb.node))continue;const Cb=fb.node;M||(M=ze.a.pf(fb));if(h&&16!==h.listType){var oa=vd.a.Za(Cb);oa.vb(8);oa.rc();if(1<b.length&&this.JRj(oa,h))continue;if(!Ja){var Ja=this.Md.Pw(oa);oa=this.jZi(h);oa=this.CBg(h,
Ja,!0,oa);Ja=!oa;null!==A&&void 0!==A?A:A=oa}}aa.push(Cb)}M?Ja?this.rUh(aa,h,{Hpb:r,i6j:!0}):this.sUh(aa):Ja?this.rUh(aa,h,{Hpb:r,i6j:A}):this.sUh(aa)}rUh(b,h,{Hpb:r=!1,i6j:A=!1}={}){const M=[];for(const Ja of b){(b=Ja.XC())&&M.push([Ja,b]);b=vd.a.Za(Ja);b.vb(8);b.rc();let fb;var aa=this.vyi(Ja);const Cb=this.infoAtLevel(b,h),Gb=of.ListItemReader.Ce?null:b.Ub(4);if(of.ListItemReader.Ce?of.ListItemReader.isListItem(Ja):Gb)if(of.ListItemReader.Ce||b.rc(),!A||oa)({listLevel:fb}=of.ListItemReader.Yka(b)),
this.bca(b,void 0,!0);else{var oa=this.Fhf(Cb,of.ListItemReader.Ce?Ja:Gb,-1,h.YA).qv;continue}this.ZMj(Ja);oa||(oa=this.lzi(h,b,Cb,!1,r),this.gMj(oa,Cb),null==oa||r||Cb.Uz!==this.Md.h9a(b.currentNode,oa.qv).Uz?(oa=Db.OutlineElementReader.K2(b),0<oa&&(aa+=oa),oa=this.Qsf(Ja.Ic.Ip(),h,aa,h.YA)):oa=oa.qv);aa=oa.level;null!=fb&&(oa.level=fb);this.o_b(b,oa);null!=fb&&(oa.level=aa)}if(!this.Gyb)for(const [Ja,fb]of M)Ja&&fb&&this.Oq.fV(Ja,fb,this.Yd.Lg);this.N0()}sUh(b){for(const h of b)b=vd.a.Za(h),b.vb(8),
b.rc(),this.bca(b,void 0,!0);this.N0()}Pcc(b,h,{CPi:r=!1,Nvn:A=-1,Hpb:M=!1,Gbm:aa=!1}={}){return h&&16!==h.listType?vd.a.Uea(()=>{if(!Db.OutlineElementReader.Nh(b))return v.ULS.sendTraceTag(578331469,393,15,"Iterator not pointing to OE in apply list info word."),gr.Bbb();const oa=Db.OutlineElementReader.nN(b);return of.ListItemReader.Ce&&!oa&&(v.ULS.sendTraceTag(508441813,393,15,"No paraNode was found while trying to applyListInfo"),of.ListItemReader.Ce)?gr.Bbb():oa&&cn.a(oa,8)?(v.ULS.sendTraceTag(578331470,
393,15,"Returning from apply list info word as its a page break."),gr.Bbb()):(null===oa||void 0===oa?0:oa.ra.last.Vh)?(v.ULS.sendTraceTag(578331471,393,15,"User applied list to para with deleted EOP."),gr.Bbb()):this.xgc(oa,()=>{var Ja=Object(vo.a)().Iu(b.currentNode);const fb=h.YA,Cb=this.infoAtLevel(b,h);var Gb=of.ListItemReader.Ce?null:b.Ub(4);if(of.ListItemReader.Ce?of.ListItemReader.isListItem(oa):Gb)return of.ListItemReader.Ce||b.rc(),Ja=this.Fhf(Cb,of.ListItemReader.Ce?oa:Gb,A,fb),Ja.qv=this.jE(b),
Ja;this.Iwo(b);({listId:Gb}=of.ListItemReader.bKf(h,{Gra:-1}));const Sb=this.Jvm(Gb,aa),pc=this.vyi(oa),zc=this.lzi(h,b,Cb,aa,M,r);this.gMj(zc,Cb);oa&&this.ZMj(oa);return null==zc||M||Cb.Uz!==this.Md.h9a(b.currentNode,zc.qv).Uz?this.sVl(Cb,Sb,zc,b.currentNode)?this.$5k(b,Cb,Sb,pc,fb):this.Z5k(b,Cb,Ja,pc,fb,Sb,Gb):(Cb.listStyle||(zc.Jmc=!0),this.a6k(Sb,zc,b))})}):(h||v.ULS.sendTraceTag(509650391,393,15,"applyListInfo was called with info = "+h),this.bca(b))}$5k(b,h,r,A,M){r=this.gwm(h,r,A);r=this.o_b(b,
r);b=of.ListItemReader.Ce?of.ListItemReader.g7(b):r;return this.Fhf(h,b,-1,M)}lzi(b,h,r,A,M,aa){var oa;M=b.dvb?new Vp(this,vd.a.Za(b.dvb),!1,!0):Vp.E6l(this,h,r,A,M);if(!M)return null;aa?(M.qv.level=this.Mtm(h,r,A),this.C8l(h,M)):M.qv&&(null===(oa=b.ff)||void 0===oa?0:oa.hasProperty(Mc.a.listLevel))&&(M.qv.level=b.ff.getValue(Mc.a.listLevel));return M}Jvm(b,h){return h&&0<b&&b+""in this.Tig?this.Tig[b+""]:-1}gwm(b,h,r){var A,M;const aa=new ey.a;aa.listID=h;aa.level=null!==(M=null===(A=b.ff)||void 0===
A?void 0:A.wf(Mc.a.listLevel))&&void 0!==M?M:this.Gad(r);b.ff&&b.oBa&&!ao.Cs.Fu&&(aa.levelText=b.levelText.replace("%1","%"+(aa.level+1)));return aa}Fhf(b,h,r,A){b=this.lll(h,b,r,A);return gr.kwn(b)}a6k(b,h,r){let A=null;0<b&&(A=new RC(0,h.qv,-1),A.tfd=b);zi.a.Vs?this.o_b(r,h.qv):this.WMj(r,h,!1,A);return gr.Bwn(h.qv)}Z5k(b,h,r,A,M,aa,oa){const Ja=Db.OutlineElementReader.K2(b);0<Ja&&(A+=Ja);r=this.Qsf(r,h,A,M);this.Eup(aa,oa,r);b=this.o_b(b,r);zi.a.Vs||h.listType||(h=h.tD,h===vj.a.Jk&&(h=1),b.setValue(ao.Cs.moa,
h),b.setValue(ao.Cs.WEa,h));return gr.nwn(r)}bca(b,{LAj:h=!1}={},r=!1){return vd.a.Uea(()=>{if(!Db.OutlineElementReader.Nh(b))return v.ULS.sendTraceTag(509678220,393,15,"Iterator not pointing to OE in remove list info word."),gr.Bbb();const A=Db.OutlineElementReader.nN(b);if(zi.a.getInstance().Fu&&!A&&(v.ULS.sendTraceTag(508432897,393,15,"OutlineElement has listNode but no paraNode during removeListInfo [setter flight ON]"),this.Oh.swo(b.currentNode),zi.a.getInstance().Kt))return gr.Bbb();if(null===
A||void 0===A?0:A.ra.last.Vh)return v.ULS.sendTraceTag(509678219,393,15,"User tried to remove list from para with deleted EOP."),gr.Bbb();const M=b.Ub(4);return zi.a.fu||M?zi.a.fu&&!of.ListItemReader.isListItem(A)?M?(M.axc=!1,b.Rg(),gr.o3f()):gr.Bbb():A?this.xgc(A,()=>{var aa;this.TAj(A);this.Ovo(A);of.ListItemReader.Ce||(A.bE=null);this.Md.Dde(of.ListItemReader.Ce?of.ListItemReader.Lr(A,{Gra:0}).listId:M.ka(Mc.a.listID,0))?(M&&(M.axc=!1),this.zI.Nga(A,b),of.ListItemReader.Ce&&!zi.a.getInstance().Kt&&
(A.bE=null)):M&&b.rc();h||this.HPo(b);if(b.Ub(4)||zi.a.fu&&of.ListItemReader.isListItem(A))M&&(M.axc=!1),this.zI.Nga(A,b),of.ListItemReader.Ce&&!zi.a.getInstance().Kt&&(A.bE=null);!zi.a.getInstance().Kt&&(this.Yd.Lg&&!this.Gyb||!this.Yd.Lg&&A.jj)&&(!A.jj||(null===(aa=A.Fx)||void 0===aa?0:aa.hasProperty(Mc.a.listID)))&&this.GHl(b);return gr.o3f()},{c7o:r}):(v.ULS.sendTraceTag(509211404,393,15,"OutlineElement has listNode but no paraNode during removeListInfo"),M&&(M.axc=!1,b.Rg()),gr.o3f()):gr.Bbb()})}HPo(b){const h=
Object(vo.a)().Iu(b.currentNode),r=Db.OutlineElementReader.nKa(b),A=Db.OutlineElementReader.jI(b),M=Db.OutlineElementReader.K2(b);this.r0d(h);this.Oh.TDa(b,1,Math.max(0,r+(M||-1*A)-this.dFc[0]))}xgc(b,h,{c7o:r=!1}={}){let A=null;b&&(A=b.XC());h=h();this.Gyb||(b&&A&&this.Oq.fV(b,A,this.Yd.Lg),r||this.N0());return h}Ovo(b){b.hasProperty(Mc.a.he)&&b.removeProperty(Mc.a.he);b.hasProperty(Mc.a.qD)&&b.removeProperty(Mc.a.qD);b.hasProperty(Mc.a.Mt)&&b.removeProperty(Mc.a.Mt)}infoAtLevel(b,h){if(!h)return null;
const r=h.YA;if(1===h.Ys){if(h.zta&&!h.IL||!h.Anf(!1))return h;b=Db.OutlineElementReader.nKa(b);const A=this.Gad(b),M=r.rUb[A];b=fq.a.maa(h.ff,h.ff);6===M?b.nca(1,1):b.nca(0,M);b.Swe("multilevel");b.levelText=r.Iad[A];r.SJa&&r.SJa[A]&&(b.font=r.SJa[A]);b.Ax=r.Wfe[A];b.b9=r.b9;b.Pge=h.Pge}else b=h;return b}gMj(b,h){null!==b&&void 0!==b&&b.qv&&(h.levelText=b.qv.levelText,h.Uz||(h.font=b.qv.font))}Mtm(b,h,r){let A=Db.OutlineElementReader.nKa(b);const M=Db.OutlineElementReader.K2(b);0<M?A+=M:(b=Db.OutlineElementReader.jI(b),
0<b&&(A-=b));h=h.ff.ka(Mc.a.listLevel,-1);return r&&0<=h?h:this.Gad(A)}C8l(b,h){if(!zi.a.Vs&&!this.Ps.h9a(b.currentNode,h.qv).listType){const r=this.VAa(b.currentNode,h.qv);b=this.S1f(h.qv,b,r);h.qv.WYc=h.qv.Bx=b.Zub===vj.a.Jk?r.startAt-1:b.Zub;h.Jmc=b.r$j}}Eup(b,h,r){0>=b?this.Tig[h+""]=r.listID:r.listID=b}sVl(b,h,r,A){if(0>=h)return!1;const M=(aa,oa)=>aa.length!==oa.length||aa.some((Ja,fb)=>Ja!==oa[fb]);if(r)return h=this.Md.h9a(A,r.qv),b.Uz!==h.Uz||M(b.dma,h.dma);r=b.ff.ka(Mc.a.listLevel,-1);return 0<=
r&&(h=this.Ps.Ty(A,h,r))&&(h=h.ka(He.a.O7,null))&&b.dma?M(h,b.dma):!1}Mvo(b,h){var r;const A=!!h&&Gd.ParagraphReader.Vb(h);let M=0,aa=0;A&&(M=this.Pp.$W(of.ListItemReader.Ce?h:this.Md.Wzi(b)).Ou,aa=this.Pp.jI(h).Ou);A&&this.TAj(h);(null===(r=zi.a.getInstance())||void 0===r?0:r.Kt)||b.Ub(4);this.zI.Nga(h,b);A&&this.Oh.TDa(b,1,M-aa)}Fea(b,h,r,A=-1,M=!1,aa=null,oa=!1){v.ULS.sendTraceTag(17622211,324,50,"'Continue Existing List' is selected from Context Menu.");const Ja=Rg.a.instance.nq(ub.a.Fea),fb=
this.Qc.Nc(15);fb.mu(b);let Cb=null,Gb=0;({osn:Cb,MPn:Gb,returnValue:A}=this.d7l(b,h,A,Cb,Gb,M,aa));if(!Cb||oa&&(1===r||0>r-Cb.qv.Bx||2<r-Cb.qv.Bx))return fb.dispose(),Ja.end(),!1;for(;0<Gb;)b.i9d(),Gb--;this.Aup(b,h,A,Cb);fb.dispose();Ja.end();return!0}Aup(b,h,r,A){for(;b.i9d();){var M=of.ListItemReader.g7(b);if(M&&(M=this.Kjc(M),M.listID===h.listID)){h=new RC(0,h,r);zi.a.getInstance().Fu?this.jLg(b,A,M.h0,h):this.jLg(b,A,!0,h);break}}}d7l(b,h,r,A,M,aa=!1,oa=null){for(var Ja;b.IJi();){if(b.kv(4)){const fb=
this.jE(b),Cb=this.Md.Pw(b);if(Cb.listType!==oa.listType){M++;continue}if(aa&&Cb.listStyle!==oa.listStyle||!aa&&h.level<fb.level){M++;continue}-1===r&&(r=fb.Bx+1);A=null;if(h.level===fb.level||aa)null===(Ja=this.bpd)||void 0===Ja?void 0:Ja.FTf(b),A=new Vp(this,b,!1,!1);aa&&fb.level!==h.level&&b.kv(4)&&(b.Ub(4).setValue(Mc.a.listLevel,fb.level),b.rc());break}M++}return{returnValue:r,osn:A,MPn:M}}fwm(b){b=of.ListItemReader.g7(b);return this.B6d(b)}B6d(b){let h;h=of.ListItemReader.Ce?of.ListItemReader.Lr(b)||
of.ListItemReader.dla(b):this.Md.v_(b,!1,!0);return this.Md.Ty(b,h.listId,h.listLevel)}startNewList(b,h,r){v.ULS.sendTraceTag(17622212,324,50,"'Start New List' is selected from Context Menu.");if(h){var A=Rg.a.instance.nq(ub.a.startNewList),M=this.Qc.Nc(15);M.mu(b);var aa=fq.a.c_(0,h.listStyle,null,0,h.ff.ka(Mc.a.listLevel,-1));if(of.ListItemReader.Ce)({listId:oa,listLevel:Ja}=of.ListItemReader.Yka(b,{Gra:0,wUa:-1}));else{b.Ub(4);var oa=b.currentNode.ka(Mc.a.listID,0);var Ja=b.currentNode.ka(Mc.a.listLevel,
-1);b.rc()}aa.Pge=oa;var fb=h.ff.ka(Mc.a.he,0);0<fb&&aa.ff.setValue(Mc.a.he,fb);-1===aa.ff.ka(Mc.a.listLevel,-1)&&aa.ff.setValue(Mc.a.listLevel,Ja);1===h.Ys&&((Ja=new Cq.a,oa=h.fIi(b.currentNode,oa),oa)?1===oa&&(aa.Swe(uw.a.Zqc),aa.YA=Ja.Ssf(Ja.Ubg,Ja.Vbg),aa.b9=aa.YA.b9):(aa.Swe(uw.a.Zqc),aa.YA=Ja.Yrf(),aa.b9=aa.YA.b9));h.zsa()&&1>r&&(r=1);aa.tD=r;Ja=new wg.DictionaryPropertySet;Ja=this.SZc(ub.a.MN,Ja);oa=Db.OutlineElementReader.nN(b);h=this.jE(b);if(fb=this.fwm(b))aa.levelText=fb.ka(Mc.a.Tw,""),
aa.IL=42,aa.Ax=fb.ka(Mc.a.aga,"left");this.Mvo(b,oa);({wla:aa}=this.Dqa(Ja,b,aa,!0));b.Ub(4);22!==b.currentNode.type&&63!==b.currentNode.type&&v.ULS.sendTraceTag(587851671,393,15,"Graph node {0} is not list node.",b.currentNode.type);zi.a.getInstance().Kt||b.currentNode.setValue(Mc.a.listLevel,h.level);zi.a.getInstance().Fu&&({listId:aa}=of.ListItemReader.Lr(zi.a.getInstance().Ula?oa:b.currentNode),this.zI.n_b(oa,aa,h.level));b.rc();aa=new Vp(this,b,!1,!1);r=new RC(1,h,r);this.jLg(b,aa,!!zi.a.getInstance().Fu,
r);M.dispose();A.end()}else v.ULS.sendTraceTag(51242764,324,50,"'Start New List' has no current ListInfo")}DZf(b){if(!b)return!1;const h=b.Ub(2);h&&b.rc();return h&&12===h.type&&h.ra&&h.ra.last&&h.ra.last.Vh?!0:!1}ape(b,h,r,A){return this.ABk.ape(b,h,r,A)}uvg(b,h){if(!b||!h)return!1;const r=b.ff.ka(Mc.a.Tw,null);h=h.ff.ka(Mc.a.Tw,null);if(!r||!h)return!1;const A=b.ff.ka(He.a.font,null);b=b.ff.ka(He.a.font,null);return r===h&&A===b}INj(b,h,r){r||h.listType||(h.tD=b.ka(He.a.GU,vj.a.Jk))}Lzi(b,h){if(!h)return null;
const r=Array(9),A=h.Pge;if(!this.njn(h,b)||1>A)return null;for(h=0;9>h;h++){const M=this.Md.Ty(b,A,h);if(null===M||void 0===M?0:M.hasProperty(Mc.a.he))r[h]=M.getValue(Mc.a.he);else return null}return r}njn(b,h){if(!b)return!1;const r=b.ff.ka(Mc.a.listLevel,-1);b=b.ff.ka(Mc.a.he,-1);if(0>r||0>b)return!1;this.r0d(h);return b!==this.E5b[r]}HMh(b,h,r){b&&b.setValue(Mc.a.he,h?h[r]:this.E5b&&r<this.E5b.length?this.E5b[r]:720*(r+1))}epi(b,h,r,A,M=null,aa=!1){if(!zi.a.Vs){var oa=new vd.a,Ja=this.VAa(b,h);
oa.set(b);oa.Kd();b=ef.a.At(oa,oa.s2b());b.pp(LG.a.Xge,null);for(var fb=-1;b.moveNext();){if(!of.ListItemReader.Cg(oa))continue;const Cb=this.jE(oa),Gb=Db.OutlineElementReader.nN(oa);this.Md.o0(oa);const Sb=oa.currentNode;oa.rc();if(r!==this.gze||Cb.listID===h.listID){if(aa){if(-1!==fb&&fb>Cb.level)break;if(-1===fb)fb=Cb.level;else if(Cb.level!==fb)continue}else{if(Cb.level<=Ja.hdb)break;if(!r(h,Cb,M))continue}A(Sb,Gb,h.listID,M)}}}}S$l(b,h,r,A){if(!zi.a.Vs){var M=new vd.a,aa=this.VAa(b,h);M.set(b);
M.Kd();if(of.ListItemReader.Cg(M)){b=this.jE(M);var oa=Db.OutlineElementReader.nN(M);this.Md.o0(M);var Ja=M.currentNode;M.rc();b.level<=aa.hdb||r(h,b,null)&&A(Ja,oa,h.listID,null)}}}R$l(b,h,r,A,M=null){const aa=new vd.a;aa.hd(b);A(b,h,this.jE(aa),aa,0);this.o3d(b,h,r,A,M)}o3d(b,h,r,A,M=null){let aa=new vd.a;const oa=this.VAa(b.currentNode,h);let Ja=null,fb=0;var Cb=new vd.a;Cb.hd(b);Cb.vb(10);const Gb=uf.a.At(Cb,Cb.origin);for(Gb.moveNext();Gb.moveNext();)if(Ja=null,aa=Gb.iterator,1===aa.role&&(Ja=
Gb.currentNode,aa.kv(4)&&(Cb=this.jE(aa),r(h,Cb,M))))if(Cb.level>h.level)A(b,h,Cb,aa,fb),fb++;else if(Cb.level===h.level||Cb.level<=oa.hdb)break;return Ja?aa:null}Owj(b,h,r,A){zi.a.Vs||this.VAa(b.currentNode,r).hdb>=h.level&&this.mll(A)}static SMj(b,h){h.setValue(He.a.font,b.zta||b.H7c||b.f5c?b.font:"Symbol")}static UMj(b,h){b=b.zta||b.H7c||b.oBa?b.levelText:vj.a.QYd;v.ULS.shipAssertTag(22127637,338,!!b);h.setValue(Mc.a.Tw,b)}static TMj(b,h){b=b.ff.ka(Mc.a.aga,"left");h.setValue(Mc.a.aga,b)}}Cu.kHn=
2147450879;Cu.Hcj=1;Object(u.a)(Cu,"FlatListEditorCssVersion",ao,[285,286]);class yJ{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc){this.Ps=b;this.K3n=h;this.gg=r;this.jp=A;this.cC=M;this.hwn=aa;this.Od=oa;this.Mj=Ja;this.swn=fb;this.sc=Cb;this.Wb=Gb;this.pM=Sb;this.zI=pc}create(){return new Cu(this.Ps,this.K3n,this.gg,this.jp,this.cC,this.hwn,this.Od,this.Mj,this.swn,this.sc,this.Wb,this.pM,this.zI)}}Object(u.a)(yJ,"FlatListEditorFactory",null,[]);class vw{constructor(){this.startAt=this.listLevel=
this.listId=0;this.dvb=null}}Object(u.a)(vw,"ListAutoCorrectionRefInfo",null,[]);class Ip{constructor(b,h){this.ZAk=b;this.jg=h}ape(b,h,r,A){if(!b.hasProperty(pd.a.MLa))return!0;h=vd.a.Za(h.currentNode);ze.a.tv(h);let M=!0;if(!r.listType&&!A){23===h.mf&&h.yL(1);A=b.ka(pd.a.MLa,1);if(1<A){var aa=new vd.a;aa.hd(h);aa.vb(10);aa=uf.a.gq(aa.origin);A=this.c7l(aa,A,r,h.currentNode);r.dvb||(M=!1)}b.setValue(pd.a.MLa,A)}return M}c7l(b,h,r,A){const M=new ib.a;for(;b.moveNext()&&b.iterator.currentNode!==A;){const aa=
b.iterator;if(!aa.kv(4))continue;const oa=this.ZAk.value.jE(aa),Ja=this.jg.Pw(aa);this.tgo(M,oa);Ja.listType===r.listType&&Ja.listStyle===r.listStyle&&(0>h-oa.Bx||2<h-oa.Bx||M.add(Object.assign(new vw,{listId:oa.listID,listLevel:oa.level,dvb:aa.currentNode,startAt:oa.Bx+1})))}0<M.count&&(h=M.K(M.count-1).startAt,r.dvb=M.K(M.count-1).dvb);return h}tgo(b,h){let r=0;for(;r<b.count;){const A=b.K(r);A.listId===h.listID&&A.listLevel>=h.level?b.removeAt(r):r++}}}Object(u.a)(Ip,"ListAutoCorrector",null,[254]);
class MG{constructor(b,h,r,A,M){this.ueb=(aa,oa,Ja)=>{var fb;aa=of.ListItemReader.Ce?of.ListItemReader.n2c(oa):this.WWc(oa);if(!aa||this.$t.DZf(aa))return 8;oa=this.$t.jE(aa);if(1===oa.Bx||this.U8c(oa.level))return 8;oa=null===(fb=this.Md)||void 0===fb?void 0:fb.Pw(aa);if(!oa||this.qYi(oa))return 8;if(1===Ja)return 32;this.$t.startNewList(aa,oa,1);return 32};this.teb=(aa,oa,Ja)=>{aa=of.ListItemReader.Ce?of.ListItemReader.n2c(oa):this.WWc(oa);if(!aa||this.$t.DZf(aa))return 8;oa=this.$t.jE(aa);if(this.U8c(oa.level))return 8;
const fb=this.Md.Pw(aa);if(!fb||this.qYi(fb))return 8;if(1===Ja)return 32;this.oYc.uym(aa.currentNode,oa.Bx,this.Md,this.$t,this.W_a);return 32};this.Fea=(aa,oa,Ja)=>{aa=of.ListItemReader.Ce?of.ListItemReader.n2c(oa):this.WWc(oa);if(!aa||this.$t.DZf(aa))return 8;oa=this.$t.jE(aa);if(1!==oa.Bx||this.U8c(oa.level))return 8;if(1===Ja)return 32;Ja=this.Md.Pw(aa);return this.$t.Fea(aa,oa,Ja.tD,-1,!1,Ja)?32:8};this.Oyb=(aa,oa,Ja,fb,Cb)=>{aa=of.ListItemReader.Ce?of.ListItemReader.n2c(oa):this.WWc(oa);if(!aa)return 8;
oa=this.$t.jE(aa);if(this.U8c(oa.level))return 8;if(1===Ja)return 32;Ja=this.Md.Pw(aa);this.$t.startNewList(aa,Ja,Cb);return 32};this.Dnb=(aa,oa,Ja,fb,Cb)=>{aa=of.ListItemReader.Ce?of.ListItemReader.n2c(oa):this.WWc(oa);if(!aa)return 8;oa=this.$t.jE(aa);return this.U8c(oa.level)?8:1===Ja?32:this.$t.Fea(aa,oa,oa.Bx,Cb)?32:8};this.Rb=b;this.Md=r;this.$t=A;this.oYc=M}U8c(b){return 0>b}Xb(){this.Rb.qa(ub.a.ueb,lc.a.bS,this.ueb);this.Rb.qa(ub.a.ueb,lc.a.Xc,this.ueb);this.Rb.qa(ub.a.ueb,lc.a.view,this.ueb);
this.Rb.Pc(ub.a.ueb,12);this.Rb.qa(ub.a.teb,lc.a.bS,this.teb);this.Rb.qa(ub.a.teb,lc.a.Xc,this.teb);this.Rb.qa(ub.a.teb,lc.a.view,this.teb);this.Rb.Pc(ub.a.teb,12);this.Rb.qa(ub.a.Fea,lc.a.bS,this.Fea);this.Rb.qa(ub.a.Fea,lc.a.Xc,this.Fea);this.Rb.qa(ub.a.Fea,lc.a.view,this.Fea);this.Rb.Pc(ub.a.Fea,12);this.Rb.qa(ub.a.Oyb,lc.a.bS,this.Oyb);this.Rb.qa(ub.a.Oyb,lc.a.Xc,this.Oyb);this.Rb.qa(ub.a.Oyb,lc.a.view,this.Oyb);this.Rb.Pc(ub.a.Oyb,12);this.Rb.qa(ub.a.Dnb,lc.a.bS,this.Dnb);this.Rb.qa(ub.a.Dnb,
lc.a.Xc,this.Dnb);this.Rb.qa(ub.a.Dnb,lc.a.view,this.Dnb);this.Rb.Pc(ub.a.Dnb,12)}get W_a(){return Za.a.instance.resolve(48).kha}WWc(b){return this.$t.Qvm(b)}qYi(b){return 1===(null===b||void 0===b?void 0:b.listType)}}Object(u.a)(MG,"ListContextMenuSectionActor",null,[]);var jm=d(595);class mx{static get rwn(){return ig.a.Ry(mx.Hn,Box4Intl.Box4Strings.l_StartNewListDialog,Box4Intl.Box4Strings.l_ContinueFromPreviousList,Box4Intl.Box4Strings.l_SetValueTo)}}mx.Hn="<div class='WACDialogRow' id='StartNewList'> <input type='radio' id='ListRadioStartNew' name='ListRadioBox' class='WACDialogRadio' alt='{0}' title='{0}'></input> <label id='StartNewList' class='WACDialogLabel' for='ListRadioStartNew' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='ContinuePreviousList'> <input type='radio' id='ListRadioContinue' name='ListRadioBox' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ContinueFromPreviousList' class='WACDialogLabel' for='ListRadioContinue' >{1}</label> </div> <div class='WACDialogRow' id='SpinnerRow'> <div class='WACDialogGroupBox' id='ListStartAtSpinnerBox'> <label id='ListStartAtNumber' class='DialogSpinnerLabel' >{2}</label> <br/> <div id='SetListStartSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(u.a)(mx,"ListSetStartValueDialogHtml",null,[]);class Pr extends ig.a{constructor(b,h,r,A,M){super();this.lHd=this.dNe=this.EHd=this.F8e=null;this.$Oe=!0;this.OV=!1;this.qjb=0;this.YUj=[ub.a.Qyg,ub.a.LDg,ub.a.zng];this.OVo=(aa,oa)=>{aa=oa[ui.a.Number];this.fda=Number.isInteger(oa[ui.a.Number])&&aa>=this.qjb?aa:this.qjb};this.NIm=(aa,oa)=>{this.fda=this.fda>=this.qjb?this.fda:this.qjb;oa[ui.a.Number]=this.fda;oa[ui.a.UnitType]=0};this.JSo=(aa,oa)=>{if(1===aa){var Ja=oa.ListRadioStartNew,fb=oa.ListRadioContinue,
Cb=vd.a.Za(this.Qf);Cb.Kd();oa=this.$t.jE(Cb);aa=this.jg.Pw(Cb);if(Ja)this.$t.startNewList(Cb,aa,this.fda);else if(fb)if(this.$Oe)this.$t.Fea(Cb,oa,this.S1e,-1,!1,aa);else{Ja=!0;for(fb=null;Cb.RJ();)if(of.ListItemReader.Cg(Cb)){fb=new Vp(this.$t,Cb,!1,!1);break}if(!fb||this.$t.jE(Cb).Bx>=this.fda)Ja=!1;Ja?(Cb=vd.a.Za(this.Qf),Cb.Kd(),this.$t.Fea(Cb,oa,this.S1e,this.fda,!1,aa)):(this.dispose(),this.NNa(CommonUIStrings.l_ErrorDialogMessage,this.qwn))}}};this.qwn=()=>{new Pr(this.Qf,this.S1e,this.jg,
this.$t,this.zd)};this.a0n=()=>{document.getElementById(Pr.J5i).style.visibility="visible"};this.GTn=()=>{document.getElementById(Pr.J5i).style.visibility="hidden"};this.Ng="ListSetStartValueDialog";this.kh=mx.rwn;this.Qf=b;this.fda=h;this.jg=r;this.S1e=h;this.J9=A;h=new vd.a;b?(h.set(b),h.Kd(),Db.OutlineElementReader.Nh(h)||Bb.OutlineElementNavigator.je(h),of.ListItemReader.Cg(h)&&(b=null,of.ListItemReader.Ce?b=this.jg.Pw(h):(h.Ub(4),h=h.currentNode,22===h.type&&(b=this.jg.N2(h))),b&&(b.zsa()?this.qjb=
1:this.qjb=0))):this.qjb=1;this.zd=M;this.mi(Box4Intl.Box4Strings.l_SetNumberingValueList,this.JSo,{["ListRadioStartNew"]:!0,["ListRadioContinue"]:!1});this.$Oe&&(this.F8e=document.getElementById("ListRadioStartNew"),this.EHd=this.a0n,this.dNe=document.getElementById("ListRadioContinue"),this.lHd=this.GTn,mf.a.addHandler(this.F8e,"click",this.EHd),mf.a.addHandler(this.dNe,"click",this.lHd));for(const aa of this.YUj)Object(jm.a)(aa,this.OVo,this.NIm);this.zd.rn()}get $t(){return this.J9}dispose(){if(!this.OV){for(const b of this.YUj)Object(jm.b)(b);
this.$Oe&&(this.EHd&&mf.a.removeHandler(this.F8e,"click",this.EHd),this.lHd&&mf.a.removeHandler(this.dNe,"click",this.lHd));this.zd.B0("ListStartSpinner");super.dispose();this.OV=!0}}hel(){const b=Aj.l("none",this.qjb+"","100","1");return Aj.j(Pr.K5i,ub.a.Qyg,ub.a.zng,Box4Intl.Box4Strings.l_SetValueTo,[b],null,ub.a.LDg)}iKb(b){const h=document.getElementById(Pr.K5i);this.zd.w5a("ListStartSpinner",b);b=this.zd.hPb("ListStartSpinner","Medium");h.appendChild(b)}Cba(){const b=this.hel();this.iKb(b)}}
Pr.K5i="SetListStartSpinnerContainer";Pr.J5i="ListStartAtSpinnerBox";Object(u.a)(Pr,"ListSetStartValueDialog",ig.a,[]);class Tz{uym(b,h,r,A,M){new Pr(b,h,r,A,M)}static get instance(){return Tz._instance||(Tz._instance=new Tz)}}Tz._instance=null;Object(u.a)(Tz,"ListDialogFactory",null,[242]);class zJ{constructor(b,h,r){this.J9=b;this.jg=h;this.Qc=r}FTf(b){v.ULS.shipAssertTag(40420184,393,Db.OutlineElementReader.Nh(b));if(of.ListItemReader.Cg(b)){const h=this.jg.Pw(b);h.Ys||this.f2m(b,h)}}Knl(b){for(let h=
0;h<b.length;h++){const r=new vd.a;r.set(b.getContext(h).node);this.FTf(r)}}f2m(b,h){const r=Object(vo.a)().Iu(b.currentNode),A=this.J9.jE(b),M=this.Qc.Nc(15);M.mu(b);h=this.J9.j6k(r,b,h);this.J9.Fup(b,A.listID);M.dispose();this.jg.h9a(b.currentNode,h)}}Object(u.a)(zJ,"SingleLevelListEditor",null,[238]);var sB=d(393);class NG{$tj(b,h,r,A,M,aa){return b?y.AFrameworkApplication.va.Nf(b,h,r,!0,M,aa):8}}Object(u.a)(NG,"ListContextManager",null,[1619]);class Pv extends NG{constructor(b){super();Pv.nIc=
b}$tj(b,h,r,A,M,aa){if(!b||!b.length)return 8;let oa;const Ja=({hRm:b,gRm:oa}=Pv.ir.eRm(b)).returnValue;let fb=1;for(const Gb of Ja.keys){var Cb=b.contains(Gb);const Sb=Ja.K(Gb);Pv.ir.ijl(Ja.K(Gb),this.xUc(h),Cb)?Cb?(v.ULS.sendTraceTag(508350475,393,50,"List Actions: {0} lists, with change in level",this.xUc(h)?"Promote":"Demote"),Cb=y.AFrameworkApplication.va.Nf(sB.a.OIa(Sb),h,r,A,M,aa)):(v.ULS.sendTraceTag(508350474,393,50,"List Actions: {0} lists, without change in level",this.xUc(h)?"Promote":
"Demote"),Cb=Pv.ir.J3n(Ja.K(Gb),this.xUc(h),oa.K(Gb))):(v.ULS.sendTraceTag(508350476,393,50,"List Actions: Tried to {0} lists, but unable to indent",this.xUc(h)?"Promote":"Demote"),Cb=8);fb=ce.ActionManager.Fcd(fb,Cb)}return fb}xUc(b){return b===ub.a.KI?!0:!1}static get ir(){return Pv.nIc||(Pv.nIc=Za.a.instance.resolve(948))}}Pv.nIc=null;Object(u.a)(Pv,"WordEditorListContextManager",NG,[]);class nx{get name(){return"WordEditor.ListEditors"}uc(b){y.AFrameworkApplication.J.$("OutlineLevelEditorsDelayInitializationEnabled")&&
(b.ia(949,()=>new Ip(b.rf(618),b.resolve(10))).ha(),b.ia(618,()=>(new yJ(b.resolve(452),b.rf(659),b.resolve(18),new Qn.a,b.resolve(17),b.resolve(949),b.resolve(46).instance,b.resolve(39).instance,b.resolve(923),b.resolve(12),b.resolve(8),b.resolve(392),b.resolve(947))).create()).ha(),b.ia(32,()=>b.resolve(618)).ha(),b.ia(880,()=>new zJ(b.resolve(618),b.resolve(10),b.resolve(42))).ha(),b.ia("Box4.ListEditors.WordEditorListContextManager",()=>new Pv(b.resolve(948))).as(693))}init(){(new MG(y.AFrameworkApplication.va,
new Ul.a,nx.Md,nx.$t,Tz.instance)).Xb();const b=y.AFrameworkApplication.va;b.fb(ub.a.zng,lc.a.view,jm.d,96);b.fb(ub.a.LDg,lc.a.view,jm.c,96);b.fb(ub.a.Qyg,lc.a.view,jm.c,96)}dispose(){}static get Md(){return null!=nx.P_g?nx.P_g:nx.P_g=Za.a.instance.resolve(10)}static get $t(){return null!=nx.LVg?nx.LVg:nx.LVg=Za.a.instance.resolve(618)}static main(){K.a.instance.Lc(new nx)}}Object(u.a)(nx,"WordEditorListEditorsPackage",null,[0,1]);var Uz=d(1687),hv=d(516),nt=d(2086);class AJ extends Jb.a{constructor(b,
h,r,A,M,aa){super(b,h);this.styleId=null;this.Ch=0;this.Ota=null;this.characterData=r;this.paragraphNode=A;this.listMarker=M;this.$Qb=aa}}Object(u.a)(AJ,"HeadingText",Jb.a,[]);var SC=d(350),nL=d(985);class IE{constructor(b,h,r,A,M,aa,oa){this.jln=oa;this.jlh=!0;this.Hsh=0;this.hIh=8;this.Ema=null;this.fYm=Ja=>{if(Ja.xs)return!0;Ja=Ja.role;return 1===Ja||2===Ja||4===Ja};this.TAk=b;this.oG=h;this.we=r;this.jg=A;this.sJ=M;this.Y0=aa}get ov(){return this.TAk.value}get uTf(){return this.jlh}set uTf(b){this.jlh=
b}get KUb(){return this.Hsh}set KUb(b){this.Hsh=b}get h2b(){return this.hIh}set h2b(b){this.hIh=b}async msm(){if(this.jln){var b=await this.fBm();return this.Rkg(b,!0)}b=this.Ema;return isNullOrUndefined(b)?null:Promise.resolve(this.Rkg(b,!0))}nsm(){return this.Rkg([],!1)}Rkg(b,h){const r=window.performance.now(),A=this.Rxi();if(!A)return null;const M=new ib.a;let aa=0;for(;A.moveNext();){var oa=A.iterator;if(11===oa.mf){const Ja=of.ListItemReader.g7(oa),fb=Bb.OutlineElementNavigator.Me(oa,!0);h&&
b[aa]&&b[aa].ParaId===Gd.ParagraphReader.nU(fb)&&aa++;Bb.OutlineElementNavigator.je(oa);if(!fb||!Gd.ParagraphReader.Vb(fb)||fb.zs||""===fb.characterData||"\ufffc"===fb.characterData)continue;const Cb=this.S5d(fb);Cb&&(Ja&&(Cb.listMarker=this.sJ.QXa(Ja,!1).FU,oa=this.jg.Pw(oa),1===oa.listType&&oa.f5c&&(Cb.Ota=oa.font)),h&&(b[aa-1]&&b[aa-1].ParaId===Gd.ParagraphReader.nU(fb)?Cb.Ch=aa:Cb.Ch=aa+1),M.add(Cb))}}v.ULS.sendTraceTag(591963592,3019,50,String.format("GetHeadingsDataForToc Duration: {0} ms;",
window.performance.now()-r));return M}fBm(){const b=new Yh.a;var h=nt.a.Cea(y.AFrameworkApplication.rootQuerySignature,null);const r=new Om.a;r.Wq=h;r.status=nL.a.nH;this.vFk=window.performance.now();h=this.Y0.Eaa(0,()=>{if(2!=r.statusCode||null==r.fk||0==r.fk.length||null==r.fk[0]){const A=String.format("GetPageEndsOperation Failed with status code: {0};",r.statusCode);b.setException(Error.create(A));v.ULS.sendTraceTag(543802465,3019,10,A)}else b.hg(r.fk[0].PageEnds),v.ULS.sendTraceTag(543802466,
3019,50,String.format("GetPageEndsDuration Duration: {0} ms;",window.performance.now()-this.vFk))});h.CG(r);h.g_();return Gk.b(b.task)}Qxi(){const b=this.Rxi();if(!b)return-1;let h=0;for(;b.moveNext();){const r=b.iterator;if(11===r.mf){const A=Bb.OutlineElementNavigator.Me(r,!0);Bb.OutlineElementNavigator.je(r);A&&Gd.ParagraphReader.Vb(A)&&!A.zs&&""!==A.characterData&&"\ufffc"!==A.characterData&&this.S5d(A)&&h++}}return h}Rxi(){if(!this.ov)return v.ULS.sendTraceTag(591000526,3019,10,"PageNode is null"),
null;var b=this.oG.mU(this.ov);if(!b)return v.ULS.sendTraceTag(591963593,3019,10,"pageContentNode is null."),null;b=vd.a.Za(b);if(!b.pq())return v.ULS.sendTraceTag(591963594,3019,10,"Failed to root at PageContent."),null;b=uf.a.At(b,b.origin);b.pp(this.fYm,null);return b}S5d(b){var h;return null!==(h=this.ROm(b))&&void 0!==h?h:this.yBm(b)}ROm(b){if(!this.wrn(b))return null;var h=Object(SC.c)(9);h=Object(SC.a)(h);h=[...Gd.ParagraphReader.eCf(b,h)];if(0===h.length)return null;const r=Gd.ParagraphReader.PVa(b)+
1;return this.T4h(b,h,r)}yBm(b){var h,r,A,M,aa=Object(SC.c)(9);aa=Object(SC.a)(aa);const oa=Gd.ParagraphReader.G3c(b),Ja=this.we.AF(b),{gYm:fb,m8l:Cb}=this.cKm(oa,Ja,aa);aa=null!==(M=null!==(r=null===(h=Cb.linkedStyle)||void 0===h?void 0:h.$Qb)&&void 0!==r?r:null===(A=Cb.Fw)||void 0===A?void 0:A.$Qb)&&void 0!==M?M:10;return this.v9c(aa-1)?this.T4h(b,fb,aa):null}T4h(b,h,r){var A;if(!this.v9c(r-1))return null;const {E1j:M,D1j:aa}=this.glp(b,h);return 0===M.length?null:(h=null===(A=Gd.ParagraphReader.E8d(b,
M))||void 0===A?void 0:A.trim())&&""!=h?new AJ(aa.Gd,aa.endCp,h,b,null,r):null}cKm(b,h,r){const A=[];let M={linkedStyle:null,Fw:null},aa=null,oa=null;for(const Ja of b)if(aa=Ja.u6.formatting?this.jsm(h,Ja.u6):aa,b=r(Ja)){if(!oa&&b){oa=aa;if(!oa)break;M=aa}else if(!this.lhn(aa,oa))break;A.push(Ja)}return{gYm:A,m8l:M}}glp(b,h){var r;let A=-1,M;for(M=0;M<h.length;M++){var aa=h[M],oa=b.characterData.substring(aa.u6.cp,aa.cpEnd),Ja=null===oa||void 0===oa?void 0:oa.trimStart();if(Ja){A=aa.u6.cp+(oa.length-
Ja.length);break}}if(-1===A)return{E1j:[],D1j:{Gd:-1,endCp:-1}};aa=-1;for(oa=h.length;0<oa;oa--){Ja=h[oa-1];const fb=b.characterData.substring(Ja.u6.cp,Ja.cpEnd),Cb=null===fb||void 0===fb?void 0:fb.trimEnd();if(Cb){aa=Ja.cpEnd-(fb.length-Cb.length);break}}return{E1j:null!==(r=h.slice(M,oa))&&void 0!==r?r:[],D1j:{Gd:A,endCp:aa}}}lhn(b,h){return null==b&&null==h&&b===h?!0:null==b||null==h?!1:h.linkedStyle&&b.linkedStyle&&h.linkedStyle.$Qb===b.linkedStyle.$Qb||h.Fw&&b.Fw&&h.Fw.B_h==b.Fw.B_h?!0:!1}jsm(b,
h){h=Wa.FormattingReader.bBa(h.formatting);b=this.lsm(b,h);h=this.ism(h);return b||h?{linkedStyle:b,Fw:h}:null}lsm(b,h){b=this.we.Aqb(h,b);if(!b)return null;h=b.ka(Mc.a.Lj,9);return this.qRj(h)?{B3p:b.id,$Qb:h+1}:null}ism(b){var h;b=this.we.ze(b);if(!b||!si.a.s2i(b))return null;const r=null!==(h=si.a.G2c(b))&&void 0!==h?h:"0";h=Number.parseInvariant(r);return this.v9c(h-1)?{B_h:b,$Qb:h}:null}wrn(b){const h=Gd.ParagraphReader.PVa(b);if(!this.v9c(h))return!1;if(this.qRj(h))return!0;b=this.we.Aq(b);
b=this.we.ze(b);return si.a.Roc(b)?!0:!1}qRj(b){return this.uTf&&this.v9c(b)}v9c(b){return b>=this.KUb&&b<=this.h2b}}Object(u.a)(IE,"StyleBasedDocumentHeadings",null,[382]);var TC=d(974);class OG{constructor(){this.startTime=0}}Object(u.a)(OG,"TocCallbackData",null,[]);class Du{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb){this.PLg=(Sb,pc,zc)=>{const Yc=pc.node;if(!Yc)return v.ULS.sendTraceTag(36705296,324,10,"Context node is null in UpdateTableOfContentsHandler."),2;if(12!==Yc.type)return v.ULS.sendTraceTag(36705297,
324,10,"Context node is not a paragraph in UpdateTableOfContentsHandler."),2;if(!Yc.zs)return 2;if(1===zc)return ec.SessionStatusManager.instance.Hk?8:32;this.Bd&&this.Bd.isFeatureEnabled(113)?this.bQc.$sp(Yc).then(Kd=>{Kd||this.T7j(Yc)}):this.T7j(Yc);return 32};this.Exp=Sb=>{Sb=window.performance.now()-Sb.startTime;v.ULS.sendTraceTag(574408796,3019,50,String.format("UpdateTOC Duration: {0} ms;",Sb));Sb=Object.assign(new bb.a,{durationMs:Sb});Ba.Health.instance.recordKpiSuccess(Du.Lak,Sb);Du.cfb()};
this.DRi=(Sb,pc,zc,Yc,Kd)=>{if(Gd.ParagraphReader.Vb(pc.node)&&pc.node.zs)return 2;if(1===zc)return ec.SessionStatusManager.instance.Hk?8:32;if(pc.contextId!==lc.a.Xc||this.xl.eba(pc)||!Gd.ParagraphReader.Vb(pc.node))return 32;this.Yd.Yu(17);(null===Kd||void 0===Kd?0:Kd.resolve)?this.bQc.d8h(pc,Kd.resolve):this.bQc.d8h(pc);return 32};this.Brg=(Sb,pc,zc)=>{Sb=pc.node;if(!Sb)return v.ULS.sendTraceTag(39358978,324,10,"Context node is null in RemoveTableOfContentsHandler."),2;if(12!==Sb.type)return v.ULS.sendTraceTag(39358979,
324,10,"Context node is not a paragraph in RemoveTableOfContentsHandler."),2;if(!Sb.zs)return 2;if(1===zc)return ec.SessionStatusManager.instance.Hk?8:32;zc=null;Sb.isConnected&&(zc=TC.a.Tjc(Sb,!0),zc.zzc(Sb));pc=new vd.a;pc.set(Sb);pc.vb(8);pc.ld(8);const Yc=this.Qc.Nc(15);Yc.mu(pc);this.bQc.ovo(Sb)?(Yc.dispose(),zc&&zc.normalize(),Du.cfb()):(zc&&zc.cancel(),Yc.dispose(),v.ULS.sendTraceTag(556565975,3019,10,"Failed to remove TOC."));return 32};this.ga=b;this.twd=h;this.Zc=A;this.Qc=M;this.xl=aa;
this.bQc=oa;this.Yd=Ja;this.Bd=fb;this.Qhh=Cb;this.nO=Gb}Xb(){this.ga.qa(ub.a.c2b,lc.a.paragraph,this.PLg);this.ga.qa(ub.a.c2b,lc.a.Cd,this.PLg);this.ga.qa(ub.a.c2b,lc.a.Xc,this.PLg);this.ga.Pc(ub.a.c2b,1028);this.ga.qa(Fc.a.XUf,lc.a.Xc,this.DRi);this.ga.Pc(Fc.a.XUf,1028);this.ga.qa(Fc.a.Tjd,lc.a.paragraph,this.Brg);this.ga.qa(Fc.a.Tjd,lc.a.Cd,this.Brg);this.ga.qa(Fc.a.Tjd,lc.a.Xc,this.Brg);this.ga.Pc(Fc.a.Tjd,1028)}T7j(b){Ba.Health.instance.recordKpiUsage(Du.Lak,1,Du.NB,null);const h=this.Xfm(b),
r=new OG;r.startTime=window.performance.now();this.twd.cKj(h,Mc.a.RKg,this.rNm(this.vBm(b)),this.Exp,null,r);this.bQc.eml()}rfk(b){if(null!=b&&b.zs)if(null==this.Qhh.instance)v.ULS.sendTraceTag(539628835,3019,10,"Page Number Finder instance is null.");else{var h=this.Qhh.instance.dCi();b=this.X6l(b);var r=!1;1===this.nO.Kw&&(r=!0);0!=b&&h!=b&&(h=[Object.assign(new ia.a,{name:"TOCPageNo",string:b}),Object.assign(new ia.a,{name:"HeadingPageNo",string:h}),Object.assign(new ia.a,{name:"isMainView",string:r})],
ac.a("TOCPageNoMismatch",!0,void 0,h))}}X6l(b){for(let h=0;h<b.ra.length;h++){const r=b.ra.K(h);if(null!=r.fc)for(let A=0;A<r.fc.length;A++){const M=r.fc.K(A);if(1===M.le&&M.tU.trim().startsWith("PAGEREF"))return parseInt(b.characterData.substr(r.cp,b.characterData.length-r.cp))}}return 0}vBm(b){return b?b.ka(Mc.a.cQ,null):(v.ULS.sendTraceTag(38638673,324,10,"Node is null in GetParaIdForUpdate."),null)}Xfm(b){return this.Zc.tsa(b,7,7).Ub(35)}rNm(b){const h=[];h.push(b+",TOC,0");return h}static cfb(){y.AFrameworkApplication.J&&
y.AFrameworkApplication.J.$("WordEditorTOCFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Za.a.instance.Ra(2);b&&b.execute(h=>{h.logActivity("InsertTOCInWordWeb","WordEditorTOCFloodgateIsEnabled")})},Du.Xza)}}Du.Xza=5E3;Du.Lak="WordUpdateTOC";Du.NB="wwaengidc";Object(u.a)(Du,"TableOfContentsActor",null,[278]);class Uq{}Object(u.a)(Uq,"FieldData",null,[]);class PG extends Uq{constructor(){super();this.Azb=null}}Object(u.a)(PG,"TOCFieldData",Uq,[]);class JE{constructor(b,h,r,A,M,aa=null){this.iYm=
b;this.wu=h;this.Ch=r;this.gXj=A;this.listMarker=M;this.Ota=aa}}Object(u.a)(JE,"TOCHeadingData",null,[]);class BJ{constructor(b,h){this.X1a=b;this.vp=h}async Sxi(b){this.X1a.uTf=b.vTf;this.X1a.KUb=b.KUb;this.X1a.h2b=b.h2b;return this.X1a.msm()}Igm(b){if(b=this.Hgm(b))return this.vp.DAa(b)}Hgm(b){const h=b.ra.length;for(let r=0;r<h;r++){const A=b.ra.K(r);if(A.hyperlink&&A.hyperlink.Ela&&A.hyperlink.url.startsWith(I.a.umb))return A.hyperlink.url.substr(A.hyperlink.url.indexOf("_Toc"))}return null}Wse(b){(b=
this.Igm(b))&&this.vp.qcg(b.id)}dKm(){return this.X1a.Qxi()}$sj(b,h){const r=new PG,A=new ib.a;for(const M of b){b=this.bKm(M,h);if(!b)return null;A.add(b)}r.Azb=A;return r}bKm(b,h){let r;if(h&&(r=this.DBl(b),!r))return v.ULS.sendTraceTag(591184344,3019,10,"Unable to create bookmark for Table of Contents"),null;h=Gn.AParagraphNode.dV(b.characterData.trim());const A=this.XLm(b.$Qb);return new JE(h,r,b.Ch,A,b.listMarker,b.Ota)}DBl(b){const h=String.format("{0}{1}","_Toc",$f.a.OF());return this.vp.sRc(h,
b.Ec,b.end,b.paragraphNode,b.paragraphNode)?h:null}XLm(b){return String.format("toc {0}",b)}}Object(u.a)(BJ,"TOCDataManager",null,[277]);class tB{ACg(){const b=Object.assign(new ni.StandardDialog,{Bu:y.AFrameworkApplication.Jfa,Fd:0,$Na:!1});b.gY(1);b.yna(WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogTitle,WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogMessage,()=>{})}static get instance(){return null!=tB.GYg?tB.GYg:tB.GYg=new tB}}Object(u.a)(tB,"TOCDialogHelper",null,[]);var oL=d(165),QG=d(503),
KE=d(239),Pg=d(148);class iv{constructor(b,h,r,A,M,aa,oa){this.BCg=b;this.Osb=h;this.vTf=r;this.KUb=A;this.h2b=M;this.CJb=aa;this.fsd=[];this.tU=oa}toString(){return"showPageNumber:"+this.BCg+"  isHyperlink:"+this.Osb+" includeOutlineLevels:"+this.vTf+" lowerOutlineLevel:"+this.KUb+" upperOutlineLevel:"+this.h2b+" addContentControl:"+this.CJb+" unsupportedSwitches:"+this.fsd.toString()}}Object(u.a)(iv,"TOCSettings",null,[]);class Xj{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc,zc,Yc,Kd,ke,ge,de){this.Olh=
"TOC";this.ppb=this.SNe=this.M$e=null;this.Qeb=b;this.Oh=h;this.ZE=r;this.$v=A;this.Vx=M;this.xl=aa;this.hb=oa;this.Qd=Ja;this.RGh=fb;this.Ke=Cb;this.K$e=Gb;this.Op=pc;this.KK=zc;this.wo=Yc;this.Qc=Kd;this.Gb=ke;this.qh=ge;this.jb=de}get r7c(){return this.Olh}set r7c(b){this.Olh=b}get Bzb(){this.M$e||(this.M$e=this.uvi());return this.M$e}uvi(){return new iv(!0,!0,!0,0,8,!0,this.ubo())}async d8h(b,h){ac.a(Xj.EIl);const r=window.performance.now();if(this.jb.Vb(b.node))if(this.xl.eba(b))v.ULS.shipAssertTag(592233794,
3019,!1,"We can't insert table of contents, current insertion point is in locked range"),Xj.WXa("IP is in locked range");else{var A=await this.Qeb.Sxi(this.Bzb);if(A){var M=new xc.a(2,1,0,()=>{this.GIl(b,A,this.Bzb.Osb,r);h&&h()});this.Gb.Zb(M)}else v.ULS.sendTraceTag(592233795,3019,10,"Failed to create table of contents."),Xj.WXa("Failed to get TOC data")}else v.ULS.shipAssertTag(592233793,3019,!1,"We can't insert table of contents, current context is not paragraph context"),Xj.WXa("Context should be paragraph")}GIl(b,
h,r,A=0){let M;try{if(0==A&&(A=window.performance.now()),this.Rli(b.node)){var aa=new vd.a;aa.set(b.node);aa.vb(7);aa.ld(7);M=this.Qc.Nc(15);M.mu(aa);var oa=this.Qeb.$sj(h,r);oa||Xj.WXa("Failed to prepare TOC Field data");var Ja=oa.Azb?oa.Azb.count:0;if(Ja){h=null;var fb;for(r=0;r<Ja;r++){const pc=oa.Azb.K(r);if(!({CMb:fb}=this.ARi(b,h,r,Ja,pc,Gb?Gb.toString():void 0)).returnValue){Xj.WXa("Failed to populate new TOC paragraph");return}if(0==r){var Cb=fb.currentNode;var Gb=Gd.ParagraphReader.nU(Cb)}h=
fb}if(this.Bzb.CJb&&!this.Srf(Cb.id,h.ko.id))Xj.WXa("Failed to add content control block");else{var Sb=window.performance.now()-A;ac.a(Xj.rtf,!0,Sb)}}else if(this.K$e.ACg(),this.dDl(b)){const pc=window.performance.now()-A;ac.a(Xj.rtf,!0,pc)}}else Xj.WXa("Failed to fetch style set")}catch(pc){Xj.WXa(String.format("{0} {1}",pc.message,pc.stack))}finally{M&&M.dispose()}}Rli(b){this.SNe=this.Vx.AF(b);return this.SNe?!0:(v.ULS.sendTraceTag(592233796,3019,15,"Failed to fetch style set"),!1)}static SLa(b){b=
[Object.assign(new ia.a,{name:Xj.Cxp,string:b})];ac.a(Xj.RLg,!1,void 0,b)}static L5f(b){b=[Object.assign(new ia.a,{name:Xj.$wo,string:b})];ac.a(Xj.FBj,!1,void 0,b)}static WXa(b){b=[Object.assign(new ia.a,{name:Xj.FIl,string:b})];ac.a(Xj.rtf,!1,void 0,b)}async $sp(b){const h=this.yGi(b);if(null==h)Xj.SLa("Cannot update TOC when firstTocPara = null");else{var r=this.fKm(h);if(0<r.fsd.length)return this.jDn(r.fsd),!1;ac.a(Xj.Bxp);var A=window.performance.now(),M=await this.Qeb.Sxi(r);if(!M)return v.ULS.sendTraceTag(559248668,
3019,10,"Failed to get data for TOC update."),Xj.SLa("Failed to fetch TOC data"),!1;b=new xc.a(1,1,0,()=>{this.Dxp(h,M,r,A)});this.Gb.Zb(b);return!0}}Dxp(b,h,r,A=0){let M;try{if(null==b)Xj.SLa("Attempt to update TOC when firstTocPara = null");else{0==A&&(A=window.performance.now());var aa=new vd.a;aa.set(b);aa.vb(7);aa.ld(7);M=this.Qc.Nc(15);M.mu(aa);var oa=this.Qeb.$sj(h,r.Osb);if(null==oa)Xj.SLa("Attempt to update TOC when tocFieldData = null");else{var Ja;if(({Omf:Ja}=this.$Aj(b,r)).response){v.ULS.sendTraceTag(559018207,
3019,50,String.format("Attempting to update TOC with settings: {0}",r.toString()));var fb=oa.Azb?oa.Azb.count:0;if(this.Rli(b)){var Cb;this.MZi(b)&&(this.EBj(b),(b=this.jb.xg(b,!1,!0))&&(Cb=b.ka(Mc.a.Yc,null).toString()));var Gb=b.ka(Mc.a.cQ,null);h=Gb;Cb=null!==Cb&&void 0!==Cb?Cb:Gb;if(fb){for(var Sb=0,pc;b.zs&&h==Gb&&Sb<fb;){const Kd=oa.Azb.K(Sb);r.Osb&&this.Qeb.Wse(b);if(!this.fxp(b,Sb,fb,Kd,r)){v.ULS.sendTraceTag(559248669,3019,10,"Failed to Update TOC Paragraph.");Xj.SLa("Failed to update TOC paragraph");
return}b.setValue(Mc.a.cQ,Cb);Sb++;pc=b;b=this.jb.xg(pc,!1,!0);if(!b){h=null;break}this.UZi(b)&&this.DBj(b);h=b.ka(Mc.a.cQ,null)}h==Gb&&this.qrg(b);var zc;if(({T1f:zc}=this.BWk(oa,Sb,fb,pc,Cb)).response)if(r.CJb&&!this.Srf(Ja,zc.id))Xj.SLa("Failed to add content control block");else{var Yc=window.performance.now()-A;ac.a(Xj.RLg,!0,Yc)}else Xj.SLa("Failed to add new paragraph")}else this.K$e.ACg(),this.yxp(b,r.CJb,Ja,r.tU,Cb)&&(Sb=window.performance.now()-A,ac.a(Xj.RLg,!0,Sb))}else Xj.SLa("Failed to fetch style set")}else Xj.SLa("Failed to remove Content Control")}}}catch(Kd){Xj.SLa(String.format("{0} {1}",
Kd.message,Kd.stack))}finally{M&&M.dispose()}}BWk(b,h,r,A,M){let aa=new vd.a;for(aa.set(A);h<r;){A=b.Azb.K(h);if(!({CMb:A}=this.ARi(null,aa,h,r,A,M)).returnValue)return{T1f:aa.currentNode,response:!1};aa=A;h++}return{T1f:aa.currentNode,response:!0}}$Aj(b,h){var r;let A,M;const aa=null===(r=null===b||void 0===b?void 0:b.ra)||void 0===r?void 0:r.first.Hb;if(aa&&0<aa.length)if(b=b.ra.first.Hb.K(0),b.fg){r=b.Wd.getValue(Mc.a.Hw);A=this.qh.hr(b.Wd.id,!0);M=this.qh.hr(b.Wd.id,!1);if(0!=this.Op.RYb(r))return v.ULS.sendTraceTag(558952907,
3019,10,"Failed to release content control"),{response:!1,Omf:A,YZh:M};h.CJb=!0}else v.ULS.sendTraceTag(528537613,3019,15,"Content control is not block type"),h.CJb=!1;else h.CJb=!1;return{response:!0,Omf:A,YZh:M}}yxp(b,h,r,A,M){v.ULS.sendTraceTag(559018209,3019,50,"Updating old TOC to empty TOC");this.Qeb.Wse(b);const aa=this.Q4d(b);if(!this.hsj(aa,h,r,A))return Xj.SLa("Failed to populate empty TOC."),!1;if(h=this.jb.xg(b,!1,!0))r=b.ka(Mc.a.cQ,null),A=h.ka(Mc.a.cQ,null),r==A&&this.qrg(h);b.setValue(Mc.a.cQ,
M);return!0}hsj(b,h,r,A){this.Qd.Ve(b,WordEditorIntl.WordEditorStrings.L_EmptyTOCText);b=b.node;this.xdj(b);const M=b.ra.first;this.Ke.JN(M.formatting,!0);this.bsf(b,0,1,A);M.HAg&&b.se.Gq.Z(M.formatting.pe,gv.CharacterPropertiesEditor.yN);return h&&r&&!this.Srf(r,b.id)?!1:!0}Q4d(b){b.ra.reset();b.OTa();const h=new oL.a(b,0);h.formatting=new Pg.a(h,N.a.nil);h.ni=!0;b.ra.add(h);return wc.a.createTextRange(b,0,b.characterData.length)}MZi(b){if(Gd.ParagraphReader.CR(b)){var h=b.ra.last.fc;if(!h||!h.length)return!1;
if(4<=h.length){b=0===h.K(h.length-4).le;const r=1===h.K(h.length-3).le&&h.K(h.length-3).tU.trim().startsWith(this.r7c),A=2===h.K(h.length-2).le;h=5===h.K(h.length-1).le;return b&&r&&A&&h}}return!1}UZi(b){if(Gd.ParagraphReader.CR(b)){var h=b.ra.first.fc;if(!h||!h.length)return!1;if(2<=h.length)return b=4===h.K(0).le,h=3===h.K(1).le,b&&h}return!1}EBj(b){const h=b.ra.last.fc,r=h.K(h.length-4),A=h.K(h.length-3),M=h.K(h.length-2),aa=h.K(h.length-1);h.remove(r);h.remove(A);h.remove(M);h.remove(aa);b.removeProperty(Mc.a.cQ)}DBj(b){const h=
b.ra.first.fc,r=h.K(0),A=h.K(1);h.remove(r);h.remove(A);b.removeProperty(Mc.a.cQ)}qrg(b){if(b){var h=b.ka(Mc.a.cQ,null),r=b.ka(Mc.a.Yc,null).toString(),A=h;r==h&&this.MZi(b)&&(this.EBj(b),(b=this.jb.xg(b,!1,!0))&&(A=b.ka(Mc.a.cQ,null)));r=new vd.a;r.set(b);r.vb(8);v.ULS.sendTraceTag(559018210,3019,50,"Attempting to remove TOC paragraphs");for(var M;b&&b.zs&&A==h&&M!=b;){if(this.UZi(b)){this.DBj(b);break}this.Qeb.Wse(b);this.wo.je(r);A=this.wo.Zs(r,!1,!0);this.Oh.mNa(b);if(!A)return null;M=b;r.Ub(2);
A=(b=r.currentNode)?b.ka(Mc.a.cQ,null):null}return b}}fKm(b){var h=b.ra,r=h?h.length:0,A=null;b=new iv(!0,!1,!1,0,8,!0,void 0);for(let M=0;M<r&&(A=this.eKm(h.K(M)),b.tU=A,A=this.aHm(A),A[0]!==this.r7c);M++);h=A?A.length:0;for(r=1;r<h;r++)switch(A[r]){case "\\h":b.Osb=!0;break;case "\\u":b.vTf=!0;break;case "\\o":this.GTo(A[r+1],b)&&r++;break;case "\\z":break;case "\\n":b.BCg=!1;b.fsd.push(A[r]);break;default:b.fsd.push(A[r])}return b}GTo(b,h){return b&&(b=b.match(RegExp('^"([0-9])-([0-9])"$')))&&
3===b.length?(h.KUb=Number.parseInvariant(b[1])-1,h.h2b=Number.parseInvariant(b[2])-1,!0):!1}ovo(b){try{ac.a(Xj.Zwo);const h=window.performance.now(),r=this.yGi(b);if(null==r){Xj.L5f("Attempt to remove TOC when firstTocPara = null");return}let A,M,aa;const oa=this.uvi();if(!({Omf:A,YZh:M}=this.$Aj(r,oa)).response)return Xj.L5f("Failed to remove content control"),!1;if(void 0==A&&void 0==M)aa=this.qrg(r);else{aa=r.Ic.Eb(A);const fb=new vd.a;fb.set(aa);fb.vb(8);b=!1;let Cb;for(;!b&&aa&&Cb!=aa;){aa.id.equals(M)&&
(b=!0);aa&&aa.zs&&this.Qeb.Wse(aa);this.wo.je(fb);const Gb=this.wo.Zs(fb,!1,!0);this.Oh.mNa(aa);if(!Gb){aa=null;break}fb.Ub(2);Cb=aa;aa=fb.currentNode}}aa&&this.Qcd(aa);const Ja=window.performance.now()-h;ac.a(Xj.FBj,!0,Ja)}catch(h){Xj.L5f(String.format("{0} {1}",h.message,h.stack))}return!0}Qcd(b){b=wc.a.Tc(b,0);b=new Er.Selection([b],!0);this.hb.Kc(b)}Srf(b,h){return this.Op.xqa(b,h,null,Xj.Ufi,!0,11).returnValue?(v.ULS.sendTraceTag(573653840,3019,10,"Failed to create content control block for table of contents."),
!1):!0}eml(){this.Qeb.dKm()||this.K$e.ACg()}yGi(b){if(!b.zs)return v.ULS.sendTraceTag(528320659,3019,15,"Cannot get TOC Begin Paragraph. Para is not in TOC"),null;b=b.ka(Mc.a.cQ,null);return this.KK.HBm(b)}jDn(b){b.length&&(b=[Object.assign(new ia.a,{name:"UnsupportedSwitches",string:b.toString()})],ac.a("UnsupportedTocInstruction",void 0,void 0,b))}eKm(b){const h=(b=b.fc)?b.length:0;for(let r=0;r<h;r++)if(1===b.K(r).le&&b.K(r).tU.trim().startsWith(this.r7c))return b.K(r).tU.trim();return null}aHm(b){const h=
[];if(!b)return h;b=b.split(" ");return b.length?b:h}dDl(b){b=this.F9h(b,null,!0,void 0).returnValue;if(!b)return Xj.WXa("Failed to create paragraph"),!1;const h=wc.a.Tc(b,0);if(!this.hsj(h,!0,b.id,this.Bzb.tU))return Xj.WXa("Failed to populate empty TOC"),!1;v.ULS.sendTraceTag(575447938,3019,50,"Created an empty table of contents.");return!0}F9h(b,h,r,A){let M,aa;r&&b?(M=this.tDl(b),aa=M.currentNode,A=Gd.ParagraphReader.nU(aa).toString()):h&&(M=this.wym(h),aa=this.Oh.bL(M));if(!aa)return v.ULS.sendTraceTag(592233798,
3019,15,"Failed to insert paragraph for table of contents"),{returnValue:null,CMb:M};aa.setValue(Mc.a.cQ,A);return{returnValue:aa,CMb:M}}ubo(){const b=new Sys.StringBuilder(this.r7c);b.append(" \\o \\z \\u");b.append(" \\h");return b.toString()}Jbo(b){const h=new Sys.StringBuilder("PAGEREF ");h.append(b);this.Bzb.Osb&&h.append(" \\h");return h.toString()}wym(b){b.Kd();this.wo.je(b);return this.Oh.Vsa(b,!1)}tDl(b){const h=new vd.a;h.set(b.node);h.Kd();this.wo.je(h);let r=this.UAi(h);const A=!b.cpBegin;
if(Db.OutlineElementReader.isEmpty(h,!0))return this.kRi(r);if(A)return this.Oh.SA(r,!0,!1),this.Oh.xca(h,r,b,!1,!1,!1),b=this.UAi(r),this.kRi(b);r=this.Oh.Vsa(h);this.Oh.xca(h,r,b,!1,!1,!0);b=this.Oh.Vsa(h);this.Oh.C_b(b.currentNode,!1);this.Oh.bL(b);this.wo.Me(b);return b}UAi(b){const h=new vd.a;h.hd(b);h.Kd();return h}kRi(b){this.Oh.SA(b,!0,!0);this.Oh.C_b(b.currentNode,!1);this.wo.Me(b);return b}xdj(b){const h=b.ra;1===h.length&&(h.first.ni=!1,b.p0d().ni=!0)}fxp(b,h,r,A,M){const aa=this.Q4d(b);
this.Qd.Ve(aa,"");this.osj(b,A,M);this.bsf(b,h,r,M.tU);return M.Osb&&!this.qF(b,A.wu)?!1:!0}ARi(b,h,r,A,M,aa){h=({CMb:b}=this.F9h(b,h,0==r,aa)).returnValue;if(!h)return{returnValue:!1,CMb:b};this.osj(h,M,this.Bzb);this.bsf(h,r,A,this.Bzb.tU);return this.Bzb.Osb&&!this.qF(h,M.wu)?{returnValue:!1,CMb:b}:{returnValue:!0,CMb:b}}osj(b,h,r){this.p7m(b,h.iYm,h.listMarker,h.gXj,h.Ota);this.RGh.W8m(b,b.characterData.length);r.BCg&&this.m8m(b,h);this.xdj(b);this.eWo(b,h.gXj)}Yvm(b,h){if(!b)return 0;const r=
Xj.YLm();return 4<b.length?r.K(h)+.5*Math.floor(b.length/3):r.K(h)}p7m(b,h,r,A,M){r&&this.H7m(b,r,A);r=wc.a.Tc(b,b.characterData.length);this.Qd.Ve(r,h);M&&(b=b.ra.sh(0),this.Ke.cha(b.formatting,M))}H7m(b,h,r){r=this.Yvm(h,r);const A=wc.a.Tc(b,0);this.Qd.Ve(A,h);this.RGh.I7m(b,h.length,r)}m8m(b,h){var r=wc.a.Tc(b,b.characterData.length);this.Qd.Ve(r,h.Ch.toString());r=b.ra.sh(b.characterData.length-h.Ch.toString().length);h=this.Jbo(h.wu);this.EWa(b,r,0,2,h);this.EWa(b,r,1,2,h);this.EWa(b,r,2,2,h);
r=b.ra.sh(b.characterData.length);this.EWa(b,r,3,2,h)}eWo(b,h){h=this.SNe.lh(h);this.$v.WP(h,b,!0)}bsf(b,h,r,A){const M=b.ra.first,aa=b.ra.last;h?this.EWa(b,M,4,1,A):(this.EWa(b,M,0,1,A),this.EWa(b,M,1,1,A),this.EWa(b,M,2,1,A));h===r-1?this.EWa(b,aa,3,1,A):this.EWa(b,aa,5,1,A)}EWa(b,h,r,A,M=null){r=new QG.a(h,null,r,A,!0,!1,!1,M);h.fc||(h.fc=new KE.a(h));h.fc.add(r);b.Ml();this.iJl(r,b)}iJl(b,h){b.pe?h.se.mX(b.pe-1,2):h.se.Tsa(b.pe,2);h.se.Gq.Z(b.pe,gv.CharacterPropertiesEditor.yN);h.se.Lt.Z(b.pe,
gv.CharacterPropertiesEditor.YR)}qF(b,h){b=wc.a.createTextRange(b,0,b.characterData.length);return this.ZE.qF(b,h,!1,!1,!1,!0)?!0:(v.ULS.sendTraceTag(592233799,3019,50,"Failed to create hyperlink for table of contents entries"),!1)}static YLm(){Xj.uya||(Xj.uya=new cb.a,Xj.uya.Z("toc 1",1),Xj.uya.Z("toc 2",1.5),Xj.uya.Z("toc 3",2),Xj.uya.Z("toc 4",2.5),Xj.uya.Z("toc 5",3),Xj.uya.Z("toc 6",3.5),Xj.uya.Z("toc 7",4),Xj.uya.Z("toc 8",4.5),Xj.uya.Z("toc 9",5));return Xj.uya}}Xj.uya=null;Xj.Ufi="Table of Contents";
Xj.EIl="CreateTocClient";Xj.rtf="CreateTocSuccess";Xj.FIl="CreateTocFailureCause";Xj.Bxp="UpdateTocClient";Xj.RLg="UpdateTocSuccess";Xj.Cxp="UpdateTocFailureCause";Xj.Zwo="RemoveTocClient";Xj.FBj="RemoveTocSuccess";Xj.$wo="RemoveTocFailureCause";Object(u.a)(Xj,"TOCField",null,[275,276]);var uB=d(628);class LE{constructor(b,h){this.DFa=b;this.GPa=h}W8m(b,h){if(Gd.ParagraphReader.Vb(b)&&!(0>h)){var r=br.a.Odc(b);r=new uB.a(r,4,1,1);this.DFa.Vae(b,r);b=wc.a.Tc(b,h);this.GPa.hbe(b)}}I7m(b,h,r){var A=
kl.a.YQ/2;const M=b.ra.T8a(h);A=Wa.FormattingReader.nj(M.formatting,He.a.fontSize,2*A)/2;r=new uB.a(Jg.a.gD(A/36)*r,1,0,1);this.DFa.Vae(b,r);b=wc.a.Tc(b,h);this.GPa.hbe(b)}}Object(u.a)(LE,"TOCTabUtility",null,[272]);class Jp{constructor(){this.W=null}get name(){return"WordEditor.TableOfContents"}uc(b){this.W=b;this.W.ia(955,()=>new Uz.a(this.W.resolve(292),hv.a.fU)).ha();this.W.ia(927,()=>new IE(new Qf.a(()=>qa.StaticActiveAppFrame.za().kb.$c),Object(vo.a)(),this.W.resolve(8),this.W.resolve(10),this.W.resolve(244),
new qr.a,this.W.resolve(114).Hra)).as(485).ha();this.W.ia("WordEditor.TableOfContents.TOCDataManager",()=>new BJ(this.W.resolve(485),this.W.resolve(454))).as(952).ha();this.W.ia("WordEditor.TableOfContents.TOCTabUtility",()=>new LE(this.W.resolve(950),this.W.resolve(951))).as(953).ha();this.W.ia("WordEditor.TableOfContents.TOCField",()=>new Xj(this.W.resolve(952),this.W.resolve(18),this.W.resolve(82),this.W.resolve(392),this.W.resolve(8),re.a.instance,this.W.resolve(326),this.W.resolve(322),this.W.resolve(953),
this.W.resolve(101),tB.instance,this.W.resolve(12),this.W.resolve(954),this.W.Oa(440),this.W.resolve(197),Qn.a.instance,y.AFrameworkApplication.oc,this.W.resolve(198),b.resolve(164))).as(956).ha();this.W.ia("WordEditor.TableOfContents.TableOfContentsActor",()=>new Du(y.AFrameworkApplication.va,this.W.resolve(955),this.W.resolve(18),this.W.resolve(292),Qn.a.instance,re.a.instance,this.W.resolve(956),this.W.resolve(46).instance,this.W.resolve(12),this.W.Ra(484),b.resolve(76))).as(94).ha()}init(){this.W.resolve(94).Xb()}dispose(){}}
Object(u.a)(Jp,"PackageManager",null,[0,1]);class Cn{constructor(b,h,r,A,M,aa,oa,Ja){this.nZa=(fb,Cb,Gb,Sb,pc)=>{if(!({Iz:fb}=this.syb(Cb,Gb,pc,!0,!0)).returnValue)return fb;this.rNd.N8h(pc,Cb.node);return 32};this.kDa=(fb,Cb,Gb,Sb,pc)=>this.nLi(Cb,Gb,Sb,pc,!0);this.rXb=(fb,Cb,Gb,Sb,pc)=>{if(!({Iz:fb}=this.syb(Cb,Gb,pc,!1,!0)).returnValue)return fb;this.rNd.lFl(pc,Cb.node);v.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32};this.Gqa=(fb,Cb,Gb,Sb,pc)=>{if(!({Iz:Sb}=this.syb(Cb,Gb,pc,!1,
!0)).returnValue)return 2==Gb&&8==Sb&&Lr.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],nf.a.ZNb),Sb;const zc=Cb.node;let Yc=null;(Yc=fb===ub.a.Gqa?this.rNd.I2b(pc[Vg.a.SourceControlId],zc):this.Jy.m8d(zc,pc))?(this.$oe(zc,()=>{this.kPd.H_b(Yc,zc)}),this.rM(),Sb=32):(Lr.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],nf.a.ZNb),Sb=8);fb===ub.a.Gqa&&32===Sb&&v.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");v.ULS.shipAssertTag(0,
324,32===Sb);return Sb};this.Yya=(fb,Cb,Gb,Sb,pc)=>this.nLi(Cb,Gb,Sb,pc,!1);this.eBe=(fb,Cb,Gb,Sb,pc)=>Sq.a.xua(fb,Cb,Gb,Sb,pc,{},14);this.tLb=(fb,Cb,Gb,Sb,pc)=>{if(!({Iz:fb}=this.syb(Cb,Gb,pc,!1,!1)).returnValue)return fb;const zc=Cb.node;this.$oe(zc,()=>{this.kPd.dql(zc)});return 32};this.Jy=b;this.rNd=h;this.ga=r;this.kPd=A;this.Qc=M;this.pB=aa;this.fAk=Ja}Xb(){this.uuc(df.a.V_a.n8h())}uuc(b){this.ga.qa(ub.a.nZa,lc.a.view,b);this.ga.qa(ub.a.nZa,lc.a.table,this.nZa);this.ga.Pc(ub.a.nZa,1127);this.ga.qa(ub.a.Gqa,
lc.a.view,this.eBe);this.ga.qa(ub.a.Gqa,lc.a.table,this.Gqa);this.ga.Pc(ub.a.Gqa,1030);this.ga.qa(ub.a.vT,lc.a.table,this.Gqa);this.ga.qa(ub.a.Yya,lc.a.view,this.eBe);this.ga.qa(ub.a.Yya,lc.a.table,this.Yya);this.ga.Pc(ub.a.Yya,1038);this.ga.qa(ub.a.kDa,lc.a.view,b);this.ga.qa(ub.a.kDa,lc.a.table,this.kDa);this.ga.Pc(ub.a.kDa,1127);this.ga.qa(ub.a.rXb,lc.a.view,b);this.ga.qa(ub.a.rXb,lc.a.table,this.rXb);this.ga.Pc(ub.a.rXb,1126);this.ga.qa(ub.a.tLb,lc.a.view,this.eBe);this.ga.qa(ub.a.tLb,lc.a.table,
this.tLb);this.ga.Pc(ub.a.tLb,1028)}rM(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Za.a.instance.Ra(2);b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}nLi(b,h,r,A,M){if(!({Iz:aa}=this.syb(b,h,A,M,!0)).returnValue)return 2==h&&8==aa&&Lr.a.recordQosError("TableStyleOptionButtonClickNoResponse",["TableInteractionFailed"],nf.a.l3l),aa;b=b.node;h=
this.Jy.P2(b);var aa=A[Vg.a.On];const oa=Cn.zKm(A.MenuItemId);M?A[Vg.a.On]=Cn.e1o(h,oa):(this.X6k(h,oa,aa,b),r.Bt=oa,r.eE=aa?0:1,v.ULS.shipAssertTag(0,324,!!oa));return 32}$oe(b,h){const r=this.Qc.Nc(15);try{r.Bb(b),this.pB.dxb(),h()}finally{r&&r.dispose()}}syb(b,h,r,A,M){return this.Epn(b,h,r,A,M)?{returnValue:A||2===h,Iz:32}:{returnValue:!1,Iz:8}}Epn(b,h,r,A,M){if(b.contextId!==lc.a.table)return!1;if(A||2===h)if(M&&!r||!Object(Xa.a)(ft.TableNode,b.node)||this.fAk(b.node))return!1;return!0}X6k(b,
h,r,A){const M=(512===h||1024===h?!r:r)?b|h:b&~h;M!==b&&this.$oe(A,()=>{this.kPd.VDa(M,A)})}static QE(){Cn.Ykb[Cn.f8l]=32;Cn.Ykb[Cn.X7l]=128;Cn.Ykb[Cn.Rtn]=64;Cn.Ykb[Cn.Htn]=256;Cn.Ykb[Cn.E$k]=512;Cn.Ykb[Cn.D$k]=1024}static e1o(b,h){b=!!(b&h);if(512===h||1024===h)b=!b;return b}static zKm(b){let h=0;b in Cn.Ykb&&(h=Cn.Ykb[b]);return h}}Cn.f8l="buttonFirstRow";Cn.X7l="buttonFirstColumn";Cn.Rtn="buttonLastRow";Cn.Htn="buttonLastColumn";Cn.E$k="buttonBandedRow";Cn.D$k="buttonBandedColumn";Cn.Ykb={};Object(u.a)(Cn,
"TableStyleActor",null,[]);Cn.QE();var gy=d(413);class Dt extends gy.a{constructor(){super();this.TableStyles=this.TableCellStyles=null;this.columns=0}}Object(u.a)(Dt,"TableGalleryButtonProps",gy.a,[]);class $y extends Dt{constructor(){super()}get Type(){return 6}}Object(u.a)($y,"TableStyleGalleryButtonProps",Dt,[]);class Vz{}Vz.FOn=2147483647;Object(u.a)(Vz,"TableStyleUtil",null,[]);class Ds{constructor(b,h,r){this.$nf="Clear";this.WNb=null;this.pNk=b;this.we=h;this.Jy=r;this.xfa=y.AFrameworkApplication.xfa;
this.Ss=y.AFrameworkApplication.Ss}U7a(){}CUk(b,h){this.U7a(b);const r=this.Dri(b),A=r.length;if(!(0>=A)){var M=Vz.FOn,aa=null;for(let fb=0;fb<A;fb++){var oa=r[fb],Ja=this.Jy.RKm(oa);M!==Ja&&(M=Object.assign(new te.a,{Id:"msMoreTableStyles"+Ja,Title:this.SKm(Ja),ControlList:[]}),aa=Object.assign(new Mo.a,{Type:6,Id:"galleryMoreTableStyles"+Ja,ExternalGalleryId:"TableStylesGallery",Width:Ds.WEg,ElementDimensions:"Size64by48",GalleryItems:[]}),this.WNb&&(aa.ExternalId=this.WNb[Ja.toString()]),M.ControlList.push(aa),
h.MenuSectionList.push(M),M=Ja);Ja=this.we.xL(oa);oa=Ds.pGg+fb;Ja=Object.assign(new $y,{Id:oa,ExternalId:oa,Command:ub.a.Gqa.toString(),QueryCommand:ub.a.nZa.toString(),LabelText:Ja?I.a.Jf(Ja):"",Alt:Ja,VerticalCenterAlign:"true"});Ja.TableCellStyles=this.t8d(oa,b);Ja.TableStyles=this.V3c(oa,b);aa&&aa.GalleryItems.push(Ja)}}}BUk(b){const h=Object.assign(new te.a,{Id:"msMoreTableStyleCommands",DisplayMode:"Menu16",ControlsId:"ctrlMoreTableStyleCommands",ControlList:[]}),r=Object.assign(new hk.a,{Id:"fseaClearTableFormatting",
Command:ub.a.tLb.toString(),LabelText:I.a.Jf(this.$nf),Alt:I.a.Jf(this.$nf),Image16by16:this.Ss,Image16by16Class:Gg.getImageClassWithCluster(this.xfa,Ds.cql),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});h.ControlList.push(r);b.MenuSectionList.push(h)}N8h(b,h){this.U7a(h);const r=b[Vg.a.SourceControlId];var A=this.I2b(r,h);if(A){var M=this.Jy.VG(h);M=M?this.we.ze(M):null;var aa=this.we.xL(A);A=this.we.ze(A);b[Pd.a.Alt]=aa;b[Pd.a.On]=A===M;h=Object.assign(new $y,{Id:r,ExternalId:r,Command:ub.a.Gqa.toString(),
QueryCommand:ub.a.nZa.toString(),TableCellStyles:this.t8d(r,h),TableStyles:this.V3c(r,h),Alt:aa});b[Pd.a.GalleryButtonProps]=h}else b[Pd.a.InnerHTML]=null,b[Pd.a.Alt]=null,b[Pd.a.On]=!1,b[Pd.a.GalleryButtonProps]=null}t8d(b,h){this.U7a(h);return(b=this.I2b(b,h))?this.pNk.fti(b,h):null}V3c(b,h){this.U7a(h);return this.I2b(b,h),null}lFl(b,h){b.MenuItems=this.Rxm(h)}Rxm(b){const h=Object.assign(new aj.a,{Id:"menuMoreTableStyles",MenuSectionList:[]});this.CUk(b,h);this.BUk(h);return h}I2b(b,h){return b?
b.startsWith(Ds.pGg)?this.KOf(parseInt(b.substr(Ds.pGg.length)),h):this.KDo(parseInt(b.substr(Ds.mep.length)),h):null}}Ds.pGg="buttonTableStyleMenu";Ds.mep="buttonTableStyleRibbon";Ds.WEg=7;Ds.cql="ClearTableStyle_16x16x32";Object(u.a)(Ds,"ATableStyleRibbonControl",null,[385]);class Wz extends Ds{constructor(b,h,r){super(null,h,r);this.VFh=b}N8h(b,h){this.U7a(h);const r=b[Vg.a.SourceControlId];var A=this.I2b(r,h);if(A){var M=this.Jy.VG(h);M=M?this.we.ze(M):null;var aa=this.we.xL(A);A=this.we.ze(A);
b[Pd.a.Alt]=aa;b[Pd.a.On]=A===M;h=Object.assign(new $y,{Id:r,ExternalId:r,Command:ub.a.Gqa.toString(),QueryCommand:ub.a.nZa.toString(),TableCellStyles:this.t8d(r,h),TableStyles:this.V3c(r,h),Alt:aa});b[Pd.a.GalleryButtonProps]=h}else b[Pd.a.InnerHTML]=null,b[Pd.a.Alt]=null,b[Pd.a.On]=!1,b[Pd.a.GalleryButtonProps]=null}t8d(b,h){this.U7a(h);return(b=this.I2b(b,h))?this.VFh.fti(b,h,5,5):null}V3c(b,h){this.U7a(h);return this.I2b(b,h),null}}Object(u.a)(Wz,"ATableStyleRibbonControlVariableSizePreviews",
Ds,[]);var ww=d(1344),Qv=d(1091);class fs{constructor(b,h,r,A){this.Zgm=(M,aa)=>this.getBorder(M,this.W4.bP(aa));this.Ygm=(M,aa)=>this.getBorder(M,this.W4.sR(aa));this.Vx=b;this.Ez=h;this.tIb=r;this.W4=A;this.gnk=new Qf.a(()=>this.Xgm());this.Ggb=new Qf.a(()=>this.Wgm())}Xgm(){const b={},h=y.AFrameworkApplication.isRtl;b.top="border-top";b.left=h?"border-right":"border-left";b.bottom="border-bottom";b.right=h?"border-left":"border-right";b.insideHorizontal="border-bottom";b.insideVertical=h?"border-left":
"border-right";return b}Wgm(){const b={};b[pi.a.hza]=pi.a.Amb;b[pi.a.Amb]=pi.a.Amb;b[pi.a.Y5a]=pi.a.Y5a;return b}dCl(b,h,r,A){const M=new Qv.a;M.rowCount=r;M.inb=A;M.K_a=this.tIb.WJm(b);M.Ja=b.ka(Mc.a.Ja,1);M.Ia=b.ka(Mc.a.Ia,1);M.tableLook=h;M.ZAe=1;return M}fti(b,h,r,A){if(!this.Vx.ze(b)||!Object(Xa.a)(179,b)||!Object(Xa.a)(bs.a,h))return null;const M=this.Ez.P2(h);r=this.dCl(b,M,r,A);A=[];for(r.rowIndex=0;r.rowIndex<r.rowCount;r.rowIndex++)this.RWk(b,h,r,A);return A}V3c(){return null}Cla(){}RWk(b,
h,r,A){r.$lc=!r.rowIndex;for(r.cellIndex=0;r.cellIndex<r.inb;r.cellIndex++)this.$Sk(b,h,r,A)}$Sk(b,h,r,A){h=this.tIb.gvl(r,this.tIb.VGf(r),h,b);const M={};var aa=this.Ez.LGf(b,h,He.a.fontColor,!0,Gj.a.nR(),"None");M.color=aa?aa:"inherit";aa=this.Ez.LGf(b,h,He.a.VK,!0,Gj.a.nR(),"None");M["background-color"]=aa?aa:"inherit";this.tXk(r,b,h,M);A.push(M)}tXk(b,h,r,A){b=this.tIb.qVa(b);this.iQd(5,b,h,r,A);this.iQd(3,b,h,r,A);this.iQd(0,b,h,r,A);this.iQd(4,b,h,r,A)}iQd(b,h,r,A,M){h=this.dom(b,h,r,A);h!==
pi.a.MH&&(M[this.gnk.value[ww.a[b]]]=h)}dom(b,h,r,A){let M=pi.a.MH;if(({Rqa:M}=this.NOa(A,b,1,h,this.Ygm,M)).returnValue)return M;({Rqa:M}=this.NOa(r,b,3,h,this.Zgm,M));return M}NOa(b,h,r,A,M,aa){return this.W4.HQj(r,h,A)&&(aa=M(b,h))!==pi.a.MH||!h&&({Rqa:aa}=this.NOa(b,1,r,A,M,aa)).returnValue||4===h&&({Rqa:aa}=this.NOa(b,2,r,A,M,aa)).returnValue?{returnValue:!0,Rqa:aa}:{returnValue:aa!==pi.a.MH,Rqa:aa}}getBorder(b,h){let r="",A,M;({borderStyle:A,borderWidth:M}=this.chm(b,h));if(A===pi.a.Y5a)return r;
r=String.format(pi.a.SSd,M,A,this.Pgm(b,h));return r.trim()}Pgm(b,h){if(!h)return pi.a.g2;b=this.Ez.y_c(b,h.color,Ol.a.auto);return b!==Ol.a.auto?Ol.a.BB(b):pi.a.g2}chm(b,h){var r=pi.a.gza;let A=pi.a.NH+pi.a.wdc;if(!h)return{borderStyle:r,borderWidth:A};r=this.Ez.y_c(b,h.style,pi.a.Y5a);b=this.Ez.y_c(b,h.size,pi.a.NH);A=this.$gm(r,b)+pi.a.wdc;r=this.Rgm(r);return{borderStyle:r,borderWidth:A}}$gm(b,h){let r=2;b===pi.a.FKb&&h<pi.a.T$&&(r=1);return r}Rgm(b){return this.Ggb.value[b]||pi.a.udc}static VKm(){return new fs(Za.a.instance.resolve(8),
Za.a.instance.resolve(458),Uu.a.instance,pi.a.instance)}static get instance(){return null!=fs.PXg?fs.PXg:fs.PXg=fs.VKm()}}Object(u.a)(fs,"TableStylePreviewGenerator",null,[386]);var xw;(function(b){b[b.NQp=0]="background1";b[b.ekq=1]="text1";b[b.OQp=2]="background2";b[b.fkq=3]="text2";b[b.accent1=4]="accent1";b[b.accent2=5]="accent2";b[b.accent3=6]="accent3";b[b.accent4=7]="accent4";b[b.accent5=8]="accent5";b[b.accent6=9]="accent6";b[b.hyperlink=10]="hyperlink";b[b.yYp=11]="followedHyperlink";b[b.$Tp=
12]="dark1";b[b.p3p=13]="light1";b[b.aUp=14]="dark2";b[b.q3p=15]="light2";b[b.none=16]="none";b[b.max=17]="max"})(xw||(xw={}));Object(u.b)("ThemeColor",xw);class hy{constructor(b){this.R8b=b}Vem(b,h,r){let A;({Kwj:h,oUh:A}=this.UEm(h));b=[];const M=[];for(let oa=0;16>oa;oa++){if(!(xw[oa]in r.DIb))continue;const Ja=oa,fb=String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,WoncaIntl.WoncaStrings[A[Ja]],this.Num(oa));var aa=h[Ja];aa=aa&4278190080|(aa&255)<<16|aa&65280|(aa&16711680)>>>16;M.push(Object.assign(new Qm,
{Color:Ja.toString(),DisplayColor:"#"+I.a.IJ(aa,6),Alt:I.a.Jf(fb)}));b[b.length]=oa}return{returnValue:M,tgp:b}}Num(b){switch(b){case 0:return Box4Intl.Box4Strings.l_ThemeLabel1;case 1:return Box4Intl.Box4Strings.l_ThemeLabel2;case 2:return Box4Intl.Box4Strings.l_ThemeLabel3;case 3:return Box4Intl.Box4Strings.l_ThemeLabel4;case 4:return Box4Intl.Box4Strings.l_ThemeLabel5;case 5:return Box4Intl.Box4Strings.l_ThemeLabel6;case 6:return Box4Intl.Box4Strings.l_ThemeLabel7;case 7:return Box4Intl.Box4Strings.l_ThemeLabel8;
case 8:return Box4Intl.Box4Strings.l_ThemeLabel9;case 9:return Box4Intl.Box4Strings.l_ThemeLabel10;default:return""}}UEm(b){let h=null,r=null;b=this.R8b(b);if(!b)return{Kwj:h,oUh:r};h=b.properties.ka(Mc.a.Leb,null);r=b.properties.getValue(Mc.a.MBe).split(" ");return{Kwj:h,oUh:r}}static XKm(){return new hy(Object(E.a)(Object(vo.a)(),Object(vo.a)().Iu,"navigateToPageContentNode"))}static get instance(){return null!=hy.hYg?hy.hYg:hy.hYg=hy.XKm()}}Object(u.a)(hy,"TableStyleThemeHelper",null,[416]);var bu=
d(888);class Xz{get Xg(){return null!=this.k3g?this.k3g:this.k3g=Za.a.instance.Oa(29)}constructor(b,h){this.Q9e={};this.DIb={};this.we=b;this.Jy=h}kAf(b,h){const r=this.Q9e[xw[h]];return r&&r.length?r:this.Qcm(b,h)}Cyi(b,h,r){if(h=this.kAf(h,r))for(b=this.we.ze(b),r=0;r<h.length;r++)if(this.we.ze(h[r])===b)return r;return-1}Cla(){this.Q9e={};this.DIb={}}Qcm(b,h){const r=[];this.DIb={};b=this.Jy.R3c(b);this.JRd(r,this.DIb,0,h,b);this.JRd(r,this.DIb,1,h,b);this.JRd(r,this.DIb,2,h,b);this.JRd(r,this.DIb,
3,h,b);return this.Q9e[xw[h]]=r}JRd(b,h,r,A,M){let aa;const oa=M.gv();aa=this.Xg.Ln?oa.Jw:M.Jw;for(let fb=0;fb<aa;fb++){var Ja=void 0;this.Xg.Ln?(Ja=oa.gla(fb),Ja=M.lh(this.we.ze(Ja))):Ja=M.XAa(fb);if(3!==this.we.BF(Ja))continue;const Cb=this.Jy.QKm(Ja),Gb=this.Jy.z8d(Ja);h[xw[Gb]]=!0;Cb!==r||Gb!==A&&16!==Gb||this.we.ze(Ja)===bu.a.IVb||(b[b.length]=Ja)}}static EOm(){return new Xz(Za.a.instance.resolve(8),Za.a.instance.resolve(458))}static cJl(){return Xz.EOm()}}Object(u.a)(Xz,"WACTableStyleRibbonList",
null,[415]);class jv extends Wz{constructor(b,h,r,A,M){super(b,h,r);this.t5b=4;this.LNd=[];this.x$m=()=>{this.obc.Cla();this.VFh.Cla()};this.qNk=M;this.obc=A;this.$nf=WordEditorIntl.WordEditorStrings.L_BtnClearTableFormatting;this.n$n()}ZBl(b,h){b.MenuItems=this.bcm(h)}n$n(){this.WNb={};this.WNb["0"]="CustomTableStyles";this.WNb["1"]="PlainTableStyles";this.WNb["2"]="GridTableStyles";this.WNb["3"]="ListTableStyles"}bcm(b){const h=Object.assign(new aj.a,{Id:"menuTableTheme"});h.MenuSectionList=[];
if(this.Von(b))return h;const r=Object.assign(new te.a,{Id:"msTableStyleTheme",ControlsId:"ctrlTableStyleThemeColors",ControlList:[]}),A=Object.assign(new wz.a,{Id:"clrTableStyleTheme",ExternalId:"TableStyleThemeColorPicker",Command:Fc.a.emb.toString(),QueryCommand:Fc.a.gYb.toString(),Width:jv.ugp});A.Colors=({tgp:this.LNd}=this.qNk.Vem(this.LNd,b,this.obc)).returnValue;r.ControlList.push(A);h.MenuSectionList.push(r);return h}U7a(b){if(b=this.Jy.VG(b))b=this.Jy.z8d(b),16!==b&&(this.t5b=b)}Dri(b){return this.obc.kAf(b,
this.t5b)}KOf(b,h){h=this.obc.kAf(h,this.t5b);return 0>b||b>=h.length?null:h[b]}KDo(b,h){var r=this.Jy.VG(h);r=this.obc.Cyi(r,h,this.t5b);r=-1!==r?Math.floor(r/Ds.WEg)*Ds.WEg:0;return this.KOf(r+b,h)}SKm(b){switch(b){case 0:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesCustom;case 2:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesGrid;case 3:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesList;case 1:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesPlain;default:return""}}Von(b){this.U7a(b);
return 0>=this.Dri(b).length}wxp(b,h){if(!b||!h)return null;b=parseInt(b[qo.Color]);var r=this.Jy.VG(h);const A=this.Jy.z8d(r);if(A===b)return null;if(16===A)return this.t5b=b,null;r=this.obc.Cyi(r,h,A);this.t5b=b;return this.KOf(r,h)}xQl(b){b=this.Jy.VG(b);b=this.Jy.z8d(b);if(16!==b)for(let h=0;h<this.LNd.length;h++)if(this.LNd[h]===b)return h;return-1}C5a(b){b.ldf(this.x$m,2)}static WKm(){return new jv(fs.instance,Za.a.instance.resolve(8),Za.a.instance.resolve(458),Xz.cJl(),hy.instance)}static get instance(){return null!=
jv.MYg?jv.MYg:jv.MYg=jv.WKm()}}jv.ugp=4;Object(u.a)(jv,"TableStyleRibbonControls",Wz,[384,385]);var Yz=d(1475);class Et extends Cn{constructor(b,h,r,A,M,aa,oa,Ja){super(b,h,r,A,M,aa,oa,Ja);this.ytc=(fb,Cb,Gb,Sb,pc)=>{if(!({Iz:fb}=this.syb(Cb,Gb,pc,!1,!0)).returnValue)return fb;this.qGg.ZBl(pc,Cb.node);return 32};this.emb=(fb,Cb,Gb,Sb,pc)=>{if(!({Iz:fb}=this.syb(Cb,Gb,pc,!1,!0)).returnValue)return 2==Gb&&8==fb&&Lr.a.recordQosError("TableStyleColorButtonClickNoResponse",["TableInteractionFailed"],nf.a.m3l),
fb;const zc=Cb.node,Yc=this.qGg.wxp(pc,zc);Yc&&this.$oe(zc,()=>{this.kPd.H_b(Yc,zc)});return 32};this.gYb=(fb,Cb,Gb,Sb,pc)=>{if(!({Iz:fb}=this.syb(Cb,Gb,pc,!0,!0)).returnValue)return fb;pc[qo.IndexColorSelected]=this.qGg.xQl(Cb.node);return 32}}uuc(b){super.uuc(b);this.ga.qa(Fc.a.emb,lc.a.view,this.eBe);this.ga.qa(Fc.a.emb,lc.a.table,this.emb);this.ga.Pc(Fc.a.emb,1030);this.ga.qa(Fc.a.ytc,lc.a.view,b);this.ga.qa(Fc.a.ytc,lc.a.table,this.ytc);this.ga.Pc(Fc.a.ytc,1126);this.ga.qa(Fc.a.gYb,lc.a.view,
b);this.ga.qa(Fc.a.gYb,lc.a.table,this.gYb);this.ga.Pc(Fc.a.gYb,1127)}get qGg(){return this.rNd}static PKm(){return new Et(Za.a.instance.resolve(458),jv.instance,y.AFrameworkApplication.va,Yz.a.instance,new Qn.a,Za.a.instance.resolve(106),Za.a.instance.resolve(46).instance,Object(E.a)(re.a.instance,re.a.instance.ytb,"isTableNodeInLockedRange"))}static get instance(){return null!=Et.XXg?Et.XXg:Et.XXg=Et.PKm()}}Object(u.a)(Et,"TableStyleActor",Cn,[]);class CJ{constructor(){this.W=null}get name(){return"WordEditor.TableStyle"}uc(b){this.W=
b;this.W.ia("Box4.TableEditors.ITableStylePreviewGeneratorVariableSize",()=>fs.instance).ha();this.W.ia(615,()=>Yz.a.instance).ha()}init(){this.W.resolve(12).us.continueWith(()=>{this.Fo()})}Fo(){this.W.resolve(12).isFeatureEnabled(104)&&(Et.instance.Xb(),jv.instance.C5a(iw.a.instance),qa.StaticActiveAppFrame.za().Fe())}dispose(){}}Object(u.a)(CJ,"TableStylePackage",null,[0,1]);var UC=window.WordEditorHeaderToolbarData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Toolbar",
attrs:{Id:"WordEditorHeaderToolbar",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageSideArrow:"IMGMAP@we@SubmenuFlyoutArrow_13x13x32",Scale:"true",Size:"OneRow",TeamId:"WAC",TextDirection:"STR@L_RibbonOptionTextDirection",Title:"STR@L_HeaderToolbarLabel",LabelText:"STR@L_HeaderToolbarLabel"},children:[{name:"Docks",attrs:{Id:"HeaderToolbarButtonDocks"},
children:[{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockLeft",Alignment:"Left"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsLeft"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarSectionsFlyout",Command:"0x2F9A3D80",QueryCommand:"0x978B3323",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0xF9833D60",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarFirstPageButton",LabelText:"STR@L_HeaderToolbarFirstPageButton",Command:"0xC95FE689",
QueryCommand:"0xA99F5B15",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarEvenPagesButton",LabelText:"STR@L_HeaderToolbarEvenPagesButton",Command:"0xD9BEF8F8",QueryCommand:"0xF04337C4",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOddPagesButton",LabelText:"STR@L_HeaderToolbarOddPagesButton",Command:"0xE58D2847",QueryCommand:"0x732475F7",TogglesWhenExecuted:"false",DisplayMode:"Medium",
Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOtherPagesButton",LabelText:"STR@L_HeaderToolbarOtherPagesButton",Command:"0x91C2D5C5",QueryCommand:"0x4B388351",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}}]}]},{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockRight",Alignment:"Right"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsRight"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarOptions",Command:"0x568463EB",LabelText:"STR@L_HeaderToolbarOptions"},
children:[{name:"Menu",attrs:{Id:"HeaderFooterToolbarMenu"},children:[{name:"MenuSection",attrs:{Id:"HeaderToolbarOptionsSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarOptionsControl"},children:[{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonAllPages",MenuItemId:"HeaderToolbarButtonAllPages",Image32by32:"IMGMAP@box42@HeaderAndFooter_32x32x32",Command:"0xF56DFAEA",QueryCommand:"0x7B6FA1F6",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarAllPages"}},
{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstPage",MenuItemId:"HeaderToolbarButtonFirstPage",Image32by32:"IMGMAP@we@DifferentFirstPage_32x32x32",Command:"0x3284B693",QueryCommand:"0x51527973",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstPage"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonEvenOddPages",MenuItemId:"HeaderToolbarButtonEvenOddPages",Image32by32:"IMGMAP@we@DifferentEvenOddPages_32x32x32",Command:"0x3DB867BD",QueryCommand:"0xE8BBEA49",TogglesWhenExecuted:"false",
LabelText:"STR@L_HeaderToolbarEvenOddPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstEvenOddPages",MenuItemId:"HeaderToolbarButtonFirstEvenOddPages",Image32by32:"IMGMAP@we@DifferentFirstEvenOddPages_32x32x32",Command:"0x8FF03DBF",QueryCommand:"0x2799C44F",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstEvenOddPages"}}]}]},{name:"MenuSection",attrs:{Id:"HeaderToolbarDeleteSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarDeleteControl"},
children:[{name:"Button",attrs:{Id:"HeaderToolbarButtonRemovePageNumbers",MenuItemId:"HeaderToolbarButtonRemovePageNumbers",Image32by32:"IMGMAP@we@WordRemovePageNumbers_32x32x32",Command:"0xF3612A1B",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_RemovePageNumbers"}},{name:"Button",attrs:{Id:"HeaderToolbarButtonDelete",MenuItemId:"HeaderToolbarButtonDelete",Image32by32:"IMGMAP@we@RemoveHeadersAndFooters_32x32x32",Command:"0x3CD9B935",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",
LabelText:"STR@L_HeaderToolbarRemoveHeadersAndFooters"}}]}]}]}]}]}]}]}]}]},vB=d(1326);class ME{constructor(b,h){this.aRa=b;this.xFa=h}aso(b){this.aRa.OQd(b)}AIa(b){this.xFa.AIa(b)}$_b(b,h){return this.xFa.$_b(b,h)}Z_b(b,h){return this.xFa.Z_b(b,h)}HCe(b,h,r){this.xFa.HCe(b,h,r)}}Object(u.a)(ME,"ClientPaginationHeaderFooterBridge",null,[417]);class wp{constructor(b,h){this.Wm=b;this.ga=h;this.Bda=new cp.a;this.Cda=new cp.a}AIa(b){b=vd.a.Za(b);if(b.pq()&&b.zq()){b.Zd();do 10===b.mf&&this.hkg(b.currentNode),
b.Au();while(8!==b.mf)}}$_b(b,h){var r=this.kQb(h);if(!this.Bda.lb(r))return v.ULS.sendTraceTag(573400388,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+r),!1;h=this.Bda.K(r);v.ULS.shipAssertTag(573400389,336,this.Cda.lb(r),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");r=this.Cda.K(r);return this.JRf(h,b,r)}Z_b(b,h){var r=this.kQb(h);if(!this.Bda.lb(r))return v.ULS.sendTraceTag(573400390,
3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+r),!1;h=this.Bda.K(r);v.ULS.shipAssertTag(573400391,336,this.Cda.lb(r),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");r=this.Cda.K(r);return this.KDf(h,b,r)}HCe(b,h,r){h=this.ENf(h,r);this.ga.Pb(b?Fc.a.lFe:Fc.a.std,2,h)}ENf(b,h){h=this.Wm.qPb(h);if(!h)return v.ULS.sendTraceTag(573400392,3009,15,"Header footer container node expected not to be null."),
0;h=this.Wm.ila(h);const r=1===b;b=!(b%2);return 1===h?1:2===h?r?2:1:3===h?b?3:4:r?2:b?3:4}hkg(b){if(10===b.type){var h=new cp.a,r=this.Wm.qPb(b);v.ULS.shipAssertTag(573400393,336,!!r,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var A=this.Wm.ila(r);b=this.kQb(b);this.GLg(b,A);this.FLg(b,h);r=vd.a.Za(r);if(r.zq()){r.Zd();do b=r.currentNode,A=this.Wm.E2c(b),b=this.Wm.PMi(b),h.add(A,b),r.Au();while(36===r.mf)}}}GLg(b,
h){this.Cda.lb(b)?this.Cda.Z(b,h):this.Cda.add(b,h)}FLg(b,h){this.Bda.lb(b)?this.Bda.Z(b,h):this.Bda.add(b,h)}kQb(b){v.ULS.shipAssertTag(573400395,336,10===b.type,"Expected node of type Outline but received node of type "+b.type);return b.ka(Mc.a.jna,0)}JRf(b,h,r){const A=1===h;h=!(h%2);switch(r){case 2:if(A){if(b.lb(2))return b.K(2)}else if(b.lb(0))return b.K(0);break;case 3:if(h){if(b.lb(1))return b.K(1)}else if(b.lb(0))return b.K(0);break;case 4:if(A){if(b.lb(2))return b.K(2)}else if(h){if(b.lb(1))return b.K(1)}else if(b.lb(0))return b.K(0);
break;case 1:if(b.lb(0))return b.K(0)}return!1}KDf(b,h,r){const A=1===h;h=!(h%2);switch(r){case 2:if(A){if(b.lb(5))return b.K(5)}else if(b.lb(3))return b.K(3);break;case 3:if(h){if(b.lb(4))return b.K(4)}else if(b.lb(3))return b.K(3);break;case 4:if(A){if(b.lb(5))return b.K(5)}else if(h){if(b.lb(4))return b.K(4)}else if(b.lb(3))return b.K(3);break;case 1:if(b.lb(3))return b.K(3)}return!1}}Object(u.a)(wp,"ClientPaginationPageAdornmentContentManager",null,[413]);class Es{constructor(b,h,r,A,M,aa){this.ewl=
oa=>{1===oa&&this.dG.kG&&(oa=this.Zc.tsa(this.dG.kG,8,8),this.Wm.Hil(oa)?this.$Nl(oa):this.c3o())};this.lop=oa=>{1===oa&&this.ga.Pb(ub.a.KX,2,!1)};this.dG=b;this.Wm=h;this.Zc=r;this.Qc=A;this.DHc=M;this.ga=aa}r3o(){const b=new ni.StandardDialog;b.Fd=1;b.Qe(1,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogRemoveAllButton);b.gY(0);b.Ex(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogMessage,0,this.ewl)}$Nl(b){b.ld(8);const h=this.Qc.Nc(15);
h.set(b.ko.mk);this.DHc.puo(b);this.dG.dismiss();h.dispose();v.ULS.sendTraceTag(4214792,317,50,"{0}",{["RemovedHeadersAndFooters"]:!0})}c3o(){const b=new ni.StandardDialog;b.Fd=1;b.Qe(1,Box4Intl.Box4Strings.L_OpenInWord);b.Qe(0,CommonUIStrings.l_Close);b.gY(0);b.Ex(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarCantDeleteContent,0,this.lop);v.ULS.sendTraceTag(4214793,317,50,"{0}",{["CouldntRemoveHeadersAndFooters"]:!0})}}Object(u.a)(Es,"DeleteHeaderFooterDialog",
null,[]);class az{constructor(b,h,r,A,M){this.Wm=b;this.Zc=h;this.Qc=r;this.DHc=A;this.ga=M}create(b){return new Es(b,this.Wm,this.Zc,this.Qc,this.DHc,this.ga)}}Object(u.a)(az,"DeleteHeaderFooterDialogFactory",null,[410]);class VC{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb){this.mda=null;this.$Hg=(Gb,Sb,pc,zc,Yc)=>{var Kd=this.OOf(Sb);return Kd?1===pc?32:(pc=this.control)?(Sb=this.Qc.Nc(15),Sb.Bb(Kd),Sb.Ii=Gb,pc.Nea?this.ga.Ob(Fc.a.KW,2):(Kd=this.vji(Kd),zc.Bt=Kd?1:0,zc=Gb!==Fc.a.std,(Gb=this.gJf(Gb,Yc))&&
pc.QDa(Gb),this.ga.Pb(Fc.a.UZd,2,zc)),Sb.dispose(),32):8:8};this.kvf=(Gb,Sb,pc)=>{if(1===pc)return 32;this.ark.create(this.control).r3o();return 32};this.$go=(Gb,Sb,pc,zc,Yc)=>1===pc?32:(Gb=this.control)?(Yc[Vg.a.On]=Gb.Nea,32):8;this.jyb=(Gb,Sb,pc,zc,Yc)=>{if(1===pc||!this.control.Nea)return 32;Sb=this.Pxi(Gb,Yc);pc=VC.OIi(this.control.kG);zc=this.Qc.Nc(15);zc.Bb(pc);zc.Ii=Gb;Gb=this.Zc.Rl();Gb.set(pc);this.bRa.iAf(Gb.currentNode,Sb);this.Wm.rVb(Gb);this.DHc.tOj(Gb,Sb);zc.dispose();return 32};this.QDa=
(Gb,Sb,pc,zc,Yc)=>{if(1===pc)return 32;Gb=this.gJf(Gb,Yc);this.control.Nea&&this.control.QDa(Gb);return 32};this.Wve=(Gb,Sb,pc,zc,Yc)=>{if(1===pc)return 32;Gb=this.ZEi(Gb,Yc);zc.Bt=Gb;Sb=this.OOf(Sb);if(!Sb)return 8;zc=this.Zc.Rl();zc.set(Sb);zc.vb(8);zc.jt(8);if(!this.ql.yLn(zc,Gb))return 8;this.Wm.rVb(zc);this.control.Bka(zc.currentNode);return 32};this.ikg=(Gb,Sb,pc,zc,Yc)=>{if(1===pc)return 32;Gb=this.yOk.zHl(this.OOf(Sb));Yc.PopulationXML=Gb;return 32};this.xre=(Gb,Sb,pc,zc,Yc)=>{Gb=this.Pxi(Gb,
Yc);Sb=this.control.kG;pc=this.Wm.ila(Sb);Yc[Vg.a.On]=Gb===pc;1===Gb&&(Yc[Vg.a.LabelText]=this.TJi(Sb)?WordEditorIntl.WordEditorStrings.L_HeaderToolbarEntireSection:WordEditorIntl.WordEditorStrings.L_HeaderToolbarAllPages);return 32};this.yqe=(Gb,Sb,pc,zc,Yc)=>{if(1===pc||!this.control.Nea)return 32;Sb=this.control.kG;void 0!==Sb&&null!==Sb&&(Sb=this.Wm.ila(Sb),Gb=this.gJf(Gb,Yc),pc=this.control.v5b,Yc[Vg.a.Visible]=this.sfp(Gb,Sb),Yc[Vg.a.On]=Gb===pc);return 32};this.pho=(Gb,Sb,pc,zc,Yc)=>{if(1===
pc||!this.control.Nea)return 32;Gb=this.control.kG;void 0!==Gb&&null!==Gb&&this.K$n(Gb,Yc);return 32};this.zgo=(Gb,Sb,pc,zc,Yc)=>{if(1===pc||!this.control.Nea)return 32;Gb=this.ZEi(Gb,Yc);Sb=this.control.kG;pc=0;void 0!==Sb&&null!==Sb&&(pc=Sb.getValue(Mc.a.jna));Yc[Vg.a.On]=Gb===pc;return 32};this.KW=(Gb,Sb,pc)=>{if(1===pc)return 32;this.control.dismiss();return 32};this.m$d=()=>32;this.UZd=(Gb,Sb,pc,zc,Yc)=>{if(1===pc)return 32;this.control.show(Yc);return 32};this.Ttb=(Gb,Sb,pc,zc,Yc)=>{if(1===
pc)return 32;if(!Yc)return 8;Sb=Yc.Q6a;if(!Sb||!Sb.isConnected)return 8;Gb=this.Wm.bdd(Sb);if(!({isHeader:pc,aHg:Sb}=this.Wm.hHi(Sb)).returnValue)return 8;this.control.Bka(Gb);this.control.QDa(Sb);this.control.show(pc,Yc.Vxe);return 32};this.ga=b;this.Wm=h;this.DHc=r;this.bRa=A;this.ql=M;this.Zc=aa;this.Qc=oa;this.yOk=Ja;this.Cvk=fb;this.ark=Cb}get control(){return this.mda}set control(b){this.mda=b}Xb(){this.ga.qa(Fc.a.Yae,lc.a.view,this.$Hg);this.ga.fb(Fc.a.tng,lc.a.application,this.$go,96);this.ga.qa(Fc.a.lFe,
lc.a.view,this.$Hg);this.ga.qa(Fc.a.std,lc.a.view,this.$Hg);this.ga.fb(Fc.a.m$d,lc.a.view,this.m$d,64);this.ga.qa(Fc.a.UZd,lc.a.view,this.UZd);this.ga.fb(Fc.a.KW,lc.a.application,this.KW,96);this.ga.fb(Fc.a.Ttb,lc.a.application,this.Ttb,96);this.ga.fb(Fc.a.QNo,lc.a.view,this.QDa,96);this.ga.qa(Fc.a.FKj,lc.a.view,this.QDa);this.ga.qa(Fc.a.HKj,lc.a.view,this.QDa);this.ga.qa(Fc.a.GKj,lc.a.view,this.QDa);this.ga.qa(Fc.a.IKj,lc.a.view,this.QDa);this.ga.fb(Fc.a.oRo,lc.a.view,this.jyb,100);this.ga.fb(Fc.a.rMj,
lc.a.view,this.jyb,4);this.ga.fb(Fc.a.qMj,lc.a.view,this.jyb,4);this.ga.fb(Fc.a.oMj,lc.a.view,this.jyb,4);this.ga.fb(Fc.a.pMj,lc.a.view,this.jyb,4);this.ga.qa(Fc.a.Wve,lc.a.view,this.Wve);this.ga.qa(Fc.a.Fxg,lc.a.view,this.Wve);this.ga.fb(Fc.a.ikg,lc.a.view,this.ikg,96);this.ga.fb(Fc.a.kvf,lc.a.view,this.kvf,4);this.ga.fb(Fc.a.cvj,lc.a.view,this.yqe,97);this.ga.fb(Fc.a.evj,lc.a.view,this.yqe,97);this.ga.fb(Fc.a.dvj,lc.a.view,this.yqe,97);this.ga.fb(Fc.a.fvj,lc.a.view,this.yqe,97);this.ga.fb(Fc.a.vvj,
lc.a.view,this.xre,97);this.ga.fb(Fc.a.uvj,lc.a.view,this.xre,97);this.ga.fb(Fc.a.svj,lc.a.view,this.xre,97);this.ga.fb(Fc.a.tvj,lc.a.view,this.xre,97);this.ga.fb(Fc.a.Ugo,lc.a.view,this.pho,97);this.ga.fb(Fc.a.Pmg,lc.a.view,this.zgo,97)}vji(b){const h=this.Wm.qPb(b),r=this.Wm.ila(h);b=this.bRa.iAf(b,r);this.control.Bka(h);return b}Pxi(b,h){switch(b){case Fc.a.rMj:case Fc.a.vvj:b=1;break;case Fc.a.qMj:case Fc.a.uvj:b=2;break;case Fc.a.oMj:case Fc.a.svj:b=3;break;case Fc.a.pMj:case Fc.a.tvj:b=4;break;
default:b=h}return b}gJf(b,h){switch(b){case Fc.a.FKj:case Fc.a.cvj:b=1;break;case Fc.a.HKj:case Fc.a.evj:b=2;break;case Fc.a.GKj:case Fc.a.dvj:b=3;break;case Fc.a.IKj:case Fc.a.fvj:b=4;break;case Fc.a.lFe:case Fc.a.std:b=h;break;case Fc.a.Yae:b=0;break;default:b=h}return b}ZEi(b,h){return b===Fc.a.Fxg||b===Fc.a.Pmg?parseInt(h.MenuItemId):h}OOf(b){return this.ql.Paa(b.Ik)}sfp(b,h){switch(h){case 1:return!1;case 2:return 1===b||2===b;case 4:return 4===b||2===b||3===b;case 3:return 4===b||3===b}return!0}K$n(b,
h){const r=this.TJi(b);if(h[Rc.a.Visible]=r)b=this.ql.PIi(this.Cvk(b)),b=String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,b),h[Rc.a.LabelText]=b}TJi(b){const h=this.Zc.Rl();h.set(b);h.vb(8);h.jt(8);return 1<this.ql.eOf(h)}static OIi(b){const h=new vd.a;h.set(b);h.vb(10);return Rx.WordSectionNavigator.gFo(h)}}Object(u.a)(VC,"HeaderFooterActor",null,[]);var wB=d(789),xB=d(707);class yB{constructor(b,h,r,A,M){this.zDk=b;this.Wm=h;this.ql=r;this.Zc=A;this.ga=M}hji(b,h){this.Wm.rVb(b);
h=this.SZl(b,h);b.rc();return h}iAf(b,h){b=this.Zc.tsa(b,8,8);let r=!1;this.ql.gVa(b,A=>{const M=this.Zc.Rl();M.set(A);r=(A=this.hji(M,h))||r;return A});return r}SZl(b,h){if(3!==this.ga.mode)return!1;let r=!1;h=xB.a.dwf(h);for(let A=0;A<h.length;++A)r=this.zDk.RZl(b,h[A])||r;return r}}yB.BMl=1;Object(u.a)(yB,"HeaderFooterInserter",null,[403]);class iy{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb){this.$Ch=this.Rdh=!1;this.kG=null;this.gWe=!1;this.v5b=0;this.$Vb=()=>{this.gWe=!0};this.y9=b;b.bind(this);
this.Saf=A;this.zrk=fb;this.Gvh=M;this.qEk=aa;this.lib=oa;this.E_=h;this.footer=r;this.E_.IIl();this.y9.$A();this.b$e=yB.BMl;this.bRa=Ja;iy.ga=Cb;this.mQ=Gb}get Nea(){return this.Rdh}show(b=!0,h=!0){this.Nea||(this.O7j(),this.OLj(!0),this.E_.dpo(),this.zrk(),this.f$o(),y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.bCa&&(hh.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new wB.a,{state:0,disablePopover:!0}))):v.ULS.sendTraceTag(509384032,3023,15,"Showing header/footer overlay and appChrome is not ready")));
(this.$Ch=h)&&this.Gvh(b)}dismiss(b=!1){this.Nea&&(this.qEk(b),this.OLj(!1),this.bNb(),this.v5b=0,this.uap(),y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.bCa&&(hh.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new wB.a,{disablePopover:!1}))):v.ULS.sendTraceTag(509384031,3023,15,"Dismissing header/footer overlay and appChrome is not ready")))}OLj(b){this.Rdh=b;iy.ga.Ob(ub.a.fEf,2);this.y9.b4(b);this.E_.b4(b);this.footer.b4(b);this.Saf()}Bka(b){this.kG!==b&&(this.kG=
b,this.E_.Bka(b),this.footer.Bka(b),this.v5b=0,this.jyb(this.lib.ila(b)))}bNb(){this.kG&&(this.E_.pob(),this.footer.pob(),this.kG=null)}update(){this.Nea&&this.Y1b()}Y1b(){this.kG&&(this.lib.qVl(this.kG)&&this.lib.NXm(this.kG)?this.O7j():this.dismiss())}O7j(){const b=this.lib.ila(this.kG);b!==this.b$e&&this.jyb(b)}jyb(b){this.b$e=b;this.QDa(this.uLm(b))}uLm(b){switch(b){case 2:return 2;case 3:return 3;case 4:return 2}return 1}QDa(b,h=!0){this.v5b!==b&&(this.bRa.iAf(this.kG,this.b$e),this.E_.EKj(b),
this.E_.DTh(vi.a.ufa),this.footer.EKj(b),this.footer.DTh(vi.a.$ea),this.v5b=b,this.Nea&&this.$Ch&&this.z_l(h))}z_l(b){this.Gvh(b);b?this.E_.qwc():this.footer.qwc()}dispose(){this.y9.Jca();this.E_.dispose();this.footer.dispose()}f$o(){this.mQ.TRc(this.$Vb);this.gWe=!1}uap(){this.mQ.kte(this.$Vb);this.gWe&&iy.ga.Ob(Fc.a.m$d,2)}static HSl(){iy.ga.Pb(Ka.a.Arb,2,!0);iy.ga.Ob(Fc.a.I6,2)}}iy.ga=null;Object(u.a)(iy,"HeaderFooterControl",null,[444,10]);class RG{constructor(b,h,r,A,M){this.Saf=b;this.lib=h;
this.bRa=r;this.ga=A;this.mQ=M}create(b,h,r,A,M){return new iy(b,h,r,this.Saf,A,M,this.lib,this.bRa,iy.HSl,this.ga,this.mQ)}}Object(u.a)(RG,"Factory",null,[407]);class Qr{constructor(){this.mda=null}get control(){return this.mda}set control(b){this.mda=b}UEf(b){return this.VEf(this.control.kG,this.control.v5b,b.isHeader,b)}VEf(b,h,r,A){return()=>{if(!b.isConnected)return null;this.control.Bka(b);this.control.QDa(h);this.control.show(r);return A}}dismiss(){this.mda.Nea&&this.mda.dismiss()}}Object(u.a)(Qr,
"HeaderFooterControlLauncher",null,[]);var DJ=d(1105),NE=d(769),EJ=d(805);class jy{constructor(b,h,r){this.pzc=null;const A=h?"Header":"Footer";this.Is=b.ownerDocument.createElement("div");this.Is.id=h?"HeaderPane":"FooterPane";this.Is.classList.add(jy.QXm,A);this.fJb=(new EJ.a(this.Is,"WACViewPanel_"+A)).mK;this.Is.appendChild(this.fJb);b.appendChild(this.Is);h&&(this.pzc=b.ownerDocument.createElement("div"),this.pzc.classList.add(jy.WXm),this.Is.appendChild(this.pzc));this.I7g=r.rBm(this.Is)}bind(){}b4(b){b?
this.I7g.a3k():this.I7g.c3k()}Cal(b){b.mdc(this.fJb)}}jy.WXm="HeaderToolbarContainer";jy.QXm="HeaderFooterPane";Object(u.a)(jy,"PaneControlDom",null,[468]);class Dq{constructor(b,h,r,A,M){this.dG=this.vr=null;this.Gkj=()=>{this.dG.dismiss(!0);if(this.v6b){const aa=new gx.a(!0);this.v6b.cNa(aa)}return!0};this.pD=aa=>{aa.Nb.preventDefault();return!1};this.Is=b.ownerDocument.createElement("div");this.Is.id=Dq.g6h;this.Is.className=Dq.g6h;this.G1=A;this.v6b=M;this.LMi=new jy(this.Is,!0,h);this.jGl(this.Is);
this.Qoi=new jy(this.Is,!1,h);this.b4(!1);b.appendChild(this.Is)}jGl(b){this.vr=b.ownerDocument.createElement("div");this.vr.id=Dq.$3n;this.vr.className=Dq.Y3n;this.vr.tabIndex=0;this.vr.setAttribute(Ne.a.Ph,Ne.a.K$);this.vr.setAttribute(Ne.a.Aja,WordEditorIntl.WordEditorStrings.L_HeaderFooterOverlayAccessibleText);b.appendChild(this.vr)}bind(b){this.dG=b}b4(b){if(!b&&this.G1){var h=new gx.a(!0);this.G1.cNa(h)}!b&&this.v6b&&(h=new gx.a(!0),this.v6b.cNa(h));this.Is.style.display=b?"":"none";this.LMi.b4(b);
this.Qoi.b4(b)}HQo(){this.vr.focus()}$A(){Qc.a.instance.nb(Jd.a.click,this.vr,this.Gkj);ie.a.instance.nb(Jd.a.az,this.Is,this.pD)}Jca(){Qc.a.instance.xc(Jd.a.click,this.vr,this.Gkj);ie.a.instance.xc(Jd.a.az,this.Is,this.pD)}}Dq.g6h="HeaderFooterControl";Dq.$3n="HeaderFooterOverlay";Dq.Y3n="EditingSurfaceOverlay HeaderFooterOverlay";Object(u.a)(Dq,"HeaderFooterControlDom",null,[443]);var cu=d(157);class zB{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb){this.y9=null;this.sa=new Td.a;this.dG=this.aLd=null;this.geg=
Gb=>{this.lca(Gb);this.sa.raiseEvent("OnShowEventKey")};this.feg=Gb=>{this.tl&&(this.aLd=new DJ.a(this.tl));this.Yb.IXc(vi.a.ufa);this.Yb.IXc(vi.a.$ea);this.bha(Gb);this.sa.raiseEvent("OnDismissEventKey")};this.poe=()=>{this.aLd&&(this.aLd.dispose(),this.aLd=null)};this.Yb=b;this.Zp=h;this.xxh=r;this.dwk=A;this.gGk=M;this.ga=aa;this.obh=NE.a.create();this.pfh=Xb.KeyInputManager.mc(cf.a.Nu,0);this.r1=Xb.KeyInputManager.mc(cf.a.G4,0);this.lMk=Xb.KeyInputManager.mc(cf.a.y0a,0);this.IK=oa;this.Ga=Ja;
this.G1=fb;this.v6b=Cb;this.tl&&this.tl.g6(this.poe)}IOh(b){this.sa.addHandler("OnShowEventKey",b)}Zxo(b){this.sa.removeHandler("OnShowEventKey",b)}OQd(b){this.sa.addHandler("OnDismissEventKey",b)}fCj(b){this.sa.removeHandler("OnDismissEventKey",b)}get tl(){const b=this.IK.value;return b?b.gj?b:(v.ULS.sendTraceTag(25474004,317,10,"_lazyPageView.Value is not a page view in HeaderFooterControlOwner."),null):(v.ULS.sendTraceTag(25474003,317,10,"_lazyPageView.Value is null in HeaderFooterControlOwner."),
null)}get control(){return this.dG}get tyl(){return this.obh}bind(b){this.dG=this.Dwl(b);this.obh.instance=this.dG}Dwl(b){this.y9=new Dq(b,this.gGk.value,this.Ga,this.G1,this.v6b);b=this.xxh.value.create(this.ga,this.y9.LMi,!0,vi.a.ufa);const h=this.xxh.value.create(this.ga,this.y9.Qoi,!1,vi.a.$ea);this.dG=this.dwk.value.create(this.y9,b,h,this.geg,this.feg);this.dUf();this.rW();return this.control}dUf(){var b=3===this.ga.mode?vi.a.uF:vi.a.puc;const h=this.Yb.ie(vi.a.ufa);h.parent=b;this.Yb.zdf(vi.a.ufa);
const r=this.Yb.ie(vi.a.$ea);r.parent=b;this.Yb.zdf(vi.a.$ea);b=this.Yb.ie(cu.a.ZQb);b.parent=id.AFrame.Eq;b.sja(()=>{this.y9.HQo()});b.bindAction(this.pfh,Fc.a.KW);b.bindAction(this.r1,Fc.a.KW);b.bindAction(this.lMk,Fc.a.KW);h.bindAction(this.r1,Fc.a.KW);r.bindAction(this.r1,Fc.a.KW)}rW(){this.Zp.rW(vi.a.ufa);this.Zp.rW(cu.a.U9a);this.Zp.rW(vi.a.$ea);this.Zp.rW(cu.a.ZQb)}lca(b){this.Zp.MK(vi.a.ufa);this.Zp.MK(cu.a.U9a);this.Zp.MK(vi.a.$ea);this.Zp.MK(cu.a.ZQb);this.Zp.ay(id.AFrame.Ro);this.Yb.iRc(vi.a.ufa);
this.Yb.iRc(vi.a.$ea);b?this.Yb.Jg(vi.a.ufa):this.Yb.Jg(vi.a.$ea)}bha(b){this.Zp.ay(vi.a.ufa);this.Zp.ay(cu.a.U9a);this.Zp.ay(vi.a.$ea);this.Zp.ay(cu.a.ZQb);this.Zp.MK(id.AFrame.Ro);(b||this.Yb.currentScope&&(this.Yb.currentScope.name===vi.a.ufa||this.Yb.currentScope.name===cu.a.U9a||this.Yb.currentScope.name===vi.a.$ea||this.Yb.currentScope.name===cu.a.ZQb))&&this.Yb.Jg(id.AFrame.Ro)}dispose(){const b=this.Yb.ie(cu.a.ZQb);b.nt(this.pfh);b.nt(this.r1);this.Yb.ie(vi.a.ufa).nt(this.r1);this.Yb.ie(vi.a.$ea).nt(this.r1);
this.tl&&this.tl.aZb(this.poe);this.control.dispose()}}Object(u.a)(zB,"HeaderFooterControlOwner",null,[408,409]);var Zz=d(1089);class Eq{constructor(b,h,r,A,M,aa,oa,Ja){this.iqa=b;this.kNk=h;this.sLe=r;this.Xm=A;this.JFk=M;this.ILk=aa;this.Tvk=oa;Eq.Oh=Ja}a7m(b,h){this.kNk(b,1,3,null,!1);this.iqa.gOj(bu.a.IVb,1696,b.currentNode);this.sLe(b,0,this.Xm?3:1,h);this.sLe(b,1,2,h);this.sLe(b,2,this.Xm?1:3,h);this.JFk(b);this.ILk(b,!1,!0,null);this.Tvk(b,h)}static get pM(){return null!=Eq.J5g?Eq.J5g:Eq.J5g=
Za.a.instance.resolve(392)}static get nl(){return null!=Eq.t1g?Eq.t1g:Eq.t1g=Za.a.instance.resolve(348)}static NOo(b,h,r){Oh.moveToCellContent(b,0,h);Bb.OutlineElementNavigator.Me(b);Eq.pM.Fnd(Box4Intl.Box4Strings.L_StyleWordHeader,b.currentNode);Eq.nl.rH(b.currentNode,r);h||Eq.nl.ir.TDa(b,1,-115);2===h&&Eq.nl.ir.Wxb(b.currentNode,1,-115);Oh.returnToContainingTable(b)}static mRo(b,h){Bb.OutlineElementNavigator.Me(b);Eq.pM.Fnd(h?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,
b.currentNode);Bb.OutlineElementNavigator.je(b)}static jim(){return(b,h,r)=>{Eq.NOo(b,h,r)}}static Orm(){return(b,h)=>{Eq.mRo(b,h)}}static wKm(b){return(h,r,A,M,aa)=>b.pUa(h,r,A,M,aa)}static sIm(){return(b,h,r,A,M)=>Eq.Oh.SA(b,h,r,A,M)}}Eq.Oh=null;Object(u.a)(Eq,"HeaderFooterDefaultTableInserter",null,[406]);class WC{constructor(b,h,r,A){this.Wm=b;this.aId=h;this.Zc=r;this.ql=A}tOj(b,h){b.ko.properties.setValue(Mc.a.eRf,2===h||4===h);b.vb(8);b.Vsd(8).properties.setValue(Mc.a.V9d,3===h||4===h)}puo(b){this.ql.gVa(b,
h=>{const r=this.Zc.Rl();r.set(h);this.Wm.rVb(r);this.tOj(r,1);this.quo(r);return!0})}quo(b){for(;b.Zd();)b.Rg()}}Object(u.a)(WC,"HeaderFooterEditor",null,[404]);var FJ=d(1074);class SG extends Ct.a{constructor(b){super();this.Uaf=b}get index(){return 0}run(){this.Uaf()}MXm(b,h){h.property===Mc.a.eRf&&this.NI()}y4n(b,h){h.property===Mc.a.V9d&&this.NI()}NI(){this.p0()}}Object(u.a)(SG,"ControlUpdateNeededTracker",Ct.a,[]);class AB{constructor(b,h,r,A,M,aa){this.ahb=null;this.ewk=r;this.SBd=h;this.a7b=
b;this.YFk=A;this.YRa=aa}start(){this.a7b.bind(qa.StaticActiveAppFrame.za().XF);this.SBd.control=this.a7b.control;this.SBd.Xb();this.ewk.control=this.a7b.control;this.YFk.value.create(this.a7b.control,Object(E.a)(this.SBd,this.SBd.vji,"ensureSectionHeaderFooterAttachedToControl")).Xb();this.wZm()}wZm(){this.ahb=new SG(()=>{this.a7b.control.update()});const b=df.a.gf.Ll;b.jf(35).jo(Object(E.a)(this.ahb,this.ahb.MXm,"headerFooterContainerNodePropertyChanged"));b.jf(8).jo(Object(E.a)(this.ahb,this.ahb.y4n,
"pageContentNodePropertyChanged"));FJ.a.Hse(Object(E.a)(this.ahb,this.ahb.NI,"setUpdateNeeded"));$r.a.instance.hva(this.ahb,3)}dispose(){this.a7b.dispose();this.YRa.Xei()}}Object(u.a)(AB,"HeaderFooterManager",null,[]);class Xo{constructor(b,h,r,A){this.ql=b;this.Wm=h;this.U8b=r;this.mOe=A}RZl(b,h){let r=!1;const A=xB.a.TKf(h);b.kv(A)||(this.o7m(b,h),this.mOe.$6m(b.currentNode,h),r=!0);return r}o7m(b,h){const r=this.U8b.create(wm.a.t5c),A=b.currentNode.ka(Mc.a.jna,0);r.properties.setValue(Mc.a.jna,
A);r.properties.setValue(Mc.a.qlc,h);h=xB.a.TKf(h);b.Vf(r,h)}}Object(u.a)(Xo,"HeaderFooterNodeLevelInserter",null,[402]);var XC=d(1391),ox=d(1427);class yw extends XC.a{constructor(b,h,r){super(b,h,"","");this.lGb=null;this.bNi=yw.Mbi;this.w5c=[];this.zTe=r}get lC(){return!0}get cssClass(){return"cui-herodock"}sn(){this.Yoo();super.sn()}RUa(){for(const b of this.w5c)b.o0d();super.RUa()}h9o(){const b=[],h=[],r=[];for(let A=0;A<this.w5c.length;A++){const M=this.w5c[A];M.visible?b.length<this.bNi?b.push(M):
Object(Xa.a)(ox.FlyoutAnchor,M)?Array.addRange(h,M.elm()):h.push(M):r.push(M)}return{Gip:b,W3n:h,D$m:r}}iGl(b){if(!b||!b.length)return null;const h=new dj.Menu(this.root,this.id+"OverflowMenu",null,null,null),r=new cg.a(this.root,this.id+"OverflowMenuSection",null,null,{DisplayMode:"Menu20",ShowSeperator:"false",Scrollable:"true"},h);for(const A of b)r.Vf(A.GW("Menu20"));h.Vf(r);return h}Yoo(){this.Pua();this.Rc=Og.a.EZa(this.Rc);this.hE();const {Gip:b,W3n:h,D$m:r}=this.h9o();for(var A of b){var M=
A.GW("Medium20");M.enabled=!0;this.Nbc(M,this.children.count);this.Rc.appendChild(M.Rc);M.$ra()}if(A=this.iGl(h)){if(this.lGb)this.lGb.Ig=A;else{M=this.id+"OverflowMenuLauncher";const aa={};aa.Image20by20=this.zTe.OverflowMenuImage20by20;aa.Image20by20Class=this.zTe.OverflowMenuImage20by20Class;aa.PopulateDynamically="false";aa.HideDefaultArrow="true";aa.Alt=this.zTe.OverflowMenuTooltip;aa.Command="798637440";aa.Id=M;this.lGb=new ox.FlyoutAnchor(this.root,M,aa,A)}A=this.lGb.GW("Small20");A.enabled=
!0;this.Nbc(A,this.children.count);this.Rc.appendChild(A.Rc);A.$ra()}if(y.AFrameworkApplication.J.$("FixHeroDockNotPollingInvisibleComponentsIsEnabled"))for(const aa of r)A=aa.GW("Medium20"),this.Vf(A),A.$ra()}dispose(){this.lGb&&(this.lGb.dispose(),this.lGb=null);for(const b of this.w5c)b.dispose();this.Pua();super.dispose()}set lC(b){super.lC=b}}yw.Mbi=4;Object(u.a)(yw,"HeroDock",XC.a,[]);var BB=d(1469);class Eu extends BB.a{constructor(){super();this.yAe=this.Jkn=this.U$o=!1;this.YGn=y.AFrameworkApplication.bZf?
1:yw.Mbi}}Object(u.a)(Eu,"ToolbarBuildOptions",BB.a,[]);var Nj=d(1424),TG=d(1501),pL=d(1527);class YC extends XC.a{constructor(b,h,r){super(b,h,"","");this.xCc=r.Alignment;this.weh=r.ScalingDirection===Nj.a.Udk}sn(){this.pAa();this.PZ(this.Rc);super.sn()}PZ(b){for(const h of this.children){h.hE();switch(this.xCc){case Nj.a.TGe:Og.a.qg(h.Rc,"cui-toolbar-button-left");break;case Nj.a.Rfb:Og.a.qg(h.Rc,"cui-toolbar-button-center");break;case Nj.a.i3b:Og.a.qg(h.Rc,"cui-toolbar-button-right");break;default:throw Error.argumentOutOfRange(this.xCc);
}h.visible&&b.appendChild(h.Rc);h.$ra()}}fR(b){if(!Object(Xa.a)(ej.a,b))throw Error.create("Only children of type ControlComponent can be added to a ButtonDock.");}get cssClass(){switch(this.xCc){case Nj.a.TGe:return"cui-toolbar-buttondock alignleft";case Nj.a.Rfb:return"cui-toolbar-buttondock aligncenter";case Nj.a.i3b:return"cui-toolbar-buttondock alignright";default:throw Error.argumentOutOfRange(this.xCc);}}get lC(){return!0}get alignment(){return this.xCc}Pkc(){let b=0;if(this.alignment===Nj.a.Rfb)for(const h of this.children){const r=
h;r.visible&&(b+=r.Rc.offsetWidth)}else b=this.Rc.offsetWidth;return b}j8d(){let b=null;if(this.alignment===Nj.a.Rfb)for(const h of this.children){if(h.visible){b=Sys.UI.DomElement.getBounds(h.Rc);break}}else b=Sys.UI.DomElement.getBounds(this.Rc);return b?0===this.root.t4?b.x:b.x+b.width:0}q5d(){let b=null;if(this.alignment===Nj.a.Rfb){if(0<this.children.count){const h=this.children.oIf(this.children.count-1);for(;h.Iub();){const r=h.get_current();if(r.visible){b=Sys.UI.DomElement.getBounds(r.Rc);
break}}}}else b=Sys.UI.DomElement.getBounds(this.Rc);return b?0===this.root.t4?b.x+b.width:b.x:0}bAf(){for(const b of this.children){const h=b;if(!Object(Xa.a)(ej.a,h)||h.control.visible)h.visible=!0}}qIo(b){const h=this.children.toArray(),r=new pL.a;let A=this.weh?0:h.length-1;const M=this.children.count,aa=this.root.M_a;for(;this.Pkc()>=b&&!(A>=M||0>A);){const oa=h[A];aa&&Object(Xa.a)(ej.a,oa)&&oa.control.visible&&(r.add(oa),oa.JRh());A+=this.weh?1:-1}for(const oa of r)oa.HAj(),oa.visible=!1}set lC(b){super.lC=
b}}Object(u.a)(YC,"ButtonDock",XC.a,[]);class ZC extends Sl.a{constructor(b,h,r,A,M,aa,oa=!1){super(b,h,aa);this.Rwa=this.a1=this.bqa=null;this.c0e=!1;this.wab=A;this.yAe=M;this.$Nd=0;yf.c(h.Size)||(h.Size===Nj.a.qQg||r.options.Jkn?this.$Nd=0:h.Size===Nj.a.Sgk&&(this.$Nd=1));this.zOk=oa}get M_a(){return!0}Vf(b){super.Vf(b);Object(Xa.a)(YC,b)&&!this.c0e&&(b.alignment===Nj.a.TGe?(this.bqa&&this.Wyg(),this.bqa=b):b.alignment===Nj.a.Rfb?(this.a1&&this.Wyg(),this.a1=b):b.alignment===Nj.a.i3b&&(this.Rwa&&
this.Wyg(),this.Rwa=b))}Wyg(){this.c0e=!0;this.Rwa=this.a1=this.bqa=null}Qxb(b,h){b=this.P1c(b);yf.c(b)||b.visible===h||(b.visible=h,this.refresh())}sn(){super.sn();this.tyj(!0)}tyj(b){const h=this.root.RLb;yf.c(this.Rc)&&this.JIl();this.Rc=Og.a.EZa(this.Rc);this.x5c&&this.Rc.appendChild(this.x5c);for(const r of this.children)r.visible&&(r.hE(),this.Rc.appendChild(r.Rc),r.$ra());this.a1&&b&&this.oZl();h&&h.F0();this.dirty=!1}oZl(){if(this.a1.visible&&this.a1.children.count&&(this.WRh(0,0),this.pVl(this.bqa,
this.a1,this.Rwa))){let b=0,h=0;const r=this.bqa?this.bqa.Pkc():0,A=this.Rwa?this.Rwa.Pkc():0;if(0<A||0<r)A>r?(b=0,h=A-r):(b=r-A,h=0);this.WRh(b,h)}}pVl(b,h,r){let A=!1;0===this.root.t4?(b&&(A=b.q5d()>h.j8d()),!A&&r&&(A=h.q5d()>r.j8d())):(b&&(A=b.q5d()<h.j8d()),!A&&r&&(A=h.q5d()<r.j8d()));return A}WRh(b,h){0===this.t4?(this.a1.Rc.style.marginLeft=b+"px",this.a1.Rc.style.marginRight=h+"px"):(this.a1.Rc.style.marginRight=b+"px",this.a1.Rc.style.marginLeft=h+"px")}JIl(){this.hE()}pv(){this.Rfi(()=>{bE.a.prototype.pv.call(this)})}Dua(b){b=
this.P1c(b);yf.c(b)||this.Rfi(Object(E.a)(b,b.rn,"pollForStateAndUpdate"))}Rfi(b){this.$qc=this.ybb=!1;b();if(this.ybb||this.$qc)this.zOk||this.refresh(),this.scale()}fR(b){if(!Object(Xa.a)(yw,b)&&!Object(Xa.a)(YC,b))throw Error.create("Only children of type ButtonDock and HeroDock can be added to a Toolbar");if(Object(Xa.a)(YC,b)&&b.alignment===Nj.a.Rfb)for(const h of this.children)if(h.alignment===Nj.a.Rfb)throw Error.create("Can't add a centered buttondock because one is already present.");}get cssClass(){let b=
"cui-toolbar-toolbar ";0===this.$Nd?(b+="cui-toolbar-onerow ",y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.kba||(b+="UITextTranformUpperCase ")):1===this.$Nd&&(b+="cui-toolbar-singledock ");return b+super.cssClass}get dAa(){return"div"}get fca(){return 26}get T_j(){return this.MQ}set T_j(b){this.MQ=b}KBl(b){b=b[Nj.a.Lx];return new YC(this.root,b.Id,b)}hE(){super.hE();this.Rc.setAttribute("role","toolbar");this.properties.Title&&this.Rc.setAttribute("title",this.properties.Title)}dPa(b){return this.root&&
this.root.tuc(b)?!0:!1}KQo(){this.f_a()}scale(){super.scale();if(!Og.a.Ws(this.properties.Scale)||this.c0e)return!1;yf.c(this.bqa)||(this.bqa.visible=!0,this.bqa.bAf());yf.c(this.a1)||(this.a1.visible=!0,this.a1.bAf());yf.c(this.Rwa)||(this.Rwa.visible=!0,this.Rwa.bAf());this.tyj(!1);const b=this.Rc.offsetWidth,h=yf.c(this.bqa)?0:this.bqa.Pkc(),r=yf.c(this.a1)?0:this.a1.Pkc(),A=yf.c(this.Rwa)?0:this.Rwa.Pkc();A+r+h>=b&&(A+h>=b?(this.gNi(this.a1),A>=b?(this.gNi(this.bqa),this.Ivg(this.Rwa,b)):this.Ivg(this.bqa,
b-A)):this.Ivg(this.a1,b-A-h));this.ybb=!1;this.sn();return!1}gNi(b){b&&(b.visible=!1)}Ivg(b,h){b&&b.qIo(h)}}Object(u.a)(ZC,"Toolbar",Sl.a,[1773]);class $C extends ZC{constructor(b,h,r,A,M=!1){super(b,h,r,!1,!1,A,M);this.vrh=!0}get fca(){return 7}get cssClass(){return $C.V$o+" "+super.cssClass}static get V$o(){let b="cui-statusbar";y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.kba||(b+=" UISmallFont UITextTranformUpperCase");return b}}Object(u.a)($C,"StatusBar",ZC,[]);var Vq=d(1454);class OE extends Vq.a{constructor(){super();
this.toolbar=null;this.cfe=!1}}Object(u.a)(OE,"ToolbarBuildContext",Vq.a,[]);class GJ extends Ap.Builder{constructor(b,h,r,A){super(b,h,Oi.Task.X6(r),A);this.TZn=M=>{this.hAg(this.ufl(M.Ghd,M.$Vc));this.toolbar.T_j=this;this.toolbar.sn();this.placeholder.appendChild(this.toolbar.Rc);Og.a.qg(this.placeholder,"loaded");this.iza.continueWith(()=>{this.iza.result.YVb(this.toolbar)},11)};if(yf.c(h))throw Error.create("Toolbar placeholder DOM element is null or undefined.");}get toolbar(){return this.root}hAg(b){this.root=
b}get lIg(){return this.options}sfl(){const b=new OE,h=new TG.a;h.id="toolbar";h.nid=1;h.handler=this.TZn;h.data=b;this.Vza.Uue(h)}ufl(b,h){var r=Nj.a.Vka(b,Nj.a.Hhk);yf.c(r)&&(r=Nj.a.Vka(b,Nj.a.Zgk),h.cfe=!0);if(yf.c(r))throw Error.create("No toolbar element was present in the data");b=new Nj.a(r);r=y.AFrameworkApplication.J.$("ToolbarScalingRedundancyEliminationIsEnabled");h.cfe?this.hAg(new $C(b.attributes[Nj.a.id],b.attributes,this,this.Oda,r)):this.hAg(new ZC(b.attributes[Nj.a.id],b.attributes,
this,this.lIg.U$o,this.lIg.yAe,this.Oda,r));this.toolbar.rza=this.options.rza;this.toolbar.EEe=!0;this.toolbar.sn();b=Nj.a.yx(Nj.a.Vka(b.node,Nj.a.xdk));h=this.Zcl(b,h);for(const A of h)this.toolbar.Vf(A);return this.toolbar}Zcl(b,h){const r=[];for(let A=0;A<b.length;A++)this.lXa(b[A])||Array.add(r,this.Bdl(b[A],h));return r}Bdl(b,h){const r=Nj.a.k3c(b);let A=null;r===Nj.a.cck?A=this.hdl(b,h):r===Nj.a.hek&&(A=this.Ydl(b,h));return A}Ydl(b,h){var r=new Nj.a(b);r=new yw(this.root,r.attributes[Nj.a.id],
b[Nj.a.Lx]);r.bNi=this.lIg.YGn;b=Nj.a.Vka(b,Nj.a.FAb);b=Nj.a.yx(b);const A=[];for(let aa=0;aa<b.length;aa++){var M=b[aa];this.lXa(M)||(M=this.Jja(M,h),Array.add(A,M))}r.w5c=A;return r}hdl(b,h){new Nj.a(b);const r=this.toolbar.KBl(b);b=Nj.a.Vka(b,Nj.a.FAb);b=Nj.a.yx(b);for(let A=0;A<b.length;A++){if(this.lXa(b[A]))continue;const M=this.tfl(b[A],h);r.Vf(M)}return r}tfl(b,h){var r=new Nj.a(b);const A=r.name;r=r.attributes[Nj.a.uBc];let M;M=h.cfe?"Small14":"Small";switch(A){case Nj.a.button:return b=
this.Jja(b,h),b.GW(yf.b(r)?M:r);case Nj.a.PJa:return M=h.cfe?"Medium14":"Medium",b=this.Jja(b,h),b.GW(yf.b(r)?M:r);case Nj.a.label:return b=this.Jja(b,h),b.GW(yf.b(r)?M:r);case Nj.a.separator:return b=this.Jja(b,h),b.GW("Small");case Nj.a.toggleButton:return b=this.Jja(b,h),b.GW(yf.b(r)?M:r);default:throw Error.create("Invalid control type.");}}}Object(u.a)(GJ,"ToolbarBuilder",Ap.Builder,[]);var Rr=d(2084);class CB{constructor(b,h,r,A,M,aa){this.ivb=()=>{this.toolbar.rn()};this.sK=b;b=new Dn.a(Bk.a.b6a,
WordEditorIntl.WordEditorStrings,null,null,[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings]);A=new Eu;A.bJ={};aa=3!==aa.mode;A.bJ.HeaderToolbarControlsRight=aa;A.bJ.HeaderToolbarButtonDockRight=aa;A.bJ.HeaderToolbarButtonRemovePageNumbers=aa;M=new GJ(A,this.sK,this,M);M.Vza=new Rr.a(CB.XXm,b);M.sfl();this.oqa=M.toolbar;r.execute(oa=>{this.toolbar.oH=oa});this.toolbar.refresh();this.toolbar.rn();this.hi=h;h.E5a(this.ivb)}get toolbar(){return this.oqa}dispose(){this.hi.Juc(this.ivb);this.toolbar&&(this.toolbar.dispose(),
this.oqa=null)}refresh(){this.toolbar.refresh()}setFocus(){this.toolbar.KQo()}GSl(){this.toolbar.H6()}YVb(){}}CB.XXm="WordEditorHeaderToolbarData";Object(u.a)(CB,"HeaderFooterToolbar",null,[349,438]);class UG{constructor(b,h,r,A,M){this.hi=b;this.ANe=h;this.Bd=r;this.Oda=A;this.ga=M}create(b){return new CB(b,this.hi,this.ANe,this.Bd,this.Oda,this.ga)}}Object(u.a)(UG,"Factory",null,[401]);class HJ{constructor(b,h){this.Zc=b;this.ql=h}zHl(b){return'<Menu Id="HeaderToolbarSectionMenu"><MenuSection Id="HeaderToolbarSectionSection" DisplayMode="Menu16"><Controls Id="HeaderToolbarSectionControls">'+
this.yHl(b)+"</Controls></MenuSection></Menu>"}yrm(b){const h=this.Zc.Rl();h.set(b);h.vb(8);h.ld(8);return h}yHl(b){if(!b)return"";let h="";b=this.yrm(b);this.ql.gVa(b,r=>{const A=this.ql.PIi(r);r=r.getValue(Mc.a.jna);h+=Aj.k(r.toString(),r.toString(),Fc.a.Fxg.toString(),Fc.a.Pmg.toString(),String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,A));return!0});return h}}Object(u.a)(HJ,"HeaderFooterToolbarGenerator",null,[400]);var Fq=d(130);class px extends oB.a{constructor(b,
h,r,A,M,aa,oa){super(b,h,r,A);this.nv=()=>{this.msd(this.Cb)};this.sK=b.container;this.ix=document.createElement("div");this.VP(this.ix);this.MGa=M;this.TQa=aa;this.$n.execute(Ja=>{Ja.YX(this.nv)});this.IM=oa;this.sK.style.backgroundColor=this.IM.$jc()}dispose(){super.dispose();this.$n.instance&&this.$n.instance.nNa(this.nv)}get $n(){return null!=this.zWg?this.zWg:this.zWg=Za.a.instance.Ra(6)}JB(b){this.sK.classList.add("HeaderFooterViewElement");this.ix.classList.add("HeaderFooterViewContent");this.msd(b.currentNode)}J6(b){this.ix.parentNode&&
this.ix.parentNode===this.sK||(this.sK.appendChild(this.ix),this.TQa.instance&&this.TQa.instance.lAg(this.jc,this.sK));super.J6(b)}fNb(b){Fq.a.$d(()=>{Fq.a.prototype.fNb.call(this,b);this.W4j();this.TQa.instance&&this.TQa.instance.$3j(this.jc,this.ix.style.paddingLeft,this.ix.style.paddingTop)},"HFVE:UFO")}msd(b){this.$n.instance&&this.$n.instance.$td(this.ix);this.W4j();b=this.MGa.ukc(b);this.ix.style.paddingLeft=b.Zec+"px";this.ix.style.width=b.ZVc+"px";this.TQa.instance&&this.TQa.instance.$3j(this.jc,
this.ix.style.paddingLeft,this.ix.style.paddingTop)}W4j(){if(this.$n.instance){this.ix.style.paddingTop="";var b=Co.a.QB(this.ix);b.paddingTop&&(b=Fd.a.zP(b.paddingTop),this.ix.style.paddingTop=Math.round(b/this.$n.instance.yj)+"px")}}}Object(u.a)(px,"HeaderFooterViewElement",oB.a,[]);class VG{constructor(b,h,r){this.MGa=b;this.TQa=h;this.IM=r}create(b,h,r,A){return new px(b,h,r,A,this.MGa,this.TQa,this.IM)}}Object(u.a)(VG,"Factory",null,[399]);var kv=d(351),ky=d(196),IJ=d(949),WG=d(580);class PE extends kv.a{constructor(b,
h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc,zc,Yc,Kd,ke,ge){super(h,aa,oa,Ja,fb,ky.a.cOi,Cb,Gb,Sb,pc,zc,Yc,Kd,ke,ge);this.isHeader=this.isHeader=b;this.j4a=M;this.j4a.uqd=this;A(this);this.Txd=r;this.PFa=document.createElement("div");this.PFa.setAttribute("Unselectable","on");this.PFa.setAttribute("hideselection","hideselection");this.PFa.setAttribute("style","outline:none;");this.PFa.innerText=WordEditorIntl.WordEditorStrings.l_HeaderFooterNoContentAvailableMessage;this.PFa.tabIndex=0;this.features.HRj=!0;this.features.rmf=
!0}get lYf(){return!0}GOf(){const b=this.Txd.UEf(this);return IJ.ViewReference.TG(this,b)}Twf(b){Object(Xa.a)(PE,b)||this.Txd.dismiss()}get MRf(){return"WordEditor"+(this.isHeader?"Header":"Footer")+"HiddenLabel"}M3c(){return WG.a.Tcj}Pv(){super.Pv();this.j4a.uji()}kF(b,h=null){this.PFa.parentNode&&this.PFa.parentNode.removeChild(this.PFa);super.kF(b,h);this.j4a.gji(this.od.mk)}detach(){this.j4a.tji();super.detach();this.PFa.parentNode||this.container.insertBefore(this.PFa,this.container.firstChild)}znd(){this.mw?
super.znd():this.PFa.focus()}t3d(){this.Pv()}}Object(u.a)(PE,"HeaderFooterView",kv.a,[437,149,150,83,10,151,152,153,154]);class XG{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc,zc,Yc,Kd){this.Txd=b;this.mQk=h;this.lQk=r;this.Ky=A;this.kd=M;this.qqa=aa;this.ga=oa;this.F2a=Ja;this.sya=fb;this.s$=Cb;this.RQk=Gb;this.qu=Sb;this.oC=pc;this.ig=zc;this.ri=Yc;this.Lxd=Kd}create(b,h){return new PE(b,h,this.Txd,this.mQk,this.lQk(),this.Ky,this.kd,this.qqa,this.ga,this.F2a,this.sya,this.s$,this.RQk,this.qu,
this.oC,this.ig,this.ri,this.Lxd)}}Object(u.a)(XG,"Factory",null,[398]);class JJ{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc,zc,Yc,Kd,ke,ge){this.pxh=!1;this.uEh="SourceControlId";this.Ogp=1;this.Pgp=1E3;this.Wqe=(de,Sd,be,Rf,Mf)=>{if(1===be)return 32;this.wBd(Mf[this.uEh]);Mf[Pd.a.Text]=this.s2e.S4n(this.Ljb.yRb);return 32};this.Zgo=(de,Sd,be,Rf,Mf)=>{if(1===be)return 32;Mf[Vg.a.On]=this.Ljb.yRb;return 32};this.t1m=(de,Sd,be,Rf,Mf)=>{if(1===be)return 32;this.Ljb.cup(Mf[Vg.a.On]);return 32};this.cBj=
(de,Sd,be)=>{if(1===be)return 32;if(this.mda){Sd=Object(vo.a)().Iu(Sd.view.od);be=vd.a.Za(Sd);const Rf=this.Yd.W5a();try{const Mf=this.Qc.Nc(15);try{Mf.Bb(Sd),Mf.Ii=de,br.a.instance.gVa(be,Yj=>{this.q9b.Qjd(Yj,this.dmm,this.YRo);return!0})}finally{Mf&&Mf.dispose()}}finally{Rf&&Rf.dispose()}}return 32};this.Kgd=(de,Sd,be,Rf,Mf)=>{if(1===be)return 32;Mf.MenuItems=this.$Fk.value;this.pxh?this.Ljb.ECo():this.pxh=!0;return 32};this.n8m=(de,Sd,be,Rf,Mf)=>{if(1===be)return 32;const Yj=this.wBd(Mf[this.uEh]);
if(this.mda){Sd=Object(vo.a)().Iu(Sd.view.od);be=vd.a.Za(Sd);Rf=this.Qc.Nc(15);try{Rf.Bb(Sd);Rf.Ii=de;let Ji=null;const sm=this.Xd.Wf("UserAction","InsertPageNumber");br.a.instance.gVa(be,jn=>{this.mda.Nea||this.zsk(jn);Ji=this.r2e.l8m(jn,Yj,this.Ljb.yRb)||Ji;return!0});sm.stop();if(!Ji)return 8;this.g4o(Ji,Yj)}finally{Rf&&Rf.dispose()}this.Yd.Yu(12)}return 32};this.R4n=()=>32;this.R4o=(de,Sd,be,Rf,Mf)=>{if(1===be)return 32;2===be&&this.YRa.showCallout(Mf);return 32};this.Q4o=(de,Sd,be,Rf,Mf,Yj)=>
this.P7e.create(de,Sd,be,Rf,Mf,Yj);this.JSl=(de,Sd,be)=>{if(1===be)return 32;this.YRa.Xei();return 32};this.X2o=de=>{y.AFrameworkApplication.va.Gua(null,Fc.a.fTj,de.Yl,null)};this.dmm=de=>{const Sd=gg.a.instance.gb.currentSelection;let be=-1;for(const Rf of Sd)if(Rf.node===de){be=Rf.cpBegin;break}return{returnValue:be,Hde:ze.a.Am(Sd)}};this.YRo=(de,Sd)=>{de=sc.SelectionFactory.ue(de,Sd);gg.a.instance.Kc(de)};this.ga=b;this.Qc=h;this.Gb=r;this.Ljb=A;this.mda=M;this.Wm=aa;this.s2e=oa;this.r2e=Ja;this.q9b=
fb;this.YRa=Cb;this.hb=Gb;this.P7e=Sb;this.Xd=pc;this.Yd=zc;this.wBd=Yc;this.zsk=ge;this.$Fk=new Qf.a(()=>this.Ljb.lBm())}Xb(){this.ga.fb(Fc.a.Kgd,lc.a.view,this.Kgd,100);this.ga.fb(Fc.a.hpj,lc.a.view,this.R4n,68);this.ga.fb(Fc.a.qRi,lc.a.view,this.n8m,4);this.ga.fb(Fc.a.yRb,lc.a.view,this.t1m,4);this.ga.fb(Fc.a.Qjd,lc.a.view,this.cBj,4);this.ga.fb(Fc.a.mwo,lc.a.view,this.cBj,4);this.ga.fb(Fc.a.rng,lc.a.application,this.Zgo,97);this.ga.fb(Fc.a.Wqe,lc.a.application,this.Wqe,97);this.ga.fb(Fc.a.eTj,
lc.a.view,this.R4o,4);this.ga.qW(Fc.a.fTj,lc.a.view,this.Q4o,100);this.ga.fb(Fc.a.ISl,lc.a.view,this.JSl,4)}g4o(b,h){const r=b.Jb.paragraph;if(r){var A=this.Wm.bdd(r);A&&this.mda.Bka(A)}A=this.mda.Nea;this.mda.show(4>h);r&&this.nRo(r)&&(this.uVo(b,r),this.DXk(b,A))}nRo(b){let h;if(!({isHeader:h,aHg:b}=this.Wm.hHi(b)).returnValue)return!1;this.mda.QDa(b,h);return!0}uVo(b,h){b=sc.SelectionFactory.ue(h,b.Jb.cp);this.hb.Kc(b)}DXk(b,h){h=new xc.a(2,1,h?this.Ogp:this.Pgp,this.X2o);h.Yl=b;this.Gb.Zb(h)}}
Object(u.a)(JJ,"PageNumbersActor",null,[436]);class YG{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc){this.ga=b;this.Gb=h;this.Ljb=r;this.s2e=A;this.r2e=M;this.q9b=aa;this.YRa=oa;this.P7e=Ja;this.Wm=fb;this.Yd=Cb;this.wBd=Gb;this.vPk=Sb;this.lja=pc}create(b,h){return new JJ(this.ga,new Qn.a,this.Gb,this.Ljb,b,this.Wm,this.s2e,this.r2e,this.q9b,this.YRa,gg.a.instance,this.P7e,qa.StaticActiveAppFrame.za().Vr,this.Yd,this.wBd,this.vPk,this.lja,h)}}Object(u.a)(YG,"Factory",null,[397]);var qL=d(1988),
$z;(function(b){b[b.small=0]="small";b[b.r4p=1]="mediumSmall";b[b.Ds=2]="medium";b[b.CX=3]="large"})($z||($z={}));Object(u.b)("ModalCalloutSize",$z);var QE;(function(b){b[b.sCe=0]="topCenter";b[b.Vkq=1]="topJustified";b[b.Wkq=2]="topLeft";b[b.Xkq=3]="topRight";b[b.Ekf=4]="bottomCenter";b[b.vRp=5]="bottomLeft";b[b.wRp=6]="bottomRight"})(QE||(QE={}));Object(u.b)("BeakLocation",QE);class bo{constructor(b,h,r){this.Ngp=1;this.X4e=!1;this.H$b=null;this.Jqo=()=>{this.hb.tA(this.Hua);this.X4e=!0;this.H$b=
null};this.Hua=(A,M)=>{if(A=M.Rm.currentSelection)1<A.length||!A.length?A=!0:(A=A.Qa,A=A.cpEnd-A.cpBegin,A=1<A||!A),A&&this.yrk()};this.Gb=b;this.hb=h;this.yrk=r}$A(){this.CXk()}Jca(){this.X4e?(this.hb.Rga(this.Hua),this.X4e=!1):this.H$b&&(this.Gb.uf(this.H$b),this.H$b=null)}CXk(){this.H$b=new xc.a(2,1,this.Ngp,this.Jqo);this.Gb.Zb(this.H$b)}}Object(u.a)(bo,"CalloutDismissManager",null,[]);class aA{constructor(b,h,r,A){this.dismiss=()=>{this.VJ&&(this.FFc.Jca(),this.Mcd.dismiss())};this.Mcd=b;this.Mp=
A;this.FFc=new bo(h,r,this.dismiss)}get VJ(){return this.Mcd.VJ}show(){if(!this.VJ){const b=document.createElement("div");b.classList.add(aA.Q4n);b.innerText=WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText;this.Mcd.content=b;this.Mcd.show();this.Mp&&this.Mp.sendNotification(WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText,!0);this.FFc.$A()}}dispose(){this.dismiss();this.Mcd.dispose()}static rFl(b,h){h=qL.a.s9h(Le.a.getElementBounds(b.targetElement),h,qa.StaticActiveAppFrame.za().XF,
$z.small);h.Eja=aA.uGf(b);h.Bu=!1;return h}static uGf(b){let h=QE.Ekf;Object(Xa.a)(437,b.view)&&b.view.isHeader&&(h=QE.sCe);return h}}aA.Q4n="PageNumbersCalloutControl";Object(u.a)(aA,"PageNumbersCallOutControl",null,[435]);class KJ{constructor(b,h,r){this.cW=null;this.WV=!1;this.dismiss=()=>{this.VJ&&this.cW&&em.UISurfaces.aP().then(A=>{this.FFc.Jca();A.removeNotification(this.cW);this.WV=!1;return null},A=>{v.ULS.sendTraceTag(593352339,383,15,"Failed to GetNotificationsAPIAsync: {0}",A);return null})};
this.il=b;this.FFc=new bo(h,r,this.dismiss)}get VJ(){return this.WV}show(){this.VJ||em.UISurfaces.aP().then(b=>{const h=b.callout(Object.assign(new io.a,{target:this.il,content:WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText})),r=Object.assign(new Lj.a,{telemetryId:"PageNumbersCallout",onShow:()=>{this.WV=!0},expirationOptions:Object.assign(new Cm.a,{displayTimeoutSeconds:7,onExpire:()=>{this.dismiss()}})});this.cW=b.addNotification(h,r);this.FFc.$A();return null},b=>{v.ULS.sendTraceTag(593352340,
383,15,"Failed to GetNotificationsAPIAsync: {0}",b);return null})}}Object(u.a)(KJ,"ReactPageNumbersCallOutControl",null,[435]);class ZG{constructor(b,h,r){this.hb=h;this.Gb=b;this.Mp=r}create(b,h){if(y.AFrameworkApplication.ua.Ib&&y.AFrameworkApplication.ua.Ib.rXa)return new KJ(h.targetElement,this.Gb,this.hb);b=aA.rFl(h,b);return new aA(b,this.Gb,this.hb,this.Mp,y.AFrameworkApplication.ua.tS)}}Object(u.a)(ZG,"Factory",null,[396]);class LJ{constructor(b,h){this.dG=null;this.ZFk=b;this.wj=h}get control(){return this.dG}showCallout(b){this.control&&
this.control.VJ&&this.control.dismiss();this.dG=this.Kbo(b);this.control.show()}Xei(){this.control&&(this.control.dismiss(),this.dG=null)}Kbo(b){const h=this.wj.psa();this.dG=this.ZFk.value.create(h,b);return this.control}}Object(u.a)(LJ,"PageNumbersCalloutControlManager",null,[395]);var MJ=d(761);class NJ extends gy.a{constructor(){super();this.Text=null}get Type(){return 7}}Object(u.a)(NJ,"PageNumberGalleryButtonProps",gy.a,[]);const bA=(b,h,r)=>{b=b.Rl();b.set(r);h.rVb(b);return b};class Rv{constructor(b,
h,r){this.MUe=!1;this.lja=h;this.Xm=r}get yRb(){return this.MUe}lBm(){const b=Object.assign(new aj.a,{Id:"menuPageNumbersDropDown",MenuSectionList:[]});b.MenuSectionList.push(this.iVk());b.MenuSectionList.push(this.$Vk());b.MenuSectionList.push(this.CWk());return b}cup(b){this.MUe=b;this.qyj()}ECo(){this.MUe=!1;const b={};b[Rv.gPi]="CheckboxModel";this.lja(b);this.qyj()}iVk(){const b=Object.assign(new te.a,{Id:"msIncludePageCount",ControlsId:"ctrlIncludePageCount",Title:I.a.Jf(WordEditorIntl.WordEditorStrings.L_PageNumbersSectionHeaderForAdd),
ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new MJ.a,{Id:Rv.u1m,Command:Fc.a.yRb.toString(),QueryCommand:Fc.a.rng.toString(),LabelText:I.a.Jf(WordEditorIntl.WordEditorStrings.L_IncludePageCount),Alt:I.a.Jf(WordEditorIntl.WordEditorStrings.L_IncludePageCountAlt),KeyTip:CommonUIStrings.l_IncludePageCountKeytip,UseUncheckedImage:!0,CloseMenuWhenExecuted:!1});b.ControlList.push(h);return b}$Vk(){const b=Object.assign(new te.a,{Id:"msPageNumbersPosition",ShowMenuSectionSeparator:!1,
ControlList:[]}),h=Object.assign(new Mo.a,{Id:"galleryPageNumbersPosition",ExternalId:"PageNumbers",ExternalGalleryId:"InsertPageNumberGallery",Type:7,Width:3,ElementDimensions:"Size61by75",GalleryItems:[]});if(this.Xm){for(var r=3;1<=r;r--)h.GalleryItems.push(this.$If(r));for(r=6;4<=r;r--)h.GalleryItems.push(this.$If(r))}else for(r=1;6>=r;r++)h.GalleryItems.push(this.$If(r));b.ControlList.push(h);return b}CWk(){const b=Object.assign(new te.a,{Id:"msRemovePageNumbers",ControlsId:"ctrlRemovePageNumbers",
DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new hk.a,{Id:"btnRemovePageNumber",Command:Fc.a.Qjd.toString(),LabelText:I.a.Jf(WordEditorIntl.WordEditorStrings.L_RemovePageNumbers),Alt:I.a.Jf(WordEditorIntl.WordEditorStrings.L_RemovePageNumbersAlt),Image16by16:y.AFrameworkApplication.Ss,Image16by16Class:Gg.getImageClass("WordRemovePageNumbers_16x16x32"),KeyTip:CommonUIStrings.l_RemovePageNumbersKeytip});b.ControlList.push(h);return b}$If(b){const h=Rv.Jhg+b.toString();var r=Object,A=r.assign,
M=new NJ,aa=Fc.a.qRi.toString(),oa=Fc.a.Wqe.toString(),Ja=I.a,fb=Ja.Jf;let Cb="";switch(b){case 1:Cb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopLeftAlt;break;case 2:Cb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopCenterAlt;break;case 3:Cb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopRightAlt;break;case 4:Cb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomLeftAlt;break;case 5:Cb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomCenterAlt;break;case 6:Cb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomRightAlt}return A.call(r,
M,{Id:h,Command:aa,QueryCommand:oa,Alt:fb.call(Ja,Cb)})}qyj(){const b={};for(let h=1;6>=h;h++)b[Rv.Jhg+h.toString()]="PageNumberGalleryButtonModel";b[Rv.gPi]="CheckboxModel";this.lja(b)}static mBm(b){return b?parseInt(b.substr(Rv.Jhg.length)):1}}Rv.u1m="btnIncludePageCount";Rv.gPi="IncludePageCount";Rv.Jhg="btnPageNumbersPosition";Object(u.a)(Rv,"PageNumbersControl",null,[394]);class qx{constructor(b,h,r,A,M=null,aa=null,oa=null,Ja=null){this.bsm=(fb,Cb)=>{const Gb=new fc.a;fb=4>fb;switch(Cb){case 1:case 2:Gb.add(fb?
0:3);break;case 3:case 4:Gb.add(fb?0:3),Gb.add(fb?1:4)}return Gb};this.Jkm=(fb,Cb,Gb)=>{var Sb=bA(this.Zc,this.Wm,fb);this.Wm.sVb(Sb,Gb);let pc=this.Opk(Sb,Cb);if(pc)this.q9b.GBj(pc);else{Sb=bA(this.Zc,this.Wm,fb);this.Wm.sVb(Sb,Gb);Sb.Zd();if(Db.OutlineElementReader.Nh(Sb)&&(Bb.OutlineElementNavigator.Me(Sb),Gd.ParagraphReader.Bh(Sb))){Sb=Sb.currentNode;const zc=this.mHi(Cb);Gd.ParagraphReader.Sy(Sb)===zc&&this.q9b.GBj(Sb)&&(pc=Sb)}pc||(Sb=bA(this.Zc,this.Wm,fb),this.Wm.sVb(Sb,Gb),this.GN.QRb(Sb,
null,!0),pc=Bb.OutlineElementNavigator.Me(Sb),this.rH(Cb,pc))}return pc};this.Kkm=(fb,Cb)=>{let Gb=null;fb.Ub(1);if(Db.OutlineElementReader.Nh(fb)&&(fb.Ub(2),Ii.TableReader.isTable(fb))){var Sb=fb.currentNode;if(3===Ii.TableReader.Fh(Sb)){let pc=0;Sb=Ii.TableReader.Eo(Sb);switch(Cb){case 1:case 4:pc=Sb?2:0;break;case 2:case 5:pc=1;break;case 3:case 6:pc=Sb?0:2}Oh.moveToCellContent(fb,0,pc);fb.currentNode&&Db.OutlineElementReader.Nh(fb)&&(fb=Bb.OutlineElementNavigator.Me(fb),Gd.ParagraphReader.Vb(fb)&&
(Gb=fb))}}return Gb};this.ghn=(fb,Cb)=>{const Gb=bA(this.Zc,this.Wm,fb);fb=Gb.currentNode.ka(Mc.a.jna,0);this.Wm.sVb(Gb,Cb);Cb=Gb.currentNode.ka(Mc.a.jna,0);return fb===Cb};this.Zc=b;this.aGk=h;this.q9b=r;this.Wm=A;this.EHc=M||this.bsm;this.Ppk=aa||this.Jkm;this.Opk=oa||this.Kkm;this.czk=Ja||this.ghn}get GN(){return null!=this.v0g?this.v0g:this.v0g=Za.a.instance.resolve(110)}l8m(b,h,r){var A=bA(this.Zc,this.Wm,b).ko;A=this.Wm.ila(A);A=this.EHc(h,A);let M=null;for(let oa=0;oa<A.length;oa++){var aa=
A.sg(oa);this.czk(b,aa)&&(aa=this.Ppk(b,h,aa),M=this.aGk.ZVk(aa,r)||M)}return M}rH(b,h){qx.tha.Fnd(4>b?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,h);qx.nl.rH(h,this.mHi(b))}mHi(b){let h=1;switch(b){case 1:case 4:h=1;break;case 2:case 5:h=2;break;case 3:case 6:h=3}return h}static get nl(){return null!=qx.r1g?qx.r1g:qx.r1g=Za.a.instance.resolve(348)}static get tha(){return null!=qx.b3g?qx.b3g:qx.b3g=Za.a.instance.resolve(392)}}Object(u.a)(qx,"PageNumbersInserter",
null,[393]);var DB=d(882),OJ=d(886);class zw{constructor(b,h,r=null,A=null,M=null){this.fBl=(aa,oa)=>{aa=wc.a.Tc(aa,Gd.ParagraphReader.textLength(aa));const Ja=aa.node.Ic;return Ja?zw.Fg.yla(aa,fb=>{fb=OJ.a.getInstance(fb,DB.a.wIf(oa));this.uXd(fb,15,Ja,oa);this.uXd(fb,47,Ja,oa);this.uXd(fb,16,Ja);this.uXd(fb,17,Ja);return fb}):null};this.R8m=(aa,oa)=>{aa=wc.a.Tc(aa,Gd.ParagraphReader.textLength(aa));zw.Fg.Ve(aa,oa)};this.Qc=b;this.bId=r||WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;
this.uNe=A||this.fBl;this.lGh=M||this.R8m}ZVk(b,h){const r=this.Qc.Nc(15);r.Bb(b);var A=Gd.ParagraphReader.text(b),M=!1;0<A.length&&" "!==A.charAt(A.length-1)&&(M=!0);if(h){h=String.format(this.bId,"#","$");M&&(h=" "+h);M=h.indexOf("#");A=h.indexOf("$");v.ULS.shipAssertTag(4256717,309,-1!==M,"{0}",{["PageNumberIndex"]:M});v.ULS.shipAssertTag(4256718,309,-1!==A,"{0}",{["PageCountIndex"]:A});v.ULS.shipAssertTag(4256719,309,M!==A,"{0}",{["PageNumberIndex"]:M,["PageCountIndex"]:A});let Ja;let fb;if(M<
A){var aa=M;Ja=A;var oa=DB.a.j2c(0);fb=DB.a.j2c(1)}else aa=A,Ja=M,oa=DB.a.j2c(1),fb=DB.a.j2c(0);this.YUf(b,h,0,aa);oa=this.uNe(b,oa);this.YUf(b,h,aa+1,Ja);aa=this.uNe(b,fb);this.YUf(b,h,Ja+1,h.length);b=M<A?oa:aa}else M&&this.lGh(b," "),b=this.uNe(b,DB.a.j2c(0));r.dispose();return b}uXd(b,h,r,A=null){const M=new Hn.a;M.setValue(He.a.Eca,!0);M.setValue(Mc.a.fOb,1);M.setValue(Mc.a.ft,h);switch(h){case 15:M.setValue(Mc.a.vXa,!0);M.setValue(Mc.a.E2,A);break;case 47:M.setValue(Mc.a.E2,A);break;case 17:M.setValue(Mc.a.pTb,
!0)}h=r.ku(M,N.a.create());this.UWk(b,h)}UWk(b,h){b.Mya(h,N.a.nil,Gn.AParagraphNode.gE,null)}YUf(b,h,r,A){h=h.substring(r,A);0<h.length&&this.lGh(b,h)}static get Fg(){return zw.Qd||(zw.Qd=Za.a.instance.resolve(322))}static set Fg(b){zw.Qd=b}}zw.Qd=null;Object(u.a)(zw,"PageNumbersNodeLevelInserter",null,[392]);class gs{S4n(b){return gs.NDm(b)}static NDm(b){return String.format(b?WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount:WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewText,
gs.Xoj,gs.Xoj)}}gs.Xoj="1";Object(u.a)(gs,"PageNumbersPositionPreviewGenerator",null,[391]);class PJ{constructor(){this.Qah=String.format(WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount,"\ufffc","\ufffc");this.kpk=this.Qah.length}iXm(b){let h=b.characterData.lastIndexOf("\ufffc");return-1!==h&&h+1===Gd.ParagraphReader.textLength(b)?{returnValue:!0,Ngd:h}:{returnValue:!1,Ngd:-1}}NVm(b){let h=b.characterData.lastIndexOf(this.Qah);return-1!==h&&h+this.kpk===Gd.ParagraphReader.textLength(b)?
{returnValue:!0,Ngd:h}:{returnValue:!1,Ngd:-1}}HWm(b){return cn.a(b,9)?!0:!1}}Object(u.a)(PJ,"PageNumbersReader",null,[390]);class ot{constructor(b,h,r,A,M,aa=null,oa=null){this.lwo=(Ja,fb,Cb,Gb)=>{Ja=bA(this.Zc,this.Wm,Ja);this.Wm.sVb(Ja,fb);fb=ef.a.xq(Ja);for(Ja=!1;fb.moveNext();){const Sb=fb.currentNode;if(Gd.ParagraphReader.Vb(fb.currentNode)&&cn.a(fb.currentNode,9)){Ja=!0;let pc;const zc=({Hde:pc}=Cb(Sb,pc)).returnValue;let Yc=zc;Yc=this.Ouo(Sb,Yc);Yc=this.Jwo(Sb,Yc);-1<zc&&(Yc===zc&&pc||Gb(Sb,
Yc))}}Ja&&this.Yd.Yu(12)};this.Zc=b;this.Wm=h;this.t2e=r;this.Yd=A;this.JNc=M;this.EHc=aa||xB.a.dwf;this.qIk=oa||this.lwo;this.bId=WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.Dhh=String.format(this.bId,"#","$");this.rxk=this.Dhh.indexOf("#");this.qxk=this.Dhh.indexOf("$");this.VRe=String.format(this.bId,"\ufffc","\ufffc");this.whh=this.VRe.length}Qjd(b,h,r){var A=bA(this.Zc,this.Wm,b).ko;A=this.Wm.ila(A);A=this.EHc(A);for(const M of A)this.qIk(b,M,h,r)}GBj(b){if(this.t2e.HWm(b)){let h=
-1;if(({Ngd:h}=this.t2e.NVm(b)).returnValue&&this.N_h(b,h)||({Ngd:h}=this.t2e.iXm(b)).returnValue&&this.Oll(b,h))return!0}return!1}Jwo(b,h){var r=b.ra.length;for(let M=0;M<r;M++){var A=b.ra.K(M);A.blob&&9===A.blob.Qh&&(A=A.cp,r=wc.a.createTextRange(b,A,A+1),this.JNc(r,""),r=b.ra.length,M--,h=this.xPh(h,A,1))}return h}Ouo(b,h){let r=b.characterData.indexOf(this.VRe);for(;-1!==r;)this.N_h(b,r)&&(h=this.xPh(h,r,this.whh)),r=b.characterData.indexOf(this.VRe);return h}Oll(b,h){const r=b.ra.sh(h);return r&&
r.blob&&9===r.blob.Qh?(b=wc.a.createTextRange(b,h,h+1),this.JNc(b,""),!0):!1}N_h(b,h){const r=b.ra.sh(h+this.rxk),A=b.ra.sh(h+this.qxk);return r&&r.blob&&9===r.blob.Qh&&A&&A.blob&&9===A.blob.Qh?(b=wc.a.createTextRange(b,h,h+this.whh),this.JNc(b,""),!0):!1}xPh(b,h,r){-1<b&&b>h&&(h=b-h,b=h>r?b-r:b-h);return b}}Object(u.a)(ot,"PageNumbersRemover",null,[389]);class $G{constructor(b,h){this.hBb=this.gBb=null;this.Is=b;this.Gb=h}a3k(){this.Is.style.display="";this.gBb||(this.hBb&&(this.Gb.uf(this.hBb),
this.hBb=null),this.gBb=new xc.a(0,1,10,()=>{this.Is.classList.add("Displayed");this.gBb=null}),this.Gb.Zb(this.gBb))}c3k(){this.Is.classList.remove("Displayed");this.hBb||(this.gBb&&(this.Gb.uf(this.gBb),this.gBb=null),this.hBb=new xc.a(0,1,200,()=>{this.Is.style.display="none";this.hBb=null}),this.Gb.Zb(this.hBb))}}Object(u.a)($G,"PaneControlAnimationHelper",null,[419]);class Wp{constructor(b){this.Gb=b}rBm(b){return new $G(b,this.Gb)}}Object(u.a)(Wp,"PaneControlAnimationHelperFactory",null,[388]);
class Gq{constructor(b,h,r,A,M,aa,oa,Ja,fb=!1){this.P6g=this.oqa=this.TBd=null;this.PXm=()=>{this.Cw.sendNotification(this.P6g+" "+WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText,!0)};this.ga=b;this.y9=h;this.y9.bind(this);this.fWe=r;this.Txa=M;this.Q$e=oa;this.Yb=Ja;this.mDd=fb;this.sia=aa.value.create(r,A);this.y9.Cal(this.sia);this.r1=Xb.KeyInputManager.mc(cf.a.G4,0)}get Cw(){return null!=this.mSg?this.mSg:this.mSg=Za.a.instance.resolve(26)}b4(b){this.y9.b4(b);this.oqa&&
!b&&this.oqa.GSl()}Bka(b){this.TBd!==b&&(this.pob(),this.TBd=b)}EKj(b){if(this.TBd){var h=this.Txa.Y8a(this.TBd,xB.a.asm(b,this.fWe));this.mDd?(this.P6g=this.eri(b,this.fWe),this.sia.j_b(Ne.a.cSd)):this.Hqp(b);h&&this.Hif(h)}}DTh(b){this.mDd&&this.Yb&&(b=this.Yb.ie(b))&&b.G$(this.PXm)}eri(b,h){let r="";switch(b){case 1:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessageForReadOnly:h?
WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessage;break;case 2:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessage;break;case 3:r=3!==this.ga.mode?
h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessage;break;case 4:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessageForReadOnly:h?
WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessage}return r}Hqp(b){this.sia.SLj(this.eri(b,this.fWe),Ne.a.cSd)}qwc(){this.sia.znd()}Hif(b){this.pob();this.sia.kF(b,b.mk)}pob(){this.sia.detach()}IIl(){this.oqa=this.Q$e.value.create(this.y9.pzc);this.xYo(this.oqa)}xYo(b){if(this.Yb){const h=this.Yb.ie(cu.a.U9a);h.parent=id.AFrame.Eq;h.sja(()=>{b.setFocus();this.GWo()});h.bindAction(this.r1,Fc.a.KW)}}GWo(){if(this.Yb){var b=
this.Yb.ie(cu.a.U9a);const h=new Re.DOMFocusListing(()=>this.y9.pzc);h.$ma=!0;h.Yn(1);this.Yb.PKb(this.y9.pzc,b,h);b=this.Yb.getRegion(cu.a.U9a);b.AZa();b.NR=!0;h.Jka&&h.hA(h.Jka)}}dispose(){void 0!==this.oqa&&null!==this.oqa&&(this.Yb.ie(cu.a.U9a).nt(this.r1),this.oqa.dispose())}dpo(){void 0!==this.oqa&&null!==this.oqa&&this.oqa.refresh()}}Object(u.a)(Gq,"PaneControl",null,[418]);class aH{constructor(b,h,r,A){this.Wm=b;this.gwk=h;this.Q$e=r;this.Yb=A}create(b,h,r,A){return new Gq(b,h,r,A,this.Wm,
this.gwk,this.Q$e,this.Yb,y.AFrameworkApplication.J.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}}Object(u.a)(aH,"Factory",null,[387]);var bz=d(1087);class cz extends Oy.a{constructor(b,h,r,A,M,aa,oa,Ja,fb){super();this.init(b);this.qm("ShowCalloutForPageNumberOperation");this.okk=Ja;this.bsb(this.okk,h,A,M,aa);this.nA=0;this.XRa=aa;this.YRa=oa;this.hi=fb;1===this.behavior&&(this.es=32,this.ova())}get PYl(){if(null!=this.lUg)var b=this.lUg;else{var h;b=this.lUg=null===(h=y.AFrameworkApplication.J)||
void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.EndOperationOnFailureIsEnabled",!1)}return b}run(){var b=this.hi.kb.Bw;if(!this.nA){var h=AE.a.zjc(this.XRa,b);this.XRa.llc(b,h)?this.XRa.TAa(b,h).element&&(this.nA=1):this.PYl&&(this.nA=2)}1===this.nA&&(h=AE.a.zjc(this.XRa,b),h=this.XRa.TAa(b,h),b=new bz.a(h.element,b),this.YRa.showCallout(b),this.nA=2);2===this.nA&&(this.es=32,this.ova())}}Object(u.a)(cz,"ShowCalloutForPageNumberOperation",Oy.a,[]);class bH{constructor(b,h,r){this.YRa=
b;this.ga=h;this.z3b=r}create(b,h,r,A,M,aa){return new cz(b,h,r,A,M,aa,this.YRa,this.ga,this.z3b)}}Object(u.a)(bH,"Factory",null,[271]);class Sv{get GN(){return null!=this.t0g?this.t0g:this.t0g=Za.a.instance.resolve(110)}uc(b){b.ia(983,()=>new AB(b.resolve(753),b.resolve(957),b.resolve(958),b.rf(959),b.resolve(459),b.resolve(960),b.resolve(12))).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterView.Factory",()=>new XG(b.resolve(958),vB.a.$pf,()=>b.resolve(726),qa.StaticActiveAppFrame.za().kb,Object(Lb.a)(),
()=>b.resolve(50),y.AFrameworkApplication.va,b.resolve(159),b.Ra(20),b.resolve(23),b.Ra(6),b.Oa(288),b.Oa(19),b.Oa(11),b.Oa(14),b.Oa(13))).as(961).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterViewElement.Factory",()=>new VG(b.resolve(727),b.Ra(194),b.resolve(318))).as(459).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterToolbar.Factory",()=>new UG($l.a.Mm,b.Ra(708),b.resolve(12),$l.a.Mm,y.AFrameworkApplication.va)).as(962).ha();b.ia("WordEditor.HeaderFooter.PaneControl.Factory",()=>new aH(b.resolve(465),
b.rf(961),b.rf(962),Cd.FocusManager.instance())).as(969).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterControl.Factory",()=>new RG(()=>{qa.StaticActiveAppFrame.za().Fe()},b.resolve(465),b.resolve(963),y.AFrameworkApplication.va,b.resolve(230))).as(970).ha();b.ia("WordEditor.HeaderFooter.PageNumbersActor.Factory",()=>new YG(y.AFrameworkApplication.va,Je.a.instance,b.resolve(964),b.resolve(965),b.resolve(966),b.resolve(967),b.resolve(960),b.resolve(968),b.resolve(465),b.resolve(46).instance,Rv.mBm,
Object(E.a)(qa.StaticActiveAppFrame.za(),qa.StaticActiveAppFrame.za().Dsd,"updateRibbonControl"),Object(E.a)(qa.StaticActiveAppFrame.za(),qa.StaticActiveAppFrame.za().eJ,"updateRibbonControls"))).as(959).ha();b.ia(958,()=>new Qr).ha();b.ia(971,()=>new Wp(Je.a.instance)).ha();b.ia(753,()=>new zB(Cd.FocusManager.instance(),qa.StaticActiveAppFrame.za().Ay,b.rf(969),b.rf(970),b.rf(971),y.AFrameworkApplication.va,new Qf.a(()=>qa.StaticActiveAppFrame.za().kb.Jc),y.AFrameworkApplication.J,b.resolve(258),
b.resolve(211))).as(981).ha();b.ia(972,()=>new WC(b.resolve(465),Um.PageReader.instance,new Ul.a,br.a.instance)).ha();b.ia(973,()=>new HJ(new Ul.a,br.a.instance));b.ia(957,()=>new VC(y.AFrameworkApplication.va,b.resolve(465),b.resolve(972),b.resolve(963),br.a.instance,new Ul.a,new Qn.a,b.resolve(973),VC.OIi,b.resolve(974))).ha();b.ia(975,()=>new Eq(Yz.a.instance,Eq.wKm(b.resolve(33)),Eq.jim(),y.AFrameworkApplication.isRtl,Bb.OutlineElementNavigator.je,Eq.sIm(),Eq.Orm(),b.resolve(18)));b.ia(976,()=>
new Zz.a(b.resolve(465),new Ul.a,h=>this.GN.QRb(h,null,Zz.a.bBg),y.AFrameworkApplication.isRtl,Object(E.a)(b.resolve(18),b.resolve(18).C_b,"setRtlSimple"),b.resolve(975),b.resolve(392)));b.ia(977,()=>new Xo(br.a.instance,b.resolve(465),b.resolve(660),b.resolve(976))).ha();b.ia(974,()=>new az(b.resolve(465),new Ul.a,new Qn.a,b.resolve(972),y.AFrameworkApplication.va)).ha();b.ia(963,()=>new yB(b.resolve(977),b.resolve(465),br.a.instance,new Ul.a,y.AFrameworkApplication.va)).ha();b.ia(964,()=>new Rv(Object(E.a)(qa.StaticActiveAppFrame.za(),
qa.StaticActiveAppFrame.za().Dsd,"updateRibbonControl"),Object(E.a)(qa.StaticActiveAppFrame.za(),qa.StaticActiveAppFrame.za().eJ,"updateRibbonControls"),y.AFrameworkApplication.isRtl)).ha();b.register(gs,965).ha();b.ia(978,()=>new zw(new Qn.a,b.resolve(12))).ha();b.ia(966,()=>new qx(new Ul.a,b.resolve(978),b.resolve(967),b.resolve(465))).ha();b.ia(979,()=>new PJ).ha();b.ia(967,()=>new ot(new Ul.a,b.resolve(465),b.resolve(979),b.resolve(46).instance,Object(E.a)(Sv.Fg,Sv.Fg.Ve,"replaceTextRange"))).ha();
b.ia("WordEditor.HeaderFooter.PageNumbersCalloutControlManager",()=>new LJ(b.rf(980),qa.StaticActiveAppFrame.za())).as(960).ha();b.ia("WordEditor.HeaderFooter.PageNumbersCallOutControl.Factory",()=>new ZG(Je.a.instance,gg.a.instance,b.resolve(26))).as(980).ha();b.ia("WordEditor.HeaderFooter.ShowCalloutForPageNumberOperation.Factory",()=>new bH(b.resolve(960),y.AFrameworkApplication.va,qa.StaticActiveAppFrame.za())).as(968).ha();b.ia("WordEditor.HeaderFooter.ClientPaginationPageAdornmentContentManager",
()=>new wp(b.resolve(465),y.AFrameworkApplication.va)).as(982).ha();b.ia("WordEditor.HeaderFooter.ClientPaginationHeaderFooterBridge",()=>new ME(b.resolve(981),b.resolve(982))).as(556).ha()}static get Fg(){return null!=Sv.MSg?Sv.MSg:Sv.MSg=Za.a.instance.resolve(322)}}Object(u.a)(Sv,"HeaderFooterComponentConfiguration",null,[1]);class cH{constructor(){this.VBd=this.W=null}get name(){return"WordEditor.HeaderFooter"}uc(b){this.W=b;(new Sv).uc(b)}init(){this.W.resolve(12).us.continueWith(()=>{this.Fo()})}Fo(){this.W.resolve(12).isFeatureEnabled(104)&&
(this.VBd=this.W.resolve(983),this.VBd.start(),this.W.resolve(556))}dispose(){this.VBd&&this.VBd.dispose()}static main(){K.a.instance.Lc(new cH)}}Object(u.a)(cH,"PackageManager",null,[0,1]);var RE=d(329),QJ=d(504);class rx{constructor(b,h){this.ig=b;this.Vm=h}create(){return new QJ.a(this.ig.instance,this.Vm.instance)}}Object(u.a)(rx,"ContentControlNodeFactory",null,[281]);var aD=d(1688),dH=d(391),eH=d(1040);class fH{create(){return new eH.a}}Object(u.a)(fH,"ContentControlContainerNodeFactory",null,
[281]);var Fs=d(199),gH=d(398),RJ=d(298),hH=d(218),rL=d(224),sL=d(1080);const iH=b=>b?(b=b.ka(Mc.a.eUa,null))&&b.includes(Fs.a.bci):!1;class sx{constructor(b,h,r,A,M,aa,oa){this.Jsa=b;this.gg=h;this.Fg=r;this.Yja=A;this.Q8=M;this.im=aa;this.Exl=oa;this.$Rn=(Ja,fb)=>{gp.a.Ufa&&(Ja=fb.node,fb=vd.a.Za(Ja),fb.vb(7)&&(fb=fb.ld(54)))&&(fb=fb.getValue(Mc.a.Wd),Ja=Ja.id,1==(null===fb||void 0===fb?void 0:fb.length)&&Ja.equals(fb[0])&&(Ja=this.Jsa.pvi(),this.cdi(Ja)))};this.ydg=(Ja,fb)=>{if(gp.a.Ufa)for(const Cb of fb.dbi)iH(Cb.Wd)||
(Ja=Cb.Wd.ka(Mc.a.eUa,null),this.cdi(Ja))}}get dXf(){return y.AFrameworkApplication.J.$("WordEditorContentControlCustomizedPlaceholderIsEnabled")}init(){this.Yja.Qyj(this.ydg);this.Exl.tT(this.$Rn)}cdi(b){const h=this.Jsa.EPb();h&&b&&this.Jsa.BQb(h,b)&&(b=new Rb.GraphTransaction(7),b.mu(h),h.Rg(),b.dispose())}PWc(){const b=new sL.a;b.setValue(Mc.a.gQm,!0);var h=(h=kb.a.create())?h.toString().replace(RegExp("-","g"),"").toUpperCase():null;b.setValue(Mc.a.Rkc,h);b.setValue(Mc.a.xxl,this.dXf);h=kb.a.create();
b.setValue(Mc.a.uJi,h);return b}Sel(b){const h=b.currentNode.getValue(Mc.a.uJi);b.Vf(new gH.a,1);b.y_();b.currentNode.setValue(Mc.a.Vfi,h);b.Vf(this.gg.Rnb(),1);b.y_();return this.gg.bL(b)}ZVo(b){var h=this.Jsa.KJf();h.vb(7);if(h.rc()&&h.YVa(0,A=>8==A.type)){h=h.currentNode;const A=(new Bu.WACStyleSet).Oaa(h);if(A){var r=A.lh(Fs.a.Gjg);if(!r&&(r=this.nWk(h),v.ULS.sendTraceTag(508952736,368,50,`Placeholder text style is not in document. Adding new style succeeded: ${!!r}`),!r))return;b=wc.a.createTextRange(b,
0,Gd.ParagraphReader.textLength(b));this.Q8.QZ(b,M=>{this.im.$qa(M);this.im.Ydb(M,r)})}}}CFl(b){var h=this.Jsa.KJf();const r=this.PWc();h.Vf(r,29);h.y_();h=this.Sel(h);this.Fg.Ve(wc.a.Tc(h,0),b,!1,!1);this.ZVo(h);return r}Tql(b){const h=this.Jsa.EPb();this.Jsa.BQb(h,b);b=this.PWc();const r=this.Jsa.KJf();r.Vf(b,29);r.Yj(b);Rt.a(h.currentNode,r.currentNode,!1);return b}Pvp(b,h){const {yoe:r,qMi:A}=this.Jsa.jqm(b);if(r){var M=wc.a.createTextRange(r,0,Gd.ParagraphReader.textLength(r));this.Fg.Ve(M,h,
!1,!1);A&&this.wOl(b);this.vup(b)}}wOl(b){const h=this.Jsa.EPb();if(h&&b&&this.Jsa.BQb(h,b))for(h.Zd(),b=h.zq(),--b;0<b;b--)h.WG(b),h.Rg()}vup(b){const h=this.Jsa.EPb();this.Jsa.BQb(h,b)&&h.currentNode.setValue(He.a.DU,new Date)}nWk(b){var h;const r=null===(h=si.a.Xg)||void 0===h?void 0:h.Ln;h=r?new RJ.a(new hH.a):new rL.a(new hH.a);h.setValue(wb.a.la,"Placeholder Text");h.setValue(wb.a.na,1);h.setValue(Mc.a.ma,"PlaceholderText");h.setValue(De.a.oa,99);h.setValue(Mc.a.pa,"Default Paragraph Font");
h.setValue(Mc.a.eo,!0);h.setValue(He.a.fontColor,8421504);return si.a.wRc([h],b)?(r&&(b=si.a.Wb.qo(),h=si.a.Wb.ze(h),h=b.lh(h)),h):null}}Object(u.a)(sx,"GlossaryEditor",null,[447]);class Tv{constructor(b,h,r,A,M){this.Yja=b;this.D5h=h;this.OLb=r;this.RL=A;this.Mj=M;this.vxl=new fH;this.Lcg=(aa,oa)=>{this.RL.$d(()=>{if(oa){oa.Nm.selectedContentControls||(oa.Nm.selectedContentControls={});var Ja=oa.Nm.selectedContentControls,fb=oa.HNa;if(fb&&fb.length){var Cb=fb[0];fb=fb[fb.length-1];Cb=this.Yja.iHf(wc.a.Tc(Cb.node,
Cb.Hj),wc.a.Tc(fb.node,fb.Oo),!1);for(const Gb of Cb)Gb.Wd.ka(Mc.a.DL,!1)||(Ja[Gb.Wd.id.toString()]=!0)}}},"CC:OnBeforeCopy")};this.Ied=(aa,oa)=>{this.RL.$d(()=>{if(oa){var Ja=oa.clone,fb=oa.original;try{const Cb=oa.Nm.selectedContentControls,Gb=this.Yja.pGf(fb,0,fb.characterData.length,!0,!0,!1);for(const Sb of Gb){const pc=Sb.qe.toString();Cb[pc]?Sb.jq&&!this.Ozl(Sb.Wd,Ja,Cb)&&(v.ULS.sendTraceTag(521172763,368,10,String.format("Cannot clone ContentControlNode id:{0} under the clipboard tree",pc)),
this.Sqg(Ja,Sb.qe)):this.Sqg(Ja,Sb.qe)}}catch(Cb){v.ULS.sendTraceTag(521171974,307,10,"onParagraphCopy operation failed: {0}",Cb.toString()),this.D5h.luo(Ja)}}},"CC:onParagraphCopy")};this.lfg=(aa,oa)=>{this.RL.$d(()=>{if(oa){var Ja=oa.clone,fb=oa.original;try{const Cb=this.Yja.pGf(Ja,0,fb.characterData.length);oa.Nm.ccObjectIdMapping||(oa.Nm.ccObjectIdMapping={});const Gb=oa.Nm.ccObjectIdMapping;for(let Sb=0;Sb<Cb.count;Sb++){const pc=Cb.K(Sb),zc=pc.qe.toString();if(this.Emn(pc))if(pc.Vc){const Yc=
fb.Jj().td.Eb(zc),Kd=this.HCm(pc),ke=this.Kql(Yc,Kd.bqj,Kd.OQi,Ja.Jj().td);Gb[zc]=ke.id;this.OLb.V4j(Gb[zc],Ja.id,null);this.Mj.Cqc(ke)}else this.OLb.V4j(Gb[zc],null,Ja.id);Gb[zc]?(pc.qe=Gb[zc],pc.Fv=null):this.Sqg(Ja,pc.qe)}}catch(Cb){v.ULS.sendTraceTag(520414297,307,10,"onParagraphPaste operation failed: {0}",Cb.toString())}}},"CC:onParagraphPaste")}}init(){Iv.a.QNh(this.Lcg);Iv.a.QQd(this.Ied);Iv.a.RQd(this.lfg)}gjm(b){if(!b.vb(25)||!b.ld(25))return null;if(!b.kv(25)){const h=this.vxl.create(wm.a.pra);
b.Vf(h,25)}return b.Ub(25)}Ozl(b,h,r){var A=b.ka(Mc.a.eaa,null);const M=vd.a.Za(h);h=h.Jj().td;r=A&&r[A.toString()]?h.Eb(A):this.gjm(M);if(!r)return v.ULS.sendTraceTag(521172765,368,10,String.format("Cannot get parent node of the cloned content control node id:{0}",b.id.toString())),null;A=Rt.b(b,h,!0);vd.a.Za(r).d6(A,26,b.id);54!==r.type&&A.setValue(Mc.a.eaa,r.id);dH.a.dVf(null,A);return A}Sqg(b,h){this.D5h.KNl(new ib.a([b]),h)}Emn(b){var h=b.Jb.paragraph.Ic;if(!h)return v.ULS.sendTraceTag(520152150,
368,10,String.format("Cannot get containing object space of the cloned content control node id:{0}",b.qe.toString())),!1;h=h.Eb(b.Fv);if(!h)return v.ULS.sendTraceTag(520152149,368,10,String.format("Cannot get property set of the cloned content control node id:{0}",b.qe.toString())),!1;b=h.getValue(Mc.a.ft);return 38===b||39==b}Ihm(b,h){var r,A=b.ra.K(b.ra.length-1);let M=b.characterData.length;A=(null===(r=null===A||void 0===A?void 0:A.Hb)||void 0===r?void 0:r.length)||0;b.id.equals(h.Jb.paragraph.id)&&
(M=h.Jb.cp,A=h.Jb.Hb.uL(h.qe,h.Vc));return this.Yja.qGf(b,0,M,0,A)}HCm(b){let h=null,r=b.Jb.paragraph;const A={};for(;r;){const M=this.Ihm(r,b);for(let aa=M.count-1;0<=aa;aa--){const oa=M.K(aa);if(!oa.jq)continue;const Ja=oa.qe.toString();if(oa.Vc){if(!A[Ja])return{bqj:oa.Wd,OQi:h}}else A[Ja]=!0,h||(h=oa.Wd)}r=Gd.ParagraphReader.xg(r,!0,!0)}return{bqj:null,OQi:h}}Kql(b,h,r,A){let M;h?M=this.OLb.HAa(h):(M=this.OLb.IAa(),h=M.currentNode);A=Rt.b(b,A,!0);A.Ag(Mc.a.Hw,$f.a.OF());54!==h.type&&A.setValue(Mc.a.eaa,
h.id);M.UJ(A,r,26);gp.a.Ufa&&!iH(b)&&this.OLb.Qql(b,A);return A}}Object(u.a)(Tv,"ContentControlCCP",null,[]);var SJ=d(717);class TJ{constructor(b,h,r,A){this.Qd=b;this.ig=h;this.jb=r;this.qh=A}get X_(){return!!this.ig.instance&&this.ig.instance.X_}get rSb(){return!!this.ig.instance&&this.ig.instance.rSb}Iya(b,h,r,A,M,aa=Fs.a.RMb,oa=Fs.a.Ufc,Ja=null,fb=Fs.a.Uuf,Cb=-1){(b=this.Xjc(b,r))?(b.Hb||(b.Hb=new RE.a(b)),this.FTk(h,b.Hb,A,M,aa,oa,Ja,fb,Cb)):v.ULS.sendTraceTag(17585366,368,15,"Unable to get a ChP at expected cp, which should not happen")}Lci(b,
h,r){if(b){new ib.a;for(let M=0;M<b.count;M++){var A=this.fHf(b.K(M),h,!1);for(const aa of A)this.Puo(aa,r)}}}JNl(b,h){this.Lci(b,h,!0)}KNl(b,h){this.Lci(b,h,!1)}Ve(b,h,r,A){this.Qd.Ve(b,h,r===ub.a.God||gp.a.mec&&8===A)}Xjc(b,h){var r=wc.a.Tc(b,h);this.Qd.qeb(r);for(r=0;r<b.ra.length;r++){const A=b.ra.K(r);if(A.cp>h)break;if(A.cp===h)return A}return null}FTk(b,h,r,A,M=Fs.a.RMb,aa=Fs.a.Ufc,oa=null,Ja=Fs.a.Uuf,fb=-1){const Cb=h.Jb.paragraph;b=new SJ.a(h.Jb,!0,!0,!0,null,b,A,r,M,aa,oa,Ja,null,this.qh);
if(!this.X_||-1>=fb||fb>h.length)fb=h.length;h.insert(b,fb);Cb.Ml();b.pe?Cb.se.mX(b.pe-1,512):Cb.se.Tsa(b.pe,512);Cb.se.Gq.Z(b.pe,gv.CharacterPropertiesEditor.yN);Cb.se.Lt.Z(b.pe,gv.CharacterPropertiesEditor.YR)}fHf(b,h,r){const A=new ib.a;for(let M=0;M<b.ra.length;M++){const aa=b.ra.K(M);if(aa.Hb)for(let oa=0;oa<aa.Hb.length;oa++)if(aa.Hb.K(oa).qe.equals(h)&&(A.add(aa.Hb.K(oa)),r))return A}return A}isd(b,h,r){if(this.rSb&&b){var A=b.node,M=b.Hj,aa=b.Oo,oa=this.tui(A,M,h,!0);h=this.tui(A,aa,h,!1);
r?-1!==oa&&oa++:-1!==h&&h++;M||-1===oa||(oa=Math.max(oa,this.jb.iy(A)));aa===this.jb.textLength(A)&&-1!==h&&(h=Math.min(h,this.jb.wx(A)));b.Fb=oa;b.Tb=h}}tui(b,h,r,A){return(b=(b=b.ra.sh(h))?b.Hb:null)&&b.length?b.uL(r,A):-1}Puo(b,h){b&&b.Jb.Hb&&(h?b.Jb.Hb.remove(b):b.Jb.Hb.Qua(b),h=b.Jb.paragraph,0<=b.pe&&b.pe<h.se.length&&(b.Jb.cp||1!==h.se.length||(h.se.mX(0,512),h.se.Gq.Z(1,gv.CharacterPropertiesEditor.yN),h.se.Lt.Z(1,gv.CharacterPropertiesEditor.YR)),h.se.removeAt(b.pe,512)),h.Ml())}luo(b){const h=
b.ra;if(h){var r=new ib.a;for(let A=0;A<h.length;A++){const M=h.K(A);if(M&&M.Hb){for(let aa=0;aa<M.Hb.length;aa++)r.add(M.Hb.K(aa).pe);M.Hb=null}}b.ana(r)}}Uop(b,h,r){if(!(0>h||0>r))for(this.Qd.qeb(wc.a.Tc(b,h)),this.Qd.qeb(wc.a.Tc(b,r)),h=b.ra.M2(h),r=b.ra.M2(r),--r;r>h;r--){const A=b.ra.K(r);A.zXf?b.ra.removeAt(r):A.formatting=null}}}Object(u.a)(TJ,"ContentControlChpManager",null,[456]);class SE{constructor(b,h,r,A,M){this.jb=b;this.yp=h;this.ri=r;this.Bd=A;this.qh=M}dGf(b){if(!b||!ze.a.pf(b))return null;
if(!b.cpBegin){const h=this.vsi(b.node,b.Fb,!0);if(h)return h}return b.cpBegin===this.jb.textLength(b.node)?this.vsi(b.node,b.Fb-1,!1):null}Agm(b,h){b=this.e9h(b,h);return this.dGf(b)}vsi(b,h,r){return b.ra&&b.ra.length?(b=r?b.ra.first.Hb:b.ra.last.Hb)&&0<=h&&h<b.length&&b.K(h).fg&&b.K(h).Vc===r&&this.MWf(b.K(h))?b.K(h):null:null}DJf(b){if(!b||!ze.a.nw(b))return null;var h=this.yp.N4d(b,b);b=0<h.count?h.K(h.count-1):null;return b&&!b.fg&&this.MWf(b)?(h=1<h.count?h.K(h.count-2):null)&&!h.fg&&this.MWf(h)?
null:b:null}MWf(b){if(!b)return!1;var h=this.gCi(b);if(!h)return!1;if(b.Vc)var r=b;else r=h,h=b;var A=this.jb.textLength(b.Jb.paragraph);if(r.Jb.cp||h.Jb.cp!==A||!r.jq||r.eCa||!h.jq||h.eCa)return!1;r=r.Jb.Hb;h=h.Jb.Hb;for(A=0;A<r.length&&!r.K(A).qe.equals(b.qe);A++)if(!r.K(A).Vc)return!1;for(r=h.length-1;0<=r&&!h.K(r).qe.equals(b.qe);r--)if(h.K(r).Vc)return!1;return!0}Rrd(b){b=this.dGf(b);this.QWd(b,!1)}Q2j(b,h){b=this.e9h(b,h);this.Rrd(b)}OOa(b){b=this.DJf(b);return this.QWd(b,!0)?b:null}Jbn(b,h){b=
this.dGf(b);return!!b&&b.qe.equals(h)}Wmc(b,h,r){b=this.Agm(b,h);return!!b&&b.qe.equals(r)}uYf(b,h){b=this.DJf(b);return!!b&&b.qe.equals(h)}QWd(b,h){if(!b)return!1;const r=this.gCi(b);return this.o6h(b,h)&&(!r||this.o6h(r,h))}o6h(b,h){if(!b||b.fg===h)return!1;var r=this.yp.fDe(b.Jb.paragraph,b.Vc);const A=b.Jb.Hb;-1!==r||b.Vc||(r=A.length);const M=h===b.Vc?1:-1;r+=h?M:0;b=A.uL(b.qe,b.Vc)+M;if(r===b||0<M!==b>r)return v.ULS.shipAssertTag(24933847,368,r!==b,"Stopping content control inline block conversion since we can't find a correct range to convert. begin: {0}, end: {1}, step: {2}",
r,b,M),v.ULS.shipAssertTag(24933848,368,0<M===b>r,"Stopping content control inline block conversion or we'll trap in infinite loop. begin: {0}, end: {1}, step: {2}",r,b,M),!1;for(var aa=r;aa!==b;aa+=M){var oa=A.K(aa);A.Qua(oa);oa.fg=h;A.$8m(oa,aa);this.gup(A.K(aa))}if(this.d3)for(A.Jb.paragraph.Ml(),aa=r;aa!==b;aa+=M)oa=A.K(aa),oa.paragraph.se.Gq.Z(oa.pe,gv.CharacterPropertiesEditor.yN),oa.paragraph.se.Lt.Z(oa.pe,gv.CharacterPropertiesEditor.YR);h||this.Qwp(A,r,b,M);v.ULS.sendTraceTag(24933849,368,
50,"Converted {0} content control(s) to {1}",Math.abs(b-r),h?"block":"inline");return!0}s7d(b){return b.Vc&&this.qh.hr(b.Wd.id,!0).equals(b.Jb.paragraph.id)?38:!b.Vc&&this.qh.hr(b.Wd.id,!1).equals(b.Jb.paragraph.id)?39:b.fg&&b.Vc?40:b.fg&&!b.Vc?41:!b.fg&&b.Vc?38:39}gup(b){const h=b.Jb.paragraph.Ic;if(h){var r=h.Eb(b.Fv),A=b.Wd;if(r){r=r.clone();r.setValue(Mc.a.e0f,b.fg);const M=this.s7d(b);r.setValue(Mc.a.ft,M);h.ku(r,null);b.Fv=r.id}A&&A.setValue(Mc.a.aba,b.fg)}}gCi(b){if(b.Jb.cp&&b.Jb.cp!==this.jb.textLength(b.Jb.paragraph)||
!b.Jb.paragraph.ra||!b.Jb.paragraph.ra.length)return null;const h=b.Vc?b.Jb.paragraph.ra.last:b.Jb.paragraph.ra.first;if(!h.Hb)return null;b=h.Hb.uL(b.qe,!b.Vc);return-1===b?null:h.Hb.K(b)}Qwp(b,h,r,A){var M=b.K(h).Wd;if(M){var aa=b.K(h).Vc;M=this.qh.hr(M.id,aa);if(!M.equals(N.a.nil))if(b.Jb&&b.Jb.paragraph&&b.Jb.paragraph.id.equals(M)){for(h+=A;h!==r;h+=A){const oa=b.K(h).Wd;if(!oa)return;this.qh.fJ(oa.id,M,aa)}0<=r&&r<b.length&&b.K(r).fg&&this.T_f(b.K(r))&&(b=b.K(r).Wd)&&this.qh.fJ(b.id,M,aa)}else v.ULS.shipAssertTag(24933851,
368,!1,"Start/End object of innermost content control is not the paragraph which holds the content control.")}}T_f(b){return b.jq&&!b.eCa}e9h(b,h){if(!b||!this.ri)return null;const r=h?wc.a.Tc(b,0):wc.a.vx(b);b=this.ri.Mr(b,h);r.Tb=r.Fb=b;return r}get d3(){return this.Bd.isFeatureEnabled(26)}}Object(u.a)(SE,"ContentControlConverter",null,[455]);var ly;(function(b){b[b.FIp=0]="BoundingBox";b[b.DNp=1]="Tags";b[b.EKp=2]="Hidden";b[b.ULp=3]="NumberOfContentControlAppearance"})(ly||(ly={}));Object(u.b)("ContentControlAppearance",
ly);var bD=d(1565);class TE{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb){this.Phb=this.Uda=this.Uzd=this.wMd=this.dHd=null;this.soa=this.Mk=this.BMc=this._id=0;this.U5b=this.Tjb=this.sNd=this._title=this.qFa=null;this.gEd=this.fEd=this.mph=this.WJd=this.KIc=this.GIc=this.kzd=!1;this.Gqh=null;this.fg=!1;this.Mxd=null;this.Di=r;this.yz=h;this.jh=A;this.sr=M;this.Vm=aa;this.f5=oa;this.ria=Ja;this.nja=fb;this.pJb=Cb;this.qh=Gb;b?(this.dHd=b.id,this.Mxd=b,this.RW(!1)):this._id=$f.a.OF()}get Dj(){return this.Di.value}get id(){this.RW();
return this._id}set id(b){this._id=b;this.isValid()&&(this.Wd.setValue(Mc.a.Hw,this._id),this.vY())}get parentId(){this.RW();return this.BMc}set parentId(b){this.BMc=b}get title(){this.RW();return this._title}set title(b){this._title=b;this.isValid()&&(this.Wd.setValue(Mc.a.vnb,this._title),this.vY(),this.lsd(h=>{h.title=this._title?this._title:Fs.a.RMb}))}get tag(){this.RW();return this.sNd}set tag(b){this.sNd=b;this.isValid()&&(this.Wd.setValue(Mc.a.znb,this.sNd),this.vY())}get type(){this.RW();
return this.Mk}set type(b){this.Mk=b;this.isValid()&&(this.Wd.setValue(Mc.a.O6a,bD.a[this.Mk]),this.vY())}get appearance(){this.RW();return this.soa}set appearance(b){if(b&&1!==b&&2!==b)throw Error.argumentUndefined("The appearance value is undefined enum.");this.soa=b;this.isValid()&&(this.Wd.setValue(Mc.a.wnb,ly[this.soa].toLowerCase()),this.vY(),this.lsd(h=>{h.appearance=ly[this.soa].toLowerCase()}))}get color(){this.RW();return this.qFa}set color(b){if(b&&16777215>=b)this.qFa=b,this.isValid()&&
(this.Wd.setValue(Mc.a.UVc,this.qFa),this.vY(),this.lsd(h=>{h.color=this.qFa}));else throw Error.argumentOutOfRange("The color value is out of range.");}get placeholderText(){this.RW();return this.Tjb}set placeholderText(b){this.Tjb=b;gp.a.Ufa&&this.jh.D5j(b,this.Mxd)&&(this.vY(),this.GL&&this.Vm.cKb(this,!0))}get d_d(){this.RW();return this.U5b}set d_d(b){this.U5b=b;this.isValid()&&(this.Wd.setValue(Mc.a.NLb,this.U5b),this.vY())}get Exf(){this.RW();return this.kzd}set Exf(b){b&&(this.kzd=b,this.isValid()&&
(this.Wd.setValue(Mc.a.DWd,this.kzd),this.vY()))}get removeWhenEdited(){this.RW();return this.WJd}set removeWhenEdited(b){if(b&&!this.Fla)throw Error.invalidOperation("Cannot set RemoveWhenEdited to true property if the content control is undeletable.");this.WJd=b;this.isValid()&&(this.Wd.setValue(Mc.a.G5h,this.WJd),this.vY())}get Fla(){this.RW();return this.GIc}set Fla(b){if(!b&&this.removeWhenEdited)throw Error.invalidOperation("Cannot set IsDeletable property to false if the content control RemoveWhenEdited property is true.");
this.GIc=b;this.isValid()&&(this.Wd.setValue(Mc.a.Wec,this.GIc),this.lsd(h=>{h.aN=this.GIc}),this.vY())}get isEditable(){this.RW();return this.KIc}set isEditable(b){this.KIc=b;this.isValid()&&(this.Wd.setValue(Mc.a.ynb,this.KIc),this.lsd(h=>{h.editable=this.KIc}),this.vY())}get isSupported(){this.RW();return this.mph}get Mmn(){return this.isSupported&&11!==this.type&&10!==this.type}get aqn(){this.RW();return this.U5b&&"table of contents"===this.U5b.toLowerCase()?!0:!1}get eee(){this.RW();return this.fEd}set eee(b){this.fEd=
b;this.isValid()&&(this.Wd.setValue(Mc.a.L5h,this.fEd),this.vY())}get Ync(){this.RW();return this.gEd}set Ync(b){this.gEd=b;this.isValid()&&(this.Wd.setValue(Mc.a.M5h,this.gEd),this.vY())}get GL(){return this.Wd.ka(Mc.a.faa,!1)}set GL(b){this.isValid()&&this.Wd.setValue(Mc.a.faa,b)}get isChecked(){return 8!==this.type?!1:this.Wd.ka(De.a.Gqf,!1)}set isChecked(b){8===this.type&&this.isValid()&&(this.Wd.setValue(De.a.Gqf,b),this.vY())}get sv(){this.RW();return this.wMd}set sv(b){this.wMd=b}get HA(){this.RW();
return this.Uzd}set HA(b){this.Uzd=b}get objectId(){return this.dHd}set objectId(b){this.dHd=b;this.Mxd=this.Dj.Eb(this.dHd)}get start(){this.A7j();return this.Uda}set start(b){this.Uda=b}get end(){this.A7j();return this.Phb}set end(b){this.Phb=b}get Wd(){return this.Mxd}z6n(b){for(let h=0;3>h;++h)if(ly[h].toLowerCase()===b)return h;return 0}vY(){const b=this.start.node;b&&b.setValue(He.a.DU,new Date)}zsd(){this._id=this.Wd.ka(Mc.a.Hw,0);this.soa=this.z6n(this.Wd.ka(Mc.a.wnb,null));this.qFa=this.Wd.ka(Mc.a.UVc,
null);this._title=this.Wd.ka(Mc.a.vnb,null);this.sNd=this.Wd.ka(Mc.a.znb,null);this.fg=this.Wd.ka(Mc.a.aba,!1);this.GIc=this.Wd.ka(Mc.a.Wec,!1);this.KIc=this.Wd.ka(Mc.a.ynb,!1);this.mph=this.Wd.ka(Mc.a.Xja,!1);this.U5b=this.Wd.ka(Mc.a.NLb,null);this.kzd=this.Wd.ka(Mc.a.DWd,!1);this.wMd=this.qh.hr(this.Wd.id,!0);this.Uzd=this.qh.hr(this.Wd.id,!1);this.gEd=this.Wd.ka(Mc.a.M5h,!1);this.fEd=this.Wd.ka(Mc.a.L5h,!1);this.WJd=this.Wd.ka(Mc.a.G5h,!1);this.Mk=Object(bD.b)(this.Wd.ka(Mc.a.O6a,"RichText"));
let b=null;try{const h=this.Wd.ka(Mc.a.eaa,N.a.nil);if(N.a.xt(h,N.a.nil))this.BMc=0;else if(b=this.Dj.Eb(h))this.BMc=b.ka(Mc.a.Hw,0)}catch(h){this.BMc=0}this.Ovp()}Ovp(){if(this.pJb){var b=this.Wd.ka(Mc.a.eUa,"");if((b=this.ria.DIi(b))&&0<b.length){this.Tjb=this.Bri(b.Qa,b.Wc);return}}this.Tjb=(b=this.jh.IAa())&&b.currentNode?b.currentNode.ka(Mc.a.VVc,null):null}RW(b=!0){if(!b||this.isValid())b=this.Wd.ka(He.a.lastModifiedTime,new Date(0)),this.Gqh!==b?(v.ULS.sendTraceTag(520734535,368,50,"Last Modified Time was used to update Properties"),
this.zsd(),this.Gqh=b):v.ULS.sendTraceTag(520734534,368,50,"Last Modified was NOT used but updateProperties would run if Last Modified was removed.")}Pwp(b,h){this.wMd=b;this.Uzd=h;this.qh.fJ(this.Wd.id,b,!0);this.qh.fJ(this.Wd.id,h,!1)}A7j(){if(this.Wd){var b=this.sv,h=this.HA;if(!b||!h||b.equals(N.a.nil)||h.equals(N.a.nil))v.ULS.sendTraceTag(17330978,368,10,"StartObjectId/EndObjectId are not initialized before trying to update Start/End contexts.");else if(b=this.jh.msa(b,!0),h=this.jh.msa(h,!1),
b&&h)if(b.isConnected&&h.isConnected||v.ULS.sendTraceTag(37777626,368,10,"StartParaNode/EndParaNode are not connected."),this.fg)b=wc.a.create(b),this.sr.isd(b,this.objectId,!0),this.start=b,b=wc.a.create(h),this.sr.isd(b,this.objectId,!0),this.end=b;else{let r=h=-1;if(b.ra){for(let A=0;A<b.ra.length&&(-1===h||-1===r);A++){const M=b.ra.K(A);if(M.Hb)for(let aa=0;aa<M.Hb.length&&(-1===h||-1===r);aa++){const oa=M.Hb.K(aa);N.a.xt(oa.qe,this.objectId)&&(oa.Vc?h=M.cp:r=M.cp)}}0<=h&&0<=r&&(b=wc.a.UT(h,r,
!1,b),this.sr.isd(b,this.objectId,!0),this.start=this.end=b)}}}}getText(){let b="";var h=this.start;const r=this.end;if(!h||!r)return b;this.fg?b=this.Bri(h,r):(h=Gd.ParagraphReader.text(h.node).substring(h.cpBegin,r.cpEnd),b+=Gn.AParagraphNode.dV(h));return b}isValid(){return!!this.Wd&&this.Wd.isConnected}wxe(b){return this.nja?this.Vm.Izg(this,b)?0:2:2}clear(){return this.nja?this.Vm.Izg(this,"")?0:2:2}Ati(){const b=new ib.a;var h=this.Wd.ka(Mc.a.Wd,[]);for(const r of h)if(!N.a.xt(r,N.a.nil)){h=
this.Di.value.Eb(r);try{b.add(this.f5.$Lb(h,this.yz,this.Di,this.jh,this.sr,this.Vm,this.ria,this.nja,this.pJb))}catch(A){}}return b}AFf(){const b=new ib.a;this.qri(this,b);return b}qri(b,h){b=b.Ati();if(b.count)for(const r of b)h.add(r),this.qri(r,h)}SG(b=!1){const h=new ib.a;if(this.fg){var r=this.Vm.YW(this.start,this.end);for(var A of r)r=wc.a.create(A),this.sr.isd(r,this.objectId,b),h.add(r)}else A=this.start.clone(),this.sr.isd(A,this.objectId,b),h.add(A);return h}lsd(b){const h=this.Vm.YW(this.start,
this.end);for(let r=0;r<h.count;r++){const A=this.sr.fHf(h.K(r),this.objectId,!1);if(A){for(let M=0;M<A.count;M++)b(A.K(M));h.K(r).Ok()}}}Bri(b,h){const r=new Sys.StringBuilder;h=this.Vm.YW(b,h);for(const A of h)A.id.equals(b.node.id)||r.append("\r"),r.append(Gd.ParagraphReader.f8(A));return r.toString()}}Object(u.a)(TE,"ContentControl",null,[476]);class jH{constructor(b){this.qh=b}$Lb(b,h,r,A,M,aa,oa,Ja,fb){return new TE(b,h,r,A,M,aa,this,oa,Ja,fb,this.qh)}}Object(u.a)(jH,"ContentControlFactory",
null,[454]);class Zk{constructor(b,h,r,A,M){this.Di=b;this.sr=h;this.UNk=r;this.zZ=A;this.Ga=M}isp(b,h,r){var A,M;if(!(gp.a.Jqf&&b&&h&&r))return!1;const aa=b.Wd;if(!aa)return!1;var oa=aa.ka(Mc.a.PLb,N.a.nil);oa&&!oa.equals(N.a.nil)?b=this.Di.value.Eb(oa):(b=this.sr.Xjc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0),b=null===(A=null===b||void 0===b?void 0:b.formatting)||void 0===A?void 0:A.lo,b||(b=new PC.a,this.Di.value.ku(b,null)),aa.setValue(Mc.a.PLb,b.id));A=this.Di.value.Eb(b.id);oa="boolean"===
typeof r&&r;const Ja=null===(M=this.Ga)||void 0===M?void 0:M.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);h=this.UNk.WIf(aa,A,h,r,Ja?null:oa);h=this.zZ.XEe(h);for(const [fb,Cb]of h)b.setValue(fb,Cb);return!0}}Object(u.a)(Zk,"ContentControlFormattingManager",null,[453]);var Gh=d(922);class tx{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc){this.yz=b;this.Di=h;this.Zc=r;this.pGb=A;this.Gpk=M;this.hT=aa;this.Oh=oa;this.jb=Ja;this.oId=fb;this.iBd=Cb;this.qh=Gb;this.FSe=
Sb;this.ria=pc}get ov(){return this.yz.value}IAa(){const b=this.Zc.Rl();b.set(this.ov);this.pGb.VR(b);if(b.Ub(25))return b;this.iBd.instance&&this.iBd.instance.fta&&v.ULS.sendTraceTag(17040640,368,10,"Content Control root node doesn't exist");v.ULS.sendTraceTag(528537619,368,15,"getContentControlRootIterator() returning null");return null}A2c(b,h,r=!1){this.KNb();const A=new ib.a;let M;if(b){M=b.Ub(26);if(!M)return A;for(;M&&(!h(M)||(A.add(M),!r));){A.addRange(this.A2c(b,h));if(r&&0<A.count)break;
M=b.Mf(26)}b.rc()}return A}jBm(){const b=this.Zc.Rl();b.set(this.yz.value);this.pGb.VR(b);return b.currentNode}pXa(b,h,r){let A;A=b.equals(h);A||(A=(b=this.msa(b,r))?b.id.equals(h):!1);return A}mVa(b,h){b=this.jv(b);if(!b)return null;let r=null;for(;55===b.type;){const A=this.qh.hr(b.id,h);if(A.equals(r)){b=null;break}else b=this.jv(A);r=A}return b}msa(b,h){return(b=this.mVa(b,h))?Gd.ParagraphReader.Vb(b)?b:h?this.jb.Om(b):this.jb.bD(b):null}Jci(b,h=!1){this.prp(b);this.Kci(b,h)}prp(b){var h=this.HAa(b);
h=this.HAa(h.parentNode);h=55===h.currentNode.type?h.currentNode.id:null;let r,A;r=this.jv(this.qh.hr(b.id,!0));for(A=this.jv(this.qh.hr(b.id,!1));r&&55===r.type;)r=this.jv(this.qh.hr(r.id,!0));for(;A&&55===A.type;)A=this.jv(this.qh.hr(A.id,!1));r&&A&&this.U4j(r.id,A.id,h,M=>{M=M.ka(Mc.a.a_,N.a.nil);return!M||M.equals(N.a.nil)||b.id.equals(M)})}Kci(b,h=!1){v.ULS.sendTraceTag(528537620,368,50,"Attempting to delete content control node");var r=this.HAa(b);const A=this.HAa(r.parentNode);let M=N.a.nil,
aa=N.a.nil;var oa=A.currentNode.ka(Mc.a.Wd,[]);const Ja=new ib.a;for(var fb=0;fb<oa.length;fb++)Ja.add(oa[fb]);if(h){if(54!==A.currentNode.type){M=this.qh.hr(A.currentNode.id,!0);aa=this.qh.hr(A.currentNode.id,!1);oa=this.jv(M);for(fb=this.jv(aa);oa&&55===oa.type;)M=this.qh.hr(oa.id,!0),oa=this.jv(M);for(;fb&&55===fb.type;)aa=this.qh.hr(fb.id,!1),fb=this.jv(aa)}oa=this.HAa(b);if(oa.Ub(26)){fb=new ib.a;for(fb.add(oa.currentNode);oa.Mf(26);)fb.add(oa.currentNode);for(var Cb of fb)this.Kci(Cb,h)}}else if(M=
this.qh.hr(b.id,!0),aa=this.qh.hr(b.id,!1),h=this.Ftm(Ja,b.id),Cb=this.HAa(b),Cb.Ub(26)){oa=this.HAa(Cb.currentNode);fb=oa.currentNode;let Gb=b;for(;fb;){const Sb=Cb.currentNode;Ja.insert(h++,Sb.id);fb=oa.Mf(26);const pc=this.HAa(Sb);54!==A.currentNode.type?Sb.setValue(Mc.a.eaa,A.currentNode.id):Sb.removeProperty(Mc.a.eaa);Rt.h(pc,A,Gb,26);Gb=pc.currentNode;fb&&(Cb.set(fb),Cb.B4(this.IAa().currentNode))}}54!==A.currentNode.type&&(h=this.qh.hr(A.currentNode.id,!0),Cb=this.qh.hr(A.currentNode.id,!1),
h.equals(b.id)&&this.qh.fJ(A.currentNode.id,M,!0),Cb.equals(b.id)&&this.qh.fJ(A.currentNode.id,aa,!1));r.Rg();v.ULS.sendTraceTag(528537621,368,50,"Disconnected nodeToDelete");this.remove(Ja,b.id);oa=Array(Ja.count);for(r=0;r<Ja.count;r++)oa[r]=Ja.K(r);A.currentNode.setValue(Mc.a.Wd,oa);Gh.a.rCa(b.id)}ETk(b,h,r,A,M,aa,oa=null){let Ja;if(h){var fb=this.jv(h.objectId);Ja=this.HAa(fb)}else Ja=this.IAa(),fb=Ja.currentNode;const Cb=this.Gpk.create(wm.a.Wd);oa&&Cb.properties.Yt(oa.properties);54!==fb.type&&
Cb.setValue(Mc.a.eaa,fb.id);oa?Ja.LRb(Cb,r,26,oa.id):Ja.UJ(Cb,r,26);this.B7j(b,Cb.id,M,!0);this.B7j(b,Cb.id,aa,!1);b.fg&&(h&&(r=this.qh.hr(fb.id,!0),oa=this.qh.hr(fb.id,!1),r.equals(M)&&this.qh.fJ(fb.id,Cb.id,!0),oa.equals(aa)&&this.qh.fJ(fb.id,Cb.id,!1)),this.U4j(M,aa,Cb.id,Gb=>{Gb=Gb.ka(Mc.a.a_,N.a.nil);const Sb=h?h.objectId:null;return!Gb||Gb.equals(N.a.nil)||Gb.equals(Sb)}));M=this.HAa(Cb);aa=Array(A.count);for(fb=A.count-1;0<=fb;fb--)aa[fb]=A.K(fb).objectId,r=this.jv(A.K(fb).objectId),r=this.HAa(r),
r.currentNode.setValue(Mc.a.eaa,Cb.id),Rt.h(r,M,null,26);0<aa.length&&Cb.setValue(Mc.a.Wd,aa);tx.sc.isFeatureEnabled(32)&&(b.d_d&&Cb.setValue(Mc.a.NLb,b.d_d),b.Exf&&Cb.setValue(Mc.a.DWd,!0));return Cb}B7j(b,h,r,A){12===this.jv(r).type?this.qh.fJ(h,r,A):(this.qh.LLg(h,r,A),this.qh.fJ(h,A?b.start.node.id:b.end.node.id,A))}JPo(b,h,r,A,M){b.setValue(Mc.a.aba,h);b.setValue(Mc.a.Wec,!0);b.setValue(Mc.a.ynb,!0);b.setValue(Mc.a.Hw,r);b.setValue(Mc.a.wnb,ly[0]);b.setValue(Mc.a.Xja,!0);b.setValue(Mc.a.O6a,
bD.a[M]);A&&b.setValue(Mc.a.Dzb,A);b.setValue(Mc.a.Xec,0)}V4j(b,h=null,r=null){h&&this.qh.fJ(b,h,!0);r&&this.qh.fJ(b,r,!1)}adi(b){if(!b||!b.count||!b.K(0))return null;const h=this.OLf(b);for(let r=0;r<b.count;r++)this.Oh.mNa(b.K(r));return h}OLf(b){if(!b||!b.K(0))return null;const h=this.Zc.Rl();h.set(b.K(0));h.Kd();h.rc();return h.RJ()?h.currentNode:null}tCm(b){const h=this.Zc.Rl();h.set(b);h.Kd();h.rc();h.rc();return h}IMh(b,h,r){const A=new ib.a;for(let M=0;M<r;M++){h=this.hT.QRb(b,h,!0,null);
if(!h||!b.Zd())return null;const aa=b.currentNode;b.rc();b.rc();A.add(aa)}return A}Jkc(b){const h=this.Zc.Rl();h.set(b);for(h.vb(7);h.rc();)switch(h.currentNode.type){case 8:case 16:case 36:case 40:return h.currentNode.id}return null}TBi(b){const h=this.Zc.Rl();h.set(b);h.Kd();return(b=h.UZa())?b.id:null}LJf(b){const h=this.Zc.Rl();h.set(b);return h.vb(7)?h:null}jv(b){return this.Di.value.Eb(b)}KNb(){if(!tx.Hmh){var b=this.IAa();b&&this.VIg(b);tx.Hmh=!0}}F_a(b){return this.oId.F_a(b)}ynf(b,h,r,A){let M=
null,aa=b.ld(16);for(;aa!==r;){if(h&&$g.TableCellReader.IWi(b)||!h&&$g.TableCellReader.KYf(b))M=b.ld(14);else return{returnValue:!1,zx:A};aa=b.ld(16)}M&&(A=wc.a.create(M));return{returnValue:!0,zx:A}}VIg(b){if(b.Ub(26)){for(this.VIg(b);b.Mf(26);)this.VIg(b);b.rc()}}remove(b,h){for(let r=0;r<b.count;r++)if(b.K(r).toString()===h.toString()){b.removeAt(r);break}}HAa(b){const h=this.Zc.Rl();h.set(b);h.B4(this.IAa().currentNode);return h}Ftm(b,h){for(let r=0;r<b.count;r++)if(b.K(r).equals(h))return r;
return-1}U4j(b,h,r,A){b=this.rkm(b,h);for(h=0;h<b.count;h++)A(b.K(h))&&(r?b.K(h).setValue(Mc.a.a_,r):b.K(h).removeProperty(Mc.a.a_),this.iBd.instance&&this.iBd.instance.PUi&&b.K(h).km(16,!0))}rkm(b,h){const r=new ib.a;var A=this.jv(b);const M=this.jv(h);if(!A||!M)return r;const aa=({Dad:oa}=this.V3d(A,M)).returnValue;A=oa[aa];if(14===A.type)r.add(A);else if(15===A.type&&1<=aa){const Ja=oa[aa-1];1===Ii.TableReader.yg(Ja)&&r.add(Ja)}var oa=vd.a.Za(aa>=oa.length-1?A:oa[aa+1]);oa.vb(7);for(A=uf.a.At(oa,
A);A.moveNext()&&A.currentNode!==M;)14===A.currentNode.type&&r.add(A.currentNode);if(!N.a.xt(h,b)&&14===M.type)for(oa=vd.a.Za(M),A=uf.a.At(oa,M);A.moveNext();)14===A.currentNode.type&&r.add(A.currentNode);return r}V3d(b,h){b=this.Wpb(b);h=this.Wpb(h);let r=0;for(;r<b.length&&r<h.length&&b[r]===h[r];++r);return{returnValue:0<r?r-1:r,Dad:b,Tug:h}}Wpb(b){const h=[];h.push(b);b=vd.a.Za(b);for(b.vb(7);b.rc();)h.push(b.currentNode);h.reverse();return h}static get sc(){return null!=tx.QUg?tx.QUg:tx.QUg=
Za.a.instance.Oa(12)}PWc(b,h,r=!1){b=this.FSe.instance.CFl(b);r?(r=Fs.a.mMl,b.setValue(Mc.a.Rkc,r)):r=b.ka(Mc.a.Rkc,null);h.setValue(Mc.a.eUa,r)}Qql(b,h){this.Krj(b)&&(b=b.ka(Mc.a.eUa,null),b=this.FSe.instance.Tql(b).ka(Mc.a.Rkc,null),h.setValue(Mc.a.eUa,b))}D5j(b,h){if(!this.Krj(h))return!1;var r=h.ka(Mc.a.eUa,null);r?iH(h)?this.PWc(b,h):this.FSe.instance.Pvp(r,b):(r=this.ria.pvi())?h.setValue(Mc.a.eUa,r):this.PWc(b,h,!0);return!0}Krj(b){if(!b)return!1;var h=b.getValue(Mc.a.O6a);if(!h)return!1;h=
Object(bD.b)(h);b=b.getValue(Mc.a.NLb);return(0==h||1==h)&&b!==Xj.Ufi}}tx.Hmh=!1;Object(u.a)(tx,"ContentControlGraphManager",null,[452]);class Aw{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb){this.TMe=Cb;this.roa=null;this.Qkn=(Gb,Sb)=>{if(this.X_)return this.Rkn(Gb,Sb);if(!Gb||!Gb.count)return v.ULS.sendTraceTag(17356048,368,15,"The GNC list should not be null or empty"),!1;let pc=!0;switch(Sb){case 0:Sb=this.fN(Gb.K(0),Gb.K(Gb.count-1),1);if((Gb=this.fN(Gb.K(0),Gb.K(Gb.count-1),3))&&0<Gb.count){if(!Gb.K(0).isSupported||
!Gb.K(0).isEditable){pc=!1;break}for(Gb=Gb.K(0);Gb;)this.Ijd(Sb,Gb.id),Gb=this.getById(Gb.parentId)}if(Sb)for(var zc of Sb)if(!zc.isSupported||!zc.isEditable){pc=!1;break}break;case 1:if(Gb.K(0).contextId!==lc.a.Xc){v.ULS.sendTraceTag(17356049,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.Inserting");pc=!1;break}(Sb=this.fN(Gb.K(0),Gb.K(0),1))&&0<Sb.count&&(pc=!1);break;case 2:if(Gb.K(0).contextId!==lc.a.Xc){v.ULS.sendTraceTag(17424994,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary");
pc=!1;break}(Sb=this.fN(Gb.K(0),Gb.K(0),3))&&0<Sb.count&&(pc=!1);break;case 3:case 4:Sb=this.h6d(Gb.K(0),!0);zc=this.h6d(Gb.K(Gb.count-1),!1);if(!Sb||!zc){v.ULS.sendTraceTag(17356050,368,15,"The GNC list is not supported for ApiOperation.Clearing or ApiOperation.Replacing");pc=!1;break}if((Sb=this.fN(Sb,Sb,3))&&0<Sb.count){pc=!1;break}if((Sb=this.fN(zc,zc,3))&&0<Sb.count){pc=!1;break}if(Sb=this.Vm.fN(Gb.K(0),Gb.K(Gb.count-1),1))for(const Yc of Sb)if(!Yc.Fla){pc=!1;break}break;default:pc=!1}return pc};
Aw.yz=b;Aw.Di=h;this.jh=r;this.sr=A;this.Vm=M;this.f5=aa;this.ria=oa;this.ig=Ja;this.yp=fb}get TWa(){return!!this.ig.instance&&this.ig.instance.TWa}get fta(){return!!this.ig.instance&&this.ig.instance.fta}get zce(){return!!this.ig.instance&&this.ig.instance.zce}get X_(){return!!this.ig.instance&&this.ig.instance.X_}get Bce(){return!!this.ig.instance&&this.ig.instance.Bce}rSb(){return!!this.ig.instance&&this.ig.instance.rSb}xqa(b,h,r=null,A=null,M=!1,aa=0){if(!this.TWa)return{returnValue:2,id:0};b=
this.jh.msa(b,!0);h=this.jh.msa(h,!1);if(!b||!h)return{returnValue:2,id:0};b=wc.a.create(b);h=wc.a.create(h);return this.rLh(b,h,r,A,M,aa,!1)}LSk(b,h,r=0,A=!1){return this.TWa&&b&&h?this.rLh(b,h,null,null,!1,r,A):{returnValue:2,id:0}}x5a(b,h=null,r=0,A=!1){let M=0;if(!this.TWa)return{returnValue:2,id:M};const aa=this.f5.$Lb(h,Aw.yz,Aw.Di,this.jh,this.sr,this.Vm,this.ria,this.TWa,this.zce);aa.type=r;aa.start=b;aa.end=b;aa.sv=b.node.id;aa.HA=b.node.id;aa.fg=!1;return this.Vm.tMh(aa,h,A)?(M=aa.id,{returnValue:0,
id:M}):{returnValue:2,id:M}}DTk(b,h=null){if(!this.TWa||!this.Vgn(b))return{returnValue:2,id:0};var r=b.K(0).contextId===lc.a.Uc?b.K(1):b.K(0);const A=b.K(b.count-1);if(this.oqf(b,lc.a.paragraph)||this.oqf(b,lc.a.Uc)){b=r.node.id;let M=A.node.id;const aa=b.equals(M);r=this.Vm.pVj(r,!0);void 0!==r&&null!==r&&(b=r,M=aa?b:M);this.Vm.pVj(A,!1);h.setValue(Mc.a.aba,!0);return this.xqa(b,M,h)}return r!==A||r.contextId!==lc.a.Cd&&r.contextId!==lc.a.Xc?{returnValue:2,id:0}:(h.setValue(Mc.a.aba,!1),this.x5a(r,
h))}getById(b){if(!this.fta)return null;const h=this.jh.A2c(this.jh.IAa(),r=>r.getValue(Mc.a.Hw)===b,!0);return 0<h.count?this.Vm.uR(h.K(0)):null}getByTitle(b){if(!this.fta)return null;const h=this.jh.A2c(this.jh.IAa(),A=>A.ka(Mc.a.vnb,null)===b,!1),r=new ib.a;for(const A of h)r.add(this.Vm.uR(A));return r}getByTag(b){if(!this.fta)return null;const h=this.jh.A2c(this.jh.IAa(),A=>A.ka(Mc.a.znb,null)===b,!1),r=new ib.a;for(const A of h)r.add(this.Vm.uR(A));return r}fN(b,h,r,A=!1){return this.fta?this.X_?
this.Vm.osa(b,h,r):this.Vm.fN(b,h,r,A):null}YW(b,h){return this.Vm.YW(b,h)}wem(){if(!this.fta)return null;const b=this.jh.A2c(this.jh.IAa(),()=>!0,!1),h=new ib.a;for(const r of b)h.add(this.Vm.uR(r));return h}RYb(b){if(!this.TWa)return v.ULS.sendTraceTag(528537618,368,15,"Cannot release content control, isContentControlWriteEnabled = false"),2;b=this.getById(b);return this.Vm.sDa(b)?0:2}zNl(b){if(!this.TWa)return 2;b=this.getById(b);return this.Vm.deleteContentControl(b)?0:2}WTk(b){this.Vm.Qyj(b)}qal(b){this.roa=
b;this.roa.fso(this.Qkn)}Fkm(b){if(!this.rSb())return null;let h;var r=b.SG();h=this.h6d(r.K(r.count-1),!1);r=this.sr.Xjc(r.K(r.count-1).node,h.cpBegin).Hb;b=this.fLm(r,b);if(-1===b)return null;h.Fb=b;h.Tb=h.Fb;return h}Rkn(b,h){if(!b||!b.count)return v.ULS.sendTraceTag(21031131,368,15,"The GNC list should not be null or empty"),!1;switch(h){case 0:return this.$en(b);case 3:case 4:case 6:return this.Wmn(b,6===h);case 1:case 2:case 5:return 1!==b.count||b.K(0).contextId!==lc.a.Xc?(v.ULS.sendTraceTag(21031132,
368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary"),!1):this.NXi(b.K(0),5===h,!1);default:return!1}}$en(b){const h=this.Vm.osa(b.K(0),b.K(b.count-1),3);if(h&&0<h.count){var r=h.K(0);if(!r.isSupported||!r.isEditable)return!1}b=this.Vm.osa(b.K(0),b.K(b.count-1),1);for(r=0;h&&r<h.count;r++)this.Ijd(b,h.K(r).id);if(b)for(const A of b)if(!A.isSupported||!A.isEditable)return!1;return!0}Wmn(b,h){var r=b.K(0),A=b.K(b.count-1),M=r.Hj,aa=A.Oo;if(-1===
M||-1===aa)return!1;M=this.yp.Haa(r.node,M,r.Fb);aa=this.yp.Haa(A.node,aa,A.Tb);var oa=-1,Ja=Math.min(M.count,aa.count);for(--Ja;0<=Ja;Ja--){const fb=M.K(Ja).qe,Cb=aa.K(Ja).qe;if(fb.equals(Cb)){oa=Ja;break}}if(-1<oa&&(Ja=this.Vm.uR(M.K(oa).Wd),!Ja.isEditable||!Ja.isSupported||Ja.GL&&!this.Ben(Ja,b)))return!1;r=this.Vm.osa(r,A,1);for(A=0;A<=oa;A++)this.Ijd(r,this.Vm.uR(M.K(A).Wd).id);for(A=oa+1;A<M.count;A++){Ja=this.Vm.uR(M.K(A).Wd);if(!Ja.isEditable||!Ja.Fla||!Ja.isSupported||Ja.GL)return!1;this.Ijd(r,
Ja.id)}for(M=oa+1;M<aa.count;M++){oa=this.Vm.uR(aa.K(M).Wd);if(!oa.isEditable||!oa.Fla||!oa.isSupported||oa.GL)return!1;this.Ijd(r,oa.id)}if(r)for(const fb of r)if(!fb.isSupported||!fb.Fla)return!1;return h&&(b=this.h6d(b.K(0),!0))?this.NXi(b,!0,!0):!0}Ben(b,h){h=this.yp.qCm(h.K(0),h.K(h.count-1));return!!b&&!!h&&b.objectId.equals(h.qe)}NXi(b,h,r){return(b=this.Vm.osa(b,b,3))&&0<b.count&&(b=b.K(0),!b.isSupported||!b.isEditable||!this.Bce&&h&&!b.fg||!r&&b.GL||gp.a.Njg&&h&&1===b.type)?!1:!0}h6d(b,h){if(!b)return null;
let r=null;switch(b.contextId){case lc.a.paragraph:r=h?wc.a.Tc(b.node,0):wc.a.vx(b.node);break;case lc.a.Uc:r=wc.a.vx(b.node);break;case lc.a.Cd:r=h?wc.a.Tc(b.node,b.cpBegin):wc.a.Tc(b.node,b.cpEnd);break;case lc.a.Xc:r=b}r&&(r.Tb=r.Fb=h?b.Fb:b.Tb);return r}Ijd(b,h){if(b)for(const r of b)if(r.id===h){b.remove(r);break}}fLm(b,h){if(!b)return-1;let r=-1;for(let A=0;A<b.length;A++)if(b.K(A).qe.equals(h.objectId)&&!1===b.K(A).Vc){r=A;if(h.fg&&0<A&&b.K(A-1).fg&&!b.K(A-1).Vc)return-1;break}return r}Vgn(b){if(void 0===
b||null===b)return!1;for(let h=0;h<b.count;h++){const r=b.K(h).contextId;if(r!==lc.a.paragraph&&r!==lc.a.Uc&&r!==lc.a.Cd&&r!==lc.a.Xc||0<h&&h<b.count-1&&r===lc.a.Cd&&(b.K(h).cpBegin||b.K(h).cpEnd!==b.K(h).node.characterData.length))return!1}return b.K(0).contextId===lc.a.Uc&&1===b.count||this.oqf(b,lc.a.Xc)&&1<b.count?!1:!0}oqf(b,h){for(const r of b)if(r.contextId===h)return!0;return!1}rLh(b,h,r=null,A=null,M=!1,aa=0,oa=!1){let Ja=0;var fb=h.node;let Cb=wc.a.create(b.node);fb=wc.a.create(fb);if(!({LVj:Cb,
sii:fb}=this.TMe.A0h(Cb,fb)).success)return{returnValue:2,id:Ja};const Gb=this.f5.$Lb(r,Aw.yz,Aw.Di,this.jh,this.sr,this.Vm,this.ria,this.TWa,this.zce);Gb.type=aa;Gb.start=b;Gb.end=h;Gb.sv=Cb.node.id;Gb.HA=fb.node.id;Gb.fg=!0;Gb.d_d=A;Gb.Exf=M;return this.Vm.tMh(Gb,r,oa)?(Ja=Gb.id,{returnValue:0,id:Ja}):{returnValue:2,id:Ja}}}Aw.yz=null;Aw.Di=null;Object(u.a)(Aw,"ContentControlManager",null,[451]);var UE=d(619),UJ=d(144),ux=d(186);class cD extends Sys.EventArgs{constructor(b){super();this.dbi=b}}
Object(u.a)(cD,"ContentControlChangeEventArgs",Sys.EventArgs,[]);var VJ=d(1363);class cA{constructor(){this.Gfj=0;this.hqj=null}}Object(u.a)(cA,"BypassIfNodeOfTypeAndParentMatchingConditionFilterData",null,[]);const EB=b=>!(null===b||void 0===b?0:b.length),kH=b=>null==b?!1:[...b].some(h=>h.Vc),lH=b=>null==b?!1:[...b].some(h=>!h.Vc);class Bw{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc,zc,Yc,Kd,ke,ge,de,Sd,be,Rf,Mf,Yj){this.Mj=Mf;this.zzh=[];this.v4e=[];this.yz=b;this.Di=h;this.jh=r;this.sr=A;this.f5=
M;this.Ke=Ja;this.Vx=fb;this.hb=aa;this.sG=oa;this.ria=pc;this.pJb=zc;this.nja=Cb;this.tK=Gb;this.ga=Sb;this.yp=Yc;this.ig=Kd;this.ri=ke;this.jb=ge;this.Qc=de;this.WIh=Sd;this.Bd=be;this.qh=Rf;this.tK&&(this.tK.addHandler(UE.a.QYb,Object(E.a)(this,this.Bmj,"onShowingPlaceholder")),this.tK.addHandler(UE.a.gte,Object(E.a)(this,this.Dlj,"onRemoveWhenEdited")),Yj.execute(Ji=>{this.pG=Ji}))}get ov(){return this.yz.value}get Dj(){return this.Di.value}get X_(){return!!this.ig.instance&&this.ig.instance.X_}get d3(){return!!this.Bd&&
this.Bd.isFeatureEnabled(26)}dispose(){this.tK&&(this.tK.removeHandler(UE.a.QYb,Object(E.a)(this,this.Bmj,"onShowingPlaceholder")),this.tK.removeHandler(UE.a.gte,Object(E.a)(this,this.Dlj,"onRemoveWhenEdited")))}fN(b,h,r,A=!1){if(this.X_)return this.osa(b,h,r);if(!b||!h)return null;const M=this.jh.msa(b.node.id,!0);var aa=this.jh.msa(h.node.id,!1);if(!M||!aa)return null;b=b.contextId===lc.a.Uc?b:wc.a.Tc(M,-1===b.cpBegin?0:b.cpBegin);h=h.contextId===lc.a.Uc?h:wc.a.Tc(aa,-1===h.cpEnd?aa.characterData.length:
h.cpEnd);aa=null;switch(r){case 0:aa=this.Tom(b,h);break;case 1:aa=this.ACm(b,h);break;case 3:aa=this.CCi(b,h,A);break;case 2:aa=this.fMm(b,h);break;case 4:aa=this.iHf(b,h,!1)}return aa}osa(b,h,r){if(!b||!h||b.contextId!==lc.a.Uc&&(b=this.p6h(b,!0),!b)||h.contextId!==lc.a.Uc&&(h=this.p6h(h,!1),!h))return null;let A=null;switch(r){case 0:A=this.Uom(b,h);break;case 1:A=this.BCm(b,h);break;case 3:A=this.DCi(b,h);break;case 2:A=this.gMm(b,h);break;case 4:A=this.iHf(b,h,!0)}return A}p6h(b,h){var r=this.jh.msa(b.node.id,
h);if(!r)return null;h?(h=-1===b.cpBegin?0:b.cpBegin,b=b.Fb):(h=-1===b.cpEnd?r.characterData.length:b.cpEnd,b=b.Tb);r=wc.a.Tc(r,h);r.Fb=b;r.Tb=b;return r}Tom(b,h){const r=new ib.a;if(b.contextId===lc.a.Uc||h.contextId===lc.a.Uc||b.equals(h))return r;const A=new bp.a,M=this.UOb(b,b),aa=this.UOb(h,h);for(let oa=0;oa<M.count;oa++)if(M.K(oa).Vc)for(let Ja=0;Ja<aa.count;Ja++)aa.K(Ja).Vc||M.K(oa).qe.equals(aa.K(Ja).qe)&&(!M.K(oa).fg||this.jh.pXa(M.K(oa).qe,b.node.id,!0)&&this.jh.pXa(aa.K(Ja).qe,h.node.id,
!1))&&this.gQd(r,A,M.K(oa).qe);return r}Uom(b,h){const r=new ib.a;if(b.contextId===lc.a.Uc||h.contextId===lc.a.Uc||b.equals(h)&&b.Fb===b.Tb||-1===b.Fb||-1===h.Tb)return r;var A=b.node.ra.sh(b.cpBegin),M=h.node.ra.sh(h.cpEnd);A&&A.Hb&&0<A.Hb.length&&b.Fb<=A.Hb.length&&M&&M.Hb&&0<M.Hb.length&&h.Tb<=M.Hb.length&&(b=b.Fb,h=h.Tb,b===A.Hb.length&&b--,0<h&&h--,A=A.Hb.K(b),M=M.Hb.K(h),A.Vc&&!M.Vc&&N.a.xt(A.qe,M.qe)&&A.jq&&M.jq&&(M=A.Wd)&&r.add(this.uR(M)));return r}ACm(b,h){const r=new ib.a,A=new bp.a,M=
this.UOb(b,h);for(let aa=0;aa<M.count;aa++)this.gQd(r,A,M.K(aa).qe);b=this.CCi(b,h,!1,!1);for(const aa of b)A.contains(aa.objectId)||(r.add(aa),A.add(aa.objectId));return r}BCm(b,h){const r=new ib.a,A=new bp.a,M=this.oGf(b,h);for(let aa=0;aa<M.count;aa++)this.odf(r,A,M.K(aa));b=this.DCi(b,h);for(const aa of b)A.contains(aa.objectId)||(r.add(aa),A.add(aa.objectId));return r}CCi(b,h,r,A=!0){const M=new ib.a;b.equals(h)&&(r=!1);const aa=new bp.a;let oa=!1;b=this.UOb(null,b,!0,r);h=this.UOb(h,null,r,
!0);for(r=b.count-1;0<=r;r--){for(let Ja=0;Ja<h.count&&!(b.K(r).qe.equals(h.K(Ja).qe)&&(b.K(r),this.gQd(M,aa,b.K(r).qe)&&(oa=!this.jh.jv(b.K(r).qe).ka(Mc.a.eaa,null),A||oa)));Ja++);if(0<M.count&&(A||oa))break}return M}DCi(b,h){const r=new ib.a,A=new bp.a,M=b.node;var aa=h.node;const oa=h.contextId===lc.a.Uc?aa.characterData.length:h.cpEnd;b=this.yp.Haa(M,b.contextId===lc.a.Uc?M.characterData.length:b.cpBegin,b.Fb);h=this.yp.Haa(aa,oa,h.Tb);aa=b.count>h.count?h.count:b.count;for(--aa;0<=aa;aa--)b.K(aa).qe.equals(h.K(aa).qe)&&
this.odf(r,A,b.K(aa));return r}fMm(b,h){const r=new ib.a;let A=new bp.a;const M=this.UOb(b,h);let aa=0,oa=null;if(b.equals(h))return r;for(b=0;b<M.count;b++)!M.K(b).Vc||M.K(b).fg&&!this.jh.pXa(M.K(b).qe,M.K(b).Jb.paragraph.id,!0)?M.K(b).Vc||M.K(b).fg&&!this.jh.pXa(M.K(b).qe,M.K(b).Jb.paragraph.id,!1)||(aa--,0>aa?(aa=0,A=new bp.a):!aa&&oa&&M.K(b).qe.equals(oa)&&this.gQd(r,A,oa)):(aa||(oa=M.K(b).qe),aa++);return r}gMm(b,h){const r=new ib.a;if(b.equals(h)&&b.Fb===h.Tb)return r;let A=new bp.a;b=this.oGf(b,
h);h=0;let M=null;for(let aa=0;aa<b.count;aa++){const oa=b.K(aa);!oa.Vc||oa.fg&&!this.jh.pXa(oa.qe,oa.Jb.paragraph.id,!0)?oa.Vc||oa.fg&&!this.jh.pXa(oa.qe,oa.Jb.paragraph.id,!1)||(h--,0>h?(h=0,A=new bp.a):!h&&M&&oa.qe.equals(M.qe)&&this.odf(r,A,M)):(h||(M=oa),h++)}return r}iHf(b,h,r){const A=new ib.a;b=r?this.oGf(b,h):this.UOb(b,h);h=0;for(r=0;r<b.count;r++){var M=b.K(r);M.jq&&(M.Vc?h++:(h--,0>h?h=0:(M=this.uR(M.Wd))&&A.add(M)))}return A}UOb(b,h,r=!0,A=!0){const M=new ib.a,aa=this.YW(b,h);if(!aa.count)return M;
let oa,Ja,fb,Cb;for(let Gb=0;Gb<aa.count;Gb++){oa=0;Ja=aa.K(Gb).characterData.length;fb=Cb=!0;if(b&&aa.K(Gb).id.equals(b.node.id)){if(b.contextId===lc.a.Uc)continue;0<=b.cpBegin&&(oa=b.cpBegin)}h&&aa.K(Gb).id.equals(h.node.id)&&0<=h.cpEnd&&(Ja=h.cpEnd);Gb||(fb=r);Gb!==aa.count-1||h&&h.contextId===lc.a.Uc||(Cb=A);M.addRange(this.pGf(aa.K(Gb),oa,Ja,fb,Cb))}return M}oGf(b,h){const r=new ib.a,A=this.YW(b,h);let M,aa,oa;for(let fb=0;fb<A.count;fb++){const Cb=A.K(fb);if(Cb.ra.length){var Ja=Cb.ra.K(Cb.ra.length-
1);M=0;aa=Cb.characterData.length;oa=0;Ja=Ja&&Ja.Hb?Ja.Hb.length:0;b&&Cb.id.equals(b.node.id)&&(M=b.Hj,oa=b.Fb);h&&Cb.id.equals(h.node.id)&&(aa=h.Oo,Ja=h.Tb);r.addRange(this.qGf(Cb,M,aa,oa,Ja))}}return r}pGf(b,h,r,A=!0,M=!0,aa=!0){const oa=new ib.a;b=b.ra;for(let Ja=0;Ja<b.length;Ja++){if(b.K(Ja).cp<h)continue;if(b.K(Ja).cp>r)break;const fb=b.K(Ja);if(fb.Hb&&0<fb.Hb.length&&(fb.cp!==h||A)&&(fb.cp!==r||M))for(let Cb=0;Cb<fb.Hb.length;Cb++){const Gb=fb.Hb.K(Cb);(aa||Gb.Vc)&&oa.add(Gb)}}return oa}qGf(b,
h,r,A,M){const aa=new ib.a;b=b.ra;for(let oa=0;oa<b.length;oa++){if(b.K(oa).cp<h)continue;if(b.K(oa).cp>r)break;const Ja=b.K(oa);if(Ja.Hb&&0<Ja.Hb.length){let fb=0,Cb=Ja.Hb.length;Ja.cp===h&&-1!==A&&(fb=A);for(Ja.cp===r&&-1!==M&&(Cb=M);fb<Cb&&fb<Ja.Hb.length;fb++)aa.add(Ja.Hb.K(fb))}}return aa}gQd(b,h,r){let A=null;if(h.contains(r)||!(A=this.Dj.Eb(r)))return!1;b.add(this.uR(A));h.add(r);return!0}odf(b,h,r){let A=null;!h.contains(r.qe)&&(A=r.Wd)&&(b.add(this.uR(A)),h.add(r.qe))}S1j(b,h){let r,A=!1;
r=({dcb:h,ccb:b,kod:A}=this.T1j(b,h,!1,A)).returnValue||A;A&&(r=r||({dcb:h,ccb:b,kod:A}=this.T1j(h,b,!0,A)).returnValue);return{returnValue:r,dcb:h,ccb:b}}T1j(b,h,r,A){let M,aa;if(r)return M=aa=null,{returnValue:!1,dcb:aa,ccb:M,kod:!1};let oa=!1;aa=b;M=h;const Ja=b.cpBegin,fb=h.cpEnd;A=!1;var Cb=r?this.vri(h):this.Lem(b);let Gb=!1,Sb=!1,pc=0,zc=0;for(const Yc of Cb)for(Cb=0;Cb<Yc.ra.length;Cb++){const Kd=Yc.ra.K(Cb);!Sb&&Yc.id.equals(h.node.id)&&(Sb=!0);if(!Gb&&(Yc.id.equals(h.node.id)&&-1!==fb&&
Kd.cp>fb||Sb&&!Yc.id.equals(h.node.id)))if(Gb=!0,pc!==zc)oa=!0;else return{returnValue:!1,dcb:aa,ccb:M,kod:A};if((!Yc.id.equals(b.node.id)||Kd.cp>=Ja||-1===Ja)&&Kd.Hb)for(let ke=0;ke<Kd.Hb.length;ke++){const ge=Kd.Hb.K(ke),de=this.Dj.Eb(ge.qe);if(!de.getValue(Mc.a.aba)||(!ge.Vc||this.jh.pXa(this.qh.hr(de.id,!0),Yc.id,!0))&&(ge.Vc||this.jh.pXa(this.qh.hr(de.id,!1),Yc.id,!1))){ge.Vc?pc++:pc--;if(oa&&pc===zc)return{dcb:aa,ccb:M}=this.mCl(b.node,Yc,b.cpBegin,Kd.cp),{returnValue:!0,dcb:aa,ccb:M,kod:A};
!r&&pc<zc&&(A=!0,zc--)}}}return{returnValue:oa,dcb:aa,ccb:M,kod:A}}mCl(b,h,r,A){let M;h.id.equals(b.id)?b=0<r||A<Gd.ParagraphReader.textLength(h)?M=wc.a.createTextRange(h,r,A):M=wc.a.create(h):(M=0<r?wc.a.createTextRange(b,r,Gd.ParagraphReader.textLength(b)):wc.a.create(b),b=A<Gd.ParagraphReader.textLength(h)?wc.a.createTextRange(h,0,A):wc.a.create(h));return{dcb:M,ccb:b}}hym(b){const h=b.cpBegin,r=this.vri(b);for(let M=r.count-1;0<=M;M--){const aa=r.K(M);for(let oa=aa.ra.length-1;0<=oa;oa--){const Ja=
aa.ra.K(oa);if((!aa.id.equals(b.node.id)||Ja.cp<=h||-1===h&&!Ja.cp)&&Ja.Hb){var A=Ja.Hb.length-1;for((Ja.cp===h||-1===h&&!Ja.cp)&&this.X_&&aa.id.equals(b.node.id)&&(A=b.Fb-1);0<=A;A--){const fb=Ja.Hb.K(A),Cb=this.Dj.Eb(fb.qe);if(fb.Vc){if(Cb.getValue(Mc.a.aba)&&!this.jh.pXa(this.qh.hr(Cb.id,!0),aa.id,!0))continue;return null}if(!Cb.getValue(Mc.a.aba)||this.jh.pXa(this.qh.hr(Cb.id,!1),aa.id,!1))return this.uR(Cb)}}}}return null}uR(b){if(!b)return null;this.jh.KNb();return this.f5.$Lb(b,this.yz,this.Di,
this.jh,this.sr,this,this.ria,this.nja,this.pJb)}YW(b,h){b=this.tri(b,h,Bw.DPb(12));if(!b)return null;h=new ib.a;for(const r of b)h.add(r);return h}Jem(b,h){const r=Bw.vum();return this.tri(wc.a.create(b.node),wc.a.create(h.node),r)}tri(b,h,r){if(!r||!b&&!h)return null;if(b&&h&&(b.equals(h)||b.node.id.equals(h.node.id))){var A=b.node;if(A&&r(A)){var M;return M=new ib.a,M.add(A),M}}A=Object.assign(new cA,{Gfj:35,hqj:r});b=b?b.node:null;h=h?h.node:null;M=this.NGm(b,h);if(!M)return null;h=this.c1k(h,
r,Bw.iXh,A);return this.Fem(b,h,M,r,Bw.iXh,A)}NGm(b,h){return(b=b?this.jzi(b):this.jzi(h))?b.ld(35):this.jh.jBm()}c1k(b,h,r,A){if(!b)return null;h(b)||(h=this.Gem(b,h,r,A),h.count&&(b=h.K(h.count-1)));return b}Fem(b,h,r,A,M,aa){b?(b=vd.a.Za(b),b.vb(7),r=uf.a.At(b,r)):r=uf.a.gq(r);M&&r.pp(M,aa);for(M=new ib.a;r.moveNext()&&(A(r.currentNode)&&M.add(r.currentNode),!h||!r.currentNode.id.equals(h.id)););return M}Gem(b,h,r,A){b=uf.a.gq(b);r&&b.pp(r,A);for(r=new ib.a;b.moveNext();)h(b.currentNode)&&r.add(b.currentNode);
return r}jzi(b){b=vd.a.Za(b);return b.vb(35)?b:null}eMi(b,h){b=this.YW(b,h);for(const r of b)if((b=this.jh.LJf(r))&&b.lla(4))return!0;return!1}tMh(b,h=null,r=!1){if(!b)return!1;var A=b.start,M=b.end;if(!ze.a.nw(A)&&A.contextId!==lc.a.paragraph||!ze.a.nw(M)&&M.contextId!==lc.a.paragraph||!this.X_&&({dcb:A,ccb:M}=this.S1j(b.start,b.end)).returnValue||this.X_&&!({start:A,end:M}=this.Wil(A,M)).returnValue)return!1;b.start=A;b.end=M;const aa=this.lfn(A,M);if(this.X_){var oa=this.osa(b.start,b.end,3);var Ja=
this.osa(b.start,b.end,2)}else oa=this.fN(b.start,b.end,3),Ja=this.fN(b.start,b.end,2);const fb=oa&&0<oa.count?oa.K(0):null,Cb=Ja&&0<Ja.count?Ja.K(0):null;if(r)return this.e8c(b,0,oa)?!0:!1;if(this.e8c(b,0,oa)){r=(r=Object(ya.a)(TE,this.hym(b.start)))?this.jh.jv(r.objectId):null;Ja=this.jh.ETk(b,fb,r,Ja,b.sv,b.HA,h);this.Mj.Cqc(Ja);if(b.fg)for(M=this.YW(b.start,b.end),r=0;r<M.count;r++)if(this.X_){oa=fb?fb.objectId:null;const Gb=this.Oyi(oa,M.K(r),!0);this.sr.Iya(M.K(r),Ja.id,0,!0,!0,void 0,void 0,
void 0,void 0,Gb);oa=this.Oyi(oa,M.K(r),!1);this.sr.Iya(M.K(r),Ja.id,M.K(r).characterData.length,!0,!1,void 0,void 0,void 0,void 0,oa)}else this.sr.Iya(M.K(r),Ja.id,0,!0,!0),this.sr.Iya(M.K(r),Ja.id,M.K(r).characterData.length,!0,!1);else this.X_?(r=-1===A.Fb?0:A.Fb,this.sr.Iya(b.start.node,Ja.id,A.cpBegin,!1,!0,void 0,void 0,void 0,void 0,r),this.sr.Iya(b.end.node,Ja.id,M.cpEnd,!1,!1,void 0,void 0,void 0,void 0,aa?r+1:M.Tb)):(this.sr.Iya(b.start.node,Ja.id,b.start.cpBegin,!1,!0),this.sr.Iya(b.start.node,
Ja.id,b.start.cpEnd,!1,!1));h||this.jh.JPo(Ja,b.fg,b.id,this.jh.Jkc(this.jh.jv(b.sv)),b.type);1===b.type&&this.sr.Uop(b.start.node,A.Hj,A.Oo);h=!(gp.a.mec&&8===b.type);b.objectId=Ja.id;A=this.jh.IAa().currentNode;h&&!A.hasProperty(Mc.a.VVc)&&A.setValue(Mc.a.VVc,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder);h&&gp.a.Ufa&&this.jh.D5j(WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,Ja);fb&&this.R6j(fb.Wd,b);Cb&&this.R6j(Ja,Cb);h&&aa&&this.ga.Pb(ub.a.God,2,b.id);gp.a.mec&&
8===b.type&&this.jLj(!1,b,Ja);VJ.a.E5h()&&this.pG&&this.pG.fireEvent(3,{node:Ja});return!0}return!1}deleteContentControl(b){if(!this.e8c(b,3))return v.ULS.sendTraceTag(528537614,368,15,"Invalid content control to delete"),!1;if(this.Mj.Nrd(b.Wd))return!0;b.GL&&(b.GL=!1);const h=this.hb.gb.currentSelection;b=b.SG();const r=new Er.Selection(b.toArray(),!0);let A=!1;this.hb.HZb(()=>{this.hb.Kc(r);if(32===this.ga.Ob(ub.a.JJ,2)){if(this.WIh.instance){const M=this.WIh.instance.FAi(h,r,this.hb.gb.currentSelection);
this.hb.Mqp(new UJ.SelectionCollection([M],0))}A=!0}});return A}sDa(b,h=!1,r=!1){if(this.e8c(b,2)){if(b.GL)return v.ULS.sendTraceTag(528537615,368,15,"Attempting to delete content control showing placeholder"),this.deleteContentControl(b);const A=b.Wd;let M=new ib.a;h&&(M=b.AFf());M.add(b);if(r||!this.Mj.Nrd(b.Wd)){A&&A.anchor&&this.jh.Jci(A,h);for(const aa of M)b=this.YW(aa.start,aa.end),this.sr.JNl(b,aa.objectId);this.ewj(M)}v.ULS.sendTraceTag(528537616,368,50,"Successfully released content control.");
return!0}v.ULS.sendTraceTag(528537617,368,15,"Invalid content control to release.");return!1}Izg(b,h){if(this.e8c(b,1)){let Ja=!1;h||(Ja=!0,{u0o:r,returnValue:h}=this.cQb(b),r&&this.jh.IAa().currentNode.setValue(Mc.a.VVc,h));var r=b.Ati().toArray();for(var A=0;A<r.length;A++)this.sDa(r[A],!0);r=this.d9o(h);if(b.fg){A=this.YW(b.start,b.end);if(!A.count)return!1;if(1===A.count&&y.AFrameworkApplication.fv)this.sr.Ve(wc.a.createTextRange(A.K(0),0,A.K(0).characterData.length),h);else{var M=this.jh.tCm(A.K(0));
h=A.K(0).Pic();A=this.jh.adi(A);A=this.jh.IMh(M,A,r.length);for(M=0;M<A.count;M++){this.sr.Ve(wc.a.createTextRange(A.K(M),0,0),r[M],void 0,b.type);for(var aa=0;aa<h.count;aa++)this.sr.Iya(A.K(M),h.K(aa),0,!0,!0),this.sr.Iya(A.K(M),h.K(h.count-aa-1),A.K(M).characterData.length,!0,!1)}b.Pwp(A.K(0).id,A.K(A.count-1).id);r=this.sG.ue(A.K(0),0);this.hb.Kc(r)}}else{M=0;1<r.length&&v.ULS.sendTraceTag(17585367,368,15,"New text being set to an inline content control should not contain multiple paragraphs");
h=b.start;A=h.node;for(var oa=0;oa<A.ra.length&&h.contextId===lc.a.Cd;oa++)if(aa=A.ra.K(oa),aa.cp===h.cpBegin&&aa.blob){M++;for(oa+=1;oa<A.ra.length;oa++)if(aa=A.ra.K(oa),aa.cp>h.cpBegin&&aa.cp<=h.cpEnd)if(aa.blob)M++;else break;else if(aa.cp>h.cpEnd)break;break}if(0<M&&M+h.cpBegin<h.cpEnd)A=wc.a.createTextRange(h.node,h.cpBegin,h.cpBegin+M),h=wc.a.createTextRange(h.node,h.cpBegin+M,h.cpEnd),this.sr.Ve(h,r[0]),this.sr.Ve(A,"");else if(0<M&&M+h.cpBegin===h.cpEnd)for(this.sr.Ve(b.start,r[0]),r=0;r<
A.ra.length;r++){if(M=A.ra.K(r),M.cp===h.cpBegin){M.blob=null;break}}else y.AFrameworkApplication.fv?(r=r.join(" "),this.sr.Ve(b.start,r)):this.sr.Ve(b.start,r[0],void 0,b.type)}this.cKb(b,Ja);let fb;this.Yio((fb=new ib.a,fb.add(b),fb));return!0}return!1}cKb(b,h){const r=this.sr.Xjc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(r){const M=this.jh.jv(b.objectId);if(h){h=this.Vx.AF(b.start.node);var A=h.lh(Fs.a.Gjg);A||(si.a.Xg.Ln?(A=h.gv().YAa(Fs.a.Mrj),A=h.lh(this.Vx.ze(A))):A=h.wKa(Fs.a.Mrj));
A&&(this.Ke.$qa(r.formatting),this.Ke.Ydb(r.formatting,A));M&&(b.GL=!0)}else M&&b.GL&&(this.jEo(b,r),b.GL=!1)}else v.ULS.sendTraceTag(17585368,368,15,"Unable to get a ChP at starting Ip of Content Control")}jEo(b,h){b=this.jh.jv(b.objectId);let r=null;b&&(r=b.ka(Mc.a.PLb,N.a.nil));this.Ke.$qa(h.formatting);r&&!r.equals(N.a.nil)&&(b=this.Di.value.Eb(r),h.formatting=b)}cQb(b){let h=!1;b=b.placeholderText;this.Uon(b)&&(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,h=!0);return{returnValue:b,
u0o:h}}Sto(b,h=!0){this.nja&&(h&&this.Oto(b),this.Yto(b))}Tto(b){if(this.nja&&(b=this.fN(b,b,4)))for(const h of b)this.sDa(h,!1)}BTn(b,h){if(h&&!b.Vc&&(this.jh.KNb(),(b=b.Jb.paragraph.Ic.Eb(b.qe))&&b.anchor)){this.jh.Jci(b);b=this.f5.$Lb(b,this.yz,this.Di,this.jh,this.sr,this,this.ria,this.nja,this.pJb);let r;this.ewj((r=new ib.a,r.add(b),r))}}Dlj(b,h){this.jh.KNb();b=this.jh.jv(h.qe);const r=this.uR(b);if(r&&r.isValid()&&r.removeWhenEdited){const A=this.Qc.Nc(7);A.Bb(b);this.sDa(r,!1);h.state=2;
A.dispose()}}Bmj(b,h){this.jh.KNb();b=this.jh.jv(h.qe);this.hdn(b)&&(b=b.ka(Mc.a.Hw,0),this.ga&&(this.ga.Pb(ub.a.God,2,b),Bw.Od.qgf()))}hdn(b){return b&&b.isConnected&&!b.ka(Mc.a.faa,!1)?this.LWf(b)&&!b.ex:!1}LWf(b){b=this.f5.$Lb(b,this.yz,this.Di,this.jh,this.sr,this,this.ria,this.nja,this.pJb);if(!b.isValid())return!1;if(b.fg){if(b.sv.toString()===b.HA.toString()){var h=this.jh.jv(b.sv);if(!h)return v.ULS.shipAssertTag(22828291,368,!1,"Block content control is connected but its start node is null"),
!1;if(12===h.type&&1===h.ra.length)return this.QUi(h.ra.K(0),b.objectId)}}else{h=b.start;if(!h)return v.ULS.shipAssertTag(22828292,368,!1,"Inline content control is connected but its start context is null"),!1;if(h.cpBegin===h.cpEnd)return h=this.jh.jv(b.sv).ra.sh(h.cpBegin),this.QUi(h,b.objectId)}return!1}QUi(b,h){b=b?b.Hb:null;if(!b)return!1;const r=b.uL(h,!0);return-1<r&&r+1<b.length&&b.K(r+1).qe.toString()===h.toString()}Qyj(b){this.v4e.push(b)}pVj(b,h){if(void 0===b||null===b||b.contextId!==
lc.a.Cd)return null;b=wc.a.Tc(b.node,h?b.cpBegin:b.cpEnd);return 0<b.cpBegin&&b.cpBegin<Gd.ParagraphReader.textLength(b.node)?this.jh.F_a(b):null}select(b,h){if(b&&!b.equals(N.a.nil)){var r=this.jh.jv(b);if(r&&55===r.type){r=this.uR(r);if(r.fg)r=this.Bgm(r);else{r=r.start;if(!r)return;r.contextId=lc.a.Cd;r=this.sG.Qo(r)}if(r&&r.length)return this.wLj(r.Qa,b,h,!0,!0),this.wLj(r.Wc,b,h,!1,!1),this.hb.Kc(r),r}}}cKo(b,h){if(!ze.a.pf(b)||b.Fb!==b.Tb)return!1;const r=b.Fb;return-1===r?!1:(b=this.yp.I8a(b.node,
b.cpBegin,r,!h))&&h===b.Vc?(h=this.uR(b.Wd),this.select(b.qe,!h.isEditable),!0):!1}Bgm(b){var h=this.jh.mVa(b.sv,!0);b=this.jh.mVa(b.HA,!1);if(!h||!b)return null;h=this.Jem(wc.a.create(h),wc.a.create(b));if(!h||!h.count)return null;b=new ib.a;for(let r=0;r<h.count;r++){let A;if(12===h.K(r).type)A=r===h.count-1?wc.a.createTextRange(h.K(r),0,Gd.ParagraphReader.textLength(h.K(r))):wc.a.create(h.K(r)),this.ri&&(A.Fb=this.ri.Mr(A.node,!0),A.Tb=this.ri.Mr(A.node,!1));else if(15===h.K(r).type)A=ux.TableNodeContext.create(h.K(r));
else continue;b.add(A)}return new Er.Selection(b.toArray(),!0)}ePo(b){if(b&&!b.equals(N.a.nil)&&(this.jh.KNb(),(b=this.jh.jv(b))&&55===b.type&&b.isConnected)){var h=b.ka(Mc.a.faa,!1);b.setValue(Mc.a.faa,!1);h&&this.Ioo(b)}}D_j(b){if(b&&!b.equals(N.a.nil)&&(this.jh.KNb(),(b=this.jh.jv(b))&&55===b.type&&b.isConnected)){var h=this.uR(b);h.isEditable&&8===h.type&&this.jLj(!h.isChecked,h,b)}}jLj(b,h,r){const {mOa:A,font:M}=this.Eim(b,r),aa=this.Qc.Nc(15);aa.Bb(r);h.isChecked=b;this.Izg(h,A);b=this.sr.Xjc(h.start.node,
Math.max(h.start.cpBegin,0));this.Ke.cha(b.formatting,M);aa.dispose()}Eim(b,h){b?(b=h.ka(De.a.C5h,Fs.a.BLl),h=h.ka(De.a.B5h,Fs.a.ALl)):(b=h.ka(De.a.K5h,Fs.a.DLl),h=h.ka(De.a.J5h,Fs.a.CLl));b=String.fromCodePoint(Number("0x"+b));return{mOa:b,font:h}}Ioo(b){var h=this.qh.hr(b.id,!0);h.equals(N.a.nil)||(h=this.jh.msa(h,!0))&&(b=this.sr.fHf(h,b.id,!0))&&0<b.count&&(b=b.K(0),h=b.Jb,h.formatting=b.oR?b.oR.Bf(h):new Pg.a(h,N.a.nil))}Kzj(b){if(b=this.Cui(b))for(const h of b)this.Mj.DAg()&&(h.GL=!1),this.sDa(h,
!1)}yui(b){const h=new ib.a;if(b=this.Cui(b))for(const r of b)h.add(r.Wd);return h}Uto(b){if(b&&(11===b.type||14===b.type||15===b.type||16===b.type)){var h=this.jb.Om(b),r=this.jb.bD(b);if(this.ri&&h&&r){b=this.ri.Mr(h,!0);const A=this.ri.Mr(r,!1);h=wc.a.create(h);r=wc.a.create(r);h.Fb=b;r.Tb=A;if(b=this.osa(h,r,4))for(const M of b)this.sDa(M,!1)}}}Mem(b){var h=this.qh.hr(b.id,!0,b.oP);b=this.qh.hr(b.id,!1,b.oP);if(h.equals(N.a.nil)||b.equals(N.a.nil))return new ib.a;h=this.jh.msa(h,!0);b=this.jh.msa(b,
!1);return h&&b?this.YW(wc.a.create(h),wc.a.create(b))||new ib.a:new ib.a}mVa(b,h){return this.jh.mVa(b,h)}rJf(b,h){if(b&&55===b.type&&(b=this.uR(b),b=h?b.start:b.end)){const r=wc.a.Tc(b.node,h?b.Hj:b.Oo);r.Fb=r.Tb=(h?b.Fb:b.Tb)+(h?-1:1);return r}return null}Ckm(b){return(b=this.uR(b))?b.start:null}wLj(b,h,r,A,M){if((b.contextId===lc.a.Cd||b.contextId===lc.a.Xc||b.contextId===lc.a.paragraph)&&(M=b.node.ra.sh(M?b.Hj:b.Oo))&&M.Hb)for(let aa=0;aa<M.Hb.length;aa++){const oa=M.Hb.K(aa);if(oa.qe.equals(h)&&
oa.jq)if(A&&oa.Vc){b.Fb=r?aa:aa+1;break}else if(!A&&!oa.Vc){b.Tb=r?aa+1:aa;break}}}Yio(b){for(let h=0;h<this.zzh.length;++h)(0,this.zzh[h])(this,new cD(b))}ewj(b){for(let h=0;h<this.v4e.length;++h)(0,this.v4e[h])(this,new cD(b))}Yto(b){b=wc.a.create(b);if(b=this.fN(b,b,4))for(const h of b)h.fg||this.sDa(h,!1)}Oto(b){if(b=b.Pic())for(let r=0;r<b.count;r++){var h=this.jh.jv(b.K(0));h=this.f5.$Lb(h,this.yz,this.Di,this.jh,this.sr,this,this.ria,this.nja,this.pJb);this.sDa(h)}}Lem(b){return this.YW(b,
null)}e8c(b,h,r=null){let A=!0;try{if(!b)return v.ULS.sendTraceTag(529106507,368,50,"Content Control is null"),!1;v.ULS.sendTraceTag(529106508,368,50,String.format("Content control change type: {0}, isSupported: {1}, isDeletable: {2}",h,b.isSupported,b.Fla));if(this.Skn(h)&&this.Tkn(h)&&!this.idn(b))return!1;if(!r){const oa=this.pCm(b);oa&&(r=new ib.a,r.add(oa))}var M=this.jh.TBi(b.start.node);const aa=this.jh.TBi(b.end.node);if(M&&aa&&!M.equals(aa)||!M&&aa||M&&!aa)return!1;M=!0;if(r&&0<r.count){if(!r.K(0).isSupported)return!1;
M=r.K(0).isEditable}switch(h){case 0:A=this.zan(b,M);break;case 1:A=(this.d3||!this.Ade(b))&&b.isSupported&&b.isEditable&&this.BSh(b)&&this.TUi(b);y.AFrameworkApplication.fv||(A=A&&!this.eMi(b.start,b.end));break;case 2:const oa=b.aqn?!0:b.isSupported;A=(this.d3||!this.Ade(b))&&oa&&b.Fla&&M;v.ULS.sendTraceTag(529106510,368,50,"True");break;case 3:A=b.isSupported&&b.Fla&&M&&this.BSh(b)&&this.TUi(b)&&!this.eMi(b.start,b.end)}}catch(aa){v.ULS.sendTraceTag(17413646,368,15,"Exception was caught in IsContentControlValid. OperationType: "+
h+", Exception: "+aa),A=!1}return A}Tkn(b){return!(y.AFrameworkApplication.fv&&1===b)}Skn(b){return!(this.X_&&(!b||2===b||3===b))}zan(b,h){if(gp.a.Njg)return this.Aan(b,h);let r=!0;if(!this.d3&&this.Ade(b))r=!1;else if(this.X_)this.X_?b.fg||ze.a.nw(b.start)||b.start.contextId===lc.a.Uc?b.fg&&(b.start.contextId!==lc.a.paragraph&&b.start.contextId!==lc.a.Uc||b.end.contextId!==lc.a.paragraph&&b.end.contextId!==lc.a.Uc)&&(r=!1):r=!1:r=h?this.cUi(b):!1;else if(!(b.fg||-1!==b.start.cpBegin&&-1!==b.end.cpEnd&&
b.start.equals(b.end)))r=!1;else if(b.fg&&(b.start.contextId!==lc.a.paragraph||b.end.contextId!==lc.a.paragraph||b.start.equals(b.end)&&!Gd.ParagraphReader.textLength(b.start.node)))r=!1;else if(b.start.contextId===lc.a.Xc||b.end.contextId===lc.a.Xc||b.start.contextId===lc.a.Uc||b.end.contextId===lc.a.Uc)r=!1;return r}Aan(b,h){return(this.d3||!this.Ade(b))&&this.Ban(b)&&this.Xgn(b)&&h&&!this.uin(b)&&this.cUi(b)?!0:!1}Xgn(b){var h;const r=b.start,A=r.contextId,M=null===(h=b.end)||void 0===h?void 0:
h.contextId;return b.fg?A!==lc.a.paragraph&&A!==lc.a.Uc||M!==lc.a.paragraph&&M!==lc.a.Uc?!1:!0:ze.a.nw(r)||A===lc.a.Uc?!0:!1}Cui(b){if(!b||!b.length)return null;const h=b[0];b=b[b.length-1];this.ri&&(this.jb.fn(h)&&12===h.node.type&&(h.Fb=this.ri.Mr(h.node,!0)),this.jb.fn(b)&&12===b.node.type&&(b.Tb=this.ri.Mr(b.node,!1)));return this.osa(h,b,4)}BSh(b){b=b.AFf();for(const h of b)if(!h.isSupported||!h.Fla)return!1;return!0}idn(b){if(this.S1j(b.start,b.end).returnValue)return!1;const h=this.fN(b.start,
b.end,2);if(!h)return!0;for(const r of h)if(!r.objectId.equals(b.objectId)&&(r.fg&&(r.start.node.id.equals(b.start.node.id)&&(-1===b.start.cpBegin||!b.start.cpBegin)||r.end.node.id.equals(b.end.node.id)&&(-1===b.end.cpEnd||b.end.cpEnd===Gd.ParagraphReader.textLength(r.end.node)))||!r.fg&&(b.start.node.id.equals(r.start.node.id)&&(-1!==b.start.cpBegin?r.start.cpBegin===b.start.cpBegin:!r.start.cpBegin)||b.end.node.id.equals(r.end.node.id)&&(-1!==b.end.cpEnd?r.end.cpEnd===b.end.cpEnd:r.end.cpEnd===
Gd.ParagraphReader.textLength(b.end.node)))))return!1;return!0}TUi(b){if(b.fg){var h=this.jh.jv(b.sv),r=this.jh.jv(b.HA);let A=null;if(12===h.type&&12===r.type){h=this.jh.Jkc(h);h=this.jh.jv(h);r=this.jh.Jkc(r);r=this.jh.jv(r);if(!h||!r)return!1;16===h.type&&16===r.type&&h.id.equals(r.id)&&(A=h)}b=this.YW(b.start,b.end);if(!b.count)return!1;for(const M of b)if(b=this.jh.Jkc(M),b=this.jh.jv(b),!b||!(16!==b.type||A&&b.id.equals(A.id)))return!1}return!0}Ade(b){return b.fg?!1:gp.a.yjd?(b=b.start.node)?
b.ka(Mc.a.hta,!0)||b.ka(fd.a.Zma,!1)?!1:!0:!0:(b=b.start.node)?!b.ka(Mc.a.hta,!0):!0}Ban(b){return 1!==b.type?!0:b.sv.equals(b.HA)&&Gd.ParagraphReader.Vb(b.start.node)&&!this.SWm(b)?!0:!1}SWm(b){const h=b.start;var r=h.node;const A=r.ra;if(b.fg){if(r.Jv||r.k7||r.hasBookmark)return!0;for(var M of A)if(this.jMi(M))return!0;return!1}b=h.Hj;r=h.Oo;let aa=M=null;for(const oa of A.e3i(b,r))if(!(oa.cp<b))if(oa.cp===b)M=oa;else if(oa.cp===r)aa=oa;else if(this.jMi(oa))return!0;return this.TWm(h,M,aa)?!0:!1}jMi(b){return EB(b.Hb)&&
EB(b.lf)&&EB(b.Zh)&&EB(b.fc)&&null==b.hyperlink&&!b.pn&&null==b.blob?!1:!0}TWm(b,h,r){if(null==h&&null==r)return!1;const A=b.Fb;b=b.Tb;return null!=h&&(h.Hb&&A<h.Hb.length||null!=h.blob)||null!=r&&r.Hb&&0<b||null!=h&&null!=r&&(kH(h.lf)&&lH(r.lf)||kH(h.Zh)&&lH(r.Zh)||!EB(h.fc)&&!EB(r.fc)&&[...h.fc].some(M=>0===M.le)&&[...r.fc].some(M=>3===M.le)||null!=h.hyperlink&&r.pn)?!0:!1}uin(b){var h,r;return(null!==(r=null===(h=this.fN(b.start,b.end,3))||void 0===h?void 0:h.toArray())&&void 0!==r?r:[]).some(A=>
1===A.type)?!0:!1}cUi(b){if(!b.fg)return!0;var h=this.jh.jv(b.sv);b=this.jh.jv(b.HA);if($g.TableCellReader.fCa(h)||$g.TableCellReader.fCa(b)||zq.a.Yla(h)||zq.a.Yla(b))return!1;h=this.jh.Jkc(h);h=this.jh.jv(h);b=this.jh.Jkc(b);b=this.jh.jv(b);return h&&b&&(16!==h.type&&16!==b.type||h.id.equals(b.id))?!0:!1}pCm(b){if(!b)return null;b=this.jh.jv(b.objectId);if(!b)return null;b=b.ka(Mc.a.eaa,N.a.nil);return b.equals(N.a.nil)?null:(b=this.jh.jv(b))?this.uR(b):null}vri(b){return this.YW(null,b)}d9o(b){return(b||
"").split(RegExp("\r\n|\r|\n"))}Uon(b){return b&&""!==b?!1:!0}Oyi(b,h,r){h=h.ra.sh(r?0:h.characterData.length);if(!h)return v.ULS.sendTraceTag(21018849,368,15,"Unable to get a ChP at expected cp, which should not happen"),0;if(!h.Hb||!h.Hb.length)return 0;if(!b)return r?0:h.Hb.length;for(let A=0;A<h.Hb.length;A++){const M=h.Hb.K(A);if(N.a.xt(M.qe,b)&&M.Vc===r)return r?A+1:A}return r?0:h.Hb.length}Wil(b,h){var r=b.node,A=h.node,M=b.contextId===lc.a.paragraph?0:b.cpBegin,aa=h.contextId===lc.a.paragraph?
Gd.ParagraphReader.textLength(A):h.cpEnd;r=this.yp.Haa(r,M,b.Fb);A=this.yp.Haa(A,aa,h.Tb);aa=!r||!r.count;M=!A||!A.count;if(aa&&M)return{returnValue:!0,start:b,end:h};if(aa)return{returnValue:this.eDe(b,A.K(A.count-1).qe,!0),start:b,end:h};if(M)return{returnValue:this.eDe(h,r.K(r.count-1).qe,!1),start:b,end:h};if(r.count===A.count)return r=r.K(r.count-1),A=A.K(A.count-1),{returnValue:r.qe.equals(A.qe),start:b,end:h};r=(aa=r.count<A.count)?A.K(A.count-1):r.K(r.count-1);return{returnValue:aa?this.eDe(b,
r.qe,!0):this.eDe(h,r.qe,!1),start:b,end:h}}eDe(b,h,r){var A=b.node;let M;if(r){M=b.contextId===lc.a.paragraph?0:b.cpBegin;var aa=b.Fb}else M=b.contextId===lc.a.paragraph?Gd.ParagraphReader.textLength(A):b.cpEnd,aa=b.Tb;A=A.ra.sh(M);if(-1===aa||!A||!A.Hb||!A.Hb.length)return!1;A=A.Hb;if(r)for(r=aa;r<A.length;r++){aa=A.K(r);if(!aa.Vc)break;if(aa.qe.equals(h))return b.Fb=r+1,!0}else for(r=aa-1;0<=r;r--){aa=A.K(r);if(aa.Vc)break;if(aa.qe.equals(h))return b.Tb=r,!0}return!1}lfn(b,h){return this.P7k(b,
h)&&b.Fb===b.Tb&&(b.contextId===lc.a.Xc||b.contextId===lc.a.paragraph&&!b.node.characterData.length)}P7k(b,h){return b.equals(h)&&b.Fb===h.Fb&&b.Tb===h.Tb}R6j(b,h){if(b&&h.fg){var r=this.qh.hr(b.id,!0),A=this.jh.msa(h.sv,!0);r.equals(A?A.id:null)&&this.qh.fJ(b.id,h.objectId,!0);r=this.qh.hr(b.id,!1);A=this.jh.msa(h.HA,!1);r.equals(A?A.id:null)&&this.qh.fJ(b.id,h.objectId,!1)}}static get Od(){return null!=Bw.L4g?Bw.L4g:Bw.L4g=Za.a.instance.resolve(46).instance}static DPb(b){return h=>h.type===b}static vum(){return b=>
12===b.type||15===b.type}static iXh(b,h){return b.mf===h.Gfj||b.parentNode&&h.hqj(b.parentNode)?!1:!0}}Object(u.a)(Bw,"ContentControlOperator",null,[448,10,449]);class mH{constructor(b,h,r){this.Zc=b;this.yz=h;this.pGb=r}DIi(b){const h=this.EPb();return h&&b&&this.BQb(h,b)?this.yOm(h):null}BQb(b,h,r=!1){if(!b||!h)return!1;do{var A=b.currentNode;if(!A)break;A=A.ka(Mc.a.Rkc,null);if(A===h||r&&A&&A.includes(h))return!0}while(b.Mf(29));return!1}yOm(b){var h=b.Ub(1);b.rc();b=b.yL(1);if(!h||!b)return null;
h=sc.SelectionFactory.n$h(h,b);b=ze.a.uk(h,!1,!1);return gp.a.Ufa&&!b?null:sc.SelectionFactory.Qy(h,b.Wc)}EPb(){const b=this.Zc.Rl();b.set(this.yz.value);this.pGb.VR(b);return b.Ub(28)&&b.Ub(29)?b:null}KJf(){const b=this.Zc.Rl();b.set(this.yz.value);this.pGb.VR(b);return b.Ub(28)?b:null}jqm(b){var h=this.EPb();if(!h||!b||!this.BQb(h,b,!1))return null;h.Zd();b=1<h.zq();h.Zd();h.Zd();h=h.currentNode;return Gd.ParagraphReader.Vb(h)?{yoe:h,qMi:b}:{yoe:null,qMi:b}}pvi(){const b=this.EPb();return this.BQb(b,
Fs.a.bci,!0)?b.currentNode.getValue(Mc.a.Rkc):null}}Object(u.a)(mH,"GlossaryNavigator",null,[233]);class WJ{constructor(b,h,r,A,M,aa){this.sr=b;this.jh=h;this.Vm=r;this.jb=A;this.Jh=M;this.nja=aa}Lmd(b,h,r){if(!this.nja)return 1;if(!({qp:M}=this.i0f(b)).returnValue||!this.Jh.j1i(M,h)||this.Hzj(b,h))return 2;var A=this.Jh.wri(h);var M=A.K(0).Pic();M&&M.count||(M=new ib.a,M.add(b.objectId));b=this.jh.adi(A);r=r.split("\n");h=Object(ya.a)(vd.a,this.jh.LJf(h));h=this.jh.IMh(h,b,r.length);for(b=0;b<h.count;++b){A=
h.K(b);this.sr.Ve(wc.a.createTextRange(A,0,0),r[b]);for(let aa=0;aa<M.count;++aa)this.sr.Iya(A,M.K(aa),0,!0,!0),this.sr.Iya(A,M.K(M.count-aa-1),A.characterData.length,!0,!1)}return 0}Hzj(b,h){if(!this.nja)return 1;let r;if(!({qp:r}=this.i0f(b)).returnValue||!this.Jh.j1i(r,h))return 2;h=this.Jh.wri(h);if(0<h.count&&(h=this.Vm.fN(wc.a.create(h.K(0)),wc.a.create(h.K(h.count-1)),2)))for(const A of h)if(A.id!==b.id&&!this.Vm.sDa(A,!0))return 2;return 0}Hoc(b){if(!this.nja||!({qp:r}=this.i0f(b)).returnValue)return!1;
b=b.AFf();for(var h of b)if(!h.Fla||!h.isSupported)return!1;if(this.Jh.Zcn(r))return!1;var r=Object(ya.a)(vd.a,this.jh.LJf(r));h=new ib.a;this.jb.bQb(r,!0,!1,h);for(const A of h)if(0<A.ka(Mc.a.fOb,0)||this.jb.p9a(A).Zy)return!1;return!0}i0f(b){let h=null;return b&&b.sv.toString()===b.HA.toString()&&b.isValid()&&b.isEditable&&b.isSupported?(h=this.jh.jv(b.sv))&&14===h.type?{returnValue:!0,qp:h}:{returnValue:!1,qp:null}:{returnValue:!1,qp:h}}}Object(u.a)(WJ,"TableContentControlEditor",null,[232]);class nH{Zcn(b){let h=
!1;const r=new vd.a;r.set(b);Oh.forEachCellInTable(r,A=>{if(!$g.TableCellReader.Tg(A)){let M=Yn.OutlineNavigator.zba(A);for(;M;){if(Db.OutlineElementReader.olc(A))return h=!0,!1;M=A.zj(1)}}return!0});return h}j1i(b,h){const r=new vd.a;r.set(h);return $g.TableCellReader.fCa(h)&&r.vb(14)&&r.ld(14).id===b.id?!0:!1}wri(b){const h=new ib.a,r=new vd.a;r.set(b);b=new ib.a;Gd.ParagraphReader.bQb(r,!0,!1,b);for(const A of b)h.add(A);return h}}Object(u.a)(nH,"TableReader",null,[231]);class oH{constructor(){this.Vm=
null}get name(){return"WordEditor.ContentControl"}init(){y.AFrameworkApplication.J.$("WordEditorContentControlWriteIsEnabled")&&(RE.a.yZa(Object(E.a)(Za.a.instance.resolve(617),Za.a.instance.resolve(617).BTn,"onContentControlRangeChanged")),this.Vm=Za.a.instance.Oa(623),Za.a.instance.resolve(984).init(),Za.a.instance.resolve(985).init())}dispose(){this.Vm&&(this.Vm.dispose(),this.Vm=null)}uc(b){b.ia(994,()=>new aD.a(Le.a.Ge)).ha();b.ia("WordEditor.ContentControl.ContentControlFactory",()=>new jH(Za.a.instance.resolve(198))).as(991).ha();
b.ia(986,()=>new rx(Za.a.instance.Ra(11),Za.a.instance.Ra(21))).ha();b.ia("WordEditor.ContentControl.ContentControlGraphManager",()=>new tx(new Qf.a(()=>qa.StaticActiveAppFrame.za().kb.$c),new Qf.a(()=>qa.StaticActiveAppFrame.za().kb.$c.td),new Ul.a,Object(vo.a)(),Za.a.instance.resolve(986),Za.a.instance.resolve(110),Za.a.instance.resolve(18),Za.a.instance.resolve(164),Za.a.instance.resolve(987),Za.a.instance.Ra(11),Za.a.instance.resolve(198),Za.a.instance.Ra(985),Za.a.instance.resolve(988))).as(989).ha();
b.ia(993,()=>new mH(new Ul.a,new Qf.a(()=>qa.StaticActiveAppFrame.za().kb.$c),Object(vo.a)())).as(988).ha();b.ia(617,()=>new Bw(new Qf.a(()=>qa.StaticActiveAppFrame.za().kb.$c),new Qf.a(()=>qa.StaticActiveAppFrame.za().kb.$c.td),Za.a.instance.resolve(989),Za.a.instance.resolve(990),Za.a.instance.resolve(991),gg.a.instance,Za.a.instance.resolve(868),Za.a.instance.resolve(101),Za.a.instance.resolve(8),y.AFrameworkApplication.J.$("WordEditorContentControlWriteIsEnabled"),Za.a.instance.Oa(389),y.AFrameworkApplication.va,
Za.a.instance.resolve(988),y.AFrameworkApplication.J.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),Za.a.instance.resolve(22),Za.a.instance.Ra(11),Za.a.instance.Oa(14),Za.a.instance.resolve(164),Za.a.instance.resolve(42),Za.a.instance.Ra(879),Za.a.instance.resolve(12),Za.a.instance.resolve(198),Za.a.instance.resolve(381),Za.a.instance.Ra(755))).as(21).as(623).ha();b.ia("WordEditor.ContentControl.ContentControlManager",()=>new Aw(new Qf.a(()=>qa.StaticActiveAppFrame.za().kb.$c),new Qf.a(()=>
qa.StaticActiveAppFrame.za().kb.$c.td),Za.a.instance.resolve(989),Za.a.instance.resolve(992),Za.a.instance.resolve(623),Za.a.instance.resolve(991),Za.a.instance.resolve(988),Za.a.instance.Ra(11),Za.a.instance.resolve(22),Za.a.instance.resolve(206))).as(954).ha();b.ia(990,()=>new TJ(Za.a.instance.resolve(322),Za.a.instance.Ra(11),Za.a.instance.resolve(164),Za.a.instance.resolve(198))).as(992).ha();b.ia(985,()=>new sx(Za.a.instance.resolve(993),Za.a.instance.resolve(18),Za.a.instance.resolve(322),Za.a.instance.resolve(623),
Za.a.instance.resolve(376),Za.a.instance.resolve(101),df.a.gf.Ll.jf(55))).as("WordEditor.ContentControl.IGlossaryEditor").ha();b.ia("WordEditor.ContentControl.TableContentControlEditor",()=>new WJ(Za.a.instance.resolve(992),Za.a.instance.resolve(989),Za.a.instance.resolve(623),Za.a.instance.resolve(164),new nH,y.AFrameworkApplication.J.$("WordEditorContentControlWriteIsEnabled"))).as(874).ha();y.AFrameworkApplication.J.$("WordEditorContentControlInlineBlockConversionIsEnabled")&&b.ia("Box4.ContentControlConverter",
()=>new SE(b.resolve(164),b.resolve(22),b.resolve(14),b.resolve(12),b.resolve(198))).as(87).ha();b.ia(984,()=>new Tv(b.resolve(617),b.resolve(992),b.resolve(989),b.resolve(994),b.resolve(381))).ha();b.ia("WordEditor.ContentControl.ContentControlFormattingManager",()=>new Zk(new Qf.a(()=>qa.StaticActiveAppFrame.za().kb.$c.td),Za.a.instance.resolve(990),Za.a.instance.resolve(936),Za.a.instance.resolve(376),y.AFrameworkApplication.J)).as(1157).ha()}static main(){K.a.instance.Lc(new oH)}}Object(u.a)(oH,
"ContentControlPackage",null,[0,1]);var dA=d(1274),tL=d(1385),XJ=d(1766),uL=d(1507);class pH{constructor(b){this.contextualIntentInvocationSource=10;this.contextualIntentInvocationSource=b}}Object(u.a)(pH,"UxManagerMenuActionTelemetryData",null,[]);class qH extends Sys.EventArgs{constructor(b,h,r){super();this.definition=b;this.source=h;this.Mul=r}}Object(u.a)(qH,"MenuDidCloseEventArgs",Sys.EventArgs,[]);class rH extends Sys.EventArgs{constructor(b,h){super();this.definition=b;this.source=h}}Object(u.a)(rH,
"MenuDidOpenEventArgs",Sys.EventArgs,[]);class VE{constructor(b,h,r,A,M,aa,oa=!1,Ja=null,fb=null,Cb=null,Gb=!1,Sb=null,pc=!1,zc=!0,Yc=null,Kd=!1,ke=10){this.target=this.container=this.Ig=null;this.isDismissed=!1;this.med=this.$dd=this.Wki=this.r0=this.Pv=this.rga=this.GCa=this.DMa=this.documentElement=this.gva=this.editingElement=null;this.isFocused=!1;this.LZd=null;this.djg=this.GXf=!1;this.sEe=null;this.Ipe=0;this.paragraphNode=b;this.cpBegin=h;this.cpEnd=r;this.definition=A;this.QRk=M;this.EXa=
aa;this.EUa=oa;this.cSj=Ja;this.Nra=fb;this.hostServices=Cb;this.u3o=Gb;this.Loj=Sb;this.nSj=pc;this.FSl=zc;this.Wki=Yc;this.showDictationCommandUx=Kd;this.source=ke}}Object(u.a)(VE,"UxManagerState",null,[]);var Sj=d(1566);class ag{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb){this.Yb=b;this.hb=h;this.mB=r;this.kd=A;this.oe=M;this.Gb=aa;this.wj=oa;this.gl=Ja;this.M5=fb;this.u4b=Cb;this.R7e=!1;this._state=null;this.shouldIgnoreFocusEvent=Gb=>{var Sb;return this.kd.Ad.mz&&!this.kd.Ad.tX&&Gb===(null===(Sb=this.kd.Le)||
void 0===Sb?void 0:Sb.editingElement)};this.sa=new Td.a;this.aMd=new cb.a;this.Zef((Gb,Sb)=>{ag.rBn(r,Sb.definition,Sb.source)});this.eZk((Gb,Sb)=>{ag.qBn(r,Sb.definition,Sb.source,Sb.Mul)});this.Yb.ie(ag.W2d).HL=!0;y.AFrameworkApplication.va.qa(Fc.a.CYc,lc.a.view,this.CYc.bind(this))}Zef(b){this.sa.addHandler(ag.E7f,b)}UBj(b){this.sa.removeHandler(ag.E7f,b)}sjo(b,h){this.sa.raiseEvent(ag.E7f,new rH(b,h))}eZk(b){this.sa.addHandler(ag.Ubj,b)}rjo(b,h,r){this.sa.raiseEvent(ag.Ubj,new qH(b,h,r))}oxp(b){var h;
if(!b.isDismissed&&b.gva){var r=Sj.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(r&&r.length){r=Sj.b(r);var A=Le.a.getElementBounds(b.gva);r.width||r.height?r.x+r.width<A.x||r.x>A.x+A.width||r.y+r.height<A.y||r.y>A.y+A.height?this.dismiss():(A=b.target,A.style.left=r.x+"px",A.style.top=r.y+"px",A.style.width=r.width+"px",A.style.height=r.height+"px",null===(h=b.Ig)||void 0===h?void 0:h.updatePosition(),b.Ig||v.ULS.sendTraceTag(512255777,341,50,"Menu is null so can't update position")):(v.ULS.sendTraceTag(50968328,
341,15,"Unable to obtain valid updated anchor for UX"),this.dismiss())}else v.ULS.sendTraceTag(50968327,341,15,"Unable to obtain updated anchor for UX"),this.dismiss()}}Yvj(b){b.isDismissed||b.sEe||(b.sEe=new xc.a(2,1,1,()=>{b.sEe=null;this.oxp(b)},147),this.Gb.Zb(b.sEe))}DMa(b,h){!b.isDismissed&&b.FSl&&0<h.QP.length&&(this.dismiss(),v.ULS.sendTraceTag(594363728,341,50,"Menu dismissed from selection change (possibly typing)"))}w2k(b){return!!b&&b.id===ag.TRk}GCa(b,h){if(b.isDismissed||!h||!h.Nb)return!1;
h=h.Nb;const r=h.keyCode,A=!b.isFocused&&!!b.Ig,M=h.altKey||h.ctrlKey||h.shiftKey;let aa=!1;r===cf.a.G4?(this.dismiss(),v.ULS.sendTraceTag(594363727,341,50,"Dismiss menu from keyboard"),aa=!0):r!==cf.a.Nu&&r!==cf.a.nz||!A||M||!this.w2k(b.definition)?r!==cf.a.A2b&&r!==cf.a.jtd||!A||M||(this.Mmg(b),b.Ig?(b.Ig.focus(),aa=!0,v.ULS.sendTraceTag(594363725,341,50,"Focus menu from keyboard")):v.ULS.sendTraceTag(576582676,341,50,"Began focus menu from keyboard but dismissed before completion")):(b.Ig.executeDefaultAction(),
v.ULS.sendTraceTag(594363726,341,50,"Default action from keyboard"),aa=!0);aa&&(h.preventDefault(),h.stopPropagation());return aa}$dd(b,h){if(b.isDismissed||!b.Ig)return v.ULS.sendTraceTag(512255776,341,50,"Could not Badge ID Invoke. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.Ig),!1;b.Ig.invokeBadgeId(h);v.ULS.sendTraceTag(526463882,341,50,"Badge ID action from dictation correction voice command");return!0}med(b,h){if(b.isDismissed||!b.Ig)return v.ULS.sendTraceTag(512255775,341,50,"Could not action from string. menu is dismissed: {0}, null menu: {1}",
b.isDismissed,!b.Ig),!1;b.Ig.executeActionFromString(h);v.ULS.sendTraceTag(526463883,341,50,"Execute action from dictation correction voice command as string");return!0}rga(b,h){if(b.isDismissed||!h||!h.Nb||!b.Ig)return v.ULS.sendTraceTag(512255774,341,50,"Could not perform onMouseMove. menu is dismissed: {0}, null mouseEvent: {1}, null mouseEvent.innerEvent: {2}, null menu: {3}",b.isDismissed,!h,!(null===h||void 0===h?0:h.Nb),!b.Ig),!1;const r=b.target;b=b.Ig.getElementBounds();var A=h.Nb;h=A.clientX;
A=A.clientY;r&&ag.Orj(h,A,Le.a.getElementBounds(r),16)||b&&ag.Orj(h,A,ag.ncl(b),4)||this.dismiss();return!1}gYo(b){var h=Sj.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(!h||!h.length)return!1;h=Sj.a(h,"OfficeContextualTarget");if(!h)return!1;b.container=ag.HWc();b.target=h;b.editingElement=this.kd.Le.editingElement;b.gva=this.kd.Ad.container;b.documentElement=document.documentElement;b.DMa=(r,A)=>{this.DMa(b,A)};b.GCa=r=>this.GCa(b,r);b.rga=r=>this.rga(b,r);b.r0=()=>{this.Yvj(b)};b.Pv=()=>{this.Yvj(b)};
b.showDictationCommandUx&&(b.$dd=r=>this.$dd(b,r),b.med=r=>this.med(b,r),this.u4b&&this.u4b.execute(r=>{r.tTo(b.$dd);r.vTo(b.med)}));document.body.appendChild(b.container);document.body.appendChild(b.target);this.hb.tA(b.DMa);this.wj.b2(b.Pv);this.oe.nb(Jd.a.TK,b.editingElement,b.GCa);b.EUa&&this.gl.nb(Jd.a.dua,b.documentElement,b.rga);mf.a.addHandler(b.gva,"scroll",b.r0);b.EXa||this.Mmg(b);return!0}JQb(b,h){const r=!!b.Ig;this.rjo(b.definition,b.source,h);b.container&&document.body.removeChild(b.container);
b.target&&document.body.removeChild(b.target);b.isFocused&&this.Yb.currentScope.name===ag.W2d&&this.Yb.$U(ag.W2d);b.DMa&&this.hb.Rga(b.DMa);b.GCa&&b.editingElement&&this.oe.xc(Jd.a.TK,b.editingElement,b.GCa);this.u4b&&this.u4b.execute(A=>{b.showDictationCommandUx&&(A.MCo(),A.NCo());A.HMj(!1,b.showDictationCommandUx)});b.rga&&b.documentElement&&b.EUa&&this.gl.xc(Jd.a.dua,b.documentElement,b.rga);b.r0&&b.gva&&mf.a.removeHandler(b.gva,"scroll",b.r0);b.Pv&&this.wj.Qga(b.Pv);b.Ig=null;b.container=null;
b.target=null;b.isDismissed=!0;b.editingElement=null;b.documentElement=null;b.gva=null;b.DMa=null;b.GCa=null;b.rga=null;b.r0=null;b.Pv=null;b.$dd=null;b.med=null;r&&b.Nra&&(b.GXf?b.djg=!0:b.Nra(b.LZd))}M9a(b,h){var r;if(!h)return!1;switch(h.actionType){case Up.b.Toggle:if(h.objectFulfillment===ag.Xhp)return this.R7e=!this.R7e,this.mLg(),this.yYc(b),!0;if(h.objectFulfillment===ag.aip)return{value:r}=this.aMd.Ac(h.suggestionGroup.type,!1),this.aMd.Z(h.suggestionGroup.type,!r),this.yYc(b),!0;break;case Up.b.GiveFeedback:if(XJ.a.pen(null===
(r=h.suggestionGroup)||void 0===r?void 0:r.type)||uL.a.bpn(h.objectName))break;this.focus();this.mLg();this.yYc(b);return!0;case Up.b.RevealSuggestions:this.yYc(b)}b.GXf=!0;h=b.QRk.executeAction(h,b.paragraphNode,b.cpBegin,b.cpEnd);b.GXf=!1;h&&this.yYc(b);b.djg&&(b.djg=!1,b.Nra(b.LZd),b.LZd=null);return h}yYc(b){b.rga&&b.documentElement&&b.EUa&&(this.gl.xc(Jd.a.dua,b.documentElement,b.rga),b.EUa=!1)}j1o(b,h){return b.id===tL.a.Blb?!1:!(0<=b.positionInSet&&0<b.setSize)&&!h}Qrd(b){var h;if(this.gYo(b)){var r=
1;y.AFrameworkApplication.J.$("RenderMultipleSuggestionGroupsInBranfordIsEnabled")&&(r=3);var A=!1;0<(null===(h=b.definition.suggestionGroups)||void 0===h?void 0:h.length)&&(A=b.definition.suggestionGroups[0].type,A=this.aMd.lb(A)?this.aMd.K(A):b.u3o);h=!1;y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FooterIconsInContextualCardIsEnabled",!1)&&(h=!0);r={containerElement:b.container,targetElement:b.target,definition:b.definition,onAction:M=>this.M9a(b,M),onDismiss:M=>
{this.JQb(b,M)},keepCurrentFocus:b.EXa,preventDismissOnScroll:!0,preventDismissOnResize:!0,showSnippet:this.R7e,showDescription:A,showEditorButton:b.nSj,showEditorBranding:this.j1o(b.definition,b.nSj),hostServices:b.hostServices,maxSuggestionGroupNumber:r,renderFooterIcons:h,shouldIgnoreFocusEvent:this.shouldIgnoreFocusEvent,keyboardHandlerTarget:b.Wki,showDictationCommandUx:b.showDictationCommandUx,editingElement:b.editingElement};b.Loj&&b.Loj(r);this.mB.createContextualUi(r).then(M=>{this.sjo(b.definition,
b.source);b.Ig=M;v.ULS.sendTraceTag(512255773,341,50,"Menu was opened");b.cSj&&b.cSj();this.u4b&&9!==b.source&&this.u4b.execute(aa=>aa.HMj(!0,b.showDictationCommandUx))}).catch(M=>{this.JQb(b,{zPp:dA.a.Unknown});v.ULS.sendTraceTag(50631187,341,10,"Failed to show menu. Error: {0}",M)});0<b.Ipe&&v.ULS.sendTraceTag(50968329,341,50,"Needed {0} tries to obtain updated anchor for UX",b.Ipe)}else 5<++b.Ipe?(v.ULS.sendTraceTag(50968330,341,15,"Unable to obtain initial anchor for UX after maximum tries -- giving up"),
this.dismiss()):this.Gb.Zb(new xc.a(2,1,Math.pow(3,b.Ipe),()=>{b.isDismissed||this.Qrd(b)},146))}get vI(){return!!this._state&&!this._state.isDismissed}HKg(b,h){this.vI&&(this._state.cpBegin=b,this._state.cpEnd=h)}get definition(){return this.vI?this._state.definition:null}set definition(b){this.vI&&(this._state.definition=b,this._state.Ig&&this._state.Ig.setDefinition(b))}focus(){this.vI&&this._state.Ig&&(this._state.isFocused||this.Mmg(this._state),this._state.Ig.focus())}mLg(){this.vI&&this._state.Ig&&
this._state.Ig.updatePosition()}Mmg(b){this.Yb.HN(ag.W2d,!1);b.isFocused=!0}zna(b,h,r,A,M,aa=null,oa=null,Ja=null,fb=!1,Cb=null,Gb=!1,Sb=!0,pc=null,zc=!1,Yc=10){if(!h||this._state&&!this._state.isDismissed)return!1;let Kd,ke;if(!({paragraphNode:ke,start:b,end:Kd}=ag.Clp(b)).returnValue)return!1;this._state=new VE(ke,b,Kd,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc,zc,Yc);this.Qrd(this._state);return!0}i_b(b){this._state&&(this._state.LZd=b)}CYc(b,h,r){if(1===r)return this.vI?32:0;this.vI&&this.dismiss();return 32}dismiss(){var b;
this._state&&(this._state.isDismissed=!0,null===(b=this._state.Ig)||void 0===b?void 0:b.dismiss())}static rBn(b,h,r){r=new pH(r);b.logAction({actionType:Up.b.SessionStart,engagement:Up.a.Try,objectName:ag.iZj,objectId:h.id,data:r});if(h.suggestionGroups)for(const A of h.suggestionGroups)b.logAction({actionType:Up.b.Presented,engagement:Up.a.See,objectName:A.type,objectId:A.id,data:r})}static qBn(b,h,r,A){r=new pH(r);b.logAction({actionType:Up.b.SessionEnd,engagement:Up.a.None,objectName:ag.iZj,objectId:h.id,
data:r},A)}static HWc(){const b=document.createElement("div");b.id="OfficeContextualContainer";return b}static ncl(b){return new Sys.UI.Bounds(b.left,b.top,b.width,b.height)}static Orj(b,h,r,A){const M=r.y-A,aa=r.x+r.width+A,oa=r.y+r.height+A;return r.x-A<=b&&b<=aa&&M<=h&&h<=oa}static Clp(b){let h,r;if(!b||!Gd.ParagraphReader.Vb(b.node)||b.contextId!==lc.a.Xc&&b.contextId!==lc.a.Cd&&b.contextId!==lc.a.paragraph)return{returnValue:!1,paragraphNode:null,start:-1,end:-1};r=b.node;b.contextId!==lc.a.paragraph?
(h=b.cpBegin,b=b.cpEnd):(h=0,b=r.characterData.length);return{returnValue:!0,paragraphNode:r,start:h,end:b}}kqc(){this.M5&&this.M5.execute(b=>{b.logActivity("WordWebEditorSeen",null)})}}ag.TRk="ActionSet";ag.iZj="IntentGroup";ag.W2d="CanvasContextualUxReact";ag.Xhp="Context";ag.aip="Description";ag.E7f="MenuDidOpen";ag.Ubj="MenuDidClose";Object(u.a)(ag,"UxManager",null,[]);class WE{constructor(){this.W=null}get name(){return"WordEditor.CanvasContextualProvider"}uc(b){this.W=b}init(){this.W.resolve(12).us.continueWith(()=>
{this.Fo()})}Fo(){const b=y.AFrameworkApplication.J.$("EditorGoalsEnabled"),h=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AIFeedbackSkittleEnabled",!0)&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackEnabled",!1);(this.W.resolve(12).isFeatureEnabled(55)||Rk.a.vLa||y.AFrameworkApplication.J.$("RewriteIsEnabled")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",
!1))&&(y.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasContextual"):this.W.resolve(77).JD.loadScript("canvasContextual")).then(()=>{this.W.ia(997,()=>canvasContextual.FactoryGlobal.getWordContextualControllerInstance({uiCulture:y.AFrameworkApplication.uiCulture,dataCulture:y.AFrameworkApplication.dataCulture,isRightToLeft:y.AFrameworkApplication.isRtl,ulsLogger:new so.a,dimeCallback:async()=>{this.W.resolve(4).launchUpsellExperience("editorinword")},loadUpsellDependencies:async()=>
{this.W.Ra(789).execute(r=>{r.W5i()})},getSoftPaywallData:()=>this.W.resolve(995),getPremiumPreviewCritiquesList:()=>this.W.resolve(996),logSystemInitiatedFeedback:async r=>{this.W.Ra(2).execute(A=>A.logActivity(r,null))}})).ha();this.W.ia(999,()=>new ag(Cd.FocusManager.instance(),this.W.resolve(326),this.W.resolve(997),Object(Lb.a)(),Xb.KeyInputManager.instance,y.AFrameworkApplication.oc,y.AFrameworkApplication.ua,y.AFrameworkApplication.ua.S8,this.W.Ra(2),this.W.Ra(998))).ha();this.W.resolve(997);
this.W.resolve(999);b&&(this.W.ia(1E3,()=>canvasContextual.FactoryGlobal.getEditorInitializerInstance({uiCulture:y.AFrameworkApplication.uiCulture,ulsLogger:new so.a})).ha(),this.W.resolve(1E3).init(),this.W.ia(1001,()=>canvasContextual.FactoryGlobal.getSkittleControllerV2Instance({ulsLogger:new so.a})).ha(),this.W.resolve(1001),h&&(this.W.ia(1002,()=>canvasContextual.FactoryGlobal.getAIFeedbackSkittleControllerInstance({ulsLogger:new so.a})).ha(),this.W.resolve(1002)))}).catch(r=>{v.ULS.sendTraceTag(50422751,
341,10,"CanvasContextualProvider - Failed to load Canvas Contextual script. Error: {0}",r)})}dispose(){}static main(){K.a.instance.Lc(new WE)}}Object(u.a)(WE,"PackageManager",null,[0,1]);class sH{constructor(b,h,r,A){this.A7m=(M,aa,oa)=>{M=null;aa.view.te&&(M=aa.view);if(!M||!M.mb)return 8;if(!this.FK.zYf())return 2;if(1===oa)return 32;this.BGk.MCl();return 32};this.Kaj=(M,aa,oa)=>{let Ja=null;aa.view.te&&(Ja=aa.view);if(!Ja||!Ja.mb)return 8;if(!this.FK.zYf())return 2;if(1===oa)return 32;if(1!==this.FK.tkc(this.hb.gb,
!0).count)return 2;aa=new Rb.GraphTransaction(15);try{if(aa.Bb(Ja.od),!this.FK.Jmp(M===Fc.a.X6f))return 8}finally{aa&&aa.dispose()}return 32};this.ga=b;this.hb=h;this.FK=r;this.BGk=A}Xb(){this.ga.qa(Fc.a.$ae,lc.a.view,this.A7m);this.ga.qa(Fc.a.X6f,lc.a.view,this.Kaj);this.ga.qa(Fc.a.Laj,lc.a.view,this.Kaj)}}Object(u.a)(sH,"IntelligentPlaceholderActor",null,[]);class tH{constructor(){this.aDc=new cb.a;this.vxd=new cb.a}OSk(b,h){let r;({value:r}=this.aDc.Ac(b,r)).returnValue||this.aDc.Z(b,r=new Sa.a);
r.add(h)}tTk(b,h){this.vxd.lb(b)&&v.ULS.sendTraceTag(50954435,323,15,"Comment ID already exists for bookmark");this.vxd.Z(b,h)}NSk(b,h,r){this.OSk(b,h);this.tTk(h,r)}Jgm(b){let h;return({value:h}=this.aDc.Ac(b,h)).returnValue?h:null}Pjm(b){let h;return({value:h}=this.vxd.Ac(b,h)).returnValue?h:null}gxo(b){let h;if(({value:h}=this.aDc.Ac(b,h)).returnValue){for(const r of h)this.vxd.remove(r);this.aDc.remove(b)}else v.ULS.sendTraceTag(50954436,323,15,"No bookmarks found for user ID")}}Object(u.a)(tH,
"IntelligentPlaceholderAtMentionManager",null,[462]);var XE=d(1671);class uH extends XE.a{constructor(b,h){super(b,h)}get key(){return"FOLLOW UP"}get Cv(){return WordEditorIntl.WordEditorStrings.L_IntelligentPlaceholder}IRj(b){return!b.ka(Mc.a.uI,!1)}uVa(){return Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress}}Object(u.a)(uH,"IntelligentPlaceholderDetailsProvider",XE.a,[]);var my=d(1827),YJ=d(2076),dD=d(1831);class eA{constructor(){this.uFa=""}Ala(b){this.uFa+=b}UUf(b){this.uFa+=b}Sae(b){this.uFa+=
b}pmc(b){this.uFa+=b}DUf(b){this.uFa+=b}}Object(u.a)(eA,"PlainTextFormatCreator",null,[1790]);var eD=d(1547),vH=d(2075);d(328);var wH=d(1546),fD=d(1394);class dz{constructor(){this.zFc=new cb.a}contains(b){return this.zFc.lb(dz.u1f(b))}add(b){this.zFc.Z(dz.u1f(b),b)}remove(b){this.zFc.remove(dz.u1f(b))}Vop(b){for(const h of b.zFc)this.add(h.value)}Rki(){const b=new ib.a;for(const h of this.zFc)b.add(h.value.lk);return b}static u1f(b){return b.lk.toString()}}Object(u.a)(dz,"CommentRangeSet",null,[]);
class gD extends Sys.EventArgs{constructor(b){super();this.XK=b}}Object(u.a)(gD,"OnFollowUpEventArgs",Sys.EventArgs,[]);class Cw extends gD{constructor(b,h){super(b);this.o9n=h}}Object(u.a)(Cw,"OnCreateEventArgs",gD,[]);class xH extends gD{constructor(b,h){super(b);this.Omn=h}}Object(u.a)(xH,"OnResolveEventArgs",gD,[]);var ZJ=d(219);class Gs{}Gs.XGe="MentionExperienceDegraded";Object(u.a)(Gs,"AtMentionsConstants",null,[]);class yH{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb){this.xcd=b;this.T8k=h;this.Fqd=
r;this.XTd=A;this.mb=M;this.iq=aa;this.ube=oa;this.cSi=Ja;this.Cw=fb;this.$cc=Cb;this.ZYa=null;this.EZn=(Gb,Sb,pc)=>{v.ULS.sendTraceTag(41178053,323,50,"@ mention selected, callback to replace text");Gb=this.ube.s$a(Gb,pc.displayName,pc.email,pc.id);this.ariaNotify(String.format(WordEditorIntl.WordEditorStrings.L_AtMentionsSuggestionSelected,Sb),!0);Gb?v.ULS.sendTraceTag(558113739,323,50,"Successfully inserted at mentions"):this.$cc.logKpiFailure("LPPWordEditorKPI","FailedToInsertAtMention",{isInternal:!0},
{name:Gs.XGe,isInternal:!0})};this.qYn=(Gb,Sb)=>{v.ULS.sendTraceTag(50954434,323,50,"Permissions received for entity");Sb&&this.$cc.Vw(Fc.a.Vjl);this.ube.TTm(Gb.id,Sb)};this.rUn=()=>{this.iq.Ad.mz&&!this.iq.Ad.tX&&this.iq.Le.pyf?this.BZh=!0:(this.xcd.reset(),v.ULS.sendTraceTag(41178054,323,50,"People picker dismissed off canvas"))};this.R_n=()=>{v.ULS.sendTraceTag(41178055,323,50,"People picker shown on canvas");this.hWk()};this.pYn=(Gb,Sb,pc,zc=new Map)=>{zc=Object.assign(new bb.a,{extendedProperties:zc});
this.$cc.logKpiFailure("LPPWordEditorKPI",Gb,{isIntentional:Sb,isInternal:pc,additionalValues:zc},{name:Gs.XGe,errorNameOverride:"LPPFailedToInsertAtMention",isIntentional:Sb,isInternal:pc,additionalValues:zc})};(b=Za.a.instance.Oa(223))&&b.addHandler(ZJ.a.LHa,this.mEo.bind(this))}see(){return!!this.ZYa}mEo(){this.see()&&this.BZh&&(this.ZYa.updateInputText(this.bad,!1),this.BZh=!1)}ariaNotify(b,h){this.Cw.sendNotification(b,h)}hWk(){const b=this.iq.Le.editingElement;if(b){var h=b.getAttribute(Ne.a.LSc);
b.setAttribute(Ne.a.LSc,h?h.toString()+" PeoplePickerAutomationID":"PeoplePickerAutomationID")}else v.ULS.sendTraceTag(51218125,323,15,"Cannot find editing element")}two(){const b=this.iq.Le.editingElement;if(b){var h=b.getAttribute(Ne.a.LSc);h?(h=h.toString().split(" "),Array.remove(h,"PeoplePickerAutomationID"),h.length?b.setAttribute(Ne.a.LSc,h.join(" ")):b.removeAttribute(Ne.a.LSc)):v.ULS.sendTraceTag(51218127,323,50,"No aria-controls when dismissing picker?")}else v.ULS.sendTraceTag(51218126,
323,15,"Cannot find editing element")}tol(){this.two();this.ZYa&&this.ZYa.updateInputText("a",!0);const b=document.getElementById("PeoplePicker");b&&document.body.removeChild(b);this.ZYa=null;this.cSi.ULj(!0)}Gse(){this.xcd.rqg(()=>{this.tol()});this.xcd.eqg((b,h)=>{this.bad=b;if(this.ZYa)1<this.bad.length&&"@"===this.bad.trimEnd()?(this.$cc.Vw(Fc.a.Ujl),this.xcd.reset()):this.ZYa.updateInputText(this.bad,!1);else if(this.$cc.logKpiUsage("LPPWordEditorKPI",0),this.$cc.Vw(Fc.a.a2n),(b=this.Usm(h))&&
b.height){h=b.y;const r=b.height,A=document.createElement("div");A.id="PeoplePicker";A.style.position="absolute";A.style.top=h-5+"px";A.style.left=b.x+"px";A.style.height=r+10+"px";document.body.appendChild(A);this.T8k.createPeoplePicker({editingElementId:this.iq.Le.editingElement.id,containerElement:A,automationID:"PeoplePickerAutomationID",onReplaceTextCallback:this.EZn,onPermissionsReceivedCallback:this.qYn,onDismiss:this.rUn,onShow:this.R_n,onFailure:this.pYn}).then(M=>{M.updateInputText(this.bad,
!1);this.ZYa=M;this.cSi.ULj(!1)})}});this.xcd.fqg(b=>{if(this.ZYa)this.ZYa.onKeyDown(b.Nb.rawEvent)})}Usm(b){var h=this.mb.gb;if(!h)return null;h=h.currentSelection;if(!h)return null;h=h.Qa;if(!h)return null;h=h.node;if(!h)return null;h=Object(ya.a)(112,h);if(!h)return null;h=Object(ya.a)(140,h.sl(this.iq.Ad.pc));if(!h)return null;h=Object(ya.a)(105,h);if(!h)return null;let r=null;try{r=this.Fqd.h2(this.XTd.Sic(2,b),h,!1,!1,!1,!1)}catch(A){v.ULS.sendTraceTag(41178056,323,15,"Failed to get ip bounds due to exception {0}, will use fallback value.",
A)}return r}}Object(u.a)(yH,"WordEditorAtMentionsHandler",null,[423]);var Fu=d(1380);class Kn{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc,zc,Yc){this.ga=b;this.Zc=h;this.$Ra=r;this.hb=A;this.Pq=M;this.Qd=aa;this.ZE=oa;this.bDd=Ja;this.Yd=fb;this.Oq=Cb;this.dmk=Sb;this.Di=pc;this.Qc=Gb;this.sa=new Td.a;this.sj=zc;this.l8g=Yc;fD.a.dff((Kd,ke)=>{this.uI(ke.XK,!0)&&this.sa.raiseEvent(Kn.ged)})}oOh(b){this.sa.addHandler(Kn.xij,b)}o_k(b){this.sa.addHandler(Kn.Nlj,b)}VZk(b){this.sa.addHandler(Kn.hXn,b)}dff(b){this.sa.addHandler(Kn.ged,
b)}uI(b,h){let r=b.ka(Mc.a.uI,!1);h&&(r=r&&!b.ka(Mc.a.wea,!1));return r}Rnc(b){return this.Pq.Rnc(b)}Kzm(b){for(const h of b)for(const r of h)if(Kn.H0f(r.contextId))return r.node.Ic;return null}iHm(b,h,r){const A=new dz,M=b.Ic;for(let aa=0;aa<b.ra.length;aa++){const oa=b.ra.K(aa);if(oa.cp>=h)break;if(oa.lf&&oa.lf.length)for(let Ja=0;Ja<oa.lf.length;Ja++){const fb=oa.lf.K(Ja);this.uI(M.Eb(fb.lk),r)&&(fb.Vc?A.add(fb):A.remove(fb))}}return A}jHm(b,h,r,A){const M=new dz,aa=b.Ic;for(let oa=0;oa<b.ra.length;oa++){const Ja=
b.ra.K(oa);if(Ja.cp>r)break;if(Ja.lf&&Ja.lf.length)for(let fb=0;fb<Ja.lf.length;fb++){const Cb=Ja.lf.K(fb);this.uI(aa.Eb(Cb.lk),A)&&(Cb.Vc?Ja.cp<r&&M.add(Cb):Ja.cp<=h&&M.remove(Cb))}}return M}dFi(b,h){let r;const A=b.node;b.contextId!==lc.a.paragraph?(r=b.cpBegin,b=b.cpEnd):(r=0,b=A.characterData.length);return r===b?this.iHm(A,r,h):this.jHm(A,r,b,h)}O3c(b,h){return Kn.H0f(b.contextId)?this.dFi(b,h).Rki():new ib.a}tkc(b,h){const r=new dz;for(const A of b)for(const M of A)Kn.H0f(M.contextId)&&r.Vop(this.dFi(M,
h));return r.Rki()}zYf(){var b=this.hb.gb;if(!b||1!==b.length||1!==b.K(0).length)return!1;b=b.K(0).Qa.node;return Gd.ParagraphReader.Vb(b)&&!Gd.ParagraphReader.Aza(b)&&this.Pq.Bsb(this.ga,!0)?!0:!1}fRi(b,h){if(!this.zYf())return null;if(this.Pq.VVm())return v.ULS.sendTraceTag(592761861,323,15,"Placeholder insertion failed because of draft comment"),null;let r=!1;var A=this.hb.gb.K(0).Qa;A.contextId===lc.a.Xc?(b=b?ze.a.Q6(A,!1):null)&&b.fw&&b.Qa.contextId===lc.a.Cd?this.hb.Kc(b):(this.Qd.Ve(A,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText+
" ",!0),this.hb.Kc(sc.SelectionFactory.cL(A.node,A.cpBegin,A.cpBegin+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText.length))):r=!0;this.sj.UMb||my.a.instance.U6c();b=this.Pq.lfc(this.hb.gb.currentSelection);if(!b)return null;this.Rnc(b)&&this.l8g.Vw(Ka.a.hMa,{succeeded:!0,hfb:29});var M=this.Zc.kg(b);const aa=M.Ub(1);if(!aa||aa.wc!==wm.a.MX)return null;M=M.Ub(2);if(!M||M.wc!==wm.a.paragraphNode)return null;this.DKg(b.Ic,b.id);this.sa.raiseEvent(Kn.xij,new Cw(b,h));r&&(h=
A.node,A=A.contextId!==lc.a.paragraph?A.cpEnd:h.characterData.length,this.hb.Kc(sc.SelectionFactory.cL(h,A,A)));return b}$ae(b){return!!this.fRi(!0,b)}g7c(b,h,r,A,M,aa){if(0>h)return!1;A="@"+A;const oa=A+" ",Ja=new Rb.GraphTransaction(15);try{Ja.Bb(b);this.Qd.Ve(wc.a.createTextRange(b,h,r),oa);this.Yd.Lg&&(this.Oq.cof(b,h,h+A.length),this.Oq.sna(b,h+A.length,h+oa.length,1));const fb=this.ZE.qF(wc.a.createTextRange(b,h,h+A.length),"mailto:"+M,!1,!0,!1);if(!fb)return!1;const Cb=fb.Dw;if(!Cb)return v.ULS.sendTraceTag(51217483,
323,15,"Insertion of IntelligentPlaceholderWithMention failed"),!1;this.hb.Kc(sc.SelectionFactory.cL(b,h,h+A.length));const Gb=this.fRi(!1,2);if(!Gb)return!1;aa&&this.bDd.NSk(aa,Cb,Gb.id);this.hb.Kc(sc.SelectionFactory.ue(b,h+oa.length))}finally{Ja&&Ja.dispose()}return!0}s$a(b,h,r,A){const M=this.hb.Mg;return ze.a.pf(M)?this.g7c(M.node,M.cpBegin-b,M.cpBegin,h,r,A):!1}jDm(b){if(1===b.length&&b.K(0).fw&&(b=b.K(0).Qa,b.contextId===lc.a.Xc&&Gd.ParagraphReader.Vb(b.node))){const h=b.node;for(let r=0;r<
h.ra.length;r++){const A=h.ra.K(r);if(A.cp===b.cpBegin){b=A.y7d(!0,!0);if(0<b.length)return b[0].lk;break}}}return null}WLb(b,h,r){return this.Pq.zWc(b,h,r).returnValue}X3d(b,h,r,A,M){let aa=!1;const oa=b.characterData;if(h>=oa.length||r>oa.length||r<h)return{returnValue:!1,jVa:aa};let Ja=h,fb=null;for(let Gb=0;Gb<b.ra.length;Gb++){const Sb=b.ra.K(Gb),pc=Sb.cp;if(!(pc<h)){if(Sb.pn&&fb)try{const zc=oa.substring(Ja,pc),Yc=new YJ.a;Yc.fullName=zc.startsWith("@")?zc.substr(1):zc;wH.a(fb.url,fb.Dw,Yc);
const Kd=new dD.a;wH.b(fb.Dw,Kd);M&&(Kd.contentId=this.dmk.NEf());A.Sae(zc,Yc,Kd);aa=!0;fb=null;Ja=pc}catch(zc){var Cb=Object.assign(new bb.a,{extendedProperties:new Map});Cb.extendedProperties.set("exception",zc.message);this.l8g.logKpiFailure("LPPWordEditorKPI","FailedToRenderAtMention",{isInternal:!0,additionalValues:Cb},{name:Gs.XGe,isInternal:!0,additionalValues:Cb})}pc<=r&&!fb&&(Cb=Math.min(pc,r),Cb>Ja&&A.Ala(oa.substring(Ja,Cb)),Ja=pc);Sb.hyperlink&&Sb.hyperlink.sI&&(fb=Sb.hyperlink);if(pc>=
r)break}}return{returnValue:!0,jVa:aa}}Iri(b,h,r,A,M=-1){var aa=!1,oa=b.Eb(h),Ja=b.Eb(Fu.k(oa));oa=b.Eb(Fu.h(oa));M=0<M?M:Number.MAX_VALUE;b=this.WLb(Ja,h,!0);h=this.WLb(oa,h,!1);if(-1===b||-1===h)return{returnValue:!1,jVa:aa};if(Ja===oa)return this.X3d(Ja,b,h,r,A);const fb=this.$Ra.lUa(Ja,!1,!1);if(!fb)return{returnValue:!1,jVa:aa};Ja=new ib.a;let Cb=0;do Ja.add(fb.DA),Cb+=fb.DA.characterData.length;while(fb.DA!==oa&&fb.mla()&&Cb<M);for(M=0;M<Ja.count;M++)if(aa=Ja.K(M),oa=aa.characterData,M)if(M===
Ja.count-1){if(!({jVa:aa}=this.X3d(aa,0,h,r,A)).returnValue)return{returnValue:!1,jVa:aa}}else{if(!({jVa:aa}=this.X3d(aa,0,oa.length,r,A)).returnValue)return{returnValue:!1,jVa:aa};r.Ala("\n")}else{if(!({jVa:aa}=this.X3d(aa,b,oa.length,r,A)).returnValue)return{returnValue:!1,jVa:aa};r.Ala("\n")}return{returnValue:!0,jVa:aa}}W3d(b,h){const r=new eA;return this.Iri(b,h,r,!1,-1).returnValue?r.uFa:null}h1d(b,h){var r=b.Eb(h);if(!r)return null;b=b.Eb(Fu.h(r));if(!b)return null;h=this.WLb(b,h,!1);if(-1===
h)return null;r=b.characterData;if(h>=r.length||!I.a.Wfa(r.charAt(h))){r=this.Qc.Nc(15);try{r.Bb(b),this.Qd.Ve(wc.a.Tc(b,h)," ")}finally{r&&r.dispose()}}return sc.SelectionFactory.ue(b,h+1)}DKg(b,h){const r=b.Eb(h),A=new eD.a;this.Iri(b,h,A,!0).returnValue&&(A.Ala("\n"),this.Pq.N4j(r,A.oQa),this.sa.raiseEvent(Kn.f1n))}TKo(b,h){for(const r of b){if(r.contains(h))return!0;for(const A of r)for(const M of h)if(A.node===M.node&&A.Hj>=M.Hj)return!0}return!1}ZXc(b,h,r,A,M){const aa=this.hb.gb.clone(),oa=
new kw.a(qa.StaticActiveAppFrame.za().kb.Jc);b=sc.SelectionFactory.ue(b,h);r=wc.a.Tc(r,A);b=sc.SelectionFactory.Qy(b,r);this.hb.Kc(b);r=!this.TKo(aa,b);return 32===this.ga.Nf(oa,ub.a.JJ,2,!0,null,null)?(r?this.hb.G0(aa):M!==N.a.nil&&(M=this.h1d(this.Di.value,M),this.hb.Kc(M)),!0):!1}Wuo(b,h){var r=b.Eb(h);const A=b.Eb(Fu.k(r));b=b.Eb(Fu.h(r));if(A===b){r=" "+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText;var M=A.characterData.indexOf(r);-1!==M&&this.ZXc(A,M,b,M+r.length,
h)}}Tci(b,h,r){var A=b.Eb(h);if(!A)return!1;const M=b.Eb(Fu.k(A));b=b.Eb(Fu.h(A));A=this.WLb(M,h,!0);const aa=this.WLb(b,h,!1);if(-1===A||-1===aa||!this.ZXc(M,A,b,aa,N.a.nil))return!1;r&&this.ddi(h);return!0}ddi(b){this.Pq.lrg(b,!0)}Jmp(b){var h=this.Kzm(this.hb.gb);if(!h)return!1;const r=this.tkc(this.hb.gb,!0);if(1!==r.count)return!1;const A=h.Eb(r.K(0));if(b)h=this.Tci(h,r.K(0),!1);else{const M=Fu.k(A),aa=Fu.h(A);N.a.xt(M,aa)||v.ULS.sendTraceTag(592487139,323,15,"User attempted to resolve comment that spans more than 1 paragraph");
this.fzl(r.K(0));h.Eb(M).km(16,!0);h=!0}h&&(A.setValue(Mc.a.wea,!0),this.sa.raiseEvent(Kn.Nlj,new xH(A,b)));return h}xUh(b,h){b=this.tkc(this.hb.gb,!1);h.Nm[Kn.Jei]=!!b.count}Ljj(b,h){if(h.Nm[Kn.Jei]&&Gd.ParagraphReader.Vb(h.clone)&&(h=h.clone,b=h.Ic)&&(h=wc.a.createTextRange(h,0,h.characterData.length),h=this.O3c(h,!1),h.count))for(const r of h)(h=b.Eb(r))&&h.setValue(Mc.a.uI,!1)}xlm(b,h,r){let A;const M=({EUc:fb}=this.Pq.zWc(h,r,!0)).returnValue;r=({EUc:A}=this.Pq.zWc(h,r,!1)).returnValue;let aa=
null,oa=-1,Ja=-1;for(;fb<A;fb++){const Cb=h.ra.K(fb);if(Cb.hyperlink&&Cb.hyperlink.sI&&Cb.hyperlink.Dw===b){aa=Cb.hyperlink;oa=Cb.cp;break}}if(!aa||oa<M)return{returnValue:!1,y7h:oa,x7h:Ja};for(b=fb;b<h.ra.length;b++){var fb=h.ra.K(b);if(fb.cp>r)break;if(fb.jX){Ja=fb.cp;break}}return{returnValue:-1!==Ja,y7h:oa,x7h:Ja}}Xvo(b){var h=this.bDd.Pjm(b);if(h){var r=null;qa.StaticActiveAppFrame.za()&&(r=qa.StaticActiveAppFrame.za().kb.$c.td);if(r){var A=r.Eb(h);h=r.Eb(Fu.k(A));var M=r.Eb(Fu.h(A));if(h!==
M)v.ULS.sendTraceTag(50954439,323,10,"Mention bookmark has no associated comments");else if(({y7h:b,x7h:M}=this.xlm(b,h,A.id)).returnValue){var aa=new Rb.GraphTransaction(7);try{aa.Bb(h);const oa=wc.a.createTextRange(h,b,M);this.Qd.Ve(oa,"");this.DKg(r,A.id)}finally{aa&&aa.dispose()}this.hb.gb&&0<this.hb.gb.length?(r=this.hb.gb.K(0).Qa,r.node===h?v.ULS.sendTraceTag(50954441,323,50,"Moving from cp {0} to {1}",r.cpBegin,b):v.ULS.sendTraceTag(50954442,323,50,"Moving selection to a different node")):
v.ULS.sendTraceTag(50954443,323,50,"Unable to find selection start after deleting mention");this.hb.Kc(sc.SelectionFactory.ue(h,b))}else v.ULS.sendTraceTag(50954440,323,15,"Unable to compute hyperlink CPs for bookmark")}else v.ULS.sendTraceTag(50954438,323,15,"Unable to find object space for removing mention")}else v.ULS.sendTraceTag(50954437,323,15,"Mention bookmark has no associated comments")}TTm(b,h){if(!h){h=this.bDd.Jgm(b);if(!h){v.ULS.sendTraceTag(50954444,323,15,"No bookmarks found for userId");
return}for(const r of h)this.Xvo(r)}this.bDd.gxo(b)}Cem(){my.a.instance.U6c();const b=new ib.a;for(const r of this.Pq.wgf)if(r.Fr!==vH.a.VD){var h=N.a.Cf(r.objectId);h=this.Di.value.Eb(h);this.uI(h,!0)&&b.add(h)}return b}tKo(b){b=this.Pq.HMf(b);this.hb.Kc(b)}fzl(b){b?this.Di.value.Eb(b).setValue(Mc.a.uI,!1):v.ULS.sendTraceTag(594043491,323,10,"The given intelligent placeholder guid is null")}static H0f(b){return b===lc.a.Cd||b===lc.a.Xc||b===lc.a.paragraph}}Kn.Jei="DisableNestedIntelligentPlaceholder";
Kn.xij="CreateIntelligentPlaceholder";Kn.Nlj="ResolveIntelligentPlaceholder";Kn.f1n="UpdateIntelligentPlaceholder";Kn.ged="DeleteIntelligentPlaceholder";Kn.hXn="MentionAddedToFollowUpEventKey";Object(u.a)(Kn,"IntelligentPlaceholderEditor",null,[463,464,465]);class Dw{constructor(b,h,r,A){this.qxa=!1;this.Ks=!0;this.oe=null;this.omb=M=>{if(!this.Ks||!this.Qil(M,this.hb.gb))return!1;M.Nb.preventDefault();M.Nb.stopPropagation();this.kd.Ad&&this.kd.Ad.LZc(!1);M=this.h1d(this.hb.gb);if(!M)return!1;this.hb.Kc(M);
return!0};this.kd=b;this.Di=h;this.hb=r;this.V9=A}kdc(b,h){this.qxa||(b.HBa?(this.pmb(h),this.qxa=!0):b.vja(()=>{this.qxa||(this.pmb(h),this.qxa=!0)}))}dispose(){this.oe&&this.oe.xc(Jd.a.TK,this.kd.Le.editingElement,this.omb)}pmb(b){this.oe=b;this.kd.Ad.gj&&this.oe.nb(Jd.a.TK,this.kd.Le.editingElement,this.omb)}Qil(b,h){if(b.Nb.keyCode!==cf.a.nz&&b.Nb.keyCode!==cf.a.Nu||1!==h.length||!h.K(0).fw)return!1;var r=this.V9.tkc(h,!0);if(1!==r.count)return!1;const A=h.K(0).Qa.node;if(!Gd.ParagraphReader.Vb(A))return!1;
b=this.V9.WLb(A,r.K(0),!0);r=this.V9.WLb(A,r.K(0),!1);return h.K(0).Qa.cpBegin<b||h.K(0).Qa.cpEnd>r?!1:!0}h1d(b){b=this.V9.tkc(b,!0);if(1!==b.count)return null;b=b.K(0);return this.V9.h1d(this.Di.value,b)}ULj(b){this.Ks=b}}Object(u.a)(Dw,"IntelligentPlaceholderKeyboardListener",null,[461,10]);class YE{constructor(b,h){this.y9m=r=>{1===r&&this.ga.Ob(Ka.a.hMa,2);2===r&&(this.UBh.instance?this.UBh.instance.Szc("https://go.microsoft.com/fwlink/?linkid=2154656")&&I.a.yX("https://go.microsoft.com/fwlink/?linkid=2154656")&&
window.open("https://go.microsoft.com/fwlink/?linkid=2154656","_blank"):v.ULS.sendTraceTag(556794450,323,15,"IntelligentPlaceholderPhaseOut Dialog's SafeLinkManager was not ready"));r=[Object.assign(new ia.a,{name:"DialogResult",int64:r})];ac.d(Fc.a.Boi,void 0,void 0,void 0,void 0,void 0,r)};this.ga=b;this.UBh=h}MCl(){const b=new ni.StandardDialog;b.Fd=11;b.Qe(1,WordEditorIntl.WordEditorStrings.L_TryIt);b.Qe(2,WordEditorIntl.WordEditorStrings.L_LearnMore);b.Ex(WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsHeader,
WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsContent,0,this.y9m);ac.a("FollowUpsPhaseOutDialogShown")}}Object(u.a)(YE,"IntelligentPlaceholderPhaseOutDialogManager",null,[]);var fA=d(1352);class Ew{constructor(b,h,r,A,M,aa){this.m$=this.o3e=null;this.W7=()=>{this.m$||(this.m$=new xc.a(3,1,0,()=>{this.m$=null;this.L9d(this.hb.gb)},130),this.Gb.Zb(this.m$))};this.Qc=b;this.FK=h;this.hb=r;this.Gb=A;this.Daf=M;this.Di=aa;this.q5=new qm.a;this.qr=new fA.a;this.Mxh=new vk.a(this.q5);this.FK.oOh((oa,
Ja)=>{this.oWk(Ja.XK)})}oWk(b){b=b.id;const h=this.bDi(this.Di.value,b);h&&this.qr.Z(b,h)}bDi(b,h){const r=b.Eb(h);return!r||this.FK.Rnc(r)?null:this.FK.W3d(b,h)}idl(b){const h=new fA.a;var r=this.FK.tkc(b,!0);if(!r)return h;b=this.Di.value;for(const A of r)(r=this.bDi(b,A))&&h.Z(A,r);return h}lrg(b){if(this.o3e){const h=this.Qc.Nc(15);try{h.Bb(this.Daf()),this.FK.ddi(this.o3e)}finally{h&&h.dispose()}}this.o3e=b?this.FK.jDm(b):null}uUm(b){const h=this.Di.value;if(b=b?this.idl(b):new fA.a){var r=new vk.a(this.q5),
A=new vk.a(this.q5);Ew.Fom(this.qr,b,r,A);for(var M of r)this.qr.Z(M,b.K(M));for(const aa of A)if(r=this.qr.K(aa),A=this.FK.W3d(h,aa),this.qr.remove(aa),A&&(b=M=!1,Na.a.n4c().equals(A,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?(b=!0,r=!1):r=-1<A.indexOf(WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?M=!0:!Na.a.n4c().equals(r,A),r||M||b)){A=this.Qc.Nc(15);try{A.Bb(this.Daf()),b?this.FK.Tci(h,aa,!0):(M&&this.FK.Wuo(h,aa),r&&this.FK.DKg(h,aa))}finally{A&&
A.dispose()}}}}gCm(b){const h=new vk.a(this.q5);for(const r of b)for(const A of r)b=A.node,Gd.ParagraphReader.Vb(b)&&h.add(b.id);return h}MSm(b){var h=this.Di.value;const r=b?this.gCm(b):new vk.a(this.q5);if(r){b=new ib.a;for(const aa of this.Mxh)if(!r.contains(aa)){var A=h.Eb(aa);if(A){A=A.ra;for(let oa=0;oa<A.length;oa++){const Ja=A.K(oa).lf;if(Ja)for(let fb=0;fb<Ja.length;fb++){var M=Ja.K(fb);M.Vc&&(M=h.Eb(M.lk))&&M.ka(Mc.a.d2i,!1)&&N.a.xt(aa,Fu.h(M))&&this.FK.Rnc(M)&&b.add(M)}}}}this.Mxh=r;if(b.count){h=
this.Qc.Nc(7);try{h.Bb(this.Daf());for(const aa of b)aa.Uf(Mc.a.d2i)}finally{h&&h.dispose()}}}}L9d(b){this.lrg(b);this.uUm(b);this.MSm(b)}rZh(){this.m$&&(this.Gb.uf(this.m$),this.m$=null)}VVb(){if(this.m$||this.Di.ERf)this.rZh(),this.L9d(null)}zE(){this.hb.tA(this.W7);y.AFrameworkApplication.XI(()=>{this.VVb()})}dispose(){this.hb.Rga(this.W7);this.rZh()}static Fom(b,h,r,A){for(const M of h){const aa=M.key;b.lb(aa)||r.add(aa)}for(const M of b)b=M.key,h.lb(b)||A.add(b)}}Object(u.a)(Ew,"IntelligentPlaceholderSelectionCache",
null,[10]);var Fw;(function(b){b[b.unknown=0]="unknown";b[b.contextMenu=1]="contextMenu";b[b.Q8k=2]="atMention";b[b.lkq=3]="textGesture";b[b.paste=4]="paste";b[b.WGp=5]="workItemIntent";b[b.aSp=6]="characterTrigger"})(Fw||(Fw={}));Object(u.b)("IntelligentPlaceholderCreation",Fw);class Uv{constructor(b,h,r,A){this.MFa=b;this.An=h;this.r4b=r;this.yz=A}cye(b){return b&&b.Ic&&b.Ic.id.equals(this.yz.value.td.id)?!0:!1}$Qj(b){return this.cye(b)&&b.ka(Mc.a.uI,!1)?!0:!1}MBn(){this.r4b.execute(b=>{b.logAction({actionType:Up.b.SessionStart,
engagement:Up.a.Offer,objectName:Uv.Jyc})})}uhe(b,h){const r=2==h&&this.cye(b);if(this.$Qj(b)||r){var A=b.getValue(Mc.a.MG);this.r4b.execute(M=>{M.logAction({actionType:Up.b.Created,engagement:Up.a.None,objectName:Uv.Jyc,objectId:A.toString(),objectFulfillment:Fw[h]})})}}Kzn(b){if(this.$Qj(b)){var h=b.getValue(Mc.a.MG);this.r4b.execute(r=>{r.logAction({actionType:Up.b.Deleted,engagement:Up.a.None,objectName:Uv.Jyc,objectId:h.toString()})})}}nCn(b,h){if(this.cye(b)){var r=b.getValue(Mc.a.MG);this.r4b.execute(A=>
{A.logAction({actionType:Up.b.Resolved,engagement:Up.a.None,objectName:Uv.Jyc,objectId:r.toString(),objectFulfillment:h?"RemoveText":"KeepText"})})}}eDn(b){b===Fc.a.$ae&&this.r4b.execute(h=>{h.logAction({actionType:Up.b.Deleted,engagement:Up.a.None,objectName:Uv.Jyc,objectFulfillment:Uv.mfp})})}pBn(b){if(this.cye(b)){var h=b.getValue(Mc.a.MG);this.r4b.execute(r=>{r.logAction({actionType:Up.b.Modified,engagement:Up.a.None,objectName:Uv.Jyc,objectId:h.toString(),objectFulfillment:"MentionInserted"})})}}Z$k(){this.MBn();
this.MFa.oOh((b,h)=>{this.uhe(h.XK,h.o9n)});this.MFa.o_k((b,h)=>{this.nCn(h.XK,h.Omn)});this.MFa.VZk((b,h)=>{this.pBn(h.XK)});this.An.occ((b,h)=>{this.eDn(h.actionId)});fD.a.dff((b,h)=>{this.Kzn(h.XK)})}}Uv.Jyc="IntelligentPlaceholder";Uv.mfp="Undo";Object(u.a)(Uv,"IntelligentPlaceholderTelemetry",null,[]);class lv{constructor(){this.V9=this.NEd=this.pLd=this.W=null}get name(){return"WordEditor.IntelligentPlaceholder"}uc(b){this.W=b;b.ia(1006,()=>new YE(y.AFrameworkApplication.va,b.Ra(65))).ha();
b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderAtMentionManager",()=>new tH).as(1004).ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderEditor",()=>new Kn(y.AFrameworkApplication.va,new Ul.a,b.resolve(351),b.resolve(326),b.resolve(1003),b.resolve(322),b.resolve(82),b.resolve(1004),b.resolve(46).instance,b.resolve(39).instance,b.resolve(42),b.resolve(383),new Qf.a(()=>qa.StaticActiveAppFrame.za().kb.$c.td),b.resolve(743),this.W.resolve(1005))).as(1007).as(696).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEventSource").ha();
b.ia(1008,()=>new sH(y.AFrameworkApplication.va,b.resolve(326),b.resolve(696),b.resolve(1006))).ha();b.ia(1010,()=>new Ew(b.resolve(42),b.resolve(1007),b.resolve(326),y.AFrameworkApplication.oc,()=>qa.StaticActiveAppFrame.za().kb.Jc.od,new Qf.a(()=>qa.StaticActiveAppFrame.za().kb.$c.td))).ha();b.ia(1011,()=>new Dw(Object(Lb.a)(),new Qf.a(()=>qa.StaticActiveAppFrame.za().kb.$c.td),b.resolve(326),b.resolve(1007))).as(1014).ha();b.ia(1009,()=>new Uv(b.resolve(1007),b.resolve(50),b.Ra(997),new Qf.a(()=>
qa.StaticActiveAppFrame.za().kb.$c))).ha()}init(){this.W.resolve(12).us.continueWith(()=>{this.Fo()})}Fo(){const b=this.W.resolve(12);this.W.Ra(999);this.W.resolve(1008).Xb();this.W.resolve(1009).Z$k();this.V9=this.W.resolve(1007);Iv.a.RYk(Object(E.a)(this.V9,this.V9.xUh,"beforeIntelligentPlaceholderPaste"));Iv.a.RQd(Object(E.a)(this.V9,this.V9.Ljj,"onIntelligentPlaceholderPaste"));this.pLd=this.W.resolve(1010);b.isFeatureEnabled(92)||this.pLd.zE();this.NEd=this.W.resolve(1011);this.NEd.kdc(qa.StaticActiveAppFrame.za().kb,
Xb.KeyInputManager.instance);this.Aro(this.W.Ra(324),this.W.resolve(164),this.W.resolve(760))}dispose(){this.pLd&&this.pLd.dispose();this.NEd&&this.NEd.dispose();this.V9&&(Iv.a.qxo(Object(E.a)(this.V9,this.V9.xUh,"beforeIntelligentPlaceholderPaste")),Iv.a.Uxo(Object(E.a)(this.V9,this.V9.Ljj,"onIntelligentPlaceholderPaste")))}Aro(b,h,r){b&&b.execute(A=>{A.XX(new uH(h,r))})}static main(){K.a.instance.Lc(new lv)}}Object(u.a)(lv,"PackageManager",null,[0,1]);var zH=window.FindReplaceTaskPaneData={name:"CommandUI",
attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FindReplaceTaskPane",Title:"STR@L_NavigationPaneTitle",Width:"300"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupNavControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Medium",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnHeadings",Command:"0xD0FBCB6A",
LabelText:"STR@L_NavigationPaneHeadingsSubtitle"}},{name:"Button",attrs:{Id:"btnFind",Command:"0x7EC3CC8E",LabelText:"STR@L_Find"}},{name:"Button",attrs:{Id:"btnReplace",Command:"0x8358F6C1",LabelText:"STR@L_Replace"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"TwoRow"},children:[{name:"Row",attrs:{Id:"SearchBoxPlaceholder",DisplayMode:"Medium"}},{name:"Row",attrs:{Id:"RowFindFilters",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",
attrs:{},children:[{name:"Label",attrs:{Id:"LabelFilters",Command:"0x2F9A3D80",QueryCommand:"0x5E7080C7"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupReplaceInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"ReplacePlaceholder",DisplayMode:"Medium"}}]}]},{name:"Group",attrs:{Id:"GroupReplaceControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"RowReplaceButtons",DisplayMode:"Medium",TextAlign:"Right"},
children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonReplace",Command:"0x3F2E19EE",LabelText:"STR@L_Replace"}},{name:"Button",attrs:{Id:"ButtonReplaceAll",Command:"0x69D75659",LabelText:"STR@L_ReplaceAll"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelSummary",Command:"0x2F9A3D80",
QueryCommand:"0x7F7A1460"}}]}]}]},{name:"Section",attrs:{Type:"OneRow",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{Id:"RowFindButtons",DisplayMode:"Small"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonFindPrevious",Alt:"STR@L_FindPrevious",Command:"0x4457C7F4",QueryCommand:"0x89A9BD2C",Image16by16:"IMGMAP@we@UpArrow_16x16x32",LabelText:"STR@L_FindPrevious"}},{name:"Button",attrs:{Id:"ButtonFindNext",Alt:"STR@L_FindNext",Command:"0xB28AED00",Image16by16:"IMGMAP@we@DownArrow_16x16x32",
QueryCommand:"0x8CA2CFB8",LabelText:"STR@L_FindNext"}}]}]}]}]},{name:"Group",attrs:{Id:"FindResultsPlaceholder",IsStretched:"true"}},{name:"Group",attrs:{Id:"GroupOutOfSyncResultsNotification",IsStretched:"false"}}]}]}]},wo=d(2138),FB=d(2132),du=d(2087);class ny{}ny.Z8o="Search_16x16x32";ny.R8o="ClosePaneGlyph_16x16x32";Object(u.a)(ny,"SearchBoxIcons",null,[]);var AH=d(2090),ez=d(2091),eu=d(2089);class BH{constructor(){this.Fgh=null}get key(){return"FIND_HIT"}get Cv(){return WordEditorIntl.WordEditorStrings.l_FindHitContentTitle}reset(b){this.Fgh=
b.node.GVa()}wEa(b){let h=null;for(const r of this.Fgh)if(r.Ec<=b&&b<r.end)return h=Object.assign(new Tt.a,{NF:this.key,contentObject:r}),{returnValue:!0,yG:h};return{returnValue:!1,yG:h}}}Object(u.a)(BH,"FindHitDetailsProvider",null,[256,257]);var ZE=d(1610),$E=d(1508),GB=d(1569),HB=d(1621);class pt{constructor(b,h,r,A,M,aa,oa,Ja=null,fb=null){this.Zm=null;this.find=(Cb,Gb,Sb,pc,zc)=>1===Sb?32:void 0===zc||null===zc?8:zc.length?this.jEg(zc):(this.zmf(du.a.initial),32);this.Uhc=(Cb,Gb,Sb,pc,zc)=>
this.gTj(Fc.a.Byb,Cb,Gb,Sb,pc,zc);this.L5l=(Cb,Gb,Sb,pc,zc)=>this.gTj(Fc.a.Cyb,Cb,Gb,Sb,pc,zc);this.gni=(Cb,Gb,Sb)=>1===Sb?32:this.jEg(this.$o.CVa());this.Hhd=(Cb,Gb,Sb,pc,zc)=>{Cb=!this.$o.XH;zc[Am.a.Image16by16Class]=Cb?Gg.getImageClass(ny.Z8o):Gg.getImageClass(ny.R8o);zc[Am.a.LabelText]=Cb?WordEditorIntl.WordEditorStrings.L_SearchFilterTooltip:WordEditorIntl.WordEditorStrings.l_SearchFilterCancelTooltip;zc[Am.a.ApplyLabelTextToControlOnly]=!0;zc[Am.a.EnsureControlRoleIsButton]=!0;zc[Am.a.On]=!1;
return 32};this.Q6l=(Cb,Gb,Sb)=>{if(1===Sb)return 32;this.DJi(!1);return 32};this.$6l=(Cb,Gb,Sb)=>{if(1===Sb)return 32;this.DJi(!0);return 32};this.Cng=(Cb,Gb,Sb,pc,zc)=>{zc[Xk.a.Visible]=this.$o.nTj;return 32};this.Ong=(Cb,Gb,Sb,pc,zc)=>{zc[Xk.a.Visible]=this.$o.nTj;return 32};this.f9d=(Cb,Gb,Sb,pc,zc)=>{if(1===Sb)return 32;this.qC.Wkd.KJi(zc);return 32};this.STd=(Cb,Gb,Sb)=>{if(1===Sb)return 32;this.zmf(du.a.initial);return 32};this.bVc=(Cb,Gb,Sb)=>{if(1===Sb)return 32;HB.a.Qrd();this.zmf(du.a.initial);
this.$o.fA(!1);return 32};this.mIa=(Cb,Gb,Sb)=>{if(1===Sb)return this.vcn(Cb===Ka.a.H1h);this.$o.mIa();return 32};this.YDe=(Cb,Gb,Sb)=>{if(1===Sb)return 32;switch(Cb){case Ka.a.rCf:this.$o.matchCase=!this.$o.matchCase;break;case Ka.a.KCf:this.$o.matchWholeWord=!this.$o.matchWholeWord}return this.jEg(this.$o.CVa())};this.Fqe=(Cb,Gb,Sb,pc,zc)=>{zc[Vg.a.On]=this.$o.matchCase;return 32};this.Hqe=(Cb,Gb,Sb,pc,zc)=>{zc[Vg.a.On]=this.$o.matchWholeWord;return 32};this.kng=(Cb,Gb,Sb,pc,zc)=>{Cb=this.$o.matchCase;
Gb=this.$o.matchWholeWord;Sb="";Cb&&Gb?Sb=String.format(WordEditorIntl.WordEditorStrings.l_FindMultipleFiltersLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):Cb?Sb=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase):Gb&&(Sb=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));zc[Fh.a.Value]=Sb;zc[Fh.a.Visible]=
Cb||Gb;return 32};this.auc=(Cb,Gb,Sb,pc,zc)=>{Cb=this.$o.x5;Gb="";switch(this.$o.XH){case du.a.eWj:Gb=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case du.a.DIj:Gb=Cb?this.jMf(WordEditorIntl.WordEditorStrings.l_SummarySomeResults):WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case du.a.Axb:Gb=this.jMf(WordEditorIntl.WordEditorStrings.l_SummaryAllResults);break;case du.a.Jha:Gb=this.jMf(this.$o.uLa?WordEditorIntl.WordEditorStrings.l_SummaryAllResults:WordEditorIntl.WordEditorStrings.l_SummarySomeResults);
break;case du.a.oYa:Gb=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case du.a.Ouc:Gb=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgress;break;case du.a.Nuc:Gb=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}zc[Fh.a.Value]=Gb;return 32};this.Gqe=(Cb,Gb,Sb,pc,zc)=>{zc&&(zc.CommandValueId=this.$o.CVa());return 32};this.replace=(Cb,Gb,Sb,pc,zc)=>{if(1===Sb)return this.i_f()?32:8;if(!this.i_f())return 8;Cb=this.$o.eQb();"string"===typeof zc&&zc&&(Cb=zc);v.ULS.sendTraceTag(6033813,
312,50,"Replace Called");ac.a("NavigationPaneReplace");zc=this.lHb.replace(Cb);this.$o.kOo(zc);return 32};this.replaceAll=(Cb,Gb,Sb,pc,zc)=>{if(1===Sb)return this.Vmn()?32:8;Cb=this.$o.eQb();"string"===typeof zc&&zc&&(Cb=zc);ac.a("NavigationPaneReplace");this.Zm=this.Xd.Wf("UserAction","ReplaceAll");this.$o.X$(du.a.Ouc);v.ULS.sendTraceTag(4065348,312,50,"Replace All started feedback indicated to user.");GB.a.gAo(this.$o.CVa(),this.$o.eQb());this.lHb.replaceAll(Cb,this.CZn);return 32};this.CZn=(Cb,
Gb)=>{this.Zm&&(this.Zm.stop(),this.Zm=null);v.ULS.sendTraceTag(4065349,312,50,"{0}",{["ReplaceAll Complete.ReplaceCount"]:Cb,["TotalCount"]:Gb});GB.a.dAo(Cb,Gb);this.$o.X$(du.a.Nuc)};this.pvj=(Cb,Gb,Sb,pc,zc)=>{Gb=!1;if(!zc)return 8;this.$o.Oj.isVisible&&(Gb=Cb===Fc.a.aid===this.$o.I3c());Cb!==Fc.a.aid||this.Qoh||(Gb=!1);zc[Vg.a.On]=Gb;return 32};this.lng=(Cb,Gb,Sb,pc,zc)=>{if(!zc||!this.$o.Oj.isVisible)return 32;zc[Vg.a.On]=this.$o.uLa;return 32};this.nng=(Cb,Gb,Sb,pc,zc)=>{if(!zc)return 32;zc.currentFindReplaceViewType=
this.$o.XH;return 32};this.fho=(Cb,Gb,Sb,pc,zc)=>{if(1===Sb)return 32;Cb=zc[Vg.a.On];zc&&(zc[Vg.a.On]=this.$o.Oj.isVisible);Cb&&!zc[Vg.a.On]&&(pt.k1j(),ac.a("NavigationPaneCrossClick"));return 32};this.$_a=(Cb,Gb,Sb,pc,zc)=>{const Yc=this.$o.Oj.isVisible;v.ULS.sendTraceTag(42501021,367,50,"Visibility: {0}",Yc);return Yc?this.bVc(Cb,Gb,Sb,pc,zc):this.kxc(Cb,Gb,Sb,pc,zc)};this.kxc=(Cb,Gb,Sb,pc,zc)=>{if(1===Sb)return ec.SessionStatusManager.instance.WA?32:8;if(2===Sb){pt.k1j();this.k8();ZE.FindReplaceUIManager.ygl(Cb,
zc,this.$o.Oj.isVisible);Gb=!0;Cb===Fc.a.oxc&&void 0!==zc&&null!==zc&&(Gb=zc);this.$o.fA(!0,Gb);zc=eu.a.initial;switch(Cb){case Fc.a.lxc:v.ULS.sendTraceTag(42501022,367,50,"");zc=eu.a.headings;break;case Fc.a.Byb:zc=eu.a.find;break;case Fc.a.Cyb:zc=eu.a.replace;break;case Fc.a.oxc:zc=eu.a.intelligentPlaceholder;break;case Fc.a.$_a:zc=this.$o.Mfc,zc||(v.ULS.sendTraceTag(42501023,367,50,""),zc=eu.a.headings)}zc!==eu.a.find&&zc!==eu.a.replace||pt.Bkp();this.$o.eTo(zc,Gb);HB.a.ump();return 32}return 8};
this.oMa=()=>{this.$o.XH&&!this.$o.uLa&&v.ULS.sendTraceTag(5007322,312,50,"App closed when find is in progress.")};this.ga=b;this.$o=h;this.qC=r;this.lHb=A;this.Qoh=M;this.Xd=oa;fb&&fb(1,this.oMa,null);this.SQa=Ja}k8(){}Xb(){this.ga.fb(Fc.a.eog,lc.a.view,this.fho,96);this.ga.qa(Fc.a.$_a,lc.a.view,this.$_a);this.ga.qa(Fc.a.lxc,lc.a.view,this.kxc);this.ga.qa(Fc.a.Byb,lc.a.view,this.kxc);this.ga.qa(ub.a.wCf,lc.a.view,this.find);this.ga.qa(Ka.a.Uhc,lc.a.view,this.Uhc);this.ga.qa(ub.a.vCf,lc.a.view,this.gni);
this.ga.fb(Ka.a.Ggo,lc.a.view,this.Hhd,97);this.ga.qa(ub.a.Uag,lc.a.view,this.Q6l);this.ga.qa(ub.a.hlg,lc.a.view,this.$6l);this.ga.fb(ub.a.Cng,lc.a.view,this.Cng,97);this.ga.fb(ub.a.Ong,lc.a.view,this.Ong,97);this.ga.qa(Fc.a.f9d,lc.a.view,this.f9d);this.ga.qa(ub.a.Wdc,lc.a.view,this.STd);this.ga.qa(Ka.a.mIa,lc.a.view,this.mIa);this.ga.qa(Ka.a.H1h,lc.a.application,this.mIa);this.ga.qa(Fc.a.bVc,lc.a.view,this.bVc);this.ga.qa(Ka.a.rCf,lc.a.view,this.YDe);this.ga.qa(Ka.a.KCf,lc.a.view,this.YDe);this.ga.fb(Ka.a.Fqe,
lc.a.view,this.Fqe,97);this.ga.fb(Ka.a.Hqe,lc.a.view,this.Hqe,97);this.ga.fb(Fc.a.kng,lc.a.view,this.kng,97);this.ga.fb(Fc.a.auc,lc.a.view,this.auc,97);this.ga.fb(Fc.a.lng,lc.a.view,this.lng,97);this.ga.fb(Fc.a.nng,lc.a.view,this.nng,97);this.ga.fb(Fc.a.mng,lc.a.view,this.pvj,97);Object($E.b)()&&this.ga.fb(Fc.a.Gqe,lc.a.view,this.Gqe,96);this.Qoh&&(this.ga.fb(Fc.a.Cyb,lc.a.view,this.kxc,1028),this.ga.fb(Fc.a.aid,lc.a.view,this.pvj,97),this.ga.fb(Fc.a.replace,lc.a.view,this.replace,1028),this.ga.fb(Fc.a.replaceAll,
lc.a.view,this.replaceAll,1028),y.AFrameworkApplication.J.$("SmartLookupEnableNativePane")&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)&&this.ga.fb(Ka.a.DCf,lc.a.view,this.L5l,1028));this.ga.qa(Fc.a.oxc,lc.a.view,this.kxc)}Spg(){this.SQa&&this.SQa.execute(b=>{b.XX(new BH)})}gTj(b,h,r,A,M,aa){if(1===A)return ec.SessionStatusManager.instance.WA?32:8;if(void 0===aa||null===aa)return 8;this.kxc(b,r,2,M,aa);b=this.$o;b.oyg(aa.CommandValueId);
Object($E.b)()&&("MatchCase"in aa&&(b.matchCase=aa.MatchCase),"MatchWholeWord"in aa&&(b.matchWholeWord=aa.MatchWholeWord));return this.gni(h,r,A,M,aa)}jEg(b){if(void 0===b||null===b||!b.length)return 32;b=AH.a.createQuery(b,this.Lgo);if(void 0===b||null===b)return v.ULS.sendTraceTag(4069067,312,10,"InvalidQuery"),8;this.qC.find(b);return 32}get Lgo(){let b=ez.a.none;this.$o.matchCase&&(b|=ez.a.matchCase);this.$o.matchWholeWord&&(b|=ez.a.ONg);return b}DJi(b){this.$o.Mfc!==eu.a.headings&&this.$o.x5&&
(b?this.qC.Wkd.lQm():this.qC.Wkd.FJi())}zmf(b){this.$o.XH&&(this.$o.uLa||v.ULS.sendTraceTag(5007321,312,50,"User action resulting in cancelling find operation in progress."),this.qC.m6a(),this.$o.X$(b))}vcn(b){return this.$o.XH===du.a.Ouc||b&&!this.$o.XH?8:32}jMf(b){return String.format(b,this.$o.qyd,this.$o.x5)}i_f(){return this.$o.I3c()&&0<this.$o.x5}Vmn(){return this.i_f()&&this.$o.uLa}static k1j(){null!=y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("NavPaneFloodgateIsEnabled")&&window.setTimeout(()=>
{const b=Za.a.instance.Ra(2);b&&b.execute(h=>{h.logActivity("NavPaneUsed","NavPaneFloodgateIsEnabled")})},pt.Xza)}static Lpm(b,h,r,A){return new pt(y.AFrameworkApplication.va,b,h,r,A,Cd.FocusManager.instance(),qa.StaticActiveAppFrame.za().Vr,Za.a.instance.Ra(324),Object(E.a)(y.AFrameworkApplication.ua.tS,y.AFrameworkApplication.ua.tS.nb,"registerHandler"))}static Bkp(){null==y.AFrameworkApplication.J||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",
!1)||window.setTimeout(()=>{const b=Za.a.instance.Ra(2);b&&b.execute(h=>{h.logActivity("FindReplaceExperienceSurvey",null)})},pt.Xza)}static Kpm(b,h,r,A){return pt.Lpm(b,h,r,A)}}pt.Xza=5E3;Object(u.a)(pt,"FindReplaceActor",null,[]);var IB=d(900),aF=function(){function b(){this._map=new Map}Object.defineProperty(b.prototype,"first",{get:function(){return this.BM},set:function(h){this.BM=h},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"last",{get:function(){return this.T2a},enumerable:!1,
configurable:!0});b.prototype.length=function(){return this._map.size};b.prototype.get=function(h){return this._map.get(h)};b.prototype.insert=function(h,r){this.removeItem(h);r={key:h,kH:this.T2a,next:void 0,data:r};this.first||(this.first=r);this.T2a&&(this.T2a.next=r);this.T2a=r;this._map.set(h,r)};b.prototype.insertAfter=function(h,r,A){h=this._map.get(h);if(!h)return!1;A={key:r,kH:h,next:h.next,data:A};var M=h.next;M&&(M.kH=A);h.next=A;this._map.set(r,A);return!0};b.prototype.insertBefore=function(h,
r,A){h=this._map.get(h);if(!h)return!1;A={key:r,kH:h.kH,next:h,data:A};var M=h.kH;M&&(M.next=A);h.kH=A;this._map.set(r,A);return!0};b.prototype.removeItem=function(h){var r=this._map.get(h);r&&(this.first===r&&(this.first=r.next),this.T2a===r&&(this.T2a=r.kH),r.kH&&(r.kH.next=r.next),r.next&&(r.next.kH=r.kH),this._map.delete(h))};return b}();class CH{constructor(){this.type="heading"}}Object(u.a)(CH,"NavPaneHeadingItem",null,[]);class hD{constructor(){this.type="bookmark"}}Object(u.a)(hD,"NavPaneBookmarkItem",
null,[]);class fu{constructor(b,h,r,A,M,aa,oa){var Ja;this.jb=b;this.hb=h;this.Yb=r;this.vp=A;this.L3=M;this.sJ=aa;this.hwk=oa;this.$3a=0;this.ZGd=new Map;this.Gjh=!1;this.gFa=new Map;this.SCd=null===(Ja=y.AFrameworkApplication.J)||void 0===Ja?void 0:Ja.getBooleanFeatureGate("Microsoft.Office.WordOnline.InitialHeadingsInNavPaneFix",!1)}get headingsReady(){return this.Gjh}set headingsReady(b){this.Gjh=b}get PXb(){return this.$3a}get N3(){this.H3a&&0!=this.H3a.length()||(this.H3a=this.Dbo());return this.H3a}set N3(b){this.H3a=
b}get VZb(){return this.XJk}set VZb(b){this.VZb&&(this.VZb.isSelected=!1);b.isSelected=!0;this.XJk=b}GKf(b,h){return"bookmark"===b.type?b.text:h.id.toString()}Dbo(){const b=new aF;if(!this.L3)return b;this.ZGd=new Map;let h;const r=[];for(const A of this.L3.paragraphs()){const M=this.RAi(A,r);null===M||void 0===M?void 0:M.forEach(aa=>{(h=this.HCi(aa,r))&&"heading"===h.type&&h.indentLevel<aa.indentLevel&&(1>=h.indentLevel?(h.isCollapsed=!1,aa.isHidden=!1):(h.isCollapsed=!0,aa.isHidden=!0));b.insert(this.GKf(aa,
A),aa)})}return b}HCi(b,h){return"heading"===b.type?1<h.length?h[h.length-2]:void 0:0<h.length?h[h.length-1]:void 0}oLg(b){var h,r,A;let M=Gd.ParagraphReader.PVa(b),aa=!1;9===M&&this.gFa.has(b.id.toString())&&(M=this.gFa.get(b.id.toString()),aa=!0);y.AFrameworkApplication.vd("InitialHeadingsInNavPaneFix-tf;InitialHeadingsInNavPaneFix-cf");const oa=this.SCd?null===(r=null===(h=this.H3a)||void 0===h?void 0:h.get(b.id.toString()))||void 0===r?void 0:r.data:null===(A=this.N3.get(b.id.toString()))||void 0===
A?void 0:A.data;if(oa){if(oa.indentLevel===M){h=Gn.AParagraphNode.dV(b.characterData.trim());r=this.vp.value.gig(b);this.SCd&&this.nXi(b)&&this.Vci(b);if(h!==oa.text||oa.hasBookmark!==r)return oa.text=h,oa.hasBookmark=r,!0;!aa&&oa.isPurelyADH&&(oa.isPurelyADH=!1,--this.$3a);return!1}this.Vgd();return!0}if(9===M)return this.cbn(b)?(this.Vgd(),!0):!1;this.Vgd();return!0}cbn(b){var h;const r=this.vp.value.zsi(b);b=null!==(h=this.ZGd.get(b.id.toString()))&&void 0!==h?h:0;if(b!==r.length)return!0;for(h=
0;h<b;++h)if(!this.N3.get(r[h].dqb()))return!0;return!1}Vci(b){var h;if((this.SCd?null===(h=this.H3a)||void 0===h?0:h.get(b.id.toString()):this.N3.get(b.id.toString()))||this.vp.value.gig(b))return this.Vgd(),!0;this.gFa.has(b.id.toString())&&(this.gFa.delete(b.id.toString()),--this.$3a);return!1}Vgd(){const b=new aF;this.$3a=0;if(this.L3){this.ZGd=new Map;var h=[],r,A;for(const M of this.L3.paragraphs()){const aa=this.RAi(M,h);null===aa||void 0===aa?void 0:aa.forEach(oa=>{var Ja=this.GKf(oa,M);A=
this.HCi(oa,h);this.AEo(Ja,oa,A);b.insert(Ja,oa);"heading"===(null===r||void 0===r?void 0:r.type)&&(Ja=r,Ja.indentLevel>=oa.indentLevel&&(Ja.isCollapsed=void 0));r=oa})}this.SCd?this.H3a=b:this.N3=b}else this.N3=b}AEo(b,h,r){var A,M;if(b=null===(A=this.H3a.get(b))||void 0===A?void 0:A.data)b.isSelected&&(h.isSelected=!0,this.VZb=h),h.isHidden=b.isHidden;if(r){if(A=null===(M=this.H3a.get(this.GKf(r,r.paragraphNode)))||void 0===M?void 0:M.data)r.isCollapsed=A.isCollapsed;r.isCollapsed?h.isHidden=!0:
r.isHidden?(r.isCollapsed=!0,h.isHidden=!0):(r.isCollapsed=!1,h.isHidden=!1)}}RAi(b,h){var r=Gd.ParagraphReader.PVa(b),A=!this.nXi(b);const M=this.khn(r)&&A?!0:!1;A=this.gFa.has(b.id.toString())&&A;const aa=[];if(M)aa.push(this.V8h(b,r,!1,h));else if(A)this.$3a+=1,this.j_c&&(r=this.gFa.get(b.id.toString()),aa.push(this.V8h(b,r,!0,h)));else{let oa=0;this.vp.value.zsi(b).forEach(Ja=>{const fb=new hD;fb.text=Ja.dqb();fb.isSelected=!1;fb.bookmarkManager=this.vp;fb.indentLevel=0<h.length?h[h.length-1].indentLevel+
1:0;oa+=1;aa.push(fb)});this.ZGd.set(b.id.toString(),oa)}return aa}V8h(b,h,r,A){var M,aa;const oa=new CH;oa.text=Gn.AParagraphNode.dV(b.characterData.trim());oa.indentLevel=h;oa.paragraphNode=b;oa.isSelected=!1;oa.isPurelyADH=r;oa.listMarker=this.XKf(b);oa.hasBookmark=this.vp.value.gig(b);for(b=null===(M=A[A.length-1])||void 0===M?void 0:M.indentLevel;b&&b>=h;)A.pop(),b=null===(aa=A[A.length-1])||void 0===aa?void 0:aa.indentLevel;(!b||b<h)&&A.push(oa);return oa}nXi(b){return this.jb.Vb(b)&&0===this.jb.textLength(b,
9)}wom(b){for(b=this.L3.r3c(b);b;){let h=this.N3.get(b.node.id.toString());for(;h;){const r=h.data;if("heading"===r.type&&!r.isHidden)return r;h=h.kH}b=b.kH}}J1l(b){(b=this.N3.get(b))&&(1==b.data.isCollapsed?this.sTj(b):this.LYm(b))}onClickHeading(b){var h;this.VZb=b=null===(h=this.N3.get(b))||void 0===h?void 0:h.data;h=sc.SelectionFactory.ue(b.paragraphNode,0);this.hb.Kc(h);this.Yb.Jg(id.AFrame.Ro)}onClickBookmark(b){var h;this.VZb=b=null===(h=this.N3.get(b))||void 0===h?void 0:h.data;this.vp.value.hQm(b.text);
this.Yb.Jg(id.AFrame.Ro)}fZm(b){var h,r;if(b=null===(r=null===(h=b.entries())||void 0===h?void 0:h.next())||void 0===r?void 0:r.value)if(h=this.wom(b[0]))this.VZb=h}onShareHeadingClick(b){var h;ac.a("CreateHeadingLinkThroughNavPane",!0,void 0);if(b=null===(h=this.N3.get(b))||void 0===h?void 0:h.data)h=b.paragraphNode.getValue(Mc.a.Yc),this.hwk.value.W8h(h)}AKg(b,h){const r=b.id.toString(),A=this.gFa.has(r);if(!A||this.gFa.get(r)!==h){this.gFa.set(r,h);if(this.j_c)return this.oLg(b);A||this.N3.get(r)||
(this.$3a+=1)}return!1}xNl(b){const h=b.id.toString(),r=this.gFa.has(h);if(r){this.gFa.delete(h);if(this.j_c)return this.oLg(b);r&&!this.N3.get(h)&&--this.$3a}return!1}Shp(b){this.j_c=b;this.Vgd()}YKg(b){var h;const r=null===(h=this.N3.get(b.id.toString()))||void 0===h?void 0:h.data;if(!r)return!1;b=this.XKf(b);if(r.listMarker===b)return!1;this.Pqp();return!0}kZd(b){var h;b=null===(h=this.N3.get(b.id.toString()))||void 0===h?void 0:h.data;if(!b||void 0===b.listMarker)return!1;b.listMarker=void 0;
return!0}sTj(b){var h=b.data;1==h.isCollapsed&&(h.isCollapsed=!1);h=h.indentLevel;b=b.next;let r;for(;b&&b.data.indentLevel>h;)r=b,b=r.next,r.data.isHidden=!1,"heading"==r.data.type&&(b=r.data.isCollapsed?this.a7o(r):this.sTj(r));return b}LYm(b){var h=b.data;h.isCollapsed=!0;h=h.indentLevel;b=b.next;let r;for(;b&&b.data.indentLevel>h;)r=b,b=r.next,r.data.isHidden=!0}a7o(b){const h=b.data.indentLevel;for(b=b.next;b&&b.data.indentLevel>h;)b=b.next;return b}khn(b){return 0<=b&&8>=b}Pqp(){let b=this.N3.first;
for(;b;){if("heading"===b.data.type){const h=b.data;h.listMarker=this.XKf(h.paragraphNode)}b=b.next}}XKf(b){var h;if(b.bE instanceof IB.a)return this.WNm(null===(h=this.sJ.QXa(b.bE))||void 0===h?void 0:h.FU)}WNm(b){for(let h=0;h<(null===b||void 0===b?void 0:b.length);)return 128<=b.charCodeAt(h)?void 0:b}}Object(u.a)(fu,"NavPaneHeadingsManager",null,[]);var gA=d(1509);class JB{constructor(){this.lHb=this.qC=this.MGc=this.AAd=this.W=null}get name(){return"WordEditor.FindReplace"}uc(b){var h;this.W=
b;y.AFrameworkApplication.vd("ImprovedNavPaneDiscoverability;ImprovedNavPaneDiscoverabilityCf");(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.ImprovedNavPaneDiscoverabilityIsEnabled",!1))&&HB.a.initialize(b.Ra(77),b.Ra(6),b.Ra(76),"WACViewPanelContainer");const r=new fu(b.resolve(164),b.resolve(326),Cd.FocusManager.instance(),b.rf(454),b.resolve(417),b.resolve(244),b.rf(1012));this.W.ia(725,()=>r).as(725).ha()}init(){JB.sc.us.continueWith(()=>
{this.Fo()})}Fo(){if(df.a.ZNg){const b=df.a.JFe;this.MGc=ZE.FindReplaceUIManager.getInstance(b);this.qC=FB.a.createInstance(this.MGc,wo.a.instance,gA.a.instance,!0);this.lHb=this.qC.cZb;this.AAd=pt.Kpm(this.MGc,this.qC,this.lHb,b);this.AAd.Xb();this.AAd.k8();this.AAd.Spg();qa.StaticActiveAppFrame.za().Fe()}}dispose(){this.MGc&&this.MGc.dispose()}static get sc(){return null!=JB.LUg?JB.LUg:JB.LUg=Za.a.instance.resolve(12)}}Object(u.a)(JB,"FindReplacePackageManager",null,[0,1]);class KB{constructor(){}NEf(){return"_@_"+
kb.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+"Z"}Itp(b,h,r,A){h.lOo(b,A);h.Tm(b,He.a.Eca,!0);h.Tm(b,Mc.a.vXa,!0);h.Tm(b,Mc.a.E2,KB.Yli(r));h.Tm(b,Mc.a.ft,15)}R0k(b,h,r,A){const M=b.tXd(A);h.Tm(M,He.a.Eca,!0);h.Tm(M,Mc.a.ft,47);h.Tm(M,Mc.a.E2,KB.Yli(r));b=b.tXd(A);h.Tm(b,He.a.Eca,!0);h.Tm(b,Mc.a.ft,16);return[M.Ek,b.Ek]}pcm(b,h,r){b=b.tXd(r);h.Tm(b,He.a.Eca,!0);h.Tm(b,Mc.a.pTb,!0);return b.Ek}static Yli(b){return String.format(' HYPERLINK "{0}"',b)}}Object(u.a)(KB,"AtMentionHyperlinkConfigurator",
null,[427]);var vx=d(1528);class bF{constructor(b,h,r){this.Iia=b;this.hb=h;this.xLi=this.RTi=this.pWe=!1;this.kWb=this.kWb.bind(this);this.lWb=this.lWb.bind(this);this.vWb=this.vWb.bind(this);r&&r.execute(A=>{this.w1a=A});xs.a.qSd.DHf.then(A=>{this.xLi=!0;this.RTi=A.isSuccess})}Gse(){this.Iia.eqg(this.kWb);this.Iia.fqg(this.lWb);this.Iia.rqg(this.vWb)}see(){return!1}kWb(b,h,r){var A,M;h=Date.now();if(this.w1a)if(this.xLi&&!this.RTi)v.ULS.sendTraceTag(512369951,3034,10,"ContextIQUserInitHandler::onInputCallback - AugLoop Auth Token is not valid.");
else{var aa=null===(M=null===(A=this.hb.gb)||void 0===A?void 0:A.currentSelection)||void 0===M?void 0:M.Wc;aa?(A=aa.node,Gd.ParagraphReader.Vb(A)?(M=Gd.ParagraphReader.text(A),0>r||r>M.length?v.ULS.sendTraceTag(540340298,3034,50,"ContextIQUserInitHandler::onInputCallback - Position of the prefix was not within the bounds of the paragraph."):1<b.length&&("@"===b.trimEnd()||vx.a.vud&&"/"===b.trimEnd())?(ac.c(Fc.a.byl,!0,void 0,void 0,void 0,void 0),this.Iia.reset()):(this.pWe?this.w1a.jup():(this.pWe=
!0,this.w1a.Y5o(aa)),this.w1a.HKg(r,r+b.length),b=M.substring(0,r)+b,this.w1a.cFf(A,b,r,h))):v.ULS.sendTraceTag(540541835,3034,10,"ContextIQUserInitHandler::onInputCallback - Current node is not a paragraph.")):v.ULS.sendTraceTag(540541834,3034,10,"ContextIQUserInitHandler::onInputCallback - Failed to get the current selection context.")}else v.ULS.sendTraceTag(537776153,3034,10,"ContextIQUserInitHandler::onInputCallback - ContextIQIntentProvider is not available yet.")}lWb(b){if(this.w1a)this.w1a.onKeyDown(b)}vWb(){this.pWe=
!1;this.w1a&&this.w1a.q2h()}}Object(u.a)(bF,"ContextIQUserInitHandler",null,[423]);class mv{constructor(){this.mB=null}get name(){return"WordEditor.AtMentions"}uc(b){this.W=b;b.ia(383,()=>new KB(b.resolve(12))).ha();const h={crewAlias:mv.lck,featureName:mv.Sdk,topLevelKpiName:mv.Ihk,vetoPillar:7};b.ia(1005,()=>new Ey.a(Ba.Health.instance,new Nl.a,h)).as(1005).ha()}init(){this.W.resolve(12).us.continueWith(()=>{this.Fo()})}dispose(){}Fo(){this.W.Ra(143).execute(b=>{b.atMentionsEnabledAsync().then(h=>
{y.AFrameworkApplication.J.$("ConsumerMentionsHostIsEnabled")&&(h=h&&y.AFrameworkApplication.J.$("WordEditorConsumerCanvasMentionsIsEnabled"));(h||vx.a.wud())&&this.dxn()})});this.W.resolve(383)}dxn(){(y.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasAtMentions"):this.W.resolve(77).JD.loadScript("canvasAtMentions")).then(()=>{y.AFrameworkApplication.J.Uo(()=>{this.Spo()})})}Spo(){const b={peopleAPI:this.W.resolve(143),localizationDetails:{isRightToLeft:y.AFrameworkApplication.isRtl,
appLocale:Sys.CultureInfo.CurrentCulture.name},useLPP:!0,isTestEnv:this.Opn()};this.mB=canvasAtMentions.FactoryGlobal.getWordAtMentionsControllerInstance(b);this.W.Ra(4).execute(h=>{h.isFeatureEnabled("MsoContextIq",!1).then(r=>{r&&vx.a.xud()||!r&&vx.a.wud()?(vx.a.HWf=!r,this.W.ia(1015,()=>new bF(this.W.resolve(291),this.W.resolve(326),this.W.Ra(1013))).ha()):this.W.ia(1015,()=>new yH(this.W.resolve(291),this.mB,this.W.resolve(20),this.W.resolve(212),this.W.resolve(326),Object(Lb.a)(),this.W.resolve(696),
this.W.resolve(1014),this.W.resolve(26),this.W.resolve(1005))).ha();this.W.resolve(1015).Gse()})})}Opn(){var b,h;const r=null!==(b=y.AFrameworkApplication.sessionStartInfoSettings.Ring)&&void 0!==b?b:"-1";b=null!==(h=y.AFrameworkApplication.sessionStartInfoSettings.WACDatacenter)&&void 0!==h?h:"";return r===mv.Zbk&&b===mv.Ybk}}mv.Zbk="-4";mv.Ybk="DC2";mv.lck="webasynccollabeng";mv.Sdk="AtMentions";mv.Ihk="AtMentionsFeatureUsage";Object(u.a)(mv,"PackageManager",null,[0,1]);var Kp=d(1684);class $J{constructor(b,
h,r,A){this.ga=b;this.Te=h;this._augLoopRuntimeManager=r;this.DQk=A;this.tya=0;this.APd=this.S$b=!1;this.b$g=this.FAh=this.C_e=this.GAh=0;this.bCb=null;this.Wrk=new Map([["ReferencesSmartLookUp",!0],["SmartLookupSynonyms",!0],["SmartLookupContextMenu",!0],["SmartLookupDictionary",!0],["ChangePicture",!0],["Rewrite",!0]]);this.Jqk=[{id:`${Lv.Ltc}_${1}`},{id:`${Lv.Ltc}_${2}`},{id:`${Lv.Ltc}_${3}`},{id:Uh.a.HYd},{id:Uh.a.cXd},{id:Uh.a.fgd},{id:Uh.a.dgd}];this.Qkk=[{id:"OpenCopilotComposeDraftContent"},
{id:"OpenCopilotComposeRewrite"},{id:"NewComment",count:2},{id:"CreatePullQuote"},{id:"DeleteBookmarkContextMenu"},{id:"EditBookmarkNameContextMenu"},{id:"EditIllustration"},{id:"Draw"},{id:"CreateHeadingLink"},{id:"RemoveContentControl"},{id:"Sort"},{id:"ReviewDesignerSuggestion"}];this.sxd=new Map;this.dmh=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdaptiveContextMenuIsEnabled",!1);this.xCk=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.AcmMaximumSuggestions",
8);this.Znk=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CanvasContextFeature",!1);this.Te.nb(this,Kp.SearchSuggestionAnnotation.getTypeName());(y.AFrameworkApplication.J.$("IsO365CommercialHost")||y.AFrameworkApplication.J.$("IsO365ConsumerHost"))&&this.sxd.set("InsertLink","InsertLinkFlyout");this.sxd.set("GraphicsEditor","");this.q4j();this.Xb(this.ga)}Pdo(b,h){if(this.dmh){var r=Date.now();this.C_e&&1250>r-this.C_e||this.kGb||(this.C_e=r,this.bCb=b,this.sMd=this.YIm(h),
this.oDo(),this.FBo())}}ZG(b,h){if(b.annotationType===Kp.SearchSuggestionAnnotation.getTypeName()&&b.content&&h===on.a.getTypeName()&&(h=Date.now(),b=b.content,this.kGb&&this.kGb===b.correlationId)){window.clearTimeout(this.tya);this.kGb=void 0;var r=this.S$b,A=this.$wm(b),M=A&&0<A.length;M&&(this.Zup(A),this.APd&&(r=!1));r&&this.YCj();h={["description"]:"[Zero term context menu] augloop response latency",["correlationId"]:b.correlationId,["requestPreparationTime"]:this.FAh,["canvasContextRetrievalTime"]:this.b$g,
["networkTime"]:b.networkTime,["executionTime"]:b.executionTime,["updateTime"]:Date.now()-h,["latencyMs"]:h-this.GAh,["containsZTM"]:M,["shouldFallBack"]:this.S$b,["fallBack"]:r};v.ULS.sendTraceTag(572057625,1303,50,JSON.stringify(h))}}$wm(b){const h=this.lNf(b.intentSuggestions,Kp.IntentIds.ZeroTermMenu,Kp.ObjectSemantic.GenericSuggestions,Kp.ObjectSchemaType.RankedSuggestion);return 1===h.length?h[0]:b.menuSuggestions}lNf(b,h,r,A){return Array.isArray(b)?b.filter(M=>M.intent===h&&M.result.semantic===
r&&M.result.type===A).map(M=>M.result.value):[]}Xb(b){b.fb(Ka.a.z8i,lc.a.application,this.GBo.bind(this),96)}YIm(b){const h=[],r=new Map,A=Date.now();for(const M of b){if(!M)continue;b=[];const aa={itemsMetadata:new cb.a};for(let oa=0;oa<M.ControlList.length;oa++){const Ja=M.ControlList[oa];if(Ja&&!Ja.ExternalId)continue;b.push(Ja.ExternalId);const fb={timeStamp:A,source:"FallbackZeroTermMenu",confidenceScore:-1};aa.itemsMetadata[Ja.ExternalId]=fb;r.set(Ja.ExternalId,fb)}h.push(appChrome.api.menuSection(b,
M.Title,M.Lang,M.Id,aa))}return{sections:h,commands:r}}Q0j(b){return this.sxd.has(b)?this.sxd.get(b):b}$Oa(b){const h={};for(const r of b)b=this.Q0j(r.suggestion),appChrome.selectors.isControlDefined(b)&&(h[b]=appChrome.selectors.getModelType(b));qa.StaticActiveAppFrame.za().w3d(h)}Ncn(b){return!appChrome.selectors.isControlDefined(b)||appChrome.selectors.isControlDisabled(b)?!1:this.Wrk.has(b)?this.sMd.commands.has(b):!0}aai(b){return appChrome.actions.updateMenu("ZeroTermContextMenu",b,null,null,
null,null,{menuTargetType:this.bCb})}Spb(b=!1){b=b?go.a.instance.JGc:go.a.instance.Spb();const h=[],r=Date.now();for(const A of b)A.commandId&&h.push({Id:A.commandId,TimeElapsedSinceClick:(r-A.timeStamp)/1E3,ContentType:A.contentType,CommandSurface:A.commandSurface,InputMethod:A.Wy});return h}G1c(){const b=go.a.instance.G1c(),h=[],r=Date.now();for(const A of b)A.controlId&&h.push({Id:A.controlId,TimeElapsedSinceClick:(r-A.timeStamp)/1E3,ContentType:A.contentType,CommandSurface:A.commandSurface,InputMethod:A.Wy});
return h}wGf(){const b={semantic:Kp.ObjectSemantic.CanvasContext,type:Kp.ObjectSchemaType.WordCanvasContext,value:{contentType:this.bCb}};if(this.Znk){const h=Date.now(),r=this.DQk.wGf(gg.a.instance.gb.currentSelection);r&&r.value.contentType&&(b.value=r.value);this.b$g=Date.now()-h}return b}Jui(){const b=this.G1c(),h=this.Spb(),r=this.Spb(!0),A=[];A.push({semantic:Kp.ObjectSemantic.ControlIdHistory,type:Kp.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Kp.SequenceType.ControlId,Sequence:b}});
A.push({semantic:Kp.ObjectSemantic.CommandIdHistory,type:Kp.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Kp.SequenceType.CommandId,Sequence:h}});A.push({semantic:Kp.ObjectSemantic.FilteredCommandIdHistory,type:Kp.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Kp.SequenceType.CommandId,Sequence:r}});A.push(this.wGf());return A}q4j(){this._augLoopRuntimeManager.getSession().then(b=>this.nwd=b).catch(()=>{this.nwd=void 0})}FBo(){const b=Date.now(),h=this.Jui(),r=[Kp.IntentIds.ZeroTermMenu,
Kp.IntentIds.Logging];this.FAh=Date.now()-b;this.qXj(r,h,"ContextualMenu")}GBo(b,h,r){2===r&&(b=this.Jui(),this.qXj([Kp.IntentIds.Logging],b,"Floatie"));return 32}qXj(b,h,r){if(0===b.length||0===h.length)v.ULS.sendTraceTag(556892510,1303,15,"No search suggestion al workflow will be activated");else{var A=new Kp.SearchSuggestionSignal({correlationId:this.S1c("ACM"),intents:b,contextObjects:h,entryPoint:r});this.S$b=0<=b.indexOf(Kp.IntentIds.ZeroTermMenu);this.GAh=Date.now();this.kGb=A.correlationId;
this.tya=window.setTimeout(()=>{this.JZn(A.correlationId)},750);h=new on.l({parentPath:["Signal",Kp.SearchSuggestionSignal.getTypeName()],items:[{id:kb.a.create().toString(),body:A}]});this.nwd&&!this.nwd.isClosed?this.nwd.submitOperation(h):(this._augLoopRuntimeManager.submitOperation({operation:h}),this.q4j());v.ULS.sendTraceTag(574441286,1303,50,JSON.stringify({["description"]:"[Zero term context menu] search suggestion al workflow invocation",["correlationId"]:A.correlationId,["shouldFallBack"]:this.S$b,
["intents"]:b}))}}S1c(b){const h=kb.a.create().toString();appChrome.api.setOfeCorrelationId(b,h);return h}JZn(b){this.kGb&&this.kGb===b&&(this.kGb=void 0,this.S$b&&this.YCj(),v.ULS.sendTraceTag(572057624,1303,15,JSON.stringify({["description"]:"[Zero term context menu] augloop request timeout",["correlationId"]:b,["shouldFallBack"]:this.S$b})))}YCj(){const b=this.aai(this.sMd.sections);appChrome.api.dispatch(b);this.d4h()}d4h(){this.APd=!0}evo(b){var h,r;const A=[],M=new Map;if(!b||0===b.length)return A;
for(const aa of b){if(!aa||!aa.controlIds||0===aa.controlIds.length)continue;b={controlIds:[],id:aa.id,title:aa.title,lang:aa.lang,data:{itemsMetadata:new cb.a}};const oa="CommandsZTM"===aa.id;for(const Ja of aa.controlIds){if(M.has(Ja))continue;if(oa&&b.controlIds.length>=this.xCk)break;const fb=null===(r=null===(h=aa.data)||void 0===h?void 0:h.itemsMetadata)||void 0===r?void 0:r[Ja];M.set(Ja,fb);b.controlIds.push(Ja);fb&&(b.data.itemsMetadata[Ja]=fb)}0<b.controlIds.length&&A.push(b)}return A}oDo(){this.APd=
!1;if(this.dmh){const b=[appChrome.actions.updateControlHiddenState("ContextMenu",!0),appChrome.actions.updateControlEnabledDisabledState("ZeroTermContextMenu",!1)];appChrome.api.dispatch(b)}}Zup(b){this.APd||(b=this.gdm(b),0<b.length&&appChrome.api.dispatch(b))}gdm(b){const h=[];let r=[];var A=this.CCm();A&&0<A.length&&r.push(...A);(A=this.gcm())&&r.push(A);Array.isArray(b)&&0<b.length&&(b=this.Lza(b))&&(b.id="CommandsZTM",r.push(b));(b=this.Wbm())&&r.push(b);r=this.evo(r);if(0===r.length)return[];
h.push(this.aai(r));this.d4h();return h}CCm(){var b,h;const r=null===(b=this.sMd)||void 0===b?void 0:b.sections.filter(A=>{var M;return null===(M=A.id)||void 0===M?void 0:M.startsWith(Lv.ihi)});for(const A of r)if(null===(h=A.data)||void 0===h?0:h.itemsMetadata)for(const M in A.data.itemsMetadata)A.data.itemsMetadata[M].source="PassThroughZeroTermMenu";return r}gcm(){const b=this.zqi(this.Jqk,"DefaultZeroTermMenu");return this.Lza(b)}Wbm(){const b=this.zqi(this.Qkk,"AdvertizedZeroTermMenu");return this.Lza(b)}zqi(b,
h){const r=[];for(const A of b)A&&this.n1o(A)&&this.sMd.commands.has(A.id)&&r.push({suggestion:A.id,rankingScore:-1,suggestionSource:h});return r}n1o(b){if("number"!==typeof(null===b||void 0===b?void 0:b.count))return!0;if(0===b.count)return!1;b.count--;return!0}Lza(b){const h=[],r={itemsMetadata:new cb.a},A=Date.now();this.$Oa(b);for(const M of b)b=this.Q0j(M.suggestion),this.Ncn(b)&&(h.push(b),r.itemsMetadata[b]={timeStamp:A,source:M.suggestionSource,confidenceScore:M.rankingScore});return 0<h.length?
appChrome.api.menuSection(h,null,null,null,r):null}}Object(u.a)($J,"AugLoopSearchSuggestionManager",null,[229,230]);class DH{constructor(){this.W=null}get name(){return"WordEditor.ContextualSearch"}uc(b){this.W=b;this.W.ia(1017,()=>new $J(y.AFrameworkApplication.va,this.W.resolve(451),augLoop.ALFactoryGlobal.getAugLoopRuntimeManager(),this.W.resolve(1016))).as(1081).ha()}init(){this.W.resolve(12).us.continueWith(()=>{xs.a.hm().then(()=>{this.start()})})}start(){this.W.resolve(1017)}dispose(){}static main(){K.a.instance.Lc(new DH)}}
Object(u.a)(DH,"PackageManager",null,[0,1]);var cF=d(443),Gw=d(934);class aK extends Gw.a{constructor(){super();this.documentUrl=this.scripts=null}}Object(u.a)(aK,"BootMessage",Gw.a,[]);var dF=d(1036);class eF{constructor(){this.wO=null;this.nXn=b=>{if(b.target===this.wO)if(void 0===b.data||null===b.data)v.ULS.sendTraceTag(50739143,3007,10,"WebWorker: The received message did not have any data.");else try{if("string"===typeof b.data){const h=H.a(b.data);this.vAe(h.api)?this.awd.K(h.api).Vie(h.method,
h):v.ULS.sendTraceTag(50739144,3007,10,"WebWorker: The received message contained an unsupported API.")}}catch(h){v.ULS.sendTraceTag(50739145,3007,10,"WebWorker: Error routing a message received from a worker thread. Exception: {0}",h)}};this.awd=new Ng.a}Z0f(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}create(b,h){let r=!1;try{this.wO=new Worker(b);this.wO.onmessage=this.nXn;const A=Object.assign(new aK,
{api:0,method:0,scripts:h,documentUrl:document.URL});this.postMessage(A);this.Z0f()&&dF.a.xjk(this.wO);r=!0}catch(A){v.ULS.sendTraceTag(50442775,3007,10,"WebWorker: Error creating worker. Exception: {0}",A)}return r}postMessage(b){try{const h=H.c(b);this.wO.postMessage(h)}catch(h){v.ULS.sendTraceTag(50442776,3007,10,"WebWorker: Error sending a message to worker thread. Exception: {0}",h)}}vAe(b){return this.awd.lb(b)}rSk(b,h){this.vAe(b)&&v.ULS.sendTraceTag(50442777,3007,10,"WebWorker: We're overwriting an existing API in the collection.  ApiId: {0}",
b);this.awd.Z(b,h)}yfm(b){return this.vAe(b)?this.awd.K(b):null}}Object(u.a)(eF,"WebWorker",null,[1545]);class lk{constructor(){this.oOg=[]}eJl(b,h){if(h){var r=y.AFrameworkApplication.eC(b.lIj,7),A=[];for(let M=0;M<b.O0b.length;M++){let aa;switch(b.O0b[M].format){case 5:case 6:aa=cF.a.iQb(b.O0b[M].name);break;default:aa=b.O0b[M].name}A.push(y.AFrameworkApplication.eC(aa,b.O0b[M].format))}try{const M=URL.createObjectURL(new Blob(["importScripts('"+r+"');"],{type:"application/javascript"})),aa=new eF;
if(aa.create(M,A))for(this.oOg.push(aa),r=0;r<b.uAe.length;r++){const oa=h.qBl(aa,b.uAe[r]);oa&&aa.rSk(b.uAe[r],oa)}}catch(M){v.ULS.sendTraceTag(50442778,3007,10,"Exception caught when creating a new worker. Exception: {0}",M.message)}}else v.ULS.sendTraceTag(42824902,3007,10,"CreateWebWorker: ApiFactory parameter was null.")}}Object(u.a)(lk,"WebWorkerCollection",null,[]);class co{constructor(b,h){this.kcf=new lk;if(b){b=b.create();for(let r=0;r<b.length;r++)this.kcf.eJl(b[r],h)}else v.ULS.sendTraceTag(50442779,
3007,10,"WebWorkerRouter: configFactory parameter was null.")}sendMessage(b,h,...r){let A=!1;for(let aa=0;aa<this.kcf.oOg.length;aa++){var M=this.kcf.oOg[aa];M.vAe(b)&&((M=M.yfm(b))?A=M.callMethod(h,r)||A:v.ULS.sendTraceTag(50442780,3007,10,"WebWorkerRouter: Failed to get an Api that is supported by the web worker. ApiId: {0}",b))}A||v.ULS.sendTraceTag(50442781,3007,10,"WebWorkerRouter: A SendMessage did not find a worker to succesfully send the message to. ApiId: {0}, MethodId: {1}",b,h)}}Object(u.a)(co,
"WebWorkerRouter",null,[1544]);class gu extends Gw.a{constructor(){super();this.LocalCobaltClusterId=this.LocalCobaltMachineId=this.LocalCobaltSessionId=this.sessionID=this.sessionStartInfoSettings=this.appSettings=null;this.LocalCobaltSessionHasBackup=!1;this.SettingsRoutedToServer=this.WaciiEnabledRequests=0;this.WacClusterId=null}}Object(u.a)(gu,"SettingsMessage",Gw.a,[]);class wx{constructor(b){this.wO=b}}Object(u.a)(wx,"WebWorkerApiMain",null,[]);class Xg extends wx{constructor(b){super(b)}Z0f(){return!!y.AFrameworkApplication.J&&
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}callMethod(b,h){if(!h)return v.ULS.sendTraceTag(591972375,3007,10,"InitializeWorkerApiMain: InitializeSettings called with a null methodParams value."),!1;if(1===b)return this.gil(h);v.ULS.sendTraceTag(591972376,3007,10,"InitializeWorkerApiMain: Unknown method called.  MethodId: {0}",b);return!1}Vie(b,h){switch(b){case 14:this.dTm(h);break;default:v.ULS.sendTraceTag(591972377,3007,10,"InitializeWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",
b)}}gil(b){if(2!==b.length)return v.ULS.sendTraceTag(591972378,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters.  Param Count: {0}",b.length),!1;if("object"!==typeof b[0]||"object"!==typeof b[1])return v.ULS.sendTraceTag(587343010,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters. Param[0] is Dictionary: {0}, Param[1] is Dictionary: {1}","object"===typeof b[0],"object"===typeof b[1]),!1;b=Object.assign(new gu,{api:0,method:1,
appSettings:b[0],sessionStartInfoSettings:b[1],sessionID:y.AFrameworkApplication.userSessionId,LocalCobaltSessionId:tm.a.instance.GF,LocalCobaltMachineId:tm.a.instance.fma,LocalCobaltClusterId:tm.a.instance.Qta,LocalCobaltSessionHasBackup:tm.a.instance.Rta,WaciiEnabledRequests:tm.a.instance.hoa,SettingsRoutedToServer:tm.a.instance.kAg,WacClusterId:y.AFrameworkApplication.Ee.Q0});this.wO.postMessage(b);return!0}dTm(b){this.Z0f()&&b&&b.result&&(v.ULS.sendTraceTag(555877916,3007,15,"Receive initialize finished message"),
this.szp())}async szp(){try{const b=await new dF.a.yjk.WorkerUtilsTestClass(10);await b.Rh(5);15==await b.counter?v.ULS.sendTraceTag(555877917,3007,50,"WorkerUtils testing successfully"):v.ULS.sendTraceTag(555877918,3007,15,"WorkerUtils testing failed")}catch(b){v.ULS.sendTraceTag(555877919,3007,10,"WorkerUtils failed with exception: {0}",b.message)}}}Object(u.a)(Xg,"InitializeWorkerApiMain",wx,[]);class EH extends Gw.a{constructor(){super();this.mockDataEnabled=!1;this.requestEndpoint=this.rootQuerySignature=
null;this.appMode=Sp.a.none;this.activityFeedIsEnabled=!1;this.api=2;this.method=4}}Object(u.a)(EH,"CatchUpNetworkRequestWorkerRequestMessage",Gw.a,[]);class FH extends wx{constructor(b,h){super(b);this.eUc=h}callMethod(b,h){if(4===b)return b=Object.assign(new EH,{rootQuerySignature:h[0],requestEndpoint:h[1],appMode:h[2],activityFeedIsEnabled:h[3]}),this.wO.postMessage(b),!0;v.ULS.sendTraceTag(592189584,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unknown method called.  MethodId: {0}",b);return!1}Vie(b,
h){switch(b){case 5:v.ULS.sendTraceTag(592189585,3012,50,"CatchUpNetworkRequestWorkerExternalApi: Message received for method: {0}",b);this.eUc.IOo(h);break;default:v.ULS.sendTraceTag(592189586,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unsupported Method sent to the Api.  MethodId: {0}",b)}}}Object(u.a)(FH,"CatchUpNetworkRequestWorkerExternalApi",wx,[]);class fz extends Gw.a{constructor(){super();this.context=this.textPredictionConfig=this.prediction=this.paragraphContent=null}}Object(u.a)(fz,
"LocalInferenceMessage",Gw.a,[]);class bK{constructor(){this.prediction=this.context=null}}Object(u.a)(bK,"LocalInferenceOutput",null,[]);class Wd{constructor(){this.modelFilesUrl=this.settings=this.scriptDirectory=null}}Object(u.a)(Wd,"TextPredictionConfig",null,[]);class oy{constructor(){this.extendedRankLimit=0;this.dynamicTemporaryInDocModelNGramToken=3}}Object(u.a)(oy,"TextPredictionSettings",null,[]);class cK{constructor(){this.nGramOrder=0;this.modelFilesUrl=null}}Object(u.a)(cK,"TextPredictionDynamicPayload",
null,[]);class LB extends wx{constructor(b,h){super(b);this.KQk=h}callMethod(b,h){if(!h)return v.ULS.sendTraceTag(575959325,3008,10,"LocalInferenceWorkerApiMain: LocalInference called with a null methodParams value."),!1;switch(b){case 8:return this.mil(h);case 7:return this.hil(h);case 9:return this.lil(h);case 10:return this.iil(h);case 13:return this.jil(h);case 14:return this.kil(h);default:return v.ULS.sendTraceTag(575959326,3008,10,"LocalInferenceWorkerApiMain: Unknown method called.  MethodId: {0}",
b),!1}}Vie(b,h){switch(b){case 9:this.kUm(h);break;default:v.ULS.sendTraceTag(575959822,3007,10,"LocalInferenceWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}kUm(b){b&&b.prediction&&(b=Object.assign(new bK,{prediction:b.prediction,context:b.context}),this.KQk.PTh().aeo(b))}hil(b){if(1>b.length)return v.ULS.sendTraceTag(575959823,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceAddContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new fz,{api:4,method:7,paragraphContent:b,textPredictionConfig:this.getConfig()});this.wO.postMessage(b);return!0}mil(b){if(1>b.length)return v.ULS.sendTraceTag(575959824,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceRemoveContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new fz,{api:4,method:8,paragraphContent:b});this.wO.postMessage(b);
return!0}lil(b){if(2>b.length)return v.ULS.sendTraceTag(575959825,3008,10,"LocalInferenceWorkerApiMain: callLocalInferencePredict called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;var h=b[0];b=b[1];h=Object.assign(new fz,{api:4,method:9,paragraphContent:b,context:h});this.wO.postMessage(h);return!0}iil(b){if(1>b.length)return v.ULS.sendTraceTag(570782293,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceInit called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new fz,{api:4,method:10,textPredictionConfig:this.getConfig(b)});this.wO.postMessage(b);return!0}jil(b){if(1>b.length)return v.ULS.sendTraceTag(556827920,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new fz,{api:4,method:13,textPredictionConfig:this.Svi(b)});this.wO.postMessage(b);return!0}kil(b){if(1>
b.length)return v.ULS.sendTraceTag(541733787,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,Object(Xa.a)(Object,b[0])),!1;b=b[0];b=Object.assign(new fz,{api:4,method:14,textPredictionConfig:this.Svi(b)});this.wO.postMessage(b);return!0}getConfig(b=null){return Object.assign(new Wd,{scriptDirectory:y.AFrameworkApplication.I8+"/intelligence/",settings:Object.assign(new oy,{extendedRankLimit:0}),modelFilesUrl:b})}Svi(b=
null){return Object.assign(new Wd,{scriptDirectory:y.AFrameworkApplication.I8+"/intelligence/",settings:Object.assign(new oy,{dynamicTemporaryInDocModelNGramToken:b.nGramOrder}),modelFilesUrl:b.modelFilesUrl})}}Object(u.a)(LB,"LocalInferenceWorkerApiMain",wx,[]);class vL extends wx{constructor(b){super(b);y.AFrameworkApplication.XI(()=>{this.VVb()})}callMethod(b){v.ULS.sendTraceTag(591689869,3008,10,"ShutdownWorkerApiMain: CallMethod not supported on this API.  MethodId: {0}",b);return!1}Vie(b){v.ULS.sendTraceTag(591689870,
3007,10,"ShutdownWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}VVb(){const b=Object.assign(new Gw.a,{api:3,method:6});this.wO.postMessage(b)}}Object(u.a)(vL,"ShutdownWorkerApiMain",wx,[]);class GH{constructor(b){this.container=b}qBl(b,h){let r=null;switch(h){case 0:r=new Xg(b);break;case 2:r=new FH(b,this.container.resolve(833));break;case 3:r=new vL(b);break;case 4:r=new LB(b,this.container.resolve(642));break;default:v.ULS.sendTraceTag(50442782,3008,10,"WordWebWorkerApiFactory: CreateApi was passed an unsupported ApiId. ApiId: {0}",
h)}return r}}Object(u.a)(GH,"WordWebWorkerApiFactory",null,[471]);var HH=d(325);class fF{constructor(b,h){this.name=b;this.format=h}}Object(u.a)(fF,"ImportedScript",null,[]);class MB{constructor(){this.uAe=this.O0b=this.lIj=null}}Object(u.a)(MB,"WebWorkerConfig",null,[]);var wL=d(1314);class IH{constructor(b){this.yFh=[];this.nzk=b;if(y.AFrameworkApplication.J){b=y.AFrameworkApplication.J.$("AppChromeOverrideIsCombinedBundle")||y.AFrameworkApplication.J.$("IsCombinedBundleEnabled");const r=y.AFrameworkApplication.J.ib("ContentBaseUrl")?
6:5;var h=y.AFrameworkApplication.J.ib("AppScriptBaseName");const A=b?"":".";if(h){const M=b?"":"{0}";h+=`${A}${M}worker.js`;this.yFh.push(new fF(`MicrosoftAjax${b?"":"DS"}.${M}js`,r),new fF(h,r))}else v.ULS.sendTraceTag(558465106,3008,10,"WordWebWorkerConfigFactory: Failed to get AppScriptBaseName. Worker JS is not loaded")}else v.ULS.sendTraceTag(558465107,3008,10,"WordWebWorkerConfigFactory: AFrameworkApplication.appSettingsManager do not exist. Worker JS is not loaded")}create(){const b=[],h=
Object.assign(new MB,{lIj:"workerboot",O0b:this.yFh,uAe:[0,2,3,4]});this.nzk&&this.Uen()&&h.O0b.push(new fF("intelligence/edge-inference-web.js",5));b.push(h);return b}Uen(){return(new HH.a("arrowFunction",()=>{try{Object(wL.a)("const sum = (a, b) => a + b")}catch(b){return!1}return!0},!1)).isSupported()}}Object(u.a)(IH,"WordWebWorkerConfigFactory",null,[228]);class gz{constructor(){this.Ga=this.W=null}get name(){return"WordEditor.Workers"}init(){const b=this.W.resolve(219);b.sendMessage.apply(b,
[0,1].concat([this.Ga.appSettings,y.AFrameworkApplication.sessionStartInfoSettings]))}dispose(){}uc(b){this.W=b;this.Ga=this.W.resolve(71);const h=this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextPredictionEdge",!1);b.ia("Box4.Workers.WebWorkerRouter",()=>new co(new IH(h),new GH(b))).as(219).ha()}static main(){K.a.instance.Lc(new gz)}}Object(u.a)(gz,"WordEditorWorkersPackage",null,[0,1]);var NB=d(1120);class JH{constructor(){this.qKd=[]}rEi(b,h){let r=-1,A=null;A=M=>{M?h(this.qKd[r]):
(++r,r<this.qKd.length?this.qKd[r].Tdc(b,A):h(null))};A(!1)}Tdc(b,h){this.rEi(b,r=>{h(!!r)})}Wuc(b,h,r){this.rEi(b,A=>{if(!A)throw Error.invalidOperation("ResolveUrl called without checking CanResolveUrl");A.Wuc(b,h,r)})}XMh(b){this.qKd.push(b)}}Object(u.a)(JH,"CompositeExternalContentURLResolver",null,[466,374]);var py=d(1308);class xx extends py.a{constructor(){super();this.Thumbnail=this.Author=this.Title=this.MediaType=null;this.Height=this.Width=0;this.ProviderName=this.IFrameHtml=null}}Object(u.a)(xx,
"ExternalContentEmbedResponse",py.a,[]);var KH=d(1333),gF=d(748),LH=d(1108),iD=d(1226),OB=d(711),hz=d(509),Vv=d(161),hA=d(863),Wv;(function(b){b[b.Oif=0]="autoCorrect";b[b.o2l=1]="externalComponentPaste";b[b.z2l=2]="externalHyperlinkPaste";b[b.RWp=3]="externalContentFloatieConversion"})(Wv||(Wv={}));Object(u.b)("ExternalContentConversionContext",Wv);class oh{constructor(){this.UTb=this.TTb=null;this.pBf=new iD.ExternalContentEmbedRetriever;this.ROc=!0;this.wGc=this.Vo=this.hOi=this.gOi=this.Hm=this.tt=
null;this.vgd=()=>{v.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")};this.ktc=()=>{v.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")};null!=oh.dsa&&oh.dsa.Lui()}get U_b(){return this.ROc}set U_b(b){this.ROc=b}kmf(b,h){let r=!1;if(b){switch(b.contextId){case lc.a.Xc:r=!h;break;case lc.a.Cd:r=!0}r&&!hA.a(b.node)&&(r=!1)}return r}frn(b){const h=b.startsWith(Nc.a.Ntc),r=b.startsWith(Nc.a.yhd),A=b.startsWith(Nc.a.vqe);
return(h||r||A)&&Nc.a.AXa(b)}Nwj(){this.Vo=N.a.create();oh.Ff.kMb(this.Vo,4);oh.Ff.i8(this.Vo,0,oh.Ff.So());this.ORb(this.TTb,3,this.UTb,!0)}DWa(b,h,r){this.Vo=N.a.create();oh.Ff.kMb(this.Vo,r?0:2);oh.Ff.i8(this.Vo,0,oh.Ff.So());this.wGc();this.ORb(b,r?0:2,h)}Voe(b,h){this.Vo=N.a.create();oh.Ff.kMb(this.Vo,1);oh.Ff.i8(this.Vo,0,oh.Ff.So());this.ORb(b,1,h)}Zae(b,h,r,A){if(!b||!b.isConnected||!Uc.ImageReader.It(b))return null;const M=new OB.a;M.setValue(wb.a.Mlc,r);M.setValue(wb.a.vWa,h);M.P6a=this.gOi;
M.Cv=this.hOi;M.providerName=A;M.Bab=1===r;M.creationTime=Date.now();vd.a.Za(b).Vf(M,2);this.Ybd(M);return M}Hyj(b){this.wGc=b}NHe(b,h){const r=oh.l4.igc(h)||0;h=oh.l4.v7a(h)||0;const A=b.Width/b.Height;1<=A?(b.Width=r,b.Height=r/A):(b.Height=h,b.Width=h/A)}TPg(b,h,r){if(null!=b&&null!=h&&!I.a.Tf(r)){var A=oh.Jdd.Zjc(r);y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoTitleOnInsertionWithDialog",!1)?A.tva=!1:A.tva=!0;A.hideFloatie=
!0;this.NHe(b,h.node);this.nmc(b,h,!1,!1,A,r)}}Rqb(b){return b?b.Ie:0}MMg(b,h,r){let A=null;const M=b.node;if(!Gd.ParagraphReader.Vb(M)||!M.isConnected)return{returnValue:!1,Zva:A};if(r)return{returnValue:!0,Zva:b};r=b.cpBegin;const aa=b.cpEnd,oa=Gd.ParagraphReader.text(M);if(0<=r&&aa<=oa.length&&oa.substring(r,aa)===h)return{returnValue:!0,Zva:b};const Ja=oa.indexOf(h);return 0<=Ja?(A=wc.a.createTextRange(M,Ja,Ja+h.length),{returnValue:!0,Zva:A}):0<=r&&aa<=oa.length&&this.nlc(b)?{returnValue:!0,
Zva:b}:{returnValue:!1,Zva:A}}nlc(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=wc.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=Nc.a.KA(h,!1);if(1===h.length){h=h[0];const r=Gd.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==r)return!0}return!1}M0f(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}cfb(b,h){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$(h)&&window.setTimeout(()=>{const r=
Za.a.instance.Ra(2);r&&r.execute(A=>{A.logActivity(b,h)})},oh.Xza)}sIf(b,h){const r=!I.a.aaa(h);switch(b){case 1:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;break;default:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}ORb(b,
h,r,A=!1){if(this.frn(r)){var M=oh.Jdd.Zjc(r);if(M)if(this.M0f(M)){v.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent");b=Object(ya.a)(wc.a,b);var aa=!h;this.kmf(b,aa)?this.x8c(r)?(h=1===h,A=this.Bqm(b),M.hideFloatie=!0,this.nmc(A,b,aa,h,M,r)):this.Okg(b,h,M,r,A):oh.Ff.eU(this.Vo,2,"URL inserted in Non-Embedable context",oh.Ff.So())}else v.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),oh.Ff.eU(this.Vo,2,"Size provided is not valid for OEmbed",
oh.Ff.So())}else v.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),oh.Ff.eU(this.Vo,2,"URL inserted is not valid for ExternalContent",oh.Ff.So())}Bqm(b){const h=new xx;h.Width=oh.l4.igc(b.node)||0;h.Height=oh.l4.v7a(b.node)||0;h.Title="Fluid Component";h.MediaType="fluid";return h}x8c(b){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=oh.r3&&oh.r3.d1i(b)}Okg(b,h,r,A,M){const aa=
!h,oa=1===h,Ja=oh.l4.igc(b.node)||0,fb=oh.l4.v7a(b.node)||0,Cb=KH.a.iqf(r.fMg,!0,Ja,fb);this.tbd(b,A,h,!0);this.pBf.M_h(Cb,Gb=>{oh.Ff.i8(this.Vo,4,oh.Ff.So());oh.Ff.Tmd(this.Vo,this.Rqb(Gb.data));if(Gb=this.Vkg(Gb)){v.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var Sb=Vv.q(Gb.MediaType);oh.Ff.tse(this.Vo,7,Sb);Sb=b;({Zva:Sb}=this.MMg(b,A,oa)).returnValue?(this.tbd(Sb,A,h,!1),null==r.width?0<Ja&&Gb.Width>Ja&&(v.ULS.sendTraceTag(591681426,
324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),Gb.Width=Ja):(v.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Gb.Width=this.ktd(r.width,Gb.Width,Ja)),null==r.height?0<fb&&Gb.Height>fb&&(v.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Gb.Height=fb):(v.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),
Gb.Height=this.ktd(r.height,Gb.Height,fb)),oh.dsa.bhb||M?this.nmc(Gb,Sb,aa,oa,r,A):(this.TTb=b,this.UTb=A,this.MWc(A))):(v.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),oh.Ff.eU(this.Vo,2,"No conversion as the context is no longer valid for the external content conversion",oh.Ff.So()));oa&&this.y6a(Sb.node)}else oa&&this.y6a(b.node),oh.Ff.eU(this.Vo,1,"URL not oEmbedable",oh.Ff.So())},Gb=>{oh.Ff.i8(this.Vo,
4,oh.Ff.So());oh.Ff.Tmd(this.Vo,this.Rqb(Gb.data));oa&&this.y6a(b.node);v.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Gb.data.De);oh.Ff.eU(this.Vo,2,"ExternalContentEmbedRequest failed",oh.Ff.So())},Gb=>{oa&&this.y6a(b.node);v.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Gb)},this.Vo)}ktd(b,h,r){!b&&0<r&&h>r||b>r?(v.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),
h=r):b>r?h=r:b&&b<r&&(h=b);return h}nmc(b,h,r,A,M,aa){this.Hm=kb.a.create();b.Width=b.Width/b.Height*(b.Height-(hz.a.v5c+hz.a.p6))+2*hz.a.p6;const oa=new Rb.GraphTransaction(15);oa.Bb(h.node);oa.Ii=Fc.a.DWa;const Ja=this.nlc(h);null!=M.tva&&!M.tva||A||Ja||(b.Title=""===M.title||M.title?M.title:b.Title,!b.Title&&""!==b.Title)||(h=this.ZUf(h,oa,b.Title,aa,r));if(h){A&&(h=this.pvf(h));var fb=this.IXd(h,A);if(fb){r=Vv.q(b.MediaType);var Cb=this.I7d(b,r);this.gOi=b.IFrameHtml;this.hOi=b.Title;if(fb=this.GUf(fb,
Cb,oa,A,aa,r,b.ProviderName))oa.TLa(this.Hm,1),oa.dispose(),this.TTb=h,this.UTb=aa,this.ohg(M,b,fb),this.Bkg(aa,A||M.hideFloatie,Ja,r,b.Title,b.ProviderName)}else oa.dispose(),v.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),oh.Ff.eU(this.Vo,2,"Could not create IP context on splitting the paragraph",oh.Ff.So())}else oh.Ff.eU(this.Vo,2,"GraphNodeContext is null",oh.Ff.So())}I7d(b,h){const r=new wg.DictionaryPropertySet;
oh.DR.Npe(r,b.Width,b.Height);b=this.rIf(h,b.Title);r.setValue(He.a.imageAltText,b);r.setValue(Mc.a.kX,$f.a.OF());r.setValue(Mc.a.imageType,wk.other);return r}GUf(b,h,r,A,M,aa,oa){if(!b)return null;b=oh.DR.cbe(b,h);if(!b)return r.dispose(),v.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),oh.Ff.eU(this.Vo,2,"The anchored image could not be inserted",oh.Ff.So()),null;r=b.node;M=this.Zae(r,M,aa,oa);oh.Ff.cLg(this.Vo,M.id);A||this.fyg(r);
return r}ohg(b,h,r){I.a.aaa(b.thumbnailUrl)||(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(oh.Ff.i8(this.Vo,8,oh.Ff.So()),v.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.b_d(r,h.Thumbnail))}Bkg(b,h,r,A,M,aa){h||this.MWc(b);this.cfb("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");this.Wne("IsHyperlinkWithNonURLDisplayText",r,aa);this.ariaNotify(A,M);oh.Ff.i8(this.Vo,5,oh.Ff.So())}Wne(b,h,r){v.ULS.sendTraceTag(591267585,
324,50,"OtelLogging: ExternalContent transaction successfully completed");ca.a.sendTelemetryEvent(Object.assign(new la.a,{name:"Office.Word.Online.ExternalContent.OEmbedInsertions",dataFields:[Object.assign(new ia.a,{name:b,bool:h}),Object.assign(new ia.a,{name:"ProviderName",string:r})]}))}ariaNotify(b,h){this.U_b&&oh.Cw&&(b=this.sIf(b,h),oh.Cw.sendNotification(b,!0))}ZUf(b,h,r,A,M){if(M){if((M=Nc.a.KA(b,!1))&&1!==M.length)return h.dispose(),v.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),
null;oh.Jp.cV(M[0].paragraph,M[0].hyperlink)}return this.Jsg(b,r,A)}pvf(b){const h=b.node,r=Gd.ParagraphReader.text(h);return 0<r.length&&!r.trim().length?(b=wc.a.createTextRange(h,0,r.length),oh.Fg.Ve(b,""),wc.a.Tc(h,0)):b}IXd(b,h){return h?b:this.qJf(b)}qJf(b){const h=Gd.ParagraphReader.text(b.node),r=vd.a.Za(b.node);if(r.Kd()){b=wc.a.Tc(b.node,b.cpEnd);Bb.OutlineElementNavigator.je(r);const A=oh.gg.Vsa(r);oh.Oh.xca(r,A,b,!0,!0,!0,!0);""!=h&&oh.Oh.SA(r,!1,!0);r.Zd();return wc.a.Tc(r.currentNode,
0)}return null}Vkg(b){if(!({group:b}=tk.a.z4(b.data.De)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}Jsg(b,h,r){const A=b.cpBegin+h.length;oh.Fg.Ve(b,h);b=wc.a.createTextRange(b.node,b.cpBegin,A);oh.Jp.qF(b,r,!1);return b}rIf(b,h){const r=!I.a.aaa(h);switch(b){case 1:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,
h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}b_d(b,h){b.Jj().wg.xF(()=>{this.Tkg(h,b)},()=>{v.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}Ybd(b){b=vd.a.Za(b);b.vb(12);b.ld(12);b.ko.PT=!0}y6a(b){b.ctc=null}fyg(b){b=vd.a.Za(b);b.vb(11)&&(b.ld(11),b.Kd()&&b.Gk()&&b.Zd()&&Gd.ParagraphReader.Vb(b.currentNode)&&(b=sc.SelectionFactory.ue(b.currentNode,0),gg.a.instance.Kc(b)))}tbd(b,h,r,A){const M=b.cpBegin,
aa=b.cpEnd;b=Gd.ParagraphReader.text(b.node).trim();M||b!==h&&""!==b?M?aa===b.length?v.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Wv[r],A):0<M&&aa<b.length&&v.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Wv[r],A):v.ULS.sendTraceTag(590958600,
324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Wv[r],A):v.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Wv[r],A)}MWc(b){this.pgc();const h=new Wt.a(1,y.AFrameworkApplication.isRtl);h.ggd=b;oh.gpb.Hid(h)}pgc(){const b=new gx.a(!0);oh.Qba.cNa(b)}Tkg(b,h){if(b=
this.BLf(b,h))h=Array(1),h[0]=b,b=gF.a.construct(h,!1,y.AFrameworkApplication.J.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.tt.yq:null),h=this.stf(),this.Ixb(h,b)}BLf(b,h){if(!h)return v.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.tt=h.Jj();(new vd.a).set(h);if(!h.anchor||!h.anchor.gr||!h.anchor.gr.at)return v.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),
null;var r=h.anchor.gr.at.node;if(!r)return v.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),null;r=r.ka(fd.a.YJ,Ml.a.Hu);const A=h.getValue(He.a.oF),M=Ah.a.xf(Uc.ImageReader.zF(h.properties),0),aa=Ah.a.xf(Uc.ImageReader.tL(h.properties),1);return LH.a.construct(h.id.toString(),b,h.ka(He.a.imageAltText,""),M,aa,h.ka(Mc.a.O_,""),r,h.ka(Mc.a.kX,0),h.ka(Mc.a.Kla,!1),h.ka(fd.a.rka,-1),h.ka(Mc.a.kub,Box4Intl.Box4Strings.l_Picture),h.ka(He.a.TBa,
!1),A,h.ka(Mc.a.runId,1),h.ka(Mc.a.Yc,0))}Ixb(b,h){y.AFrameworkApplication.Ee.Wj(b,2,H.c(h),{},!1,2,this.vgd,this.ktc,null,void 0,void 0,void 0,void 0,"26");v.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}stf(){let b=$a.a.X0c("PicturePaste.ashx");const h=wm.a.yWa;y.AFrameworkApplication.J&&!y.AFrameworkApplication.J.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=$a.a.Bp(b,Uj.a.fileId,this.tt.yq));b=$a.a.Bp(b,Uj.a.cellId,this.tt.ml.toString());this.Hm||(this.Hm=
kb.a.create(),v.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=$a.a.Bp(b,Uj.a.f_,this.Hm.toString());b=$a.a.Bp(b,Uj.a.classId,h.toString());this.tt.NG&&(b=$a.a.Bp(b,Uj.a.NG,this.tt.NG));b=$a.a.Bp(b,Uj.a.tAb,"1");b=$a.a.Bp(b,Pi.a.imageType,wk.other.toString());b=tm.a.instance.Cef(b);b=$a.a.Bp(b,Uj.a.dza,this.tt.wg.kr.toString());b=$a.a.Bp(b,Uj.a.$sc,"0");return b=$a.a.Bp(b,Uj.a.v2b,"1")}static get gpb(){return null!=oh.uUg?oh.uUg:oh.uUg=Za.a.instance.resolve(211)}static get dsa(){oh.TFa||
(oh.TFa=Za.a.instance.resolve(1018));return oh.TFa}static get Qba(){return null!=oh.F1g?oh.F1g:oh.F1g=Za.a.instance.resolve(258)}static get Cw(){return null!=oh.oSg?oh.oSg:oh.oSg=Za.a.instance.resolve(26)}static get l4(){return null!=oh.Q2g?oh.Q2g:oh.Q2g=Za.a.instance.resolve(1019)}static get DR(){return null!=oh.pXg?oh.pXg:oh.pXg=Za.a.instance.resolve(1020)}static get gg(){return oh.Oh||(oh.Oh=Za.a.instance.resolve(18))}static get Jp(){return null!=oh.hXg?oh.hXg:oh.hXg=Za.a.instance.resolve(82)}static get Fg(){return null!=
oh.WSg?oh.WSg:oh.WSg=Za.a.instance.resolve(322)}static get Ff(){return null!=oh.DUg?oh.DUg:oh.DUg=Za.a.instance.resolve(637)}static get Jdd(){return null!=oh.o0g?oh.o0g:oh.o0g=Za.a.instance.resolve(1021)}static get r3(){return null!=oh.d0g?oh.d0g:oh.d0g=Za.a.instance.resolve(644)}}oh.Oh=null;oh.Xza=5E3;oh.TFa=null;Object(u.a)(oh,"ExternalContentEditor",null,[362]);var PB=d(288),nv=d(1156);class jD{constructor(b,h){this.bhb=!0;this.sWb=r=>{if(null!=r.result)return r.result.Value;v.ULS.sendTraceTag(556376794,
324,15,"onRegister get convertExternalContentIsEnabled settings options from Roaming Service failed.");return this.bhb};this.Rbb=r=>{r.kp||r.fj?v.ULS.sendTraceTag(559153884,324,15,"Load to get convertExternalContentIsEnabled settings options from Roaming Service failed."):(this.sXh(r.result),v.ULS.sendTraceTag(559437389,324,50,"Load to get convertExternalContentIsEnabled settings options from Roaming Service successfully"));return this.bhb};this.Ux=b;this.kT=h}Lui(){const b=new Yh.a;this.a0i()&&this.kT?
this.kT.Jwb(PB.a.gWc).CWRCo(this.sWb,0).CWRCo(this.Rbb,8):b.hg(this.bhb)}Mha(b){this.kT&&this.kT.Mha(PB.a.gWc,new nv.a(PB.a.gWc,b))}LHo(b){this.a0i()&&(this.Ux.rva("saveConvertExternalContentIsEnabled",b.toString()),v.ULS.sendTraceTag(559437386,324,50,"Try to save convertExternalContentIsEnabled settings value to Roaming Service."),this.sXh(b),this.Mha(b))}a0i(){const b=y.AFrameworkApplication.J.$("IsAnonymousUser");if(y.AFrameworkApplication.J.$("IsRoamingServiceEnabled"))if(b)v.ULS.sendTraceTag(559437387,
324,50,"User is anonymous ");else return!0;return!1}sXh(b){this.bhb=b}}Object(u.a)(jD,"ExternalContentSettingInfo",null,[470]);var Br=d(1097);class MH{constructor(){this.thumbnail=this.author=this.title=this.mediaType=this.url=null;this.height=this.width=0;this.type=null;this.showFloatie=!1}}Object(u.a)(MH,"FluidComponentProperties",null,[]);class dK{constructor(){this.loopType=this.Cv=this.P6a=this.url=null;this.mediaType=0;this.g$i=null}}Object(u.a)(dK,"IFrameProps",null,[]);class $k{static get l4(){return null!=
$k.O2g?$k.O2g:$k.O2g=Za.a.instance.resolve(1019)}static get DR(){return $k.Dk||($k.Dk=Za.a.instance.resolve(1020))}static get Cw(){return null!=$k.nSg?$k.nSg:$k.nSg=Za.a.instance.resolve(26)}static get Jp(){return null!=$k.bXg?$k.bXg:$k.bXg=Za.a.instance.resolve(82)}static get gg(){return null!=$k.K0g?$k.K0g:$k.K0g=Za.a.instance.resolve(18)}static get Fg(){return null!=$k.TSg?$k.TSg:$k.TSg=Za.a.instance.resolve(322)}static AXa(b){const h=b.startsWith(Nc.a.Ntc),r=b.startsWith(Nc.a.yhd),A=b.startsWith(Nc.a.vqe);
return(h||r||A)&&Nc.a.AXa(b)}static kmf(b,h){let r=!1;if(b){switch(b.contextId){case lc.a.Xc:r=!h;break;case lc.a.Cd:r=!0}r&&!hA.a(b.node)&&(r=!1)}return r}static nlc(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=wc.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=Nc.a.KA(h,!1);if(1===h.length){h=h[0];const r=Gd.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==r)return!0}return!1}static rIf(b,h){const r=!I.a.aaa(h);switch(b){case 1:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,
h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}static Ybd(b){b=vd.a.Za(b);b.vb(12);b.ld(12);b.ko.PT=!0}static I7d(b,h,r,A){const M=new wg.DictionaryPropertySet;$k.DR.Npe(M,h,b);b=$k.rIf(A,r);M.setValue(He.a.imageAltText,b);M.setValue(Mc.a.kX,$f.a.OF());M.setValue(Mc.a.imageType,
wk.other);return M}static Zae(b,h,r){if(!b||!b.isConnected||!Uc.ImageReader.It(b))return null;const A=new OB.a;A.setValue(wb.a.Mlc,h.mediaType);A.setValue(wb.a.vWa,h.url);A.setValue(pd.a.loopComponentType,h.loopType);A.P6a=h.P6a;A.Cv=h.Cv;A.providerName=r;A.creationTime=Date.now();A.Bab=1===h.mediaType;A.createMode=h.g$i;vd.a.Za(b).Vf(A,2);$k.Ybd(A);return A}static IXd(b,h){return h?b:$k.qJf(b)}static qJf(b){const h=Gd.ParagraphReader.text(b.node),r=vd.a.Za(b.node);if(r.Kd()){b=wc.a.Tc(b.node,b.cpEnd);
Bb.OutlineElementNavigator.je(r);const A=$k.gg.Vsa(r);$k.gg.xca(r,A,b,!0,!0,!0,!0);""!=h&&$k.gg.SA(r,!1,!0);r.Zd();return wc.a.Tc(r.currentNode,0)}return null}static fyg(b){b=vd.a.Za(b);b.vb(11)&&(b.ld(11),b.Kd()&&b.Gk()&&b.Zd()&&Gd.ParagraphReader.Vb(b.currentNode)&&(b=sc.SelectionFactory.ue(b.currentNode,0),gg.a.instance.Kc(b)))}static sIf(b,h){const r=!I.a.aaa(h);switch(b){case 1:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;
break;default:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}static ariaNotify(b,h){$k.Cw&&(b=$k.sIf(b,h),$k.Cw.sendNotification(b,!0))}static Wne(b,h,r,A=""){v.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");ca.a.sendTelemetryEvent(Object.assign(new la.a,{name:r,dataFields:[Object.assign(new ia.a,
{name:b,bool:h}),Object.assign(new ia.a,{name:"ProviderName",string:A})]}))}}Object(u.a)($k,"ExternalContentHelper",null,[]);var iA=d(738);class QB{constructor(){this.Hm=this.tt=null}b_d(b,h,r){b.Jj().wg.xF(()=>{this.Tkg(h,b,r)},()=>{v.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}Tkg(b,h,r){if(b=this.BLf(b,h))h=Array(1),h[0]=b,r=gF.a.construct(h,r,y.AFrameworkApplication.J.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.tt.yq:
null),b=this.stf(),this.Ixb(b,r)}BLf(b,h){if(!h)return v.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.tt=h.Jj();(new vd.a).set(h);if(!h.anchor||!h.anchor.gr||!h.anchor.gr.at)return v.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var r=h.anchor.gr.at.node;if(!r)return v.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),
null;r=r.ka(fd.a.YJ,Ml.a.Hu);const A=h.getValue(He.a.oF),M=Ah.a.xf(Uc.ImageReader.zF(h.properties),0),aa=Ah.a.xf(Uc.ImageReader.tL(h.properties),1);return LH.a.construct(h.id.toString(),b,h.ka(He.a.imageAltText,""),M,aa,h.ka(Mc.a.O_,""),r,h.ka(Mc.a.kX,0),h.ka(Mc.a.Kla,!1),h.ka(fd.a.rka,-1),h.ka(Mc.a.kub,Box4Intl.Box4Strings.l_Picture),h.ka(He.a.TBa,!1),A,h.ka(Mc.a.runId,1),h.ka(Mc.a.Yc,0))}Ixb(b,h){y.AFrameworkApplication.Ee.Wj(b,2,H.c(h),{},!1,2,this.vgd.bind(this),this.ktc.bind(this),null,void 0,
void 0,void 0,void 0,"26");v.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}vgd(){v.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")}ktc(){v.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")}stf(){let b=$a.a.X0c("PicturePaste.ashx");const h=wm.a.yWa;y.AFrameworkApplication.J&&!y.AFrameworkApplication.J.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=$a.a.Bp(b,Uj.a.fileId,this.tt.yq));
b=$a.a.Bp(b,Uj.a.cellId,this.tt.ml.toString());this.Hm||(this.Hm=kb.a.create(),v.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=$a.a.Bp(b,Uj.a.f_,this.Hm.toString());b=$a.a.Bp(b,Uj.a.classId,h.toString());this.tt.NG&&(b=$a.a.Bp(b,Uj.a.NG,this.tt.NG));b=$a.a.Bp(b,Uj.a.tAb,"1");b=$a.a.Bp(b,Pi.a.imageType,wk.other.toString());b=tm.a.instance.Cef(b);b=$a.a.Bp(b,Uj.a.dza,this.tt.wg.kr.toString());b=$a.a.Bp(b,Uj.a.$sc,"0");return b=$a.a.Bp(b,Uj.a.v2b,
"1")}}Object(u.a)(QB,"ExternalContentThumbnailHelper",null,[]);class Xv extends QB{constructor(){super(...arguments);this.Vo=null}static get Ff(){return null!=Xv.CUg?Xv.CUg:Xv.CUg=Za.a.instance.resolve(637)}H9j(b,h,r){return $k.AXa(h)?$k.kmf(b,r)?!0:(Xv.Ff.eU(this.Vo,2,"URL inserted in Non-Embedable context",Xv.Ff.So()),!1):(v.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),Xv.Ff.eU(this.Vo,2,"URL inserted is not valid for ExternalContent",
Xv.Ff.So()),!1)}}Object(u.a)(Xv,"AbstractExternalContentEditor",QB,[362]);var eK=d(1128),kD=d(1121);class hs extends Xv{constructor(b){super();hs.DRa=b;this.w4f()}w4f(){kD.a.w4f(hs.DRa.tvi())}static get nl(){return null!=hs.j1g?hs.j1g:hs.j1g=Za.a.instance.resolve(348)}xDl(b,h){h=this.lAi(b,h);this.bRi(h,b,5)}DWa(b,h,r){if(this.H9j(b,h,r)){var A=this.lAi(b,null);A.url=h;this.bRi(A,b,r?0:2)}}Voe(b,h){this.DWa(b,h,!1)}bRi(b,h,r){this.Hm=kb.a.create();const A=new Rb.GraphTransaction(15);A.Bb(h.node);
A.Ii=Fc.a.l7m;const M=$k.nlc(h),aa=Vv.q(b.mediaType),oa=$k.I7d(b.height,b.width,b.title,aa);h=this.ytp(h,1==r);(h=$k.Dk.cbe(h,oa))?(h=h.node,$k.Zae(h,{url:b.url,mediaType:aa,Cv:b.title,loopType:b.type,g$i:r},void 0)||v.ULS.sendTraceTag(538817433,324,50,"insertFluidComponentCore: Iframe node is null"),A.TLa(this.Hm,1),A.dispose(),this.b_d(h,b.thumbnail,!1),this.qao(M,aa,b.type)):v.ULS.sendTraceTag(538817432,324,50,"insertFluidComponentCore: insertPictureResult is null")}ytp(b,h){$k.Fg.Ve(b,"");return $k.IXd(b,
h)}qao(b,h,r){$k.Wne("IsHyperlinkWithNonURLDisplayText",b,"Office.Word.Online.ExternalContent.FluidComponent");$k.ariaNotify(h,this.Ofm(r))}Ofm(b){switch(b){case iA.a.CheckList:return"Checklist Component";case iA.a.TaskAssignment:return"Task List Component";case iA.a.Poll:return"Poll Component";default:return"Fluid Component"}}lAi(b,h){const r=new MH;r.width=$k.l4.igc(b.node)||0;Vv.j()?r.height=null!=hs.DRa&&hs.DRa.qvi(h)||$k.l4.v7a(b.node)||0:r.height=null!=hs.DRa&&hs.DRa.qvi(h)+2*hz.a.p6||$k.l4.v7a(b.node)||
0;r.title="Fluid Component";r.mediaType="fluid";r.type=h;r.thumbnail=this.Cqm();r.url=null!=hs.DRa&&hs.DRa.PHf();return r}Cqm(){return hs.DRa.tvi()}static x8c(b){y.AFrameworkApplication.vd("2cejb611;b0jjh576");return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=hs.DRa&&hs.DRa.d1i(b)&&eK.a.Pnl(b)}}Object(u.a)(hs,"FluidComponentEditor",Xv,[]);class Yv{get s2l(){return null!=this.tUg?this.tUg:this.tUg=Za.a.instance.resolve(1022)}get Q2d(){return null!=
this.NVg?this.NVg:this.NVg=Za.a.instance.resolve(1023)}kao(b,h){b&&(hs.x8c(h)?this.Q2d.DWa(b,h,!0):this.s2l.DWa(b,h,!0))}}Object(u.a)(Yv,"PostHyperlinkAutoCorrectStrategy",null,[467]);class qy{Tdc(b,h){h(qy.vao.test(b))}Wuc(b,h){b.startsWith("https")||(b=b.replace("http","https"));b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen='' sandbox='allow-scripts allow-same-origin'></iframe>",
960,960,b);b=Object.assign(new xx,{OperationId:0,StatusCode:0,MediaType:"rich",Height:960,Width:960,Thumbnail:qy.thumbnailUrl,Title:"Power BI",IFrameHtml:b});h(b)}}qy.vao=RegExp("^https?:\\/\\/(app|msit).powerbi.com\\/view\\?r=[^\\/]+$","i");qy.thumbnailUrl="https://www.onenote.com/Images/oembed_powerbi_defaultthumbnail.png";Object(u.a)(qy,"PowerBIURLResolver",null,[466,374]);class Gu{constructor(b){this.lIh=b}Tdc(b,h){let r=!1;try{if(Gu.kpn(b)){const A=this.lIh.Zjc(b);r=null!=A.width&&null!=A.height&&
!!A.thumbnailUrl&&!!A.title&&null!=A.tva}}catch(A){}h(r)}Wuc(b,h){var r=this.lIh.Zjc(b);b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' style='border:none' allowfullscreen='true' allow='accelerometer; autoplay; battery; camera; clipboard-write; encrypted-media; fullscreen; gyroscope; picture-in-picture; sync-xhr; wake-lock; screen-wake-lock; web-share' sandbox='allow-downloads allow-forms allow-modals allow-pointer-lock allow-popups allow-presentation allow-scripts allow-same-origin'></iframe>",
r.width,r.height,b);r=Object.assign(new xx,{Height:r.height,IFrameHtml:b,MediaType:"rich",OperationId:0,StatusCode:0,Thumbnail:r.thumbnailUrl,Title:r.title,Width:r.width});h(r)}static kpn(b){for(const h of Gu.dcp)if(b.startsWith(h))return!0;return!1}static kaa(){return new Gu(Za.a.instance.resolve(1021))}}Gu.dcp=["https://wedge.wedge:9090/","https://wedgecomponents.azurewebsites.net/"];Object(u.a)(Gu,"WedgeComponentExperimentsURLResolver",null,[466,374]);var hF=d(873);let iF=!1;class ov{static z4o(b){ov.sYi||
ov.addEventListener();const h=Za.a.instance.Ra(2);h&&h.execute(r=>{r.logActivity(b,null)})}static addEventListener(){window.addEventListener(ov.Mcp,ov.Lcp,!0);ov.sYi=!0}static pql(){const b=window.document.getElementById("LoopComponent");null===b||void 0===b?void 0:b.click();iF=!0}}ov.QDn="LoopHomeTabFlightActivity";ov.Mcp="switchToInsertTabAndClickLoopButtonEvent";ov.sYi=!1;ov.Lcp=()=>{var b,h;appChrome.api.dispatch(appChrome.actions.setCurrentTab("Insert"));const r=null===(b=y.AFrameworkApplication.J)||
void 0===b?void 0:b.ic("WordLoopsTUIButtonDropdownDelayInMs",50);b=new xc.a(0,1,r,()=>{ov.pql()});null===(h=y.AFrameworkApplication.oc)||void 0===h?void 0:h.Zb(b)};Object(u.a)(ov,"FluidComponentsTUIHelper",null,[]);class NH{constructor(b,h,r){this.ga=b;this.Utk=h;this.xl=r;this.doh=!1;this.Esh=1E3;this.Fsh=15E3;this.V7e=this.M7e=!0;this.V7e=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowLoopComponentSurveyEnabled",!1);this.Esh=!!y.AFrameworkApplication.J&&
y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.LoopComponentDropdownFocusTime",1E3);this.Fsh=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.NotUseLoopComponentSurveyTriggerTime",15E3)}Xb(){this.ga.fb(Fc.a.gRi,lc.a.Xc,this.K7m.bind(this),1028);this.ga.fb(Fc.a.ype,lc.a.Xc,this.ype.bind(this),1028);this.ga.fb(Fc.a.m7c,lc.a.Xc,this.KUf.bind(this),1028);this.ga.fb(Fc.a.$6c,lc.a.Xc,this.KUf.bind(this),1028);this.ga.fb(Fc.a.gbe,
lc.a.Xc,this.KUf.bind(this),1028);this.ga.fb(Fc.a.Y4i,lc.a.Xc,this.Yek.bind(this),1028)}K7m(){return 32}ype(b,h,r){if(2!==r)return 32;this.V7e&&(this.yBj(),this.Ikp());return 32}KUf(b,h,r){var A,M;if(1===r){if(!this.dde(b)||!hF.a.RWi())return v.ULS.sendTraceTag(508937180,324,50,"Loops feature is disabled as it is not supported"),2;if(!h.Al||!ze.a.pf(h)||(null===(A=this.xl)||void 0===A?0:A.q2(h))||(null===(M=this.xl)||void 0===M?0:M.Nla(h)))return 2;if(h&&h.node&&hA.a(h.node))return 32}else if(2===
r)return this.Utk.xDl(h,NH.Aqm(b)),this.yBj(),32;return 2}Ikp(){if(null!=hb.a.instance.getItem("LoopComponentSurveyShowed")||iF)this.M7e=!1;if(this.M7e){let b=this.kAi();window.setTimeout(()=>{b&&"hidden"!==b.visibility&&(this.doh=!0)},this.Esh);this.oIk=window.setTimeout(()=>{const h=Za.a.instance.Ra(2);this.doh&&h&&h.execute(r=>{(b=this.kAi())&&"hidden"===b.visibility&&!iF&&(v.ULS.sendTraceTag(508941015,324,50,"Triggering not use loop component survey"),r.ieb("WordLoopFeedbackSurvey",null),this.M7e=
!1,hb.a.instance.setItem("LoopComponentSurveyShowed","true"))})},this.Fsh)}}kAi(){var b,h;let r=null;try{const A=document.getElementById("Ribbon-LoopComponentDropdown");A&&(r=Co.a.QB(null===(h=null===(b=A.parentNode)||void 0===b?void 0:b.parentNode)||void 0===h?void 0:h.parentNode))}catch(A){v.ULS.sendTraceTag(508941014,324,10,"Loop component dropdown get parent and parent get exception "+(null!=A?A.toString():""))}return r}yBj(){this.V7e&&window.clearTimeout(this.oIk)}dde(b){return b===Fc.a.$6c||
b===Fc.a.m7c?eK.a.dde():!0}Yek(b,h,r){2===r&&I.a.yX("https://go.microsoft.com/fwlink/?linkid=2194838")&&df.a.svg.Szc("https://go.microsoft.com/fwlink/?linkid=2194838");return 32}static Aqm(b){switch(b){case Fc.a.m7c:return iA.a.TaskAssignment;case Fc.a.$6c:return iA.a.CheckList;case Fc.a.gbe:return iA.a.Poll;default:return null}}}Object(u.a)(NH,"FluidComponentsActor",null,[]);class wj extends Xv{constructor(){super();this.UTb=this.TTb=null;this.pBf=new iD.ExternalContentEmbedRetriever;this.wGc=null;
null!=wj.dsa&&wj.dsa.Lui()}Nwj(){this.Vo=N.a.create();wj.Ff.kMb(this.Vo,4);wj.Ff.i8(this.Vo,0,wj.Ff.So());this.ORb(this.TTb,3,this.UTb,!0)}DWa(b,h,r){this.Vo=N.a.create();wj.Ff.kMb(this.Vo,r?0:2);wj.Ff.i8(this.Vo,0,wj.Ff.So());this.wGc();this.ORb(b,r?0:2,h)}Voe(b,h){this.Vo=N.a.create();wj.Ff.kMb(this.Vo,1);wj.Ff.i8(this.Vo,0,wj.Ff.So());this.ORb(b,1,h)}Hyj(b){this.wGc=b}NHe(b,h){const r=wj.l4.igc(h)||0;h=wj.l4.v7a(h)||0;const A=b.Width/b.Height;1<=A?(b.Width=r,b.Height=r/A):(b.Height=h,b.Width=h/
A)}TPg(b,h,r){if(null!=b&&null!=h&&!I.a.Tf(r)){var A=wj.Jdd.Zjc(r);y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoTitleOnInsertionWithDialog",!1)?A.tva=!1:A.tva=!0;A.hideFloatie=!0;this.NHe(b,h.node);this.nmc(b,h,!1,!1,A,r)}}Rqb(b){return b?b.Ie:0}MMg(b,h,r){let A=null;const M=b.node;if(!Gd.ParagraphReader.Vb(M)||!M.isConnected)return{returnValue:!1,Zva:A};if(r)return{returnValue:!0,Zva:b};r=b.cpBegin;const aa=b.cpEnd,oa=Gd.ParagraphReader.text(M);
if(0<=r&&aa<=oa.length&&oa.substring(r,aa)===h)return{returnValue:!0,Zva:b};const Ja=oa.indexOf(h);return 0<=Ja?(A=wc.a.createTextRange(M,Ja,Ja+h.length),{returnValue:!0,Zva:A}):0<=r&&aa<=oa.length&&$k.nlc(b)?{returnValue:!0,Zva:b}:{returnValue:!1,Zva:A}}M0f(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}cfb(b,h){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$(h)&&window.setTimeout(()=>{const r=Za.a.instance.Ra(2);r&&r.execute(A=>{A.logActivity(b,
h)})},wj.Xza)}ORb(b,h,r,A=!1){if(this.H9j(b,r,!h)){var M=wj.Jdd.Zjc(r);M&&(this.M0f(M)?(v.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent"),this.Okg(b,h,M,r,A)):(v.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),wj.Ff.eU(this.Vo,2,"Size provided is not valid for OEmbed",wj.Ff.So())))}}Okg(b,h,r,A,M){const aa=!h,oa=1===h,Ja=wj.l4.igc(b.node)||0,fb=wj.l4.v7a(b.node)||0,Cb=KH.a.iqf(r.fMg,!0,Ja,fb);this.tbd(b,
A,h,!0);this.pBf.M_h(Cb,Gb=>{wj.Ff.i8(this.Vo,4,wj.Ff.So());wj.Ff.Tmd(this.Vo,this.Rqb(Gb.data));if(Gb=this.Vkg(Gb)){v.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var Sb=Vv.q(Gb.MediaType);wj.Ff.tse(this.Vo,7,Sb);Sb=b;({Zva:Sb}=this.MMg(b,A,oa)).returnValue?(this.tbd(Sb,A,h,!1),null==r.width?0<Ja&&Gb.Width>Ja&&(v.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),
Gb.Width=Ja):(v.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Gb.Width=this.ktd(r.width,Gb.Width,Ja)),null==r.height?0<fb&&Gb.Height>fb&&(v.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Gb.Height=fb):(v.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),Gb.Height=this.ktd(r.height,Gb.Height,
fb)),wj.dsa.bhb||M?this.nmc(Gb,Sb,aa,oa,r,A):(this.TTb=b,this.UTb=A,this.MWc(A))):(v.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),wj.Ff.eU(this.Vo,2,"No conversion as the context is no longer valid for the external content conversion",wj.Ff.So()));oa&&this.y6a(Sb.node)}else oa&&this.y6a(b.node),wj.Ff.eU(this.Vo,1,"URL not oEmbedable",wj.Ff.So())},Gb=>{wj.Ff.i8(this.Vo,4,wj.Ff.So());wj.Ff.Tmd(this.Vo,
this.Rqb(Gb.data));oa&&this.y6a(b.node);v.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Gb.data.De);wj.Ff.eU(this.Vo,2,"ExternalContentEmbedRequest failed",wj.Ff.So())},Gb=>{oa&&this.y6a(b.node);v.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Gb)},this.Vo)}ktd(b,h,r){!b&&0<r&&h>r||b>r?(v.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),h=r):b>r?
h=r:b&&b<r&&(h=b);return h}nmc(b,h,r,A,M,aa){this.Hm=kb.a.create();b.Width=b.Width/b.Height*(b.Height-(hz.a.v5c+hz.a.p6))+2*hz.a.p6;const oa=new Rb.GraphTransaction(15);oa.Bb(h.node);oa.Ii=Fc.a.DWa;const Ja=$k.nlc(h);null!=M.tva&&!M.tva||A||Ja||(b.Title=""===M.title||M.title?M.title:b.Title,!b.Title&&""!==b.Title)||(h=this.ZUf(h,oa,b.Title,aa,r));if(h){A&&(h=this.pvf(h));var fb=$k.IXd(h,A);if(fb){r=Vv.q(b.MediaType);var Cb=$k.I7d(b.Height,b.Width,b.Title,r);(fb=this.GUf(fb,Cb,A,{url:aa,P6a:b.IFrameHtml,
Cv:b.Title,mediaType:r},b.ProviderName))?(oa.TLa(this.Hm,1),oa.dispose(),this.TTb=h,this.UTb=aa,this.ohg(M,b,fb),this.Bkg(aa,A||M.hideFloatie,Ja,r,b.Title,b.ProviderName)):oa.dispose()}else oa.dispose(),v.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),wj.Ff.eU(this.Vo,2,"Could not create IP context on splitting the paragraph",wj.Ff.So())}else wj.Ff.eU(this.Vo,2,"GraphNodeContext is null",wj.Ff.So())}GUf(b,h,r,A,M){if(!b)return null;
b=wj.DR.cbe(b,h);if(!b)return v.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),wj.Ff.eU(this.Vo,2,"The anchored image could not be inserted",wj.Ff.So()),null;b=b.node;A=$k.Zae(b,A,M);wj.Ff.cLg(this.Vo,A.id);r||$k.fyg(b);return b}ohg(b,h,r){I.a.aaa(b.thumbnailUrl)||(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(wj.Ff.i8(this.Vo,8,wj.Ff.So()),v.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),
this.b_d(r,h.Thumbnail,!1))}Bkg(b,h,r,A,M,aa){h||this.MWc(b);this.cfb("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");$k.Wne("IsHyperlinkWithNonURLDisplayText",r,"Office.Word.Online.ExternalContent.OEmbedInsertions",aa);$k.ariaNotify(A,M);wj.Ff.i8(this.Vo,5,wj.Ff.So())}ZUf(b,h,r,A,M){if(M){if((M=Nc.a.KA(b,!1))&&1!==M.length)return h.dispose(),v.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;$k.Jp.cV(M[0].paragraph,
M[0].hyperlink)}return this.Jsg(b,r,A)}pvf(b){const h=b.node,r=Gd.ParagraphReader.text(h);return 0<r.length&&!r.trim().length?(b=wc.a.createTextRange(h,0,r.length),$k.Fg.Ve(b,""),wc.a.Tc(h,0)):b}Vkg(b){if(!({group:b}=tk.a.z4(b.data.De)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}Jsg(b,h,r){const A=b.cpBegin+h.length;$k.Fg.Ve(b,h);b=wc.a.createTextRange(b.node,b.cpBegin,A);$k.Jp.qF(b,r,!1);return b}y6a(b){b.ctc=null}tbd(b,h,r,A){const M=b.cpBegin,aa=b.cpEnd;b=Gd.ParagraphReader.text(b.node).trim();
M||b!==h&&""!==b?M?aa===b.length?v.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Wv[r],A):0<M&&aa<b.length&&v.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Wv[r],A):v.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
Wv[r],A):v.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",Wv[r],A)}MWc(b){this.pgc();const h=new Wt.a(1,y.AFrameworkApplication.isRtl);h.ggd=b;wj.gpb.Hid(h)}pgc(){const b=new gx.a(!0);wj.Qba.cNa(b)}static get gpb(){return null!=wj.vUg?wj.vUg:wj.vUg=Za.a.instance.resolve(211)}static get dsa(){wj.TFa||(wj.TFa=Za.a.instance.resolve(1018));return wj.TFa}static get Qba(){return null!=
wj.G1g?wj.G1g:wj.G1g=Za.a.instance.resolve(258)}static get l4(){return null!=wj.P2g?wj.P2g:wj.P2g=Za.a.instance.resolve(1019)}static get DR(){return null!=wj.oXg?wj.oXg:wj.oXg=Za.a.instance.resolve(1020)}static get Jdd(){return null!=wj.n0g?wj.n0g:wj.n0g=Za.a.instance.resolve(1021)}}wj.Xza=5E3;wj.TFa=null;Object(u.a)(wj,"ExternalContentEditorV2",Xv,[]);class yx{constructor(){this.Bd=this.W=null}get name(){return"WordEditor.ExternalContent"}get sc(){return this.Bd?this.Bd:this.Bd=this.W.resolve(12)}uc(b){var h;
this.W=b;b.ia("WordEditor.ExternalContent.ExternalContentSizeBehavior",()=>new NB.a(br.a.instance,Rx.WordSectionNavigator.instance)).as(1019).ha();b.ia("WordEditor.ExternalContent.PostHyperlinkAutoCorrectStrategy",()=>new Yv).as(815).ha();b.ia("WordEditor.ExternalContent.ExternalContentSettingInfo",()=>new jD(b.resolve(217),b.resolve(218))).as(1018).ha();y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)?(b.ia("WordEditor.ExternalContent.ExternalContentEditorV2",
()=>new wj).as(1022).ha(),b.ia(1023,()=>new hs(b.resolve(644))).ha(),b.ia(1024,()=>new NH(y.AFrameworkApplication.va,b.resolve(1023),re.a.instance)).ha(),(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsHomeTUIEnabled",!1))&&ov.z4o(ov.QDn)):b.ia("WordEditor.ExternalContent.ExternalContentEditor",()=>new oh).as(1022).ha()}init(){this.sc.us.continueWith(()=>{this.Fo()});y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1)&&this.W.resolve(1024).Xb()}dispose(){}oDl(){const b=new JH;this.aii()&&b.XMh(Gu.kaa());b.XMh(new qy);return b}Fo(){null==y.AFrameworkApplication.J||y.AFrameworkApplication.J.$("IOEmbedOverridesURLParserCrashFixIsEnabled")||this.W.ia("WordEditor.ExternalContent.OEmbedQueryParamsOverridesURLParser",()=>new Br.a).as(1021).ha();this.aii()&&(this.W.ia(488,()=>this.oDl()).as(488).ha(),this.W.resolve(488))}aii(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableInnerRingWEdgeExperimentsOEmbedURLResolver",
!1)}static main(){K.a.instance.Lc(new yx)}}Object(u.a)(yx,"ExternalContentPackage",null,[0,1]);var Hu;(function(b){b[b.invalid=-1]="invalid";b[b.clear=0]="clear";b[b.left=1]="left";b[b.start=2]="start";b[b.center=3]="center";b[b.right=4]="right";b[b.end=5]="end";b[b.Quf=6]="decimal";b[b.TQp=7]="bar";b[b.Zub=8]="num"})(Hu||(Hu={}));Object(u.b)("TabStopValues",Hu);class Yo{}Yo.Xbi=8;Yo.IMl=1;Yo.yaa="wwaengidc";Yo.kpiName="WordRuler";Yo.precision=.0625;Yo.Sdp=1;Yo.Lzp="ShowHideRuler";Object(u.a)(Yo,
"Constants",null,[]);var RB=d(1037);class vr{static qkc(b,h){if(!vr.X9c)return null;switch(b){case "Left":return r=>{const A=r.rulerCanvasProps;r=r.indents;return{eUb:0,yZb:A.scale-(A.margins[1].value+r[2].value+Math.max(r[0].value,r[1].value)+8*A.precision)}};case "Right":return r=>{const A=r.rulerCanvasProps;r=r.indents;return{eUb:0,yZb:A.scale-(r[2].value+(A.margins[0].value+Math.max(r[0].value,r[1].value))+8*A.precision)}};case "MoveTableColumn":return()=>{let r=0,A=0;if(0===h){var M={};32===
vr.Rb.Pb(ub.a.duc,2,M)&&(r=Jg.a.iB(M.MinIndent),A=Jg.a.iB(M.MaxIndent))}else M={gp:h-1},32===vr.Rb.Pb(ub.a.buc,2,M)&&(r=Jg.a.iB(M.MinResize),A=Jg.a.iB(M.MaxResize));return{eUb:r,yZb:A}};case "Top":return r=>{r=r.rulerCanvasProps;return{eUb:0,yZb:r.scale-(r.margins[1].value+8*r.precision)}};case "Bottom":return r=>{r=r.rulerCanvasProps;return{eUb:0,yZb:r.scale-(r.margins[0].value+8*r.precision)}}}return null}static W7d(b){if(!vr.X9c)return null;switch(b){case "FirstLineIndent":case "HangingIndent":case "LeftIndent":return h=>
{var r=h.rulerCanvasProps,A=h.indents,M=h.ipContextIndex;h=r.margins;var aa=r.scale;r=r.precision;if("MoveTableColumn"!==h[0].type){M=h[0].value;h=h[1].value+A[2].value;var oa=M;"LeftIndent"===b&&(oa+=Math.max(A[0].value,A[1].value));A=-1*M;r=aa-(oa+h+8*r)}else{aa=0;for(oa=0;oa<=M;oa++)aa+=h[oa].value;oa=0;if("LeftIndent"===b){oa=A[0].value;const Ja=A[1].value;aa+=Math.max(oa,Ja);oa=Math.max(oa,Ja)}h=h[M+1].value;oa+=A[2].value;A=-1*aa;r=h-oa-r}return{eUb:A,yZb:r}};case "RightIndent":return h=>{var r=
h.rulerCanvasProps,A=h.indents,M=h.ipContextIndex,aa=r.margins;h=r.scale;r=r.precision;if("MoveTableColumn"!==aa[0].type){var oa=aa[0].value;aa=aa[1].value;M=A[0].value;var Ja=A[1].value;A=-1*aa;h-=oa+aa+Math.max(M,Ja)+8*r}else{oa=0;for(Ja=0;Ja<=M;Ja++)oa+=aa[Ja].value;aa=aa[M+1].value;M=A[0].value;Ja=A[1].value;A=-1*(h-oa-aa);h=aa-Math.max(M,Ja)-r}return{eUb:A,yZb:h}}}return null}static EGm(){return b=>{var h=b.rulerCanvasProps,r=b.indents,A=b.ipContextIndex,M=h.margins;b=h.precision;h=h.scale;"MoveTableColumn"!==
M[0].type?(A=M[0].value,M=M[1].value+r[2].value,r=Math.min(r[0].value,r[1].value)+b,b=h-(A+M+b)):(h=r[2].value,M=M[A+1].value,r=Math.min(r[0].value,r[1].value)+b,b=M-(h+b));return{eUb:r,yZb:b}}}static get Rb(){return null!=vr.dSg?vr.dSg:vr.dSg=y.AFrameworkApplication.va}static get X9c(){null==this.Vib&&(y.AFrameworkApplication.cga("WoRul910;WoRul910cf"),this.Vib=y.AFrameworkApplication.J?y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RulerPropertyBoundaryIsEnabled",!1):
!1);return this.Vib}}vr.Vib=null;Object(u.a)(vr,"RulerPropertyBoundaryHelper",null,[]);var xL=d(917),jF=d(1351),jA=d(1033),yL=d(1186),pv=d(1187);class Hs{constructor(b,h,r,A,M,aa,oa){this.C3n="OutlineContainer";this.pPk="UpdateCustomTabFailed";this.dHb="ReadRulerPropertiesFailed";this.tPk="UpdateIndentFailed";this.$Hh="UpdateMarginFailed";this.Ome=Ja=>{(Ja.button===Sys.UI.MouseButton.rightButton||this.tnn&&Ja.button===Sys.UI.MouseButton.leftButton)&&this.l6e.show(new Sys.UI.Point(Ja.clientX,Ja.clientY),
2)};this.p7j=()=>{this.p0a()};this.Xn=b;this.W8b=h;this.ga=r;this.l6e=A;this.pA=M;this.jG=aa;this.f6b=null;this.IK=oa;this.Rx=!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.m3;this.Fkj=this.yme.bind(this);this.Dnj=this.nv.bind(this);this.o7j=this.p0a.bind(this)}zE(){this.mef();this.cNh();this.W8b.Ll.jf(10).jo(this.Fkj);mf.a.addHandler(this.Kbf,Jd.a.scroll,this.p7j);this.Xn.execute(h=>{h.YX(this.Dnj)});const b=[this.nLf(),document.getElementById(vi.a.OAc),document.getElementById("PageContentContainer")];
this.wqg(b);qa.StaticActiveAppFrame.za().NK.registerBoundingWindowRectsChanged("documentPanel",(h,r)=>{"undefined"!==r&&this.tfb([1,0])})}wqg(b){this.f6b?this.f6b.register(b,this.o7j):jA.a(jF.a.J3k,()=>{appChrome.getResizeObserver().then(h=>{this.f6b=h.createResizeObserver();this.f6b.register(b,this.o7j);return null})})}nLf(){var b;return 0===this.jG.Kw?this.Zwh:(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.isRulerPositionFixEnabled",!1))?
this.uxh:this.vxh}get Kbf(){return document.getElementById(vi.a.E0a)}get Zwh(){const b=document.getElementsByClassName(this.C3n);return b&&0<b.length?b[0]:null}get vxh(){var b=this.pA.nOb;if(!b)return null;b=this.LJo(Gd.ParagraphReader.nU(b));return xL.a.eCi(b)}get ZRa(){return this.IK.value}get uxh(){return this.ZRa.Be(this.ZRa.od).dS}LJo(b){return 0<b?document.querySelector("div.PagesContainer p[paraid='"+b+"']"):null}get pQ(){return this.Xn&&this.Xn.instance?this.Xn.instance.yj:Yo.IMl}Gjc(){const b=
{};return 32!==this.ga.Pb(ub.a.YMa,2,b)?(v.ULS.sendTraceTag(529065947,yL.a.jMn,pv.a.ot,"Unable to read page properties for Ruler"),Pl.recordQosError(this.dHb,[Pl.$ia],"Unable to read page properties for Ruler"),null):b}dispose(){this.eNi();this.W8b.Ll.jf(10).JP(this.Fkj);mf.a.removeHandler(this.Kbf,Jd.a.scroll,this.p7j);this.Xn.execute(b=>{b.nNa(this.Dnj)});this.f6b&&this.f6b.dispose();qa.StaticActiveAppFrame.za().NK.unregisterBoundingWindowRectsChanged("documentPanel",(b,h)=>{"undefined"!==h&&this.tfb([1,
0])})}get RYi(){null==Hs.FWe&&(Hs.FWe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("SharedUXThemingIsEnabled")&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&y.AFrameworkApplication.J.$("RulerThemingIsEnabled"):!1);return Hs.FWe}get tnn(){null==Hs.nXe&&(Hs.nXe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableRulerContextMenuOnLeftClick",!1):!1);return Hs.nXe}}Hs.FWe=null;
Hs.nXe=null;Object(u.a)(Hs,"ARuler",null,[316]);var fK=d(296);class Lp extends Hs{constructor(b,h,r,A,M,aa,oa,Ja){super(b,h,r,M,aa,oa,Ja);this.MR="HorizontalRuler";this.Uck="CustomTabModificationFromRuler";this.Aek="IndentModificationFromRuler";this.WGe="MarginModificationFromRuler";this.bkh=this.akh=this._tabStops=null;this.TTn=(fb,Cb,Gb)=>{if(!(fb>=this._tabStops.length)){fb=this._tabStops[fb];var Sb="Modify"===Gb?this.ga.Pb(Fc.a.Sqc,2,{["tabStop"]:fb,["value"]:Jg.a.gD(Cb)}):this.ga.Pb(Fc.a.Wcb,
2,fb);if(32===Sb){Cb=1;var pc=String.format("Custom tab modified using ruler. Operation: {0}. CustomTab: {1}",Gb,Hu[fb.xha]);v.ULS.sendTraceTag(591213271,3014,50,pc)}else Cb=0,pc=String.format("Unable to modify custom tab using ruler. Operation: {0}. CustomTab: {1}",Gb,Hu[fb.xha]),v.ULS.sendTraceTag(591213272,3014,15,pc),Pl.recordQosError(this.pPk,[Pl.$ia],"Unable to modify custom tab using ruler");ac.a(this.Uck,32===Sb,void 0,[Object.assign(new ia.a,{name:"Operation",string:Gb}),Object.assign(new ia.a,
{name:"TabType",int64:Hu[fb.xha]})]);Gb=new Map;Gb.set("Command","OnCustomTabChange");Gb.set("Source",this.MR);Gb.set("Response",pc);Ba.Health.instance.recordKpiUsage(Yo.kpiName,Cb,Yo.yaa,Gb)}};this.hWn=(fb,Cb)=>{var Gb=new RB.a;Gb.unit=1;Gb.value=Jg.a.gD(Cb);Cb=8;switch(fb){case "FirstLineIndent":Cb=this.ga.Pb(ub.a.Cnd,2,Gb);break;case "HangingIndent":Cb=this.ga.Pb(ub.a.Dnd,2,Gb);break;case "LeftIndent":Cb=this.ga.Pb(ub.a.h$a,2,Gb);break;case "RightIndent":Cb=this.ga.Pb(ub.a.g$a,2,Gb)}let Sb;32===
Cb?(Gb=1,Sb=String.format("Indents set using Ruler. Indent: {0}",fb),v.ULS.sendTraceTag(592517017,3014,50,Sb)):(Gb=0,Sb=String.format("Unable to set indent using Ruler. Indent: {0}",fb),v.ULS.sendTraceTag(592496523,3014,15,Sb,fb),Pl.recordQosError(this.tPk,[Pl.$ia],"Unable to set indent using Ruler."));ac.a(this.Aek,32===Cb,void 0,[Object.assign(new ia.a,{name:"Type",string:fb})]);fb=new Map;fb.set("Command","OnIndentChange");fb.set("Source",this.MR);fb.set("Response",Sb);Ba.Health.instance.recordKpiUsage(Yo.kpiName,
Gb,Yo.yaa,fb)};this.psc=(fb,Cb)=>{if(Pl.instance.Sfa)switch(Cb.jMa){case 3:case 2:case 1:this.wqg([this.uxh]);break;case 0:this.wqg([this.Zwh])}};this.Oeg=(fb,Cb,Gb)=>{let Sb;Sb="Left"===fb?this.ga.Pb(ub.a.pna,2,Jg.a.gD(Cb)):"Right"===fb?this.ga.Pb(ub.a.Odb,2,Jg.a.gD(Cb)):Gb?this.ga.Pb(ub.a.XAe,2,{["columnIndex"]:Gb-1,["width"]:Jg.a.gD(Cb)}):this.ga.Pb(ub.a.Ewc,2,Jg.a.gD(Cb));32===Sb?(Cb=1,Gb=String.format("Margins set using Ruler. Margin: {0}",fb),v.ULS.sendTraceTag(592517018,3014,50,Gb)):(Cb=0,
Gb=String.format("Unable to set margins using Ruler. Margin: {0}",fb),v.ULS.sendTraceTag(592496524,3014,15,Gb),Pl.recordQosError(this.$Hh,[Pl.$ia],"Unable to set margins using Ruler."));ac.a(this.WGe,32===Sb,void 0,[Object.assign(new ia.a,{name:"Type",string:fb})]);fb=new Map;fb.set("Command","OnMarginChange");fb.set("Source",this.MR);fb.set("Response",Gb);Ba.Health.instance.recordKpiUsage(Yo.kpiName,Cb,Yo.yaa,fb)};this.ySa=A;this.$r={}}get iX(){return this.akh}get HKa(){return this.bkh}renderRuler(){this.iX.classList.remove("HideWACHorizontalRulerContainer");
this.iX.classList.add("ShowWACHorizontalRulerContainer");var b=this.Gjc();if(b){var h=this.Oeg,r=this.hWn,A=this.TTn,M=this.Frd(),aa=this.K1j(),oa=this.J1j();M&&aa&&oa||(this.$r.disabled=!0);this.$r.onIndentChange=r;this.$r.onMarginChange=h;this.$r.onTabChange=A;this.p0a();b=Ah.a.qj(b.np,0);this.HKa.style.width=(b*this.pQ).toString()+"px";return this.ySa().then(Ja=>{Ja.renderRuler(this.HKa,this.$r)})}}static roc(){null==this.BEb&&null!=y.AFrameworkApplication.J&&(this.BEb=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.isRulerPositionFixEnabled",
!1));return this.BEb}J1j(){const b=[];var h={};if(32!==this.ga.Pb(Fc.a.SXb,2,h))return v.ULS.sendTraceTag(589651997,3014,15,"Unable to read paragraph tabs for Ruler"),Pl.recordQosError(this.dHb,[Pl.$ia],"Unable to read paragraph tabs for Ruler"),!1;var r=h.customTabs;if(!r||0>=r.length)return this.$r.tabs=b,!0;this._tabStops=r;h="";for(const A of r){switch(A.xha){case 1:h="LeftTab";break;case 4:h="RightTab";break;case 3:h="CenterTab";break;case 6:h="DecimalTab";break;case 7:h="BarTab"}r=Ah.a.bZa(A.nOa,
0);b.push({["type"]:h,["value"]:r,["getRulerPropertyBoundary"]:vr.EGm()})}this.$r.tabs=b;return!0}tfb(b){var h;if(this.iX){this.iX.classList.add("ShowWACHorizontalRulerContainer");"disabled"in this.$r&&delete this.$r.disabled;for(const r of b)switch(r){case 0:b=this.K1j();const A=this.J1j();b&&A||(this.$r.disabled=!0);break;case 1:this.Frd()||(this.$r.disabled=!0)}if(null===(h=this.pA.currentSelection)||void 0===h?0:h.w8c)this.$r.disabled=!0;this.ySa().then(r=>{r.renderRuler(this.HKa,this.$r);return null})}}Frd(){const b=
{};var h=this.Gjc();if(!h)return!1;b.scale=Jg.a.iB(h.np);b.precision=Yo.precision;b.rulerType="Horizontal";if(!this.O1n())return this.$r.ipContextIndex=0,this.$r.permittedUnits=Yo.Xbi,h=[{["type"]:"Left",["value"]:Jg.a.iB(h.marginLeft),["getRulerPropertyBoundary"]:vr.qkc("Left",0)},{["type"]:"Right",["value"]:Jg.a.iB(h.marginRight),["getRulerPropertyBoundary"]:vr.qkc("Right",1)}],b.margins=h,this.$r.rulerCanvasProps=b,!0;var r={};h={};var A=this.ga.Pb(ub.a.hid,2,r);const M=this.ga.Pb(ub.a.eYb,2,h);
if(32!==A||32!==M)return v.ULS.sendTraceTag(589651998,3014,15,"Unable to read table properties for Ruler"),Pl.recordQosError(this.dHb,[Pl.$ia],"Unable to read table properties for Ruler"),!1;r=r.ColumnWidths;A=h.TablePosition;if(!A||!r||0>=r.length)return v.ULS.sendTraceTag(589632533,3014,15,"Cannot show table properties on the ruler as they are null"),Pl.recordQosError(this.dHb,[Pl.$ia],"Cannot show table properties on the ruler as they are null"),!1;h=Array(r.length+1);h[0]={["type"]:"MoveTableColumn",
["value"]:Jg.a.iB(A.x/this.pQ),["getRulerPropertyBoundary"]:vr.qkc("MoveTableColumn",0)};for(A=0;A<r.length;A+=1)h[A+1]={["type"]:"MoveTableColumn",["value"]:Jg.a.iB(r[A]),["getRulerPropertyBoundary"]:vr.qkc("MoveTableColumn",A+1)};this.$r.ipContextIndex=this.sKm();this.$r.permittedUnits=Yo.Sdp;b.margins=h;this.$r.rulerCanvasProps=b;return!0}K1j(){var b={};if(32!==this.ga.Pb(ub.a.Kcb,2,b))return v.ULS.sendTraceTag(592496522,3014,15,"Unable to read paragraph indentation for Ruler"),Pl.recordQosError(this.dHb,
[Pl.$ia],"Unable to read paragraph indentation for Ruler"),!1;const h={type:"FirstLineIndent"};h.getRulerPropertyBoundary=vr.W7d("FirstLineIndent");const r={type:"HangingIndent"};r.getRulerPropertyBoundary=vr.W7d("HangingIndent");const A={type:"RightIndent"};A.getRulerPropertyBoundary=vr.W7d("RightIndent");const M={type:"LeftIndent"};M.getRulerPropertyBoundary=vr.W7d("LeftIndent");this.$r.rtl=b.isRtl;b=b.Du;h.value=1===b.specialIndentType?Jg.a.iB(b.oha+b.RA):2===b.specialIndentType?Jg.a.iB(b.RA-b.oha):
Jg.a.iB(b.RA);r.value=Jg.a.iB(b.RA);M.value=Jg.a.iB(b.RA);A.value=Jg.a.iB(b.Cfa);this.$r.indents=[h,r,A,M];return!0}cNh(){mf.a.addHandler(this.iX,Jd.a.az,this.Ome);Lp.roc()&&this.jG.mcc(this.psc)}eNi(){this.iX&&(this.iX.classList.remove("ShowWACHorizontalRulerContainer"),this.iX.classList.add("HideWACHorizontalRulerContainer"),mf.a.removeHandler(this.iX,Jd.a.az,this.Ome));this.ySa().then(b=>{b.dispose(this.HKa);return null});Lp.roc()&&this.jG.jte(this.psc)}nv(){this.r7j();this.p0a();this.tfb([1,0])}yme(b,
h){b=h.property;if(b===Mc.a.np||b===Mc.a.marginLeft||b===Mc.a.marginRight)this.r7j(),this.p0a(),this.tfb([1])}r7j(){var b=this.Gjc();b&&(b=Ah.a.qj(b.np,0),this.HKa.style.width=Math.round(b*this.pQ).toString()+"px")}p0a(){window.requestAnimationFrame(()=>{var b=this.nLf();b&&(b=Le.a.getElementBounds(b),y.AFrameworkApplication.isRtl?this.HKa.style.marginRight=(window.document.documentElement.clientWidth-b.x-b.width).toString()+"px":this.HKa.style.marginLeft=b.x.toString()+"px")})}sKm(){const b=vd.a.Za(this.pA.nOb);
if(b.vb(14))return b.ld(16),cr.a(b,!0);v.ULS.sendTraceTag(557110540,3014,15,"Unable to read table column index for Ruler");Pl.recordQosError(this.dHb,[Pl.$ia],"Unable to read table column index for Ruler");return 0}O1n(){let b=!0;const h=this.pA.currentSelection.WT();if(null===h)return v.ULS.sendTraceTag(557065614,3014,15,"Unable to get Context Iterator for the Ruler"),Pl.recordQosError(this.dHb,[Pl.$ia],"Unable to get Context Iterator for the Ruler"),!1;for(;h.moveNext()&&b;){const r=vd.a.Za(h.current.node);
r.Kd();b=b&&Ii.TableReader.ny(r)}return b}mef(){if(!this.HKa&&!this.iX){this.akh=document.createElement("div");this.iX.id=Lp.vwk;this.iX.className=Lp.uwk;this.iX.setAttribute(Ne.a.Aja,WordEditorIntl.WordEditorStrings.L_Ruler);this.iX.setAttribute(Ne.a.Ph,Ne.a.eTh);this.iX.classList.add("HideWACHorizontalRulerContainer");if(this.RYi){var b=y.AFrameworkApplication.J.ib("ModernUxExperimentPreferenceCookieName");const h=y.AFrameworkApplication.J.$("ModernUxExperimentDefaultOffIsEnabled");Jc.a.dfa(b,!h)&&
this.iX.classList.add(Lp.RCk)}this.bkh=document.createElement("div");this.HKa.className=Lp.twk;this.HKa.id=Lp.wwk;this.iX.appendChild(this.HKa);b=null;this.Rx&&((b=Object(fK.a)("EditorBars"))&&b.appendChild(this.iX),this.iX.classList.add("regionComposer"));b||(b=document.getElementById(vi.a.OAc),b.insertBefore(this.iX,b.firstChild))}}static LG(){return new Lp(Za.a.instance.Ra(6),df.a.gf,y.AFrameworkApplication.va,em.UISurfaces.REi,Za.a.instance.resolve(1025),mt.a.instance,Za.a.instance.resolve(76),
Lp.roc()?new Qf.a(()=>qa.StaticActiveAppFrame.za().kb.Jc):null)}static get instance(){return null!=Lp.JYg?Lp.JYg:Lp.JYg=Lp.LG()}}Lp.BEb=null;Lp.vwk="WACHorizontalRulerContainer";Lp.uwk="WACHorizontalRulerContainer";Lp.wwk="WACHorizontalRuler";Lp.twk="WACHorizontalRuler";Lp.RCk="ModernUxWACHorizontalRulerContainer";Object(u.a)(Lp,"HorizontalRuler",Hs,[]);var kF=d(1531);class Bl extends Hs{constructor(b,h,r,A,M,aa,oa,Ja){super(b,h,r,M,aa,oa,Ja);this.MR="VerticalRuler";this.WGe="MarginModificationFromRuler";
this.QIh=this.PIh=null;this.Oeg=(fb,Cb)=>{let Gb=8;"Top"===fb?Gb=this.ga.Pb(ub.a.Pdb,2,Jg.a.gD(Cb)):"Bottom"===fb&&(Gb=this.ga.Pb(ub.a.Ndb,2,Jg.a.gD(Cb)));let Sb;32===Gb?(Cb=1,Sb=String.format("Margins set using Ruler. Margin: {0}",fb),v.ULS.sendTraceTag(529065945,3014,50,Sb)):(Cb=0,Sb=String.format("Unable to set margins using Ruler. Margin: {0}",fb),v.ULS.sendTraceTag(529065946,3014,15,Sb),Pl.recordQosError(this.$Hh,[Pl.$ia],"Unable to set margins using Ruler."));ac.a(this.WGe,32===Gb,void 0,[Object.assign(new ia.a,
{name:"Type",string:fb})]);fb=new Map;fb.set("Command","OnMarginChange");fb.set("Source",this.MR);fb.set("Response",Sb);Ba.Health.instance.recordKpiUsage(Yo.kpiName,Cb,Yo.yaa,fb)};this.ySa=A;this.$r={}}get K4(){return this.PIh}get mPa(){return this.QIh}renderRuler(){this.K4.classList.remove("HideWACVerticalRulerContainer");this.K4.classList.add("ShowWACVerticalRulerContainer");var b=this.Gjc();if(b){var h=this.Oeg;this.Frd()||(this.$r.disabled=!0);this.$r.onMarginChange=h;this.p0a();b=Ah.a.qj(b.rw,
1);this.mPa.style.height=(b*this.pQ).toString()+"px";this.ySa().then(r=>{r.renderRuler(this.mPa,this.$r);return null})}}tfb(b){var h;if(this.K4){this.K4.classList.add("ShowWACVerticalRulerContainer");"disabled"in this.$r&&delete this.$r.disabled;for(const r of b)switch(r){case 1:this.Frd()?this.p0a():this.$r.disabled=!0}if(null===(h=this.pA.currentSelection)||void 0===h?0:h.w8c)this.$r.disabled=!0;this.ySa().then(r=>{r.renderRuler(this.mPa,this.$r);return null})}}static roc(){null==this.BEb&&null!=
y.AFrameworkApplication.J&&(this.BEb=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.isRulerPositionFixEnabled",!1));return this.BEb}Frd(){const b={},h=this.Gjc();if(!h)return!1;b.scale=Jg.a.iB(h.rw);b.precision=Yo.precision;b.rulerType="Vertical";this.$r.ipContextIndex=0;this.$r.permittedUnits=Yo.Xbi;b.margins=[{["type"]:"Top",["value"]:Jg.a.iB(h.marginTop),["getRulerPropertyBoundary"]:vr.qkc("Top",0)},{["type"]:"Bottom",["value"]:Jg.a.iB(h.marginBottom),["getRulerPropertyBoundary"]:vr.qkc("Bottom",
1)}];this.$r.rulerCanvasProps=b;return!0}cNh(){this.mef();mf.a.addHandler(this.K4,Jd.a.az,this.Ome)}eNi(){this.K4&&(this.K4.classList.remove("ShowWACVerticalRulerContainer"),this.K4.classList.add("HideWACVerticalRulerContainer"),mf.a.removeHandler(this.K4,Jd.a.az,this.Ome));this.ySa().then(b=>{b.dispose(this.mPa);return null})}nv(){this.n7j();this.p0a();this.tfb([1])}yme(b,h){b=h.property;if(b===Mc.a.rw||b===Mc.a.marginTop||b===Mc.a.marginBottom)this.n7j(),this.p0a(),this.tfb([1])}n7j(){var b=this.Gjc();
b&&(b=Ah.a.qj(b.rw,1),this.mPa.style.height=Math.round(b*this.pQ).toString()+"px")}p0a(){window.requestAnimationFrame(()=>{var b;if(b=Bl.roc()?this.vxh:this.nLf()){const h=Le.a.getElementBounds(b);this.mPa.style.height=h.height.toString()+"px";b=this.jMm(b);this.mPa.style.marginTop=b+"px"}})}jMm(b){b=b.getBoundingClientRect().y;const h=this.Kbf.getBoundingClientRect().y;return b-h}mef(){if(!this.mPa&&!this.K4){this.PIh=document.createElement("div");this.K4.id=Bl.gQk;this.K4.className=Bl.fQk;this.K4.setAttribute(Ne.a.Aja,
WordEditorIntl.WordEditorStrings.L_Ruler);this.K4.setAttribute(Ne.a.Ph,Ne.a.eTh);this.K4.classList.add("HideWACVerticalRulerContainer");if(this.RYi){var b=y.AFrameworkApplication.J.ib("ModernUxExperimentPreferenceCookieName");const h=y.AFrameworkApplication.J.$("ModernUxExperimentDefaultOffIsEnabled");Jc.a.dfa(b,!h)&&Sys.UI.DomElement.addCssClass(this.K4,Bl.SCk)}this.QIh=document.createElement("div");this.mPa.className=Bl.eQk;this.mPa.id=Bl.hQk;this.K4.appendChild(this.mPa);b=document.getElementById(vi.a.OAc);
b.insertBefore(this.K4,b.firstChild)}}static LG(){return new Bl(Za.a.instance.Ra(6),df.a.gf,y.AFrameworkApplication.va,em.UISurfaces.REi,Za.a.instance.resolve(1025),mt.a.instance,Za.a.instance.resolve(76),Bl.roc()?new Qf.a(()=>qa.StaticActiveAppFrame.za().kb.Jc):null)}static get instance(){return null!=Bl.IYg?Bl.IYg:Bl.IYg=Bl.LG()}}Bl.BEb=null;Bl.gQk="WACVerticalRulerContainer";Bl.fQk="WACVerticalRulerContainer";Bl.hQk="WACVerticalRuler";Bl.eQk="WACVerticalRuler";Bl.SCk="ModernUxWACVerticalRulerContainer";
Object(u.a)(Bl,"VerticalRuler",Hs,[]);class Pl{constructor(b,h,r,A,M,aa,oa,Ja,fb){this.DTe=this.hWe=!1;this.MR="RulerActor";this.NBh=null;this.Sfa=!1;this.pok="ClearAllTabStopsFailed";this.UDh="ShowHideRulerFailed";this.TXe=null;this.RUd=(Cb,Gb,Sb)=>{if(1===Sb)return 32;Cb=this.ga.Ob(Fc.a.SYb,2,null);32===Cb?(Sb=1,Gb=String.format("Clear all tab stops from ruler"),v.ULS.sendTraceTag(591213266,3014,50,Gb)):(Sb=0,Gb=String.format("Unable to clear all tab stop from ruler"),v.ULS.sendTraceTag(591213267,
3014,15,Gb),Pl.recordQosError(this.pok,[Pl.$ia],Gb));const pc=new Map;pc.set("Command","ClearAllTabStops");pc.set("Source",this.MR);pc.set("Response",Gb);Ba.Health.instance.recordKpiUsage(Yo.kpiName,Sb,Yo.yaa,pc);return Cb};this.c7c=(Cb,Gb,Sb)=>{if(1===Sb)switch(Cb){case Fc.a.jjf:case Fc.a.Ruf:return 2;default:return 32}Gb=this.l6e.qFm();switch(Cb){case Fc.a.R2f:var pc=1;break;case Fc.a.Uug:pc=4;break;case Fc.a.Umf:pc=3;break;default:return v.ULS.sendTraceTag(591213268,3014,15,"Tried to insert bar or decimal tab stop."),
2}Cb=new uB.a(Gb,pc,0,1);Cb=this.ga.Pb(Fc.a.Kmd,2,Cb);32===Cb?(Sb=1,Gb=String.format("Insert Custom Tab Stop from Ruler. Tab: {0}. Value: {1}",Hu[pc],Gb.toString()),v.ULS.sendTraceTag(591213269,3014,50,Gb)):(Sb=0,Gb=String.format("Unable to set custom tab stop from ruler. Tab: {0}. Value: {1}",Hu[pc],Gb.toString()),v.ULS.sendTraceTag(591213270,3014,15,Gb));pc=new Map;pc.set("Command","InsertCustomTabStopRuler");pc.set("Source",this.MR);pc.set("Response",Gb);Ba.Health.instance.recordKpiUsage(Yo.kpiName,
Sb,Yo.yaa,pc);return Cb};this.p0b=(Cb,Gb,Sb,pc,zc)=>{var Yc;if(this.hWe||1===Sb&&Xn.a.Jla(Gb.Ik))return 8;(null===(Yc=y.AFrameworkApplication.J)||void 0===Yc?0:Yc.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableRuler",!1))&&Gb.contextId!=lc.a.view&&(v.ULS.sendTraceTag(508359384,3014,15,String.format("context id: {0}",Gb.contextId)),Gb=new kw.a(qa.StaticActiveAppFrame.za().kb.Jc));return this.Sfa?this.z5c(Cb,Gb,Sb,pc,zc):this.o5o(Gb,Sb)};this.zGo=()=>{this.Sfa?v.ULS.sendTraceTag(574128526,
3014,50,"Ruler was already enabled"):(appChrome.api.dispatch(appChrome.actions.setCurrentTab("View")),32!==this.ga.Ob(ub.a.p0b,2)?(v.ULS.sendTraceTag(574128527,3014,50,"Ruler could not be enabled"),Pl.recordQosError(this.UDh,[Pl.$ia],"Ruler could not be enabled")):v.ULS.sendTraceTag(573190796,3014,50,"Ruler was enabled from teaching callout"))};this.z5c=(Cb,Gb,Sb)=>{if(1===Sb||!this.Sfa)return 32;this.Sfa=!1;this.m6e.DHj(!1);this.uib.dispose();this.Mfe()&&this.nxf();this.q7j();v.ULS.sendTraceTag(593351623,
3014,50,"Ruler is disabled");Cb=new Map;Cb.set("Command","HideRuler");Cb.set("Source",this.MR);Cb.set("Response","");Ba.Health.instance.recordKpiUsage(Yo.kpiName,1,Yo.yaa,Cb);return 32};this.nre=(Cb,Gb,Sb,pc,zc)=>{if(1===Sb)return 32;zc&&(zc[Vg.a.On]=this.Sfa);return 32};this.U2m=Cb=>{this.Sfa=Cb.result};this.YQb=()=>{this.hWe=!1};this.QMi=()=>{this.hWe=!0};this.ga=b;this.uib=h;this.wbf=r;this.z3b=A;this.l6e=M;this.m6e=aa;Pl.ql=Ja;this.aRa=oa;this.jG=fb;this.aRa.IOh(this.QMi);this.aRa.OQd(this.YQb)}initialize(){this.Xb();
this.NBh=this.zGo;window.addEventListener("TurnRulerOnAction",this.NBh,!0);return this.m6e.DGm().continueWith(this.U2m,8)}Xb(){this.ga.qa(ub.a.p0b,lc.a.view,this.p0b);this.ga.fb(ub.a.nre,lc.a.view,this.nre,96);this.ga.qa(Fc.a.jjf,lc.a.view,this.c7c);this.ga.qa(Fc.a.Umf,lc.a.view,this.c7c);this.ga.qa(Fc.a.RUd,lc.a.view,this.RUd);this.ga.qa(Fc.a.Ruf,lc.a.view,this.c7c);this.ga.qa(Fc.a.z5c,lc.a.view,this.z5c);this.ga.qa(Fc.a.R2f,lc.a.view,this.c7c);this.ga.qa(Fc.a.Uug,lc.a.view,this.c7c);kF.a.ed.addHandler(kF.a.pme,
this.hfd.bind(this));this.jG.QJb(this.psc)}rQi(){this.Sfa&&(this.uib.zE(),this.uib.renderRuler(),this.Mfe()&&this.WCj())}WCj(){this.wbf.zE();this.wbf.renderRuler()}nxf(){this.wbf.dispose()}Mfe(){return this.E2i()&&this.isPaginatedView()}E2i(){null==this.TXe&&null!=y.AFrameworkApplication.J&&(this.TXe=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.VerticalRulerEnabled",!1));return this.TXe}Hkp(){y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableRuler",
!1)&&this.Sfa&&Za.a.instance.Ra(2).execute(b=>{b.logActivity("LocateRulerActivity",null)})}Hzc(){this.Sfa||Za.a.instance.Ra(2).execute(b=>{b.logActivity("TurnRulerOnActivity",null)})}XZ(){this.aRa.Zxo(this.QMi);this.aRa.fCj(this.YQb);this.Sfa&&(this.uib.dispose(),this.Mfe()&&this.nxf())}q7j(){if(this.z3b){const b={};b[Yo.Lzp]="ToggleButtonModel";this.z3b.eJ(b)}}o5o(b,h){if(!Pl.ql.Paa(b.Ik))return v.ULS.sendTraceTag(574375060,3014,15,"Cannot show ruler. Word Section Node not found."),Pl.recordQosError(this.UDh,
[Pl.$ia],"Cannot show ruler. Word Section Node not found."),8;if(1===h)return 32;this.Sfa=!0;this.m6e.DHj(!0);this.rQi();this.q7j();v.ULS.sendTraceTag(593351624,3014,50,"Ruler is enabled");b=new Map;b.set("Command","ShowRuler");b.set("Source",this.MR);b.set("Response","");Ba.Health.instance.recordKpiUsage(Yo.kpiName,1,Yo.yaa,b);return 32}isPaginatedView(){return 1===this.jG.Kw||2===this.jG.Kw}hfd(b,h){switch(h.documentMode){case "View":this.Sfa&&(this.ga.Ob(ub.a.p0b,2),this.DTe=!0);break;case "Edit":this.DTe&&
(this.ga.Ob(ub.a.p0b,2),this.DTe=!1)}}psc(b,h){if(Pl.instance.Sfa&&Pl.instance.E2i())switch(h.jMa){case 2:case 1:Pl.instance.WCj();break;case 3:case 0:Pl.instance.nxf()}}static recordQosError(b,h,r){const A=Object.assign(new bb.a,{extendedProperties:new Map});r&&A.extendedProperties.set("exception",r);Ba.Health.instance.recordQosError(b,h,!1,!0,!1,!1,A)}static LG(){return new Pl(y.AFrameworkApplication.va,Lp.instance,Bl.instance,qa.StaticActiveAppFrame.za(),Za.a.instance.resolve(1025),Za.a.instance.Oa(1026),
Za.a.instance.resolve(981),br.a.instance,Za.a.instance.resolve(76))}static get instance(){return null!=Pl.JXg?Pl.JXg:Pl.JXg=Pl.LG()}}Pl.ql=null;Pl.$ia="RulerInteractionFailed";Object(u.a)(Pl,"RulerActor",null,[]);class qv{constructor(b,h){this.dOc=null;this.sWb=r=>r.result?r.result.Value.toString():"";this.Rbb=r=>{if(r.kp||r.fj)v.ULS.sendTraceTag(591541278,3014,15,"Failed to get ruler is enabled settings options from Roaming Service."),this.dOc=!1;else{r=r.result;const A=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableRuler",
!1);"true"===r.toLowerCase()&&A&&v.ULS.sendTraceTag(508703490,3014,50,"Roaming setting is set to true by default");""===r&&y.AFrameworkApplication.J&&(!A||appChrome.api.isSmallDevice()||appChrome.api.isVerySmallDevice()?r=y.AFrameworkApplication.J.ib("RulerDefaultOn"):(r="true",v.ULS.sendTraceTag(508703489,3014,50,"Enabling Ruler by default for undefined roaming setting for large screens")));this.dOc="true"===r.toLowerCase();v.ULS.sendTraceTag(591541279,3014,50,"Load to get ruler is enabled settings options from Roaming Service successfully.")}return this.dOc};
this.Ux=b;this.kT=h}DGm(){const b=new Yh.a;if(null==this.dOc){if(this.f0i())return this.kT.Jwb(PB.a.Dld).CWRCo(this.sWb,0).CWRCo(this.Rbb,8);b.hg(!1)}else b.hg(this.dOc);return b.task}Mha(b){this.kT.Mha(PB.a.Dld,new nv.a(PB.a.Dld,b))}DHj(b){this.f0i()&&(this.Ux.rva("saveRulerIsEnabled",b.toString()),v.ULS.sendTraceTag(591541276,3014,50,"Try to save ruler settings value to Roaming Service."));this.Mha(b)}f0i(){const b=y.AFrameworkApplication.J.$("IsAnonymousUser");if(y.AFrameworkApplication.J.$("IsRoamingServiceEnabled"))if(b)v.ULS.sendTraceTag(591541277,
3014,50,"User is anonymous ");else return!0;return!1}}Object(u.a)(qv,"RulerSettingInfo",null,[269]);class OH{constructor(){this.ylh=this.W=null}get name(){return"WordEditor.Ruler"}uc(b){this.W=b;v.ULS.sendTraceTag(578110851,3014,50,"Word ruler package is configured.")}init(){this.W.ia("WordEditor.Ruler.RulerSettingInfo",()=>new qv(this.W.resolve(217),this.W.resolve(218))).as(1026).ha();this.W.resolve(12).us.continueWith(()=>{this.Fo()});this.ylh=Pl.instance.initialize();v.ULS.sendTraceTag(578110852,
3014,50,"Word ruler package is initialized")}Fo(){this.ylh.continueWith(()=>{Pl.instance.rQi();Pl.instance.Hzc();Pl.instance.Hkp()});v.ULS.sendTraceTag(578110853,3014,50,"InitializeRuler is called")}dispose(){Pl.instance.XZ();v.ULS.sendTraceTag(578110854,3014,50,"Word ruler package is disposed")}}Object(u.a)(OH,"PackageManager",null,[0,1]);class iz{constructor(){this.cmc=this.zcc=null}}Object(u.a)(iz,"CreatePickerCustomizationDictionaryOptions",null,[1829]);class lF{}lF.kh="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";
Object(u.a)(lF,"InsertMediaM365DialogHtml",null,[]);class lD{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc,zc,Yc,Kd,ke){this.ZM=ke;this.ehb=null;this.KXf=this.EEd=!1;this.bTj=ge=>{if(ge.rawEvent&&(ge=ge.rawEvent.data))try{const de=Sys.Serialization.JavaScriptSerializer.deserialize(ge,!0),Sd=de.MessageId?de.MessageId.toString():null;de&&Sd&&(Sd===C.a.pmc||Sd===C.a.AUf)&&this.YLc.start(Sd===C.a.pmc?this.Jib:this.Klh)}catch(de){}};this.Rsp=(ge,de,Sd,be,Rf)=>{if(1===Sd)return 32;this.yoh?ge=CommonUIStrings.l_OneDriveName:
""!==this.dCd?ge=this.dCd:(ge=CommonUIStrings.l_HostGeneric,v.ULS.sendTraceTag(20509841,352,15,"InsertMediaActor::UpdateEntryPoints : Do not have host name, use generic name instead."));Rf[Xk.a.LabelText]=ge;return 32};this.Usp=(ge,de,Sd,be,Rf)=>{if(1===Sd)return 32;if(!y.AFrameworkApplication.xYf())return Rf[Xk.a.Visible]=!1,32;this.yoh?ge=String.format(CommonUIStrings.l_ChangePictureFromHost,CommonUIStrings.l_OneDriveName):""!==this.dCd?ge=String.format(CommonUIStrings.l_ChangePictureFromHost,this.dCd):
(ge=CommonUIStrings.l_ChangePictureFromHostGeneric,v.ULS.sendTraceTag(577835747,352,15,"InsertMediaActor::UpdateEntryPointsForChangePictureHostButton : Do not have host name, use generic name instead."));Rf[Xk.a.LabelText]=ge;return 32};this.Ssp=(ge,de,Sd,be,Rf)=>{if(1===Sd)return 32;y.AFrameworkApplication.J.$("InsertOnlinePictureEnabled")||(Rf[Xk.a.Visible]=!1);return 32};this.Tsp=(ge,de,Sd,be,Rf)=>{if(1===Sd)return 32;y.AFrameworkApplication.J.$("InsertPictureUsingStockImagesIsEnabled")||(Rf[Xk.a.Visible]=
!1);return 32};this.Lye=(ge,de,Sd)=>{de=this.jIc.value.Lja(de);if(1===Sd)return de&&this.Iib.kin?32:8;if(2!==Sd||!de)return 8;this.ehb=kb.a.create();v.ULS.sendTraceTag(7165725,352,50,"InsertMediaActor::ShowInsertPictureFromSearchDialog : Show dialog.");ge=this.bum(ge,this.ehb);ge=this.sdf(ge);ge=this.WCd.N2c(ge);ge.correlationId=this.ehb;ge.TUf=this.Llh;ge.$ta=1;return this.Jye(ge,CommonUIStrings.L_PictureInsertTitle,this.Jib)};this.s4o=(ge,de,Sd)=>{ge=32===this.ga.Nf(de,ub.a.GR,1,!1,null,null);if(1===
Sd)return ge&&this.Iib.LXi?32:8;if(2!==Sd||!ge)return 8;v.ULS.sendTraceTag(21612190,352,50,"InsertMediaActor::ShowInsertOneDriveFileDialog : ShowInsertMediaDialog dialog.");return this.Jye(this.Jlh.getInstance(),Box4Intl.Box4Strings.l_InsertOneDriveFile,this.Klh)};this.PSj=(ge,de,Sd)=>{ge=this.jIc.value.Lja(de);if(1===Sd)return ge&&this.Iib.wYf?32:8;if(2!==Sd||!ge)return 8;v.ULS.sendTraceTag(17838539,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : ShowInsertMediaDialog dialog.");return this.Jye(this.Jlh.getInstance(),
CommonUIStrings.L_PictureInsertTitle,this.Jib)};this.Hye=(ge,de,Sd)=>{de=this.jIc.value.Lja(de);if(1===Sd)return de&&this.Iib.oin?32:8;if(2!==Sd||!de)return 8;v.ULS.sendTraceTag(587532180,352,50,"InsertMediaActor::ShowInsertM365PictureFromSearchDialog : Show dialog.");this.ehb=kb.a.create();Sd=y.AFrameworkApplication.J.$("StockImagesFreemiumExperienceIsEnabled")&&this.qK.isFreemiumUpsellEnabled();Sd=this.EEd?1:Sd?0:-1;ge=this.Jwm(ge,this.ehb,Sd);ge=this.WCd.N2c(ge);ge.kh=lF.kh;ge.correlationId=this.ehb;
ge.$ta=2;ge.TUf=this.Llh;ge.uTa=this.qK;ge.userLicenseType=Sd;return this.Jye(ge,CommonUIStrings.L_PictureInsertTitle,this.Jib)};this.Mye=(ge,de,Sd)=>{de=this.jIc.value.Lja(de);ge=Za.a.instance.Oa(1027);if(1===Sd)return de&&!this.Iib.wYf&&ge&&ge.G_f()&&!y.AFrameworkApplication.nfe?32:8;if(2!==Sd||!de||!ge)return 8;v.ULS.sendTraceTag(553734720,352,50,"InsertMediaActor::showInsertPictureFromSharedPicker : Show dialog.");this.ehb=kb.a.create();Sd=lD.LIh;de=!1;y.AFrameworkApplication.yYf()&&(de=this.ydm());
const be=new iz;be.zcc=de;be.cmc=!0;Sd=ge.ksf(CommonUIStrings.L_ImageUploadButtonText,"Select Images",!0,!1,!0,Sd,"Insert Media",1,be);ge.y5d(Sd).then(Rf=>{if(null!=Rf&&0<Rf.length){const Mf=[];for(let Yj=0;Yj<Rf.length;Yj++){const Ji=Rf[Yj][F.a.Crj],sm=Rf[Yj][F.a.Brj],jn={};jn.Extension=Ji;jn.OriginalUrl=sm;jn.caption=Ji;Mf.push(jn)}this.Jib.FWa=ub.a.q6;this.Jib.r$a(Mf)}});return 32};this.Kye=(ge,de,Sd)=>{var be=this.jIc.value.Lja(de);de=Za.a.instance.Oa(1027);if(1===Sd)return be&&de&&de.G_f()?32:
8;if(2!==Sd||!be||!de)return 8;Sd=Za.a.instance.Oa(1028);null!=Sd&&Sd.h4l(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",!1));v.ULS.sendTraceTag(526951881,352,50,"InsertMediaActor::showInsertPictureFromMobileDevice : Show dialog.");this.ehb=kb.a.create();Sd=lD.LIh;be=new iz;be.zcc=!0;be.cmc=!0;Sd=de.ksf(CommonUIStrings.L_ImageUploadButtonText,CommonUIStrings.L_ImageUploadingTitle,!0,!1,!0,Sd,"InsertPictureFromMobile",3,be);
de.y5d(Sd).then(Rf=>{if(null!=Rf&&0<Rf.length){var Mf=[];const Yj=ge===ub.a.dbe;let Ji=!1;const sm=y.AFrameworkApplication.J.ib("PhoneLinkServiceEndpoint");for(let jn=0;jn<Rf.length;jn++){const js=Rf[jn][F.a.Crj],uy=Rf[jn][F.a.Brj],nz={};nz.Extension=js;nz.OriginalUrl=uy;nz.caption=js;Mf.push(nz);Ji||(Ji=-1!==nz.OriginalUrl.indexOf(sm))}this.Jib.FWa=ub.a.q6;this.Jib.r$a(Mf);Mf={};Mf.InsertImageCount=Rf.length;Ji&&ac.c(Yj?ub.a.L7m:ub.a.nll,void 0,void 0,void 0,void 0,void 0,Mf)}});return 32};this.YLc=
A;this.HHd=M;this.WCd=oa;this.Jlh=Ja;this.z1=fb;this.ga=b;this.jIc=aa;this.yoh=pc;this.dCd=Yc;this.Iib=r;this.Jib=Cb;this.Klh=Gb;this.Llh=Kd;(this.qK=Sb)&&this.qK.isFeatureEnabled("MsoPremiumStockImages",!1).catch(ge=>v.ULS.sendTraceTag(577249666,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",ge)).then(ge=>{(this.EEd=ge)||this.qK.Nua("MsoPremiumStockImages",()=>{this.EEd=!0;v.ULS.sendTraceTag(577249667,352,50,"InsertMediaActor::Constructor - License state changed to premium")});
return null})}Xb(){(this.Iib.wYf||this.Iib.LXi)&&this.Iib.nin&&this.Hbo();this.zro();this.yro();this.ga.fb(ub.a.t_h,lc.a.view,this.PSj,1284);this.ga.fb(ub.a.jvj,lc.a.view,this.Usp,1124);this.ga.fb(ub.a.NUf,lc.a.view,this.PSj,1284);this.ga.fb(ub.a.ung,lc.a.view,this.Rsp,1124);this.ga.fb(ub.a.V7m,lc.a.view,this.s4o,1284)}zro(){this.ga.fb(ub.a.insertOnlinePicture,lc.a.view,this.Lye,1284);this.ga.fb(ub.a.abe,lc.a.view,this.Hye,1284);this.ga.V3("word_insertOnlinePictures",!0,ub.a.insertOnlinePicture,lc.a.view,
this.Lye,b=>{qa.StaticActiveAppFrame.za().a2b(b,Object(E.a)(new Uh.a,(new Uh.a).mqb,"getCommandById"))});this.ga.V3("word_insertOnlinePictures",!0,ub.a.abe,lc.a.view,this.Hye,b=>{qa.StaticActiveAppFrame.za().a2b(b,Object(E.a)(new Uh.a,(new Uh.a).mqb,"getCommandById"))});this.ga.fb(ub.a.bnf,lc.a.view,this.Lye,1284);this.ga.fb(ub.a.dnf,lc.a.view,this.Mye,1284);this.ga.V3("word_insertOnlinePictures",!0,ub.a.dnf,lc.a.view,this.Mye);this.ga.fb(ub.a.enf,lc.a.view,this.Hye,1284);this.ga.fb(ub.a.hvj,lc.a.view,
this.Ssp,1284);this.ga.fb(ub.a.ivj,lc.a.view,this.Tsp,1284);this.ga.V3("word_insertOnlinePictures",!0,ub.a.bnf,lc.a.view,this.Lye);this.ga.V3("word_insertOnlinePictures",!0,ub.a.enf,lc.a.view,this.Hye);this.ga.fb(ub.a.PUf,lc.a.view,this.Mye,1284);this.ga.V3("word_insertOnlinePictures",!0,ub.a.PUf,lc.a.view,this.Mye,b=>{qa.StaticActiveAppFrame.za().a2b(b,Object(E.a)(new Uh.a,(new Uh.a).mqb,"getCommandById"))})}yro(){y.AFrameworkApplication.yYf()&&(this.ga.fb(ub.a.dbe,lc.a.view,this.Kye,1284),this.ga.fb(ub.a.cnf,
lc.a.view,this.Kye,1284),this.ga.V3("mso_insertMobileDevicePictures",!0,ub.a.dbe,lc.a.view,this.Kye,b=>{qa.StaticActiveAppFrame.za().a2b(b,Object(E.a)(new Uh.a,(new Uh.a).mqb,"getCommandById"))}),this.ga.V3("mso_insertMobileDevicePictures",!0,ub.a.cnf,lc.a.view,this.Kye,b=>{qa.StaticActiveAppFrame.za().a2b(b,Object(E.a)(new Uh.a,(new Uh.a).mqb,"getCommandById"))}))}Hbo(){y.AFrameworkApplication.ua.get_element().appendChild(this.HHd.c8a);mf.a.addHandler(this.HHd.c8a.contentWindow,"message",this.bTj);
this.KXf=!0}bum(b,h){let r=0;y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib&&5===y.AFrameworkApplication.ua.Ib.Uk&&(r=12);const A=tj.a.Hg(y.AFrameworkApplication.lcid);return String.format(y.AFrameworkApplication.J.appSettings.WordInsertPictureServiceEndpoint,b===ub.a.insertOnlinePicture?1:0,y.AFrameworkApplication.lcid,A?A.name:"en-us",y.AFrameworkApplication.buildVersion,h,r,y.AFrameworkApplication.J.ib("UserId"))}Jye(b,h,r){try{return b.Iye(h,r,void 0),v.ULS.sendTraceTag(7185476,352,
50,"InsertMediaActor::ShowInsertPictureDialog : ShowInsertMediaDialog dialog success."),32}catch(A){return v.ULS.sendTraceTag(7165726,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",A.toString()),this.mq(Bf.a.rdd,CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ClipartCannotConnect),8}}Jwm(b,h,r){if(ub.a.abe===b)return b=this.z1.sWh(y.AFrameworkApplication.J.ib("InsertOnlineM365PictureEndpoint"),h.toString(),1,r),this.sdf(b);b=this.z1.sWh(y.AFrameworkApplication.J.ib("InsertOnlineM365PictureEndpoint"),
h.toString(),0,r);return this.sdf(b)}mq(b,h,r){const A=new ni.StandardDialog(!0);A.Bu=y.AFrameworkApplication.Jfa;A.Fd=0;A.Qe(1,CommonUIStrings.l_DialogClose);A.zy(b,h,r,()=>{})}ydm(){const b=Za.a.instance.Oa(1028);return null!=b?b.Lhm():!1}dispose(){this.KXf&&this.HHd.c8a.contentWindow&&(mf.a.removeHandler(this.HHd.c8a.contentWindow,"message",this.bTj),this.KXf=!1)}sdf(b){return this.ZM&&this.ZM.XO?(b=new Ra.QueryStringBuilder(b),b.ye("theme","4"),b.toString()):b}}lD.LIh=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");
Object(u.a)(lD,"InsertMediaActor",null,[10]);var jz=d(951);class gK extends jz.a{constructor(b,h){super(b,$a.a.getOrigin(h))}Vq(b,h){this.isEnabled()&&this.eea(this.Heb)&&(this.Xu(b),this.sD(b,h))}}Object(u.a)(gK,"InsertMediaCrossDocumentMessenger",jz.a,[459,44,10]);class PH{getInstance(b,h){return new gK(b,h)}}Object(u.a)(PH,"InsertMediaCrossDocumentMessengerFactory",null,[434]);var QH=d(768);class kA{}kA.kh="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";
Object(u.a)(kA,"InsertMediaDialogHtml",null,[]);var lA;(function(b){b[b.OK=0]="OK";b[b.cancel=1]="cancel";b[b.error=2]="error";b[b.open=3]="open"})(lA||(lA={}));Object(u.b)("HubbleAction",lA);var mA;(function(b){b[b.unknown=0]="unknown";b[b.aRp=1]="bing";b[b.mLp=2]="M365";b[b.L0p=3]="icons";b[b.oneDrive=4]="oneDrive";b[b.I$d=5]="hubble"})(mA||(mA={}));Object(u.b)("InsertMediaProviders",mA);class mF extends ig.a{constructor(b,h,r,A=null,M=!1){super(!1,!1,M);this.Bz=null;this.yGc=!1;this.Obd=this.t3=
null;this.Klf="KeepFocusDiv";this.tTd="KeepFocusStartDiv";this.correlationId=null;this.$ta=0;this.uTa=this.TUf=null;this.userLicenseType=0;this.AZe=null;this.rWn=()=>{this.t3&&(this.t3.style.visibility="visible",window.setTimeout(()=>{if(this.Nj){const aa=this.Nj.getElementById(this.tTd);aa&&aa.focus()}},0))};this.Yfa=aa=>{aa.keyCode===Sys.UI.Key.tab&&(aa.target.id!==this.Klf||aa.shiftKey?aa.target.id===this.tTd&&aa.shiftKey&&(aa.preventDefault(),this.Nj.getElementById(this.Klf).focus()):(aa.preventDefault(),
this.Nj.getElementById(this.tTd).focus()))};this.aij=()=>{v.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");this.SNb(this.d6a);this.Jxb(1)};this.aeg=()=>{this.Bz&&(v.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),this.Bz.sendMessage(C.a.HLj,{["CustomHeaders"]:""}))};this.rjj=()=>{this.Bz&&(v.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.Bz.sendMessage(C.a.DVo,{["SessionId"]:y.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))};
this.qjj=()=>{this.Bz&&(v.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.Bz.sendMessage(C.a.HOo,{["CID"]:""}))};this.NWn=()=>{this.uTa&&(v.ULS.sendTraceTag(577249665,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),this.uTa.launchUpsellExperience("stockimages"))};if(!b)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");this.XCd=b;this.L5b="";this.z1=r;this.$xa=[];this.UId=h;this.kh=A||kA.kh;this.Ng="InsertMediaDialog"}get telemetryEventName(){return"InsertM365Images"}async Iye(b,
h){this.L5b=b;this.yGc=!1;this.showDialog(this.L5b,null);this.t3=this.ljc(this.Bj("insertmediaframe"));if(!this.t3)throw this.SNb(this.d6a),Error.invalidOperation("Couldn't get InsertMediaIframe.");b=document.createElement("div");b.setAttribute("Id",this.tTd);b.setAttribute("tabindex","0");b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","-1000px");this.t3.parentNode.insertBefore(b,this.t3.parentNode.firstChild);b=document.createElement("div");b.setAttribute("Id",
this.Klf);b.setAttribute("tabindex","0");this.t3.parentNode.appendChild(b);b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","10000px");$addHandler(this.ewf,"keydown",this.Yfa);this.t3.src=this.XCd;this.t3.style.width="100%";this.t3.style.height="100%";this.t3.frameBorder="0";y.AFrameworkApplication.J.$("ShowInsertMediaIframeWhenIframeIsReady")&&Y.a.uj?(this.t3.style.visibility="hidden",this.Obd=this.rWn,mf.a.addHandler(this.t3,"load",this.Obd)):this.t3.style.visibility=
"visible";this.ljc(this.Bj("WACDialogButtonPanel")).style.display="none";this.ljc(this.Bj("WACDialogTitleText")).style.display="none";2===this.$ta&&(this.ljc(this.Bj("WACDialogTitlePanel")).style.display="none",this.ljc(this.Bj("WACDialogBodyPanel")).style.padding="0");Cd.FocusManager.instance().au().scope.HL=!0;this.Bz=this.UId.getInstance(this.t3.contentWindow,this.XCd);this.Bz.eea("https://osiziwuspersimmon002.blob.core.windows.net");this.Bz.eea("https://osizewuspersimmon001.blob.core.windows.net");
this.Bz.eea("https://osizpscuspersimmon000.blob.core.windows.net");this.Bz.eea("https://cdn.hubblecontent.msit.osi.office.net");this.Bz.eea("https://cdn.hubblecontent.osi.office.net");this.Bz.Vq(C.a.hMh,r=>{this.phj(r,Object(E.a)(h,h.r$a,"insertMediaCallback"))});this.Bz.Vq(C.a.insert,r=>{this.cme(r,Object(E.a)(h,h.r$a,"insertMediaCallback"))});this.Bz.Vq(C.a.FMh,r=>{this.Dkj(r)});this.Bz.Vq(C.a.ivi,this.aeg);this.Bz.Vq(C.a.getSessionId,this.rjj);this.Bz.Vq(C.a.Qsi,this.qjj);this.Bz.Vq(C.a.PTd,this.aij);
2!==this.$ta||this.userLicenseType||(this.Bz.Vq(C.a.Hun,this.NWn),this.AZe=this.uTa.Nua("MsoPremiumStockImages",r=>{v.ULS.sendTraceTag(577249664,352,50,"OnCompleteM365Upsell: upsell completed from stock images");this.Bz.sendMessage(C.a.byp,{["LicenseTier"]:r.toString()})}));this.Jxb(3)}dispose(){this.uTa&&this.AZe&&this.uTa.VYb("MsoPremiumStockImages",this.AZe);this.Bz&&(this.Bz.dispose(),this.Bz=null);this.Obd&&(mf.a.removeHandler(this.t3,"load",this.Obd),this.Obd=null);super.dispose()}phj(b,h){v.ULS.sendTraceTag(7135752,
352,100,"OnAddItem : Got message.");if(b=this.z1.R6n(b))this.$xa.push(b),this.yGc&&(h(this.$xa),this.yGc=!1)}mq(){const b=new ni.StandardDialog(!0);b.Bu=y.AFrameworkApplication.Jfa;b.Fd=0;b.Qe(1,CommonUIStrings.l_DialogOk);b.Ex(CommonUIStrings.l_ImageUploadFailedTitle,CommonUIStrings.l_InsertPictureMaxLimitExceeded,2,()=>{})}Jxb(b){if(2===this.$ta){const r=y.AFrameworkApplication.J.ib("InsertMediaDialogAriaTenantNameSpace");if(r&&""!==r){var h=[];h.push(Object.assign(new ia.a,{name:"InsertedFiles",
int64:this.$xa.length}));h.push(Object.assign(new ia.a,{name:"MediaDetails",string:JSON.stringify(this.$xa)}));h.push(Object.assign(new ia.a,{name:"DialogResult",string:lA[b]}));h.push(Object.assign(new ia.a,{name:"DialogMode",string:this.vAi()}));h.push(Object.assign(new ia.a,{name:"CorrelationId",string:this.correlationId.toString()}));h.push(Object.assign(new ia.a,{name:"Provider",string:mA[this.$ta]||"Unknown"}));ca.a.sendTelemetryEvent(Object.assign(new la.a,{name:String.format("{0}.{1}",r,this.telemetryEventName),
dataFields:h}))}}}vAi(){return 3===this.$ta?"Icons":5===this.$ta?"ExternalContent":"Images"}ljc(b){const h=document.getElementById(b);if(!h)throw Error.invalidOperation(String.format("Couldn't get {0}.",b));return h}cme(b,h){v.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.SNb(this.d6a);h?this.$xa&&50<this.$xa.length?(this.mq(),this.Jxb(0),v.ULS.sendTraceTag(578140104,352,10,"InsertMediaDialog: User tried to insert {0} images using {1}",this.$xa.length,mA[this.$ta])):this.$xa&&0<
this.$xa.length?(h(this.$xa),this.Jxb(0),v.ULS.sendTraceTag(578140105,352,50,"InsertMediaDialog: User inserted {0} images using {1}",this.$xa.length,mA[this.$ta])):(v.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this.yGc=!0,h(this.$xa),this.Jxb(2)):this.Jxb(2)}Dkj(b){b&&b.Values&&(b=b.Values,delete b.m_Origin,delete b.m_Source,delete b.m_ReceivedTime,v.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+b.eventName||!1),ca.a.sendOtelEvent(Object.assign(new QH.a,{otelEvent:b})))}}
Object(u.a)(mF,"InsertMediaDialog",ig.a,[433,10]);class mD{constructor(b,h){this.aVe=b;this.z1=h}N2c(b,h=!1){return new mF(b,this.aVe,this.z1,kA.kh,h)}getInstance(){throw Error.notImplemented();}}Object(u.a)(mD,"InsertMediaDialogFactory",null,[432]);class iq{constructor(b,h,r){this.oUi=!1;this.correlationId=null;this.$ta=0;this.TUf=null;this.Awk=b;this.wQc=[];this.eCd=h;this.wFh=r.split(";")}async Iye(b,h){Array.clear(this.wQc);b=this.Awk.value;b.eea(this.eCd);b.Xu(h.J5c);this.oUi||(b.sD(h.J5c,r=>
{this.cme(r,h)}),this.oUi=!0);v.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");b.sendMessage(h.gai,{["FileExtensionFilterList"]:this.wFh})}eYk(b){Array.contains(this.wQc,b)||this.wQc.push(b)}cme(b,h){v.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");b=h.lqj(b);const r=[];for(let A=0;A<b.length;A++){const M=b[A];h.Xce(M,this.wFh)?r.push(M):this.eYk(h.sEi(M))}r&&r.length?h.r$a(r):v.ULS.sendTraceTag(20509843,
352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.wQc.length&&(h=this.wQc.join(", "),v.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",h),this.W5o(h))}W5o(b){const h=new ni.StandardDialog;h.Fd=0;h.jY(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,b),null)}dispose(){}}Object(u.a)(iq,"InsertMediaFromHostManager",null,[433,10]);class nA{constructor(b){this.Exk=
b}N2c(){throw Error.notImplemented();}getInstance(){return this.Exk}}Object(u.a)(nA,"InsertMediaFromHostManagerFactory",null,[431,432]);class hK{constructor(){this.c8a=document.createElement("iframe");this.c8a.src="about:blank";this.c8a.style.visibility="hidden";this.c8a.style.position="absolute";this.c8a.style.zIndex="-100"}}Object(u.a)(hK,"InsertMediaFromHostOneDriveHostFrame",null,[430]);class RH extends jz.a{constructor(b,h){super(b,"*"===h?h:$a.a.getOrigin(h));this.kLh(C.a.pmc);this.kLh(C.a.AUf)}Mte(){}}
Object(u.a)(RH,"InsertMediaFromOneDriveCrossDocumentMessenger",jz.a,[429,44,10]);class nD{}Object(u.a)(nD,"OnlineMediaSearchResult",null,[]);class is{sWh(b,h,r,A){const M=tj.a.Hg(y.AFrameworkApplication.lcid).name,aa=y.AFrameworkApplication.buildVersion,oa=I.a.zT(y.AFrameworkApplication.J.ib("UserId")).toString();if(-1!==b.indexOf("exp=")){const Ja=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertOnlineM365ExperimentEnabled",!1)?1:0;y.AFrameworkApplication.vd("ShIns226;ShIns226cf");
return String.format(b,y.AFrameworkApplication.lcid,M,aa,h,is.YHe,oa,A,r,Ja)}return String.format(b,y.AFrameworkApplication.lcid,M,aa,h,is.YHe,oa,A,r)}R6n(b){if(!b||!b.Values)return null;b=b.Values;if(!b)return null;let h="";"sourceProvider"in b&&(h=b.sourceProvider||"");return Object.assign(new nD,{Action:b.action||"",Caption:b.caption||"",ContentType:b.contenttype||"",Type:b.extension||"",PageUrl:b.pageUrl||"",OriginalUrl:b.sourceUrl||"",ContentProvider:h,ThumbnailUrl:b.thumbnailUrl||"",LicenseUrl:b.licenseUrl||
"",LicenseDisplayName:b.licenseDisplayName||"",Height:b.height||0,Width:b.width||0,SvgContent:b.svgContent||"",Html:b.html||"",ProviderName:b.providerName||""})}S6n(b){const h=[];if(!b||!b.Values||!b.Values.Items)return h;b=b.Values.Items;for(let A=0;A<b.length;A++){var r=b[A];r&&(r=Object.assign(new nD,{Type:r.Extension||"",OriginalUrl:r.SourceUrl||"",Caption:r.caption,Height:r.Height||0,Width:r.Width||0}),h.push(r))}return h}Hig(b){const h=[];for(let A=0;A<b.data.files.length;A++){var r=b.data.files[A];
r&&(r=Object.assign(new nD,{ContentType:r.itemType||"",Type:r.extension||"",OriginalUrl:r.urls&&r.urls.open?r.urls.open:"",Height:r.photo?r.photo.height:0,Width:r.photo?r.photo.width:0}),h.push(r))}return h}Xce(b,h){if(!b)return!1;for(let r=0;r<h.length;r++)if(0<=b.toLowerCase().indexOf(h[r]))return!0;return!1}Cbo(b){let h="";if(b)for(let r=0;r<b.length;r++){const A=b[r];A&&(h+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',A.OriginalUrl,A.Width,A.Height))}return h}}is.YHe=0;Object(u.a)(is,
"InsertMediaHelper",null,[428]);class oA{constructor(b,h,r,A,M){this.kin=b;this.wYf=h;this.LXi=r;this.nin=A;this.oin=M}}Object(u.a)(oA,"InsertMediaSettingsManager",null,[]);class pA{constructor(b){this.uIc=ub.a.GR;this.ga=b}get FWa(){return this.uIc}set FWa(b){this.uIc=b}r$a(b){try{v.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length);for(let h=0;h<b.length;h++)this.ga.Pb(this.FWa,2,b[h]);v.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",
b.length)}catch(h){v.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",h.toString())}}}Object(u.a)(pA,"InsertOneDriveFileHandler",null,[426]);class Hw extends pA{constructor(b){super(b)}get gai(){return C.a.AUf}get J5c(){return C.a.j7m}lqj(b){return b&&b.Values&&"Items"in b.Values?b.Values.Items:null}sEi(){Tc.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");return""}Xce(){return!0}vuj(b,
h,r){b=r(b);b.length&&(r={},r.Items=b,h.sendMessage(this.J5c,r))}nqj(b){const h=[];for(let r=0;r<b.data.files.length;r++){const A=b.data.files[r];if(A){const M={};M.DisplayText=String.format("{0}{1}",A.name,A.extension);M.Url=this.o8l([A.urls.viewInBrowser,A.urls.open,A.urls.download]);h.push(M)}}return h}o8l(b){for(let h=0;h<b.length;h++)if(b[h]&&""!==b[h])return b[h];v.ULS.sendTraceTag(21764229,352,10,"None of the URLs we received are valid");return""}}Object(u.a)(Hw,"InsertOneDriveFileHelper",
pA,[425,426]);class oD{constructor(b,h,r,A){this.Ho=A;this.uIc=ub.a.q6;this.Mp=null;this.wYn=()=>{Bd.a.iV&&this.Ho.XL([26],this.He)};this.ga=b;this.z1=h;this.ija=r;Bd.a.iV&&(this.He=sh.a.getInstance(dd.a),cm.a.$pg(this.wYn))}get Rb(){return this.ga}get Cw(){return this.Mp||(this.Mp=Za.a.instance.resolve(26))}get FWa(){return this.uIc}set FWa(b){this.uIc=b}r$a(b){try{Bd.a.iV&&this.Ho.WX([26]);v.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",
b.length);const h=this.z1.Cbo(b);let r=2;if(h&&0<h.length){const A=new wg.DictionaryPropertySet;A.setValue(pd.a.QX,h);A.setValue(pd.a.Ofa,!0);if(this.ija){const M=this.ija.Bpd();M.Occ("insertOnlineImage");A.setValue(pd.a.sza,M)}r=this.ga.Pb(this.FWa,2,A)}v.ULS.sendTraceTag(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",b.length,32===r,""===h)}catch(h){v.ULS.cA(21612225,352,10,h,"InsertImageFromHostHelper::InsertMediaCallback : Exception")}}}
Object(u.a)(oD,"InsertOnlineImageHandler",null,[426]);class nF extends oD{constructor(b,h,r,A=null){super(b,h,A,r)}get gai(){return C.a.pmc}get J5c(){return C.a.x7m}lqj(b){return this.z1.S6n(b)}sEi(b){return b.Type}Xce(b,h){return this.z1.Xce(b.Type,h)}nqj(b){return this.z1.Hig(b)}vuj(b,h,r){r=r(b);if(r.length){b=[];for(let A=0;A<r.length;A++){const M=r[A],aa={};aa.Extension=M.Type;aa.SourceUrl=M.OriginalUrl;aa.caption=M.Type;aa.SourceUrl=M.OriginalUrl;aa.Width=M.Width;aa.Height=M.Height;b.push(aa)}r=
{};r.Items=b;h.sendMessage(this.J5c,r)}}}Object(u.a)(nF,"InsertOnlineImageHelper",oD,[425,426]);class SH{constructor(b,h){this.jDb=b;this.UId=h}start(b){this.jDb.start({mode:"open",select:"multi",lightbox:"white"},(h,r)=>{this.processResponse(h,r,b)})}processResponse(b,h,r){v.ULS.sendTraceTag(22090009,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",b);b&&h&&h.data&&h.data.files&&0<h.data.files.length?(b=this.UId.getInstance(window.frames[0].parent,
window.document.URL),r.vuj(h,b,A=>r.nqj(A))):v.ULS.sendTraceTag(22090010,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : No media to insert.")}}Object(u.a)(SH,"OneDriveFilePickerHelperV5",null,[268]);class iK{constructor(){this.VCd=this.W=null}get name(){return"Box4.Media"}uc(b){this.W=b;b.ia(1032,()=>new hK).as(1039).ha();const h=new oA(Boolean.parse(y.AFrameworkApplication.J.appSettings.InsertOnlinePictureEnabled||"false"),y.AFrameworkApplication.xYf(),!1,y.AFrameworkApplication.MBg(),
y.AFrameworkApplication.J.$("InsertPictureUsingStockImagesIsEnabled"));b.ia("Box4.Media.OneDriveFilePickerHelperV5",()=>new SH(b.resolve(1029),b.resolve(1030))).as(1031).ha();b.ia(1040,()=>new lD(y.AFrameworkApplication.va,y.AFrameworkApplication.J,h,b.resolve(1031),b.resolve(1032),new Qf.a(()=>Za.a.instance.resolve(820)),b.resolve(1033),b.resolve(1034),b.resolve(1035),b.resolve(1036),b.resolve(1037),b.resolve(4),y.AFrameworkApplication.rtb,y.AFrameworkApplication.Mta,y.AFrameworkApplication.JZm,
y.AFrameworkApplication.J.appSettings.InsertPictureTelemetryEndpoint,b.resolve(113))).ha();b.ia("Box4.Media.InsertMediaDialogFactory",()=>new mD(b.resolve(1030),b.resolve(1035))).as(1033).ha();b.ia("Box4.Media.InsertMediaFromHostManagerFactory",()=>new nA(b.resolve(1038))).as(1034).ha();b.ia(1038,()=>new iq(new Qf.a(()=>{if(y.AFrameworkApplication.MBg()){var r=Za.a.instance.resolve(1039).c8a;r=new RH(r.contentWindow,"*")}else r=y.AFrameworkApplication.K_;return r}),y.AFrameworkApplication.MBg()?$a.a.getOrigin(window.document.URL):
$a.a.getOrigin(y.AFrameworkApplication.mwb),y.AFrameworkApplication.J.appSettings.ImageFetcherSupportedExtensions)).ha();b.register(PH,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as(1030).ha();b.register(is,1035).ha();b.ia(1036,()=>new nF(y.AFrameworkApplication.va,b.resolve(1035),new bn.b,b.resolve(259))).ha();b.ia(1037,()=>new Hw(y.AFrameworkApplication.va)).ha()}init(){this.VCd=this.W.resolve(1040);this.VCd.Xb()}dispose(){this.VCd&&this.VCd.dispose()}}Object(u.a)(iK,"MediaPackage",null,
[0,1]);var TH=d(961);class rv{get name(){return"Box4.PlaceholderText"}uc(b){this.W=b;this.W.ia(926,()=>new TH.a(qa.StaticActiveAppFrame.za().kb.Jc,this.W.resolve(412),this.W.resolve(369),this.W.Ra(72),df.a.gf.Ll.jf(12),this.W.rf(164))).ha()}init(){this.W.resolve(926).init()}dispose(){}static main(){K.a.instance.Lc(new rv,4)}}Object(u.a)(rv,"PlaceholderTextPackage",null,[0,1]);class pD{constructor(b,h,r,A){this.Z8b=b;this.Sia=h;this.szk=r;this.xr=A;this.Okj=()=>{(y.AFrameworkApplication.wCj||this.V9k())&&
this.Yzc()}}init(){pD.W9k&&this.szk&&this.ZL()}ZL(){this.Sia.wt(this.Okj)}Yzc(){this.Sia.hS(this.Okj)}V9k(){if(!this.Z8b)return!1;const b=this.ypm();return b&&32===y.AFrameworkApplication.va.Pb(Ka.a.Sua,2,b)&&this.xr?(this.xr.execute(h=>{h.logActivity("AutoRenameDocumentCallout",null);y.AFrameworkApplication.oc.Zb(new xc.a(5,1,12E4,()=>{h.logActivity("AutoRenameSentimentSurvey",null)},0,"floodgateSurveyForAutoRenameSentiment"))}),ac.a("AutoRenameDocumentSuccess"),!0):!1}ypm(){let b,h=this.Z8b.E2d();
for(;h;){const r=h.node;if(0<Gd.ParagraphReader.textLength(r,9)&&(b=Gn.AParagraphNode.zpm(r.characterData.trim()),0<b.length))break;h=h.next}return b}static get W9k(){var b;null===this.ZJe&&(this.ZJe=null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoRenameNewDocument",!1));return this.ZJe}}pD.ZJe=null;Object(u.a)(pD,"AutoRenameExecutor",null,[]);class zx{$jn(){var b;const h=y.AFrameworkApplication.sessionStartInfoSettings.ApplicationModeExtended,
r=y.AFrameworkApplication.sessionStartInfoSettings.SessionOrigin,A=null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoRenameNewDocumentFileNew",!1);return y.AFrameworkApplication.wI&&(!y.AFrameworkApplication.fua||"blank"===y.AFrameworkApplication.fua)&&(0<=h.toLowerCase().indexOf("new")||A&&0<=r.toLowerCase().indexOf("wacfilenew"))}get name(){return"Box4.AutoRename"}uc(b){this.W=b;this.W.ia(1041,()=>new pD(this.W.resolve(412),df.a.gf.Ll.jf(12),
this.$jn(),b.Ra(2))).ha()}init(){this.W.resolve(1041).init()}dispose(){}static main(){K.a.instance.Lc(new zx,20)}}Object(u.a)(zx,"AutoRenamePackage",null,[0,1]);var e=d(346);class n{constructor(){this.XFo="getAddinShortcutsPreference";this.YFo="saveAddinShortcutsPreference";this.ZFo="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.cem=6E4;this.ike=this.Era=this.uca=null}BEi(b){return String.format(this.ZFo,y.AFrameworkApplication.J.appSettings.RoamingServiceHandlerWebServiceBase||"",b,y.AFrameworkApplication.um)}executeRequest(b,
h,r,A,M=null){return n.HT.HJb(b,h,M,null,r,A,!1,null,this.cem)}saveSetting(b,h,r,A,M){return this.EHj(b,h,r,null,A,M)}startBatchUpdateScope(){this.ike=[]}saveShortcutInfoArrayBatch(b,h,r){this.$Ho(r,b,h)}$Ho(b,h,r){const A={action:"",addinId:"",ownerType:0};A.timestamp=(new Date).toUTCString();const M=this.getShortcutInfoArray(h.toString(),r.toString());b?(A.shortcutInfoArray=b,this.rdf(h,r,b)):M&&(A.shortcutInfoArray=M);b={};b[h.toString()]=A;h=new e.a(r.toString(),b);this.ike.push(h)}commitBatchUpdateScope(){return this.Cod()?
this.bIo().then(()=>{this.Ddc();return Promise.resolve(!0)}):this.dIo().then(()=>{this.Ddc();return Promise.resolve(!0)})}bIo(){return this.getSetting().then(b=>{let h=null;if(b&&!({ev:h}=H.d(b)).returnValue)return v.ULS.sendTraceTag(522739852,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);h||(h={});for(const r of this.ike){(b=h[r.key])||(b={});const A=r.value;for(const M of qb.a.xR(A))b[M]=A[M];h[r.key]=b}this.uca=h;try{return localStorage.setItem("AddinShortcutPreferenceData",
H.c(h)),Promise.resolve(!0)}catch(r){return v.ULS.sendTraceTag(522739853,0,10,"SaveSettingToLocalStorageBatch failed",r),Promise.resolve(!1)}})}dIo(){return this.lNo().then(b=>this.dve(b))}lNo(){return this.NMf().then(b=>{let h=null;b&&(({ev:h}=H.d(b)).returnValue||v.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));h||(h={});for(const r of this.ike){(b=h[r.key])||(b={});const A=r.value;for(const M of qb.a.xR(A))b[M]=
A[M];h[r.key]=b}this.uca=h;return H.c(h)})}saveShortcutInfoArray(b,h,r){return this.EHj(0,"","",r,b,h)}EHj(b,h,r,A,M,aa){const oa=this.Cod(),Ja={};Ja.action=r;Ja.addinId=h;Ja.ownerType=b;Ja.timestamp=(new Date).toUTCString();h=this.getShortcutInfoArray(M.toString(),aa.toString());0===b&&A?(Ja.shortcutInfoArray=A,this.rdf(M,aa,A)):h&&(Ja.shortcutInfoArray=h);b={};b[M.toString()]=Ja;M=new e.a(aa.toString(),b);return oa?this.aIo(M):this.cIo(M)}aIo(b){return this.getSetting().then(h=>{let r=null;if(h&&
!({ev:r}=H.d(h)).returnValue)return v.ULS.sendTraceTag(522739855,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),Promise.resolve(!1);r||(r={});r[b.key]=b.value;this.uca=r;try{return localStorage.setItem("AddinShortcutPreferenceData",H.c(r)),Promise.resolve(!0)}catch(A){return v.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",A),Promise.resolve(!1)}})}cIo(b){return this.kNo(b).then(h=>this.dve(h))}kNo(b){return this.NMf().then(h=>{let r=null;h&&
(({ev:r}=H.d(h)).returnValue||v.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));r||(r={});r[b.key]=b.value;this.uca=r;return H.c(r)})}saveSettings(b){this.uca=H.a(b);this.Ddc();return this.Cod()?this.HHj(b):this.dve(b)}HHj(b){try{return localStorage.setItem("AddinShortcutPreferenceData",b),Promise.resolve(!0)}catch(h){return v.ULS.sendTraceTag(522739858,0,10,"SaveSettingToLocalStorage failed",h),Promise.resolve(!1)}}dve(b){const h=
{};h.Wac=b;const r=H.c(h);return new Promise(A=>{try{if(void 0===r||null===r||!r.length||1E6<=r.length)A(!1);else{var M=this.executeRequest(this.BEi(this.YFo),2,"SaveAddinShortcutsPreferenceRequest","38",r);M.continueWith(()=>{if(M.kp||M.fj)v.ULS.sendTraceTag(522739859,0,10,"SaveAddinShortcutsPreference: Request failure"),A(!1);else{var aa=M.result;void 0!==aa.args&&null!==aa.args&&void 0!==aa.args.data&&null!==aa.args.data&&aa.args.data.Ie===ea.a.pz?A(!0):A(!1)}})}}catch(aa){v.ULS.sendTraceTag(522739860,
0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",aa.toString()),A(!1)}})}getSetting(){const b=this.Cod();return this.uca?Promise.resolve(H.c(this.uca)):b?this.$Hm():this.NMf()}Cod(){const b=y.AFrameworkApplication.J.$("IsAnonymousUser"),h=y.AFrameworkApplication.J.$("IsRoamingServiceEnabled");var r=y.AFrameworkApplication.J.ib("Puid");const A=y.AFrameworkApplication.J.ib("UserPrincipalName");r=!(void 0===r||null===r)&&!(void 0===A||null===A)&&0<r.length&&0<A.length;return b||!h||!r}$Hm(){try{const b=
localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(b)}catch(b){return v.ULS.sendTraceTag(522739861,0,10,"GetSettingFromLocalStorage failed",b),Promise.resolve("")}}NMf(){return new Promise((b,h)=>{try{const r=this.executeRequest(this.BEi(this.XFo),1,"GetSettingRequest","37");r.continueWith(()=>{if(r.kp||r.fj)v.ULS.sendTraceTag(522739862,0,10,"GetSettingFromRoaming : Request failure");else{let M="";var A=r.result;A&&A.args&&A.args.data?A.args.data.Ie!==ea.a.pz?v.ULS.sendTraceTag(522739864,
0,10,"GetSettingFromRoaming : Received error response {0}",A.args.data.Ie):A.args.data.De?(A=H.a(A.args.data.De),A.Wac&&(M=A.Wac)):v.ULS.sendTraceTag(522739865,0,10,"GetSettingFromRoaming : ResponseData is null"):v.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");b(M)}})}catch(r){v.ULS.sendTraceTag(522739866,0,10,"GetSettingFromRoaming Exception handling request {0}",r.toString()),h("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(b){const h=this.Cod(),r=
this;return this.getSetting().then(A=>{let M=null;A&&(M=H.a(A));if(!M)return v.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),Promise.resolve(!0);for(const aa of qb.a.xR(M)){A=M[aa.toString()];for(const oa of qb.a.xR(A)){const Ja=A[oa];if(Ja.addinId===b)delete A[oa.toString()];else if(0===Ja.ownerType&&Ja.shortcutInfoArray){const fb=Ja.shortcutInfoArray,Cb=new ib.a;for(let Gb=0;Gb<fb.length;++Gb)fb[Gb].addinId!==b&&Cb.add(fb[Gb]);Ja.shortcutInfoArray=Cb.toArray()}}qb.a.count(A)||
delete A[aa]}r.uca=M;r.Tuo(b);return h?r.HHj(H.c(M)):r.dve(H.c(M))})}Ddc(){if(this.uca){this.Era=null;const r=this.uca;for(const A in r){var b=A;const M=r[A];for(const aa in M){var h=aa;const oa=M[aa];oa.shortcutInfoArray&&this.rdf(parseInt(h),parseInt(b),oa.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(b=>{let h=null;if(b&&!({ev:h}=H.d(b)).returnValue)return v.ULS.sendTraceTag(522739868,0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),
Promise.resolve(!1);this.uca=h;this.Ddc();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(b,h,r){return this.uca&&(r=this.uca[r])&&(h=r[h])&&h.addinId===b?h:null}getShortcutInfoArray(b,h){return this.uca&&(h=this.uca[h])&&(b=h[b])&&b.shortcutInfoArray?b.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(b,h,r){this.saveShortcutInfoArrayBatch(parseInt(b),parseInt(h),r)}setShortcutInfoArray(b,h,r){return this.saveShortcutInfoArray(parseInt(b),parseInt(h),r).then(()=>{this.Ddc();
return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(b,h){if(!this.Era)return Promise.resolve(!0);var r=this.Era[b];if(!r)return Promise.resolve(!0);var A=r[h];r=A.modifiers;A=A.keyCode;const M=this.getShortcutInfoArray(r.toString(),A.toString());if(!M||!M.length)return Promise.resolve(!0);let aa=0;for(const oa of M){if(oa.addinId===b&&oa.action===h)break;++aa}if(aa>=M.length)return Promise.resolve(!0);M.splice(aa,1);return this.saveShortcutInfoArray(r,A,M).then(()=>{this.Ddc();return Promise.resolve(!0)})}rdf(b,
h,r){this.Era||(this.Era={});for(const A of r){r=A.addinId;const M=A.action;let aa=this.Era[r];aa||(aa={});const oa={};oa.modifiers=b;oa.keyCode=h;aa[M]=oa;this.Era[r]=aa}}Tuo(b){b in this.Era&&delete this.Era[b]}isActionCustomized(b,h){return this.Era&&(b=this.Era[b])&&b[h]?!!b[h]:!1}getShortcutByCustomizedAction(b,h){return this.Era&&(b=this.Era[b])?b[h]:null}getShortcutsPreferenceMappingTable(){return this.uca}static instance(){n.Tff||(v.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),
n.Tff=new n,n.HT=y.AFrameworkApplication.Ee);return n.Tff}}n.Tff=null;n.HT=null;Object(u.a)(n,"AddinShortcutsPreferenceSettingHelper",null,[]);class D{constructor(b,h){this.iyd=null;new ib.a;this.Enh=!0;this.zBd=b;this.Fih=h}Qef(b){this.Fih.addHandler("GoalChangedEvent",b)}mPn(){this.Fih.raiseEvent("GoalChangedEvent")}YWf(b,h){return this.iyd&&this.Enh?b in this.iyd?this.iyd[b]:"Formality"===h&&this.zBd.CMf().formality?!1:!0:!0}oPo(b,h){h===this.zBd.CMf().formality&&(this.iyd=b,this.mPn())}wtp(b){this.Enh=
b}}Object(u.a)(D,"GoalChangeSource",null,[251,252,253]);var V=d(1572),ha=d(1691),Ga=d(1402);class mb{constructor(b,h,r,A,M,aa){this.XQa=h;this.$Fa=r;this.Te=b;this.yC=A;this.Pg=M;this.Ivk=aa;this.$Fa.ESb()&&this.initialize()}initialize(){return this.yC.hm().then(()=>{this.Te.nb(this,V.a.getTypeName());this.Te.addHandler(this,ha.a.getTypeName())}).catch(b=>{this.Pg.sendTraceTag(528274563,2252,10,"EnsureAugLoopRuntimeManager threw exception when registering to GoalsAnnotation.",b)})}ZG(b,h){if(h===
hc.a.getTypeName()||h===Ga.a.getTypeName())if(!b||!b.content)this.Pg.sendTraceTag(528274564,2252,10,"Handled annotation is invalid");else if(wa.a.getTypeNameFor(b.content)===V.a.getTypeName()||wa.a.getTypeNameFor(b.content)===ha.a.getTypeName())if(wa.a.getTypeNameFor(b.content)===V.a.getTypeName()){var r=b.content;this.Pg.sendTraceTag(528274565,2252,50,"Goal annotation received with formality goal: {0}",r.critiqueConfiguration.formalityGoal);this.XQa.oPo(r.critiqueConfiguration.mapping,r.critiqueConfiguration.formalityGoal)}else if(wa.a.getTypeNameFor(b.content)===
ha.a.getTypeName())if(b=b.content,b.features){for(r of b.features)if("Goals"===r.featureName){this.Ivk.wtp(!!r.supportType);return}this.Pg.sendTraceTag(528274567,2252,10,"No goals feature in multilingualFeaturesAnnotation")}else this.Pg.sendTraceTag(528274566,2252,10,"MultilingualFeaturesAnnotation.Features is null")}}Object(u.a)(mb,"GoalsAnnotationHandler",null,[229]);class Ub{constructor(b){this.Ga=b}ESb(){return this.Ga.$("EditorGoalsEnabled")}}Object(u.a)(Ub,"GoalsGate",null,[249]);var uc=d(1123),
Cc=d(1129),Xc=d(1510);class rd{}rd.RYd=0;rd.WYd="1.0";rd.settingType="Goals";Object(u.a)(rd,"GoalsConstants",null,[]);var td=d(1571);class Ad{constructor(b,h,r,A,M){this.A9b=null;this.gXi=!1;this.kyh=b;this.BBd=h;this.Pg=r;this.$Fa=A;this.GSe=M;this.$Fa.ESb()?this.Xko():this.$Fa.ESb()&&this.$wg(rd.RYd,rd.WYd)}Xko(){new Promise(b=>{this.kyh.OCi(rd.settingType,h=>{this.Yko(h)?(this.$wg(this.A9b.formality,this.A9b.version),b(this.A9b)):(this.$wg(rd.RYd,rd.WYd),b(null))})})}Yko(b){this.gXi=!0;if(!b||
!b.pyb)return this.Pg.sendTraceTag(528274529,2252,50,"No persisted goal is registered."),!1;b=b.pyb.properties;var h=b.getValue(Mc.a.PRi);h=parseInt(h);b=b.getValue(Mc.a.QRi);if(!this.BBd.WMg(b))return this.Pg.sendTraceTag(528274530,2252,10,"Trying to read unsupported persisted formality goal version. Goal version {0}",b),!1;this.A9b=b=Object.assign(new td.a,{formality:h,version:b});this.Pg.sendTraceTag(528274531,2252,50,"Persisted goal received with formality goal: {0} and version: {1}",b.formality,
b.version);return!0}$wg(b,h){b=Object.assign(new Xc.a,{formality:b,version:h});this.GSe.eKj(b)}oHp(b){if(this.BBd.WMg(b.version)){var h=uc.a.TDl(b.version,b.formality.toString());this.kyh.KMh(Object.assign(new Cc.a,{pyb:h,settingType:rd.settingType}))?this.A9b=b:this.Pg.sendTraceTag(528274561,2252,10,"Write persisted goal failed.")}else this.Pg.sendTraceTag(528274560,2252,10,"Trying to write unsupported formality goal version. Goal version {0}",b.version)}wzi(){this.gXi||this.Pg.sendTraceTag(528274562,
2252,10,"Trying to get persisted goal that is not read yet.");return this.A9b}}Object(u.a)(Ad,"GoalsPersistenceHandler",null,[248]);class Xd{constructor(b,h,r,A){this.Pg=b;this.HSe=h;this.BBd=r;this.$Fa=A;this.ABd=Object.assign(new td.a,{formality:rd.RYd,version:rd.WYd});this.G7e=this.$Fa.ESb()}CMf(){this.G7e&&(this.G7e=!1,this.HSe.wzi()&&(this.ABd=this.HSe.wzi()));return this.ABd}lVo(b){this.G7e=!1;this.BBd.WMg(b.version)?(this.$Fa.ESb()&&this.HSe.oHp(b),this.ABd=b):(this.Pg.sendTraceTag(528274528,
2252,10,"Unsupported formality goal version. Goal version {0}",b.version),this.ABd=Object.assign(new td.a,{formality:rd.RYd,version:rd.WYd}))}}Object(u.a)(Xd,"GoalsProvider",null,[244,245]);class Ke{constructor(b,h,r,A){this.Te=b;this.yC=h;this.CY=r;this.Pg=A}eKj(b){b=Object.assign(new hc.a,{parentPath:["Signal",Xc.a.getTypeName()],items:[Object.assign(new Gc.a,{body:b})]});this.m0d(b)}m0d(b){this.yC.hm().then(()=>{this.Mcf(b)}).catch(h=>{this.Pg.sendTraceTag(528274526,2250,10,"EnsureAugLoopRuntimeManager threw exception.",
h)})}Mcf(b){this.Te.activateAnnotation(V.a.getTypeName(),Ke.Ecc).then(()=>{this.CY.getAugLoopRuntimeManager().submitOperation(Object.assign(new Ma.a,{operation:b}))}).catch(h=>{this.Pg.sendTraceTag(528274527,2250,10,"Activating GoalsAnnotation threw exception.",h)})}}Ke.Ecc="GoalSelected";Object(u.a)(Ke,"GoalsSignalSender",null,[243]);class Ye{constructor(){Ye.vbf=new RegExp(Ye.cQk)}WMg(b){return!!b.match(Ye.vbf)&&1===b.match(Ye.vbf).length}}Ye.cQk="[0-9]+[.]?[0-9]*";Ye.vbf=null;Object(u.a)(Ye,"GoalsValidator",
null,[239]);class eg{constructor(){this.W=null}get name(){return"WordEditor.Goals"}init(){this.W.resolve(1042)}dispose(){}uc(b){this.W=b;this.W.ia("WordEditor.Goals.GoalsValidator",()=>new Ye).as(1044).ha();this.W.ia(1045,()=>new Ub(this.W.resolve(71))).ha();this.W.ia("WordEditor.Goals.GoalsProvider",()=>new Xd(this.W.resolve(457),this.W.resolve(1043),this.W.resolve(1044),this.W.resolve(1045))).as(1046).as(1528).ha();this.W.ia("WordEditor.Goals.GoalChangeSource",()=>new D(this.W.resolve(1046),new Td.a)).as(1054).as(1049).as(1050).ha();
this.W.ia(1043,()=>new Ad(this.W.resolve(1047),this.W.resolve(1044),this.W.resolve(457),this.W.resolve(1045),this.W.resolve(1048))).as("WordEditor.Goals.IGoalsPersistenceHandler").ha();this.W.ia(1042,()=>new mb(this.W.resolve(451),this.W.resolve(1049),this.W.resolve(1045),this.W.resolve(657),this.W.resolve(457),this.W.resolve(1050))).as(1042).ha();this.W.ia("WordEditor.Goals.GoalsSignalSender",()=>new Ke(this.W.resolve(451),this.W.resolve(657),this.W.resolve(658),this.W.resolve(457))).as(1048).ha()}static main(){K.a.instance.Lc(new eg)}}
Object(u.a)(eg,"WordEditorGoalsPackage",null,[0,1]);var Lg=d(1824),Ch=d(622),rj=d(1423);class Bj{constructor(){this.annotation=null;this.languages=new vk.a(Na.a.th())}}Object(u.a)(Bj,"CritiqueCountWrapper",null,[]);class Ok{constructor(){this.Ewa=new cb.a}T4d(){return this.Ewa}mPi(b,h,r,A){if(this.Ewa.lb(r)){this.Ewa.K(r).annotation.count+=h;r=this.Ewa.K(r).languages;for(var M of A)r.add(M)}else M=N.a.create().toString(),b=Object.assign(new rj.a,{id:M,categoryName:b,count:h}),this.Ewa.add(r,Object.assign(new Bj,
{annotation:b,languages:A}))}}Ok.lj=389;Object(u.a)(Ok,"BaseCritiquesByTypeCounter",null,[223]);class Ug extends Ok{constructor(b){super();this.iHb=new Sa.a;this.qNe=new Sa.a;this.iPd=b}HRm(b){const h=b.annotation;try{if(h&&Ch.a(wa.a.getTypeNameFor(h.content))){const r=h.content;if(b.opType===hc.a.getTypeName()){this.iPd.ixo(h.parentPath,r);const A=r.M_.state;if(60!==A&&70!==A)return this.iHb.contains(h.id)&&this.iHb.remove(h.id),this.F1m(h.id,r),Lg.a.$yb(h,8),!0;this.iHb.add(h.id)}else if(b.opType===
eb.a.getTypeName())if(this.iHb.contains(h.id))this.iHb.remove(h.id);else if(this.pbi(r.typeId,h.id))return Lg.a.$yb(h,16),!0}}catch(r){Lg.a.qbd(r,[h],!0)}return!1}GRm(b){if((b=b.annotation)&&Ch.a(wa.a.getTypeNameFor(b.content))){const h=b.content,r=h.M_.state;if((60===r||70===r)&&!this.iHb.contains(b.id))return this.iHb.add(b.id),this.pbi(h.typeId,b.id)}return!1}F1m(b,h){this.qNe.add(b);b=new vk.a(Na.a.th());h.language&&b.add(h.language);this.mPi(h.categoryName,1,h.typeId,b)}pbi(b,h){if(!this.qNe.contains(h))return!1;
if(!this.Ewa.lb(b))return v.ULS.sendTraceTag(589866503,Ok.lj,15,"Unable to decrement the count for critique category {0}. Reason : {1}",b,"Category not found in CritiqueCountsByCategory dictionary"),!1;if(0>=this.Ewa.K(b).annotation.count)return v.ULS.sendTraceTag(589866504,Ok.lj,15,"Unable to decrement the count for critique category {0}. Reason : {1}",b,"Current count is less than or equal to 0"),!1;this.qNe.remove(h);this.Ewa.K(b).annotation.count--;return!0}}Object(u.a)(Ug,"AlCritiquesByTypeCounter",
Ok,[225,223]);var Oj=d(1639);class Sh extends Ct.a{constructor(b,h,r,A,M,aa,oa,Ja,fb){var Cb;super();this.Te=b;this.iPd=h;this.eJe=r;this.Bdh=A;this.XQa=M;this.Mxa=aa;this.kj=oa;this.wda=this.Wbh=!1;this.T0e=new cb.a;this.NUn=(Gb,Sb)=>{this.iPd.HSm(Sb)&&(this.wda=!0,this.p0())};this.LRn=(Gb,Sb)=>{this.eJe.HRm(Sb)&&this.YZb()};this.Kij=()=>{this.YZb()};this.ycg=(Gb,Sb)=>{this.eJe.GRm(Sb)&&this.YZb()};this.nvb=()=>{this.YZb()};this.YZb=()=>{let Gb=!1;this.kj.$d(()=>{var Sb=this.Clm();const pc=new ib.a;
for(const zc of Sb)Sb=Object.assign(new Oj.a,{id:zc.id,parentPath:xs.a.jNb,content:zc,annotationType:wa.a.getTypeNameFor(zc)}),pc.add(Sb),Gb||(Gb=0<zc.count);this.Te.nPo(pc)},"CC:SATH");!this.Wbh&&Gb&&(ca.a.sendTelemetryEvent({...(new la.a),name:"Office.Word.Online.Editor.CritiquesAvailable"}),this.Wbh=!0)};this.Gdn=(Gb,Sb,pc)=>{const zc=!this.XQa||this.XQa.YWf(Gb,pc);Gb=this.Mxa&&this.Mxa.instance?this.Mxa.instance.XWf(Gb,pc,Sb.substr(1,Sb.length-2)):!0;return zc&&Gb};null===Ja||void 0===Ja?void 0:
Ja.Qef(this.nvb);fb.hva(this,7);null===(Cb=this.Mxa)||void 0===Cb?void 0:Cb.execute(Gb=>{Gb.pff(this.YZb)})}get index(){return 3}run(){this.wda&&(this.YZb(),this.wda=!1)}hlj(){this.YZb()}yAl(b){let h=0;if(({value:h}=this.T0e.Ac(b.categoryName,0)).returnValue)if(h!==b.count)this.T0e.Z(b.categoryName,b.count);else return!1;else this.T0e.add(b.categoryName,b.count);return!0}Clm(){const b=new cb.a;var h=this.iPd.T4d();const r=this.eJe.T4d();this.IKg(b,h);this.IKg(b,r);this.Bdh&&(h=this.Bdh.T4d(),this.IKg(b,
h));h=new ib.a;for(const A of b.values)this.yAl(A)&&h.add(A);return h}IKg(b,h){for(const M of h){h=M.value.annotation;const aa=M.key;var r=this.jNo(M.value.languages);if(!b.lb(h.categoryName)){var A=N.a.create().toString();A=Object.assign(new rj.a,{id:A,categoryName:h.categoryName,count:0,countsByTypeId:{}});b.add(h.categoryName,A)}this.Gdn(aa,r,h.categoryName)&&(r=b.K(h.categoryName),r.count+=h.count,r.countsByTypeId[aa]=(r.countsByTypeId[aa]?r.countsByTypeId[aa]:0)+h.count)}}jNo(b){const h=[];let r=
0;for(const A of b)h[r++]=A;return H.c(h)}}Object(u.a)(Sh,"CritiquesCounter",Ct.a,[226,227]);class $i{constructor(b){this.k5=b}T4d(){const b=new cb.a,h=new vk.a(Na.a.th()),r=Object.assign(new rj.a,{id:"a8f8d183-1cc4-4f3c-8483-23ae2e6d092b",categoryName:"Did you say?",count:this.k5.wEc.count});b.add("33ab9b0e-2399-4300-a09f-ec2dbfcbf96e",Object.assign(new Bj,{annotation:r,languages:h}));return b}}Object(u.a)($i,"DictationCritiquesByTypeCounter",null,[224,223]);class Wh extends Ok{constructor(b){super();
this.Mgb=new cb.a;this.Te=b}HSm(b){const h=xs.a.m7d(b.nodeId);if(!xs.a.Tf(h)){if(b.$ob&&b.$ob.length){let r=null;for(const A of b.$ob)A.errorDetails.X$a()||(b=this.Wui(A),xs.a.Tf(b)||(r||(r=new cb.a),r.lb(b)||r.add(b,new ib.a),r.K(b).add(A)));this.qbi(h);r?this.jTo(h,r):this.Mgb.remove(h)}else{if(!this.Mgb.lb(h))return!1;this.qbi(h);this.Mgb.remove(h)}return!0}return!1}ixo(b,h){var r;if(({value:r}=this.Mgb.Ac(b,r)).returnValue)for(const M of r)if(b=M.value,0<b.count&&this.uHf(b.K(0))===h.categoryName)for(r=
b.count-1;0<=r;r--){var A=b.K(r).end-b.K(r).Ec;b.K(r).Ec===h.range.start&&A===h.range.length&&(A=this.Wui(b.K(r)),this.Ewa.lb(A)&&(A=this.Ewa.K(A).annotation,A.count=Math.max(0,A.count-1)),b.removeAt(r))}}qbi(b){if(this.Mgb.lb(b))for(const r of this.Mgb.K(b)){var h=r.key;b=r.value;this.Ewa.lb(h)&&(h=this.Ewa.K(h).annotation,h.count=Math.max(0,h.count-b.count))}}jTo(b,h){const r=new cb.a,A=new cb.a;for(const M of h){h=M.key;A.add(h,new vk.a(Na.a.th()));for(const aa of M.value){const oa=aa.end-aa.Ec,
Ja=this.uHf(aa);this.sml(b,Ja,aa.Ec,oa)?v.ULS.sendTraceTag(589866513,Ok.lj,50,"Canvas annotation category {0} for parent path {1} in range (start {2},length {3}) already received from AL. Skipping this",h,b,aa.Ec,oa):(r.lb(h)||r.add(h,new ib.a),r.K(h).add(aa),A.K(h).add(this.Elm(aa)))}}this.Mgb.Z(b,r);for(const M of this.Mgb.K(b))0<M.value.count&&(b=this.uHf(M.value.K(0)),this.mPi(b,M.value.count,M.key,A.K(M.key)))}Wui(b){let h=null;b&&(b=Object(ya.a)(221,b.errorDetails))&&b.yu&&(h=b.yu.TypeId);return h}uHf(b){let h=
null;b&&(b=Object(ya.a)(221,b.errorDetails))&&b.yu&&(h=b.yu.CategoryTitle);return h}Elm(b){let h="";b&&b.errorDetails&&(h=tj.a.Hg(b.errorDetails.lcid).name);return h}sml(b,h,r,A){if((b=this.Te.NFf(b))&&0<b.count)for(const M of b)if(b=wa.a.getTypeNameFor(M.content),M&&Ch.a(b)&&(b=M.content,b.categoryName===h&&b.range.start===r&&b.range.length===A))return!0;return!1}}Object(u.a)(Wh,"WacCritiquesByTypeCounter",Ok,[222,223]);class Fi{constructor(){this.W=null}get name(){return"WordEditor.CritiqueCounts"}uc(b){this.W=
b}init(){var b=this.W.resolve(71);if(b.$("AugLoopOperationsAreEnabled")){this.W.ia(1051,()=>new Wh(this.W.resolve(451))).ha();this.W.ia(1052,()=>new Ug(this.W.resolve(1051),this.W.resolve(71))).ha();var h=b.$("DictationCorrectionsInEditorPaneIsEnabled");h&&this.W.ia(1053,()=>new $i(this.W.resolve(68))).ha();this.W.ia(1055,()=>new Sh(this.W.resolve(451),this.W.resolve(1051),this.W.resolve(1052),this.W.Oa(1053),this.W.Oa(1049),this.W.Ra(996),er.a.instance,this.W.Oa(1054),this.W.resolve(201))).ha();
b=this.W.resolve(1055);this.W.resolve(43).vOh(b.NUn);this.W.resolve(451).iZk(b.LRn);this.W.resolve(451).gOh(b.ycg);h&&(h=this.W.resolve(323),h.SNh(b.Kij),h.TNh(b.Kij))}}dispose(){}static main(){K.a.instance.Lc(new Fi)}}Object(u.a)(Fi,"WordEditorCritiqueCountsPackage",null,[0,1]);class Km{get name(){return"WordEditor.GraphicsEditor"}uc(){}init(){}dispose(){}static main(){K.a.instance.Lc(new Km)}}Object(u.a)(Km,"PackageManager",null,[0,1]);var fl=window.PasteFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},
children:[{name:"Floatie",attrs:{Id:"WordEditor.PasteFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"PasteOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PasteFloatie.FlyoutAnchor",LabelText:"(Ctrl)",Image16by16:"IMGMAP@we@Paste_16x16x32",
Alt:"STR@L_PasteOptionsWithCtrl",DisplayMode:"Medium",TemplateAlias:"Paste"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msPasteOptionsButtons",Title:"STR@L_PasteOptions",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0x5FA36C32",QueryCommand:"0x57455F86",Image16by16:"IMGMAP@we@PasteSourceFormatting_16x16x32",
Alt:"STR@L_PasteWithSourceTheme",LabelText:"STR@L_PasteWithSourceTheme"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0x8E28DB06",QueryCommand:"0x8A0031FF",Image16by16:"IMGMAP@we@PasteTextOnly_16x16x32",Alt:"STR@L_PasteTextOnly",LabelText:"STR@L_PasteTextOnly"}},{name:"ToggleButton",attrs:{Id:"floatie.gbFormatWithDesignerButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteFormatWithDesignerTooltipUnavailable",
LabelText:"STR@L_PasteFormatWithDesigner"}},{name:"ToggleButton",attrs:{Id:"floatie.gbMatchDocumentFormattingButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteMatchDocumentFormattingTooltipUnavailable",LabelText:"STR@L_PasteMatchDocumentFormatting"}},{name:"ToggleButton",attrs:{Id:"floatie.gbUseSmartPasteButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteUseSmartPasteTooltipUnavailable",
LabelText:"STR@L_PasteUseSmartPaste"}}]}]}]}]}]}]}]}]}]}]}]};class qt{constructor(b){this.osk={};this.Yb=b;this.sHb=new eh.a}XUa(b,h){const r=this.Yb.swb,A=parseInt(b);return b&&A!==ce.ActionManager.bzf?this.sHb.lb(r)?(b=this.sHb.K(r).$kc(A,h,2),32===b||1===b):!1:!1}BLa(b){const h=parseInt(b),r=this.Yb.swb;return b&&h!==ce.ActionManager.bzf?this.sHb.lb(r)?32===this.sHb.K(r).$kc(h,this.osk,1):!1:!0}uzj(b,h){this.sHb.Z(b,h)}PQj(b){b=parseInt(b);const h=this.Yb.swb;return!!h&&!!this.sHb.K(h)&&this.sHb.K(h).Mcn(b)}}
Object(u.a)(qt,"NonCanvasCuiUser",null,[1795,218]);var Ft=d(1151),SB;(function(b){b[b.fOp=0]="UnspecifiedGallery";b[b.OIp=1]="CharacterCodeGallery";b[b.oKp=2]="FontStyleGallery";b[b.QKp=3]="InkThicknessGallery";b[b.MKp=4]="IconGallery";b[b.hLp=5]="ListGallery";b[b.CNp=6]="TableStyleGallery";b[b.jMp=7]="PageNumberGallery";b[b.NIp=8]="ChangeColorsGallery"})(SB||(SB={}));Object(u.b)("GalleryType",SB);class Ws{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(u.a)(Ws,"CommonGalleryButtonProps",
null,[]);class qD extends Ws{constructor(){super();this.tableStyles=this.tableCellStyles=null;this.columns=0}}Object(u.a)(qD,"AdditionalTableStyleGalleryButtonProps",Ws,[]);class Xs extends qD{constructor(){super()}}Object(u.a)(Xs,"AdditionalChangeColorsGalleryButtonProps",qD,[]);class hu extends Ws{constructor(){super();this.character=null}}Object(u.a)(hu,"AdditionalCharacterCodeGalleryButtonProps",Ws,[]);class Ys extends Ws{constructor(){super();this.previewStyleLabel=this.styleDisplayName=null}}
Object(u.a)(Ys,"AdditionalFontStyleGalleryButtonProps",Ws,[]);class jK{constructor(){this.selectedId=this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}Object(u.a)(jK,"AdditionalGalleryProperties",null,[]);class kz extends Ws{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.role=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(u.a)(kz,"AdditionalIconButtonProperties",
Ws,[]);class Sr extends Ws{constructor(){super();this.styleDisplayName=null}}Object(u.a)(Sr,"AdditionalInkThicknessGalleryButtonProps",Ws,[]);class lz extends Ws{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(u.a)(lz,"AdditionalListGallerButtonProps",Ws,[]);class ry extends Ws{constructor(){super();this.text=null}}Object(u.a)(ry,"AdditionalPageNumberGalleryButtonProps",Ws,[]);var iu=d(1085);const kK=(b,h)=>{var r=appChrome.selectors.getActiveControlStates();if(r=Object(ya.a)(Object,
r[b])){if((b=Object(ya.a)(String,r.value))&&b===h)return!1;b=Object(ya.a)(String,r.selectedKey);if(!h&&!b)return!1;if(b){r=Array.isArray(r.options)?r.options:null;let A=null;for(let M=0;M<r.length;M++){const aa=Object(ya.a)(Object,r[M]);if(Object(ya.a)(String,aa.key)===b){A=aa;break}}if(A&&Object(ya.a)(String,A.text)===h)return!1}}return!0},Gt=(b,h,r,A)=>{if(0<(A&2)){A=[];switch(h){case "ToggleButtonModel":case "InkButtonModel":A.push(sv(b,r[Vg.a.On]));break;case "CheckboxModel":A.push(appChrome.actions.toggleCheckbox(b,
r[Vg.a.On]));break;case "ComboBoxModel":if(y.AFrameworkApplication.J&&(y.AFrameworkApplication.J.$("ReactRibbonDispatchActionFilter")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1))&&!kK(b,r[ja.a.Value]))break;(h=r[ja.a.Key])?A.push(appChrome.actions.updateComboBoxKey(b,h,r[ja.a.Value])):A.push(appChrome.actions.updateComboBoxValue(b,r[ja.a.Value]));break;case "FontPickerModel":A.push(appChrome.actions.updateFontPickerSelectedFont(b,
r[iu.a.SelectedFont]));break;case "SplitButtonModel":A.push(sv(b,r[Am.a.On]));break;case "SpinButtonModel":A.push(appChrome.actions.updateSpinButton(b,r[ui.a.Number],Jg.a.R6a(r[ui.a.UnitType]),r[ui.a.Text],r[ui.a.MaxValue],r[ui.a.Alt]));break;case "ColorPickerModel":A.push(appChrome.actions.updateColorPickerSelectedColor(b,r[qo.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":A.push(appChrome.actions.updatePageNumberGalleryButtonText(b,r[Pd.a.Text]));break;case "CompoundButtonModel":r[Vg.a.Description]&&
A.push(appChrome.actions.updateCompoundButtonDescription(b,r[Vg.a.Description]));Vg.a.On in r&&A.push(sv(b,r[Vg.a.On]));break;case "SliderModel":r.snapToStep?A.push(appChrome.actions.updateSliderSelectedValue(b,r[nj.Value])):A.push(appChrome.actions.updateSliderValue(b,r[nj.Value],r[nj.MinValue]||0,r[nj.MaxValue],r[nj.Text]));break;case "FlyoutAnchorModel":Rc.a.ImageIsVisible in r&&A.push(appChrome.actions.hideFlyoutAnchorIcon(b,!r[Rc.a.ImageIsVisible]));Vg.a.On in r&&A.push(sv(b,r[Vg.a.On]));break;
case "InputBoxModel":A.push(appChrome.actions.updateInputBoxValue(b,r[ml.a.Text]))}h=A;var M=Object(ya.a)(String,r[Pm.a.iconColor]);void 0!==M&&null!==M&&h.push(appChrome.actions.updateIconColor(b,M));TB(b,r,A);h=A;(M=Object(ya.a)(Object,r[Pm.a.IconSet]))&&h.push(appChrome.actions.setControlIconSet(b,M));h=A;M=Object(ya.a)(String,r[Pm.a.customTooltip]);void 0!==M&&null!==M&&h.push(appChrome.actions.setControlCustomTooltip(b,M));b=A;(r=Array.isArray(r[Pm.a.Apg])?r[Pm.a.Apg]:null)&&b.push.apply(b,r);
return A}return null},sy=(b,h)=>appChrome.actions.updateControlEnabledDisabledState(b,h),sv=(b,h)=>appChrome.actions.toggleButton(b,h),TB=(b,h,r)=>{h=Object(ya.a)(String,h[Pm.a.Icon]);void 0!==h&&null!==h&&r.push(appChrome.actions.setControlIcon(b,h))};class rD{constructor(b,h,r,A){this.vl=A;this.Wxa=b;this.vB=h;this.p$b=r;this.rJc={}}s$n(b,h,r,A,M=null){const aa=b.ExternalGalleryId||b.ExternalId;var oa=b.ExternalId;A.push(aa);if(appChrome.selectors.isControlDefined(aa))b.GalleryStyle&&hh.d("setGalleryStyles")&&
h.push(appChrome.actions.setGalleryStyles(aa,b.GalleryStyle));else{if(4!==b.Type)return;r.push(appChrome.api.createGalleryModel(aa,Object.assign(new jK,{columns:b.Width,sections:[appChrome.api.gallerySection([],oa)],styles:b.GalleryStyle,galleryType:"IconGallery"})))}r=0;A=!!y.AFrameworkApplication.J&&(y.AFrameworkApplication.J.$("ReactRibbonDispatchActionFilter")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1));if(hh.d("setGallerySections")&&
b.GallerySections&&0<b.GallerySections.length){oa=[];const fb=[],Cb=[],Gb={};for(var Ja of b.GallerySections){oa.push(appChrome.api.gallerySection([],Ja.SectionId,Ja.Title));0===r&&Ja.GalleryButtons&&0<Ja.GalleryButtons.length&&(r=Ja.GalleryButtons[0].Type);A&&this.hDi(Ja.GalleryButtons,M,Gb);const Sb=this.Cdf(fb,Ja.GalleryButtons,Gb);fb.push.apply(fb,this.JLf(Sb,aa,Ja.SectionId,!1,r,M,!0,Gb));Cb.push.apply(Cb,Sb)}h.push(appChrome.actions.setGallerySections(aa,oa));h.push.apply(h,fb);h.push.apply(h,
this.aJf(aa,SB[r],Cb,null,5===b.Type,!0,null,Gb))}else b.GalleryItems&&0<b.GalleryItems.length&&(r=b.GalleryItems[0].Type),Ja=A?this.hDi(b.GalleryItems,M,null):null,h.push.apply(h,this.JLf(this.Cdf(h,b.GalleryItems,Ja),aa,oa,!1,r,M,!1,Ja))}MDm(b,h){const r=[];let A=null,M=!1;if(!b)return null;const aa=this.Wxa.Cgd(this.vB,b.commandId,h);r.push(sy(b.externalUxCommand,!aa));if(b.previewControlIds){const fb=[];for(let Cb=0;Cb<b.previewControlIds.length;Cb++){var oa={},Ja=b.previewControlIds[Cb];oa.SourceControlId=
Ja;const Gb=this.vl.getCommandByExternalUxId(Ja);this.A7d(Gb||b,oa);oa[Pd.a.On]&&(A=oa.SourceControlId,oa[Pd.a.HighlightOn]&&(M=!0));TB(Ja,oa,r);if(oa=Object(ya.a)(gy.a,oa[Pd.a.GalleryButtonProps]))fb.push(oa),aa&&(Ja=this.Wxa.Cgd(this.vB,oa.Command,h),oa.IsDisabled=!Ja)}0<fb.length&&r.push.apply(r,this.JLf(this.Cdf(r,fb),b.externalUxCommand,b.externalUxCommand,!0,fb[0].Type));r.push(appChrome.actions.updateGallerySelectedId(b.externalUxCommand,A));M&&(v.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",
A),r.push(appChrome.actions.highlightSelectedFontStyle(A)))}return r}Cdf(b,h,r=null){const A=[],M=[];for(let oa=0;oa<h.length;oa++){const Ja=h[oa],fb=yf.b(Ja.ExternalId)?Ja.Id:Ja.ExternalId;A.push(fb);const Cb=r&&r[fb]?r[fb].result:-1;switch(Ja.Type){case 1:var aa=Ja;M.push(appChrome.api.createCharacterCodeGalleryButtonModel(fb,Object.assign(new hu,{disabled:-1!==Cb?1>(Cb&1):aa.IsDisabled,character:aa.Character,style:aa.Style,title:aa.Alt})));break;case 2:aa=Ja;M.push(appChrome.api.createFontStylesGalleryButtonModel(fb,
Object.assign(new Ys,{disabled:-1!==Cb?1>(Cb&1):aa.IsDisabled,styleDisplayName:aa.LabelText,style:aa.Style,title:aa.Alt,previewStyleLabel:aa.PreviewStyleLabel})));break;case 3:aa=Ja;M.push(appChrome.api.createInkThicknessGalleryButtonModel(fb,Object.assign(new Sr,{disabled:-1!==Cb?1>(Cb&1):aa.IsDisabled,styleDisplayName:aa.LabelText,style:aa.Style,title:aa.Alt})));break;case 4:aa=Ja;M.push(appChrome.api.createIconGalleryButtonModel(fb,Object.assign(new kz,{disabled:-1!==Cb?1>(Cb&1):aa.IsDisabled,
icon:[aa.Icon],role:aa.Role,fullIconStyle:aa.FullIconStyle,previewIconStyle:aa.PreviewIconStyle,largePreviewIconStyle:aa.LargePreviewIconStyle,label:aa.LabelText,title:aa.Alt})));break;case 5:aa=Ja;M.push(appChrome.api.createListGalleryButtonModel(fb,Object.assign(new lz,{disabled:-1!==Cb?1>(Cb&1):aa.IsDisabled,infoAtLevel:aa.LevelInfo,ariaLabel:aa.Alt})));break;case 6:aa=Ja;M.push(appChrome.api.createTableStyleGalleryButtonModel(fb,Object.assign(new qD,{disabled:-1!==Cb?1>(Cb&1):aa.IsDisabled,tableCellStyles:aa.TableCellStyles,
tableStyles:aa.TableStyles,title:aa.Alt,columns:aa.columns})));break;case 8:aa=Ja;M.push(appChrome.api.createChangeColorsGalleryButtonModel(fb,Object.assign(new Xs,{disabled:-1!==Cb?1>(Cb&1):aa.IsDisabled,tableCellStyles:aa.TableCellStyles,tableStyles:aa.TableStyles,title:aa.Alt})));break;case 7:aa=Ja,M.push(appChrome.api.createPageNumberGalleryButtonModel(fb,Object.assign(new ry,{disabled:-1!==Cb?1>(Cb&1):aa.IsDisabled,text:aa.Text,title:aa.Alt})))}this.vl.addCommandToMaps(Object.assign(new Yu.a(fb,
Ja.Command),{queryCommandId:Ja.QueryCommand,menuItemId:Ja.MenuItemId}))}b.push(appChrome.actions.addControls(M));return A}JLf(b,h,r,A,M,aa=null,oa=!1,Ja=null){const fb=[];A?fb.push(appChrome.actions.populateGalleryItems(h,b)):(this.rJc[h]=!1,oa||(A=!0,appChrome.selectors.isControlDefined(h)&&(A=appChrome.selectors.getGalleryState(h),A=A.disableIndividualButtons?A.disableIndividualButtons:!0),fb.push.apply(fb,this.aJf(h,SB[M],b,null,5===M,A,aa,Ja))),fb.push(appChrome.actions.updateGallerySectionItems(h,
r,b)));return fb}trm(b){return this.aJf(b.ExternalUxId,b.galleryType,b.items,b.sections,b.isListGallery,b.disableIndividualButtons?b.disableIndividualButtons:!0)}aJf(b,h,r,A,M,aa=!0,oa=null,Ja=null){const fb=[];if(b in this.rJc){if(this.rJc[b])return delete this.rJc[b],fb;this.rJc[b]=!0}let Cb=null,Gb=-1;if(r)({jqi:Gb,returnValue:Cb}=this.ZLh(h,r,fb,aa,oa,Ja));else if(A)for(const Sb of A)(r=({jqi:Gb}=this.ZLh(h,Sb.galleryButtons,fb,aa,null,Ja)).returnValue)&&(Cb=r);fb.push(appChrome.actions.updateGallerySelectedId(b,
Cb));aa&&fb.push(sy(b,!1));M&&0<Gb&&fb.push(appChrome.actions.updateListGalleryTextDirection(b,2===Gb));return fb}gDi(b,h=null){const r={},A={};A.SourceControlId=b;A.Location=h;b=this.vl.getCommandByExternalUxId(b);if(!b)return r.result=-1,r.props=A,r;b=this.A7d(b,A);r.result=b;r.props=A;return r}hDi(b,h=null,r=null){r||(r={});for(const A of b)b=yf.b(A.ExternalId)?A.Id:A.ExternalId,r[b]=this.gDi(b,h);return r}ZLh(b,h,r,A,M=null,aa=null){let oa,Ja=null;oa=-1;let fb=!1;for(const Gb of h){var Cb=this.qrm(b);
h=aa&&aa[Gb]&&-1!==aa[Gb].result?aa[Gb]:this.gDi(Gb,M);const Sb=h.result;h=h.props;A&&r.push(sy(Gb,1>(Sb&1)));(Cb=Gt(Gb,Cb,h,Sb))&&r.push.apply(r,Cb);h[Pd.a.On]&&(Ja=Gb,h[Pd.a.HighlightOn]&&h[Pd.a.HighlightOn]&&(fb=!0));void 0!==h[Pm.a.labelText]&&null!==h[Pm.a.labelText]&&(Cb=this.vl.getCommandByExternalUxId(Gb),r.push(appChrome.actions.setControlLabel(Cb.externalUxCommand,h[Pm.a.labelText])));h[Pd.a.IsRtl]&&0>oa&&(oa=h[Pd.a.IsRtl])}fb&&(v.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",
Ja),r.push(appChrome.actions.highlightSelectedFontStyle(Ja)));return{returnValue:Ja,jqi:oa}}qrm(b){switch(b){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";
case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}A7d(b,h){h.MenuItemId=b.menuItemId;return this.Wxa.Cua(this.vB,this.p$b,b.commandId,b.queryCommandId,h)}}Object(u.a)(rD,"ReactGalleryPoller",null,[]);var lK=d(695),sD=d(647),UH=d(1694),Ax=d(771),ty=d(1695);class Wm{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(u.a)(Wm,"PopulateFontPickerDataProps",null,[]);var mK=d(285),Zv=d(1878);
class ju{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;this.shouldTakeFocus=!1}}Object(u.a)(ju,"CommonOptionalButtonProperties",null,[]);class Iw extends ju{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null;this.dismissHostingSurfaceOnExecute=!1}}Object(u.a)(Iw,"OptionalButtonProperties",ju,[]);class VH extends ju{constructor(){super();this.ariaDescription=
this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(u.a)(VH,"OptionalCompoundButtonProperties",ju,[]);class WH extends ju{constructor(){super();this.onRetryCommandId=this.retryButtonTitle=this.ariaDescription=this.label=null}}Object(u.a)(WH,"OptionalErrorViewProperties",ju,[]);class XH extends ju{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=
null}}Object(u.a)(XH,"OptionalFlyoutAnchorProperties",ju,[]);class Vd extends ju{constructor(){super();this.isBanner=null}}Object(u.a)(Vd,"OptionalLabelProperties",ju,[]);class $v extends ju{constructor(){super();this.commandValueId=this.actionCommandValueId=this.actionText=this.actionId=this.details=this.links=this.description=this.actionCommandId=this.commandId=this.secondaryLabel=this.label=null}}Object(u.a)($v,"OptionalMultipActionButtonProperties",ju,[]);class Ai extends Iw{constructor(){super();
this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(u.a)(Ai,"OptionalPersonaButtonProperties",Iw,[]);class tD extends ju{constructor(){super();this.toggled=!1;this.roleInMenu=null;this.toggleUsingIcon=!1;this.stylingParameters=null}}Object(u.a)(tD,"OptionalToggleButtonProperties",ju,[]);var nK=d(1697),wr=d(1696),Hq=d(481);class mz{constructor(){this.j3h=this.actions=null;this.v$j=!1}}Object(u.a)(mz,"PopulateActions",null,[]);class Ht{ZFi(b,h){switch(h){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(b);
case "ToggleButtonModel":return this.EEm(b);case "InkButtonModel":return this.DEm(b);case "GalleryModel":return appChrome.selectors.getGalleryState(b);case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(b);case "SliderModel":return appChrome.selectors.getSliderState(b)}return{}}EEm(b){const h={};h[Vg.a.On]=appChrome.selectors.getButtonToggleState(b);return h}DEm(b){const h={};h[Vg.a.On]=hh.i("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(b):appChrome.selectors.getButtonToggleState(b);
return h}}Object(u.a)(Ht,"ReactStatePropsSelector",null,[]);class no{constructor(b,h,r,A,M){this.Wxa=b;this.vB=h;this.p$b=r;this.vl=A;this.j9e={};this.WHk=new Ht;this.cHb=M}mUj(b){const h=b.populationProps.populateQueryCommandId;return b.populationProps.populateOnlyOnce&&h in this.j9e}eFm(b,h,r=null){const A=[],M={};if(!this.mUj(b)){const aa=b.populationProps.populateQueryCommandId,oa={};oa.MenuId=b.externalUxCommand;oa.IsShadowMenuOpen=this.isShadowMenuOpen(r);if(0<(this.Wxa.Cua(this.vB,this.p$b,
aa,aa,oa,this.$tm(r))&1))if("FontPickerModel"===h)this.j9e[aa]=!0,A.push(no.qDm(b,oa)),M[b.externalUxCommand]="FontPickerModel";else if(oa.MenuItems)switch(this.j9e[aa]=!0,h){case "ComboBoxModel":A.push(no.oDm(b,oa));M[b.externalUxCommand]="ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":A.push.apply(A,this.lIi(b.externalUxCommand,h,oa.MenuItems,M,r&&"location"in r?r.location:null))}}return Object.assign(new mz,
{actions:A,j3h:M,v$j:this.isShadowMenuOpen(r)})}xAi(b,h,r,A,M,aa,oa,Ja,fb=null){let Cb=null;const Gb=[];yf.c(b.Title)||(Cb=b.Title);for(let Sb=0;Sb<b.ControlList.length;Sb++){const pc=Object(ya.a)(Ko.a,b.ControlList[Sb]);if(!pc||pc.ExternalId)aa&&this.Gjm(pc,aa),h.push.apply(h,this.pDm(pc,oa,Gb,M,r,A,fb))}return Ja?appChrome.api.menuSection(Gb,Cb,b.Lang):null}lIi(b,h,r,A,M=null){const aa=[],oa=[],Ja=[],fb=[];for(var Cb=0;Cb<r.MenuSectionList.length;Cb++){var Gb=Object(ya.a)(te.a,r.MenuSectionList[Cb]);
Gb&&(Gb=this.xAi(Gb,aa,b,h,fb,A,oa,r.UpdateDynamically,M),r.UpdateDynamically&&Ja.push(Gb))}Cb=null;r.MenuFooterSection&&(Cb=this.xAi(r.MenuFooterSection,aa,b,h,fb,A,oa,r.UpdateDynamically,M));r.UpdateDynamically&&aa.push(appChrome.actions.updateMenu(b,Ja,r.Title,r.AriaLabel,r.ShouldAutoOpen,r.AriaRoleDescription,r.MenuTargetDescriptor,Cb,r.IsFlexLayout));0<oa.length&&aa.splice(0,0,appChrome.actions.addControls(oa));0<fb.length&&hh.d("setStatefulSplitButtonMruBypassControls")&&aa.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(b,
fb));return aa}Gjm(b,h){switch(b.ControlType){case 1:case 3:h[b.ExternalId]=1===b.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:h[b.ExternalId]="ToggleButtonModel";break;case 6:h[b.ExternalId]="CheckboxModel";break;case 7:h[b.ExternalId]="ColorPickerModel";b=Object(ya.a)(wz.a,b);b.McuLayout&&(h[b.McuExternalId]="ColorPickerModel");break;case 9:h[b.ExternalId]="FlyoutAnchorModel"}}pDm(b,h,r,A,M,aa,oa=null){const Ja=[];switch(b.ControlType){case 14:y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",
!1)&&(A=Object(ya.a)(Ax.a,b),null!=A.IsBanner&&A.IsBanner&&this.a$n(Object(ya.a)(Ax.a,b),Ja,h,r));break;case 1:case 3:b=Object(ya.a)(hk.a,b);this.c$n(b,Ja,h,r);b.MenuItemsStatefulData&&hh.d("setStatefulSplitButtonMenuItemsStatefulData")&&Ja.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(M,b.MenuItemsStatefulData));break;case 2:this.P$n(Object(ya.a)(Hq.a,b),Ja,h,r);break;case 6:this.d$n(Object(ya.a)(MJ.a,b),Ja,h,r);break;case 4:this.I$n(Object(ya.a)(ak,b),Ja,h,r);break;case 7:this.f$n(Object(ya.a)(wz.a,
b),Ja,h,r);break;case 12:this.m$n(Object(ya.a)(UH.a,b),Ja,h,r);break;case 13:this.E$n(Object(ya.a)(ty.a,b),Ja,h,r);break;case 9:b=Object(ya.a)(Se.a,b);this.o$n(b,Ja,h,r);"StatefulSplitButtonModel"===aa&&A.push(b.ExternalId);break;case 8:this.cHb.s$n(Object(ya.a)(Mo.a,b),Ja,h,r,oa)}return Ja}a$n(b,h,r,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.IconName&&0<b.IconName.length&&h.push(appChrome.actions.setControlIcon(b.ExternalId,
b.IconName))):(h=null,b.IconName&&0<b.IconName.length&&(h=new Zv.a(b.IconName)),r.push(appChrome.api.createLabelModel(b.ExternalId,b.LabelText,b.Id,Object.assign(new Vd,{isBanner:b.IsBanner,iconSet:h?h.iconSet:null}))))}c$n(b,h,r,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.Description&&h.push(appChrome.actions.updateCompoundButtonDescription(b.ExternalId,b.Description)),b.CommandValueId&&
h.push(appChrome.actions.setButtonCommandValueId(b.ExternalId,b.CommandValueId)),this.rRd()&&((r=this.HVa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Zv.a(r)).iconSet)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(b.Description||Object(Xa.a)(wE,b)?r.push(appChrome.api.createCompoundButtonModel(b.ExternalId,b.LabelText,b.Description,Object.assign(new VH,{iconSet:(new Zv.a(this.HVa(b))).iconSet,keytip:b.KeyTip,roleInMenu:b.RoleInMenu,
ariaDescription:b.AriaDescription,customTooltip:b.LabelText!==b.Alt?b.Alt:null}))):(A=b.DismissHostingSurfaceOnExecute,r.push(appChrome.api.createButtonModel(b.ExternalId,b.LabelText,Object.assign(new Iw,{iconSet:(new Zv.a(this.HVa(b))).iconSet,keytip:b.KeyTip,supportsPreview:!!b.CommandPreviewId&&!!b.CommandRevertId,customTooltip:b.LabelText!==b.Alt?b.Alt:null,commandValueId:b.CommandValueId,shouldTakeFocus:b.ShouldTakeFocus,dismissHostingSurfaceOnExecute:void 0!==A&&null!==A?A:!0})))),this.vl.addCommandToMaps(Object.assign(new Yu.a(b.ExternalId,
b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand,commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));b.Lang&&hh.d("setControlLanguage")&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}d$n(b,h,r,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.rRd()&&((r=this.HVa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,
(new Zv.a(r)).iconSet)),b.IsChecked&&h.push(appChrome.actions.toggleButton(b.ExternalId,b.IsChecked)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(r.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new tD,{iconSet:(new Zv.a(this.HVa(b))).iconSet,keytip:b.KeyTip,toggled:b.IsChecked,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null,toggleUsingIcon:!!b.CheckedImageClass}))),
this.vl.addCommandToMaps(Object.assign(new Yu.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}m$n(b,h,r,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.Label&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.Label)),b.IconName&&0<b.IconName.length&&h.push(appChrome.actions.setControlIcon(b.ExternalId,b.IconName))):(h=null,b.IconName&&0<b.IconName.length&&(h=new Zv.a(b.IconName)),r.push(appChrome.api.createErrorViewModel(b.ExternalId,
Object.assign(new WH,{label:b.Label,retryButtonTitle:b.RetryButtonTitle,onRetryCommandId:b.OnRetryCommandId,ariaDescription:b.AriaDescription,iconSet:h?h.iconSet:null}))))}E$n(b,h,r,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(r={},b.Label&&(r.label=b.Label),b.SecondaryLabel&&(r.secondaryLabel=b.SecondaryLabel),b.Details&&(r.details=b.Details),b.Description&&(r.description=b.Description),b.iconSet&&(r.iconSet=b.iconSet),b.Links&&(r.links=b.Links),b.CommandValueId&&(r.commandValueId=
b.CommandValueId),b.ActionCommandValueId&&(r.actionCommandValueId=b.ActionCommandValueId),b.ActionCommandId&&(r.actionCommandId=b.ActionCommandId),b.CommandId&&(r.commandId=b.CommandId),h.push(appChrome.actions.updateMultiActionButton(b.ExternalId,r))):(r.push(appChrome.api.createMultiActionButtonModel(b.Id,Object.assign(new $v,{label:b.Label,secondaryLabel:b.SecondaryLabel,actionText:b.ActionText,description:b.Description,iconSet:b.iconSet,links:b.Links,details:b.Details,actionId:b.ActionId,commandId:b.CommandId,
actionCommandId:b.ActionCommandId||b.ActionId,commandValueId:b.CommandValueId,actionCommandValueId:b.ActionCommandValueId||b.CommandValueId}))),b.CommandIdMapped&&this.vl.addCommandToMaps(new Yu.a(b.CommandId,b.CommandIdMapped)),b.ActionIdMapped&&this.vl.addCommandToMaps(new Yu.a(b.ActionId,b.ActionIdMapped)))}P$n(b,h,r,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.rRd()&&((r=this.HVa(b))&&
0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Zv.a(r)).iconSet)),y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?r.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new tD,{iconSet:(new Zv.a(this.HVa(b))).iconSet,
iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null,toggleUsingIcon:b.ToggleUsingIcon,stylingParameters:b.StylingParameters}))):r.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new tD,{iconSet:(new Zv.a(this.HVa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,toggleUsingIcon:b.ToggleUsingIcon,stylingParameters:b.StylingParameters}))),
this.vl.addCommandToMaps(Object.assign(new Yu.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}I$n(b,h,r,A){A.push(b.ExternalId);A=this.PCm(b);appChrome.selectors.isControlDefined(b.ExternalId)?b.LabelText&&h.push(appChrome.actions.setPersonaButtonCoauthor(b.ExternalId,A,b.LabelText)):hh.a("createPersonaButtonModel")&&r.push(appChrome.api.createPersonaButtonModel(b.ExternalId,A,b.LabelText,Object.assign(new Ai,{role:b.RoleInMenu,fullDescriptionLabel:b.AriaDescription,
iconSet:{["default"]:"doughboywhiteglyph_20"}})))}o$n(b,h,r,A){A.push(b.ExternalId);if(appChrome.selectors.isControlDefined(b.ExternalId))b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.rRd()&&((r=this.HVa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Zv.a(r)).iconSet)),void 0!==b.ImageIsVisible&&null!==b.ImageIsVisible&&h.push(appChrome.actions.hideFlyoutAnchorIcon(b.ExternalId,!b.ImageIsVisible)),void 0!==b.Toggled&&null!==b.Toggled&&
h.push(appChrome.actions.toggleButton(b.ExternalId,b.Toggled)));else{A=!(void 0===b.ImageIsVisible||null===b.ImageIsVisible)&&!b.ImageIsVisible;const M=!(void 0===b.Toggled||null===b.Toggled)&&b.Toggled;r.push(appChrome.api.createFlyoutAnchorModel(b.ExternalId,b.LabelText,Object.assign(new XH,{iconSet:(new Zv.a(this.HVa(b))).iconSet,keytip:b.KeyTip,hideIcon:A,toggled:M,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null})));this.vl.addCommandToMaps(Object.assign(new Yu.a(b.ExternalId,
b.Command),{queryCommandId:b.QueryCommand,populationProps:new lK.a(b.PopulateQueryCommand,b.PopulateOnlyOnce)}))}b.Menu&&h.push.apply(h,this.lIi(b.ExternalId,"FlyoutAnchorModel",b.Menu,null));b.Lang&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}f$n(b,h,r,A){b.McuLayout&&A.push(b.McuExternalId);A.push(b.ExternalId);A=0;appChrome.selectors.isControlDefined(b.ExternalId)?b.McuLayout&&(A=this.WHk.ZFi(b.ExternalId,"ColorPickerModel").columnCount):(b.McuLayout&&(r.push(appChrome.api.createColorPickerModel(b.McuExternalId,
b.Width)),this.vl.addCommandToMaps(Object.assign(new Yu.a(b.McuExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})),A=b.Width),r.push(appChrome.api.createColorPickerModel(b.ExternalId,b.Width)),this.vl.addCommandToMaps(Object.assign(new Yu.a(b.ExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));r=[];const M=[];for(let aa=0;aa<b.Colors.length;aa++){const oa=b.Colors[aa],Ja=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.HighContrastColorPickerEnabled",
!1)?oa.Disabled:!1;aa<A?r.push(appChrome.api.colorPickerCell(oa.Color,oa.DisplayColor,oa.Alt,Ja)):M.push(appChrome.api.colorPickerCell(oa.Color,oa.DisplayColor,oa.Alt,Ja))}0<r.length&&h.push(appChrome.actions.populateColorPickerCells(b.McuExternalId,r));h.push(appChrome.actions.populateColorPickerCells(b.ExternalId,M));b.SelectedColorId&&(0<r.length&&h.push(appChrome.actions.updateColorPickerSelectedColor(b.McuExternalId,b.SelectedColorId)),h.push(appChrome.actions.updateColorPickerSelectedColor(b.ExternalId,
b.SelectedColorId)))}HVa(b){return b.Image32by32Class?this.vl.pwi(b.Image32by32Class):b.Image16by16Class?this.vl.pwi(b.Image16by16Class):b.ExternalImageId}PCm(b){return b?Object.assign(new wr.a,{displayName:b.DisplayName,personaCoinColor:b.ImageBackColor,isUnauthenticatedSender:b.IsAnonymous,identifiers:Object.assign(new nK.a,{PersonaType:"User",Smtp:b.PersonaId})}):null}$tm(b){let h=2;b&&"inputMethod"in b&&b.inputMethod&&(h=b.inputMethod);return h}isShadowMenuOpen(b){return!!b&&b.isShadowRendering}rRd(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",
!1)}static qDm(b,h){return appChrome.actions.populateFontPickerDataAsync(new Promise((r,A)=>{Za.a.instance.Ra(4).execute(M=>{M.isFeatureEnabled(mK.a.gUb,!1).then(aa=>{let oa=h.fonts;aa||M.isFreemiumUpsellEnabled()||(oa=Oe.a.I$j(oa,Ja=>Ja.fontType!==mK.a.Lkg));aa=Object.assign(new Wm,{commandId:b.externalUxCommand,fonts:oa,isSubscriber:aa,mruList:h.mruList,initialPinnedFontKeys:h.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});r(aa)}).catch(A)})}))}static oDm(b,h){const r=[];for(let A=
0;A<h.MenuItems.MenuSectionList.length;A++){const M=h.MenuItems.MenuSectionList[A];M.Title&&r.push(appChrome.api.comboBoxHeader("Header-"+A.toString(),M.Title));for(let aa=0;aa<M.ControlList.length;aa++){const oa=Object(ya.a)(sD.a,M.ControlList[aa]);oa&&r.push(appChrome.api.comboBoxItem(oa.MenuItemId,oa.LabelText,oa.Styles,oa.CommandValueId,oa.AriaLabel,oa.Data,oa.Disabled))}A<h.MenuItems.MenuSectionList.length-1&&r.push(appChrome.api.comboBoxDivider("Divider-"+A.toString()))}return appChrome.actions.populateComboBoxOptions(b.externalUxCommand,
r)}}Object(u.a)(no,"ReactPopulateQueryCommandPoller",null,[]);class $H{constructor(b,h,r,A,M){this.vl=r;this.Wxa=b;this.vB=h;this.p$b=A;this.cHb=M}dFm(b,h,r){const A=[];if(this.adn(h))b=this.cJm(b,h,r),void 0!==b&&null!==b&&A.push.apply(A,b);else if(b){var M=this.A7d(b,r);Pm.a.visible in r&&A.push(appChrome.actions.updateControlHiddenState(b.externalUxCommand,!r[Pm.a.visible]));A.push(sy(b.externalUxCommand,1>(M&1)));void 0!==r[Pm.a.labelText]&&null!==r[Pm.a.labelText]&&A.push(appChrome.actions.setControlLabel(b.externalUxCommand,
r[Pm.a.labelText]));void 0!==h&&null!==h&&(M=Gt(b.externalUxCommand,h,r,M),void 0!==M&&null!==M&&A.push.apply(A,M),"PeopleWell"===h&&this.iWk(b.externalUxCommand,r,A))}return A}uom(b,h,r){const A=[];switch(h){case "FlyoutAnchorModel":var M=appChrome.selectors.getFlyoutAnchorMenuItems(b);break;case "SplitButtonModel":var aa=appChrome.selectors.getSplitButtonState(b);if(aa=this.vl.getCommandByExternalUxId(aa.command))r=this.Wxa.Cgd(this.vB,aa.commandId,r),A.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(b,
!r)),A.push(sy(b,!1));return A;default:return null}h=!1;for(aa in M)if(M=this.vl.getCommandByExternalUxId(aa),yf.c(M))h=!0;else if(r.SourceControlId=M.externalUxCommand,this.Wxa.Cgd(this.vB,M.commandId,r))return A.push(sy(b,!1)),A;A.push(sy(b,!h));return A}cJm(b,h,r){switch(h){case "PreviewGalleryModel":return this.cHb.MDm(b,r);case "GalleryModel":return this.cHb.trm(r)}return null}adn(b){return"GalleryModel"===b||"PreviewGalleryModel"===b}A7d(b,h){h.MenuItemId=b.menuItemId;return this.Wxa.Cua(this.vB,
this.p$b,b.commandId,b.queryCommandId,h)}iWk(b,h,r){const A=h[Rc.a.LabelTextUserGeneratedPlaceholderReplacements];h=h[Rc.a.LabelText];A&&0<A.length&&(h=String.format.apply(null,[h].concat(A)));r.push(this.qNm(b,h))}qNm(b,h){return appChrome.actions.updatePeopleWell(this.njm(b),h)}njm(b){const h=[];var r={};b=this.vl.getCommandByExternalUxId(b).populationProps.populateQueryCommandId;this.Wxa.Cua(this.vB,this.p$b,"1285265560",b,r);r=r.MenuItems;if(!r)return h;r=r.MenuSectionList[0];for(b=0;b<r.ControlList.length;b++){const A=
r.ControlList[b],M={};M.name=A.Alt;M.id=A.MenuItemId;M.description=A.Description;M.color=A.ImageBackColor;M.joinTime=A.JoinTimeInMS;M.imageUrl=A.ImageUrl;M.activeStatus=A.ActiveStatus;M.isAnonymous=A.IsAnonymous;M.canJump=A.CanJump;M.upn=A.Upn;h.push(M)}return h}}Object(u.a)($H,"ReactQueryCommandPoller",null,[]);var uK=d(1657);class aI{constructor(b,h,r){this.vl=b;this.vB=h;b=new uK.a;this.xMk=new Ht;this.cHb=new rD(b,this.vB,r,this.vl);this.Izh=new no(b,this.vB,r,this.vl,this.cHb);this.wzh=new $H(b,
this.vB,this.vl,r,this.cHb)}tKa(){const b=[];if(!hh.c())return b;b.push.apply(b,this.oNm());var h=this.rnm();if(0<h.length)b.push.apply(b,h);else if(h=appChrome.selectors.getActiveControlIds(),Object.keys(h).length){const r=this.snm();for(const A of r)b.push(appChrome.actions.updateControlEnabledDisabledState(A,!0)),delete h[A];b.push.apply(b,this.S8d(h))}return b}Dgd(b,h){hh.c()&&(b=this.S8d(b,h),appChrome.api.dispatch(b))}dkg(b,h,r=null){if(!yf.c(b)&&b.populationProps&&!this.Izh.mUj(b)){b=this.Izh.eFm(b,
h,r);if(!b.v$j){let A;(A=b.actions).push.apply(A,this.S8d(b.j3h,hh.g(r)))}if(0<b.actions.length)return appChrome.api.dispatch(b.actions),!0}return!1}S8d(b,h=0){const r=[],A={};if(hh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(var M of appChrome.selectors.getActiveGroupIds())for(var aa of appChrome.selectors.getVisibleControlsInGroup(M))A[aa]=!0;for(const oa in b)M=oa,aa=b[oa],
0===h&&A[M]&&(h=2),r.push.apply(r,this.nNm(M,aa,h));return r}nNm(b,h,r=0){const A=[],M=this.vl.getCommandByExternalUxId(b);let aa={};appChrome.selectors.isControlDefined(b)&&(aa=this.xMk.ZFi(b,h));aa[Ft.a.hfb]=r;yf.c(M)?(aa.ExternalUxId=b,(b=this.wzh.uom(b,h,aa))&&0<b.length&&A.push.apply(A,b)):(aa.MenuItemId=M.menuItemId,aa.SourceControlId=b);A.push.apply(A,this.wzh.dFm(M,h,aa));return A}oNm(){const b=[],h=!!y.AFrameworkApplication.J&&(y.AFrameworkApplication.J.$("ReactRibbonDispatchActionFilter")||
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1)),r=appChrome.selectors.getContextualTabIds();let A=[];h&&(A=appChrome.selectors.getActiveContextualTabIds());for(let aa=0;aa<r.length;aa++){var M=this.vl.qNf(r[aa]);if(M){M=this.vB.BLa(M);let oa=!0;h&&(oa=0<=Array.indexOf(A,r[aa]));h&&oa===M||b.push(appChrome.actions.activateDeactivateContextualTab(r[aa],M))}}return b}rnm(){var b=appChrome.selectors.getSelectedTabId();const h=[],r=this.vl.qNf(b);
r&&(this.vB.BLa(r)||h.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(b,!0)));return h}snm(){var b=appChrome.selectors.getActiveGroupIds();const h=[];for(const r of b)if(b=this.vl.Lrm(r))for(const A of b)this.vB.BLa(A.commandId)||((b=A.externalUxCommandIds)||(b=appChrome.selectors.getVisibleControlsInGroup(A.externalUxGroupId)),h.push.apply(h,b));return h}}Object(u.a)(aI,"ReactRibbonRootPoller",null,[1784]);class zD{constructor(b,h,r=null){this.vB=this.mGa=this.gkb=null;this.R9b=
h;b.hTa(this);this.oH=r}get Hta(){this.mGa||(this.mGa=new Date,this.mGa.setTime(0));return this.mGa}set Hta(b){this.mGa=b}get fca(){return 2}get oH(){return this.vB}set oH(b){this.vB=b}get nuc(){this.gkb||(this.gkb=new aI(this.R9b,this.oH,this.fca));return this.gkb}onb(){const b=document.activeElement;Fd.a.isEditable(b)&&b.blur()}executeCommand(b,h,r,A,M,aa,oa,Ja=2){yf.c(this.oH)||(M=new om.a,M.CommandLocation=Ja,M.InvocationMethod=A,M.CommandTabName=r,h[Ft.a.hfb]=Ja,this.oH.XUa(b,h,M,aa,oa),this.tzn(b,
h))}tKa(){return yf.c(this.oH)?[]:this.nuc.tKa()}rn(){const b=this.tKa();0<b.length&&(this.Hta=new Date,appChrome.api.dispatch(b))}ysd(){hh.c()&&this.nuc.Dgd({PeopleWell:"PeopleWell"},18)}nsd(){}tzn(b,h){try{const r=Za.a.instance.Oa(2);if(r&&h){const A=h.SourceControlId||h.launcherId||h.LegacyId||h.NewContextId;let M=(A?"_"+A:"")+(h.SqmControlId?"_"+h.SqmControlId:"");M=M.length?M:"_"+b;r.S4f("Ribbon"+M)}}catch(r){v.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+(r?r.toString():""))}}}
Object(u.a)(zD,"ReactRibbonRoot",null,[605,1785]);var AD=d(1573);class bI{constructor(b){this.Lbf=this.fTe=!1;this.$gb=null;this.V9g=!1;this.FS=null;this.oxa=!1;this.FTn=h=>{h.Nb&&h.Nb.target&&"input"===h.Nb.target.tagName.toLowerCase()&&Cd.FocusManager.instance().EE("ribbon");return!1};this.B4e=b;ie.a.instance.nb(Jd.a.az,this.O1c(),this.FTn);(b=Za.a.instance.Ra(5))&&b.execute(h=>{this.FS=h});y.AFrameworkApplication.J.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&y.AFrameworkApplication.ua.Ib.vN?
zl.a.get_instance().Tk(16,()=>{this.isReady?this.initializeContextualUI(this.O1c()):zl.a.get_instance().Tk(7,()=>{this.initializeContextualUI(this.O1c())})}):zl.a.get_instance().Tk(7,()=>{this.initializeContextualUI(this.O1c())})}get f3(){return this.oxa}get isReady(){return y.AFrameworkApplication.J.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&y.AFrameworkApplication.ua.Ib.vN?zl.a.get_instance().isCompleted(16)&&zl.a.get_instance().isCompleted(7):zl.a.get_instance().isCompleted(7)}Uil(){if(this.V9g)return!0;
try{return Promise.resolve(null),this.V9g=!0}catch(b){return!1}}TJg(b){if(!this.isReady||this.Lbf)return this.P5f("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.Uil())return this.P5f("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(y.AFrameworkApplication.e_d||""!==y.AFrameworkApplication.fv)if(!y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.enableRibbonForCA",!1)||"DocGen"===y.AFrameworkApplication.fv||"ContentAssemblyView"===
y.AFrameworkApplication.fv)return this.P5f("Unable to launch contextual ui because the feature to show contextual ui is disabled"),!0;this.Lbf=!0;let h=Ka.a.Sg;switch(b){case 1:h=Ka.a.showContextMenu;break;case 0:h=Ka.a.showFloatie;break;case 2:h=Ka.a.gxc}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.Lbf=!1;ac.c(h)},0)});return!1}EIi(b){return em.UISurfaces.J8a().then(h=>{if(appChrome.api.isSmallDevice()&&h.getBlockedSmallScreenFloatieGroupList){h=h.getBlockedSmallScreenFloatieGroupList();
const r=[];for(const A of b)Array.contains(h,A)||r.push(A);return r}return b})}showFloatie(b,h,r,A=null){this.TJg(0)||this.EIi(h).then(M=>{if(0>=M.length)return null;this.nAg(M).then(()=>{const aa={};aa.target=b;em.UISurfaces.J8a().then(oa=>{appChrome.api.dispatch(oa.showFloatie(aa,r,void 0,this.vKf(),A));this.oxa=!0;y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogFloatieMenuContextIsEnabled",!1)&&y.AFrameworkApplication.va&&y.AFrameworkApplication.va.Ob(Ka.a.z8i,
2);return null})});return null})}showContextMenu(b,h,r=null,A=null){this.TJg(1)||this.kSj(b,h,r,A)}kSj(b,h,r=null,A=null){this.nAg(null).then(()=>{const M={};M.target=b;A&&(M.directionalHint=A);em.UISurfaces.J8a().then(aa=>{appChrome.api.dispatch(aa.showContextMenu(M,h,r,void 0,this.vKf()));return null})})}fxc(b,h,r,A=null){this.TJg(2)||this.EIi(h).then(M=>{0>=M.length?this.kSj(b,r,A):this.nAg(M).then(()=>{const aa={};aa.target=b;const oa={};oa.target=b;em.UISurfaces.J8a().then(Ja=>{appChrome.api.dispatch(Ja.showContextualUI(aa,
oa,r,void 0,A,this.vKf()));this.oxa=!0;return null})});return null})}P5f(b){v.ULS.sendTraceTag(561394519,340,15,b)}Pwf(){this.isReady&&em.UISurfaces.isLoaded()&&em.UISurfaces.J8a().then(b=>{appChrome.api.dispatch(b.hideContextMenu());return null})}dismissFloatie(){this.isReady&&em.UISurfaces.isLoaded()&&em.UISurfaces.J8a().then(b=>{this.oxa=!1;appChrome.api.dispatch(b.hideFloatie());return null})}DYc(){this.isReady&&em.UISurfaces.isLoaded()&&em.UISurfaces.J8a().then(b=>{appChrome.api.dispatch(b.hideContextualUI());
this.oxa=!1;return null})}initializeContextualUI(b){return em.UISurfaces.J8a().then(h=>{this.fTe||(h.initializeContextualUI(b),this.fTe=!0);return null})}nAg(b){if(!this.fTe)return this.initializeContextualUI(this.O1c()).then(()=>{this.setActiveFloatieGroups(b);return null});this.setActiveFloatieGroups(b);return Promise.resolve(null)}setActiveFloatieGroups(b){if(b&&b.length){var h=[];h.push(appChrome.actions.setActiveFloatieGroups(b));appChrome.api.dispatch(h);var r=[];em.UISurfaces.J8a().then(A=>
{r.push.apply(r,this.B4e.nuc.S8d(A.selectors.getFloatieOnlyControlsMap(),9));0<r.length&&appChrome.api.dispatch(r);return null})}}O1c(){if(this.$gb)return this.$gb;this.$gb=AD.a("div");this.$gb.id="ReactContextualUIDiv";this.$gb.style.position="absolute";this.$gb.style.zIndex="1001";document.body.insertBefore(this.$gb,document.body.firstChild);return this.$gb}vKf(){return this.FS?this.FS.contentType:"Unknown"}}Object(u.a)(bI,"ReactContextualUILauncher",null,[1786]);class cI extends BB.a{constructor(){super()}}
Object(u.a)(cI,"FloatieBuildOptions",BB.a,[]);class vy extends Vq.a{constructor(){super()}}Object(u.a)(vy,"FloatieBuildContext",Vq.a,[]);var ls=d(1468);class sn extends Ap.Builder{constructor(b,h,r){super(b,h,r,null);this.QZn=A=>{this.Jdl(A.Ghd,A.$Vc);this.kR.Xni=this;this.kR.sn();this.kR.Rc.style.display="none";this.placeholder.appendChild(this.kR.Rc);this.iza.continueWith(()=>{this.iza.result.YVb(this.kR)},11);ck.a.instance.nb(Jd.a.gt,this.kR.Rc,Object(E.a)(this.kR,this.kR.rE,"onPointerDown"))};
if(yf.c(h))throw Error.create("Floatie placeholder DOM element is null or undefined.");}get kR(){return this.root}AXo(b){this.root=b}Idl(){const b=new vy,h=new TG.a;h.nid=1;h.handler=this.QZn;h.data=b;this.Vza.Uue(h)}Jdl(b,h){b=Nj.a.Vka(b,Nj.a.Vdk);if(yf.c(b))throw Error.create("No floatie element was present in the data");b=new Nj.a(b);this.AXo(new Ly(b.attributes[Nj.a.id],b.attributes));b=Nj.a.Vka(b.node,Nj.a.JGe);this.clf(b,h)}clf(b,h){b=Nj.a.yx(b);for(let r=0;r<b.length;r++){if(this.lXa(b[r]))continue;
const A=this.ilf(b[r],h);this.kR.Vf(A)}}ilf(b,h){var r=new Nj.a(b);b=new ls.Group(this.kR,r.attributes[Nj.a.id],r.attributes[Nj.a.U0a],r.attributes[Nj.a.tBc],r.attributes[Nj.a.N0a],!1,r.name===Nj.a.Jhk,!1,r.attributes);r=Nj.a.yx(r.node);for(let A=0;A<r.length;A++)b.Vf(this.kTd(r[A],h));return b}kTd(b,h){b=new Nj.a(b);var r=b.attributes[Nj.a.id];b=Nj.a.yx(b.node);var A=2;2===b.length&&(A=3);r=new jk.a(this.kR,r,A,2,1);for(A=0;A<b.length;A++){const aa=new Nj.a(b[A]);var M=Nj.a.Vka(aa.node,Nj.a.FAb);
M=Nj.a.yx(M);this.qlf(r.T7d(A+1),M,aa.attributes[Nj.a.id],h)}return r}qlf(b,h,r,A){for(r=0;r<h.length;r++){if(this.lXa(h[r]))continue;const M=new Nj.a(h[r]),aa=this.Jja(h[r],A);aa&&b.Vf(aa.GW(M.attributes[Nj.a.uBc]))}}}Object(u.a)(sn,"FloatieBuilder",Ap.Builder,[]);class kC{constructor(b,h){this.zw=null;this.mtl=b;this.ANe=h;this.dVn=this.Mle.bind(this)}get kR(){return this.zw}qnb(b,h,r){h=new Dn.a(Bk.a.b6a,Box4Intl.Box4Strings,null,null,h);const A=new cI;A.bJ=r||{};A.bJ.floatieshadingColor=!1;const M=
new sn(A,document.body,this.mtl.xGj);M.Vza=new Rr.a(b,h);M.Idl();this.ANe.execute(aa=>{M.kR.oH=aa});M.kR.Zro(this.dVn);M.kR.hro(()=>[]);this.zw=M.kR;return this.kR}}Object(u.a)(kC,"AFloatieInitializer",null,[]);class WI extends kC{constructor(b,h,r,A){super(h,r);this.Vjg=()=>{this.kR.rn()};this.hi=b;this.BK=A}qnb(b,h,r){if(b=super.qnb(b,h,r))b.Gtc=!0,b.Spe=!0,b.preventDismissOnScroll=!0;this.hi.E5a(this.Vjg);return b}O6c(b,h,r=null){this.BK.GUh(()=>this.qnb(b,h,r))}Mle(){this.kR.Gtc=!0}}Object(u.a)(WI,
"PasteFloatieInitializer",kC,[]);var VD=d(802);class Pu{ZDa(b,h){this.tjl&&this.m3o(b,h,Pu.H7f,Pu.currentSelection)}m3o(b,h,r,A){switch(r){case 1:case 6:case 2:case 3:case 4:Pu.xyf.show(A,b,h)}}Vbj(){switch(Pu.H7f){case 5:case 1:return!0;default:return!1}}hKl(){return Pu.H7f}get tjl(){return 1!==qa.StaticActiveAppFrame.za().state}static get xyf(){return null!=Pu.iUg?Pu.iUg:Pu.iUg=Za.a.instance.resolve(1056)}static axm(b){if(!b)return 0;if(2===qa.StaticActiveAppFrame.za().mode){const h=b.Qa.node,r=
vd.a.Za(h);r.pq();return wq.e(r.currentNode)?2:y.AFrameworkApplication.z2b||!gB.isEmbeddedFileNode(h)||gB.isInvalid(h)?Xn.a.Bhn(b.Qa)||Xn.a.SXf(b.Qa)?6:1:3}return 4}static get currentSelection(){return gg.a.instance.gb.currentSelection}static get H7f(){return Pu.axm(Pu.currentSelection)}}Object(u.a)(Pu,"SelectionContextMenuProvider",null,[1554]);class Mx{constructor(b,h){this.Spe=this.Gtc=!1;this.p5c=!0;this.bO=b;this.vl=h}get isVisible(){return this.bO.f3}get controls(){return null}dismissFloatie(){this.bO.dismissFloatie();
return!0}Pzf(){}eeb(b,h,r,A,M=null){this.bO.showFloatie(Object.assign(new ur.a,{x:b.x,y:b.y}),this.pFf(r),r,M)}pPb(){return new Sys.UI.Bounds(0,0,0,0)}H6(){return this.dismissFloatie()}pFf(){return[]}}Object(u.a)(Mx,"ReactFloatie",null,[440,441]);class UD{constructor(b){this.pyd=null;this.bO=b}dispose(){}H6(){this.bO.DYc();return!0}showContextMenu(b,h){this.m0b(b,h.clientPoint,h.zg)}m0b(b,h,r){this.ceb(b,new Sys.UI.Bounds(h.x,h.y,0,0),r);v.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",
b)}ceb(b,h,r,A=null){this.pyd?this.bO.fxc(Object.assign(new ur.a,{x:h.x,y:h.y}),this.pyd.pFf(r),r,b):this.bO.showContextMenu(Object.assign(new ur.a,{x:h.x,y:h.y}),r,b,A);this.pyd=null}gxc(b,h,r,A){this.pyd=Object(ya.a)(Mx,r);A.ZDa(b,h);return!0}}Object(u.a)(UD,"ReactContextMenuController",null,[710,10]);var fL=d(465);class Nx{constructor(){this.hna=this.text=this.ata=null}}Object(u.a)(Nx,"BusinessBarButtonData",null,[]);class fw{constructor(){this.text=this.ata=null}}Object(u.a)(fw,"BusinessBarLinkData",
null,[]);var rt=d(727),Cr=d(245);class rh{constructor(b,h,r,A){this.ogh=this.Cdh=this.zhb=this.Cbh=null;this.Qt=b;this.swa=h;this.ga=r;this.Ga=A}sjg(){this.qUc();this.rUc();this.nec()}rUc(){}qUc(){const b=qa.StaticActiveAppFrame.za().kb.$c;b&&(this.Cbh=this.vfb(this.Cbh,1,2===qa.StaticActiveAppFrame.za().mode&&b.SWf,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}G2i(){return y.AFrameworkApplication.ua&&1===y.AFrameworkApplication.ua.mode}nec(){let b=null;if(10<=df.a.gf.oM){if(df.a.gf.Hca.iWa){var h=
df.a.gf.hGb;Cr.a.lSb(h)?22===h?b=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===h||20===h?b=Y.a.Ci?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===h?b=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===h?b=Y.a.Ci?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===h&&(b=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):Cr.a.GRf(df.a.gf.Hca.jea)||df.a.hn||this.G2i()||(b=Box4Intl.Box4Strings.l_SectionLockedInfoText)}}else if(h=
qa.StaticActiveAppFrame.za().kb.activeSection){const r=h.vfd;Cr.a.lSb(r)?22===r?b=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===r||20===r?b=Y.a.Ci?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===r?b=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===r?b=Y.a.Ci?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===r&&(b=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):Cr.a.GRf(h.p5a)||
df.a.hn||this.G2i()||(b=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.ogh=this.vfb(this.ogh,5,!!b,b)}DSj(b,h,r,A){b=this.swa.create(null,b,null);b.closeable=!0;b.id=23;b.image=3;b.rQd(h,()=>{Le.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+r)});A&&(b.Pja=A);this.Qt.Jz(b,!0)}c4o(b,h,r){this.DSj(b,h,r,null)}n4o(b){b=this.swa.create(null,b,null);b.closeable=!0;b.id=20;this.Qt.Jz(b)}w3o(){var b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,h=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;
this.zhb||(this.zhb=this.swa.create(b,h,null),this.zhb.closeable=!0,this.zhb.id=27,this.Qt.Jz(this.zhb))}uYm(){this.zhb&&(this.zhb=this.vfb(this.zhb,27,!1,""))}dCg(b){this.Cdh=this.vfb(this.Cdh,30,!0,b)}vfb(b,h,r,A,M=!1,aa="",oa=null,Ja=null,fb=null){r?b?b.message=A:(b=this.swa.create(aa,A,null),b.id=h,b.closeable=M,oa&&b.addButton(oa.text,oa.ata,oa.hna),Ja&&b.rQd(Ja.text,Ja.ata),fb&&(b.Pja=fb),this.Qt.Jz(b,!1)):b&&(this.Qt.removeEntry(b),b=null);return b}kdf(b){this.Qt.Jz(b,void 0)}}Object(u.a)(rh,
"BusinessBarController",null,[377]);class zo extends rh{constructor(b,h,r,A){super(b,h,r,A);this.uxa=null}NJf(b,h,r=null,A=null,M=null,aa=2){if(this.uxa)return null;this.uxa=this.swa.create(h,r||"",null);this.uxa.id=6;this.uxa.image=aa;this.uxa.k9c=!1;b&&(this.uxa.errorCode=b);this.uxa.closeable=!1;h=y.AFrameworkApplication.sH&&this.Ga.$("ShowFeedbackButtonOnKickoutBusinessBar");A?(this.uxa.addButton(A,M,""),h&&this.uxa.gNh(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.rJi(b)})):h&&this.uxa.addButton(WoncaIntl.WoncaStrings.L_GiveFeedback,
()=>{this.rJi(b)},"");this.Qt.Jz(this.uxa,void 0,null,null,null);return this.uxa}rJi(b){v.ULS.sendTraceTag(36471966,338,15,"Feedback given after kickout: {0}",{["ErrorCode"]:b});this.ga.Pb(Ka.a.kla,2,{["ErrorCode"]:b})}static get pj(){return Um.PageReader.instance}}Object(u.a)(zo,"BusinessBarController",rh,[376,377]);class Ur{static get Kgj(){const b=I.a.Yi(tj.a.Hg(y.AFrameworkApplication.lcid).name);return Ur.Ckn?String.format("https://support.office.com/{0}/client/results?Shownav=true&lcid=1033&ns=WDWAEndUser&version=15&omkt={0}&ver=15&apps=WDWAENDUSER%2CXLWAENDUSER%2CPPWAENDUSER%2CONWAENDUSER&HelpID=WordODF",
b):String.format("https://r.office.microsoft.com/r/rlidWebOpenDocumentDetails?clid={0}",b)}static get Ckn(){if(null!=Ur.LZg)var b=Ur.LZg;else{var h;y.AFrameworkApplication.vd("d932d186;491d2669");b=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.OdtDialogLearnMoreUrlChangeEnabled",!1);b=Ur.LZg=b}return b}}Object(u.a)(Ur,"OdtUtils",null,[]);class Xh extends zo{constructor(b,h,r,A){super(b,h,r,A);this.WFb=this.HBb=this.vHc=this.Msh=this.$Sa=
this.Ssh=this.eEh=null;this.vBk="https://go.microsoft.com/fwlink/?linkid=2134357"}sjg(){super.sjg();this.pnl();this.Nnl()}rUc(){const b=qa.StaticActiveAppFrame.za().kb.$c;if(b){var h=df.a.l3;if(df.a.yt||df.a.hn||h&&y.AFrameworkApplication.ow)this.eEh=this.vfb(this.eEh,4,zo.pj.uab(b),Box4Intl.Box4Strings.l_BusinessBarSigned,!0),this.Ssh=this.vfb(this.Ssh,3,zo.pj.gab(b),Box4Intl.Box4Strings.l_BusinessBarMarkedAsFinal,!0),this.Msh=this.vfb(this.Msh,8,zo.pj.jxl(b),Box4Intl.Box4Strings.l_BusinessBarContainsMalformedHyperlinkUris,
!0),zo.pj.BTb(b)?this.$Sa||(this.$Sa=this.swa.create(Box4Intl.Box4Strings.l_BusinessBarCompatTitle,Box4Intl.Box4Strings.l_BusinessBarCompatMessage,null),this.$Sa.id=14,this.$Sa.closeable=!0,this.$Sa.image=3,this.$Sa.addButton(Box4Intl.Box4Strings.L_LearnMore,rt.a.qvn,""),this.Qt.Jz(this.$Sa,!1)):this.$Sa&&(this.Qt.removeEntry(this.$Sa),this.$Sa=null)}}pnl(){if($l.a.q9c){const b=Ur.Kgj,h=this.swa.create(Box4Intl.Box4Strings.l_BusinessBarODTDocumentTitle,Box4Intl.Box4Strings.l_BusinessBarODTDocument,
null);h.id=9;h.closeable=!0;h.pVk(b);this.Qt.Jz(h,!0)}}get sqn(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UnsupportedBrowserVersionSoftBlockIsEnabled",!1)?Y.a.tqn:!1}Nnl(){this.sqn&&!this.WFb&&(this.WFb=this.swa.create("",CommonUIStrings.l_UnsupportedBrowserDeadline,null),this.WFb.id=15,this.WFb.closeable=!0,this.WFb.k9c=!1,this.WFb.addButton(Box4Intl.Box4Strings.L_DownloadNow,rt.a.wqp,""),this.Qt.Jz(this.WFb,!1))}d4o(b,h){if(qa.StaticActiveAppFrame.za().kb.$c){const r=
new Nx;r.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptSendButton;r.ata=()=>{b()};const A=new fw;A.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptPrivacyLinkText;A.ata=()=>{Le.a.openWindow(4,y.AFrameworkApplication.privacyUrl)};this.vHc=this.vfb(this.vHc,25,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptMessage,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptTitle,r,A,()=>{h()})}}CYm(){this.vHc&&(this.vHc=this.vfb(this.vHc,25,!1,""))}e3o(){if(qa.StaticActiveAppFrame.za().kb.$c){const b=
new fw;b.text=WordEditorIntl.WordEditorStrings.L_CitationStyleLearnMore;b.ata=()=>{Le.a.openWindow(4,this.vBk)};this.HBb||(this.HBb=this.swa.create(WordEditorIntl.WordEditorStrings.L_CitationStylePromptTitle,WordEditorIntl.WordEditorStrings.L_CitationStylePromptText,null),this.HBb.id=32,this.HBb.closeable=!0,this.HBb.image=3,this.HBb.rQd(b.text,b.ata),this.Qt.Jz(this.HBb,!1))}}s7(b){return this.Qt.s7(b)}Jz(b,h){this.Qt.Jz(b,h)}}Object(u.a)(Xh,"BusinessBarController",zo,[484,376,377]);class Dy{constructor(){this.menuTargetType=
null}}Object(u.a)(Dy,"MenuTargetDescriptor",null,[]);class bt{static get haa(){return null!=bt.xTg?bt.xTg:bt.xTg=Za.a.instance.resolve(31)}static showContextMenu(b,h){bt.haa.showContextMenu(b,h)}static m0b(b,h,r){bt.haa.m0b(b,h,r)}static ceb(b,h,r,A=null){bt.haa.ceb(b,h,r,A)}}Object(u.a)(bt,"BaseContextMenu",null,[]);class pj extends bt{constructor(b,h,r,A=!1,M,aa=null,oa){super();this.dsj=(Ja,fb,Cb,Gb,Sb)=>{if(1===Cb)return 32;Ja=Sb.Wy;Sb=Sb.rd;fb=Object.assign(new aj.a,{ExternalId:"ContextMenu",
UpdateDynamically:!0,MenuSectionList:[]});this.mFl(fb,Ja,Sb.IsShadowMenuOpen);Sb.MenuItems=fb;return 32};this.yfo=h;this.io=r;this.Jkb=aa;this.OWe=A;this.Xb(b);this.xgb=oa;pj.C4a[1]=ub.a.Eze;pj.C4a[2]=ub.a.k9d;pj.C4a[3]=ub.a.jAe}get JWl(){return Uh.a.HYd}get IWl(){return Uh.a.cXd}get KWl(){return Uh.a.fgd}get vyf(){return Uh.a.Lig}Xb(b){b.fb(ub.a.gkg,lc.a.application,this.dsj,96);b.fb(ub.a.fsj,lc.a.application,this.dsj,96)}show(b,h,r){let A=null,M=new Sys.UI.Bounds(0,0,0,0);const aa=this.qEm(b);if(aa&&
(b=b.Qa.node)&&(b=b.Be(Object(Lb.a)().Ad.pc))){M=eB.a.Ar(b,aa.end);if(y.AFrameworkApplication.isRtl&&M.x>h.x||!y.AFrameworkApplication.isRtl&&M.x+M.width<h.x||M.y+M.height<h.y)M=eB.a.Ar(b,aa.end-1);h.x=M.x+(y.AFrameworkApplication.isRtl?0:M.width);h.y=M.y+M.height;A=6}bt.ceb("ContextMenu",new Sys.UI.Bounds(h.x,h.y,M.width,M.height),r,A)}U2(b,h){return this.Uod(b)||pj.lec(ub.a.mergeCells)||pj.lec(ub.a.hOa)||this.RCg(b)||this.fSj(b,h)||pj.USj()||pj.ISj(b).returnValue}Uod(b){return 2===qa.StaticActiveAppFrame.za().mode&&
this.g9c(b)}jXc(b,h,r=null){if(ev.jD()&&2===qa.StaticActiveAppFrame.za().mode){h=this.xgb.v6h(b.Qa);if(!h||!this.inn()&&!this.Kon(h.errorDetails))return;h=h.errorDetails}else{if(!this.Uod(b))return;h=this.GDi(b)}var A=tj.a.Hg(h.lcid);const M=A?A.name:"UNKNOWN";A=Object(Xa.a)(pq.a,h)?h.typeId:"";v.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",h.errorType,h.proofingType,A,M);if(b=this.yfo.rfc(b,h))r.push.apply(r,b),this.PCn(h,A)}Kon(b){return b&&(1===
b.proofingType||2===b.proofingType)}inn(){y.AFrameworkApplication.vd("gec07842;ae49c383");return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RightClickALV2Refinement",!1)}PCn(b,h){const r=pj.C4a[b.proofingType];r&&(y.AFrameworkApplication.va.Ob(r,2),v.ULS.sendTraceTag(527799885,375,50,"AEditSurfaceContextMenu: Logging command {0}, typeId {1}, proofingType {2}, ALV2 flight {3}.",r,h,b.proofingType,ev.jD()))}GDi(b){return this.io.rsa(b.Qa).errorDetails}g9c(b){return this.io.Eve(b)}mjc(){return null}zXd(){}qEm(b){return this.g9c(b)?
this.io.rsa(b.Qa):(b=this.mjc(b))?new Jb.a(b.gw,b.cpEnd):null}RCg(b){if(2!==qa.StaticActiveAppFrame.za().mode||!b)return!1;b=sB.a.OIa(b.toArray());return!!Object(Al.a)().wW(b,14)}uTj(b,h){return 2===h||3===h&&!this.g9c(b)}fSj(b,h){return 3!==h||this.g9c(b)}MBl(){const b=[];b.push(Object.assign(new hk.a,{ExternalId:this.JWl}));b.push(Object.assign(new hk.a,{ExternalId:this.IWl}));b.push(Object.assign(new hk.a,{ExternalId:this.KWl}));return b}uGl(){const b=[];this.OWe&&b.push(Object.assign(new hk.a,
{ExternalId:this.vyf}));return b}static get Md(){return null!=pj.O_g?pj.O_g:pj.O_g=Za.a.instance.resolve(10)}static get Ahn(){null==pj.jWe&&(pj.jWe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("HyperlinkContextMenuOnEOPFixIsEnabled"):!1);return pj.jWe}static get Ycd(){null==pj.QAb&&(pj.QAb=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("MultiParagraphHyperlinkEditEnabled"):!1);return pj.QAb}static get Lya(){null==pj.Pca&&(pj.Pca=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("AddHyperlinkWhenSelectionContainsLineBreak"):
!1);return pj.Pca}static lec(b){return 32===y.AFrameworkApplication.va.Ob(b,1)}static USj(){return 2===qa.StaticActiveAppFrame.za().mode&&!!df.a.GC.WK&&df.a.GC.WK.W9c(ub.a.Ine.toString())}static WSj(b){if(1!==b.length||!b.Qa.Al)return!1;b=vd.a.Za(b.Qa.node);b.vb(11);b.rc();return(of.ListItemReader.Ce?of.ListItemReader.Cg(b):b.kv(4))&&!pj.Md.Pw(b).listType?!0:!1}static ISj(b){let h=!1,r=!1;if(!b)return{returnValue:!1,trb:h,T5c:r};if(pj.Ycd)return pj.m4o(b,r);if(!(b.fw||pj.Ahn&&2===b.length&&b.Wc.contextId===
lc.a.Uc))return{returnValue:!1,trb:h,T5c:r};b=b.Qa.clone();h=32===y.AFrameworkApplication.va.Nf(b,ub.a.$bb,1,!0,null,null);r=32===y.AFrameworkApplication.va.Nf(b,ub.a.GR,1,!0,null,null);return{returnValue:h||r,trb:h,T5c:r}}static m4o(b,h){let r;h=b.Qa.clone();r=pj.Lya&&cn.l(h);let A=!r&&32===y.AFrameworkApplication.va.Nf(h,ub.a.$bb,1,!0,null,null);if(b.fw||2===b.length&&b.Wc.contextId===lc.a.Uc)h=!r&&32===y.AFrameworkApplication.va.Nf(h,ub.a.GR,1,!0,null,null);else{h=!0;const M=b.length;for(let aa=
0;aa<M;aa++){const oa=b.K(aa).clone();if(oa.contextId===lc.a.paragraph||oa.contextId===lc.a.Cd)(r=pj.Lya&&cn.l(oa))||(h=32===y.AFrameworkApplication.va.Nf(oa,ub.a.GR,1,!0,null,null)&&h);else if(oa.contextId!==lc.a.Uc)return h=A=!1,{returnValue:!1,trb:A,T5c:h}}}return{returnValue:A||h,trb:A,T5c:h}}static yAi(b){const h=Object.assign(new te.a,{ControlList:[]});for(const r of b)h.ControlList.push(Object.assign(new hk.a,{ExternalId:r}));return h}static iE(b){const h=[];for(const r of b)h.push(Object.assign(new hk.a,
{ExternalId:r}));return h}}pj.jWe=null;pj.QAb=null;pj.Pca=null;pj.C4a=[];Object(u.a)(pj,"AEditSurfaceContextMenu",bt,[]);var ek=d(705),oo=d(1458),KA=d(1773),Rw=d(1006);class ps{static zDm(b,h,r){h=[];r.Wbo.rfc(r.Nem(b),h);return h}static knm(b,h,r){const A=[];if(r.Uod(b))return A;Rk.a.vLa&&!Y.a.Jt||r.kwf.zXd(b,null,h,A);return A}static MIm(b,h,r){const A=[];r.jXc(b,h,A);return A}}Object(u.a)(ps,"ContextMenuSectionHelper",null,[]);var XF=d(2095);class eo{static Ymm(b,h,r){h=[];r.cQl(b)&&h.push(Object.assign(new hk.a,
{ExternalId:"ReviewDesignerSuggestion",LabelText:r.OFm(b)}));return h}static ixm(){return pj.lec(ub.a.mergeCells)?pj.iE(["MergeCells"]):pj.lec(ub.a.Jze)?pj.iE(["SplitCells"]):[]}static MKm(){return pj.lec(ub.a.wze)&&(y.AFrameworkApplication.vd("4aah1391;h7hg6461"),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableSortInContextMenuEnabled",!1))?pj.iE(["Sort"]):[]}static tMm(b,h,r){h=[];if(!r.ti.c5h(b))return h;b=r.ti.SHi(b);h.push(Object.assign(new hk.a,{ExternalId:"AcceptChangeContext",
LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_AcceptChange,b)}));h.push(Object.assign(new hk.a,{ExternalId:"RejectChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_RejectChange,b)}));return h}static Yhm(b,h,r){return y.AFrameworkApplication.J.$("CatchUpActivityIsEnabled")&&b&&b.Qa&&b.Qa.node&&r.Dc&&r.Dc.Dfj(b.Qa.node)?pj.iE(["ShowCatchUpActivitiesForParagraph"]):
[]}static Snm(b){return mp.A3o(b)?pj.iE(["Draw"]):mp.MSj(b)?pj.iE(["EditIllustration"]):[]}static qPm(b){return mp.c6o(b)?[Object.assign(new Se.a,{ExternalId:"WrapTextMenu"})]:[]}static J7d(b,h,r){return r.vQl(b)?pj.iE(["CreatePullQuote"]):[]}static getContentControls(b,h,r){return r.bQl()?pj.iE(["RemoveContentControl"]):[]}static Mjm(){return pj.iE(["NewComment"])}static tim(b){const h=[];!mp.QCg(b)&&mp.sCg(b)&&ec.SessionStatusManager.instance.WA&&b.kP&&h.push(Object.assign(new Se.a,{ExternalId:"ChangePictureMenu",
QueryCommand:"QueryChangePictureHostButton"}));return h}static gum(b,h,r){h=[];!mp.QCg(b)&&mp.sCg(b)&&ec.SessionStatusManager.instance.WA&&(v.ULS.sendTraceTag(39188235,1303,50,"Showing Insights context menu option"),b.kP&&!y.AFrameworkApplication.J.$("ChangePicturesIsEnabled")?h.push(...pj.iE(["ChangePicture"])):h.push(...r.uEl().ControlList),(b=mp.Ryi())&&0<b.length&&(r=r.kIl(b),null!=r&&h.push(...r.ControlList)));return h}static nEm(){return pj.USj()?pj.iE(["SetProofingLanguage"]):[]}static XFm(b,
h,r){return r.hnn&&r.k5o(b)?pj.iE(["Rewrite"]):[]}static Ovm(b){return pj.WSj(b)?pj.iE(["StartNewList","ContinueNumbering","SetNumberingValue"]):[]}static YBm(){return mp.hTj()?pj.iE(["ParagraphOptions"]):[]}static atm(b){return mp.MSj(b)?pj.iE(["EditIllustration"]):[]}static DIm(b){return mp.QCg(b)?pj.iE(["ShowSmartLookupPane"]):[]}static DMm(b){return mp.ZSj(b)?pj.iE(["ModernTranslatorSplitButton"]):[]}static ksm(b,h,r){h=[];if(b.fw){const A=b.Qa;if(A.contextId===lc.a.paragraph||A.contextId===lc.a.Xc||
A.contextId===lc.a.Cd){b=b.Qa.node;if(!r.Vg.Vb(b)||b.zs||""===b.characterData)return h;r.Jxf.S5d(b)&&h.push(...pj.iE(["CreateHeadingLink"]))}}return h}static getBookmark(b,h,r){h=[];if(b.fw){const A=b.Qa;(ze.a.pf(A)||ze.a.D$a(A))&&r.wbl.p5d(b.Qa.node,b.Qa.cpBegin)&&(h.push(...pj.iE(["DeleteBookmarkContextMenu"])),h.push(...pj.iE(["EditBookmarkNameContextMenu"])))}return h}static Xka(b){let h=!1,r=!1;const A=[];({trb:h,T5c:r}=pj.ISj(b)).returnValue&&(h?r?A.push(...pj.iE(["EditHyperlink","SelectHyperlink",
"OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):A.push(...pj.iE(["OpenHyperlink"])):r&&(y.AFrameworkApplication.J.$("IsO365CommercialHost")||y.AFrameworkApplication.J.$("IsO365ConsumerHost")?A.push(...pj.iE(["InsertLinkFlyout"])):A.push(...pj.iE(["InsertLink"]))));return A}static hjm(b,h,r){const A=[];if(!r.fSj(b,h))return A;2===qa.StaticActiveAppFrame.za().mode?(A.push(...r.MBl()),A.push(...r.uGl()),3===h&&r.g9c(b)&&A.push(Object.assign(new hk.a,{ExternalId:"Delete"}))):(!y.AFrameworkApplication.z0&&
!y.AFrameworkApplication.lH||y.AFrameworkApplication.ENb)&&A.push(Object.assign(new hk.a,{ExternalId:"Copy"}));return A}static HFf(b,h,r){return r.RCg(b)&&r.uTj(b,h)?pj.iE(["EditTableAltText"]):[]}static Vyi(b,h,r){return r.mQl(b)?pj.iE(["ShowIntentSuggestion"]):[]}static yKm(b,h,r){const A=[];r.RCg(b)&&!r.uTj(b,h)&&(A.push(Object.assign(new Se.a,{ExternalId:"InsertTableMenu"})),A.push(Object.assign(new Se.a,{ExternalId:"DeleteTableMenu"})),A.push(Object.assign(new Se.a,{ExternalId:"SelectTableMenu"})));
return A}static EKm(b,h,r){return r.G5o(b)?pj.iE(["UpdateTableOfContents"]):[]}static Jom(b){return mp.H3o(b)?pj.iE(["ShowHideEquationToolsPane"]):[]}static glm(b,h,r){switch(r.eSk){case XF.a.blankDocument:case XF.a.blankLine:return pj.iE(["OpenCopilotComposeDraftContent"]);case XF.a.selection:return pj.iE(["OpenCopilotComposeRewrite"]);default:return[]}}}Object(u.a)(eo,"ContextMenuSectionItemHelper",null,[]);class mp extends pj{get Vg(){return this.jb}get Jxf(){return this.X1a}constructor(b,h,r,
A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc,zc,Yc,Kd,ke,ge,de=!1,Sd=null,be=null,Rf,Mf,Yj,Ji){super(b,h,r,de,void 0,Sd,Rf);this.xZd=Ji;this.F3e=this.FS=null;this.GVe=this.zjh=!1;this.qve=new Map;this.wD={};this.wub={};this.ga=b;this.J=A;this.ti=M;this.qZ=Ja;this.GK=fb;this.Tn=Cb;this.JPk=!!Sd;this.kwf=Gb;this.Wbo=Sb;this.kdh=Kd;this.Moa=ke;this.wbl=ge;this.X1a=Yj;this.jb=Mf;Yc&&Yc.execute(sm=>{this.eCh=sm});pc&&pc.execute(sm=>{this.F3e=sm});this.Dc=oa;this.pu=zc;be&&be.execute(sm=>{this.FS=sm});this.K2m();this.M$n();
this.k4l();this.a4l().catch(()=>{v.ULS.sendTraceTag(508679947,3048,50,"Fetching copilot state for context menu failed.")});this.L$n()}get vyf(){return this.JPk?Uh.a.dgd:super.vyf}z1o(){const b=$l.a.Mm.kb.Jc.mb.gb.currentSelection;return this.Uod(b)&&2!==this.GDi(b).errorType}U2(b,h){return super.U2(b,h)||mp.hTj()||pj.WSj(b)||mp.sCg(b)||mp.ZSj(b)}mFl(b,h,r){const A=[];let M=null;try{M=$l.a.Mm.kb.Jc.mb.gb.currentSelection}catch(aa){v.ULS.sendTraceTag(576481226,341,15,"Selection was not initialized in time for ContextMenu Population");
return}this.z$n(M,h,A,this.Vkm(M));b.MenuSectionList.push(...A);this.VSo(b);!r&&this.eCh&&this.eCh.Pdo(b.MenuTargetDescriptor.menuTargetType,A)}Vkm(b){return pj.lec(ub.a.mergeCells)?hr.dRg:b.w8c?hr.APg:b.kP?hr.xQg:b.woc()?hr.tPg:b.WWa?hr.mPg:hr.FPg}vEl(b){b=mp.JEl(b);return Object.assign(new hk.a,{ExternalId:"SmartLookupContextMenu",LabelText:b})}lIl(b){return(b=mp.Rck(b))?Object.assign(new hk.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}):null}uEl(){const b=Object.assign(new te.a,{ControlList:[]}),
h=mp.Ryi();b.ControlList.push(this.vEl(h));return b}kIl(b){const h=Object.assign(new te.a,{ControlList:[]});if(b&&0<b.length){b=this.lIl(b);if(null==b)return null;h.ControlList.push(b)}return h}Toc(b){return b.kP||2<b.length||!b.length||2===b.length&&!ze.a.ll(b.Wc)||1===b.length&&ze.a.ll(b.Wc)?!1:this.L0f(b.Qa)}L0f(b){return Gd.ParagraphReader.Vb(b.node)?""!==Gd.ParagraphReader.text(b.node).trim():!1}G5o(b){var h=vd.a.Za(b.Qa.node);h=Object(ya.a)(ek.a,h.currentNode);return b.kP?!1:!!h&&h.zs}k4l(){this.J.$("RewriteIsEnabled")||
this.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.pu.execute(b=>{b.isFeatureEnabled(oo.a.Rej,!1).then(h=>{h||v.ULS.sendTraceTag(592995265,341,50,"Rewrite license missing, skip creating context menu item");this.zjh=h;return null})}):v.ULS.sendTraceTag(592995266,341,50,"Rewrite flight not enabled, skip creating context menu item")}async a4l(){v.ULS.sendTraceTag(508679949,3048,50,"Fetching copilot state for context menu.");this.GVe=await (await Object(Rw.c)(this.Gzl)).isEnabled();
v.ULS.sendTraceTag(508679948,3048,50,`Fetching copilot state for context menu complete. Enabled: ${this.GVe}`)}get hnn(){return this.J.$("RewriteIsEnabled")||this.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.zjh&&!this.GVe:!1}k5o(b){if(!this.Toc(b)||b.WWa||b.woc())return!1;b=b.Qa;if(Gd.ParagraphReader.fn(b)||ze.a.pf(b)||ze.a.Zl(b)){b=this.GK.pKa(b);b||(b=y.AFrameworkApplication.lcid);switch(b&1023){case 9:return!0;case 10:if(this.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",
!1))return!0}return!1}}mQl(b){if(1!==b.length||Y.a.Jt)return!1;const h=Rk.a.vLa;if(h&&this.z1o()||ev.jD()&&!this.xgb.v6h(b.Qa))return!1;const r=mp.sc.isFeatureEnabled(55);return b.K(0).contextId===lc.a.Xc&&(h||r)&&0<this.Tn.O2c(b.K(0),0).count||h&&this.mjc(b)?!0:!1}cQl(b){return 1===b.length&&this.kdh.TB(b.Qa.node).Lla}OFm(b){var h,r;const A=null===(h=this.xZd)||void 0===h?void 0:h.cX(null===(r=null===b||void 0===b?void 0:b.Qa)||void 0===r?void 0:r.node);return KA.a.LHi(A)}get Mw(){return null!=this.UTg?
this.UTg:this.UTg=Za.a.instance.Oa(1057)}get Hzl(){return null!=this.ATg?this.ATg:this.ATg=Za.a.instance.Oa(1058)}get Gzl(){return null!=this.zTg?this.zTg:this.zTg=Za.a.instance.Ra(689)}vQl(b){if(!this.Moa.CVi()||!this.Mw||this.Mw.isVisible||!(1===b.length||2===b.length&&ze.a.ll(b.Wc))||b.Dtb||!ze.a.Zl(b.Qa)&&b.Qa.contextId!==lc.a.paragraph||b.p0i()||this.kdh.TB(b.Qa.node).Lla)return!1;const h=Gd.ParagraphReader.text(b.Qa.node),r=b.Qa.contextId===lc.a.paragraph?0:b.Qa.cpBegin,A=b.Qa.contextId===lc.a.paragraph?
h.length:b.Qa.cpEnd-r;return 1>A||1500<A||I.a.Tf(I.a.uDa(h.substr(r,A)))||1!=jt.a.nqb(b.Qa.node)?!1:!0}bQl(){return 32==this.ga.Ob(ub.a.Hjd,1)}mjc(b){return this.kwf.mjc(b)}zXd(b,h,r,A=null){this.Uod(b)||this.kwf.zXd(b,h,r,A)}Nem(b){return this.F3e?this.F3e.Oem(b):[]}VSo(b){const h=this.FS?this.FS.contentType:"Unknown";b.MenuTargetDescriptor=Object.assign(new Dy,{menuTargetType:h})}static get sc(){return null!=mp.rVg?mp.rVg:mp.rVg=Za.a.instance.resolve(12)}static sCg(b){return y.AFrameworkApplication.Y2&&
!b.WWa&&Za.a.instance.resolve(1059).Oqn()}static K7d(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=I.a.VA(b,h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}static JEl(b){let h=WordEditorIntl.WordEditorStrings.L_ContextMenuSmartLookup;(b=mp.K7d(b))&&0<b.length&&(h=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSmartLookup,b));return h}static Rck(b){b=mp.K7d(b);return null!=b&&0<b.length?String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSynonyms,
b):null}static Ryi(){const b=(new Xr.a).getSelectedText();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static MSj(b){const h=mp.sc.isFeatureEnabled(43);return!b.SVc&&h&&!Y.a.Jt&&b.WWa}static A3o(b){const h=mp.sc.isFeatureEnabled(43);return!b.SVc&&h&&!Y.a.Jt&&b.kP}static QCg(b){return y.AFrameworkApplication.J.$("WordEditorSmartLookupIsEnabled")&&!b.woc()}static ZSj(b){return y.AFrameworkApplication.J.$("LanguageTranslationIsEnabled")&&!b.WWa&&!b.woc()}static H3o(b){return b.q0i()&&
y.AFrameworkApplication.ua.Ib.P9c}static hTj(){return 2===$l.a.Mm.mode}static c6o(b){return b.kP}get eSk(){var b;return null===(b=this.Hzl)||void 0===b?void 0:b.iSk}z$n(b,h,r,A){this.wub[A].forEach(M=>{const aa=Object.assign(new te.a,{ControlList:[]}),oa=aa.ControlList;M.forEach(Ja=>{Ja instanceof Iq?r.push(...this.qve.get(Ja)(b,h,this)):oa.push(...this.wD[Ja](b,h,this))});(null===oa||void 0===oa?0:oa.length)&&r.push(aa)})}L$n(){this.qve.set(Iq.e3b,ps.zDm);this.qve.set(Iq.zGe,ps.knm);this.qve.set(Iq.qHe,
ps.MIm)}M$n(){this.wD[Yf.GAb]=eo.hjm;this.wD[Yf.wHe]=eo.yKm;this.wD[Yf.xHe]=eo.EKm;this.wD[Yf.yGe]=eo.Ymm;this.wD[Yf.VGe]=eo.ixm;this.wD[Yf.yHe]=eo.MKm;this.wD[Yf.jGe]=eo.HFf;this.wD[Yf.PGe]=eo.gum;this.wD[Yf.Hud]=eo.Vyi;this.wD[Yf.OGe]=eo.atm;this.wD[Yf.pHe]=eo.DIm;this.wD[Yf.AHe]=eo.DMm;this.wD[Yf.cHe]=eo.nEm;this.wD[Yf.gHe]=eo.XFm;this.wD[Yf.Kud]=eo.Ovm;this.wD[Yf.Nud]=eo.YBm;this.wD[Yf.dHe]=eo.J7d;this.wD[Yf.qud]=eo.getContentControls;this.wD[Yf.XHe]=eo.qPm;this.wD[Yf.AGe]=eo.Snm;this.wD[Yf.qGe]=
eo.tim;this.wD[Yf.zHe]=eo.tMm;this.wD[Yf.pGe]=eo.Yhm;this.wD[Yf.pud]=eo.getBookmark;this.wD[Yf.LGe]=eo.ksm;this.wD[Yf.NGe]=eo.Xka;this.wD[Yf.O0a]=eo.Mjm;this.wD[Yf.Hud]=eo.Vyi;this.wD[Yf.BGe]=eo.Jom;this.wD[Yf.YOg]=eo.glm}K2m(){const b=[Yf.VGe,Yf.yHe,Yf.jGe,Yf.wHe];this.wub[hr.dRg]=[[Yf.GAb],b,[Yf.O0a],[Iq.e3b],[Yf.qud]];this.wub[hr.xQg]=[[Yf.GAb],[Yf.qGe,Yf.AGe,Yf.XHe],b,[Yf.O0a],[Iq.e3b]];this.wub[hr.tPg]=[[Yf.BGe],[Yf.Kud,Yf.Nud],[Yf.pud,Yf.O0a],[Iq.e3b]];this.wub[hr.FPg]=[[Yf.Hud],[Yf.yGe],[Iq.qHe],
[Iq.zGe],[Yf.GAb],[Yf.PGe,Yf.OGe,Yf.pHe,Yf.AHe],[Yf.cHe,Yf.gHe,Yf.Nud],[Yf.YOg],[Yf.Kud],b,[Yf.qud],[Yf.NGe,Yf.pud,Yf.LGe,Yf.O0a],[Yf.dHe],[Yf.zHe],[Yf.pGe],[Yf.xHe],[Iq.e3b]];this.wub[hr.APg]=[[Yf.GAb],[Yf.O0a]];this.wub[hr.mPg]=[[Yf.GAb],[Yf.OGe]];this.wub[hr.Wek]=[[Yf.Hud],[Yf.yGe],[Iq.qHe],[Iq.zGe],[Yf.GAb],[Yf.qGe],[Yf.AGe],[Yf.XHe],[Yf.PGe],[Yf.pHe],[Yf.AHe],[Yf.cHe],[Yf.gHe],[Yf.BGe],[Yf.Kud],[Yf.Nud],[Yf.NGe],[Yf.VGe],[Yf.yHe],[Yf.jGe],[Yf.wHe],[Yf.pud],[Yf.LGe],[Yf.O0a],[Yf.dHe],[Yf.qud],
[Yf.zHe],[Yf.pGe],[Yf.xHe],[Iq.e3b]]}}Object(u.a)(mp,"EditSurfaceContextMenu",pj,[]);var hr;(function(b){b[b.dRg=1]="TABLE_MULTI_CELL";b[b.FPg=2]="GENERIC";b[b.xQg=3]="PICTURE";b[b.tPg=4]="EQUATION";b[b.Wek=5]="LEGACY";b[b.APg=6]="FLUID";b[b.mPg=7]="DRAWING"})(hr||(hr={}));Object(u.b)("Scenarios",hr);class Iq{}Iq.e3b=new Iq;Iq.zGe=new Iq;Iq.qHe=new Iq;Object(u.a)(Iq,"Sections",null,[]);var Yf;(function(b){b[b.Hud=1]="INTENT_SUGGESTION";b[b.GAb=2]="ESSENTIALS";b[b.PGe=3]="INSIGHT";b[b.OGe=4]="ILLUSTRATION";
b[b.pHe=5]="SMART_LOOKUP";b[b.AHe=6]="TRANSLATE";b[b.cHe=7]="PROOFING";b[b.gHe=8]="REWRITE_SUGGESTIONS";b[b.Kud=9]="LISTS";b[b.Nud=10]="PARAGRAPH_OPTIONS";b[b.VGe=11]="MERGE_SPLIT_CELLS";b[b.yHe=12]="TABLE_SORT";b[b.jGe=13]="ALT_TEXT";b[b.NGe=14]="HYPERLINK";b[b.pud=15]="BOOKMARK";b[b.LGe=16]="HEADING_LINK";b[b.O0a=17]="COMMENT";b[b.dHe=18]="PULL_QUOTE";b[b.XHe=19]="WRAP_TEXT";b[b.AGe=20]="DRAW";b[b.zHe=21]="TRACK_CHANGE";b[b.pGe=22]="CATCHUP_ACTIVITIES";b[b.xHe=23]="TABLE_OF_CONTENTS";b[b.yGe=24]=
"DESIGNER_REVIEW";b[b.wHe=25]="TABLE_ITEMS";b[b.qGe=26]="CHANGE_PICTURE";b[b.BGe=27]="EQUATION_TOOLS";b[b.qud=28]="CONTENT_CONTROL";b[b.YOg=29]="COPILOT_COMPOSE"})(Yf||(Yf={}));Object(u.b)("SectionItem",Yf);class ru extends bt{constructor(b,h,r){super();this.il=null;this.Cpe=(A,M,aa,oa,Ja)=>{if(1===aa)return 32;A=[];M=[];this.A1o()&&M.push("InsertTabStopMenuSplitButton");this.l1o()&&M.push("ClearAllTabStops");M.push("HideRuler");A.push(ru.yAi(M));M=Object.assign(new aj.a,{ExternalId:"RulerContextMenu",
UpdateDynamically:!0,MenuSectionList:[]});M.MenuSectionList.push(...A);Ja.MenuItems=M;return 32};this.ga=b;this.Xn=h;this.pA=r;this.Xb()}get uib(){return document.getElementById("WACHorizontalRuler")}get pQ(){return this.Xn&&this.Xn.instance?this.Xn.instance.yj:1}get target(){return this.il}show(b,h){this.il=b;bt.m0b("RulerContextMenu",b,h);v.ULS.sendTraceTag(592307397,3014,50,"Ruler Context menu invoked.");b=new Map;b.set("Command","Show");b.set("Source",ru.MR);b.set("Response","Ruler Context menu invoked.");
Ba.Health.instance.recordKpiUsage(ru.kpiName,1,ru.yaa,b)}qFm(){var b=0,h=(this.target.x-Le.a.lGf(this.uib))/this.pQ;h=Ah.a.$z(h,0);var r={},A=this.pA.nOb,M=vd.a.Za(A);M.Kd();if(!Ii.TableReader.ny(M))return 32===this.ga.Pb(ub.a.YMa,2,r)&&(b=r.marginLeft),h-b;b={};M={};r=this.ga.Pb(ub.a.hid,2,b);var aa=this.ga.Pb(ub.a.eYb,2,M);if(32!==r||32!==aa)return v.ULS.sendTraceTag(559252943,3014,15,"Unable to read table properties for Ruler Context Menu"),h;b=b.ColumnWidths;aa=M.TablePosition;if(!aa||!b||0>=
b.length)return v.ULS.sendTraceTag(559252944,3014,15,"Queried table properties are null or do not exist"),h;r=0;M=vd.a.Za(A);M.vb(14)&&(M.ld(16),r=cr.a(M,!0));A=aa.x/this.pQ;for(M=0;M<r;M++)A+=b[M];return h-A}Xb(){this.ga.fb(Fc.a.Cpe,lc.a.application,this.Cpe,96)}A1o(){var b={},h={},r=this.ga.Pb(ub.a.YMa,2,b),A=this.ga.Pb(ub.a.Kcb,2,h);if(32===r&&32===A){A=h.Du;r=Ah.a.qj(A.Cfa,0);A=1===A.specialIndentType?Ah.a.qj(A.RA,0):Ah.a.qj(A.RA-A.oha,0);const M=Ah.a.qj(b.marginLeft,0);b=Ah.a.qj(b.marginRight,
0);const aa=Le.a.lGf(this.uib),oa=Le.a.Hsi(this.uib);h.isRtl?(h=aa+this.pQ*Math.max(b,b+r),r=oa-this.pQ*Math.max(M,M+A)):(h=aa+this.pQ*Math.max(M,M+A),r=oa-this.pQ*Math.max(b,b+r));if(this.target.x>=h&&this.target.x<=r)return!0}return!1}l1o(){var b={};if(32!==this.ga.Pb(Fc.a.SXb,2,b)||!b)return!1;b=b.customTabs;return!b||0>=b.length?!1:!0}static yAi(b){const h=Object.assign(new te.a,{ControlList:[]});for(const r of b)h.ControlList.push(Object.assign(new hk.a,{ExternalId:r}));return h}}ru.yaa="wwaengidc";
ru.kpiName="WordRuler";ru.MR="RulerContextMenu";Object(u.a)(ru,"RulerContextMenu",bt,[483]);var Ym=d(279),Cj=d(1335),kj=d(455),YF=d(749),LA=d(1138),sF=d(1693);class Is{constructor(){this.lineStyle=pi.a.MH;this.Ppc=pi.a.NH;this.borderColor=pi.a.g2}}Object(u.a)(Is,"TableBorderFormattingData",null,[]);var ku=d(697);class sA{constructor(){this.c3=this.DXi=!1;this.xzb=ku.a.none;this.Ax=0;this.Mfb=1}}Object(u.a)(sA,"WrapTextPropertiesData",null,[]);var tF=d(1045);class gl extends LA.a{constructor(b=null){super(b);
this.kCh=new sF.a;this.MJh=new sA;this.NFh=new Is;this.cTe=!1;this.xOi=h=>{const r=new Ym.a;r.EJa=!0;r.xO=h;return r};this.dY=()=>{const h=new Ym.a;h.VQb=!1;h.xO=ub.a.YMa;h.rd=this.kCh;h.ioc=!0;h.Sla=!0;return h};this.Jvj=()=>{const h=new Ym.a;h.VQb=this.cTe;this.cTe=!0;h.xO=ub.a.aNa;h.rd=this.NFh;h.ioc=!0;h.Sla=!0;return h};this.Std=()=>{const h=new Ym.a;h.VQb=!1;h.xO=Fc.a.iuc;h.rd=this.MJh;h.ioc=!0;h.Sla=!0;return h};this.W$d=(h,r)=>{const A=new Ym.a;A.rd=new wg.DictionaryPropertySet;switch(h){case Fc.a.i6c:A.rd.setValue(pd.a.Srb,
r[ui.a.Number]);break;case Fc.a.f6c:A.rd.setValue(pd.a.Prb,r[ui.a.Number]);break;case Fc.a.g6c:A.rd.setValue(pd.a.Qrb,r[ui.a.Number]);break;case Fc.a.h6c:A.rd.setValue(pd.a.Rrb,r[ui.a.Number])}return A};this.Wgo=()=>{const h=new Ym.a;h.rd=new wg.DictionaryPropertySet;h.Sla=!0;return h}}initialize(){super.initialize();this.jd.Z(Fc.a.g2f,Cj.a.dsb);this.jd.Z(Fc.a.j2f,Cj.a.dsb);this.jd.Z(Fc.a.l2f,Cj.a.dsb);this.jd.Z(Fc.a.tng,gl.jZa);this.jd.Z(Fc.a.aid,gl.jZa);this.jd.Z(Fc.a.mng,gl.jZa);this.jd.Z(Ka.a.hYb,
gl.jZa);this.jd.Z(ub.a.Tqe,this.dY);this.jd.Z(ub.a.Sqe,this.dY);this.jd.Z(ub.a.Rqe,this.dY);this.jd.Z(ub.a.Vqe,this.dY);this.jd.Z(ub.a.Uqe,this.dY);this.jd.Z(ub.a.Qqe,this.dY);this.jd.Z(ub.a.bre,this.dY);this.jd.Z(ub.a.are,this.dY);this.jd.Z(ub.a.$qe,this.dY);this.jd.Z(ub.a.Xqe,this.dY);this.jd.Z(ub.a.Yqe,this.dY);this.jd.Z(ub.a.Zqe,this.dY);this.jd.Z(ub.a.Jng,this.dY);this.jd.Z(ub.a.Ing,this.dY);this.jd.Z(ub.a.Wmg,this.dY);this.jd.Z(ub.a.Ymg,this.dY);this.jd.Z(ub.a.Xmg,this.dY);this.jd.Z(ub.a.Vmg,
this.dY);this.jd.Z(ub.a.Qdb,gl.EFn);this.jd.Z(ub.a.j_a,gl.Y4n);this.jd.Z(ub.a.Pxb,gl.Tsl);Object(tF.a)()&&(this.jd.Z(ub.a.twc,gl.Zvn),this.jd.Z(ub.a.yng,this.dY),this.jd.Z(ub.a.xng,this.dY));this.jd.Z(ub.a.Gqa,gl.jZa);this.jd.Z(ub.a.rXb,gl.jZa);this.jd.Z(ub.a.nZa,gl.jZa);this.jd.Z(ub.a.Yya,gl.jZa);this.jd.Z(ub.a.kDa,gl.jZa);this.jd.Z(Fc.a.Kgd,gl.jZa);this.jd.Z(Fc.a.g3d,Cj.a.GDf);this.jd.Z(Fc.a.h3d,this.Xqi);this.Jn.Z(Fc.a.Igd,Cj.a.DUa);this.Jn.Z(Fc.a.Jgd,Cj.a.DUa);this.jd.Z(ub.a.F_b,Cj.a.$7a);this.jd.Z(ub.a.E_b,
Cj.a.$7a);this.jd.Z(ub.a.hyb,Cj.a.$7a);this.jd.Z(ub.a.Xng,this.mH);this.jd.Z(ub.a.Vng,this.mH);this.jd.Z(ub.a.Wng,this.mH);this.jd.Z(ub.a.dM,gl.pfo);this.Jn.Z(Fc.a.Gre,gl.Bjd);this.Jn.Z(Fc.a.Hre,gl.Bjd);this.Jn.Z(Fc.a.Ire,gl.Bjd);this.Jn.Z(Fc.a.Ere,gl.Bjd);this.Jn.Z(Fc.a.Fre,gl.Bjd);this.jd.Z(Fc.a.Gre,this.Std);this.jd.Z(Fc.a.Hre,this.Std);this.jd.Z(Fc.a.Ire,this.Std);this.jd.Z(Fc.a.Ere,this.Std);this.jd.Z(Fc.a.Fre,this.Std);this.jd.Z(Fc.a.WFe,gl.fBc);this.jd.Z(Fc.a.XFe,gl.fBc);this.jd.Z(Fc.a.YFe,
gl.fBc);this.jd.Z(Fc.a.ZFe,gl.fBc);this.jd.Z(Fc.a.$Fe,gl.fBc);this.jd.Z(Fc.a.aGe,gl.fBc);this.jd.Z(Fc.a.ZNa,gl.sic);this.jd.Z(Fc.a.BSj,gl.sic);this.jd.Z(Fc.a.CSj,gl.sic);this.jd.Z(Fc.a.Eye,gl.sic);this.jd.Z(Fc.a.Fye,gl.sic);this.jd.Z(Fc.a.Iod,gl.sic);this.jd.Z(Fc.a.Cwb,this.Wgo);this.jd.Z(Fc.a.Mhd,gl.M3d);this.jd.Z(Fc.a.Jqe,gl.M3d);this.jd.Z(Fc.a.Kqe,gl.M3d);this.jd.Z(Fc.a.Lqe,gl.M3d);this.jd.Z(Fc.a.i6c,this.W$d);this.jd.Z(Fc.a.f6c,this.W$d);this.jd.Z(Fc.a.g6c,this.W$d);this.jd.Z(Fc.a.h6c,this.W$d);
this.jd.Z(ub.a.Nsa,this.xOi);this.jd.Z(ub.a.hNb,this.xOi);this.jd.Z(Fc.a.Awb,gl.Awb);this.jd.Z(Fc.a.Nye,Cj.a.$7a);this.jd.Z(ub.a.aog,this.Jvj);this.jd.Z(ub.a.bog,this.Jvj)}clearCache(){super.clearCache();this.cTe=!1;this.kCh=new sF.a;this.MJh=new sA;this.NFh=new Is}AHf(){const b=super.AHf();b.SHa=gl.SHa;b.M5a=gl.M5a;return b}static get u4n(){return null!=gl.U0g?gl.U0g:gl.U0g=Za.a.instance.Oa(1060)}static get gB(){gl.oya||(gl.oya=Za.a.instance.Oa(873));return gl.oya}static jZa(b,h){b=new Ym.a;b.rd=
h;return b}static cnd(b,h,r){h[Vg.a.Description]=b?b.BFn(r):null}static SHa(b,h){const r=Object(ya.a)(sF.a,b.rd),A=Object(ya.a)(kj.a,b.rd),M=Object(ya.a)(sA,b.rd),aa=Object(ya.a)(Is,b.rd);let oa=!0;const Ja=gl.u4n;switch(b.Kvb){default:oa=LA.a.SHa(b,h);break;case ub.a.Tqe:h[Pm.a.Icon]=r.RBa?"PageMarginsLandscapeNormal_48":"PageMarginsPortraitNormal_48";h[Vg.a.On]=!r.UUb;gl.cnd(Ja,h,0);break;case ub.a.Sqe:h[Pm.a.Icon]=r.RBa?"PageMarginsLandscapeNarrow_48":"PageMarginsPortraitNarrow_48";h[Vg.a.On]=
1===r.UUb;gl.cnd(Ja,h,1);break;case ub.a.Rqe:h[Pm.a.Icon]=r.RBa?"PageMarginsLandscapeModerate_48":"PageMarginsPortraitModerate_48";h[Vg.a.On]=2===r.UUb;gl.cnd(Ja,h,2);break;case ub.a.Vqe:h[Pm.a.Icon]=r.RBa?"PageMarginsLandscapeWide_48":"PageMarginsPortraitWide_48";h[Vg.a.On]=3===r.UUb;gl.cnd(Ja,h,3);break;case ub.a.Uqe:h[Pm.a.Icon]=r.RBa?"PageMarginsLandscapeOffice2003_48":"PageMarginsPortraitOffice2003_48";h[Vg.a.On]=4===r.UUb;gl.cnd(Ja,h,4);break;case ub.a.Qqe:h[Pm.a.Icon]=r.RBa?"PageMarginsLandscapeCustom_48":
"PageMarginsPortraitCustom_48";h[Vg.a.On]=5===r.UUb;break;case ub.a.bre:h[Vg.a.On]=!r.OWb;h[Vg.a.Description]=Ja?Ja.Jfd(0):null;break;case ub.a.are:h[Vg.a.On]=1===r.OWb;h[Vg.a.Description]=Ja?Ja.Jfd(1):null;break;case ub.a.$qe:h[Vg.a.On]=2===r.OWb;h[Vg.a.Description]=Ja?Ja.Jfd(2):null;break;case ub.a.Xqe:h[Vg.a.On]=3===r.OWb;h[Vg.a.Description]=Ja?Ja.Jfd(3):null;break;case ub.a.Yqe:h[Vg.a.On]=4===r.OWb;h[Vg.a.Description]=Ja?Ja.Jfd(4):null;break;case ub.a.Zqe:h[Vg.a.On]=5===r.OWb;break;case ub.a.Jng:h[Vg.a.On]=
!r.RBa;break;case ub.a.Ing:h[Vg.a.On]=r.RBa;break;case ub.a.Wmg:h[Vg.a.On]=1===r.lVc;break;case ub.a.Ymg:h[Vg.a.On]=2===r.lVc;break;case ub.a.Xmg:h[Vg.a.On]=3===r.lVc;break;case ub.a.Vmg:h[Vg.a.On]=0===r.lVc;break;case ub.a.yng:h[Vg.a.On]=-1===r.q5i;break;case ub.a.xng:h[Vg.a.On]=2===r.q5i;break;case ub.a.Xng:h[Vg.a.On]=A.Du?!A.Du.specialIndentType:!1;break;case ub.a.Vng:h[Vg.a.On]=A.Du?1===A.Du.specialIndentType:!1;h[Xk.a.Image16by16Class]=A.isRtl?Gg.getImageClass("IndentSpecialFirstLineRTL_Server_16x16x32"):
Gg.getImageClass("IndentSpecialFirstLine_Server_16x16x32");break;case ub.a.Wng:h[Vg.a.On]=A.Du?2===A.Du.specialIndentType:!1;h[Xk.a.Image16by16Class]=A.isRtl?Gg.getImageClass("IndentSpecialHangingRTL_Server_16x16x32"):Gg.getImageClass("IndentSpecialHanging_Server_16x16x32");break;case Fc.a.Gre:h[Vg.a.On]=1===M.Mfb;break;case Fc.a.Hre:h[Vg.a.On]=8===M.Mfb;break;case Fc.a.Ire:h[Vg.a.On]=9===M.Mfb;break;case Fc.a.Ere:h[Vg.a.On]=3===M.Mfb;break;case Fc.a.Fre:h[Vg.a.On]=4===M.Mfb;break;case Fc.a.Cwb:h[Vg.a.On]=
b.rd.ka(pd.a.NBa,!1);break;case Fc.a.Awb:h[ja.a.IsFreeForm]=!0;h[ja.a.Value]=b.rd[Fh.a.Value];break;case ub.a.aog:h[Pd.a.On]=gl.gB.Csi(h.MenuItemId)===aa.lineStyle;break;case ub.a.bog:h[Pd.a.On]=gl.gB.Dsi(h.MenuItemId)===aa.Ppc}return oa}static EFn(b,h){b=5;switch(h.MenuItemId){case "buttonMarginsNormal":b=0;break;case "buttonMarginsNarrow":b=1;break;case "buttonMarginsModerate":b=2;break;case "buttonMarginsWide":b=3;break;case "buttonMarginsOffice2003":b=4}h=new Ym.a;h.rd=b;return h}static Y4n(b,
h){b=5;switch(h.MenuItemId){case "buttonSizeLetter":b=0;break;case "buttonSizeLegal":b=1;break;case "buttonSizeExecutive":b=2;break;case "buttonSizeA4":b=3;break;case "buttonSizeA5":b=4}h=new Ym.a;h.rd=b;return h}static Tsl(b,h){b=0;switch(h.MenuItemId){case "buttonOneColumn":b=1;break;case "buttonTwoColumns":b=2;break;case "buttonThreeColumns":b=3}h=new Ym.a;h.rd=b;return h}static Zvn(b,h){b=3;switch(h.MenuItemId){case "buttonLineNumberingNone":b=-1;break;case "buttonLineNumberingContinuous":b=2}h=
new Ym.a;h.rd=b;return h}static Awb(){const b=new Ym.a;b.xO=Fc.a.Awb;b.rd={};b.Sla=!0;b.ioc=!0;return b}static fBc(b,h){const r=new Ym.a;r.rd=new wg.DictionaryPropertySet;let A=1;switch(b){case Fc.a.ZFe:A=1;break;case Fc.a.$Fe:A=8;break;case Fc.a.aGe:A=9;break;case Fc.a.XFe:A=3;break;case Fc.a.YFe:A=4}r.rd.setValue(pd.a.Mfb,A);r.rd.setValue(pd.a.fOa,h[Vg.a.SourceControlId]);return r}static sic(b,h,r){b=new Ym.a;b.rd=r.InvocationMethod;return b}static pfo(b,h){b=new Ym.a;b.rd=h;return b}static Bjd(){const b=
new YF.a;b.xO=Fc.a.iuc;return b}static M3d(){const b=new Ym.a;b.rd=new wg.DictionaryPropertySet;b.L9c=!0;return b}static M5a(b,h){let r=!0;switch(b.Kvb){case Fc.a.Mhd:b=b.rd.ka(pd.a.Srb,0);h[ui.a.Number]=b;h[ui.a.UnitType]=7;break;case Fc.a.Jqe:b=b.rd.ka(pd.a.Prb,0);h[ui.a.Number]=b;h[ui.a.UnitType]=7;break;case Fc.a.Kqe:b=b.rd.ka(pd.a.Qrb,0);h[ui.a.Number]=b;h[ui.a.UnitType]=7;break;case Fc.a.Lqe:b=b.rd.ka(pd.a.Rrb,0);h[ui.a.Number]=b;h[ui.a.UnitType]=7;break;default:r=LA.a.M5a(b,h)}return r}}gl.oya=
null;Object(u.a)(gl,"CuiActionBridge",LA.a,[]);class uF extends ig.a{constructor(b){super();this.ptl=CommonUIStrings.l_AccHelpDialogCommandsHeaderText;this.hZo=CommonUIStrings.l_AccHelpDialogShortcutHeaderText;this.BZd=this.GHb=this.C9=this.m3a=this.A7e=null;this.LGj=h=>{h.target.setAttribute(Ne.a.imb,Ne.a.fq);Sys.UI.DomElement.removeCssClass(this.GHb,"inactiveRowSelection");this.GHb=h.target};this.KGj=h=>{h.target.removeAttribute(Ne.a.imb);Sys.UI.DomElement.addCssClass(h.target,"inactiveRowSelection")};
this.f_h=h=>{(h=h.target.parentNode)&&h!==this.GHb&&this.c4(h)};this.JYj=h=>h.Nb.keyCode===cf.a.Nu?(h.Nb.stopPropagation(),!0):!1;this.eKh=h=>{if(!h.Nb)return!1;const r=h.Nb.keyCode;if(h.eventName===Jd.a.hj){h=this.Itm(this.GHb);let A=-1;const M=qb.a.count(this.Pxe)-1;r===Sys.UI.Key.down?A=h<M?h+1:0:r===Sys.UI.Key.up?A=0<h?h-1:M:r===Sys.UI.Key.home?A=0:r===Sys.UI.Key.end&&(A=M);-1!==A&&this.c4(this.C9.tBodies[0].children[A])}return!0};this.Yb=b;this.kh="<div id='AccessibilityHelpDialogBody'></div>";
this.Ng="AAccessibilityHelpDialog";this.Fd=6;this.Qe(0,CommonUIStrings.l_DialogClose)}get jwf(){return null}get Pxe(){this.A7e||(this.A7e=this.$3m());return this.A7e}get Kdp(){return 300}get edj(){return"https://go.microsoft.com/fwlink/p/?LinkId=325036"}get ddj(){return CommonUIStrings.l_AccHelpDialogMoreHelpLinkText}get h7a(){return this.Yb.au()}e_a(b){super.e_a(b);this.j$n()}x_a(){this.showDialog(this.dialogTitle,Object(E.a)(this,this.mRk,"accHelpDialogResultHandler"));this.fNa();this.setFocus()}setFocus(){this.C9?
(this.GHb=this.C9.tBodies[0].firstChild,this.c4(this.GHb)):this.jJ&&"none"!==this.jJ.style.display?this.c4(this.jJ):this.c4(this.lB)}Oqa(){this.oe.nb(Jd.a.hj,this.BZd,this.eKh);if(this.C9){this.oe.nb(Jd.a.pi,this.C9,this.JYj);const b=this.C9.tBodies[0].children;for(let h=0;h<b.length;h++)if(mf.a.addHandler(b[h],Jd.a.focus,this.LGj),mf.a.addHandler(b[h],Jd.a.blur,this.KGj),Y.a.Jt){const r=b[h].children;for(let A=0;A<r.length;A++)mf.a.addHandler(r[A],Jd.a.focus,this.f_h)}}super.Oqa()}oob(){this.oe&&
(this.oe.xc(Jd.a.hj,this.BZd,this.eKh),this.C9&&this.oe.xc(Jd.a.pi,this.C9,this.JYj));if(this.C9){const b=this.C9.tBodies[0].children;for(let h=0;h<b.length;h++)if(mf.a.removeHandler(b[h],Jd.a.focus,this.LGj),mf.a.removeHandler(b[h],Jd.a.blur,this.KGj),Y.a.Jt){const r=b[h].children;for(let A=0;A<r.length;A++)mf.a.removeHandler(r[A],Jd.a.focus,this.f_h)}}super.oob()}fNa(){this.h7a.scope.nt(this.Yb.xZ);this.h7a.scope.nt(this.Yb.yZ);this.h7a.scope.bindAction(this.Yb.xZ,Ka.a.eRc);this.h7a.scope.bindAction(this.Yb.yZ,
Ka.a.dRc)}KUm(b){if(!this.h7a.Nk||!this.h7a.Nk.zra)return 2;var h=this.h7a.Nk.zra;if(this.C9&&(h===this.lB&&b===Ka.a.eRc||h===this.m3a&&b===Ka.a.dRc))this.c4(this.GHb);else if(h.id.startsWith("SelectableTableRow"))h=null,b===Ka.a.eRc?h=this.m3a:b===Ka.a.dRc&&(h=this.lB),h&&this.c4(h);else if(b===Ka.a.eRc)this.h7a.Vqc();else if(b===Ka.a.dRc)this.h7a.Tqc();else return 2;return 32}mRk(){}j$n(){this.BZd=document.getElementById("AccessibilityHelpDialogBody")||this.Iq;this.hIl();this.IHl();this.tFl()}hIl(){if(this.jwf){var b=
document.createElement("div");b.className="WACDialogSubtitle";var h=document.createElement("span");h.innerText=this.jwf;b.appendChild(h);this.Qoa.appendChild(b)}}IHl(){if(this.Pxe&&!qb.a.isEmpty(this.Pxe)){this.C9=document.createElement("table");this.C9.className="SelectableDialogTable";var b=document.createElement("thead"),h=document.createElement("tr");h.setAttribute(Ne.a.Ph,Ne.a.PSc);b.appendChild(h);var r=Fd.a.KWc(14,this.ptl);h.appendChild(r);r=Fd.a.KWc(14,this.hZo);h.appendChild(r);this.C9.appendChild(b);
b=document.createElement("tbody");h=0;r=this.Pxe;for(const aa in r){var A=aa,M=r[aa];const oa=document.createElement("tr");oa.tabIndex=0;oa.setAttribute(Ne.a.Ph,Ne.a.PSc);oa.id="SelectableTableRow"+h++;A=Fd.a.KWc(15,A);oa.appendChild(A);M=Fd.a.KWc(15,M);oa.appendChild(M);b.appendChild(oa)}b.style.maxHeight=this.Kdp+"px";this.C9.appendChild(b);this.BZd.appendChild(this.C9)}}tFl(){if(this.ddj&&this.edj){var b=document.createElement("div");b.className="WACDialogLearnMoreLinkContainer";this.m3a=document.createElement("a");
this.m3a.innerText=this.ddj;this.m3a.href=this.edj;this.m3a.target="_blank";this.m3a.id=this.Bj("AccessibilityHelpDialogLink");this.m3a.className=id.AFrame.zgf;b.appendChild(this.m3a);this.Oc.insertBefore(b,this.Oc.lastChild)}}Itm(b){return Number.parseInvariant(b.id.substr(18))}X1(b,h,r,A=null){b&&h&&r&&(r=A?String.format(r,A):r,b[h]=r)}QFi(b,h){return Y.a.Qm?h:b}}Object(u.a)(uF,"AAccessibilityHelpDialog",ig.a,[24]);class Js extends uF{constructor(b){super(b)}get dialogTitle(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWETitle}get jwf(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWESubtitle}$3m(){const b=
this.QFi(CommonUIStrings.l_AccHelpDialogCtrlKey,CommonUIStrings.l_AccHelpDialogCommandKey),h=this.QFi(CommonUIStrings.l_AccHelpDialogWindowsKey,CommonUIStrings.l_AccHelpDialogCtrlKey),r={};this.X1(r,CommonUIStrings.l_AccHelpDialogAccHelpCommand,CommonUIStrings.l_AccHelpDialogAccHelpShortcut);this.X1(r,CommonUIStrings.l_AccHelpDialogLandmarkRegionsCommand,CommonUIStrings.l_AccHelpDialogLandmarkRegionsShortcut,b);this.X1(r,CommonUIStrings.l_AccHelpDialogTellMeCommand,CommonUIStrings.l_AccHelpDialogTellMeShortcut);
this.X1(r,CommonUIStrings.l_AccHelpDialogAccessKeysCommand,CommonUIStrings.l_AccHelpDialogAccessKeysShortcut,h);this.X1(r,CommonUIStrings.l_AccHelpDialogTooltipToggle,CommonUIStrings.l_AccHelpDialogTooltipToggleShortcut,b);this.X1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteShortcut,b);this.X1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteShortcut,
b);this.X1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentShortcut);this.X1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerShortcut,b);this.X1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleShortcut,b);this.X1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptShortcut,b);this.X1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectShortcut,b);this.X1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousShortcut,b);this.X1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextShortcut,
b);this.X1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstShortcut,b);y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("AccessibleMovingDialogsEnabled")&&this.X1(r,CommonUIStrings.l_AccHelpDialogOpenDialogMenuCommand,CommonUIStrings.l_AccHelpDialogOpenDialogMenuShortcut);y.AFrameworkApplication.J.$("CatchUpActivityIsEnabled")&&this.X1(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsShortcut);(Js.sc&&Js.sc.isFeatureEnabled(55)||Rk.a.vLa)&&this.X1(r,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestion,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionShortcut);return r}static get sc(){return null!=Js.bVg?Js.bVg:Js.bVg=Za.a.instance.Oa(12)}}Object(u.a)(Js,"AccessibilityHelpDialog",uF,[]);var dI=d(390);class tA{static get kh(){return ig.a.Ry(tA.Hn,WordEditorIntl.WordEditorStrings.l_StyleName,WordEditorIntl.WordEditorStrings.l_BadStyleName)}}
tA.Hn="<div class='normal' id='text'> <label id='IntroLabel' class='WACDialogLabel' for='styleText' >{0}</label> <input type='text' id='styleText' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleError' role='alert'>{1}</div> </div>";Object(u.a)(tA,"ApplyStylesDialogHtml",null,[]);class wy extends ig.a{constructor(b,
h){super();this.wJ=null;this.FPc=!1;this.cJb=this.zgb=this.SLc=this.WLc=this.VPc=null;this.U6k=(r,A)=>{if(this.yh.mw){if(r){r=A.styleList;A=A.styleText;if(-1===r||I.a.vh(A)!==I.a.vh(this.wJ[r]))r=this.iGi(A);A=this.wJ[r];r=this.Wb.qo();si.a.Xg.Ln?(r=r.gv(),A=this.Wb.ze(r.YAa(A))):A=this.Wb.ze(r.wKa(A));y.AFrameworkApplication.va.Nf(this._context,ub.a.vT,2,!1,new dI.a,A)}this.yh.L8()}};this.y0n=r=>{this.FPc?(this.FPc=!1,this.validate()):"value"===r.rawEvent.propertyName&&(this.FPc=!0,this.O1.value!==
this.VPc&&(this.VPc=this.O1.value,this.aUh()))};this.UWn=()=>{-1!==this.dqa.selectedIndex&&(Y.a.x7&&(this.FPc=!0),this.VPc=this.wJ[this.dqa.selectedIndex],this.O1.value=this.wJ[this.dqa.selectedIndex],this.validate())};this.onKeyDown=r=>{Y.a.fM?r.keyCode!==cf.a.BD&&r.keyCode!==cf.a.F4||this.zgb||this.cJb||(this.cJb=new xc.a(0,1,1,this.FAp),y.AFrameworkApplication.oc.Zb(this.cJb)):Y.a.x7&&r.keyCode===cf.a.BD&&(this.FPc=!0)};this.HI=()=>{this.zgb||(this.zgb=new xc.a(0,1,1,this.x9k),y.AFrameworkApplication.oc.Zb(this.zgb));
this.cJb&&(y.AFrameworkApplication.oc.uf(this.cJb),this.cJb=null)};this.x9k=()=>{this.zgb=null;this.aUh()};this.FAp=()=>{this.cJb=null;this.validate()};this._context=b;this.Bd=h;this.Ng="ApplyStylesDialog";this.yh=this._context.view;this.dNf();b=this.sbp();h="";this.wJ.length>b&&(h=this.wJ[b]);h={["styleText"]:h,["styleList"]:b};this.kh=tA.kh;this.mi(WordEditorIntl.WordEditorStrings.l_ApplyStyles,this.U6k,h);this.dqa=document.getElementById("styleList");this.tkg();this.dqa.selectedIndex=b;this.O1=
document.getElementById("styleText");this.O1.focus();this.O1.select();this.vHd=this.UWn;mf.a.addHandler(this.dqa,"change",this.vHd);this.uHd=this.onKeyDown;mf.a.addHandler(this.O1,"keydown",this.uHd);Y.a.x7?(this.WLc=this.y0n,mf.a.addHandler(this.O1,"propertychange",this.WLc),this.VPc=this.wJ[b]):(this.SLc=this.HI,mf.a.addHandler(this.O1,"keypress",this.SLc))}get Wb(){return null!=this.R5g?this.R5g:this.R5g=Za.a.instance.resolve(8)}get Xg(){return null!=this.v3g?this.v3g:this.v3g=Za.a.instance.Oa(29)}sbp(){var b=
this.yh.mb;if(!b||!b.gb)return Tc.b(579216408,3018,15,"Unable to retrieve valid SelectionCollection"),0;b=b.gb.currentSelection;if(!b)return Tc.b(579216409,3018,15,"CurrentSelection is null"),0;Gd.ParagraphReader.fn(b.Qa)&&(b=ze.a.uk(b,!0,!1));b=b.Qa;if(!b||!ze.a.nw(b))return Tc.b(579216410,3018,15,"Received invalid nodeContext, null={0}",!b),0;var h=Wa.FormattingReader.Rs(b);(h=Wa.FormattingReader.bBa(h))||(h=this.Wb.Aq(b.node));if(!h)return 0;b=this.Wb.xL(h);b=Array.indexOf(this.wJ,b);0>b&&(b=0);
return b}tkg(){const b=this.wJ.length;for(let h=0;h<b;h++){const r=document.createElement("OPTION");r.value=h.toString();r.text=this.wJ[h];this.dqa.add(r,null)}}dNf(){var b=si.a.Ip();if(b){if(this.Xg.Ln){var h=(new Bu.WACStyleSet).Rka(b);b=h.Jw}else{var r=(new Bu.WACStyleSet).Oaa(b);b=r.Jw}var A=this.Bd.isFeatureEnabled(104)&&!!this.Wb.Zg;this.wJ=[];for(let M=0;M<b;M++){let aa;aa=r instanceof Bu.WACStyleSet?r.XAa(M):h.gla(M);if(this.Wb.isHidden(aa))continue;const oa=this.Wb.BF(aa);if(!A){if(3===oa)continue}else if(3===
oa&&this.Wb.ze(aa)===bu.a.IVb)continue;Array.add(this.wJ,this.Wb.xL(aa))}this.wJ.sort(wy.avl)}else Tc.b(577644352,3018,15,"Couldn't find PageContentNode")}dispose(){this.WLc&&mf.a.removeHandler(this.O1,"propertychange",this.WLc);this.uHd&&mf.a.removeHandler(this.O1,"keydown",this.uHd);this.vHd&&mf.a.removeHandler(this.dqa,"change",this.vHd);this.SLc&&mf.a.removeHandler(this.O1,"keypress",this.SLc);this.zgb&&y.AFrameworkApplication.oc.uf(this.zgb);this.zgb=this.SLc=this.dqa=this.O1=this.uHd=this.WLc=
this.vHd=null;super.dispose()}aUh(){var b=this.O1.value,h=this.R1m(b);const r=-1===h?b:this.wJ[h];b=b.length;const A=r.length;this.VPc=r;this.O1.value=r;this.dqa.selectedIndex=h;A>b&&(Y.a.fM?this.O1.setSelectionRange(b,A):Y.a.x7&&(h=this.O1.createTextRange(),h.collapse(!0),h.moveStart("character",b),h.moveEnd("character",A-b),h.select()));this.validate();this.O1.focus()}R1m(b){let h=0,r=this.wJ.length,A=-1;for(b=I.a.vh(b);h<r;){const M=Math.floor((h+r)/2),aa=wy.Bpf(b,this.wJ[M]);if(!aa){A=M;break}0<
aa?h=M+1:r=M}if(A>h)for(;!wy.Bpf(b,this.wJ[A-1])&&(A--,A!==h););return A}validate(){const b=-1===this.iGi(this.O1.value),h=document.getElementById("badStyleError");b?(h.style.display="inline-block",h.innerText=WordEditorIntl.WordEditorStrings.l_BadStyleName):(h.style.display="none",h.innerText="");return!b}iGi(b){b=I.a.vh(b);const h=this.wJ.length;for(let r=0;r<h;r++)if(b===I.a.vh(this.wJ[r]))return r;return-1}static Bpf(b,h){const r=Math.min(b.length,h.length);b=I.a.vh(b);h=I.a.vh(h);for(let A=0;A<
r;A++){const M=I.a.charCodeAt(b,A),aa=I.a.charCodeAt(h,A);if(M!==aa)return M-aa}return b.length<=h.length?0:1}static avl(b,h){return wy.Bpf(b,h)}}Object(u.a)(wy,"ApplyStylesDialog",ig.a,[]);var Bx=d(225);class eI extends ni.StandardDialog{constructor(b){super();this.Ux=b;this.s3o()}s3o(){this.Fd=1;this.gY(1);this.Qe(1,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogOKText);this.Ex(Box4Intl.Box4Strings.l_DeleteSavedStylesDialogTitleText,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogMessageText,1,this.zvf.bind(this))}zvf(b){1===
b&&this.Ux.rva("saveWordUserPreferenceSaveStyleSetting","{}").continueWith(h=>{h.fj?Tc.b(524834400,3018,10,"DeleteSavedSytles: Task Faulted.Exception:{0} Stack:{1}",h.vk,h.vk.stack):(this.kDo(),Tc.b(524834399,3018,50,"User deleted saved styles via UI."))},8)}kDo(){Bx.a.mAb="{}"}}Object(u.a)(eI,"DeleteSavedStylesConfirmationDialog",ni.StandardDialog,[]);class BD extends ni.StandardDialog{constructor(b,h){super();this.zvf=M=>{if(1===M){M=new Map;M.set("Source","DeleteStyleConfirmationDialog");M.set("Action",
"DeleteStyle");Ba.Health.instance.recordKpiUsage(Kr.a.TEa,0,Kr.a.NB,M);var aa=si.a.Ip();M=new Rb.GraphTransaction(15);M.Bb(aa);M.Ii=ub.a.WMb;this.pM.Nci(this.hFh)?Tc.b(578359694,3018,50,"User deleted a style via UI."):(aa=new Map,aa.set("Source","DeleteStyleConfirmationDialog"),aa.set("Action","DeleteStyle"),aa=Object.assign(new bb.a,{extendedProperties:aa}),Ba.Health.instance.recordKpiFailure(Kr.a.TEa,"DeleteStyleFailed",!1,!0,aa),Tc.b(578359695,3018,50,"User tried to delete a style via UI, but we were unable to delete it."));
M.dispose()}};h||Tc.b(590128417,3018,10,"styleId is null");let r=null,A=null;if(this.yh=b.view)A=this.yh.mb;A&&(r=A.gb.currentSelection.Qa);r?(b=r.node)?(this.JM=Object(vo.a)().Iu(b))?(this.hFh=new ib.a,this.hFh.add(h),this.t3o(h)):Tc.b(590128448,3018,10,"_pageContenNode is null."):Tc.b(590128419,3018,10,"node is null."):Tc.b(590128418,3018,10,"nodeContext is null.")}get pM(){return null!=this.I5g?this.I5g:this.I5g=Za.a.instance.resolve(392)}get Wb(){return null!=this.$5g?this.$5g:this.$5g=Za.a.instance.resolve(8)}t3o(b){const h=
(new Bu.WACStyleSet).Oaa(this.JM);h?((b=h.lh(b))||Tc.b(590128450,3018,10,"Style set doesn't contain style with given ID"),b=this.Wb.xL(b),this.Fd=4,this.gY(2),this.Ex(CommonUIStrings.l_DefaultDialogTitle,String.format(WordEditorIntl.WordEditorStrings.l_DeleteStyleConfirmationDialogMessage,b),0,this.zvf)):Tc.b(590128449,3018,10,"Can't retrieve style set from page content node")}}Object(u.a)(BD,"DeleteStyleConfirmationDialog",ni.StandardDialog,[]);class vF{static get kh(){return ig.a.Ry(vF.Hn)}}vF.Hn=
"<div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div>";Object(u.a)(vF,"DeleteStyleDialogHtml",null,[]);class pz extends ig.a{constructor(b){super();this.JM=this.wJ=null;this.zOl=(h,r)=>{this.yh.mw&&(h?(h=r.styleList,-1!==h&&(h=this.wJ[h],r=this.Wb.qo(),si.a.Xg.Ln?(r=r.gv(),h=this.Wb.ze(r.YAa(h))):h=this.Wb.ze(r.wKa(h)),this.oYc.yOl(this._context,h),this.yh.L8())):this.yh.L8())};this._context=b;this.Ng="DeleteStyleDialog";this.Fd=1;this.Qe(1,
WordEditorIntl.WordEditorStrings.l_DeleteStyleDialogButton);this.yh=this._context.view;this.dNf();this.kh=vF.kh;this.mi(WordEditorIntl.WordEditorStrings.l_DeleteStyle,this.zOl,{["styleList"]:0});this.dqa=document.getElementById("styleList");this.tkg();this.dqa.selectedIndex=0;this.dqa.focus()}get Wb(){return null!=this.U5g?this.U5g:this.U5g=Za.a.instance.resolve(8)}get oYc(){return null!=this.WTg?this.WTg:this.WTg=Za.a.instance.resolve(1061)}tkg(){const b=this.wJ.length;for(let h=0;h<b;h++){const r=
document.createElement("OPTION");r.value=h.toString();r.text=this.wJ[h];this.dqa.add(r,null)}}dNf(){if(this.JM=si.a.Ip()){var b=(new Bu.WACStyleSet).Oaa(this.JM),h=b.gv();var r=si.a.Xg.Ln?h.Jw:b.Jw;this.wJ=[];for(let M=0;M<r;M++){let aa;aa=si.a.Xg.Ln?h.gla(M):b.XAa(M);if(!this.Wb.isHidden(aa)&&this.Wb.me(aa,b)){var A=this.Wb.BF(aa);if(2===A||1===A)aa.hasProperty(Mc.a.linkedStyle)&&2!==A||(A=aa.ka(Mc.a.ZD,null))&&0<A.length||this.wJ.push(this.Wb.xL(aa))}}this.wJ.sort()}else Tc.b(578650370,3018,15,
"PageContentNode is null")}}Object(u.a)(pz,"DeleteStyleDialog",ig.a,[]);var It=d(772);class lu{constructor(b){this.Yl=null;this.jR=b}}Object(u.a)(lu,"PropertySetChangedState",null,[]);class Cx{static Ado(b,h,r){if(b&&h){var A=new lu(h),M=(aa,oa,Ja)=>{r.zdo(aa,oa,Ja,A)};b=new It.a(h,b);b.WQd=M;b.rUd=M;b.rte=M;b.Ccb()}}}Object(u.a)(Cx,"PropertySetChangedManager",null,[]);class qz{constructor(b){this.nSa=b}zdo(b,h,r,A){const M=this.nSa[b.id.toString()];M&&M(b,h,r,A)}}Object(u.a)(qz,"PropertyChangedProcessor",
null,[]);const Dx=(b,h,r)=>{const A=mt.a.instance.nOb;if(A){const M=new Rb.GraphTransaction(15);M.Bb(A);Cx.Ado(b,h,new qz(r));M.dispose()}};class Jw{static get kh(){return ig.a.Ry(Jw.Hn,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTop,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeft,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottom,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRight)}}Jw.Hn="<div class='WACDialogRow' id='RowMargins'> <div class='WACDialogGroupBox' id='MarginsDialogTopLeftBox'> <div class='WacDialogLabels' id='MarginsDialogTopLeftLabels'> <label id='MarginsDialogMarginTop' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='MarginsDialogMarginLeft' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogTopLeftSpinners'> <div id='MarginsDialogMarginTopSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginLeftSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> <div class='WACDialogGroupBox MarginsDialogRightChunk' id='MarginsDialogBottomRightBox'> <div class='WacDialogLabels' id='MarginsDialogBottomRightLabels'> <label id='MarginsDialogMarginBottom' class='DialogSpinnerLabel' >{2}</label> <br/> <label id='MarginsDialogMarginRight' class='DialogSpinnerLabel' >{3}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogBottomRightSpinners'> <div id='MarginsDialogMarginBottomSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginRightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> </div>";
Object(u.a)(Jw,"MarginsDialogHtml",null,[]);class yp{static get b8(){return null!=yp.V0g?yp.V0g:yp.V0g=Za.a.instance.Oa(1062)}static AFn(b,h,r){yp.b8&&null!==r&&yp.b8.Uwe(0,r)}static wFn(b,h,r){yp.b8&&null!==r&&yp.b8.Uwe(3,r)}static yFn(b,h,r){yp.b8&&null!==r&&yp.b8.Uwe(1,r)}static zFn(b,h,r){yp.b8&&null!==r&&yp.b8.Uwe(2,r)}static g5n(b,h,r){yp.b8&&null!==r&&yp.b8.j_a(0,r)}static I4n(b,h,r){yp.b8&&null!==r&&yp.b8.j_a(1,r)}static Usl(b,h,r){yp.b8&&null!==r&&(b==De.a.HG?yp.b8.fwe(0,r):b==De.a.RH?yp.b8.fwe(1,
r):b==De.a.hra?yp.b8.fwe(2,r):b==De.a.separator&&yp.b8.fwe(3,r))}}Object(u.a)(yp,"PageLevelPropertyChangedHandlers",null,[]);const Sw=[Fc.a.nfd,Fc.a.mfd,Fc.a.Jne,Fc.a.Kne,Fc.a.Pqe,Fc.a.Mqe,Fc.a.Nqe,Fc.a.Oqe];class Ao extends ig.a{constructor(b,h,r,A,M){super();this.b1c=(aa,oa)=>{var Ja=Ao.vhd(aa);aa=df.a.tba;this.uq.hasProperty(Ja)?(Ja=this.uq.getValue(Ja),oa[ui.a.Number]=Jg.a.lPa(Ja,aa)):oa[ui.a.Number]=0;oa[ui.a.UnitType]=aa};this.Fmd=(aa,oa)=>{this.uq.setValue(Ao.vhd(aa),Jg.a.ROa(oa[ui.a.Number],
oa[ui.a.UnitType]));this.yv.rn()};this.CFn=aa=>{let oa=!1;1===aa&&(Math.abs(this.uq.getValue(Mc.a.marginTop))+Math.abs(this.uq.getValue(Mc.a.marginBottom))+df.a.SEa<=this.yya.getValue(Mc.a.rw)&&this.uq.getValue(Mc.a.marginLeft)+this.uq.getValue(Mc.a.marginRight)+df.a.SEa<=this.yya.getValue(Mc.a.np)?Dx(this.gGa,this.uq,Ao.ikc()):oa=!0);this.dispose();oa&&this.NNa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage,this.xFn)};this.xFn=()=>{Za.a.instance.resolve(1061).q9h(this.gGa,this.yya,this.X9)};this.Ng=
"MarginsDialog";this.yya=h.clone();this.gGa=b.clone();this.uq=b.clone();this.X9=r;this.RY=!1;this.yv=M;this.kh=Jw.kh;r&&(this.XEc=St.a.z1b);this.mi(WordEditorIntl.WordEditorStrings.L_PageMargins,this.CFn,null);this.T6c();this.O8e=document.getElementById("DialogMarginTopSpinner");this.c4(this.O8e)}Cba(){this.iTd("MarginsDialogMarginTopSpinnerContainer","DialogMarginTopSpinner",Fc.a.nfd,Fc.a.Pqe,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTopAlt);this.iTd("MarginsDialogMarginBottomSpinnerContainer",
"DialogMarginBottomSpinner",Fc.a.mfd,Fc.a.Mqe,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottomAlt);this.iTd("MarginsDialogMarginLeftSpinnerContainer","DialogMarginLeftSpinner",Fc.a.Jne,Fc.a.Nqe,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeftAlt);this.iTd("MarginsDialogMarginRightSpinnerContainer","DialogMarginRightSpinner",Fc.a.Kne,Fc.a.Oqe,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRightAlt)}T6c(){for(const b of Sw)Object(jm.a)(b,this.Fmd,this.b1c);this.yv.Dua("DialogMarginTopSpinner");
this.yv.Dua("DialogMarginBottomSpinner");this.yv.Dua("DialogMarginLeftSpinner");this.yv.Dua("DialogMarginRightSpinner")}dispose(){for(const b of Sw)Object(jm.b)(b);this.yv.B0("DialogMarginTopSpinner");this.yv.B0("DialogMarginBottomSpinner");this.yv.B0("DialogMarginLeftSpinner");this.yv.B0("DialogMarginRightSpinner");super.dispose()}iTd(b,h,r,A,M){r=Ao.iel(h,r,A,M);this.iKb(r,b,h)}iKb(b,h,r){h=document.getElementById(h);this.yv.w5a(r,b);b=this.yv.hPb(r,"Medium");h.appendChild(b)}static ikc(){return Ao.nSa||
(Ao.nSa=Ao.qfc())}static qfc(){const b={};b[Mc.a.marginTop.id.toString()]=yp.AFn;b[Mc.a.marginBottom.id.toString()]=yp.wFn;b[Mc.a.marginLeft.id.toString()]=yp.yFn;b[Mc.a.marginRight.id.toString()]=yp.zFn;return b}static iel(b,h,r,A){let M=!0;if(h===Fc.a.nfd||h===Fc.a.mfd)M=!1;return Aj.j(b,h,r,A,[Ao.kel(M),Ao.jel(M)])}static kel(b){return Aj.l("inch",b?"0":"-22","22",".1")}static jel(b){return Aj.l("centimeter",b?"0":"-55.8","55.8","1")}static vhd(b){let h=null;switch(b){case Fc.a.nfd:case Fc.a.Pqe:h=
Mc.a.marginTop;break;case Fc.a.mfd:case Fc.a.Mqe:h=Mc.a.marginBottom;break;case Fc.a.Jne:case Fc.a.Nqe:h=Mc.a.marginLeft;break;case Fc.a.Kne:case Fc.a.Oqe:h=Mc.a.marginRight}return h}}Ao.nSa=null;Object(u.a)(Ao,"MarginsDialog",ig.a,[]);class qk{static get kh(){return ig.a.Ry(qk.Hn,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidth,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeight)}}qk.Hn="<div class='WACDialogRow' id='RowPapeSize'> <div class='WacDialogLabels' id='PaperSizeDialogLabels'> <label id='PaperSizeDialogWidth' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='PaperSizeDialogHeight' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='PaperSizeDialogSpinners'> <div id='PaperSizeDialogWidthSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='PaperSizeDialogHeightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(u.a)(qk,"PaperSizeDialogHtml",null,[]);const lC=[Fc.a.Nne,Fc.a.Mne,Fc.a.dre,Fc.a.cre];class Lq extends ig.a{constructor(b,h,r,A,M){super();this.b1c=(aa,oa)=>{var Ja=this.vhd(aa);aa=df.a.tba;this.uq.hasProperty(Ja)?(Ja=this.uq.getValue(Ja),oa[ui.a.Number]=Jg.a.lPa(Ja,aa)):oa[ui.a.Number]=0;oa[ui.a.UnitType]=aa};this.Fmd=(aa,oa)=>{this.uq.setValue(this.vhd(aa),Jg.a.ROa(oa[ui.a.Number],oa[ui.a.UnitType]));this.yv.rn()};this.t5n=aa=>{let oa=!1;1===aa&&(this.uq.getValue(Mc.a.rw)>=df.a.SEa+this.yya.getValue(Mc.a.marginTop)+
this.yya.getValue(Mc.a.marginBottom)&&this.uq.getValue(Mc.a.np)>=df.a.SEa+this.yya.getValue(Mc.a.marginLeft)+this.yya.getValue(Mc.a.marginRight)?Dx(this.gGa,this.uq,Lq.ikc()):oa=!0);this.dispose();oa&&this.NNa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage,this.s5n)};this.s5n=()=>{Za.a.instance.resolve(1061).S9h(this.gGa,this.yya,this.X9)};this.Ng="PaperSizeDialog";this.yya=h.clone();this.gGa=b.clone();this.uq=b.clone();this.X9=r;this.RY=!1;this.yv=M;this.kh=qk.kh;r&&(this.XEc=St.a.z1b);this.mi(WordEditorIntl.WordEditorStrings.l_PaperSizeDialogTitle,
this.t5n,null);this.T6c();this.O8e=document.getElementById("DialogWidthSpinner");this.c4(this.O8e)}Cba(){this.zWh("PaperSizeDialogWidthSpinnerContainer","DialogWidthSpinner",Fc.a.Nne,Fc.a.dre,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidthAlt);this.zWh("PaperSizeDialogHeightSpinnerContainer","DialogHeightSpinner",Fc.a.Mne,Fc.a.cre,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeightAlt)}T6c(){for(const b of lC)Object(jm.a)(b,this.Fmd,this.b1c);this.yv.Dua("DialogWidthSpinner");this.yv.Dua("DialogHeightSpinner")}dispose(){for(const b of lC)Object(jm.b)(b);
this.yv.B0("DialogWidthSpinner");this.yv.B0("DialogHeightSpinner");super.dispose()}zWh(b,h,r,A,M){r=Lq.Ael(h,r,A,M);this.iKb(r,b,h)}iKb(b,h,r){h=document.getElementById(h);this.yv.w5a(r,b);b=this.yv.hPb(r,"Medium");h.appendChild(b)}vhd(b){let h=null;switch(b){case Fc.a.Mne:case Fc.a.cre:h=Mc.a.rw;break;case Fc.a.Nne:case Fc.a.dre:h=Mc.a.np}return h}static ikc(){return Lq.nSa||(Lq.nSa=Lq.qfc())}static qfc(){const b={};b[Mc.a.np.id.toString()]=yp.g5n;b[Mc.a.rw.id.toString()]=yp.I4n;return b}static Ael(b,
h,r,A){return Aj.j(b,h,r,A,[Lq.Cel(),Lq.Bel()])}static Cel(){return Aj.l("inch",Lq.xUj,Lq.Ctn,Lq.y7o)}static Bel(){return Aj.l("centimeter",Lq.xUj,Lq.Btn,Lq.x7o)}}Lq.xUj="0";Lq.Ctn="22";Lq.y7o=".1";Lq.x7o="1";Lq.Btn="55.8";Lq.nSa=null;Object(u.a)(Lq,"PaperSizeDialog",ig.a,[]);const ZF=RegExp("[{|}|;|\\\\]"),WD=b=>{if(!b)return"";const h=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogDefaultStyle,r=b.Jw;let A;for(A=1;A<=r;A++){const M=h+A;if(!(b.SVa(M)||b.zkc(M)||b.SVa(M+"Char")||b.zkc(M+"Char")))break}return h+
A};class XD extends ig.a{constructor(b,h,r,A,M){var aa,oa,Ja,fb;super(!1,!1,!0);this.context=b;this.Rb=h;this.F2=r;this.Wb=A;this.NYa=M;this.O0d=null;this.Swj=(Cb,Gb)=>{if(this.ne.mw){if(0!==Cb){Cb="string"===typeof Gb.styleText?Gb.styleText:null;Gb=this.Qpd;var Sb=Cb;const pc=I.a.uDa(Sb);let zc=null;if(0===pc.length)zc=WordEditorIntl.WordEditorStrings.l_StyleNameEmpty;else if(253<Sb.length)zc=WordEditorIntl.WordEditorStrings.l_StyleNameOverMaxLength;else if(ZF.test(Sb))zc=WordEditorIntl.WordEditorStrings.l_StyleNameRestrictedCharacters;
else if(Gb.YAa(Sb)||Gb.zkc(pc))zc=WordEditorIntl.WordEditorStrings.l_StyleNameAlreadyExists;(Gb=zc)?(this.O0d=Gb,Gb=WD(this.Qpd),Cb=this.gPb(Cb,Gb),this.O0d=null,this.RY=!1,this.hide(),this.mi(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.Swj,Cb),this.RY=!0):(this.hide(),Gb=new Map,Gb.set("Source","ReactCreateNewStyleDialog"),Gb.set("Action","CreateStyle"),Ba.Health.instance.recordKpiUsage(Kr.a.TEa,0,Kr.a.NB,Gb),this.Ldf(Cb)||(Cb=new Map,Cb.set("Source","ReactCreateNewStyleDialog"),Cb.set("Action",
"CreateStyle"),Cb=Object.assign(new bb.a,{extendedProperties:Cb}),Ba.Health.instance.recordKpiFailure(Kr.a.TEa,"CreateStyleFailed",!1,!0,Cb)))}else this.hide();this.ne.L8()}};this.Ng="CreateNewStyleDialog";this.ne=b.view;(b=null===(fb=null===(Ja=null===(oa=null===(aa=this.ne)||void 0===aa?void 0:aa.mb)||void 0===oa?void 0:oa.gb)||void 0===Ja?void 0:Ja.currentSelection)||void 0===fb?void 0:fb.Qa)?(aa=b.node)?(this.Uh=this.NYa.Iu(aa))?(this.Qpd=(new Bu.WACStyleSet).Rka(this.Uh),(this.DVb=this.F2.J1d(b))?
(aa=this.DVb.ka(He.a.fontSize,22),16>aa?Tc.b(593078050,3018,50,"Font size less than 8pt in create new style dialog preview"):52>=aa?Tc.b(593078049,3018,50,"Font size between 8pt and 26pt in create new style dialog preview"):90>=aa?Tc.b(593078048,3018,50,"Font size between 26pt and 45 pt in create new style dialog preview"):Tc.b(593078047,3018,50,"Font size more than 45pt in create new style dialog preview"),this.Crg(this.DVb),this.Uh&&this.DVb&&(this.nda=!1,aa=WD(this.Qpd),aa=this.gPb(aa,aa),this.mi(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,
this.Swj,aa))):Tc.b(592737758,3018,10,"_newStyleProperties is null.")):Tc.b(592737757,3018,10,"_pageContenNode is null."):Tc.b(592725466,3018,10,"node is null."):Tc.b(556917206,3018,10,"nodeContext is null.")}Crg(b){b.Uf(wb.a.Yw,wb.a.Fw,...Kr.a.Qaa())}gPb(b,h){const r=52<=this.DVb.ka(He.a.fontSize,kl.a.YQ),A=Vh.a.zHf(this.DVb,"97%",26,!1,!0,r);A["padding-left"]="5px";r||(A["line-height"]="40px");b={["styleNameLabel"]:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogName,["previewWindowLabel"]:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogParagraphPreview,
["styleName"]:b,["previewContainerText"]:h,["getPreviewStyle"]:()=>A};this.O0d&&(b.errorMessage=this.O0d);return{["id"]:this.Ng,["bodyControls"]:b}}Ldf(b){const h=new Rb.GraphTransaction(15);h.Bb(this.Uh);h.Ii=ub.a.lMb;const r=si.a.Ldf(b,si.a.KDi(this.DVb),null,this.Uh);r&&(Tc.b(593078046,3018,50,"User created linked style"),this.Qpd=(new Bu.WACStyleSet).Rka(this.Uh),b=I.a.uDa(I.a.N_(b)),b=this.Qpd.zkc(b),this.Rb.Nf(this.context,ub.a.vT,2,!1,new dI.a,this.Wb.ze(b)));h.dispose();return r}}Object(u.a)(XD,
"ReactCreateNewStyleDialog",ig.a,[]);class Ox extends ig.a{constructor(b,h=!1,r){super(!1,!1,h);let A=h=this.CM=null;this.Ng=Ox.id;this.yh=b.view;this.vp=r;this.yh&&(A=this.yh.mb);A&&A.gb&&A.gb.currentSelection&&(h=A.gb.currentSelection.Qa);h?(b=h.node)?(this.JM=Object(vo.a)().Iu(b))||v.ULS.sendTraceTag(539762890,3029,10,"_pageContenNode is null"):v.ULS.sendTraceTag(539762889,3029,10,"node is null"):v.ULS.sendTraceTag(539762888,3029,10,"nodeContext is null")}pAp(b){var h=RegExp("^(?!\\p{N})[\\p{L}\\p{N}\\p{Mc}\\p{Mn}_]{1,40}$",
"gu"),r=this.tem();const A=""===I.a.uDa(b),M=b.length>Ox.PGn;r=r.includes(b);h=h.test(b);b=b.startsWith("_");let aa=null;if(A||M||r||b||!h)aa=A?WordEditorIntl.WordEditorStrings.l_BookmarkNameEmpty:M?WordEditorIntl.WordEditorStrings.l_BookmarkNameOverMaxLength:b?WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters:h?WordEditorIntl.WordEditorStrings.l_BookmarkNameAlreadyExists:WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters;return aa}Obn(b,h){return b?b===h:!1}tem(){const b=
this.vp.U3d(!1),h=[];for(let r=0;r<b.count;r++){const A=b.K(r).ka(Mc.a.wu,"");h.push(A)}return h}}Ox.id="BookmarkEditDialog";Ox.PGn=40;Object(u.a)(Ox,"AEditBookmarkDialog",ig.a,[]);class YD extends Ox{constructor(b,h,r){super(b,!0,r);this.DQe=null;this.k2a="wwaengidc";this.uJc="ReactCreateEditBookmarkNameDialog";this.Xph="EditBookmarkName";this.vxa="EditBookmarkNameDialog";this.xKe=h;this.vp=r;this.JM&&(this.nda=!1,b=this.gPb(h.properties.ka(Mc.a.wu,null)),this.mi(WordEditorIntl.WordEditorStrings.l_EditBookmark,
this.Uwj.bind(this),b))}Uwj(b,h){if(this.yh.mw){if(b){b="string"===typeof h.BookmarkText?h.BookmarkText:null;var r;this.xKe.hasProperty(Mc.a.wu)?r=this.xKe.getValue(Mc.a.wu):v.ULS.sendTraceTag(528880847,3029,10,"Bookmark name not found");h=this.pAp(b);this.Obn(b,r)?(v.ULS.sendTraceTag(528880848,3029,50,"User did not update existing bookmark's name, dismissing edit bookmark dialog"),this.hide()):h?(this.DQe=h,r=this.gPb(b),this.DQe=null,this.RY=!1,this.hide(),this.mi(WordEditorIntl.WordEditorStrings.l_EditBookmark,
this.Uwj.bind(this),r),this.RY=!0):(this.hide(),r=new Map,r.set("Source",this.uJc),r.set("Action",this.Xph),Ba.Health.instance.recordKpiUsage(this.vxa,0,this.k2a,r),this.dll(b)||(r=new Map,r.set("Source",this.uJc),r.set("Action",this.Xph),r=Object.assign(new bb.a,{extendedProperties:r}),Ba.Health.instance.recordKpiFailure(this.vxa,"Unable to edit bookmark",!1,!0,r)))}else this.hide();this.yh.L8()}}dll(b){b=I.a.uDa(I.a.N_(b));try{const h=this.vp.irp(this.xKe,b);if(h)v.ULS.sendTraceTag(539762886,3029,
50,"Updated bookmark name to name specified by user");else return v.ULS.sendTraceTag(525111646,3029,10,"Error updating bookmark name to name specified by user"),h}catch(h){return v.ULS.sendTraceTag(539762887,3029,10,"Error updating bookmark name to name specified by user",h.Message),!1}}gPb(b){const h={};h.bookmarkValue=b;h.errorMessage=this.DQe;h.bookmarkTextLabel=WordEditorIntl.WordEditorStrings.l_EditBookmarkDialogLabelName;return{["id"]:this.Ng,["bodyControls"]:h}}}Object(u.a)(YD,"ReactEditBookmarkNameDialog",
Ox,[]);class Vr extends ig.a{constructor(b,h,r,A){super(!1,!1,!0);this.Rsl=()=>{this.oYc.a8h(this.UPi,this.bFe,this.x$c)};this.Ssl=(M,aa)=>{aa&&1===M&&(aa.columnsCountSpinButtonProps&&this.i0.setValue(De.a.HG,aa.columnsCountSpinButtonProps.value),aa.columnsWidthSpinButtonProps&&(M=aa.columnsWidthSpinButtonProps,this.i0.setValue(De.a.RH,[Jg.a.ROa(M.value,Jg.a.gUa(M.unitType.toLowerCase()))])),aa.columnsSpacingSpinButtonProps&&(M=aa.columnsSpacingSpinButtonProps,this.i0.setValue(De.a.hra,Jg.a.ROa(M.value,
Jg.a.gUa(M.unitType.toLowerCase())))),aa.columnsLineBetweenCheckboxProps&&this.i0.setValue(De.a.separator,aa.columnsLineBetweenCheckboxProps.checked),this.Vsl()&&(aa=Vr.MSd,this.S7k()?Dx(this.UPi,this.i0,this.ikc):aa=aa!==Vr.MSd?aa:Box4Intl.Box4Strings.l_ColumnsDialogFailMessage,this.dispose(),aa!==Vr.MSd&&this.NNa(aa,this.Rsl)))};this.Vsl=()=>this.i0.hasProperty(De.a.HG)&&this.i0.hasProperty(De.a.RH)&&this.i0.hasProperty(De.a.hra)&&this.i0.hasProperty(De.a.separator);this.k4d=(M,aa,oa)=>Math.floor((M-
(aa-1)*oa)/aa);this.tGf=(M,aa,oa)=>1==aa?0:Math.floor((M-aa*oa)/(aa-1));this.v1k=(M,aa,oa,Ja)=>{const fb=M/aa;oa<Vr.Cxc?(oa=Vr.Cxc,Ja=this.tGf(M,aa,oa)):oa>fb&&(oa=fb,Ja=this.tGf(M,aa,oa));return[oa,Ja]};this.r1k=(M,aa,oa,Ja)=>{const fb=(M-Vr.Cxc*aa)/(aa-1);0>Ja?(Ja=0,oa=this.k4d(M,aa,Ja)):Ja>fb&&(Ja=fb,oa=this.k4d(M,aa,Ja));return[oa,Ja]};this.ROa=(M,aa)=>Jg.a.ROa(M,Jg.a.gUa(aa));this.mXc=(M,aa,oa,Ja,fb)=>({["unitType"]:M,["unitPlaceholder"]:I.a.lpe(aa),["minValue"]:oa,["maxValue"]:Ja,["step"]:fb});
this.UPi=b.clone();this.i0=b.clone();this.bFe=h.clone();this.Ovb=this.bFe.getValue(Mc.a.np)-this.bFe.getValue(Mc.a.marginLeft)-this.bFe.getValue(Mc.a.marginRight);this.aVb=Math.floor(this.Ovb/Vr.Cxc);this.x$c=r;this.oYc=A;this.Ng=Vr.id;b={};b.getUnitValue=3==df.a.tba?Jg.a.iB:Jg.a.j0a;b.getCalculatedWidthValue=this.k4d;b.getCalculatedSpacingValue=this.tGf;b.twipsFromValueAndUnits=this.ROa;b.adjustWidthForLimits=this.v1k;b.adjustSpacingForLimits=this.r1k;b.pageContentWidth=this.Ovb;b.maxColumnCount=
this.aVb;b.columnsLabelProps={["type"]:"AppLabelProps",["id"]:"ColumnsSection",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogTitle,["forId"]:"ColumnsGroup"};b.columnsCountSpinButtonProps=this.xjm();b.columnsWidthSpinButtonProps=this.Bjm();b.columnsSpacingSpinButtonProps=this.zjm();b.columnsLineBetweenCheckboxProps=this.yjm();b={["id"]:"ColumnsDialog",["bodyControls"]:b};this.mi(Box4Intl.Box4Strings.l_ColumnsDialogTitle,this.Ssl.bind(this),b)}xjm(){var b=[this.mXc("None",0,1,this.aVb,1)];const h=this.UMf(De.a.HG);
b={["type"]:"AppSpinButtonProps",["id"]:"columnsCountSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogCount,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogCountAlt,["unitType"]:Jg.a.R6a(0),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.O_b(h,b)}Bjm(){var b=[this.mXc("Inch",3,.5,Jg.a.iB(this.Ovb),.1),this.mXc("Centimeter",
1,1.27,Jg.a.j0a(this.Ovb),1)];const h=df.a.tba,r=this.UMf(De.a.RH);b={["type"]:"AppSpinButtonProps",["id"]:"columnsWidthSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogWidth,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogWidthAlt,["unitType"]:Jg.a.R6a(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.O_b(r,b)}zjm(){var b=
[this.mXc("Inch",3,0,Jg.a.iB(this.Ovb-2*Vr.Cxc),.1),this.mXc("Centimeter",1,0,Jg.a.j0a(this.Ovb-2*Vr.Cxc),1)];const h=df.a.tba,r=this.UMf(De.a.hra);b={["type"]:"AppSpinButtonProps",["id"]:"columnsSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacingAlt,["unitType"]:Jg.a.R6a(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,
["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.O_b(r,b)}yjm(){const b=this.i0.getValue(De.a.separator);return{["type"]:"AppCheckboxInternalProps",["id"]:"columnsLineBetweenCheckbox",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetween,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetweenAlt,["checked"]:b}}get ikc(){return null!=this.IWg?this.IWg:this.IWg=(()=>this.xtf())()}xtf(){const b={};b[De.a.HG.id.toString()]=b[De.a.RH.id.toString()]=b[De.a.hra.id.toString()]=
b[De.a.separator.id.toString()]=yp.Usl;return b}S7k(){const b=this.i0.getValue(De.a.RH),h=this.i0.getValue(De.a.HG),r=this.i0.getValue(De.a.hra);let A=0;for(let M=0;M<h;M++)A+=b[0];if(h<=this.aVb&&(h-1)*r+A<=this.Ovb)return!0;v.ULS.sendTraceTag(509723422,336,15,"Invalid inputs for Columns Dialog - does not fit in page content space.  Count: {0}, Width: {1}, Spacing: {2}",h,b[0],r);return!1}UMf(b){if(this.i0.hasProperty(b)){if(b==De.a.HG)return this.i0.getValue(b);if(b==De.a.RH){var h=df.a.tba;b=this.i0.getValue(De.a.hra);
const r=this.i0.getValue(De.a.HG);return Jg.a.lPa(this.k4d(this.Ovb,r,b),h)}if(b==De.a.hra){if(1==this.i0.getValue(De.a.HG))return 0;h=df.a.tba;b=this.i0.getValue(b);return Jg.a.lPa(b,h)}}return 0}O_b(b,h){h.value=isNaN(b)?Vr.MSd:b;return h}}Vr.id="ColumnsDialog";Vr.MSd="";Vr.Cxc=720;Object(u.a)(Vr,"WordReactColumnsDialog",ig.a,[]);var mC=d(480);const xz=(b,h,r)=>{const A=[];if(b.length!==h.length||r&&r.length!==h.length)return A;for(let M=0;M<b.length;M++){const aa={};aa.key=h[M];aa.text=b[M];aa.type=
"AppComboBoxItem";r&&(aa.ariaLabel=r[M]);A[M]=aa}return A},Tw=(b,h,r,A,M)=>({["unitType"]:b,["unitPlaceholder"]:I.a.lpe(h),["minValue"]:r,["maxValue"]:A,["step"]:M}),nC=()=>({["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}),Px=(b,h,r)=>{let A=!1;b.hasProperty(h)&&b.hasProperty(r)?(r=b.getValue(r),1===r?(b=Number.NaN,h=5,A=!0):(b=b.getValue(h),h=2===r?4:5)):(b=Number.NaN,h=df.a.rLa?4:5);
return{Dxc:b,jfb:h,Qmc:A}};class Bo{constructor(){this.TUj=this.Epj=this.Cpj=this.x5n=this.cig=!1}}Object(u.a)(Bo,"Box4PropertySetChangedState",null,[]);class xl{static get fmc(){return null!=xl.rXg?xl.rXg:xl.rXg=Za.a.instance.Oa(1063)}static get o3i(){return null!=xl.k_g?xl.k_g:xl.k_g=Za.a.instance.Oa(1064)}static get D8(){return null!=xl.U2g?xl.U2g:xl.U2g=Za.a.instance.Oa(825)}static xsn(b,h,r){xl.o3i&&r&&(null===h||11!==r||10!==h&&9!==h)&&xl.o3i.rH(r)}static $vn(b,h,r){xl.D8&&r&&xl.D8.GE(r)}static hyl(b,
h,r){h!=r&&xl.D8.mwc(r)}static Ksn(b,h,r){h!=r&&xl.D8.Ymd(r)}static bDp(b,h,r){h!=r&&xl.D8.Rnd(r)}static Isn(b,h,r){h!=r&&xl.D8.Xmd(r)}static Jpj(b,h,r,A){xl.D8&&void 0!==r&&null!==r&&(b=xl.t1c(A),!b.cig&&A.jR.hasProperty(pd.a.Qsc)&&A.jR.hasProperty(pd.a.Rsc)&&(h=A.jR.getValue(pd.a.Rsc),A=A.jR.getValue(pd.a.Qsc),b.cig=!0,xl.D8.eha(1,h,A)))}static Ipj(b,h,r,A){xl.D8&&void 0!==r&&null!==r&&(b=xl.t1c(A),!b.x5n&&A.jR.hasProperty(pd.a.Osc)&&A.jR.hasProperty(pd.a.Psc)&&(h=A.jR.getValue(pd.a.Psc),A=A.jR.getValue(pd.a.Osc),
b.cig=!0,xl.D8.eha(0,h,A)))}static Bpj(b,h,r,A){xl.fmc&&void 0!==r&&null!==r&&(b=xl.t1c(A),!b.Cpj&&A.jR.hasProperty(pd.a.JMa)&&A.jR.hasProperty(pd.a.KMa)&&(h=A.jR.getValue(pd.a.KMa),A=A.jR.getValue(pd.a.JMa),b.Cpj=!0,xl.fmc.sNj(1,h,A)))}static Dpj(b,h,r,A){xl.fmc&&void 0!==r&&null!==r&&(b=xl.t1c(A),!b.Epj&&A.jR.hasProperty(pd.a.Svb)&&A.jR.hasProperty(pd.a.Tvb)&&(h=A.jR.getValue(pd.a.Tvb),A=A.jR.getValue(pd.a.Svb),b.Epj=!0,xl.fmc.sNj(0,h,A)))}static CDg(b,h,r,A){xl.fmc&&void 0!==r&&null!==r&&(b=xl.t1c(A),
!b.TUj&&A.jR.hasProperty(pd.a.D_a)&&A.jR.hasProperty(pd.a.E_a)&&(h=0,A.jR.hasProperty(pd.a.E8)&&(h=A.jR.getValue(pd.a.E8)),r=A.jR.getValue(pd.a.E_a),A=A.jR.getValue(pd.a.D_a),b.TUj=!0,xl.fmc.qxe(h,r,A)))}static t1c(b){b.Yl||(b.Yl=new Bo);return b.Yl}}Object(u.a)(xl,"ParagraphLevelPropertyChangedHandlers",null,[]);class Uw{constructor(){this.nSa=null}IBm(b){const h={};h.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"};
var r=Tw("Point",5,0,1584,1),A=Tw("Line",4,0,327,1),M=[r,A];A=nC();var aa=[Box4Intl.Box4Strings.L_SpinnerAuto];r=[""];({Dxc:Ja,jfb:oa,Qmc:fb}=Px(b,pd.a.Rsc,pd.a.Qsc));var oa={["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,["unitType"]:Jg.a.R6a(oa),["validUnits"]:M,["numberFormatInfo"]:A,["validReservedValues"]:aa};fb?oa.reservedValue=aa[0]:oa.value=
isNaN(Ja)?"":Ja;h.beforeSpacingSpinButtonProps=oa;({Dxc:Ja,jfb:oa,Qmc:fb}=Px(b,pd.a.Psc,pd.a.Osc));M={["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:Jg.a.R6a(oa),["validUnits"]:M,["numberFormatInfo"]:A,["validReservedValues"]:aa};fb?M.reservedValue=aa[0]:M.value=isNaN(Ja)?"":Ja;h.afterSpacingSpinButtonProps=M;if(aa=M=b.hasProperty(pd.a.xa))aa=
Uw.Qab.KPb(b),aa=b.hasProperty(pd.a.xa)&&b.hasProperty(pd.a.Rab)&&2===b.getValue(pd.a.Rab)?!$f.a.LBa(aa,1)&&!$f.a.LBa(aa,1.5)&&!$f.a.LBa(aa,2):!1;if(M){var Ja=Uw.Qab.KPb(b);M=0;var fb=!1;b.hasProperty(pd.a.xa)&&b.hasProperty(pd.a.Rab)||(fb=!0);fb||(2!==b.getValue(pd.a.Rab)&&(fb=!0),M=Ja,1>M&&(fb=!0));fb?M="":(Ja="multiple",aa||($f.a.LBa(M,1)?Ja="1.00":$f.a.LBa(M,1.5)?Ja="1.50":$f.a.LBa(M,2)&&(Ja="2.00")),M=Ja)}else M=null;Ja={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,["options"]:xz([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50","2.00","multiple"]),["allowFreeForm"]:!1};M?Ja.selectedKey=M:Ja.defaultSelectedKey="";h.lineSpacingComboBoxProps=Ja;M=0;Ja=!1;b.hasProperty(pd.a.xa)&&b.hasProperty(pd.a.Rab)&&
2===b.getValue(pd.a.Rab)&&aa&&(M=Uw.Qab.KPb(b),Ja=!0,1>M&&(M=Number.NaN));b=[Tw("none",0,1,132,.5)];b={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",["validUnits"]:b,["numberFormatInfo"]:A,["validReservedValues"]:r};Ja?b.value=M:b.reservedValue=r[0];h.atSpinButtonProps=b;return h}ikc(){return this.nSa||(this.nSa=this.qfc())}qfc(){const b=
{};b[pd.a.xa.id.toString()]=xl.$vn;b[pd.a.Psc.id.toString()]=xl.Ipj;b[pd.a.Osc.id.toString()]=xl.Ipj;b[pd.a.Rsc.id.toString()]=xl.Jpj;b[pd.a.Qsc.id.toString()]=xl.Jpj;return b}static get Qab(){return null!=Uw.u_g?Uw.u_g:Uw.u_g=Za.a.instance.resolve(384)}}Object(u.a)(Uw,"ReactParagraphDialog",null,[]);const ZD=b=>1===b||2===b||3===b||6===b||10===b||11===b||9===b||7===b||13===b,Kq=(b,h,r,A)=>{let M=df.a.tba;b.hasProperty(h)&&b.hasProperty(r)&&!A?(h=b.getValue(h),b=b.getValue(r),h?2===b?M=2:h=Jg.a.lPa(h,
M):df.a.rLa&&(M=2)):(h=Number.NaN,df.a.rLa&&(M=2));return{Dxc:h,jfb:M}},rz=b=>{let h="0";b.hasProperty(pd.a.E8)&&(b=b.getValue(pd.a.E8),(1===b||2===b||!b)&&(1===b?h="1":2===b?h="2":b||(h="0")));return h},Mp=(b,h)=>{if(h.hasProperty(pd.a.E8)&&2===h.getValue(pd.a.E8)&&h.hasProperty(pd.a.E_a)&&h.hasProperty(pd.a.D_a)&&b.hasProperty(pd.a.KMa)&&b.hasProperty(pd.a.JMa)){var r=b.getValue(pd.a.KMa),A=b.getValue(pd.a.JMa);r=(new et.a(A,r)).Ou;A=h.getValue(pd.a.E_a);h=h.getValue(pd.a.D_a);h=(new et.a(h,A)).Ou;
b.setValue(pd.a.KMa,r+h);b.setValue(pd.a.JMa,1)}},wF=b=>{const h=b.getValue(pd.a.KMa);b=b.getValue(pd.a.JMa);return(new et.a(b,h)).Ou},fI=b=>{const h=b.getValue(pd.a.Tvb);b=b.getValue(pd.a.Svb);return(new et.a(b,h)).Ou},pk=(b,h)=>h.hasProperty(pd.a.KMa)&&h.hasProperty(pd.a.JMa)&&h.hasProperty(pd.a.Tvb)&&h.hasProperty(pd.a.Svb)&&b.hasProperty(Mc.a.marginLeft)&&b.hasProperty(Mc.a.marginRight)&&b.hasProperty(Mc.a.np),vh=b=>b.hasProperty(pd.a.Qfd)?b.getValue(pd.a.Qfd):!1,Zs=b=>b.hasProperty(De.a.keepWithNext)?
b.getValue(De.a.keepWithNext):!1,Zo=b=>b.hasProperty(De.a.widowControl)?b.getValue(De.a.widowControl):!1,Xm=b=>b.hasProperty(De.a.keepTogether)?b.getValue(De.a.keepTogether):!1;class yr extends ig.a{constructor(b,h,r,A){super(!1,!1,!0);this.LJh=null;this.G5n=()=>{Za.a.instance.resolve(1065).QXd(this.gGa,this.yya,this.X9)};this.I5n=(fb,Cb)=>{if(Cb&&(1===fb||2===fb)){if(Cb.alignmentComboBoxProps){var Gb=parseInt(Cb.alignmentComboBoxProps.selectedKey);isNaN(Gb)||ZD(Gb)&&this.uq.setValue(pd.a.Ax,Gb)}var Sb=
Cb.bySpinButtonProps;Gb=!!Sb&&""!==Sb.value;var pc=Cb.didChangeSpecialIndentationComboBoxValue;if(Cb.specialIndentationComboBoxProps){var zc=parseInt(Cb.specialIndentationComboBoxProps.selectedKey);1!==zc&&2!==zc&&zc||!(zc||pc||Gb)||this.uq.setValue(pd.a.E8,zc)}if(Sb){zc=Sb.value;Sb=Jg.a.gUa(Sb.unitType.toLowerCase());let Yc;0<=zc||(zc=0);2===Sb?Yc=2:(Yc=1,zc=Jg.a.ROa(zc,Sb));if(Gb||pc)this.uq.setValue(pd.a.E_a,zc),this.uq.setValue(pd.a.D_a,Yc)}Cb.beforeTextSpinButtonProps&&(pc=Cb.beforeTextSpinButtonProps,
Gb=Jg.a.gUa(pc.unitType.toLowerCase()),pc=""===pc.value?Number.NaN:pc.value,isNaN(pc)||(zc=pc,2===Gb?Sb=2:(Sb=1,zc=Jg.a.ROa(pc,Gb)),this.uq.setValue(pd.a.KMa,zc),this.uq.setValue(pd.a.JMa,Sb)));Cb.afterTextSpinButtonProps&&(pc=Cb.afterTextSpinButtonProps,Gb=Jg.a.gUa(pc.unitType.toLowerCase()),pc=""===pc.value?Number.NaN:pc.value,isNaN(pc)||(zc=pc,2===Gb?Sb=2:(Sb=1,zc=Jg.a.ROa(pc,Gb)),this.uq.setValue(pd.a.Tvb,zc),this.uq.setValue(pd.a.Svb,Sb)));Cb.beforeSpacingSpinButtonProps&&(Gb=Cb.beforeSpacingSpinButtonProps,
pc=Jg.a.gUa(Gb.unitType.toLowerCase()),zc=Gb.reservedValue,""!==Gb.value&&(zc===Box4Intl.Box4Strings.L_SpinnerAuto?(pc=1,Gb=0):(pc=4===pc?2:4,Gb=Gb.value),this.uq.setValue(pd.a.Rsc,Gb),this.uq.setValue(pd.a.Qsc,pc)));Cb.afterSpacingSpinButtonProps&&(Gb=Cb.afterSpacingSpinButtonProps,pc=Jg.a.gUa(Gb.unitType.toLowerCase()),zc=Gb.reservedValue,""!==Gb.value&&(zc===Box4Intl.Box4Strings.L_SpinnerAuto?(pc=1,Gb=0):(pc=4===pc?2:4,Gb=Gb.value),this.uq.setValue(pd.a.Psc,Gb),this.uq.setValue(pd.a.Osc,pc)));
if(Cb.atSpinButtonProps||Cb.lineSpacingComboBoxProps)if(Gb=Cb.atSpinButtonProps.value,1<Gb)this.uq.setValue(pd.a.xa,Gb),this.uq.setValue(pd.a.Rab,2);else if(Gb=Cb.lineSpacingComboBoxProps.selectedKey)Gb="1.00"===Gb?1:"1.50"===Gb?1.5:"2.00"===Gb?2:0,Gb=1<=Gb?Gb:1,this.uq.setValue(pd.a.xa,Gb),this.uq.setValue(pd.a.Rab,2);Cb.contextualSpacingCheckboxProps&&this.uq.setValue(pd.a.Qfd,Cb.contextualSpacingCheckboxProps.checked);Cb.keepWithNextCheckboxProps&&this.uq.setValue(De.a.keepWithNext,Cb.keepWithNextCheckboxProps.checked);
Cb.widowOrphanCheckboxProps&&this.uq.setValue(De.a.widowControl,Cb.widowOrphanCheckboxProps.checked);Cb.keepTogetherCheckboxProps&&this.uq.setValue(De.a.keepTogether,Cb.keepTogetherCheckboxProps.checked);Mp(this.gGa,this.gGa);Mp(this.uq,this.gGa);Cb="";Gb=this.yya;pc=this.uq;if(zc=pk(Gb,pc))zc=pc.hasProperty(pd.a.E_a)&&pc.hasProperty(pd.a.D_a);zc?(zc=pc.getValue(pd.a.E_a),Sb=pc.getValue(pd.a.D_a),zc=(new et.a(Sb,zc)).Ou,Gb=wF(pc)+fI(pc)+Gb.getValue(Mc.a.marginRight)+Gb.getValue(Mc.a.marginLeft)+zc+
df.a.SEa<=Gb.getValue(Mc.a.np)):Gb=pk(Gb,pc)?wF(pc)+fI(pc)+Gb.getValue(Mc.a.marginRight)+Gb.getValue(Mc.a.marginLeft)+df.a.SEa<=Gb.getValue(Mc.a.np):!0;Gb?Dx(this.gGa,this.uq,this.iPm(this.w7e?this.w7e.qfc():{})):Cb=""!==Cb?Cb:Box4Intl.Box4Strings.l_ParaIndentSetFailedMessage;this.dispose();""!==Cb?this.NNa(Cb,this.G5n):2===fb&&(ac.c(Fc.a.hxc,!0,"Custom Tab Stop Dialog was opened via Paragraph Dialog"),this.ga.Pb(Fc.a.hxc,2,null))}};this.gGa=b.clone();this.uq=b.clone();this.yya=h.clone();this.X9=
r;this.ga=A;this.w7e=new Uw;b=this.w7e.IBm(this.uq);h=Tw("Inch",3,-11,22,.1);r=Tw("Inch",3,0,22,.1);var M=Tw("Centimeter",1,-27.94,55.88,1);A=Tw("Centimeter",1,0,55.88,1);var aa=Tw("Character",2,-316.8,316.8,.5),oa=Tw("Character",2,0,316.8,.5);h=[h,M,aa];A=[r,A,oa];r=nC();b.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,["forId"]:"GeneralGroup"};M=[Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,
Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified,Box4Intl.Box4Strings.l_ParagraphDialogAlignDistributed];aa=["1","2","3","6","7"];let Ja=5;oa=this.uq.hasProperty(pd.a.Ax)?this.uq.getValue(pd.a.Ax):0;if(10===oa||9===oa)oa=11;if(y.AFrameworkApplication.lcid===tj.a.Hg("AR-SA").LCID||11===oa)b.isKashidaSupported=!0,M[Ja]=Box4Intl.Box4Strings.l_ParagraphDialogAlignKashida,aa[Ja]="11",Ja=6;if(y.AFrameworkApplication.lcid===tj.a.Hg("TH-TH").LCID||13===
oa)b.isThaiSupported=!0,M[Ja]=Box4Intl.Box4Strings.l_ParagraphDialogAlignThaiDistributed,aa[Ja]="13";M={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,["showLabel"]:!0,["options"]:xz(M,aa),["allowFreeForm"]:!1};ZD(oa)?M.selectedKey=oa.toString():M.defaultSelectedKey="";b.alignmentComboBoxProps=M;b.paginationLabelProps={["type"]:"AppLabelProps",["id"]:"PaginationSection",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogPagination,["forId"]:"PaginationGroup"};oa={["type"]:"AppCheckboxInternalProps",["id"]:"KeepWithNextCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepWithNext,["checked"]:Zs(this.uq)};b.keepWithNextCheckboxProps=oa;oa={["type"]:"AppCheckboxInternalProps",["id"]:"WidowOrphanCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogWidowOrphan,["checked"]:Zo(this.uq)};b.widowOrphanCheckboxProps=oa;oa={["type"]:"AppCheckboxInternalProps",["id"]:"KeepTogetherCheckbox",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepTogether,["checked"]:Xm(this.uq)};b.keepTogetherCheckboxProps=oa;b.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};M=rz(this.uq);oa="0"===M;b.specialIndentationComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,
["showLabel"]:!0,["options"]:xz([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["selectedKey"]:M,["allowFreeForm"]:!1};aa=df.a.tba;M=0;({Dxc:M,jfb:aa}=Kq(this.uq,pd.a.E_a,pd.a.D_a,oa));A={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,
["unitType"]:Jg.a.R6a(aa),["validUnits"]:A,["numberFormatInfo"]:r};A=this.O_b(M,A);b.bySpinButtonProps=A;oa=df.a.tba;A=0;({Dxc:A,jfb:oa}=Kq(this.uq,pd.a.KMa,pd.a.JMa,!1));oa={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:Jg.a.R6a(oa),["validUnits"]:h,["numberFormatInfo"]:r};oa=this.O_b(A,oa);b.beforeTextSpinButtonProps=oa;oa=df.a.tba;A=0;({Dxc:A,
jfb:oa}=Kq(this.uq,pd.a.Tvb,pd.a.Svb,!1));h={["type"]:"AppSpinButtonProps",["id"]:"AfterTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRight,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRightAlt,["unitType"]:Jg.a.R6a(oa),["validUnits"]:h,["numberFormatInfo"]:r};h=this.O_b(A,h);b.afterTextSpinButtonProps=h;h={["id"]:"ParagraphDialog",["bodyControls"]:b};r={["type"]:"AppCheckboxInternalProps",["id"]:"ContextualSpacingCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogContextualSpacing,
["checked"]:vh(this.uq)};b.contextualSpacingCheckboxProps=r;h.dialogButtonsOption=9;b=mC.a.isSharedUxGateEnabled("SharedOnline.ChangeGate.DialogButtonSpacingFix");h.secondaryActionButtonProps={["id"]:"tabStopOptionsButton",["type"]:"AppButtonProps",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogTabStopOptions,["positionInFooter"]:b?"left":void 0};h.styles={["root"]:{["#tabStopOptionsButton"]:{["float"]:b?void 0:"left",["margin-left"]:"0"}}};this.mi(Box4Intl.Box4Strings.l_ParagraphDialogTitle,this.I5n,
h)}iPm(b){return this.LJh||(this.LJh=this.xtf(b))}xtf(b){b[pd.a.Ax.id.toString()]=xl.xsn;b[pd.a.JMa.id.toString()]=xl.Bpj;b[pd.a.KMa.id.toString()]=xl.Bpj;b[pd.a.Svb.id.toString()]=xl.Dpj;b[pd.a.Tvb.id.toString()]=xl.Dpj;b[pd.a.E8.id.toString()]=xl.CDg;b[pd.a.D_a.id.toString()]=xl.CDg;b[pd.a.E_a.id.toString()]=xl.CDg;b[pd.a.Qfd.id.toString()]=xl.hyl;b[De.a.keepWithNext.id.toString()]=xl.Ksn;b[De.a.widowControl.id.toString()]=xl.bDp;b[De.a.keepTogether.id.toString()]=xl.Isn;return b}O_b(b,h){h.value=
isNaN(b)?"":b;return h}}Object(u.a)(yr,"WordReactParagraphDialog",ig.a,[]);class bw{vBl(b){new wy(b,Za.a.instance.resolve(12))}FFl(b,h){new XD(b,h,Za.a.instance.resolve(386),Za.a.instance.resolve(8),Object(vo.a)())}DWl(b,h,r){new YD(b,h,r)}q9h(b,h,r){new Ao(b,h,r,Za.a.instance.resolve(1062),Za.a.instance.resolve(48).kha)}S9h(b,h,r){new Lq(b,h,r,Za.a.instance.resolve(1062),Za.a.instance.resolve(48).kha)}a8h(b,h,r){new Vr(b,h,r,Za.a.instance.resolve(1061))}NAl(b){return new Js(b)}QXd(b,h,r){new yr(b,
h,r,y.AFrameworkApplication.va)}tOl(){const b=Za.a.instance.Oa(217);null==b?Tc.b(524834398,3018,10,"Roaming service not resolved."):new eI(b)}yOl(b,h){new BD(b,h)}Avf(b){return new pz(b)}}Object(u.a)(bw,"DialogFactory",null,[481,482]);class jq extends ig.a{constructor(b,h){super(!1,!1,!0);this.Lfi="DoNotCheckSpellingCheckbox";this.Yfi="DocumentChoiceGroup";this.syd=0;this.I3i="LanguageList";this.documentContext="DocumentContext";this.Sr="RangeContext";this.eSo=(r,A)=>{const M=Rg.a.instance.nq(ub.a.LMj);
if(1!==r)M.properties.Z("canceled","true");else{r=A[this.I3i].replace(jq.DQg,"");var aa=parseInt(r),oa=Boolean.parse(A[this.Lfi]);A=A[this.Yfi];A===this.documentContext?this.REd.RPo(aa,oa):this.REd.kVo(aa,oa);M.properties.Z("PreviousLCID",this.syd.toString());M.properties.Z("ChangedLCID",aa.toString());M.properties.Z("NoProof",oa.toString());this.aqh.dSo(aa,this.syd);ac.d(ub.a.LMj,!0,void 0,void 0,void 0,void 0,[Object.assign(new ia.a,{name:"SelectedLcid",string:r}),Object.assign(new ia.a,{name:"NoProof",
string:oa.toString()}),Object.assign(new ia.a,{name:"Context",string:A})]);qa.StaticActiveAppFrame.za().Fe(!0)}M.end()};this.aqh=h;this.REd=b}uCg(){const b=Array(2);b[0]={["key"]:this.Sr,["text"]:WordEditorIntl.WordEditorStrings.l_SelectedText};b[1]={["key"]:this.documentContext,["text"]:WordEditorIntl.WordEditorStrings.l_CurrentDocument};const h={showDocumentChoiceGroup:!0};h.markSelectedText=Box4Intl.Box4Strings.l_MarkSelectedText;h.documentChoiceGroupProps={["id"]:this.Yfi,["defaultSelectedKey"]:this.Mmm(),
["label"]:WordEditorIntl.WordEditorStrings.l_ChangeProofingLanguage,["options"]:b};this.syd=({Cfo:this.wqk}=this.REd.eHm()).returnValue;h.languageListPropsProvider=this.Rum();h.spellingCheckboxProps={["id"]:this.Lfi,["checked"]:!this.wqk,["label"]:WordEditorIntl.WordEditorStrings.l_DoNotCheckSpellingOrGrammar};this.mi(Box4Intl.Box4Strings.l_Language,this.eSo,{["id"]:"LanguageDialog",["bodyControls"]:h})}Mmm(){return this.REd.pf()?this.documentContext:this.Sr}Rum(){return()=>{let b,h;const r=({selectedIndex:b,
Gxc:h}=this.aqh.Qum(this.syd)).returnValue;for(let A=0;A<r.length&&A<h;A++)r[A].value=jq.DQg+r[A].value;return{["id"]:this.I3i,["items"]:r,["selectedLanguageIndex"]:b,["applyBorderIndex"]:h}}}}jq.DQg="recent-";Object(u.a)(jq,"ReactLanguageDialog",ig.a,[480]);class mu extends kC{constructor(b,h,r,A){super(h,r);this.Vjg=()=>{this.kR.rn()};this.hi=b;this.BK=A}qnb(b,h,r){if(b=super.qnb(b,h,r))b.Gtc=!0,b.Spe=!0,b.preventDismissOnScroll=!0;this.hi.E5a(this.Vjg);return b}O6c(b,h,r=null){this.BK.GUh(()=>
this.qnb(b,h,r))}Mle(){this.kR.Gtc=!0}}Object(u.a)(mu,"ExternalContentFloatieInitializer",kC,[]);class CD{mXb(){Pl.instance.Sfa&&(Lp.instance.tfb([1,0]),Pl.instance.Mfe()&&Bl.instance.tfb([1]))}}Object(u.a)(CD,"RulerUser",null,[472]);class UB{constructor(){this.whitelistedControlIds=null}}Object(u.a)(UB,"StatusBarProps",null,[]);class VB{constructor(b,h,r=!0){this.sa=new Td.a;this.tWj=()=>4;this.FJd=!1;this.D4e=null;this.lja=h.eJ;this.R8e=h.qWj;r?zl.a.get_instance().Tk(7,()=>{this.CWh(b,h)}):this.CWh(b,
h)}CWh(b,h){const r={};r.StatusBarBuildStartTime=Date.now();window.setTimeout(()=>{r.FirstTimeoutCallbackExecutionStartTime=Date.now();er.a.instance.$d(()=>{em.UISurfaces.gJm().then(A=>{r.StatusBarApiResolutionTime=Date.now();const M=Object.assign(new UB,{whitelistedControlIds:h.whitelistedControlIds});A.initializeNewStatusBar(b,M,this.R8e);this.D4e=A;this.FJd=!0;r.ReactStatusBarInitializedTime=Date.now();window.setTimeout(()=>{r.SecondTimeoutCallbackExecutionStartTime=Date.now();er.a.instance.$d(()=>
{const aa=[];if(h.bJ){const oa=h.bJ;for(const Ja in oa)aa.push(appChrome.actions.updateControlHiddenState(Ja,oa[Ja]));appChrome.api.dispatch(aa)}r.PollingStartTime=Date.now();this.mXb();r.PollingEndTime=Date.now();v.ULS.sendTraceTag(509748573,813,50,JSON.stringify(r))},"RSB:I2")},0);y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.RaiseReactStatusBarInitializedEvent")&&this.Jjo();return null}).catch(()=>{v.ULS.sendTraceTag(51656736,324,10,"Failed to load React Status Bar API");
return null})},"RSB:I1");if(h.Ava&&b){VB.njh||(y.AFrameworkApplication.va.qa(Ka.a.sWj,we.a.frame,this.tWj),y.AFrameworkApplication.va.qa(Ka.a.rWj,we.a.frame,this.tWj),VB.njh=!0);const A=St.a.Jae(h.Ava,h.bMj,b,!1);A.HL=!0;this.pYb(A,Ka.a.sWj,Ka.a.rWj)}},0)}mXb(){this.FJd&&this.lja&&window.setTimeout(()=>{this.lja(this.D4e.selectors.getStatusBarControlsMap(this.R8e),7)},0)}Qxb(b,h){this.FJd&&window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(b,h))},0)}eS(b){this.FJd&&
this.lja&&window.setTimeout(()=>{const h=this.D4e.selectors.getStatusBarControlsMap(this.R8e);if(h[b]){const r={};r[b]=h[b];this.lja(r,7)}},0)}pYb(b,h,r){const A=Xb.KeyInputManager.mc(cf.a.nz,0),M=Xb.KeyInputManager.mc(cf.a.nz,4);b.nt(A);b.nt(M);b.bindAction(A,h);b.bindAction(M,r)}Jjo(){this.sa&&(this.sa.raiseEvent("RSBIE"),this.sa.dispose(),this.sa=null)}}VB.njh=!1;Object(u.a)(VB,"ReactStatusBar",null,[]);class Jt{constructor(){this.whitelistedControlIds=this.bJ=this.eJ=null;this.jrn=!1;this.bMj=
this.Ava=this.qWj=null}}Object(u.a)(Jt,"ReactStatusBarInitOptions",null,[]);var Kw=d(471);class Ju{constructor(b,h,r,A,M){this.R9b=this.oSa=this.Ga=null;this.bap=()=>{const aa=qa.StaticActiveAppFrame.za().oq.getRegion(vi.a.Ava);aa&&aa.D8f()};this.lVm=(aa,oa,Ja,fb,Cb)=>{if(!Cb)return v.ULS.sendTraceTag(572135558,306,10,String.format("{0}","actionData is null for visibility toggle")),8;if(1===Ja)return 32;Cb&&2===Cb.length&&this.oSa&&this.oSa.Qxb(Cb[0],Cb[0]);return 32};this.Hsd=aa=>{qa.StaticActiveAppFrame.za().eJ(aa)};
this.ga=A;er.a.instance.$d(()=>{this.Ga=M;this.R9b=this.oSa=null;const aa={};y.AFrameworkApplication.oTj||(aa[Kw.a.tGo]=!0);aa.GiveFeedback=!y.AFrameworkApplication.sH;this.Ga.$("OfficeOnlineInGallatinTextVisible")||(aa.CenterStatusLabel=!0);aa[Kw.a.Woj]=!0;this.Ga.$("WPMPackageIsEnabled")&&this.Ga.$("WPMStatusBarLabelIsEnabled")||(aa[Kw.a.sOg]=!0);this.Ga.$("AddInCommandsIsEnabled")||(aa[Kw.a.VUk]=!0);this.Ga.$("WordEditorShowOcsConnectionStatus")||(aa[Kw.a.acg]=!0);aa[Kw.a.QDp]=!0;this.Ga.$("ReadingTimeIsEnabled")||
(aa[Kw.a.gxj]=!0);window.setTimeout(()=>{this.g5m(b,aa)},0)},"SBU:I")}Xb(){this.ga.fb(ub.a.Zze,lc.a.application,this.lVm,96)}g5m(b,h){this.R9b=Za.a.instance.Oa(1066);const r={};for(const M in h){var A=h[M];r[this.VLf(M)]=A}this.oSa=new VB(b,Object.assign(new Jt,{bJ:r,eJ:this.Hsd,jrn:!1,qWj:"WordEditorStatusBar",Ava:vi.a.Ava,bMj:this.bap}))}VLf(b){let h="";if(this.R9b){const r=this.R9b.tIf(b);r&&0<r.count&&(h=r.K(0))}return h&&""!==h?h:b}mXb(){this.oSa&&this.oSa.mXb()}Qxb(b,h){this.oSa&&this.oSa.Qxb(this.VLf(b),
h)}eS(b){this.oSa&&this.oSa.eS(this.VLf(b))}dispose(){}}Object(u.a)(Ju,"StatusBarUser",null,[219,10]);var WB=d(1556);class nu{constructor(b){this.ykd=(h,r,A,M,aa)=>{this.ga.Ob(this.xpm(aa[WB.a.koe]),2);return 32};this.ga=b;this.ga.qa(Ka.a.ykd,we.a.frame,this.ykd);this.ga.qa(Ka.a.DDj,we.a.frame,ce.ActionManager.Zf)}}Object(u.a)(nu,"FileMenuSQMInformation",null,[1821]);class xy extends nu{constructor(b){super(b);this.uqo()}uqo(){this.ga.qa(Ka.a.Vsg,we.a.frame,ce.ActionManager.Zf);this.ga.qa(Ka.a.xDj,
we.a.frame,ce.ActionManager.Zf);this.ga.qa(Ka.a.Wsg,we.a.frame,ce.ActionManager.Zf);this.ga.qa(Ka.a.yDj,we.a.frame,ce.ActionManager.Zf);this.ga.qa(Ka.a.zDj,we.a.frame,ce.ActionManager.Zf);this.ga.qa(Ka.a.Xsg,we.a.frame,ce.ActionManager.Zf);this.ga.qa(Ka.a.ADj,we.a.frame,ce.ActionManager.Zf);this.ga.qa(Ka.a.BDj,we.a.frame,ce.ActionManager.Zf);this.ga.qa(Ka.a.CDj,we.a.frame,ce.ActionManager.Zf);this.ga.qa(Ka.a.cEj,we.a.frame,ce.ActionManager.Zf);this.ga.qa(Fc.a.wDj,we.a.frame,ce.ActionManager.Zf);this.ga.qa(Ka.a.dEj,
we.a.frame,ce.ActionManager.Zf);this.ga.qa(Ka.a.GDj,we.a.frame,ce.ActionManager.Zf);this.ga.qa(Ka.a.HDj,we.a.frame,ce.ActionManager.Zf)}xpm(b){switch(b){case "menuJewelAbout":case "FileAboutPage":return Ka.a.Vsg;case "tabHome":case "FileHomePage":return y.AFrameworkApplication.vd("1ba3i132;45gid285"),Ka.a.xDj;case "menuJewelInfo":case "FileInfoPage":return Ka.a.Wsg;case "menuJewelNew":case "FileNewPage":return Ka.a.yDj;case "menuJewelOpen":case "FileOpenPage":return Ka.a.zDj;case "menuJewelPrint":case "FilePrintPage":return Ka.a.Xsg;
case "menuJewelSaveAs":case "FileSaveAsPage":return Ka.a.ADj;case "menuJewelDownload":case "FileDownloadPage":return Fc.a.wDj;case "menuJewelShare":case "FileSharePage":return Ka.a.BDj;case "menuJewelTransform":case "FileTransformPage":return Ka.a.CDj}return Ka.a.DDj}}Object(u.a)(xy,"WordEditorFileMenuSQMInformation",nu,[]);var DD=d(1550);class Jq{constructor(b){this.ga=b;this.ga.qa(Ka.a.zkd,we.a.frame,Object(E.a)(this,this.zkd,"reportTabSwitch"));this.ga.qa(Ka.a.YDj,we.a.frame,ce.ActionManager.Zf);
this.ga.qa(Ka.a.$Dj,we.a.frame,ce.ActionManager.Zf)}zkd(b,h,r,A,M){this.ga.Ob(this.$Fm(M[DD.a.SFg]),2);return 32}}Object(u.a)(Jq,"RibbonSQMInformation",null,[1782]);class xF extends Jq{constructor(b){super(b);this.Qso()}Qso(){this.ga.qa(Ka.a.PDj,we.a.frame,ce.ActionManager.Zf);this.ga.qa(Ka.a.RDj,we.a.frame,ce.ActionManager.Zf);this.ga.qa(Fc.a.Zsg,we.a.frame,ce.ActionManager.Zf);this.ga.qa(Ka.a.SDj,we.a.frame,ce.ActionManager.Zf);this.ga.qa(Ka.a.TDj,we.a.frame,ce.ActionManager.Zf);this.ga.qa(Fc.a.UDj,
we.a.frame,ce.ActionManager.Zf);this.ga.qa(Fc.a.VDj,we.a.frame,ce.ActionManager.Zf);this.ga.qa(Fc.a.WDj,we.a.frame,ce.ActionManager.Zf);this.ga.qa(Fc.a.XDj,we.a.frame,ce.ActionManager.Zf);this.ga.qa(Fc.a.$sg,we.a.frame,ce.ActionManager.Zf);this.ga.qa(Fc.a.ZDj,we.a.frame,ce.ActionManager.Zf);this.ga.qa(Ka.a.aEj,we.a.frame,ce.ActionManager.Zf);this.ga.qa(Fc.a.bEj,we.a.frame,ce.ActionManager.Zf);this.ga.qa(Fc.a.QDj,we.a.frame,ce.ActionManager.Zf)}$Fm(b){switch(b){case "tabAddins":case "Addins":return Ka.a.PDj;
case "tabHome":case "Home":return Ka.a.SDj;case "tabInsert":case "Insert":return Ka.a.TDj;case "tabDeveloper":case "Developer":return Ka.a.RDj;case "tabPageLayout":case "Layout":return Fc.a.UDj;case "tabReferences":case "References":return Fc.a.XDj;case "tabReview":case "Review":return Fc.a.$sg;case "tabView":case "View":return Ka.a.aEj;case "Table":case "TableLayout":case "ContextualTabs.Tables.Design":case "ContextualTabs.Tables.Layout":return Fc.a.ZDj;case "tabMailings":case "Mailings":return Fc.a.VDj;
case "tabWordDesign":case "Design":return Fc.a.bEj;case "tabHelp":case "Help":return Fc.a.Zsg;case "ctabPictureTools":case "Picture":return Fc.a.WDj;case "Copilot":return Fc.a.QDj}return Ka.a.$Dj}}Object(u.a)(xF,"WordEditorRibbonSQMInformation",Jq,[]);class gI{constructor(b=null,h=null,r=null){this.bJ=b||{};this.B1j=h||[];this.F1j=r||{}}}Object(u.a)(gI,"RibbonTrimmingProperties",null,[]);class uA{constructor(b,h,r){this.Vza=b;this.bJ=h;this.e1f=r}}Object(u.a)(uA,"ReactRibbonJewelProperties",null,
[]);class sz{constructor(){this.Bko=(b,h,r,A,M)=>{if(1===r)return 32;y.AFrameworkApplication.cga("54hi9858;4f638686");if(!M)return 32;b=M.SourceControlId;17!==M.UILocation||"New"!==b&&"Open"!==b||(M=[],hh.d("setFileMenuSelectedPage")&&("New"===b&&y.AFrameworkApplication.ua?2===y.AFrameworkApplication.ua.Ib.Uk?M.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):M.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===b&&y.AFrameworkApplication.ua&&(2===y.AFrameworkApplication.ua.Ib.Uk?
M.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):M.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),M.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(M));return 32};y.AFrameworkApplication.va.qa(Ka.a.NXa,we.a.frame,this.Bko)}F4i(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}wZa(){return!1}Trj(){}sfi(){}}Object(u.a)(sz,"ReactFileMenu",null,[297]);class lg{csf(){const b=new sz,h=[];h.push(appChrome.actions.updateFileMenuExpandedValue(!1));
h.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(h);return b}}Object(u.a)(lg,"ReactFileMenuFactory",null,[267]);class yy{constructor(b,h,r,A=!1){this.Wyc=b;this.Bnh=this.Wyc.R$a;this.Ske=Za.a.instance.Oa(120);this.RUb=Za.a.instance.Oa(729);yy.cLe=!1;this.Cln=A;this.ga=h;this.Yb=r}get Rb(){return this.ga}get focusManager(){return this.Yb}eif(){return this.Bnh&&!!this.Ske&&!!this.RUb}G0a(b,h){this.Wyc.Uo(()=>{v.ULS.sendTraceTag(5878046,340,50,"Full app settings are ready");
this.Bnh=!0;this.QAf(b,h)});Za.a.instance.Ra(120).execute(r=>{v.ULS.sendTraceTag(5878049,340,50,"IOfficeTrialExperience object is ready");this.Ske=r;this.QAf(b,h)});Za.a.instance.Ra(729).execute(r=>{v.ULS.sendTraceTag(5878050,340,50,"IMacOfficeOffer object is ready");this.RUb=r;this.QAf(b,h)})}QAf(b,h){yy.cLe||(this.eif()?(v.ULS.sendTraceTag(5878051,340,50,"ExecuteCallbackWhenReady: ready"),b(this,h),yy.cLe=!0):v.ULS.sendTraceTag(5878080,340,100,"ExecuteCallbackWhenReady: not ready yet"))}}yy.cLe=
!1;Object(u.a)(yy,"RibbonDependencies",null,[74]);class tz{constructor(b,h,r){this.ADb=b;this.ga=h;this.Yb=r}}Object(u.a)(tz,"WoncaRibbonUserFactory",null,[355]);class ED{constructor(b,h){this.vMe=b;this.vbc=h}lyb(b){this.vMe.lyb(b);this.vbc&&this.vbc.lyb(b)}Wmd(b){this.vMe.Wmd(b);this.vbc&&this.vbc.Wmd(b)}Ksd(b){this.vMe.Ksd(b);this.vbc&&this.vbc.Ksd(b)}}Object(u.a)(ED,"RibbonCommandTrimmer",null,[266]);var XB=d(1182),vA=d(1103);class yF{constructor(b,h){this.Ga=b;this.i$b=h}lyb(b){Y.a.Ci&&6>Y.a.Z9a&&
(b.fseaInsertPicture=!0);this.Ga.$("InsertSymbolIsEnabled")||(b.grpInsertSymbols=!0);this.Ga.$("ClipartInsertEnabled")||(b.fseaInsertClipart=!0);this.Ga.$("UIDiscoverabilityEnabled")||(b.jbtnAccessibilityHelp=!0);hF.a.oZi()||(b.InsertLoopComponentsForConsumers=!0);const h=this.Ga.$("InsertOnlinePictureEnabled"),r=y.AFrameworkApplication.xYf();h||(b.fseaInsertOnlinePicture=!0,b.fseaFlyInsertOnlinePictureFromSearch=!0);r||(b.fseaFlyInsertOnlinePictureFromHost=!0,b.fseaInsertOnlinePictureFromHost=!0);
if(r||y.AFrameworkApplication.nfe)b.fseaInsertPictureFromOneDrive=!0;r&&h?(b.fseaInsertOnlinePicture=!0,b.fseaInsertOnlinePictureFromHost=!0):b.flyOnlinePicture=!0;y.AFrameworkApplication.yYf()||(b.InsertPictureFromMobileDevice=!0,b.ChangePictureFromMobileDevice=!0);y.AFrameworkApplication.Izc&&(b.btnOpenInClient=!0);y.AFrameworkApplication.J.$("DisablePrintBasedOnPolicy")&&y.AFrameworkApplication.J.$("DisablePrint")&&this.Jzc(b)}Wmd(b){b.menuJewel=!0;y.AFrameworkApplication.sH||(b.jbtnGiveFeedback=
!0)}Jzc(b){b.faPrint=!0;b.jbtnSaveACopy=!0;b.jbtnSaveAsToHost=!0;b.jbtnSaveToSharePoint=!0;b.jbtnDownloadACopy=!0;b.jbtnDownloadAsPdf=!0;b.jbtnDownloadAsOdt=!0;b.jbtnPrintToPdf=!0;b.jbtnDirectPrint=!0}Ksd(b){delete b.menuJewel;y.AFrameworkApplication.privacyUrl||(b.jbtnPrivacy=!0);y.AFrameworkApplication.wkd||(b.jbtnReportAbuse=!0);y.AFrameworkApplication.wBe||(b.jbtnTermsOfUse=!0);y.AFrameworkApplication.Y1d||(b.jbtnFileSharing=!0);y.AFrameworkApplication.Xwb||(b.jbtnShareRWC=!0);y.AFrameworkApplication.dCf||
y.AFrameworkApplication.nMg||(b.jbtnVersion=!0);this.i$b.Ske&&this.i$b.Ske.yQn||(b.btnjTryOffice=!0,b.btnjTryOfficeForWordEditor=!0);this.i$b.RUb&&this.i$b.RUb.k0o||(b.btnjTryMacOffice=!0,b.btnjTryMacOfficeForWordEditor=!0);y.AFrameworkApplication.Izc?(b.btnjOpenInClient=!0,b.btnjEditInClient=!0):b[df.a.yt?"btnjOpenInClient":"btnjEditInClient"]=!0;y.AFrameworkApplication.blp&&(b.jbtnDownloadACopy=!0,b.jbtnDownloadAsPdf=!0,b.jbtnDownloadAsOdt=!0);y.AFrameworkApplication.J.$("DisablePrintBasedOnPolicy")&&
y.AFrameworkApplication.J.$("DisablePrint")?this.Jzc(b):y.AFrameworkApplication.J.$("DirectPrintIsEnabled")?b.jbtnPrintToPdf=!0:b.jbtnDirectPrint=!0;y.AFrameworkApplication.lH&&(this.Jzc(b),b.faShare=!0);if(y.AFrameworkApplication.z0||Y.a.wXa||!y.AFrameworkApplication.K5c&&!y.AFrameworkApplication.VBf&&!y.AFrameworkApplication.lMg)b.jbtnFileEmbed=!0;XB.a.q1m()||(b.btnjClose=!0);y.AFrameworkApplication.rtb?(b.jbtnVersion=!0,v.ULS.sendTraceTag(594629315,3005,15,"Word external version history menu item for OneDriveConsummer trimmed.")):
y.AFrameworkApplication.Lfe()||(b.btnjVersionHistory=!0);b.jbtnVersion&&b.btnjVersionHistory&&b.btnjOpenInClient&&b.btnjEditInClient&&(b.faInfo=!0);y.AFrameworkApplication.Uog||(b.faOpen=!0);b.jbtnFileSharing&&b.jbtnFileEmbed&&b.jbtnShareRWC&&(b.faShare=!0);b.AboutInformationMenuSectionDiagnostics=!this.Ga.$("DiagnosticsInfoInJewelAboutMenuIsEnabled");b.btnjTryOffice&&b.btnjTryMacOffice&&b.jbtnTermsOfUse&&b.jbtnPrivacy&&b.AboutInformationMenuSectionDiagnostics&&(b.faAbout=!0);b.jbtnHelp&&b.jbtnGiveFeedback&&
b.jbtnReportAbuse&&(b.faHelp=!0);b.btnjClose&&(b.msJewelSecondary=!0);const h=!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.I_i;if(b.faOpen&&b.faNew||!h)b.faHome=!0;if(y.AFrameworkApplication.gL||".ODT"===df.a.F_c.toUpperCase()||!y.AFrameworkApplication.J.$("WordEditorAppsForOfficeRibbonIsEnabled")||!vA.a.sRd||y.AFrameworkApplication.J.$("AppsForOfficeThirdPartyIsDisabled"))b.faGetAddinsFromBackstage=!0}}Object(u.a)(yF,"WoncaCommandTrimmer",null,[266]);var hI=d(965);d(725);var ti=d(1555),
zF=d(1777);class iI{constructor(b,h){this.q1=this.DM=null;this._clientId=b;this.Oda=h}N_l(){if(!yf.c(this.q1))return this.q1;this.Yzf();if(yf.c(this.q1))throw Error.create("HeaderSkeleton.EnsureTopBarDomElement _elmTopBar1 is null or undefined");this.q1.style.display="block";this.Oda&&this.Oda.b2(Object(E.a)(this,this.Pv,"onResize"));return this.q1}Pv(){this.GDa()}GDa(){this.Ezf()?(document.getElementById("application").style.minWidth="0px",(new zF.a(this.q1,null,y.AFrameworkApplication.isRtl)).tIo(this.q1)):
y.AFrameworkApplication.ua.Ib.vN||ti.a.uIo(this.q1,y.AFrameworkApplication.isRtl)}Ezf(){return y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("EnhancedMobileViewIsEnabled"):!1}Yzf(){if(yf.c(this.DM)){var b;({u5c:b}=St.a.Hrd(!y.AFrameworkApplication.I_)).returnValue?(this.DM=AD.a("div"),this.DM.className=St.a.u2l,this.DM.id=Dn.a.m1d,b.appendChild(this.DM),this.Rzf(),y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.jba&&!y.AFrameworkApplication.I_&&this.Szf(),this.M_l()):y.AFrameworkApplication.J&&
y.AFrameworkApplication.J.$("ReactHeaderCrashLogs")&&v.ULS.sendTraceTag(509116637,340,50,"HeaderSkeleton.EnsureHeaderDom: Couldn't ensure header dom since HeaderPanel doesn't exist")}}M_l(){yf.c(this.q1)&&(this.q1=AD.a("div"),this.q1.className=St.a.oIg,this.q1.style.display="none",this.DM.appendChild(this.q1))}Rzf(){Sys.UI.DomElement.addCssClass(this.DM,St.a.v2l);y.AFrameworkApplication.isRtl&&AD.b(this.DM,"cui-rtl")}Szf(){Sys.UI.DomElement.addCssClass(this.DM,"FlexBoxLayout")}}Object(u.a)(iI,"HeaderSkeleton",
null,[]);var Hj=d(612);class jI{constructor(){this.cCc=null}jnp(){this.cCc||(this.cCc=Za.a.instance.Oa(1067))||v.ULS.sendTraceTag(589050651,1300,10,"Unable to resolve IAccountSwitching")}zdm(){this.jnp();return this.cCc?this.cCc.getCustomAuthConfig():null}static Pdn(){return y.AFrameworkApplication.J.$("UiHostSupportsCustomAuthConfig")}}Object(u.a)(jI,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class YB{constructor(){this.rpc=this.cultureName=null}}Object(u.a)(YB,"HeaderCultureInfo",null,[]);
var ZB=d(1574);class kI{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}Object(u.a)(kI,"SearchInitializationSettings",null,[]);var $B=d(295);class lI{constructor(){this.saveStatus=this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=this.onGetSuggestedTitle=this.documentExtension=
null;this.isShared=!1}}Object(u.a)(lI,"DocumentTitleAppProps",null,[]);class zy{constructor(){this.documentExtension=this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=null;this.openBreadcrumbsInNewTab=!1}}Object(u.a)(zy,"DocumentTitleCalloutAppProps",null,[]);class mI{constructor(){this.language=this.culture=this.userID=
this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showDiscoverPremiumButton=this.showMeControl=this.showAppLauncher=this.isConsumer=!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;this.enableTheming=!1;
this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=this.showWorkflowButton=this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(u.a)(mI,"HeaderAppProps",null,[]);class vK{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(u.a)(vK,"HeaderControls",null,[]);class wK{constructor(){this.command=this.label=
null}}Object(u.a)(wK,"WorkflowButtonAppProps",null,[]);var AF;(function(b){b[b.none=0]="none";b[b.readOnly=1]="readOnly";b[b.z1p=2]="insufficientPermission";b[b.Y0p=3]="incompatibleEditorsPresent";b[b.OVp=4]="editorsPresent";b[b.vke=5]="notSupported"})(AF||(AF={}));Object(u.b)("RenameDisableReason",AF);class nI{constructor(b=""){this.bwg=this.documentTitleAppProps=this.pOg=null;this.POf=()=>{if(!this.pOg){const h=Hj.a();if(h){const r=this.VEm(h.command);r&&(this.pOg=Object.assign(new wK,{command:r,
label:h.label}))}}return this.pOg};this.xUn=()=>{zl.a.get_instance().hK(17)};this.onMove=()=>{const h={};h.MoveButtonClickedTime=new Date;y.AFrameworkApplication.va.Pb(Ka.a.qVb,2,h)};this.Bnm=()=>{let h=null,r=null;var A=Za.a.instance.Oa(1068);A?(A=A.jEi(),0!==A&&(h=this.uFm(A),r=AF[A])):v.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new zy,{breadcrumbBrandName:y.AFrameworkApplication.Ft.breadcrumbBrandName,breadcrumbBrandUrl:y.AFrameworkApplication.Ft.breadcrumbBrandUrl,
breadcrumbFolderName:y.AFrameworkApplication.Ft.breadcrumbFolderName,breadcrumbFolderUrl:y.AFrameworkApplication.Ft.breadcrumbFolderUrl,hideDocumentTitleInput:y.AFrameworkApplication.ua.Ib.yYm,isVersionHistoryEnabled:this.D1o(),documentExtension:I.a.Uka(y.AFrameworkApplication.fileName),isMoveEnabled:32===y.AFrameworkApplication.va.Ob(Ka.a.qVb,1),onMove:this.onMove,message:h,renameDisableReason:r,openBreadcrumbsInNewTab:y.AFrameworkApplication.J.$("OpenLinksInNewWindow")})};this.Pvi=()=>{if(!this.documentTitleAppProps){const h=
y.AFrameworkApplication.Ft.yA;this.documentTitleAppProps=Object.assign(new lI,{documentTitle:y.AFrameworkApplication.g_d?h:I.a.rL(h),onFirstRender:this.xUn,getCalloutAppProps:this.Bnm,isShared:!1})}return this.documentTitleAppProps};this.oyl=h=>{appChrome.getHeaderApi().then(r=>{r.setNavBarData(h.result);return null});v.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")};this.onFirstRender=()=>{Za.a.instance.Ra(1069).execute(h=>{h.aZo.continueWith(this.oyl,3)});zl.a.get_instance().hK(15)};
this.onFullyLoaded=()=>{zl.a.get_instance().hK(16)};this.yMk=""!==b?b:se.a.m4}VEm(b){const h=Za.a.instance.Oa(663).mqb(b);if(h&&0<h.length)return h[0].externalUxCommand;v.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",b));return null}dlm(){return Object.assign(new vK,{workflowButton:this.POf()})}uFm(b){switch(b){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;
case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}D1o(){return!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.G0i}f_o(){return!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.F0i}k1o(){const b=!Hj.b()&&!y.AFrameworkApplication.hideHeader&&!y.AFrameworkApplication.QRf&&(y.AFrameworkApplication.J.$("SkypeWebControlIsEnabled")||y.AFrameworkApplication.J.$("TeamsChatIsEnabled"));v.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",b);return b}Gpo(b=
!1){appChrome.getHeaderApi().then(h=>{const r=Za.a.instance.resolve(797);h.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});h.setHeaderCommandHandler("OnFullyLoaded",()=>{this.onFullyLoaded()});h.setHeaderCommandHandler("OnFlexPaneOpen",A=>{r.onFlexPaneOpen(A)});h.setHeaderCommandHandler("OnFlexPaneClose",A=>{r.onFlexPaneClose(A)});h.setHeaderCommandHandler("SetCookie",A=>Jc.a.set(A.cookieName,A.value));h.setHeaderCommandHandler("GetCookie",A=>this.flm(A));h.setHeaderCommandHandler("QueryWorkflowButtonSettings",
this.POf);b||(h.setHeaderCommandHandler("QueryDocumentTitleAppProps",this.Pvi),h.setHeaderCommandHandler("OnDocumentTitleReducerReady",()=>{this.yUn();return null}));ZB.a.Mee()&&h.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(E.a)(this,this.XEi,"getSearchInitializationSettings"))})}yUn(){Za.a.instance.Ra(55).execute(b=>{b.fAb(!1,y.AFrameworkApplication.va.mode)})}flm(b){b=Jc.a.get(b);void 0!==b&&null!==b&&0<b.length&&(b=decodeURIComponent(b));return b}RJm(){return $B.AppChromeOverrideUtilities.isEnabled?
$B.AppChromeOverrideUtilities.o7d("suiteux-shell",!1):this.yMk+y.AFrameworkApplication.ina+"suiteux-shell"}ela(b=!1){a:{try{var h=tj.a.Hg(y.AFrameworkApplication.lcid);if(h){var r=Object.assign(new YB,{cultureName:h.name,rpc:h.rpc});break a}}catch(A){v.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+y.AFrameworkApplication.lcid.toString())}r=Object.assign(new YB,{cultureName:"en-us",rpc:"en"})}h=Za.a.instance.resolve(797);r=Object.assign(new mI,{appName:CommonUIStrings.l_AppNameShort,
culture:r.cultureName,language:r.rpc,isConsumer:!y.AFrameworkApplication.qMg,showAppLauncher:Hj.h(),showMeControl:Hj.g(),hideUserName:y.AFrameworkApplication.t$d,defaultDocumentTitleToLeft:y.AFrameworkApplication.Jbi,assetsContainerOverride:this.RJm(),controls:this.dlm(),documentTitleAppProps:b?null:this.Pvi(),showDocumentTitleControl:!b,showWorkflowButton:!!this.POf(),showChatControl:this.k1o(),showGoPremiumControl:Hj.i(),showDiscoverPremiumButton:Hj.f(),enableSearchControl:ZB.a.Fnn(),onFlexPaneOpen:Object(E.a)(h,
h.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(E.a)(h,h.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.f_o(),testTraffic:y.AFrameworkApplication.J.$("SharedHeaderTestTrafficIsEnabled"),onFirstRender:this.onFirstRender,onFullyLoaded:this.onFullyLoaded,enableUpdatedRUMReporting:y.AFrameworkApplication.g_o()});!y.AFrameworkApplication.z2b||y.AFrameworkApplication.dDg?(r.userDisplayName=y.AFrameworkApplication.userName,r.emailAddress=y.AFrameworkApplication.J.ib("UserPrincipalName"),
r.userID=y.AFrameworkApplication.J.ib("Puid")||"",r.signOutLink=y.AFrameworkApplication.dDg):y.AFrameworkApplication.signInUrl&&(r.signInLink=y.AFrameworkApplication.signInUrl);ZB.a.Mee()&&(h=this.XEi(),r.loadTellMeResources=h.loadTellMeResources,r.getTokenRequestDictionary=h.getTokenRequestDictionary,r.enableVanillaSearchBox=y.AFrameworkApplication.J.$("VanillaSearchUxInHeaderIsEnabled"),r.userRing=h.userRing);jI.Pdn()&&(h=new jI,r.shellAuthProviderConfigPromise=Object(E.a)(h,h.zdm,"getAccountSwitchingConfig"));
this.HSk();this.Gpo(b);y.AFrameworkApplication.vd("1fb8i225;405dc927;4057j379;7eb0a923;82d02276;c29b9277;bcge5509;d960a232");return r}HSk(){y.AFrameworkApplication.J.$("SideLoadingIsEnabled")&&zl.a.get_instance().Tk(16,()=>{appChrome.getHeaderApi().then(b=>{b.setCustomHeaderButtonBadgeCharacter("overrideSettingButtonId","\u25b6");b.setCustomHeaderButtonBadgeLabel("overrideSettingButtonId","Sideloading is active so javascript is coming from an unofficial source.");b.setCustomHeaderButtonBadgeColors("overrideSettingButtonId",
{badgeColor:"green",badgeHoverColor:"green",badgeFontColor:"white",badgeFontHoverColor:"white"});return null})})}XEi(){if(!this.bwg){const b=new ZB.a;let h=y.AFrameworkApplication.J.ib("Microsoft365Ring");h&&h.length||(h="generalAudience");this.bwg=Object.assign(new kI,{loadTellMeResources:b.byn(),getTokenRequestDictionary:Object(E.a)(b,b.bMm,"getTokenRequestDict"),userRing:h})}return this.bwg}}Object(u.a)(nI,"ReactSharedHeaderPropsHelper",null,[1889]);class FD{constructor(){this.label=this.value=
null}}Object(u.a)(FD,"TextInfoSectionField",null,[]);var Ay=d(929),oI=d(1160);class wA{constructor(){this.commandId=0;this.externalUxCommand=null}}Object(u.a)(wA,"CommandDefinition",null,[]);class xK{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=this.getDoNothingCommand=this.getCommandByExternalUxId=null}}Object(u.a)(xK,"CommandDefinitionMapping",null,[]);const BL=b=>Object.assign(new xK,{getCommandByExternalUxId:h=>{const r=b.getCommandByExternalUxId(h);return r?Object.assign(new wA,
{commandId:parseInt(r.commandId),externalUxCommand:r.externalUxCommand}):Object.assign(new wA,{externalUxCommand:h})},getDoNothingCommand:()=>parseInt(Ka.a.Sg),addCommandToMaps:Object(E.a)(b,b.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(E.a)(b,b.addIconToMap,"addIconToMap"),addTabToMap:Object(E.a)(b,b.addTabToMap,"addTabToMap")});var CL=d(1254);class aC{}Object(u.a)(aC,"RibbonInitState",null,[]);var Ex=d(421),DL=d(1216);class pI{constructor(){}flatten(b){const h=[];for(const r of b)h.push.apply(h,
r);return h}}Object(u.a)(pI,"ReactAsyncDispatcher",null,[]);var EL=d(1641);class qI{constructor(b,h){this.TLk=b;this.Sok=h}}Object(u.a)(qI,"ReactExecuteCommandContext",null,[]);class ym{}ym.Trigger="FontTrigger";ym.Name="FontName";ym.Action="FontAction";ym.Level="FontLevel";ym.IsPinned="FontIsPinned";Object(u.a)(ym,"FontPickerLogProperties",null,[]);class Np{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb=null,Gb=null){this.D1=null;this.tDh=!1;this.uQe=[];this.nyd=-1;this.CNd=!1;this.eNk=0;this.$Dc=null;this.fzh=
!1;this.Sxd=null;this.zsh=!1;this.dtp=(Sb,pc)=>{const zc=Sb.launcherId;this.Wwc(zc,pc)&&(pc=appChrome.selectors.getFlyoutAnchorMenuItems(zc),this.jAc(pc,zc,hh.g(Sb)))};this.fup=(Sb,pc)=>{const zc=Sb.launcherId;this.Wwc(zc,pc)&&(pc=hh.i("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(zc):appChrome.selectors.getFlyoutAnchorMenuItems(zc),this.jAc(pc,zc,hh.g(Sb)))};this.Wvp=(Sb,pc)=>{const zc=Sb.launcherId;this.Wwc(zc,pc)&&(pc=appChrome.selectors.getPreviewGalleryMenuItems(zc),
this.jAc(pc,zc,hh.g(Sb)))};this.Nwp=(Sb,pc)=>{const zc=Sb.launcherId;this.Wwc(zc,pc)&&(pc=appChrome.selectors.getSplitButtonMenuItems(zc),this.jAc(pc,zc,hh.g(Sb)))};this.Twp=(Sb,pc)=>{const zc=Sb.launcherId;this.Wwc(zc,pc)&&(pc=appChrome.selectors.getStatefulSplitButtonMenuItems(zc),this.jAc(pc,zc,hh.g(Sb)))};this.Yia=b;this.gkb=h;this.b6e=Object(ya.a)(1785,b);this.vl=r;this.Yb=A;M&&(this.D1=new EL.a(M,A));this.tJk=aa;this.ptk=oa;this.xr=Cb;this.ga=Ja;this.XEb={};this.Ga=fb;this.RRg=Gb;fb&&(fb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",
!1)||fb.$("EnqueueTasksWhenTaskMgrIsYielding"))&&Hk.a.instance.Wgf.CWR(()=>this.tDh=!0);fb&&(b=this.Ga.ib("CommandControlIdPairsForLoggingOverride")||"")&&0<=b.trim().length&&({ev:this.$Dc}=H.d(b));this.$Dc||(this.$Dc={})}get GJj(){return!!window.appChrome&&!!appChrome.selectors}gIj(){-1!==this.nyd&&window.clearTimeout(this.nyd);this.nyd=window.setTimeout(()=>{for(this.nyd=-1;0<this.uQe.length;){if(Je.a.instance.Yy){this.gIj();break}const b=this.uQe.shift();b&&this.executeCommand(b.TLk,b.Sok)}},0)}executeCommand(b,
h){if(Je.a.instance.Yy){if(this.tDh){this.uQe.push(new qI(b,h));this.gIj();return}v.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",b,h.modelType,qb.a.toJSON(h.payload));if(this.Ga.$("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(h){const r=this.vl.getCommandByExternalUxId(b),A=h.modelType;this.RRg&&this.RRg.vzn(b,h);r?this.Y0l(b,
r,A,h):this.Z0l(b,A,h);this.oml(h);this.Pkp(h);this.iFn(b,h)}}Z0l(b,h,r){switch(h){case "GalleryModel":case "PreviewGalleryModel":this.ski(r,b);break;case "ButtonModel":this.T0l(r,b)}}Jvp(b,h,r,A,M){if(r.payload)switch(r.payload.type){case "CoauthorMenuPayload":b.MenuItemId=r.payload.coauthorId;break;case "ButtonPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=r.payload.commandValueId;b.TerminalParentControlId=r.payload.terminalParentControlId;this.Ga&&this.Ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_8213680_EnableUnDismissWhenClickingMenu")?
(h=!0,yf.c(r.payload.dismissHostingSurfaceOnExecute)||(h=r.payload.dismissHostingSurfaceOnExecute),h&&this.v6()):this.v6();break;case "ButtonPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=r.payload.commandValueId;M=h.commandPreviewId;break;case "ButtonRevertPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=r.payload.commandValueId;M=h.commandRevertId;break;default:b.MenuItemId=h.menuItemId}else b.MenuItemId=h.menuItemId;b.SourceControlId=A;return M}Kvp(b,h,r){if(h.payload)switch(h.payload.type){case "MenuOpenPayload":b=
this.vl.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;break;case "MenuClosePayload":b=this.vl.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":r.CommandId=h.payload.executedControl;r.ControlId=h.payload.executedControl;r.ParentControlId=h.payload.parentControl;r.CloseAllMenus=!0;this.v6();break;case "TellMeSearchResultChangePayload":r.Value=h.payload.searchText;break;case "SmartLookupPayload":r.CommandValueId=h.payload.selectionContextJson}return b}Y0l(b,
h,r,A){var M=this.i$n(A,r),aa=h.commandId;const oa={},Ja={};switch(r){case "SplitButtonModel":if(this.S4c(A.payload,this.Nwp,M))return;oa.MenuItemId=h.menuItemId;this.Ozg(A,oa);break;case "StatefulSplitButtonModel":if(this.S4c(A.payload,this.Twp,M))return;r=A.payload.statefulData;M=A.payload.statefulMode;"color"===M?oa.Color=r:"icon"===M&&(r=this.vl.getCommandByExternalUxId(r))&&(oa.MenuItemId=r.menuItemId);break;case "FileMenu":oa.MenuItemId=h.menuItemId;oa.SourceControlId=b;A.payload&&"FileMenuPageSwitchPayload"===
A.payload.type&&this.QSm(aa,A.payload,b);break;case "TellMe":aa=this.Kvp(aa,A,oa);oa.SourceControlId=b;oa.Location=A.payload.location;break;case "ButtonModel":A.payload&&"TabSwitchPayload"===A.payload.type?this.NUm(oa,A):aa=this.Jvp(oa,h,A,b,aa);break;case "CompoundButtonModel":oa.MenuItemId=h.menuItemId;oa.CommandValueId=A.payload.commandValueId;oa.SourceControlId=b;this.Ozg(A,oa);this.v6();break;case "ToggleButtonModel":case "InkButtonModel":oa.MenuItemId=h.menuItemId;oa.SourceControlId=b;this.Ozg(A,
oa);this.v6();break;case "FontPickerModel":switch(A.payload.type){case "MenuOpenPayload":aa=this.vl.getCommandByExternalUxId("FontPickerMenuOpen").commandId;oa[iu.a.FontPickerId]=A.payload.launcherId;break;case "MenuClosePayload":aa=this.vl.getCommandByExternalUxId("FontPickerMenuClose").commandId;oa[iu.a.FontPickerId]=A.payload.launcherId;break;case "FontPickerFontSelectedPayload":r=A.payload.font;M=null;"string"===typeof r?(M=gq.FontUtils.rYa(r),oa.CommandValueId=M,M=gq.FontUtils.NXd(M)):(r.data?
(oa.CommandValueId=r.data.fontToApply,oa.MenuItemId=r.data.themeIndex,oa[iu.a.Formatting]=r.data):oa.CommandValueId=r.name,M=r);oa.SourceControlId=b;oa[iu.a.RequestUpdateMru]=M;Ja[ym.Name]=A.payload.nameToLog?A.payload.nameToLog:"string"===typeof r?gq.FontUtils.vce(r)?"*"+r:gq.FontUtils.xXf(r)?"[EF]":"[MF]":"";Ja[ym.IsPinned]=A.payload.isPinned;Ja[ym.Level]=A.payload.level;this.i5f();break;case "FontPickerFontInfoRequestedPayload":oa.CommandValueId=A.payload.font.name;oa[iu.a.Trigger]=A.payload.trigger;
Ja[ym.Trigger]=A.payload.trigger;Ja[ym.Name]=A.payload.nameToLog;this.i5f();break;case "FontPickerFontPinningPayload":r=A.payload.isPinned;oa.CommandValueId=A.payload.fontKey;oa[iu.a.IsPinned]=r;Ja[ym.Name]=A.payload.nameToLog;Ja[ym.Action]=r?"pin":"unpin";Ja[ym.Level]=A.payload.level;this.i5f();break;default:return}break;case "ComboBoxModel":var fb=A.payload.type;switch(fb){case "MenuOpenPayload":case "MenuPopulatePayload":this.Wwc(A.payload.launcherId,M)&&(aa={},aa[A.payload.launcherId]=r,this.gkb.Dgd(aa,
hh.g(A.payload)),this.XEb[b]=new Date);return;case "MenuClosePayload":return;case "ComboBoxPayload":case "ComboBoxPreviewPayload":r=A.payload.newValue;if(!r)return;r.value?(oa[ja.a.Value]=r.value,oa[ja.a.IsFreeForm]=!0):(oa[ja.a.Value]=r.text,oa.MenuItemId=r.key,oa.CommandValueId=r.commandValueId);"ComboBoxPreviewPayload"===fb&&(aa=h.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":aa=h.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(A.payload.type){case "ZeroTermContextMenuClosePayload":r=
qb.a.xR(A.payload);for(fb of r)oa[fb]=A.payload[fb];break;default:this.S4c(A.payload,this.dtp,M),oa.launcherId=A.payload.launcherId}break;case "InkFlyoutAnchorModel":this.S4c(A.payload,this.fup,M);oa.launcherId=A.payload.launcherId;break;case "ColorPickerModel":switch(A.payload.type){case "ColorPickerPayload":oa[qo.Color]=A.payload.selectedColorId;oa.colorRGB=A.payload.color;break;case "ColorPickerPreviewPayload":aa=h.commandPreviewId;oa[qo.Color]=A.payload.selectedColorId;break;case "ColorPickerRevertPreviewPayload":aa=
h.commandRevertId;break;default:return}break;case "SpinButtonModel":oa[ui.a.Number]=A.payload.value;oa[ui.a.UnitType]=Jg.a.gUa(A.payload.unitType.toLowerCase());oa[ui.a.Text]=A.payload.reservedValue;break;case "SliderModel":oa[nj.Value]=A.payload.value;break;case "InsertTableModel":oa[tf.a.Rows]=A.payload.rows;oa[tf.a.Columns]=A.payload.columns;break;case "CheckboxModel":oa[Vg.a.On]=A.payload.checked;oa.MenuItemId=h.menuItemId;oa.TerminalParentControlId=A.payload.terminalParentControlId;break;case "PreviewGalleryModel":if(this.S4c(A.payload,
this.Wvp,M)){oa.launcherId=A.payload.launcherId;break}this.ski(A,b);return;case "DocumentTitleModel":switch(A.payload.type){case "DocumentTitleRenamePayload":oa.getNewDocumentTitle=A.payload.getNewDocumentTitle;break;case "MenuOpenPayload":aa={};aa[A.payload.launcherId]=r;this.gkb.Dgd(aa,hh.g(A.payload));this.XEb[b]=new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":oa.MenuItemId=A.payload.url;this.lAn(A.payload.pageId);break;case "NewBlankDocumentModel":case "CustomTemplateModel":oa.MenuItemId=
A.payload.assetId;oa.SourceControlId=b;y.AFrameworkApplication.J.$("BackstagePremiumTemplateExperienceEnabled")&&(oa.IsPremium=A.payload.isPremium||!1);this.mAn(A.payload.pageId);break;case "CoauthorGallery":oa.RenderTime=A.triggerTime;break;case "PeopleWell":oa.RenderTime=A.triggerTime;break;case "SyncStatus":oa.SourceControlId=b;break;case "InputBoxModel":oa.Text=A.payload.newValue;break;case "PersonaButtonModel":oa.CommandValueId=A.payload.commandValueId;this.VTm(A.payload);break;case "MultiActionButtonModel":oa.CommandValueId=
A.payload.commandValueId;oa.Href=A.payload.href;oa.SourceControlId=b;oa.Type=A.payload.type;oa.TerminalParentControlId=A.payload.terminalParentControlId;this.v6();break;default:return}aa&&!this.isShadowMenuOpen(A.payload)&&(A.payload&&"terminalParentControlId"in A.payload&&(oa.ParentMenuId=A.payload.terminalParentControlId),oa.CommandValueId||(oa.CommandValueId=oa.MenuItemId),h.legacyControlId&&(oa.LegacyId=h.legacyControlId),oa.SourceControlId||(oa.SqmControlId=b),this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1)&&oa.launcherId&&(h=this.vl.getCommandByExternalUxId(oa.launcherId))&&(oa.launcherCommandId=parseInt(h.commandId)),A.payload&&!yf.c(A.payload.PRIReadinessCheck)&&(oa.PRIReadinessCheck=A.payload.PRIReadinessCheck,this.fzh=!0),A.payload&&!yf.c(A.payload.shouldTakeFocus)&&(oa[Ft.a.t_a]=A.payload.shouldTakeFocus),h=this.Jdf(A,oa),A.payload&&!yf.c(A.payload.interactiveUid)&&(Ja.interactive_uid=A.payload.interactiveUid),yf.c(A.triggerTime)||(Ja.TriggerTime=A.triggerTime),A.payload&&!yf.c(A.payload.userActionKey)&&
(Ja.userActionKey=A.payload.userActionKey),this.byg(Ja,A,b,aa),this.b6e.executeCommand(aa,oa,this.getSelectedTabId(),h,!0,()=>{this.A8f(oa,b)},Ja,hh.g(A.payload)))}byg(b,h,r,A){if(this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",!1)&&r&&A&&h.payload){const M=!yf.c(h.payload.launcherId);r=this.oHj(this.rzm(M?h.payload.launcherId:r,A),A,!1);b.ControlId=r;const aa=h.payload.inputMethod,oa=h.payload.location;yf.c(aa)||yf.c(oa)||this.Dzn(1===aa,
2===aa||3===aa||4===aa,M&&("Overflow"===oa||"ToolBarOverflow"===oa)||"TabSwitchPayload"===h.payload.type,r,oa)}this.Ga&&this.Ga.$("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&h.payload&&"terminalParentControlId"in h.payload&&(b.TerminalParentControlId=this.oHj(h.payload.terminalParentControlId,A,!0))}Dzn(b,h,r,A,M){this.Sxd||(this.Sxd={});const aa=[];M=Qg.a.Iaa("UILocation",M,2);Array.add(aa,M);if(M=this.getSelectedTabId())M=Qg.a.Iaa("Tab",M,2),Array.add(aa,M);this.Sxd[A]||r||(this.Sxd[A]=
1,h?this.lbd("DistinctUserInitiatedTerminalCommand",aa):b&&this.lbd("DistinctUserInitiatedKeyboardCommand",aa));h?r?this.lbd("UserInitiatedNavigationalCommand",aa):this.lbd("UserInitiatedTerminalCommand",aa):b&&this.lbd("UserInitiatedKeyboardCommand",aa)}lbd(b,h){ac.b(b,null,0,!0,0,h)}oHj(b,h,r){if(RegExp("^[a-zA-Z0-9_]*$").test(b))return b;v.ULS.sendTraceTag(510247689,207,15,r?"CommandId: "+h+" has a parentControlId that is non-alphanumeric and may need to be changed":"CommandId: "+h+" has a controlId that is non-alphanumeric and may need to be changed");
return"MalformedId"}rzm(b,h){h=parseInt(h);h=ce.ActionManager.$of(h)||ce.ActionManager.dea(h)||"";return!yf.c(h)&&h in this.$Dc?this.$Dc[h]:100<b.length?"":b}i5f(){this.xr&&this.xr.execute(b=>{b.S4f("ModernFontPickerExperience")})}Jdf(b,h){let r=2;b.payload&&"inputMethod"in b.payload&&b.payload.inputMethod&&(r=b.payload.inputMethod,h[Ft.a.Wy]=r);return r}A8f(b,h){const r=Object(ya.a)(id.AFrame,y.AFrameworkApplication.ua);if(this.Yb&&this.fRj(b)){if(!this.Yb.currentScope&&r){let A="null";if(b){const M=
b.Value;delete b.Value;A=qb.a.toJSON(b);yf.c(M)||(b.Value=M)}v.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",h,A,r.ndb)}this.Yb.wDf()}(this.Yb&&this.Yb.currentScope&&this.Yb.currentScope.name!==id.AFrame.Jua&&r&&this.Yb.currentScope.name!==r.ndb||this.fRj(b))&&this.bsl(b)}fRj(b){return!!b&&!yf.c(b[Ft.a.t_a])&&b[Ft.a.t_a]}bsl(b){Ft.a.Wy in b&&1===b[Ft.a.Wy]&&Ay.ShyRibbon.Smb(1,
0)}NUm(b,h){hh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.CloseMenuOnUnmount")&&this.v6();this.Yia.rn();if(this.tJk&&this.ga){const r={};r[DD.a.SFg]=h.payload.tabId;this.ga.Pb(Ka.a.zkd,2,r,this.AR(h));yf.c(h.payload.inputMethod)||(this.ga.Ob(Ka.a.YDj,2),this.CNd||this.I5o(h.payload.tabId))}h=h.payload.tabId;b.NewContextId=h;b.NewContextCommand=this.vl.qNf(h);v.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+h);if(this.xr&&h){const r=h+"TabSwitchActivity";
this.xr.execute(A=>{A.S4f(r)})}}S4c(b,h,r){const A=b.type;return"MenuClosePayload"===A?!0:"MenuOpenPayload"===A?(h(b,r),!0):!1}VTm(b){b=b.type;"MenuOpenPayload"===b?y.AFrameworkApplication.eqd=!0:"MenuClosePayload"===b&&(y.AFrameworkApplication.eqd=!1)}i$n(b,h){if(!b.payload||!b.payload.launcherId||"MenuOpenPayload"!==b.payload.type&&"MenuPopulatePayload"!==b.payload.type)return!1;const r=b.payload.launcherId,A=this.vl.getCommandByExternalUxId(r);return A&&A.populationProps?((b=this.gkb.dkg(A,h,b.payload))&&
r in this.XEb&&delete this.XEb[r],b):!1}getSelectedTabId(){return this.GJj?appChrome.selectors.getSelectedTabId():null}jAc(b,h,r){this.gkb.Dgd(b,r);this.XEb[h]=new Date}Wwc(b,h){let r=!0;b in this.XEb&&(r=this.XEb[b].getTime()<this.Yia.Hta.getTime());return r&&!h&&this.GJj}ski(b,h){const r={};var A=b.payload.selectedGalleryId;const M=this.vl.getCommandByExternalUxId(A);if(M){r.SourceControlId=A;r.MenuItemId=M.menuItemId;r.SqmControlId=h;M.legacyControlId&&(r.LegacyId=M.legacyControlId);b.payload&&
!yf.c(b.payload.shouldTakeFocus)&&(r[Ft.a.t_a]=b.payload.shouldTakeFocus);this.lCm(b.payload,r);(A=this.AR(b))||(A={});this.byg(A,b,h,M.commandId);const aa=this.Jdf(b,r);this.b6e.executeCommand(M.commandId,r,this.getSelectedTabId(),aa,!0,()=>{this.A8f(r,h)},A,hh.g(b.payload))}}T0l(b,h){const r=this.vl.getCommandByExternalUxId(h);if(r){const A={};A.SourceControlId=h;A.MenuItemId=h;A.SqmControlId=h;b.payload&&!yf.c(b.payload.shouldTakeFocus)&&(A[Ft.a.t_a]=b.payload.shouldTakeFocus);let M=this.AR(b);
M||(M={});this.byg(M,b,h,r.commandId);const aa=this.Jdf(b,A);this.b6e.executeCommand(r.commandId,A,this.getSelectedTabId(),aa,!1,()=>{this.A8f(A,h)},M,hh.g(b.payload))}}lCm(b,h){"CharacterGalleryPayload"===b.type&&(h.MenuItemId=b.character)}Ozg(b,h){b.payload&&"toggled"in b.payload&&(h[Vg.a.On]=b.payload.toggled)}iFn(b,h){if("MenuOpen"===b){if(this.D1&&!("isShadowRendering"in h.payload&&h.payload.isShadowRendering))this.D1.onMenuOpen()}else if("MenuClose"===b&&this.D1)this.D1.onMenuClose()}v6(){this.D1&&
this.D1.gdg()}AR(b){let h=null;yf.c(b.triggerTime)||(h={},h.TriggerTime=b.triggerTime);return h}QSm(b,h,r){if(this.ptk&&this.ga){const A={};A[WB.a.koe]=r;this.ga.Pb(Ka.a.ykd,2,A)}this.jAc(h.pageControlIdMap,b,hh.g(h))}mAn(b){if(this.ga)switch(b){case "FileHomePage":this.ga.Ob(Ka.a.cEj,2);break;case "FileNewPage":this.ga.Ob(Ka.a.dEj,2)}}lAn(b){if(this.ga)switch(b){case "FileHomePage":this.ga.Ob(Ka.a.GDj,2);break;case "FileOpenPage":this.ga.Ob(Ka.a.HDj,2)}}isShadowMenuOpen(b){return!!b&&"MenuOpenPayload"===
b.type&&b.isShadowRendering}I5o(b){if(y.AFrameworkApplication.J.$("TellMeHelpCoachMarkActivityEnabled")&&"Help"===b)this.xr.execute(h=>{h.logActivity("TellMeHelpCoachMarkActivity",null)}),this.CNd=!0;else{if(y.AFrameworkApplication.J.$("TellMe3TabSwitchCoachMarkActivityEnabled")&&(this.xr.execute(h=>{h.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.eNk)){this.CNd=!0;return}y.AFrameworkApplication.J.$("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.ga.Ob(Ka.a.s0b,2)&&(this.CNd=
!0)}}oml(b){b&&b.payload&&b.payload.PRIReadinessCheck&&!this.fzh&&appChrome.PRIToastManager.dismissToast()}Pkp(b){!this.zsh&&this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)&&(b=hh.g(b.payload),31===b||14===b||15===b||2===b)&&(window.requestAnimationFrame(()=>{window.setTimeout(()=>{const h=Za.a.instance.Ra(2);h&&h.execute(r=>{r.logActivity("SingleLineToolBarFPS","SingleLineToolBarFloodgateSurveyIsEnabled")})},0)}),this.zsh=!0)}}Object(u.a)(Np,
"ReactExecuteCommandHandler",null,[]);class eO{constructor(){this.V1d=null}get gAb(){return 0}get fbb(){return 0}get dMa(){return!1}GDa(){}I_j(){}z2(){return!1}dMj(){}H6(){return!1}dPa(b){return this.V1d&&this.V1d.wZa(b)?!0:!1}get Ena(){return!1}Qxb(){}Gce(){return!1}get OWd(){return null}set OWd(b){}Fja(){}Sea(){}xOf(){return null}RUa(){}refresh(){}get controls(){return null}tuc(){return!1}onb(){}rn(){}get oH(){return null}set oH(b){}nsd(){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}
Object(u.a)(eO,"ReactRibbonExternal",null,[604,550,605]);class zr{constructor(b,h,r,A){this.hVn=(M,aa)=>{if((M=Object(ya.a)(id.AFrame,y.AFrameworkApplication.ua))&&aa.nfj&&y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.bCa){const oa=appChrome.selectors.getShyState();oa.isActive&&aa.nfj.name===M.ndb&&Ay.ShyRibbon.Smb(oa.state,1)}};this.eGj=()=>4;this.dGj=()=>4;this.$Fj=()=>{hh.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.bCa&&
appChrome.selectors.getShyState().isActive&&Ay.ShyRibbon.Smb(1,0),this.Yb.Jg(id.AFrame.Ro));return 4};this.XZn=M=>{M.Nb&&M.Nb.target&&"input"!==M.Nb.target.tagName.toLowerCase()&&M.Nb.preventDefault();return!1};this.Yb=b;this.ga=h;this.dJh=r;this.j$b=A}initialize(){this.ga.qa(Ka.a.jld,we.a.frame,this.eGj);this.ga.qa(Ka.a.ild,we.a.frame,this.dGj);this.ga.qa(Ka.a.Aue,we.a.frame,this.$Fj);var b=St.a.Jae(this.j$b,null,this.dJh,!1);b.HL=!0;this.pYb(b,Ka.a.jld,Ka.a.ild);b.bindAction(Xb.KeyInputManager.mc(cf.a.Bfb,
0),Ka.a.Aue);b=this.Yb.ie(id.AFrame.Jua);b.HL=!0;this.pYb(b,Ka.a.E7a,Ka.a.E7a);ie.a.instance.nb(Jd.a.az,this.dJh,this.XZn);b=Cp.a.instance;hh.a("enterKeytipMode")&&b.yTo(this.j$b,()=>{appChrome.api.enterKeytipMode(!1)});hh.a("exitKeytipMode")&&b.uTo(this.j$b,()=>{appChrome.api.exitKeytipMode();Ay.ShyRibbon.Smb(1,0)});y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.bCa&&(b=Object(ya.a)(Cd.FocusManager,this.Yb))&&b.HZk(this.hVn)}A5m(b){b=St.a.Jae(b,null,document.getElementById("WACToolbarContainer"),
!1);b.HL=!0;this.pYb(b,Ka.a.jld,Ka.a.ild)}pYb(b,h,r){const A=Xb.KeyInputManager.mc(cf.a.nz,0),M=Xb.KeyInputManager.mc(cf.a.nz,4);b.nt(A);b.nt(M);b.bindAction(A,h);b.bindAction(M,r)}dispose(){this.ga.vy(Ka.a.jld,we.a.frame,this.eGj);this.ga.vy(Ka.a.ild,we.a.frame,this.dGj);this.ga.vy(Ka.a.Aue,we.a.frame,this.$Fj)}}Object(u.a)(zr,"ReactRibbonFocusManager",null,[10]);class Kt{constructor(b,h,r,A,M,aa,oa,Ja=null,fb=!0,Cb=null,Gb=null){this.Yhb=this.xOd=this.qMe=this.Yia=null;this.WCh=[];this.k$b=null;
this.yio=()=>{y.AFrameworkApplication.J.Uo(()=>{this.ZSl()})};this.sCn=()=>{if(y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.As){var Sb=Za.a.instance.Ra(2);"SingleLine"===appChrome.selectors.getRibbonMode()?(Sb.execute(zc=>{zc.logActivity("SingleRibbonModeActivity",null)}),y.AFrameworkApplication.vd("d79fg304;61jba833;h856e313;f5i2f477;d613b829;da9b1202")):"Multiline"===appChrome.selectors.getRibbonMode()&&(Sb.execute(zc=>{zc.logActivity("MultiRibbonModeActivity",null)}),y.AFrameworkApplication.vd("69a7h198;dfd7j584"));
if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ScreenSizeActivity")){var pc=Fd.a.$qb();Sb=Fd.a.dX();pc=1550<pc?"Large":1050<pc?"Medium":"Small";Sb=850<Sb?"Large":675<Sb?"Medium":"Small";ac.a("ScreenBucket_W_"+pc+"_H_"+Sb);y.AFrameworkApplication.J&&y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ScreenSizeAction")&&ac.c(this.OGm(pc,Sb))}}};this.wCg=()=>{const Sb=Za.a.instance.Ra(2);Sb&&Sb.execute(pc=>
{pc.logActivity("SingleLineToolBarOptOut",null)});return 32};this.$yn=()=>{this.ga.qa(Ka.a.$Ig,we.a.frame,Object(E.a)(this,this.$Ig,"triggerModeSwitcherTUI"));this.ga.fb(Ka.a.wCg,we.a.frame,this.wCg,96);const Sb=Jc.a.dfa(y.AFrameworkApplication.J.ib("VNextStyleOptOutCookieName"),!1);window.setTimeout(()=>{const pc=Za.a.instance.Ra(2);pc&&(y.AFrameworkApplication.J.$("Fluent2StyleIsEnabled")?(pc.execute(zc=>{zc.logActivity("VNextStylesOn",null)}),pc.execute(zc=>{zc.logActivity("Fluent2StyleEnabledFPS",
"Fluent2StyleFloodgateSurveyIsEnabled")})):y.AFrameworkApplication.J.$("Fluent2StyleFGOnlyIsEnabled")&&Sb&&pc.execute(zc=>{zc.logActivity("Fluent2StyleOptOutFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},5E3)};this.dto=()=>{zl.a.get_instance().Tk(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",!1)});const Sb=appChrome.api.getRibbonSubComponentMappings();for(const zc in Sb){var pc=zc;const Yc=Sb[zc];if(Yc)for(const Kd of Yc)y.AFrameworkApplication.va.H2(Kd)?appChrome.api.reportRibbonSubComponentBehaviorMapped(pc):
y.AFrameworkApplication.va.rTo(Kd,this.UFl(pc));else appChrome.api.reportRibbonSubComponentBehaviorMapped(pc)}};this.tSa=b;this.O_e=h;this.j$b=r;this.Yb=A;this.ga=M;this.vl=aa;this.Yia=Cb?Cb:new zD(rw.instance,this.vl);this.pJc=oa;this.rBh=new eO;this.uSa=Ja;this.H7e=fb;new pI;this.tgh=Gb;zl.a.get_instance().Tk(7,Object(E.a)(this,this.RUo,"setRibbonPostInteractiveReady"));zl.a.get_instance().Tk(7,this.sCn);zl.a.get_instance().Tk(19,this.$yn);zl.a.get_instance().Tk(7,this.dto);zl.a.get_instance().Tk(7,
this.yio)}initialize(b,h,r=null){this.H7e||this.hK(5);r?r.then(()=>{this.QCj()}).catch(()=>v.ULS.sendTraceTag(561394319,340,10,"Failed to load the resources for the Ribbon")):Ex.a.Jqd(Ex.a.Jqd(Oi.Task.WAA(this.e6i(b),this.d6i(Kt.ipk)),()=>this.d6i(Kt.xlk)),()=>this.e6i(h)).continueWith(()=>{this.QCj()},11)}dispose(){this.rop();this.Yhb&&this.Yhb.sfi();this.k$b&&this.k$b.dispose();for(const b of this.WCh)zl.a.get_instance().Rol(b);y.AFrameworkApplication.va.vy(Ka.a.pBo,we.a.frame,ce.ActionManager.Zf)}d6i(b){return Za.a.instance.resolve(641).cqc(y.AFrameworkApplication.eC(b,
2))}e6i(b){return""===b?Oi.Task.X6(!0):Za.a.instance.resolve(641).cqc(y.AFrameworkApplication.eC(b,3))}j5m(){(this.uSa||this.pJc)&&appChrome.api.dispatch(this.dIi());this.SWo();hh.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(y.AFrameworkApplication.I8);this.Yia.rn()}QCj(){this.j5m();this.H7e&&(appChrome.renderAppChrome(this.tSa,hh.e()),this.hK(10));this.oLh();this.dlf();this.H7e&&this.hK(5);this.jQi()}jQi(){this.Yb&&this.ga&&this.j$b&&(this.k$b=new zr(this.Yb,this.ga,this.tSa,this.j$b),
this.k$b.initialize())}get hld(){return this.rBh}setCommandDefinitionMapping(){if(hh.a("setCommandDefinitionMapping")){const b=BL(this.vl);appChrome.api.setCommandDefinitionMapping(b)}}registerOnShyRibbonStateChange(){y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.bCa&&hh.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((b,h)=>{0===h&&this.ttc()})}oLh(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const b=Object(ya.a)(zD,this.Yia);
this.qMe=new Np(this.Yia,b.nuc,this.vl,this.Yb,this.O_e,Za.a.instance.Oa(1070),Za.a.instance.Oa(1071),y.AFrameworkApplication.va,y.AFrameworkApplication.J,Za.a.instance.Ra(2),null);this.yal();this.ORm()}yal(){this.xOd=appChrome.api.bindCommandHandler((b,h)=>{this.qMe.executeCommand(b,h)})}rop(){this.xOd&&(this.xOd(),this.xOd=null)}SWo(){appChrome.api.initializeLogger(new so.a)}tKa(){return this.Yia?this.Yia.tKa():[]}ttc(){er.a.instance.$d(()=>{let b=null;er.a.instance.$d(()=>{b=this.tKa()},"RB:GA");
b&&0<b.length&&(this.Yia.Hta=new Date,er.a.instance.$d(()=>{appChrome.api.dispatch(b)},"RB:DA"));this.Yhb&&er.a.instance.$d(()=>{this.Yhb.Trj()},"RB:J")},"RB:PFSU")}ysd(){this.Yia.ysd()}YVb(){}VRk(b){b=[appChrome.actions.activateDeactivateContextualTab(b,!0),appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}setCurrentTab(b){b=[appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}dIi(){var b=y.AFrameworkApplication.J;const h=[];b.$("EnableTellMeForOneLineRibbonIsEnabled")?b.$("OcpsIsEnabled")&&
Za.a.instance.Ra(4).execute(r=>{r.isFeatureEnabled("ConnectedServices",!0).then(A=>{A&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",!1));return null})}):h.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));h.push.apply(h,this.Ewi());b=new CL.a(this.vl);this.uSa.bJ&&(DL.a.elp(this.uSa.bJ),h.push.apply(h,b.P3d(this.uSa.bJ)));if(this.uSa.B1j)for(const r of this.uSa.B1j)h.push(appChrome.actions.updateGallerySectionHiddenState(r.H3d,r.Hgq,r.dlq));
h.push.apply(h,b.fri(this.uSa.F1j));return h}Ewi(){const b=[];if(this.pJc&&this.pJc.bJ){const r=this.pJc.bJ;for(const A in r){var h=r[A];const M=this.vl.tIf(A);if(M)for(const aa of M)b.push(appChrome.actions.updateControlHiddenState(aa,h))}}return b}$Oa(b){b&&this.Yia.nuc.Dgd(b,0)}dkg(b){this.Yia.nuc.dkg(this.vl.getCommandByExternalUxId(b),appChrome.selectors.getModelType(b),{inputMethod:0})}ZSl(){const b=y.AFrameworkApplication.J.$("ShareMenuIsEnabled")?"ShareMenu":"Share",h=y.AFrameworkApplication.J.appSettings;
h&&appChrome.api.dispatch(this.Iwp(b,"Shared"===(h.SharingStatus||"")))}Iwp(b,h){return appChrome.actions.updateSharingStatusIndicator(b,h)}hK(b){zl.a.get_instance().hK(b);this.WCh.push(b)}RUo(){hh.d("updateRibbonInitializationState")&&appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new aC,{postRibbonInteractiveReady:!0})))}dlf(){this.pJc&&this.tgh&&(this.Yhb=this.tgh.csf(),this.rBh.V1d=this.Yhb)}Fun(b,h){this.Yhb&&this.Yhb.F4i(b,h)}Pug(b,h,r){if(1===r)return 32;
this.JNj(!0);this.ttc();y.AFrameworkApplication.ua.Fe();return 32}Qug(b,h,r){if(1===r)return 32;this.JNj(!1);this.cVo();this.ttc();y.AFrameworkApplication.ua.Fe();return 32}$Ig(b,h,r){if(1===r)return 32;(b=Za.a.instance.Ra(2))&&b.execute(A=>{A.logActivity("DefaultFileOpenPreferenceOn",null)});return 32}cVo(){Jc.a.UNa(y.AFrameworkApplication.J.ib("IsSimplifiedRibbonOnCookieName"),"true",Jc.a.XLa)}JNj(b){Jc.a.UNa(y.AFrameworkApplication.J.ib("ReactRibbonMLRPreferenceCookieName"),b.toString(),Jc.a.XLa)}OGm(b,
h){return"Large"===b?"Large"===h?Ka.a.ZIo:"Medium"===h?Ka.a.$Io:Ka.a.aJo:"Medium"===b?"Large"===h?Ka.a.bJo:"Medium"===h?Ka.a.cJo:Ka.a.dJo:"Large"===h?Ka.a.eJo:"Medium"===h?Ka.a.fJo:Ka.a.gJo}UFl(b){return()=>{appChrome.api.reportRibbonSubComponentBehaviorMapped(b)}}ORm(){if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&hh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&
y.AFrameworkApplication.dtc.Qcf){const b=y.AFrameworkApplication.dtc.Qcf,h=y.AFrameworkApplication.dtc.PKh;h.payload||(h.payload={});const r=h.payload.launcherId?h.payload.launcherId:b;Kt.gGj.lb(r)?Kt.gGj.K(r)():"StatefulSplitButtonModel"===h.modelType?appChrome.PRIToastManager.dismissToast():(h.payload.PRIReadinessCheck=!0,this.qMe.executeCommand(b,h))}}}Kt.ipk="common";Kt.xlk="appChrome";Kt.gGj=new oI.a(Na.a.n4c());Object(u.a)(Kt,"ReactRibbonUser",null,[360,349,10]);class EM extends Kt{constructor(b,
h,r,A,M,aa,oa,Ja,fb=null,Cb=!0,Gb=null,Sb=null){super(b,h,A,M,aa,oa,Ja,fb,Cb,Gb,Sb);this.oBd=null;this.ADb=r;this.ADb.execute(pc=>{this.oBd=pc});this.ADb.execute(pc=>{this.Yia.oH=pc})}tKa(){return this.oBd?(this.oBd.clearCache(),super.tKa()):[]}YVb(b){if(!b)throw Error.argumentNull();this.ADb.execute(h=>{b.oH=h})}}Object(u.a)(EM,"ReactRibbonUser",Kt,[]);var $O=d(969);class yK extends EM{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb=!0,Gb=null,Sb=null){super(h,b.taa,A,vi.a.$ua,M.focusManager,M.Rb,oa,Ja,fb,
Cb,Gb,Sb);if(void 0===b||null===b)throw Error.argumentNull("hostingAppFrame");this.STe=b;this.Oda=aa;M.G0a(()=>{this.pwp();y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayUIComponentsUntilAfterRibbon",!1)?zl.a.get_instance().Tk(7,()=>{this.$Pi()}):this.$Pi()},null)}get qVi(){return!!y.AFrameworkApplication.J.appSettings.BootActivityNavigationId}$Pi(){this.XDl();this.csf();this.Ipo()}pwp(){this.tSa.classList.add("FlexBoxLayout");this.STe.psa().classList.add("cui-exth");
this.STe.psa().classList.add("FlexBoxLayout");this.STe.psa().classList.add("ScrollableRibbon")}XDl(){y.AFrameworkApplication.I_||this.jIl()}jIl(){if(!y.AFrameworkApplication.I_){var b=(new iI(yK.rJk,this.Oda)).N_l(),h=St.a.Jae(vi.a.mWa,null,b,!0);h.HL=!0;this.pYb(h,Ka.a.jld,Ka.a.ild);h.bindAction(Xb.KeyInputManager.mc(cf.a.Bfb,0),Ka.a.Aue);jA.a(1,()=>{this.Bzo(b)})}}Bzo(b){const h=new nI;appChrome.renderSharedHeader(b,h.ela()).then(this.Rwf.bind(this))}EAj(){y.AFrameworkApplication.ua.Ib.E0i?appChrome.getHeaderApi().then(b=>
{document.getElementById(y.AFrameworkApplication.ipb).classList.remove("Placeholder");return b.dismissPlaceholder()}):(new $O.a).Rwf()}Rwf(){this.qVi&&y.AFrameworkApplication.J.$("ImprovedDeepLinkLoadIsEnabled")?(zl.a.get_instance().Tk(12,this.EAj.bind(this),11),v.ULS.sendTraceTag(42316515,338,50,"DismissFastViewHeader was delayed to AppInitializationStatus.CommentRendered phase")):this.EAj()}pYb(b,h,r){const A=Xb.KeyInputManager.mc(cf.a.nz,0),M=Xb.KeyInputManager.mc(cf.a.nz,4);b.nt(A);b.nt(M);b.bindAction(A,
h);b.bindAction(M,r)}csf(){const b=!!this.uSa&&"FileMenu"in this.uSa.F1j;y.AFrameworkApplication.ua.Ib.qXa&&!b&&jA.a(1,this.Uyo.bind(this))}Uyo(){const b=[];if(y.AFrameworkApplication.J.$("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var h=[Object.assign(new FD,{label:CommonUIStrings.L_DiagnosticsSessionId,value:y.AFrameworkApplication.userSessionId}),Object.assign(new FD,{label:CommonUIStrings.L_DiagnosticsBuild,value:y.AFrameworkApplication.buildVersion})];b.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",
h))}b.push.apply(b,this.Ewi());h=document.createElement("div");document.body.appendChild(h);appChrome.renderFileMenu(h,b)}Ipo(){this.ga.qa(Ka.a.Q_a,lc.a.view,this.Q_a.bind(this));this.ga.qa(Ka.a.Pug,lc.a.view,this.Pug.bind(this));this.ga.qa(Ka.a.Qug,lc.a.view,this.Qug.bind(this))}activateRibbonTab(b){this.VRk(b)}ttc(){zl.a.get_instance().isCompleted(7)&&this.oBd&&(db.a.mark(4893),Vh.a.Vvp(),super.ttc(),db.a.mark(4894))}Q_a(b,h,r,A,M){if(2===M[Ft.a.Wy]){if(r=Object(ya.a)(kw.a,h))A=Object(ya.a)(kv.a,
r.view);else return v.ULS.sendTraceTag(38549528,338,10,"Context is not a valid ViewContext. It is a {0}, the actionId is: {1}, the actionData is: {2}",Object.getTypeName(h),b,qb.a.join(M," ",":")),8;if(A&&""!==A.nL)Xn.a.Jla(h)&&Xn.a.tnc()||(this.Yb.Jg(A.nL),appChrome.selectors.getShyState().isActive&&Ay.ShyRibbon.Smb(0,1));else return v.ULS.sendTraceTag(38549529,338,10,"Context is not a valid InteractiveView. It is a {0}, the actionId is: {1}, the actionData is: {2}, it is a view type of: {3}",Object.getTypeName(r.view),
b,qb.a.join(M," ",":"),this.pum(r.view)),8}return 32}pum(b){return b?"is ContentEditableView: "+b.qk+" is Editing View: "+b.KBa+" is HtmlView: "+b.U$a+" is InteractiveView: "+b.te+" is NavigationPaneView: "+b.Zjn+" is PageView: "+b.gj+" is WordNavigationPaneHeadingsView "+b.X0f:"null view"}}yK.rJk="WACRibbon";Object(u.a)(yK,"ReactRibbonUser",EM,[359,360,349,10]);class rI extends yK{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc,zc=null,Yc,Kd){super(b,h,r,A,M,aa,oa,Ja,fb,!1,Cb,zc);this.U2k=()=>{this.xr&&
this.xr.execute(ke=>{ke.logActivity("WordShyRibbon",null)});return 32};this.qYo=()=>{y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)&&"true"!==Jc.a.get(y.AFrameworkApplication.J.ib("ReactRibbonMLRPreferenceCookieName"))&&zl.a.get_instance().Tk(20,()=>{this.xr.execute(ke=>{ke.logActivity("FloodgateFirstStart",null)})})};this.v4m=()=>{vg.a.instance.qf(Jh.a.L5m,(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(ke=>
{var ge;this.uSa&&ke.push.apply(ke,this.dIi());(this.IDh||this.JDh)&&this.Jkb&&ke.push.apply(ke,this.aim());ke.push(appChrome.actions.setControlCustomTooltip(Uh.a.pvn,CommonUIStrings.l_LoopsLearnMoreTooltip));ke.push(appChrome.actions.setControlCustomTooltip(Uh.a.aol,"Plan and manage tasks with to-do lists you can share and work on with others."));ke.push(appChrome.actions.setControlCustomTooltip(Uh.a.Lep,"Assign tasks, set due dates, and track in a table you can easily edit."));ke.push(appChrome.actions.setControlCustomTooltip(Uh.a.J9n,
"Make surveys to get quick feedback, schedule, and plan."));var de=null===(ge=y.AFrameworkApplication.J)||void 0===ge?void 0:ge.ib("ReactShyRibbonPreferenceCookieName");ge=Jc.a.get(de);this.pYo(ge);this.qYo();ke.push.apply(ke,this.tKa());ke.push(appChrome.actions.setControlBehaviorAttached(!0));const Sd=Za.a.instance.resolve(1072);ge=Sd.Rtm();y.AFrameworkApplication.vd("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",
!1)&&(de=appChrome.selectors.getModeSwitcherMode())&&de!==ge.activeMode&&v.ULS.sendTraceTag(527778651,306,15,`ModeSwitcher was initially rendered in the incorrect mode. Expected: ${ge.activeMode}, Actual: ${de}`);"Suggest"===ge.activeMode||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)&&"View"===ge.activeMode?appChrome.getUpdateAppModeAndTabsActions(ge,!0).then(be=>{appChrome.api.dispatch(ke.concat(be));Sd.Cbj();this.pQi()}):(ke.push(appChrome.actions.updateModeSwitcher(ge)),
appChrome.api.dispatch(ke),Sd.Cbj(),this.pQi())})};this.Jkb=Gb;this.IDh=Sb;this.JDh=pc;this.xr=Za.a.instance.Ra(2);this.Gb=Yc;this.gSe=Kd}K5m(){v.ULS.sendTraceTag(587232785,306,50,"InitializeWordRibbon was reached");zl.a.get_instance().hK(5);const b=this.qVi&&y.AFrameworkApplication.J.$("ImprovedDeepLinkLoadIsEnabled")?12:10;zl.a.get_instance().Tk(b,this.v4m,11);y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnablePenMinutes",!1)&&this.fWk()}fWk(){this.Gb.Zb(new xc.a(5,
1,0,()=>{this.gSe.execute(b=>{b.WTo()})}))}aim(){const b=[];this.IDh&&(b.push(appChrome.actions.setButtonSecondaryText(Uh.a.HYd,this.Jkb.mZm)),b.push(appChrome.actions.setButtonSecondaryText(Uh.a.cXd,this.Jkb.lZm)),b.push(appChrome.actions.setButtonSecondaryText(Uh.a.fgd,this.Jkb.nZm)));this.JDh&&b.push(appChrome.actions.setButtonSecondaryText(Uh.a.dgd,this.Jkb.oZm));return b}pYo(b){"true"===b?this.xr.execute(h=>{h.logActivity("OptInShyRibbonNormalScreenActivity",null)}):"false"!==b&&""!==b||!(1300>
window.innerWidth||700>window.innerHeight)||this.xr.execute(h=>{h.logActivity("NonOptInShyRibbonSmallScreenActivity",null)});document.addEventListener("ShyRibbonSmallScreenActivity",()=>{requestAnimationFrame(()=>setTimeout(()=>{var h;null===(h=document.getElementById("RibbonModeToggle"))||void 0===h?void 0:h.click()},0))},!1);y.AFrameworkApplication.va.fb(Ka.a.bQh,we.a.frame,this.U2k,96)}pQi(){y.AFrameworkApplication.dtc.qop();this.oLh();this.dlf();this.jQi();zl.a.get_instance().hK(7);vg.a.instance.F$(Jh.a.pSc,
Jh.a.Oug,(new Date).getTime());y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)&&this.k$b&&this.k$b.A5m(cu.a.$Tj)}$Oa(b){if(b){const h=this.Fxi();try{super.$Oa(b)}finally{null===h||void 0===h?void 0:h.dispose()}}}tKa(){const b=this.Fxi();try{return super.tKa()}finally{null===b||void 0===b?void 0:b.dispose()}}Fxi(){var b;let h=void 0;const r=null===(b=df.a.gf)||void 0===b?void 0:b.Ll;r&&(h=new Rb.GraphTransaction(df.a.dWi()&&df.a.pYf?0:
2),h.set(r));return h}}Object(u.a)(rI,"ReactRibbonUser",yK,[]);class fO extends tz{constructor(b,h,r,A,M,aa,oa,Ja){super(b,h,r);this.OWe=y.AFrameworkApplication.J.$("PasteWithOptionsFromRibbon")&&Y.a.u7;this.vl=M;this.B4e=aa;this.Gb=oa;this.gSe=Ja}nHl(b,h){const r=new yy(y.AFrameworkApplication.J,this.ga,this.Yb,this.OWe),A=new hI.a(r);return this.NHl(b,h,A,r)}NHl(b,h,r,A){var M=new ED(new yF(y.AFrameworkApplication.J,A),r);r=this.f5m(M);const aa={};M.lyb(aa);M=!Y.a.u7;const oa=Y.a.Pr||Y.a.uj;var Ja=
Y.a.Qm;y.AFrameworkApplication.J.$("CcpFixIPadShortcutStringsIsEnabled")&&(Ja=Y.a.Ci||Ja);Ja=new VD.a(Ja);b=new rI(b,h,WordEditorIntl.WordEditorStrings,this.ADb,A,b,this.vl,r,new gI(aa),this.B4e,Ja,M,oa,new lg,this.Gb,this.gSe);b.K5m();return b}f5m(b){const h={};b.Wmd(h);b.Ksd(h);return new uA(null,h,"jewelWordEditor")}}Object(u.a)(fO,"WordEditorRibbonUserFactory",tz,[]);class FM{constructor(b,h){this.vB=b;this.SGd=h}XUa(b,h,r,A=null,M=null){return this.SGd.PQj(b)?this.SGd.XUa(b,h,r,A,M):this.vB.XUa(b,
h,r,A,M)}BLa(b,h=null){return this.SGd.PQj(b)?this.SGd.BLa(b):this.vB.BLa(b,h)}}Object(u.a)(FM,"RootCuiUser",null,[218]);class gO extends FM{constructor(b,h){super(b,h)}clearCache(){this.vB.clearCache()}}Object(u.a)(gO,"WordGeneralCuiUser",FM,[217,218]);var aP=d(1341);class FL{static getSelectedText(){const b=(new Xr.a).DMf();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static K7d(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=I.a.VA(b,h)?h-1:h),b=b.length>h?b.substr(0,
h).trim()+"...":b);return b}}Object(u.a)(FL,"SearchUtils",null,[]);class Ku extends Mx{constructor(b,h,r){super(b,r);this.rK=h}pFf(b){const h=[];var r=gg.a.instance.gb.currentSelection;const A=!!this.rK&&this.rK.W9c(ub.a.Wmf.toString()),M=!!this.rK&&this.rK.W9c(ub.a.fYb.toString()),aa=!A&&!r.WWa&&Ku.Bdb.Vbj(),oa=!(y.AFrameworkApplication.fv&&Ku.MXi)&&(!!this.rK&&this.rK.W9c(Ka.a.hMa.toString())||!!my.a.instance&&(3===my.a.instance.mode||2===my.a.instance.mode)),Ja=r.q0i()&&y.AFrameworkApplication.ua.Ib.P9c;
var fb=!1;if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",!1)){fb=!!r&&(r.fw||2===r.length&&ze.a.ll(r.Wc));var Cb=FL.getSelectedText();fb=fb&&0<Cb.length&&60>Cb.length}b=(Cb=3===b||Y.a.Ci||y.AFrameworkApplication.bEf)&&Ku.xyf.U2(r,b);r=Ku.MXi&&r&&1===r.length&&r.K(0).contextId===lc.a.Xc;Cb&&h.push(this.vl.MAa("ClipboardGroup")[0].externalUxGroupId);aa&&(h.push(this.vl.MAa("TextFormattingGroup")[0].externalUxGroupId),
h.push(this.vl.MAa("StylesGroup")[0].externalUxGroupId));fb&&h.push(this.vl.MAa("DefineGroup")[0].externalUxGroupId);A&&h.push(this.vl.MAa("PictureToolsGroup")[0].externalUxGroupId);M&&h.push(this.vl.MAa("TableToolsGroup")[0].externalUxGroupId);Ja&&h.push(this.vl.MAa("EquationToolsGroup")[0].externalUxGroupId);oa&&h.push(this.vl.MAa("CommentGroup")[0].externalUxGroupId);r&&h.push(this.vl.MAa("ContentAssemblyGroup")[0].externalUxGroupId);b&&h.push(this.vl.MAa("ContextMenuGroup")[0].externalUxGroupId);
aP.a.MUi&&Ku.oen&&h.push(this.vl.MAa("DesignerGroup")[0].externalUxGroupId);return h}static get xyf(){return null!=Ku.hUg?Ku.hUg:Ku.hUg=Za.a.instance.resolve(1056)}static get Bdb(){return null!=Ku.t2g?Ku.t2g:Ku.t2g=Za.a.instance.resolve(123)}static O6c(b,h,r,A){b.tal(()=>Ku.qnb(h,r,A))}static qnb(b,h,r){return new Ku(b,h,r)}static get oen(){null===this.KVe&&(y.AFrameworkApplication.vd("DesignerInContextMenuConsumerExp;DesignerInContextMenuConsumerExpCf"),this.KVe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerInContextMenuConsumerExpIsEnabled",
!1):!1);return this.KVe}static get MXi(){null!==this.rWe||"Templatization"!==y.AFrameworkApplication.fv&&"ContentAssemblyEdit"!==y.AFrameworkApplication.fv||(y.AFrameworkApplication.vd("insertSnippetTreatment;insertSnippetControl"),this.rWe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertSnippetActionForCA",!1):!1);return this.rWe}}Ku.KVe=null;Ku.rWe=null;Object(u.a)(Ku,"WordReactFloatie",Mx,[]);class GL{constructor(){this.gia=this.vPc=
this.W=null}get name(){return"WordEditor.UI"}init(){var b;this.W.resolve(1073).sjg();const h=df.a.GC.WK,r=qa.StaticActiveAppFrame.za();Ku.O6c(r,this.W.resolve(728),h,this.W.resolve(663));this.gia=this.W.Oa(31);const A=new WI(r,h,this.W.Ra(708),this.W.resolve(894)),M={"floatie.gbFormatWithDesignerButton":!0,"floatie.gbMatchDocumentFormattingButton":!0,"floatie.gbUseSmartPasteButton":!0};switch(null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",
0)){case 1:M["floatie.gbFormatWithDesignerButton"]=!1;break;case 2:M["floatie.gbMatchDocumentFormattingButton"]=!1;break;case 3:M["floatie.gbUseSmartPasteButton"]=!1}A.O6c("PasteFloatieData",null,M);this.W.resolve(1074).initialize();(new mu(r,h,this.W.Ra(708),this.W.resolve(1075))).O6c("ExternalContentFloatieData",[WordEditorIntl.WordEditorStrings],{});this.W.resolve(708);zl.a.get_instance().Tk(7,()=>{this.vPc=this.W.resolve(1076);this.vPc.Xb()})}dispose(){this.vPc&&(this.vPc.dispose(),this.vPc=null);
this.gia&&(this.gia.dispose(),this.gia=null)}uc(b){this.W=b;b.ia(1073,()=>new Xh(b.resolve(445),b.resolve(811),y.AFrameworkApplication.va,y.AFrameworkApplication.J)).as(675).as(426).as(53).ha();let h=Y.a.Qm;y.AFrameworkApplication.J.$("CcpFixIPadShortcutStringsIsEnabled")&&(h=Y.a.Ci||h);b.ia(1083,()=>new VD.a(h));const r=Y.a.Pr||Y.a.uj,A=y.AFrameworkApplication.J.$("PasteWithOptionsFromContextMenu")&&(Y.a.u7||r),M=y.AFrameworkApplication.J.$("CatchUpActivityIsEnabled");b.ia(920,()=>new ev(Za.a.instance.resolve(345),
Za.a.instance.resolve(733),new Td.a)).ha();b.ia(643,()=>new mp(y.AFrameworkApplication.va,b.resolve(1077),b.resolve(43),y.AFrameworkApplication.J,b.resolve(180).instance,b.resolve(46).instance,M?b.Ra(856).instance:null,b.resolve(41),b.resolve(331),b.Oa(733),b.resolve(1078),b.resolve(1079),b.Ra(1080),b.Ra(4),b.Ra(1081),b.resolve(1082),b.resolve(864),b.resolve(928),A,r?b.resolve(1083):null,Za.a.instance.Ra(5),Za.a.instance.resolve(920),b.resolve(164),b.resolve(927),b.Oa(1084))).as(1056).ha();b.ia(123,
()=>new Pu).ha();b.ia(1074,()=>new gl(y.AFrameworkApplication.J)).as(826).ha();b.ia("WordEditor.UI.DialogFactory",()=>new bw).as(1061).as(1065).ha();b.ia("Common.NonCanvasCuiUser",()=>new qt(Cd.FocusManager.instance())).as(1085).ha();b.ia(1086,()=>new gO(b.resolve(708),b.resolve(1085))).ha();b.resolve(1086);b.ia(1076,()=>new Ju(qa.StaticActiveAppFrame.za().vEg,b.Ra(708),b.resolve(12),y.AFrameworkApplication.va,y.AFrameworkApplication.J,qa.StaticActiveAppFrame.za())).as(584).ha();const aa=b.resolve(1086);
b.ia(1087,()=>new zD(rw.instance,b.resolve(663),aa)).ha();const oa=b.Ra(1086);b.ia("WordEditor.UI.WordEditorRibbonUserFactory",()=>new fO(oa,y.AFrameworkApplication.va,Cd.FocusManager.instance(),b.resolve(892),b.resolve(663),b.resolve(1087),y.AFrameworkApplication.oc,b.Ra(1088))).as(450).ha();b.ia("WordEditor.UI.ReactLanguageDialog",()=>new jq(b.resolve(1089),b.resolve(1090))).as(918);b.ia("WordEditor.UI.WordEditorRibbonSQMInformation",()=>new xF(y.AFrameworkApplication.va)).as(1070).ha();b.ia("WordEditor.UI.WordEditorFileMenuSQMInformation",
()=>new xy(y.AFrameworkApplication.va)).as(1071).ha();b.ia("WordEditor.UI.RulerUser",()=>new CD).as(703);b.ia("WordEditor.UI.RulerContextMenu",()=>new ru(y.AFrameworkApplication.va,Za.a.instance.Ra(6),mt.a.instance)).as(1025).ha();b.ia(728,()=>new bI(b.resolve(1087),b.resolve(663))).ha();b.ia(31,()=>new UD(b.resolve(728))).ha()}static main(){y.AFrameworkApplication.vd("5b6i5792;30d4f535");oi.instance.bii();oi.instance.mzf();K.a.instance.Lc(new GL,6)}}Object(u.a)(GL,"WordEditorUIPackage",null,[0,1]);
var HL=window.ExternalContentFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.ExternalContentFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"ExternalContentOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},
children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"ExternalContentFloatie.FlyoutAnchor",LabelText:"STR@L_DisplayAs",Image16by16:"IMAGEPATH@DisplayAs.png",Alt:"STR@L_DisplayAs",DisplayMode:"Medium",TemplateAlias:"ExternalContent"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msExternalContentOptionsButtons",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",
attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0xE188C0F7",QueryCommand:"0xD46B64BD",Image16by16:"IMAGEPATH@EmbeddedContent.png",Alt:"STR@L_EmbeddedContent",LabelText:"STR@L_EmbeddedContent"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0xE36ACF00",QueryCommand:"0xB5FF507C",Image16by16:"IMGMAP@we@WebInsertHyperlink_16x16x32",Alt:"STR@L_Hyperlink",LabelText:"STR@L_Hyperlink"}}]}]}]}]}]}]}]}]}]}]}]},tv={};tv.oBc=function(){function b(){return oa()&&(Yc()||3<=(Sb()?
Kd("version/"):0))}function h(){return 0<=window.navigator.userAgent.indexOf("Windows")}function r(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function A(Vf){Vf=(new RegExp(Vf+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var Ki=-1;null!=Vf&&2<=Vf.length&&(Ki=parseFloat(Vf[1]),isNaN(Ki)&&(Ki=-1));return Ki}function M(){xM||(xM=!0,AL=A("Windows Phone"));return 8<=AL}function aa(){return"function"==typeof navigator.msLaunchUri&&!r()&&!zc()&&!Ja()}function oa(){return 0<=
window.navigator.userAgent.indexOf("Macintosh")}function Ja(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function fb(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function Cb(){return fb()?8==window.document.documentMode:!1}function Gb(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function Sb(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function pc(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}
function zc(){var Vf=window.navigator.userAgent.toLowerCase();return 0<=Vf.indexOf("android")&&0<=Vf.indexOf("chrome")}function Yc(){return 3<=(Gb()?Kd("firefox/"):0)}function Kd(Vf){var Ki=window.navigator.userAgent.toLowerCase(),Zj=Ki.indexOf(Vf);return 0<=Zj?parseInt(Ki.substring(Zj+Vf.length,Ki.length)):0}function ke(Vf,Ki,Zj,Pk,xo){if(Pk&&null!=Ki)Ki();else if(aa())navigator.msLaunchUri(Vf,Ki,Zj);else if(!(pc()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||
0<navigator.maxTouchPoints&&oa())||Ja())de(Vf,Ki,Zj);else if(pc()&&xo)a:{try{window.open(Vf,"_self")}catch(xr){null!=Zj&&Zj();break a}null!=Ki&&Ki()}else ge(Vf,Ki,Zj)}function ge(Vf,Ki,Zj){var Pk=document.getElementById("OICLinkTag");null==Pk&&(Pk=document.createElement("a"),Pk.id="OICLinkTag",Pk.style.visibility="hidden",Pk.href="",0==(xp.Options&aw.SupportsTopTargetNavigation)||xp.NoBrowserModalDialogs?Pk.target="_blank":Pk.target="_top",document.body.appendChild(Pk),null!=Pk.addEventListener&&
Pk.addEventListener("click",function(xo){null!=xo.stopPropagation&&xo.stopPropagation()},!1));try{Pk.href=Vf,Pk.dispatchEvent(new MouseEvent("click"))}catch(xo){null!=Zj&&Zj();return}null!=Ki&&Ki()}function de(Vf,Ki,Zj){var Pk=document.getElementById("OICFrame");null==Pk&&(Pk=document.createElement("iframe"),Pk.className="ObjectInDialog",Pk.style.visibility="hidden",Pk.src="about:blank",document.body.appendChild(Pk),Pk.id="OICFrame");try{Pk.contentWindow.location.href=Vf}catch(xo){null!=Zj&&Zj();
return}null!=Ki&&Ki()}function Sd(Vf){return 0!=(Vf.Options&aw.SkipProtocolHandler)||Cb()}function be(Vf){return Vf===rA.ReadOnly||Vf===rA.ReadWrite}function Rf(Vf,Ki,Zj,Pk){var xo;try{var xr=new ActiveXObject("SharePoint.OpenDocuments.4");return(xo=xr.ViewDocument3(window.self,Vf,Ki,Pk))?(uD(oz.O14ActiveX),hp.None):hp.Failed}catch(Wq){}if(aw.O14Only===(Zj&aw.O14Only))return xp.DescriptiveUnattemptedEnums?hp.O14AttemptFailure:hp.Unattempted;try{return xr=new ActiveXObject("SharePoint.OpenDocuments.3"),
(xo=xr.ViewDocument3(window.self,Vf,Ki,Pk))?(uD(oz.O12ActiveX),hp.None):hp.Failed}catch(Wq){}if(aw.O12UpOnly===(Zj&aw.O12UpOnly))return xp.DescriptiveUnattemptedEnums?hp.O12UpOnlyFail:hp.Unattempted;try{return xr=new ActiveXObject("SharePoint.OpenDocuments.2"),(xo=be(Ki)?xr.ViewDocument2(window.self,Vf,Pk):xr.EditDocument2(window.self,Vf,Pk))?(uD(oz.O11ActiveX),hp.None):hp.Failed}catch(Wq){}return xp.DescriptiveUnattemptedEnums?hp.ActiveXUnattempted:hp.Unattempted}function Mf(Vf,Ki,Zj,Pk,xo){Vf==
Xp.Visio&&Zj==rA.ReadWrite&&(Zj=rA.WriteOnly);Pk=Pk||r()&&!M();if(!Pk){Pk="";if(Vf==Xp.PowerPoint){Vf=Pk;Pk=xp.DocumentExtension;Zj=be(Zj);var xr=new Set([".pot",".potm",".potx"]),Wq=new Set([".pps",".ppsm",".ppsx"]);Zj=Zj&&xr.has(Pk)?"nft|ofc|":Zj&&Wq.has(Pk)?"ofv|ofs|t|":!Zj&&Wq.has(Pk)?"ofe|ofs|t|":Zj?"ofv|ofc|":"ofe|";Zj=Vf+Zj}else Zj=be(Zj)?Pk+"ofv|ofc|":Pk+"ofe|";Pk=Zj;xp.NewTelemetryDataIsEnabled&&(Zj=xp.SessionOrigin?"or|"+xp.SessionOrigin+"|":"",Zj+=xp.ClickTime?"ct|"+xp.ClickTime+"|":"",
Zj+=xp.CorrelationId?"cid|"+xp.CorrelationId+"|":"",Pk+=Ji(Zj));xo+=Ji(Pk+"u|")}xo+=Ji(Ki);Ki=window.location.href;Zj=Ki.toLowerCase().indexOf("&wdlor=");-1!=Zj?(Zj+=7,Vf=Ki.indexOf("&",Zj),Ki=-1==Vf?Ki.substr(Zj):Ki.substring(Zj,Vf)):Ki=void 0;if(null!=Ki&&"undefined"!=typeof Ki){Zj="";try{Zj=decodeURIComponent(Ki)}catch(yD){}0<Zj.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Zj)&&(xo=xo+"|f|"+Zj)}return xo}function Yj(Vf,Ki,Zj,Pk,xo,xr){var Wq=oK(Vf);if(null==Wq)return vD(xp.DescriptiveUnattemptedEnums?
hp.ProtocolHandlerIsNull:hp.Unattempted,xp.Application),!1;Vf=Mf(Vf,Ki,Zj,Pk,Wq);ke(Vf,sm,jn,xo,xr);return!0}function Ji(Vf){if(oa()&&pc()){var Ki="";try{Ki=decodeURI(Vf)}catch(Zj){}if(Ki==Vf)return encodeURI(Vf)}return Vf}function sm(){uD(oz.ProtocolHandler)}function jn(){xp.Options|=aw.SkipProtocolHandler;pK(xp,wD,xD)}function js(){null!=ZH&&ZH(oz.RoamingProtocolHandler)}function uy(){null!=tK&&tK(hp.ControlNeeded)}function nz(){var Vf=document.getElementById("npSharePointPlugin");if(null==Vf){Vf=
"application/x-sharepoint";oa()&&3<=(Sb()?Kd("version/"):0)&&qA("application/x-sharepoint-webkit",!0)&&(Vf="application/x-sharepoint-webkit");if(!qA(Vf,!0))if(oa()&&qA("application/officelive",!0))Vf="application/officelive";else return null;var Ki=document.createElement("object");Ki.id="npSharePointPlugin";Ki.type=Vf;Ki.style.width="0px";Ki.style.height="0px";Ki.style.setProperty("visibility","hidden","");document.body.appendChild(Ki);Vf=document.getElementById("npSharePointPlugin")}return Vf}function qA(Vf,
Ki){var Zj=window.navigator.mimeTypes;if(null==Zj)return!1;Vf=Zj[Vf];return!Vf||Ki&&!Vf.enabledPlugin?!1:!0}function oF(Vf){try{if(null!=new ActiveXObject(Vf))return!0}catch(Ki){}return!1}function YH(Vf){switch(Vf){case Xp.OneNote:return"OneNote.Notebook";default:return""}}function oK(Vf){if(Vf!=Xp.OneNote&&r()&&!M())return"office:";switch(Vf){case Xp.Excel:return"ms-excel:";case Xp.OneNote:return"onenote:";case Xp.PowerPoint:return"ms-powerpoint:";case Xp.Visio:return"ms-visio:";case Xp.Word:return"ms-word:";
case Xp.Project:return"ms-project:";case Xp.Publisher:return"ms-publisher:";case Xp.Infopath:return"ms-infopath:";case Xp.Access:return"ms-access:";default:return""}}function uM(Vf){switch(Vf){case Xp.Excel:return"root\\office15\\excel.exe";case Xp.PowerPoint:return"root\\office15\\powerpnt.exe";case Xp.Visio:return"root\\office15\\visio.exe";case Xp.Word:return"root\\office15\\winword.exe";case Xp.Project:return"root\\office15\\winproj.exe";case Xp.Publisher:return"root\\office15\\mspub.exe";case Xp.Infopath:return"root\\office15\\infopath.exe";
case Xp.Access:return"root\\office15\\msaccess.exe";default:return null}}function pK(Vf,Ki,Zj){xp=Vf;wD=Ki;xD=Zj;if(Vf.DocumentUrl){var Pk=Zj=Ki=Vf.DocumentUrl;try{Pk=decodeURIComponent(Vf.DocumentUrl)}catch(rF){}try{Zj=encodeURI(Vf.DocumentUrl)}catch(rF){}Ki=Ki+""+Vf.CorrelationIdForWinClient;Pk+=Vf.CorrelationIdForWinClient;Zj+=Vf.CorrelationIdForWinClient;Vf.Mode===rA.ReadWrite&&aw.CheckoutRequired===(Vf.Options&aw.CheckoutRequired)&&(Vf.Mode=rA.ForceCheckout);aw.HostIsEditOnly===(Vf.Options&aw.HostIsEditOnly)&&
(Vf.Mode=rA.WriteOnly);if(Sd(Vf)?0:oa()&&(Vf.Application==Xp.OneNote||qA("application/x-sharepoint-protocolhandler",!1)||qA("application/x-sharepoint-webkit-protocolhandler",!1))||aa()||zc()||!(b()||Yc()||"ActiveXObject"in window&&!r()||pc())||15<=pF())Yj(Vf.Application,Vf.EncodeUrl?Zj:Ki,Vf.Mode,Vf.Application==Xp.OneNote,Vf.SilentExternalHandler,Vf.NavigateUsingWindowOpen);else{var xo;if(xo=Cb())a:{var xr=Vf.EncodeUrl?Ki:Pk,Wq=Vf.Mode,yD=YH(Vf.Application);try{xo=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,
xr,Wq,yD);break a}catch(rF){}xo=!1}if(xo)uD(oz.O15ActiveX);else{if(b()||Yc()){var ks=Vf.EncodeUrl?Ki:Pk;Pk=Vf.Mode;xo=YH(Vf.Application);xr=nz();if(null==xr)ks=xp.DescriptiveUnattemptedEnums?hp.PluginIsNull:hp.Unattempted;else{Wq=!1;try{Wq=xr.ViewDocument3(window.self,ks,Pk,xo)}catch(rF){}if(!Wq)try{Wq=be(Pk)?xr.ViewDocument2(window.self,ks,xo):xr.EditDocument2(window.self,ks,xo)}catch(rF){}Wq?(uD(oz.NpapiPlugin),ks=hp.None):ks=hp.Failed}}else{try{ks=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=ks&&
ks.SaveSSOCreds()}catch(rF){}ks=Rf(Vf.EncodeUrl?Ki:Pk,Vf.Mode,Vf.Options,YH(Vf.Application))}if(ks!=hp.None){if(Pk=Vf.CouldUseRoamingApps)vM||(vM=!0,wM=A("Windows NT")),Pk=6.1<=wM&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(fb()||Yc()||pc());if(Pk&&Vf.Application!=Xp.OneNote){if(!tv.oBc.LIp()){vD(hp.ControlNeeded,xp.Application);return}if(Vf.RoamingAppsLauncher){"undefined"==typeof Vf.RoamingAppsLauncher||null==Vf.RoamingAppsLauncher?vD(xp.DescriptiveUnattemptedEnums?hp.RoamingLauncherIsNull:
hp.Unattempted,xp.Application):"undefined"==typeof Vf.RoamingBitsUrl||null==Vf.RoamingBitsUrl?tv.oBc.dLp(Vf.DocumentUrl,Vf.RoamingAppsLauncher,Vf.Application,Vf.ApplicationParameters,wD,xD):tv.oBc.Xek(Vf.DocumentUrl,Vf.RoamingAppsLauncher,Vf.RoamingApplicationExe,Vf.ApplicationParameters,Vf.RoamingPlatform,Vf.RoamingBitsUrl,wD,xD);return}if(!Vf.ContinueIfLauncherIsNull){vD(hp.LauncherNeeded,xp.Application);return}}aw.NoProtocolHandlerFallback==(Vf.Options&aw.NoProtocolHandlerFallback)||Sd(Vf)||fb()||
oa()&&!(xp.DescriptiveUnattemptedEnums?ks>=hp.O14Unattempted&&ks<=hp.DocumentUrlIsNull:ks==hp.Unattempted)?vD(ks,xp.Application):Yj(Vf.Application,Vf.EncodeUrl?Zj:Ki,Vf.Mode,Vf.Application==Xp.OneNote,Vf.SilentExternalHandler,Vf.NavigateUsingWindowOpen)}}}}else vD(xp.DescriptiveUnattemptedEnums?hp.DocumentUrlIsNull:hp.Unattempted,xp.Application)}function uD(Vf){null!=wD&&wD(Vf)}function vD(Vf,Ki){"undefined"==typeof Ki&&(Ki=null);null!=xD&&xD(Vf,Ki)}function pF(){var Vf=0;if(b()||Yc()||pc()){var Ki=
nz();try{null!=Ki&&(Vf=Ki.GetOfficeVersion())}catch(Zj){}}else oF("SharePoint.OpenDocuments.5")?Vf=15:oF("SharePoint.OpenDocuments.4")?Vf=14:oF("SharePoint.OpenDocuments.3")?Vf=12:oF("SharePoint.OpenDocuments.2")&&(Vf=11);return Vf}function zL(){return oa()&&(qA("application/x-sharepoint",!0)||qA("application/x-sharepoint-webkit",!0))}var qK="",rK="",sK="",wD,xD,ZH,tK,xp,vM,wM,xM,AL,rA={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},aw={None:0,CheckoutRequired:1,
O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},hp={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},oz={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,
RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},Xp={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:rA,OpenDocumentOptions:aw,OpenDocumentFailureType:hp,OpenDocumentControl:oz,OfficeApplication:Xp,EditDocumentInClient:pK,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=Xp.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=
!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.DocumentExtension=this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:pF,IsO14MacPluginInstalled:zL,OfferOfficeInDialog:function(){return h()&&11>=pF()},OfferOfficeNoIntrusive:function(){return h()&&
15>pF()},OfferMacOffice:function(){return oa()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!zL()},InstallRoamingControl:function(){Gb()?window.InstallTrigger.install({Office:{URL:rK}}):de(sK,null,null)},CanUseRoamingControl:function(){if(aa())return!0;if(pc())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Gb()){var Vf=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(Vf);
var Ki=document.createEvent("Events");Ki.initEvent("RoamingOfficeInstalled",!0,!1);Vf.dispatchEvent(Ki);return!!Vf.getAttribute("installed")}if(fb())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(Zj){}return!1},InitUrls:function(Vf,Ki,Zj){qK=Vf;rK=Zj;sK=Ki},LaunchRoamingApps:function(Vf,Ki,Zj,Pk,xo,xr){tv.oBc.Xek(Vf,Ki,uM(Zj),Pk,"x86",qK,xo,xr)},LaunchRoamingApps2:function(Vf,Ki,Zj,Pk,xo,xr,Wq,yD){var ks="";null!=Pk&&(ks+=" "+Pk);null!=Vf&&(ks+=' "'+Vf+'"');if(aa()||
pc())ZH=Wq,tK=yD,Wq='office: "'+(xr+'" "')+(Zj+'" "ROAMING"'),Wq+=' "'+Ki+'"',Wq+=' "'+xo+'"',Wq+=" "+ks,ke(Wq,js,uy,!1,!1);else if(Gb())Vf=document.createElement("RoamingExtensionElement"),Vf.setAttribute("cabUrl",xr),Vf.setAttribute("app",Zj),Vf.setAttribute("licensingEntitlements",Ki),Vf.setAttribute("platform",xo),Vf.setAttribute("args",ks),document.documentElement.appendChild(Vf),Ki=document.createEvent("Events"),Ki.initEvent("RoamingOfficeLaunch",!0,!1),Vf.dispatchEvent(Ki),null!=Wq&&Wq(oz.RoamingFFExtension);
else if(fb()){if(Vf=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Vf)try{Vf.HrConfigureSingle(xr,Zj,Ki,xo,ks),null!=Wq&&Wq(oz.RoamingActiveX)}catch(rF){}}else null!=yD&&yD(hp.Failed)},ShouldShowDialog:function(){return!r()},NavigateToUrlUsingClickingOnATag:ge,OpenDocumentWithProtocolHandler:Yj,OpenDocumentWithProtocolHandlerNoCallBack:function(Vf,Ki,Zj,Pk){var xo=oK(Vf);if(null==xo)return vD(xp.DescriptiveUnattemptedEnums?hp.ProtocolHandlerNoCallbackIsNull:hp.Unattempted,xp.Application),
!1;Vf=Mf(Vf,Ki,Zj,Pk,xo);ke(Vf,null,null,!1,!1);return!0}}}();tv.ClientUtils=tv.oBc;var IL=d(1355);class zK{constructor(b,h,r){this.a1n=(A,M,aa,oa,Ja)=>{if(1===aa)return 32;Ja?(A=Ja.SourceControlId,"btnjTryMacOfficeForWordEditor"===A?Le.a.un($a.a.X8a(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===A&&Le.a.un($a.a.X8a(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.H4i();return 32};this.onj=(A,M,aa)=>{if(1===aa)return 32;switch(A){case Ka.a.u2j:Le.a.un($a.a.X8a(15),
"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case Ka.a.t2j:Le.a.un($a.a.X8a(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32};this.ga=b;this.qzk=h;this.Y9=r}Xb(){this.ga.qa(Ka.a.Imp,we.a.frame,this.a1n);this.ga.qa(Ka.a.u2j,we.a.frame,this.onj);this.ga.qa(Ka.a.t2j,we.a.frame,this.onj)}H4i(){Le.a.un(zK.BEn,"_blank",void 0,"LaunchMacTrialWindow")}get qod(){return this.qzk&&Y.a.Qm&&!Y.a.NZf&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get k0o(){const b=this.qod;b||
y.AFrameworkApplication.wn.yOo();return b}get j0o(){return this.qod}static get BEn(){return $a.a.Laa("522401")}}Object(u.a)(zK,"MacOfficeOffer",null,[1880]);class AK{constructor(b,h,r){this.b1n=(A,M,aa,oa,Ja)=>{if(this.OOd&&1===aa)return this.isFreemiumUpsellEnabled&&this.rod?32:8;2===aa&&(Ja?(A=Ja.SourceControlId,"btnjTryOfficeForWordEditor"===A?Le.a.un($a.a.X8a(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===A?Le.a.un($a.a.X8a(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):
this.k2f()):this.k2f());return 32};this.yJg=(A,M,aa,oa,Ja)=>{if(this.OOd&&1===aa)return this.isFreemiumUpsellEnabled&&this.rod?32:8;2===aa&&(Ja?(A=Ja.SourceControlId,Le.a.un($a.a.Laa("862405")+this.jCm(A),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):Le.a.un($a.a.Laa("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32};this.z2j=(A,M,aa)=>{if(this.OOd&&1===aa)return this.isFreemiumUpsellEnabled&&this.rod?32:8;if(2===aa)switch(A){case Ka.a.y2j:Le.a.un($a.a.X8a(14),
"_blank",void 0,"TryOfficeThroughViewer.Word");break;case Ka.a.x2j:Le.a.un($a.a.X8a(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32};this.ga=b;this.xzk=h;this.qK=null;(this.OOd=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&Za.a.instance.Ra(4).execute(A=>{this.qK=A});this.Y9=r}Xb(){this.ga.qa(Ka.a.Ump,we.a.frame,this.b1n);this.ga.qa(Ka.a.yJg,we.a.frame,this.yJg);this.ga.qa(Ka.a.y2j,we.a.frame,this.z2j);
this.ga.qa(Ka.a.x2j,we.a.frame,this.z2j)}get yQn(){return this.rod}get xQn(){return this.rod&&MSOJS.ClientUtils.OfferOfficeInDialog()}get rod(){return this.xzk&&!Y.a.Qm}get isFreemiumUpsellEnabled(){let b=!1;this.qK&&(b=this.qK.isFreemiumUpsellEnabled());return b}k2f(b=null){let h=0;b&&(h=b);Le.a.un(AK.Dvm(h),"_blank",void 0,"LaunchOfficeOffer")}jCm(b){let h=0;switch(b){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":h=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":h=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":h=
3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":h=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":h=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":h=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":h=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":h=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":h=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":h=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":h=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":h=
17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":h=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":h=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":h=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":h=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":h=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":h=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":h=29}return 0===h?"":String.format("&pc={0:D}",h)}static Dvm(b){if(Y.a.Ci)switch(b){case 1:return $a.a.Laa("393806");
case 2:return $a.a.Laa("393810");case 3:return $a.a.Laa("393809");case 5:return $a.a.Laa("393805")}else if(Y.a.rI)switch(b){case 1:return $a.a.Laa("521979");case 3:return $a.a.Laa("521980");case 5:return $a.a.Laa("521978");case 2:return $a.a.Laa("522490")}else{if(2===b)return $a.a.Laa("517778");if(1===b)return $a.a.X8a(30)}return $a.a.Laa("522402")}}Object(u.a)(AK,"OfficeTrialExperience",null,[1879]);class GM{uc(b){b.register(AK,"Common.App.OpenInClient.OfficeTrialExperience").as(120).ha().Sd(()=>
new AK(y.AFrameworkApplication.va,y.AFrameworkApplication.uZf,y.AFrameworkApplication.lcid));b.register(zK,"Common.App.OpenInClient.MacOfficeOffer").as(729).ha().Sd(()=>new zK(y.AFrameworkApplication.va,y.AFrameworkApplication.FYi,y.AFrameworkApplication.lcid))}}Object(u.a)(GM,"OpenInClientConfiguration",null,[1]);class xA{constructor(b=!1,h=!1,r=!1,A=!1,M=!0,aa=!1,oa=!0,Ja=!0,fb=!0,Cb=!1,Gb=!1,Sb=!1,pc=!1,zc=!1,Yc=!1,Kd=!1,ke=!1,ge=!1,de=null,Sd=null,be=null,Rf=null,Mf=null,Yj=null,Ji=null,sm=null,
jn=null){this.fnc=!1;this.oGk=b;this.tGk=h;this.TKk=r;this.RKk=A;this.MKk=M;this.NKk=aa;this.PKk=oa;this.QKk=Ja;this.OKk=fb;this.dLk=Cb;this.xLk=Gb;this.cLk=Sb;this.QMk=pc;this.XKk=zc;this.Cxk=Yc;this.pLk=Kd;this.yLk=ke;this.aok=ge;this.VKk=de;this.bLk=Sd;this.SKk=Mf;this.$Kk=be;this.UKk=Rf;this.ZKk=Yj;this.aLk=Ji;this.WKk=sm;this.YKk=jn}get wqj(){return this.oGk}get y7n(){return this.tGk}get LQj(){return this.TKk}get KQj(){return this.RKk}get t_o(){return this.MKk}get u_o(){return this.NKk}get w_o(){return this.PKk}get x_o(){return this.QKk}get v_o(){return this.OKk}get uyb(){return this.XKk}get p6m(){return this.Cxk}get tRj(){return this.pLk}get URj(){return this.yLk}get Xjl(){return this.aok}get OQj(){return this.dLk}get H1o(){return this.xLk}get G_o(){return this.cLk}get Xbp(){return this.QMk}get MQj(){return this.VKk||
Object(E.a)(this,this.gvc,"returnFalse")}get F_o(){return this.bLk||Object(E.a)(this,this.gvc,"returnFalse")}get E_o(){return this.$Kk||Object(E.a)(this,this.yug,"returnTrue")}get z_o(){return this.UKk||Object(E.a)(this,this.yug,"returnTrue")}get y_o(){return this.SKk||Object(E.a)(this,this.gvc,"returnFalse")}get D_o(){return this.ZKk||Object(E.a)(this,this.yug,"returnTrue")}get NQj(){return this.aLk||Object(E.a)(this,this.gvc,"returnFalse")}get A_o(){return this.WKk||Object(E.a)(this,this.gvc,"returnFalse")}get C_o(){return this.YKk||
Object(E.a)(this,this.gvc,"returnFalse")}yug(){return!0}gvc(){return!1}}Object(u.a)(xA,"HtmlTranslatorSettings",null,[513]);class By{constructor(b,h,r,A,M,aa,oa){this.rg=b;this.Fg=h;this.SZ=r;this.vBf=A;this.Mj=M;this.Od=aa;this.CF=oa}E7m(b,h){var r;b=h.view;h=h.Ik;if(!h||!this.rg.nWi(h,!0)||this.vBf&&this.vBf.instance&&this.vBf.instance.sX(h))return 2;var A=By.reb?!By.X2.QBa(h):!0;this.SZ&&A&&this.SZ.Uzc(h.node,cf.a.Nu,h.cpBegin);A=h.node;(null===(r=this.CF)||void 0===r?0:r.replaceText)&&this.CF.doc(A)?
(r=A.ra.H7a(h.cpBegin),this.CF.replaceText(A,r,r,am.a.Lad)):this.Fg.yla(h,M=>new am.a(M));if(this.Od.Lg){r=new Rb.GraphTransaction(15);try{r.Bb(h.node),this.Mj.sna(h.node,h.cpBegin,h.cpBegin+1,1)}finally{r&&r.dispose()}}A=h.node;r=h.cpEnd+1;" "===Gd.ParagraphReader.text(A).charAt(r)&&(A=wc.a.createTextRange(A,r,r+1),this.Fg.Ve(A,"\u00a0"));h=wc.a.Tc(h.node,r);b.mb.Kc(sc.SelectionFactory.Qo(h));return 32}static get X2(){return null!=By.iXg?By.iXg:By.iXg=Za.a.instance.resolve(242)}static get reb(){null==
By.$pa&&(By.$pa=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("SplitHyperlinkFixWithEnterIsEnabled"):!1);return By.$pa}}By.$pa=null;Object(u.a)(By,"InsertLineBreakStrategy",null,[]);class uv{static get gg(){return null!=uv.C0g?uv.C0g:uv.C0g=Za.a.instance.resolve(18)}static get Mj(){return null!=uv.t4g?uv.t4g:uv.t4g=Za.a.instance.resolve(39).instance}static get Od(){return null!=uv.X4g?uv.X4g:uv.X4g=Za.a.instance.resolve(46).instance}static e8m(b,h,r,A,M){if(M&&M.hasProperty(pd.a.targetObject)){var aa=
h.view.od.Ic.Eb(M.getValue(pd.a.targetObject));aa=wc.a.create(aa)}else aa=Object(Al.a)().wW(h.Ik,11);if(!aa)return 8;b=y.AFrameworkApplication.va.Nf(aa,b,r,!0,A,M);if(32===b&&2===r){if(!h.view.te)return 2;h=h.view;A=h.mb.Mg;if(A=Object(Al.a)().wW(A,11)){r=new xm.a;r.set(A.node);r.Kd();if(M&&M.hasProperty(pd.a.targetObject))for(M=M.wf(pd.a.targetObject);!r.currentNode.id.equals(M)&&r.rc()&&(Bb.OutlineElementNavigator.je(r),11===r.mf););Bb.OutlineElementNavigator.z3(r,!1,!1);M=ze.a.JJa(r,!0);M=Gd.ParagraphReader.xu(M)?
sc.SelectionFactory.ue(M,0):sc.SelectionFactory.Gr(M);h.mb.Kc(M)}}return b}static bbe(b,h,r,A,M){b=b===ub.a.j7c;h=h.node;if(M&&M.hasProperty(pd.a.targetObject)&&!h.id.equals(M.wf(pd.a.targetObject)))return 2;if(1===r)return 32;r=new vd.a;r.set(h);r.vb(10);uv.gg.SA(r,b,!0);uv.Od.Lg&&(r=Bb.OutlineElementNavigator.Me(r),uv.Mj.M_b(r,1));return 32}}Object(u.a)(uv,"InsertOutlineElementStrategy",null,[]);class BK{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb){this.oRi=(Sb,pc,zc)=>{var Yc,Kd;if(null===(Yc=this.lda)||
void 0===Yc?0:Yc.cEa)return this.lda.cEa(zc,pc.cpBegin,{Fb:pc.Fb,Tb:pc.Tb});Yc=!pc.cpBegin;zc=pc.cpBegin===Gd.ParagraphReader.textLength(zc);const ke=!(null===(Kd=Of.a.ud())||void 0===Kd||!Kd.Co);let ge=!0;ke&&Yc&&!zc?(ge=!1,Kd=new vd.a,Kd.hd(Sb),Kd.Kd(),this.Oh.SA(Kd,!0,!1)):Kd=this.Oh.Vsa(Sb);this.Oh.xca(Sb,Kd,pc,!1,!0,ge,!1,!0);!ke||Yc||zc||(Sb=Object(Al.a)().K4d(pc),Of.a.ud().Ak.xG(Sb));return Kd};this.X0=h;this.Ask=b;this.pB=aa;this.EBk=M;this.Oh=r;this.xqk=A;this.xl=oa;this.hb=Ja;this.sG=fb;
this.sEc=Cb;this.lda=Gb}mNn(b,h,r,A,M){if(!h.view.te)return 2;h=h.view;let aa=null;h.gj&&(aa=h);const oa=h.mb.Mg;var Ja=!0;let fb=!1,Cb=null;if(!oa)return 2;const Gb=new Rb.GraphTransaction(15);Gb.Bb(h.od);let Sb=null;2===r&&(Sb=new xm.a,Sb.set(oa.node),Sb.Kd(),Cb=new rn.a(Sb),Bb.OutlineElementNavigator.je(Sb),Ja=Db.OutlineElementReader.isEmpty(Sb,!1),{dRj:Ja,O$j:fb}=this.xqk.eRj(Sb,Ja,Rj.a.UPb,-1,oa));b=y.AFrameworkApplication.va.Nf(oa,b,r,!1,A,M);Ja&&32===b&&2===r&&(fb||Bb.OutlineElementNavigator.fMa(Sb,
!1,!ze.a.pf(oa),!1),fb&&Cb&&Cb.restore(Sb),this.pB.freeze(),(r=sc.SelectionFactory.hp(Sb.currentNode,!0))||v.ULS.sendTraceTag(591958035,324,15,"could not create selection for NewLineView."),h.mb.Kc(r),this.pB.yOa(),this.Ask.Yg.pI());aa&&(Ja||aa.Z3(),aa.Le&&aa.tX&&(aa.Le.iK=!0));zz.GrippersManager.instance.g2b(1);Gb.dispose();return b}oE(b,h,r){b=!1;if(Uc.ImageReader.t7(h)||Uc.ImageReader.A$a(h))h=this.ezl(h),b=!0;const A=h;if((h=ze.a.pf(h))&&this.xl.Mh&&!this.xl.fkn(A))return 2;if(1===r)return 32;
const M=A.node,aa=new vd.a;aa.set(M);aa.Kd();Bb.OutlineElementNavigator.je(aa);r=new Rb.GraphTransaction(15);r.mu(aa);h?(this.sEc.instance&&this.sEc.instance.OOa(A),Gd.ParagraphReader.Vb(M)&&A.cpBegin===Gd.ParagraphReader.textLength(M)&&cn.m(A)&&9===Gd.ParagraphReader.PVa(M)&&this.pB.cAl(A),of.ListItemReader.Cg(aa)?this.EBk.execute(aa,A,M,this.oRi):this.oRi(aa,A,M),this.X0&&this.X0.Uzc(M,cf.a.Nu,A.cpBegin),b&&(Bb.OutlineElementNavigator.Zs(aa,!1,!1),b=aa.Ub(2),(b=this.sG.ue(b,0))&&this.hb.Kc(b))):
this.Oh.SA(aa,!0,!0);r.dispose();qa.StaticActiveAppFrame.za()&&qa.StaticActiveAppFrame.za().Fe();return 32}ezl(b){if(Uc.ImageReader.t7(b))var h=wc.a.Tc(b.node,b.cpBegin);else{h=Gd.ParagraphReader.OT(b.node);var r=h.properties.wf(Mc.a.Gq);b=b.node.properties.getValue(Mc.a.runId);r=BK.sHf(b,r,h.ra);h=wc.a.Tc(h,r)}return h}static FCf(b,h){let r=0;for(;r<h.length&&!(b<h[r]);)r++;return r}static sHf(b,h,r){let A=0;b=BK.FCf(b,h);let M=0;if(b===h.length)M=r.length-1;else for(;M<r.length;){h=r.K(M);if(h.formatting&&
h.formatting.pe===b)break;M++}M<r.length&&(A=r.K(M).cp);return A}}Object(u.a)(BK,"NewLineStrategy",null,[]);class GD{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc,zc,Yc,Kd){this.An=null;this.qqa=b;this.Yzd=oa;this.LGd=new BK(this,h,r,A,M,aa,Ja,Gb,Sb,Yc,Kd);this.Ilh=new By(Ja,fb,h,Cb,pc,zc,Kd)}get Yg(){return this.An||(this.An=this.qqa())}Xb(){const b=y.AFrameworkApplication.va,h=Object(E.a)(this.LGd,this.LGd.oE,"newLine");b.fb(ub.a.enter,lc.a.view,Object(E.a)(this.Yzd.value,this.Yzd.value.$_l,"enterView"),
1124);b.fb(ub.a.mQj,lc.a.view,Object(E.a)(this.Yzd.value,this.Yzd.value.eZo,"shiftEnterView"),1124);b.qa(ub.a.oE,lc.a.view,Object(E.a)(this.LGd,this.LGd.mNn,"newLineView"));b.qa(ub.a.oE,lc.a.Xc,h);b.qa(ub.a.oE,lc.a.image,h);b.qa(ub.a.oE,lc.a.Cd,h);b.qa(ub.a.oE,lc.a.I$,h);b.qa(ub.a.oE,lc.a.Pob,h);b.qa(ub.a.oE,lc.a.V6c,h);b.qa(ub.a.oE,lc.a.paragraph,h);b.qa(ub.a.oE,lc.a.SJ,h);b.qa(ub.a.oE,lc.a.XOa,h);b.Pc(ub.a.oE,1124);b.fb(ub.a.f7c,lc.a.view,Object(E.a)(this.Ilh,this.Ilh.E7m,"insertLineBreakView"),
1028);b.qa(ub.a.j7c,lc.a.view,uv.e8m);b.qa(ub.a.j7c,lc.a.bS,uv.bbe);b.Pc(ub.a.j7c,1092)}static get instance(){return null!=GD.kYg?GD.kYg:GD.kYg=GD.Pm()}static Pm(){return new GD(()=>Za.a.instance.resolve(50),Za.a.instance.Oa(70),Za.a.instance.resolve(18),Za.a.instance.resolve(1091),Za.a.instance.resolve(1092),Za.a.instance.resolve(106),Za.a.instance.rf(1093),re.a.instance,Za.a.instance.resolve(322),Za.a.instance.Ra(51),gg.a.instance,Za.a.instance.resolve(868),Za.a.instance.resolve(39).instance,Za.a.instance.resolve(46).instance,
Za.a.instance.Ra(87),Za.a.instance.resolve(86))}}Object(u.a)(GD,"EnterActor",null,[]);var JL=d(1257),KL=d(583);class Kk{static get nl(){return null!=Kk.k1g?Kk.k1g:Kk.k1g=Za.a.instance.resolve(348)}static get D8(){return null!=Kk.T2g?Kk.T2g:Kk.T2g=Za.a.instance.Oa(825)}static get Vyb(){return null!=Kk.e3g?Kk.e3g:Kk.e3g=Za.a.instance.Oa(8)}static get Qab(){return null!=Kk.w_g?Kk.w_g:Kk.w_g=Za.a.instance.Oa(384)}static get Mj(){return null!=Kk.B4g?Kk.B4g:Kk.B4g=Za.a.instance.Oa(381)}static get Od(){return null!=
Kk.b5g?Kk.b5g:Kk.b5g=Za.a.instance.Oa(262)}static Xb(){const b=y.AFrameworkApplication.va;b.qa(ub.a.Z2f,lc.a.view,Jn.a.qx);b.Pc(ub.a.Z2f,1028);b.qa(ub.a.GE,lc.a.view,Jn.a.qx);b.qa(ub.a.GE,lc.a.paragraph,Kk.WRd);b.Pc(ub.a.GE,1036);b.qa(ub.a.mwc,lc.a.paragraph,Kk.s5k);b.qa(ub.a.mwc,lc.a.view,Jn.a.qx);b.Pc(ub.a.mwc,1036);b.qa(ub.a.Ymd,lc.a.paragraph,Kk.Chf);b.qa(ub.a.Ymd,lc.a.view,Jn.a.qx);b.qa(ub.a.Rnd,lc.a.paragraph,Kk.Yhf);b.qa(ub.a.Rnd,lc.a.view,Jn.a.qx);b.qa(ub.a.Xmd,lc.a.paragraph,Kk.Bhf);b.qa(ub.a.Xmd,
lc.a.view,Jn.a.qx);b.qa(ub.a.sef,lc.a.view,Kk.M0k);b.Pc(ub.a.sef,1036);b.qa(ub.a.xrg,lc.a.view,Kk.Byo);b.Pc(ub.a.xrg,1036);b.qa(ub.a.qef,lc.a.view,Kk.L0k);b.Pc(ub.a.qef,1036);b.qa(ub.a.wrg,lc.a.view,Kk.Ayo);b.Pc(ub.a.wrg,1036);b.qa(ub.a.n_a,lc.a.view,Jn.a.qx);b.qa(ub.a.n_a,lc.a.paragraph,Kk.WRd);b.Pc(ub.a.n_a,1036);b.qa(ub.a.m_a,lc.a.view,Jn.a.qx);b.qa(ub.a.m_a,lc.a.paragraph,Kk.WRd);b.Pc(ub.a.m_a,1036);b.qa(ub.a.Ize,lc.a.view,Kk.Hze);b.qa(ub.a.Ize,lc.a.paragraph,Kk.Hze);b.Pc(ub.a.Ize,1028);b.qa(ub.a.MDg,
lc.a.view,Kk.Hze);b.qa(ub.a.MDg,lc.a.paragraph,Kk.Hze);b.Pc(ub.a.MDg,1028);b.qa(ub.a.Aze,lc.a.view,Jn.a.qx);b.qa(ub.a.Aze,lc.a.paragraph,Kk.iSh);b.Pc(ub.a.Aze,1028);b.qa(ub.a.zze,lc.a.view,Jn.a.qx);b.qa(ub.a.zze,lc.a.paragraph,Kk.iSh);b.Pc(ub.a.zze,1028)}static iSh(b,h,r,A,M){if(1===r)return 32;b===ub.a.Aze?b=ub.a.n_a:b===ub.a.zze&&(b=ub.a.m_a);return Kk.WRd(b,h,r,A,Kk.Z6n(M))}static Z6n(b){var h=b.indexOf(",");const r=b.substring(0,h);b=b.substring(h+1,b.length);h=new JL.a;h.value=parseFloat(r);
h.unit=parseInt(b);return h}static Hze(b,h,r,A,M){if(2===r){h=M[ui.a.Text];r=M[ui.a.Number];M=M.Increment;A=new JL.a;let aa=!1;""===h||M&&h===Box4Intl.Box4Strings.L_SpinnerAuto?(A.value=0,A.unit=df.a.rLa?2:4,aa=!0):r||M||(A.value=0,A.unit=1,aa=!0);aa&&(y.AFrameworkApplication.va.Pb(b===ub.a.Ize?ub.a.n_a:ub.a.m_a,2,A),qa.StaticActiveAppFrame.za().Fe())}return 32}static WRd(b,h,r,A,M){if(!({Iz:r}=Jn.a.VAg(r,h)).returnValue)return r;h=h.node;switch(b){case ub.a.GE:Kk.nl.GE(h,new KL.a(2,M));break;case ub.a.n_a:b=
new KL.a(M.unit,M.value);Kk.nl.Nxb(h,b);break;case ub.a.m_a:b=new KL.a(M.unit,M.value),Kk.nl.Mxb(h,b)}A&&jt.a.tzb&&(A.Bt|=jt.a.nqb(h));return 32}static M0k(b,h,r){if(1===r)return 32;v.ULS.sendTraceTag(588394561,340,50,"Add Space Before Paragraph option is clicked");b=Kk.fGi(h);if(!b)return v.ULS.sendTraceTag(588367186,3018,10,"No style applied on the paragraph"),8;b=(b=b.ka(Mc.a.Sj,240)/20)?b:Kk.xMl;Kk.D8.eha(1,b,4);return 32}static Byo(b,h,r){if(1===r)return 32;v.ULS.sendTraceTag(588394562,340,50,
"Remove Space Before Paragraph option is clicked");Kk.D8.eha(1,0,4);return 32}static L0k(b,h,r){if(1===r)return 32;v.ULS.sendTraceTag(588394563,340,50,"Add Space After Paragraph option is clicked");b=Kk.fGi(h);if(!b)return v.ULS.sendTraceTag(588367187,3018,10,"No style applied on the paragraph"),8;b=b.ka(Mc.a.ta,240)/20;Kk.D8.eha(0,b?b:12,4);return 32}static Ayo(b,h,r){if(1===r)return 32;v.ULS.sendTraceTag(588394564,340,50,"Remove Space After Paragraph option is clicked");Kk.D8.eha(0,0,4);return 32}static Chf(b,
h,r,A,M){if(2==r){if("boolean"!==typeof M)return 16;b=h.node;h=b.XC();Kk.nl.Chf(b,M);h&&Kk.Mj.fV(b,h,Kk.Od.Lg)}return 32}static Yhf(b,h,r,A,M){if(2==r){if("boolean"!==typeof M)return 16;b=h.node;h=b.XC();Kk.nl.Yhf(b,M);h&&Kk.Mj.fV(b,h,Kk.Od.Lg)}return 32}static Bhf(b,h,r,A,M){if(2==r){if("boolean"!==typeof M)return 16;b=h.node;h=b.XC();Kk.nl.Bhf(b,M);h&&Kk.Mj.fV(b,h,Kk.Od.Lg)}return 32}static s5k(b,h,r,A,M){if(2==r){if("boolean"!==typeof M)return 16;b=new Map;b.set("Value",M.toString());Ba.Health.instance.recordKpiUsage(vj.a.Gab.Yhp,
0,vj.a.NB,b);h=h.node;b=h.XC();h.hasProperty(Mc.a.$x)&&h.removeProperty(Mc.a.$x);Kk.Qab.R4d(h)!==M&&h.setValue(Mc.a.$x,M);(M=Kk.Qab.Ojc(h,!0))&&M.km(4,!0);(M=Kk.Qab.Ojc(h,!1))&&M.km(4,!0);b&&Kk.Mj.fV(h,b,Kk.Od.Lg)}return 32}static fGi(b){b=b.view;return b.te&&(b=b.mb)&&b.gb.currentSelection?Kk.Vyb.Aq(b.gb.currentSelection.Qa.node):null}}Kk.xMl=12;Object(u.a)(Kk,"SpacingActor",null,[]);class HM{process(){}}Object(u.a)(HM,"NoOpFormattingViewOperationFinishedStageProcessor",null,[1612]);class IM{constructor(b){this.Ke=
b}cRo(b,h){b&&h&&h.cache&&(this.Ke.cha(b,h.cache.gI),this.Ke.gC(b,h.cache.fontSize))}KPb(){return null}QVa(){return null}wkc(){return null}$W(){return null}}Object(u.a)(IM,"FormattingStewardBridge",null,[1611]);class LL{uc(b){b.ia(922,()=>new HM).ha();b.ia(688,()=>new IM(b.resolve(101))).ha()}}Object(u.a)(LL,"WoncaActorsConfiguration",null,[1]);class UF{constructor(b,h,r,A,M,aa,oa,Ja){this.ga=b;this.onk=h;this.nnk=r;this.n9g=A;this.rGk=M;this.vId=aa;this.vGk=oa;this.wGk=Ja}get Rb(){return this.ga}Ccl(b){this.Rb.Gua(b,
this.onk,null,null)}Acl(b){this.Rb.Gua(b,this.nnk,null,null)}q6(b,h,r){r?this.Rb.Gua(b,this.n9g,h,null):this.Rb.Pb(this.n9g,2,h)}B7n(b,h){this.Rb.Gua(b,this.vId,h,null)}O3(b,h){this.Rb.Gua(b,this.vGk,h,null)}fwb(b,h){this.Rb.Gua(b,this.wGk,h,null)}Pig(b,h=!1){const r=new wg.DictionaryPropertySet;r.setValue(pd.a.QX,b);r.setValue(pd.a.Rqj,!0);r.setValue(pd.a.M$a,h);this.Rb.Pb(this.rGk,2,r)}}Object(u.a)(UF,"ClipboardCommands",null,[1606]);class Lw{}Object(u.a)(Lw,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",
null,[1604]);class HD{constructor(b){this.ga=b}get Rb(){return this.ga}sNj(b,h,r){let A=0;b?1===b&&(A=ub.a.h$a):A=ub.a.g$a;b=new RB.a;b.unit=r;b.value=h;this.Rb.Pb(A,2,b)}qxe(b,h,r){let A=0;1===b?A=ub.a.E_b:2===b?A=ub.a.hyb:b||(A=ub.a.F_b);b=new RB.a;b.unit=r;b.value=h;this.Rb.Pb(A,2,b)}}Object(u.a)(HD,"IndentationCommands",null,[1597]);var TF;(function(b){b[b.unspecified=-1]="unspecified";b[b.none=0]="none";b[b.left=1]="left";b[b.center=2]="center";b[b.right=3]="right";b[b.m1p=4]="inner";b[b.outer=
5]="outer";b[b.both=6]="both";b[b.$Up=7]="distribute";b[b.margin=8]="margin";b[b.O_p=9]="highKashida";b[b.S3p=10]="lowKashida";b[b.q4p=11]="mediumKashida";b[b.vaq=12]="numTab";b[b.ukq=13]="thaiDistribute";b[b.start=14]="start";b[b.end=15]="end"})(TF||(TF={}));Object(u.b)("Justification",TF);class ol{constructor(b){this.uRa={};this.ga=b;this.G2m()}get Rb(){return this.ga}rH(b){b=this.uRa[TF[b]];void 0!==b&&null!==b&&this.Rb.Ob(b,2)}G2m(){this.uRa.left=ub.a.F7;this.uRa.center=ub.a.W$;this.uRa.right=
ub.a.p8;this.uRa.both=ub.a.ZJa;this.uRa.lowKashida=ub.a.HTb;this.uRa.mediumKashida=ub.a.HTb;this.uRa.highKashida=ub.a.HTb;this.uRa.distribute=ub.a.IYc;this.uRa.thaiDistribute=ub.a.Knd}}Object(u.a)(ol,"JustificationCommands",null,[1596]);class sM{constructor(b){this.ga=b}GE(b){this.ga.Pb(ub.a.GE,2,b)}mwc(b){this.ga.Pb(ub.a.mwc,2,b)}Ymd(b){this.ga.Pb(ub.a.Ymd,2,b)}Rnd(b){this.ga.Pb(ub.a.Rnd,2,b)}Xmd(b){this.ga.Pb(ub.a.Xmd,2,b)}eha(b,h,r){this.ga.Pb(b?ub.a.n_a:ub.a.m_a,2,Object.assign(new JL.a,{value:h,
unit:r}))}}Object(u.a)(sM,"SpacingCommands",null,[1594]);class sI{constructor(b,h,r){this.Rb=b;this.jZc=h;this.cXl=r;this.h2n=(A,M,aa)=>{if(1===aa)return this.jZc.d2?32:8;this.jZc.Qxn();this.cXl().B3o(this.jZc.bom());return 32}}Xb(){this.Rb.fb(ub.a.Ivb,lc.a.application,this.h2n,1028)}}Object(u.a)(sI,"EditorSettingsUIActor",null,[]);class BF extends ig.a{constructor(b,h){super(!1,!1,!0);this.eXl=b;this.OXa=h;this.dXl=r=>{1!==r?v.ULS.sendTraceTag(527434075,340,50,"Editor Settings closed without changes"):
(this.eXl.Tqp(),v.ULS.sendTraceTag(578869131,340,50,"Editor Settings updated"))}}async B3o(b){const h=await this.OXa.hUb;b={["id"]:"SettingsDialog",["uiLanguage"]:y.AFrameworkApplication.uiCulture,["selectedLanguage"]:tj.a.Hg(y.AFrameworkApplication.lcid).name,["isGoalActive"]:!1,["isSubscription"]:h.H$c,["editorSettings"]:b};this.mi(Box4Intl.Box4Strings.l_EditorSettings,this.dXl,b);v.ULS.sendTraceTag(578091235,340,50,"Editor settings dialog is opened.")}}Object(u.a)(BF,"EditorSettingsDialog",ig.a,
[]);var hO=d(237);class JM{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc){this.vGb=this.AMc=this.FDc=null;this.n8e=0;this.vVe=!1;this.sa=new Td.a;this.jde=!1;this.$v=b;this.pB=h;this.Ke=r;this.wv=A;this.jb=M;this.Qd=aa;this.xl=oa;this.Bd=Ja;this.Yd=fb;this.Oq=Cb;this.zZ=Gb;this.Vx=Sb;this.yp=pc}get NYl(){return this.Bd?this.Bd.isFeatureEnabled(35):!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("Box4EndOfParagraphFormattingIsEnabled")}get gEf(){return null!=this.cWg?this.cWg:this.cWg=Za.a.instance.resolve(716)}get vU(){return this.vVe}set vU(b){this.vVe!==
b&&(this.vVe=this.jde=b,this.sa.raiseEvent("FormatPainterBrushActiveStatusChanged"))}TYk(b){this.sa.addHandler("FormatPainterBrushActiveStatusChanged",b)}Arj(b){const h=b.Qa;v.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",h.contextId);this.reset();var r=h.node;b=this.XYi(b);if(this.gEf.r0o(h.contextId,b))try{this.vGb=this.jb.p9a(r)}catch(A){throw v.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",A.message),A;}this.AMc=this.Vx.Aq(r);r=Wa.FormattingReader.Rs(h);
r.lo&&(this.FDc=Object(ya.a)(PC.a,r.lo.clone()));this.n8e=b?lc.a.paragraph:h.contextId}DRh(b){if(b){const r=this.XYi(b);for(let A=0;A<b.length;A++){const M=b.K(A);if(null===M||void 0===M?0:M.Al)this.aKb(M,r);else if(0==(null===M||void 0===M?void 0:M.length))v.ULS.sendTraceTag(529089953,354,50,"Attempt to apply format to non-graph-node context: {0}",M);else if(M)for(let aa=0;aa<M.length;aa++){var h=M.getContext(aa);if(null===h||void 0===h?0:h.Qw){if(h)for(let oa=0;oa<h.length;oa++)M.addContext(h.getContext(oa))}else(null===
h||void 0===h?0:h.Al)?this.aKb(h,r):v.ULS.sendTraceTag(529089954,354,50,"Attempt to apply format to non-graph-node context: {0}",h.contextId)}}}}HRh(b,h){if(h){var r=b.node,A=r.ra.last,M=this.Qd.V7a(r),aa=M.Bf(M.Jb);this.IRh(M,h,null);this.Oq.k_b(r,A,b.cpBegin,b.cpEnd,aa,M,this.Yd.Lg)}}E5k(b,h,r){if(h||r)0<cn.g(b).length&&v.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.zZ.QZ(b,A=>{this.IRh(A,h,r)})}IRh(b,h,r){this.Ke.$qa(b);b.lo&&b.lo.removeProperty(He.a.highlight);
this.Ke.Pnf(b);r&&(r=r.clone(),r.Uf(...Kr.a.Qaa()),this.Yt(b,r.Wi()));this.Yt(b,h)}Yt(b,h){if(h){var r=b.paragraph.Ic;if(r){var A=b.lo;A=A?Object(ya.a)(Hn.a,A.clone()):PC.a.cUa(wm.a.Zvb);for(const oa of h.ek())if(oa!==Mc.a.Dw&&oa!==Mc.a.E2&&oa!==He.a.mE&&oa!==He.a.gba&&oa!==Mc.a.Fsb&&oa!==He.a.mP&&oa!==Mc.a.Iab&&oa!==Mc.a.noProof){if(oa===wb.a.Fw){var M=h.ka(wb.a.Fw,N.a.nil);if(M!==N.a.nil)if(M=this.Vx.qo().hla(M,r)){var aa=this.Vx.xL(M);if(aa===Box4Intl.Box4Strings.L_StyleWordHyperlink)if(M=this.Vx.AF(b.paragraph),
si.a.Xg.Ln?(aa=M.gv().YAa(aa),M=M.lh(this.Vx.ze(aa))):M=M.wKa(aa),M){A.Fza(M.Wi(),...Kr.a.Qaa());continue}else v.ULS.sendTraceTag(589345875,354,50,"Applied Hyperlink style on formatting is not present in Style Set")}else v.ULS.sendTraceTag(589345876,354,50,"Applied character style on formatting is not present in Object Space")}A.setValue(oa,h.wf(oa))}A.ELa?h=r.IP(A,!0):(r.ku(A),h=A);b.Ek=h.id}}}XYi(b){return!b.fw&&b.Wc.contextId!==lc.a.Uc}reset(){this.vGb=this.AMc=this.FDc=null;this.n8e=lc.a.none}aKb(b,
h){if(b.contextId===lc.a.Xc||b.contextId===lc.a.Cd)var r=this.xl.eba(b);else if(b.contextId===lc.a.paragraph)r=this.xl.mee(b);else if(b.contextId===lc.a.Uc)r=this.xl.Uce(b);else{v.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",b.contextId);return}v.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",b.contextId);if(r)v.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{r=Object(ya.a)(Gn.AParagraphNode,b.node);var A=
!1;r&&(A=b.contextId===lc.a.Cd&&!!r&&!b.cpBegin&&b.cpEnd===this.jb.textLength(r));if(h=this.gEf.pZo(this.n8e,b.contextId,h,A))try{Gd.ParagraphReader.Vb(r)?(this.AMc&&this.$v.WP(this.AMc,r,!0),this.wv.$Rh(r,this.vGb)):v.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",b.node.type)}catch(M){throw v.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",M.message),M;}A=b;b.contextId===lc.a.paragraph?A=wc.a.createTextRange(r,0,
Gd.ParagraphReader.textLength(r)):b.contextId===lc.a.Xc&&(A=this.pB.IMf(b),A=gg.a.jMb(A));if(A&&A.contextId===lc.a.Cd){const M=this.yp.u7d(A);M&&(A=M);try{this.E5k(A,this.FDc,h?null:this.AMc)}catch(aa){throw v.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",aa.message),aa;}}if(b.contextId===lc.a.paragraph||b.contextId===lc.a.Uc)h=new vd.a,h.set(r),h.Kd(),h.ld(11),A=of.ListItemReader.Cg(h),r=!Gd.ParagraphReader.textLength(r),v.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",
A,r),A?(r=of.ListItemReader.g7(h),of.ListItemReader.isListItem(r)&&this.HRh(b,this.FDc)):this.NYl&&this.HRh(b,this.FDc)}}}Object(u.a)(JM,"FormatPainter",null,[1553]);var aO=d(117);class Fx{constructor(b,h,r,A,M,aa,oa,Ja=!1,fb,Cb,Gb){this.nEd=!1;this.URe=new ht.a;this.USm=()=>{this.SV.vU=!1;return 32};this.VSm=(Sb,pc,zc)=>{Sb=!1;if(pc=this.pA.Ika){switch(pc.contextId){case lc.a.Cd:case lc.a.paragraph:case lc.a.Uc:case lc.a.Xc:Sb=!0}Sb&&ze.a.Zl(pc)&&cn.b(pc)&&(this.xd.$b(Nf.a.Nn,{["Reason"]:nf.a.QVc}),
Sb=!1);Sb&&Gd.ParagraphReader.qX(pc)&&(this.xd.$b(Nf.a.Nn,{["Reason"]:nf.a.QQ}),Sb=!1)}if(1===zc||!Sb)return Sb?32:8;6!==this.ga.aE?(this.SV.vU?v.ULS.sendTraceTag(22832076,354,50,"User deactivated the Format Painter button"):(v.ULS.sendTraceTag(22832075,354,50,"User activated the Format Painter button"),this.SV.Arj(this.pA.currentSelection),this.nEd||(this.hi.D5a(this.e5j),(zc=this.hi.kb.Bw)&&zc.gj&&zc.WNh(this.d5j),this.nEd=!0)),this.SV.vU=!this.SV.vU):(v.ULS.sendTraceTag(22832077,354,50,"User picked format from keyboard shortcut"),
this.SV.Arj(this.pA.currentSelection),this.SV.vU=!1);return 32};this.TSm=(Sb,pc,zc,Yc,Kd)=>{if(6===this.ga.aE||this.SV.vU){v.ULS.sendTraceTag(22832078,354,50,"User applied the Format Painter from command location: {0}",this.ga.aE);Sb=this.hi.Vr.Wf("UserAction","FormatPainterApply");if(Fx.sc&&Fx.sc.kE(108)){Kd=Kd?Kd.KeepBrushActive:!1;zc=null;this.pA.currentSelection&&2===this.pA.currentSelection.trigger&&(Kd=Kd||this.SV.jde,this.SV.jde&&ze.a.Am(this.pA.currentSelection)&&(zc=ze.a.Q6(this.pA.currentSelection.Qa,
!1)))&&(zc.trigger=2);this.SV.jde=!1;if(Kd||2!==this.pA.currentSelection.trigger)pc=new Rb.GraphTransaction(15),zc&&zc.Qa?(pc.set(zc.Qa.node.mk),this.hb.Kc(zc)):pc.set(this.pA.nOb.mk),zc=sc.SelectionFactory.Qo(this.hb.Mg),this.SV.DRh(zc),pc.dispose();this.SV.vU=Kd}else Kd=new Rb.GraphTransaction(15),Kd.set(this.pA.nOb.mk),pc=sc.SelectionFactory.Qo(this.hb.Mg),this.SV.DRh(pc),this.SV.vU=!1,Kd.dispose();Sb.stop()}return 32};this.e5j=()=>{this.yne(this.SV.vU)};this.d5j=()=>{this.yne(this.SV.vU)};this.hi=
b;this.Yb=h;this.ga=r;this.xd=A;this.pA=M;this.SV=aa;this.hb=oa;this.Jyk=Ja;this.lA=fb;this.Fy=Cb;this.Dqk=Gb}get vhh(){return Y.a.eu||Y.a.Iee?"url("+this.jxi()+"), pointer":'url("'+this.jxi()+'"), pointer'}jxi(){return this.Fy?this.lA.JAa(Bk.a.ki("FormatPainterText.cur"),Bk.a.ki("FormatPainterTextDarkMode.cur"),new aO.a(Gj.a.nR())):Bk.a.ki("FormatPainterText.cur")}Xb(){const b=this.Yb.ie(vi.a.uF);b.bindAction(Xb.KeyInputManager.mc(cf.a.Bfb,0),ub.a.fEf);b.bindAction(Xb.KeyInputManager.mc(cf.a.MAb,
6),ub.a.y3d);this.Jyk||b.bindAction(Xb.KeyInputManager.mc(cf.a.PAb,6),ub.a.t8a);this.ga.fb(ub.a.y3d,lc.a.view,this.VSm,1028);this.ga.fb(ub.a.t8a,lc.a.view,this.TSm,1028);this.ga.fb(ub.a.fEf,lc.a.view,this.USm,1028);this.SV.TYk(()=>{this.SLg(this.SV.vU)});this.Fy&&this.Dqk.NQd(()=>{this.yne(this.SV.vU)})}SLg(b){const h=this.hi.Vr.Wf("UserAction","FormatPainterUpdateCursor");this.yne(b);this.hi.Fe();h.stop()}c5j(b,h){for(let r=0;r<b.length;r++)this.b5j(b[r],h);(b=this.hi.kb.Bw)&&b.te&&this.b5j(b.Kh.editingElement,
h)}b5j(b,h){b.style.cursor=h?this.vhh:""}yne(b){const h=document.querySelectorAll(".OutlineElement");if(1<h.length){const r=h[h.length-2].style.cursor===this.vhh;if(this.hi.kb.isEditingAllowed||this.hi.kb.Wz){if(b&&!r||!b&&r)this.c5j(h,b),this.A5j(b);b||!this.nEd||this.URe.count||(this.hi.VBj(this.e5j),(b=this.hi.kb.Bw)&&b.gj&&b.wxo(this.d5j),this.nEd=!1)}else r&&(this.c5j(h,!1),this.A5j(!1))}}A5j(b){const h=this.hi.kb.Bw;h&&(b?this.URe.add(h.od.Bk):this.URe.remove(h.od.Bk))}static get sc(){return null!=
Fx.VUg?Fx.VUg:Fx.VUg=Za.a.instance.Oa(12)}}Object(u.a)(Fx,"FormatPainterActor",null,[]);class vv{constructor(b,h,r){this.Sn=r}$_l(b,h,r,A,M){var aa;if(!({ne:r,selected:aa,Iz:fb,X8c:Ja}=this.nRj(h,r,!1)).returnValue)return fb;db.a.mark(5013);var oa=vv.Iw.GO(aa);for(let Cb=0;Cb<oa.length;++Cb){if(!oa[Cb].isValid)continue;const Gb=oa[Cb].iterator;Gb.pq();if(gm.OutlineReader.oy(Gb))return this.Hji(r,Gb)}var Ja=Ja?ub.a.f7c:this.Eom();if(aa.Qw||ze.a.Zl(aa)||Gd.ParagraphReader.fn(aa)&&!ze.a.bba(aa)){if(vv.sc&&
vv.sc.isFeatureEnabled(22)&&Object(Al.a)().WCg(aa).returnValue)return 8;var fb=this.Iji(h,r,b,A,M,Ja)}else if(ze.a.ll(aa))fb=this.Gji(h,r,b,A,M,Ja);else if(ze.a.pf(aa)){fb=new vd.a;fb.set(aa.node);fb.vb(10);oa=Nc.a.KA(aa,!1);if(0<oa.length){if(!oa[0].hyperlink)return v.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",oa[0].cpBegin,oa[0].cpEnd),8;df.a.gic(oa[0].hyperlink.url);return 32}$g.TableCellReader.h3(fb)&&(Oh.returnToContainingCell(fb),$g.TableCellReader.Ila(fb)&&
(oa=new vd.a,oa.hd(fb),Oh.returnToContainingRow(oa),gm.OutlineReader.UA(fb,aa,!1)&&zq.a.LWi(oa)&&0>=aa.Fb&&(Ja=ub.a.j7c,Oh.returnToContainingTable(fb),Bb.OutlineElementNavigator.je(fb),M||(M=new wg.DictionaryPropertySet),M.Ag(pd.a.targetObject,fb.currentNode.id))));fb=this.Jji(h,r,b,A,M,Ja)}else ze.a.bba(aa)&&(fb=y.AFrameworkApplication.va.Nf(h,ub.a.oE,2,!1,A,M));db.a.mark(5014);return fb}nRj(b,h,r){let A=null,M=null,aa=!1;if(1===h)return{returnValue:!1,ne:A,selected:M,Iz:32,X8c:aa};if(!b.view.te)return{returnValue:!1,
ne:A,selected:M,Iz:2,X8c:aa};A=b.view;M=A.mb.Mg;return!M||!vv.rg.nWi(M,r)||vv.rg.Nla(M,oa=>aa=oa)&&!aa?{returnValue:!1,ne:A,selected:M,Iz:2,X8c:aa}:this.Sn&&this.Sn.instance&&this.Sn.instance.sX(M)?{returnValue:!1,ne:A,selected:M,Iz:4,X8c:aa}:{returnValue:!0,ne:A,selected:M,Iz:2,X8c:aa}}eZo(b,h,r,A,M){let aa,oa;if(!({ne:r,selected:aa,Iz:oa}=this.nRj(h,r,!0)).returnValue)return oa;const Ja=vv.Iw.GO(aa);for(let fb=0;fb<Ja.length;++fb){if(!Ja[fb].isValid)continue;const Cb=Ja[fb].iterator;Cb.pq();if(gm.OutlineReader.oy(Cb))return this.Hji(r,
Cb)}aa.Qw||ze.a.Zl(aa)?oa=this.Iji(h,r,b,A,M,ub.a.f7c):ze.a.ll(aa)?oa=this.Gji(h,r,b,A,M,ub.a.f7c):ze.a.pf(aa)?oa=this.Jji(h,r,b,A,M,ub.a.f7c):ze.a.bba(aa)&&(oa=y.AFrameworkApplication.va.Nf(h,ub.a.oE,2,!1,A,M));return oa}Hji(b,h){b.mb.Kc(sc.SelectionFactory.hp(h.currentNode,!1));return 32}Iji(b,h,r,A,M,aa){const oa=new Rb.GraphTransaction(15);oa.Ii=r;oa.Bb(h.od);h=new wg.DictionaryPropertySet;h.setValue(pd.a.OYc,!0);h=y.AFrameworkApplication.va.Nf(b,ub.a.JJ,2,!0,A,h);32===h&&(h=y.AFrameworkApplication.va.Nf(b,
aa,2,!1,A,M));oa.dispose();return h}Gji(b,h,r,A,M,aa){const oa=new Rb.GraphTransaction(15);oa.Ii=r;oa.Bb(h.od);h.mb.Kc(ze.a.uk(h.mb.gb.K(0),!1,!1));b=y.AFrameworkApplication.va.Nf(b,aa,2,!1,A,M);oa.dispose();return b}Jji(b,h,r,A,M,aa){const oa=new Rb.GraphTransaction(15,r);oa.Ii=r;oa.Bb(h.od);b=y.AFrameworkApplication.va.Nf(b,aa,2,!1,A,M);oa.dispose();return b}static get Iw(){return Object(Al.a)()}static get rg(){return re.a.instance}static get sc(){return null!=vv.RUg?vv.RUg:vv.RUg=Za.a.instance.Oa(12)}}
Object(u.a)(vv,"AEnterViewStrategy",null,[1620]);class bL extends vv{constructor(b,h,r){super(b,h,r)}Eom(){return ub.a.oE}}Object(u.a)(bL,"EnterViewStrategy",vv,[]);class ML{constructor(b){this.Rm=this.transaction=null;this.ne=b;this.cWc=this.Xo=0}}Object(u.a)(ML,"SelectAllArguments",null,[]);class yA{constructor(b,h,r){this.A4n=b;this.jvn=h;this.jp=r;this.T1l=(A,M,aa)=>M.view.gj?this.a8a(M,aa,this.UVj):this.fKo(M,aa);this.ohd=(A,M)=>M.Xo?1===M.Xo?(M.ne.mb.Bnd(M.Rm,A),M.Xo=2,!0):2===M.Xo?(M.ne.mb.gb.g7a=
M.Rm.g7a,this.Yg.pI(),M.transaction.LNa(A),M.Xo=3,M.transaction.dispose(),db.a.mark(5799),!0):!1:(M.transaction=this.jp.Nc(2),M.transaction.Bb(M.ne.od),M.Xo=1,!0);this.fKo=(A,M)=>{if(1===M)return 32;if(!A.view.te)return 2;A=A.view;return A.mb&&A.mb.gb&&A.mb.gb.currentSelection?this.UVj(A).zfa?1:32:8};this.UVj=A=>{A.gj&&v.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");A=new Fv.a(null,this.Ieo,new ML(A));A.qm("SelectAllInOutline");A.run();return A};this.Ieo=(A,M)=>{if(!M.Xo)return M.Rm=
sc.SelectionFactory.gKo(M.ne.mb.gb.currentSelection),M.transaction=this.jp.Nc(2),M.transaction.Bb(M.ne.od),M.Xo=1,!0;if(1===M.Xo){if(!M.cWc)return M.ne.mb.Kc(M.Rm.K(0),A),++M.cWc,!0;if(M.cWc<M.Rm.length)return M.ne.mb.$Wk(M.Rm.K(M.cWc),A),++M.cWc,!0;M.Xo=2}return 2===M.Xo?(M.ne.mb.gb.g7a=M.Rm.g7a,this.Yg.pI(),M.transaction.LNa(A),M.Xo=3,M.transaction.dispose(),!0):!1}}get Yg(){return this.jvn.value}Xb(){const b=y.AFrameworkApplication.va;b.qa(ub.a.ZDa,we.a.frame,yA.jSj);b.qa(ub.a.CAg,we.a.frame,yA.jSj);
b.fb(ub.a.a8a,lc.a.view,this.T1l,2);b.fb(ub.a.I5a,lc.a.view,id.AFrame.Sg,100);b.fb(ub.a.F8f,lc.a.view,yA.F8f,4)}a8a(b,h,r){if(1===h)return 32;if(!b.view.te)return 2;h=b.view;if(!h.mb)return 8;const A=h.mb.gb;if(!A||!A.length)return 8;db.a.mark(5798);qa.StaticActiveAppFrame.za().kb.isEditingAllowed||qa.StaticActiveAppFrame.za().kb.Wz||h.gj?b=ze.a.SKf(A):(Cd.FocusManager.instance().EE(id.AFrame.Ro),b=sc.SelectionFactory.LIj(h.od));if(!b)return 8;A.g7a||v.ULS.sendTraceTag(39098305,324,50,"Progress selection start");
r&&this.A4n.VSb(ze.a.gvi(b))?r=r(h):(r=new ML(h),r.Rm=b,r=new Fv.a(null,this.ohd,r),r.qm("ExpandSelection"),r.run());return r.zfa?1:32}static get Bdb(){return null!=yA.s2g?yA.s2g:yA.s2g=Za.a.instance.resolve(123)}static F8f(b,h,r){if(1===r)return 32;if(!h.view.te)return 8;b=h.view;h=sc.SelectionFactory.hp(b.root.graphNode,!0);if(!h)return 8;b.mb.Kc(h);return 32}static jSj(){var b=qa.StaticActiveAppFrame.za().kb.Bw;if(!b.te)return 2;if(b.te&&1!==qa.StaticActiveAppFrame.za().state){db.a.mark(4668);
var h=b.mb.gb.currentSelection;if(!h&&y.AFrameworkApplication.J.$("ContextMenuOnSelectionFixIsEnabled"))return 2;h=ze.a.Tqa(h);let r=h.x,A=h.y+h.height;if(!b.container)return 8;b=Sys.UI.DomElement.getBounds(b.container);if(h.y<b.y||h.y>b.y+b.height||h.x<b.x||h.x>b.x+b.width)r=b.x,A=b.y;yA.Bdb.ZDa(new Sys.UI.Point(r,A),1);db.a.mark(4669)}return 32}}Object(u.a)(yA,"SelectAllHandlers",null,[1595]);class iO{wwe(){}}Object(u.a)(iO,"FontNameFormattingStrategyNoop",null,[1603]);var bP=d(1023);class CK{constructor(b,
h,r,A,M,aa){this.$Uh=this.cVh=null;this.$s=b;this.ZUh=h;this.kbl=r;this.tbl=A;this.cVh=M;this.$Uh=aa}}Object(u.a)(CK,"BookmarkHighlightContext",null,[]);class cL extends Oq.a{constructor(){super()}get wfa(){return!0}get Erb(){return 5}get Y9a(){if(null!=this.w5)return this.w5;this.w5=[];this.w5.push(new Pq.a($n.a.PSd,$n.a.PSd));this.w5.push(new Pq.a($n.a.Sjf,$n.a.Sjf));this.w5.push(new Pq.a($n.a.lTc,$n.a.lTc));return this.w5}zMa(b,h){this.wfa&&er.a.instance.$d(()=>{const r=this.vs.TIa;var A=this.vs.iad;
if(r)if(5===r.type){A=r.UB;if(r.VL&&r.VL.$s.includes(b))for(const M of h.ZMa("*"))this.vs.BZa(M);A&&A.$s.includes(b)&&this.ayb(h,r.action,A,b)}else A&&5===A.type&&3===r.action&&A.UB.$s.includes(b)&&this.ayb(h,0,A.UB,b)},"BHA:OPHC")}yXa(b){return Object(Xa.a)(CK,b)}q9a(b,h){if(b)for(const r of b.$s)h.add(r)}ayb(b,h,r,A){0===h&&b.htmlElement&&er.a.instance.$d(()=>{const M=b.ZMa("*"),aa=M.length,oa=$n.a.PSd;var Ja=A.id===r.cVh,fb=A.id===r.$Uh;let Cb=!1;var Gb=0,Sb=[];const pc=Array(aa);for(let Kd=0;Kd<
aa;Kd++){var zc=M[Kd];const ke=lr.a(zc);pc[Kd]=ke;const ge=zc.classList;if(0!=pc[Kd]){const de=!ge.contains($n.a.dI),Sd=nk.a.Eb(zc,$n.a.rKb);Sd&&Sb.push(...Sd);if(Ja){let be;if((be=nk.a.Eb(zc,$n.a.RSd))&&Sd&&1===be.length&&1===Sd.length&&be[0].equals(Sd[0]))continue;be&&(Gb+=be.length,1===ke?ge.add($n.a.Sjf):ge.add(oa));if(Sd)for(const Rf of Sd)this.ice(r,Rf)&&(Gb--,Cb&&ge.add($n.a.lTc));0!==Gb&&de&&ge.add(oa)}if(!Ja&&!fb&&r.tbl.has(A.id))if((zc=nk.a.Eb(zc,$n.a.rKb))&&Cb){ge.add(oa);for(const be of zc)if(this.ice(r,
be)){ge.add($n.a.lTc);break}}else de&&ge.add(oa)}Cb=!ge.contains($n.a.P7a)}if(fb&&!Ja){Ja=new Set;for(var Yc of Sb)this.ice(r,Yc)&&Ja.add(Yc);Cb=!1;for(Sb=0;0!==Ja.size&&Sb<aa;Sb++){Gb=M[Sb];Yc=Gb.classList;if(0!=pc[Sb])if(fb=!1,Gb=nk.a.Eb(Gb,$n.a.rKb)){for(const Kd of Gb)this.ice(r,Kd)&&(Ja.delete(Kd),fb=!0);0!==Ja.size&&Yc.add(oa);Cb&&fb&&Yc.add($n.a.lTc)}else Yc.contains($n.a.dI)||Yc.add(oa);Cb=!Yc.contains($n.a.P7a)}}},"BHA:SPH")}ice(b,h){for(const r of b.kbl)if(h.equals(r))return!0;return!1}}
Object(u.a)(cL,"BookmarkHighlightActor",Oq.a,[516]);var DK=d(1881),tI;(function(b){b[b.w2p=0]="jsonToDocumentXml";b[b.jVl=1]="documentXmlToJson";b[b.kVl=2]="documentXmlToThemeJson";b[b.Olq=3]="unsupported"})(tI||(tI={}));Object(u.b)("GraphicsEditorConversionRequestType",tI);var KM=d(1615);class EK{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb){this.Gf=b;this.oG=h;this.jb=M;this.GY=aa;this.Dk=oa;this.Xd=Ja;this.Bd=Cb;this.Ga=fb}Nwg(b,h,r,A){const M=b.BKh(h);if(M){var aa=Object(Xa.a)(KM.a,b),oa=this.Xd.Wf("WebServiceCall",
String.format("SendGraphicsEditorRequest: ClosingDialog = {0} EditingExistingContent = {1}",aa,r)),Ja=h.Ik.node,fb=()=>{r||this.Cvo(h.Ik,M.getId())};aa=EK.pWh();A=this.NWh(M.getId().toString(),Ja,A,r);try{b.QQh(A,h)}catch(Cb){v.ULS.sendTraceTag(572872463,3001,10,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Exception while trying to AppendUrlParameters. Exception: "+Cb.message);this.mq(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);return}this.Gf.Wj(aa,2,A.toString(),{},
!0,0,Cb=>{v.ULS.sendTraceTag(575522560,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Successfully created GraphicsEditorSession.");b.csc(Cb,M,()=>{this.mq(b.P7d())},fb,Ja,h,oa)},Cb=>{const Gb=415===Cb.data.Ie;let Sb="";Cb&&Cb.data&&Cb.data.vi&&"X-CorrelationId"in Cb.data.vi&&Cb.data.vi["X-CorrelationId"]&&(Sb=Cb.data.vi["X-CorrelationId"]);b.UU(`Graphics editor request failed. HttpStatus [${Cb.data.Ie}], ResponseData [${Cb.data.De}], CorrelationId [${Sb}]`,M,Ja,fb,()=>{this.mq(Gb?
WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError:b.P7d())},oa,Gb)},null)}else this.mq(b.P7d())}NLo(b,h,r){return new Promise((A,M)=>{var aa=b.Ik,oa=null;oa=dn.a.fZf(aa)?aa.getContext(0).node:aa.node;aa=EK.pWh();oa=this.NWh(h.toString(),oa,r,!1);oa.ye(DK.a.erf,tI.kVl.toString());this.Gf.Wj(aa,2,oa.toString(),{},!0,0,Ja=>{v.ULS.sendTraceTag(575522563,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Successfully created.");A(Ja.data.De)},Ja=>{v.ULS.sendTraceTag(575522564,
3001,10,`GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Request failed. HttpStatus ${Ja.data.Ie}, ResponseData ${Ja.data.De}`);this.mq(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);M(null)},null)})}NWh(b,h,r,A){const M=h.Jj(),aa=new Ra.QueryStringBuilder("WordGraphicsEditorHandler.ashx");y.AFrameworkApplication.rja(aa);aa.ye(DK.a.hAe,this.Zhn(h)?"true":"false");aa.ye(Uj.a.nodeId,b);aa.ye(Uj.a.cellId,M.ml.toString());aa.ye(Uj.a.fileId,M.yq);aa.ye(Uj.a.f_,r.toString());
aa.ye(DK.a.D1l,A?"true":"false");if(b=!!this.Bd&&this.Bd.isFeatureEnabled(43)){aa.ye(Pi.a.Erj,b.toString());if(b=this.Bd.isFeatureEnabled(83))aa.ye(Pi.a.U8n,b.toString()),aa.ye(Pi.a.W_m,"true");this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.PictureTransparency",!1)&&aa.ye(Pi.a.c9n,"true")}aa.ye(Pi.a.lUh,"true");tm.a.instance.KJb(aa);return aa}Zhn(b){if(!this.oG)return!1;b=this.oG.Iu(b);return!!b&&b.wf(Mc.a.V_f)}Cvo(b,h){b.cpBegin===b.cpEnd-1&&this.Dk.Cuc(b.node,h,this.jb,this.GY)}mq(b){const h=
new ni.StandardDialog;h.Fd=0;h.zy(Bf.a.fyf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,b,null,b===WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError);qa.StaticActiveAppFrame.za().Fe()}static pWh(){const b=new Ra.QueryStringBuilder("WordGraphicsEditorHandler.ashx");y.AFrameworkApplication.rja(b);return b.toString()}}Object(u.a)(EK,"GraphicsEditorRequestManager",null,[515]);class LM extends nF{constructor(b,h,r){super(b,h,r);this.FWa=ub.a.GR}r$a(b){null!=b&&0<b.length&&this.Rb.Pb(this.FWa,
2,b[0])}eck(b,h,r,A){const M=tj.a.Hg(y.AFrameworkApplication.lcid).name;b=String.format(b,y.AFrameworkApplication.lcid,M,y.AFrameworkApplication.buildVersion,h,is.YHe,r);b+="&flipgrid=1&ted=1";y.AFrameworkApplication.vd("wwa11yq3;wwa11yq3cf");y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.OnlineMediaAccessibilityChangesEnabled",!1)&&(b+="&resize_picker=1");A&&this.Q0i()&&(A=new Ra.QueryStringBuilder(b),A.PK("stream2","1"),y.AFrameworkApplication.J.$("GetCustomHeaderEnabled")&&
A.PK("enablegetcustomheader","1"),b=A.toString());return b}Q0i(){y.AFrameworkApplication.vd("EnableStream2VideosInsertion;EnableStream2VideosInsertioncf");y.AFrameworkApplication.vd("EnableStream2Videos;EnableStream2Videoscf");return y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableStream2VideosInsertion",!1)&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableStream2Videos",!1)?!0:!1}}Object(u.a)(LM,"InsertHubbleMediaHelper",
nF,[]);class MM{constructor(b,h,r,A,M,aa,oa,Ja,fb){this.FEd=!1;this.ga=b;this.Ga=h;this.WCd=r;this.z1=A;this.gAd=M;this.xl=aa;this.vmk=Ja;this.Blk=oa;this.vl=fb;this.z1.Q0i()&&oa.isFeatureEnabled("OmgStreamTwo",!1).then(Cb=>{this.FEd=Cb;this.FEd||(this.eFh=oa.Nua("OmgStreamTwo",Gb=>{this.FEd=Gb.isEnabled}))})}dispose(){this.eFh&&this.Blk.VYb("OmgStreamTwo",this.eFh)}Xb(){const b=this.F2n.bind(this);this.ga.fb(Fc.a.Wgg,lc.a.Xc,b,1028);const h=this.X7m.bind(this);this.ga.fb(Fc.a.MUf,lc.a.Xc,h,1028);
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoFromRibbonIfDisabled",!1)&&(this.V3(Fc.a.Wgg,b),this.V3(Fc.a.MUf,h))}V3(b,h){this.ga.V3("word_insertOnlineVideos",!0,b,lc.a.Xc,h,r=>{qa.StaticActiveAppFrame.za()&&this.vl&&qa.StaticActiveAppFrame.za().a2b(r,this.vl.mqb)})}X7m(b,h,r,A,M){if(1!==r){if(null==M)return 16;if(!h.Al||!ze.a.pf(h))return 2;b=this.pom(M);M=M.OriginalUrl;y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1);this.gAd.TPg(b,h,M)}return 32}cik(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("OnlineVideoFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Za.a.instance.Ra(2);b&&b.execute(h=>{h.logActivity("OnlineVideoInserted","OnlineVideoFloodgateIsEnabled")})},5E3)}pom(b){const h=new xx;h.MediaType=b.ContentType;h.Height=b.Height;h.Width=b.Width;h.IFrameHtml=b.Html;h.Title=b.Caption;h.Thumbnail=b.ThumbnailUrl;h.ProviderName=b.ProviderName;return h}F2n(b,h,r){var A,M;if(1!==r)h=I.a.zT(this.Ga.ib("UserId")).toString(),
h=this.z1.eck(this.Ga.appSettings.InsertVideoHubbleEndpoint,kb.a.create().toString(),h,this.FEd),this.z1.FWa=Fc.a.MUf,h=this.WCd.N2c(h,!0),h.correlationId=kb.a.create(),h.$ta=5,h.Iye(null,this.z1,this.vmk),ca.a.sendTelemetryEvent(Object.assign(new la.a,{name:"Office.Word.Online.OnlineMedia",dataFields:[Object.assign(new ia.a,{name:"ActionId",int64:b})]})),this.cik();else if(!(h&&h.node&&hA.a(h.node))||(null===(A=this.xl)||void 0===A?0:A.q2(h))||(null===(M=this.xl)||void 0===M?0:M.Nla(h)))return 2;
return 32}}Object(u.a)(MM,"OnlineMediaActor",null,[]);const NM={"https://hubblecontent.osi.office-int.net":"https://osiziwuspersimmon002.blob.core.windows.net","https://hubblecontent.osi.officeppe.net":"https://osizewuspersimmon001.blob.core.windows.net","https://hubblecontent.df.osi.office.net":"https://osizpscuspersimmon000.blob.core.windows.net","https://hubblecontent.msit.osi.office.net":"https://cdn.hubblecontent.msit.osi.office.net","https://hubblecontent.osi.office.net":"https://cdn.hubblecontent.osi.office.net"};
class Lu extends mF{constructor(b,h,r,A=null,M=!1){super(b,h,r,A,M);this.GHc=null;this.aeg=()=>{this.Bz&&(v.ULS.sendTraceTag(509092503,352,50,`onGetCustomHeaders : Token available: ${!!Lu.mHa} time: ${(new Date).getTime()-this.ji}`),this.Bz.sendMessage(C.a.HLj,{["CustomHeaders"]:Lu.mHa||""}))}}get telemetryEventName(){return"Office.Word.Online.OnlineMediaDialog"}q1c(){const b={};b.insertMediaServiceEndpoint=this.XCd;b.iFrameId="mediaiframe";return b}async Iye(b,h,r){r&&(this.ji=(new Date).getTime(),
Date.now()>Lu.TGh&&await this.refreshToken(r));this.L5b=b;this.GHc=h;this.yGc=!1;b={["id"]:"OnlineMediaDialog",["bodyControls"]:this.q1c(),["componentIsVisibleCallback"]:this.egk.bind(this)};this.mi(this.L5b,null,b)}egk(){this.t3=this.ljc(this.Bj("mediaiframe"));let b=this.XCd;if(y.AFrameworkApplication.J.$("NewInsertMediaServiceEndpoint")){const h=new URL(b),r=NM[h.protocol+"//"+h.host];r?b=r:v.ULS.sendTraceTag(508937025,352,10,`Target URL: ${h.host} not found`)}this.Bz=this.UId.getInstance(this.t3.contentWindow,
b);this.Bz.Vq(C.a.hMh,h=>{this.phj(h,this.GHc.r$a.bind(this.GHc))});this.Bz.Vq(C.a.insert,h=>{this.cme(h,this.GHc.r$a.bind(this.GHc))});this.Bz.Vq(C.a.FMh,this.Dkj.bind(this));this.Bz.Vq(C.a.ivi,this.aeg.bind(this));this.Bz.Vq(C.a.getSessionId,this.rjj.bind(this));this.Bz.Vq(C.a.Qsi,this.qjj.bind(this));this.Bz.Vq(C.a.PTd,this.aij.bind(this));this.Jxb(3)}Jxb(b){const h=[];h.push(Object.assign(new ia.a,{name:"DialogResult",string:lA[b]}));h.push(Object.assign(new ia.a,{name:"DialogMode",string:this.vAi()}));
h.push(Object.assign(new ia.a,{name:"CorrelationId",string:this.correlationId.toString()}));h.push(Object.assign(new ia.a,{name:"Provider",string:mA[this.$ta]||"Unknown"}));ca.a.sendTelemetryEvent(Object.assign(new la.a,{name:this.telemetryEventName,dataFields:h}))}async refreshToken(b){try{const h=await b.pV("Hubble","84a0e9dd-6e58-4aad-82af-ebe485acd09d/.default");h.IsSuccess&&(Lu.TGh=h.Telemetry.expiresOn?1E3*(h.Telemetry.expiresOn-10):0,Lu.mHa=h.Token);v.ULS.sendTraceTag(509092504,352,50,`Hubble token requested by: ${"WordInsertMediaDialog"} successful: ${!!Lu.mHa} time: ${(new Date).getTime()-
this.ji}`)}catch(h){v.ULS.sendTraceTag(508954306,352,10,`Hubble token requested by: ${"WordInsertMediaDialog"} successful: false time: ${(new Date).getTime()-this.ji} error: ${h} `)}}}Lu.TGh=0;Object(u.a)(Lu,"OnlineMediaDialog",mF,[]);class CF{constructor(b,h){this.aVe=b;this.z1=h}N2c(b,h=!1){return new Lu(b,this.aVe,this.z1,null,h)}getInstance(){throw Error.notImplemented();}}Object(u.a)(CF,"OnlineMediaDialogFactory",null,[518]);class bC extends Tx{constructor(){super(1,3);this.bO=Za.a.instance.resolve(728);
this.sZj=!1}eeb(){y.AFrameworkApplication.va.Ob(Fc.a.jxc,2)}x0d(){this.Zni&&!this.zw&&(this.zw=this.OQa())}i1d(){if(this.zw&&this.zw.isVisible){var b=Object(ya.a)(vl.a,this.zw.controls["ExternalContentFloatie.FlyoutAnchor"]);b.behavior.ey(b.sqb(),1,null)}b=document.getElementById("ExternalContentFloatieFlyout");if(null==b)v.ULS.shipAssertTag(555816415,324,!1,"ExternalContentFloatieEventManger.onOnlyKeyPressed: externalContentFloatieUIElement is null.");else{var h=b.getBoundingClientRect();0<h.top&&
h.bottom<window.innerHeight&&(h=b.getAttribute(Ne.a.dSd)||"",Ne.a.FO===h&&b.click())}}f3(){return this.bO.f3}}Object(u.a)(bC,"ExternalContentFloatieManager",Tx,[]);class ir{constructor(){ir.V4m()}get Wb(){return null!=this.Z5g?this.Z5g:this.Z5g=Za.a.instance.resolve(8)}get key(){return"FORMATTING_PARAGRAPH"}get Cv(){return null}K1b(b){var h=null;if(!Gd.ParagraphReader.Bh(b))return{returnValue:!1,Eea:h};if((b=this.Wb.Aq(b.currentNode))&&2===this.Wb.BF(b)){const r=this.Wb.ze(b);ir.qT.contains(r)&&(h=
this.Wb.xL(b),h=Object.assign(new qC.a,{NF:this.key,contentId:b.id,contentObject:h}))}return{returnValue:!!h,Eea:h}}oqb(b,h){let r=null;h&&b.contentId.equals(h.contentId)||(r=b.contentObject);return r}static V4m(){ir.qT=new bp.a;ir.qT.add(Zl.StyleReader.styleIdHeading1);ir.qT.add(Zl.StyleReader.styleIdHeading2);ir.qT.add(Zl.StyleReader.styleIdHeading3);ir.qT.add(Zl.StyleReader.I0b);ir.qT.add(Zl.StyleReader.Rpd);ir.qT.add(Zl.StyleReader.Spd);ir.qT.add(Zl.StyleReader.lAe);ir.qT.add(Zl.StyleReader.kAe);
ir.qT.add(Zl.StyleReader.wordStyleIdHeading1);ir.qT.add(Zl.StyleReader.wordStyleIdHeading2);ir.qT.add(Zl.StyleReader.wordStyleIdHeading3);ir.qT.add(Zl.StyleReader.XAc);ir.qT.add(Zl.StyleReader.YAc);ir.qT.add(Zl.StyleReader.ZAc);ir.qT.add(Zl.StyleReader.Otd);ir.qT.add(Zl.StyleReader.Ptd);ir.qT.add(Zl.StyleReader.Qtd);ir.qT.add(Zl.StyleReader.yAb);ir.qT.add(Zl.StyleReader.Rtd)}}ir.qT=null;Object(u.a)(ir,"ParagraphStyleDetailsProvider",null,[719,257]);class OM{constructor(b,h,r,A){this.SQa=b;this.gBk=
h;this.pBk=r;this.qBk=A}Tpg(){this.SQa.execute(b=>{b.NYb(this.gBk.value);b.NYb(new ir);b.NYb(this.qBk.value);b.XX(this.pBk.value)})}}Object(u.a)(OM,"AccessibilityActor",null,[]);class jO{constructor(b,h,r){this.zi=null;this.Dod=(A,M,aa)=>{if(1===aa)return 32;this.zi=this.wFc.value.NAl(this.Yb);if(!this.zi)return v.ULS.sendTraceTag(21233673,334,10,"AccessibilityHelpDialog failed to initialize"),8;this.zi.x_a();return 32};this.fKh=A=>this.zi?this.zi.KUm(A):2;this.ga=b;this.wFc=h;this.Yb=r}Xb(){if(y.AFrameworkApplication.J.$("UIDiscoverabilityEnabled")){var b=
Xb.KeyInputManager.mc(cf.a.LAb,5);this.Yb.ie(id.AFrame.Ro).nt(b);this.Yb.ie(id.AFrame.Eq).bindAction(b,Ka.a.Dod);this.ga.qa(Ka.a.Dod,we.a.frame,this.Dod);this.ga.qa(Ka.a.eRc,we.a.frame,this.fKh);this.ga.qa(Ka.a.dRc,we.a.frame,this.fKh)}}}Object(u.a)(jO,"AccessibilityHelpDialogActor",null,[]);var kO=d(1022),lO=d(1269);class PM{constructor(b,h){this.Xvk=b.ic("WordHangForActionManagerThresholdTime",750);this.ga=h;this.mkk=kO.a.TG(26,5,new lO.a)}A0(){this.ga.A0(this)}T7(){}R7(b){const h=+b.endTime-+b.startTime;
if(h>this.Xvk){let r="";switch(b.behavior){case 1:r="E";break;case 2:r="X";break;case 3:r="A"}(b=ce.ActionManager.dea(b.actionId))&&b.length||(b="UnknownAction");this.mkk.track(h,b+"_"+r)}}}Object(u.a)(PM,"ActionHangDetector",null,[148]);var QM=d(2139);class RM extends Dc{constructor(b,h=null){super(b,void 0,y.AFrameworkApplication.w7a,new Ob(b,!1),void 0,void 0,h)}get sbb(){return this.Tce?CommonUIStrings.l_DownloadACopyDialog_EmailALinkText:CommonUIStrings.l_DownLoadACopyDialogMessageWorkOffline}get Rpc(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get Rad(){return"DownloadCopyLink"}get buttonText(){return CommonUIStrings.l_DownloadACopyMin}get qXc(){return y.AFrameworkApplication.w7a?
"UIFontDialogTextLarge":null}get Tce(){return"VersionHistory"===this.GYh?!1:!y.AFrameworkApplication.ua.Ib.isBusinessUser&&!y.AFrameworkApplication.ua.Ib.isEduUser}vhe(){v.ULS.sendTraceTag(7690388,324,50,"Download a copy dialog displayed")}d5f(){v.ULS.sendTraceTag(7690389,324,50,"Download a copy dialog clicked")}obd(){v.ULS.sendTraceTag(19462214,324,50,"Download a copy dialog button clicked");y.AFrameworkApplication.va.Ob(Ka.a.Egi,2)}}Object(u.a)(RM,"DownloadACopyDialog",Dc,[]);var FK;(function(b){b[b.Unknown=
0]="Unknown";b[b.Excel=1]="Excel";b[b.OneNote=2]="OneNote";b[b.PowerPoint=3]="PowerPoint";b[b.Visio=4]="Visio";b[b.Word=5]="Word";b[b.Project=6]="Project";b[b.zMp=7]="Publisher";b[b.PKp=8]="Infopath";b[b.ZHp=9]="Access"})(FK||(FK={}));Object(u.b)("OfficeApplication",FK);var uI;(function(b){b[b.ReadWrite=0]="ReadWrite";b[b.ReadOnly=1]="ReadOnly";b[b.TOp=2]="WriteOnly";b[b.pKp=3]="ForceCheckout";b[b.SOp=4]="WriteLocalCopy";b[b.ZLp=5]="OpenInBrowser"})(uI||(uI={}));Object(u.b)("OpenDocumentMode",uI);
class SM extends ig.a{constructor(){super(!1,!1,!0)}Gne(){var b={["description"]:"We'd love to understand why you're opening this document in the Desktop App. Why did you decide to leave Word for the web?",["actionButtonLabel"]:Box4Intl.Box4Strings.l_WordPredictionFeedbackActionLabel};const h=Array(5);h[0]={["key"]:"0",["text"]:"I can't open my document in Word for the web"};h[1]={["key"]:"1",["text"]:"I didn't intend to open this document online"};h[2]={["key"]:"2",["text"]:"Word for the web was glitchy with this document"};
h[3]={["key"]:"3",["text"]:"I need features in the Desktop App for this document"};h[4]={["key"]:"4",["text"]:"I prefer the Desktop App"};b.selectionOptions={["id"]:"reasonsList",["options"]:h};b={["id"]:"OpenInClientFeedbackDialog",["bodyControls"]:b};this.mi("Send feedback to Microsoft",this.ATo.bind(this),b);return new Promise(r=>{this.hEk=r})}ATo(b,h){1===b&&this.wha(h.selectedReason)}dispose(){super.dispose();this.hEk()}wha(b){const h={},r={},A={},M={},aa={};h.appId=2155;h.manifestType="Fps";
h.submitTime=(new Date).toISOString();h.source="Client";h.type="Survey";h.clientFeedbackId=kb.a.create().toString();aa.reason=b;const oa={},Ja={numberOfOptions:5};Ja.selectedRating=b;oa.rating=[Ja];M.surveySpecificData=JSON.stringify(oa);A.extendedManifestData=JSON.stringify(M);h.application=A;aa.surveyId="4938d2fd-3840-4f39-9073-1b7522395873";h.survey=aa;h.telemetry=this.OKb();h.web=this.ATc();r["Content-Type"]="application/json";this.bNa(JSON.stringify(h),r)}gea(b,h,r,A){h&&b&&A&&r&&A in h&&(b[r]=
h[A])}OKb(){const b=y.AFrameworkApplication.sessionStartInfoSettings,h={};h.officeBuild=y.AFrameworkApplication.buildVersion;h.featureArea="Open In Desktop App";this.gea(h,b,"audienceGroup","AudienceGroup");this.gea(h,b,"osBuild","OsVersion");this.gea(h,b,"platform","Platform");this.gea(h,b,"processSessionId","WACSessionID");return h}ATc(){const b=y.AFrameworkApplication.sessionStartInfoSettings,h={};this.gea(h,b,"browser","Browser");this.gea(h,b,"browserVersion","BrowserVersion");this.gea(h,b,"dataCenter",
"WACDatacenter");return h}bNa(b,h,r=0){let A=0;3<r||(1===r?A=200:1<r&&(A=200+500*(r-1)),y.AFrameworkApplication.oc.Zb(new xc.a(2,1,A,()=>{y.AFrameworkApplication.Ee.Wj("https://petrol.office.microsoft.com/v1/feedback",2,b,h,!1,2,()=>{v.ULS.sendTraceTag(512341407,211,50,"Success sending OCV feedback for Open In Client")},()=>{this.bNa(b,h,r+1);v.ULS.sendTraceTag(512341406,211,50,"Failure sending OCV feedback for Open In Client, attempt {0}",r)},null)})))}}Object(u.a)(SM,"WordOpenInClientFeedbackDialog",
ig.a,[]);var cC=d(1328),TM=d(1767);const vI=b=>{for(let h=0;h<b.children.length;h++){const r=b.children[h];r.style.position="relative";r.style.top=(r.parentNode.offsetHeight-r.offsetHeight)/2+"px"}},GK=b=>b.Nb.keyCode===cf.a.Nu||b.Nb.keyCode===cf.a.y0a?(b.If.click(),!0):!1,wI=(b,h,r,A,M,aa,oa)=>{const Ja=document.createElement("a");Ja.className="ProtocolLaunchingDialogButtonAnchor";Ja.className+=" OICDialog";Ja.id=b;Ja.setAttribute(Ne.a.Ph,Ne.a.K$);Ja.style.padding="0";Ja.style.margin="0";A&&UM(M,
h,r,A,Ja);b=document.createElement("span");b.className="ProtocolLaunchingDialogButtonLabel";b.innerText=M;Ja.appendChild(b);Ja.tabIndex=0;aa&&Qc.a.instance.nb(Jd.a.click,Ja,aa);oa&&Xb.KeyInputManager.instance.nb(Jd.a.pi,Ja,oa);return Ja},UM=(b,h,r,A,M)=>{var aa=document.createElement("img");aa.alt=b;aa.className=Gg.getImageClassWithCluster(r,A);aa.src=h;aa.setAttribute(Ne.a.Ph,Ne.a.wA);b=document.createElement("span");b.className="ProtocolLaunchingDialogImg32Container";b.appendChild(aa);aa=document.createElement("span");
aa.className="ProtocolLaunchingDialogIconContainer";aa.appendChild(b);M.appendChild(aa)};class VF{static get kh(){return ig.a.Ry(VF.Hn,CommonUIStrings.l_OICLaunchDialogTitle)}}VF.Hn="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(u.a)(VF,"OICLaunchDialogHtml",null,[]);class NL extends ig.a{constructor(b){super();this.h4b=this.yBb=null;this.OV=!1;this.Rlj=()=>{this.hide();this.ep.Xuc();return!0};this.Xlj=()=>{v.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();y.AFrameworkApplication.va.Ob(Ka.a.tZb,2);return!0};this.NQn=()=>{this.ep.Xuc()};this.ep=b;this.kh=VF.kh;this.Fd=5;this.Ng="OICLaunchDialog";this.showDialog("",this.NQn);this.JMj();this.t8("ProtocolLaunchingDialogTitle");4!==y.AFrameworkApplication.ua.Ib.LUa&&
(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.c4(this.yBb);v.ULS.sendTraceTag(22140865,211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Cba(){this.yBb=wI("BtnRichClient",this.ep.JYc,this.ep.t6c,this.ep.gTf,CommonUIStrings.l_OICLaunchRichClient,this.Xlj,GK);document.getElementById("OICLaunchRichClient").appendChild(this.yBb);vI(this.yBb);this.h4b=wI("BtnReturn",this.ep.JYc,
this.ep.t6c,this.ep.QOi,CommonUIStrings.l_OICReturnToOnlineClient,this.Rlj,GK);document.getElementById("OICReturnToApp").appendChild(this.h4b);vI(this.h4b)}dispose(){this.OV||(this.yBb&&(Qc.a.instance.xc(Jd.a.click,this.yBb,this.Xlj),Xb.KeyInputManager.instance.xc(Jd.a.pi,this.yBb,GK)),this.h4b&&(Qc.a.instance.xc(Jd.a.click,this.h4b,this.Rlj),Xb.KeyInputManager.instance.xc(Jd.a.pi,this.h4b,GK)),super.dispose(),this.OV=!0)}}Object(u.a)(NL,"OICLaunchDialog",ig.a,[]);class zA{static get kh(){return ig.a.Ry(zA.Hn,
CommonUIStrings.l_OICDialogTitle)}}zA.Hn="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(u.a)(zA,"ProtocolLaunchingDialogV2Html",null,[]);class dL extends ig.a{constructor(b){super();this.g4b=this.b1a=null;this.OV=!1;this.Hgb=null;this.ajj=h=>this.Ycg(h,0);this.tjj=h=>this.Ycg(h,2);this.Qlj=h=>this.Ycg(h,1);this.Yij=()=>{this.hide();4===y.AFrameworkApplication.ua.Ib.LUa?(v.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.ep.Xuc()):(v.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.ep.L4c());return!0};this.Ple=()=>{v.ULS.sendTraceTag(37339423,
211,50,"Open give feedback dialog");return!0};this.Nme=()=>{v.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";y.AFrameworkApplication.va.Ob(Ka.a.tZb,2);return!0};this.Hmg=()=>{this.ep.Xuc()};this.ep=b;this.kh=zA.kh;this.Fd=5;this.Ng="ProtocolLaunchingDialog";this.XEc="OICRetryDialog";y.AFrameworkApplication.oc.wrb&&y.AFrameworkApplication.oc.restart();y.AFrameworkApplication.oc.Zb(new xc.a(2,1,5E3,()=>{this.Kcp()},101));this.showDialog("",
this.Hmg);this.JMj();this.t8("Issues");this.qoi();v.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Cba(){const b=document.getElementById("Issues");if(b){UM("",this.ep.JYc,this.ep.t6c,this.ep.gTf,b);const h=document.createElement("span");h.className="WACDialogSectionTitle";h.innerText=5===this.ep.Pnj?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;b.appendChild(h);vI(b);b.style.display="none"}y.AFrameworkApplication.ua.Ib.tJi?
(this.g4b=wI("GiveFeedback",this.ep.JYc,this.ep.t6c,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,this.Ple,this.tjj),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.g4b),vI(this.g4b)):document.getElementById("ButtonGiveFeedback").style.display="none";0===y.AFrameworkApplication.ua.Ib.LUa||y.AFrameworkApplication.MRl?document.getElementById("ButtonEdit").style.display="none":(this.b1a=wI("Edit",this.ep.JYc,this.ep.t6c,"",2===y.AFrameworkApplication.ua.Ib.Uk?4===
y.AFrameworkApplication.ua.Ib.LUa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===y.AFrameworkApplication.ua.Ib.LUa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,this.Yij,this.ajj),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.b1a),vI(this.b1a));0===y.AFrameworkApplication.ua.Ib.LUa&&!y.AFrameworkApplication.uZf&&b&&(b.style.display="none")}roi(){return this.Hgb?(this.c4(this.Hgb),!0):!1}qoi(){return this.b1a?
(this.c4(this.b1a),!0):!1}Ycg(b,h){let r=!1;if(b.Nb.keyCode===cf.a.Nu||b.Nb.keyCode===cf.a.y0a)b.If.click(),r=!0;else if(b.Nb.keyCode===Sys.UI.Key.down||b.Nb.keyCode===Sys.UI.Key.up)switch(h){case 1:r=this.qoi();break;case 0:r=this.roi()}return r}Heg(){fL.Redirect.showHelp("OICFailure");return!0}Kcp(){var b=document.getElementById("ProtocolLaunchingDialogTitle");if(b){b.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(b=document.getElementById("Issues"))b.style.display="block";(b=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&
!b.children.length&&(this.Hgb=wI("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,this.Nme,this.Qlj),b.appendChild(this.Hgb),vI(this.Hgb),this.b1a||this.roi())}}dispose(){this.OV||(this.b1a&&(Qc.a.instance.xc(Jd.a.click,this.b1a,this.Yij),Xb.KeyInputManager.instance.xc(Jd.a.pi,this.b1a,this.ajj)),this.g4b&&(Qc.a.instance.xc(Jd.a.click,this.g4b,this.Ple),Xb.KeyInputManager.instance.xc(Jd.a.pi,this.g4b,this.tjj)),this.Hgb&&(Qc.a.instance.xc(Jd.a.click,this.Hgb,this.Nme),Xb.KeyInputManager.instance.xc(Jd.a.pi,
this.Hgb,this.Qlj)),super.dispose(),this.OV=!0)}}Object(u.a)(dL,"ProtocolLaunchingDialog",ig.a,[]);class WF extends ni.StandardDialog{constructor(b){super();this.Ple=h=>{v.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");this.fjj(h)};this.Nme=()=>{v.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");y.AFrameworkApplication.va.Ob(Ka.a.tZb,2)};this.Hmg=h=>{WF.CLi?3===h?this.EFj():2===h||0===h?this.d6h():1===h&&this.vec():2===h?this.EFj():(1===h||0===h)&&this.d6h()};this.ep=b;this.Ng=
"ProtocolLaunchingDialog";y.AFrameworkApplication.oc.wrb&&y.AFrameworkApplication.oc.restart();y.AFrameworkApplication.ua.Ib.tJi&&this.tUk(this.Ple);WF.CLi?(this.Fd=12,this.Qe(1,CommonUIStrings.l_CloseFile),this.Qe(2,CommonUIStrings.l_OICDialogContinueHere),this.Qe(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Fd=4,this.Qe(1,CommonUIStrings.l_OICDialogContinueHere),this.Qe(2,CommonUIStrings.l_OICDialogLaunchAgain));this.zub(CommonUIStrings.l_OICDialog2ndTitle,5===this.ep.Pnj?CommonUIStrings.l_OICBrowserDialogTitle:
CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,this.Hmg,null)}vec(){v.ULS.sendTraceTag(577783557,211,50,"Closing the document");y.AFrameworkApplication.va.Pb(Ka.a.close,2,ul.a)}EFj(){v.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(this.Nme,0)}d6h(){4===y.AFrameworkApplication.ua.Ib.LUa||y.AFrameworkApplication.J.$("WordConsumptionViewToEditRedirectIsEnabled")&&1===y.AFrameworkApplication.ua.mode?(v.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),
this.ep.Xuc()):(v.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.ep.L4c())}static get CLi(){return y.AFrameworkApplication.J.$("OICDialogThreeActions")&&32===y.AFrameworkApplication.va.Ob(Ka.a.close,1)}}Object(u.a)(WF,"StandardProtocolLaunchingDialog",ni.StandardDialog,[]);class eL{}Object(u.a)(eL,"EditDocumentInClientParams",null,[]);class OL{static ahi(b,h,r,A,M,aa,oa=!1,Ja=!1,fb="",Cb=!1,Gb=!1,Sb=!1,pc="",zc="",Yc="",Kd=!1,ke=""){const ge=new eL;ge.DocumentUrl=b;ge.DocumentExtension=
ke;ge.Mode=h;ge.Options=r;ge.Application=A;ge.SilentExternalHandler=oa;ge.EncodeUrl=Ja;ge.CorrelationIdForWinClient=fb;ge.NavigateUsingWindowOpen=Cb;ge.DescriptiveUnattemptedEnums=Gb;ge.NoBrowserModalDialogs=Sb;ge.SessionOrigin=pc;ge.CorrelationId=zc;ge.ClickTime=Yc;ge.NewTelemetryDataIsEnabled=Kd;MSOJS.ClientUtils.EditDocumentInClient(ge,M,aa)}}Object(u.a)(OL,"ClientUtils",null,[]);var mO=d(544),VM=d(933);class IA{constructor(b){this.P3a=this.TFc=this.RDc=null;this.bHc=!1;this.qPe=this.b_e=this.lvh=
null;this.bxd=this.kA=this.zLd="";this.application=this.vC=0;this.scp=this.BFg=!1;this.WEo=(h,r,A)=>r.contextId!==we.a.frame?2:1===A?32:this.tZb();this.$gj=()=>{this.wof()};this.ahj=()=>{this.Xuc()};this.Ujj=()=>{this.B4i()};this.A_m=()=>this.Dei(!0);this.ezp=b&&y.AFrameworkApplication.J.$("OICLaunchDialogIsEnabled");y.AFrameworkApplication.va.H2(Ka.a.tZb)||y.AFrameworkApplication.va.qa(Ka.a.tZb,we.a.frame,this.WEo);this.OTj=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("SilentExternalHandler")}get Pnj(){return this.vC}sWo(b,
h="",r=""){this.kA=r||kb.a.create().toString();this.zLd=h||mO.a.pBi();this.bxd=b}get options(){let b=0;y.AFrameworkApplication.cCo&&(b|=1);y.AFrameworkApplication.Xnj&&(b|=4);this.mcp()&&(b|=64);return b}mcp(){return!(2===this.application&&y.AFrameworkApplication.J.$("IsEmbeddedScenario"))}get JYc(){return y.AFrameworkApplication.Ss}get t6c(){return y.AFrameworkApplication.xfa}get QOi(){return""}get gTf(){return""}get rcp(){return y.AFrameworkApplication.J.$("OneNoteMobileViewerIsEnabled")}get hgp(){return this.lvh||
(this.lvh=Za.a.instance.resolve(120))}wof(){this.BFg||this.V0l()}Xuc(){this.scp||this.Cki()}ixj(b){return this.ezp&&Y.a.Ci?(new NL(this),32):this.b4h(b)}b4h(b){const h=({Mzb:b}=this.kun(b)).returnValue;v.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===h,b);return h}Ec(b,h,r,A,M,aa,oa=""){this.RDc=b;this.qPe=oa;this.TFc=h;this.P3a=aa;this.application=r;this.vC=A;return y.AFrameworkApplication.Lgi?(this.B4i(),32):y.AFrameworkApplication.Mta&&!y.AFrameworkApplication.DNi?(y.AFrameworkApplication.KCg(),
8):this.vUh(M)}get MQn(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}tZb(){this.MQn&&this.bzn();return this.b4h(this.bHc)}WJj(){const b=new VM.a(C.a.KX);b.Values["ui-language"]=y.AFrameworkApplication.lcid.toString();b.Values[jz.a.Dai]=y.AFrameworkApplication.userSessionId;return this.P3a.value.send(b)?32:8}bzn(){Ba.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",["OpenInClientFailed"],
!1,!1,!1,!1,Object.assign(new bb.a,{inStaging:!1}))}EMo(b){const h=new VM.a(C.a.gCp);h.Values["ui-language"]=y.AFrameworkApplication.lcid.toString();h.Values[jz.a.Dai]=y.AFrameworkApplication.userSessionId;h.Values[F.a.fCp]=b;this.P3a.value.send(h)}kun(b){this.bHc=b;this.EMo(5===this.vC?IA.o2n:IA.u2n);return 5===this.vC?this.jun():this.nun()}jun(){this.L4i();return{returnValue:32,Mzb:"HostEditUrl,"}}nun(){let b;var h=b="";y.AFrameworkApplication.jNh&&(h="|f|"+y.AFrameworkApplication.userSessionId);
const r=y.AFrameworkApplication.J.$("IsAssignmentMode")&&y.AFrameworkApplication.J.$("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||y.AFrameworkApplication.C$c||Y.a.wXa,A=y.AFrameworkApplication.J.$("UnattemptedEnumIsEnabled"),M=y.AFrameworkApplication.J.$("NoBrowserModalDialogs");if(y.AFrameworkApplication.va.gke){var aa=y.AFrameworkApplication.va.AR(3588168074);aa&&this.sWo(aa.epochClickTime,aa.sessionOrigin,aa.correlationId);this.s9i()}if(y.AFrameworkApplication.Osj){b+="NewOrder,";
aa=8;this.P3a&&this.P3a.value&&this.P3a.value.isEnabled()&&y.AFrameworkApplication.r2b&&(b+="Post,",aa=this.WJj());if(32===aa)return{returnValue:aa,Mzb:b};v.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return y.AFrameworkApplication.Ft.Kba?(v.ULS.shipAssertTag(5566816,211,!!y.AFrameworkApplication.Ft.Kba),b+="HostUrl,",{returnValue:y.AFrameworkApplication.ua.HX(!0,y.AFrameworkApplication.Ft.Kba),Mzb:b}):this.RDc?(v.ULS.sendTraceTag(18715405,211,15,
"Try to open doc in rich client, SessionId {0}",y.AFrameworkApplication.userSessionId),b+="DocUrl,",OL.ahi(this.RDc,this.vC,this.options,this.application,Object(E.a)(this,this.$ij,"onEditInClientSuccess"),Object(E.a)(this,this.Zij,"onEditInClientFailure"),this.OTj,y.AFrameworkApplication.J.$("OICEncodeUrlIsEnabled"),h,r,A,M,this.zLd,this.kA,this.bxd,y.AFrameworkApplication.va.gke,this.qPe),{returnValue:32,Mzb:b}):{returnValue:8,Mzb:b}}b+="OldOrder,";if(!this.RDc&&y.AFrameworkApplication.Ft.Kba)return this.P3a&&
this.P3a.value&&this.P3a.value.isEnabled()&&y.AFrameworkApplication.r2b?(b+="Post,",h=this.WJj()):(v.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),h=8),32!==h?(v.ULS.shipAssertTag(22595484,211,!!y.AFrameworkApplication.Ft.Kba),b+="HostUrl,",{returnValue:y.AFrameworkApplication.ua.HX(!0,y.AFrameworkApplication.Ft.Kba),Mzb:b}):{returnValue:h,Mzb:b};v.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",y.AFrameworkApplication.userSessionId);
b+="DocUrl,";OL.ahi(this.RDc,this.vC,this.options,this.application,Object(E.a)(this,this.$ij,"onEditInClientSuccess"),Object(E.a)(this,this.Zij,"onEditInClientFailure"),this.OTj,y.AFrameworkApplication.J.$("OICEncodeUrlIsEnabled"),h,r,A,M,this.zLd,this.kA,this.bxd,y.AFrameworkApplication.va.gke,this.qPe);return{returnValue:32,Mzb:b}}cBo(b){y.AFrameworkApplication.wn.setDw(8981,b)}$ij(b){this.cBo(b);v.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===b&&MSOJS.ClientUtils.ShouldShowDialog()?
(this.rcp||this.L4i(),this.s9i()):this.BFg||this.wof()}Zij(b,h=0){v.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",b,h);if(5===b)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const r=!!this.TFc&&!this.bHc;let A=0;1===b&&(A=2);6<=b&&13>=b&&(A=1,1===h&&(this.BFg=!0));this.hgp.xQn?(v.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",A),TM.a.instance.TFl(this.bHc?this.$gj:this.ahj,r?this.Ujj:null,
this.Dei(!1)?this.A_m:null,A,h)):(v.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",A),TM.a.instance.RFl(this.bHc?this.$gj:this.ahj,r?this.Ujj:null,A))}}s9i(){try{const b=[Object.assign(new ia.a,{name:"CorrelationId",string:this.kA}),Object.assign(new ia.a,{name:"SessionOrigin",string:this.zLd}),Object.assign(new ia.a,{name:"ClickTime",string:this.bxd}),Object.assign(new ia.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];ac.a("OpenInClientCompleted",
!0,0,b)}catch(b){v.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+b.toString())}}L4i(){y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.cH&&y.AFrameworkApplication.J.$("StandardProtocolDialogIsEnabled")?new WF(this):new dL(this)}Dei(b){const h=(Y.a.S8c||Y.a.eu)&&!!y.AFrameworkApplication.HZd;h&&b&&(Le.a.un(y.AFrameworkApplication.HZd,"_blank",void 0,"OpenInClient"),this.wof());return h}}IA.u2n="OpenInDesktop";IA.o2n="OpenInBrowser";Object(u.a)(IA,"AOpenInClientOperation",
null,[]);class PL extends IA{constructor(b,h,r=!1){super(r);this.fxk=b;this.exk=h}get QOi(){return this.exk}get gTf(){return this.fxk}V0l(){y.AFrameworkApplication.va.Pb(Ka.a.close,2,ul.a)}Cki(){}vUh(b){return this.ixj(b)}B4i(){v.ULS.shipAssertTag(5566817,211,!!this.TFc);y.AFrameworkApplication.Jfa?y.AFrameworkApplication.ua.HX(!0,this.TFc):Le.a.un(this.TFc,void 0,void 0,"LaunchDownload")}L4c(){y.AFrameworkApplication.ua.Ib.L4c()}}Object(u.a)(PL,"OpenInClientOperation",IA,[]);class xI extends PL{constructor(){super("Word_32x32x32",
"EditInWordWebApp_32x32x32",!0);this.Zto=b=>{v.ULS.sendTraceTag(50857160,211,50,"Saving finished. Release lock before open in client");df.a.wna?df.a.Ak.Ajd(!1,"OpenInWordOperation").then(()=>{this.Xgg(b)}).catch(()=>{this.m8i(b,-1)}):df.a.nV.xF(this.Xgg,this.m8i,b)};this.m8i=b=>{v.ULS.sendTraceTag(50857161,211,15,"Lock release failed.");const h=new ni.StandardDialog;h.Fd=0;h.zy(Bf.a.$op,CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.l_UnlockFailed,b?this.Ayn:this.Byn)};this.Ayn=
()=>{y.AFrameworkApplication.va.Pb(Ka.a.close,2,ul.c)};this.Byn=()=>{qa.StaticActiveAppFrame.za().j8(null)};this.Xgg=b=>{y.AFrameworkApplication.eqd=!0;v.ULS.sendTraceTag(50857162,211,50,"Saving finished. Ready to OpenWordClient with forceClose: {0}.",b);this.ixj(b)}}gal(b){df.a.gf.Dbb.bmc||Of.a.ud().iC.Do?(v.ULS.sendTraceTag(50857159,211,15,"Saving skipped due to document loading failure"),this.Xgg(b)):hv.a.fU(cC.a.boj,!0,this.Zto,null,b)}vUh(b){this.gal(b);return 32}Cki(){qa.StaticActiveAppFrame.za().j8(null)}}
Object(u.a)(xI,"OpenInWordOperation",PL,[]);const WM=(b,h)=>{v.ULS.sendTraceTag(41186076,306,50,"Toggling readonly recommended setting for the document.");b[Vg.a.On]=Um.PageReader.instance.ow(h);Um.PageReader.instance.ow(h)?b[Vg.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOn:b[Vg.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOff},nO=(b,h,r,A,M)=>{if(!qa.StaticActiveAppFrame.za()||!qa.StaticActiveAppFrame.za().kb||!y.AFrameworkApplication.Dn.$pb)return 8;h=
qa.StaticActiveAppFrame.za().kb.$c;if(!h)return 8;if(b===ub.a.uqe&&2===r){b=new Rb.GraphTransaction(15);try{b.Bb(h),Um.PageReader.instance.gip(h)}finally{b&&b.dispose()}WM(M,h)}return 32},oO=(b,h,r,A,M)=>{if(!qa.StaticActiveAppFrame.za()||!qa.StaticActiveAppFrame.za().kb)return 8;b=qa.StaticActiveAppFrame.za().kb.$c;if(!b)return 8;M[Vg.a.Alt]=y.AFrameworkApplication.Dn.$pb?"":CommonUIStrings.l_ProtectDocumentToolTip;WM(M,b);return 32};var pO=d(1073);class XM extends QM.a{constructor(b,h){super(b,
h);this.Dph=this.Cph=this.woh=!1;this.eSc=new ib.a("docx doc docm dot dotx odt dotm".split(" "));this.ecd=100;this.Bkj=(r,A,M,aa,oa)=>{var Ja;if(A.contextId!==we.a.frame)return 2;if(!(df.a.WUc||y.AFrameworkApplication.Ft.Kba||y.AFrameworkApplication.r2b||this.woh))return v.ULS.sendTraceTag(50857163,211,15,"OIC entry is hidden"),this.woh=!0,8;if(1===M)return ec.SessionStatusManager.instance.Hk?8:32;let fb=!1;void 0!==oa&&null!==oa&&(fb=oa);if(null===(Ja=y.AFrameworkApplication.J)||void 0===Ja?0:Ja.getBooleanFeatureGate("Microsoft.Office.WordOnline.OpenInClientFeedback",
!1))(new SM).Gne().then(()=>this.GWb(r,fb));else return this.GWb(r,fb);return 32};this.yEe=(r,A,M)=>{if(1==M){if(!pO.a.tWe)return this.Cph||(v.ULS.sendTraceTag(508703937,231,50,"Open files from PC is shown as disabled"),this.Cph=!0),64;if(!y.AFrameworkApplication.Ee.SAc)return this.Dph||(v.ULS.sendTraceTag(508598026,231,50,"Open files from PC is shown as disabled due to empty token"),this.Dph=!0),64}else if(2==M)return ac.a("OpenFileFromPC"),(r=this.JHl())?this.r4o(M,r):2;return 32};this.STl=r=>{this.Pzn();
if(!y.AFrameworkApplication.C$c&&y.AFrameworkApplication.ua.Ib.NAg(Ka.a.Pea.toString()))this.ODa(!0,C.a.download,!0,{});else if(y.AFrameworkApplication.J.$("WordEditorDownloadACopyUiIsEnabled")){let A=y.AFrameworkApplication.rNb,M=null;r&&(r.FileDownloadUrl&&(A=r.FileDownloadUrl.toString()),r.CallSource&&(M=r.CallSource.toString()));new RM(A,M)}else super.Pea(0,null,2,null,null)};this.wil=r=>{super.workflow(0,null,2,null,r)};this.M5=Za.a.instance.Ra(2)}get BUf(){this.Hlh||(this.Hlh=Za.a.instance.resolve(1094));
return this.Hlh}Xb(){super.Xb();this.ga.qa(ub.a.KX,we.a.frame,this.Bkj);y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OICExtendedTelemetryIsEnabled",!1)&&this.ga.Pc(ub.a.KX,12288);var b=this.ga;b.fb(ub.a.uqe,lc.a.application,nO,4);b.fb(ub.a.Qng,lc.a.application,oO,96);this.ga.qa(Ka.a.Rgg,we.a.frame,this.Bkj);this.ga.qa(ub.a.k8j,lc.a.view,this.yEe);this.ga.qa(ub.a.l8j,lc.a.view,this.yEe)}GWb(b,h){v.ULS.sendTraceTag(50857164,211,50,"OpenInClient begin. Expect saving starting soon.");
return(new xI).Ec(df.a.WUc,y.AFrameworkApplication.rNb,FK.Word,b===Ka.a.Rgg?uI.OpenInBrowser:uI.WriteOnly,h,new Qf.a(()=>this.K_))}BSd(b){return Uk.a.instance.jIa()?!0:qa.StaticActiveAppFrame.za().sHj(cC.a.vec,rt.a.orl,b)}JHl(){return()=>{window.addEventListener("fileUploadedSuccessfully",this.Tkp,{once:!0});this.BUf.SSo(this.ecd);this.BUf.XNo(this.eSc);this.BUf.showDialog()}}r4o(b,h){return 2===b?(h(),32):2}Tkp(){window.addEventListener("focus",()=>{const b=Za.a.instance.Ra(2);null!=b&&b.execute(h=>
{ac.a("triggerUploadFileFeatureSurvey");h.logActivity("UploadFileFeatureSurvey","UploadFileFloodgateSurveyIsEnabled")})},{once:!0})}Pea(b,h,r,A,M){if(2===r){if(!y.AFrameworkApplication.rNb&&!y.AFrameworkApplication.ua.Ib.NAg(Ka.a.Pea.toString()))return 8;hv.a.fU(cC.a.Pea,!0,this.STl,null,M);return 32}return super.Pea(b,h,r,A,M)}Pzn(){y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=this.M5&&this.M5.execute(b=>b.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity",
"CollabCornerFloodgateSurveysIsEnabled"))}workflow(b,h,r,A,M){return 2===r?(hv.a.fU(cC.a.workflow,!0,this.wil,null,M),32):super.workflow(b,h,r,A,M)}}Object(u.a)(XM,"AppFrameCommandUIActor",QM.a,[]);class YM extends ni.StandardDialog{constructor(){super();this.Fd=0;this.zub(CommonUIStrings.l_WheresTheSaveButtonDialogTitle,CommonUIStrings.l_WheresTheSaveButtonDialogMessage,"WheresTheSaveButtonDialogItem_32x32x32",CommonUIStrings.l_WheresTheSaveButtonDialogTitle,null,null)}}Object(u.a)(YM,"WheresTheSaveButtonDialog",
ni.StandardDialog,[]);const dC=(b,h,r)=>{if(1===r)return 32;new YM;return 32};var QL=d(546),ZM=d(1345);class cw extends jl.a{constructor(b,h,r,A,M=null){super();this.o3=M;this.bnk=56;this.RMc="px";this.JCc="aria-label";this.IPa="BookmarkIndicator";this.Vjh="HighlightBookmarkedContent";this.rwk="HighlightBookmark";this.k2a="wwaengidc";this.vbl="Bookmark_24";this.jb=b;this.Dg=h;this.ZY=r;(this.qB=A)&&this.qB.LQd(this.pD.bind(this))}GZo(b){if(b.Kj){for(const h of b.mg.Aj)if(this.yQj(h))return!0;return!1}return this.yQj(b.htmlElement)}u_a(b){let h=
!1;er.a.instance.$d(()=>{h=this.GZo(b)},"BIA:SCIVE");return h}yQj(b){return cw.O7e?(b=b.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .BookmarkStart"))&&0<b.length?!0:!1:!1}kUa(b){const h=[];er.a.instance.$d(()=>{const r=b.j6a(0,this.bnk,this.zoom);h.push(this.Iea(b.H3,r,b.MAc[0].y-b.m7[0].y))},"BIA:CIs");return h}Iea(b,h,r){const A=b.uh.ownerDocument,M=fm.a.createElement(A,Lo.a.div);M.className=cw.enk;cw.b9g;M.style.left=h+this.RMc;M.style.top=r+this.RMc;h=fm.a.createElement(A,
Lo.a.div);hh.a("renderIcon")&&appChrome.api.renderIcon(this.vbl,h);h.setAttribute("role","img");h.setAttribute("alt","Bookmark");h.title="Bookmark";h.setAttribute(this.JCc,"Bookmark");M.appendChild(h);b={context:new CK([],M,new Set,new Set,null,null),dcg:b,container:M};this.Dg.LI(Jd.a.click,M,this.kua.bind(this),b);return M}YUd(){const b=Object.assign(new Sm.a,{action:1,type:5,UB:null,VL:this.dia});this.dia=null;this.ZY.qH(b)}pD(b,h){this.dia&&(h.X7a.If.classList.contains("BookmarkHighlightSelected")||
this.YUd())}kua(b){this.Qcb(this.Vjh,this.rwk);if(null==b){var h=new Map;h.set("Source",this.IPa);h=Object.assign(new bb.a,{additionalValues:h});Ba.Health.instance.recordKpiFailure(this.Vjh,"Unable to highlight bookmarked content",!1,!0,h);return!1}h=b.rq.context;if(cw.rab(h,this.dia))return!0;h=this.iJf(b.rq.dcg,h,b.rq.container);b=Object.assign(new Sm.a,{action:0,type:5,UB:h,VL:this.dia});this.dia=h;this.ZY.qH(b);return!0}iJf(b,h,r){h={aVh:new Set,QWb:new Set,dVh:null,Rjf:null};const A=this.jb.Hv(b.Cb,
!0,!1),M=[];if(A)for(const aa of A)M.push(aa);this.aWk(b,h,M);h=new CK(M,r,h.aVh,h.QWb,h.dVh,h.Rjf);this.dia&&this.dia.$s===M&&(r.className+=String.format(" {0}",cw.ank),this.dia=h);return h}aWk(b,h,r){var A;if(b.Kj){var M=new Set;for(const oa of b.mg.Aj)oa.querySelectorAll("*").forEach(M.add,M);b=Array.from(M.values())}else b=Array.prototype.slice.call(b.htmlElement.querySelectorAll("*"),0);let aa=[];h.QWb.add(r[0].id);h.dVh=r[0].id;h.Rjf=r[0].id;b.forEach(oa=>{const Ja=nk.a.Eb(oa,$n.a.RSd);if(Ja)for(const fb of Ja)aa.push(fb),
h.aVh.add(fb);if(!aa.length)return!0;oa=nk.a.Eb(oa,$n.a.rKb);if(!oa)return!0;aa=ZM.a.Auc(aa,oa)});for(b=this.jb.xg(r[r.length-1],!1,!0);aa.length&&b;)h.QWb.add(b.id),h.Rjf=b.id,r.push(b),M=this.o3.value.sl(b),M=null===(A=null===M||void 0===M?void 0:M.htmlElement)||void 0===A?void 0:A.querySelectorAll("."+$n.a.Qjf),null===M||void 0===M?void 0:M.forEach(oa=>{(oa=nk.a.Eb(oa,$n.a.rKb))&&(aa=ZM.a.Auc(aa,oa))}),b=this.jb.xg(b,!1,!0)}Qcb(b,h){const r=new Map;r.set("Source",this.IPa);r.set("Action",h);Ba.Health.instance.recordKpiUsage(b,
0,this.k2a,r)}static rab(b,h){return!!h&&!!b&&b.ZUh===h.ZUh}}cw.ank="WordBookmarkIndicatorContainerSelected";cw.O7e=!0;cw.b9g="WordBookmarkIndicatorContainer";cw.enk="WordBookmarkSvgIndicatorContainer";Object(u.a)(cw,"BookmarkIndicatorActor",jl.a,[216]);class RL{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb=null,Gb=null,Sb=null,pc=null,zc=null,Yc=null,Kd=null){var ke,ge;this.via="_";this.w2a="OLE_LINK";this.rwd=(null===(ke=y.AFrameworkApplication.J)||void 0===ke?0:ke.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableLocalizedBookmarkName",
!1))?WordEditorIntl.WordEditorStrings.L_Bookmark:"Bookmark";this.Dmk=(null===(ge=y.AFrameworkApplication.J)||void 0===ge?0:ge.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableLocalizedBookmarkName",!1))?new RegExp("^"+this.rwd+"\\d+$","i"):/^BOOKMARK\d+$/i;this.IPa="BookmarkRibbonOptions";this.Zmk="BookmarkFloatieOptions";this.Lbh="CreateBookmarkOnRange";this.Mbh="CreateBookmarkOnView";this.Kbh="CreateBookmarkOnIP";this.vNe="CreateBookmark";this.k2a="wwaengidc";this.TDh="ShowHideBookmarksOnDocument";
this.adh="DeleteBookmark";this.$qk="DeleteBookmarkAction";this.DLk="ShowHideBookmarks";this.SDh="ShowBookmarksFloatie";this.ALk="ShowBookmarksFloatieAction";this.Feh="EditBookmark";this.Zrk="EditBookmarkAction";this.Ujf="BookmarksUsage";this.xbl="InsertTabSwitchActivity";this.H8m="Insert";this.z3b=b;this.ga=h;this.hb=r;this.vp=A;this.yz=M;this.U9=aa;this.Qc=oa;this.bO=Ja;this.xr=Gb;this.a9g=fb;this.Oe=Cb;this.B9=zc;this.wo=Sb;this.kd=pc;this.AV=Yc;this.xl=Kd}get ov(){return this.yz.value}Xb(){this.ga.qa(Fc.a.iUa,
lc.a.view,this.iUa.bind(this));this.ga.fb(Ka.a.Q_a,lc.a.application,this.Rkp.bind(this),96);this.ga.qa(Fc.a.iUa,lc.a.Cd,this.GBl.bind(this));this.ga.qa(Fc.a.iUa,lc.a.Xc,this.FBl.bind(this));this.ga.qa(Fc.a.deleteBookmark,lc.a.view,this.deleteBookmark.bind(this));this.ga.qa(Fc.a.ryf,lc.a.view,this.CWl.bind(this));this.ga.fb(Fc.a.bSj,lc.a.view,this.i4o.bind(this),1028);this.ga.fb(Fc.a.Aqe,lc.a.application,this.Aqe.bind(this),96);this.ga.fb(Fc.a.xye,lc.a.Xc,this.xye.bind(this),1028);this.ga.fb(ub.a.Nge,
lc.a.view,this.Nge.bind(this),1028);this.ga.fb(Fc.a.z$d,lc.a.view,this.z$d.bind(this),1028);this.ga.Pc(Fc.a.iUa,1028)}Rkp(b,h,r,A,M){return M&&M.NewContextId===this.H8m?(this.khe(this.xbl),32):2}iUa(b,h,r,A,M){var aa,oa;b=this.hb.Mg;if(!b||b.contextId===lc.a.I$)return 2;if(1===r)return Xn.a.Jla(h)||(null===(aa=this.xl)||void 0===aa?0:aa.q2(b))||(null===(oa=this.xl)||void 0===oa?0:oa.Nla(b))?8:32;h=this.hb.gb.currentSelection;if(!h||this.Oe.Am(h))return 2;this.zbd(M,"User is trying to create bookmark from UILocation : {0}");
this.Qcb(this.Mbh,this.vNe);if(h&&this.vp.idf(this.dqb(),h))return this.khe(this.Ujf),32;M=new Map;M.set("Source",this.IPa);M=Object.assign(new bb.a,{additionalValues:M});Ba.Health.instance.recordKpiFailure(this.Mbh,"Unable to create bookmark",!1,!0,M);return 8}GBl(b,h,r,A,M){if(1===r)return 32;if(lc.a.Cd!==h.contextId)return 8;this.zbd(M,"User is trying to create bookmark from UILocation : {0}");b=this.hb.gb.currentSelection;if(!b)return 2;this.Qcb(this.Lbh,this.vNe);if(this.vp.idf(this.dqb(),b))return this.khe(this.Ujf),
32;b=new Map;b.set("Source",this.IPa);b=Object.assign(new bb.a,{additionalValues:b});Ba.Health.instance.recordKpiFailure(this.Lbh,"Unable to create bookmark for range",!1,!0,b);return 8}FBl(b,h,r,A,M){if(1===r)return 32;if(lc.a.Xc!==h.contextId)return 8;this.zbd(M,"User is trying to create bookmark from UILocation : {0}");b=this.hb.gb.currentSelection;if(!b)return 2;this.Oe.Am(b)&&(h=b.Qa,this.Oe.ptb(h)?(b=this.Oe.Q6(h,!1),b||(v.ULS.sendTraceTag(542921105,3029,50,"User is trying to create bookmark at EOP"),
b=this.Oe.Q6(h,!0))):v.ULS.sendTraceTag(542921106,3029,50,"Selection is not expandable to word. Bookmark will be added on IP"));this.Qcb(this.Kbh,this.vNe);if(this.vp.idf(this.dqb(),b))return this.khe(this.Ujf),32;b=new Map;b.set("Source",this.IPa);b=Object.assign(new bb.a,{additionalValues:b});Ba.Health.instance.recordKpiFailure(this.Kbh,"Unable to create bookmark for IP",!1,!0,b);return 8}Aqe(b,h,r,A,M){1===r&&32;M[Vg.a.On]=cw.O7e;return 32}i4o(b,h,r,A,M){if(1===r)return 32;this.Qcb(this.TDh,this.DLk);
(b=M[Vg.a.On])||v.ULS.sendTraceTag(556889756,3029,50,"User hides bookmarks annotations on document");cw.O7e=b;b=Object(vo.a)().mU(this.ov);if(null!==b)return this.Mid(b),this.z3b.eJ({ShowBookmarks:"CheckboxModel"}),32;b=new Map;b.set("Source",this.IPa);b=Object.assign(new bb.a,{additionalValues:b});Ba.Health.instance.recordKpiFailure(this.TDh,"Unable to show/hide bookmark on document",!1,!0,b);return 8}deleteBookmark(b,h,r,A,M){b=this.hb.gb.currentSelection;if(!b)return 2;b=b.Qa;b=this.vp.p5d(b.node,
b.cpBegin);if(1===r)return b?32:8;this.zbd(M,"User is trying to delete bookmark from UILocation : {0}");this.bO.f3&&(v.ULS.sendTraceTag(545118155,3029,50,"Dismissing the bookmarks floatie"),this.bO.dismissFloatie());this.Qcb(this.adh,this.$qk);b||v.ULS.sendTraceTag(545118156,3029,50,"Delete bookmark called for a context where there were no bookmarks.");if(b&&this.vp.$zj(b.id))return this.a9g&&this.a9g.YUd(),32;r=new Map;r.set("Source",this.IPa);r=Object.assign(new bb.a,{additionalValues:r});Ba.Health.instance.recordKpiFailure(this.adh,
"Unable to delete bookmark",!1,!0,r);return 8}CWl(b,h,r,A,M){b=this.hb.gb.currentSelection;if(!b)return 2;b=b.Qa;b=this.vp.p5d(b.node,b.cpBegin);if(1===r)return b?32:8;this.zbd(M,"User is trying to edit bookmark from UILocation : {0}");this.bO.f3&&(v.ULS.sendTraceTag(539762822,3029,50,"Dismissing the bookmarks floatie"),this.bO.dismissFloatie());this.Qcb(this.Feh,this.Zrk);b||v.ULS.sendTraceTag(539762823,3029,50,"Edit bookmark called for a context where there were no bookmarks.");if(b)return this.B9.value.DWl(h,
b,this.vp),32;h=new Map;h.set("Source",this.IPa);h=Object.assign(new bb.a,{additionalValues:h});Ba.Health.instance.recordKpiFailure(this.Feh,"Unable to edit bookmark",!1,!0,h);return 8}zbd(b,h){b&&b.UILocation&&v.ULS.sendTraceTag(540386525,3029,50,h,b.UILocation)}xye(b,h,r,A,M){1===r&&32;this.Qcb(this.SDh,this.ALk);if(h.contextId===lc.a.Xc)return b=Array(1),b.push("Bookmarks"),this.bO.showFloatie(M.location,b,1),32;M=new Map;M.set("Source",this.Zmk);M=Object.assign(new bb.a,{additionalValues:M});
Ba.Health.instance.recordKpiFailure(this.SDh,"Unable to show bookmark floatie",!1,!0,M);return 8}Nge(b,h,r,A,M){let aa;return 1===r?(er.a.instance.$d(()=>{aa=this.ga.Nf(h,ub.a.GR,r,!0,A,M);32!==aa&&(aa=this.ga.Nf(h,Fc.a.iUa,r,!0,A,M))},"BA:LFE"),aa):8}z$d(b,h,r){var A;if(1===r)return 32;if(b=this.hb.gb.currentSelection){b=b.Qa.node;if(h=this.cli(b))return h.click(),32;v.ULS.sendTraceTag(539523265,3029,50,"No indicator found in current paragraph.");if(b=this.vp.p5d(b,0)){b=this.AV.ymb.get(null===(A=
b.id)||void 0===A?void 0:A.toString());A=Object(vo.a)().mU(this.ov).Ic.Eb(b);if(A=this.cli(A))return A.click(),32;v.ULS.sendTraceTag(539523266,3029,50,"No indicator found for the paragraph in previous paragraphs.")}else v.ULS.sendTraceTag(539523267,3029,50,"No bookmark found enclosing the content.")}return 2}cli(b){let h;b=this.wo.jm(b).sl(this.kd.Ad.pc);b.V$a&&(b=b.htmlElement.querySelectorAll("div."+cw.b9g),0<b.length&&(h=b[0]));return h}Mid(b){const h=QL.b(b);if(h){var r=this.Qc.Nc(2);try{for(r.Bb(b);h.moveNext();){if(!Gd.ParagraphReader.Bh(h.iterator))continue;
const A=h.currentNode;this.uVl(A)&&this.U9.dSb(A,!0)}}finally{r&&r.dispose()}}}uVl(b){var h;for(let A=0;A<b.ra.length;A++){const M=b.ra.K(A);if(null!=M.Zh)for(let aa=0;aa<M.Zh.length;aa++){var r=M.Zh.K(aa);if(null!=r){r=b.Ic.Eb(r.Io).ka(Mc.a.wu,"");const oa=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.$("HideBookMarkStartingWithOleLink");if(!(I.a.Tf(r)||r.startsWith(this.via)||oa&&r.startsWith(this.w2a)))return!0}}}}dqb(){var b=this.vp.U3d(!1);const h=[];for(let r=0;r<b.count;r++){const A=
b.K(r).ka(Mc.a.wu,"");this.Dmk.test(A)&&h.push(A)}return 0<h.length?(h.sort((r,A)=>r.localeCompare(A,void 0,{numeric:!0})),b=parseInt(h[h.length-1].substring(this.rwd.length)),this.rwd+(b+1)):this.rwd+1}Qcb(b,h){const r=new Map;r.set("Source",this.IPa);r.set("Action",h);Ba.Health.instance.recordKpiUsage(b,0,this.k2a,r)}khe(b){this.xr&&this.xr.execute(h=>{h.logActivity(b,null)})}}Object(u.a)(RL,"BookmarkActor",null,[]);class yI{constructor(b,h,r){this.Rb=b;this.LQl=h;this.tg=r;this.Yof=this.Yof.bind(this)}Xb(){this.Rb.qa(Fc.a.g2f,
lc.a.view,this.Yof)}Yof(b,h,r,A,M){return 1===r?32:(b=this.tg.Paa(h.Ik))?(M=3===M.Wy,this.LQl.value.a8h(this.rEm(b),this.cOm(b),M),32):2}rEm(b){const h=new wg.DictionaryPropertySet;h.setValue(De.a.HG,this.tg.Fh(b));h.setValue(De.a.RH,this.tg.Gaa(b));h.setValue(De.a.hra,this.tg.lqb(b));h.setValue(De.a.separator,this.tg.a8d(b));return h}cOm(b){const h=new wg.DictionaryPropertySet;h.setValue(Mc.a.marginLeft,this.tg.kN(b));h.setValue(Mc.a.marginRight,this.tg.lN(b));h.setValue(Mc.a.np,this.tg.Gv(b));return h}}
Object(u.a)(yI,"ColumnsDialogActor",null,[]);var $M=d(860);class aN{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb){this.Op=b;this.ria=h;this.Ke=r;this.sr=A;this.Vm=M;this.Qd=aa;this.Qc=oa;this.we=Ja;this.ga=fb;this.Kyk=Cb;this.Fpk=Gb}get dXf(){return this.Kyk}Xb(){this.ga.fb(ub.a.God,lc.a.view,this.W6m.bind(this),96);this.ga.fb(ub.a.Hjd,lc.a.view,this.Hjd.bind(this),4);this.ga.fb(ub.a.QRd,lc.a.view,this.QRd.bind(this),1028)}QRd(b,h,r,A,M){if(!gp.a.Jqf)return 8;b=M.FormattingActionId;M=M.FormattingActionData;
if(!h.view||!h.view.te)return 2;h=h.view;if(!(b&&M&&h.mb&&h.mb.gb.currentSelection))return 8;h=this.Vm.yui(h.mb.gb.currentSelection.toArray());for(const aa of h){h=aa.ka(Mc.a.Hw,0);r=this.Op.getById(h);if(!r)return v.ULS.sendTraceTag(509136987,368,10,"Content control not found by id '"+h+"'."),8;if(!this.Fpk.isp(r,b,M))return v.ULS.sendTraceTag(509136986,368,10,"Content control with id '"+h+"' failed to update formatting."),8}return 32}W6m(b,h,r,A,M){h=this.Op.getById(M);if(!h)return 8;r=h.Wd;if(!r)return 8;
if(gp.a.mec&&8===h.type||r.ka(Mc.a.faa,!1))return 2;A=this.Op.Fkm(h);if(!A)return 8;M=this.Qc.Nc(7);M.Bb(A.node);if(!this.dXf)return(b=h.placeholderText)||(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder),this.Qd.Ve(A,b),gp.a.Ufa?this.Vm.cKb(h,!0):this.cKb(h),r.setValue(Mc.a.faa,!0),M.dispose(),32;const aa=new wg.DictionaryPropertySet;aa.setValue(pd.a.e9d,A);var oa=r.ka(Mc.a.eUa,"");oa=this.ria.DIi(oa);if(!oa)return this.sr.Ve(A,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,
b),gp.a.Ufa?this.Vm.cKb(h,!0):this.cKb(h),r.setValue(Mc.a.faa,!0),M.dispose(),32;aa.setValue(pd.a.r4c,oa);if(1<oa.length&&!h.fg)return M.dispose(),8;gp.a.Ufa?this.ga.Pb(ub.a.Pod,2,{r4c:oa,e9d:A,placeholderText:h.placeholderText}):this.aAl(aa);r.setValue(Mc.a.faa,!0);M.dispose();return 32}Hjd(b,h,r){b=h.view.te?h.view:null;if(!b||!b.mb)return 8;const [A,M]=this.zHm(b.mb.gb);if(0===A.length)return 8;if(1===r){for(var aa of A){var oa=M.get(aa.parentId);if(this.UUi(aa,oa))return 32}return 8}if(2===r){r=
this.I7o(A,M);aa=this.Qc.Nc(15);aa.Bb(b.od);for(oa of r)r=M.get(oa.parentId),this.UUi(oa,r)&&this.Op.RYb(oa.id);aa.dispose();Object($M.l)()&&Object($M.o)("RemoveContentControl");return 32}return 2}zHm(b){var h,r,A=[];for(const aa of b)A.push(...(null!==(h=this.Vm.osa(aa.Qa,aa.Wc,1))&&void 0!==h?h:[]));if(0===A.length)return[A,new Map];h=[];for(const aa of b)h.push(...(null!==(r=this.Vm.osa(aa.Qa,aa.Wc,3))&&void 0!==r?r:[]));b=new Map(A.map(aa=>[aa.id,aa]));if(0===h.length)return[A,b];const M=new Map(h.map(aa=>
[aa.id,aa]));A=A.filter(aa=>!M.has(aa.id));b=new Map([...b,...M]);return 0==A.length?[[h[0]],b]:[A,b]}cKb(b){const h=this.sr.Xjc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(h){if(b=this.we.AF(b.start.node).lh(Fs.a.Gjg))this.Ke.$qa(h.formatting),this.Ke.Ydb(h.formatting,b)}else v.ULS.sendTraceTag(20492441,368,15,"Unable to get a ChP at starting Ip of Content Control")}aAl(b){this.ga.Pb(ub.a.Pod,2,b)}UUi(b,h){return b.Fla&&b.Mmn&&(!h||h.isEditable)}I7o(b,h){const r=(A,M)=>null==A||null==M||
A.id===M.id?!1:A.id===M.parentId||r(h.get(A.parentId),M);return b.slice().sort((A,M)=>r(A,M)?1:r(M,A)?-1:0)}}Object(u.a)(aN,"ContentControlActor",null,[]);var Cy=d(1050);class zI extends ig.a{constructor(b,h,r){super(!1,!1,!0);this.Frh=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,Cy.a.tgf,Cy.a.sgf,Cy.a.ugf];this.Plk=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,Cy.a.k2k,Cy.a.j2k,Cy.a.m2k];this.w7g=[Box4Intl.Box4Strings.l_CustomTabDialogAlignLeft,Box4Intl.Box4Strings.l_CustomTabDialogAlignCenter,
Box4Intl.Box4Strings.l_CustomTabDialogAlignRight];this.hxc=()=>{new zI(this.ga,this.I9e,this.hFc)};this.Otm=()=>{const A=[];for(const M of this.I9e)A.push(this.V8(M));return A};this.Rwp=A=>{const M=new Set;this.nia="";for(const aa of A)if(""!==aa.position){const oa=this.tBi(aa.position);if(0>oa||22<oa){this.nia=Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds;break}if(M.has(oa)){this.nia=Box4Intl.Box4Strings.l_CustomTabDialogMultipleTabStopsSamePosition;break}else this._tabStops.push(this.Ghp(aa)),
M.add(oa)}else{this.nia=Box4Intl.Box4Strings.l_CustomTabDialogEmptyPosition;break}""!==this.nia&&(this._tabStops=[],this.I9e=A)};this.yKl=(A,M)=>{try{if(1===A){if(""!==this.nia)throw Error.create(this.nia);M.DefaultTabStop&&(this.hFc=Cy.a.avg(M.DefaultTabStop),this.uAp(this.hFc));if(32!==this.ga.Pb(Fc.a.V1b,2,{["tabStops"]:this._tabStops,["defaultTabStopLength"]:Jg.a.gD(this.hFc)}))throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogSaveError);}}catch(aa){this.NNa(aa.message,this.hxc)}};this.ga=
b;this.I9e=h;this._tabStops=[];this.hFc=r;this.nia="";b={["id"]:"CustomTabDialog",["bodyControls"]:this.q1c()};this.mi(Box4Intl.Box4Strings.l_CustomTabDialogTitle,this.yKl,b)}V8(b){return{["position"]:b.position,["alignment"]:b.alignment,["leader"]:b.leader}}tBi(b){return Math.floor(100*parseFloat(b))/100}Ghp(b){return new uB.a(Jg.a.gD(this.tBi(b.position)),Cy.a.kKm(b.alignment),Cy.a.iKm(b.leader),1)}uAp(b){if(0>b||22<b)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds);
var h={};if(32===this.ga.Pb(ub.a.YMa,2,h)){var r=h.marginLeft;const A=Ah.a.qj(h.marginRight,0);r=Ah.a.qj(r,0);h=Ah.a.qj(h.np,0);if(Ah.a.ula(b,0,!1)>=h-A-r)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopMarginIndentCheck);}}q1c(){return{["getInitState"]:this.Otm,["updateState"]:this.Rwp,["validPositions"]:this.RFi(0,"Position"),["validAlignments"]:this.Uti(this.w7g,this.w7g,null,"Alignment"),["validLeaders"]:this.Uti(this.Frh,this.Frh,this.Plk,"Leader"),["defaultTabStopSpinButtonProps"]:this.RFi(.01,
"DefaultTabStops"),["defaultTabStopLength"]:this.hFc,["DefaultTabStop"]:"DefaultTabStop",["addButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogAddButton,["clearAllButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogClearAllButton,["positionHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogPosition,["alignmentHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogAlignment,["leaderHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogLeader,["defaultTabStopText"]:Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStops,
["addNewTabStopHeader"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopHeader,["addNewTabStopDescription"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopDescription,["deleteButtonTooltip"]:Box4Intl.Box4Strings.l_CustomTabDialogDeleteButtonTooltip}}RFi(b,h){return{["type"]:"AppSpinButtonProps",["id"]:"CustomTabDialogSpinButtonPosition",["label"]:h,["unitType"]:"Inch",["validUnits"]:[Tw("Inch",3,b,22,.1)],["numberFormatInfo"]:nC()}}Uti(b,h,r,A){return{["type"]:"AppComboBoxProps",["id"]:"CustomTabDialogComboBox",
["label"]:A,["options"]:xz(b,h,r)}}}Object(u.a)(zI,"CustomTabDialog",ig.a,[]);class bN{constructor(b,h,r){this.Sqc=(A,M,aa,oa,Ja)=>{if(2!==aa)return 8;if(!Ja)return 16;A=Ja.tabStop;Ja=Ja.value;if(!A)return 16;ac.c(Fc.a.Sqc);Ja=new uB.a(Ja,A.xha,A.Lta,A.TFg);M=M.node;this.DFa.Wcb(M,A);this.DFa.Vae(M,Ja);return 32};this.Kmd=(A,M,aa,oa,Ja)=>{if(2===aa){if(!Ja)return 16;this.DFa.Vae(M.node,Ja);return 32}return 8};this.SXb=(A,M,aa,oa,Ja)=>{A=this.DFa.cxj(M.node);if(!("customTabs"in Ja))return Ja.customTabs=
A,32;M=Ja.customTabs;if(!M||0>=M.length||!A||0>=A.length)return Ja.customTabs=null,32;aa=[];for(const fb of M)for(const Cb of A)if(Cb.nOa===fb.nOa&&Cb.TFg===fb.TFg&&Cb.xha===fb.xha){aa.push(fb);break}Ja.customTabs=aa;return 32};this.Wcb=(A,M,aa,oa,Ja)=>{if(2===aa){if(!Ja)return 16;ac.c(Fc.a.Wcb);this.DFa.Wcb(M.node,Ja);return 32}return 8};this.SYb=(A,M)=>{this.DFa.SYb(M.node);return 32};this.V1b=(A,M,aa,oa,Ja)=>{if(2===aa){if(!Ja)return 16;A=Ja.tabStops;aa=Ja.defaultTabStopLength;M=M.node;oa=!1;const fb=
this.DFa.eAo(M,A);Ja.defaultTabStopLengthSaved||(oa=this.hT.KPo(M,aa),Ja.defaultTabStopLengthSaved=!0);fb&&ac.d(Fc.a.V1b,!0,void 0,void 0,void 0,void 0,[Object.assign(new ia.a,{name:"Custom Tab Stops Count",string:A.length.toString()})]);if(null==oa)return v.ULS.sendTraceTag(571479714,3015,15,"Could not set Default Tab Stop Length."),16;oa&&(this.hkd&&this.hkd.VSi(),this.Od.Yu(11,Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopTrackingAlert),ac.d(Fc.a.V1b,!0,void 0,void 0,void 0,void 0,[Object.assign(new ia.a,
{name:"Default Tab Stop Length",string:aa.toString()})]));return 32}return 8};this.lSj=(A,M,aa)=>{if(2!==aa)return 8;A={};if(32!==this.ga.Pb(Fc.a.q_,2,A))return v.ULS.sendTraceTag(572072071,3015,15,"Could not read Default Tab Stop Length."),16;M={};if(32!==this.ga.Pb(ub.a.YMa,2,M))return v.ULS.sendTraceTag(572072072,3015,15,"Could not read Section Properties."),16;A=Cy.a.avg(Jg.a.iB(A.defaultTabStop));aa={};aa.defaultTabStopLength=A;aa.sectionPropertiesData=M;if(32!==this.ga.Pb(Fc.a.SMg,2,aa))return v.ULS.sendTraceTag(572072073,
3015,15,"Could not validate Paragraphs against indents and default tab stop."),16;if(!aa.isParagraphValid)return v.ULS.sendTraceTag(572072074,3015,15,"Could not open Custom Tab Stop Dialog since all selected paragraphs failed validation."),this.DFa.NNa(Box4Intl.Box4Strings.l_CustomTabDialogIndentError),8;M={};if(32!==this.ga.Pb(Fc.a.SXb,2,M))return v.ULS.sendTraceTag(572072075,3015,15,"Could not read Custom Tab Stops."),16;(M=M.customTabs)||(M=[]);M=Cy.a.jKm(M);new zI(this.ga,M,A);ac.c(Fc.a.hxc,!0);
return 32};this.vln=(A,M,aa,oa,Ja)=>{if(2!==aa)return 8;if(!Ja)return 16;if(Ja.isParagraphValid)return 32;aa={};if(32!==this.ga.Nf(M,ub.a.Kcb,2,!1,null,aa))return 16;A=Ja.sectionPropertiesData;M=Ja.defaultTabStopLength;var fb=aa.Du;oa=fb.Cfa;fb=1===fb.specialIndentType?fb.RA:fb.RA-fb.oha;const Cb=A.marginLeft,Gb=A.marginRight;aa.isRtl?(aa=Ah.a.qj(Math.max(Gb,Gb+oa),0),oa=Ah.a.qj(Math.max(Cb,Cb+fb),0)):(aa=Ah.a.qj(Math.max(Cb,Cb+fb),0),oa=Ah.a.qj(Math.max(Gb,Gb+oa),0));A=Ah.a.qj(A.np,0);M=Ah.a.ula(M,
0,!1);Ja.isParagraphValid=M<A-aa-oa;return 32};this.ga=b;this.DFa=h;this.hT=r}get Od(){return null!=this.G4g?this.G4g:this.G4g=Za.a.instance.resolve(46).instance}get hkd(){return null!=this.Z1g?this.Z1g:this.Z1g=Za.a.instance.Oa(1095)}Xb(){const b=r=>Kv.OutlineElementGeneralizer.Mka(r.gb,!0),h=df.a.V_a.IWc(b,!0);this.ga.qa(Fc.a.SXb,lc.a.view,df.a.V_a.IWc(b,!1));this.ga.fb(Fc.a.SXb,lc.a.paragraph,this.SXb,96);this.ga.qa(Fc.a.Wcb,lc.a.view,h);this.ga.fb(Fc.a.Wcb,lc.a.paragraph,this.Wcb,96);this.ga.qa(Fc.a.SYb,
lc.a.view,h);this.ga.fb(Fc.a.SYb,lc.a.paragraph,this.SYb,96);this.ga.qa(Fc.a.Kmd,lc.a.view,h);this.ga.fb(Fc.a.Kmd,lc.a.paragraph,this.Kmd,96);this.ga.qa(Fc.a.Sqc,lc.a.view,h);this.ga.fb(Fc.a.Sqc,lc.a.paragraph,this.Sqc,96);this.ga.qa(Fc.a.V1b,lc.a.view,h);this.ga.fb(Fc.a.V1b,lc.a.paragraph,this.V1b,96);this.ga.qa(Fc.a.SMg,lc.a.view,h);this.ga.fb(Fc.a.SMg,lc.a.paragraph,this.vln,96);this.ga.qa(Fc.a.hxc,lc.a.view,this.lSj);this.ga.qa(Fc.a.BRi,lc.a.view,this.lSj)}}Object(u.a)(bN,"CustomTabActor",null,
[]);var qO=d(128),ID=d(616);class cN{constructor(b,h,r,A,M,aa,oa,Ja,fb){this.ga=b;this.bPd=r;this.h1a=(this.OOc=M)&&A;this.Zo=aa;this.kW=oa;this.Eqk=Ja;this.Fy=fb;this.Llk=h;this.H9i(!0);this.A8i(!0);y.AFrameworkApplication.XI(()=>{this.VVb()});this.h1a&&hh.a("dispatch")&&appChrome.api.dispatch(this.YXj([]))}Xb(){this.h1a&&(this.ga.qa(Fc.a.Zhp,lc.a.view,this.OKl.bind(this)),this.ga.qa(Fc.a.bod,lc.a.view,this.bod.bind(this)),this.ga.fb(Fc.a.did,lc.a.view,this.did.bind(this),96));this.OOc&&(this.ga.qa(Fc.a.cod,
lc.a.view,this.cod.bind(this)),this.ga.fb(Fc.a.rre,lc.a.view,this.rre.bind(this),96))}z$m(b){if(!this.V_o(b))return!1;const h=Qn.a.instance.Nc(2);try{h.Bb(b.root);const r=vd.a.Za(b.root.graphNode),A=ef.a.xq(r);for(;A.moveNext();){const M=Object(ya.a)(qO.a,A.currentNode);M&&M.qI(b.pc,20,!0)}}finally{h&&h.dispose()}return!0}V_o(b){return b&&b.root&&b.mw?b.gj||b.lYf||b.WWi||b.qk:!1}eCo(){let b=!1;this.bPd.forEach(h=>{this.z$m(h)&&(b=!0)});return b}$hp(){v.ULS.sendTraceTag(570566656,3023,50,"Toggle Dark Mode for canvas fishbowl to {0} mode",
this.Zo.XO?"dark":"light");return this.Zo.XO?ID.a.xRc(1):ID.a.lAj(1)}YHg(){const b=this.Zo.t6;v.ULS.sendTraceTag(571524678,3023,50,"Toggle canvas Dark Mode to {0} mode",b?"dark":"light");if(!this.eCo()||(b?!ID.a.xRc(0):!ID.a.lAj(0)))return!1;this.Eqk.wjo(b);return!0}YXj(b){b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",!this.Zo.XO));b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackgroundStatusBar",this.uGi(!0)));try{WordRibbonStrings?b.push(appChrome.actions.setControlCustomTooltip("DarkModeSwitchBackgroundStatusBar",
this.Zo.Beb?WordRibbonStrings.DarkModeSwitchBackgroundTooltipDark:WordRibbonStrings.DarkModeSwitchBackgroundTooltipLight)):v.ULS.sendTraceTag(527283228,3023,10,"Trying to access WordRibbonStrings when it's undefined")}catch(h){v.ULS.sendTraceTag(527282835,3023,10,h)}return b}OKl(){return this.YHg()?32:8}cod(b,h,r){if(1===r)return 32;b=this.kW.Wf("UserAction","sharedUXDarkModeToggle");if(hh.a("toggleSharedUXDarkMode"))v.ULS.sendTraceTag(571524677,3023,50,"Requesting to toggle Dark Mode for the Shared UX."),
appChrome.api.toggleSharedUXDarkMode(),hh.a("isSharedUXDarkModeOn")?this.Zo.XO=appChrome.api.isSharedUXDarkModeOn():this.Zo.XO=!this.Zo.XO,v.ULS.sendTraceTag(529388308,3023,50,"User in new ribbonMode: {0}",this.Zo.XO);else return 8;appChrome.getHeaderApi().then(A=>{A.hasOwnProperty("refreshThemeOverride")&&A.refreshThemeOverride()});this.$hp()||v.ULS.sendTraceTag(561553416,3023,15,"Failed to toggle Dark mode for Fishbowl");this.h1a&&!this.Zo.Beb&&(this.YHg()||v.ULS.sendTraceTag(561553417,3023,15,
"Failed to toggle Dark mode for Canvas"));h={};h.DarkModeToggle=appChrome.selectors.getModelType("DarkModeToggle");qa.StaticActiveAppFrame.za().eJ(h);appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.Zo.XO));this.h1a&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",!this.Zo.XO));b.stop();v.ULS.sendTraceTag(555885377,3023,50,"{0}",b.Ei);ac.b(this.Zo.XO?"DarkModeOn":"DarkModeOff");return 32}bod(b,
h,r){if(1===r)return 32;b=this.kW.Wf("UserAction","sharedUXDarkModeSwitchBackground");v.ULS.sendTraceTag(561088148,3023,50,"Requesting to toggle Dark Mode for the switch background UX.");this.Zo.Beb=!this.Zo.Beb;if(!this.YHg())return 8;h={};h.DarkModeSwitchBackground=this.Fy?"ButtonModel":"ToggleButtonModel";qa.StaticActiveAppFrame.za().eJ(h);b.stop();v.ULS.sendTraceTag(555885378,3023,50,"{0}",b.Ei);v.ULS.sendTraceTag(529388309,3023,50,"User in new canvasMode: {0}",this.Zo.Beb);ac.b(this.Zo.Beb?"DarkCanvasOff":
"DarkCanvasOn");return 32}rre(b,h,r,A,M){if(1===r)return 32;if(!M)return 2;hh.a("isSharedUXDarkModeOn")&&(this.Zo.XO=appChrome.api.isSharedUXDarkModeOn());M&&(M[Vg.a.On]=this.Zo.XO);return 32}did(b,h,r,A,M){if(1===r)return 32;if(!M)return 2;!this.Fy&&M&&(M[Vg.a.On]=this.Zo.Beb);b=[];b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.Zo.XO));this.h1a&&this.YXj(b);b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackground",this.uGi(!1)));appChrome.api.dispatch(b);
return 32}uGi(b){const h={};this.Zo.Beb?b?h["default"]="MoonMonochromatic_16":(h["default"]="MoonMonochromatic_20",h.icon32="MoonMonochromatic_32"):b?h["default"]="SunMonochromatic_16":(h["default"]="SunMonochromatic_20",h.icon32="SunMonochromatic_32");return h}VVb(){this.OOc&&this.H9i(!1);this.h1a&&this.A8i(!1)}H9i(b){var h;v.ULS.sendTraceTag(561088149,3023,50,"Shared dark mode state. IsBoot: {0}; State: {1}; DefaultOn: {2}",b,this.Zo.XO?"dark":"light",this.Zo.cJa);b&&this.Zo.XO!=(null===(h=this.Llk)||
void 0===h?void 0:h.$("DarkModeIsOn"))&&v.ULS.sendTraceTag(522303360,3023,15,"Inconsistent dark mode value is found during boot. Dark mode toggle: {0}. DefaultOn: {1}.",this.Zo.XO?"dark":"light",this.Zo.cJa)}A8i(b){v.ULS.sendTraceTag(561088150,3023,50,"Canvas dark mode state. IsBoot: {0}; State: {1}; DarkCanvasPreferred: {2}",b,this.Zo.t6?"dark":"light",this.Zo.NKl)}}Object(u.a)(cN,"DarkModeActor",null,[]);class Gx{constructor(b){this.An=null;this.qqa=b}get jKb(){return null!=this.pSg?this.pSg:this.pSg=
Za.a.instance.Oa(105)}get SZ(){return null!=this.rSg?this.rSg:this.rSg=Za.a.instance.Oa(70)}get NX(){return null!=this.a1g?this.a1g:this.a1g=Za.a.instance.Oa(102)}get GN(){return null!=this.y0g?this.y0g:this.y0g=Za.a.instance.Oa(110)}get Yg(){return this.An||(this.An=this.qqa())}b5i(b,h,r){if(this.GN&&Gx.im){var A=Object(Al.a)().RJf(h);b=A.node;ze.a.ll(A)&&(A=wc.a.Tc(b,Gd.ParagraphReader.textLength(b)));var M=Wa.FormattingReader.language(Wa.FormattingReader.Rs(A));A=vd.a.Za(r.od);Object(vo.a)().vue(A);
var aa=b=null;if(A)for(let oa=A.Ub(1);oa&&!aa;oa=A.zj(1))gm.OutlineReader.XBa(oa)&&(aa=oa);if(A&&!aa){if(!this.NX||!this.GN)return;b=new Rb.GraphTransaction(7);b.mu(A);aa=this.NX.OXd(A);this.GN.yja(A,!0);M&&(Bb.OutlineElementNavigator.Me(A),A=wc.a.Tc(A.currentNode,0),Gx.im.Mwe(Wa.FormattingReader.Rs(A),M))}M=sc.SelectionFactory.hp(aa,!0);r.mb.Kc(M);ze.a.pf(h)&&(r=vd.a.Za(h.node),r.pq(),Yn.OutlineNavigator.xug(r),this.jKb&&this.SZ&&gm.OutlineReader.UA(r,h,!0)&&(h=this.jKb.nCf(h,-1,!1,cf.a.nz))&&this.SZ.bIj(h));
this.Yg&&this.Yg.pI();b&&b.dispose()}}static get im(){return null!=Gx.qWg?Gx.qWg:Gx.qWg=Za.a.instance.Oa(101)}static get instance(){return null!=Gx.ZYg?Gx.ZYg:Gx.ZYg=Gx.Pm()}static Pm(){return new Gx(()=>Za.a.instance.Oa(50))}}Object(u.a)(Gx,"TitleViewEditor",null,[]);class SL{tvf(b,h,r){return 1===r?32:SL.hOl(h.node)}static hOl(b){const h=new vd.a;h.set(b);h.pq();b=new Rb.GraphTransaction(7);b.mu(h);h.Rg();b.dispose();return 32}}Object(u.a)(SL,"DeleteOutlineLevelContentStrategy",null,[]);class ms{constructor(){this.brk=
new SL;this.tvf=(b,h,r,A,M)=>this.brk.tvf(b,h,r,A,M)}Xb(b){const h=this.idi.Dvf.bind(this.idi),r=this.tvf,A=this.Yci.mOl.bind(this.Yci);this.Ppg(b,h,r,A);b.qa(ub.a.backspace,lc.a.Xc,A);b.qa(ub.a.backspace,lc.a.Cd,A);b.qa(ub.a.backspace,lc.a.Uc,ce.ActionManager.aU);b.qa(ub.a.backspace,lc.a.outline,r);b.qa(ub.a.backspace,lc.a.view,h);b.Pc(ub.a.backspace,1124);b.qa(ub.a.Yza,lc.a.Xc,ce.ActionManager.aU);b.qa(ub.a.Yza,lc.a.Cd,A);b.qa(ub.a.Yza,lc.a.Uc,ce.ActionManager.aU);b.qa(ub.a.Yza,lc.a.outline,r);
b.qa(ub.a.Yza,lc.a.view,h);b.fb(ub.a.mYd,lc.a.view,h,1124);b.qa(ub.a.JJ,lc.a.Xc,A);b.qa(ub.a.JJ,lc.a.Cd,A);b.qa(ub.a.JJ,lc.a.Uc,ce.ActionManager.aU);b.qa(ub.a.JJ,lc.a.outline,r);b.qa(ub.a.JJ,lc.a.view,h);b.Pc(ub.a.JJ,1124);b.fb(ub.a.Ttf,lc.a.view,h,1124);b.fb(ub.a.Ira,lc.a.view,ms.Ira,1028)}Ppg(){}static get gg(){return null!=ms.B0g?ms.B0g:ms.B0g=Za.a.instance.resolve(18)}static get NX(){return null!=ms.Y0g?ms.Y0g:ms.Y0g=Za.a.instance.resolve(102)}static get GN(){return null!=ms.x0g?ms.x0g:ms.x0g=
Za.a.instance.resolve(110)}static get sc(){return null!=ms.qVg?ms.qVg:ms.qVg=Za.a.instance.Oa(12)}static Ira(b,h,r,A,M){A=h.view;if(!A.mb||!A.mb.gb.currentSelection||ze.a.Am(A.mb.gb.currentSelection))return 8;if(1===r)return 32;r=A.mb.gb;const aa=r.currentSelection;var oa=aa.Qa,Ja=null,fb=!1;if(r.FL){if(oa.contextId===lc.a.outline&&1===r.length){for(b=vd.a.Za(oa.node);b.Zd();)b.Rg();ms.GN.yja(b,!0);Bb.OutlineElementNavigator.Me(b);b=sc.SelectionFactory.ue(b.currentNode,0);A.mb.Kc(b);return 32}Ja=
oa.node;var Cb=null;if(wq.c(oa)){var Gb=Ja.Be(A.pc);Gb&&(Gb=Gb.Beq)&&0<=Gb.width&&0<=Gb.height&&(Cb=new Qx.a(Ah.a.qn(Gb.x,0),Ah.a.qn(Gb.y,1)));Cb||(Cb=ZA.a(Ja))}else Cb=ZA.a(oa.node);oa=vd.a.Za(oa.node);oa.pq();Object(vo.a)().vue(oa);Ja=ms.NX.OXd(oa);ZA.b(Ja,Cb.x,Cb.y);ms.GN.yja(oa,!0);Ja=sc.SelectionFactory.hp(Ja,!0)}else if(1===r.length){fb=r.last;oa=gg.a.jMb(fb);if(ms.sc&&ms.sc.isFeatureEnabled(22)&&Object(Al.a)().WCg(oa).returnValue)return 2;oa=fb.Wc;fb=!r.Rw&&!(null===(Cb=r.currentSelection)||
void 0===Cb?0:Cb.yab)&&(ze.a.ll(oa)||Gd.ParagraphReader.fn(oa)||ze.a.bba(oa))}fb&&(fb=ze.a.uk(aa,!1,!1,void 0,!1),A.mb.Kc(fb),y.AFrameworkApplication.va.Nf(h,ub.a.oE,2,!1,null,M),Ja=A.mb.gb.currentSelection,A.mb.Kc(aa));M||(M=new wg.DictionaryPropertySet);M.setValue(pd.a.OYc,!0);y.AFrameworkApplication.va.Nf(h,ub.a.JJ,2,!0,null,M);if(Ja&&Ja.Qa.isValid)return A.mb.Kc(Ja),32;r.FL&&Gx.instance.b5i(b,h.Ik,A);ze.a.Am(A.mb.gb.currentSelection)||y.AFrameworkApplication.va.Nf(h,ub.a.oE,2,!1,null,M);return 32}static gOl(b,
h){if(1===h)return 32;h=new Rb.GraphTransaction(7);h.Bb(b);ms.gg.mNa(b);h.dispose();return 32}}Object(u.a)(ms,"ADeleteActor",null,[]);var dN=d(248),rO=d(694);class Sn{get rg(){return re.a.instance}mOl(b,h,r,A,M){A=null===M||void 0===M?void 0:M.Xsd;if(1===r)return 32;var aa=b===ub.a.backspace;if(this.rg.Mh){if(this.rg.iXi(h)&&Sn.Yja&&(r=h.clone(),r.Tb+=1,--r.Fb,this.rg.Ioc(r)))return Sn.Yja.Kzj([r]),32;if(this.rg.WYf(h,aa))return 2}if(Sn.ly()&&Sn.ly().instance&&Sn.ly().instance.sX(h))return 4;const oa=
h.node;var Ja=h.cpBegin;r=h.cpEnd;let fb=h.Fb,Cb=h.Tb;const Gb=Gd.ParagraphReader.text(oa),Sb=Gb.length;let pc=!1;if(Ja===r){if(aa&&!Ja||!aa&&Ja===Sb)return 2;aa?({cp:Ja,returnValue:pc}=this.rg.wdj(oa,Ja),pc||({cp:Ja,Xqa:fb,returnValue:pc}=this.rg.vdj(h,Ja,fb)),pc||(Ja--,I.a.VA(Gb,Ja)&&Ja--),b=ub.a.ejf):({cp:r,returnValue:pc}=this.rg.fLn(oa,r),pc||({cp:r,Xqa:Cb,returnValue:pc}=this.rg.eLn(h,r,Cb)),pc||(r++,I.a.VA(Gb,r)&&r++),b=ub.a.Fci)}Ja=Ja===r?wc.a.Tc(oa,Ja):wc.a.createTextRange(oa,Ja,r);fx.a.qpb&&
(Ja.Rea=h.Rea,Ja.Vra=h.Vra);pc&&this.rg.Mh&&(aa?Ja.Fb=fb:Ja.Tb=Cb);if(!this.rg.Ioc(Ja))return 2;this.xJb(oa);h=new Rb.GraphTransaction(15);h.Ii=b;h.Bb(oa);aa=Object(Xa.a)(rO.a,M)&&M.s8a;if(!Sn.Od.Lg||aa||Sn.eIa.Pee(gg.a.instance.gb.currentSelection))this.Zci(Ja,A);else{aa=Sn.Od.W5a();try{const zc=Sn.ti.opd(Ja);let Yc;if(({type:Yc}=zc.R8d()).returnValue){const Kd=Object(ya.a)(89,M);Kd&&Kd.ka(fd.a.fXf,!1)?Sn.Od.dXb=Yc:Sn.Od.Yu(Yc)}M=0;for(let Kd=zc.length-1;0<=Kd;--Kd){let ke;const ge=({zfe:ke}=zc.getContext(Kd)).returnValue;
ke?(Sn.Jp.Wub(ge,null),M+=Sn.Mj.kyb(ge,2),Sn.Mj.rXd=r+M):this.Zci(ge,A)}}finally{aa&&aa.dispose()}}h.dispose();return 32}xJb(){}static get Od(){return null!=Sn.J4g?Sn.J4g:Sn.J4g=Za.a.instance.resolve(46).instance}static get Mj(){return null!=Sn.w4g?Sn.w4g:Sn.w4g=Za.a.instance.resolve(39).instance}static get ti(){return null!=Sn.d5g?Sn.d5g:Sn.d5g=Za.a.instance.resolve(180).instance}static get Jp(){return null!=Sn.fXg?Sn.fXg:Sn.fXg=Za.a.instance.resolve(82)}static ly(){return Sn.Sn||(Sn.Sn=Za.a.instance.Ra(51))}static get Yja(){Sn.yDb||
(Sn.yDb=Za.a.instance.Ra(21));return Sn.yDb.instance}static get eIa(){return null!=Sn.DSg?Sn.DSg:Sn.DSg=Za.a.instance.resolve(288)}}Sn.Sn=null;Sn.yDb=null;Object(u.a)(Sn,"ADeleteParagraphContentStrategy",null,[]);var DF=d(223);class JA extends Sn{constructor(){super()}get Fg(){return null!=this.JSg?this.JSg:this.JSg=Za.a.instance.resolve(322)}get Dr(){return null!=this.ASg?this.ASg:this.ASg=Za.a.instance.Ra(11)}get Rqc(){return null!=this.g0g?this.g0g:this.g0g=Za.a.instance.resolve(274)}get A6(){return null!=
this.hTg?this.hTg:this.hTg=Za.a.instance.resolve(22)}get cU(){return null!=this.DVg?this.DVg:this.DVg=Za.a.instance.resolve(88)}Zci(b,h){this.yNl(b,h)}n1k(b,h,r,A){this.Dr.instance&&this.Dr.instance.Mh&&(b.cpBegin===h.cpBegin?b.Fb=h.Fb:r&&(b.Fb=r.Hb&&r.Hb.length?0:-1),b.Tb=A)}xJb(b){Of.a.xJb(b)}yNl(b,h){var r=b.node;const A=DF.b([new Jb.a(b.cpBegin,b.cpEnd)],this.dNm(b));var M=new cb.a,aa=[];JA.msl(r,A,M,aa);for(const oa of M.keys)1<M.K(oa)&&pJ.a.uhj(N.a.Cf(oa));this.Xuo(r,aa);this.Rqc.OUc(r);r=b.Tb;
M=!!this.Dr.instance&&this.Dr.instance.Mh;for(aa=A.length-1;0<=aa;aa--)r=this.deleteRange(b,A[aa],r,M,h)}dNm(b){const h=[],r=b.node;var A=cn.f(r,oa=>oa.Mja);for(var M of A)A=M.Jb.cp,h.push(new Jb.a(A,A+1));M=[];fx.a.eI?this.cU&&(M=this.cU.zIf(r,b)):M=Gd.ParagraphReader.EVa(r);for(var aa of M)this.rkn(aa,b)&&h.push(aa);aa=!!this.Dr.instance&&this.Dr.instance.fta;this.Dr.instance&&this.Dr.instance.Mh||!aa||!r.Jv||(JA.H5h&&JA.H5h.Tto(b),this.A6&&h.push(...this.A6.Aui(r).toArray()));return DF.a(h)}rkn(b,
h){return fx.a.eI?this.cU?!this.cU.xVi(b,h):!1:!b.aN||!JA.NXf(b,h)}Xuo(b,h){const r=new ib.a;for(const A of h)for(h=0;h<A.length;){h=this.Ayi(A,h,0);if(-1===h)break;let M=this.Ayi(A,h+1,3);if(-1===M)break;if(A.K(h).aN)for(;M>=h;){const aa=A.K(M);r.add(aa.pe);A.remove(aa);M--}h=M+1}b.ana(r)}Ayi(b,h,r){for(;h<b.length;h++){const A=b.K(h);if(1===A.Uq&&A.le===r)return h}return-1}deleteRange(b,h,r,A,M){const aa=h.Ec,oa=h.end;h=null;A&&(h=b.node.ra.sh(aa));aa<oa&&(A=wc.a.createTextRange(b.node,aa,oa),fx.a.qpb&&
(A.Rea=b.Rea,A.Vra=b.Vra),this.n1k(A,b,h,r),this.Fg.Ve(A,"",void 0,void 0,ub.a.XSc,!1,M));return r=h&&h.Hb&&h.Hb.length?h.Hb.length:-1}static get H5h(){return null!=JA.rTg?JA.rTg:JA.rTg=Za.a.instance.Oa(623)}static NXf(b,h){return b.Ec>=h.cpBegin&&b.end<=h.cpEnd}static msl(b,h,r,A){let M=0;b=b.ra;for(const aa of h)for(;M<b.length;){h=b.K(M);if(h.cp>=aa.Ec&&h.cp<aa.end&&(h.fc&&h.fc.exl&&A.push(h.fc),h.Zh))for(let oa=0;oa<h.Zh.length;oa++){const Ja=h.Zh.K(oa).Io.toString();r.lb(Ja)?r.Z(Ja,r.K(Ja)+1):
r.Z(Ja,1)}++M}}}Object(u.a)(JA,"DeleteParagraphContentStrategy",Sn,[]);class tM{static get cJ(){return dN.a.instance}static HOl(b,h,r){if(1===r)return 32;b=h.node;return tM.cJ.HTd(b)?ms.gOl(b,r):32}}Object(u.a)(tM,"DeleteUnsupportedObjectStrategy",null,[]);var JD=d(837),sO=d(518);class eN{constructor(b,h,r,A,M){this.DBp=b;this.cca=r;this.rd=A;this.actionId=h;this.Xsd=M}}Object(u.a)(eN,"DeleteActionData",null,[]);class sj{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb){this.$ci=b;this.rg=h;this.cJ=r;this.Jp=
A;this.X2=M;this.Vg=aa;this.Tpj=oa;this.Fg=Ja;this.Od=fb;this.eIa=Cb}wjp(b){return!ze.a.Zl(b)&&!ze.a.Ifa(b)}MHm(b,h,r){var A;let M,aa,oa;if(!h&&b&&b.fw&&(A=b.Qa)&&ze.a.pf(A)&&this.Vg.Vb(A.node)&&(M=A.node.ra.sh(A.cpBegin))&&M.pn&&(aa=this.Vim(M))&&aa.hyperlink.sI&&(oa=this.AHm(b,aa.cp)))return oa;if(!b)return null;if(A=this.xnp(b,h))return A;if(!r)return b;h=ze.a.h8a(b,!h,{BE:!1,Eu:!0,QG:!0,aJ:!0});return sc.SelectionFactory.Qy(b,h.Qa,!1)}Vim(b){const h=b.paragraph.ra;let r=null;b=b.cp;for(let A=
0;A<h.length;A++){const M=h.K(A);if(M.cp>=b)break;M.pn&&(r=null);M.hyperlink&&(r=M)}return r}DHm(b,h){var r=b.Qa.node;if(h){if(h=ze.a.B_a(b.Qa.node,b.Qa.cpBegin,!0),b=sc.SelectionFactory.Qy(b,wc.a.Tc(b.Qa.node,h),!1),r=r.ra.sh(h),r.q7||r.Z_)b.Qa.Fb=0}else if(h=ze.a.B_a(b.Qa.node,b.Qa.cpBegin,!1),b=sc.SelectionFactory.Qy(b,wc.a.Tc(b.Qa.node,h),!1),r=r.ra.sh(h),r.q7||r.Z_)b.Qa.Fb=r.iz+r.nS;b.Anc=!0;return b}xnp(b,h){var r=b.Qa;let A=null;if(!b.fw||!r||!ze.a.pf(r))return null;if(this.Vg.Vb(r.node)&&
(A=h?r.node.ra.sh(r.cpBegin):r.node.ra.T8a(r.cpBegin-1))&&A.BU)return this.DHm(b,h);r=vd.a.Za(b.Qa.node);if(!r.vb(8))return null;Bb.OutlineElementNavigator.je(r);let M=!1;const aa=[];if(h?A&&A.ni:0===b.Qa.cpBegin){do(b=h?Bb.OutlineElementNavigator.Zs(r,!0,!0,!1):Bb.OutlineElementNavigator.z3(r,!0,!0,!1))&&(null===b||void 0===b?0:b.BWa)?(aa.push(wc.a.create(Bb.OutlineElementNavigator.Me(r))),Bb.OutlineElementNavigator.je(r)):M=!0;while(!M);if(0<aa.length)return h=new Er.Selection(h?aa:aa.reverse(),
h),h.Anc=!0,h}return null}AHm(b,h){var r=ze.a.MJa(b,{BE:!1,Eu:!1,QG:!0,aJ:!0});if(!r||!r.fw||r.Qa.node!==b.Qa.node)return null;r=r.Qa;if(r.cpBegin!==r.cpEnd)return null;const A=this.Vg.text(r.node);for(let M=r.cpBegin-1;M>=h;M--)if(!I.a.Sw(A.charCodeAt(M)))return sc.SelectionFactory.Qy(b,wc.a.Tc(r.node,M+1),!1);return sc.SelectionFactory.Qy(b,wc.a.Tc(r.node,h),!1)}Dvf(b,h,r,A,M){var aa,oa;if(1===r)return 32;(r=null===(oa=null===(aa=h.view)||void 0===aa?void 0:aa.mb)||void 0===oa?void 0:oa.Mg)&&Object(Al.a)().ubi(r).filter(Gd.ParagraphReader.qX).forEach(Ja=>
{var fb;return null===(fb=Gd.ParagraphReader.kKa(Ja.node))||void 0===fb?void 0:fb.Axe("delete_selection")});oa=!1;b===ub.a.Ttf?(b=ub.a.JJ,oa=!0):b===ub.a.mYd?(b=ub.a.backspace,oa=!0):b===ub.a.Yza&&(h=new kw.a(qa.StaticActiveAppFrame.za().kb.Jc));if(!h.view.te)return 2;zz.GrippersManager.instance.fA(!1);aa=b===ub.a.JJ;r=mt.a.G5d(h);if(oa&&this.rg.Mh&&r&&ze.a.Am(r)&&this.rg.WYf(r.Qa,!aa,!0))return 2;oa=this.MHm(r,aa,oa);return this.JOl(b,h,A,M,oa,aa)}JOl(b,h,r,A,M,aa){var oa;const Ja=h.view,fb=Ja.mb;
var Cb=A,Gb=A;b===ub.a.Yza&&(Gb=Cb=null,M=new Er.Selection(A,!0));if(!M)return 32;const Sb=this.PZo(Cb,aa);if(this.rg.Mh&&sj.Yja&&1===fb.gb.length&&ze.a.Am(M)&&M.fw&&sj.Yja.cKo(M.Qa,aa)||fx.a.eI&&sj.cU&&1===fb.gb.length&&ze.a.Am(M)&&M.fw&&sj.cU.dKo(M.Qa,aa))return 32;let pc;aa?db.a.mark(pc=5009):db.a.mark(pc=5011);Cb=new Rb.GraphTransaction(15);Cb.Ii=b;Cb.Bb(Ja.od);let zc=null,Yc=({nIo:zc}=this.Tkm(b,A,fb,M,zc)).returnValue;var Kd=null;({fze:Kd}=Object(Al.a)().WCg(Yc)).returnValue&&(Yc=Kd);if(!Yc)return Cb.dispose(),
32;Kd=!1;y.AFrameworkApplication.vd("b1jb9393;09icj321");if(null===(oa=y.AFrameworkApplication.J)||void 0===oa?0:oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",!1))oa=Yc.node,Kd=null===oa||void 0===oa?void 0:oa.Jv;const ke=new eN(h,b,r,Gb,Kd);Gb=null;this.rg.Mh&&sj.Yja&&(Gb=Object(Al.a)().GO(Yc),sj.Yja.Kzj(Gb));fx.a.eI&&fx.a.u7a&&sj.cU&&1===fb.gb.length&&!ze.a.Am(M)&&(Gb||(Gb=Object(Al.a)().GO(Yc)),sj.cU.Xto(Gb));this.E0j(Yc);const ge=this.jri(Yc,M,aa);let de=null;
aa?de=new JD.a(M):ge&&(de=new JD.a(ge));let Sd=!1;Gb=sj.Zk;if(ze.a.pf(Yc)){const be=TC.a.Tjc(Ja.od,Sb);Gb.$d(()=>{this.tNl(h,r,A,Yc,aa,de,M,be,fb,Sb,ke,ge)},"DVS:DAIPC")}else this.Od.Lg&&!this.eIa.Pee(M)?(Gb.$d(()=>{this.vjp(b,Ja.od,Yc,aa,M,fb,Sb,ke,de)},"DVS:TCDC"),Sd=!0):Gb.$d(()=>{Sd=this.krj(b,Ja.od,Yc,fb,Sb,ke,de,zc)},"DVS:PUD");this.v8l(fb);this.KEj(Yc);Cb.dispose();db.a.mark(pc+1);return b===ub.a.Yza?Sd?32:8:32}krj(b,h,r,A,M,aa,oa,Ja){h=TC.a.Tjc(h,M);this.wjp(r)&&h.Yeb(r);b=sj.Dc.nq(b);b.properties.Z("CountOfParagraphsDeleted",
this.Vg.wrf(r).toString());r=this.WSl(r,A,M,h,aa,oa,Ja);b.end();return r}vjp(b,h,r,A,M,aa,oa,Ja,fb){var Cb=0,Gb=null;const Sb=Object(Al.a)().GO(r),pc=Sb[Sb.length-1];if(pc.contextId===lc.a.paragraph||pc.contextId===lc.a.Uc){var zc=vd.a.Za(pc.node);zc.Kd();Bb.OutlineElementNavigator.je(zc);Bb.OutlineElementNavigator.Zs(zc,!0,!1)&&(Gb=Bb.OutlineElementNavigator.Me(zc))&&(Cb=this.Vg.textLength(Gb))}else Cb=this.Vg.textLength(pc.node)-pc.cpEnd;zc=Object(ya.a)(89,Ja.rd);if(zc=!!zc&&zc.ka(fd.a.fXf,!1))this.irj(b,
h,r,aa,oa,Ja,fb,!1,zc);else{zc=this.Od.W5a();try{this.irj(b,h,r,aa,oa,Ja,fb,!0)}finally{zc&&zc.dispose()}}if(M.Anc)Cb=this.jri(r,M,A),this.Vg.Vb(Cb.Qa.node)&&gg.a.instance.Kc(Cb);else{if(A){if(r.Qw){b=Sb.length-1;do M=Sb[b],b--;while(!M.node.isConnected&&0<=b)}else M=r;if(!this.Vg.Vb(M.node))return;switch(pc.contextId){case lc.a.paragraph:case lc.a.Uc:Cb=Gb&&Gb.isConnected?0:Cb;break;case lc.a.Xc:case lc.a.Cd:break;default:Cb=0}Cb=sc.SelectionFactory.ue(M.node,this.Vg.textLength(M.node)-Cb);M.Hj===
Cb.Qa.cpBegin&&(Cb.Qa.Fb=M.Fb)}else{Cb=M.Qa.node;if(!this.Vg.Vb(Cb))return;Gb=M.Qa.contextId===lc.a.paragraph?0:M.Qa.contextId===lc.a.Uc?this.Vg.textLength(Cb):M.Qa.cpBegin;Cb=sc.SelectionFactory.ue(Cb,Gb)}gg.a.instance.Kc(Cb)}}irj(b,h,r,A,M,aa,oa,Ja,fb=!1){r=this.Tbm(A,r);r=sj.ti.opd(r);({type:Gb}=r.R8d()).returnValue&&Ja&&4!==Gb&&this.Od.Yu(Gb);for(Ja=r.length-1;0<=Ja;--Ja){var Cb=void 0;var Gb=({zfe:Cb}=r.getContext(Ja)).returnValue;Cb?(Cb=fb&&Gb.contextId===lc.a.Uc&&Ja===r.length-1,this.Jp.Wub(Gb,
2),Cb||sj.Mj.kyb(Gb,2)):this.krj(b,h,Gb,A,M,aa,oa,null)}}Tbm(b,h){if(Object(Xa.a)(dn.a,h)){b=Kv.OutlineElementGeneralizer.Mka(b.gb,!0);for(let r=0;r<b.length;r++)if(b.getContext(r).contextId===lc.a.table)return b}return h}Tkm(b,h,r,A,M){b===ub.a.Yza?(b=sB.a.OIa(h),M=sO.SelectionReferenceFactory.instance.nMb()):(M=null,b=1===r.gb.length?gg.a.jMb(A):r.Mg);return{returnValue:b,nIo:M}}Lil(b){return!b.Al||b.contextId!==lc.a.paragraph||!this.Vg.Vb(b.node)||this.Od.Lg||this.rg.mee(b)?!1:!0}E0j(b){if(b.Qw)for(let h=
0;h<b.length;h++)this.E0j(b.getContext(h));else this.Lil(b)&&(b.node.ITd=!0)}KEj(b){if(b.Qw)for(let h=0;h<b.length;h++)this.KEj(b.getContext(h));else b.Al&&(b=b.node)&&this.Vg.Vb(b)&&(b.ITd=!1)}jri(b,h,r){if(b.Al&&ze.a.pf(b)&&!r){const A=b.node;let M=b.cpBegin,aa=-1;if(({cp:M}=this.rg.wdj(A,M)).returnValue)return sc.SelectionFactory.ue(A,M);if(({cp:M,Xqa:aa}=this.rg.vdj(b,M,aa)).returnValue)return h=sc.SelectionFactory.ue(A,M),h.Qa.Fb=aa,h.Qa.Tb=aa,h}h=ze.a.h8a(h,!r,{BE:!h.Anc||h.fw,Eu:!1,QG:!1,aJ:!0,
mza:ze.a.Am(h)});this.rg.Mh&&ze.a.Zl(b)&&(h.Qa.Tb=h.Qa.Fb=r?b.Tb:b.Fb);return h}tNl(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb){const pc=sj.Zk;!ze.a.UA(A.node,A,M)||this.rg.Mh&&this.rg.iXi(A)?pc.$d(()=>{this.YNl(A,M,aa,oa,Ja,fb,Cb,Gb)},"DVS:IPM"):pc.$d(()=>{const {response:zc,h4:Yc}=this.XNl(b,h,r,A,M,oa,Ja,fb,Gb,Sb);sj.Ofj(Ja,32===zc);Yc&&sj.Wua(fb,aa)},"DVS:ISE")}vTm(b,h){h.rd||(h.rd=new wg.DictionaryPropertySet);h.rd.setValue(fd.a.Nta,"delete");h.rd.setValue(fd.a.cma,"backspace");var r=of.ListItemReader.Ce?
b:b.bE;const A=sj.Md.N2(r),M=kt.Ztn;if(null===M||void 0===M?0:M.Lmn(r,A)){h.rd.setValue(fd.a.cma,"backspace-autocorrect");r=M.o1j+" ";const aa=wc.a.Tc(b,0);this.Fg.Ve(aa,r);b=sc.SelectionFactory.ue(b,r.length);gg.a.instance.Kc(b);v.ULS.sendTraceTag(540386467,393,50,"Unlisted list with trigger string: {0}",M.o1j)}return y.AFrameworkApplication.va.Nf(h.DBp,A.Uz?ub.a.MN:ub.a.ME,2,!1,h.cca,h.rd)}RSm(b,h,r,A,M){let aa=!1;0<this.Tpj.K2(b).Ou&&(M=y.AFrameworkApplication.va.Nf(h,ub.a.Buc,2,!1,r,A),aa=!0);
return{eX:aa,response:M}}YSm(b,h,r,A,M){let aa=!1;0<this.Tpj.jI(b).Ou&&(M=y.AFrameworkApplication.va.Nf(h,ub.a.Mjd,2,!1,r,A),aa=!0);return{eX:aa,response:M}}eUm(b,h,r,A,M){let aa=!1;sj.ir.bLb(b)&&(M=y.AFrameworkApplication.va.Nf(h,ub.a.KI,2,!1,r,A),aa=!0);return{eX:aa,response:M}}BRm(b,h,r,A,M,aa,oa,Ja,fb,Cb){const Gb=new xm.a;Gb.hd(h);let Sb=!1;if(Bb.OutlineElementNavigator.fMa(Gb,!1,!b,!1)){Cb=!0;fb=32;Sb=!0;(new vd.a).hd(Gb);Bb.OutlineElementNavigator.Me(Gb);const zc=Gb.currentNode;Gd.ParagraphReader.Aza(zc)&&
Gd.ParagraphReader.kKa(zc).Axe("delete_ip");var pc=new vd.a;pc.set(oa);(pc=this.Vg.isEmpty(pc))&&M&&ze.a.bba(M.Qa)?(r.Yeb(aa),Bb.OutlineElementNavigator.Me(h),sj.gg.mNa(h.currentNode)):zc.CL?(r.Yeb(aa),Bb.OutlineElementNavigator.je(Gb),Gb.Rg()):b&&pc?this.rg.RZi(oa)&&!({h4:Cb}=this.euj(b,oa,zc,M,Cb)).returnValue&&(r.Yeb(aa),sj.$l.Nga(h),this.$ci.tbo(oa),h.Rg()):Ii.TableReader.isTable(Gb)?(r.Yeb(aa),b&&(Oh.moveToFirstRow(Gb),Oh.moveToFirstColumn(Gb),Yn.OutlineNavigator.zba(Gb),Bb.OutlineElementNavigator.Me(Gb),
Ja.Kc((new JD.a(sc.SelectionFactory.ue(Gb.currentNode,0))).restore())),fb=2,Cb=!1):this.Vg.Vb(zc)&&(1==this.Vg.textLength(zc)&&(Ja=cn.e(zc),1==Ja.length&&8==Ja[0].Qh&&(Ja=wc.a.createTextRange(zc,0,1),this.Fg.Ve(Ja,"",void 0,void 0,ub.a.XSc))),({h4:Cb}=this.euj(b,oa,zc,M,Cb)).returnValue||(A.actionId==ub.a.backspace&&r.zzc(oa),this.$ci.uNl(b,r,aa,h,oa,Gb)))}return{eX:Sb,response:fb,h4:Cb}}euj(b,h,r,A,M){if(this.Od.Lg){if(sj.fUa){const aa=Object(Xa.a)(Gn.AParagraphNode,r)?sj.fUa.nee(r):!1,oa=Object(Xa.a)(Gn.AParagraphNode,
h)?sj.fUa.nee(h):!1;if(aa!==oa)return{returnValue:!1,h4:M}}b=b?h:r;if(!Object(Xa.a)(Gn.AParagraphNode,b))return{returnValue:!1,h4:M};h=b.ra.last;r=y.AFrameworkApplication.userName;if(!h.Ui||h.Ui.authorName!==r)return sj.Mj.M_b(b,2),A&&(gg.a.instance.Kc(A),M=!1),{returnValue:!0,h4:M}}return{returnValue:!1,h4:M}}nTm(b,h,r,A,M,aa,oa,Ja){Db.OutlineElementReader.jgn(h,b)||({response:oa,h4:Ja}=sj.QTl(r,A,b,aa,M,oa,Ja));return{eX:!1,response:oa,h4:Ja}}XNl(b,h,r,A,M,aa,oa,Ja,fb,Cb){let Gb=!1,Sb=2;const pc=
A.node;let zc=void 0,Yc=!1;const Kd=sj.Zk;if(!M){if(of.ListItemReader.Ce?of.ListItemReader.isListItem(pc):pc.bE)return Kd.$d(()=>{Sb=this.vTm(pc,fb)},"DVS:HLOE"),{response:Sb,h4:Gb};Kd.$d(()=>{({response:Sb,eX:Yc}=this.RSm(pc,b,h,r,Sb))},"DVS:HIOD");if(Yc)return{response:Sb,h4:Gb};Kd.$d(()=>{({response:Sb,eX:Yc}=this.YSm(pc,b,h,r,Sb))},"DVS:HWPF");if(Yc)return{response:Sb,h4:Gb};zc=this.izi(pc);Kd.$d(()=>{({response:Sb,eX:Yc}=this.eUm(zc,b,h,r,Sb))},"DVS:HPOB");if(Yc)return{response:Sb,h4:Gb}}null!==
zc&&void 0!==zc?zc:zc=this.izi(pc);Kd.$d(()=>{({response:Sb,eX:Yc,h4:Gb}=this.BRm(M,zc,oa,fb,Cb,A,pc,Ja,Sb,Gb))},"DVS:HAOE");if(Yc)return{response:Sb,h4:Gb};Kd.$d(()=>{({response:Sb,eX:Yc,h4:Gb}=this.nTm(M,zc,h,r,oa,aa,Sb,Gb))},"DVS:HFLOE");return{response:Sb,h4:Gb}}YZo(b){return ze.a.Zl(b)||this.cJ.k2i(b)||ze.a.Ifa(b)}PZo(b,h){return b&&b.hasProperty(pd.a.OYc)?!b.ka(pd.a.OYc,!1):!h}static get Md(){return null!=sj.N_g?sj.N_g:sj.N_g=Za.a.instance.resolve(10)}static get $l(){return null!=sj.D_g?sj.D_g:
sj.D_g=Za.a.instance.resolve(32)}static get gg(){return null!=sj.J0g?sj.J0g:sj.J0g=Za.a.instance.resolve(18)}static get ir(){return Rj.a.UPb}static get Mj(){return null!=sj.z4g?sj.z4g:sj.z4g=Za.a.instance.resolve(39).instance}static get ti(){return null!=sj.g5g?sj.g5g:sj.g5g=Za.a.instance.resolve(180).instance}static get Dc(){return Rg.a.instance}static get Yja(){sj.yDb||(sj.yDb=Za.a.instance.Ra(21));return sj.yDb.instance}static get cU(){sj.GEf||(sj.GEf=Za.a.instance.Ra(88));return sj.GEf.instance}static get fUa(){return null!=
sj.uTg?sj.uTg:sj.uTg=Za.a.instance.Oa(14)}static get Zk(){return er.a.instance}v8l(b){if(1===b.gb.length&&(b=b.gb.K(0),ze.a.Am(b))){var h=b.Qa;b=h.node;h=h.cpBegin;var r=this.Vg.text(b);h<r.length&&0<h&&" "===r.charAt(h-1)&&" "===r.charAt(h)&&this.Fg.Ve(wc.a.createTextRange(b,h-1,h),"\u00a0")}}s$k(b,h){if(!h.hyperlink.Rsb){const r=new Rb.GraphTransaction(15);try{r.Bb(b.node),this.X2.cV(b,h)}finally{r&&r.dispose()}h.hyperlink.sI&&this.Od.Yu(2)}}static QTl(b,h,r,A,M,aa,oa){if(r=ze.a.h8a(A,!r,{BE:!1,
Eu:!1,QG:!1,aJ:!0})){A=sc.SelectionFactory.Qy(A,r.Qa);aa=32;for(r=0;r<A.length;++r){M.Yeb(A.K(r));const Ja=y.AFrameworkApplication.va.Nf(A.K(r),ub.a.JJ,2,!0,b,h);2!==Ja&&(aa=Ja)}32===aa&&(oa=!0)}return{response:aa,h4:oa}}WSl(b,h,r,A,M,aa,oa){let Ja=!1;this.ZZo(b)?(Ja=sj.Ywf(b,!0,h,r,A,M))&&sj.fPa(aa,h,oa):this.YZo(b)?(Ja=sj.Ywf(b,!1,h,r,A,M))&&sj.fPa(aa,h,oa):(A.normalize(),sj.fPa(aa,h,oa));return Ja}static fPa(b,h,r){r&&r.Wua()||sj.Wua(h,b)}static Ywf(b,h,r,A,M,aa){var oa;A||gm.OutlineReader.nXa(b)||
(r=sj.Trd(r))&&M.gWo(r);y.AFrameworkApplication.vd("b1jb9393;09icj321");if(null===(oa=y.AFrameworkApplication.J)||void 0===oa?0:oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",!1))aa.rd?aa.rd.Xsd=aa.Xsd:aa.rd={Xsd:aa.Xsd};oa=b instanceof dn.a?b.getContext(0).node:b.node;oa=sj.HAm(oa);b=32===y.AFrameworkApplication.va.Nf(b,aa.actionId,2,h,aa.cca,aa.rd);sj.Ofj(M,b,oa);return b}static get im(){return null!=sj.tWg?sj.tWg:sj.tWg=Za.a.instance.resolve(101)}static get Vyb(){return null!=
sj.g3g?sj.g3g:sj.g3g=Za.a.instance.resolve(8)}static HAm(b){const h=new zn.a;if(b){let r=null;b=sc.SelectionFactory.hp(b,!0);if(!b)v.ULS.sendTraceTag(509645905,315,10,"Unexpected null selection.");else for(let A=0;A<b.length;A++)if(Wa.FormattingReader.tqf(b.K(A))){r=b.K(A);break}r&&((b=Wa.FormattingReader.Rs(r))&&b.cache&&b.cache.mE&&(b=b.Bf(null),sj.im.l8(b)),b&&(h.formatting=b.Ek,h.languageId=Wa.FormattingReader.language(b)),h.goa=sj.Vyb.Aq(r.node))}return h}static Ofj(b,h,r){h?b.normalize(r):b.cancel()}static Wua(b,
h){h&&sj.Zk.$d(()=>{const r=h.restore();r&&b.Kc(r)},"DVS:RS")}YNl(b,h,r,A,M,aa,oa,Ja){let fb;!h&&({hyperlink:fb}=this.X2.Lnc(b)).returnValue?(r=new JD.a(A),this.s$k(b,fb),M.normalize(),sj.Wua(aa,r)):sj.Ywf(b,!1,aa,oa,M,Ja)&&(h&&this.Od.Lg?(h=sj.Mj.rXd)?(aa.Kc(sc.SelectionFactory.ue(b.node,h)),sj.Mj.rXd=null):sj.Wua(aa,r):sj.Wua(aa,r))}ZZo(b){return b.Qw||gm.OutlineReader.nXa(b)||this.Vg.fn(b)}static Trd(b){return(b=Kv.OutlineElementGeneralizer.Mka(b.gb,!0))&&1===b.length&&(b=b.getContext(0).node,
Ii.TableReader.zU(b))?b:null}izi(b){const h=new vd.a;h.set(b);h.Kd();Bb.OutlineElementNavigator.je(h);return h}}sj.yDb=null;sj.GEf=null;Object(u.a)(sj,"ADeleteViewStrategy",null,[]);class Mw{uNl(b,h,r,A,M,aa){const oa=aa.currentNode;Bb.OutlineElementNavigator.je(aa);b?(h.zzc(aa.currentNode),Mw.rg.wYi(r,M,oa,!1)||Mw.gg.merge(A,aa,!1,!1)):Mw.rg.wYi(r,oa,M,!0)||Mw.gg.merge(aa,A,!1,!1)}tbo(b){b&&Gd.ParagraphReader.Vb(b)&&(fD.a.Gjd(b),Mw.uWl.$ff(b))}static get gg(){return null!=Mw.F0g?Mw.F0g:Mw.F0g=Za.a.instance.resolve(18)}static get uWl(){return null!=
Mw.eUg?Mw.eUg:Mw.eUg=Za.a.instance.resolve(1096)}static get rg(){return re.a.instance}}Object(u.a)(Mw,"DeleteParagraphNodeStrategy",null,[510]);class fN extends sj{constructor(b,h,r,A,M,aa,oa,Ja,fb){super(new Mw,b,h,r,A,M,aa,oa,Ja,fb)}}Object(u.a)(fN,"DeleteViewStrategy",sj,[]);class TL extends ms{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb){super();this.deleteParagraph=(pc,zc)=>{pc=zc.node;fD.a.Gjd(pc);this.TPe.$ff(pc);this.vp&&this.vp.instance&&this.vp.instance.Pkj(pc);pc.Jv&&(this.Vm.Sto(pc,!this.Mh),
this.Mh&&this.Ohh.instance&&this.Ohh.instance.S4j(pc));return 0};this.sNl=(pc,zc,Yc)=>{if(1===Yc)return 32;pc=qa.StaticActiveAppFrame.za().Vr.Wf("ModelUpdate","DeleteAnchoredObject");zc=zc.node;Yc=new vd.a;Yc.set(zc);Yc.vb(12);var Kd=Yc.rp(12);if(re.a.instance.w9c(Kd))return 2;Of.a.xJb(Kd);Kd=new Rb.GraphTransaction(7);Kd.Bb(zc);Yc.Rg();Kd.dispose();pc.stop();return 32};this.crk=new JA;this.drk=new fN(re.a.instance,dN.a.instance,aa,oa,Ja,fb,Cb,Gb,Sb);this.Vm=b;this.jHc=h;this.Ohh=r;this.TPe=A;this.vp=
M}get Mh(){return this.jHc.instance?this.jHc.instance.Mh:!1}get idi(){return this.drk}get Yci(){return this.crk}Ppg(b,h,r,A){const M=tM.HOl,aa=this.sNl;b.qa(ub.a.backspace,lc.a.I$,aa);b.qa(ub.a.backspace,lc.a.XOa,M);b.qa(ub.a.JJ,lc.a.I$,aa);b.qa(ub.a.JJ,lc.a.XOa,M);b.qa(ub.a.backspace,lc.a.paragraph,this.deleteParagraph);b.qa(ub.a.JJ,lc.a.paragraph,this.deleteParagraph);b.qa(ub.a.Yza,lc.a.paragraph,this.deleteParagraph);b.Pc(ub.a.Yza,64);super.Ppg(b,h,r,A)}static xJb(b){var h;(null===(h=Of.a.ud())||
void 0===h?0:h.Co)&&Of.a.ud().Ak.xG(b)}}Object(u.a)(TL,"DeleteActor",ms,[]);var tO=d(446);class HK{constructor(){this.Height=this.Width=0}static construct(b,h){const r=new HK;r.Width=b;r.Height=h;return r}}Object(u.a)(HK,"ViewportInfo",null,[]);class AI extends sl.a{constructor(){super();this.ContractVersion=0;this.World=this.EnhancementId=this.DocumentContent=null;this.ScalingFactor=0;this.MobileViewportInfo=this.DesktopViewportInfo=null;this.MinParagraphCount=0;this.ContentCulture=null}$m(){return tO.a.Gcp}static construct(b,
h,r,A,M,aa,oa,Ja,fb,Cb,Gb){const Sb=new AI;Sb.ContractVersion=b;Sb.DocumentContent=h;Sb.EnhancementId=r;Sb.World=A;Sb.ScalingFactor=M;Sb.DesktopViewportInfo=HK.construct(aa,oa);Sb.MobileViewportInfo=HK.construct(Ja,fb);Sb.MinParagraphCount=Cb;Sb.ContentCulture=Gb;return Sb}}Object(u.a)(AI,"SwayPreviewRequest",sl.a,[]);var UL=d(594);class AA{static get kh(){y.AFrameworkApplication.vd("wwa11yq3;wwa11yq3cf");return ig.a.Ry(df.a.instance&&df.a.instance.L2i?AA.OQl:AA.Hn,WordEditorIntl.WordEditorStrings.L_DigitalPrintLearnMore,
WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogStyleLabel,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogPreviewLabel,AA.lHo,WordEditorIntl.WordEditorStrings.l_SavingStatus)}}AA.lHo=Bk.a.ki("progress.gif");AA.Hn="<div class='WACDialogRow digitalPrintDialogWrapper UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
AA.OQl="<div class='WACDialogRow digitalPrintDialogWrapper digitalPrintDialogWrapperResize UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper swayGalleryWrapperResize' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper swayPreviewWrapperResize' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
Object(u.a)(AA,"DigitalPrintDialogHtml",null,[]);class wv{constructor(b,h,r,A){this.fontFamily=b;this.TDo=h;this.fontWeight=r;this.fontStyle=A}}Object(u.a)(wv,"FontInfo",null,[]);class Ar{constructor(b,h,r,A){this.styleName=b;this.title=h;this.shp=r;this.eYm=A}}Object(u.a)(Ar,"StyleVisualInfo",null,[]);class Nw extends ig.a{constructor(b,h,r,A,M=!0){super();this.M9=this.Lm=this.vpa=this.D5=this.aCd=this.DFh=this.fNd=this.A9e=this.B9e=this.T8e=this.jac=this.DSa=this.R5=this.E$b=null;this.lbf=this.$4e=
!1;this.RAd=null;this.WUl=()=>{this.PHj(0)};this.VUl=(aa,oa)=>{this.PHj(oa)};this.gnj=aa=>{this.mzi(aa)===Sys.UI.Key.enter&&(this.Xfg(aa),aa.preventDefault(),aa.stopPropagation())};this.ojj=aa=>{((aa=aa.rawEvent.relatedTarget)&&("digitalPrintLearnMoreLink"===aa.id||aa.id===af.a.xvd)||Y.a.Jt)&&this.DSa&&this.m_b(this.DSa)};this.pjj=aa=>{const oa=this.mzi(aa);oa!==Sys.UI.Key.tab&&oa!==Sys.UI.Key.left&&oa!==Sys.UI.Key.right&&oa!==Sys.UI.Key.up&&oa!==Sys.UI.Key.down||this.JUm(oa)||(aa.preventDefault(),
aa.stopPropagation(),this.rVn(oa))};this.$dg=()=>{this.lbf||(this.lbf=!0,v.ULS.sendTraceTag(25798020,382,50,"User has scrolled styles gallery"),mf.a.removeHandler(this.R5,Jd.a.scroll,this.$dg))};this.Heg=()=>{v.ULS.sendTraceTag(26005580,382,50,"Learn more click")};this.Xfg=aa=>{aa.preventDefault();aa.stopPropagation();y.AFrameworkApplication.va.Ob(ub.a.Bei,2);aa.target?(aa="button"===aa.target.tagName.toLowerCase()?aa.target:aa.target.parentNode)&&aa.id!==this.E$b&&(v.ULS.sendTraceTag(25231813,382,
50,"DigitalPrintDialog.OnStyleGalleryItemClick style changed from {0} to {1}",this.E$b,aa.id),this.u_h(aa),this.$9h()):v.ULS.sendTraceTag(24418077,382,10,"DigitalPrintDialog.OnStyleGalleryItemClick e.Target is null!")};this.wRl=aa=>{const oa=(new Date).getTime()-this.udh;vg.a.instance.qf(Jh.a.yRl,oa);aa?this.qMo():(v.ULS.sendTraceTag(25231814,382,50,"DigitalPrintDialog.DigitalPrintDialogHandler Dialog has been closed with the cancel button"),y.AFrameworkApplication.va.Ob(ub.a.Aei,2))};this.oMo=()=>
{this.z5o();try{const aa=Nw.cgi.K2l(),oa=AI.construct(2,aa,this.E$b,"VerticalWorld",.3,1366,600,330,280,20,Nw.cgi.jhb.name);y.AFrameworkApplication.Ee.Wj(String.format("{0}/we/GetSwayPreview.ashx?{1}",df.a.webServiceBase,y.AFrameworkApplication.rootQuerySignature),2,UL.b(oa),{"Content-Type":"application/json; charset=utf-8","Content-Encoding":"gzip"},!1,2,this.Bco,this.utj,oa)}catch(aa){v.ULS.sendTraceTag(25268375,382,10,"Failed to generate preview request. Exception: {0}",aa.message)}};this.Bco=
aa=>{var oa=null;({group:oa}=tk.a.z4(aa.data.De)).returnValue?(oa=oa.Responses[0],oa.Succeeded?(this.Hhe(aa.data,Jh.a.Hcp),this.$mb(),this.ANj(this.A9e,oa.PreviewHtml),this.ANj(this.fNd,oa.PreviewHtmlMobile)):this.utj(null)):v.ULS.sendTraceTag(25231816,382,10,"DigitalPrintDialog.PreviewSuccessCallback Preview response deserialization failed")};this.utj=()=>{this.A5o();this.B9e.style.background="#E6E6E6";this.DFh.style.background="#E6E6E6"};this.kh=AA.kh;this.Ng="DigitalPrintDialog";v.ULS.sendTraceTag(26005578,
382,50,"Print to Web dialog has been opened and we initiated document force save");this.IHk=WordEditorIntl.WordEditorStrings.L_DigitalPrintTransformSlab;this.L5b=WordEditorIntl.WordEditorStrings.L_DigitalPrintButtonTransform;this.ZMk=r;this.HGc=A;this.Qe(1,this.IHk);this.mi(this.L5b,this.wRl,null);this.e4m();this.nbp();this.udh=(new Date).getTime();M&&hv.a.fU(cC.a.Bwf,!1,this.WUl,this.VUl,null);this.t5m();this.E2m();this.wxn();this.z4f();this.nxn();this.$9h()}get zAa(){return this.RAd}PHj(b){if(!this.$4e){const h=
(new Date).getTime()-this.udh;vg.a.instance.qf(Jh.a.xRl,h);b?v.ULS.sendTraceTag(25548302,382,15,String.format("We failed to save document with status code {0}",Gr.a[b])):v.ULS.sendTraceTag(25548301,382,50,"We saved document successfully");document.getElementById("digitalPrintSavingDiv").style.display="none";this.d6a.disabled=!1}}e4m(){this.jac=document.getElementById("digitalPrintStatusMessageDiv");this.T8e=document.getElementById("digitalPrintStatusMessageIconDiv");this.B9e=document.getElementById("swayDesktopPreviewWrapperDiv");
this.A9e=document.getElementById("swayDesktopPreviewHtmlHolder");this.fNd=document.getElementById("swayMobilePreviewHtmlHolder");this.DFh=document.getElementById("swayMobilePreviewWrapperDiv");this.R5=document.getElementById("swayGallery");this.R5.setAttribute("tabindex","0");mf.a.addHandler(this.R5,Jd.a.scroll,this.$dg);this.R5.setAttribute(Ne.a.Ph,Ne.a.YSh);this.D5=document.getElementById("digitalPrintLearnMoreLink");this.D5.href="https://go.microsoft.com/fwlink/?linkid=871972";mf.a.addHandler(this.D5,
Jd.a.click,this.Heg);this.vpa=new ib.a;this.aCd=document.getElementById("homeWrapper");this.t8("mainText");document.getElementById("mainText").innerText="OneDriveWOPI"===this.HGc?WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionMSA:WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionAAD}t5m(){this.Lm=new ib.a;this.Lm.add(new Ar("BokehV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBokeh,"swayLightProTitle swayBokehTitle","swayLightProHeading swayBokehHeading"));
this.Lm.add(new Ar("Regency",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameRegency,"swayVanillaTitle swayRegencyTitle","swayVanillaHeading swayRegencyHeading"));this.Lm.add(new Ar("PilarV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNamePilar,"swayVanillaTitle swayPilarTitle","swayVanillaHeading swayPilarHeading"));this.Lm.add(new Ar("Boutique",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBoutique,"swaySwirlTitle swayBoutiqueTitle","swaySwirlHeading swayBoutiqueHeading"));
this.Lm.add(new Ar("Studio",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStudio,"swaySimplicityTitle swayStudioTitle","swaySimplicityHeading swayStudioHeading"));this.Lm.add(new Ar("Sierra",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameSierra,"swaySwirlTitle swaySierraTitle","swaySwirlHeading swaySierraHeading"));this.Lm.add(new Ar("Fete",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFete,"swaySwirlTitle swayFeteTitle","swaySwirlHeading swayFeteHeading"));this.Lm.add(new Ar("CelestialV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCelestial,"swaySwirlTitle swayCelestialTitle","swaySwirlHeading swayCelestialHeading"));this.Lm.add(new Ar("TranquilV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameTranquil,"swayVanillaTitle swayTranquilTitle","swayVanillaHeading swayTranquilHeading"));this.Lm.add(new Ar("Midtown",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMidtown,"swayLightProTitle swayMidtownTitle","swayLightProHeading swayMidtownHeading"));this.Lm.add(new Ar("Lucent",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameLucent,"swaySimplicityTitle swayLucentTitle","swaySimplicityHeading swayLucentHeading"));this.Lm.add(new Ar("AerialV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAerial,"swaySwirlTitle swayAerialTitle","swaySwirlHeading swayAerialHeading"));this.Lm.add(new Ar("StructureV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStructure,"swaySwirlTitle swayStructureTitle","swaySwirlHeading swayStructureHeading"));this.Lm.add(new Ar("Muse",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMuse,"swayLightProTitle swayMuseTitle","swayLightProHeading swayMuseHeading"));this.Lm.add(new Ar("Cinema",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCinema,"swaySimplicityTitle swayCinemaTitle","swaySimplicityHeading swayCinemaHeading"));this.Lm.add(new Ar("MegaV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMega,"swayVanillaTitle swayMegatitle","swayVanillaHeading swayVanillaHeading"));this.Lm.add(new Ar("ConvergenceV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameConvergence,"swayVanillaTitle swayConvergenceTitle","swayVanillaHeading swayConvergenceHeading"));this.Lm.add(new Ar("Alloy",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAlloy,"swayLightProTitle swayAlloyTitle","swayLightProHeading swayAlloyHeading"));this.Lm.add(new Ar("Fluent",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFluent,"swaySimplicityTitle swayFluentTitle","swaySimplicityHeading swayFluentHeading"));this.Lm.add(new Ar("Aurora",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAurora,"swaySwirlTitle swayAuroraTitle","swaySwirlHeading swayAuroraHeading"));this.Lm.add(new Ar("Civic",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCivic,"swayLightProTitle swayCivicTitle","swayLightProHeading swayCivicHeading"));this.Lm.add(new Ar("Reflection",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameReflection,"swaySimplicityTitle swayReflectionTitle","swaySimplicityHeading swayReflectionHeading"))}E2m(){this.M9=
new ib.a;this.M9.add(new wv("universc","universc","normal","normal"));this.M9.add(new wv("Miller-Banner_Roman_WebTT","Miller-Banner_Roman_WebTT","normal","normal"));this.M9.add(new wv("Miller-Banner_Italic_WebTT","Miller-Banner_Italic_WebTT","normal","italic"));this.M9.add(new wv("Miller-Banner_Bold_Italic_WebTT","Miller-Banner_Bold_Italic_WebTT","bold","italic"));this.M9.add(new wv("QuireSans-Thin","QuireSans-Thin","extrathin","normal"));this.M9.add(new wv("Posterama-Regular","Posterama-Regular",
"normal","normal"));this.M9.add(new wv("Heron_Serif-Regular_WebTT","Heron_Serif-Regular_WebTT","normal","normal"));this.M9.add(new wv("Benton_Modern-Roman_WebTT","Benton_Modern-Roman_WebTT","normal","normal"));this.M9.add(new wv("ArialNova","ArialNova","normal","normal"));this.M9.add(new wv("TisaOffcSerifPro-Thin","TisaOffcSerifPro-Thin","normal","normal"));this.M9.add(new wv("QuireSans-Regular","QuireSans-Regular","normal","normal"));this.M9.add(new wv("RockwellNova","RockwellNova","normal","normal"));
this.M9.add(new wv("SabonNRegLT","SabonNRegLT","normal","normal"));this.M9.add(new wv("DaytonaThin","DaytonaThin","100","normal"))}wxn(){const b=document.createElement("style");b.setAttribute("type","text/css");let h="";for(const r of this.M9)h+=String.format(this.ZMk,r.fontFamily,r.TDo,r.fontWeight,r.fontStyle);b.innerText=h;this.aCd.appendChild(b)}nxn(){const b=document.createElement("style");b.setAttribute("type","text/css");const h=String.format(".{0} {{ background: url({1}) no-repeat; }}","swayPreviewFrameBackground",
Bk.a.ki("SwayPreviewFrame.svg")),r=String.format("@media screen and (-ms-high-contrast: active) {{ .{0} {{ background: url({1}) no-repeat; -ms-high-contrast-adjust: none; }}}}","swayPreviewFrameBackground",Bk.a.ki("SwayPreviewFrameHC.svg"));b.innerText=h+r;Y.a.Pr&&(b.innerText+=".AppRtl .swayGallery { margin-right: -15px; }");this.aCd.appendChild(b)}mzi(b){return b?b.keyCode:window.event.keyCode}hide(){this.Eqg();super.hide()}Eqg(){if(this.R5&&!this.$4e){for(let b=0;b<this.vpa.count;b++)mf.a.removeHandler(this.vpa.K(b),
Jd.a.click,this.Xfg),mf.a.removeHandler(this.vpa.K(b),Jd.a.hj,this.gnj);mf.a.removeHandler(this.R5,Jd.a.hj,this.pjj);mf.a.removeHandler(this.R5,Jd.a.focus,this.ojj);mf.a.removeHandler(this.D5,Jd.a.click,this.Heg);this.lbf||mf.a.removeHandler(this.R5,Jd.a.scroll,this.$dg);this.$4e=!0}}z4f(){const b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",Bk.a.pcl());this.aCd.appendChild(b);for(const h of this.Lm)this.Dsf(this.R5,h);this.c4(this.R5);
this.u_h(this.R5.firstChild);this.R5.firstChild.focus();mf.a.addHandler(this.R5,Jd.a.hj,this.pjj);mf.a.addHandler(this.R5,Jd.a.focus,this.ojj)}Dsf(b,h){const r=document.createElement("button");r.className="swayGalleryItem swayClip136x90 swayImageBorderButton";r.setAttribute(Ne.a.imb,Ne.a.FO);r.setAttribute("title",h.title);r.setAttribute(Ne.a.Ph,Ne.a.aTh);r.id=h.styleName;b.appendChild(r);b=document.createElement("img");b.className=String.format("swayPublish_Sway{0}StyleBlank_136x90x32",h.styleName);
b.src=Bk.a.ki("swayPublish.png");b.setAttribute(Ne.a.Ph,Ne.a.wA);b.setAttribute("unselectable","on");b.setAttribute(Ne.a.vA,Ne.a.fq);b.id=h.styleName+"img";r.appendChild(b);b=document.createElement("label");b.innerText=h.title;b.className=h.shp;b.setAttribute(Ne.a.vA,Ne.a.fq);b.setAttribute("unselectable","on");b.setAttribute(Ne.a.Ph,Ne.a.wA);r.appendChild(b);const A=document.createElement("label");A.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintHeadingText;A.className=h.eYm;A.setAttribute(Ne.a.vA,
Ne.a.fq);b.setAttribute("unselectable","on");A.setAttribute(Ne.a.Ph,Ne.a.wA);r.appendChild(A);mf.a.addHandler(r,Jd.a.click,this.Xfg);mf.a.addHandler(r,Jd.a.hj,this.gnj);this.vpa.add(r)}rVn(b){const h=this.zAa;this.U9l(b,h,!y.AFrameworkApplication.isRtl)||this.W9l(b,h,!y.AFrameworkApplication.isRtl)||this.R9l(b,h)||this.S9l(b,h)}JUm(b){return b===Sys.UI.Key.tab?(this.zAa&&this.zAa!==this.DSa&&(this.zAa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.RAd=this.DSa),!0):!1}U9l(b,
h,r){return b===Sys.UI.Key.right&&r||b===Sys.UI.Key.left&&!r?(b=(b=h.nextSibling)||this.R5.firstChild,this.m_b(b),!0):!1}W9l(b,h,r){return b===Sys.UI.Key.left&&r||b===Sys.UI.Key.right&&!r?(b=(b=h.previousSibling)||this.R5.lastChild,this.m_b(b),!0):!1}R9l(b,h){return b===Sys.UI.Key.down?(b=this.vpa.indexOf(h),h=b+2,h<this.vpa.count?(b=this.vpa.K(h))&&this.m_b(b):(h=b%2+1,h=2<=h?0:h,(b=this.vpa.K(h))&&this.m_b(b)),!0):!1}S9l(b,h){b===Sys.UI.Key.up&&(b=this.vpa.indexOf(h),h=b-2,0<=h?(b=this.vpa.K(h))&&
this.m_b(b):(h=b?20+b-1:this.vpa.count-1,(b=this.vpa.K(h))&&this.m_b(b)))}m_b(b){this.zAa&&this.zAa.id!==this.DSa.id&&(this.zAa.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.RAd=b;this.zAa.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonFocused");this.zAa.focus()}nbp(){this.d6a.className="WACDialogButtonNormal swayPrintToWebButton";this.d6a.setAttribute("tabindex","0");this.lB.className="WACDialogButtonNormal swayCancelButton";
this.lB.setAttribute("tabindex","0");this.d6a.disabled=!0}u_h(b){this.zAa&&(this.zAa.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.DSa&&(this.DSa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.DSa.setAttribute(Ne.a.imb,Ne.a.FO));this.E$b=b.id;this.DSa=b;this.DSa.setAttribute(Ne.a.imb,Ne.a.fq);this.RAd=b;this.zAa.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonSelected")}$9h(){Je.a.instance.Zb(new xc.a(2,
1,50,this.oMo))}ANj(b,h){b.innerHTML=h}qMo(){v.ULS.sendTraceTag(25231818,382,50,String.format("DigitalPrintDialog.SendPublishRequest Sending publish request for style {0}",this.E$b));y.AFrameworkApplication.va.Ob(ub.a.Cei,2);const b=String.format("{0}/we/SwayPublish.ashx?{1}&parentSessionId={2}&styleId={3}",df.a.webServiceBase,y.AFrameworkApplication.rootQuerySignature,y.AFrameworkApplication.userSessionId,this.E$b);Le.a.openWindow(4,b)}Hhe(b,h){vg.a.instance.qf(h,+b.MO-+b.bH)}A5o(){var b=WordEditorIntl.WordEditorStrings.L_DigitalPrintPreviewFailureMessage;
this.$mb();this.jac.innerText=b;this.jac.style.display="block"}z5o(){this.$mb();this.T8e.style.display="block";this.jac.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintGeneratingPreview;this.jac.style.display="block"}$mb(){this.B9e.style.background="";this.fNd.style.background="";Fd.a.DT(this.A9e);Fd.a.DT(this.fNd);this.jac.style.display="none";this.T8e.style.display="none"}static get cgi(){return null!=Nw.aUg?Nw.aUg:Nw.aUg=Za.a.instance.Oa(1097)}}Object(u.a)(Nw,"DigitalPrintDialog",ig.a,
[]);class VL{constructor(b,h){this._context=this.pl=null;this.GLe=0;this.$wd=!1;this.tEh=null;this.Bwf=(r,A,M,aa,oa)=>{if(1===M)return y.AFrameworkApplication.lH?8:32;this.tEh=oa.SourceControlId;if(y.AFrameworkApplication.J.$("IsAnonymousUser"))return v.ULS.sendTraceTag(34373826,382,50,"DigitalPrintActor.DigitalPrint: Anonymous user tried to click on Print to Web feature."),this.nxc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSignInNeeded),32;this._context=A;if(VL.Mjn())return v.ULS.sendTraceTag(34373828,
382,50,"DigitalPrintActor.DigitalPrint: MSA user clicked on Print to Web feature."),this.asf(),32;switch(this.GLe){case 1:v.ULS.sendTraceTag(34373829,382,50,"DigitalPrintActor.DigitalPrint: AAD user with Sway license clicked again on Print to Web feature.");this.asf();break;case 2:v.ULS.sendTraceTag(34373830,382,50,"DigitalPrintActor.DigitalPrint: AAD user without Sway license clicked again on Print to Web feature.");this.nxc(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense);break;case 0:this.$wd=
!1,this.pl=(new Mq.a).create(),this.pl.message=WordEditorIntl.WordEditorStrings.L_DigitalPrintCheckingSwayLicense,this.pl.dM(CommonUIStrings.l_DefaultDialogTitle,this.Dnl,null),y.AFrameworkApplication.Ee.Wj(String.format("{0}/we/CheckSwayLicense.ashx?{1}",df.a.webServiceBase,y.AFrameworkApplication.rootQuerySignature),2,null,null,!1,2,this.Fnl,this.Enl,null)}return 32};this.Dnl=()=>{this.$wd=!0;v.ULS.sendTraceTag(34373831,382,50,"DigitalPrintActor.CheckSwayLicenseCanceled: Canceling license check...")};
this.Fnl=r=>{if(!this.$wd){this.pl.close();var A=null;this.Hhe(r.data,Jh.a.Fcp);({group:A}=tk.a.z4(r.data.De)).returnValue?(r=A.Responses[0],v.ULS.sendTraceTag(34373832,382,50,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization succeeded. HasLicense: {0}, Succeeded: {1}",r.HasLicense,r.Succeeded),r.Succeeded?(this.GLe=r.HasLicense?1:2,2===this.GLe?this.nxc(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense):this.asf()):this.nxc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown)):
(v.ULS.sendTraceTag(34373833,382,10,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization failed"),this.nxc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))}};this.Enl=r=>{this.$wd||(this.pl.close(),v.ULS.sendTraceTag(34373834,382,15,"DigitalPrintActor.CheckSwayLicenseFailCallback: CheckSwayLicense request failed!"),this.Hhe(r.data,Jh.a.Ecp),this.nxc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))};this.ga=b;this.B9=h}Xb(){y.AFrameworkApplication.z0?
v.ULS.sendTraceTag(26093080,382,50,"Disabling Digital Print button because document has protection."):y.AFrameworkApplication.J.$("DisablePrintBasedOnPolicy")&&y.AFrameworkApplication.J.$("DisablePrint")?v.ULS.sendTraceTag(26093081,382,50,"Disabling Digital Print button because print is disabled."):(this.ga.fb(ub.a.wYc,lc.a.view,this.Bwf,4),this.ga.fb(ub.a.Bei,lc.a.view,ce.ActionManager.aU,4),this.ga.fb(ub.a.Cei,lc.a.view,ce.ActionManager.aU,4),this.ga.fb(ub.a.Aei,lc.a.view,ce.ActionManager.aU,4),
this.ga.fb(Ka.a.GZd,lc.a.view,ce.ActionManager.aU,4))}asf(){v.ULS.sendTraceTag(36824994,382,50,"DigitalPrintActor.CreateDigitalPrintDialog: Opening the DigitalPrintDialog. Button {0} clicked.",this.tEh);new Nw(this._context,this.ga,y.AFrameworkApplication.J.ib("SwayFontDownloadUrlTemplate"),y.AFrameworkApplication.J.ib("FileSource"))}nxc(b){const h=new ni.StandardDialog;h.Fd=0;h.yna(CommonUIStrings.l_DefaultDialogTitle,b,null)}Hhe(b,h){vg.a.instance.qf(h,+b.MO-+b.bH)}static Mjn(){return"OneDriveWOPI"===
y.AFrameworkApplication.J.ib("FileSource")}}Object(u.a)(VL,"DigitalPrintActor",null,[]);class EF{constructor(){this.yHh=null}G9i(){v.ULS.sendTraceTag(25007841,375,50,"Do not check for this critique type triggered")}J2j(b){if(!b)return v.ULS.sendTraceTag(25007842,375,15,"Error range is null"),!1;if(!this.v2i(b.errorDetails))return!1;this.yHh=Object(ya.a)(pq.a,b.errorDetails).typeId;return!0}ood(b){return this.v2i(b)?Object(ya.a)(pq.a,b).typeId===this.yHh:!1}v2i(b){if(!b)return v.ULS.sendTraceTag(25007843,
375,15,"No ErrorDetails found"),!1;b=Object(ya.a)(pq.a,b);return b?b.token&&b.typeId?!0:(v.ULS.sendTraceTag(25007873,375,50,"Token is null: {0}",!b.token),!1):(v.ULS.sendTraceTag(25007872,375,50,"ErrorDetails is null"),!1)}}Object(u.a)(EF,"DoNotCheckThisCritiqueTypeStrategy",null,[495]);class gN extends ig.a{constructor(b,h,r){super(!1,!1,!0);this.Rb=b;this.dsa=r;this.Mrk="DocumentChoiceGroup";this.Weh="EmbededContent";this.zkh="HyperLink";this.LYe=r.bhb;b={["id"]:"ExternalContentDefaultSettingsDialog",
["bodyControls"]:this.q1c()};this.ink=this.q2l.bind(this);this.Qe(1,WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogSave);this.mi(WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogTitle,this.ink,b)}q1c(){const b=Array(2);b[0]={["key"]:this.Weh,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryContent};b[1]={["key"]:this.zkh,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryHyperLink};const h={};h.documentChoiceGroupProps=
{["id"]:this.Mrk,["defaultSelectedKey"]:this.LYe?this.Weh:this.zkh,["label"]:WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogDescription,["options"]:b};h.learnMoreLinkText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMore;h.learnMoreURL=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMoreUrl;h.externalContentDefaultSettingsDialogInformationText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogInformation;
return h}q2l(b,h){1===b?(this.LYe!==h.isExternalContentSelected&&(b=h.isExternalContentSelected?Fc.a.aVa:Fc.a.hpb,this.Rb.Ob(b,2),this.LYe=h.isExternalContentSelected,ca.a.sendTelemetryEvent(Object.assign(new la.a,{name:"Office.Word.Online.ExternalContent.ExternalContentDefaultSettings",dataFields:[Object.assign(new ia.a,{name:"ActionId",int64:b})]}))),this.dsa.LHo(h.isExternalContentSelected)):0===b&&v.ULS.sendTraceTag(556565635,324,50,"Cancel Clicked in ExternalContentDefaultSettingsDialog")}}Object(u.a)(gN,
"ExternalContentDefaultSettingsDialog",ig.a,[]);class Tr{constructor(b,h,r,A,M){this.bO=Za.a.instance.resolve(728);this.zBb=Vg.a.On;this.jxc=()=>{const aa=Array(1);aa.push("ExternalContent");var oa=Za.a.instance.resolve(1098).FVa();oa=Object.assign(new ur.a,{x:oa.x,y:oa.y});this.bO.showFloatie(oa,aa,1);return 32};this.dRb=()=>{this.bO.f3&&this.bO.dismissFloatie();return 32};this.ovj=(aa,oa,Ja,fb,Cb)=>{if(oa="object"===typeof Cb?Cb:null)aa===Fc.a.ing?(aa=Tr.V2a!==Fc.a.aVa&&Tr.V2a!==Fc.a.hpb,oa[this.zBb]=
Tr.V2a===Fc.a.aVa||aa):aa===Fc.a.jng&&(oa[this.zBb]=Tr.V2a===Fc.a.hpb);return 32};this.Uki=(aa,oa,Ja)=>{1!==Ja&&(aa===Fc.a.hpb&&Tr.V2a!==Fc.a.hpb?(v.ULS.sendTraceTag(575813832,324,50,"ExternalContentPasteHyperlinkOption clicked"),this.An.undo()&&(oa=new Wt.a(1,y.AFrameworkApplication.isRtl),oa.ggd="ExternalContent",Tr.gpb.Hid(oa))):aa===Fc.a.aVa&&Tr.V2a!==Fc.a.aVa&&(v.ULS.sendTraceTag(575813833,324,50,"ExternalContentPasteEmbededWebContentOption clicked"),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1),this.Pfh.Nwj()),Tr.V2a=aa);ca.a.sendTelemetryEvent(Object.assign(new la.a,{name:"Office.Word.Online.ExternalContent.Floatie",dataFields:[Object.assign(new ia.a,{name:"behavior",string:Ja.toString()}),Object.assign(new ia.a,{name:"ActionId",int64:aa})]}));return 32};this.ga=b;this.An=h;this.Pfh=A;this.fyk=M;this.hnk=this.r2l.bind(this);y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1);this.Pfh.Hyj(()=>{this.reset()})}Xb(){this.ga.fb(Fc.a.ing,
lc.a.view,this.ovj,97);this.ga.fb(Fc.a.jng,lc.a.view,this.ovj,97);this.ga.fb(Fc.a.Tki,lc.a.view,this.hnk,1028);this.ga.fb(Fc.a.aVa,lc.a.view,this.Uki,1028);this.ga.fb(Fc.a.hpb,lc.a.view,this.Uki,1028);this.fyk||(this.ga.fb(Fc.a.jxc,lc.a.view,this.jxc,96),this.ga.fb(Fc.a.dRb,lc.a.view,this.dRb,96))}M3o(b){new gN(this.ga,b,Tr.dsa)}r2l(b,h,r){1!==r&&this.M3o(Tr.V2a);return 32}static get gpb(){return null!=Tr.wUg?Tr.wUg:Tr.wUg=Za.a.instance.resolve(211)}static get dsa(){Tr.TFa||(Tr.TFa=Za.a.instance.resolve(1018));
return Tr.TFa}reset(){Tr.V2a=null!=Tr.dsa?Tr.dsa.bhb?Fc.a.aVa:Fc.a.hpb:Fc.a.aVa}}Tr.V2a=Fc.a.aVa;Tr.TFa=null;Object(u.a)(Tr,"ExternalContentActor",null,[]);class KD extends nw{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc){super(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb);this.G7c=pc;this.Z0d=!1;this.Zlh=null}ijd(){this.Z0d||(super.ijd(),this.Z0d=!0)}DDe(){this.Z0d&&(super.DDe(),KD.ehi&&this.Zlh&&KD.ehi.removeHandler(ZJ.a.LHa,this.Zlh),this.Z0d=!1)}W1b(){if(this.G7c){this.Cza.f3&&this.Cza.dismissFloatie();const b=
new Wt.a(0,y.AFrameworkApplication.isRtl);b.location=this.rcb.FVa();this.showFloatie(null,b)}else this.Cza.f3&&y.AFrameworkApplication.va.Ob(Fc.a.dRb,2),y.AFrameworkApplication.va.Ob(Fc.a.jxc,2);this.Noc=!1}dismissFloatie(b){!this.yWe&&(b&&(this.rcb.vVf(),this.K3j()),this.Cza.f3||this.rRa)&&(this.rRa=!b,this.DDe(),this.G7c?this.Cza.dismissFloatie():y.AFrameworkApplication.va.Ob(Fc.a.dRb,2))}showFloatie(b,h){h||(h=new Wt.a(0,y.AFrameworkApplication.isRtl));h.location||(h.location=this.rcb.FVa());if(!h.location)return!1;
this.rRa&&(this.rRa=!1,this.ijd());this.G7c?(b=Array(1),b.push("ExternalContent"),this.Cza.showFloatie(this.rcb.FVa(),b,1)):y.AFrameworkApplication.va.Ob(Fc.a.jxc,2);return!0}JXc(){if(!this.Noc){const b=new xc.a(3,1,this.kbi,()=>{this.W1b()},196);Je.a.instance.Zb(b);this.Noc=!0}}bna(){this.G7c?this.Cza.f3&&this.Cza.dismissFloatie():y.AFrameworkApplication.va.Ob(Fc.a.dRb,2);this.JXc()}PZb(){this.G7c?this.Cza.f3&&this.Cza.dismissFloatie():y.AFrameworkApplication.va.Ob(Fc.a.dRb,2);this.JXc()}static get ehi(){return null!=
KD.gUg?KD.gUg:KD.gUg=Za.a.instance.resolve(223)}}Object(u.a)(KD,"ExternalContentFloatieEventManager",nw,[]);class LD extends Jv{constructor(b,h,r,A,M){super(b,h,r,A,M)}iYh(){if(!this.hb||!this.hb.gb||!this.hb.gb.currentSelection)return v.ULS.sendTraceTag(575813836,307,15,"Selection is null when we try to calculate external content floatie position"),null;var b=this.hb.gb.currentSelection.Qa,h=!b.cpBegin&&!b.cpEnd;let r=b.node;if(r&&h&&!r.CL){do r=this.sDi(r);while(r&&!r.CL&&Object(Xa.a)(Gn.AParagraphNode,
r)&&!r.characterData.trim().length)}let A="";const M=Object(ya.a)(Gn.AParagraphNode,r);M&&(A=M.characterData.length===b.cpBegin||h?M.characterData.trimEnd():M.characterData.substring(0,b.cpBegin).trimEnd());h=M?A.length:b.cpBegin;b=Object.assign(new nG,{aDa:Object(ya.a)(112,(M?Object(ya.a)(112,M):Object(ya.a)(112,r))||b.node),btc:h});return this.MIf(b)}fyi(b,h){let r=null;const A=Object(ya.a)(140,b.aDa.sl(h.pc));if(!A)return null;if(Object(Xa.a)(Gn.AParagraphNode,b.aDa)){const M=Object(ya.a)(Gn.AParagraphNode,
b.aDa);if(M.PT){if(b=Object(ya.a)(aG.a,Gd.ParagraphReader.kKa(M)))(b=Object(ya.a)(140,b.sl(h.pc)))&&(r=b.getBounds()),r&&(r.height+=LD.$ni,r.width-=LD.k9l);return r}h=Object(ya.a)(105,A);if(!h)return null;try{if(r=this.rya.h2(b.btc,h,0<b.btc,!1,!1,!1))r.height+=LD.$ni}catch(aa){v.ULS.sendTraceTag(575813837,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",aa),r=null}}r||(r=A.getBounds());return r}}LD.$ni=65;LD.k9l=100;Object(u.a)(LD,"ExternalContentFloatiePositionProvider",
Jv,[]);class IK{constructor(b,h,r,A,M,aa){this.Qte=(oa,Ja,fb)=>{if(1===fb)return y.AFrameworkApplication.z0||y.AFrameworkApplication.lH||y.AFrameworkApplication.nta||ec.SessionStatusManager.instance.Hk?8:32;if(oa===ub.a.print)oa=1;else if(oa===Fc.a.YYc)oa=0;else if(oa===Fc.a.Xxf)oa=3;else if(oa===Fc.a.u_d)oa=2;else return 8;return this.vHo(oa)};this.ga=b;this.B9=h;this.A6b=r;this.vrk=A;this.Idh=M;this.xnk=aa}Xb(){var b;y.AFrameworkApplication.J.$("DisablePrintBasedOnPolicy")&&this.vrk||y.AFrameworkApplication.lH?
(document.body.classList.add("WACStopPrinting"),""!==this.Idh&&this.xnk.n4o(this.Idh)):(this.ga.qa(ub.a.print,lc.a.application,this.Qte),this.ga.qa(Fc.a.YYc,lc.a.application,this.Qte),(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadPDFWithoutCommentsIsEnabled",!1))&&this.ga.qa(Fc.a.Xxf,lc.a.application,this.Qte),this.ga.qa(Fc.a.u_d,lc.a.application,this.Qte))}vHo(b){const h=y.AFrameworkApplication.rootQuerySignature;if(!h||""===h||Of.a.ud()&&
Of.a.ud().iC.Do)return 8;this.A6b.kce=!1;this.A6b.w$j.start();hv.a.fU(cC.a.Dyl,!0,Object(E.a)(this.A6b,this.A6b.HBo,"requestFileDownload"),Object(E.a)(this.A6b,this.A6b.hWb,"onForceSaveFailed"),b);return 32}}Object(u.a)(IK,"FileDownloadActor",null,[]);class hN extends nd{constructor(b,h=null,r=null){super(b,!0,h,!1,void 0,r)}get HSf(){return null}get sbb(){return this.Ice?CommonUIStrings.l_DownloadAsPdfDialog_CopyALinkText_EditPermissions:y.AFrameworkApplication.w7a?CommonUIStrings.l_DownLoadACopyDialogMessage:
CommonUIStrings.l_PrintDialogDocumentIsPrinting}get Rpc(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get dRd(){return null}get Ice(){return"VersionHistory"===this.GYh?!1:y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadAsPdfCopyLinkEnabled",!1)}vhe(){v.ULS.sendTraceTag(508875466,324,50,"Download as PDF dialog displayed");y.AFrameworkApplication.cga("tcopypdf;ccopypdf")}}Object(u.a)(hN,"DownloadAsPdfDialog",
nd,[]);class ou{constructor(){this._url=this.uw=null;this.q4a=this.p4a=0;this.qlb=!1;this.ULa=()=>{y.AFrameworkApplication.Ee.Wj(this._url,1,null,null,!0,2,this.Ybb,this.UU,null)};this.Ybb=b=>{ou.Jkd();const h=b.data.cna;let r=null;if(h)try{r=h.selectSingleNode("/docdata/status")}catch(A){}r&&("InProgress"===r.text&&22>this.p4a++||"ServiceBusy"===r.text&&3>this.q4a++)?this.wNa(1E3*(this.p4a+this.q4a)):this.uw(!0,r?r.text:null,b.data)};this.UU=b=>{this.qlb?(ou.TGa||(ou.$ib=new Date,ou.TGa=!0,ou.hW=
1),18E4>(new Date).getTime()-ou.$ib.getTime()?this.gxb(4<=ou.hW?2E4:1E3):this.K9a(b.data)):4>ou.hW?this.gxb(2E3):this.K9a(b.data)}}send(b,h,r){this._url=b;this.uw=h;this.qlb=r;this.ULa(null)}wNa(b){b=new xc.a(2,1,b,this.ULa);y.AFrameworkApplication.oc.Zb(b)}gxb(b){this.wNa(b);ou.hW++}K9a(b){this.uw(!1,null,b)}static saa(b,h){(new ou).send(b,h,!1)}static Jkd(){ou.TGa=!1;ou.hW=0}}ou.$ib=null;ou.TGa=!1;ou.hW=0;Object(u.a)(ou,"ClientRequestWithRetry",null,[]);class FF extends Dc{constructor(b){super(b,
void 0,y.AFrameworkApplication.w7a)}get sbb(){return FF.Bkn?WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogOdtReady.replace("{0}",""):WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogOdtReady}static get Bkn(){if(null!=FF.KZg)var b=FF.KZg;else{var h;y.AFrameworkApplication.vd("32d51153;h1018576");b=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.OdtDialogDownloadLinkRemovalEnabled",!1);b=FF.KZg=b}return b}get Rpc(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLinkSuggestion}get Rad(){return"DownloadOdtLink"}get buttonText(){return CommonUIStrings.l_Download}get qXc(){return y.AFrameworkApplication.w7a?
"UIFontDialogTextLarge":null}vhe(){v.ULS.sendTraceTag(7628378,324,50,"ODT download dialog displayed")}d5f(){v.ULS.sendTraceTag(7628379,324,50,"ODT download dialog link clicked")}obd(){v.ULS.sendTraceTag(19462216,324,50,"ODT download dialog button clicked")}get zad(){return Ur.Kgj}get Wtb(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLearnMoreLinkText}get tcj(){return!y.AFrameworkApplication.w7a}}Object(u.a)(FF,"DownloadAsOdtDialog",Dc,[]);class iN{constructor(b,h){this.Xhb=this.n5a=
null;this.Pgi="downloadpdf";this.PVl="downloadpdfwithoutcomments";this.Ctj="printpdf";this.Jgj="odt";this.jeb=r=>{1===qa.StaticActiveAppFrame.za().state||this.n5a||(this.n5a=(new Mq.a).create(),r=r.Yl,this.czn(r),1===r?this.n5a.message=this.FCb.$T.isEnabled?y.AFrameworkApplication.w7a?CommonUIStrings.l_DirectPrintPreparingPDF:WordEditorIntl.WordEditorStrings.L_DirectPrintWait:WordEditorIntl.WordEditorStrings.l_PrintPDFWait:0===r||3===r?this.n5a.message=WordEditorIntl.WordEditorStrings.l_PrintPDFWait:
2===r&&(this.n5a.message=WordEditorIntl.WordEditorStrings.l_ConversionToODTWait),this.n5a.dM(CommonUIStrings.l_DefaultDialogTitle,this.cancelButton,null))};this.cancelButton=()=>{this.kce=!0};this.Eba=(r,A,M)=>{this.CEg("Success. Save and Conversion Complete.");M=new Ra.QueryStringBuilder(M.request.get_url());y.AFrameworkApplication.rja(M);M=M.toString();const aa=this.ZBo(M);this.Ora(aa);2!==aa&&this.FCb.jdo();if(!r||A)this.A8(aa);else if(this.kce)this.kce=!1,this.Xhb=null;else{this.Xhb&&y.AFrameworkApplication.oc.uf(this.Xhb);
this.Xhb=null;if(0===aa||3===aa){A=new ia.a;A.name="IsLabeled";const oa=y.AFrameworkApplication.J.ib("AppliedPolicyId");A.bool=!!(oa&&0<oa.length);ac.a("PdfProtectionUsage",r,void 0,[A])}this.dTl(M,aa)}};this.kce=!1;this.FCb=b;this.w$j=h.bYa("UserAction","WordEditorForceSaveAndPrint")}Ora(b){this.n5a&&(this.mzn(b),this.n5a.close(),this.n5a=null)}A8(b){if(1!==qa.StaticActiveAppFrame.za().state){this.gAn(b);const h=new ni.StandardDialog;h.Fd=0;h.Qe(1,CommonUIStrings.l_DialogClose);h.zy(0,"",1===b?WordEditorIntl.WordEditorStrings.l_PrintError:
WordEditorIntl.WordEditorStrings.l_ConversionError,null,!0)}}iMf(b){switch(b){case 0:return this.TVi?this.PVl:this.Pgi;case 3:return this.Pgi;case 1:return this.Ctj;case 2:return this.Jgj;default:return v.ULS.sendTraceTag(7628383,324,10,"Unknown request PDF type {0}",b),this.Ctj}}HBo(b){var h=y.AFrameworkApplication.rootQuerySignature;h&&""!==h?(h="WordViewer/request."+this.oBf(b)+"?"+h+"&type="+this.iMf(b)+"&rndm="+kb.a.create(),1===b&&this.FCb.E2o()&&(h+="&useNamedAction=1"),y.AFrameworkApplication.J&&
y.AFrameworkApplication.J.$("CustomFontReadModePDFIsEnabled")&&gq.FontUtils.Qxe()&&(1===b||!b)&&(0<gq.FontUtils.Tai&&(h+="&cfcVer="+gq.FontUtils.Tai),gq.FontUtils.Sai&&(h+="&cfcUrl="+encodeURI(gq.FontUtils.Sai)),gq.FontUtils.Uai&&(h+="&cfcEncData="+encodeURIComponent(gq.FontUtils.Uai)),gq.FontUtils.Rai&&(h+="&cfcBaseUrl="+encodeURI(gq.FontUtils.Rai))),ou.saa(h,this.Eba),this.Xhb||(this.Xhb=new xc.a(2,1,500,this.jeb),this.Xhb.Yl=b,y.AFrameworkApplication.oc.Zb(this.Xhb))):(this.CEg("failed. QuerySignature is empty."),
this.A8(b))}oBf(b){return 2===b?"odt":"pdf"}hWb(){this.CEg("Failed. force save failed.")}ZBo(b){if(0<b.indexOf("&type=downloadpdf")&&this.TVi)return 0<b.indexOf("&type=downloadpdfwithoutcomments")?0:3;if(0<b.indexOf("&type=downloadpdf"))return 0;if(0<b.indexOf("&type=printpdf"))return 1;if(0<b.indexOf("&type=odt"))return 2;v.ULS.sendTraceTag(7628384,324,10,"Could not get requestType from uri:{0}",b);return 1}CEg(b){v.ULS.sendTraceTag(7628385,328,50,"stopping the perf counter for forcesave and print. [StoppingReason:{0}]",
b);this.w$j.stop()}dTl(b,h){const r=new ib.a;r.add("access_token");r.add("access_token_ttl");1!==qa.StaticActiveAppFrame.za().state&&(1===h?this.FCb.b5o(b,r):0===h||3===h?new hN(b):2===h&&new FF(b))}dispose(){}czn(b){switch(b){case 0:v.ULS.sendTraceTag(38114782,203,50,"Download Attempt: Pdf");break;case 3:v.ULS.sendTraceTag(0,203,50,"Download Attempt: Pdf with Comments");break;case 2:v.ULS.sendTraceTag(38114783,203,50,"Download Attempt: Odt");break;case 1:v.ULS.sendTraceTag(38114784,203,50,"Download Attempt: PrintPdf");
break;default:v.ULS.sendTraceTag(38114785,203,15,"Download Attempt: {0}",b)}}mzn(b){switch(b){case 0:v.ULS.sendTraceTag(38114786,203,50,"Download Cancelled: Pdf");break;case 3:v.ULS.sendTraceTag(0,203,50,"Download Cancelled: Pdf with Comments");break;case 2:v.ULS.sendTraceTag(38114787,203,50,"Download Cancelled: Odt");break;case 1:v.ULS.sendTraceTag(38114816,203,50,"Download Cancelled: PrintPdf");break;default:v.ULS.sendTraceTag(38114817,203,15,"Download Cancelled: {0}",b)}}gAn(b){switch(b){case 0:v.ULS.sendTraceTag(38114818,
203,15,"Download Failed: Pdf");break;case 3:v.ULS.sendTraceTag(0,203,15,"Download Failed: Pdf with Comments");break;case 2:v.ULS.sendTraceTag(38114819,203,15,"Download Failed: Odt");break;case 1:v.ULS.sendTraceTag(38114820,203,15,"Download Failed: PrintPdf");break;default:v.ULS.sendTraceTag(38114821,203,15,"Download Failed: {0}",b)}}get TVi(){if(null!=this.qZg)var b=this.qZg;else{var h;y.AFrameworkApplication.vd("b62ed219;f72gc351");b=this.qZg=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:
h.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadPDFWithoutCommentsIsEnabled",!1)}return b}}Object(u.a)(iN,"FileDownloadManager",null,[]);class MD{get key(){return"LIST"}get Cv(){return Box4Intl.Box4Strings.l_ListContentTitle}K1b(b){let h=null;const r=MD.Md.Pw(b);if(!r)return{returnValue:!1,Eea:h};b=this.Lvm(b,r);h=Object.assign(new qC.a,{NF:this.key,contentId:b.listId,contentObject:b});return{returnValue:!0,Eea:h}}oqb(b,h){b=b.contentObject;const r=this.wum(b.Zy),A=new fc.a;h?(h=h.contentObject,
h.level!==b.level?(A.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,b.level)),A.add(r)):h.id.equals(b.id)&&h.Zy.listType===b.Zy.listType||A.add(r)):(A.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),A.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,b.level)),A.add(r));return A.toArray().join(" ")}wum(b){let h="";const r=b.listStyle;if(!b.listType)h=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,b.Bx);else if(1===b.listType)switch(r){case 1:h=
this.TWh;break;case 2:h=this.Hfl;break;case 3:h=this.Ifl;break;default:h=this.TWh}return h}static get Md(){return null!=MD.K_g?MD.K_g:MD.K_g=Za.a.instance.resolve(10)}}Object(u.a)(MD,"ListDetailsProvider",null,[719,257]);class jN{constructor(){this.Zy=this.listId=this.id=null;this.level=0}}Object(u.a)(jN,"ListItemInfo",null,[]);class eC extends MD{constructor(b){super();this.J9=b}get TWh(){return WoncaIntl.WoncaStrings.L_BulletStyle1}get Hfl(){return WoncaIntl.WoncaStrings.L_BulletStyle2}get Ifl(){return WoncaIntl.WoncaStrings.L_BulletStyle3}Lvm(b,
h){const r=this.J9.jE(b);return Object.assign(new jN,{id:b.currentNode.id,listId:new N.a(kb.a.nil,r.listID),Zy:h,level:r.level+1})}}Object(u.a)(eC,"FlatListDetailsProvider",MD,[]);class kN{constructor(b,h){this.ga=b;this.jg=h}get Wb(){return null!=this.V5g?this.V5g:this.V5g=Za.a.instance.Oa(8)}Xb(){}}Object(u.a)(kN,"FormattingActor",null,[]);var uO=d(1111),dw=d(309),lN=d(1700);class mN{constructor(b,h,r,A,M,aa,oa,Ja){this.Db=b;this.vKk=h;this.Qc=r;this.MDb=A;this.$p=M;this.Ga=aa;this.Bd=oa;this.hzk=
Ja}csc(b,h,r,A,M,aa,oa){v.ULS.sendTraceTag(574358090,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:oa.Ei});this.MDb.then(()=>{this.vKk(b.data.De);v.ULS.sendTraceTag(574358091,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper load success: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:oa.Ei});oa.stop()})}UU(b,h,r,A,M,aa,oa){aa.stop();M();oa?(this.v8n(h,r),v.ULS.sendTraceTag(574377989,3001,15,"{0}",{["message"]:b,
["id"]:Uc.ImageReader.b9a(h.Db)})):v.ULS.sendTraceTag(574377990,3001,15,"{0}",{["message"]:b,["id"]:Uc.ImageReader.b9a(h.Db)})}QQh(b,h){b.ye(DK.a.erf,tI.jVl.toString());if(this.Bd&&this.Bd.isFeatureEnabled(43)){var r=this.$p.Kn(h.Ik);r=this.$p.Fk(r);b.ye(Pi.a.ft,dw.a[r]);5===r&&this.J4k(b,h)}this.hzk&&b.ye(Pi.a.hae,"true")}BKh(){return new lN.a(this.Db.id,this.Db)}P7d(){return WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError}v8n(b,h){const r=this.Qc.Nc(7,ub.a.SQm);r.Bb(h);b.Db.setValue(Mc.a.j5h,
!0);r.dispose()}J4k(b,h){var r=h.Ik;h=this.$p.Kn(r);var A=r.node;const M=(r=this.$p.sKa(h,A.Ic,!1))?this.$p.mKa(r):"";if(""===M)throw v.ULS.sendTraceTag(572555911,3001,10,"Could not find original dataBlobId on picture node."),Error.argumentNull("OriginalObjectDataBlobId");A=(A=this.$p.sKa(h,A.Ic,!0))?this.$p.mKa(A):"";b.ye(Pi.a.ysc,M);b.ye(Pi.a.A$j,A);r=r.ka(wb.a.bmi,"");""!==r&&b.ye(Pi.a.extension,r);b.ye(Pi.a.width,this.$p.RB(h).toString());b.ye(Pi.a.height,this.$p.$C(h).toString());b.ye(Pi.a.xgd,
this.$p.Oqb(h).toString());r=this.Ga.$("WordEditorImageCropIsEnabled");b.ye(Pi.a.fai,r.toString());r&&(r=this.$p.ifa(h),b.ye(Pi.a.top,r.top.toString()),b.ye(Pi.a.bottom,r.bottom.toString()),b.ye(Pi.a.left,r.left.toString()),b.ye(Pi.a.right,r.right.toString()));r=this.Ga.$("WordEditorImageRotateIsEnabled");b.ye(Pi.a.GGj,r.toString());r&&(b.ye(Pi.a.angle,this.$p.L2(h).toString()),h=this.$p.vsa(h),b.ye(Pi.a.flipH,h.Apb?"true":"false"),b.ye(Pi.a.flipV,h.OJa?"true":"false"));b.ye(Pi.a.Jhi,"true")}}Object(u.a)(mN,
"GraphicsEditorDocumentXmlToJsonRequestHelper",null,[501]);class nN{constructor(){this.UQa=null}wal(b){this.UQa=b}teardown(){null!=this.UQa&&(this.UQa.teardown(),this.UQa=null);this.U3e=null}getGraphicData(){return this.UQa?this.UQa.getGraphicData():null}auo(){null!=this.U3e&&this.setGraphicData(this.U3e)}setGraphicData(b){this.U3e=b;if(this.UQa)try{this.UQa.setGraphicData(b)}catch(h){v.ULS.sendTraceTag(575522530,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: Exception {0} thrown from GraphicHost.",
h.toString())}else v.ULS.sendTraceTag(575522529,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: GraphicHost is null.")}hasEdits(){return this.UQa?this.UQa.hasEdits():!1}}Object(u.a)(nN,"GraphicsEditorGC2HostUser",null,[503]);var vO=d(1701),Lk=d(1055),ND=d(1236),GF=d(787),HF=d(1327),IF=d(1054);class BI{constructor(b){this.preloadScript=this.loadScript=null;this.loadScript=h=>b.loadScript(h);this.preloadScript=h=>{b.preloadScript(h)}}}Object(u.a)(BI,"GC2ScriptLoader",null,[]);class fC{constructor(b,
h,r){this.fMe=b;this._context=h;this.sSa=r}closeEditor(){this.fMe&&(this.fMe(),this.fMe=null)}logActivity(b,h,r,A){ac.a(b,h,r,A)}logTrace(b,h,r,A){v.ULS.sendTraceTag(575522531,3001,fC.CDn(h),A)}isEnabled(b){const h=y.AFrameworkApplication.J;switch(b){case "EqualSizingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSizingGuide",!1);case "EqualSpacingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSpacingGuide",!1);case "AdjustHandles":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsAdjustHandles",
!1);case "SpaceFirstLastPara":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextSpaceFirstLastPara",!1);case "ModernFontPicker":return h.$("ModernFontPickerIsEnabled");default:return h.getBooleanFeatureGate(`Microsoft.Office.WordOnline.GC2.${b}`,!1)}}getFontPickerFonts(b){const h=`${Za.a.instance.resolve(402).p8a}/${"hier_officeFontsPreview.ttf"}`;b("msofp_hier",h);b=gq.FontUtils.TEf(()=>!1,()=>"",!0);return{commandId:"FontPicker",fonts:b.fonts.filter(r=>"premium"!==r.fontType),mruList:b.mruList,
previewFontFamily:"msofp_hier_MSFontService"}}getHealth(){return Ba.Health.instance}getFonts(b){const h=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernFontPicker",!1),r=h?"msofp_hier":"msofp",A=`${Za.a.instance.resolve(402).p8a}/${h?"hier_officeFontsPreview.ttf":"flat_officeFontsPreview.ttf"}`;b(r,A);gq.FontUtils.iLh();gq.FontUtils.JLh({});b=gq.FontUtils.SEf(()=>!1,(M,aa)=>aa).MenuSectionList;h&&0<b.length&&(b.pop(),b.push(this.Awl()));return b}Awl(){const b=gq.FontUtils.TEf(()=>
!1,()=>"").fonts.map((h,r)=>{const A=h.name;h=h.displayName;const M=gq.FontUtils.Ata(A);return Object.assign(new sD.a,{MenuItemId:gq.FontUtils.HIj+r,CommandValueId:A,LabelText:h||A,Styles:{["optionText"]:{["fontFamily"]:h&&!M?"msofp_hier_MSFontService":"'Segoe UI',Tahoma,Sans-Serif;"}},AriaLabel:A})});return Object.assign(new te.a,{Title:CommonUIStrings.l_FontDropdownMenuSectionAll,Id:"AllFontsDropdown",ControlList:b})}getPictureDataFromId(b){const h=this._context.Ik;var r=Uc.ImageReader.Kn(h);if(this.Ehn(r,
h,b)&&(r=Uc.ImageReader.a9(r,pd.a.Y7,""),r.length))return Promise.resolve(r);r=new Ra.QueryStringBuilder("/we/GetImage.ashx?");r.EJb(h.node.Jj().yq);r.ye(Pi.a.JYd,b);y.AFrameworkApplication.rja(r);r.ye(Uj.a.tAb,"1");tm.a.instance.KJb(r);r.ye(Pi.a.gbi,"true");const A=r.toString();return new Promise((M,aa)=>{this.sSa.Wj(A,1,null,null,!1,2,oa=>{M(oa.data.De)},oa=>{aa(oa.data.Ie.toString())},null)})}getPlaceholders(){const b={};b.PictureDownloading=Bk.a.ki("progress.gif");b.PictureInvalid=Bk.a.ki("CancelRequest.32x32x32.png");
return b}getTheme(){const b=Object(vo.a)().Iu(this._context.view.od).properties.ka(Mc.a.MBe,"");return 0===b.length?[]:b.split(" ").map(h=>df.a.VTa[h])}static CDn(b){switch(b){case 0:return 10;case 1:return 15;case 2:return 50;case 3:return 100;case 4:return 200;default:return 50}}Ehn(b,h,r){const A=h.node.Ic;h=Uc.ImageReader.T6d(b,A,!1);b=Uc.ImageReader.T6d(b,A,!0);return r===h||r===b}}Object(u.a)(fC,"GraphicsEditorApp",null,[508]);class JF extends ig.a{constructor(b,h,r,A,M){super(!1,!1,!0);this.closeEditor=
()=>{this.S5h();this.dispose()};this.Lra=aa=>{this.S5h(2===aa)};this.nib=b;this.Qvk=h;this.Skh=r;this._context=A;this.sSa=M}e4o(b){return new Promise((h,r)=>{this.mi(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle,this.Lra,{["id"]:"GraphicsEditorDialog",["bootstrap"]:(A,M)=>this.tKb(A,M,b),["onload"]:A=>{this.onLoad(A,h,r)},["editorDiscardText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogDiscardChanges,["editorSaveText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogSave,
["onReload"]:()=>{this.nib.auo()},["iFrameTitle"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle})})}onLoad(b,h,r){b?(this.nib.wal(b),h(b)):(v.ULS.sendTraceTag(573100169,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Null host"),r(null))}tKb(b,h,r){b=y.AFrameworkApplication.J;const A=IF.a();A.loadScriptWithRetryHandler=h;const M=new fC(this.closeEditor,this._context,this.sSa),aa={["bootConfig"]:Object.assign(new ND.a,{scriptBaseUrl:$B.AppChromeOverrideUtilities.isEnabled?$B.AppChromeOverrideUtilities.G6d(y.AFrameworkApplication.lcid):
y.AFrameworkApplication.I8+y.AFrameworkApplication.lcid+"/",isMLRRibbonMode:y.AFrameworkApplication.ua.Ib.Xwc,isCombinedBundleEnabled:y.AFrameworkApplication.J.$("IsCombinedBundleEnabled")}),["scriptLoader"]:new BI(new Lk.DynamicScriptLoader(A)),["publicPath"]:y.AFrameworkApplication.I8,["appSettings"]:b.appSettings,["logger"]:new so.a,["featureGateManager"]:Object.assign(new GF.a,{getBooleanFeatureGate:Object(E.a)(b,b.getBooleanFeatureGate,"getBooleanFeatureGate"),getIntFeatureGate:Object(E.a)(b,
b.getIntFeatureGate,"getIntFeatureGate"),getStringFeatureGate:Object(E.a)(b,b.getStringFeatureGate,"getStringFeatureGate")}),["app"]:M,["resolveScript"]:(oa,Ja)=>HF.a.resolveScript(oa,Ja),["initialTabId"]:r};b.$("DynamicBundlesIsEnabled")&&(r="",y.AFrameworkApplication.J.$("AppChromeOverrideIsCombinedBundle")||y.AFrameworkApplication.J.$("IsCombinedBundleEnabled")||(r=b.$("IsWebpack5RibbonEnabled")?"wp5/":"exp/"),aa.dynamicBundlesPath=$B.AppChromeOverrideUtilities.isEnabled?$B.AppChromeOverrideUtilities.Fvc+
r:b.ib("StaticContentUrl")+r);return new Promise((oa,Ja)=>{h("gc2",y.AFrameworkApplication.eC("gc2.js",5),"anonymous",5,!1).then(()=>{oa(aa)}).catch(()=>{v.ULS.sendTraceTag(572915794,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Failed To Download Scripts");Ja(null)})})}S5h(b){b=this.nib.hasEdits()&&!b;this.Qvk(b?this.nib.getGraphicData():null,!!this.Skh,this.Skh,b)}}Object(u.a)(JF,"ReactGraphicsEditorDialog",ig.a,[]);class KF{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc,zc,Yc=!1){this.nqi=Yc;this.MDb=
this._context=null;this.f4o=(Kd,ke,ge,de,Sd)=>{var be,Rf;const Mf=!!Sd&&Object(Xa.a)(N.a,Sd);try{if(1===ge){const Ji=ke.view;return this.Dk.Lja(ke)&&Ji.features.AAe?32:8}this.Ezk=4===(null===Sd||void 0===Sd?void 0:Sd.InputMethod)?!0:!1;Object(Ui.c)()&&(this.nqi||uO.a.cpb(()=>{this.nqi=!0}));v.ULS.sendTraceTag(573100171,3001,50,`Launch Graphics Editor dialog. Existing:${Mf}`);performance.mark("LaunchStart");this._context=ke;const Yj=new JF(this.nib,this.hdg,Mf?Sd:null,ke,this.Gf);Kd=null;if(Mf){const Ji=
null===(Rf=null===(be=ke.view.mb)||void 0===be?void 0:be.gb)||void 0===Rf?void 0:Rf.currentSelection;if(null===Ji||void 0===Ji?0:Ji.kP)Kd="Draw"}this.MDb=Yj.e4o(Kd).then(()=>{v.ULS.sendTraceTag(559424644,3001,50,`Graphics Editor dialog display success. Existing:${Mf}`)}).catch(()=>{this.kfi()});if(!Mf){const Ji=js=>{this.MDb.then(()=>{this.tmj(js,!1)})};if(y.AFrameworkApplication.sessionStartInfoSettings&&"Automation"===y.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)return Ji(JSON.stringify({elements:[]})),
32;let sm=null;sm=Object(vo.a)().Iu(ke.view.od);const jn=sm.properties.ka(Mc.a.oqi,"");if(0<jn.length)return Ji(jn),32;this.MSe.NLo(ke,N.a.create(),kb.a.create()).then(js=>{const uy=this.Qc.Nc(0,ub.a.D4c);uy.Bb(sm);sm.setValue(Mc.a.oqi,js);uy.dispose();Ji(js);return null}).catch(js=>{v.ULS.sendTraceTag(512521162,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",js.toString(),Mf);this.kfi()})}return 32}catch(Yj){return v.ULS.sendTraceTag(42328736,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",
Yj.toString(),Mf),8}};this.zSm=(Kd,ke,ge,de,Sd)=>{var be,Rf;Kd=ke.view;ge=null===(Rf=null===(be=null===Kd||void 0===Kd?void 0:Kd.mb)||void 0===be?void 0:be.gb)||void 0===Rf?void 0:Rf.currentSelection;if(null===ge||void 0===ge||!ge.WWa)return 8;if(!Kd.features.AAe)return 32;v.ULS.sendTraceTag(574232200,3001,50,"Launch Graphics Editor: DoubleClick");this.bhi(Sd,ke);return 32};this.ySm=(Kd,ke,ge,de,Sd)=>{var be,Rf,Mf=ke.view;Mf=null===(Rf=null===(be=null===Mf||void 0===Mf?void 0:Mf.mb)||void 0===be?
void 0:be.gb)||void 0===Rf?void 0:Rf.currentSelection;return null!==Mf&&void 0!==Mf&&Mf.WWa?this.CKi(Kd,ke,ge,de,Sd):8};this.CKi=(Kd,ke,ge)=>{if(1===ge)return ke.view.features.AAe?32:8;if(2===ge){Kd=Uc.ImageReader.Kn(ke.Ik);if(!Kd)return 2;v.ULS.sendTraceTag(574232201,3001,50,"Launch Graphics Editor: ContextMenu");this.bhi(Kd,ke);return 32}return 2};this.tmj=(Kd,ke=!0)=>{this.nib.setGraphicData(Kd);performance.mark("LaunchEnd");performance.measure("EditorLaunch","LaunchStart","LaunchEnd");Kd=performance.getEntriesByName("EditorLaunch");
v.ULS.sendTraceTag(559424645,3001,50,`Graphics Editor dialog launched with data successfully set. Existing: ${ke} Duration: ${Kd[Kd.length-1].duration}`);performance.clearMarks("LaunchStart");performance.clearMarks("LaunchEnd");performance.clearMeasures("EditorLaunch")};this.hdg=(Kd,ke,ge,de)=>{var Sd;this.nib.teardown();if(ke&&this._context){var be=this._context.view.mb.Mg,Rf=be.node;be.Al&&Gd.ParagraphReader.Vb(Rf)&&(be=null===(Sd=this.r$)||void 0===Sd?void 0:Sd.TB(Rf),27==(null===be||void 0===
be?void 0:be.role)&&v.ULS.sendTraceTag(541446533,3016,50,"Editing Pull Quote using Graphics Editor. Has edits: {0}; {1}",de,de?" Everything deleted: "+(0==(null===Kd||void 0===Kd?void 0:Kd.json.length)):""))}if(de)if(v.ULS.sendTraceTag(541714E3,3001,50,"GraphicsEditorActor: close dialog and save"),this._context)if(Kd)if(de=Kd.json,Sd=Kd.width,Rf=Kd.height,de.length||ke)if(!de.length&&ke)if(ke=this._context.Ik){ke=ke.node;if(Uc.ImageReader.Zaa(ke)){if(!this.Dk.uuo(ke,new vd.a,re.a.instance,TL.xJb)){v.ULS.sendTraceTag(588817116,
3001,10,"Failed to remove anchored image.");return}}else if(!this.Dk.Cuc(ke,ge,this.jb,this.GY)){v.ULS.sendTraceTag(572363225,3001,10,"Failed to remove inline image.");return}v.ULS.sendTraceTag(572363226,3001,50,"Graphic removed thru dialog.")}else v.ULS.sendTraceTag(588886034,3001,10,"Context was in invalid state for removing existing content.");else be=new vO.a(this._context,y.AFrameworkApplication.ua.pWa,!0,this.Dk,this.Ga,Object(vo.a)()),Kd=kb.a.create(),ge=new KM.a(be,de,this.vM,this.An,Kd,Qn.a.instance,
ke,ge,this.Dk,this.$p,Sd,Rf,this.Ga,this.GY,this.Bd,Object(Ui.c)(),Object(Ui.b)()),this.MSe.Nwg(ge,this._context,ke,Kd),this.Kha(),this.Ezk&&this.Mkp();else v.ULS.sendTraceTag(541714001,3001,50,"Empty Json on new content creation when close dialog");else v.ULS.sendTraceTag(577868244,3001,10,"JSON was unexpectedly null and the model did change!");else v.ULS.sendTraceTag(590205069,3001,10,"GraphicsEditorActor: context cannot be null")};this.ga=b;this.Ga=h;this.MSe=r;this.Dk=A;this.vM=M;this.An=aa;this.nib=
new nN;this.Qc=Ja;this.jb=fb;this.GY=Cb;this.$p=Gb;this.Bd=pc;this.Gf=Sb;this.r$=zc}Xb(){let b=!0;this.Ga.$("GraphicsEditorActorRegistrationUpdateIsEnabled")||(b=this.Bd&&this.Bd.isFeatureEnabled(43));b&&!Y.a.Jt&&(this.ga.fb(Fc.a.mPf,lc.a.view,this.f4o,4),this.ga.fb(ub.a.uyf,lc.a.view,this.zSm,4),this.ga.fb(Fc.a.chi,lc.a.view,this.ySm,4),this.ga.fb(Fc.a.Ggc,lc.a.view,this.CKi,4))}kfi(){const b=new ni.StandardDialog;b.Fd=0;b.zy(Bf.a.fyf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError,
null);qa.StaticActiveAppFrame.za().Fe()}bhi(b,h){var r=b.ka(fd.a.KP,1);const A=b.ka(wb.a.Q_,ic.a.finished);r&&A!==ic.a.hPa?b.ka(Mc.a.j5h,!1)?(h=new ni.StandardDialog,h.Fd=0,h.zy(Bf.a.fyf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError,null,!0),qa.StaticActiveAppFrame.za().Fe(),v.ULS.sendTraceTag(521426528,3001,15,"{0}",{["message"]:"Graphic already known to have unsupported properties",["id"]:Uc.ImageReader.b9a(b)})):(this.ga.Pb(Fc.a.mPf,
2,b.id),this.MDb||(v.ULS.sendTraceTag(574997639,3001,10,"GraphicsEditorDialogInitialization promise was null!"),this.MDb=new Promise(M=>{M(null)})),r=kb.a.create(),b=new mN(b,this.tmj,Qn.a.instance,this.MDb,this.$p,this.Ga,this.Bd,Object(Ui.d)(b)),this.MSe.Nwg(b,h,!0,r)):v.ULS.sendTraceTag(573055959,3001,50,"Graphics Editor launch diverted since Box4 model is not ready!")}Kha(){const b=Za.a.instance.Ra(2);b?b.execute(h=>{h.logActivity("WordWebDrawing","WordDrawingFloodgateIsEnabled")}):v.ULS.sendTraceTag(572352085,
3001,10,"ISystemInitiatedFeedback was null")}Mkp(){const b=Za.a.instance.Ra(2);b?b.execute(h=>{h.logActivity("WordPenNsatSurvey","WordPenNsatSurveyIsEnabled")}):v.ULS.sendTraceTag(520382472,3001,10,"ISystemInitiatedFeedback was null")}}Object(u.a)(KF,"GraphicsEditorActor",null,[]);var JK=d(528);class Hx{constructor(b,h,r){this.k2a="wwaengidc";this.fyd="CreateLinkForHeading";this.hqk="CreateLinkForHeadingAction";this.psk="\ufffc";this.X1a=b;this.ga=h;this.jb=r}Xb(){this.ga.qa(Fc.a.RWc,lc.a.paragraph,
this.gtf.bind(this));this.ga.qa(Fc.a.RWc,lc.a.Cd,this.gtf.bind(this));this.ga.qa(Fc.a.RWc,lc.a.Xc,this.gtf.bind(this));this.ga.Pc(Fc.a.RWc,1028)}gtf(b,h,r){b=h.node;if(1===r)return this.nYi(b)?32:8;this.dno(this.fyd,this.hqk);if(!this.nYi(b))return v.ULS.sendTraceTag(528815444,3029,50,"User is trying to create sharable link for a non-heading text"),8;r=b.getValue(Mc.a.Yc);if(!r)return v.ULS.sendTraceTag(528815445,3029,10,"Word id does not exist for the paragraph"),r=new Map,r.set("Source",this.fyd),
r=Object.assign(new bb.a,{additionalValues:r}),Ba.Health.instance.recordKpiFailure(this.fyd,"Unable to create sharable link as paragraph id is missing",!1,!0,r),8;this.W8h(r);return 32}W8h(b){b=String.format('{{"{0}":"{1}"}}',JK.a.heading,b);this.ga.Pb(Ka.a.Aaa,2,{["nav"]:btoa(b),["mode"]:"copy"},{["ControlId"]:"CopyLinkToHeading"})}nYi(b){return!this.jb.Vb(b)||this.jb.ync(b)||this.jb.Msb(b)||b.zs||""===b.characterData||b.characterData===this.psk||!this.X1a.S5d(b)?!1:!0}dno(b,h){const r=new Map;r.set("Source",
this.fyd);r.set("Action",h);Ba.Health.instance.recordKpiUsage(b,0,this.k2a,r)}}Object(u.a)(Hx,"HeadingsActor",null,[]);class OD{b1o(b){return Gd.ParagraphReader.Aza(this.Bxi(b))}Pmd(b,h,r){if(b=Gd.ParagraphReader.kKa(this.Bxi(b)))h=b.Be(h),Object(Xa.a)(33,h)&&(Vv.m(b)?h.fWo(r):h.Pmd())}Bxi(b){return b&&b.Al&&b?b.node:null}}Object(u.a)(OD,"IFrameFocusStrategy",null,[497]);class oN{constructor(b){this.mHa=null;this.uCd=b}G9i(){v.ULS.sendTraceTag(25007835,375,50,"Ignore all spelling error triggered")}J2j(b){if(!b)return v.ULS.sendTraceTag(25007836,
375,15,"Error range is null"),!1;if(!b.errorDetails)return v.ULS.sendTraceTag(25007837,375,15,"No error detail found"),!1;if(!b.errorDetails.token)return v.ULS.sendTraceTag(25007838,375,50,"Ignore-all: Token is null and the ErrorDetails type is {0}",Object.getType(b.errorDetails).toString()),!1;this.mHa=I.a.dCe(b.errorDetails.token,b.errorDetails.lcid);this.uCd.add(this.mHa,b.errorDetails.lcid);return!0}ood(b){return b?b.token?I.a.dCe(b.token,b.lcid)===this.mHa:(v.ULS.sendTraceTag(25007840,375,15,
"ErrorDetails Token is null"),!1):(v.ULS.sendTraceTag(25007839,375,15,"ErrorDetails is null during ignore-all operation"),!1)}}Object(u.a)(oN,"IgnoreAllProofingErrorStrategy",null,[495]);var wO=d(1246),ns=d(569),pN=d(372);class qN{constructor(b,h){this.filename=b;this.blob=h}}Object(u.a)(qN,"UploadBlobParameters",null,[]);class rN extends ik{constructor(b,h,r,A,M,aa,oa,Ja,fb=null){super(b,h,r,null,M,aa,Ja,!1);this.LAk="DragAndDrop";this.rgh="FileName";this.ugh=0;this.fIh=null;this.Usd=this.rob=!1;
this.xeh=A;this.Hyh=fb}get o8j(){return"DragDropInsertImage"}get MR(){return this.LAk}get fileExtension(){return this.rgh}get fileSize(){return this.ugh}get p8j(){return this.fIh}Wpd(b){const h=new qN(this.xeh.name,this.xeh);b.oXj(h);this.fIh=b.nlb}vAa(b,h){this.Hyh&&this.Hyh();super.vAa(b,h)}QMg(b){const h=!!b&&this.coa(b.name,null)&&this.RMg(b,null);b&&(this.rgh=b.name,this.ugh=b.size);h||this.whe();return h}}Object(u.a)(rN,"DragDropInsertImageUploader",ik,[]);class Lt{constructor(b,h,r,A,M,aa,
oa){this.m6c=aa;this.jV=oa;this.Aie=this.Bie=this.aje=this.bje=0;this.ga=null;this.$xf=(Ja,fb,Cb)=>{if(df.a.KZd)return 8;Ja=fb.node;return 1===Cb?Ja?32:2:2===Cb?(Cb=Uc.ImageReader.Kn(fb),fb=Uc.ImageReader.n3c(Cb,fb.node.Jj().td,y.AFrameworkApplication.J,y.AFrameworkApplication.ua.pWa),JC(fb),32):2};this.p8m=(Ja,fb,Cb)=>{const Gb=this.Dk.Lja(fb);if(2===Cb&&Gb){if(ub.a.nX===Ja||ub.a.pUd===Ja)y.AFrameworkApplication.Mta?y.AFrameworkApplication.KCg():this.DGl(fb);return 32}return 1!==Cb||ub.a.nX!==Ja&&
ub.a.pUd!==Ja?2:Gb?32:2};this.RRb=(Ja,fb,Cb,Gb,Sb)=>this.Dk.Lja(fb)?1===Cb?32:this.Dk.SUf(fb,Sb)?32:2:2;this.wVo=()=>{if(this.hb&&this.hb.gb&&this.hb.gb.currentSelection){const Ja=this.hb.gb.currentSelection.Qa;Ja&&this.hb.Kc(sc.SelectionFactory.ue(Ja.node,Ja.cpBegin))}};this.gWl=(Ja,fb,Cb,Gb,Sb)=>{v.ULS.sendTraceTag(42530333,307,50,"Drag and drop local content");if((Ja=Sb.DataTransfer)&&Ja.files&&0<Ja.files.length){v.ULS.sendTraceTag(578380440,307,50,String.format("{0} files to drop",Ja.files.length));
for(Cb=0;Cb<Ja.files.length;Cb++)Gb=Ja.files[Cb],0<=I.a.vh(Gb.type).indexOf("image")&&this.y7m(Gb,fb)&&(Gb=this.hb.gb.currentSelection.Qa,this.hb.Kc(sc.SelectionFactory.ue(Gb.node,Gb.cpBegin+1)));this.tPa();return 32}v.ULS.sendTraceTag(42530334,307,15,"Drag and drop local content not handled");return 2};this.a9n=(Ja,fb,Cb,Gb,Sb)=>{if(2===Cb)return y.AFrameworkApplication.va.Nf(fb.Ik,Ja,Cb,!0,Gb,Sb);if(!fb.view.te)return 8;Ja=fb.view;if(!Ja.mb)return 8;Ja=Ja.mb.Mg;Ja=Object(Al.a)().GO(Ja);return 1===
Ja.length&&this.LQ(Ja[0])?(this.XBn(),32):8};this.pRm=(Ja,fb,Cb)=>{if(!this.LQ(fb))return 8;const Gb=Uc.ImageReader.Kn(fb),Sb=Uc.ImageReader.RB(Gb),pc=Uc.ImageReader.$C(Gb);Ja=Ja===ub.a.u9d;v.ULS.sendTraceTag(20459936,322,50,"GrowShrinkImage: {0}",{["IsGrow"]:Ja});if(1===Cb)return this.pj.p7||Uc.ImageReader.Z$a(Gb)?2:Ja&&Sb<this.Bie&&pc<this.Aie||!Ja&&Sb>this.bje&&pc>this.aje?32:2;Cb=Ja?1.1:.9;this.setSize(Gb,fb,Sb*Cb,pc*Cb,!0);return 32};this.Stc=(Ja,fb,Cb,Gb,Sb)=>{if(!this.Lqa(fb))return 8;Ja=Uc.ImageReader.Kn(fb);
fb=Uc.ImageReader.OVa(Ja);Cb=Uc.ImageReader.NVa(Ja);if(0>=fb||0>=Cb)return 2;Ja=Uc.ImageReader.RB(Ja)/fb*100;Sb.setValue(pd.a.s6c,Ja);return 32};this.Xlc=(Ja,fb,Cb,Gb,Sb)=>{if(!this.Lqa(fb))return 8;Ja=Uc.ImageReader.Kn(fb);if(1===Cb)return this.pj.p7||Uc.ImageReader.Z$a(Ja)?2:32;v.ULS.sendTraceTag(20459937,322,50,"Change image scale.");Cb=Sb.ka(pd.a.s6c,-1)/100;Gb=Sb.ka(pd.a.KOi,!1);const pc=Sb.ka(pd.a.cTf,!0);Sb=Sb.ka(pd.a.dTf,!0);if(0>=Cb)return Lt.Dc.$b(Nf.a.Nn,{["Reason"]:nf.a.psb}),2;const zc=
Uc.ImageReader.OVa(Ja),Yc=Uc.ImageReader.NVa(Ja),Kd=Uc.ImageReader.RB(Ja),ke=Uc.ImageReader.$C(Ja);if(0>=zc||0>=Yc)return Lt.Dc.$b(Nf.a.C4,{["Reason"]:nf.a.psb}),2;Gb?(Gb=pc?Cb*Kd:Kd,Cb=Sb?Cb*ke:ke):(Gb=pc?Cb*zc:Kd,Cb=Sb?Cb*Yc:ke);this.setSize(Ja,fb,Gb,Cb);Of.a.ud().Co&&Of.a.ud().Ak.xG(fb.node);this.tPa();return 32};this.XXb=(Ja,fb,Cb,Gb,Sb)=>{if(!this.LQ(fb))return 8;Ja=Uc.ImageReader.Kn(fb);Ja=Uc.ImageReader.$C(Ja);if(0>=Ja)return 2;Sb.setValue(pd.a.MKa,Ja);return 32};this.MKa=(Ja,fb,Cb,Gb,Sb)=>
{if(!this.Lqa(fb))return 8;Ja=Uc.ImageReader.Kn(fb);if(1===Cb)return this.pj.p7||Uc.ImageReader.Z$a(Ja)?2:32;v.ULS.sendTraceTag(20459938,322,50,"Change image absolute height.");Cb=Sb.ka(pd.a.MKa,0);Sb=Uc.ImageReader.Y$a(Ja);if(0>=Cb)return Lt.Dc.$b(Nf.a.Nn,{["Reason"]:nf.a.psb}),2;Gb=Uc.ImageReader.OVa(Ja);const pc=Uc.ImageReader.NVa(Ja),zc=Uc.ImageReader.RB(Ja);var Yc=Uc.ImageReader.$C(Ja);Yc=zc/Yc;if(0>=Gb||0>=pc)if(Lt.Dc.$b(Nf.a.C4,{["Reason"]:nf.a.psb}),this.mRj(Ja))return 2;this.setSize(Ja,fb,
Sb?Cb*Yc:zc,Cb);Of.a.ud().Co&&Of.a.ud().Ak.xG(fb.node);qa.StaticActiveAppFrame.za().Fe();return 32};this.YXb=(Ja,fb,Cb,Gb,Sb)=>{if(!this.LQ(fb))return 8;Ja=Uc.ImageReader.Kn(fb);Ja=Uc.ImageReader.RB(Ja);if(0>=Ja)return 2;Sb.setValue(pd.a.NKa,Ja);return 32};this.NKa=(Ja,fb,Cb,Gb,Sb)=>{if(!this.Lqa(fb))return 8;Ja=Uc.ImageReader.Kn(fb);if(1===Cb)return this.pj.p7||Uc.ImageReader.Z$a(Ja)?2:32;v.ULS.sendTraceTag(20459939,322,50,"Change image absolute width.");Cb=Sb.ka(pd.a.NKa,0);Sb=Uc.ImageReader.Y$a(Ja);
if(0>=Cb)return Lt.Dc.$b(Nf.a.Nn,{["Reason"]:nf.a.psb}),2;Gb=Uc.ImageReader.OVa(Ja);const pc=Uc.ImageReader.NVa(Ja);var zc=Uc.ImageReader.RB(Ja);const Yc=Uc.ImageReader.$C(Ja);zc=Yc/zc;if(0>=Gb||0>=pc)if(Lt.Dc.$b(Nf.a.C4,{["Reason"]:nf.a.psb}),this.mRj(Ja))return 2;this.setSize(Ja,fb,Cb,Sb?Cb*zc:Yc);Of.a.ud().Co&&Of.a.ud().Ak.xG(fb.node);qa.StaticActiveAppFrame.za().Fe();return 32};this.$Xb=(Ja,fb,Cb,Gb,Sb)=>{if(!this.LQ(fb))return 8;Ja=Uc.ImageReader.Kn(fb);Ja=Uc.ImageReader.Y$a(Ja);Sb.setValue(pd.a.P_,
Ja);return 32};this.P_=(Ja,fb,Cb,Gb,Sb)=>{if(!this.LQ(fb))return 8;Ja=Uc.ImageReader.Kn(fb);if(1===Cb&&this.pj.p7)return 2;Of.a.ud().Co&&Of.a.ud().Ak.xG(fb.node);Sb&&(fb=Sb.ka(pd.a.P_,!0),v.ULS.sendTraceTag(20459968,322,50,"Change image lock aspect ratio."),this.Dk.yMj(Ja,fb),qa.StaticActiveAppFrame.za().Fe());return 32};this.Jcb=(Ja,fb,Cb,Gb,Sb)=>{if(!this.LQ(fb))return 8;Ja=Uc.ImageReader.Kn(fb);Ja=Uc.ImageReader.t_(Ja);Sb.setValue(pd.a.Nrb,Ja);return 32};this.Nrb=(Ja,fb,Cb,Gb,Sb)=>{if(!this.LQ(fb))return 8;
if(1===Cb)return this.pj.p7?2:32;if(Of.a.ud().Co&&(Ja=fb.node.ka(fd.a.YJ,Ml.a.Hu),Ja!==Ml.a.Hu&&(Ja=Of.a.ud().Ak.Cqb(Ja),pN.a.getInstance().aeb(Ja))))return Lt.Dc.$b(Nf.a.Nn,{["Reason"]:nf.a.IG}),2;Ja=Uc.ImageReader.Kn(fb);Sb=Sb.ka(pd.a.Nrb,null);this.Dk.FRo(Ja,fb,Sb);v.ULS.sendTraceTag(21297027,322,50,"Change image alt text.");this.Od.Yu(13);return 32};this.Icb=(Ja,fb,Cb,Gb,Sb)=>{if(!this.LQ(fb))return 8;Ja=Uc.ImageReader.Kn(fb);Ja=Uc.ImageReader.IVa(Ja);Sb.setValue(pd.a.O_,Ja);return 32};this.O_=
(Ja,fb,Cb,Gb,Sb)=>{if(!this.LQ(fb))return 8;if(1===Cb)return this.pj.p7?2:32;if(Of.a.ud().Co&&(Ja=fb.node.ka(fd.a.YJ,Ml.a.Hu),Ja!==Ml.a.Hu&&(Ja=Of.a.ud().Ak.Cqb(Ja),pN.a.getInstance().aeb(Ja))))return Lt.Dc.$b(Nf.a.Nn,{["Reason"]:nf.a.IG}),2;Ja=Uc.ImageReader.Kn(fb);Sb=Sb.ka(pd.a.O_,null);this.Dk.ERo(Ja,fb,Sb);v.ULS.sendTraceTag(21297029,322,50,"Change image alt text description.");this.Od.Yu(13);return 32};this.xdb=(Ja,fb,Cb)=>{var Gb,Sb;if(1===Cb)return 32;if(!fb.view.te)return v.ULS.sendTraceTag(512267791,
322,15,"No interactive view. Action: {0}",Ja),8;fb=fb.view;Cb=null===(Sb=null===(Gb=fb.mb)||void 0===Gb?void 0:Gb.gb)||void 0===Sb?void 0:Sb.K(0);if(!Cb)return v.ULS.sendTraceTag(512267790,322,15,"No selection view. Action: {0}",Ja),8;Sb=Cb.Qa;Gb=this.jV.Wf("UserAction",Ja.toString());let pc;Ja==ub.a.iwg?pc=this.m6c.xdb(Sb,2):Ja==ub.a.lwg?(pc=this.m6c.xdb(Sb,0),5==pc&&(pc=this.m6c.xdb(Sb,2))):Ja==ub.a.mwg&&(pc=this.m6c.xdb(Sb,1),5==pc&&(pc=this.m6c.xdb(Sb,3)));switch(pc){case 4:Sb=32;fb.Z3();break;
case 5:Sb=2;break;default:Sb=8}Gb.stop();v.ULS.sendTraceTag(512267789,322,50,"Select image: {0}. Duration: {1}. Action: {2}",pc,Gb.Ei,Ja);return Sb};this.Dk=b;this.Sn=h;this.Od=r;this.Yg=A;this.hb=M;this.He=Bd.a.lq?sh.a.getInstance(dd.a):sh.a.getInstance(gj.a)}get pj(){return Um.PageReader.instance}get Wea(){return this.Sn.instance}get Rb(){return this.ga}s5m(){this.bje=Ah.a.qn(1,0);this.aje=Ah.a.qn(1,1);this.Bie=Ah.a.qn(1920,0);this.Aie=Ah.a.qn(1280,1)}Xb(b){this.ga=b;const h=this.a9n,r=this.p8m,
A=this.RRb,M=this.pRm;b.fb(ub.a.nX,lc.a.view,r,1284);b.qa(ub.a.RRb,lc.a.Xc,A);b.qa(ub.a.iwg,lc.a.view,this.xdb);b.qa(ub.a.lwg,lc.a.view,this.xdb);b.qa(ub.a.mwg,lc.a.view,this.xdb);b.qa(ub.a.RRb,lc.a.image,A);b.Pc(ub.a.RRb,1284);b.fb(ub.a.pUd,lc.a.view,r,1284);b.fb(ub.a.Wmf,lc.a.view,h,1028);this.ks(b,ub.a.u9d,M);this.ks(b,ub.a.YCg,M);this.ks(b,ub.a.Stc,this.Stc);this.ks(b,ub.a.XXb,this.XXb);this.ks(b,ub.a.YXb,this.YXb);this.ks(b,ub.a.Jcb,this.Jcb);this.ks(b,ub.a.Icb,this.Icb);this.ks(b,ub.a.Xlc,this.Xlc);
this.ks(b,ub.a.Dwe,this.MKa);this.ks(b,ub.a.Ewe,this.NKa);this.ks(b,ub.a.Umd,this.Nrb);this.ks(b,ub.a.l_b,this.O_);this.ks(b,ub.a.$Xb,this.$Xb);this.ks(b,ub.a.P_,this.P_);this.ks(b,ub.a.$xf,this.$xf);b.fb(ub.a.Tgi,lc.a.view,this.gWl,4);b.Pc(ub.a.u9d,4);b.Pc(ub.a.YCg,4);b.Pc(ub.a.Stc,69);b.Pc(ub.a.XXb,69);b.Pc(ub.a.YXb,69);b.Pc(ub.a.$Xb,69);b.Pc(ub.a.Jcb,69);b.Pc(ub.a.Icb,69);b.Pc(ub.a.P_,4);b.Pc(ub.a.Xlc,4);b.Pc(ub.a.Dwe,4);b.Pc(ub.a.Ewe,4);b.Pc(ub.a.Umd,4);b.Pc(ub.a.l_b,4);this.s5m()}ks(b,h,r){b.qa(h,
lc.a.image,r);b.qa(h,lc.a.sOb,r);b.qa(h,lc.a.Cd,r);b.qa(h,lc.a.I$,r)}DGl(b){new ik(b,Je.a.instance,y.AFrameworkApplication.J,null,this.Yg,this.ga,new bn.b)}KAp(b){return this.pj.p7?(Lt.Dc.$b(Nf.a.Nn,{["Reason"]:nf.a.compatMode}),!1):this.ga&&3!==this.ga.mode?(Lt.Dc.$b(Nf.a.Nn,{["Reason"]:nf.a.p3l}),!1):Lt.rg.q2(b)?(Lt.Dc.$b(Nf.a.Nn,{["Reason"]:nf.a.IG}),!1):this.Wea&&this.Wea.sX(b)?(Lt.Dc.$b(Nf.a.Nn,{["Reason"]:nf.a.b8a}),!1):!0}Khn(b){const h=Uc.ImageReader.Kn(b);return h&&5===Uc.ImageReader.Fk(h)&&
this.bWi(b,h)}bWi(b,h){(h=!Uc.ImageReader.Djc(h)&&!Uc.ImageReader.Fde(h))||Lt.Dc.$b(Nf.a.Nn,{["Reason"]:nf.a.q5h});return h&&this.KAp(b)}y7m(b,h){var r,A;h=new rN(h,Je.a.instance,y.AFrameworkApplication.J,b,this.Yg,this.ga,this.hb,new bn.b,this.wVo);if(h.QMg(b))Bd.a.lq?this.He.logKpiUsage({kpiName:dd.d.yKa,kpiType:0}):(null===(A=y.AFrameworkApplication.J)||void 0===A?0:A.$("ShouldLogPicturesExtendedHealthKpis"))&&this.He.logKpiUsage({kpiName:gj.c.OKa,kpiType:0});else return Bd.a.lq?(b=new Map([["ErrorLevel",
"info"]]),b=Object.assign(new bb.a,{extendedProperties:b}),this.He.logKpiFailure({kpiName:dd.d.yKa,errorName:"PictureDragDropInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:Object(Ql.c)(dd.d.Zkc)})):(null===(r=y.AFrameworkApplication.J)||void 0===r?0:r.$("ShouldLogPicturesExtendedHealthKpis"))?(b=new Map([["ErrorLevel","info"]]),b=Object.assign(new bb.a,{extendedProperties:b}),this.He.logKpiFailure({kpiName:gj.c.OKa,errorName:"PictureDragDropInvalid",optionalProperties:{isIntentional:!0,
isInternal:!0,additionalValues:b},optionalVeto:{name:gj.c.Vlc,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:null}})):Ba.Health.instance.recordQosError("PictureDragDropInvalid",["ImageInsertFailed"],!0,!0,!1,!1,null),v.ULS.sendTraceTag(578380439,307,50,"The file is not supported"),!1;new Jk.a(document.body,Object(E.a)(h,h.Hvb,"onUploadFrameInitialized"),Object(E.a)(h,h.aoa,"uploadResponseReceived"),y.AFrameworkApplication.J,!1,void 0,
hg.a(y.AFrameworkApplication.J));return!0}LQ(b){return this.Khn(b)}Lqa(b){const h=Uc.ImageReader.Kn(b);if(!h)return!1;const r=Za.a.instance.Oa(12),A=Uc.ImageReader.Fk(h);return 5===A||10===A||48===A||11===A||r&&r.isFeatureEnabled(43)&&4===A?this.bWi(b,h):!1}setSize(b,h,r,A,M=!1){Of.a.ud().Co&&Of.a.ud().Ak.xG(h.node);const aa=Uc.ImageReader.Y$a(b);let oa=1;r>this.Bie?oa=this.Bie/r:r<this.bje&&(oa=this.bje/r);let Ja=1;A>this.Aie?Ja=this.Aie/A:A<this.aje&&(Ja=this.aje/A);if(aa||M)oa=Math.min(oa,Ja),
Ja=Math.min(oa,Ja);1!==oa&&(r*=oa);1!==Ja&&(A*=Ja);this.zxf(b,h,r,A)}zxf(b,h,r,A){this.Dk.IVo(b,h,r,A)}XBn(){v.ULS.sendTraceTag(20459969,322,50,"PictureTools Tab enabled.")}tPa(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("WordEditorInsertImagesFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Za.a.instance.Ra(2);b&&b.execute(h=>{h.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}mRj(b){const h=Uc.ImageReader.OVa(b);b=Uc.ImageReader.NVa(b);return 0>=
h||0>=b}static get rg(){return re.a.instance}static get Dc(){return Rg.a.instance}}Object(u.a)(Lt,"ImageActor",null,[]);var xO=d(823);class BA{constructor(b,h,r,A,M,aa){this.oI=b;this.graphNode=h;this.Qgc=r;this.WQm=A;this.AAa=M;this.Ho=aa;this.nBd=new xO.a(this.Ip(),BA.pBc);if(Bd.a.lq||Bd.a.iV)this.He=sh.a.getInstance(dd.a)}yra(b){this.FX("crop");this.Ho.WX([7]);if(null===this.oI||void 0===this.Qgc||void 0===this.AAa)return this.mD("crop","Argument(s) invalid"),!1;const h=this.getGraphicData("crop");
if(void 0===h)return!1;const r=this.AAa.fPm();r.top=b.top;r.left=b.left;r.right=b.right;r.bottom=b.bottom;try{if(!this.DSc(r,h))return this.CUb("crop","Failed to apply and update"),this.mD("crop","Failed to apply and update"),!1}catch(A){return this.CUb("crop",A),this.mD("crop",A.stack?A.stack:A.message?A.message:A.toString()),!1}this.Ho.XL([7]);this.A4();this.rbd("crop");return!0}rotate(b){this.FX("rotate");this.Ho.WX([8]);if(null===this.oI||void 0===this.Qgc||void 0===this.AAa)return this.mD("rotate",
"Argument(s) invalid"),!1;const h=this.getGraphicData("rotate");if(void 0===h)return!1;b-=this.oI.Gga.HEi();if(0!==b){const r=this.AAa.jPm();r.rotation=b;try{if(!this.DSc(r,h))return this.mD("rotate","Failed to apply and update"),!1}catch(A){return this.CUb("rotate",A),this.mD("rotate",A.stack?A.stack:A.message?A.message:A.toString()),!1}}this.Ho.XL([8]);this.A4();this.rbd("rotate");return!0}flip(b,h){const r="flip"+(b?"H":"")+(h?"V":"");this.FX(r);this.Ho.WX([9]);if(null===this.oI||void 0===this.Qgc||
void 0===this.AAa)return this.mD(r,"Argument(s) invalid"),!1;const A=this.getGraphicData(r);if(void 0===A)return!1;const M=this.AAa.gPm();M.flip=this.AAa.tqm();M.flip.x=b;M.flip.y=h;try{if(!this.DSc(M,A))return this.mD(r,"Failed to apply and update"),!1}catch(aa){return this.CUb(r,aa),this.mD(r,aa.stack?aa.stack:aa.message?aa.message:aa.toString()),!1}this.Ho.XL([9]);this.A4();this.rbd(r);return!0}oUd(b,h,r){const A="changePictureBorderProps"+(void 0!==b?"_Weight":"")+(void 0!==h?"_DashType":"")+
(void 0!==r?"_Color":"");this.FX(A);this.Ho.WX([10]);if(null===this.oI||void 0===this.Qgc||void 0===this.AAa)return this.mD(A,"Argument(s) invalid"),!1;const M=this.getGraphicData(A);if(void 0===M)return!1;const aa=this.AAa.dPm();void 0!==b&&(aa.weight=b);void 0!==h&&(aa.$M=h);void 0!==r&&(aa.color=r);try{if(!this.DSc(aa,M))return this.CUb(A,"Failed to apply and update"),this.mD(A,"Failed to apply and update"),!1}catch(oa){return this.CUb(A,oa),this.mD(A,oa.stack?oa.stack:oa.message?oa.message:oa.toString()),
!1}this.Ho.XL([10]);this.A4();this.rbd(A);return!0}resize(b,h){this.FX("resize");this.Ho.WX([11]);if(null===this.oI||void 0===this.Qgc||void 0===this.AAa)return this.mD("resize","Argument(s) invalid"),!1;const r=this.getGraphicData("resize");if(void 0===r)return!1;let A=0;var M=0;({width:A,height:M}=Uc.ImageReader.a9a(this.oI));b/=A;h/=M;M=this.AAa.kPm();M.scale=this.AAa.yIm();M.scale.width=b;M.scale.height=h;try{if(!this.DSc(M,r))return this.mD("resize","Failed to apply and update"),!1}catch(aa){return this.CUb("resize",
aa),this.mD("resize",aa.stack?aa.stack:aa.message?aa.message:aa.toString()),!1}this.Ho.XL([11]);this.A4();this.rbd("resize");return!0}static get pBc(){return Za.a.instance.Oa(96)}getGraphicData(b){try{const h=this.nBd.QNf();return this.oI.getGraphicData(h)}catch(h){this.mD(b,h.stack?h.stack:h.message?h.message:h.toString())}}DSc(b,h){this.Qgc.apply(b,h);b=this.oI.TOb(h);if(void 0===b)return!1;this.lrp(b);return!0}lrp(b){const h=new Rb.GraphTransaction(15);h.Bb(this.graphNode);this.oI.setValue(De.a.rN,
b.rN);this.WQm.RHo(b.Yki,b.iCa,this.oI);h.dispose()}Ip(){return Object(vo.a)().Iu(this.graphNode)}FX(b){const h=this.RPg;h.Bob=b;v.ULS.sendTraceTag(509657553,322,50,"{0}",h)}mD(b,h){const r=this.RPg;r.message=h;r.Bob=b;v.ULS.sendTraceTag(509666444,322,15,"{0}",r)}get RPg(){return{["id"]:Uc.ImageReader.b9a(this.oI),["type"]:Uc.ImageReader.Fk(this.oI)}}rbd(b){Bd.a.lq&&this.He.logKpiSuccess({kpiName:dd.d.q9d+dd.b.I3d+b+dw.a[Uc.ImageReader.Fk(this.oI)].toString()})}CUb(b,h){if(Bd.a.lq){const {width:r,
height:A}=Uc.ImageReader.a9a(this.oI);h=Object.assign(new bb.a,{extendedProperties:new Map([["Exception",h.message?h.message:h.toString()]])});h.extendedProperties.set("ErrorLevel","warning");this.He.logKpiFailure({kpiName:dd.d.q9d+dd.b.I3d+b+dw.a[Uc.ImageReader.Fk(this.oI)].toString(),errorName:"DrawingResponseInvalid"+Object(Ql.b)(A,r),optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:h},optionalVeto:Object(Ql.c)(dd.d.bKi,h,null,!1)})}}A4(){if(Bd.a.iV){var b=this.Ho.records;for(const [h,
r]of Object.entries(b))b={additionalValues:Object.assign(new bb.a,{durationMs:r}),hasImpliedUsage:!0},this.He.logKpiSuccess({kpiName:dd.d.etc+bn.a[h]+dw.a[Uc.ImageReader.Fk(this.oI)].toString(),optionalProperties:b}),this.Ho.Fuc(Number(h))}}}Object(u.a)(BA,"EditWithGC2Command",null,[]);class gC{RHo(b,h,r){this.yxn(b,h);this.UHo(r)}yxn(b,h){this.LJ=Array(4);this.LJ[Zi.a.left]=b.Jyf;this.LJ[Zi.a.top]=b.Lyf;this.LJ[Zi.a.right]=b.Kyf;this.LJ[Zi.a.bottom]=b.Iyf;this.ZUa=b.ZUa;this.$Ua=b.$Ua;(this.iCa=
h)&&this.Yyl()}UHo(b){b.setValue(De.a.eBa,Math.round(this.ZUa).toString());b.setValue(De.a.fBa,Math.round(this.$Ua).toString());const h=Array(4);this.LJ.forEach((r,A)=>{h[A]=Math.round(r).toString()});b.setValue(De.a.bWa,h);b.setValue(De.a.I$a,this.iCa)}Yyl(){this.Dcp();const b=this.ZUa/2,h=this.$Ua/2;this.ZUa%2&&0===this.$Ua%2?(--this.LJ[Zi.a.left],++this.LJ[Zi.a.top]):this.$Ua%2&&0===this.ZUa%2&&(++this.LJ[Zi.a.left],--this.LJ[Zi.a.top]);this.LJ[Zi.a.left]+=b-h;this.LJ[Zi.a.right]-=b-h;this.LJ[Zi.a.top]+=
h-b;this.LJ[Zi.a.bottom]-=h-b}Dcp(){const b=this.ZUa;this.ZUa=this.$Ua;this.$Ua=b}}Object(u.a)(gC,"GraphicsExtents",null,[]);var XL=d(1109),YL=d(1110),KK=d(527);class LK{constructor(){this.SCp={["PictureBorderWeightZeroPointTwoFive"]:.25,["PictureBorderWeightZeroPointFive"]:.5,["PictureBorderWeightZeroPointSevenFive"]:.75,["PictureBorderWeightOne"]:1,["PictureBorderWeightOnePointFive"]:1.5,["PictureBorderWeightTwoPointTwoFive"]:2.25,["PictureBorderWeightThree"]:3,["PictureBorderWeightFourPointFive"]:4.5};
this.SKl={["PictureBorderStyleSolid"]:0,["PictureBorderStyleDash"]:7,["PictureBorderStyleRoundDot"]:8};this.T8n={["background1"]:0,["text1"]:1,["background2"]:2,["text2"]:3,["accent1"]:4,["accent2"]:5,["accent3"]:6,["accent4"]:7,["accent5"]:8,["accent6"]:9};this.S8n={[0]:"background1",[1]:"text1",[2]:"background2",[3]:"text2",[4]:"accent1",[5]:"accent2",[6]:"accent3",[7]:"accent4",[8]:"accent5",[9]:"accent6"};this.Ybi={ENa:{Etc:1}};this.aci=.75;this.Zbi=0;this.pgp=8;this.kOn=6}Uhp(b,h){if(b){var r=
this.ZCm(b);h=h.Gga.q7d();b.On=void 0===r?!1:r===h}}Thp(b,h){if(b){var r=this.SCi(b);h=h.Gga.DLf();b.On=void 0===r||void 0===h?!1:r===h}}static d4c(b){return b.Gga.d4c()}HLm(b){var h=b.ENa;b=this.S8n[h.Etc];const r=h.rIa.She;h=h.rIa.Rhe;let A,M;void 0!=r?A=r:void 0!=h&&(M=100-h);return{Etc:b,rIa:{Peb:A,Kwc:M}}}qca(b,h,r){var A;const M=null===(A=w())||void 0===A?void 0:A.NIa();h=new BA(b,h,M,new gC,z(),new bn.b);r=this.WCi(r);if(void 0===r)return!1;A=!!b.Gga.d4c();b=void 0!==b.Gga.DLf();return h.oUd(r,
b?void 0:this.Zbi,A?void 0:this.Ybi)}$To(b,h,r){var A;const M=null===(A=w())||void 0===A?void 0:A.NIa();h=new BA(b,h,M,new gC,z(),new bn.b);r=this.SCi(r);if(void 0===r)return!1;A=!!b.Gga.d4c();b=!!b.Gga.q7d();return h.oUd(b?void 0:this.aci,r,A?void 0:this.Ybi)}e4(b,h,r){var A;const M=null===(A=w())||void 0===A?void 0:A.NIa();A=new BA(b,h,M,new gC,z(),new bn.b);h=this.WCm(r,h);if(void 0===h)return!1;r=!!b.Gga.q7d();b=void 0!==b.Gga.DLf();return A.oUd(r?void 0:this.aci,b?void 0:this.Zbi,h)}Euc(b,h){var r;
const A=null===(r=w())||void 0===r?void 0:r.NIa();return(new BA(b,h,A,new gC,z(),new bn.b)).oUd()}WCm(b,h){if(b.length===this.pgp){b=parseInt(b,16)>>>24;h=Object(vo.a)().Iu(h);h=os.pmp(b-1,h);if(void 0===h){v.ULS.sendTraceTag(508692042,322,15,`getPictureBorderColorFromActionData: Could not find theme color info for color index ${b}`);return}b=this.T8n[h.JBe];if(void 0===b){v.ULS.sendTraceTag(508683782,322,15,`getPictureBorderColorFromActionData: Could not find preset scheme color for ${h.JBe}`);return}const r=
void 0!==h.Peb?100-h.Peb:100-h.Kwc;return{ENa:{Etc:b,rIa:{Rhe:r,She:void 0!==h.Peb?100-r:void 0}}}}if(b.length===this.kOn)return{gld:"#"+I.a.IJ(Ol.a.qmb(parseInt(b,16)),6)};v.ULS.sendTraceTag(508692041,322,15,"setPictureBorderColor: Invalid action data received.")}ZCm(b){b=this.WCi(b);if(void 0!==b)return b=Ah.a.x0(b,0,!1),Ah.a.Ejg(b)}WCi(b){b=this.SCp[b.SourceControlId];void 0===b&&v.ULS.sendTraceTag(508692040,322,15,"getPictureBorderWeightFromActionDataInPoints: Invalid action data received.");
return b}SCi(b){b=this.SKl[b.SourceControlId];void 0===b&&v.ULS.sendTraceTag(508692039,322,15,"getPictureBorderDashTypeFromActionData: Invalid action data received.");return b}}Object(u.a)(LK,"Gc2PictureBorderHelper",null,[]);var sN=d(386),yO=d(436),zO=d(1332);class ip extends Lt{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb){super(b,h,A,aa,oa,Ja,fb);this.Bsh=!1;this.jSe=this.Hda=null;this.Kx=(Gb,Sb,pc,zc,Yc)=>{if(!this.LQ(Sb))return 8;if(1===pc)return this.pj.p7?2:32;Gb=parseInt(Yc);v.ULS.sendTraceTag(593372312,
322,50,"SetPictureStyle: "+Gb);this.XKd.Bio(Sb,Uc.ImageReader.Kn(Sb),Gb);this.ibd(Sb);this.tPa();return 32};this.$te=(Gb,Sb,pc)=>{if(!this.LQ(Sb))return 8;v.ULS.sendTraceTag(593372311,322,50,"Applying Style Reset");Gb=Uc.ImageReader.Kn(Sb);if(1===pc)return this.pj.p7?2:32;pc=Uc.ImageReader.d9a(Gb);pc===xt.a.adb?(pc=new Rb.GraphTransaction(15),pc.Bb(Sb.node),Uc.ImageReader.Ymc()?Gb.setValue(Mc.a.hXb,""):this.EM.gvo(Gb),pc.dispose(),this.GNc.create(Gb,Sb).Kx(Mj.a.LEj),this.ibd(Sb)):pc===xt.a.aQh&&this.GNc.create(Gb,
Sb).Kx(Mj.a.LEj);return 32};this.$Sm=(Gb,Sb,pc,zc,Yc)=>{if(!this.LQ(Sb))return 8;Gb=Uc.ImageReader.Kn(Sb);if(1===pc)return this.pj.p7||Uc.ImageReader.Fnc(Gb)?2:32;Yc&&(this.EM.brd(Gb,Sb),v.ULS.sendTraceTag(22381021,322,50,"Toggled Image Crop Mode"),qa.StaticActiveAppFrame.za().Fe());this.tPa();return 32};this.aTm=(Gb,Sb,pc,zc,Yc)=>{var Kd;if(!this.LQ(Sb))return 8;if(1===pc)return this.pj.p7?2:32;Gb=Uc.ImageReader.Kn(Sb);if(Yc){pc=Uc.ImageReader.mce(Uc.ImageReader.Kn(Sb));v.ULS.sendTraceTag(22381022,
322,50,"Applying New Image Cropping, isCanvas: "+pc);zc=Yc.ka(pd.a.Srb,0);const ge=Yc.ka(pd.a.Prb,0),de=Yc.ka(pd.a.Qrb,0);Yc=Yc.ka(pd.a.Rrb,0);var ke=Uc.ImageReader.ifa(Gb);const Sd=ke.bottom,be=ke.left,Rf=ke.right;if(zc===ke.top&&ge===Sd&&de===be&&Yc===Rf)return v.ULS.sendTraceTag(23070480,322,50,"Cropping Properties were the same as before, no need to update."),32;if(Object(Ui.d)(Gb)&&(ke=null===(Kd=w())||void 0===Kd?void 0:Kd.NIa(),(new BA(Gb,Sb.node,ke,new gC,z(),new bn.b)).yra({top:.001*zc,bottom:.001*
ge,left:.001*de,right:.001*Yc})))return 32;pc?(new XL.a(Gb,new YL.a,new bn.b)).sPo(zc,ge,de,Yc,this.STn,Sb):this.XKd.qio(Sb,Uc.ImageReader.Kn(Sb),zc,ge,de,Yc);this.ibd(Sb);qa.StaticActiveAppFrame.za().Fe()}return 32};this.C9d=(Gb,Sb,pc,zc,Yc)=>{if(!this.LQ(Sb))return 8;zc=Uc.ImageReader.Kn(Sb);if(1===pc)return this.pj.p7||Uc.ImageReader.Fnc(zc)?2:32;if(Yc){v.ULS.sendTraceTag(22552775,322,50,"Getting New Image Cropping From Spinners on Format Picture Pane");this.EM.NBa()||this.EM.brd(zc,Sb);switch(Gb){case Fc.a.i6c:Gb=
Yc.ka(pd.a.Srb,-1);pc=0;break;case Fc.a.f6c:Gb=Yc.ka(pd.a.Prb,-1);pc=1;break;case Fc.a.g6c:Gb=Yc.ka(pd.a.Qrb,-1);pc=2;break;case Fc.a.h6c:Gb=Yc.ka(pd.a.Rrb,-1);pc=3;break;default:return 8}this.EM.Wtp(Gb,pc);this.ibd(Sb);qa.StaticActiveAppFrame.za().Fe()}return 32};this.Cwb=(Gb,Sb,pc,zc,Yc)=>{if(!this.LQ(Sb))return 8;Uc.ImageReader.Kn(Sb);Yc&&(Gb=this.EM.NBa(),Yc.setValue(pd.a.NBa,Gb));return 32};this.Rtc=(Gb,Sb,pc,zc,Yc)=>{if(!this.LQ(Sb))return 8;Gb=Uc.ImageReader.Kn(Sb);if(Yc){if(this.EM.NBa())({top:Kd,
bottom:pc,left:Gb,right:Sb}=this.EM.Ulm());else{zc=Ah.a.xf(Uc.ImageReader.RB(Gb),0);var Kd=Ah.a.xf(Uc.ImageReader.$C(Gb),1);Sb=Uc.ImageReader.ifa(Gb);const ke=Math.max(Sb.top,0);pc=Math.max(Sb.bottom,0);Gb=Math.max(Sb.left,0);Sb=Math.max(Sb.right,0);zc=1E5*zc/(1E5-(Gb+Sb));const ge=1E5*Kd/(1E5-(ke+pc));Kd=Math.floor(ke*ge/1E5);pc=Math.floor(pc*ge/1E5);Gb=Math.floor(Gb*zc/1E5);Sb=Math.floor(Sb*zc/1E5)}Yc.setValue(pd.a.Srb,Kd);Yc.setValue(pd.a.Prb,pc);Yc.setValue(pd.a.Qrb,Gb);Yc.setValue(pd.a.Rrb,Sb)}return 32};
this.blc=(Gb,Sb,pc,zc,Yc)=>{if(!this.LQ(Sb))return 8;if(1===pc){if(this.pj.p7)return 2;this.yDn();return 32}Gb=Uc.ImageReader.Kn(Sb);this.EM.NBa()&&this.EM.brd(Gb,Sb);Gb=Yc.ka(pd.a.fOa,"");Yc=Yc.ka(pd.a.Mfb,0);v.ULS.sendTraceTag(20459970,322,50,"SetWrapTextAction: {0}",{["Type"]:Yc,["SourceControlId"]:Gb});switch(Yc){case 1:this.EM.BWo(Sb);break;case 8:this.EM.zxe(Sb,ku.a.C0b,1);break;case 9:this.EM.zxe(Sb,ku.a.C0b,3);break;case 3:this.EM.zxe(Sb,ku.a.none,void 0,!0);break;case 4:this.EM.zxe(Sb,ku.a.none,
void 0,!1)}this.tPa();qa.StaticActiveAppFrame.za().Fe();return 32};this.iuc=(Gb,Sb,pc,zc,Yc)=>{if(!this.LQ(Sb))return 8;Gb=Uc.ImageReader.Kn(Sb);Sb=Uc.ImageReader.t7(Sb);pc=Uc.ImageReader.c3(Gb);zc=Uc.ImageReader.Hkc(Gb);Gb=Uc.ImageReader.Sy(Gb);return this.oio(Sb,pc,zc,Gb,Yc)?32:8};this.cTm=(Gb,Sb,pc,zc,Yc)=>{var Kd;if(!this.Lqa(Sb))return 8;zc=Uc.ImageReader.Kn(Sb);if(1===pc)return ec.SessionStatusManager.instance.Hk?8:this.pj.p7||Uc.ImageReader.Gnc(zc)?2:32;this.EM.NBa()&&this.EM.brd(zc,Sb);if(Yc){const ge=
Yc.ka(pd.a.p6c,0),de=Uc.ImageReader.mce(zc);v.ULS.sendTraceTag(22052889,322,50,"SetImageRotateAction: {0}, isCanvas: {1}",ge,de);pc=Uc.ImageReader.L2(zc);var ke=Uc.ImageReader.vsa(zc);let Sd=ke.Apb;ke=ke.OJa;switch(ge){case 0:pc=Yc.ka(pd.a.lX,0);break;case 2:pc-=90;pc=Ql.e(pc);break;case 1:pc+=90;pc=Ql.e(pc);break;case 4:Sd=!Sd;break;case 3:ke=!ke;break;case 5:pc+=Yc.ka(pd.a.lX,0),pc=Ql.e(pc)}if(Object(Ui.d)(zc))if(Yc=null===(Kd=w())||void 0===Kd?void 0:Kd.NIa(),Kd=new BA(zc,Sb.node,Yc,new gC,z(),
new bn.b),4===ge){if(Kd.flip(!0,!1))return 32}else if(3===ge){if(Kd.flip(!1,!0))return 32}else if(Kd.rotate(pc))return 32;de?(new XL.a(zc,new YL.a,new bn.b)).YUo(pc,Sd,ke,this.c_n,Sb):ge?this.GNc.create(zc,Sb).bUo(pc,Sd,ke):(Kd=kb.a.create(),Yc=new Rb.GraphTransaction(15,ub.a.Vaa),Yc.Bb(Sb.node),this.EM.ORo(zc,pc),this.XKd.xio(Sb,Uc.ImageReader.Kn(Sb),pc,Kd),Yc.TLa(Kd,1),Yc.Ii=Gb,Yc.dispose());this.tPa();this.ibd(Sb);qa.StaticActiveAppFrame.za().Fe()}return 32};this.ZXb=(Gb,Sb,pc,zc,Yc)=>{if(!this.LQ(Sb))return 8;
Gb=Uc.ImageReader.Kn(Sb);Gb=Uc.ImageReader.L2(Gb);if(0>Gb)return 2;Yc.setValue(pd.a.lX,Gb);return 32};this.c_n=(Gb,Sb,pc,zc)=>{if(Gb){const Yc=new Rb.GraphTransaction(15,ub.a.Vaa);Yc.Bb(zc.node);Sb.setValue(pd.a.fLb,JSON.stringify(pc));Sb.setValue(pd.a.Cu,Gb);this.EM.Hwe(Sb,pc.rotationAngle,pc.Alc,pc.JAc);this.KOb(Sb);Yc.dispose()}};this.KZn=(Gb,Sb,pc,zc)=>{if(Gb){const Yc=new Rb.GraphTransaction(15);Yc.Bb(zc.node);Sb.setValue(pd.a.fLb,JSON.stringify(pc));Sb.setValue(pd.a.Cu,Gb);this.EM.owe(Sb,pc.rDe,
pc.bsd);this.KOb(Sb);Yc.dispose()}};this.STn=(Gb,Sb,pc,zc)=>{if(Gb){const Yc=new Rb.GraphTransaction(15);Yc.Bb(zc.node);Sb.setValue(pd.a.fLb,JSON.stringify(pc));Sb.setValue(pd.a.Cu,Gb);this.EM.IRo(Sb,Math.round(pc.SIa*KK.a.Unb),Math.round(pc.PIa*KK.a.Unb),Math.round(pc.QIa*KK.a.Unb),Math.round(pc.RIa*KK.a.Unb));this.KOb(Sb);Yc.dispose()}};this.Lgd=(Gb,Sb,pc,zc,Yc)=>{if(!this.Lqa(Sb))return 8;if(1===pc)return 32;Gb=this.Ip(Sb);if(!Gb)return 8;pc=Uc.ImageReader.Kn(Sb);Object(Ui.d)(pc)?(Sb=LK.d4c(pc),
void 0===Sb?Sb=ip.ugd.gca="":void 0!==Sb.ENa?(Sb=(new LK).HLm(Sb),ip.ugd.gca=Sb,Sb=""):Sb=ip.ugd.gca=Sb.gld):(Sb=this.Dp.RCi(Gj.a.ZW(Sb),pc),ip.ugd.gca=Sb);this.HP&&this.HP.kAc(Sb);Sb=ip.ugd.Opb(Gb,df.a.VTa);if(!Sb)return 8;Yc.MenuItems=Sb;return 32};this.e4=(Gb,Sb,pc,zc,Yc)=>{if(!this.Lqa(Sb))return 8;zc=Uc.ImageReader.Kn(Sb);if(Object(Ui.d)(zc)){if(!Uc.ImageReader.nmf(zc))return 2}else if(zc&&Uc.ImageReader.Vz(zc))return 2;if(1===pc)return 32;if(2!==pc)return 2;if(!Yc)return v.ULS.sendTraceTag(571287758,
322,10,"SetPictureBorderColor: actionData null"),8;if(Object(Ui.d)(zc)){if(!this.Cic.e4(zc,Sb.node,Yc))return 8}else{pc=new Rb.GraphTransaction(15);pc.Bb(Sb.node);const Kd=ip.Nva.Qja(Sb.node,Yc);this.Dp.e4(zc,Yc,Sb,Kd);this.KOb(zc);pc.dispose()}Gb==ub.a.rnd&&this.HP.gTa(Yc);this.dvd();this.tPa();return 32};this.E3=(Gb,Sb,pc)=>{if(!this.Lqa(Sb))return 8;if(1===pc)return 32;qa.StaticActiveAppFrame.za().dismissFloatie();ip.rFa=new Xt("PictureBorder",ub.a.rnd);ip.rFa.zyb(0);return 32};this.qca=(Gb,Sb,
pc,zc,Yc)=>{if(!this.Lqa(Sb))return 8;if(1===pc)return 32;Gb=Uc.ImageReader.Kn(Sb);if(Object(Ui.d)(Gb)){if(!Uc.ImageReader.nmf(Gb))return 2}else if(Gb&&Uc.ImageReader.Vz(Gb))return 2;if(!Yc)return v.ULS.sendTraceTag(571287759,322,10,"SetPictureBorderWeight: actionData null"),8;if(Object(Ui.d)(Gb)){if(!this.Cic.qca(Gb,Sb.node,Yc))return 8}else pc=new Rb.GraphTransaction(15),pc.Bb(Sb.node),this.Dp.qca(Gb,Yc,Sb),this.KOb(Gb),pc.dispose();this.dvd();this.tPa();return 32};this.Tdb=(Gb,Sb,pc,zc,Yc)=>{if(!this.Lqa(Sb))return 8;
if(1===pc)return 32;Gb=Uc.ImageReader.Kn(Sb);if(Object(Ui.d)(Gb)){if(!Uc.ImageReader.nmf(Gb))return 2}else if(Gb&&Uc.ImageReader.Vz(Gb))return 2;if(!Yc)return v.ULS.sendTraceTag(571287760,322,10,"SetPictureBorderStyle: actionData null"),8;if(Object(Ui.d)(Gb)){if(!this.Cic.$To(Gb,Sb.node,Yc))return 8}else pc=new Rb.GraphTransaction(15),pc.Bb(Sb.node),this.Dp.Tdb(Gb,Yc,Sb),this.KOb(Gb),pc.dispose();this.dvd();this.tPa();return 32};this.Euc=(Gb,Sb,pc)=>{if(!this.Lqa(Sb))return 8;if(1===pc)return 32;
Gb=Uc.ImageReader.Kn(Sb);if(Object(Ui.d)(Gb)){if(!this.Cic.Euc(Gb,Sb.node))return 8}else pc=new Rb.GraphTransaction(15),pc.Bb(Sb.node),Uc.ImageReader.klc(Gb)&&(this.Dp.Euc(Gb),this.KOb(Gb)),pc.dispose();this.dvd();this.tPa();return 32};this.EM=b;this.GNc=r;this.XKd=M;ip.hi=Cb;null===oa||void 0===oa?void 0:oa.tA(ip.sil)}get HP(){return null!=this.U1g?this.U1g:this.U1g=Za.a.instance.Oa(788)}static sil(){ip.b9n()}get Dp(){this.Hda||(this.Hda=new sN.a);return this.Hda}get Cic(){this.jSe||(this.jSe=new LK);
return this.jSe}Xb(b){super.Xb(b);this.ks(b,ub.a.Kx,this.Kx);b.Pc(ub.a.Kx,4);this.ks(b,ub.a.$te,this.$te);this.ks(b,Fc.a.WFe,this.blc);b.Pc(Fc.a.WFe,4);this.ks(b,Fc.a.XFe,this.blc);this.ks(b,Fc.a.YFe,this.blc);this.ks(b,Fc.a.ZFe,this.blc);this.ks(b,Fc.a.$Fe,this.blc);this.ks(b,Fc.a.aGe,this.blc);this.ks(b,Fc.a.iuc,this.iuc);b.Pc(Fc.a.iuc,101);this.ks(b,Fc.a.e6c,this.$Sm);b.Pc(Fc.a.e6c,4);this.ks(b,Fc.a.Cwb,this.Cwb);b.Pc(Fc.a.Cwb,101);this.ks(b,Fc.a.DOi,this.aTm);this.ks(b,Fc.a.i6c,this.C9d);this.ks(b,
Fc.a.f6c,this.C9d);this.ks(b,Fc.a.g6c,this.C9d);this.ks(b,Fc.a.h6c,this.C9d);this.ks(b,Fc.a.Mhd,this.Rtc);b.Pc(Fc.a.Mhd,101);this.ks(b,Fc.a.Jqe,this.Rtc);b.Pc(Fc.a.Jqe,101);this.ks(b,Fc.a.Kqe,this.Rtc);b.Pc(Fc.a.Kqe,101);this.ks(b,Fc.a.Lqe,this.Rtc);b.Pc(Fc.a.Lqe,101);this.ks(b,ub.a.Vaa,this.cTm);b.Pc(ub.a.Vaa,4);this.ks(b,ub.a.ZXb,this.ZXb);b.Pc(ub.a.ZXb,101);this.ks(b,ub.a.Lgd,this.Lgd);b.Pc(ub.a.Lgd,4);this.ks(b,ub.a.e4,this.e4);b.Pc(ub.a.e4,4);this.ks(b,ub.a.rnd,this.e4);b.Pc(ub.a.rnd,4);this.ks(b,
ub.a.Ugg,this.E3);b.Pc(ub.a.Ugg,4);this.ks(b,ub.a.jDa,this.jDa.bind(this));b.Pc(ub.a.jDa,4);this.ks(b,ub.a.qca,this.qca);b.Pc(ub.a.qca,4);this.ks(b,ub.a.aYb,this.aYb.bind(this));b.Pc(ub.a.aYb,4);this.ks(b,ub.a.Tdb,this.Tdb);b.Pc(ub.a.Tdb,4);this.ks(b,ub.a.$ag,this.Euc);b.Pc(ub.a.$ag,4)}zxf(b,h,r,A){var M;v.ULS.sendTraceTag(593372313,322,50,"Applying New Image Resize, isCanvas: "+Uc.ImageReader.mce(b));this.EM.NBa()&&this.EM.brd(b,h);if(Object(Ui.d)(b)){const aa=null===(M=w())||void 0===M?void 0:M.NIa();
if((new BA(b,h.node,aa,new gC,z(),new bn.b)).resize(r,A))return}Uc.ImageReader.Vz(b)?(b=kb.a.create(),M=new Rb.GraphTransaction(15),M.Bb(h.node),this.XKd.wio(h,Uc.ImageReader.Kn(h),r,A,b),M.TLa(b,1),M.dispose()):Uc.ImageReader.bxc(b)?(new XL.a(b,new YL.a,new bn.b)).GUo(r,A,this.KZn,h):(super.zxf(b,h,r,A),this.Od.Yu(13))}LQ(b){if(!b.Al)return!1;var h=b.node;return(h=Object(Ui.c)()?h instanceof pr.a||h instanceof zO.a?h:null:Object(ya.a)(pr.a,h))&&Vv.n(h)?(Lt.Dc.$b(wO.a.Nn,{["Reason"]:ns.a.QQ}),!1):
super.LQ(b)}static b9n(){ip.cGb||(ip.hi.E5a(ip.ivb),ip.cGb=!0)}oio(b,h,r,A,M){return M?(M.DXi=b,M.c3=h,M.xzb=r,M.Ax=A,M.Mfb=ip.rPm(M),!0):!1}ibd(b){Of.a.ud().Co&&Of.a.ud().Ak.xG(b.node)}yDn(){this.Bsh||(v.ULS.sendTraceTag(20459971,322,50,"Wrap Text UI enabled."),this.Bsh=!0)}KOb(b){const h=yO.a.instance.EAf(b);this.EM.Fwe(b,h[Zi.a.left],h[Zi.a.right],h[Zi.a.top],h[Zi.a.bottom])}Ip(b){return b.contextId===lc.a.view?Um.PageReader.instance.ZPb(b):Object(vo.a)().Iu(b.node)}jDa(b,h,r,A,M){if(!this.Lqa(h))return 8;
2===r&&(b=Uc.ImageReader.Kn(h),Object(Ui.d)(b)?this.Cic.Uhp(M,b):this.Dp.$hk(M,b));return 32}aYb(b,h,r,A,M){if(!this.Lqa(h))return 8;2===r&&(b=Uc.ImageReader.Kn(h),Object(Ui.d)(b)?this.Cic.Thp(M,b):this.Dp.Zhk(M,b));return 32}dvd(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("PictureBorderFloodgateSurveyIsEnabled")&&window.setTimeout(()=>{const b=Za.a.instance.Ra(2);b&&b.execute(h=>{h.logActivity("PictureBorderApplied","PictureBorderFloodgateSurveyIsEnabled")})},5E3)}static get Nva(){return null!=
ip.k4g?ip.k4g:ip.k4g=Ep.a.instance}static get ugd(){ip.mJ||(ip.mJ=new os("PictureBorder"),ip.Ffa(ip.mJ));return ip.mJ}static rPm(b){if(b.DXi)b=1;else switch(b.xzb){case ku.a.none:b=b.c3?3:4;break;case ku.a.C0b:b=1===b.Ax?8:3===b.Ax?9:2;break;case ku.a.V_j:b=5;break;case ku.a.c_j:b=6;break;case ku.a.XZj:b=7;break;default:b=0}return b}static Ffa(b){b.BG(3,ub.a.e4);b.BG(4,ub.a.e4);b.BG(5,ub.a.rnd);b.BG(6,ub.a.e4);b.C5a(iw.a.instance,1)}}ip.cGb=!1;ip.mJ=null;ip.rFa=null;ip.ivb=()=>{ip.hi.Juc(ip.ivb);
ip.cGb=!1;if(hh.c()){var b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Picture")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Picture"))}else v.ULS.sendTraceTag(509445760,322,50,"appChrome is undefined")};Object(u.a)(ip,"ImageActor",Lt,[]);class Gm{static get nl(){return null!=Gm.n1g?Gm.n1g:Gm.n1g=Za.a.instance.resolve(348)}static get cC(){return null!=Gm.y1g?Gm.y1g:Gm.y1g=Za.a.instance.resolve(17)}static get M3(){return Gm.nl.ir}static get Yg(){return null!=
Gm.l5g?Gm.l5g:Gm.l5g=Za.a.instance.resolve(50)}static Xb(){const b=y.AFrameworkApplication.va;b.qa(ub.a.MXb,lc.a.view,Jn.a.qx);b.qa(ub.a.MXb,lc.a.paragraph,Gm.Eqa);b.Pc(ub.a.MXb,1036);b.qa(ub.a.YMb,lc.a.view,Jn.a.qx);b.qa(ub.a.YMb,lc.a.paragraph,Gm.Eqa);b.Pc(ub.a.YMb,1036);b.qa(ub.a.kob,lc.a.view,Jn.a.qx);b.qa(ub.a.kob,lc.a.paragraph,Gm.Eqa);b.Pc(ub.a.kob,1036);b.qa(ub.a.Buc,lc.a.view,Jn.a.qx);b.qa(ub.a.Buc,lc.a.paragraph,Gm.Eqa);b.Pc(ub.a.Buc,1036);b.qa(ub.a.Mjd,lc.a.view,Jn.a.qx);b.qa(ub.a.Mjd,
lc.a.paragraph,Gm.Eqa);b.Pc(ub.a.Mjd,1036);b.qa(ub.a.h$a,lc.a.view,Jn.a.qx);b.qa(ub.a.h$a,lc.a.paragraph,Gm.Eqa);b.Pc(ub.a.h$a,1036);b.qa(ub.a.Xrb,lc.a.view,Jn.a.qx);b.qa(ub.a.Xrb,lc.a.paragraph,Gm.Eqa);b.Pc(ub.a.Xrb,1036);b.qa(ub.a.g$a,lc.a.view,Jn.a.qx);b.qa(ub.a.g$a,lc.a.paragraph,Gm.Eqa);b.Pc(ub.a.g$a,1036);b.qa(ub.a.Jwe,lc.a.view,Gm.Gze);b.qa(ub.a.Jwe,lc.a.paragraph,Gm.Gze);b.Pc(ub.a.Jwe,1028);b.qa(ub.a.Gyg,lc.a.view,Gm.Gze);b.qa(ub.a.Gyg,lc.a.paragraph,Gm.Gze);b.Pc(ub.a.Gyg,1028);b.qa(ub.a.E_b,
lc.a.view,Jn.a.qx);b.qa(ub.a.E_b,lc.a.paragraph,Gm.Eqa);b.Pc(ub.a.E_b,1036);b.qa(ub.a.hyb,lc.a.view,Jn.a.qx);b.qa(ub.a.hyb,lc.a.paragraph,Gm.Eqa);b.Pc(ub.a.hyb,1036);b.qa(ub.a.F_b,lc.a.view,Jn.a.qx);b.qa(ub.a.F_b,lc.a.paragraph,Gm.Eqa);b.Pc(ub.a.F_b,1036);b.qa(ub.a.DDg,lc.a.view,Jn.a.qx);b.Pc(ub.a.DDg,1028);b.qa(ub.a.Cnd,lc.a.view,Jn.a.qx);b.qa(ub.a.Cnd,lc.a.paragraph,Gm.Eqa);b.Pc(ub.a.Cnd,1036);b.qa(ub.a.Dnd,lc.a.view,Jn.a.qx);b.qa(ub.a.Dnd,lc.a.paragraph,Gm.Eqa);b.Pc(ub.a.Dnd,1036)}static Gze(b,
h,r,A,M){2===r&&""===M[ui.a.Text]&&(b=b===ub.a.Jwe?ub.a.h$a:ub.a.g$a,h=new RB.a,h.value=0,h.unit=df.a.rLa?2:1,y.AFrameworkApplication.va.Pb(b,2,h),qa.StaticActiveAppFrame.za().Fe());return 32}static Eqa(b,h,r,A,M){if(!({Iz:r}=Jn.a.VAg(r,h)).returnValue)return r;h=h.node;switch(b){case ub.a.MXb:Gm.M3.ymg(h,!0);break;case ub.a.YMb:Gm.M3.ymg(h,!1);break;case ub.a.kob:Gm.M3.kob(h);break;case ub.a.Buc:Gm.M3.aha(h,0);break;case ub.a.Mjd:Gm.M3.Uxb(h,0);break;case ub.a.Xrb:case ub.a.h$a:r=new vd.a;r.set(h);
r.vb(11);let aa=M.value;M=M.unit;b===ub.a.Xrb&&(aa=(new et.a(M,aa)).Ou+Gm.cC.jI(h).Ou,M=1);Gm.M3.TDa(r,M,aa);break;case ub.a.g$a:Gm.M3.Wxb(h,M.unit,M.value);break;case ub.a.E_b:M?(b=(new et.a(M.unit,M.value)).Ou,Gm.M3.aha(h,b)):Gm.cC.F5d(h).Ou||Gm.M3.aha(h,gm.OutlineReader.q_(h));break;case ub.a.hyb:M?(b=(new et.a(M.unit,M.value)).Ou,Gm.M3.Uxb(h,b)):Gm.cC.jI(h).Ou||Gm.M3.Uxb(h,gm.OutlineReader.q_(h));break;case ub.a.F_b:Gm.M3.aha(h,0);break;case ub.a.Cnd:b=M;b=(new et.a(b.unit,b.value)).Ou;Gm.M3.xzg(h,
1,b);break;case ub.a.Dnd:b=M,b=(new et.a(b.unit,b.value)).Ou,Gm.M3.xzg(h,2,b)}Gm.Yg.pI();A&&jt.a.tzb&&(A.Bt|=jt.a.nqb(h));return 32}}Object(u.a)(Gm,"IndentationActor",null,[]);var tN=d(385),AO=d(67),MK=d(424),BO=d(1010);class kq{constructor(b){this.G3a=this.wHa=this.ILc=null;this.uJh=!1;this.Wpe=h=>{if(this.wHa)if(h===Ka.a.Vpe)Cd.FocusManager.instance().getRegion(id.AFrame.zcb).Vqc();else if(h===Ka.a.Upe)Cd.FocusManager.instance().getRegion(id.AFrame.zcb).Tqc();else return 2;else return 2;return 32};
this._frame=b}n$o(){if(this.uJh)this.K4i();else{const b=ob.a.create(y.AFrameworkApplication.J.ib("WopiBootstrapUrl"));b.a2((h,r)=>{r.succeeded?(this.uJh=!0,this.K4i()):v.ULS.sendTraceTag(40436806,323,10,"Failed to download word.boot.js")});pb.a.l_(b)}}K4i(){if(this.ILc)v.ULS.sendTraceTag(38130908,323,10,"previewPanel: Tried to launch while already running");else{const b=this._frame.dwa;this.wHa=document.createElement("div");b.parentNode.insertBefore(this.wHa,b);this.G3a=previewPanel.FactoryGlobal.getWordDocumentPanel(this,
{fileName:y.AFrameworkApplication.J.ib("FileName"),reactRoot:this.wHa});this.G3a.setWebpackPublicPath(y.AFrameworkApplication.I8);this.G3a.renderDocumentPanel()}}Aum(b){const h={};h.Container=b;h.BootstrapperUrl=y.AFrameworkApplication.J.ib("WopiBootstrapUrl");h.ApplicationUrl=this._frame.qAb;b={};b.HostName=y.AFrameworkApplication.J.ib("FileSource");b.HostSessionId=y.AFrameworkApplication.J.ib("HostSessionId");b.UserId=y.AFrameworkApplication.J.ib("UserId");b.DocumentClickTime=new Date(this._frame.Aub);
b.SessionContext="";b.WdParams={};h.SessionInformation=b;b={};b.FileName=y.AFrameworkApplication.J.ib("FileName");b.FileGetUrl="";b.ReadOnly=!1;b.BundleInfo={MajorVersion:1,Url:""};h.WopiPrecheckInfo=b;h.ApplicationCustomSettings={WopiFallbackEnabled:!0,appFrameName:"PreviewPanelApplicationFrame",IsCore:!0,InAppDocumentPreview:!0};b={entryPoint:"WordEditorPreviewPanel"};b.userClickTime=this._frame.Aub;h.Diagnostics=b;b={};b.WopiSrc=y.AFrameworkApplication.J.ib("WopiSrc");b.AccessToken=y.AFrameworkApplication.J.ib("AccessToken");
b.AccessTokenTtl=y.AFrameworkApplication.J.ib("AccessTokenTtl");h.WopiInfo=b;h.FnOnInitializeSuccess=r=>{kq.JZ=r;this.G3a.setMaxPage(kq.JZ.GetPageCount());this.G3a.setCurrentPage(kq.JZ.GetCurrentPage());this.G3a.setPageControlVisible(!0);kq.JZ.RegisterEventHandler("PageChanged",A=>{this.G3a.setCurrentPage(A.newPage)});kq.JZ.RegisterEventHandler("BrowserEvent",A=>{27===A.keyCode?this.closeViewer():A.button&&1!==A.button||this.wHa.click()});r=this._frame.Aub-(new Date).getTime();v.ULS.sendTraceTag(38355488,
323,50,"previewPanel: Load finished - {0}",r);this.Xb();Cd.FocusManager.instance().HN(id.AFrame.zcb,!0);this.buildFocusRegion();this.fNa(Cd.FocusManager.instance().ie(id.AFrame.zcb));this.wHa.click()};h.FnOnInitializeFailure=(r,A)=>{v.ULS.sendTraceTag(38273185,323,10,"previewPanel: {1}: {0}",r.toString(),A.toString());this.closeViewer()};return h}buildFocusRegion(){const b=Cd.FocusManager.instance();var h=b.getRegion(id.AFrame.zcb);h=[2,3];const r=b.ie(id.AFrame.zcb),A=new Re.DOMFocusListing(()=>
this.wHa);A.$ma=!0;for(const M of h)A.Yn(M);h=b.Vqa(()=>this.wHa,r,A);h.AZa();h.NR=!0;h.K6a=!0;A.hA(A.Jka)}Xb(){y.AFrameworkApplication.va.qa(Ka.a.Vpe,we.a.frame,this.Wpe);y.AFrameworkApplication.va.qa(Ka.a.Upe,we.a.frame,this.Wpe)}fNa(b){b.nt(Cd.FocusManager.instance().xZ);b.nt(Cd.FocusManager.instance().yZ);b.bindAction(Cd.FocusManager.instance().xZ,Ka.a.Vpe);b.bindAction(Cd.FocusManager.instance().yZ,Ka.a.Upe)}loadViewer(b){b=this.Aum(b);this.ILc=Microsoft.Office.Word.Viewer.InitializeWopiPending(b);
this.ILc.Complete(b.WopiInfo)}closeViewer(){Cd.FocusManager.instance().$U(id.AFrame.zcb);kq.JZ&&(kq.JZ.Dispose(),kq.JZ=null,y.AFrameworkApplication.va.vy(Ka.a.Vpe,we.a.frame,this.Wpe),y.AFrameworkApplication.va.vy(Ka.a.Upe,we.a.frame,this.Wpe));this.ILc&&(this.wHa.parentNode.removeChild(this.wHa),this.wHa=this.ILc=null)}printAction(){v.ULS.sendTraceTag(38355489,323,50,"previewPanel: Print Called");y.AFrameworkApplication.va.Ob(ub.a.print,2)}downloadPdfAction(){v.ULS.sendTraceTag(38355490,323,50,"previewPanel: Download to PDF Called");
y.AFrameworkApplication.va.Ob(Fc.a.YYc,2)}downloadCopyAction(){v.ULS.sendTraceTag(38355491,323,50,"previewPanel: Download Copy Called");y.AFrameworkApplication.va.Ob(Ka.a.Pea,2)}zoomInAction(){if(kq.JZ){let b=kq.JZ.GetZoomLevel();b+=.2;kq.JZ.SetZoomLevel(b)}}zoomOutAction(){if(kq.JZ){let b=kq.JZ.GetZoomLevel();b-=.2;kq.JZ.SetZoomLevel(b)}}setPage(b){if(kq.JZ){const h=kq.JZ.GetPageCount();1>b?(kq.JZ.SetCurrentPage(1),this.G3a.setCurrentPage(1)):1<=b&&b<=h?kq.JZ.SetCurrentPage(b):(kq.JZ.SetCurrentPage(h),
this.G3a.setCurrentPage(h))}}static getInstance(b){kq.S3e||(kq.S3e=new kq(b));return kq.S3e}}kq.JZ=null;kq.S3e=null;Object(u.a)(kq,"PreviewPanelActor",null,[]);class yo{static get X9j(){return null!=yo.F5g?yo.F5g:yo.F5g=y.AFrameworkApplication.J.ib("ClassicViewModePreferenceCookieName")}static get Bg(){return null!=yo.$Sg?yo.$Sg:yo.$Sg=Za.a.instance.Oa(114)}static Xb(b,h){b.fb(ub.a.readingMode,we.a.frame,yo.vak,128);b.qa(ub.a.KAe,we.a.frame,yo.vak);yo.nO=h;b.qa(Fc.a.Rve,we.a.frame,yo.Rve);b.fb(Fc.a.pre,
we.a.frame,yo.pre,96);b.qa(Fc.a.sge,we.a.frame,yo.sge);b.fb(Fc.a.wng,we.a.frame,yo.wng,96);yo.Bg.Ohc&&yo.nO.mcc(yo.zrc)}static vak(b,h,r){if(h.contextId!==we.a.frame)return 2;h=$l.a.Mm;switch(b){case ub.a.readingMode:if(!h.qAb)return 8;if(1===r)return ec.SessionStatusManager.instance.Hk?8:32;b=(new Date).getTime();Hk.a.instance.voo(b);h.Aub=b;y.AFrameworkApplication.J.$("InAppDocumentPreviewIsEnabled")?hv.a.fU(cC.a.m8f,!0,yo.bco,null,h):hv.a.fU(cC.a.m8f,!0,yo.Iej,null,h);return 32;case ub.a.KAe:return 32;
default:return 2}}static Iej(b){MK.a()?yo.SNm(b):yo.$Xj(b)}static SNm(b){const h={};h[F.a.nSf]=yo.X9j;y.AFrameworkApplication.qN().execute(r=>{r.Xu(C.a.oSf);r.ppp(C.a.oSf);r.sD(C.a.oSf,A=>{yo.Wll(A,b)});r.sendMessage(C.a.Gsm,h)})}static Wll(b,h){b.Values[F.a.nSf]===yo.X9j&&("true"===b.Values[F.a.RNi]?yo.$Xj(h):(yo.Gsp(),yo.Pcp()))}static Gsp(){if("View"!==appChrome.selectors.getModeSwitcherMode()){const b={activeMode:"View"};y.AFrameworkApplication.vd("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)?appChrome.dispatchUpdateAppModeAndTabsAction(b):appChrome.api.dispatch(appChrome.actions.updateModeSwitcher(b))}}static Pcp(){y.AFrameworkApplication.ow=!0;qa.StaticActiveAppFrame.za().K8(1);qa.StaticActiveAppFrame.za().kb.Bw&&qa.StaticActiveAppFrame.za().kb.Bw.gj&&qa.StaticActiveAppFrame.za().kb.Bw.iUf();y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ClassViewButtonBugFix",
!1)&&qa.StaticActiveAppFrame.za().Fe();BO.a.Y0j(y.AFrameworkApplication.J)}static $Xj(b){try{const h=new cb.a;let r,A;y.AFrameworkApplication.s$j?(r=df.a.hostUrl,A=3):(r=b.qAb,A=1);b.Aub&&h.add(y.AFrameworkApplication.n8f,b.Aub.toString());y.AFrameworkApplication.QWf&&h.add(y.AFrameworkApplication.crf,"1");y.AFrameworkApplication.smf&&h.add(y.AFrameworkApplication.Twl,"1");h.add(tN.a.DMg,tN.a.userSessionData);h.add(y.AFrameworkApplication.Ype,y.AFrameworkApplication.userSessionId);const M=y.AFrameworkApplication.J.ib(y.AFrameworkApplication.Uva);
M&&h.add(y.AFrameworkApplication.h3j,M);v.ULS.sendTraceTag(573095942,324,100,"Navigate to view mode");MK.b(y.AFrameworkApplication.J)?MK.d("view",h,MK.c):(r=$a.a.CMh(r,h),y.AFrameworkApplication.s$j?Le.a.un(r,Le.a.ewa(A),void 0,"AuthenticationLostDuringSession"):Le.a.openWindow(A,r,!1,void 0,AO.a.zCj))}catch(h){}}static bco(b){v.ULS.sendTraceTag(38355487,323,50,"previewPanel: init");(y.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("previewPanel"):Za.a.instance.resolve(77).JD.loadScript("previewPanel")).catch(()=>
{v.ULS.sendTraceTag(38130907,323,10,"previewPanel: Failed to download script");yo.Iej(b)}).then(()=>{kq.getInstance(b).n$o()})}static Rve(b,h,r){if(1===r)return 32;yo.nO.ELj(1===yo.nO.Kw?yo.Bg.v2f?3:0:1);qa.StaticActiveAppFrame.za().Fe();return 32}static pre(b,h,r,A,M){if(1===r)return 32;M[Vg.a.On]=1===yo.nO.Kw;return 32}static sge(b,h,r){if(1===r)return 32;yo.nO.ELj(2);qa.StaticActiveAppFrame.za().Fe();return 32}static zrc(b,h){2===h.jMa&&(b=qa.StaticActiveAppFrame.za(),b.K8(1),b.Fe())}static wng(){return yo.Bg.B_c?
32:8}}yo.nO=null;Object(u.a)(yo,"MainViewModeActor",null,[]);class CO{constructor(b,h,r){this.DFn=(A,M,aa,oa,Ja)=>1===aa?32:(A=this.ql.Paa(M.Ik))?(Ja=3===Ja.Wy,this.B9.value.q9h(this.sEm(A),this.xQb(A),Ja),32):2;this.ga=b;this.B9=h;this.ql=r}Xb(){this.ga.qa(Fc.a.j2f,lc.a.view,this.DFn);this.ga.fb(Fc.a.Pqe,lc.a.view,jm.d,96);this.ga.fb(Fc.a.Mqe,lc.a.view,jm.d,96);this.ga.fb(Fc.a.Nqe,lc.a.view,jm.d,96);this.ga.fb(Fc.a.Oqe,lc.a.view,jm.d,96);this.ga.qa(Fc.a.nfd,lc.a.view,jm.c);this.ga.qa(Fc.a.mfd,lc.a.view,
jm.c);this.ga.qa(Fc.a.Jne,lc.a.view,jm.c);this.ga.qa(Fc.a.Kne,lc.a.view,jm.c)}sEm(b){const h=new wg.DictionaryPropertySet;h.setValue(Mc.a.marginTop,this.ql.ysa(b));h.setValue(Mc.a.marginBottom,this.ql.OAa(b));h.setValue(Mc.a.marginLeft,this.ql.kN(b));h.setValue(Mc.a.marginRight,this.ql.lN(b));return h}xQb(b){const h=new wg.DictionaryPropertySet;h.setValue(Mc.a.np,this.ql.Gv(b));h.setValue(Mc.a.rw,this.ql.dD(b));return h}}Object(u.a)(CO,"MarginsDialogActor",null,[]);class uN{constructor(b){this.crd=
(h,r,A)=>{if(1===A)return 32;h=y.AFrameworkApplication.ua;if(!h)return 32;h.DSd();uN.MHo(h);return 32};this.ga=b}Xb(){this.ga.qa(Fc.a.crd,lc.a.view,this.crd)}static MHo(b){const h=y.AFrameworkApplication.J.ib("ModernUxExperimentPreferenceCookieName");var r=y.AFrameworkApplication.J.$("ModernUxExperimentDefaultOffIsEnabled");r=Jc.a.dfa(h,!r);Jc.a.UNa(h,(!r).toString(),Jc.a.XLa);r?v.ULS.sendTraceTag(576075457,340,50,"User is opting out of the modern ux experience"):v.ULS.sendTraceTag(576075458,340,
50,"User is opting in to the modern ux experience");ac.d(Fc.a.crd,!0,void 0,void 0,void 0,void 0,[Object.assign(new ia.a,{name:"ModernUxExperimentPreference",string:(!r).toString()})]);b.j8(null)}}Object(u.a)(uN,"ModernUxActor",null,[]);var DO=d(870),Yp=d(1781);class NK{constructor(b,h,r,A){this.uze=Jg.a.gD(1)/6;this.jUo=(M,aa,oa,Ja,fb)=>{if(1===oa)return 32;if(oa=this.tg.Paa(aa.Ik)){if(0<=fb&&fb<Yp.a.Q3.length){aa=new Rb.GraphTransaction(15);aa.Bb(oa);aa.Ii=M;M=Yp.a.Q3[fb].UFd;Ja=Yp.a.Q3[fb].SFd;
const Cb=Yp.a.Q3[fb]._marginLeft;fb=Yp.a.Q3[fb].TFd;this.moe(M,Ja,this.tg.dD(oa))&&this.moe(Cb,fb,this.tg.Gv(oa))?(this.wG.Pdb(oa,M),this.wG.Ndb(oa,Ja),this.wG.pna(oa,Cb),this.wG.Odb(oa,fb),this.Yd.Yu(11)):this.NNa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage);aa.dispose()}else return 2;return 32}v.ULS.sendTraceTag(520618525,3009,50,"wordSectionNode is null; context.nextContext = {0}",aa.Ik);return 2};this.kUo=(M,aa,oa,Ja,fb)=>{if(1===oa)return 32;if(oa=this.tg.Paa(aa.Ik)){if(0<=fb&&fb<Yp.a.Eua.length)aa=
new Rb.GraphTransaction(15),aa.Bb(oa),aa.Ii=M,M=(Ja=this.tg.V8c(oa))?Yp.a.Eua[fb].D3a:Yp.a.Eua[fb].E3a,fb=Ja?Yp.a.Eua[fb].E3a:Yp.a.Eua[fb].D3a,this.moe(this.tg.OAa(oa),this.tg.ysa(oa),fb)&&this.moe(this.tg.kN(oa),this.tg.lN(oa),M)?(this.wG.azg(oa,M),this.wG.$yg(oa,fb),this.Yd.Yu(11)):this.NNa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage),aa.dispose();else return 2;return 32}v.ULS.sendTraceTag(520618524,3009,50,"wordSectionNode is null; context.nextContext = {0}",aa.Ik);return 2};this.CTo=(M,
aa,oa,Ja,fb)=>{if(1===oa)return 32;if(oa=this.tg.Paa(aa.Ik)){aa=this.tg.V8c(oa);Ja=new Rb.GraphTransaction(15);Ja.Bb(oa);Ja.Ii=M;this.wG.KMj(oa,fb);if(fb&&!aa||!fb&&aa){M=this.tg.Gv(oa);fb=this.tg.dD(oa);this.wG.azg(oa,fb);this.wG.$yg(oa,M);M=this.tg.ysa(oa);fb=this.tg.OAa(oa);const Cb=this.tg.kN(oa),Gb=this.tg.lN(oa);aa?(this.wG.Pdb(oa,y.AFrameworkApplication.isRtl?Cb:Gb),this.wG.Ndb(oa,y.AFrameworkApplication.isRtl?Gb:Cb),this.wG.pna(oa,y.AFrameworkApplication.isRtl?fb:M),this.wG.Odb(oa,y.AFrameworkApplication.isRtl?
M:fb)):(this.wG.Pdb(oa,y.AFrameworkApplication.isRtl?Gb:Cb),this.wG.Ndb(oa,y.AFrameworkApplication.isRtl?Cb:Gb),this.wG.pna(oa,y.AFrameworkApplication.isRtl?Math.abs(M):fb),this.wG.Odb(oa,y.AFrameworkApplication.isRtl?fb:M));this.Yd.Yu(11)}Ja.dispose();return 32}v.ULS.sendTraceTag(520618523,3009,50,"wordSectionNode is null; context.nextContext = {0}",aa.Ik);return 2};this.sce=(M,aa,oa)=>{if(1===oa)return 1===this.jG.Kw?32:8};this.Pxb=(M,aa,oa,Ja,fb)=>{if(1===oa)return 32;oa=this.tg.Paa(aa.Ik);if(!oa)return v.ULS.sendTraceTag(520618522,
3009,50,"wordSectionNode is null; context.nextContext = {0}",aa.Ik),2;aa=new Rb.GraphTransaction(15);aa.Bb(oa);aa.Ii=M;M=Math.floor(this.tg.Gv(oa)/720);if(0>fb||fb>M)return 2;this.wG.f_b(oa,fb);this.kBd.execute(Cb=>{Cb.logActivity("WordWebColumnsActivity",null)});aa.dispose();return 32};this.iwe=(M,aa,oa,Ja,fb)=>{if(1===oa)return 32;oa=this.tg.Paa(aa.Ik);if(!oa)return v.ULS.sendTraceTag(520618521,3009,50,"wordSectionNode is null; context.nextContext = {0}",aa.Ik),2;aa=new Rb.GraphTransaction(15);
aa.Bb(oa);aa.Ii=M;M=fb[0];Ja=this.tg.Gv(oa);if(720>M||M>Ja)return 2;this.wG.kwc(oa,fb);this.kBd.execute(Cb=>{Cb.logActivity("WordWebColumnsActivity",null)});aa.dispose();return 32};this.hwe=(M,aa,oa,Ja,fb)=>{if(1===oa)return 32;oa=this.tg.Paa(aa.Ik);if(!oa)return v.ULS.sendTraceTag(520618520,3009,50,"wordSectionNode is null; context.nextContext = {0}",aa.Ik),2;aa=new Rb.GraphTransaction(15);aa.Bb(oa);aa.Ii=M;M=this.tg.Gv(oa);Ja=this.tg.Fh(oa);if(0>fb||fb>(M-720*Ja)/(Ja-1))return 2;this.wG.ZOo(oa,
fb);this.kBd.execute(Cb=>{Cb.logActivity("WordWebColumnsActivity",null)});aa.dispose();return 32};this.gwe=(M,aa,oa,Ja,fb)=>{if(1===oa)return 32;oa=this.tg.Paa(aa.Ik);if(!oa)return v.ULS.sendTraceTag(512370310,3009,50,"wordSectionNode is null; context.nextContext = {0}",aa.Ik),2;aa=new Rb.GraphTransaction(15);aa.Bb(oa);aa.Ii=M;if(null==fb)return 2;this.wG.AVo(oa,fb);this.kBd.execute(Cb=>{Cb.logActivity("WordWebColumnsActivity",null)});aa.dispose();return 32};this.YMa=(M,aa,oa,Ja,fb)=>{let Cb;try{Cb=
this.tg.Paa(aa.Ik)}catch(Gb){return v.ULS.sendTraceTag(508339925,3009,50,"context.nextContext = {0}",aa.Ik),2}if(Cb)return fb.marginTop=this.tg.ysa(Cb),fb.marginBottom=this.tg.OAa(Cb),fb.marginLeft=this.tg.kN(Cb),fb.marginRight=this.tg.lN(Cb),fb.np=this.tg.Gv(Cb),fb.rw=this.tg.dD(Cb),fb.RBa=this.tg.V8c(Cb),fb.HG=this.tg.Fh(Cb),fb.hra=this.tg.lqb(Cb),fb.Osl=this.tg.a8d(Cb),fb.UUb=this.Owm(fb),fb.OWb=this.oBm(fb),fb.lVc=this.Ajm(fb),32;v.ULS.sendTraceTag(520618519,3009,50,"wordSectionNode is null; context.nextContext = {0}",
aa.Ik);return 2};this.Vwe=(M,aa,oa,Ja,fb)=>{if(1===oa)return 32;if(oa=this.tg.Paa(aa.Ik)){aa=new Rb.GraphTransaction(15);aa.Bb(oa);switch(M){case ub.a.Pdb:this.wG.Pdb(oa,fb);break;case ub.a.Ndb:this.wG.Ndb(oa,fb);break;case ub.a.pna:this.wG.pna(oa,fb);break;case ub.a.Odb:this.wG.Odb(oa,fb)}this.Yd.Yu(11);aa.dispose();return 32}v.ULS.sendTraceTag(520618518,3009,50,"wordSectionNode is null; context.nextContext = {0}",aa.Ik);return 2};this.rNj=(M,aa,oa,Ja,fb)=>{if(1===oa)return 32;if(oa=this.tg.Paa(aa.Ik)){aa=
new Rb.GraphTransaction(15);aa.Bb(oa);let Cb=Ja=0;switch(M){case ub.a.czg:Cb=fb;this.wG.azg(oa,Cb);Ja=this.tg.dD(oa);break;case ub.a.bzg:Ja=fb,this.wG.$yg(oa,Ja),Cb=this.tg.Gv(oa)}this.wG.KMj(oa,Ja<Cb);this.Yd.Yu(11);aa.dispose();return 32}v.ULS.sendTraceTag(520618517,3009,50,"wordSectionNode is null; context.nextContext = {0}",aa.Ik);return 2};this.wG=b;this.Yd=h;this.jG=r;this.kBd=A}get tg(){return br.a.instance}Pwm(b){var h=df.a.aZf,r=h?1:3,A=y.AFrameworkApplication.numberFormat;let M=Yp.a.Q3[b].UFd;
var aa=Yp.a.Q3[b].SFd;var oa=Yp.a.Q3[b]._marginLeft;b=Yp.a.Q3[b].TFd;M=h?Jg.a.j0a(M):Jg.a.iB(M);aa=h?Jg.a.j0a(aa):Jg.a.iB(aa);oa=h?Jg.a.j0a(oa):Jg.a.iB(oa);b=h?Jg.a.j0a(b):Jg.a.iB(b);h=I.a.XJa(M,r,A);aa=I.a.XJa(aa,r,A);oa=I.a.XJa(oa,r,A);r=I.a.XJa(b,r,A);A={};A.top=h;A.bottom=aa;A.left=oa;A.right=r;return A}BFn(b){const h=WordRibbonStrings.PageMarginsTop,r=WordRibbonStrings.PageMarginsBottom,A=WordRibbonStrings.PageMarginsLeft,M=WordRibbonStrings.PageMarginsRight;b=this.Pwm(b);return[[h,b.top,r,b.bottom],
[A,b.left,M,b.right]]}Jfd(b){var h=df.a.aZf,r=h?1:3;const A=y.AFrameworkApplication.numberFormat;let M=Yp.a.Eua[b].D3a;b=Yp.a.Eua[b].E3a;M=h?Jg.a.j0a(M):Jg.a.iB(M);b=h?Jg.a.j0a(b):Jg.a.iB(b);h=I.a.XJa(b,r,A);r=I.a.XJa(M,r,A);return String.format(WoncaIntl.WoncaStrings.L_PageSizeDescription,h,r)}Xb(){const b=y.AFrameworkApplication.va;b.fb(ub.a.Qdb,lc.a.view,this.jUo,4);b.fb(ub.a.j_a,lc.a.view,this.kUo,4);b.fb(ub.a.setOrientation,lc.a.view,this.CTo,4);b.fb(ub.a.YMa,lc.a.view,this.YMa,96);b.qa(ub.a.Pdb,
lc.a.view,this.Vwe);b.qa(ub.a.Ndb,lc.a.view,this.Vwe);b.qa(ub.a.pna,lc.a.view,this.Vwe);b.qa(ub.a.Odb,lc.a.view,this.Vwe);b.qa(ub.a.czg,lc.a.view,this.rNj);b.qa(ub.a.bzg,lc.a.view,this.rNj);b.fb(ub.a.sce,lc.a.view,this.sce,4);b.qa(ub.a.Pxb,lc.a.view,this.Pxb);b.qa(ub.a.iwe,lc.a.view,this.iwe);b.qa(ub.a.hwe,lc.a.view,this.hwe);b.qa(ub.a.gwe,lc.a.view,this.gwe)}moe(b,h,r){return r>=b+h+df.a.SEa}Owm(b){let h=5;for(let r=0;r<Yp.a.Q3.length;r++)if(Yp.a.Q3[r].UFd===b.marginTop&&Yp.a.Q3[r].SFd===b.marginBottom&&
Yp.a.Q3[r]._marginLeft===b.marginLeft&&Yp.a.Q3[r].TFd===b.marginRight){h=r;break}return h}oBm(b){let h=5;b=new DO.a(Math.min(b.np,b.rw),Math.max(b.np,b.rw));for(let r=0;r<Yp.a.Eua.length;r++)if(this.X4n(b,Yp.a.Eua[r])){h=r;break}return h}Ajm(b){let h=0;switch(b.HG){case 1:h=1;break;case 2:h=2;break;case 3:h=3}return h}X4n(b,h){return $f.a.YTi(b.E3a,Math.max(h.E3a-this.uze,0),h.E3a+this.uze)&&$f.a.YTi(b.D3a,Math.max(h.D3a-this.uze,0),h.D3a+this.uze)}NNa(b){if(!af.a.UO){const h=new ni.StandardDialog;
h.Fd=0;h.jY(CommonUIStrings.l_DefaultDialogTitle,b,null)}}}Object(u.a)(NK,"PageActor",null,[491]);class OK{constructor(b){this.ga=b}get Rb(){return this.ga}Uwe(b,h){let r=0;b?1===b?r=ub.a.pna:2===b?r=ub.a.Odb:3===b&&(r=ub.a.Ndb):r=ub.a.Pdb;this.Rb.Pb(r,2,h)}j_a(b,h){let r=0;1===b?r=ub.a.bzg:b||(r=ub.a.czg);this.Rb.Pb(r,2,h)}fwe(b,h){let r=0;switch(b){case 0:r=ub.a.Pxb;break;case 1:r=ub.a.iwe;break;case 2:r=ub.a.hwe;break;case 3:r=ub.a.gwe}this.Rb.Pb(r,2,h)}}Object(u.a)(OK,"PageCommands",null,[490]);
class Ix{constructor(b,h,r){this.W4n=(A,M,aa,oa,Ja)=>1===aa?32:(A=this.ql.Paa(M.Ik))?(Ja=3===Ja.Wy,this.B9.value.S9h(this.tEm(A),this.xQb(A),Ja),32):2;this.ga=b;this.B9=h;this.ql=r}Xb(){this.ga.qa(Fc.a.l2f,lc.a.view,this.W4n);this.ga.fb(Fc.a.dre,lc.a.view,jm.d,96);this.ga.fb(Fc.a.cre,lc.a.view,jm.d,96);this.ga.qa(Fc.a.Nne,lc.a.view,jm.c);this.ga.qa(Fc.a.Mne,lc.a.view,jm.c)}tEm(b){const h=new wg.DictionaryPropertySet;h.setValue(Mc.a.np,this.ql.Gv(b));h.setValue(Mc.a.rw,this.ql.dD(b));return h}xQb(b){const h=
new wg.DictionaryPropertySet;h.setValue(Mc.a.marginTop,Math.abs(this.ql.ysa(b)));h.setValue(Mc.a.marginBottom,Math.abs(this.ql.OAa(b)));h.setValue(Mc.a.marginLeft,this.ql.kN(b));h.setValue(Mc.a.marginRight,this.ql.lN(b));return h}}Object(u.a)(Ix,"PaperSizeDialogActor",null,[]);class CI{constructor(b,h,r){this.ga=b;this.B9=h;this.cZ=r}Xb(){this.ga.fb(ub.a.Dpc,lc.a.view,this.J5n.bind(this),1028);this.ga.qa(ub.a.Dpc,lc.a.paragraph,this.H5n.bind(this));this.ga.fb(ub.a.Who,lc.a.view,jm.d,96);this.ga.fb(ub.a.Xho,
lc.a.view,jm.d,96);this.ga.fb(ub.a.cho,lc.a.view,jm.d,96);this.ga.fb(ub.a.dho,lc.a.view,jm.d,96);this.ga.fb(ub.a.K8o,lc.a.view,jm.c,96);this.ga.fb(ub.a.J8o,lc.a.view,jm.c,96);this.ga.fb(ub.a.M2n,lc.a.view,jm.c,96);this.ga.fb(ub.a.N2n,lc.a.view,jm.c,96);this.ga.fb(ub.a.z2n,lc.a.view,jm.c,96);this.ga.fb(ub.a.I8o,lc.a.view,jm.c,96);this.ga.fb(ub.a.A2n,lc.a.view,jm.c,96)}H5n(b,h,r,A,M){if(1===r)return 3===this.ga.mode||2===this.ga.mode?32:8;b=h.node;h=this.h2j(h);M=3===M.Wy;this.B9.value.QXd(this.E3c(b),
this.xQb(h),M);return 32}J5n(b,h,r,A,M){b=h.view.mb;if(!b||CI.rg.enc(b.Mg))return 8;if(Object(Al.a)().NEa(Gd.ParagraphReader.qX,b.Mg))return CI.Dc.$b(Nf.a.Re,{["Reason"]:nf.a.QQ}),8;if(1===r)return 3===this.ga.mode||2===this.ga.mode?32:8;r=b.gb.currentSelection;h=this.h2j(h);M=3===M.Wy;if(1===r.length&&ze.a.pf(r.K(0)))return r=r.K(0).node,this.B9.value.QXd(this.E3c(r),this.xQb(h),M),32;b=[];for(A=0;A<r.length;A++){const aa=r.K(A);(!A&&ze.a.ll(aa)||Gd.ParagraphReader.fn(aa)||ze.a.Zl(aa))&&b.push(aa.node)}if(!b.length)return 8;
r=Array(b.length);for(A=0;A<b.length;A++)r[A]=this.E3c(b[A]);r=yC.APropertySet.$yi(r);this.B9.value.QXd(r,this.xQb(h),M);return 32}E3c(b){const h=new wg.DictionaryPropertySet;h.setValue(pd.a.Ax,Gd.ParagraphReader.Sy(b));const r=this.cZ.QVa(b);var A=r.lineSpacing;h.setValue(pd.a.Rab,A.unit);h.setValue(pd.a.xa,A.value);A=r.beforeSpacing;h.setValue(pd.a.Qsc,A.unit);h.setValue(pd.a.Rsc,A.value);A=r.afterSpacing;h.setValue(pd.a.Osc,A.unit);h.setValue(pd.a.Psc,A.value);h.setValue(pd.a.Qfd,r.$x);h.setValue(De.a.keepWithNext,
Gd.ParagraphReader.keepWithNext(b));h.setValue(De.a.widowControl,Gd.ParagraphReader.P2b(b));h.setValue(De.a.keepTogether,Gd.ParagraphReader.keepTogether(b));return h}static get rg(){return re.a.instance}static get Dc(){return Rg.a.instance}}Object(u.a)(CI,"AParagraphDialogActor",null,[]);class vN extends CI{constructor(b,h,r,A,M){super(b,h,r);this.ql=A;this.Pp=M}Xb(){super.Xb();this.ga.fb(ub.a.wvj,lc.a.view,jm.d,96);this.ga.fb(ub.a.xvj,lc.a.view,jm.d,96);this.ga.fb(ub.a.iho,lc.a.view,jm.d,96);this.ga.fb(ub.a.L1m,
lc.a.view,jm.c,96);this.ga.fb(ub.a.N1m,lc.a.view,jm.c,96);this.ga.fb(ub.a.G8o,lc.a.view,jm.c,96);this.ga.fb(ub.a.H8o,lc.a.view,jm.c,96);this.ga.fb(ub.a.I2n,lc.a.view,jm.c,96);this.ga.fb(ub.a.P2n,lc.a.view,jm.c,96);this.ga.fb(ub.a.O2n,lc.a.view,jm.c,96);this.ga.fb(ub.a.L8o,lc.a.view,jm.c,96);this.ga.fb(ub.a.Yho,lc.a.view,jm.d,96);this.ga.fb(ub.a.Zho,lc.a.view,jm.d,96)}h2j(b){return this.ql.Paa(b.Ik)}E3c(b){const h=super.E3c(b);var r=this.Pp.$W(b);const A=this.Pp.jI(b);h.setValue(pd.a.JMa,1);h.setValue(pd.a.KMa,
r.Ou-A.Ou);r=this.Pp.w9a(b);h.setValue(pd.a.Svb,r.unit);h.setValue(pd.a.Tvb,r.value);b=this.Pp.wkc(b);b.specialIndentType&&(h.setValue(pd.a.E8,b.specialIndentType),h.setValue(pd.a.D_a,b.unit),h.setValue(pd.a.E_a,b.value));return h}xQb(b){const h=new wg.DictionaryPropertySet;h.setValue(Mc.a.np,this.ql.Gv(b));h.setValue(Mc.a.rw,this.ql.dD(b));h.setValue(Mc.a.marginTop,Math.abs(this.ql.ysa(b)));h.setValue(Mc.a.marginBottom,Math.abs(this.ql.OAa(b)));h.setValue(Mc.a.marginLeft,this.ql.kN(b));h.setValue(Mc.a.marginRight,
this.ql.lN(b));return h}}Object(u.a)(vN,"ParagraphDialogActor",CI,[]);class wN extends Sys.EventArgs{constructor(b,h){super();this.node=b;this.hYi=h}}Object(u.a)(wN,"AfterPasteEventArgs",Sys.EventArgs,[]);class EO{constructor(b){this.EVe=null;this.gAd=b}get Q2d(){return null!=this.MVg?this.MVg:this.MVg=Za.a.instance.resolve(1023)}get Fce(){this.EVe||(this.EVe=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$(Ir.a.Adi));return this.EVe}veo(b){if(b&&Db.OutlineElementReader.Nh(b.xAa)&&Db.OutlineElementReader.Nh(b.Otb)){this.Seo(b);
var h=new xm.a;for(h.hd(b.xAa);h&&h.currentNode;){const r=this.n7d(h),A=Gd.ParagraphReader.Vb(r);A&&Gd.ParagraphReader.unb(r)&&this.teo(r);const M=h.currentNode.id===b.Otb.currentNode.id;A&&this.Fce&&r.mk.Tka(r.type).Nre(new wN(r,M));if(M)break;Bb.OutlineElementNavigator.Zs(h,!1,!1)}}}teo(b){v.ULS.sendTraceTag(590435214,307,50,"ProcessParagraphForExternalContent: Processing the pasted the external content (oEmbed) component via external paste flow.");const h=b.ctc;b=wc.a.Tc(b,0);hs.x8c(h)?this.Q2d.Voe(b,
h):this.gAd.Voe(b,h)}Seo(b){if(b.xAa.currentNode&&b.Otb.currentNode&&b.xAa.currentNode.id===b.Otb.currentNode.id){const h=this.n7d(b.xAa);Gd.ParagraphReader.Vb(h)?this.xeo(h,b.D7n,b.C7n):v.ULS.sendTraceTag(590955995,307,50,"ProcessSinglePastedHyperlink: No paragraph node pasted.")}}xeo(b,h,r){v.ULS.shipAssertTag(590956771,307,0<=h);v.ULS.shipAssertTag(590958592,307,0<=r);var A=Gd.ParagraphReader.text(b);if(""!==A){var M=wc.a.createTextRange(b,h,r);M=Nc.a.KA(M,!1);if(1===M.length){const aa=M[0];M=
A.substring(h,r).trim();A=A.substring(aa.cpBegin,aa.cpEnd).trim();h=M===A;M=wc.a.createTextRange(b,aa.cpBegin,aa.cpEnd);if(aa.hyperlink&&h&&!Nc.a.AXa(A))b=aa.hyperlink.url;else if(h)b=A;else{v.ULS.sendTraceTag(590958596,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because the pasted text is not equal to the pasted hyperlink display text");return}hs.x8c(b)?this.Q2d.DWa(M,b,!1):this.gAd.DWa(M,b,!1)}else v.ULS.sendTraceTag(590958597,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because either no hyperlinks or more than one hyperlink got pasted  Hyperlinks pasted = {0}",
M.length)}}n7d(b){const h=Bb.OutlineElementNavigator.Me(b);Bb.OutlineElementNavigator.je(b);return h}}Object(u.a)(EO,"PastedContentsProcessorPostMergeAfterPaste",null,[489]);class ZL extends Ez{constructor(b,h,r,A,M,aa,oa,Ja){super(A);this.C6e=7;this.ox=this.mGc=null;this.kUe=0;this.hUe=b;this.xl=h;this.io=r;this.Xd=M;this.qkk=oa;this.Z3a=Ja;this.Q5=this.Xd.bYa("UserAction","WordIgnoreAll")}mAg(b){this.hUe.G9i();this.mGc=this.io.rsa(b);this.Z3a.yOi(this.mGc,null,!1);return this.hUe.J2j(this.mGc)?
(this.Q5.start(),this.ox=new Rb.GraphTransaction(15),this.ox.Bb(b.node),!0):!1}dqe(b){this.IXb(b.node);return!0}khd(b){this.IXb(b);return!0}eqe(b){this.IXb(b.node)}IGg(b){this.ox.dispose();this.mGc.errorDetails.Izb(b.actionId);this.Q5.stop();v.ULS.sendTraceTag(19779652,324,50,String.format("Ignore-all succeeded. Actual ignored errors: {0}. Duration in milliseconds: {1}. Type: {2}",this.kUe,this.Q5.Ei,this.mGc.errorDetails.proofingType));return!0}Exc(b,h){if(super.Exc(b,h))return!0;b=b.role;return 9===
b||10===b||13===b||7===b||8===b}IDi(b){if(b&&b.type!==this.C6e){const h=vd.a.Za(b);return h.vb(this.C6e)?h.ld(this.C6e):b}return b}Ghn(b,h){return this.hUe.ood(h.errorDetails)&&!this.xl.eba(wc.a.createTextRange(b,h.Ec,h.end))}IXb(b){if(b){var h=this.io.d7(b,r=>this.Ghn(b,r));this.qkk?this.io.Rwb(b,h,!0):0<h.length&&(b.km(4,!0),this.io.JVb(b));this.kUe+=h.length}}}Object(u.a)(ZL,"IgnoreAllCallbackSteps",Ez,[]);class FO{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc){this.Whd=(zc,Yc,Kd,ke,ge)=>{if(1===
Kd)return 32;zc=this.GK.pKa(Yc.view.mb.Mg);if(zc=tj.a.Hg(zc))ge[Xk.a.LabelText]=zc.displayName;return 32};this.Nsa=(zc,Yc,Kd,ke,ge,de)=>{const Sd=new ZL(this.Uwk,this.xl,this.io,this.Oe,this.Xd,this.qZ,0,this.Z3a);return new oE(zc,Yc,Kd,ke,ge,de,Sd,this.ga,this.hb,this.Oe,"IgnoreAllOperation")};this.hNb=(zc,Yc,Kd,ke,ge,de)=>{const Sd=new ZL(this.Irk,this.xl,this.io,this.Oe,this.Xd,this.qZ,1,this.Z3a);return new oE(zc,Yc,Kd,ke,ge,de,Sd,this.ga,this.hb,this.Oe,"DoNotCheckThisCritiqueType")};this.ga=
b;this.xl=h;this.hb=r;this.Oe=A;this.io=M;this.GK=aa;this.Xd=oa;this.Uwk=Ja;this.Irk=fb;this.L7b=Cb.J9c;this.qZ=Cb;this.Z3a=Gb;this.nWe=Sb;this.xgb=pc}Xb(){this.nWe&&(ev.jD()?this.ga.fb(ub.a.Nsa,lc.a.Xc,this.Y_m.bind(this),1028):this.ga.qW(ub.a.Nsa,lc.a.view,this.Nsa,1028));this.L7b&&this.ga.qW(ub.a.hNb,lc.a.view,this.hNb,1028);this.ga.fb(Fc.a.Whd,lc.a.view,this.Whd,96)}Y_m(b,h,r,A,M){if(1===r)return 32;v.ULS.sendTraceTag(528023773,324,50,"Ignore All error triggered for AL");this.xgb.vQf(M?M:h,null,
Up.b.IgnoreAll);return 32}}Object(u.a)(FO,"ProofingActor",null,[]);var GO=d(1699);class PD{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb){this.ep=this.zSa=this.HMd=this.IMd=null;this.ZF=this.Tu=this.hs=0;this.eib=this.dib=!1;this.Wda=this.f5b=this.e5b=this.d5b=this.g5b=0;this.HLd=null;this.Yha=this.sZ=this.yr=this.aT=0;this.Hm=null;this.D2a=0;this.Hfg=Gb=>{var Sb;if(Bd.a.lq){var pc=Object.assign(new bb.a,{extendedProperties:new Map});pc.extendedProperties.set("status",Gb.data.status.toString());pc.extendedProperties.set("httpStatus",
Gb.data.Ie.toString());this.K8i("GraphicSwordRequestFailed",this.D2a,pc)}else 5===this.D2a&&(pc=Object.assign(new bb.a,{extendedProperties:new Map}),pc.extendedProperties.set("status",Gb.data.status.toString()),pc.extendedProperties.set("httpStatus",Gb.data.Ie.toString()),(null===(Sb=y.AFrameworkApplication.J)||void 0===Sb?0:Sb.$("ShouldLogPicturesExtendedHealthKpis"))?(Sb={name:gj.c.bae,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:pc},
pc.extendedProperties.set("ErrorLevel","warning"),this.He.logKpiFailure({kpiName:gj.c.Tlc,errorName:"PictureSwordRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:pc},optionalVeto:Sb})):Ba.Health.instance.recordQosError("PictureSwordRequestFailed",["ImageEditFailed"],!1,!0,!1,!1,pc));v.ULS.sendTraceTag(25182720,322,15,"Request failed: {0}. PlaceholderKind: {1}",{["Status"]:Gb.data.status,["HttpStatus"]:Gb.data.Ie,["Id"]:Gb.data.id,["ResponseData"]:Gb.data.De},dw.a[this.D2a]);
this.wue()};this.Dk=r;this.eSa=Cb;this._image=b;this._context=h;this.yEd=!1;(b=Object(vo.a)().Iu(h.node))&&b.wf(Mc.a.V_f)&&(this.yEd=!0);this.hIc=A.$("ImageDataURLPresentationIsEnabled");this.VGk=A.$("WordOartPostRequestIsEnabled");this.Ga=A;this.Zr=M;this.Xd=aa;this.Yd=oa;this.An=Ja;this.vM=fb;this.He=sh.a.getInstance(gj.a);this.E4m();this.Mme=this.csc.bind(this)}E4m(){this.ep="";this.hs=Uc.ImageReader.RB(this._image);this.Tu=Uc.ImageReader.$C(this._image);this.Wda=Uc.ImageReader.Oqb(this._image);
this.ZF=Uc.ImageReader.L2(this._image);var b=Uc.ImageReader.vsa(this._image);this.dib=b.Apb;this.eib=b.OJa;b=Uc.ImageReader.ifa(this._image);this.g5b=Math.max(b.top,0);this.d5b=Math.max(b.bottom,0);this.e5b=Math.max(b.left,0);this.f5b=Math.max(b.right,0);this.Hm=kb.a.nil;this.zSa=null;this.D2a=Uc.ImageReader.Fk(this._image)}jTd(b,h){return(new GO.a(this.Zr,this.D2a,this.Ga,this.hs,this.Tu,this.ZF,this.Wda,this.g5b,this.d5b,this.e5b,this.f5b,this.dib,this.eib,this.yEd)).build(this._context.node,this._image,
b,h)}resize(b,h){this.ep="Resize";this.Tze();db.a.mark(this.fkc());this.hs=b;this.Tu=h;this.sendMessage(!1,this.Mme)}Kx(b){this.ep="Styles";this.Tze();db.a.mark(this.fkc());this.Wda=b;this.sendMessage(!1,this.Mme)}bUo(b,h,r){this.ep="Rotation";this.Tze();this.ZF=b;this.dib=h;this.eib=r;this.sendMessage(!1,this.Mme)}aUo(b,h){this.ep="SwordRequestManager";this.Tze();this.zSa=b;this.ZF=h.angle;this.hs=h.width;this.Tu=h.height;this.Wda=h.styleId;this.g5b=h.top;this.d5b=h.bottom;this.e5b=h.left;this.f5b=
h.right;this.Hm=h.f_;this.sendMessage(!1,this.Mme)}sendMessage(b,h){this.eSa.WX([this.eSa.MJf(this.ep)]);if(this.Ga.$("WordOartForceOutboundAfterImageSuccessIsEnabled")){var r=this.Onb(r);const A=Uc.ImageReader.Csa(this._image,this.Ga,this.Zr);A?Bd.a.eyb(this._image,A,4):this._image.setValue(fd.a.hVa,!0);r.dispose()}this.hWj(b);db.a.mark(this.fkc());b=new Ra.QueryStringBuilder(this.jTd(b,!0));this.hIc&&b.ye(Pi.a.gbi,"true");this.VGk?(r=new Ra.QueryStringBuilder("WordOart.ashx"),y.AFrameworkApplication.Ee.Wj(r.toString(),
2,b.toString(),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!0,0,h,this.Hfg,null)):y.AFrameworkApplication.Ee.Wj(b.toString(),1,"",null,!0,0,h,this.Hfg,null)}Onb(b){b=this.Hm&&this.Hm!==kb.a.nil?new Rb.GraphTransaction(7,ub.a.Vaa):new Rb.GraphTransaction(15);b.Bb(this._context.node);return b}get gek(){const b=new Rb.GraphTransaction(3);b.Bb(this._context.node);return b}wue(){this.j0d();this.i0d();const b=this.gek;var h=Uc.ImageReader.aKa(this._image,this._context.node.Ic,this.Ga,
this.Zr);this._image.setValue(fd.a.hVa,!1);this._image.setValue(pd.a.j6c,h);this._image.setValue(pd.a.lX,-1);this._image.setValue(fd.a.KP,1);h=Uc.ImageReader.Csa(this._image,this.Ga,this.Zr);this.Ga.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&(this._image.removeProperty(pd.a.npe),this._image.removeProperty(pd.a.mpe),h&&Bd.a.eyb(this._image,h,3));b.dispose();PD.mq();this.zSa&&this.zSa()}hWj(b){this.Xd&&(b=String.format("Send Single {0} SWORD Request.",b?"PNG":"XML"),this.IMd=this.Xd.Wf("WebServiceCall",
b))}j0d(){this.IMd&&(this.IMd.stop(),this.IMd=null)}Tze(){if(this.Xd){const b=String.format("Send SWORD {0} Request. PlaceholderKind: {1}",this.ep,dw.a[this.D2a]);this.HMd=this.Xd.Wf("WebServiceCall",b)}}i0d(){this.HMd&&(this.HMd.stop(),this.HMd=null)}A4(){if(Bd.a.iV){var b=this.eSa.records;for(const [h,r]of Object.entries(b))b={additionalValues:Object.assign(new bb.a,{durationMs:r}),hasImpliedUsage:!0},this.He.logKpiSuccess({kpiName:dd.d.etc+bn.a[h]+dw.a[this.D2a].toString(),optionalProperties:b}),
this.eSa.Fuc(Number(h))}}M8i(b){this.He.logKpiSuccess({kpiName:dd.d.C4c+this.ep+dw.a[b].toString()})}L8i(b,h){b=Object.assign(new bb.a,{extendedProperties:new Map([["Exception",b.message]])});this.K8i("GraphicResponseInvalid",h,b)}K8i(b,h,r){r.extendedProperties.set("ErrorLevel","warning");this.He.logKpiFailure({kpiName:dd.d.C4c+this.ep+dw.a[h].toString(),errorName:b+Object(Ql.b)(this.Tu,this.hs),optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:r},optionalVeto:Object(Ql.c)(dd.d.iPf,
r,null,!1)})}static mq(){const b=new ni.StandardDialog;b.Fd=0;b.zy(Bf.a.Z8n,Box4Intl.Box4Strings.l_PictureStyleErrorTitle,Box4Intl.Box4Strings.l_PictureStyleError,null);qa.StaticActiveAppFrame.za()&&qa.StaticActiveAppFrame.za().Fe()}}Object(u.a)(PD,"RenderedImageEditOperation",null,[507]);var QD=d(205),DI=d(517);class EI extends PD{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb){super(b,h,r,A,M,aa,oa,Ja,fb,Cb);if(Bd.a.lq||Bd.a.iV)this.He=sh.a.getInstance(dd.a)}sendMessage(b,h){Object(QD.a)(()=>{let r;r=this.Onb(r);
this._image.setValue(fd.a.KP,0);r.dispose()});this.hWj(b);db.a.mark(this.fkc());this.eSa.WX([13]);b=new Ra.QueryStringBuilder("WordOart.ashx");this.Tkh=this.getUrl(!0,!1);b=new DI.a(b.toString(),2,this.getUrl(!1,!1),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!1,2,null,null,null,null,null,null,null,null,null,null,null,null,["Content-Type"],null,"text");y.AFrameworkApplication.Ee.send(b).qDa(h,r=>{this.Hfg(r)})}csc(b){try{const h=JSON.parse(b.data.uNa);this.Pvk=h[Pi.a.B4c];
this.yQk=h[Pi.a.width];this.iwk=h[Pi.a.height];this.F7g=h[Pi.a.fSc];this.ZFc=Array(4);this.ZFc[Zi.a.left]=h[Pi.a.Gob];this.ZFc[Zi.a.right]=h[Pi.a.Hob];this.ZFc[Zi.a.top]=h[Pi.a.Iob];this.ZFc[Zi.a.bottom]=h[Pi.a.Fob];this.Aph=void 0!==h[Pi.a.iCa]?"true"===h[Pi.a.iCa].toLowerCase():null;Object(QD.a)(()=>{this.zsd();this._context.node.Jj().wg.xF(()=>{this.L7l()},null,null)})}catch(h){Bd.a.lq&&(b=Object.assign(new bb.a,{extendedProperties:new Map([["Exception",h.message],["Operation",this.ep]])}),b.extendedProperties.set("ErrorLevel",
"warning"),this.He.logKpiFailure({kpiName:dd.d.q9d+dd.b.GJa+dw.a[Uc.ImageReader.Fk(this._image)].toString(),errorName:"DrawingResponseInvalid"+Object(Ql.b)(this.Tu,this.hs),optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:Object(Ql.c)(dd.d.bKi,b,null,!1)})),v.ULS.sendTraceTag(526528851,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",h.message,this.ep,Uc.ImageReader.Fk(this._image)),this.wue()}}$le(){v.ULS.sendTraceTag(521175366,
322,15,"onImageSuccess should not have been called")}zsd(){let b;b=this.Onb(b);this._image.setValue(De.a.rN,this.Pvk);this.F7g&&this._image.setValue(De.a.wRd,this.F7g);this._image.setValue(De.a.eBa,this.yQk);this._image.setValue(De.a.fBa,this.iwk);this._image.setValue(De.a.bWa,this.ZFc);this.$wk&&this._image.setValue(pd.a.tRb,this.$wk);Bd.a.eyb(this._image,this.Tkh,3);this._image.setValue(Mc.a.Eob,this.Tkh);this.Aph?this._image.setValue(De.a.I$a,this.Aph):this._image.removeProperty(De.a.I$a);this.Fol();
b.dispose()}Fol(){this._image.removeProperty(pd.a.Cu);this._image.removeProperty(pd.a.lX);this._image.removeProperty(pd.a.npe);this._image.removeProperty(pd.a.mpe)}L7l(){this.vM.MNa(this._context);if(this.Hm&&this.Hm!==kb.a.nil){const b=this._context.node.Jj(),h=new N.a(this.Hm,1);this.An.Hec(b,h)}this.Yd.Yu(13);Bd.a.lq&&this.He.logKpiSuccess({kpiName:dd.d.q9d+dd.b.GJa+dw.a[Uc.ImageReader.Fk(this._image)].toString()});this.j0d();this.i0d();db.a.mark(this.y3c());this.eSa.XL([13]);this.A4();Object(QD.a)(()=>
{let b;b=this.Onb(b);this._image.setValue(fd.a.KP,1);b.dispose()});this.zSa&&this.zSa()}getUrl(b,h){b=new Ra.QueryStringBuilder(this.jTd(b,h));b.ye(Pi.a.hae,"true");return b.toString()}fkc(){return 51511}y3c(){return 51512}}Object(u.a)(EI,"RenderedGraphicEditOperation",PD,[]);var xN=d(572);class PK extends PD{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb){super(b,h,r,A,M,aa,oa,Ja,fb,Gb);this.Nfh=null;this.$le=Sb=>{const pc=this.jTd(!0,!1);let zc;zc=this.Onb(zc);this._image.setValue(Mc.a.gSc,this.HLd);var Yc=
Za.a.instance.Oa(12);Bd.a.lq&&this.M8i(this.kHb);Yc&&Yc.isFeatureEnabled(43)&&this._image.setValue(Mc.a.n1d,this.Nfh);this.Ga.$("WordEditorImageRotateIsEnabled")&&this.Ga.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Dk.Hwe(this._image,this.ZF,this.dib,this.eib);const Kd=Uc.ImageReader.Csa(this._image,this.Ga,this.Zr),ke=()=>{Kd&&Bd.a.eyb(this._image,Kd,3);Bd.a.eyb(this._image,pc,3);this.Dk.Fwe(this._image,Jg.a.cI(this.aT),Jg.a.cI(this.sZ),Jg.a.cI(this.yr),Jg.a.cI(this.Yha));this._image.setValue(Mc.a.Eob,
pc);Uc.ImageReader.Vz(this._image)||this._image.setValue(Mc.a.PKa,xt.a.adb);this.Dk.owe(this._image,this.hs,this.Tu);this.Ga.$("WordEditorImageRotateIsEnabled")&&!this.Ga.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Dk.Hwe(this._image,this.ZF,this.dib,this.eib);2===Sb.data.status&&Uc.ImageReader.g3(Sb.data.De)&&(this._image.setValue(pd.a.Cu,Sb.data.De),Sb.data.request&&this._image.setValue(pd.a.tRb,Object(xN.a)("POST"===Sb.data.request.get_httpVerb()?Sb.data.request.get_body():Sb.data.request.get_url())));
this.zSa&&this.zSa();this.vM.MNa(this._context);if(this.Hm&&this.Hm!==kb.a.nil){const ge=this._context.node.Jj(),de=new N.a(this.Hm,1);this.An.Hec(ge,de)}this.Yd.Yu(13);this.j0d();this.i0d();db.a.mark(this.y3c());this.eSa.XL([this.eSa.MJf(this.ep)]);this.A4()};if(this.Ga.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Hm&&this.Hm!==kb.a.nil&&(Yc=this._context.node.Jj())&&Yc.wg){zc.dispose();Yc.wg.xF(()=>{let ge;ge=this.Onb(ge);ke();ge.dispose()},null,null);return}ke();zc.dispose()};if(Bd.a.lq||
Bd.a.iV)this.He=sh.a.getInstance(dd.a);this.kHb=Cb}fkc(){return 51511}y3c(){return 51512}csc(b){try{var h=JSON.parse(b.data.De);const M=Sys.Net.XMLDOM("string"===typeof h[Pi.a.$Ph]?h[Pi.a.$Ph]:null);this.HLd="string"===typeof h[Pi.a.xRd]?h[Pi.a.xRd]:null;const aa=Za.a.instance.Oa(12);aa&&aa.isFeatureEnabled(43)&&(this.Nfh="string"===typeof h[Pi.a.Ghc]?h[Pi.a.Ghc]:null);Y.a.Jt&&M.setProperty("SelectionNamespaces","xmlns:mc='"+Mj.a.Q2k+"'");const oa=M.selectSingleNode("/mc:AlternateContent");if(!oa)throw su.a.argument("Alternate content element could not be retrieved!");
const Ja=oa.firstChild;if(!Ja)throw su.a.argument("Alternate content choice element could not be retrieved!");const fb=Ja.firstChild;if(!fb)throw su.a.argument("Drawing element could not be retrieved!");var r=fb.firstChild;if(!r)throw su.a.argument("Inline element could not be retrieved!");h=b=null;const Cb=RegExp("effectExtent"),Gb=RegExp("extent");for(const pc of r.childNodes)-1!==pc.nodeName.search(Cb)&&(b=pc),-1!==pc.nodeName.search(Gb)&&(h=pc);if(!b||!h)throw su.a.argument("Effect extent or extent could not be retrieved!");
this.aT=parseInt(b.selectSingleNode("@l").text);this.sZ=parseInt(b.selectSingleNode("@r").text);this.yr=parseInt(b.selectSingleNode("@t").text);this.Yha=parseInt(b.selectSingleNode("@b").text);const Sb=Ql.e(this.ZF);if(45<=Sb&&135>=Sb||225<=Sb&&315>=Sb){const pc=parseInt(h.selectSingleNode("@cx").text);var A=parseInt(h.selectSingleNode("@cy").text);r=pc/2;A/=2;this.aT-=r-A;this.sZ+=r-A;this.yr-=A-r;this.Yha+=A-r}}catch(M){Bd.a.lq&&this.L8i(M,this.kHb);v.ULS.sendTraceTag(42079129,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",
M.message,this.ep,dw.a[this.kHb]);this.wue();return}this.sendMessage(!0,this.$le)}}Object(u.a)(PK,"RenderedDrawingEditOperation",PD,[]);class yN extends PD{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb){super(b,h,r,A,M,aa,oa,Ja,fb,Sb);this.Hda=null;this.$le=pc=>{var zc;const Yc=this.jTd(!0,!1);let Kd;Kd=this.Onb(Kd);this._image.setValue(Mc.a.hXb,this.HLd);const ke=Uc.ImageReader.Csa(this._image,this.Ga,this.Zr);Bd.a.lq?this.M8i(this.kHb):(null===(zc=y.AFrameworkApplication.J)||void 0===zc?0:zc.$("ShouldLogPicturesExtendedHealthKpis"))&&
this.He.logKpiSuccess({kpiName:gj.c.Tlc});const ge=()=>{ke&&Bd.a.eyb(this._image,ke,3);Bd.a.eyb(this._image,Yc,3);this.Dk.Fwe(this._image,Jg.a.cI(this.aT),Jg.a.cI(this.sZ),Jg.a.cI(this.yr),Jg.a.cI(this.Yha));this._image.setValue(Mc.a.Eob,Yc);Uc.ImageReader.Vz(this._image)||this._image.setValue(Mc.a.PKa,xt.a.adb);this._image.setValue(Mc.a.xgd,this.Wda);this._image.setValue(pd.a.S0m,-1);this.Bd.isFeatureEnabled(83)&&Uc.ImageReader.klc(this._image)&&this.Dp.Euc(this._image);this._image.setValue(fd.a.hVa,
!1);this.Dk.owe(this._image,this.hs,this.Tu);this.Ga.$("WordEditorImageRotateIsEnabled")&&this.Dk.Hwe(this._image,this.ZF,this.dib,this.eib);this.Ga.$("WordEditorImageCropIsEnabled")&&this.Dk.Cyg(this._image,this.g5b,this.d5b,this.e5b,this.f5b);2===pc.data.status&&Uc.ImageReader.g3(pc.data.De)&&(this._image.setValue(pd.a.Cu,pc.data.De),pc.data.request&&this._image.setValue(pd.a.tRb,Object(xN.a)("POST"===pc.data.request.get_httpVerb()?pc.data.request.get_body():pc.data.request.get_url())));this.zSa&&
this.zSa();this.vM.MNa(this._context);if(this.Hm&&this.Hm!==kb.a.nil){const de=this._context.node.Jj(),Sd=new N.a(this.Hm,1);this.An.Hec(de,Sd)}this.Yd.Yu(13);this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateCommandUIAfterSwordEdit",!1)&&qa.StaticActiveAppFrame.za().Fe();this.j0d();this.i0d();db.a.mark(this.y3c());this.eSa.XL([this.eSa.MJf(this.ep)]);this.A4()};if(this.Ga.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Hm&&this.Hm!==kb.a.nil&&(zc=this._context.node.Jj())&&
zc.wg){Kd.dispose();zc.wg.xF(()=>{let de;de=this.Onb(de);ge();de.dispose()},null,null);return}ge();Kd.dispose()};this.kHb=Cb;this.Bd=Gb;if(Bd.a.lq||Bd.a.iV)this.He=sh.a.getInstance(dd.a)}fkc(){return 7988}y3c(){return 7989}get Dp(){this.Hda||(this.Hda=new sN.a);return this.Hda}csc(b){var h;try{const r=b.data.cna;this.HLd=b.data.De;Y.a.Jt&&r.setProperty("SelectionNamespaces","xmlns:pic='"+Mj.a.X8n+"'");const A=r.selectSingleNode("/pic:wordEdit/pic:spPr").nextSibling;this.aT=parseInt(A.selectSingleNode("@l").text);
this.sZ=parseInt(A.selectSingleNode("@r").text);this.yr=parseInt(A.selectSingleNode("@t").text);this.Yha=parseInt(A.selectSingleNode("@b").text)}catch(r){b=Object.assign(new bb.a,{extendedProperties:new Map});b.extendedProperties.set("exception",r.message);b.extendedProperties.set("operation",this.ep);Bd.a.lq?this.L8i(r,this.kHb):(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:gj.c.bae,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,
isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","warning"),this.He.logKpiFailure({kpiName:gj.c.Tlc,errorName:"PictureSwordResponseInvalid",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:h})):Ba.Health.instance.recordQosError("PictureSwordResponseInvalid",["ImageEditFailed"],!1,!0,!1,!1,b);v.ULS.sendTraceTag(25182691,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",r.message,this.ep,
dw.a[this.kHb]);this.wue();return}this.sendMessage(!0,this.$le)}}Object(u.a)(yN,"RenderedPictureEditOperation",PD,[]);class QK{constructor(b,h,r,A,M,aa,oa,Ja){this.Dk=b;this.Ga=h;this.Zr=r;this.Xd=A;this.Yd=M;this.An=aa;this.vM=oa;this.Bd=Ja}create(b,h){const r=Uc.ImageReader.Fk(b);return Object(Ui.d)(b)?new EI(b,h,this.Dk,this.Ga,this.Zr,this.Xd,this.Yd,this.An,this.vM,new bn.b):10===r||11===r||48===r||4===r?new PK(b,h,this.Dk,this.Ga,this.Zr,this.Xd,this.Yd,this.An,this.vM,r,new bn.b):5===r?new yN(b,
h,this.Dk,this.Ga,this.Zr,this.Xd,this.Yd,this.An,this.vM,r,this.Bd,new bn.b):null}}Object(u.a)(QK,"Factory",null,[487]);class FI{constructor(){this.PYc=b=>{const h=window.performance.now(),r=si.a.Ip();if(r){b=QL.a(b.Yl,r);b=uf.a.At(b,r);var A=0,M=new Rb.GraphTransaction(3);try{for(M.Bb(r);b.moveNext();){if(!Gd.ParagraphReader.Bh(b.iterator))continue;const aa=b.currentNode;this.sgi(aa)&&(A++,aa.km(4,!0));const oa=window.performance.now()-h;if(2500<A||100<oa){this.nHb=null;this.qid(aa);break}}}finally{M&&
M.dispose()}}else Tc.b(570450380,3018,10,"PageContentNode not found")};this.nHb=null}VSi(){const b=si.a.Ip();this.Mid(b);this.qid(null)}qid(b){this.nHb&&(y.AFrameworkApplication.oc.uf(this.nHb),this.nHb=null);this.nHb=new xc.a(1,1,1,this.PYc,198);this.nHb.Yl=b;y.AFrameworkApplication.oc.Zb(this.nHb)}Mid(b){const h=QL.b(b);if(h){var r=new Rb.GraphTransaction(3);try{for(r.Bb(b);h.moveNext();){if(!Gd.ParagraphReader.Bh(h.iterator))continue;const A=h.currentNode;this.sgi(A)&&A.km(4,!0)}}finally{r&&r.dispose()}}}sgi(b){b=
b.gJ;for(const h of b)if(h.V$a)return 0<h.R0b;return!1}}Object(u.a)(FI,"RenderParagraphsContainingTabs",null,[]);class $L{constructor(b,h){this.YOe=!0;this.TEc=null;this.xUl=()=>{this.TEc=null;this.YOe=!0;this.ASa&&this.ASa.q0a(!Zf.a.fP())};this.ufb=(r,A,M)=>{if(1===M)return 32;2===M&&(r=!1,Zf.a.fP()?this.YOe=!1:this.YOe?r=!0:this.zxp(),this.ASa&&this.ASa.q0a(r));return 32};this.ga=b;this.ASa=h}Xb(){this.ga.fb(Ka.a.ufb,lc.a.application,this.ufb,1124)}zxp(){this.TEc?y.AFrameworkApplication.oc.uf(this.TEc):
this.TEc=new xc.a(4,1,5E3,this.xUl);y.AFrameworkApplication.oc.Zb(this.TEc)}}Object(u.a)($L,"SaveStatusActor",null,[]);var HO=d(658);class zN{get Evg(){return null!=this.l2g?this.l2g:this.l2g=Za.a.instance.Oa(654)}get nCo(){return this.mCo||(this.mCo=Za.a.instance.Oa(1101))}get Xg(){return null!=this.x3g?this.x3g:this.x3g=Za.a.instance.Oa(29)}constructor(b,h){this.dKb=(r,A,M)=>{r=si.a.oTb(A);if(1===M||r)return r?8:32;this.B9.value.vBl(A);return 32};this.lMb=(r,A,M)=>{r=si.a.oTb(A);if(1===M||r)return r?
8:32;this.B9.value.FFl(A,this.ga);return 32};this.Avf=(r,A,M)=>{r=si.a.oTb(A)||this.SZo();if(1===M||r)return r?8:32;this.B9.value.Avf(A);return 32};this.ga=b;this.B9=h}get Wb(){return null!=this.j6g?this.j6g:this.j6g=Za.a.instance.resolve(8)}Xb(){this.ga.fb(ub.a.dKb,lc.a.view,this.dKb,1028);this.ga.fb(ub.a.lMb,lc.a.view,this.lMb,4);this.ga.fb(ub.a.WMb,lc.a.view,this.Avf,4);this.ga.fb(ub.a.Dvg,lc.a.view,this.hIo.bind(this),4);this.ga.fb(ub.a.Qtg,lc.a.view,this.Rtg.bind(this),4);this.ga.fb(ub.a.vvf,
lc.a.view,this.uOl.bind(this),4)}hIo(b,h,r){b=si.a.oTb(h)||this.XZo();if(1===r||b)return b?8:32;this.Evg.gIo();return 32}Rtg(b,h,r){b=si.a.oTb(h)||this.VZo();if(1===r||b)return b?8:32;this.nCo.Rtg();return 32}uOl(b,h,r){b=si.a.oTb(h)||this.RZo();if(1===r||b)return b?8:32;this.B9.value.tOl();return 32}RZo(){return"{}"===Bx.a.mAb?!0:!1}VZo(){if(0==Bx.a.rP.size)return!0;var b=Bx.a.rP;const h=this.Wb.qo();let r=0;for(const A of b.values())b=h.lh(A),this.Wb.me(b,h)||r++;return 0==r?!0:!1}XZo(){var b=Bx.a.mAb,
h=Bx.a.rP;const r=this.Wb.qo();if(0==h.size)return!0;if(!({ev:b}=H.d(b)).returnValue)return v.ULS.sendTraceTag(526979992,3017,15,"Received null string during  deserialization: StylesActor."),!0;if(Object.keys(b).length!=h.size)return!1;for(const M of h.values()){h=r.lh(M);var A=b[M];if(null==A)return!1;if(A=si.a.o8d(A)){if(h=si.a.c2c(h,r),si.a.j9c(h,A))return!1}else v.ULS.sendTraceTag(526979993,3017,15,"Received null style during de serialization: StylesActor.")}return!0}SZo(){var b=si.a.Ip();if(!b)return Tc.b(577368330,
3018,15,"PageContentNode is null"),!0;b=this.Xg.Ln?(new Bu.WACStyleSet).Rka(b):(new Bu.WACStyleSet).Oaa(b);const h=b.Jw;for(let A=0;A<h;A++){let M;b instanceof Bu.WACStyleSet?M=b.XAa(A):b instanceof HO.a&&(M=b.gla(A));if(!this.Wb.isHidden(M)&&this.Wb.me(M,b)){var r=this.Wb.BF(M);if(2===r||1===r)if(!M.hasProperty(Mc.a.linkedStyle)||2===r)if(r=M.ka(Mc.a.ZD,null),!(r&&0<r.length))return!1}}return!0}}Object(u.a)(zN,"StylesActor",null,[]);class CA{constructor(b){this.JAe=(h,r,A)=>{h=y.AFrameworkApplication.ua;
if(1===A)return 1!==h.mode||ec.SessionStatusManager.instance.Hk?2:32;Ba.Health.instance.recordKpiUsage("SwitchToClassicViewMode",0,CA.NB,null);const M={};M[F.a.nSf]=y.AFrameworkApplication.J.ib("ClassicViewModePreferenceCookieName");M[F.a.RNi]="true";y.AFrameworkApplication.qN().execute(aa=>{aa.sendMessage(C.a.Fap,M)});return y.AFrameworkApplication.va.Ob(ub.a.readingMode,2)};this.ga=b}Xb(){this.ga.qa(Fc.a.JAe,lc.a.view,this.JAe)}}CA.NB="wwaengidc";Object(u.a)(CA,"SwitchToClassicViewModeActor",null,
[]);class aM{constructor(b,h,r,A,M,aa,oa,Ja,fb){this.angle=r;this.styleId=A;this.width=b;this.height=h;this.top=M;this.bottom=aa;this.left=oa;this.right=Ja;this.f_=fb}}Object(u.a)(aM,"SWordData",null,[]);class AN{constructor(b,h){this.ho=this.z5=this.Zq=null;this.t5e=this.T8b=!1;this.aT=this.sZ=this.Yha=this.yr=this.Wda=this.Tu=this.hs=this.ZF=0;this.Hm=null;this.Eba=()=>{this.t5e=!1;this.T8b&&this.HZc()};this.$p=b;this.GNc=h;this.iQi()}iQi(){this.sZ=this.aT=this.Yha=this.yr=this.Wda=this.Tu=this.hs=
this.ZF=-1;this.Hm=kb.a.nil}HZc(){this.t5e||(this.VAp(),this.XGl(),this.T8b=!1)}XGl(){this.ho=new aM(this.hs,this.Tu,this.ZF,this.Wda,this.yr,this.Yha,this.aT,this.sZ,this.Hm);this.GNc.create(this.z5,this.Zq).aUo(this.Eba,this.ho);this.t5e=!0;let b;Object(Xa.a)(4,this.z5)?b=dw.a[Uc.ImageReader.Fk(this.z5)]:(v.ULS.sendTraceTag(42469523,322,50,"Unable to acquire PlaceholderKind because the image property set isn't of the type which contains information about the PlaceholderKind."),b="generic");v.ULS.sendTraceTag(23171277,
322,50,"Sending request to SWord with width: {0}, height: {1}, angle: {2}, style: {3}, top: {4}, bottom: {5}, left: {6}, right: {7}, placeholderKind: {8}",this.hs,this.Tu,this.ZF,this.Wda,this.yr,this.Yha,this.aT,this.sZ,b);this.iQi()}VAp(){this.hs=-1!==this.hs?this.hs:this.z5.ka(pd.a.NKa,-1);this.Tu=-1!==this.Tu?this.Tu:this.z5.ka(pd.a.MKa,-1);this.hs=-1!==this.hs?this.hs:this.$p.RB(this.z5);this.Tu=-1!==this.Tu?this.Tu:this.$p.$C(this.z5);this.ZF=-1!==this.ZF?this.ZF:this.$p.L2(this.z5);this.Wda=
-1!==this.Wda?this.Wda:this.$p.Oqb(this.z5);const b=this.$p.ifa(this.z5);this.yr=-1!==this.yr?this.yr:b.top;this.Yha=-1!==this.Yha?this.Yha:b.bottom;this.aT=-1!==this.aT?this.aT:b.left;this.sZ=-1!==this.sZ?this.sZ:b.right}xio(b,h,r,A){this.Zq=b;this.ZF=r;this.T8b=!0;this.z5=h;this.Hm=A;this.HZc()}wio(b,h,r,A,M){this.Zq=b;this.T8b=!0;this.z5=h;this.Hm=M;this.z5.setValue(pd.a.NKa,r);this.z5.setValue(pd.a.MKa,A);this.HZc()}Bio(b,h,r){this.Zq=b;this.T8b=!0;this.z5=h;this.Wda=r;this.HZc()}qio(b,h,r,A,
M,aa){this.Zq=b;this.yr=r;this.Yha=A;this.aT=M;this.sZ=aa;this.T8b=!0;this.z5=h;h=b=0;({width:b,height:h}=this.$p.a9a(this.z5));this.hs=b-(M+aa)/1E5*b;this.Tu=h-(r+A)/1E5*h;this.HZc()}}Object(u.a)(AN,"SWordRequestManager",null,[486]);class GI{constructor(b,h,r,A=null,M=null,aa=null,oa=null,Ja=null,fb=null,Cb=null){this.An=null;this.EIh=!1;this.mdp=(Gb,Sb,pc,zc,Yc)=>{if(1===pc)return 32;const Kd=Gb===ub.a.Nxe;if(!Sb.view.te)return 2;const ke=Sb.view,ge=ke.mb,de=ge.Mg;if(!de||GI.rg.q2(de))return 2;
if(this.Sn&&this.Sn.instance&&this.Sn.instance.sX(de))return 4;var Sd=null,be=ce.ActionManager.DCa,Rf=!1,Mf=ze.a.pf(de);if(de.Qw){if(ge.gb.FL&&(be=de.getContext(0),Sd=new vd.a,Sd.set(be.node),Sd.pq(),be=Kd?ub.a.nwg:ub.a.vve),be=this.F9e.Qco(be),be===ce.ActionManager.DCa){var Yj=Object(Al.a)().wW(de,16);Yj?(Kd&&(be=ub.a.Vje),Sd=new vd.a,Sd.set(Yj.node),Sd.Kd()):be=Kd?ub.a.KI:ub.a.ZQ}}else if(de.Al)if(Sd=new vd.a,Sd.set(de.node),ze.a.tv(Sd),gm.OutlineReader.nXa(de))be=Kd?ub.a.nwg:ub.a.vve;else{if(this.fUe&&
this.fUe.b1o(de))return this.fUe.Pmd(de,ke.pc,Kd),32;Uc.ImageReader.B$a(de)?be=Kd?ub.a.mwg:ub.a.lwg:(be=Kd?this.F9e.HQm(Sd,de,be,Sb):this.F9e.GQm(Sd,de,be),Db.OutlineElementReader.Nh(Sd)&&de.contextId===lc.a.Xc&&(Rf=Db.OutlineElementReader.UA(Sd,de,!1)),Yj=of.ListItemReader.Cg(Sd)&&Rf,be!==ce.ActionManager.DCa||$g.TableCellReader.Vfa(Sd)||Yj||(this.EIh||(v.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this.EIh=!0),y.AFrameworkApplication.va.Ob(ub.a.HQi,2),this.eRi(Sb)))}else return 2;
if(!Kd&&be===ce.ActionManager.DCa&&$g.TableCellReader.Vfa(Sd))if(Oh.returnToCell(Sd),$g.TableCellReader.gXa(Sd)||Ii.TableReader.BXi(Sd)&&$g.TableCellReader.KYf(Sd)){if(be=this.URk(),!be)return 2}else be=ub.a.Dej;if(be===ce.ActionManager.DCa)return 2;switch(be){case ub.a.Dej:case ub.a.Vje:Rf=be===ub.a.Vje;Mf&&this.U4&&this.X0&&(Mf=this.U4.nCf(de,-1,!0,cf.a.nz))&&this.X0.bIj(Mf);pc=32;Oh.returnToCell(Sd);Oh.moveToNextOrPreviousCell(Sd,Rf)&&(Mf=!0,Rf=!1,gm.OutlineReader.qRf(Sd)||(Yn.OutlineNavigator.L8f(Sd,
!1),Bb.OutlineElementNavigator.Me(Sd),Gd.ParagraphReader.xu(Sd.currentNode)&&(Mf=!1,Gd.ParagraphReader.textLength(Sd.currentNode)||(Rf=!0)),Rf||Oh.returnToCell(Sd)),Rf?Sd=sc.SelectionFactory.ue(Sd.currentNode,0):(Sd=sc.SelectionFactory.Gr(Sd.currentNode),!Mf&&ze.a.ll(Sd.Wc)&&(Mf=Sd.toArray(),Array.removeAt(Mf,Mf.length-1),Sd=new Er.Selection(Mf,Sd.Kf))),ge.Kc(Sd));break;case ub.a.nwg:case ub.a.vve:be===ub.a.vve?Yn.OutlineNavigator.Hdj(Sd,!1):Yn.OutlineNavigator.Hdj(Sd,!0);ge.Kc(sc.SelectionFactory.Gr(Sd.currentNode));
pc=32;break;case ub.a.rpd:pc=y.AFrameworkApplication.va.Nf(Sb,be,pc,!0,zc,Yc);break;default:if(Sd=()=>{const Ji=new wg.DictionaryPropertySet;Ji.setValue(fd.a.Aae,Gb===ub.a.Nxe?"ShiftTab":"tab");return Ji},pc=y.AFrameworkApplication.va.Nf(Sb,be,pc,!0,zc,Bi.n4f?Sd():Yc),!Rf&&Mf&&(be===ub.a.KI||be===ub.a.ZQ)){const Ji=ze.a.Tqa(ge.gb.currentSelection).y;df.a.vuc(()=>{this.iLn(ge,ke,Ji)})}}32===pc&&Sb.view.te&&this.Yg.pI();return pc};this.qqa=b;this.F9e=h;this.Sn=r;this.U4=A;this.X0=M;this.H9e=aa;this.GPa=
oa;this.Bd=Ja;this.Qc=fb;this.fUe=Cb}get Yg(){return this.An||(this.An=this.qqa())}Xb(){const b=y.AFrameworkApplication.va,h=this.mdp;b.fb(ub.a.tab,lc.a.view,h,1124);b.fb(ub.a.Nxe,lc.a.view,h,1124);b.qa(ub.a.HQi,lc.a.view,ce.ActionManager.Zf)}iLn(b,h,r){if(b&&h){var A=b.gb.currentSelection;ze.a.Tqa(A).y<r?(h=ze.a.P_c(h,A,!1),h=ze.a.wAa(h,{BE:!1,Eu:!1,QG:!1,aJ:!0})):h=ze.a.m2d(h,A,!1);b.Kc(h)}}URk(){return ub.a.u$a}eRi(){}Qcd(b,h,r){if(b&&h){var A=b.gb.currentSelection;ze.a.Tqa(A).y<r?(h=ze.a.P_c(h,
A,!1),h=ze.a.wAa(h,{BE:!1,Eu:!1,QG:!1,aJ:!0})):h=ze.a.wAa(A,{BE:!1,Eu:!1,QG:!1,aJ:!0});b.Kc(h)}}static get rg(){return re.a.instance}}Object(u.a)(GI,"TabActor",null,[]);class RK{constructor(b){this.nIc=b}get ir(){return this.nIc}Qco(b){return b}HQm(b,h,r,A){A=A.view;const M=A.mb.gb.currentSelection;if($g.TableCellReader.Vfa(b))return this.uXi(b,h)?ub.a.KI:ub.a.Vje;Bb.OutlineElementNavigator.je(b);if(ze.a.pf(h))Db.OutlineElementReader.UA(b,h,!1)&&this.pRj(b)?r=ub.a.MXb:ze.a.Ree(A,M)&&this.ir.bLb(b)?
r=ub.a.KI:ze.a.Ree(A,M)&&(r=ub.a.KI);else if(ze.a.Zl(h)){if(!this.ir.bLb(b))return r;ze.a.Jsb(h)?r=ub.a.KI:ze.a.I1i(h)&&(r=this.pRj(b)?ub.a.MXb:ub.a.KI)}else this.ir.bLb(b)&&(r=ub.a.KI);return r}GQm(b,h,r){if($g.TableCellReader.h3(b))return this.uXi(b,h)?ub.a.ZQ:r;Bb.OutlineElementNavigator.je(b);if(ze.a.pf(h))Db.OutlineElementReader.UA(b,h,!1)&&(!of.ListItemReader.Cg(b)&&Db.OutlineElementReader.isEmpty(b,!1)?r=ce.ActionManager.DCa:this.QZo(b)?r=ub.a.kob:this.BQj(b)?r=ub.a.YMb:this.ir.Qdc(b)&&(r=
ub.a.ZQ));else if(ze.a.Zl(h)){if(!this.ir.Qdc(b))return r;ze.a.Jsb(h)?r=ub.a.ZQ:ze.a.I1i(h)&&(r=this.BQj(b)?ub.a.YMb:ub.a.ZQ)}else this.ir.Qdc(b)&&(r=ub.a.ZQ);return r}pRj(b){return of.ListItemReader.Cg(b)?!1:0<Db.OutlineElementReader.K2(b)?!0:!1}BQj(b){if(of.ListItemReader.Cg(b))return!1;const h=Db.OutlineElementReader.K2(b);b=gm.OutlineReader.q_(b.currentNode);return h<b?!0:!1}QZo(b){return of.ListItemReader.Cg(b)?!1:0<Db.OutlineElementReader.jI(b)?!0:!1}static Qs(){return new RK(Rj.a.UPb)}uXi(b,
h){if(this.qmn){const r=new vd.a;r.hd(b);Bb.OutlineElementNavigator.je(r);if(of.ListItemReader.Cg(r)&&Db.OutlineElementReader.UA(r,h,!1))return!0}return!1}get qmn(){var b;y.AFrameworkApplication.vd("egdi3422;7g6fa693");return null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.QOEForListInTableIsEnabled",!1)}}Object(u.a)(RK,"TabActorPromoteDemoteStrategy",null,[500]);class DA extends GI{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc){super(b,
h,r,A,M,aa,oa,Ja,fb,Cb);this.yme=(zc,Yc)=>{zc=Yc.property;!this.hkd||zc!==Mc.a.np&&zc!==Mc.a.marginLeft&&zc!==Mc.a.marginRight||this.hkd.VSi()};this.q_=(zc,Yc,Kd,ke,ge)=>{zc=gm.OutlineReader.q_(this.TBm(Yc));ge.defaultTabStop=zc;return 32};this.W8b=Gb;this.ga=pc;this.zE();this.ga.qa(Fc.a.q_,lc.a.view,this.q_)}get hkd(){return null!=this.Y1g?this.Y1g:this.Y1g=Za.a.instance.Oa(1095)}zE(){this.W8b.Ll.jf(10).jo(this.yme)}eRi(b){const h=b.view,r=h.mb;b=r.Mg;if(this.GPa&&this.Qc){var A=this.Qc.Nc(15);A.Bb(b.node);
b.contextId===lc.a.Cd&&y.AFrameworkApplication.va.Ob(ub.a.JJ,2);this.GPa.hbe(r.Mg);A.dispose();var M=ze.a.Tqa(r.gb.currentSelection).y;df.a.vuc(()=>{this.Qcd(r,h,M)})}}TBm(b){return b.view.mb.gb.currentSelection.Qa.node}static get instance(){return null!=DA.UYg?DA.UYg:DA.UYg=DA.Pm()}static Pm(){return new DA(()=>Za.a.instance.resolve(50),RK.Qs(),Za.a.instance.Ra(51),Za.a.instance.resolve(105),Za.a.instance.resolve(70),Za.a.instance.Oa(116),Za.a.instance.Oa(951),Za.a.instance.Oa(12),Za.a.instance.Oa(263),
Za.a.instance.Oa(1102),df.a.gf,Za.a.instance.Oa(293),y.AFrameworkApplication.va)}}Object(u.a)(DA,"TabActor",GI,[]);class Mu{static get Zu(){return null!=Mu.hSg?Mu.hSg:Mu.hSg=Za.a.instance.resolve(349)}static initialize(){Lr.a.poc=Mu.qnn;gg.a.instance.tA(Mu.vil)}static vil(){Mu.gEp()}static qnn(b){return!Ii.TableReader.Xhn(b)}static ivb(){Mu.Zu.Juc(Mu.ivb);Mu.cGb=!1;const b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Table")&&
appChrome.api.dispatch(appChrome.actions.setCurrentTab("Table"))}static gEp(){var b,h,r;((null===(b=mt.a.instance.currentSelection)||void 0===b?0:b.GLa)||(null===(h=mt.a.instance.currentSelection)||void 0===h?0:h.Rw)||(null===(r=mt.a.instance.currentSelection)||void 0===r?0:r.yab))&&!Mu.cGb&&(Mu.Zu.E5a(Mu.ivb),Mu.cGb=!0)}}Mu.cGb=!1;Object(u.a)(Mu,"TableActor",null,[]);var IO=d(357),cP=d(666),SK=d(932);class wi{static get Nva(){return null!=wi.j4g?wi.j4g:wi.j4g=Ep.a.instance}static get Od(){return null!=
wi.O4g?wi.O4g:wi.O4g=Za.a.instance.Oa(46).instance}static get pYj(){wi.mJ||(wi.mJ=new os("TableBorder"),wi.Ffa(wi.mJ));return wi.mJ}static get gB(){wi.oya||(wi.oya=Za.a.instance.Oa(873),wi.oya.initialize());return wi.oya}static Xb(){const b=y.AFrameworkApplication.va,h=df.a.V_a.IWc(r=>wi.Ubm(r));b.qa(ub.a.czb,lc.a.view,wi.zdb);b.qa(ub.a.czb,lc.a.table,wi.ydb);b.Pc(ub.a.czb,4);b.qa(ub.a.Eeb,lc.a.view,wi.zdb);b.qa(ub.a.Eeb,lc.a.table,wi.ydb);b.Pc(ub.a.Eeb,4);b.qa(ub.a.Feb,lc.a.view,wi.zdb);b.qa(ub.a.Feb,
lc.a.table,wi.ydb);b.Pc(ub.a.Feb,4);b.qa(ub.a.hzb,lc.a.view,wi.zdb);b.qa(ub.a.hzb,lc.a.table,wi.ydb);b.Pc(ub.a.hzb,4);b.qa(ub.a.ezb,lc.a.view,wi.zdb);b.qa(ub.a.ezb,lc.a.table,wi.ydb);b.Pc(ub.a.ezb,4);b.qa(ub.a.fzb,lc.a.view,wi.zdb);b.qa(ub.a.fzb,lc.a.table,wi.ydb);b.Pc(ub.a.fzb,4);b.qa(ub.a.gzb,lc.a.view,wi.zdb);b.qa(ub.a.gzb,lc.a.table,wi.ydb);b.Pc(ub.a.gzb,4);b.qa(ub.a.dzb,lc.a.view,wi.zdb);b.qa(ub.a.dzb,lc.a.table,wi.ydb);b.Pc(ub.a.dzb,4);b.qa(ub.a.lTa,lc.a.view,wi.zdb);b.qa(ub.a.lTa,lc.a.table,
wi.ydb);b.Pc(ub.a.lTa,4);b.qa(ub.a.Epe,lc.a.view,wi.Epe);b.qa(ub.a.fha,lc.a.view,wi.uxe);b.qa(ub.a.fha,lc.a.p4,wi.txe);b.qa(ub.a.fha,lc.a.J0,wi.vxe);b.Pc(ub.a.fha,4);b.qa(ub.a.Tub,lc.a.view,wi.uxe);b.qa(ub.a.Tub,lc.a.p4,wi.txe);b.qa(ub.a.Tub,lc.a.J0,wi.vxe);b.Pc(ub.a.Tub,4);b.qa(ub.a.Vgg,lc.a.view,wi.E3);b.Pc(ub.a.Vgg,4);b.qa(ub.a.Vdb,lc.a.view,wi.uxe);b.qa(ub.a.Vdb,lc.a.p4,wi.txe);b.qa(ub.a.Vdb,lc.a.J0,wi.vxe);b.Pc(ub.a.Vdb,4);b.fb(ub.a.wtc,lc.a.view,wi.wtc,1124);b.qa(ub.a.Wdb,lc.a.view,wi.uxe);
b.qa(ub.a.Wdb,lc.a.p4,wi.txe);b.qa(ub.a.Wdb,lc.a.J0,wi.vxe);b.Pc(ub.a.Wdb,4);b.fb(ub.a.xtc,lc.a.view,wi.xtc,1124);b.qa(ub.a.aNa,lc.a.view,h);b.qa(ub.a.aNa,lc.a.p4,wi.aNa);b.qa(ub.a.aNa,lc.a.J0,wi.aNa);b.Pc(ub.a.aNa,97)}static rM(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Za.a.instance.Ra(2);b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}static zdb(b,
h,r,A){if(1===r)return 32;if(!h.view.te)return 2;const M=h.view;if(!M.mb||!M.mb.gb)return 8;h=M.mb.gb;if(2===r){v.ULS.sendTraceTag(578027873,306,50,"Selecting table border using border gallery");if((r=sc.SelectionFactory.Trd(h))&&Ii.TableReader.zU(r))return y.AFrameworkApplication.va.Nf(wc.a.create(r),b,2,!1,A,null);r=M.mb.Mg;if(!r)return 8;A=Object(Al.a)().hU(r,16);r=Object(Al.a)().wW(r,14);if(!r)return Lr.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],nf.a.qsb),8;if(!wi.kJg(r.node,
A,h))return 8;b=SK.getTableCellBorderContext($u.TableBorderSelectionCache.ica,$u.TableBorderSelectionCache.WVa(),b);if(!b||0>=b.length)return Lr.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],nf.a.qsb),8;$u.TableBorderSelectionCache.oyb(b);b=sc.SelectionFactory.pMb(b,!0);h=null;b&&(h=sc.SelectionFactory.wra(b));if(!h||0>=h.currentSelection.length)return Lr.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],nf.a.qsb),8;gg.a.instance.G0(h)}return 32}static ydb(b,
h,r){if(1===r)return 32;if(2!==r||14!==h.node.type)return 2;b=SK.getTableBorderContext(h.node,b);if(!b)return Lr.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],nf.a.qsb),8;b=sc.SelectionFactory.ufc(b,!0);h=null;b&&(h=sc.SelectionFactory.wra(b));if(!h||0>=h.currentSelection.length)return Lr.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],nf.a.qsb),8;gg.a.instance.G0(h);return 32}static Epe(b,h,r,A,M){if(1===r)return 32;b=h.contextId===lc.a.view?
Um.PageReader.instance.ZPb(h):IO.a.mLf(h);if(!b)return 8;h=new Is;r="";32===y.AFrameworkApplication.va.Pb(ub.a.aNa,2,h)&&h&&(r=h.borderColor);wi.pYj.gca=r;b=wi.pYj.Opb(b,df.a.VTa);if(!b)return 8;M.MenuItems=b;v.ULS.sendTraceTag(578027874,340,50,"Table border color dropdown menu is opened.");return 32}static uxe(b,h,r,A,M){if(!wi.gB)return 2;if(1===r)return 32;if(!h.view.te)return 2;var aa=h.view;if(!aa.mb||!aa.mb.gb)return 8;h=aa.mb.gb;if(2===r){v.ULS.sendTraceTag(578027875,306,50,"Setting table border property for the command: {0} with action data {1}",
b,wi.Z0c(b,M));r=sc.SelectionFactory.U2j(h);if(!r){const oa=sc.SelectionFactory.Trd(h);oa&&14===oa.type&&(r=ok.TableNodeBorderContext.fka(oa,4))}if(r)return y.AFrameworkApplication.va.Nf(r,b,2,!0,A,M);r=sc.SelectionFactory.GJg(h);if(!r||0>=r.length){r=aa.mb.Mg;if(!r)return 8;aa=Object(Al.a)().hU(r,16);r=Object(Al.a)().wW(r,14);if(!r||!wi.kJg(r.node,aa,h))return 8;r=SK.getTableCellBorderContext($u.TableBorderSelectionCache.ica,$u.TableBorderSelectionCache.WVa(),ub.a.lTa);if(!r||0>=r.length)return 8}aa=
sB.a.OIa(r);if(!aa)return 8;wi.rM();h=new Rb.GraphTransaction(15);h.Bb(r[0].node);h.Ii=b;b=y.AFrameworkApplication.va.Nf(aa,b,2,!0,A,M);h.dispose();return b}return 32}static txe(b,h,r,A,M){if(!wi.gB)return 2;if(1===r)return 32;if(2!==r||h.contextId!==lc.a.p4)return Lr.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],nf.a.u1d),2;v.ULS.sendTraceTag(578027904,306,50,"Setting table border property for the table border for the command: {0} with action data {1}",b,wi.Z0c(b,M));
r=h.node;A=new en;let aa=0;({qYj:A,property:aa}=wi.z$h(r,b,M,A,aa));wi.rM();M=!0;const oa=new Rb.GraphTransaction(15);oa.Bb(r);oa.Ii=b;if(M=wi.gB.COo(h,A,aa))b=new vd.a,b.set(r),Oh.forEachCellInTable(b,Ja=>{Ja.currentNode.km(4,!0);return!0});oa.dispose();M&&wi.Od&&wi.Od.Yu(16);return M?32:(Lr.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],nf.a.u1d),8)}static vxe(b,h,r,A,M){if(!wi.gB)return 2;if(1===r)return 32;if(2!==r||h.contextId!==lc.a.J0)return Lr.a.recordQosError("TableBorderActionNoResponse",
["TableInteractionFailed"],nf.a.u1d),2;v.ULS.sendTraceTag(578027905,306,50,"Setting table border property for the cell border for the command: {0} with action data {1}",b,wi.Z0c(b,M));r=h.node;A=new en;let aa=0;({qYj:A,property:aa}=wi.z$h(r,b,M,A,aa));(b=wi.gB.Rxg(Gj.a.ZW(h),h,A,aa))&&wi.Od&&wi.Od.Yu(16);return b?32:(Lr.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],nf.a.u1d),8)}static E3(b,h,r){if(1===r)return 32;qa.StaticActiveAppFrame.za().dismissFloatie();wi.rFa=new Xt("TableBorder",
ub.a.fha);wi.rFa.zyb(0);return 32}static wtc(b,h,r,A,M){if(!wi.gB)return 8;if(1===r)return 32;b=wi.gB.WEf();M.MenuItems=b;return 32}static xtc(b,h,r,A,M){if(!wi.gB)return 8;if(1===r)return 32;b=wi.gB.XEf();M.MenuItems=b;return 32}static aNa(b,h,r,A,M){if(!wi.gB)return 2;if(!ze.a.q$c(h)&&!ze.a.r$c(h))return 8;b=Object(ya.a)(Is,M);if(!b)return 8;ze.a.q$c(h)?wi.gB.fio(h,b):wi.gB.Dgo(h,b);return 32}static kJg(b,h,r){if(!b||14!==b.type)return v.ULS.sendTraceTag(578027906,306,15,"Table node must be present"),
!1;if(!h)return v.ULS.sendTraceTag(578027907,306,15,"Cell context must be present"),!1;if(r&&r.currentSelection&&r.currentSelection.We&&r.currentSelection.We.Qa&&r.currentSelection.We.Qa.contextId===lc.a.J0&&$u.TableBorderSelectionCache.WVa()&&0<$u.TableBorderSelectionCache.WVa().length)return!0;$u.TableBorderSelectionCache.S6c(b);r=$u.TableBorderSelectionCache.ica;for(let M=0;M<h.length;M++){if(h.getContext(M).contextId!==lc.a.ax)return!1;const aa=h.getContext(M).node;if(!$g.TableCellReader.Us(aa)){var A=
new vd.a;A.set(aa);if(A.vb(14)&&Oh.getContainingTable(A)===b){A.ld(14);A=$g.TableCellReader.cKa(A,aa);if(!A)return!1;Array.add($u.TableBorderSelectionCache.WVa(),new cP.a(aa,A.rowIndex,A.gp,aa.rowSpan,aa.colSpan));r.leftMostColumnSelected=Math.min(r.leftMostColumnSelected,A.gp);r.rightMostColumnSelected=Math.max(r.rightMostColumnSelected,A.gp);r.topMostRowSelected=Math.min(r.topMostRowSelected,A.rowIndex);r.bottomMostRowSelected=Math.max(r.bottomMostRowSelected,A.rowIndex)}}}$u.TableBorderSelectionCache.ica=
r;return!0}static Ffa(b){b.BG(3,ub.a.fha);b.BG(4,ub.a.fha);b.C5a(iw.a.instance,1)}static Ubm(b){const h=b.gb;var r=sc.SelectionFactory.U2j(h);if(!r){const A=sc.SelectionFactory.Trd(h);A&&14===A.type&&(r=ok.TableNodeBorderContext.fka(A,4))}if(r)return sB.a.OIa([r]);r=sc.SelectionFactory.GJg(h);if(!r||0>=r.length){r=b.Mg;if(!r)return null;b=Object(Al.a)().hU(r,16);r=Object(Al.a)().wW(r,14);if(!r||!wi.kJg(r.node,b,h))return null;r=SK.getTableCellBorderContext($u.TableBorderSelectionCache.ica,$u.TableBorderSelectionCache.WVa(),
ub.a.lTa);if(!r||0>=r.length)return null}return sB.a.OIa(r)}static z$h(b,h,r,A,M){switch(h){case ub.a.fha:A.color=wi.Nva.Qja(b,r);M=3;break;case ub.a.Tub:A.style="none";M=2;break;case ub.a.Vdb:(b="object"===typeof r?r:null)&&"MenuItemId"in b&&(A.style=wi.gB.Csi(b.MenuItemId));M=2;break;case ub.a.Wdb:(b="object"===typeof r?r:null)&&"MenuItemId"in b&&(A.weight=wi.gB.Dsi(b.MenuItemId)),M=1}return{qYj:A,property:M}}static Z0c(b,h){let r="";if(!h)return r;switch(b){case ub.a.fha:r=h;break;case ub.a.Tub:r=
"none";break;case ub.a.Vdb:case ub.a.Wdb:(b="object"===typeof h?h:null)&&"MenuItemId"in b&&(r=b.MenuItemId)}return r}}wi.mJ=null;wi.rFa=null;wi.oya=null;Object(u.a)(wi,"TableBorderActor",null,[]);class bM{E7l(b,h,r,A){return b?this.e6l(h,r,A):this.F7l(h,r,A)}dni(b,h,r,A,M){return b?this.f7l(h,r,A,M):this.U6l(h,r,A,M)}R6l(b){let h=!1;var r=b.Kf?b.We.Wc:b.We.Qa;b=new vd.a;b.set(r.node);b.vb(14);r=null;$g.TableCellReader.Pfa(b)?$g.TableCellReader.MSb(b)||(h=!0,r=Oh.moveToNextRow(b)):r=Oh.moveToNextColumn(b);
return{returnValue:r,CLn:h}}a7l(b){var h=b.Kf?b.We.Wc:b.We.Qa;const r=new vd.a;r.set(h.node);r.vb(14);h=null;$g.TableCellReader.Ila(r)?$g.TableCellReader.Hla(r)||(h=new vd.a,h.set(b.jza.node),h.vb(14),b=zq.a.Gt(h),zq.a.Gt(r)>b?(Oh.moveToPreviousRow(r),Oh.moveToLastColumn(r),h=r.currentNode):h=Oh.moveToPreviousRow(r)):h=Oh.moveToPreviousColumn(r);return h}oni(b,h){var r=b.Kf?b.We.Wc:b.We.Qa;b=new vd.a;b.set(r.node);b.vb(14);r=null;h?$g.TableCellReader.Hla(b)||(r=Oh.moveToPreviousRow(b)):$g.TableCellReader.MSb(b)||
(r=Oh.moveToNextRow(b));return r}GTb(b,h,r){for(;$g.TableCellReader.Tg(b);)if(h){if(r&&b.MBa(1)||!r&&b.SBa(1))return null;r?Oh.moveToPreviousColumn(b):Oh.moveToNextColumn(b)}else{if($g.TableCellReader.z7(b.currentNode)){const A=new vd.a;A.hd(b);if(this.GTb(A,!0,!0)||this.GTb(A,!0,!1)){b.hd(A);break}}else{if(!r&&Oh.moveToControllingCell(b,2))break;if(r&&Oh.moveToControllingCell(b))break}if(r&&$g.TableCellReader.Hla(b)||!r&&$g.TableCellReader.MSb(b))return null;r?Oh.moveToPreviousRow(b):Oh.moveToNextRow(b)}return b.currentNode}Xhc(b,
h){if(!zq.a.isTableRow(b))return null;b=vd.a.Za(b.currentNode);b.vb(14);let r;const A=Ii.TableReader.kD(b.origin);do r=h?Oh.moveToPreviousRow(b):Oh.moveToNextRow(b);while(A&&r&&zq.a.ZWa(b));return r}Gub(b,h,r,A,M){let aa=null;Bb.OutlineElementNavigator.je(b);const oa=Db.OutlineElementReader.isRtl(b.currentNode);if(r)if(Oh.returnToCell(b),h=$g.TableCellReader.Pfa(b),r=$g.TableCellReader.Ila(b),M||!oa&&r||oa&&A&&h)Oh.returnToContainingRow(b),(A=this.Xhc(b,!0))?aa=sc.SelectionFactory.hp(A,!h):M&&(Bb.OutlineElementNavigator.je(b),
M=new xm.a,M.hd(b),(b=Bb.OutlineElementNavigator.z3(M,!1,!1))&&(aa=sc.SelectionFactory.hp(b,!1)));else{do oa?Oh.moveToNextColumn(b):Oh.moveToPreviousColumn(b);while($g.TableCellReader.Tg(b)&&!$g.TableCellReader.Hla(b));$g.TableCellReader.Tg(b)||(aa=sc.SelectionFactory.hp(b.currentNode,!oa))}else Db.OutlineElementReader.UA(b,h,oa)||ze.a.pf(h)||Oh.returnToCell(b),aa=sc.SelectionFactory.hp(b.currentNode,!oa);return aa}Fub(b,h,r,A,M){let aa=null;Bb.OutlineElementNavigator.je(b);const oa=Db.OutlineElementReader.isRtl(b.currentNode);
if(r)if(Oh.returnToCell(b),r=$g.TableCellReader.Pfa(b),h=$g.TableCellReader.Ila(b),M||!oa&&A&&r||oa&&!A&&h)Oh.returnToContainingRow(b),(A=this.Xhc(b,!1))?aa=sc.SelectionFactory.hp(A,h):(Bb.OutlineElementNavigator.je(b),A=new xm.a,A.hd(b),(b=Bb.OutlineElementNavigator.Zs(A,!1,!1))&&(aa=sc.SelectionFactory.hp(b,!0)));else{do oa?Oh.moveToPreviousColumn(b):Oh.moveToNextColumn(b);while($g.TableCellReader.Tg(b)&&!$g.TableCellReader.Pfa(b));$g.TableCellReader.Tg(b)||(aa=sc.SelectionFactory.hp(b.currentNode,
oa))}else Db.OutlineElementReader.UA(b,h,!oa)||ze.a.pf(h)||Oh.returnToCell(b),aa=sc.SelectionFactory.hp(b.currentNode,oa);return aa}}Object(u.a)(bM,"ATableCellSelectionStrategy",null,[1605]);class BN extends bM{constructor(){super()}U6l(b,h,r,A){let M=b.currentSelection,aa=null;if(b.Rw)if(h)if(2===M.We.oma&&!M.Kf&&M.We.Wc.equals(M.jza))M=sc.SelectionFactory.p$h(M.jza.node,!1);else{var oa=({CLn:b}=this.R6l(M)).returnValue;oa&&($g.TableCellReader.Us(oa)&&(oa=vd.a.Za(oa),oa.vb(14),oa=!b&&this.GTb(oa,
!0,!1)?oa.currentNode:b||Oh.moveToNextRow(oa)?this.GTb(oa,!1,!1):null),oa&&(aa=sc.SelectionFactory.Qo(ux.TableNodeContext.create(oa),M.Kf)))}else M=b.zha,b=vd.a.Za(M.We.Wc.node),b.vb(14),$g.TableCellReader.oLa(b.currentNode)&&Oh.moveToLastGhostCell(b,2),(oa=Oh.moveToNextColumn(b))?(b=$g.TableCellReader.z7(oa),$g.TableCellReader.Us(oa)&&!b&&(oa=vd.a.Za(oa),oa.vb(14),oa=Oh.moveToControllingCell(oa)),b?M=sc.SelectionFactory.hp(M.We.Wc.node,!1):aa=sc.SelectionFactory.hp(oa,!0)):(oa=M.We.Wc.node,aa=sc.SelectionFactory.hp(oa,
!1));else b=h&&M.Kf||!h&&!M.Cta?M.We.Wc:M.We.Qa,zq.a.Yla(b.node)&&(b=vd.a.Za(b.node),(oa=this.Xhc(b,!1))?aa=h?sc.SelectionFactory.Qo(ux.TableNodeContext.create(oa),M.Kf):sc.SelectionFactory.hp(oa,!0):M=ze.a.uk(sc.SelectionFactory.Gr(b.currentNode),!1,!0));return aa?aa:A?ze.a.Whc(M,!1,h,!0):ze.a.wAa(M,{BE:!h,Eu:h,QG:r,aJ:!0})}f7l(b,h,r,A){let M=b.currentSelection;var aa=null;if(b.Rw)h?1===M.We.oma&&M.Kf&&M.We.Qa.equals(M.jza)||(aa=this.a7l(M),(aa=this.bni(M,aa))||M.Kf&&(M=M.m0c())):(M=b.zha,aa=sc.SelectionFactory.hp(M.We.Qa.node,
!0));else if(h){var oa=(M.Kf?M.We.Wc:M.We.Qa).node;b=vd.a.Za(oa);ze.a.tv(b);zq.a.Yla(oa)&&(M.Kf&&1===M.We.oma&&M.Cta?(aa=zq.a.JA(oa).toArray(),(aa=this.bni(M,0<=aa.length-2?aa[aa.length-2]:null))||M.Kf&&(M=M.m0c())):(oa=this.Xhc(b,!0))?aa=sc.SelectionFactory.Qo(ux.TableNodeContext.create(oa),M.Kf):M=sc.SelectionFactory.hp(b.currentNode,!0))}else aa=ze.a.uk(M,!0,!1);return aa?aa:A?ze.a.Whc(M,!0,h,!0):ze.a.MJa(M,{BE:!h,Eu:h,QG:r,aJ:!0})}bni(b,h){if(!h)return null;var r=h;$g.TableCellReader.Us(h)&&(r=
vd.a.Za(h),r.vb(14),r=this.GTb(r,!0,!0)?r.currentNode:$g.TableCellReader.Hka(h));return r?sc.SelectionFactory.Qo(ux.TableNodeContext.create(r),b.Kf):null}F7l(b,h,r){let A=h.currentSelection,M=null;if(h.Rw){var aa=h.d_>h.qOa;if(r)if(2===h.length&&1===h.zha.We.oma&&aa)A=ze.a.uk(A,!0,!1);else{if(h=this.oni(A,!0))$g.TableCellReader.Us(h)&&(h=vd.a.Za(h),h.vb(14),h=this.GTb(h,!1,!0)),h&&(M=sc.SelectionFactory.Qo(ux.TableNodeContext.create(h),A.Kf));M||A.Kf&&(A=A.m0c())}else aa&&(A=h.zha)}else h=r&&A.Kf?
A.We.Wc:A.We.Qa,zq.a.Yla(h.node)&&(h=vd.a.Za(h.node),(aa=this.Xhc(h,!0))?M=r?sc.SelectionFactory.Qo(ux.TableNodeContext.create(aa),A.Kf):sc.SelectionFactory.hp(aa,!0):r&&(A=sc.SelectionFactory.hp(h.currentNode,!0)));return M?M:ze.a.Pnb(b,A,!1,r,r)}e6l(b,h,r){let A=h.currentSelection,M=null;if(h.Rw){const aa=h.d_<h.qOa;if(r)if(2===h.length&&1===h.zha.We.oma&&aa)A=ze.a.uk(A,!1,!1);else{if(h=this.oni(A,!1))$g.TableCellReader.Us(h)&&(h=vd.a.Za(h),h.vb(14),h=this.GTb(h,!1,!1)),h&&(M=sc.SelectionFactory.Qo(ux.TableNodeContext.create(h),
A.Kf))}else aa&&(A=h.zha)}else h=!r||A.Kf?A.We.Wc:A.We.Qa,zq.a.Yla(h.node)&&(h=vd.a.Za(h.node),(h=this.Xhc(h,!1))&&(M=r?sc.SelectionFactory.Qo(ux.TableNodeContext.create(h),A.Kf):sc.SelectionFactory.hp(h,A.Cta)));return M?M:ze.a.Pnb(b,A,!0,r,r)}}Object(u.a)(BN,"TableCellSelectionStrategy",bM,[]);class CN{constructor(b){this.dM=(h,r,A,M,aa)=>{if(1===A)return 32;h=(new Mq.a).create();r="";switch(aa.DialogType){case "DirectPrintPreparingPDF":r=CommonUIStrings.l_DirectPrintPreparingPDF;aa=CommonUIStrings.l_DefaultDialogTitle;
break;default:aa=CommonUIStrings.l_DefaultDialogTitle}h.message=r;h.dM(aa,null,null);return 32};this.ga=b}Xb(){this.ga.fb(ub.a.dM,lc.a.view,this.dM,1028)}}Object(u.a)(CN,"UIAutomationActor",null,[]);class DN{constructor(b,h,r,A){this.jb=b;this.GPa=h;this.dDc=r;this.N9=A}qJg(b,h,r){return this.dDc.dln(h)?r?!0:b&&this.jb.Bh(b)?(b=this.vx(b.currentNode),this.GPa.pRi(b),!0):!1:!1}HQf(b,h){return this.dDc.t0l(b,h)}NQf(b){b&&this.jb.Bh(b)&&(b=this.vx(b.currentNode),this.GPa.hbe(b))}vx(b){return wc.a.vx(b)}pca(b,
h,r){this.N9.Eqj&&this.dDc.WVi(r)&&(this.N9.pca(b,h),b.setValue(pd.a.oWi,!0))}$md(){}hde(b){return this.dDc.hde(b)}get ree(){return this.dDc.ree}GE(){}eha(){}qxe(){}get MRj(){return!1}}Object(u.a)(DN,"WordEditorPasteStewardBridge",null,[485]);class EN{constructor(b){this.sa=new Td.a;this.qHj="WordFileSaveAsButtonClicked";this.iEp=()=>{this.sa.raiseEvent(this.qHj,null);return 32};this.ga=b}Xb(){y.AFrameworkApplication.J.$("UseNewCommandForWordFileMenuSaveAs")&&this.ga.qa(Fc.a.sak,we.a.frame,this.iEp)}M_k(b){this.sa.addHandler(this.qHj,
b)}}Object(u.a)(EN,"WordFileSaveAsActor",null,[]);class FN extends DC{constructor(){super()}CSc(b,h,r,A,M,aa,oa){return Sq.a.gtc(h,r,A,M,aa,oa)}}Object(u.a)(FN,"WordIndentationActorExtension",DC,[]);class GN{constructor(b){this.J7=b;this.twc=()=>32;this.Nde=(h,r,A)=>{if(1===A)return 1===this.J7.Kw?32:8}}Xb(){const b=y.AFrameworkApplication.va;b.qa(ub.a.twc,lc.a.view,this.twc);b.qa(ub.a.Nde,lc.a.view,this.Nde)}}Object(u.a)(GN,"LineNumberingActor",null,[]);class LF{constructor(b,h,r,A,M){this.Rb=b;
this.Nva=h;this.lcb=r;this.t0=A;this.jp=M;this.rFa=this.mJ=null;this.jnd=(aa,oa,Ja)=>{if(1===Ja)return 32;const {paragraphs:fb,isInsideTable:Cb}=this.h7(oa);if(0===fb.length)return 8;if(Cb)return this.Rb.Ob(ub.a.czb,Ja);oa=this.ROb(fb);Ja=this.jp.Nc(15);Ja.Bb(fb[0]);Ja.Ii=aa;for(const Gb of fb)this.lcb.Oxb(Gb,[1],oa);Ja.dispose();return 32};this.pnd=(aa,oa,Ja)=>{if(1===Ja)return 32;const {paragraphs:fb,isInsideTable:Cb}=this.h7(oa);if(0===fb.length)return 8;if(Cb)return this.Rb.Ob(ub.a.hzb,Ja);oa=
this.ROb(fb);Ja=this.jp.Nc(15);Ja.Bb(fb[0]);Ja.Ii=aa;for(const Gb of fb)this.lcb.Oxb(Gb,[0],oa);Ja.dispose();return 32};this.lnd=(aa,oa,Ja)=>{if(1===Ja)return 32;const {paragraphs:fb,isInsideTable:Cb}=this.h7(oa);if(0===fb.length)return 8;if(Cb)return this.Rb.Ob(ub.a.Eeb,Ja);oa=this.ROb(fb);Ja=this.jp.Nc(15);Ja.Bb(fb[0]);Ja.Ii=aa;for(const Gb of fb)this.lcb.Oxb(Gb,[2],oa);Ja.dispose();return 32};this.ond=(aa,oa,Ja)=>{if(1===Ja)return 32;const {paragraphs:fb,isInsideTable:Cb}=this.h7(oa);if(0===fb.length)return 8;
if(Cb)return this.Rb.Ob(ub.a.Feb,Ja);oa=this.ROb(fb);Ja=this.jp.Nc(15);Ja.Bb(fb[0]);Ja.Ii=aa;for(const Gb of fb)this.lcb.Oxb(Gb,[3],oa);Ja.dispose();return 32};this.hnd=(aa,oa,Ja)=>{const {paragraphs:fb,isInsideTable:Cb}=this.h7(oa);return 0===fb.length?8:1===Ja&&Cb?32:1!==Ja||Cb?Cb?this.Rb.Ob(ub.a.ezb,Ja):8:8};this.ind=(aa,oa,Ja)=>{const {paragraphs:fb,isInsideTable:Cb}=this.h7(oa);return 0===fb.length?8:1===Ja&&Cb?32:1!==Ja||Cb?Cb?this.Rb.Ob(ub.a.fzb,Ja):8:8};this.nnd=(aa,oa,Ja)=>{if(1===Ja)return 32;
const {paragraphs:fb,isInsideTable:Cb}=this.h7(oa);if(0===fb.length)return 8;if(Cb)return this.Rb.Ob(ub.a.gzb,Ja);oa=this.ROb(fb);Ja=this.jp.Nc(15);Ja.Bb(fb[0]);Ja.Ii=aa;for(const Gb of fb)this.lcb.Oxb(Gb,[0,1,2,3],oa);Ja.dispose();return 32};this.knd=(aa,oa,Ja)=>{if(1===Ja)return 32;const {paragraphs:fb,isInsideTable:Cb}=this.h7(oa);if(0===fb.length)return 8;if(Cb)return this.Rb.Ob(ub.a.dzb,Ja);oa=this.ROb(fb);Ja=this.jp.Nc(15);Ja.Bb(fb[0]);Ja.Ii=aa;for(const Gb of fb)this.lcb.Oxb(Gb,[4],oa);Ja.dispose();
return 32};this.gnd=(aa,oa,Ja)=>{if(1===Ja)return 32;const {paragraphs:fb,isInsideTable:Cb}=this.h7(oa);if(0===fb.length)return 8;if(Cb)return this.Rb.Ob(ub.a.lTa,Ja);oa=this.ROb(fb);Ja=this.jp.Nc(15);Ja.Bb(fb[0]);Ja.Ii=aa;for(const Gb of fb)this.lcb.Oxb(Gb,[0,1,2,3,4],oa);Ja.dispose();return 32};this.mnd=(aa,oa,Ja)=>{if(1===Ja)return 32;const {paragraphs:fb,isInsideTable:Cb}=this.h7(oa);if(0===fb.length)return 8;if(Cb)return this.Rb.Ob(ub.a.Tub,Ja);oa=this.jp.Nc(15);oa.Bb(fb[0]);oa.Ii=aa;for(const Gb of fb)this.lcb.Uol(Gb);
oa.dispose();return 32};this.Ape=(aa,oa,Ja,fb,Cb)=>{if(1===Ja)return 32;aa=Um.PageReader.instance.ZPb(oa);if(!aa)return 8;const {paragraphs:Gb,isInsideTable:Sb}=this.h7(oa);Sb?(Ja=new Is,this.Rb.Nf(oa,ub.a.aNa,2,!1,void 0,Ja),this.eig.gca=Ja.borderColor):(oa=this.pLf(Gb,!0),this.eig.gca=oa&&void 0!==oa.color?Ol.a.BB(oa.color):"");oa=this.eig.Opb(aa,df.a.VTa);if(!oa)return 8;Cb.MenuItems=oa;return 32};this.Lng=(aa,oa,Ja,fb,Cb)=>{if(1===Ja)return 32;if(!Cb)return 0;const {paragraphs:Gb,isInsideTable:Sb}=
this.h7(oa);Ja=this.pLf(Gb,!0);fb=new Is;Sb&&this.Rb.Nf(oa,ub.a.aNa,2,!1,void 0,fb);if(!Ja&&!Sb)return Cb[Vg.a.On]=!1,32;switch(aa){case Fc.a.gre:Cb[Vg.a.On]=Cb.MenuItemId===this.t0.ehm(Sb?fb.lineStyle:Ja.style);break;case Fc.a.hre:Cb[Vg.a.On]=Cb.MenuItemId===this.t0.hhm(Sb?fb.Ppc:Ja.size);break;case Fc.a.fre:if(!Ja){Cb[Vg.a.On]=!1;break}Cb[Vg.a.On]=Cb.MenuItemId===this.t0.bhm(Ja.space);break;default:return 8}return 32};this.cxe=(aa,oa,Ja,fb,Cb)=>{const {paragraphs:Gb,isInsideTable:Sb}=this.h7(oa);
if(0===Gb.length)return 8;if(1===Ja)return Sb&&aa===Fc.a.s_b?8:32;oa=this.Z0c(aa,Cb);if(Sb)switch(aa){case Fc.a.WDa:return this.Rb.Pb(ub.a.fha,Ja,oa);case Fc.a.t_b:return this.Rb.Pb(ub.a.Vdb,Ja,Cb);case Fc.a.u_b:return this.Rb.Pb(ub.a.Wdb,Ja,Cb);default:return 8}Ja=this.jp.Nc(15);Ja.Bb(Gb[0]);Ja.Ii=aa;for(const pc of Gb)if(Cb=this.t0.Fsi(pc),(fb=this.t0.jGf(pc))&&Cb&&0!==Cb.length){switch(aa){case Fc.a.WDa:fb.color=this.Nva.Qja(pc,oa);this.mad.color=fb.color;break;case Fc.a.t_b:fb.style=this.t0.dhm(oa);
this.mad.style=fb.style;break;case Fc.a.u_b:fb.size=this.t0.ghm(oa);this.mad.size=fb.size;break;case Fc.a.s_b:fb.space=this.t0.ahm(oa),this.mad.space=fb.space}this.lcb.Oxb(pc,Cb,fb)}Ja.dispose();return 32};this.wtc=(aa,oa,Ja,fb,Cb)=>{if(!this.t0)return 8;if(1===Ja)return 32;aa=this.t0.WEf();Cb.MenuItems=aa;return 32};this.xtc=(aa,oa,Ja,fb,Cb)=>{if(!this.t0)return 8;if(1===Ja)return 32;aa=this.t0.XEf();Cb.MenuItems=aa;return 32};this.v$n=(aa,oa,Ja,fb,Cb)=>{if(!this.t0)return 8;if(1===Ja)return 32;
aa=this.t0.scm();Cb.MenuItems=aa;return 32};this.E3=(aa,oa,Ja)=>{if(1===Ja)return 32;qa.StaticActiveAppFrame.za().dismissFloatie();this.rFa=new Xt(LF.jnb,Fc.a.WDa);this.rFa.zyb(0);return 32};this.mad=this.t0.MHf()}get eig(){this.mJ||(this.mJ=new os(LF.jnb),this.Ffa());return this.mJ}Ffa(){this.mJ.BG(3,Fc.a.WDa);this.mJ.BG(4,Fc.a.WDa);this.mJ.C5a(iw.a.instance,1)}Xb(){this.npo();this.qpo();this.ppo()}npo(){y.AFrameworkApplication.va;this.Rb.qa(Fc.a.jnd,lc.a.view,this.jnd);this.Rb.Pc(Fc.a.jnd,4);this.Rb.qa(Fc.a.pnd,
lc.a.view,this.pnd);this.Rb.Pc(Fc.a.pnd,4);this.Rb.qa(Fc.a.lnd,lc.a.view,this.lnd);this.Rb.Pc(Fc.a.lnd,4);this.Rb.qa(Fc.a.ond,lc.a.view,this.ond);this.Rb.Pc(Fc.a.ond,4);this.Rb.qa(Fc.a.hnd,lc.a.view,this.hnd);this.Rb.Pc(Fc.a.hnd,4);this.Rb.qa(Fc.a.ind,lc.a.view,this.ind);this.Rb.Pc(Fc.a.ind,4);this.Rb.qa(Fc.a.nnd,lc.a.view,this.nnd);this.Rb.Pc(Fc.a.nnd,4);this.Rb.qa(Fc.a.knd,lc.a.view,this.knd);this.Rb.Pc(Fc.a.knd,4);this.Rb.qa(Fc.a.gnd,lc.a.view,this.gnd);this.Rb.Pc(Fc.a.gnd,4);this.Rb.qa(Fc.a.mnd,
lc.a.view,this.mnd);this.Rb.Pc(Fc.a.mnd,4)}qpo(){this.Rb.qa(Fc.a.Ape,lc.a.view,this.Ape);this.Rb.qa(Fc.a.WDa,lc.a.view,this.cxe);this.Rb.Pc(Fc.a.WDa,4);this.Rb.qa(Fc.a.gre,lc.a.view,this.Lng);this.Rb.qa(Fc.a.t_b,lc.a.view,this.cxe);this.Rb.Pc(Fc.a.t_b,4);this.Rb.fb(Fc.a.jsj,lc.a.view,this.wtc,1124);this.Rb.qa(Fc.a.hre,lc.a.view,this.Lng);this.Rb.qa(Fc.a.u_b,lc.a.view,this.cxe);this.Rb.Pc(Fc.a.u_b,4);this.Rb.fb(Fc.a.ksj,lc.a.view,this.xtc,1124);this.Rb.qa(Fc.a.fre,lc.a.view,this.Lng);this.Rb.qa(Fc.a.s_b,
lc.a.view,this.cxe);this.Rb.Pc(Fc.a.s_b,4);this.Rb.fb(Fc.a.isj,lc.a.view,this.v$n,1124)}ppo(){this.Rb.qa(Fc.a.Tgg,lc.a.view,this.E3);this.Rb.Pc(Fc.a.Tgg,4)}h7(b){b=mt.a.G5d(b);const h=[];let r=!0;for(const A of b)Gd.ParagraphReader.Vb(A.node)&&(h.push(A.node),Gd.ParagraphReader.wX(A.node)||(r=!1));return{paragraphs:h,isInsideTable:r}}pLf(b,h=!1){if(0!==b.length){var r=this.t0.jGf(b[0]);for(const A of b)if(b=this.t0.jGf(A),h)r=this.bkm(r,b);else if(!this.t0.ASh(r,b)){r=void 0;break}return r}}bkm(b,
h){if(b&&h)return{color:b.color===h.color?b.color:void 0,style:b.style===h.style?b.style:void 0,size:b.size===h.size?b.size:void 0,space:b.space===h.space?b.space:void 0}}Z0c(b,h){var r="";if(!h)return r;switch(b){case Fc.a.WDa:r=(r="object"===typeof h?h:null)&&"Color"in r?r.Color:h;break;case Fc.a.t_b:case Fc.a.u_b:case Fc.a.s_b:(h="object"===typeof h?h:null)&&"MenuItemId"in h&&(r=h.MenuItemId)}return r}ROb(b){b=this.pLf(b);b||(b=this.mad);b||(b=this.t0.MHf());return b}}LF.jnb="ParagraphBorder";
Object(u.a)(LF,"ParagraphBorderActor",null,[]);var dP=d(760),HI=d(487);class EA extends jl.a{constructor(b,h,r){super();this.Rsk="CommonControlChevronDown_12";this.Ook="CommonControlChevronRight_12";this.JCc="aria-label";this.m$b="role";this.flk="alt";this.uma=A=>{if(null===A)return!1;this.hEb.get(A.If).style.visibility="visible";return!0};this.vma=A=>{if(null===A)return!1;this.hEb.get(A.If).style.visibility="collapse";return!0};this.hEb=new Map;this.gl=b;this.Dg=h;this.kd=r}u_a(b){b=this.QJ(b);return Gd.ParagraphReader.ifn(b)}kUa(b){const h=
[];h.push(this.Iea(b.H3));return h}Iea(b){var h;const r=this.QJ(b);var A=b.uh.ownerDocument;const M=fm.a.createElement(A,Lo.a.div);M.className=EA.Qsk;A=this.oEl(A,r.isCollapsed);M.appendChild(A);this.EVf(M,A,r.isCollapsed);const aa=null===(h=this.kd.Le)||void 0===h?void 0:h.wNb;this.Zkn(b.htmlElement,aa)?this.EVf(aa,A,r.isCollapsed):this.EVf(b.htmlElement,A,r.isCollapsed);this.Dg.LI(Jd.a.click,A,this.kua.bind(this),r);return M}oEl(b,h){const r=fm.a.createElement(b,Lo.a.div);r.className=EA.Psk;r.title=
h?WordRibbonStrings.CollapsedHeadingExpandButtonTooltip:WordRibbonStrings.ExpandedHeadingCollapseButtonTooltip;r.style.visibility=h?"visible":"collapse";r.setAttribute(this.m$b,"img");r.setAttribute(this.flk,r.title);r.setAttribute(this.JCc,r.title);b=fm.a.createElement(b,Lo.a.div);b.className=EA.Osk;dP.a.renderIcon(h?this.Ook:this.Rsk,b);r.appendChild(b);return r}EVf(b,h,r){r?(this.Gpp(b),this.hEb.delete(b)):(this.hEb.set(b,h),this.kro(b))}kro(b){this.gl.nb(Jd.a.UR,b,this.uma);this.gl.nb(Jd.a.ML,
b,this.vma)}Gpp(b){this.gl.xc(Jd.a.UR,b,this.uma);this.gl.xc(Jd.a.ML,b,this.vma)}kua(b){if(null===b)return!1;b=b.rq;b.isCollapsed=!b.isCollapsed;HI.a.Ebe([b],4);return!1}QJ(b){return Gd.ParagraphReader.Hv(b.Cb,!0,!1).K(0)}Zkn(b,h){b=Le.a.getElementBounds(b);h=Le.a.getElementBounds(h);return null===b||null===h||b.x>h.x+h.width||h.x>b.x+b.width||b.y>h.y+h.height||h.y>b.y+b.height?!1:!0}}EA.Qsk="WordExpandCollapseIndicatorContainer";EA.Psk="WordExpandCollapseIconContainer";EA.Osk="WordExpandCollapseIcon";
Object(u.a)(EA,"ExpandCollapseIndicatorActor",jl.a,[216]);class MF{constructor(b=MF.fob){this.color=b}}MF.fob=0;MF.gwo=Ol.a.auto;Object(u.a)(MF,"ParagraphShadingProperties",null,[]);class uz{constructor(b,h,r,A,M,aa){this.Rb=b;this.Nva=h;this.HP=r;this.Zpj=A;this.Z5n=M;this.jp=aa;this.T2h=this.GVd=null;this.H$n=(oa,Ja,fb,Cb,Gb)=>{if(1===fb)return 32;if(2===fb&&!Gb)return 8;oa=Um.PageReader.instance.ZPb(Ja);if(!oa)return 8;Ja="";fb={};32===this.Rb.Pb(Fc.a.Zhd,2,fb)&&(Ja=fb[uz.$Ca]);this.Ypj.gca=Ja;
this.HP.kAc(Ja);oa=this.Ypj.Opb(oa,df.a.VTa);if(!oa)return 8;Gb.MenuItems=oa;return 32};this.EVo=(oa,Ja,fb,Cb,Gb)=>{if(1===fb)return 32;this.Rb.Pb(Fc.a.w8,2,Gb);this.HP.gTa(this.Rti(Gb))||v.ULS.sendTraceTag(508151187,340,50,"Color selected from Recent Colors section. Menu: {0}",uz.$Ca);return 32};this.Zhd=(oa,Ja,fb,Cb,Gb)=>{if(1===fb)return 32;const {paragraphs:Sb,isInsideTable:pc}=this.h7(Ja);if(0===Sb.length)return 32;if(pc){oa={};if(32===this.Rb.Nf(Ja,ub.a.zwb,2,void 0,Cb,oa,void 0)){Ja=oa[uz.Hkl];
if(!Ja)return 8;Gb[uz.$Ca]=Ol.a.BB(Ja);return 32}return 8}Ja=this.cIm(Sb);if(!Ja)return 8;Gb[uz.$Ca]=Ja;return 32};this.uzg=(oa,Ja,fb,Cb,Gb)=>{if(1===fb)return 32;fb=this.Rti(Gb);if(!fb)return 8;const {paragraphs:Sb,isInsideTable:pc}=this.h7(Ja);if(0===Sb.length)return 32;Gb=(Gb="object"===typeof Gb?Gb:null)&&"SourceControlId"in Gb&&"AutomaticParagraphShadingColor"===Gb.SourceControlId;if(pc)return this.Rb.Nf(Ja,Gb?ub.a.x6a:ub.a.s8,2,void 0,Cb,fb,void 0);Ja=this.jp.Nc(15);Ja.Bb(Sb[0]);Ja.Ii=oa;for(const zc of Sb)oa=
new MF(Gb?Ol.a.auto:this.Nva.Qja(zc,fb)),this.Zpj.uzg(zc,oa);Ja.dispose();return 32};this.E3=(oa,Ja,fb)=>{if(1===fb)return 32;qa.StaticActiveAppFrame.za().dismissFloatie();this.T2h=new Xt(uz.$Ca,Fc.a.qnd);this.T2h.zyb(0);return 32};this.Xnf=(oa,Ja,fb,Cb,Gb)=>{if(1===fb)return 32;const {paragraphs:Sb,isInsideTable:pc}=this.h7(Ja);if(0===Sb.length)return 32;if(pc)return this.Rb.Nf(Ja,ub.a.x6a,2,void 0,Cb,Gb,void 0);Ja=this.jp.Nc(15);Ja.Bb(Sb[0]);Ja.Ii=oa;for(const zc of Sb)this.Zpj.Xnf(zc);Ja.dispose();
return 32}}Xb(){this.Rb.qa(Fc.a.w8,lc.a.view,this.uzg);this.Rb.Pc(Fc.a.w8,1028);this.Rb.qa(Fc.a.qnd,lc.a.view,this.EVo);this.Rb.Pc(Fc.a.qnd,1028);this.Rb.qa(Fc.a.Zhd,lc.a.view,this.Zhd);this.Rb.Pc(Fc.a.Zhd,1124);this.Rb.qa(Fc.a.dxe,lc.a.view,this.E3);this.Rb.Pc(Fc.a.dxe,1028);this.Rb.qa(Fc.a.exe,lc.a.view,this.Xnf);this.Rb.Pc(Fc.a.exe,1028);this.Rb.qa(Fc.a.pkg,lc.a.view,this.H$n);this.Rb.Pc(Fc.a.pkg,1124)}get Ypj(){this.GVd||(this.GVd=new os(uz.$Ca),this.Ffa(this.GVd));return this.GVd}Ffa(b){b.BG(1,
Fc.a.w8);b.BG(3,Fc.a.w8);b.BG(4,Fc.a.w8);b.BG(5,Fc.a.qnd);b.BG(2,Fc.a.exe);b.BG(6,Fc.a.dxe);b.C5a(iw.a.instance,1)}h7(b){b=mt.a.G5d(b);const h=[];let r=!0;for(const A of b)Gd.ParagraphReader.Vb(A.node)&&(h.push(A.node),Gd.ParagraphReader.wX(A.node)||(r=!1));return{paragraphs:h,isInsideTable:r}}Rti(b){if(!b)return"";const h="object"===typeof b?b:null;return h&&"Color"in h?h.Color:b}cIm(b){if(0===b.length)return"";const h=this.AFi(b[0]);for(const r of b)if(h!==this.AFi(r))return"";return h}AFi(b){return(b=
this.Z5n.bIm(b))?Ol.a.BB(b.color):""}}uz.$Ca="ParagraphShading";uz.Hkl="CellShading";Object(u.a)(uz,"ParagraphShadingActor",null,[]);class cM{constructor(){this.JHd=this.iEd=null}get name(){return"WordEditor.Actors"}init(){Object(Lb.a)().Le.$fc=!0;y.AFrameworkApplication.va.qa(Fc.a.XCp,we.a.frame,dC);this.W.resolve(1103).Xb(y.AFrameworkApplication.va);GD.instance.Xb();Gm.Xb();yo.Xb(y.AFrameworkApplication.va,this.W.resolve(76));Kk.Xb();DA.instance.Xb();wi.Xb();this.W.resolve(1104).Xb(y.AFrameworkApplication.va);
this.W.resolve(1105).Xb();this.JHd=this.W.resolve(1106);this.JHd.Xb();y.AFrameworkApplication.J.$("WordEditorFormatPainterIsEnabled")&&this.W.resolve(1107).Xb();y.AFrameworkApplication.J.$("WordEditorAutoSaveImprovementIsEnabled")&&this.W.resolve(1108).Xb();y.AFrameworkApplication.J.$("WritingStyleIsEnabled")&&y.AFrameworkApplication.J.$("WordWritingStylesDialogIsEnabled")&&(this.qZ.Aee=!0);y.AFrameworkApplication.J.$("SharedUXThemingIsEnabled")&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",
!1)&&this.W.resolve(1109).Xb();y.AFrameworkApplication.J.$("WordConsumptionViewToEditRedirectIsEnabled")&&this.W.resolve(1110).Xb();this.W.resolve(1111).Xb();this.W.resolve(120).Xb();this.W.resolve(729).Xb();this.W.resolve(1112).Xb();this.W.resolve(1113).Xb();this.W.resolve(1114).Xb();this.W.resolve(1115).Xb();this.W.resolve(1116).Xb();this.W.resolve(1117).Xb();this.W.resolve(1118).Xb();this.W.resolve(1119).Xb();Object(tF.a)()&&this.W.resolve(1120).Xb();this.W.resolve(1121).Xb();this.W.resolve(1122).Xb(y.AFrameworkApplication.va);
this.W.resolve(1123).Xb();this.W.resolve(1124).Xb();this.W.resolve(1125).Xb();this.W.resolve(1126).Xb();this.W.resolve(1127).Xb();this.W.resolve(1012).Xb();const b=this.W.resolve(354);b.iNa(this.W.resolve(1128));this.tWi&&b.iNa(this.W.resolve(1129));this.W.resolve(1130).Xb();this.W.resolve(1131).Tpg();this.W.resolve(1132);this.W.resolve(1133).Xb();this.W.resolve(1134).Xb();this.W.resolve(1135);this.W.resolve(1136).Xb();this.W.resolve(787);this.W.resolve(1137).A0();this.W.resolve(1138).Xb();y.AFrameworkApplication.J.$("GraphicsEditorActorRegistrationUpdateIsEnabled")?
this.opo():this.W.resolve(1139).Xb();this.ZY.Ucb(this.$mk);this.W.resolve(928).JVm()&&qa.StaticActiveAppFrame.za().kb.Kii();qa.StaticActiveAppFrame.za().Fe();Mu.initialize();y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphBordersEditingEnabled",!1)&&this.W.resolve(1140).Xb();y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphShadingEditingEnabled",!1)&&this.W.resolve(1141).Xb()}dispose(){this.JHd&&this.JHd.dispose()}opo(){this.Bd.us.isCompleted?
this.Bd&&this.Bd.isFeatureEnabled(43)&&this.W.resolve(1139).Xb():this.Bd.us.continueWith(()=>{this.Bd&&this.Bd.isFeatureEnabled(43)&&(this.W.resolve(1139).Xb(),qa.StaticActiveAppFrame.za().Fe())})}get tWi(){var b;y.AFrameworkApplication.vd("j993a635;bdibc659");return null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableExpandCollapse",!1)}get Bln(){if(null==this.iEd)if(this.Bd)if(this.Bd.us.isCompleted)this.iEd=this.Bd.isFeatureEnabled(2);
else return!1;else this.iEd=!1;return this.iEd}uc(b){var h,r;this.W=b;this.Bd=b.Oa(12);this.qZ=this.W.resolve(41);this.qZ.J9c=y.AFrameworkApplication.J.$("WordProofingSecondaryContextualMenuIsEnabled")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorRightClickSecondaryMenuIsEnabled",!1);(new LL).uc(b);b.ia(171,()=>new UF(y.AFrameworkApplication.va,ub.a.Ukf,ub.a.vTc,ub.a.q6,ub.a.Oig,ub.a.paste,ub.a.O3,ub.a.fwb)).ha();b.ia(910,()=>{const A=b.resolve(71);return new Lh(!0,
A.$("SplitHyperlinkFixWithEnterIsEnabled"))}).ha();b.ia(907,()=>{const A=b.resolve(71),M=aa=>!aa.fnc;return new xA(A.$("PasteComplexTablesIsEnabled"),!0,!0,!0,void 0,void 0,void 0,void 0,void 0,void 0,!0,void 0,A.$("SupportCloudFontInExternalPasteIsEnabled"),!0,!0,!0,!0,!0,aa=>aa.fnc,()=>!1,M,M,M,M,void 0,()=>this.Bln,aa=>!aa.fnc)}).ha();b.ia("WordEditor.Actors.WordEditorPasteStewardBridge",()=>new DN(b.resolve(164),b.resolve(951),b.resolve(1142),b.resolve(490))).as(886).ha();b.ia("WordEditor.Actors.PastedContentsProcessorPostMergeAfterPaste",
()=>new EO(b.resolve(1022),b.resolve(12))).as(883).ha();b.ia("Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy",()=>new Lw).as(885).ha();b.ia(1063,()=>new HD(y.AFrameworkApplication.va)).ha();b.ia(1064,()=>new ol(y.AFrameworkApplication.va)).ha();b.ia(825,()=>new sM(y.AFrameworkApplication.va)).ha();b.ia(1062,()=>new OK(y.AFrameworkApplication.va)).ha();b.ia(1116,()=>new zN(y.AFrameworkApplication.va,b.rf(1061))).ha();b.ia(1134,()=>new VL(y.AFrameworkApplication.va,b.rf(1061))).ha();
b.ia(1143,()=>new iN(b.resolve(813),new IL.a)).ha();b.ia(1115,()=>new IK(y.AFrameworkApplication.va,b.rf(1061),b.resolve(1143),y.AFrameworkApplication.J.$("DisablePrint"),y.AFrameworkApplication.J.ib("IrmPolicyDescription"),b.resolve(675))).ha();b.ia(1117,()=>new vN(y.AFrameworkApplication.va,b.rf(1065),b.resolve(1144),br.a.instance,b.resolve(17))).ha();b.ia(1112,()=>new CO(y.AFrameworkApplication.va,b.rf(1061),br.a.instance)).ha();b.ia(1114,()=>new yI(y.AFrameworkApplication.va,b.rf(1061),br.a.instance)).ha();
b.ia(1104,()=>new kF.a(b.Ra(2),bP.a.$1c())).as(1072).ha();b.ia(1113,()=>new Ix(y.AFrameworkApplication.va,b.rf(1061),br.a.instance)).ha();b.ia(1145,()=>new oN(b.resolve(650))).ha();b.register(EF,1146).ha();b.ia(1118,()=>new FO(y.AFrameworkApplication.va,re.a.instance,Za.a.instance.resolve(326),sr.a.instance,Za.a.instance.resolve(43),Za.a.instance.resolve(331),Za.a.instance.resolve(38),Za.a.instance.resolve(1145),Za.a.instance.resolve(1146),this.qZ,Za.a.instance.resolve(343),y.AFrameworkApplication.J.$("WordEditorProofingIgnoreAll"),
Za.a.instance.resolve(920))).ha();(y.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("editorSettingsManager"):b.resolve(77).JD.loadScript("EditorSettingsManager")).then(()=>{const A=b.resolve(1147);A.y2m();A.init();b.ia(1149,()=>new sI(y.AFrameworkApplication.va,b.resolve(1147),()=>new BF(b.resolve(1147),b.resolve(1148)))).ha();y.AFrameworkApplication.J.$("WritingStyleIsEnabled")&&y.AFrameworkApplication.J.$("WordWritingStylesDialogIsEnabled")&&this.W.resolve(1149).Xb()});
b.ia(1119,()=>new NK(Za.a.instance.resolve(1150),Za.a.instance.resolve(46).instance,Za.a.instance.resolve(76),Za.a.instance.Ra(2))).as(1060).ha();Object(tF.a)()&&b.ia(1120,()=>new GN(Za.a.instance.resolve(76))).ha();b.ia(1121,()=>new cN(y.AFrameworkApplication.va,y.AFrameworkApplication.J,hO.a.Gsa(),!!df.a.instance&&df.a.instance.nLa,!!df.a.instance&&df.a.instance.c$c,Za.a.instance.resolve(113),Za.a.instance.resolve(38),Za.a.instance.resolve(480),!!df.a.instance&&df.a.instance.sta)).ha();b.ia(1151,
()=>new eC(b.resolve(618)));b.ia(1131,()=>new OM(b.Ra(324),b.rf(1151),b.rf(1152),b.rf(1153))).ha();b.ia(1111,()=>new XM(y.AFrameworkApplication.va,b.Ra(7))).ha();b.ia(1122,()=>new ip(b.resolve(1020),b.Ra(51),b.resolve(1154),b.resolve(46).instance,b.resolve(1132),b.resolve(50),b.resolve(326),b.resolve(1155),b.resolve(38),b.resolve(349),y.AFrameworkApplication.J)).as("Box4.Actors.ImageActor").ha();b.ia(1138,()=>new EN(y.AFrameworkApplication.va)).ha();b.ia(1154,()=>new QK(b.resolve(1020),y.AFrameworkApplication.J,
y.AFrameworkApplication.ua.pWa,Za.a.instance.resolve(38),b.resolve(46).instance,b.resolve(50),b.resolve(393),b.resolve(12))).ha();b.ia(1103,()=>new TL(Za.a.instance.resolve(623),Za.a.instance.Ra(11),Za.a.instance.Ra(205),Za.a.instance.resolve(1096),Za.a.instance.Ra(454),Za.a.instance.resolve(82),Za.a.instance.resolve(242),Za.a.instance.resolve(164),Za.a.instance.resolve(17),Za.a.instance.resolve(322),Za.a.instance.resolve(46).instance,Za.a.instance.resolve(620))).ha();this.W.ia("WordEditor.Actors.SWordRequestManager",
()=>new AN(b.resolve(1156),b.resolve(1154),y.AFrameworkApplication.J)).as(1132).ha();b.ia("WordEditor.Actors.TableCellSelectionStrategy",()=>new BN).as(49).ha();y.AFrameworkApplication.J.$("WordEditorFormatPainterIsEnabled")&&b.ia("Box4.Actors.FormatPainter",()=>new JM(b.resolve(392),b.resolve(106),b.resolve(101),b.resolve(348),b.resolve(164),b.resolve(322),re.a.instance,b.resolve(12),b.resolve(46).instance,b.resolve(39).instance,b.resolve(376),b.resolve(8),b.resolve(22))).as(95).ha();b.ia(1107,()=>
new Fx(qa.StaticActiveAppFrame.za(),Cd.FocusManager.instance(),y.AFrameworkApplication.va,Rg.a.instance,mt.a.instance,b.resolve(95),b.resolve(326),!0,b.resolve(96),!!df.a.instance&&df.a.instance.sta,b.resolve(480))).ha();b.ia(1123,()=>new kN(y.AFrameworkApplication.va,b.resolve(10))).ha();b.ia(1124,()=>new CN(y.AFrameworkApplication.va)).ha();b.ia(1108,()=>new $L(y.AFrameworkApplication.va,b.resolve(55))).ha();b.ia(1093,()=>new bL(b.Oa(70),b.rf(50),b.Ra(51))).ha();b.ia(934,()=>new yA(Um.PageReader.instance,
b.rf(50),b.resolve(42))).ha();b.ia(1125,()=>new aN(b.resolve(954),b.resolve(988),b.resolve(101),b.resolve(992),b.resolve(623),b.resolve(322),b.resolve(42),b.resolve(8),y.AFrameworkApplication.va,y.AFrameworkApplication.J.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),b.resolve(1157))).ha();b.ia(1130,()=>new jO(y.AFrameworkApplication.va,b.rf(1061),Cd.FocusManager.instance())).ha();b.ia("Box4.Actors.FontNameFormattingStrategyNoop",()=>new iO).as(917).ha();b.ia("WordEditor.GraphicsEditor.GraphicsEditorRequestManager",
()=>new EK(y.AFrameworkApplication.Ee,Object(vo.a)(),b.resolve(322),b.resolve(42),b.resolve(164),b.resolve(385),b.resolve(1020),Za.a.instance.resolve(38),y.AFrameworkApplication.J,b.resolve(12))).as(1135).ha();b.ia(1139,()=>new KF(y.AFrameworkApplication.va,y.AFrameworkApplication.J,b.resolve(1135),b.resolve(1020),b.resolve(393),b.resolve(50),b.resolve(322),b.resolve(42),b.resolve(164),b.resolve(385),b.resolve(1156),y.AFrameworkApplication.Ee,this.Bd,b.resolve(862))).ha();b.ia(1095,()=>new FI).ha();
b.ia(1126,()=>new bN(y.AFrameworkApplication.va,b.resolve(950),b.resolve(110))).ha();b.ia(1012,()=>new Hx(b.resolve(927),y.AFrameworkApplication.va,b.resolve(164))).ha();b.ia(1127,()=>new RL(qa.StaticActiveAppFrame.za(),y.AFrameworkApplication.va,gg.a.instance,b.resolve(928),new Qf.a(()=>qa.StaticActiveAppFrame.za().kb.$c),this.W.resolve(354),this.W.resolve(42),this.W.resolve(728),this.W.resolve(1128),sr.a.instance,this.W.Ra(2),b.resolve(197),Object(Lb.a)(),this.W.rf(1061),this.W.resolve(380),re.a.instance)).ha();
b.ia(1128,()=>new cw(b.resolve(164),Qc.a.instance,this.W.resolve(372),b.resolve(186),new Qf.a(()=>qa.StaticActiveAppFrame.za().kb.Jc))).ha();this.tWi&&b.ia(1129,()=>new EA(ie.a.instance,Qc.a.instance,Object(Lb.a)())).ha();b.ia(1102,()=>new OD).ha();b.ia(1098,()=>new LD(gg.a.instance,b.resolve(20),Object(Lb.a)(),Le.a.getElementBounds,b.resolve(1075))).ha();b.ia(1105,()=>new Tr(y.AFrameworkApplication.va,b.resolve(50),y.AFrameworkApplication.J,b.resolve(1022),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",
!1))).as(1105).ha();b.ia(1075,()=>new bC).as("Box4.UI.IFloatieManager").ha();b.ia(1137,()=>new PM(y.AFrameworkApplication.J,y.AFrameworkApplication.va)).as(1137).ha();b.ia(787,()=>new KD(b.resolve(1075),b.resolve(211),Object(Lb.a)(),Ky.a.instance(),y.AFrameworkApplication.ua,b.resolve(1098),b.resolve(71),b.resolve(895),df.a.gf.Ll.jf(12),b.resolve(201),b.resolve(728),b.resolve(27),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",
!1))).ha();b.ia("Box4.Actors.WordIndentationActorExtension",()=>new FN).as(930).ha();y.AFrameworkApplication.J.$("SharedUXThemingIsEnabled")&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&b.ia(1109,()=>new uN(y.AFrameworkApplication.va)).ha();y.AFrameworkApplication.J.$("WordConsumptionViewToEditRedirectIsEnabled")&&b.ia(1110,()=>new CA(y.AFrameworkApplication.va)).ha();(new GM).uc(b);b.ia(1158,()=>new CF(b.resolve(1030),b.resolve(1035))).as(1158).ha();
b.ia(1159,()=>new LM(y.AFrameworkApplication.va,b.resolve(1035),new bn.b)).ha();b.ia(1106,()=>new MM(y.AFrameworkApplication.va,y.AFrameworkApplication.J,b.resolve(1158),b.resolve(1159),b.resolve(1022),re.a.instance,b.resolve(4),y.AFrameworkApplication.J.$("GetCustomHeaderEnabled")?Za.a.instance.resolve(722):void 0,y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoFromRibbonIfDisabled",!1)?b.resolve(663):void 0)).ha();null!==(r=null===(h=y.AFrameworkApplication.J)||
void 0===h?void 0:h.$("PageLoadStatsDialogIsEnabled"))&&void 0!==r&&r&&d.e(14).then(d.bind(null,2140)).then(A=>{(new A.PageLoadStatsActor(()=>b.resolve(584))).Xb()});this.$mk=new cL;this.ZY=this.W.resolve(372);y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphBordersEditingEnabled",!1)&&this.W.ia(1140,()=>new LF(y.AFrameworkApplication.va,Ep.a.instance,this.W.resolve(1160),this.W.resolve(1161),this.W.resolve(42))).ha();y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphShadingEditingEnabled",
!1)&&this.W.ia(1141,()=>new uz(y.AFrameworkApplication.va,Ep.a.instance,this.W.resolve(788),this.W.resolve(1162),this.W.resolve(1163),this.W.resolve(42))).ha()}static main(){K.a.instance.Lc(new cM)}}Object(u.a)(cM,"WordEditorActorsPackage",null,[0,1]);class NF{constructor(b){this.SDd=!1;this.ujj=()=>{this.SDd=!0;this.uu.pte(this.ujj)};this.uu=b;this.uu.Slb(this.ujj)}}Object(u.a)(NF,"GraphFullyConnectedGetter",null,[519]);class sg{constructor(){this.Drh=Object.assign(new cp.a,{})}KTk(b,h){let r;const A=
b&1023;({value:r}=this.Drh.Ac(A,0)).returnValue||sg.VPm().contains(A)||v.ULS.sendTraceTag(50942149,338,15,"Culture is not supported. LCID {0}; Key: {1}",b,A);r+=h;this.Drh.Z(A,r);return r}static VPm(){sg.WMd||(sg.WMd=new Sa.a,sg.qc(0),sg.qc(1),sg.qc(2),sg.qc(3),sg.qc(4),sg.qc(5),sg.qc(6),sg.qc(7),sg.qc(8),sg.qc(9),sg.qc(10),sg.qc(11),sg.qc(12),sg.qc(13),sg.qc(14),sg.qc(15),sg.qc(16),sg.qc(17),sg.qc(18),sg.qc(19),sg.qc(20),sg.qc(21),sg.qc(22),sg.qc(23),sg.qc(24),sg.qc(25),sg.qc(26),sg.qc(27),sg.qc(28),
sg.qc(29),sg.qc(30),sg.qc(31),sg.qc(32),sg.qc(33),sg.qc(34),sg.qc(35),sg.qc(36),sg.qc(37),sg.qc(38),sg.qc(39),sg.qc(40),sg.qc(41),sg.qc(42),sg.qc(43),sg.qc(44),sg.qc(45),sg.qc(46),sg.qc(47),sg.qc(48),sg.qc(49),sg.qc(50),sg.qc(51),sg.qc(52),sg.qc(53),sg.qc(54),sg.qc(55),sg.qc(56),sg.qc(57),sg.qc(58),sg.qc(59),sg.qc(60),sg.qc(61),sg.qc(62),sg.qc(63),sg.qc(64),sg.qc(65),sg.qc(66),sg.qc(67),sg.qc(68),sg.qc(69),sg.qc(70),sg.qc(71),sg.qc(72),sg.qc(73),sg.qc(74),sg.qc(75),sg.qc(76),sg.qc(77),sg.qc(78),sg.qc(79),
sg.qc(80),sg.qc(81),sg.qc(82),sg.qc(83),sg.qc(84),sg.qc(85),sg.qc(86),sg.qc(87),sg.qc(88),sg.qc(89),sg.qc(90),sg.qc(91),sg.qc(92),sg.qc(93),sg.qc(94),sg.qc(95),sg.qc(96),sg.qc(97),sg.qc(98),sg.qc(99),sg.qc(100),sg.qc(101),sg.qc(102),sg.qc(103),sg.qc(104),sg.qc(105),sg.qc(106),sg.qc(107),sg.qc(108),sg.qc(109),sg.qc(110),sg.qc(111),sg.qc(112),sg.qc(113),sg.qc(114),sg.qc(115),sg.qc(116),sg.qc(117),sg.qc(118),sg.qc(119),sg.qc(120),sg.qc(121),sg.qc(122),sg.qc(124),sg.qc(126),sg.qc(127),sg.qc(128),sg.qc(129),
sg.qc(130),sg.qc(131),sg.qc(132),sg.qc(133),sg.qc(134),sg.qc(135),sg.qc(136),sg.qc(140),sg.qc(145),sg.qc(146),sg.qc(147));return sg.WMd}static qc(b){sg.WMd.add(b&1023)}}sg.WMd=null;Object(u.a)(sg,"LanguagePerParagraphModel",null,[]);class II{constructor(){this.RBg=!1;this.vUd=this.uUd=this.U2b=0;this.l2i=!0;this.UGp=0}}Object(u.a)(II,"UpdateWordCountStateResult",null,[]);class JO extends Sys.EventArgs{constructor(b){super();this.isEnabled=b}}Object(u.a)(JO,"WordCountAvailabilityChangedEventArg",Sys.EventArgs,
[]);class KO{constructor(){this.y_h=this.x_h=this.wordCount=-1;this.vNb=this.SVh=0;this.uNb=1;this.Upj=1033}}Object(u.a)(KO,"WordCountCache",null,[]);class LO extends Sys.EventArgs{constructor(b){super();this.state=b}}Object(u.a)(LO,"WordCountChangedEventArg",Sys.EventArgs,[]);class HN{constructor(){this.UAc=this.iIa=0}}Object(u.a)(HN,"CharsCountResult",null,[]);class dM{constructor(){this.cp=0;this.WAc=null;this.Y$=this.Z$=0}}Object(u.a)(dM,"TextChunkResult",null,[]);class Jx{constructor(){this.hak=
this.Z$=this.Y$=this.wordCount=0}}Object(u.a)(Jx,"WordCountStateForParagraph",null,[]);class Ow{constructor(){this.Cca=this.AL=this.Z$=this.Y$=this.XU=this.wordCount=0;this.currentNode=null;this.d_=-1;this.cp=0;this.gjg=[];this.uNb=this.vNb=this.c6a=this.bjg=this.cjg=0;this.nK=this.YWi=!1;this.CAb=new ib.a;this.Jab=new ib.a}}Object(u.a)(Ow,"WordCountState",null,[]);class Op{constructor(b,h,r,A,M,aa){this.S9o=1E3;this.sa=new Td.a;this.oJb=null;this.BIe=0;this.euk="\ue000";this.OFc=!1;this.TNe=this.INe=
this.Eyd=0;this.gch=this.och=null;this.ENe=this.DNe=this.NNe=0;this.zUl=oa=>{this.oJb=null;this.Bxf(oa.Yl)};this.sJ=h;this.msk=new RegExp(Gn.AParagraphNode.gE,"g");this.Md=b;this.Xi=A;this.an=r;this.o5a=aa;this.A2a=M.$("WordEditorWordCountPackageImageAndTableCountIsEnabled");this.$Jk=M.$("WordEditorWordCountPackageSelectionAdditionalCountsIsEnabled");this.CEj()}get Frn(){return!!this.oJb}get JUa(){return this.OFc}set JUa(b){this.OFc=b}get UPd(){return this.BIe}set UPd(b){this.BIe=b}get CXa(){return!this.BIe}get Mz(){return this.Eyd}get zMb(){return this.INe}get DMb(){return this.TNe}get qKl(){return this.och}get $tf(){return this.gch}get wXc(){return this.NNe}get uXc(){return this.DNe}get vXc(){return this.ENe}Slb(b){this.sa.addHandler(Op.FFe,
b)}pte(b){this.sa.removeHandler(Op.FFe,b)}Fff(b){this.sa.addHandler(Op.UNg,b)}vyo(b){this.sa.removeHandler(Op.UNg,b)}mZd(){this.lZd();this.CEj()}CEj(){this.NNe=this.ENe=this.DNe=this.TNe=this.INe=this.Eyd=-1}dvf(){this.Xze(this.S9o)}Gpd(){const b=new Ow;b.YWi=!0;this.lZd();this.Bxf(b)}Xze(b,h=null){this.CXa&&(this.Frn&&(h=null,this.lZd()),h||(h=new Ow),b=new xc.a(3,1,b,this.zUl,this.WYj),b.Yl=h,this.xYk(b))}lZd(){this.oJb&&(this.Xi.uf(this.oJb),this.oJb=null)}d8j(b,h,r,A,M,aa=!0,oa=-1,Ja=-1,fb=-1,
Cb=1033){const Gb=new II;Gb.U2b=r;Gb.uUd=M;Gb.vUd=A;if(!b.cp&&h.Htd&&aa&&!this.eEi(h))return Op.Txp(b,h.Htd),Gb.l2i=!0,Gb;A=0<=Ja&&0<=fb?{Gd:Ja,endCp:fb}:void 0;r=this.iem(h,A);A&&(Ja=A.Gd,fb=A.endCp);r=0<=fb?r.substring(0,fb):r;fb=0<=Ja&&0<=fb?r.substring(Ja,fb):r;A=b.cp>=Ja?b.cp:Ja;M=b.gjg||[];aa=0<b.cjg?b.cjg:0;let Sb=0<b.bjg?b.bjg:0,pc=[];b.nK=!1;do{this.o5a.update();if(!b.YWi&&(Gb.U2b+pc.length/2>Op.PDp||this.o5a.Mub())){let Kd;M=(Kd=M).concat.apply(Kd,pc);b.cp=A;b.gjg=M;b.bjg=Sb;b.cjg=aa;b.d_=
oa;b.currentNode=h;this.Xze(Op.yHp,b);Gb.RBg=!0;b.nK=!0;return Gb}if((!A||A===Ja)&&0<r.length&&A<r.length){M.push(Ou.a.instance.ONf(r,A));var zc=this.eEi(h);if(0<=oa&&!A&&zc){b.wordCount+=1;Gb.U2b+=1;const Kd=this.Md.N2(zc);zc=this.sJ.Fdd(Kd,zc);zc=Op.oXd(zc);b.Z$+=zc.iIa+1;b.Y$+=zc.iIa-zc.UAc}}zc=this.KIi(r,A,Op.iol);A=zc.cp;let Yc;pc=(Yc=pc).concat.apply(Yc,zc.WAc);aa+=zc.Z$;Sb+=zc.Y$}while(-1!==A);b=this.FRk(b,M,pc,r,fb,Gb.U2b,Gb.uUd,Gb.vUd,h,-1===oa,Cb);Gb.U2b=b.wordCount;Gb.uUd=b.Y$;Gb.vUd=b.Z$;
Gb.UGp=b.hak;return Gb}Pfi(b,h){const r=Gd.ParagraphReader.textLength(h,9);if(r){h=cn.e(h);var A=0;for(let M=0;M<h.length;M++)if(this.Orb&&5===h[M].Qh&&b.AL++,Op.tZo(h[M])){A++;break}h.length!==r?b.XU++:b.XU+=A}}AQj(b){this.UPd=this.UZo(b.c6a,b.wordCount)?1:0;return!!this.UPd}Bnj(b){this.Eyd=b.wordCount;this.INe=b.AL;this.TNe=b.Cca;this.ENe=b.Z$;this.DNe=b.Y$;this.NNe=b.XU;this.och=b.CAb;this.gch=b.Jab;this.Fwj(b)}Fwj(b){this.sa.raiseEvent(Op.FFe,new LO(b))}Ewj(){this.sa.raiseEvent(Op.UNg,new JO(!1))}UZo(b,
h){if(Y.a.Jt||Y.a.eu||Y.a.EF)return!1;(h/=2)||(h=1);return(h?b/h:0)>Op.RGn?!0:!1}get Orb(){const b=!this.S6f||1===this.S6f&&this.$Jk;return this.A2a&&b}MAi(b,h){let r=1033,A=0;b=h.QJf(b);h=new sg;for(let M=0;M<b.length;M++){const aa=h.KTk(b[M].lcid,b[M].end-b[M].Ec);A<aa&&(A=aa,r=b[M].lcid)}return r}FRk(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb){var Sb;h=(Sb=h).concat.apply(Sb,r);r=Ou.a.instance.MIi(h,A);b.wordCount+=r.wordCount;M=Op.oXd(M);Sb=M.iIa-M.UAc;const pc=M.iIa;b.Y$+=Sb;b.Z$+=pc;aa+=r.wordCount;oa+=M.iIa-
M.UAc;Ja+=M.iIa;b.c6a+=r.c6a;const {zWl:zc,Oip:Yc}=Op.ERk(h,A);b.vNb+=zc;b.uNb+=Yc;b.Jab.add(Gb);b.CAb.add(r.wordCount);Cb&&Op.wgl(pc,Sb,fb,r,zc,Yc,Gb);b.cp=0;b.gjg=[];b=new Jx;b.Y$=oa;b.Z$=Ja;b.wordCount=aa;b.hak=r.wordCount;return b}iem(b,h){let r=this.iAo(b);r=Gd.ParagraphReader.rpb(b,9,r,h);return this.ivo(r)}iAo(b){var h=Gd.ParagraphReader.text(b);b=cn.e(b);if(0<b.length){h=h.split("");for(let A=0;A<b.length;++A){let M=!0;var r=!0;const aa=b[A];if(1===aa.Qh)r=aa,r=22!==r.kind&&2!==r.kind;else if(5===
aa.Qh)M=!1;else if(7===aa.Qh||10===aa.Qh)h[aa.Jb.cp]=this.euk,M=!1;if(M){if(aa.Jb.cp>=h.length)return"";h[aa.Jb.cp]=r?" ":"C"}}h=h.join("")}return h}ivo(b){return b.replace(this.msk,"")}KIi(b,h,r){const A=b.length-h<=r;var M=A?b.length:h+r;const aa=new dM;if(M<h)return aa.cp=-1,aa;aa.WAc=Ou.a.instance.mGf(b,h,M);M=Op.oXd(b.substr(h,M));aa.Z$=M.iIa;aa.Y$=M.iIa-M.UAc;if(!aa.WAc.length&&!A)return r===b.length-h?aa:this.KIi(b,h,b.length-h);aa.cp=A||!aa.WAc.length?-1:aa.WAc[aa.WAc.length-1].cp;return aa}xYk(b){this.oJb=
b;this.Xi.Zb(this.oJb)}eEi(b){b=of.ListItemReader.Ce?b:b.bE;if(of.ListItemReader.isListItem(b)){const h=this.Md.N2(b);if(null===h||void 0===h?0:h.Uz)return b}return null}static tZo(b){return 11===b.Qh}static Txp(b,h){b.wordCount+=h.wordCount;b.Y$+=h.x_h;b.Z$+=h.y_h;b.c6a+=h.SVh;b.vNb+=h.vNb;b.uNb+=h.uNb;b.Jab.add(h.Upj);b.CAb.add(h.wordCount)}static wgl(b,h,r,A,M,aa,oa){const Ja=new KO;Ja.wordCount=A.wordCount;Ja.y_h=b;Ja.x_h=h;Ja.SVh=A.c6a;Ja.vNb=M;Ja.uNb=aa;Ja.Upj=oa;r.Htd=Ja}static oXd(b){const h=
b.length,r=new HN;for(let M=0;M<h;M++){var A=b.charCodeAt(M);r.iIa++;if(55296<=A&&56319>=A&&(A=M+1<h?b.charCodeAt(M+1):0,56320<=A&&57343>=A)){M++;continue}I.a.Wfa(b.charAt(M))&&r.UAc++}return r}static ERk(b,h){let r=0,A=0;for(let M=0;M<b.length;++M){const aa=b[M],oa=aa.UN;(3===oa||2===oa)&&aa.cp<h.length&&(++r,I.a.mnc(h.charCodeAt(aa.cp))&&++A)}return{zWl:A,Oip:r}}}Op.FFe="wctek";Op.UNg="wcac";Op.yHp=1;Op.iol=400;Op.PDp=90;Op.RGn=.1;Object(u.a)(Op,"WordCountManagerBase",null,[523]);class IN extends Op{constructor(b,
h,r,A,M,aa,oa,Ja,fb,Cb,Gb){super(b,h,r,M,fb,Cb);this.Zoi=this.lNd=this.Vpa=null;this.mua=()=>{this.dvf()};this.hb=A;this.xd=oa;this.SFh=Ja;this.GK=Gb;this.hb.tA(this.mua);this.aXe=fb.$("ReadingTimeIsEnabled")}get WYj(){return 66}m5m(){if(this.Vpa)return!0;if(!this.hb||!this.hb.gb)return this.xd&&(df.a.isClosing||y.AFrameworkApplication.Sl?this.xd.$b("SelectionWordCountSelectionNullWhenAppExiting",{["Reason"]:"SelectionWordCount triggerred when app is exiting"}):this.xd.$b("SelectionWordCountSelectionNullWhenAppAlive")),
!1;const b=this.hb.gb.clone();this.Vpa=b.WT(!0);if(!this.Vpa||!this.Vpa.ZU())return this.lZd(),!1;this.SFh&&(this.lNd=this.SFh.create(h=>b.WT(h),this.an));this.Vpa.moveNext();return!0}get S6f(){return 1}eyl(b){return b===lc.a.Cd||b===lc.a.paragraph?!0:this.Orb&&(b===lc.a.sOb||b===lc.a.image||b===lc.a.I$)}Bxf(b){this.o5a.reset();if(this.m5m()){for(this.Orb&&this.lNd&&(this.lNd.vUl(b,this.o5a)||this.Xze(1,b));this.Vpa.current;){const A=-1===b.d_?0:b.d_;let M=0;var h=this.Vpa.current;if(!this.eyl(h.contextId)){this.Vpa.moveNext();
continue}if(this.Orb&&Uc.ImageReader.B$a(h)){b.AL++;this.Vpa.moveNext();continue}if(!Gd.ParagraphReader.Vb(h.node)){this.Vpa.moveNext();continue}const aa=h.node;if(this.JUa&&this.Zoi&&this.Zoi.V8a(aa))this.Vpa.moveNext();else{if(this.Orb&&h.isValid){var r=vd.a.Za(aa);for(r.Ub(6);!r.xs;)Uc.ImageReader.It(r.currentNode)&&b.AL++,r.zj(6)}r=this.aXe?this.MAi(aa,this.GK):1033;h=this.d8j(b,aa,0,0,0,this.mde(h),A,h.cpBegin,h.cpEnd,r);if(h.l2i&&(M+=1,100<M)){b.d_=A+1;this.Xze(1,b);return}if(h.RBg)return;this.Pfi(b,
aa);this.Vpa.moveNext()}}this.lNd=this.Vpa=null;this.AQj(b)?(this.Eyd=-1,this.Ewj()):this.Bnj(b)}}mde(b){let h=!1;b.contextId===lc.a.paragraph?h=!0:b.contextId===lc.a.Cd&&(h=b.cpEnd-b.cpBegin===b.node.characterData.length);return h}}Object(u.a)(IN,"SelectionWordCountManager",Op,[]);class TK{constructor(b,h){this.D7b=!1;this.wIb=null;b&&h&&(this.wac=b(!1),this.Zc=h,this.wac.moveNext())}vUl(b,h){if(!b||!this.wac||!this.wac.current)return!0;do{const r=this.wac.current;if(r.contextId===lc.a.Lu||r.contextId===
lc.a.ax){for(this.wIb||this.w5m(r.node);this.wIb.moveNext();)if(14===this.wIb.currentNode.type&&b.Cca++,h.update(),h.Mub())return!1;this.FAl(r,b);this.wIb=null}this.wac.moveNext()}while(this.wac.current);return!0}FAl(b,h){const r=this.Zc.kg(b.node);r.vb(14);b.contextId===lc.a.Lu&&(zq.a.LWi(r)&&(this.D7b=!0),zq.a.Lde(r)&&this.D7b&&(this.D7b=!1,h.Cca++));b.contextId===lc.a.ax&&($g.TableCellReader.s8c(r)&&(this.D7b=!0),$g.TableCellReader.gXa(r)&&this.D7b&&(this.D7b=!1,h.Cca++))}w5m(b){this.wIb=uf.a.gq(b);
14===b.type?this.wIb.pp(TK.I_c,b):this.wIb.pp(TK.I_c,null)}static I_c(b){return b.parentNode?!0:!1}}Object(u.a)(TK,"TableCountSelectionTraverser",null,[525]);class UK{constructor(b){this.A2a=b.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}create(b,h){return this.A2a?new TK(b,h):null}}Object(u.a)(UK,"TableCountSelectionTraverserFactory",null,[517]);class JN extends Op{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb){super(b,h,r,M,fb,Cb);this.RDp=Sb=>{if(Sb.xs)return!0;Sb=Sb.role;return 1===Sb||
2===Sb||this.Orb&&6===Sb||3===Sb||4===Sb||5===Sb||!this.JUa&&(7===Sb||8===Sb)};this.ga=A;this.SFk=aa;this.OOk=oa;this.Pbh=Ja;this.GK=Gb;this.ga.fb(Fc.a.fak,lc.a.application,ce.ActionManager.Zf,64);this.ga.fb(Fc.a.gak,lc.a.application,ce.ActionManager.Zf,64);this.aXe=fb.$("ReadingTimeIsEnabled")}get WYj(){return 63}get S6f(){return 0}Bxf(b){this.o5a.reset();b.nK=!1;var h=this.SFk();Um.PageReader.instance.VSb(h)||(this.mZd(),this.Ewj());h=this.an.tsa(h,7,7).currentNode;var r=this.EEl(b.currentNode,
h);h=this.OOk(r,h);h.pp(this.RDp,null);let A=r=0;for(var M=0;h.moveNext();){if(h.currentNode&&(!of.ListItemReader.Ce||!GE.a.qZf(h.currentNode))&&of.ListItemReader.isListItem(h.currentNode)){var aa=this.Md.N2(h.currentNode);if(aa.Uz){var oa=of.ListItemReader.Ce?h.currentNode:this.Md.KVa(h.currentNode);if(oa&&(oa=oa.ra.last,(null===oa||void 0===oa?0:oa.ni)&&($l.a.B8&&oa.Vh||oa.BU)))continue;b.wordCount+=1;if(aa=this.sJ.Fdd(aa,h.currentNode))aa=Op.oXd(aa),b.Z$+=aa.iIa+1,b.Y$+=aa.iIa-aa.UAc;r+=1;A+=b.Z$;
M+=b.Y$}if(!of.ListItemReader.Ce)continue}if(this.Orb&&h.currentNode&&Uc.ImageReader.It(h.currentNode))b.AL++;else if(this.Orb&&h.currentNode&&Ii.TableReader.zU(h.currentNode))b.Cca++;else if(h.currentNode&&Gd.ParagraphReader.Vb(h.currentNode)){aa=h.currentNode;oa=this.aXe?this.MAi(aa,this.GK):1033;M=this.d8j(b,aa,r,A,M,!0,-1,-1,-1,oa);if(M.RBg){b.nK=!0;return}this.Pfi(b,aa);r=M.U2b;A=M.vUd;M=M.uUd}}this.AQj(b)?(this.mZd(),this.dBo(),this.Fwj(b)):this.Bnj(b)}EEl(b,h){b?(b=this.Pbh(b),b.vb(7)):b=this.Pbh(h);
return b}dBo(){switch(this.UPd){case 1:this.ga.Ob(Fc.a.fak,2);break;case 2:this.ga.Ob(Fc.a.gak,2)}}}Object(u.a)(JN,"TotalWordCountManager",Op,[]);class KN{constructor(){this.xJj=this.wJj=this.Bwg=this.yJj=this.f0j=this.g0j=this.d0j=this.e0j=0}get Bgj(){return this.Ljc(this.yJj,this.g0j,"WC")}get HPn(){return this.Ljc(this.wJj,this.d0j,"NumCharsNoSp")}get IPn(){return this.Ljc(this.Bwg,this.e0j,"NumCharsWithSp")}get NPn(){return this.Ljc(this.xJj,this.f0j,"NumParagraphs")}Ljc(b,h,r){const A=this.ntd(h,
r).toLocaleString();return 0<this.Bwg?(b=this.TMg(b,h,r),String.format(WordEditorIntl.WordEditorStrings.L_DocStatsDialogCountString,b.toLocaleString(),A)):A}TMg(b,h,r){b=this.ntd(b,r);return b>h?(v.ULS.sendTraceTag(22397767,338,15,"Sel>Total for {0}",r),h):b}ntd(b,h){0>b&&v.ULS.sendTraceTag(22397768,338,15,"{0}<0",h);return Math.max(b,0)}}Object(u.a)(KN,"DocumentStats",null,[]);class VK{static Zrf(b){return ig.a.Ry(VK.Hn,WordEditorIntl.WordEditorStrings.L_DocStatsDialogWordsCount,b.Bgj,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsNoSpacesCount,
b.HPn,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsWithSpacesCount,b.IPn,WordEditorIntl.WordEditorStrings.L_DocStatsDialogParagraphsCount,b.NPn)}}VK.Hn="<table id='DocumentStatsTable' cellpadding=5 cellspacing=5 role='presentation' width='100%'> <tr role='presentation'> <td> <span id='WordCount' class='WACDialogSpan'>{0}</span> </td> <td style='text-align:right'> <span id='WordCountResult' class='WACDialogSpan'>{1}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharNoSpacesCount' class='WACDialogSpan'>{2}</span> </td> <td style='text-align:right'> <span id='CharNoSpacesCountResult' class='WACDialogSpan'>{3}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharWithSpacesCount' class='WACDialogSpan'>{4}</span> </td> <td style='text-align:right'> <span id='CharWithSpacesCountResult' class='WACDialogSpan'>{5}</span> </td> </tr> <tr role='presentation'> <td> <span id='ParagraphCount' class='WACDialogSpan'>{6}</span> </td> <td style='text-align:right'> <span id='ParagraphCountResult' class='WACDialogSpan'>{7}</span> </td> </tr> </table>";
Object(u.a)(VK,"DocumentStatsDialogHtml",null,[]);class MO extends ig.a{constructor(b){super();this.OV=!1;this.cVl=()=>{};this.FH=b}z3o(){this.Ng="DocumentStatsDialog";this.kh=VK.Zrf(this.FH);this.Fd=0;this.showDialog(WordEditorIntl.WordEditorStrings.L_DocStatsDialogTitle,this.cVl);this.t8("DocumentStatsTable")}Cba(){}dispose(){this.OV||(super.dispose(),this.OV=!0)}}Object(u.a)(MO,"DocumentStatsDialog",ig.a,[]);class NO{constructor(b,h,r,A,M,aa,oa,Ja,fb){this.UEh=this.BHc=this.OFc=this.C7b=this.cYe=
!1;this.qsc=()=>{this.xEe()};this.wga=()=>{this.xEe()};this.VVo=()=>{this.UEh=!0;return 32};this.fog=()=>this.uu.CXa?32:8;this.pid=(Cb,Gb,Sb,pc,zc)=>{if(1===Sb)return this.uu.CXa?32:8;zc[Vg.a.On]=this.V0f;return 32};this.eCe=(Cb,Gb,Sb)=>{if(1===Sb)return this.uu.CXa?32:8;this.V0f?this.dSl():this.yYl();qa.StaticActiveAppFrame.za().eJ({ShowWordCount:"CheckboxModel"});return 32};this.uxc=(Cb,Gb,Sb)=>{if(1===Sb)return Xn.a.Jla(Gb)?8:this.uu.CXa?32:8;if(this.UEh)return y.AFrameworkApplication.va.Ob(Fc.a.Fne,
2),32;Cb=this.Xd.Wf("UserAction","Show Word Count Dialog");Cb.start();this.uu.Gpd();this.oT.Gpd();this.uu.Mz!==this.oT.Mz?v.ULS.sendTraceTag(23188303,338,50,"Open Word Count Dialog with content selected"):v.ULS.sendTraceTag(523072473,338,50,"Open Word Count Dialog without content selected");Gb=this.VCl();(new MO(Gb)).z3o();Cb.stop();return 32};this.Chd=(Cb,Gb,Sb,pc,zc)=>{zc||v.ULS.sendTraceTag(23652428,338,10,String.format("{0}","actionData is null"));if(1===Sb)return 32;if(!this.uu.CXa)return zc[Xk.a.Visible]=
!1,32;zc[Xk.a.Visible]=!0;this.V0f?(Cb=this.uu.Mz,0>Cb?Cb=WordEditorIntl.WordEditorStrings.l_WordCountCalculating:Cb?(Gb=this.oT?this.oT.Mz:-1,Cb=0<Gb?this.KHm(Cb,Gb):String.format(1===Cb?WordEditorIntl.WordEditorStrings.l_WordCountResultSingularAccurate:WordEditorIntl.WordEditorStrings.l_WordCountResultAccurate,this.$ue(Cb))):Cb=String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultExact,this.$ue(Cb))):Cb=WordEditorIntl.WordEditorStrings.l_WordCountHidden;zc[Xk.a.LabelText]=Cb;return 32};
this.kNe=oa;this.lNe=aa;this.uu=b;this.oT=h;this.iIb=r;this.CMk=M;this.oT.Fff(this.qsc);this.uu.Fff(this.qsc);this.oT.Slb(this.wga);this.uu.Slb(this.wga);this.Xd=Ja;this.JUa=A;this.A2a=fb.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}get Vuf(){return!Y.a.w7}Xb(){const b=y.AFrameworkApplication.va;b.qa(Fc.a.eCe,lc.a.application,this.eCe);b.qa(Fc.a.uxc,lc.a.view,this.uxc);b.fb(Fc.a.pid,lc.a.application,this.pid,96);b.fb(Fc.a.Chd,lc.a.application,this.Chd,96);b.fb(Fc.a.fog,lc.a.application,
this.fog,96);b.qa(Fc.a.$hi,lc.a.application,this.VVo)}get JUa(){return this.OFc}set JUa(b){this.OFc=b;this.uu.JUa=b;this.oT.JUa=b}yYl(){this.uu.CXa&&(this.mPj(!0),this.xEe(),this.uu.Gpd())}VCl(){const b=new KN;b.g0j=this.uu.Mz;b.e0j=this.uu.vXc;b.d0j=this.uu.uXc;b.f0j=this.uu.wXc;b.yJj=this.oT.Mz;b.wJj=this.oT.uXc;b.Bwg=this.oT.vXc;b.xJj=this.oT.wXc;return b}vom(){return this.kNe("WACWordCountEnabled",this.Vuf)}twe(b){this.lNe("WACWordCountEnabled",b?"true":"false",Jc.a.XLa)}get V0f(){this.C7b||(this.cYe=
this.vom(),this.C7b=!0);return this.cYe}mPj(b){this.twe(b);this.cYe=b;this.C7b=!0}dSl(){this.uu.mZd();this.oT.mZd();this.mPj(!1);this.xEe()}get tH(){return null!=this.Y2g?this.Y2g:this.Y2g=(()=>this.iIb())()}xEe(){this.BHc||(v.ULS.sendTraceTag(23188304,338,50,"Word count document stats: {0}",this.gJl()),this.BHc=!0);this.tH&&this.tH.eS(this.CMk)}gJl(){const b={["words"]:this.uu.Mz,["charsWithSpaces"]:this.uu.vXc,["charsWithNoSpaces"]:this.uu.uXc,["paragraphs"]:this.uu.wXc};this.A2a&&(b.images=this.uu.zMb,
b.tables=this.uu.DMb);return b}$ue(b){try{return b.toLocaleString()}catch(h){v.ULS.sendTraceTag(23652430,338,10,String.format("Error converting count to locale string, error: {1}, stacktrace: {2}",h.toString(),h.stack))}return b.toString()}KHm(b,h){h>b&&(v.ULS.sendTraceTag(23652432,338,10,String.format("Selection word count is greater than total word count.")),h=b);return String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultOnSelectionAccurate,this.$ue(h),this.$ue(b))}}Object(u.a)(NO,"WordCountActor",
null,[]);class WK extends Ct.a{constructor(b,h,r,A){super();this.FN=(M,aa)=>{if(aa.property===He.a.Pn||aa.property===He.a.Qn)M=aa.node,aa=$l.a.Mm.kb.Jc,aa.mw&&aa.od&&aa.od.Ic&&M.Ic&&M.Ic.id===aa.od.Ic.id&&this.qji(M)};this.Nkj=(M,aa)=>{this.qji(aa.node)};this.HXn=(M,aa)=>{aa.property!==pd.a.XB&&aa.property!==Mc.a.Tw||this.p0()};this.Ele=()=>{this.p0()};this.O9=b;this.uu=h;this.Im=r;this.A2a=A.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}$A(){var b=this.Im.jf(12);b.jo(this.FN);b.wt(this.Nkj);
b.Yx(this.Nkj);b=this.Im.jf(22);b.jo(this.HXn);b.wt(this.Ele);b.Yx(this.Ele);this.A2a&&this.Rro();this.O9.hva(this,7)}Rro(){var b=[19,14];for(const h of b)b=this.Im.jf(h),b.wt(this.Ele),b.Yx(this.Ele)}get index(){return 1}run(){this.uu.dvf()}qji(b){b.Htd=null;this.p0()}}Object(u.a)(WK,"WordCountAppEventCoordinator",Ct.a,[]);class LN{}LN.GRk="AccurateWordCountButton";Object(u.a)(LN,"WordCountConstants",null,[]);class OO{constructor(b,h){this.uu=b;this.oT=h}getInstance(b){switch(b){case 1:return this.oT;
case 0:return this.uu;default:return this.uu}}}Object(u.a)(OO,"WordCountManagerFactory",null,[215]);class eM{constructor(){this.W=null}get name(){return"WordEditor.WordCount"}uc(b){this.W=b;const h=this.W.resolve(71);this.W.ia(1164,()=>new UK(h)).ha();this.W.ia(1165,()=>{var r=new ts.a(10,Le.a.Ge);const A=new JN(b.resolve(10),b.resolve(244),new Ul.a,y.AFrameworkApplication.va,y.AFrameworkApplication.oc,()=>$l.a.Mm.kb.Jc.od,uf.a.At,vd.a.Za,h,r,Za.a.instance.resolve(331));r=new IN(Za.a.instance.resolve(10),
Za.a.instance.resolve(244),new Ul.a,gg.a.instance,y.AFrameworkApplication.oc,Qz.a.instance,Rg.a.instance,Za.a.instance.resolve(1164),h,r,Za.a.instance.resolve(331));return new OO(A,r)}).ha();this.W.ia("WordEditor.WordCount.GraphFullyConnectedGetter",()=>new NF(this.W.resolve(1165).getInstance(0))).as(509).ha()}init(){const b=qa.StaticActiveAppFrame.za().kb;b.HBa?this.zva():b.vja(()=>{this.zva()})}zva(){if(df.a.gf){var b=df.a.gf.Ll;if(b){this.W.resolve(509);var h=this.W.resolve(1165).getInstance(0),
r=this.W.resolve(1165).getInstance(1),A=Za.a.instance.resolve(71);(new NO(h,r,()=>Za.a.instance.Oa(584),this.unm(),LN.GRk,Jc.a.UNa,Jc.a.dfa,Za.a.instance.resolve(38),A)).Xb();(new WK($r.a.instance,h,b,A)).$A();h.dvf()}else v.ULS.sendTraceTag(22425994,306,10,"Graph is null. Word Count will not be available")}else v.ULS.sendTraceTag(23967264,306,15,"TheNotebookManager is null. Word Count will not be available")}unm(){var b=$l.a.Mm.kb;if(!b)return v.ULS.sendTraceTag(22611550,324,10,""),!1;b=b.Jc;if(!b)return v.ULS.sendTraceTag(22611552,
324,10,""),!1;b=b.od;return b?b.ka(Mc.a.JUa,!1):(v.ULS.sendTraceTag(22611554,324,10,""),!1)}dispose(){}static main(){K.a.instance.Lc(new eM)}}Object(u.a)(eM,"PackageManager",null,[0,1]);var PO=d(2088);class MN{constructor(b){this.K6e=null;b.Ra(1166).execute(h=>{this.K6e=h})}PLj(b){this.K6e&&this.K6e.nJf().handleDocumentContentAugloopAnnotation(b)}}Object(u.a)(MN,"DocumentContentExtractionManager",null,[445]);class Hh{}Hh.D7o="mso_smartLookup";Hh.channelId="SmartLookup";Hh.C7o="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";
Hh.zUj="https://uci.edog.cdn.office.net/mirrored/smartlookup/";Hh.AUj="https://uci.cdn.office.net/mirrored/smartlookup/";Hh.B7o="https://hedwigtestserver.blob.core.windows.net/builds/";Hh.A7o="http://localhost:8080/";Hh.fpd="current";Hh.yUj="next";Hh.q5n=2;Hh.Msc=1;Hh.Nsc=CommonUIStrings.L_SmartLookupPaneTitle;Hh.yD="InsightsTaskPane";Hh.BGg="InsightsTaskPaneData";Hh.GSf="InsightsContentFrame";Hh.width=400;Hh.pJn="ApplicationPropertiesRequest";Hh.AJn="SelectionRequest";Hh.vJn="PageRendered";Hh.oJn=
"ApplicationProperties";Hh.zJn="Selection";Hh.CJn="Telemetry";Hh.BJn="TakeFocus";Hh.uJn="LostFocus";Hh.rJn="Keyboard";Hh.sJn="LegalAgreed";Hh.QGp="WordWac";Hh.L1n="OneNoteWAC";Hh.zig="yes";Hh.gZj="appCorrelationId";Hh.jfp="clientCorrelationId";Hh.hZj="message";Hh.i5i="Microsoft::Office::Insights::LegalAgreed";Object(u.a)(Hh,"InsightsConstants",null,[]);var JI=d(1563);class KI{}Object(u.a)(KI,"ActivityContractInfo",null,[]);class $s{}Object(u.a)($s,"BrowserPaneDataField",null,[]);class LI{}Object(u.a)(LI,
"BrowserPaneTelemetryEvent",null,[]);class Il{static fB(b,h){const r=new LI;r.eventName="Diagnostics";r.isActivity=!1;r.activityContract=Object.assign(new KI,{success:!0});const A=[],M=new $s;M.name="Message";M.dataType=0;M.value=b;b=new $s;b.name="Level";b.dataType=0;b.value=Il.getLevelString(h);Array.add(A,M);Array.add(A,b);r.dataFields=A;Il.sendTelemetryEvent(r)}static QJj(b,h){const r=new LI;r.eventName=b;r.isActivity=!1;r.activityContract=Object.assign(new KI,{success:!0});b=[];const A=new $s;
A.name="AppCorrelationId";A.dataType=0;A.value=h;Array.add(b,A);r.dataFields=b;Il.sendTelemetryEvent(r)}static TLo(b,h,r,A,M,aa){const oa=new LI;oa.eventName="LaunchPaneWithError";oa.isActivity=!1;oa.activityContract=Object.assign(new KI,{success:!0});const Ja=[],fb=new $s;fb.name="IsNetworkConnected";fb.dataType=0;fb.value=b?"true":"false";b=new $s;b.name="IsHostruntimeAvailable";b.dataType=0;b.value=h?"true":"false";h=new $s;h.name="EntryPoint";h.dataType=0;h.value=r;r=new $s;r.name="RuntimeVersion";
r.dataType=0;r.value=A;A=new $s;A.name="IsFirstRelease";A.dataType=1;A.value=M?"true":"false";M=new $s;M.name="IsZeroTerm";M.dataType=1;M.value=aa?"true":"false";aa=new $s;aa.name="IsClientSideRendering";aa.dataType=1;aa.value="false";Array.add(Ja,fb);Array.add(Ja,h);Array.add(Ja,b);Array.add(Ja,r);Array.add(Ja,A);Array.add(Ja,M);Array.add(Ja,aa);oa.dataFields=Ja;Il.sendTelemetryEvent(oa)}static Fwg(b,h,r){const A=new LI;A.eventName="CDNDownloadLatency";A.isActivity=!0;A.activityContract=Object.assign(new KI,
{duration:r,success:!0});r=[];const M=new $s;M.name="CDNHostname";M.dataType=0;M.value=b;b=new $s;b.name="Filename";b.dataType=0;b.value=h;Array.add(r,M);Array.add(r,b);A.dataFields=r;Il.sendTelemetryEvent(A,1)}static Svc(b,h,r,A,M,aa,oa,Ja){const fb=new LI;fb.eventName="LaunchPane";fb.isActivity=!0;fb.activityContract=Object.assign(new KI,{duration:h,success:!0});h=[];const Cb=new $s;Cb.name="AppCorrelationId";Cb.dataType=0;Cb.value=b;b=new $s;b.name="EntryPoint";b.dataType=0;b.value=r;r=new $s;
r.name="IsServerSideRendering";r.dataType=1;r.value="true";const Gb=new $s;Gb.name="UxVersion";Gb.dataType=0;Gb.value=A;A=new $s;A.name="FeatureGates";A.dataType=0;A.value=M;M=new $s;M.name="IsFirstRelease";M.dataType=1;M.value=aa?"true":"false";aa=new $s;aa.name="IsZeroTerm";aa.dataType=1;aa.value=oa?"true":"false";oa=new $s;oa.name="IsClientSideRendering";oa.dataType=1;oa.value=Ja?"true":"false";Array.add(h,Cb);Array.add(h,b);Array.add(h,r);Array.add(h,Gb);Array.add(h,A);Array.add(h,M);Array.add(h,
aa);Array.add(h,oa);fb.dataFields=h;Il.sendTelemetryEvent(fb)}static sendTelemetryEvent(b,h=2){if(b.isFeedbackActivity)Il.iAn(b.eventName);else{var r=-1<b.eventName.indexOf(Il.fZj)?b.eventName:Il.fZj+b.eventName,A=Il.wmm(b.dataFields);b.isActivity?(b=Object.assign(new Sg.a,{name:r,samplingPolicy:h,dataFields:A,succeeded:b.activityContract.success,durationMs:b.activityContract.duration}),ca.a.sendActivityEvent(b)):(b=Object.assign(new la.a,{name:r,samplingPolicy:h,dataFields:A}),ca.a.sendTelemetryEvent(b))}}static getLevelString(b){switch(b){case 10:return"Error";
case 15:return"Warning";default:return"Info"}}static wmm(b){const h=[];if(b&&0<b.length)for(const r of b)(b=Qg.a.Iaa(r.name,r.value,Il.Azl(r.dataType)))&&Array.add(h,b);return h}static Azl(b){switch(b){case 0:return 2;case 1:return 1;case 2:return 3;case 3:return 4;default:return 0}}static iAn(b){const h=Za.a.instance.Oa(2);h?h.logActivity(b,null):v.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}Il.fZj="Office.Insights.SmartLookup.";Object(u.a)(Il,"TelemetryUtils",
null,[]);var OF;(function(b){b[b.other=0]="other";b[b.ygq=1]="searchBoxSearch";b[b.sgq=2]="searchBoxDictionary";b[b.xgq=3]="searchBoxQuickAnswer";b[b.Tiq=4]="smartLookupRibbon";b[b.Siq=5]="smartLookupContextMenu";b[b.entity=6]="entity";b[b.OUp=7]="dictionary";b[b.web=8]="web";b[b.Rcq=9]="pictures";b[b.files=10]="files";b[b.rRp=11]="bookmarks";b[b.tlc=12]="help";b[b.bSp=13]="chartRecommendation";b[b.z3p=14]="linkSkill";b[b.ugq=15]="searchBoxFindInDocument";b[b.tgq=16]="searchBoxEntity";b[b.Agq=17]=
"searchSkill";b[b.vTp=18]="controlF";b[b.sfq=19]="ribbonFindButton";b[b.nfq=20]="reuseSlides";b[b.data=21]="data";b[b.lTp=22]="contextMenuDictionary";b[b.oTp=23]="contextMenuSearchSuggestion";b[b.rTp=24]="contextMenuSynonyms";b[b.nTp=25]="contextMenuSearchBoxSearch";b[b.zgq=26]="searchBoxSearchZeroTerm";b[b.pTp=27]="contextMenuSearchZeroTerm";b[b.haq=28]="note";b[b.Riq=29]="smartLookupAutoLaunch";b[b.qTp=30]="contextMenuSmartLookupInSubMenu";b[b.fUp=31]="dataDisambiguate";b[b.y3p=32]="linkFiles";
b[b.wgq=33]="searchBoxNoteL2";b[b.mTp=34]="contextMenuLaunchL2Document";b[b.vPp=35]="actionAI";b[b.Ccq=36]="pasteAsNewSlide";b[b.Miq=37]="slidesCompression";b[b.vgq=38]="searchBoxGenerateDeck";b[b.bdq=39]="powerPointCopilot";b[b.Tjq=40]="tellMeService";b[b.ldq=99]="prefetch"})(OF||(OF={}));Object(u.b)("EntryPoint",OF);var xj=d(1456),xv=d(1473);class pu{static W_(b,h,r,A,M,aa){if(1===r)return ec.SessionStatusManager.instance.WA?32:8;if(M.value.$1o())return Il.fB("Skipping Serplet launch",10),32;h=
aa;if(!h)return 8;b=pu.OOb();if(r=h.CommandValueId)try{h=H.a(r)}catch(oa){return v.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",r),8}r=h;h.selection||(h.neighborhood?r=Object.assign(new xj.a,{selection:h}):(h=M.value.xPb(),r.selection=Object.assign(new xv.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength})));r.selection.clientDetectedLanguage=M.value.Qyi();return pu.yhc(aa,null,r,b,0,M)}static yhc(b,h,r,
A,M,aa){const oa={};oa.controlId=b?b.SourceControlId:"shortcut";r&&(oa.entryPoint=OF[r.entryPoint]);v.ULS.sendTraceTag(594044172,1303,50,pu.VW("Show insights",A,oa));h?aa.value.v4o(h,A,M):r&&(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",!1)?aa.value.N2o(r,A):aa.value.w4o(r,A,M));return 32}static VW(b,h,r=null){b={["appCorrelationId"]:h,["message"]:b};if(r)for(const A in r)b[A]=r[A];return H.c(b)}static OOb(){return kb.a.create().toString()}}Object(u.a)(pu,
"InvokingPaneUtils",null,[]);class MI{}Object(u.a)(MI,"LaunchDataInDoc",null,[]);class fM{}Object(u.a)(fM,"LaunchDataPasteAsSlide",null,[]);class QO{}Object(u.a)(QO,"LaunchDataSlidesCompression",null,[]);var Ks=d(1439);class NN{constructor(b,h,r,A,M,aa,oa,Ja,fb){this.QFc=this.gCd=this.hx=null;this.NPb=Cb=>{this.hx||3!==Cb.state||(this.hx=Cb,this.gCd=this.hx.Dga)};this.ND=b;this.ga=h||y.AFrameworkApplication.va;this.Zp=r;this.Yb=A;this.Voh=Ja;this.DLc=M;this.Ga=aa;this.Gb=oa;this.p4m();this.s2a=new Qf.a(()=>
new rk.a(fb.value,this.NPb))}Xb(){this.ga.qa(Ka.a.a9m,we.a.frame,Object(E.a)(this,this.t4o,"showInsights"));this.ga.qa(Ka.a.b9m,we.a.frame,Object(E.a)(this,this.u4o,"showInsightsForTellMe"));this.ga.qa(Ka.a.definitions,we.a.frame,Object(E.a)(this,this.p3o,"showDefinitions"));this.ga.qa(Ka.a.avf,we.a.frame,Object(E.a)(this,this.q3o,"showDefinitionsForTellMe"));this.ga.qa(Ka.a.rCg,we.a.frame,Object(E.a)(this,this.rCg,"showInsightsForSuggestion"));this.Voh&&(this.ga.qa(Ka.a.Yaa,we.a.frame,Object(E.a)(this,
this.W_,"invokeSmartLookupPane")),this.ga.qa(Ka.a.E7c,we.a.frame,Object(E.a)(this,this.E7c,"invokeInDocSerplet")),this.ga.qa(Ka.a.Qbe,we.a.frame,Object(E.a)(this,this.Qbe,"invokeSerpletRibbon")),this.ga.qa(Ka.a.F7c,we.a.frame,Object(E.a)(this,this.F7c,"invokeSerpletContextMenu")),this.ga.qa(Ka.a.XVf,we.a.frame,Object(E.a)(this,this.XVf,"invokeSerpletTellMeZeroTerm")),this.ga.qa(Ka.a.WVf,we.a.frame,Object(E.a)(this,this.WVf,"invokeSerpletTellMeNotes")),this.ga.qa(Ka.a.Mbe,we.a.frame,Object(E.a)(this,
this.Mbe,"invokeImageSerpletContextMenu")),this.ga.qa(Ka.a.Rbe,we.a.frame,Object(E.a)(this,this.Rbe,"invokeSynonymsSerpletContextMenu")),this.ga.qa(Ka.a.Lbe,we.a.frame,Object(E.a)(this,this.Lbe,"invokeDictionarySerpletContextMenu")),this.ga.qa(Ka.a.Tbe,we.a.frame,Object(E.a)(this,this.Tbe,"invokeZeroTermSerpletContextMenu")),this.ga.qa(Ka.a.Kbe,we.a.frame,Object(E.a)(this,this.Kbe,"invokeDefinitionSearchFromFloatie")),this.ga.qa(Ka.a.Pbe,we.a.frame,Object(E.a)(this,this.Pbe,"invokeSerpletBrowseFiles")),
this.ga.qa(Ka.a.Nbe,we.a.frame,Object(E.a)(this,this.Nbe,"invokeInDocSerpletWithLaunchData")),this.ga.qa(Ka.a.Bre,we.a.frame,Object(E.a)(this,this.Bre,"queryToggleSerplet")),this.ga.qa(Ka.a.Iwe,we.a.frame,Object(E.a)(this,this.Iwe,"setInDocSearchParameter")),this.ga.qa(Ka.a.VVf,we.a.frame,Object(E.a)(this,this.VVf,"invokeSerpletSlidesCompression")),this.ga.qa(Ka.a.UVf,we.a.frame,Object(E.a)(this,this.UVf,"invokeSerpletPasteAsNewSlide")),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",
!1)&&(this.ga.qa(Ka.a.jTi,we.a.frame,Object(E.a)(this,this.$$m,"invokeSmartLookupPaneConversations")),this.ga.qa(Ka.a.Jbe,we.a.frame,Object(E.a)(this,this.Jbe,"invokeAutoLaunchSearchRequest"))),this.vqo().continueWith(()=>{y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Fe(!0)}))}SLh(){this.ga.fb(Ka.a.hLa,we.a.frame,Object(E.a)(this,this.hLa,"invokeFilesSerplet"),4);this.ga.fb(Ka.a.OVf,we.a.frame,Object(E.a)(this,this.hLa,"invokeFilesSerplet"),4);this.ga.fb(Ka.a.dTi,we.a.frame,Object(E.a)(this,
this.O$m,"invokeLinkFilesSerplet"),4);if(this.Ga.$("IsTellMeUpSellEnterpriseEnabled")&&this.Ga.$("SmartLookupTokenPrefetchIsEnabled")){const b=xc.a.oaa(0,Object(E.a)(this,this.Psj,"prefetchToken"),0,177);this.Gb.Zb(b)}}Def(){hh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&(this.ga.qa(Ka.a.hLa,we.a.frame,Object(E.a)(this,this.PVf,"invokeFilesSerpletUnavailable")),this.ga.qa(Ka.a.OVf,we.a.frame,Object(E.a)(this,this.PVf,
"invokeFilesSerpletUnavailable")),this.ga.qa(Ka.a.dTi,we.a.frame,Object(E.a)(this,this.PVf,"invokeFilesSerpletUnavailable")))}Psj(b){v.ULS.sendTraceTag(579352786,1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",b.interval,!!b.data);this.Qzc().then(h=>{let r=1;if(h)v.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),this.ixg("SmartLookupFiles: Token prefetch succeeded",!0),h=6E4*this.Ga.ic("SmartLookupTokenRenewalWaitDurationInMinutes",
30);else{v.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.ixg("SmartLookupFiles: Token prefetch failed",!1);r=parseInt(b.data||"1");if(r>this.Ga.ic("SmartLookupTokenRenewalRetryThreshold",5)){v.ULS.sendTraceTag(577345097,1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.ixg("SmartLookupFiles: Token prefetch max retry count reached",!1);return}h=6E4*this.Ga.ic("SmartLookupTokenRetryWaitDurationInMinutes",10);r++}h=new xc.a(3,1,h,Object(E.a)(this,
this.Psj,"prefetchToken"),177);h.data=r.toString();this.Gb.Zb(h)})}ixg(b="",h=!1){this.DLc.execute(r=>{r&&r.Qvc("PrefetchToken",h,0,"SmartLookup",b)})}Qzc(){return this.DLc?new Promise(b=>{this.DLc.execute(h=>{if(h){var r=Date.now();h.getToken("SmartLookup",this.Ga.ib("SmartLookupShredderServiceEndpoint")).then(A=>{b(!!A&&0<A.length);h.Qvc("TryGetTokenInternal",!!A&&0<A.length,Date.now()-r,"SmartLookup")})}else b(!1)})}):Promise.resolve(!1)}vqo(){const b=new Yh.a;if(this.Ga.$("BrowserSupportsInsightsPaneSSO"))this.SLh(),
b.hg(!0);else{if(!this.DLc)return v.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),b.hg(!1),this.Def(),b.task;this.DLc.execute(h=>{h?h.getToken("SmartLookup",this.Ga.ib("SmartLookupShredderServiceEndpoint")).then(r=>{v.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!r&&0<r.length);r&&0<r.length?(this.SLh(),b.hg(!0)):this.Def()}):(v.ULS.sendTraceTag(587534912,1303,10,"Unable to resolve oAuthManager"),b.hg(!1),this.Def())})}return b.task}t4o(b,h,r,A,M){if(1===r)return y.AFrameworkApplication.ua&&
y.AFrameworkApplication.J.$("OneNoteDelayLoadContextActivationManager")&&!y.AFrameworkApplication.dWc?8:this.ND.value.QXi()?32:8;b=pu.OOb();h=this.ND.value.xPb();return this.Voh?(h=Object.assign(new xv.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength}),h=Object.assign(new xj.a,{selection:h,userIntent:null,entryPoint:0,launchData:Object.assign(new Ks.a,{landingTab:"All"})}),pu.yhc(M,null,h,b,0,this.ND)):pu.yhc(M,h,null,b,0,this.ND)}p3o(b,h,r,A,M){if(1===r)return this.ND.value.QXi()?
32:8;b=pu.OOb();h=this.ND.value.xPb();return pu.yhc(M,h,null,b,1,this.ND)}u4o(b,h,r,A,M){return 1===r?32:this.Dki(M,0)}q3o(b,h,r,A,M){return 1===r?32:this.Dki(M,1)}Dki(b,h){const r=pu.OOb(),A=b.CommandValueId;let M;try{M=H.a(A)}catch(aa){return v.ULS.sendTraceTag(6295941,1303,15,pu.VW(String.format("Insights parameters [{0}] is not in proper format.",A),r)),8}return pu.yhc(b,M,null,r,h,this.ND)}rCg(b,h,r,A,M){if(1===r)return 32;if(!M)return 8;b=M.query?M.query:"";h=pu.OOb();r=new JI.a;r.neighborhood=
b;r.mentionStart=0;r.mentionLength=b.length;return pu.yhc(M,r,null,h,0,this.ND)}O$m(b,h,r,A){if(1===r)return ec.SessionStatusManager.instance.WA?32:8;const M=y.AFrameworkApplication.J.$("InsertFileLinkSerpletIsEnabled"),aa=this.ND.value.e9a();return this.W_(b,h,r,A,Object.assign(new xj.a,{selection:Object.assign(new xv.a,{neighborhood:aa.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new Ks.a,{landingTab:"File"}),entryPoint:M?32:10}))}hLa(b,h,r,A){if(1===r)return ec.SessionStatusManager.instance.WA?
32:8;const M=y.AFrameworkApplication.J.$("InvokeReuseSlidesSerpletIsEnabled"),aa=this.ND.value.e9a();return this.W_(b,h,r,A,Object.assign(new xj.a,{selection:Object.assign(new xv.a,{neighborhood:aa.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new Ks.a,{landingTab:M?"Slide":"File"}),entryPoint:M?20:10}))}PVf(){return 2}E7c(b,h,r,A,M){if(1===r)return ec.SessionStatusManager.instance.Hk?8:32;const aa=this.ND.value.e9a();M=void 0===M||null===M?18:19;return this.W_(b,h,r,A,Object.assign(new xj.a,
{selection:Object.assign(new xv.a,{neighborhood:aa.neighborhood,mentionStart:aa.mentionStart,mentionLength:aa.mentionLength}),launchData:Object.assign(new Ks.a,{landingTab:"Indoc"}),entryPoint:M}))}Nbe(b,h,r,A,M){M=M.CommandValueId;if(!M||M&&this.QFc&&M.query===this.QFc.query&&M.matchCase===this.QFc.matchCase&&M.matchWholeWordOnly===this.QFc.matchWholeWordOnly)return 32;const aa=this.ND.value.e9a();return this.W_(b,h,r,A,Object.assign(new xj.a,{selection:Object.assign(new xv.a,{neighborhood:aa.neighborhood,
mentionStart:aa.mentionStart,mentionLength:aa.mentionLength}),launchData:Object.assign(new Ks.a,{landingTab:"Indoc",data:Object.assign(new MI,{type:4,query:M.query,matchCase:M.matchCase,matchWholeWord:M.matchWholeWordOnly})}),entryPoint:18}))}Bre(b,h,r,A,M){M&&(M[Vg.a.On]=this.ND.value.WSb);return 32}Iwe(b,h,r,A,M){if(b=M.CommandValueId)this.QFc=b;return 32}$$m(b,h,r){if(1===r)return ec.SessionStatusManager.instance.WA?32:8;b=this.ND.value.e9a();b=Object.assign(new xj.a,{selection:Object.assign(new xv.a,
{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new Ks.a,{landingTab:"All"})});this.ND.value.uge(b);return 32}Jbe(b,h,r){if(1===r)return ec.SessionStatusManager.instance.WA?32:8;b=this.ND.value.e9a();b=Object.assign(new xj.a,{selection:Object.assign(new xv.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new Ks.a,{landingTab:"All",data:y.AFrameworkApplication.rNb})});
h=pu.OOb();this.ND.value.ZZb(b,h);return 32}Qbe(b,h,r,A){if(1===r)return ec.SessionStatusManager.instance.WA?32:8;const M=this.ND.value.Syi();return this.W_(b,h,r,A,Object.assign(new xj.a,{selection:Object.assign(new xv.a,{neighborhood:M.neighborhood,mentionStart:M.mentionStart,mentionLength:M.mentionLength}),entryPoint:4,launchData:Object.assign(new Ks.a,{landingTab:"All"})}))}F7c(b,h,r,A){return this.W_(b,h,r,A,Object.assign(new xj.a,{entryPoint:5,launchData:Object.assign(new Ks.a,{landingTab:"All"})}))}XVf(b,
h,r,A){if(1===r)return ec.SessionStatusManager.instance.WA?32:8;const M=this.ND.value.e9a();return this.W_(b,h,r,A,Object.assign(new xj.a,{selection:Object.assign(new xv.a,{neighborhood:M.neighborhood,mentionStart:M.mentionStart,mentionLength:0}),launchData:Object.assign(new Ks.a,{landingTab:"All"}),entryPoint:26}))}Lbe(b,h,r,A){return 1===r?(b=this.ND.value.xPb())&&0<b.mentionLength?32:8:this.W_(b,h,r,A,Object.assign(new xj.a,{entryPoint:22,launchData:Object.assign(new Ks.a,{landingTab:"All"})}))}Kbe(b,
h,r,A){return 1===r?(b=this.ND.value.xPb())&&0<b.mentionLength?32:8:this.W_(b,h,r,A,Object.assign(new xj.a,{entryPoint:7,launchData:Object.assign(new Ks.a,{landingTab:"All"})}))}Mbe(b,h,r,A){return this.W_(b,h,r,A,Object.assign(new xj.a,{launchData:Object.assign(new Ks.a,{landingTab:"Image"}),entryPoint:9}))}Rbe(b,h,r,A){return this.W_(b,h,r,A,Object.assign(new xj.a,{launchData:Object.assign(new Ks.a,{landingTab:"All"}),entryPoint:24}))}WVf(b,h,r,A){return this.W_(b,h,r,A,Object.assign(new xj.a,{launchData:Object.assign(new Ks.a,
{landingTab:"Notes"}),entryPoint:33}))}Tbe(b,h,r,A){if(1===r)return ec.SessionStatusManager.instance.WA?32:8;const M=this.ND.value.e9a();return this.W_(b,h,r,A,Object.assign(new xj.a,{selection:Object.assign(new xv.a,{neighborhood:M.neighborhood,mentionStart:M.mentionStart,mentionLength:0}),launchData:Object.assign(new Ks.a,{landingTab:"All"}),entryPoint:27}))}VVf(b,h,r,A,M){if(!M)return 8;const aa=M.url;M=M.selectedSlideIDs;return this.W_(b,h,r,A,Object.assign(new xj.a,{launchData:Object.assign(new Ks.a,
{landingTab:"All",data:Object.assign(new QO,{type:6,url:aa,selectedSlideIDs:M})}),entryPoint:37}))}UVf(b,h,r,A,M){if(!M)return 8;const aa=M.Selection;M=M.CurrentDocTitle;return this.W_(b,h,r,A,Object.assign(new xj.a,{launchData:Object.assign(new Ks.a,{landingTab:"All",data:Object.assign(new fM,{type:5,selection:aa,currentDocTitle:M})}),entryPoint:36}))}W_(b,h,r,A,M){return pu.W_(b,h,r,A,this.ND,M)}Pbe(b,h,r){if(1===r)return 32;this.hx||this.s2a.value.zR("Browse File from Search pane",!0);if(!this.gCd||
""===this.gCd)return v.ULS.sendTraceTag(558409934,1303,10,"InsightsActor: Failed to get host url to browse files."),8;Le.a.un(this.gCd,"_blank",void 0,"BrowseFilesFromSearchPane");return 32}p4m(){const b=this.Yb.ie(Hh.yD);b.parent=id.AFrame.Eq;b.sja(Object(E.a)(this,this.Rvc,"sendIFrameTakeFocusMessage"));this.Zp.rW(Hh.yD)}Rvc(){document.activeElement.blur();y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.jtb||(this.ND.value.IQo(),this.ND.value.RLo())}dispose(){this.ND.value&&this.ND.value.dispose()}}
Object(u.a)(NN,"InsightsActor",null,[10]);const RD=b=>{b=b.split("-");return b[b.length-1]},RO=()=>{var b=NI();if(b)return Promise.resolve(b);b=yv().replace("SearchWeb","searchweb");b=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?b+Hh.yUj+"/":b+Hh.fpd+"/";b+="version.json";if(Y.a.kta)return SO(b);try{const h=new Sys.Net.WebRequest;h.set_httpVerb("GET");h.set_url(b);b={};b.method=h.get_httpVerb();return"function"!==typeof window.fetch?
(Il.fB("InsightsUtils - Failed to download version.json because fetch API is unavailable.",10),Promise.resolve("")):window.fetch(h.getResolvedUrl(),b).then(r=>r.json()).catch(()=>{Il.fB("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(r=>{r=H.b(JSON.stringify(r));return r.version?r.version:""},r=>{Il.fB("InsightsUtils - Failed to deserialize version: "+r.toString(),10);v.ULS.sendTraceTag(591971029,1303,15,"Insights: Failed to deserialize version: "+r.toString());
return""}).then(r=>r)}catch(h){return Il.fB("InsightsUtils - Failed to download version.json: "+h.toString(),10),v.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+h.toString()),Promise.resolve("")}},SO=b=>{const h=y.AFrameworkApplication.Ee;return new Promise(r=>{const A=new DI.a(b,1,null,null,!0,2,null);h.send(A).qDa(M=>{M&&M.data?M.data.De||(Il.fB("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+M.data.Ie,
10),r("")):(Il.fB("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",10),r(""));try{const aa=H.b(M.data.De);aa.version&&r(aa.version)}catch(aa){Il.fB("InsightsUtils - Failed to deserialize version: "+aa.toString(),10),r("")}},M=>{M&&M.data?Il.fB("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+M.data.Ie,10):Il.fB("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",10);r("")})})},
gM=()=>y.AFrameworkApplication.J.$("SmartLookupEnableLocalOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",!1),hC=()=>{const b=yv();return gM()||y.AFrameworkApplication.J.ib("SmartLookupPRClientVersion")?b+NI()+"/":y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?b+Hh.yUj:b+Hh.fpd},NI=()=>gM()?"dev":y.AFrameworkApplication.J.ib("SmartLookupPRClientVersion")?y.AFrameworkApplication.J.ib("SmartLookupPRClientVersion").split("/")[1]:
y.AFrameworkApplication.J.ib("SmartLookupClientVersion"),PF=b=>{var h=3===y.AFrameworkApplication.ua.Ib.Uk?"wordwac":2===y.AFrameworkApplication.ua.Ib.Uk?"pptwac":"excelwac";var r=tj.a.Hg(y.AFrameworkApplication.lcid);const A=r?r.name:"en-us";r=yv();const M=FA();h="main_ssr_wac.html?appName="+h+"&culture="+A;return"LOCAL"===M?r+h:r+((""!==b?b:Hh.fpd)+"/")+h},TO=b=>yv()+(""!==b?b:Hh.fpd)+"/scripts/microsoft.office.smartlookup.host.runtime.js",yv=()=>{switch(FA()){case "LOCAL":return Hh.A7o;case "PR":const b=
y.AFrameworkApplication.J.ib("SmartLookupPRClientVersion").split("/");return Hh.B7o+b[0]+"/";case "INT":return Hh.C7o;case "EDOG":return Hh.zUj;default:return Hh.AUj}},UO=()=>{if(!y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch(FA()){case "EDOG":return Hh.zUj;case "PROD":return Hh.AUj;default:return""}},FA=()=>{if(y.AFrameworkApplication.J.$("SmartLookupEnableEdogSourceLocationOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",
!1))return"EDOG";if(y.AFrameworkApplication.J.$("SmartLookupEnableProdSourceLocationOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",!1))return"PROD";if(y.AFrameworkApplication.J.$("SmartLookupEnableIntSourceLocationOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",!1))return"INT";if(y.AFrameworkApplication.J.ib("SmartLookupPRClientVersion")&&
y.AFrameworkApplication.J.ib("SmartLookupPRIntentSvc"))return"PR";if(gM())return"LOCAL";switch(Object(ya.a)(String,y.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||""){case "Dogfood":if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",!1)){let b=y.AFrameworkApplication.J.ib("UserPrincipalName");b=I.a.vh(b);const h=y.AFrameworkApplication.J.Zx("SmartLookupINTEnabledForSKITeam")?y.AFrameworkApplication.J.cD("SmartLookupINTEnabledForSKITeam"):
[];if(0<=Array.indexOf(h,b))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},OI=()=>{let b;b=y.AFrameworkApplication.J.$("IntentSvcEnableEdogSourceLocationOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",!1)?"EDOG":y.AFrameworkApplication.J.$("IntentSvcEnableProdSourceLocationOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",
!1)?"PROD":y.AFrameworkApplication.J.$("IntentSvcEnableIntSourceLocationOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",!1)?"INT":FA();const h=y.AFrameworkApplication.J.ib("IntentServiceEndpoint"),r=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",!1);if("PROD"===b&&""!==h)return h+"searchendpointv2/";switch(b){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";
case "PR":return y.AFrameworkApplication.J.ib("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(r?"wss://entity.osi.office-int.net/officeaugmentation/":"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(r?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}},GA=()=>{const b=
FA(),h=y.AFrameworkApplication.J.ib("IntentServiceEndpoint");switch(b){case "LOCAL":case "INT":case "EDOG":return"https://shredder-test.osi.office.net/shredderservice/api/refreshmemory";default:return"PROD"===b&&""!==h?"https://shredder-eu.osi.office.net/shredderservice/api/refreshmemory":"https://shredder.osi.office.net/shredderservice/api/refreshmemory"}};class QF{sendTelemetryEvent(b){Il.sendTelemetryEvent(b)}}Object(u.a)(QF,"OtelTelemetrySink",null,[474]);class ON{}Object(u.a)(ON,"ApplicationProperties",
null,[]);class VO{constructor(){this.createdDate=this.author=this.filePath=this.docName=null}}Object(u.a)(VO,"CurrentDocumentProperties",null,[]);class PN{}Object(u.a)(PN,"EnterpriseUserInfo",null,[]);class hM{}Object(u.a)(hM,"FeatureGates",null,[]);class PI{constructor(b,h){this.qw=this.oj=null;this.CPa="Search";this.Z$i=!0;this.dJb=h;this.pu=b;this.pu.execute(r=>{r.isFeatureEnabled("mso_sendASmile",!0).then(A=>{this.Z$i=A}).catch(A=>{Il.fB("SearchHelper - Failed to check if Feedback feature is enabled: "+
A.toString(),15)})});b=OI();h=y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentSearch")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(y.AFrameworkApplication.J.$("SmartLookupFeatureGateV2")){this.qw={};const r=this.SHm();if(r&&0<r.length)for(let A=0;A<r.length;A++){const M=r[A],aa=this.jIm(M);switch(aa.toLowerCase()){case "true":this.qw[M]=!0;break;case "false":this.qw[M]=!1;break;default:this.qw[M]=aa}}this.qw.EnableInDocumentSearch=
h;this.qw.EnableInDocumentSearchReplace=!0;this.qw.EnableInDocumentParamLocalSearch=!0;this.qw.EnableInDocumentQuerySuggest=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentQuerySuggest")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1);this.qw.EnableInDocumentQuestionGeneration=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentQuestionGeneration")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",
!1);this.qw.EnableInDocumentExperiment1=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentExperiment1")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1);this.qw.EnableInDocumentExperiment2=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentExperiment2")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1);this.qw.EnableInDocumentExperiment3=
h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentExperiment3")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1);this.qw.EnableZeroTermAutoRefresh=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1);this.qw.EnableTap3SZeroTerm=y.AFrameworkApplication.J.$("SmartLookupEnableTap3SZeroTerm")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1);this.qw.EnableLocalSearch=!0;this.qw.EnableInDocumentStickyFilters=!0;this.qw.IntentServiceEndpoint=b;this.qw.EnablePDFShredding=y.AFrameworkApplication.J.$("SmartLookupEnableSharepointPDFIsEnabled")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1);this.qw.FilterNonPPTFilesForReuseSlides=y.AFrameworkApplication.J.$("SmartLookupFilterNonPPTFilesForReuseSlides");this.qw.UXBundleVersion=NI();this.qw.SmartLookupServicePath=hC();this.qw.EnableAcronymSearch=
!0;this.qw.UseAltAnswerEndpoint1=y.AFrameworkApplication.J.$("SmartLookupUseAltAnswerEndpoint1")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1);this.qw.UseAltAnswerEndpoint2=y.AFrameworkApplication.J.$("SmartLookupUseAltAnswerEndpoint2")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.qw.UseAltAnswerEndpoint3=y.AFrameworkApplication.J.$("SmartLookupUseAltAnswerEndpoint3")||
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1);this.qw.UseNextUXVersion=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1);this.qw.IgnoreNeighborhoodContext=y.AFrameworkApplication.J.$("SmartLookupIgnoreNeighborhoodContextIsEnabled");this.qw.ShowDebugInfo="INT"===FA();this.qw.DebugCommands=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
"");this.qw.ChangeGates=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames","");this.qw.QnaInMixSection=!0;this.qw.EnableNoteSearch=y.AFrameworkApplication.J.$("SmartLookupNoteSearchIsEnabled")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1);this.qw.EnableWikiL2=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);this.qw.EnableFilteringOutRedundantKPE=
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1);this.qw.EnableZeroTermEntitySuggestion=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1);this.qw.RankingModels=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels","");this.qw.EnableClientSideRendering=!0}else this.oj=new hM,this.oj.EnableInDocumentSearch=h,this.oj.EnableInDocumentSearchReplace=
!0,this.oj.EnableInDocumentParamLocalSearch=!0,this.oj.EnableInDocumentQuerySuggest=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentQuerySuggest")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1),this.oj.EnableInDocumentQuestionGeneration=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentQuestionGeneration")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",
!1),this.oj.EnableInDocumentExperiment1=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentExperiment1")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1),this.oj.EnableInDocumentExperiment2=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentExperiment2")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1),this.oj.EnableInDocumentExperiment3=
h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentExperiment3")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.oj.EnableZeroTermAutoRefresh=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.oj.EnableTap3SZeroTerm=y.AFrameworkApplication.J.$("SmartLookupEnableTap3SZeroTerm")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1),this.oj.EnableLocalSearch=!0,this.oj.EnableInDocumentStickyFilters=!0,this.oj.IntentServiceEndpoint=b,this.oj.EnablePDFShredding=y.AFrameworkApplication.J.$("SmartLookupEnableSharepointPDFIsEnabled")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.oj.FilterNonPPTFilesForReuseSlides=y.AFrameworkApplication.J.$("SmartLookupFilterNonPPTFilesForReuseSlides"),this.oj.UXBundleVersion=NI(),this.oj.SmartLookupServicePath=hC(),this.oj.EnableAcronymSearch=
!0,this.oj.UseAltAnswerEndpoint1=y.AFrameworkApplication.J.$("SmartLookupUseAltAnswerEndpoint1")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1),this.oj.UseAltAnswerEndpoint2=y.AFrameworkApplication.J.$("SmartLookupUseAltAnswerEndpoint2")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1),this.oj.UseAltAnswerEndpoint3=y.AFrameworkApplication.J.$("SmartLookupUseAltAnswerEndpoint3")||
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.oj.UseNextUXVersion=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1),this.oj.IgnoreNeighborhoodContext=y.AFrameworkApplication.J.$("SmartLookupIgnoreNeighborhoodContextIsEnabled"),this.oj.ShowDebugInfo="INT"===FA(),this.oj.DebugCommands=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
""),this.oj.ChangeGates=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.oj.QnaInMixSection=!0,this.oj.EnableNoteSearch=y.AFrameworkApplication.J.$("SmartLookupNoteSearchIsEnabled")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1),this.oj.EnableWikiL2=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),this.oj.EnableFilteringOutRedundantKPE=
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.oj.EnableZeroTermEntitySuggestion=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1),this.oj.RankingModels=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",""),this.oj.EnableClientSideRendering=!0,this.oj.SharedSerpletFeatureGate1=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",
!1),this.oj.SharedSerpletFeatureGate2=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.oj.SharedSerpletFeatureGate3=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",!1),this.oj.SharedSerpletFeatureGate4=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",!1),this.oj.SharedSerpletFeatureGate5=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",
!1),this.oj.SharedSerpletFeatureGate6=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.oj.SharedSerpletFeatureGate7=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",!1),this.oj.SharedSerpletFeatureGate8=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",!1),this.oj.SharedSerpletFeatureGate9=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",
!1),this.oj.SharedSerpletFeatureGate10=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.oj.SharedSerpletFeatureGate11=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",!1),this.oj.SharedSerpletFeatureGate12=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",!1),this.oj.SharedSerpletFeatureGate13=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",
!1),this.oj.SharedSerpletFeatureGate14=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.oj.SharedSerpletFeatureGate15=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",!1),this.oj.SharedSerpletFeatureGate16=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",!1),this.oj.SharedSerpletFeatureGate17=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",
!1),this.oj.SharedSerpletFeatureGate18=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.oj.SharedSerpletFeatureGate19=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",!1),this.oj.SharedSerpletFeatureGate20=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",!1),this.oj.SharedSerpletFeatureGate21=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",
!1),this.oj.SharedSerpletFeatureGate22=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.oj.SharedSerpletFeatureGate23=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",!1),this.oj.SharedSerpletFeatureGate24=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",!1),this.oj.SharedSerpletFeatureGate25=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",
!1),this.oj.SharedSerpletFeatureGate26=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.oj.SharedSerpletFeatureGate27=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",!1),this.oj.SharedSerpletFeatureGate28=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",!1),this.oj.SharedSerpletFeatureGate29=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",
!1),this.oj.SharedSerpletFeatureGate30=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.oj.SharedSerpletFeatureGate31=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",!1),this.oj.SharedSerpletFeatureGate32=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1),this.oj.SharedSerpletFeatureGate33=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",
!1),this.oj.SharedSerpletFeatureGate34=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.oj.SharedSerpletFeatureGate35=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",!1),this.oj.SharedSerpletFeatureGate36=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",!1),this.oj.SharedSerpletFeatureGate37=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",
!1),this.oj.SharedSerpletFeatureGate38=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.oj.SharedSerpletFeatureGate39=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",!1),this.oj.SharedSerpletFeatureGate40=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",!1);this.uKc=Za.a.instance.resolve(1167);this.oub=PI.isEnterpriseUser();
this.ZXa=y.AFrameworkApplication.J.ib("SmartLookupShredderServiceEndpoint");this.I6f=$a.a.kU(y.AFrameworkApplication.J.ib("AppCatalogUrl")||"");this.xEn=y.AFrameworkApplication.J.ib("UserPrincipalName");this.oub&&this.EFi()}jIm(b){return y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline."+b,"")}SHm(){const b=y.AFrameworkApplication.J.m8a,h=y.AFrameworkApplication.J.cD("SmartLookupFlightKeywordList"),r=[];if(b&&h&&0<h.length)for(const M in b){var A={key:M,value:b[M]};A=
A&&A.key?A.key:"";for(let aa=0;aa<h.length;aa++)if(-1<A.toLowerCase().indexOf(h[aa].toLowerCase())){const oa=A.split(".");oa&&4===oa.length&&Array.add(r,oa[oa.length-1])}}return r}RMf(b,h,r,A){return new Promise(M=>{this.Eon().then(aa=>{const oa=new ON;oa.anid="";oa.applicationName=3===y.AFrameworkApplication.ua.Ib.Uk?"WORD":"POWERPNT";oa.applicationVersion=y.AFrameworkApplication.buildVersion;oa.appCorrelationId=b?b:pu.OOb();oa.themePlatform="web";oa.lcid=y.AFrameworkApplication.lcid;oa.launchUtcTime=
(new Date).toUTCString();y.AFrameworkApplication.J.$("SmartLookupFeatureGateV2")?oa.featureGates=H.c(this.qw):oa.featureGates=H.c(this.oj);var Ja=tj.a.Hg(y.AFrameworkApplication.lcid);Ja=Ja?Ja.name:null;oa.market=RD(Ja);oa.uiLanguage=Ja;oa.sessionId=y.AFrameworkApplication.userSessionId;oa.themeId=r;oa.parentalControl="yes";oa.processorOnlyMode=aa;oa.isEditingAllowed=h.isEditingAllowed();oa.isFeedbackEnabled=this.Z$i;oa.isClientSideRendering=18===A||19===A||15===A;oa.disableClipboard=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletRestrictCopyWithIRMEnabled",
!1)&&y.AFrameworkApplication.lH&&!y.AFrameworkApplication.ENb;oa.accessToken=this.oub?this.EFi():"";aa=new PN;aa.CountryCode=RD(Ja);aa.ServiceEndpoint=this.ZXa;aa.IsGoLocal=y.AFrameworkApplication.J.$("IsGoLocalEnvironment");aa.IsEnabled=this.oub;aa.IsEnterpriseEnabled=this.oub;aa.TenantRoot=this.I6f;aa.Upn=this.xEn;Ja=FA();aa.IsEUDB="PROD"===Ja&&""!==y.AFrameworkApplication.J.ib("IntentServiceEndpoint");oa.enterpriseUserInfo=aa;aa=new VO;aa.filePath=y.AFrameworkApplication.J.ib("EditDocInClientUrl");
aa.docName=y.AFrameworkApplication.J.ib("FileName");aa.author=99!==A?h.author():null;aa.createdDate=99!==A?h.createdDate():null;oa.currentDocument=aa;M(oa)})})}Eon(){return new Promise(b=>{this.pu?this.pu.execute(h=>{h.isFeatureEnabled(Hh.D7o,!0).then(r=>{b(!r)}).catch(r=>{Il.fB("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+r.toString(),10);b(!0)})}):b(!0)})}e8n(b){this.uKc&&this.oub&&this.K8d(this.ZXa).then(h=>{b(h)})}EFi(){return"Dev Box"===y.AFrameworkApplication.J.ib("StatusBarEnvironmentNameToUse")&&
void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?window.SearchPaneShredderTokenOverride:this.uKc?this.uKc.$Lm(this.CPa,this.ZXa):""}K8d(b){return"Dev Box"===y.AFrameworkApplication.J.ib("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?new Promise(h=>{h(window.SearchPaneShredderTokenOverride)}):this.uKc?this.uKc.getToken(this.CPa,b):Promise.resolve("")}P3c(){return this.dJb?
this.dJb.getVersion():""}npm(){return y.AFrameworkApplication.J.$("SmartLookupFeatureGateV2")?H.c(this.qw):H.c(this.oj)}static isEnterpriseUser(){const b=y.AFrameworkApplication.J.ib("SovereignEnvironmentName"),h=y.AFrameworkApplication.J.$("IsTellMeUpSellEnterpriseEnabled");return(!b||!b.length)&&h}}Object(u.a)(PI,"SearchHelper",null,[446]);class SD{constructor(){SD._instance=""}getVersion(){return SD._instance}hXo(b){SD._instance=b}}SD._instance=null;Object(u.a)(SD,"SmartLookupVersion",null,[]);
class QN{}Object(u.a)(QN,"ConfigurationProvider",null,[]);class iC{constructor(b){iC._instance=b}nJf(){return iC._instance}}iC._instance=null;Object(u.a)(iC,"SearchHostRuntime",null,[]);class iM{constructor(){this.zia=this.F3b=this.W=null}get name(){return"Common.App.Insights"}uc(b){this.W=b;const h=Xe.a.Yp(Za.a.instance.Ra(804)),r=y.AFrameworkApplication.J.$("SmartLookupEnableNativePane")||y.AFrameworkApplication.J.$("SmartLookupIsEnabled");b.register(NN,1170).ha().Sd(()=>new NN(b.rf(1168),y.AFrameworkApplication.va,
Cp.a.instance,Cd.FocusManager.instance(),b.Ra(1167),y.AFrameworkApplication.J,Je.a.instance,r,new Qf.a(()=>h.result)));b.register(445,1176).ha().Sd(()=>new MN(b));r&&(b.register(SD,1169).ha().Sd(()=>new SD),b.register(446,1171).ha().Sd(()=>new PI(Za.a.instance.Ra(4),b.Oa(1169))))}init(){y.AFrameworkApplication.Y2&&(this.F3b=this.W.Oa(1170),this.F3b.Xb())}$oo(){if(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RecallRefreshMemory",!1)){var b=y.AFrameworkApplication.J.ib("SmartLookupShredderServiceEndpoint");
this.W.resolve(1171).K8d(b).then(h=>{var r={};r.Authorization="Bearer "+h;h=GA();const A=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RefreshMemoryTelemetry",!0);r=new DI.a(h+("?isTelemetryOnly="+A),1,null,r,!0,2,null);y.AFrameworkApplication.Ee.send(r).qDa(()=>{Il.fB("InsightsPackage - Refresh Memory API request sent and was successful. isTelemetryOnly="+A,50)},M=>{Il.fB("InsightsPackage - Failed to send refreshmemory API request. Error: "+M.toString(),
10)})})}}RVl(){this.J9m();this.$oo()}J9m(){RO().then(b=>{if(""!==b){const h=this.W.Oa(1169);h&&h.hXo(b)}this.x_d();this.F3b=this.W.resolve(1170);b=TO(b);b=ob.a.create(b);b.a2((h,r)=>{r.succeeded?this.hYo()&&this.prefetchZeroTerm():Il.fB("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+r.QF,10);this.F3b.Xb()});pb.a.l_(b)})}hYo(){const b=Object.assign(new QN,{channelId:Hh.channelId,approvedOriginPattern:gM()?"^(http)?://(localhost:8080)$":y.AFrameworkApplication.J.ib("SmartLookupApprovedOriginPattern")});
var h=this.W.resolve(1172);const r=this.W.resolve(1173),A=this.W.resolve(1174),M=new ib.a;h&&M.add(h);r&&M.add(r);A&&M.add(A);h=OI();try{const aa=new QF,oa=SmartLookupHostRuntime.setup(b,M.toArray(),!0,h,aa);this.W.register(iC,1166).ha().Sd(()=>new iC(oa));return!0}catch(aa){return Il.fB("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+aa,10),!1}}prefetchZeroTerm(){if(y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentSearch")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",
!1)){var b=Za.a.instance.Oa(1166);if(b){const h=this.W.resolve(1171),r=this.W.resolve(1175);h.RMf(null,r,0,99).then(A=>{b.nJf().prefetchZeroTerm(A,y.AFrameworkApplication.userSessionId,hC(),!0,"Indoc",null)})}else Il.fB("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",15)}}x_d(){var b=this.W.resolve(1171);const h=PF(b.P3c());b=b.P3c();b=yv()+(""!==b?b:Hh.fpd)+"/scripts/microsoft.office.smartlookup.ssr.js";const r=UO();Y.a.kta?this.QVl(h,b):(this.NVl(h,
r),this.OVl(b,r))}NVl(b,h){const r=new Sys.Net.WebRequest;r.set_httpVerb("GET");const A={};A.method=r.get_httpVerb();r.set_url(b);const M=(new Date).getTime();try{window.fetch(r.getResolvedUrl(),A).then(()=>{""!==h&&Il.Fwg(h,b,(new Date).getTime()-M);this.W.Oa(1169)})}catch(aa){Il.fB("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+aa.toString(),10)}}OVl(b,h){var r=new Sys.Net.WebRequest;r.set_httpVerb("GET");const A={};A.method=r.get_httpVerb();r.set_url(b);let M=
-1;if(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))r=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",3E5),Je.a.instance.Zb(new xc.a(5,1,r,()=>{const aa=ob.a.create(b);aa.Yef(()=>{M=Date.now()});aa.a2((oa,Ja)=>{Ja.succeeded?""!==h&&Il.Fwg(h,b,Date.now()-M):Il.fB("InsightsPackage - Failed to prefetch JS file.",10)});pb.a.l_(aa)}));else{M=Date.now();try{window.fetch(r.getResolvedUrl(),
A).then(()=>{""!==h&&Il.Fwg(h,b,Date.now()-M)})}catch(aa){Il.fB("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+aa.toString(),10)}}}QVl(b,h){if(Y.a.kta){var r=y.AFrameworkApplication.Ee;b=new DI.a(b,1,null,null,!0,2,null);r.send(b).qDa(A=>{A&&A.data?A.data.De?this.W.Oa(1169):Il.fB("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+A.data.Ie,10):Il.fB("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",
10)},A=>{A&&A.data?Il.fB("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+A.data.Ie,10):Il.fB("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",10)});y.AFrameworkApplication.J.$("SmartLookupPrefetchJSIsEnabled")&&(h=new DI.a(h,1,null,null,!0,2,null),r.send(h).qDa(A=>{A&&A.data?A.data.De||Il.fB("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+A.data.Ie,10):
Il.fB("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},A=>{A&&A.data?Il.fB("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+A.data.Ie,10):Il.fB("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",10)}))}}dispose(){this.F3b&&this.F3b.dispose()}}Object(u.a)(iM,"InsightsPackage",null,[0,1]);var RN=d(1529);class SN{constructor(){this.documentContentTableName=this.dataCenterEndpoint=
this.documentContentKey=null}}Object(u.a)(SN,"DocumentContentParams",null,[]);var XK=d(1882),TN=d(751),HA=d(2096),UN=d(2097),jM;(function(b){b.BlockedByClassifier="BlockedByClassifier";b.BlockedByLanguage="BlockedByLanguage";b.BlockedByPostfilter="BlockedByPostfilter";b.BlockedByPostfilterProcessError="BlockedByPostfilterProcessError";b.BlockedByPrefilter="BlockedByPrefilter";b.BlockedByQualityCheck="BlockedByQualityCheck";b.DocumentLengthTooShort="DocumentLengthTooShort";b.InvalidRequestForm="InvalidRequestForm";
b.NthParagraphSummaryNotSupported="NthParagraphSummaryNotSupported";b.OffensiveContentInUserInput="OffensiveContentInUserInput";b.OutOfScopeRequestInUserInput="OutOfScopeRequestInUserInput";b.ResourceUnavailable="ResourceUnavailable";b.Success="Success";b.Timeout="Timeout";b.UnknownError="UnknownError";b.UnknownErrorInParser="UnknownErrorInParser";b.UserNotAuthorized="UserNotAuthorized"})(jM||(jM={}));var kM;(function(b){b.FailedTTS="FailedTTS";b.NotRequestedTTS="NotRequestedTTS";b.Success="Success";
b.UnknownError="UnknownError"})(kM||(kM={}));var at;(function(b){b.T0a="SearchProvider";b.Zfb="TextSummarization"})(at||(at={}));Object(u.b)("WorkflowType",at);var Nu;(function(b){b.Success="Success";b.VPg="Invoked";b.Error="Error"})(Nu||(Nu={}));Object(u.b)("LogType",Nu);var ew;(function(b){b.Vbk="AugloopLateResponse";b.BlockedByPrefilter="BlockedByPrefilter";b.BlockedByQualityCheck="BlockedByQualityCheck";b.BlockedByClassifier="BlockedByClassifier";b.UPg="InvalidAnnotation";b.qhk="StaleAnnotation";
b.Timeout="Timeout";b.Other="Other"})(ew||(ew={}));Object(u.b)("ErrorReason",ew);class QI{constructor(b){this.bgi=b;this.Idg=this.Idg.bind(this);this.zWb=this.zWb.bind(this);this.cgp=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.TextSummarizationRequestTimeout",5E3)}async submitDocumentContentExtractionSignal(){try{this.MJo=Date.now();this.Bxb=kb.a.create().toString();this.log({qM:at.T0a,logType:Nu.VPg,success:!0,correlationId:this.Bxb});var b=FA().toLowerCase();b="int"===
b||"local"===b;await this.activateAnnotation();const h=new on.l({parentPath:["Signal",XK.SearchProviderSignal.getTypeName()],items:[{id:"SearchProvider",body:new XK.SearchProviderSignal({correlationId:this.Bxb,shouldUseIntEndpoint:b})}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:h});this.BIj=window.setTimeout(()=>{this.onError(at.T0a,Nu.Error,ew.Timeout)},1500)}catch(h){window.clearTimeout(this.BIj),this.onError(at.T0a,Nu.Error,ew.Other,this.hwi(h))}}async generateDocumentSummaryDetails(){try{if(!QI.m$c)return null;
this.bgp=Date.now();this.log({qM:at.Zfb,logType:Nu.VPg,success:!0});await this.activateAnnotation();const b=new on.l({parentPath:["Signal",HA.a.getTypeName()],items:[{id:"TextSummarization",body:new HA.a}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:b});this.DZj=window.setTimeout(()=>{this.onError(at.Zfb,Nu.Error,ew.Timeout)},this.cgp);return new Promise(h=>{this.dyc=h})}catch(b){window.clearTimeout(this.DZj),this.onError(at.Zfb,Nu.Error,ew.Other,this.hwi(b))}}async generateDocumentSummary(){var b;
return null===(b=await this.generateDocumentSummaryDetails())||void 0===b?void 0:b.summary}static get m$c(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableDocumentSummarization",!1)}static get Ion(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableVoiceSummarization",!1)}async activateAnnotation(){if(!this.Lmc){await xs.a.hm();var b=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation,
h=[b(Object.assign(new TN.a,{annotationType:XK.SearchProviderAnnotation.getTypeName(),handler:this.Idg}))];QI.m$c&&h.push(b(Object.assign(new TN.a,{annotationType:UN.b.getTypeName(),handler:this.zWb})));await Promise.all(h);this.Lmc=!0}}zWb(b){var h,r,A;if(this.dyc)if(this.vZi(b)){if(b=b.items[0],UN.b.typeGuard(b.body))if(window.clearTimeout(this.DZj),b=b.body,b.status!==jM.Success)this.onError(at.Zfb,Nu.Error,this.Qom(b),`[TextSummary] workflow failed with status: ${b.status}`);else{this.log({qM:at.Zfb,
logType:Nu.Success,success:!0});var M=null!==b.summary&&""!==b.summary,aa=QI.Ion&&(null===(h=b.tts)||void 0===h?void 0:h.requestStatus)===kM.Success&&null!==(null===(r=b.tts)||void 0===r?void 0:r.base64Audio)&&""!==(null===(A=b.tts)||void 0===A?void 0:A.base64Audio);this.dyc({succeeded:M,summary:M?b.summary:null,audioSucceeded:aa,audioBase64:aa?b.tts.base64Audio:null});this.dyc=null}}else this.log({qM:at.Zfb,logType:Nu.Error,success:!1,N0d:ew.UPg})}Idg(b){if(this.vZi(b)&&(b=b.items[0],XK.SearchProviderAnnotation.typeGuard(b.body)))if(window.clearTimeout(this.BIj),
(b=b.body)&&(b.docContentKey||b.dataCenterEndpoint||b.documentContentTableName))if(void 0===this.Bxb)this.log({qM:at.T0a,logType:Nu.Error,N0d:ew.Vbk,success:!1,correlationId:b.correlationId,message:"[SearchProvider] workflow results arrived after timeout",workflowExecutionTime:b.workflowExecutionTime});else if(this.Bxb!==b.correlationId)this.log({qM:at.T0a,logType:Nu.Error,N0d:ew.qhk,success:!1,correlationId:b.correlationId,message:"[SearchProvider] current correlation Id is not the one pending",
workflowExecutionTime:b.workflowExecutionTime});else{var h=this.t8h(b.docContentKey,b.dataCenterEndpoint,b.documentContentTableName);this.log({qM:at.T0a,logType:Nu.Success,success:!0,correlationId:b.correlationId,workflowExecutionTime:b.workflowExecutionTime});this.Bxb=void 0;this.bgi.PLj(h)}else this.onError(at.T0a,Nu.Error,ew.UPg)}Qom(b){switch(b.status){case "BlockedByPrefilter":return ew.BlockedByPrefilter;case "BlockedByQualityCheck":case "BlockedByPostfilter":return ew.BlockedByQualityCheck;
default:return ew.Other}}vZi(b){return b&&b.items&&0<b.items.length&&b.items[0].body}log(b){switch(b.qM){case at.T0a:var h=this.MJo;break;case at.Zfb:h=this.bgp;break;default:h=-1}const r=Date.now(),A=h?r-h:-1;h=[Object.assign(new ia.a,{name:"WorkflowType",string:b.qM}),Object.assign(new ia.a,{name:"LogType",string:b.logType}),Object.assign(new ia.a,{name:"ErrorReason",string:b.N0d}),Object.assign(new ia.a,{name:"CorrelationId",string:b.correlationId}),Object.assign(new ia.a,{name:"Message",string:b.message}),
Object.assign(new ia.a,{name:"WorkflowExecutionTime",int64:b.workflowExecutionTime}),Object.assign(new ia.a,{name:"StartTime",int64:h}),Object.assign(new ia.a,{name:"EndTime",int64:r}),Object.assign(new ia.a,{name:"Duration",int64:A})];Object(ac.a)("AugloopSearchProviderData",b.success,A,h)}hwi(b){return`Error: ${b}, Message: ${b.message}, Stack: ${b.stack}`}t8h(b="",h="",r=""){return Object.assign(new SN,{documentContentKey:b,dataCenterEndpoint:h,documentContentTableName:r})}onError(b,h,r,A){h={qM:b,
logType:h,success:!1,message:A,N0d:r};switch(b){case at.T0a:if(!this.Bxb)break;h.correlationId=this.Bxb;this.log(h);this.Bxb=void 0;this.r3l();break;case at.Zfb:if(!this.dyc)break;this.log(h);this.dyc(null);this.dyc=null;break;default:return null}}r3l(){this.bgi.PLj(this.t8h())}}Object(u.a)(QI,"AugloopSearchProviderManager",null,[]);class YK{constructor(){this.results=null;this.totalResultCount=0;this.hasTooManyResults=!1}}Object(u.a)(YK,"DocumentContentSearchResults",null,[]);class lM{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(b,
h,r,A,M){this.selectRange(h,r,A,M)}selectRangeV3(){}search(){}searchV2(b,h){this.search(b,r=>{h(Object.assign(new YK,{results:r,totalResultCount:r.length,hasTooManyResults:100<r.length}))})}searchWithParam(b,h){this.search(b.query,h)}searchWithParamV2(b,h){this.searchWithParam(b,r=>{h(Object.assign(new YK,{results:r,totalResultCount:r.length,hasTooManyResults:r.length>b.totalResultLimit}))})}highlight(){}highlightWithParam(b){this.highlight(b.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return Promise.resolve(null)}generateDocumentSummaryDetails(){return Promise.resolve(null)}extractDocumentObjects(){}getAuthorImageUrlFromClient(){return Promise.resolve(null)}getId(){return"DocumentContentExecutor"}}
Object(u.a)(lM,"BaseDocumentContentExecutor",null,[1836,295]);var RI=d(2137),VN=d(1343);class SI{constructor(){this.query=null;this.matchWholeWordOnly=this.matchCase=!1;this.totalResultLimit=0}}Object(u.a)(SI,"DocumentContentSearchParams",null,[]);class ZK{constructor(){this.subdocumentId=null;this.endParagraphOffset=this.endParagraphIndex=this.startParagraphOffset=this.startParagraphIndex=0}}Object(u.a)(ZK,"DocumentSelection",null,[]);class WN{constructor(){this.authorID=this.authorColor=this.authorImageURL=
null}}Object(u.a)(WN,"IAuthorProperties",null,[]);var Pw=d(680);class mM{constructor(){this.V_c=this.jpf=0}}Object(u.a)(mM,"CommentFindResultIndexInfo",null,[]);const $K=b=>{b.Kc(ze.a.uk(b.gb.currentSelection,!0,!1))},nM=b=>{b=RI.a.v7d(b.text[0]).split("\n");return 1===b.length?b[0]:b.join(" ")};class oM{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=
0;this.authorName=this.authorEmail=null}}Object(u.a)(oM,"DocumentContentSearchResult",null,[]);var XN=d(1839);class WO{constructor(){this.authorEmail=this.authorName=this.kOb=this.ppf=null}}Object(u.a)(WO,"CommentFindResults",null,[]);class jC{constructor(){this.end=this.Ec=0}}Object(u.a)(jC,"FindResultOffset",null,[]);class qu{constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb){this.eLe=this.uw=this.uRe=this.qC=null;this.$Gh=0;this.rO=null;this.dEc=new ib.a;this.Hah=null;this.Uu=b;this.jb=h;this.Bkb=r;this.Wia=
M;this.E6b=aa;this.kDb=oa;this.xi=Ja;this.ga=fb;this.hb=Cb}Csm(b,h){var r;const A=[];if(12!=b.type)return A;const M=Wa.FormattingReader.rri(b);let aa=null,oa=-1;var Ja=Ol.a.auto;for(let Cb=0;Cb<=M.length;Cb++){let Gb=-1;var fb=Ol.a.auto;Cb<M.length&&(fb=M[Cb],Gb=fb.cp,fb=null===(r=fb.formatting)||void 0===r?void 0:r.cache,fb=(null===fb||void 0===fb?0:fb.SQb)?fb.highlight:(null===fb||void 0===fb?0:fb.jWa)?fb.$w:Ol.a.auto);if(Ja!=fb){if(Ja!=Ol.a.auto){aa||(aa=this.kDb.DVa(b.id));-1==Gb&&(Gb=aa.length);
Ja=this.Bkb.WXd(aa,oa,Gb,"");const Sb={};Sb.context=Ja.NWd;Sb.startOffsetInContext=Ja.nue;Sb.endOffsetInContext=Ja.lue-1;A.push({data:Sb,startParagraphIndex:h,endParagraphIndex:h,startOffsetInParagraph:oa,endOffsetInParagraph:Gb-1})}oa=Gb;Ja=fb}}return A}get xea(){return this.Hah}initialize(){this.qC=FB.a.createInstance(this,this.Wia,gA.a.instance,!1,!0)}search(b,h){this.qC.m6a();this.YZf(b)?(this.uw=h,this.rO=new ib.a,b=this.Zsf(b),this.qC.find(b)):h(null)}searchV2(b,h){this.qC.m6a();if(this.YZf(b)){this.CXi()&&
this.ga.Pb(Ka.a.Iwe,2,{CommandValueId:b});this.eLe=h;this.$Gh=b.totalResultLimit;this.rO=new ib.a;b=this.Zsf(b);this.Hah=new cp.a;this.qC.find(b);h=this.Wia.Ygd(b.text);h=this.Wia.ZWb(h);b=this.E6b.kkc(h.join("|"),b);h=this.xi.qR();for(let A=0;A<h.length;A++){const M=h[A],aa=nM(M);var r=this.kDb.GQb(aa,b);const oa=this.kDb.GQb(M.author,b);if(!r&&!oa){v.ULS.sendTraceTag(572343620,313,15,"commentTextIsNull: {0}, findRegexIsNull: {1}",!aa,!b);continue}r=oa&&0<oa.length?oa:r;let Ja="",fb="";oa&&0<oa.length&&
(Ja=M.author,fb=M.authorId);for(const Cb of r)r=XN.a.createInstance(Cb.Ec,Cb.end,N.a.Cf(M.objectId),A,32,!1),this.dEc.add(r),this.xea.lb(A)||this.xea.add(A,Object.assign(new WO,{ppf:aa,kOb:[],authorName:Ja,authorEmail:fb}))}}else h(null)}get Wmi(){null==this.uRe&&(this.uRe=FB.a.createInstance(this,this.Wia,gA.a.instance));return this.uRe}CXi(){var b;return null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}Hnc(){var b;
return null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocNoteSearchOnWac",!1)}highlight(b){var h=this.YZf(b);b=h?this.Zsf(b):null;var r={};this.CXi()&&this.ga.Pb(Fc.a.eog,2,r);if(r[Vg.a.On]){if(h){h={};r={};var A={};this.ga.Pb(Fc.a.Gqe,2,h);this.ga.Pb(Ka.a.Fqe,2,r);this.ga.Pb(Ka.a.Hqe,2,A);if(b.text!=h.CommandValueId||b.matchCase!=r[Vg.a.On]||b.matchWholeWord!=A[Vg.a.On])$K(this.hb),this.ga.Pb(Ka.a.Uhc,2,{CommandValueId:b.text,
MatchCase:b.matchCase,MatchWholeWord:b.matchWholeWord})}}else r=this.Wmi,r.m6a(),h&&r.find(b)}selectNextPrevHighlight(b){const h=this.Wmi;return 0<h.zk.Pna?(b?h.CJi():h.HJi(),h.zk.Vcf-1):-1}Zsf(b){let h=ez.a.none;b.matchCase&&(h|=ez.a.matchCase);b.matchWholeWordOnly&&(h|=ez.a.ONg);return AH.a.createQuery(b.query,h)}YZf(b){return b&&!!b.query&&0<b.query.length}Bxe(){}Xve(){}reset(){}ICf(){}Shc(){if(this.uw){var b=this.u8h(this.rO);this.uw(b)}if(this.eLe){b=new YK;const h=this.rO.count+this.dEc.count>
this.$Gh;b.totalResultCount=this.rO.count+this.dEc.count;b.hasTooManyResults=h;h||(this.rO.iD(this.rO.count,this.dEc),b.results=this.u8h(this.rO));this.eLe(b);this.dEc.clear()}}u8h(b){var h;const r=[];var A=Object.assign(new Pw.a,{R_:!1,Ssa:!0,RKa:this.Hnc(),S_:!0});A=this.jb.iKa(this.Uu.value,A);for(const oa of b){var M=oa.Ec;let Ja=oa.end;var aa=void 0;b=-1;let fb=null,Cb=0;if(32===oa.type){fb=qu.opf;Cb=3;b=A.count+oa.qWa;const Gb=({Ec:M,end:Ja}=RN.a.uAj(this.xea.K(oa.qWa).ppf,M,Ja)).returnValue;
aa=this.Bkb.WXd(Gb,M,Ja,$E.a(oa.type));this.xea.K(oa.qWa).ppf=Gb;this.xea.K(oa.qWa).kOb.push(Object.assign(new jC,{Ec:M,end:Ja}))}else{if(2===oa.type||4===oa.type)Cb=2===oa.type?1:2,fb=qu.IRf;if(8===oa.type||16===oa.type)Cb=8===oa.type?6:5,fb=qu.obg;for(aa=0;aa<A.count;aa++)if(A.K(aa).id===oa.nodeId){b=aa;break}aa=this.Bkb.XXd(oa)}M=(null===(h=this.xea)||void 0===h?0:h.lb(oa.qWa))?this.xea.K(oa.qWa):null;if(0<=b||(null===M||void 0===M?0:M.authorName))b=Object.assign(new oM,{snippet:aa.NWd,subdocumentId:fb,
subdocumentType:Cb,startOffsetInSnippet:aa.nue,endOffsetInSnippet:aa.lue-1,paragraphIndex:b,startOffsetInParagraph:oa.Ec-aa.nue,endOffsetInParagraph:oa.end-aa.lue-1,authorName:M?M.authorName:"",authorEmail:M?M.authorEmail:""}),r.push(b)}r.sort((oa,Ja)=>oa.paragraphIndex===Ja.paragraphIndex?oa.startOffsetInParagraph-Ja.startOffsetInParagraph:oa.paragraphIndex-Ja.paragraphIndex);return r}update(){}dVa(b,h){switch(b){case 0:h&&0<h.length&&!this.rO&&(v.ULS.sendTraceTag(570975814,313,15,"Results container list is null"),
this.rO=new ib.a);for(const r of h)this.rO.add(r)}}fyb(){}dispose(){}}qu.opf="Comment";qu.IRf="HeaderFooter";qu.obg="Note";qu.LOi="Image";Object(u.a)(qu,"WordDocumentSearchProcessor",null,[422,10,442]);class pM extends lM{Hnc(){var b;return null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocNoteSearchOnWac",!1)}constructor(b,h,r,A,M,aa,oa,Ja,fb,Cb,Gb,Sb,pc){super();this.ZGa=null;this.FN=(zc,Yc)=>{zc=Yc.node;Yc=Yc.property;
this.YAg(zc)&&Yc===He.a.Pn&&this.LQb(zc,3)};this.xma=(zc,Yc)=>{zc=Yc.node;!Yc.Oce&&this.YAg(zc)&&this.LQb(zc,1)};this.wvb=(zc,Yc)=>{zc=Yc.node;this.YAg(zc)&&this.LQb(zc,2)};this.Uu=b;this.jb=h;this.kd=r;this.hb=A;this.sG=M;this.gm=Ja;this.Yb=fb;this.A$=aa;this.PD=oa;this.xi=Cb;this.Jxk=Gb;this.nBh=N.a.create();this.Ise(this.FN,this.xma,this.wvb);pc&&pc.execute(zc=>this.Ipa=zc);Sb.execute(zc=>{this.B4a=zc})}submitDocumentContentExtractionSignal(){this.B4a&&this.B4a.submitDocumentContentExtractionSignal()}generateDocumentSummary(){return this.B4a?
this.B4a.generateDocumentSummary():Promise.resolve(null)}generateDocumentSummaryDetails(){return this.B4a?this.B4a.generateDocumentSummaryDetails():Promise.resolve(null)}getAllParagraphsInDocument(){const b=this.nN(this.UBm());for(const r of this.xi.qR()){var h=RI.a.v7d(r.text[0]).split("\n");h=1===h.length?h[0]:h.join(" ");b.add(h)}return b.toArray()}extractDocumentObjects(b){var h=Object.assign(new Pw.a,{R_:!1,Ssa:!1,S_:!0}),r=this.jb.iKa(this.Uu.value,h);h=[];const A=[];for(var M=0;M<r.count;++M){var aa=
r.K(M);h.push(...this.xtm(aa,M));A.push(...this.A$.Csm(aa,M))}r=[];M=this.xi.qR();for(aa=0;aa<M.length;aa++)r.push(this.Njm(M[aa]));M={};M.images=h;M.comments=r;M.highlights=A;b(M)}selectRange(b,h,r,A,M){const aa=Date.now(),oa={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.l_a();if(0>b||0>h||0>r||0>A||b>r||b===r&&h>A)throw Error("Provided select range offsets incorrect");const zc=Object.assign(new Pw.a,{R_:!1,Ssa:!0,RKa:this.Hnc(),S_:!0}),Yc=
this.jb.iKa(this.Uu.value,zc);if(r>=Yc.count){const Kd=Za.a.instance.resolve(744).qR(),ke=r-Yc.count;if(ke<Kd.length){M=-1;if(this.A$.xea.lb(ke)){const de=this.A$.xea.K(ke).kOb;for(var Ja=0;Ja<de.length;Ja++)if(de[Ja].Ec===h){M=Ja;break}}this.ZGa=-1!==M?Object.assign(new mM,{jpf:ke,V_c:M}):null;const ge=Kd[ke];y.AFrameworkApplication.va.Ob(Fc.a.KW,2);y.AFrameworkApplication.va.Pb(Fc.a.I6,2,null);y.AFrameworkApplication.va.Pb(Fc.a.selectComment,2,Object.assign(new VN.a,{commentId:ge.id,kca:2,g4:!1}))}}else{this.ZGa=
null;var fb=Yc.K(b),Cb=Yc.K(r);if(!this.Ife(fb,h)||!this.Ife(Cb,A))throw Error("Provided select range offsets incorrect");y.AFrameworkApplication.va.Ob(Fc.a.KW,2);this.eip(fb);var Gb=this.sG.ue(fb,h);Ja=this.sG.Qy(Gb,wc.a.Tc(Cb,A+1));if(M){const Kd=Ja.toArray();h=[];for(const ke of Kd)h.push(this.h7d(ke.node));h.join(" ").includes(M)||(oa.success=!1,oa.message="The text in clicked passage does not match the selected hit")}var Sb=this.gm.value.Bw,pc=this.hb.gb.currentSelection;pc&&pc.equals(Ja)&&this.kd.iha(Sb,
null);this.kd.iha(Sb,Ja);oa.duration=Date.now()-aa;this.logMessage(oa)}}catch(zc){oa.success=!1,oa.message=zc.stack,oa.duration=Date.now()-aa,this.logMessage(oa)}}search(b,h){this.l_a();this.A$.search(Object.assign(new SI,{query:b}),h)}searchV2(b,h){this.l_a();this.A$.searchV2(Object.assign(new SI,{query:b}),h)}selectNextPrevHighlight(b){this.l_a();return this.A$.selectNextPrevHighlight(b)}searchWithParam(b,h){this.l_a();this.A$.search(b,h)}searchWithParamV2(b,h){this.l_a();this.A$.searchV2(b,h)}highlight(b){this.l_a();
this.A$.highlight(Object.assign(new SI,{query:b}))}highlightWithParam(b){this.l_a();this.A$.highlight(b)}getRevision(){return this.nBh.toString()}getSelectedText(){const b=this.Jxk.getSelectedText();return Object.assign(new xv.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:b.mentionLength})}getDocumentSelection(){var b=Object.assign(new Pw.a,{R_:!1,Ssa:!0,RKa:this.Hnc(),S_:!0}),h=({$s:aa}=this.FHm(b)).returnValue;if(h)return h;var r=this.hb.gb.currentSelection;if(!r||!r.length)return null;
h=r.Qa;r=r.Wc;let A=-1,M=-1;var aa=aa||this.jb.iKa(this.Uu.value,b);b=null;for(let oa=0;oa<aa.count;oa++){const Ja=aa.K(oa);-1===A&&h.node.id===Ja.id&&(A=oa,b=Ja);-1===M&&r.node.id===Ja.id&&(M=oa)}aa=null;5===(null===b||void 0===b?void 0:b.Rra)&&(aa=qu.IRf);if(1===(null===b||void 0===b?void 0:b.Rra)||2===(null===b||void 0===b?void 0:b.Rra))aa=qu.obg;return Object.assign(new ZK,{subdocumentId:aa,startParagraphIndex:A,startParagraphOffset:h.Hj,endParagraphIndex:M,endParagraphOffset:r.Oo})}clearDocumentSelection(){$K(this.hb)}selectRangeV2(b,
h,r,A,M,aa){const oa=Date.now(),Ja={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.l_a();if(0>h||0>r||0>A||0>M||h>A||h===A&&r>M)throw Error("Provided select range offsets incorrect");var fb=Object.assign(new Pw.a,{R_:!1,Ssa:!0,RKa:this.Hnc(),S_:!0});const pc=this.jb.iKa(this.Uu.value,fb);if(b==qu.opf)this.QIj(r,A,pc.count);else{fb=this.ZGa=null;var Cb={};Cb.subdocumentId=b;Cb.startParagraphIndex=h;Cb.startParagraphOffset=r;Cb.endParagraphIndex=
A;Cb.endParagraphOffset=M;fb=b==qu.LOi?this.syi(pc.K(h),{isFloatingImage:!1,imageId:"",...Cb}):this.pHi(pc.K(h),pc.K(A),{clickedPassage:aa,...Cb},Ja);var Gb=this.gm.value.Bw,Sb=this.hb.gb.currentSelection;(null===Sb||void 0===Sb?0:Sb.equals(fb))&&this.kd.iha(Gb,null);this.kd.iha(Gb,fb)}Ja.duration=Date.now()-oa;this.logMessage(Ja)}catch(pc){Ja.success=!1,Ja.message=pc.stack,Ja.duration=Date.now()-oa,this.logMessage(Ja)}}selectRangeV3(b){const h=Date.now(),r={activityName:"InDocSelectRangeData",success:!0,
message:"Select Range Succeeded",duration:0};try{this.l_a();if(0>b.startParagraphIndex||0>b.startParagraphOffset||0>b.endParagraphIndex||0>b.endParagraphOffset||b.startParagraphIndex>b.endParagraphIndex||b.startParagraphIndex===b.endParagraphIndex&&b.startParagraphOffset>b.endParagraphOffset)throw Error("Provided select range offsets incorrect");var A=Object.assign(new Pw.a,{R_:!1,Ssa:!0,RKa:this.Hnc(),S_:!0});const oa=this.jb.iKa(this.Uu.value,A);if(b.subdocumentId==qu.opf)this.QIj(b.startParagraphOffset,
b.endParagraphIndex,oa.count);else{A=this.ZGa=null;A=b.subdocumentId==qu.LOi?this.syi(oa.K(b.startParagraphIndex),b):this.pHi(oa.K(b.startParagraphIndex),oa.K(b.endParagraphIndex),b,r);var M=this.gm.value.Bw,aa=this.hb.gb.currentSelection;(null===aa||void 0===aa?0:aa.equals(A))&&this.kd.iha(M,null);this.kd.iha(M,A)}r.duration=Date.now()-h;this.logMessage(r)}catch(oa){r.success=!1,r.message=oa.stack,r.duration=Date.now()-h,this.logMessage(r)}}UBm(){const b=Date.now(),h={activityName:"GetParagraphNodes",
success:!0,message:"",duration:0},r=Object.assign(new Pw.a,{R_:!1,Ssa:!1,S_:!0});h.duration=Date.now()-b;this.logMessage(h);return this.jb.iKa(this.Uu.value,r)}nN(b){const h=Date.now(),r={activityName:"GetParagraphContent",success:!0,message:"",duration:0},A=new ib.a;for(const M of b)A.add(this.h7d(M));r.duration=Date.now()-h;this.logMessage(r);return A}syi(b,h){if(h.isFloatingImage)return h=N.a.Cf(h.imageId),b=b.Ic.Eb(h),b=sc.SelectionFactory.Gr(b);const r=this.sG.ue(b,h.startParagraphOffset);return b=
this.sG.Qy(r,wc.a.Tc(b,h.startParagraphOffset+1))}async getAuthorImageUrlFromClient(b,h){b=new Av.a(b,"O365",h,b);if(!this.Ipa||!this.Ipa.getPersonaIconPropertiesArray)return null;b=await this.Ipa.getPersonaIconPropertiesArray([b]);return 0<b.length&&b[0].authorImageURL?Object.assign(new WN,{authorImageURL:b[0].authorImageURL,authorColor:b[0].authorColor,authorID:b[0].authorID}):null}pHi(b,h,r,A){if(!this.Ife(b,r.startParagraphOffset)||!this.Ife(h,r.endParagraphOffset))throw Error("Provided select range offsets incorrect");
r.subdocumentId==qu.IRf?y.AFrameworkApplication.va.Pb(Fc.a.Ttb,2,new lB.a(b)):y.AFrameworkApplication.va.Ob(Fc.a.KW,2);r.subdocumentId==qu.obg?32===y.AFrameworkApplication.va.Pb(Fc.a.Zbb,2,new lB.a(b))&&y.AFrameworkApplication.va.Ob(Fc.a.i3d,2):y.AFrameworkApplication.va.Pb(Fc.a.I6,2,null);b=this.sG.ue(b,r.startParagraphOffset);h=this.sG.Qy(b,wc.a.Tc(h,r.endParagraphOffset+1));if(r.clickedPassage){b=h.toArray();const M=[];for(const aa of b)M.push(this.h7d(aa.node));M.join(" ").includes(r.clickedPassage)||
(A.success=!1,A.message="The text in clicked passage does not match the selected hit")}return h}QIj(b,h,r){const A=Za.a.instance.resolve(744).qR();h-=r;if(h<A.length){r=-1;if(this.A$.xea.lb(h)){const M=this.A$.xea.K(h).kOb;for(let aa=0;aa<M.length;aa++)if(M[aa].Ec===b){r=aa;break}}this.ZGa=-1!==r?Object.assign(new mM,{jpf:h,V_c:r}):null;b=A[h];y.AFrameworkApplication.va.Ob(Fc.a.KW,2);y.AFrameworkApplication.va.Pb(Fc.a.I6,2,null);y.AFrameworkApplication.va.Pb(Fc.a.selectComment,2,Object.assign(new VN.a,
{commentId:b.id,kca:2,g4:!1}))}}l_a(){this.Yb&&(this.Yb.currentScope&&this.Yb.currentScope.name===Hh.yD||this.Yb.Jg(Hh.yD))}nwp(){this.nBh=N.a.create()}h7d(b){if(b.qSb)return"";b=this.jb.text(b);return Gn.AParagraphNode.dV(b," ")}Ife(b,h){b=this.h7d(b);return h<b.length}LQb(b,h){switch(h){case 1:case 2:case 3:this.nwp()}}logMessage(b){const h=[Object.assign(new ia.a,{name:"Message",string:b.message})];Object(ac.a)(b.activityName,b.success,b.duration,h)}YAg(b){return!b.qSb&&this.p9c(b)}p9c(b){const h=
this.Uu.value;return!!h&&!!h.td&&!!b.Ic&&b.Ic.id.equals(h.td.id)}eip(b){this.jb.ync(b)?32===y.AFrameworkApplication.va.Pb(Fc.a.Zbb,2,new lB.a(b))&&y.AFrameworkApplication.va.Ob(Fc.a.i3d,2):y.AFrameworkApplication.va.Pb(Fc.a.I6,2,null)}Ise(b,h,r){this.PD&&(this.PD.jo(b),this.PD.wt(h),this.PD.Yx(r))}FHm(b){let h=null;if(!this.xi.lu||!this.ZGa)return{returnValue:null,$s:h};const r=Array.indexOf(this.xi.qR(),this.xi.lu);if(0>r)return{returnValue:null,$s:h};h=this.jb.iKa(this.Uu.value,b);var A=RI.a.v7d(this.xi.lu.text[0]).split("\n");
b=0;A=(1===A.length?A[0]:A.join(" ")).length-1;this.ZGa&&r===this.ZGa.jpf&&this.A$.xea.lb(r)&&this.A$.xea.K(r).kOb.length>this.ZGa.V_c&&(b=this.A$.xea.K(r).kOb[this.ZGa.V_c].Ec,A=this.A$.xea.K(r).kOb[this.ZGa.V_c].end);return{returnValue:Object.assign(new ZK,{startParagraphIndex:h.count+r,startParagraphOffset:b,endParagraphIndex:h.count+r,endParagraphOffset:A,subdocumentId:"Comment"}),$s:h}}xtm(b,h){const r=[];if(12!=b.type)return r;r.push(...this.Wtm(b,h));r.push(...this.zqm(b,h));return r}zqm(b,
h){const r=[],A=vd.a.Za(b);if(!A.QA())return r;let M=A.Zd();for(;M;){if(!this.YWa(M)){M=A.Au();continue}const aa=M.properties;aa&&Uc.ImageReader.M8c(aa)&&r.push(this.N0j(aa,h,0,b.Ic,!0,M.id.toString()));M=A.Au()}return r}YWa(b){if(19!==b.type||5!==Uc.ImageReader.Fk(b))return!1;b=vd.a.Za(b);if(!b.QA())return!0;let h=b.Zd();for(;h;){if(59===h.type)return!1;h=b.Au()}return!0}Wtm(b,h){const r=[],A=b.Ic;if(A){if(!b.hasProperty(He.a.Qn))return r;var M=b.ka(He.a.Qn,null);if(!M)return r;b=b.ka(He.a.vn,null);
for(let oa=0;oa<M.length;++oa){var aa=M[oa];if(!aa)continue;aa=A.Eb(aa);if(!aa||!Uc.ImageReader.M8c(aa)||5!==Uc.ImageReader.Fk(aa))continue;let Ja=0;0!=oa&&b&&oa-1<b.length&&(Ja=b[oa-1]);r.push(this.N0j(aa,h,Ja,A,!1,""))}return r}}N0j(b,h,r,A,M,aa){A=(new Sys.Net.WebRequest).getResolvedUrl()+Uc.ImageReader.sAm(b,A);const oa=b.ka(pd.a.Cu,""),Ja={};Ja.base64Encoding=oa;Ja.url=A;Ja.width=Uc.ImageReader.zF(b);Ja.height=Uc.ImageReader.tL(b);Ja.altText=Uc.ImageReader.t_(b);Ja.description=Uc.ImageReader.IVa(b);
Ja.imageId=aa;Ja.isFloatingImage=M;return{data:Ja,startParagraphIndex:h,endParagraphIndex:h,startOffsetInParagraph:r,endOffsetInParagraph:r+1}}Njm(b){return{data:{comment:nM(b),authorName:b.author,authorEmail:b.authorId,objectId:b.objectId,authorImageURL:""},startParagraphIndex:-1,endParagraphIndex:-1,startOffsetInParagraph:-1,endOffsetInParagraph:-1}}}Object(u.a)(pM,"WordDocumentContentExecutor",lM,[]);class TI{isEditingAllowed(){return!0}author(){return null}createdDate(){return null}}Object(u.a)(TI,
"BaseDocumentHelper",null,[365]);class qM extends TI{constructor(b){super();this.Jbm=b}get Agc(){const b=this.Jbm.instance;b&&b.loadDocumentProperty();return b}isEditingAllowed(){return qa.StaticActiveAppFrame.za().kb.isEditingAllowed}author(){var b;return null===(b=this.Agc)||void 0===b?void 0:b.author}createdDate(){var b;return null===(b=this.Agc)||void 0===b?void 0:b.creationDate}}Object(u.a)(qM,"WordDocumentHelper",TI,[]);class YN{constructor(b){this.w$i=b}insertOnlinePicture(){}insertHtmlText(b){b&&
this.CUf(b.htmlText)}getId(){return"InsertContentExecutor"}CUf(b){return this.executeCommand(ub.a.Iqa,b)}executeCommand(b,h){const r=new wg.DictionaryPropertySet;r.setValue(pd.a.QX,h);r.setValue(pd.a.KDa,!1);h=this.w$i.Ob(b,1);32===h&&(h=this.w$i.Pb(b,2,r));return h}}Object(u.a)(YN,"WordInsertContentExecutor",null,[439,295]);var XO=d(1702),ZN=d(1703);class $N{constructor(b,h,r,A,M){this.UEc="undefined";this.tAg="Something went wrong with retrieving a summary. Please try again.";this.aan=(aa,oa,Ja,
fb,Cb)=>pu.W_(aa,oa,Ja,fb,this.ND,Cb);this.Aye=(aa,oa,Ja,fb,Cb)=>{if(1===Ja)return this.Lyk?32:8;aa=FL.getSelectedText();aa=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuDictionarySmartLookupWithQuery,FL.K7d(aa));Cb[Xk.a.LabelText]=aa;return 32};this.dFf=(aa,oa,Ja)=>{if(1===Ja)return 32;const fb={};this.B4a?this.B4a.generateDocumentSummary().then(Cb=>{Cb||(Cb=this.tAg,v.ULS.sendTraceTag(509723399,1303,15,"Share with summary: Generated document summary is empty."));fb.additionalData=
this.Erf(Cb);this.ga.Pb(Ka.a.Aaa,2,fb)}).catch(()=>{v.ULS.sendTraceTag(509723398,1303,15,"Share with summary: Error in generating document summary.");fb.additionalData=this.Erf(this.tAg);this.ga.Pb(Ka.a.Aaa,2,fb)}):(v.ULS.sendTraceTag(509723397,1303,15,"Share with summary: Search provider manager is unavailable."),fb.additionalData=this.Erf(this.tAg),this.ga.Pb(Ka.a.Aaa,2,fb));return 32};this.Wjp=(aa,oa,Ja)=>{if(!this.jaj)return v.ULS.sendTraceTag(508929473,1303,15,"Cannot get a token for Transform to Slides action."),
8;if(1===Ja)return this.jqn()?32:2;if(2===Ja)this.jaj.K8d(this.Ga.ib("SmartLookupShredderServiceEndpoint")).then(fb=>{fb={token:fb,files:H.c(this.wpm()),type:"MultiFilesDeckGeneration"};fb=Object.assign(new XO.a,{selection:Object.assign(new xv.a,{neighborhood:"",mentionStart:0,mentionLength:0}),launchData:Object.assign(new Ks.a,{landingTab:"All",data:fb}),entryPoint:38});this.ga.Pb(Ka.a.Yaa,2,fb);return 32}).catch(()=>{v.ULS.sendTraceTag(508929472,1303,15,"Error in getting a token for Transform to Slides action.");
return 8});else return 32};this.ND=b;this.ga=h||y.AFrameworkApplication.va;this.Ga=r;this.syk=(this.Rx=!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.m3)&&!!this.Ga&&this.Ga.$("AutoOpenSearchPaneInDoublePortraitIsEnabled");this.Lyk=!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",!1);A&&A.execute(aa=>{this.B4a=aa});this.jaj=M}Xb(){this.ga.fb(Fc.a.gUh,we.a.frame,this.aan,1028);this.ga.fb(Fc.a.Aye,we.a.frame,this.Aye,1028);this.ga.fb(Fc.a.yqi,
we.a.frame,this.dFf,1028);this.ga.fb(Fc.a.O0j,we.a.frame,this.Wjp,1028);this.syk&&(this.UEc=qa.StaticActiveAppFrame.za().NK.getWindowMode(),this.Pii(this.UEc),qa.StaticActiveAppFrame.za().NK.registerBoundingWindowRectsChanged("SearchPane",(b,h)=>{h!==this.UEc&&(this.UEc=h,this.Pii(this.UEc))}))}jqn(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableTransformToSlidesInRibbon",!1)&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableContentTransformInL2",
!1)}Pii(b){"DP"===b&&em.UISurfaces.Iv().then(h=>{h.selectors.getTabbedTaskPaneCount()||this.ga.Pb(Fc.a.gUh,2,{SourceControlId:"smartlookupAuto"});return null})}Erf(b){return{["documentSummary"]:b}}wpm(){const b=new ZN.a("docx",y.AFrameworkApplication.J.ib("EditDocInClientUrl"),y.AFrameworkApplication.J.ib("BreadcrumbBrandUrl"),"",y.AFrameworkApplication.sessionStartInfoSettings.FileSizeBytes,(new Date).toLocaleString()),h=[];Array.add(h,b);return h}}Object(u.a)($N,"WordInsightsActor",null,[]);class RF{constructor(){this.cyd=
this.$S=null}e9a(){return this.xPb()}Syi(){return this.xPb()}Qyi(){return null}v4o(b,h,r){this.$S||(this.$S=this.HXd());this.$S.kS(b,h,r)}w4o(b,h,r){this.$S||(this.$S=this.HXd());this.$S.CCg(b,h,r)}N2o(b,h){this.cyd||(this.cyd=null);this.cyd&&this.cyd.CCg(b,h)}ZZb(b,h){this.$S||(this.$S=this.HXd());this.$S.ZZb(b,h)}uge(b){this.$S||(this.$S=this.HXd());this.$S.uge(b)}RLo(){this.$S&&this.$S.Rvc()}IQo(){this.$S&&this.$S.vwe()}$1o(){var b=y.AFrameworkApplication.J.ic("SmartLookupLaunchThrottleThresholdInMilliseconds",
1500);b=window.performance.now()-RF.m4i<=b;b||(RF.m4i=window.performance.now());return b}dispose(){this.$S&&(this.$S.dispose(),this.$S=null)}get WSb(){return this.$S?this.$S.isVisible:!1}}RF.m4i=0;Object(u.a)(RF,"InsightsManager",null,[1887,10]);class UI{constructor(b,h,r,A,M,aa=!0,oa=null,Ja=null){this.n9=this.rG=this.nRa=null;this.nJc=!1;this.zia=null;this.Yb=h;this.T7b=aa;this.Xdh=Ja?Ja:new TI;this.pu=oa;this.Zp=b;this.T7b&&(Za.a.instance.Oa(1166)&&(this.zia=Za.a.instance.resolve(1166).nJf()),
this.Ckb=Za.a.instance.resolve(1171),this.dJb=this.Ckb.P3c())}svb(b){if(this.T7b){b=b.rawEvent;try{var h=H.a(b.data)}catch(r){v.ULS.sendTraceTag(595161728,1303,15,this.VW("Message data from Serplet [{0}] failed to deserialize.",b.data));return}switch(h.actionType){case 101:b=0;this.rG&&(b=this.rG.entryPoint);this.Ckb.RMf(this.n9,this.Xdh,this.Ikc(),b).then(r=>{h.data=r;this.nwb(h)});break;case 118:h.data=this.rG?this.rG:Object.assign(new xj.a,{selection:Object.assign(new xv.a,{neighborhood:this.nRa.neighborhood,
mentionStart:this.nRa.mentionStart,mentionLength:this.nRa.mentionLength})});this.nwb(h);break;case 103:b=H.a(Object(ya.a)(String,h.data));Il.sendTelemetryEvent(b);break;case 206:this.Ckb.K8d(h.data).then(r=>{h.data=r;this.nwb(h)});break;case 112:h.data.shiftPressed?(Y.a.uj&&document.activeElement.blur(),this.Zp.A9d(0,null,2,null,null),v.ULS.sendTraceTag(592545156,1303,50,this.VW("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.Zp.M4c(0,null,2,null,null),v.ULS.sendTraceTag(592545155,1303,
50,this.VW("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.Lsa()}}}Tld(b){if(this.zia){var h=0;this.rG&&(h=this.rG.entryPoint);this.Ckb.RMf(this.n9,this.Xdh,this.Ikc(),h).then(r=>{Il.QJj("SearchFromHost",this.n9);this.rG.launchData||(this.rG.launchData=new Ks.a);const A=hC();try{this.zia.search(this.rG,r,y.AFrameworkApplication.userSessionId,A,b),this.Ckb.e8n(M=>{Il.QJj("SearchFromHostWithToken",this.n9);this.zia.searchAuthenticatedProviders(this.rG,r,y.AFrameworkApplication.userSessionId,
A,null,M)})}catch(M){Il.fB("BaseSmartLookupPane - Fail to search from host. Error: "+M,10)}}).catch(r=>{Il.fB("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+r.toString(),10)})}}Svc(b){if(this.T7b){var h=Il,r=h.Svc,A=this.n9;b=Math.round(window.performance.now()-b);var M=this.rG?OF[this.rG.entryPoint]:"",aa=this.Ckb.P3c(),oa=this.Ckb.npm(),Ja=this.rG?this.rG.entryPoint:0;r.call(h,A,b,M,aa,oa,y.AFrameworkApplication.Cgf,this.nJc,18===Ja||19===Ja||15===Ja)}}}Object(u.a)(UI,
"BaseSmartLookupPane",null,[354,10]);class aL{constructor(b){this.messageType=null;this.messageType=b}}Object(u.a)(aL,"InsightsMessage",null,[]);class vz extends aL{constructor(b,h){super(b);this.messageContent=null;this.messageContent=h}}Object(u.a)(vz,"InsightsMessageWithContent",aL,[]);class rM extends vz{constructor(b){super(Hh.oJn,b)}}Object(u.a)(rM,"InsightsMessageAppProperties",vz,[]);class VI extends vz{constructor(b){super(Hh.zJn,b)}}Object(u.a)(VI,"InsightsMessageSelection",vz,[]);class YO extends aL{constructor(){super(Hh.BJn)}}
Object(u.a)(YO,"InsightsMessageTakeFocus",aL,[]);class SF extends UI{constructor(b,h,r,A,M=null,aa=null,oa=null,Ja=!0,fb=null,Cb=null){super(h,r,M,aa,oa,Ja,fb,Cb);this.dxd=this.tC=this.Oj=null;this.gId=!1;this.sWn=Gb=>{Gb===this.Oj&&this.Lsa()};this.Nrc=()=>{v.ULS.sendTraceTag(6295951,1303,50,this.VW("The iframe is successfully loaded in Insights task pane"))};this.rvb=()=>{v.ULS.sendTraceTag(6295952,1303,15,this.VW("The iframe failed to load in Insights task pane"))};this.YCd=b;this.WHc=this.T7b?
PF(this.dJb):y.AFrameworkApplication.c9m;this.i2();this.dqg();this.Mp=A;this.Mch=0}get isVisible(){return!1}i2(){this.Oj=this.YCd.lXc();y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib.jtb&&this.Oj.dso(b=>{b===this.Oj&&(this.vwe(),this.Rvc())});this.fUf(this.Oj.I_a.VUh);this.Oj.rn()}fUf(b){b.style.overflow="hidden";const h=Og.a.createElement("iframe");Sys.UI.DomElement.addCssClass(h,"InsightsPaneIFrame");h.setAttribute("Unselectable","off");this.tC=h;b.appendChild(this.tC);this.tC.id=Hh.GSf}dqg(){mf.a.addHandler(this.tC,
"load",this.Nrc);mf.a.addHandler(this.tC,"error",this.rvb);$addHandler(window,"message",Object(E.a)(this,this.svb,"onIFrameMessage"))}fKg(){mf.a.removeHandler(this.tC,"load",this.Nrc);mf.a.removeHandler(this.tC,"error",this.rvb);$removeHandler(window,"message",Object(E.a)(this,this.svb,"onIFrameMessage"))}dispose(){this.tC&&(this.fKg(),this.tC.parentNode.removeChild(this.tC),this.tC=null);this.Oj&&(this.YCd.tgc(this.Oj),this.Oj=null)}kS(b,h,r){this.n9=h;this.dxd=null;this.Mch=r;this.nJc=!b.mentionLength;
this.gId=!1;v.ULS.sendTraceTag(6295947,1303,50,this.VW("Start to show Insights"));this.nRa=b;this.WHc&&this.WHc.length?this.tC.src=this.WHc:(this.tC.src=SF.vgj,v.ULS.sendTraceTag(6295948,1303,15,this.VW("The Insights URL config setting is null or empty")));this.Mp.sendNotification(CommonUIStrings.l_InsightsPaneNotification,!0);this.Oj.d0||this.Oj.kqg(this.sWn);this.T7b&&this.Tld(!1);b=window.performance.now();this.YCd.showTaskPane(this.Oj);this.Oj.rn();this.Svc(b)}CCg(b,h,r){this.rG=b;this.kS(Object.assign(new JI.a,
{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,r)}ZZb(){}uge(){}Rvc(){this.tC.src===this.WHc&&this.gId&&(this.Yb.Jg(Hh.yD),this.nwb(new YO))}vwe(){this.tC&&Cd.FocusManager.ON(this.tC.contentWindow)}Puf(){this.tC.src=SF.vgj;this.Oj.sn()}Lsa(){this.YCd.hideTaskPane(this.Oj);this.Puf()}svb(b){const h=b.rawEvent;if(h.source===this.tC.contentWindow)if(this.T7b)super.svb(b);else{let r;try{r=H.a(h.data)}catch(A){v.ULS.sendTraceTag(6295953,
1303,15,this.VW("Message data [{0}] failed to deserialize.",h.data));return}if(yf.c(r.messageType))v.ULS.sendTraceTag(6295954,1303,15,this.VW("Message data [{0}] is in wrong format.",h.data));else switch(r.messageType){case Hh.pJn:this.nwb(new rM(this.fum()));break;case Hh.AJn:this.nwb(new VI(this.nRa));break;case Hh.vJn:this.gId=!0;this.vwe();this.Rvc();v.ULS.sendTraceTag(6295955,1303,50,this.VW("Insights pane rendering is completed"));break;case Hh.CJn:b=r.messageContent;this.dxd=b.clientCorrelationId;
this.n9!==b.appCorrelationId&&v.ULS.sendTraceTag(6403778,1303,15,this.VW("App correlation ID on client {0} does not match one on server {1}",this.n9,b.appCorrelationId));break;case Hh.uJn:r.messageContent?(Y.a.uj&&document.activeElement.blur(),this.Zp.A9d(0,null,2,null,null),v.ULS.sendTraceTag(6604741,1303,50,this.VW("Insights UX lost focus through Ctrl + Shift + F6"))):(this.Zp.M4c(0,null,2,null,null),v.ULS.sendTraceTag(6604742,1303,50,this.VW("Insights UX lost focus through Ctrl + F6")));break;
case Hh.rJn:r.messageContent.keyCode===cf.a.Bfb&&this.Lsa();break;case Hh.sJn:try{this.gId=!1,localStorage.setItem(Hh.i5i,"true")}catch(A){v.ULS.sendTraceTag(17961859,1303,10,this.VW("Failed to SetItem in LocalStorage for LegalAgreed"))}}}}fum(){const b={anid:"00000000-0000-0000-0000-000000000000"};b.appCorrelationId=this.n9;3===y.AFrameworkApplication.ua.Ib.Uk?b.applicationName=Hh.QGp:4===y.AFrameworkApplication.ua.Ib.Uk&&(b.applicationName=Hh.L1n);b.applicationVersion=y.AFrameworkApplication.buildVersion;
var h=tj.a.Hg(y.AFrameworkApplication.lcid);h=h?h.name:null;b.market=RD(h);b.uiLanguage=h;b.sessionId=y.AFrameworkApplication.userSessionId;b.parentalControl=Hh.zig;b.clientType="user";b.legalAgreed=this.rvm();b.defaultDefineTab=1===this.Mch?"true":null;return b}VW(b,...h){const r={};this.n9&&(r[Hh.gZj]=this.n9);this.dxd&&(r[Hh.jfp]=this.dxd);r[Hh.hZj]=String.format.apply(null,[b].concat(h));return H.c(r)}Ikc(){return 5}rvm(){try{const b=localStorage.getItem(Hh.i5i);return!!b&&"true"===b}catch(b){return v.ULS.sendTraceTag(17961860,
1303,10,this.VW("Failed to GetItem in LocalStorage for LegalAgreed")),!1}}nwb(b){b=H.c(b);this.tC.contentWindow.postMessage(b,$a.a.getOrigin(this.WHc))}}SF.vgj="about:blank";Object(u.a)(SF,"InsightsPane",UI,[]);class c{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(u.a)(c,"SmartLookupTaskPaneProps",null,[]);class k{}Object(u.a)(k,"ActionDescriptor",null,[]);class t extends UI{constructor(b,h,r,A=null,M=null,aa=null,oa=!0,Ja=null,fb=null){super(h,r,A,M,aa,oa,Ja,fb);this.W9e=!!y.AFrameworkApplication.ua&&
!!y.AFrameworkApplication.ua.Ib&&y.AFrameworkApplication.ua.Ib.o0f;this.Ut=this.V4e=!1;this.yCk=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.wCk=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",844);this.BCk=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",1366);this.ACk=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",
700);this.fnj=()=>{if(this.zia)this.zia.onPaneThemeChanged(this.Ikc());return hh.a("getTheme")?appChrome.api.getTheme():null};this.rvb=()=>{Il.fB("ReactSmartLookupPane - Iframe component failed to load.",10)};this.Nrc=()=>{y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",!1)||window.navigator.onLine||Il.fB("ReactSmartLookupPane - Onload detected no network.",50)};oa||Il.fB("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",
10);this.IGa=b;this.Ekh=PF(this.dJb)}get isVisible(){return this.Ut}ZZb(b,h){this.rG=b;this.nRa=b=Object.assign(new JI.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength});this.nJc=!b.mentionLength;this.n9=h;this.Tld(!1)}uge(b){this.rG=b;this.pxc(Object.assign(new JI.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),!1)}kS(b,h){this.n9=h;this.pxc(b,!0)}CCg(b,h,
r){this.rG=b;this.kS(Object.assign(new JI.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,r)}Lsa(){this.bha();this.IGa.hideTaskPane()}pxc(b,h){ec.SessionStatusManager.instance.WA&&this.zia?(this.nRa=b,this.nJc=!b.mentionLength,b=window.performance.now(),this.initialize(),this.isVisible?y.AFrameworkApplication.J.$("SmartLookupDisableRefreshPaneIsEnabled")?(this.IGa.updateTaskPane(null),h&&this.yMo()):(h&&this.Tld(!1),this.V4e=
!this.V4e,this.IGa.updateTaskPane(this.EB())):(h&&this.Tld(this.isVisible),this.IGa.showTaskPane(this.EB())),this.Svc(b)):(this.IGa.showTaskPane(this.EB()),Il.TLo(ec.SessionStatusManager.instance.WA,!!this.zia,this.rG?OF[this.rG.entryPoint]:"",this.Ckb.P3c(),y.AFrameworkApplication.Cgf,this.nJc))}yMo(){if(!this.rG){const b=Object.assign(new xv.a,{neighborhood:this.nRa.neighborhood,mentionStart:this.nRa.mentionStart,mentionLength:this.nRa.mentionLength});this.rG=Object.assign(new xj.a,{selection:b,
userIntent:null,entryPoint:0,launchData:null})}this.Tld(this.isVisible)}eMo(){const b=new k;b.transactionId=this.n9;b.actionType=15;b.channelId=Hh.channelId;this.nwb(b)}svb(b){const h=b.rawEvent;document.getElementById(Hh.yD)&&h.source!==document.getElementById(Hh.yD).contentWindow||this.Jko(b)}Jko(b){const h=b.rawEvent;let r;try{r=H.b(h.data)}catch(A){v.ULS.sendTraceTag(545604257,1303,15,this.VW("Message data from Serplet [{0}] failed to deserialize.",h.data));return}switch(r.actionType){case 32:y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",
!1)&&(Fd.a.$qb()>=this.yCk?this.IGa.updateTaskPane(this.ptf(this.wCk)):Fd.a.$qb()>=this.BCk&&this.IGa.updateTaskPane(this.ptf(this.ACk)));break;case 33:y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&this.IGa.updateTaskPane(this.ptf(r.data));break;case 42:this.IGa.updateTaskPane(this.vIl(r.data));break;case 43:this.IGa.updateTaskPane(this.EB());break;default:super.svb(b)}}dispose(){}initialize(){this.i2();this.tna()}i2(){this.IGa.lXc()}tna(){const b=
this.Yb.ie(Hh.yD);b.parent=id.AFrame.Eq;b.HL=!0}PQo(){this.Yb.Jg(Hh.yD)}bha(){this.zab()&&this.Yb.Jg(this.Yb.IW)}dqg(){$addHandler(window,"message",Object(E.a)(this,this.svb,"onIFrameMessage"))}fKg(){$removeHandler(window,"message",Object(E.a)(this,this.svb,"onIFrameMessage"))}zab(){return!!this.Yb.currentScope&&this.Yb.currentScope.name===Hh.yD}nwb(b){b=H.c(b);document.getElementById(Hh.yD)&&document.getElementById(Hh.yD).contentWindow.postMessage(b,$a.a.getOrigin(this.Ekh))}VW(b,...h){const r={};
this.n9&&(r[Hh.gZj]=this.n9);r[Hh.hZj]=String.format.apply(null,[b].concat(h));return H.c(r)}Ikc(){return hh.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}Rvc(){}vwe(){document.getElementById(Hh.yD)&&Cd.FocusManager.ON(document.getElementById(Hh.yD).contentWindow)}Wnm(){return this.rG?10===this.rG.entryPoint?2===y.AFrameworkApplication.ua.Ib.Uk?CommonUIStrings.l_ReuseSlidesPaneTitle:CommonUIStrings.l_ReuseFilesPaneTitle:18===this.rG.entryPoint?CommonUIStrings.l_FindInDocumentPaneTitle:
37===this.rG.entryPoint?CommonUIStrings.l_SummarizePaneTitle:36===this.rG.entryPoint||38===this.rG.entryPoint?CommonUIStrings.l_ConvertToDeckPaneTitle:CommonUIStrings.L_SmartLookupPaneTitle:""}EB(){var b=CommonUIStrings.L_SmartLookupPaneTitle;y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletDynamicPaneTitle",!1)&&(b=this.Wnm());const h=new c;h.src=this.Ekh;h.id=Hh.yD;h.refreshPane=this.V4e;h.onError=this.rvb;h.onLoad=this.Nrc;h.title=b;ec.SessionStatusManager.instance.WA?
this.zia||(h.errorMessage=CommonUIStrings.l_SmartLookupPaneInitializationError,h.errorType=1):(h.errorMessage=CommonUIStrings.l_SmartLookupPaneNetworkDisconnected,h.errorType=0);b=Object.assign(new Pn.a,{title:b,hideHeader:!1,width:Hh.width,location:Hh.q5n,contentProps:h,isModernPane:!0,onOpen:()=>{this.PQo();this.Ut=!0;this.dqg();hh.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(this.fnj);y.AFrameworkApplication.ua.Fe();if(this.zia)this.zia.onPaneStateChanged(!0)},
onClose:()=>{this.eMo();this.bha();this.Ut=!1;this.fKg();hh.a("removeOnThemeChangeCallback")&&appChrome.api.removeOnThemeChangeCallback(this.fnj);y.AFrameworkApplication.ua.Fe();if(this.zia)this.zia.onPaneStateChanged(!1)}});this.W9e&&(b.enableResize=!0,b.minResizeWidth=320,b.maxResizeWidth=920);return b}vIl(b){const h=this.EB();h.title=b;h.contentProps.title=b;return h}ptf(b){const h=this.EB();h.resizeWidth=b;return h}}Object(u.a)(t,"ReactSmartLookupPane",UI,[]);class B{lXc(){const b=new Dn.a(Bk.a.b6a,
WordEditorIntl.WordEditorStrings);return ho.a.instance.I$h(Hh.yD,Hh.Msc,Hh.width,Hh.BGg,b)}showTaskPane(b){ho.a.instance.showTaskPane(b)}hideTaskPane(b){ho.a.instance.hideTaskPane(b)}tgc(b){ho.a.instance.tgc(Hh.yD,b)}}Object(u.a)(B,"WordInsightsPaneHandler",null,[293]);class O{lXc(){ho.a.instance.nUa()}showTaskPane(b){em.UISurfaces.Iv().then(h=>{h.showTaskPane(Hh.yD,b);return null})}updateTaskPane(b=null){em.UISurfaces.Iv().then(h=>{h.setSelectedTaskPane(Hh.yD);b&&h.updateTaskPane(Hh.yD,b);return null})}hideTaskPane(){em.UISurfaces.Iv().then(b=>
{b.hideTaskPane(Hh.yD,2);return null})}}Object(u.a)(O,"WordReactSmartLookupPaneHandler",null,[292]);class da extends RF{constructor(b,h){super();this.Iy=b;this.hb=h}HXd(){const b=!!y.AFrameworkApplication.ua&&!!y.AFrameworkApplication.ua.Ib&&y.AFrameworkApplication.J.$("SmartLookupEnableNativePane");return y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Ib&&y.AFrameworkApplication.ua.Ib.d_f?new t(new O,Cp.a.instance,Cd.FocusManager.instance(),Za.a.instance.resolve(1172),Za.a.instance.resolve(1173),
Za.a.instance.resolve(1174),b,Za.a.instance.Ra(4),Za.a.instance.resolve(1175)):new SF(new B,Cp.a.instance,Cd.FocusManager.instance(),Za.a.instance.resolve(26),Za.a.instance.resolve(1172),Za.a.instance.resolve(1173),Za.a.instance.resolve(1174),b,Za.a.instance.Ra(4),Za.a.instance.resolve(1175))}xPb(){return this.Iy.getSelectedText()}Qyi(){if(!this.hb||!this.hb.gb||1>this.hb.gb.length)return null;var b=this.hb.gb.currentSelection.Qa;b=null==b?null:Wa.FormattingReader.Rs(b);return(b=null==b?null:tj.a.Hg(Wa.FormattingReader.language(b)))?
b.name:""}e9a(){return this.Iy.DMf()}Syi(){return this.Iy.DMf()}QXi(){return this.Iy.Ndn()}}Object(u.a)(da,"WordInsightsManager",RF,[]);var sa=d(216);class Pa{}Object(u.a)(Pa,"CommandMetadataResponse",null,[]);class lb{constructor(){this.ISf=this.getAllIcons()}executeCommand(){}executeCommandAsync(){return Promise.resolve(null)}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){sa.PrivacyDialogManager.yye()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(b){const h=
new Pa;b.iconNames&&(h.svgData=this.getCommandIconSvg(b.iconNames));if(!b.commandId||""===b.commandId)return h.isVisible=!1,h;try{h.isVisible=Array.contains(appChrome.selectors.getVisibleControlIds(),b.commandId);h.isDisabled=appChrome.selectors.isControlDisabled(b.commandId);h.label=appChrome.selectors.getControlLabel(b.commandId);if(h.svgData&&""!==h.svgData)return h;const r=appChrome.selectors.getControlIconSet(b.commandId),A=Array(2);A[0]=r["default"];A[1]=r.icon32;h.svgData=this.getCommandIconSvg(A)}catch(r){return null}return h}getCommandIconSvg(b){if(!this.ISf)return"";
for(let h=0;h<b.length;h++){const r=b[h];if(r in this.ISf)return this.ISf[r]}return""}startSpeech(){return Promise.resolve(!1)}stopSpeech(){return Promise.resolve(!1)}getAllIcons(){return{}}createFeedbackPropertiesFromData(b){const h={SourceControlId:"GiveFeedback"};h.feedbackType="true"===b.IsPosFeedback?0:1;const r={};r.featureArea=lb.L3l;h.telemetryGroup=r;h.appData=b;return h}}lb.$Mi="FA000000012";lb.queryPrefix="AssetID=";lb.L3l="SearchPane";Object(u.a)(lb,"BaseSerpletExecutor",null,[294,295]);
class Kb extends lb{constructor(b,h){super();this.ga=b;this.hb=h}executeCommand(b){if(!b)throw Error("Missing commandData argument");switch(b.CommandId){case 0:this.ga.Pb(ub.a.ZTb,2,null);break;case 1:this.ga.Pb(Fc.a.q0b,2,null);break;case 2:this.ga.Pb(ub.a.wYc,2,{SourceControlId:"Serplet"});break;default:throw Error(`Unknown commandId requested: ${b.CommandId}`);}}browseFiles(){this.ga.Pb(Ka.a.Pbe,2,null)}openHelpTaskPane(){}openFeedbackPane(b){this.ga.Pb(Ka.a.RZb,2,this.createFeedbackPropertiesFromData(b))}openFindReplaceTaskPane(b){const h=
{};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Pb(Ka.a.DCf,2,h)}openFindReplaceTaskPaneV2(b){b={CommandValueId:b.Query,MatchCase:b.MatchCase,MatchWholeWord:b.MatchWholeWordOnly};$K(this.hb);this.ga.Pb(Ka.a.DCf,2,b)}openFindTaskPane(b){const h={};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Pb(Ka.a.Uhc,2,h)}openNavigationPane(){this.ga.Pb(Fc.a.lxc,2,null)}openSerpletTaskPane(){this.ga.Pb(Ka.a.jTi,2,null)}sendAutoLaunchSearchRequest(){this.ga.Pb(Ka.a.Jbe,2,null)}getAllIcons(){const b=
{};for(const r of Object.keys(window))if(r.startsWith("word")){var h=window[r];h&&(h=h.icons,null!==h&&void 0!==h&&h.length&&h.forEach(A=>b[A.id]=JSON.stringify(A)))}return b}}Object(u.a)(Kb,"WordSerpletExecutor",lb,[]);class bc extends iM{constructor(){super();this.g2e=null;this.fz=()=>{y.AFrameworkApplication.Y2&&(this.RVl(),xs.a.hm().then(()=>this.g2e.resolve(1179)))}}get name(){return"WordEditor.Insights"}init(){y.AFrameworkApplication.Y2&&(this.g2e.Oa("WordEditor.Insights.WordInsightsActor").Xb(),
y.AFrameworkApplication.J.$("SmartLookupEnableNativePane")&&y.AFrameworkApplication.J.$("DownloadSmartLookupRuntimeDuringPkgInitIsEnabled")?y.AFrameworkApplication.J.Uo(this.fz):super.init())}uc(b){super.uc(b);this.g2e=b;b.ia("Box4.Insights.Box4InsightsSelection",()=>new Xr.a).as(1178).as(1059).ha();b.ia("WordEditor.Insights.WordInsertContentExecutor",()=>new YN(y.AFrameworkApplication.va)).as(1174).ha();b.ia("WordEditor.Insights.WordSerpletExecutor",()=>new Kb(y.AFrameworkApplication.va,gg.a.instance)).as(1173).ha();
b.ia("WordEditor.Insights.AugloopSearchProviderManager",()=>new QI(b.resolve(1176))).as(1179).ha();b.ia("WordEditor.Insights.WordDocumentContentExecutor",()=>{const h=new qu(new Qf.a(()=>qa.StaticActiveAppFrame.za()?qa.StaticActiveAppFrame.za().kb.$c:null),b.resolve(164),RN.a.instance,y.AFrameworkApplication.J,wo.a.instance,PO.a.instance,b.resolve(1177),b.resolve(744),y.AFrameworkApplication.va,gg.a.instance,b.resolve(868));h.initialize();return new pM(new Qf.a(()=>qa.StaticActiveAppFrame.za()?qa.StaticActiveAppFrame.za().kb.$c:
null),b.resolve(164),Object(Lb.a)(),gg.a.instance,b.resolve(868),h,df.a.gf.Ll.jf(12),new Qf.a(()=>qa.StaticActiveAppFrame.za().kb),Cd.FocusManager.instance(),b.resolve(744),b.resolve(1178),b.Ra(1179),b.Ra(143))}).as(1172).ha();b.ia("WordEditor.Insights.WordInsightsManager",()=>new da(b.resolve(1178),b.resolve(326))).as(1168).ha();b.ia("WordEditor.Insights.WordInsightsActor",()=>new $N(b.rf(1168),y.AFrameworkApplication.va,y.AFrameworkApplication.J,b.Ra(1179),b.resolve(1171))).ha();b.ia(1175,()=>new qM(b.Ra(1180))).ha()}}
Object(u.a)(bc,"WordInsightsPackage",iM,[]);class Bc{}Object(u.a)(Bc,"ScalingStep",null,[]);class cd{constructor(b,h,r){this.zIc=!1;this.FS=null;this.KPc=this.E7b=!1;this.K4a=[];this.Xte=A=>{this.gda&&this.gda!==A&&appChrome.api.dispatch(this.SEi(!1))};h.execute(A=>{this.FS=A});b.tA(Object(E.a)(this,this.B_n,"onProcessSetSelectionFinished"));this.xr=r}rkc(b,h,r){const A=[];for(const M of b)A.push(appChrome.actions.addScalingStepInTab("Home",{type:h,controlId:M},r));return A}oDi(b){const h=[];for(let r=
0;4>r;r++)h.push(appChrome.actions.addScalingStepInTab("Home",{type:"DropPreviewItemFromGallery",controlId:b},2>r?0:void 0));h.push(appChrome.actions.addScalingStepInTab("Home",{type:"GalleryToFlyout",controlId:b},void 0));return h}SEi(b){const h=[];if(b)switch(this.gda){case "Image":h.push(appChrome.actions.removeControlScalingStepsFromTab("TextAlignmentAnchor","Home"));h.push(...this.oDi("PictureStyles"));h.push(...this.rkc("RotatePictureMenu PictureBorders PictureStyles CropPictureMenu WrapTextMenu EditPictureAltText".split(" "),
"DropLabel"));b=this.K4a.slice().reverse();b.push("TextAlignmentAnchor");h.push(...this.rkc(b,"MoveToOverflow"));break;case "Table":this.KPc||h.push(...this.oDi("TableStyles"));h.push(...this.rkc(this.K4a,"DropLabel",this.KPc?0:void 0));b=this.K4a.slice().reverse();h.push(...this.rkc(b,"MoveToOverflow"));break;case "Hyperlink":h.push(...this.rkc(["EditHyperlink","RemoveHyperlink"],"DropLabel")),b=this.K4a.slice().reverse(),h.push(...this.rkc(b,"MoveToOverflow"))}else for(const r of this.K4a)h.push(appChrome.actions.removeControlScalingStepsFromTab(r,
"Home"));return h}jsd(b){const h={};for(const r of b)try{h[r]=appChrome.selectors.getModelType(r)}catch(A){this.BI("Error","GetModelType failed for "+r)}qa.StaticActiveAppFrame.za().w3d(h)}Lqp(b){if(0!==b.length){var h=[],r={},A=!1;for(const M of b)try{if(appChrome.selectors.isControlDefined(M))r[M]=appChrome.selectors.getModelType(M);else{A=!0;break}}catch(aa){this.BI("Error","GetModelType failed for "+M);A=!0;break}if(A)this.gda=void 0,this.LDe(!1);else{if("Image"===this.gda&&!this.E7b)h.push(appChrome.actions.updateGroupHiddenState("Font",
!0)),this.E7b=!0;else if(this.E7b){h.push(appChrome.actions.updateGroupHiddenState("Font",!1));A=appChrome.selectors.getVisibleControlsInGroup("Font");for(const M of A)r[M]=appChrome.selectors.getModelType(M);this.E7b=!1}qa.StaticActiveAppFrame.za().w3d(r);this.K4a=b;r=[];for(const M of b)appChrome.selectors.isControlDisabled(M)&&r.push(M);0<r.length&&this.BI("Disabled",r.join(","));0<this.K4a.length&&(h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),h.push(appChrome.actions.updateControlsInGroup("Adaptive",
this.K4a)),h.push(...this.SEi(!0)),this.zIc=!0);appChrome.api.dispatch(h)}}}LDe(b){if(b||this.zIc){var h=[];h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!b));this.zIc=b;if("Image"===this.gda||this.E7b){b=!b;h.push(appChrome.actions.updateGroupHiddenState("Font",!b));if(b){const r=appChrome.selectors.getVisibleControlsInGroup("Font");this.jsd(r)}this.E7b=!b}appChrome.api.dispatch(h)}}Hzc(){this.zIc&&this.xr&&this.xr.execute(b=>{b.logActivity("AdaptiveContextualGroupShown",null)})}B_n(b,
h){!y.AFrameworkApplication.ua.Ib.Xwc&&"Home"===appChrome.selectors.getSelectedTabId()&&this.FS&&h.Rm&&h.Rm.currentSelection&&0!==h.Rm.length?(b=()=>{let r=[],A=!1;var M=this.FS.contentType,aa=appChrome.selectors.getActiveContextualTabIds();M.includes("Image")?(this.Xte("Image"),this.gda&&"Image"===this.gda?A=!0:(r="PictureStyles PictureBorders WrapTextMenu RotatePictureMenu CropPictureMenu PictureAbsoluteHeight PictureAbsoluteWidth LockAspectRatio EditPictureAltText FormatPictureOptions".split(" "),
this.gda="Image")):M.includes("Table")&&0<=aa.indexOf("Table")?(M=!(mt.a.instance.currentSelection.GLa||mt.a.instance.currentSelection.Rw||mt.a.instance.currentSelection.yab),(aa="Table"===this.gda&&M!==this.KPc)?this.Xte("TableCellEdit"):this.Xte("Table"),!this.gda||"Table"!==this.gda||aa?(M?(r=["SelectTableMenu","DeleteTableMenu","InsertTableMenu","AlignmentTableMenu"],this.KPc=!0):(r="SelectTableMenu DeleteTableMenu InsertTableMenu AlignmentTableMenu MergeCells SplitCells TableDistributeMenu TableStyles ChangeColorsTable StyleOptionsTableMenu CellShading EditTableAltText BorderGallery TableBorderColor".split(" "),
this.KPc=!1),this.gda="Table"):A=!0):M.includes("Hyperlink")&&(this.Xte("Hyperlink"),this.gda&&"Hyperlink"===this.gda?A=!0:(r=["EditHyperlink","RemoveHyperlink","CopyHyperlink","OpenHyperlink"],this.gda="Hyperlink"));A?this.zIc||(this.jsd(this.K4a),this.LDe(!0),this.Hzc()):0<r.length?(this.Lqp(r),this.Hzc()):this.LDe(!1)},"requestIdleCallback"in window?window.requestIdleCallback(b):window.requestAnimationFrame(b)):this.LDe(!1)}BI(b,h){b={Time:(new Date).getTime(),Event:b,Message:h,Scenario:"AdaptiveTabGroup"};
h=new Sg.a;h.name="Events";h.dataFields=Qg.a.$H(b);h.durationMs=window.performance.now();ca.a.JNa(h,"TellMeWAC.")}}Object(u.a)(cd,"AdaptiveTabGroupUpdater",null,[]);class wd{constructor(){this.W=null;this.NRn=()=>{y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableAdaptiveTabGroupUpdater",!1)&&(this.W.ia(1181,()=>new cd(this.W.resolve(326),this.W.Ra(5),this.W.Ra(2))).ha(),this.W.resolve(1181))}}get name(){return"WordEditor.RibbonIntelligence"}uc(b){this.W=b}init(){jA.a(1,
this.NRn)}dispose(){}}Object(u.a)(wd,"PackageManager",null,[0,1]);var Yd=d(1837),oe=d(1068),Pe=d(1834);const bf=(b,h,r)=>1===r?32:2===r?(d.e(5).then(d.bind(null,2122)).then(A=>{A.createAndShowDevToolsMenu()}),32):2;class od{constructor(){this.name="WordEditor.DevTools"}init(){if(window.g_wordDevToolsIsEnabled||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DevToolsIsEnabled",!1))y.AFrameworkApplication.va.qa(Fc.a.aCg,we.a.frame,bf),null!==sessionStorage.getItem("devToolsRefresh")&&
d.e(5).then(d.bind(null,2122))}dispose(){}uc(b){x(b)}static main(){K.a.instance.Lc(new od)}}Object(u.a)(od,"WordDevToolsPackage",null,[0,1]);d(581);class ae{constructor(){this.underline=this.strikethrough=this.italic=this.highlight=this.fontColor=this.bold=null}}Object(u.a)(ae,"FormattingData",null,[]);class qh extends ae{constructor(){super();this.hyperlinkData=null}}Object(u.a)(qh,"RichContentCommandData",ae,[]);class Df{constructor(){Df.Ej.add(Fc.a.Ceb);Df.Ej.add(Fc.a.Q0b);Df.Ej.add(Fc.a.myc);
Df.Ej.add(Fc.a.pY);Df.Ej.add(Fc.a.Rag);Df.Ej.add(Fc.a.glg);Df.Ej.add(Fc.a.deleteComment);Df.Ej.add(Fc.a.XXc);Df.Ej.add(Fc.a.mvf);Df.Ej.add(Fc.a.Pye);Df.Ej.add(Fc.a.$_a);Df.Ej.add(Fc.a.aCg);Df.Ej.add(Fc.a.q0b);Df.Ej.add(Fc.a.hCg);Df.Ej.add(Fc.a.YYc);Df.Ej.add(Fc.a.u_d);Df.Ej.add(ub.a.wYc);Df.Ej.add(ub.a.KX);Df.Ej.add(ub.a.print);Df.Ej.add(ub.a.uqe);Df.Ej.add(ub.a.Qng);Df.Ej.add(ub.a.readingMode);Df.Ej.add(ub.a.ZTb);Df.Ej.add(Ka.a.C_j);Df.Ej.add(Ka.a.ou);Df.Ej.add(Ka.a.yqd);Df.Ej.add(Ka.a.RZb);Df.Ej.add(Ka.a.kla);
Df.Ej.add(Ka.a.Dod);Df.Ej.add(Ka.a.TBg);Df.Ej.add(Ka.a.MNg);Df.Ej.add(Ka.a.Aaa);Df.Ej.add(Ka.a.hMa);Df.Ej.add(Ka.a.Kof);Df.Ej.add(Ka.a.NXa);Df.Ej.add(Ka.a.Wsg);Df.Ej.add(Ka.a.Vsg);Df.Ej.add(Ka.a.Xsg);Df.Ej.add(Ka.a.GZd);Df.Ej.add(Ka.a.Sya);Df.Ej.add(Ka.a.bze);Df.Ej.add(Ka.a.uSj);Df.Ej.add(Ka.a.close);Df.Ej.add(Ka.a.qre);Df.Ej.add(Ka.a.Bqe);Df.Ej.add(Ka.a.One);Df.Ej.add(Ka.a.Yye);Df.Ej.add(Ka.a.aze);Df.Ej.add(Ka.a.EXb);Df.Ej.add(Ka.a.Sua);Df.Ej.add(Ka.a.lmc);Df.Ej.add(Ka.a.JCg);Df.Ej.add(Ka.a.sxc);
Df.Ej.add(Ka.a.Pea);Df.Ej.add(Ka.a.Dvc);Df.Ej.add(Ka.a.zpe);Df.Ej.add(Ka.a.hYb);Df.Ej.add(Ka.a.Lvj);Df.Ej.add(Ka.a.G2h);Df.Ej.add(Ka.a.vVd);Df.Ej.add(Ka.a.Jof);Df.Ej.add(Ka.a.I2h);Df.Ej.add(Ka.a.H2h);Df.Ej.add(Ka.a.Kof);Df.Ej.add(Ka.a.wVd);Df.Ej.add(Fc.a.eGe);Df.Ej.add(Fc.a.COg);Df.Ej.add(Fc.a.V2b);Df.Ej.add(Fc.a.pwg);Df.Ej.add(Fc.a.Awb);Df.Ej.add(Fc.a.Jre);Df.Ej.add(Fc.a.$na);Df.Ej.add(Ka.a.Wrb);Df.Ej.add(Ka.a.eob);Df.Ej.add(Ka.a.vxc);Df.Ej.add(Ka.a.gbk);Df.Ej.add(Ka.a.Svj);Df.Ej.add(Fc.a.jid);Df.Ej.add(ub.a.pXb);
Df.Ej.add(ub.a.E3)}}Df.Ej=new Set;Object(u.a)(Df,"CommentRibbonCommands",null,[]);class Ci{constructor(b,h,r,A,M){this.Kfj=b;this.Qg=h;this.Ep=r;this.ij=A;this.Cgp=M;this.l$b=null;this.iFa=new eh.a(0);this.vBb=new eh.a(0);this.DKe=new eh.a(0);this.Raf=!1;this.C3m();this.Pso()}Mcn(b){return this.l$b&&this.Ep.Vy?!Df.Ej.has(b):!1}$kc(b,h,r){if(b===Ka.a.Sg)return 32;if(!this.iFa.lb(b)&&!this.vBb.lb(b)||!this.l$b)return 2;const A=this.vBb.lb(b);var M=A?this.vBb.K(b):this.iFa.K(b);const aa=A?2:this.DKe.K(r);
A||1!==aa||(this.wgn(qa.StaticActiveAppFrame.za().oq.currentScope.name)||qa.StaticActiveAppFrame.za().oq.Jg(this.Qg.en?id.AFrame.zt:id.AFrame.lR),qa.StaticActiveAppFrame.za().Fe(!0));r=new qh;switch(M){case 1:r.highlight={color:this.QDi(h.Color)};break;case 6:r.fontColor={color:this.QDi(h.Color)}}M=this.l$b.executeCommand(M,aa,r);2===M&&A&&(b===ub.a.Otc?h[Vg.a.On]=!!r.bold:b===ub.a.Vtc?h[Vg.a.On]=!!r.italic:b===ub.a.huc?h[Vg.a.On]=!!r.underline:b===ub.a.$tc?h[Vg.a.On]=!!r.strikethrough:b===ub.a.hY?
h[Vg.a.On]=!!r.highlight:b===ub.a.Zw&&(h[Vg.a.On]=!!r.fontColor));return 2===M?32:1===M?2:8}Npo(b){this.l$b=b;this.l$b.registerSelectionChangeHandler(()=>{this.Raf||(this.Raf=!0,qa.StaticActiveAppFrame.za().Fe(!0),this.Raf=!1)});this.l$b.registerKeypressHandler(h=>{if(h.shortKey)switch(h.key){case cf.a.n3b:case cf.a.hvd:case cf.a.UHe:case cf.a.W0a:qa.StaticActiveAppFrame.za().Fe(!0)}h.key!==cf.a.BD&&h.key!==cf.a.F4||qa.StaticActiveAppFrame.za().Fe(!0)})}Pso(){this.Kfj.uzj(id.AFrame.zt,this);this.Kfj.uzj(id.AFrame.lR,
this)}C3m(){this.iFa.Z(ub.a.bold,0);this.iFa.Z(ub.a.eA,3);this.iFa.Z(ub.a.strikethrough,4);this.iFa.Z(ub.a.underline,5);this.iFa.Z(ub.a.hY,1);this.iFa.Z(ub.a.oza,1);this.iFa.Z(ub.a.Zw,6);this.iFa.Z(ub.a.Oja,6);this.iFa.Z(ub.a.nva,6);this.vBb.Z(ub.a.Otc,0);this.vBb.Z(ub.a.Vtc,3);this.vBb.Z(ub.a.$tc,4);this.vBb.Z(ub.a.huc,5);this.DKe.Z(1,0);this.DKe.Z(2,1)}wgn(b){return b===id.AFrame.zt||b===id.AFrame.lR}QDi(b){return b?Ol.a.BB(this.Cgp.Qja(this.ij.od,b)):""}}Object(u.a)(Ci,"CommentRibbonCommandHandler",
null,[212,213]);class mg{constructor(){this.W=null}get name(){return"WordEditor.CommentsRibbonHandler"}init(){this.W.resolve(774);this.W.resolve(751).Log?this.W.resolve(1182):this.W.resolve(742).T3("OnCommentRenderedOnce",()=>{this.W.resolve(1182)})}dispose(){}uc(b){this.W=b;this.W.ia("WordEditor.Comments.CommentRibbonCommandHandler",()=>new Ci(this.W.Oa(1085),this.W.resolve(751),this.W.resolve(744),$l.a.Mm.kb.Jc,Ep.a.instance)).as(774).ha();this.W.ia(1182,()=>new Df).ha()}static main(){K.a.instance.Lc(new mg)}}
Object(u.a)(mg,"PackageManager",null,[0,1]);var Vk=d(1982);class Vj{constructor(b,h){this.dMl=2E3;this.EKh=null;this.mig=b.Vpj;this.maxLength=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.MaxCanvasContextChars",this.dMl);h&&h.execute(r=>{this.EKh=r})}wGf(b){b=this.Shm(b,this.maxLength);return{semantic:Kp.ObjectSemantic.CanvasContext,type:Kp.ObjectSchemaType.WordCanvasContext,value:b}}Shm(b,h){try{return this.Rhm(b,h)}catch(r){return v.ULS.sendTraceTag(522725067,1303,15,
"Error processing selection for Canvas Context: {0}",r),null}}LHm(b,h){const r={Q7a:[],ECa:0,selection:{start:null,end:null},cursor:null,tiles:[]},A=b.length;for(let aa=0;aa<A;aa++){const oa=b.K(aa);var M=oa.node;if(!Gd.ParagraphReader.Vb(M)||Array.contains(r.Q7a,M.Bk))continue;r.Q7a.push(M.Bk);const Ja=Gd.ParagraphReader.textLength(M);if(r.ECa+Ja>h)break;M=this.mig.Enb(M);r.tiles.push(M);r.ECa+=Ja;1!==A||r.cursor||(r.cursor=Vj.hmm(oa,r.tiles.length-1));null===r.selection.start&&0===aa&&(r.selection.start=
this.tHi(oa,!0,r.tiles.length-1));null===r.selection.end&&aa===A-1&&(r.selection.end=this.tHi(oa,!1,r.tiles.length-1))}return r}kym(b,h,r){const A={Pqd:[],d_j:[],ECa:0};var M=b.K(0).node;let aa=b.K(b.length-1).node;for(b=h;0<b&&(M||aa);){var oa=Vj.suj(M,!0,b,r);if(M=oa.node)M=this.mig.Enb(M),A.Pqd.push(M),b-=oa.ECa,M=oa.node,r=oa.Q7a;oa=Vj.suj(aa,!1,b,r);if(aa=oa.node)r=this.mig.Enb(aa),A.d_j.push(r),b-=oa.ECa,aa=oa.node,r=oa.Q7a}A.ECa=h-b;return A}Thm(b,h){let r=0;var A=this.LHm(b,h);const M={tiles:A.tiles,
selection:A.selection,cursor:A.cursor};r+=A.ECa;A=A.Q7a;r<h&&(b=this.kym(b,h-r,A),M.tiles.unshift.apply(M.tiles,b.Pqd),M.tiles.push.apply(M.tiles,b.d_j),M.selection.start&&(M.selection.start.index+=b.Pqd.length),M.selection.end&&(M.selection.end.index+=b.Pqd.length),M.cursor&&(M.cursor.index+=b.Pqd.length));return M}Rhm(b,h){var r;if(!b)return null;b=this.Thm(b,h);return{contentType:null===(r=this.EKh)||void 0===r?void 0:r.contentType,formattedContext:b.tiles,selection:b.selection,cursor:b.cursor}}tHi(b,
h,r){if(b.contextId===lc.a.Cd||b.contextId===lc.a.paragraph||b.contextId===lc.a.Xc){if(h&&-1!==b.Hj)return{index:r,offset:b.Hj};if(!h&&-1!==b.Oo)return{index:r,offset:b.Oo}}return null}static hmm(b,h){return b.contextId===lc.a.Xc?{index:h,offset:b.Hj}:null}static suj(b,h,r,A){A={node:null,ECa:0,Q7a:A};if(!b||0>=r||!A.Q7a)return A;do A.node=Gd.ParagraphReader.xg(b,h,!1,!1),A.ECa=A.node?Gd.ParagraphReader.textLength(A.node):0,b=A.node;while(A.node&&(Array.contains(A.Q7a,A.node.Bk)||!Gd.ParagraphReader.Vb(A.node)||
!A.ECa));A.node&&(A.ECa>r?A.node=null:A.Q7a.push(A.node.Bk));return A}}Object(u.a)(Vj,"Box4CanvasContextProvider",null,[208]);class Yi{get name(){return"Box4.CanvasContext"}init(){}dispose(){}uc(b){b.ia("Box4.CanvasContext.Box4CanvasContextProvider",()=>new Vj(b.resolve(736),b.Ra(5))).as(1016).ha()}static main(){K.a.instance.Lc(new Yi)}}Object(u.a)(Yi,"Box4CanvasContextPackage",null,[0,1]);class fi{constructor(b,h,r,A){this.xK={};this.qbc=this.YKd=0;this.TYd=3E4;this.start=()=>{0!=this.kJb.size&&
0===this.qbc&&(this.qbc=window.setInterval(this.aHo,this.TYd),v.ULS.sendTraceTag(509215365,306,50,"Starting watchdog task"))};this.aHo=()=>{0!=this.kJb.size&&(this.tf.Do?(v.ULS.sendTraceTag(520974675,306,50,"Session has been kicked out"),this.stop()):(this.xK.ScanTime=Date.now(),this.xK.NumWatchDogs=this.kJb.size,this.xK.WatchDogManagerScanNumber=++this.YKd,this.kJb.forEach(async(M,aa)=>{this.xK[aa]=await M.EKn();"KickoutComponent"==this.xK[aa].ComponentStatus&&this.D1f(this.Lom(aa));M.rrn()||v.ULS.sendTraceTag(520974674,
306,20,JSON.stringify(this.xK))})))};this.tf=b;this.Tpa=r;this.C1=A;this.Tbf=new Map;this.kJb=new Map;h.execute(M=>{this.tk=M;this.tk.IHa((aa,oa)=>{this.A_(oa)})})}A_(b){2!==b.oldState&&3!==b.oldState||1!==b.newState&&0!==b.newState?2!==b.newState&&3!==b.newState||0===this.qbc||(v.ULS.sendTraceTag(509215698,306,50,"WatchDogManager stopping for {0}",b.newState),this.stop()):(this.stop(),this.start(),this.mDo(),v.ULS.sendTraceTag(509219479,306,50,"WatchDogManager returning from {0} to {1}",b.oldState,
b.newState))}stop(){0!==this.qbc&&(window.clearInterval(this.qbc),this.qbc=0);v.ULS.sendTraceTag(509215696,306,50,"Stopping watchdog task")}rXk(b,h){this.Tbf.set(b,h)}QDo(){this.lbo(this.Tbf)}get t2k(){return this.Tbf.size===this.kJb.size}lbo(b){b.forEach((h,r)=>{h.execute(A=>{A?(this.kJb.set(r,A),this.start()):v.ULS.sendTraceTag(512550848,306,10,"WatchDog {0} resolved to null",r)})})}mDo(){this.kJb.forEach(b=>{b&&b.zDa()});v.ULS.sendTraceTag(509138259,306,50,"WatchDogs reset")}D1f(b){0<this.Tpa.l0a&&
this.C1.JTb(b)}Lom(b){return 1288==b?Bf.a.SGp:1289==b?Bf.a.RGp:null}}Object(u.a)(fi,"WatchDogManager",null,[204]);class yj{constructor(){this.W=this.jJb=null}get name(){return"Box4.WatchDogManager.WatchDogManager"}init(){this.jJb=this.W.resolve(this.name);this.I5m()}dispose(){this.jJb&&this.jJb.stop()}uc(b){this.W=b;b.ia(this.name,this.dJl.bind(this)).as("Box4.WatchDogManager.IWatchDogManager").ha()}static main(){K.a.instance.Lc(new yj)}gBp(){if(!this.jJb.t2k){const b=[];let h=0;this.TKd.forEach((r,
A)=>{r&&(this.W.Oa(A)||(b[h++]=A))});if(0<b.length){const r=!this.W.resolve(436).AU;v.ULS.sendTraceTag(508965916,306,10,"{0} did not resolve. HasDataLoss: {1}",b,r)}}}dJl(){return new fi(this.W.resolve(117)||ec.SessionStatusManager.instance,this.W.Ra(103),this.W.resolve(819),this.W.resolve(439))}nYk(){window.setTimeout(this.gBp.bind(this),this.LCp)}uYk(){this.TKd=new Map;this.TKd.set(1288,df.a.hn||df.a.yt);this.TKd.set(1289,!0)}I5m(){this.uYk();this.tYk(this.TKd,this.jJb.rXk.bind(this.jJb));this.jJb.QDo();
this.nYk()}tYk(b,h){b.forEach((r,A)=>{r&&h(A,this.W.Ra(A))})}get LCp(){return null!=this.D6g?this.D6g:this.D6g=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.WatchdogResolveIntervalMs",3E5)}}Object(u.a)(yj,"WatchDogManagerPackage",null,[0,1]);class uj{constructor(b){this.PMa=b;this.boi=!1;this.Bpb=void 0}eYo(){this.boi||(this.wDl(),this.$vl(),this.KZl(),this.Z$n(),this.boi=!0)}X3o(){em.UISurfaces.yqm().then(b=>{b.renderFloatingHelp(this.Bpb.xla,{["actionCallback"]:(h,r=2,
A=null)=>{y.AFrameworkApplication.va.Pb(h,r,A)}});return null})}$vl(){this.Bpb.wfd.appendChild(this.Bpb.xla)}KZl(){this.PMa.appendChild(this.Bpb.wfd)}wDl(){this.Bpb={wfd:this.r8h(uj.x3n),xla:this.r8h(uj.q6m)}}r8h(b){const h=document.createElement("div");h.id=b;return h}Z$n(){this.Bpb.wfd.style.position="fixed";this.Bpb.wfd.style.bottom="47px";this.Bpb.wfd.style.right="24px"}}uj.x3n="FloatingHelpOuterContainer";uj.q6m="FloatingHelpInnerHost";Object(u.a)(uj,"FloatingHelpManager",null,[202]);class Pj{constructor(){this.container=
void 0}get name(){return"WordEditor.FloatingHelp"}uc(b){this.container=b;const h=$l.a.Mm.XF;this.container.ia("WordEditor.FloatingHelp.FloatingHelpManager",()=>new uj(h)).as(1183).ha()}init(){if(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FloatingHelpExperiment",!1)&&void 0!==this.container){const b=this.container.resolve(1183);b.eYo();b.X3o()}}dispose(){}static main(){K.a.instance.Lc(new Pj)}}Object(u.a)(Pj,"FloatingHelpPackage",null,[0,1]);class mj{constructor(b,
h){this.id=b;this.altText=h}}Object(u.a)(mj,"ParagraphBorderPropertiesItem",null,[]);class ci{constructor(b,h,r,A,M,aa){this.H3d=b;this.gallerySectionId=h;this.uBf=r;this.vgf=A;this.commandId=M;this.queryCommandId=aa}}Object(u.a)(ci,"ParagraphBorderPropertiesMenuPropsArgs",null,[]);class op{constructor(b,h,r,A){this.size=b;this.space=h;this.style=r;this.color=A}}Object(u.a)(op,"ParagraphBorderStyleProperties",null,[]);class $d{constructor(b,h,r,A,M,aa){this.Z5a=b;this.Npd=h;this.width=r;this.Gdd=
A;this.height=M;this.Nad=aa}}Object(u.a)($d,"ParagraphBorderPropertiesDefinition",null,[]);class md{constructor(){this.Sbl=[new mj(md.w0b,WordEditorIntl.WordEditorStrings.L_ParagraphBorderSolidLine),new mj(md.OMb,WordEditorIntl.WordEditorStrings.L_ParagraphBorderDashedLine),new mj(md.oNb,WordEditorIntl.WordEditorStrings.L_ParagraphBorderDottedLine),new mj(md.qNb,WordEditorIntl.WordEditorStrings.L_ParagraphBorderDoubleLine)];this.bcl=[new mj(md.yKb,"0.25 pt"),new mj(md.wKb,"0.5 pt"),new mj(md.BKb,
"0.75 pt"),new mj(md.xKb,"1 pt"),new mj(md.vKb,"1.5 pt"),new mj(md.CKb,"2.25 pt"),new mj(md.AKb,"3 pt"),new mj(md.uKb,"4.5 pt"),new mj(md.zKb,"6 pt")];this.Obl=[new mj(md.nkf,"0 pt"),new mj(md.hkf,"1 pt"),new mj(md.mkf,"2 pt"),new mj(md.lkf,"3 pt"),new mj(md.fkf,"4 pt"),new mj(md.dkf,"5 pt"),new mj(md.jkf,"6 pt"),new mj(md.ikf,"7 pt"),new mj(md.ckf,"8 pt"),new mj(md.gkf,"9 pt"),new mj(md.kkf,"10 pt")]}initialize(){this.B3m();this.ljd()}B3m(){this.TSd=[new $d(md.w0b,"","2",1,8,0),new $d(md.OMb,"5,3",
"1",1,8,0),new $d(md.oNb,"1,1","1",1,8,0),new $d(md.qNb,"","1",2,8,3)];this.USd=[new $d(md.yKb,"","0.25",1,8,0),new $d(md.wKb,"","0.5",1,8,0),new $d(md.BKb,"","0.75",1,8,0),new $d(md.xKb,"","1",1,8,0),new $d(md.vKb,"","1.5",1,8,0),new $d(md.CKb,"","2.25",1,8,0),new $d(md.AKb,"","3",1,8,0),new $d(md.uKb,"","4.5",1,8,0),new $d(md.zKb,"","6",1,8,0)]}ljd(){if(Object(hh.c)()){var b={};for(const h of this.TSd)b[h.Z5a]=appChrome.buildBorderStyleIcon(h.Npd,h.width,h.Gdd,h.height,h.Nad);for(const h of this.USd)b[h.Z5a]=
appChrome.buildBorderStyleIcon(h.Npd,h.width,h.Gdd,h.height,h.Nad);appChrome.api.registerIconProvider(()=>b)}else v.ULS.sendTraceTag(508339926,306,15,"AppChrome not loaded yet. Skipping registering icons for paragraph border manager.")}MHf(){return new op(md.Tfc,md.Cbi,md.Sfc,md.OXc)}jGf(b){var h=this.Fsi(b);if(0!==h.length){for(const A of h)if(r){if(h=this.Esi(b,A),!this.ASh(r,h))return}else var r=this.Esi(b,A);return r}}Esi(b,h){const r=this.MHf();switch(h){case 0:return{size:Gd.ParagraphReader.nj(b,
De.a.YU,r.size),space:Gd.ParagraphReader.nj(b,De.a.NMa,r.space),style:Gd.ParagraphReader.nj(b,De.a.awb,r.style),color:Gd.ParagraphReader.nj(b,De.a.$vb,r.color)};case 1:return{size:Gd.ParagraphReader.nj(b,De.a.u0,r.size),space:Gd.ParagraphReader.nj(b,De.a.MMa,r.space),style:Gd.ParagraphReader.nj(b,De.a.Vvb,r.style),color:Gd.ParagraphReader.nj(b,De.a.Uvb,r.color)};case 2:return{size:Gd.ParagraphReader.nj(b,De.a.e8,r.size),space:Gd.ParagraphReader.nj(b,De.a.SYa,r.space),style:Gd.ParagraphReader.nj(b,
De.a.Xvb,r.style),color:Gd.ParagraphReader.nj(b,De.a.Wvb,r.color)};case 3:return{size:Gd.ParagraphReader.nj(b,De.a.Oba,r.size),space:Gd.ParagraphReader.nj(b,De.a.ocb,r.space),style:Gd.ParagraphReader.nj(b,De.a.VWb,r.style),color:Gd.ParagraphReader.nj(b,De.a.ncb,r.color)};case 4:return{size:Gd.ParagraphReader.nj(b,De.a.PX,r.size),space:Gd.ParagraphReader.nj(b,De.a.LMa,r.space),style:Gd.ParagraphReader.nj(b,De.a.TWb,r.style),color:Gd.ParagraphReader.nj(b,De.a.SWb,r.color)}}return r}ghm(b){switch(b){case md.yKb:return md.oTc;
case md.wKb:return md.jVh;case md.BKb:return md.X5a;case md.xKb:return md.Qqa;case md.vKb:return md.T$;case md.CKb:return md.Hja;case md.AKb:return md.n6;case md.uKb:return md.fza;case md.zKb:return md.Gja;default:return md.Tfc}}dhm(b){switch(b){case md.w0b:return"single";case md.OMb:return"dashed";case md.oNb:return"dotted";case md.qNb:return"double";default:return md.Sfc}}ahm(b){switch(b){case md.nkf:return md.uVh;case md.hkf:return md.oVh;case md.mkf:return md.tVh;case md.lkf:return md.sVh;case md.fkf:return md.ekf;
case md.dkf:return md.mVh;case md.jkf:return md.qVh;case md.ikf:return md.pVh;case md.ckf:return md.lVh;case md.gkf:return md.nVh;case md.kkf:return md.rVh;default:return md.Cbi}}hhm(b){switch(b){case md.oTc:return md.yKb;case md.jVh:return md.wKb;case md.X5a:return md.BKb;case md.Qqa:return md.xKb;case md.T$:return md.vKb;case md.Hja:return md.CKb;case md.n6:return md.AKb;case md.fza:return md.uKb;case md.Gja:return md.zKb}}ehm(b){switch(b){case "single":return md.w0b;case "dashed":return md.OMb;
case "dotted":return md.oNb;case "double":return md.qNb}}bhm(b){switch(b){case md.uVh:return md.nkf;case md.oVh:return md.hkf;case md.tVh:return md.mkf;case md.sVh:return md.lkf;case md.ekf:return md.fkf;case md.mVh:return md.dkf;case md.qVh:return md.jkf;case md.pVh:return md.ikf;case md.lVh:return md.ckf;case md.nVh:return md.gkf;case md.rVh:return md.kkf}}Fsi(b){const h=[];void 0!==Gd.ParagraphReader.nj(b,De.a.YU,void 0)&&h.push(0);void 0!==Gd.ParagraphReader.nj(b,De.a.u0,void 0)&&h.push(1);void 0!==
Gd.ParagraphReader.nj(b,De.a.e8,void 0)&&h.push(2);void 0!==Gd.ParagraphReader.nj(b,De.a.Oba,void 0)&&h.push(3);void 0!==Gd.ParagraphReader.nj(b,De.a.PX,void 0)&&h.push(4);return h}WEf(){const b=new ci("ParagraphBorderLineStyleOptionsGallery","DefaultBorderStyleOptions","ParagraphBorderLineStyleOptionsGallery",this.Sbl,Fc.a.t_b,Fc.a.gre);return this.Eic(b,md.Tbl,md.Ubl)}XEf(){const b=new ci("ParagraphBorderLineWeightOptionsGallery","DefaultBorderWeightOptions","ParagraphBorderLineWeightOptionsGallery",
this.bcl,Fc.a.u_b,Fc.a.hre);return this.Eic(b,md.ccl,md.dcl)}scm(){const b=new ci("ParagraphBorderLinePaddingOptionsGallery","DefaultBorderPaddingOptions","ParagraphBorderLinePaddingOptionsGallery",this.Obl,Fc.a.s_b,Fc.a.fre);return this.Eic(b,"0px","0px")}Eic(b,h="20px",r="50px"){const A=new aj.a,M=new te.a,aa=Object.assign(new Mo.a,{Id:b.H3d,ExternalId:b.gallerySectionId,ExternalGalleryId:b.uBf,Type:4,Width:10,GalleryItems:[]});for(const Ja of b.vgf){var oa={};const fb={};fb.width=r;fb.height=h;
fb.marginRight="8px";oa.root=fb;oa=Object.assign(new yq.a,{Id:String.format("{0}_Button",Ja.id),ExternalId:String.format("{0}_ExternalID",Ja.id),Icon:Ja.id,Command:b.commandId.toString(),QueryCommand:b.queryCommandId.toString(),MenuItemId:Ja.id,SYp:fb,FullIconStyle:oa,LabelText:Ja.altText});aa.GalleryItems.push(oa)}M.ControlList=[];A.MenuSectionList=[];M.ControlList.push(aa);A.MenuSectionList.push(M);A.UpdateDynamically=!0;return A}ASh(b,h){return!b&&!h||b&&h&&b.color===h.color&&b.size===h.size&&
b.style===h.style&&b.space===h.space}}var Jj=md;md.w0b="SolidLineStyle";md.OMb="DashedLineStyle";md.oNb="DottedLineStyle";md.qNb="DoubleLineStyle";md.oTc=2;md.yKb="BorderPointSizeOneQuarter";md.jVh=4;md.wKb="BorderPointSizeOneHalf";md.X5a=6;md.BKb="BorderPointSizeThreeQuarters";md.Qqa=8;md.xKb="BorderPointSizeOne";md.T$=12;md.vKb="BorderPointSizeOneAndHalf";md.Hja=18;md.CKb="BorderPointSizeTwoAndQuarter";md.n6=24;md.AKb="BorderPointSizeThree";md.fza=36;md.uKb="BorderPointSizeFourAndHalf";md.Gja=48;
md.zKb="BorderPointSizeSix";md.uVh=0;md.nkf="BorderSpaceZero";md.oVh=1;md.hkf="BorderSpaceOne";md.tVh=2;md.mkf="BorderSpaceTwo";md.sVh=3;md.lkf="BorderSpaceThree";md.ekf=4;md.fkf="BorderSpaceFour";md.mVh=5;md.dkf="BorderSpaceFive";md.qVh=6;md.jkf="BorderSpaceSix";md.pVh=7;md.ikf="BorderSpaceSeven";md.lVh=8;md.ckf="BorderSpaceEight";md.nVh=9;md.gkf="BorderSpaceNine";md.rVh=10;md.kkf="BorderSpaceTen";md.Sfc="single";md.Tfc=md.Qqa;md.OXc=0;md.Cbi=Jj.ekf;md.Ubl="50px";md.Tbl="20px";md.dcl="60px";md.ccl=
"20px";Object(u.a)(md,"ParagraphBorderManager",null,[209]);class tn{constructor(){this.qte={size:0,space:0,color:0,style:"none"}}Oxb(b,h,r){for(const A of h)this.BOo(b,A,r)}BOo(b,h,r){switch(h){case 0:b.properties.setValue(De.a.NMa,r.space);b.properties.setValue(De.a.YU,r.size);b.properties.setValue(De.a.$vb,r.color);b.properties.setValue(De.a.awb,r.style);break;case 1:b.properties.setValue(De.a.MMa,r.space);b.properties.setValue(De.a.u0,r.size);b.properties.setValue(De.a.Uvb,r.color);b.properties.setValue(De.a.Vvb,
r.style);break;case 2:b.properties.setValue(De.a.SYa,r.space);b.properties.setValue(De.a.e8,r.size);b.properties.setValue(De.a.Wvb,r.color);b.properties.setValue(De.a.Xvb,r.style);break;case 3:b.properties.setValue(De.a.ocb,r.space);b.properties.setValue(De.a.Oba,r.size);b.properties.setValue(De.a.ncb,r.color);b.properties.setValue(De.a.VWb,r.style);break;case 4:b.properties.setValue(De.a.LMa,r.space),b.properties.setValue(De.a.PX,r.size),b.properties.setValue(De.a.SWb,r.color),b.properties.setValue(De.a.TWb,
r.style)}}Uol(b){var h=[0,1,2,3,4];for(const r of h)this.Vol(b,r)}Vol(b,h){switch(h){case 0:this.Ejd(b,tn.Fip);break;case 1:this.Ejd(b,tn.ecl);break;case 2:this.Ejd(b,tn.uvn);break;case 3:this.Ejd(b,tn.PFo);break;case 4:this.Ejd(b,tn.mal)}}Ejd(b,h){const [r,A,M,aa]=h;h=Gd.ParagraphReader.Wb.Aq(b);h.hasProperty(r)?b.properties.setValue(r,this.qte.space):b.properties.hasProperty(r)&&b.properties.removeProperty(r);h.hasProperty(A)?b.properties.setValue(A,this.qte.size):b.properties.hasProperty(A)&&b.properties.removeProperty(A);
h.hasProperty(M)?b.properties.setValue(M,this.qte.color):b.properties.hasProperty(M)&&b.properties.removeProperty(M);h.hasProperty(aa)?b.properties.setValue(aa,this.qte.style):b.properties.hasProperty(aa)&&b.properties.removeProperty(aa)}}tn.Fip=[De.a.NMa,De.a.YU,De.a.$vb,De.a.awb];tn.ecl=[De.a.MMa,De.a.u0,De.a.Uvb,De.a.Vvb];tn.uvn=[De.a.SYa,De.a.e8,De.a.Wvb,De.a.Xvb];tn.PFo=[De.a.ocb,De.a.Oba,De.a.ncb,De.a.VWb];tn.mal=[De.a.LMa,De.a.PX,De.a.SWb,De.a.TWb];Object(u.a)(tn,"ParagraphBorderEditor",null,
[207]);class Po{constructor(b){this.Wb=b}uzg(b,h){b.properties.setValue(Po.R_b,h.color)}Xnf(b){this.Wb.Aq(b).hasProperty(Po.R_b)?b.properties.setValue(Po.R_b,MF.gwo):b.properties.hasProperty(Po.R_b)&&b.properties.removeProperty(Po.R_b)}}Po.R_b=wb.a.$w;Object(u.a)(Po,"ParagraphShadingEditor",null,[205]);class qs{bIm(b){b=Gd.ParagraphReader.nj(b,qs.R_b,null);return null===b?null:new MF(b)}}qs.R_b=wb.a.$w;Object(u.a)(qs,"ParagraphShadingReader",null,[203]);class nq{get name(){return"WordEditor.ParagraphEditor"}uc(b){this.container=
b;y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphBordersEditingEnabled",!1)&&(this.container.ia(1160,()=>new tn).ha(),this.container.ia(1161,()=>new md).ha());y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphShadingEditingEnabled",!1)&&(this.container.ia(1162,()=>new Po(this.container.resolve(8))).ha(),this.container.ia(1163,()=>new qs).ha())}init(){this.container.resolve(1161).initialize()}dispose(){}static main(){y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphBordersEditingEnabled",
!1)&&K.a.instance.Lc(new nq)}}Object(u.a)(nq,"WordEditorParagraphEditorsPackage",null,[0,1]);Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");Type.registerNamespace("CommandUI.Controls.SearchBoxComponents");Type.registerNamespace("CommandUI.React");Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");Type.registerNamespace("B4AuC");Type.registerNamespace("B4CS");Type.registerNamespace("B4IE");Type.registerNamespace("B4Im");Type.registerNamespace("B4Intent");
Type.registerNamespace("B4LE");Type.registerNamespace("B4NLE");Type.registerNamespace("B4OLE");Type.registerNamespace("B4S");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TaE");Type.registerNamespace("B4UI");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");Type.registerNamespace("Box4.AtMentions");Type.registerNamespace("Box4.AugmentationLoop");Type.registerNamespace("Box4.AugmentationLoop.TilingSchema");Type.registerNamespace("Box4.ClipArt");Type.registerNamespace("Box4.Clipboard");
Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.Media");Type.registerNamespace("Box4.Proofing");Type.registerNamespace("Box4.TaskPaneManager");Type.registerNamespace("Box4.WorkerShared");Type.registerNamespace("Box4.Workers");Type.registerNamespace("CanvasAtMentions");Type.registerNamespace("Common.App.CatchUpActivity");Type.registerNamespace("GC2");Type.registerNamespace("PUTSOMETHINGHERE");
Type.registerNamespace("WEAc");Type.registerNamespace("WEB");Type.registerNamespace("WECX");Type.registerNamespace("WEDCE");Type.registerNamespace("WEIE");Type.registerNamespace("WEIL");Type.registerNamespace("WELE");Type.registerNamespace("WENLE");Type.registerNamespace("WEOLE");Type.registerNamespace("WETaE");Type.registerNamespace("WEUI");Type.registerNamespace("Wac.Common");Type.registerNamespace("Wac.Common.Actors");Type.registerNamespace("Wac.Common.SendUsYourFile");Type.registerNamespace("Wonca.UI");
Type.registerNamespace("WordEditor.AtMentions");Type.registerNamespace("WordEditor.CanvasContextualProvider");Type.registerNamespace("WordEditor.CatchUpActivity");Type.registerNamespace("WordEditor.CatchUpActivity.NetworkShared");Type.registerNamespace("WordEditor.ContextualSearch");Type.registerNamespace("WordEditor.CritiqueCounts");Type.registerNamespace("WordEditor.Designer.Common");Type.registerNamespace("WordEditor.Designer.Common.AL");Type.registerNamespace("WordEditor.Designer.Common.Conditions");
Type.registerNamespace("WordEditor.Designer.Common.Review");Type.registerNamespace("WordEditor.DocumentUnderstanding.RLM");Type.registerNamespace("WordEditor.Embed");Type.registerNamespace("WordEditor.FindReplace");Type.registerNamespace("WordEditor.FootnoteEndnote");Type.registerNamespace("WordEditor.FootnoteEndnoteInteractive");Type.registerNamespace("WordEditor.Goals");Type.registerNamespace("WordEditor.GraphicsEditor");Type.registerNamespace("WordEditor.HeaderFooter");Type.registerNamespace("WordEditor.Insights");
Type.registerNamespace("WordEditor.IntelligentPlaceholder");Type.registerNamespace("WordEditor.RibbonIntelligence");Type.registerNamespace("WordEditor.Ruler");Type.registerNamespace("WordEditor.SendUsYourFile");Type.registerNamespace("WordEditor.SignalAggregator");Type.registerNamespace("WordEditor.TableStyle");Type.registerNamespace("WordEditor.TaskPaneManager");Type.registerNamespace("WordEditor.Tasks");Type.registerNamespace("WordEditor.WordCount");Type.registerNamespace("WordEditor.WorkerShared");
Type.registerNamespace("WordEditor.Workers");Type.registerNamespace("Common.App.AccountSwitching");G.main();Type.registerNamespace("Common.App.WopiIdentity");za.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");Kc.main();Object(Vk.a)(!1);zx.main();rv.main();$b.main();ra.main();Ya.main();od.main();Pj.main();Type.registerNamespace("Common.App.AccessibilityHelpDialog");Type.registerNamespace("Common.App.ActivityAggregator");Qe.main();Type.registerNamespace("Common.App.AltTextDialog");
Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("Common");Ig.main();Type.registerNamespace("Common.App.WildFire");jj.main();Type.registerNamespace("Common.App.BrowserInfoLogger");Vi.main();Type.registerNamespace("Common.App.HostNotification");Tf.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.FloatPane");yd.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");
Type.registerNamespace("Common.App.LivePersonaUtils");Ef.main();Type.registerNamespace("CNT");Mh.main();Type.registerNamespace("Common.App.NewAndOpen.Core");K.a.instance.Lc(new bh);Type.registerNamespace("Common.App.NewAndOpen.UX");K.a.instance.Lc(new Ph);Type.registerNamespace("Common.App.OneDriveFilePickerApi");Zm.main();Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SafeLinks");Type.registerNamespace("Common.App.SafeLinks");Tn.main();Type.registerNamespace("Common.Search");
Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");ne.main();Type.registerNamespace("Common.App.TaskPaneManager");Type.registerNamespace("CAUI");kc.main();Type.registerNamespace("CADWLTR");Oc.main();Type.registerNamespace("Common.App.DirectPrint");K.a.instance.Lc(new Bg);Type.registerNamespace("Common.App.SearchOAuthManager");bk.main();Wf.main();jf.main();$e.main();Cg.main();ji.main();K.a.instance.Lc(new ai);Ll.main();cl.main();Xl.main();
K.a.instance.Lc(new yl);Type.registerNamespace("Common.App.SaveStatus");K.a.instance.Lc(new vc);Type.registerNamespace("Common.App.EventsCacheManager");nm.main();Type.registerNamespace("CUIB");Wr.main();Type.registerNamespace("CommandUI.TaskPane");try{K.a.instance.Lc(new Da(qa.StaticActiveAppFrame.za().kb))}catch(b){v.ULS.shipAssertTag(575930383,3016,!1,b.message)}To.main();Type.registerNamespace("Common.App.Insights");yh;K.a.instance.Lc(new ut);Type.registerNamespace("Common.App.Policy.Contracts");
Type.registerNamespace("Common.App.AugmentationLoop");Type.registerNamespace("Common.App.CommentsSmartReply");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AugmentationLoop.SDX");Nq("Begin");K.a.instance.Lc(new Ww);try{K.a.instance.Lc(new uh(zl.a.get_instance(),qa.StaticActiveAppFrame.za().kb,qa.StaticActiveAppFrame.za().Ib))}catch(b){v.ULS.shipAssertTag(575930384,3016,!1,b.message)}rc.main();K.a.instance.Lc(new lf);as.main();Rq.main();hm.main();Hy.main();
yz.main();qn.main();iB.main();Ov.main();K.a.instance.Lc(new nJ);LC.main();vE.main();xE.main();EG.main();Yi.main();mg.main();K.a.instance.Lc(new lx);K.a.instance.Lc(new uJ);TD.main();FE.main();nx.main();nq.main();K.a.instance.Lc(new Jp);K.a.instance.Lc(new CJ);UC;cH.main();oH.main();WE.main();lv.main();zH;K.a.instance.Lc(new JB);K.a.instance.Lc(new mv);DH.main();gz.main();yx.main();K.a.instance.Lc(new OH);K.a.instance.Lc(new iK);Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=
n;Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");eg.main();Fi.main();Km.main();fl;GL.main();HL;window.MSOJS=tv;cM.main();eM.main();K.a.instance.Lc(new bc);K.a.instance.Lc(new wd);(async()=>{y.AFrameworkApplication.J.$("WPMPackageIsEnabled")&&await d.e(29).then(d.bind(null,2131)).then(b=>{b.initializeOnDemandPackage()})})();yj.main();Nh.main()},2137:function(J,L,d){J=d(0);var m=d(7),f=d(1547);class a{static get oHn(){return 50}static v7d(w){if(""===
w)return"";let z=0,x="";try{const u=f.a.rqb(w);for(const v of u.ops)if(a.sI(v))z||(x+=a.aqm(v.attributes.atmention.fullName)),z+=1;else{const E=v.insert?v.insert:"";" "!==E&&0<E.length&&(z=0,x+=E)}}catch(u){m.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return x}static Wjm(w){w=a.v7d(w);return 0<w.length&&w.split(" ").length<=a.oHn?w:null}static aqm(w){let z="";w&&(w=w.split(" "),0<w.length&&(z=w[0]));return z}static sI(w){return!!w.attributes&&
!!w.attributes.atmention}}Object(J.a)(a,"BaseCommentSmartReplyHelpers",null,[]);d.d(L,"a",function(){return l});class l extends a{constructor(){super()}static $Ob(w,z,x=!1){if(!w)return null;w=w.text&&0<w.text.length?w.text[0]:"";z=!z||!z.Of||""===z.Of;return 0<w.length&&z&&!x?a.Wjm(w):null}}Object(J.a)(l,"CommentSmartReplyHelpers",a,[])},934:function(J,L,d){d.d(L,"a",function(){return m});J=d(0);class m{constructor(){this.method=this.api=0}}Object(J.a)(m,"Message",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/22495436/wdjs/WordEditorDS.box4.dll1.js.map